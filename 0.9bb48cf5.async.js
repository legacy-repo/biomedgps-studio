var xA=Math.pow;var Wr=(sr,it,$)=>new Promise((X,tt)=>{var j=Z=>{try{Q($.next(Z))}catch(L){tt(L)}},W=Z=>{try{Q($.throw(Z))}catch(L){tt(L)}},Q=Z=>Z.done?X(Z.value):Promise.resolve(Z.value).then(j,W);Q(($=$.apply(sr,it)).next())});(self.webpackChunkbiomedgps_studio=self.webpackChunkbiomedgps_studio||[]).push([[0],{7364:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"}},{tag:"path",attrs:{d:"M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"}}]},name:"aim",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="AimOutlined";var L=tt.forwardRef(Z)},43396:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M952 224h-52c-4.4 0-8 3.6-8 8v248h-92V304c0-4.4-3.6-8-8-8H232c-4.4 0-8 3.6-8 8v176h-92V232c0-4.4-3.6-8-8-8H72c-4.4 0-8 3.6-8 8v560c0 4.4 3.6 8 8 8h52c4.4 0 8-3.6 8-8V548h92v172c0 4.4 3.6 8 8 8h560c4.4 0 8-3.6 8-8V548h92v244c0 4.4 3.6 8 8 8h52c4.4 0 8-3.6 8-8V232c0-4.4-3.6-8-8-8zM296 368h88v288h-88V368zm432 288H448V368h280v288z"}}]},name:"box-plot",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="BoxPlotOutlined";var L=tt.forwardRef(Z)},71938:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M740 161c-61.8 0-112 50.2-112 112 0 50.1 33.1 92.6 78.5 106.9v95.9L320 602.4V318.1c44.2-15 76-56.9 76-106.1 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 49.2 31.8 91 76 106.1V706c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-27.8l423.5-138.7a50.52 50.52 0 0034.9-48.2V378.2c42.9-15.8 73.6-57 73.6-105.2 0-61.8-50.2-112-112-112zm-504 51a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm96 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm408-491a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"branches",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="BranchesOutlined";var L=tt.forwardRef(Z)},72850:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="ClearOutlined";var L=tt.forwardRef(Z)},19671:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M624 706.3h-74.1V464c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v242.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.7a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-download",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="CloudDownloadOutlined";var L=tt.forwardRef(Z)},43587:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M704 446H320c-4.4 0-8 3.6-8 8v402c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8V454c0-4.4-3.6-8-8-8zm-328 64h272v117H376V510zm272 290H376V683h272v117z"}},{tag:"path",attrs:{d:"M424 748a32 32 0 1064 0 32 32 0 10-64 0zm0-178a32 32 0 1064 0 32 32 0 10-64 0z"}},{tag:"path",attrs:{d:"M811.4 368.9C765.6 248 648.9 162 512.2 162S258.8 247.9 213 368.8C126.9 391.5 63.5 470.2 64 563.6 64.6 668 145.6 752.9 247.6 762c4.7.4 8.7-3.3 8.7-8v-60.4c0-4-3-7.4-7-7.9-27-3.4-52.5-15.2-72.1-34.5-24-23.5-37.2-55.1-37.2-88.6 0-28 9.1-54.4 26.2-76.4 16.7-21.4 40.2-36.9 66.1-43.7l37.9-10 13.9-36.7c8.6-22.8 20.6-44.2 35.7-63.5 14.9-19.2 32.6-36 52.4-50 41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.3c19.9 14 37.5 30.8 52.4 50 15.1 19.3 27.1 40.7 35.7 63.5l13.8 36.6 37.8 10c54.2 14.4 92.1 63.7 92.1 120 0 33.6-13.2 65.1-37.2 88.6-19.5 19.2-44.9 31.1-71.9 34.5-4 .5-6.9 3.9-6.9 7.9V754c0 4.7 4.1 8.4 8.8 8 101.7-9.2 182.5-94 183.2-198.2.6-93.4-62.7-172.1-148.6-194.9z"}}]},name:"cloud-server",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="CloudServerOutlined";var L=tt.forwardRef(Z)},62298:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="CloudUploadOutlined";var L=tt.forwardRef(Z)},93695:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 256H736v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zm-200 0H360v-72h304v72z"}}]},name:"delete",theme:"filled"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="DeleteFilled";var L=tt.forwardRef(Z)},93181:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM288 604a64 64 0 10128 0 64 64 0 10-128 0zm118-224a48 48 0 1096 0 48 48 0 10-96 0zm158 228a96 96 0 10192 0 96 96 0 10-192 0zm148-314a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"dot-chart",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="DotChartOutlined";var L=tt.forwardRef(Z)},62876:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M855 160.1l-189.2 23.5c-6.6.8-9.3 8.8-4.7 13.5l54.7 54.7-153.5 153.5a8.03 8.03 0 000 11.3l45.1 45.1c3.1 3.1 8.2 3.1 11.3 0l153.6-153.6 54.7 54.7a7.94 7.94 0 0013.5-4.7L863.9 169a7.9 7.9 0 00-8.9-8.9zM416.6 562.3a8.03 8.03 0 00-11.3 0L251.8 715.9l-54.7-54.7a7.94 7.94 0 00-13.5 4.7L160.1 855c-.6 5.2 3.7 9.5 8.9 8.9l189.2-23.5c6.6-.8 9.3-8.8 4.7-13.5l-54.7-54.7 153.6-153.6c3.1-3.1 3.1-8.2 0-11.3l-45.2-45z"}}]},name:"expand-alt",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="ExpandAltOutlined";var L=tt.forwardRef(Z)},82738:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 100c-61.8 0-112 50.2-112 112 0 47.7 29.9 88.5 72 104.6v27.6L512 601.4 312 344.2v-27.6c42.1-16.1 72-56.9 72-104.6 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 50.6 33.8 93.5 80 107.3v34.4c0 9.7 3.3 19.3 9.3 27L476 672.3v33.6c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-33.6l226.7-291.6c6-7.7 9.3-17.3 9.3-27v-34.4c46.2-13.8 80-56.7 80-107.3 0-61.8-50.2-112-112-112zM224 212a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm336 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm192-552a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"fork",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="ForkOutlined";var L=tt.forwardRef(Z)},20015:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M955.7 856l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-790.4-23.9L512 231.9 858.7 832H165.3zm319-474.1l-228 394c-12.3 21.3 3.1 48 27.7 48h455.8c24.7 0 40.1-26.7 27.7-48L539.7 358c-6.2-10.7-17-16-27.7-16-10.8 0-21.6 5.3-27.7 16zm214 386H325.7L512 422l186.3 322zm-214-194.1l-57 98.4C415 669.5 430.4 696 455 696h114c24.6 0 39.9-26.5 27.7-47.7l-57-98.4c-6.1-10.6-16.9-15.9-27.7-15.9s-21.5 5.3-27.7 15.9zm57.1 98.4h-58.7l29.4-50.7 29.3 50.7z"}}]},name:"heat-map",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="HeatMapOutlined";var L=tt.forwardRef(Z)},41935:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.3 338.4a447.57 447.57 0 00-96.1-143.3 443.09 443.09 0 00-143-96.3A443.91 443.91 0 00512 64h-2c-60.5.3-119 12.3-174.1 35.9a444.08 444.08 0 00-141.7 96.5 445 445 0 00-95 142.8A449.89 449.89 0 0065 514.1c.3 69.4 16.9 138.3 47.9 199.9v152c0 25.4 20.6 46 45.9 46h151.8a447.72 447.72 0 00199.5 48h2.1c59.8 0 117.7-11.6 172.3-34.3A443.2 443.2 0 00827 830.5c41.2-40.9 73.6-88.7 96.3-142 23.5-55.2 35.5-113.9 35.8-174.5.2-60.9-11.6-120-34.8-175.6zM312.4 560c-26.4 0-47.9-21.5-47.9-48s21.5-48 47.9-48 47.9 21.5 47.9 48-21.4 48-47.9 48zm199.6 0c-26.4 0-47.9-21.5-47.9-48s21.5-48 47.9-48 47.9 21.5 47.9 48-21.5 48-47.9 48zm199.6 0c-26.4 0-47.9-21.5-47.9-48s21.5-48 47.9-48 47.9 21.5 47.9 48-21.5 48-47.9 48z"}}]},name:"message",theme:"filled"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="MessageFilled";var L=tt.forwardRef(Z)},75491:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="MessageOutlined";var L=tt.forwardRef(Z)},84387:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 708c-22.1 0-40-17.9-40-40s17.9-40 40-40 40 17.9 40 40-17.9 40-40 40zm62.9-219.5a48.3 48.3 0 00-30.9 44.8V620c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8v-21.5c0-23.1 6.7-45.9 19.9-64.9 12.9-18.6 30.9-32.8 52.1-40.9 34-13.1 56-41.6 56-72.7 0-44.1-43.1-80-96-80s-96 35.9-96 80v7.6c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V420c0-39.3 17.2-76 48.4-103.3C430.4 290.4 470 276 512 276s81.6 14.5 111.6 40.7C654.8 344 672 380.7 672 420c0 57.8-38.1 109.8-97.1 132.5z"}}]},name:"question-circle",theme:"filled"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="QuestionCircleFilled";var L=tt.forwardRef(Z)},55076:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 568a56 56 0 10112 0 56 56 0 10-112 0zm338.7 119.7c-23.1 18.2-68.9 37.8-114.7 37.8s-91.6-19.6-114.7-37.8c-14.4-11.3-35.3-8.9-46.7 5.5s-8.9 35.3 5.5 46.7C396.3 771.6 457.5 792 512 792s115.7-20.4 155.9-52.1a33.25 33.25 0 10-41.2-52.2zM960 456c0-61.9-50.1-112-112-112-42.1 0-78.7 23.2-97.9 57.6-57.6-31.5-127.7-51.8-204.1-56.5L612.9 195l127.9 36.9c11.5 32.6 42.6 56.1 79.2 56.1 46.4 0 84-37.6 84-84s-37.6-84-84-84c-32 0-59.8 17.9-74 44.2L603.5 123a33.2 33.2 0 00-39.6 18.4l-90.8 203.9c-74.5 5.2-142.9 25.4-199.2 56.2A111.94 111.94 0 00176 344c-61.9 0-112 50.1-112 112 0 45.8 27.5 85.1 66.8 102.5-7.1 21-10.8 43-10.8 65.5 0 154.6 175.5 280 392 280s392-125.4 392-280c0-22.6-3.8-44.5-10.8-65.5C932.5 541.1 960 501.8 960 456zM820 172.5a31.5 31.5 0 110 63 31.5 31.5 0 010-63zM120 456c0-30.9 25.1-56 56-56a56 56 0 0150.6 32.1c-29.3 22.2-53.5 47.8-71.5 75.9a56.23 56.23 0 01-35.1-52zm392 381.5c-179.8 0-325.5-95.6-325.5-213.5S332.2 410.5 512 410.5 837.5 506.1 837.5 624 691.8 837.5 512 837.5zM868.8 508c-17.9-28.1-42.2-53.7-71.5-75.9 9-18.9 28.3-32.1 50.6-32.1 30.9 0 56 25.1 56 56 .1 23.5-14.5 43.7-35.1 52zM624 568a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"reddit",theme:"outlined"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="RedditOutlined";var L=tt.forwardRef(Z)},90841:function(sr,it,$){"use strict";$.d(it,{Z:function(){return L}});var X=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512.5 390.6c-29.9 0-57.9 11.6-79.1 32.8-21.1 21.2-32.8 49.2-32.8 79.1 0 29.9 11.7 57.9 32.8 79.1 21.2 21.1 49.2 32.8 79.1 32.8 29.9 0 57.9-11.7 79.1-32.8 21.1-21.2 32.8-49.2 32.8-79.1 0-29.9-11.7-57.9-32.8-79.1a110.96 110.96 0 00-79.1-32.8zm412.3 235.5l-65.4-55.9c3.1-19 4.7-38.4 4.7-57.7s-1.6-38.8-4.7-57.7l65.4-55.9a32.03 32.03 0 009.3-35.2l-.9-2.6a442.5 442.5 0 00-79.6-137.7l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.2 28.9c-30-24.6-63.4-44-99.6-57.5l-15.7-84.9a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52-9.4-106.8-9.4-158.8 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.3a353.44 353.44 0 00-98.9 57.3l-81.8-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a445.93 445.93 0 00-79.6 137.7l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.2 56.5c-3.1 18.8-4.6 38-4.6 57 0 19.2 1.5 38.4 4.6 57l-66 56.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.3 44.8 96.8 79.6 137.7l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.8-29.1c29.8 24.5 63 43.9 98.9 57.3l15.8 85.3a32.05 32.05 0 0025.8 25.7l2.7.5a448.27 448.27 0 00158.8 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-84.9c36.2-13.6 69.6-32.9 99.6-57.5l81.2 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.5-87.4 79.6-137.7l.9-2.6c4.3-12.4.6-26.3-9.5-35zm-412.3 52.2c-97.1 0-175.8-78.7-175.8-175.8s78.7-175.8 175.8-175.8 175.8 78.7 175.8 175.8-78.7 175.8-175.8 175.8z"}}]},name:"setting",theme:"filled"},W=j,Q=$(27029),Z=function(C,M){return tt.createElement(Q.Z,(0,X.Z)((0,X.Z)({},C),{},{ref:M,icon:W}))};Z.displayName="SettingFilled";var L=tt.forwardRef(Z)},62238:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var $=function(j,W){var Q=j.nodes,Z=j.edges,L=[],P={};if(!Q)throw new Error("invalid nodes data!");return Q&&Q.forEach(function(C,M){P[C.id]=M;var k=[];L.push(k)}),Z&&Z.forEach(function(C){var M=C.source,k=C.target,B=P[M],R=P[k];!B&&B!==0||!R&&R!==0||(L[B][R]=1,W||(L[R][B]=1))}),L},X=$;it.default=X},10369:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),Object.defineProperty(it,"GADDIAsync",{enumerable:!0,get:function(){return X.GADDIAsync}}),Object.defineProperty(it,"connectedComponentAsync",{enumerable:!0,get:function(){return X.connectedComponentAsync}}),it.default=void 0,Object.defineProperty(it,"detectAllCyclesAsync",{enumerable:!0,get:function(){return X.detectAllCyclesAsync}}),Object.defineProperty(it,"detectAllDirectedCycleAsync",{enumerable:!0,get:function(){return X.detectAllDirectedCycleAsync}}),Object.defineProperty(it,"detectAllUndirectedCycleAsync",{enumerable:!0,get:function(){return X.detectAllUndirectedCycleAsync}}),Object.defineProperty(it,"detectCycleAsync",{enumerable:!0,get:function(){return X.detectCycleAsync}}),it.detectDirectedCycleAsync=void 0,Object.defineProperty(it,"dijkstraAsync",{enumerable:!0,get:function(){return X.dijkstraAsync}}),Object.defineProperty(it,"findAllPathAsync",{enumerable:!0,get:function(){return X.findAllPathAsync}}),Object.defineProperty(it,"findShortestPathAsync",{enumerable:!0,get:function(){return X.findShortestPathAsync}}),Object.defineProperty(it,"floydWarshallAsync",{enumerable:!0,get:function(){return X.floydWarshallAsync}}),Object.defineProperty(it,"getAdjMatrixAsync",{enumerable:!0,get:function(){return X.getAdjMatrixAsync}}),Object.defineProperty(it,"getDegreeAsync",{enumerable:!0,get:function(){return X.getDegreeAsync}}),Object.defineProperty(it,"getInDegreeAsync",{enumerable:!0,get:function(){return X.getInDegreeAsync}}),Object.defineProperty(it,"getNeighborsAsync",{enumerable:!0,get:function(){return X.getNeighborsAsync}}),Object.defineProperty(it,"getOutDegreeAsync",{enumerable:!0,get:function(){return X.getOutDegreeAsync}}),Object.defineProperty(it,"labelPropagationAsync",{enumerable:!0,get:function(){return X.labelPropagationAsync}}),Object.defineProperty(it,"louvainAsync",{enumerable:!0,get:function(){return X.louvainAsync}}),Object.defineProperty(it,"minimumSpanningTreeAsync",{enumerable:!0,get:function(){return X.minimumSpanningTreeAsync}}),Object.defineProperty(it,"pageRankAsync",{enumerable:!0,get:function(){return X.pageRankAsync}});var X=$(30485),tt=X.detectCycleAsync;it.detectDirectedCycleAsync=tt;var j={getAdjMatrixAsync:X.getAdjMatrixAsync,connectedComponentAsync:X.connectedComponentAsync,getDegreeAsync:X.getDegreeAsync,getInDegreeAsync:X.getInDegreeAsync,getOutDegreeAsync:X.getOutDegreeAsync,detectCycleAsync:X.detectCycleAsync,detectDirectedCycleAsync:tt,detectAllCyclesAsync:X.detectAllCyclesAsync,detectAllDirectedCycleAsync:X.detectAllDirectedCycleAsync,detectAllUndirectedCycleAsync:X.detectAllUndirectedCycleAsync,dijkstraAsync:X.dijkstraAsync,findAllPathAsync:X.findAllPathAsync,findShortestPathAsync:X.findShortestPathAsync,floydWarshallAsync:X.floydWarshallAsync,labelPropagationAsync:X.labelPropagationAsync,louvainAsync:X.louvainAsync,minimumSpanningTreeAsync:X.minimumSpanningTreeAsync,pageRankAsync:X.pageRankAsync,getNeighborsAsync:X.getNeighborsAsync,GADDIAsync:X.GADDIAsync};it.default=j},83764:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=j($(93026)),tt=$(70643);function j(L){return L&&L.__esModule?L:{default:L}}function W(L){L===void 0&&(L={});var P=L,C=function(){},M=function(){var k={};return function(B){var R=B.next,F=R;return k[F]?!1:(k[F]=!0,!0)}}();return P.allowTraversal=L.allowTraversal||M,P.enter=L.enter||C,P.leave=L.leave||C,P}var Q=function(P,C,M,k){k===void 0&&(k=!0);var B=W(M),R=new X.default,F=P.edges,K=F===void 0?[]:F;R.enqueue(C);for(var O="",_=function(){var mt=R.dequeue();B.enter({current:mt,previous:O}),(0,tt.getNeighbors)(mt,K,k?"target":void 0).forEach(function(st){B.allowTraversal({previous:O,current:mt,next:st})&&R.enqueue(st)}),B.leave({current:mt,previous:O}),O=mt};!R.isEmpty();)_()},Z=Q;it.default=Z},59527:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=W,it.detectStrongConnectComponents=it.detectConnectedComponents=void 0;var X=$(70643),tt=function(Z){for(var L=Z.nodes,P=L===void 0?[]:L,C=Z.edges,M=C===void 0?[]:C,k=[],B={},R=[],F=function ft(mt){R.push(mt),B[mt.id]=!0;for(var st=(0,X.getNeighbors)(mt.id,M),ut=function(wt){var ot=st[wt];if(!B[ot]){var pt=P.filter(function(Nt){return Nt.id===ot});pt.length>0&&ft(pt[0])}},dt=0;dt<st.length;++dt)ut(dt)},K=0;K<P.length;K++){var O=P[K];if(!B[O.id]){F(O);for(var _=[];R.length>0;)_.push(R.pop());k.push(_)}}return k};it.detectConnectedComponents=tt;var j=function(Z){for(var L=Z.nodes,P=L===void 0?[]:L,C=Z.edges,M=C===void 0?[]:C,k=[],B={},R={},F={},K=[],O=0,_=function ut(dt){R[dt.id]=O,F[dt.id]=O,O+=1,k.push(dt),B[dt.id]=!0;for(var gt=(0,X.getNeighbors)(dt.id,M,"target").filter(function(Gt){return P.map(function(se){return se.id}).indexOf(Gt)>-1}),wt=function(se){var ie=gt[se];if(!R[ie]&&R[ie]!==0){var Be=P.filter(function(ke){return ke.id===ie});Be.length>0&&ut(Be[0]),F[dt.id]=Math.min(F[dt.id],F[ie])}else B[ie]&&(F[dt.id]=Math.min(F[dt.id],R[ie]))},ot=0;ot<gt.length;ot++)wt(ot);if(F[dt.id]===R[dt.id]){for(var pt=[];k.length>0;){var Nt=k.pop();if(B[Nt.id]=!1,pt.push(Nt),Nt===dt)break}pt.length>0&&K.push(pt)}},ft=0,mt=P;ft<mt.length;ft++){var st=mt[ft];!R[st.id]&&R[st.id]!==0&&_(st)}return K};it.detectStrongConnectComponents=j;function W(Q,Z){return Z?j(Q):tt(Q)}},92935:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.secondReg=it.dateReg=void 0;var $=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/;it.secondReg=$;var X=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/;it.dateReg=X},82556:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.getOutDegree=it.getInDegree=it.default=void 0;var $=function(Q){var Z={},L=Q.nodes,P=L===void 0?[]:L,C=Q.edges,M=C===void 0?[]:C;return P.forEach(function(k){Z[k.id]={degree:0,inDegree:0,outDegree:0}}),M.forEach(function(k){Z[k.source].degree++,Z[k.source].outDegree++,Z[k.target].degree++,Z[k.target].inDegree++}),Z},X=$;it.default=X;var tt=function(Q,Z){var L=$(Q);return L[Z]?$(Q)[Z].inDegree:0};it.getInDegree=tt;var j=function(Q,Z){var L=$(Q);return L[Z]?$(Q)[Z].outDegree:0};it.getOutDegree=j},94282:function(sr,it,$){"use strict";function X(R){return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},X(R)}Object.defineProperty(it,"__esModule",{value:!0}),it.detectAllUndirectedCycle=it.detectAllDirectedCycle=it.detectAllCycles=it.default=void 0;var tt=L($(45891)),j=Z($(59527)),W=$(70643);function Q(R){if(typeof WeakMap!="function")return null;var F=new WeakMap,K=new WeakMap;return(Q=function(_){return _?K:F})(R)}function Z(R,F){if(!F&&R&&R.__esModule)return R;if(R===null||X(R)!=="object"&&typeof R!="function")return{default:R};var K=Q(F);if(K&&K.has(R))return K.get(R);var O={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ft in R)if(ft!=="default"&&Object.prototype.hasOwnProperty.call(R,ft)){var mt=_?Object.getOwnPropertyDescriptor(R,ft):null;mt&&(mt.get||mt.set)?Object.defineProperty(O,ft,mt):O[ft]=R[ft]}return O.default=R,K&&K.set(R,O),O}function L(R){return R&&R.__esModule?R:{default:R}}var P=function(F){var K=null,O=F.nodes,_=O===void 0?[]:O,ft={},mt={},st={},ut={};_.forEach(function(wt){mt[wt.id]=wt});for(var dt={enter:function(ot){var pt=ot.current,Nt=ot.previous;if(st[pt]){K={};for(var Gt=pt,se=Nt;se!==pt;)K[Gt]=se,Gt=se,se=ft[se];K[Gt]=se}else st[pt]=pt,delete mt[pt],ft[pt]=Nt},leave:function(ot){var pt=ot.current;ut[pt]=pt,delete st[pt]},allowTraversal:function(ot){var pt=ot.next;return K?!1:!ut[pt]}};Object.keys(mt).length;){var gt=Object.keys(mt)[0];(0,tt.default)(F,gt,dt)}return K},C=function(F,K,O){var _,ft;O===void 0&&(O=!0);for(var mt=[],st=(0,j.default)(F,!1),ut=0,dt=st;ut<dt.length;ut++){var gt=dt[ut];if(!!gt.length)for(var wt=gt[0],ot=wt.id,pt=[wt],Nt=(_={},_[ot]=wt,_),Gt=(ft={},ft[ot]=new Set,ft);pt.length>0;)for(var se=pt.pop(),ie=se.id,Be=(0,W.getNeighbors)(ie,F.edges),ke=function(Yt){var be,nn=Be[Yt],Ee=F.nodes.find(function(He){return He.id===nn});if(nn===ie)mt.push((be={},be[nn]=se,be));else if(!(nn in Gt))Nt[nn]=se,pt.push(Ee),Gt[nn]=new Set([se]);else if(!Gt[ie].has(Ee)){for(var le=!0,Le=[Ee,se],Ze=Nt[ie];Gt[nn].size&&!Gt[nn].has(Ze)&&(Le.push(Ze),Ze!==Nt[Ze.id]);)Ze=Nt[Ze.id];if(Le.push(Ze),K&&O?(le=!1,Le.findIndex(function(He){return K.indexOf(He.id)>-1})>-1&&(le=!0)):K&&!O&&Le.findIndex(function(He){return K.indexOf(He.id)>-1})>-1&&(le=!1),le){for(var fe={},Re=1;Re<Le.length;Re+=1)fe[Le[Re-1].id]=Le[Re];Le.length&&(fe[Le[Le.length-1].id]=Le[0]),mt.push(fe)}Gt[nn].add(se)}},we=0;we<Be.length;we+=1)ke(we)}return mt};it.detectAllUndirectedCycle=C;var M=function(F,K,O){O===void 0&&(O=!0);for(var _=[],ft=new Set,mt=[],st=[],ut={},dt={},gt=function(Ze){for(var fe=[Ze];fe.length>0;){var Re=fe.pop();ft.has(Re)&&(ft.delete(Re),mt[Re.id].forEach(function(He){fe.push(He)}),mt[Re.id].clear())}},wt=function Le(Ze,fe,Re){var He=!1;if(K&&O===!1&&K.indexOf(Ze.id)>-1)return He;_.push(Ze),ft.add(Ze);for(var pe=Re[Ze.id],Ge=0;Ge<pe.length;Ge+=1){var te=ut[pe[Ge]];if(te===fe){for(var Me={},We=1;We<_.length;We+=1)Me[_[We-1].id]=_[We];_.length&&(Me[_[_.length-1].id]=_[0]),st.push(Me),He=!0}else ft.has(te)||Le(te,fe,Re)&&(He=!0)}if(He)gt(Ze);else for(var Ge=0;Ge<pe.length;Ge+=1){var te=ut[pe[Ge]];mt[te.id].has(Ze)||mt[te.id].add(Ze)}return _.pop(),He},ot=F.nodes,pt=ot===void 0?[]:ot,Nt=0;Nt<pt.length;Nt+=1){var Gt=pt[Nt],se=Gt.id;dt[se]=Nt,ut[Nt]=Gt}if(K&&O)for(var ie=function(Ze){var fe=K[Ze];dt[pt[Ze].id]=dt[fe],dt[fe]=0,ut[0]=pt.find(function(Re){return Re.id===fe}),ut[dt[pt[Ze].id]]=pt[Ze]},Nt=0;Nt<K.length;Nt++)ie(Nt);for(var Be=function(Ze){for(var fe,Re,He=Infinity,pe=0;pe<Ze.length;pe+=1)for(var Ge=Ze[pe],te=0;te<Ge.length;te++){var Me=dt[Ge[te].id];Me<He&&(He=Me,Re=pe)}for(var We=Ze[Re],ee=[],pe=0;pe<We.length;pe+=1){var Pt=We[pe];ee[Pt.id]=[];for(var yt=0,Ne=(0,W.getNeighbors)(Pt.id,F.edges,"target").filter(function(Rt){return We.map(function(Yn){return Yn.id}).indexOf(Rt)>-1});yt<Ne.length;yt++){var tn=Ne[yt];tn===Pt.id&&!(O===!1&&K.indexOf(Pt.id)>-1)?st.push((fe={},fe[Pt.id]=Pt,fe)):ee[Pt.id].push(dt[tn])}}return{component:We,adjList:ee,minIdx:He}},ke=0;ke<pt.length;){var we=pt.filter(function(Le){return dt[Le.id]>=ke}),At=(0,j.detectStrongConnectComponents)({nodes:we,edges:F.edges}).filter(function(Le){return Le.length>1});if(At.length===0)break;var Yt=Be(At),be=Yt.minIdx,nn=Yt.adjList,Ee=Yt.component;if(Ee.length>1){Ee.forEach(function(Le){mt[Le.id]=new Set});var le=ut[be];if(K&&O&&K.indexOf(le.id)===-1)return st;wt(le,le,nn),ke=be+1}else break}return st};it.detectAllDirectedCycle=M;var k=function(F,K,O,_){return _===void 0&&(_=!0),K?M(F,O,_):C(F,O,_)};it.detectAllCycles=k;var B=P;it.default=B},45891:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=W;var X=$(70643);function tt(Q){Q===void 0&&(Q={});var Z=Q,L=function(){},P=function(){var C={};return function(M){var k=M.next;return C[k]?!1:(C[k]=!0,!0)}}();return Z.allowTraversal=Q.allowTraversal||P,Z.enter=Q.enter||L,Z.leave=Q.leave||L,Z}function j(Q,Z,L,P){P.enter({current:Z,previous:L});var C=Q.edges,M=C===void 0?[]:C;(0,X.getNeighbors)(Z,M,"target").forEach(function(k){P.allowTraversal({previous:L,current:Z,next:k})&&j(Q,k,Z,P)}),P.leave({current:Z,previous:L})}function W(Q,Z,L){j(Q,Z,"",tt(L))}},78089:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=$(65353),tt=$(23044),j=$(70643),W=function(C,M,k){for(var B=Infinity,R,F=0;F<M.length;F++){var K=M[F].id;!k[K]&&C[K]<=B&&(B=C[K],R=M[F])}return R},Q=function(C,M,k,B){var R=C.nodes,F=R===void 0?[]:R,K=C.edges,O=K===void 0?[]:K,_=[],ft={},mt={},st={};F.forEach(function(Nt,Gt){var se=Nt.id;_.push(se),mt[se]=Infinity,se===M&&(mt[se]=0)});for(var ut=F.length,dt=function(Gt){var se=W(mt,F,ft),ie=se.id;if(ft[ie]=!0,mt[ie]===Infinity)return"continue";var Be=[];k?Be=(0,j.getOutEdgesNodeId)(ie,O):Be=(0,j.getEdgesByNodeId)(ie,O),Be.forEach(function(ke){var we=ke.target,At=ke.source,Yt=we===ie?At:we,be=B&&ke[B]?ke[B]:1;mt[Yt]>mt[se.id]+be?(mt[Yt]=mt[se.id]+be,st[Yt]=[se.id]):mt[Yt]===mt[se.id]+be&&st[Yt].push(se.id)})},gt=0;gt<ut;gt++)dt(gt);st[M]=[M];var wt={};for(var ot in mt)mt[ot]!==Infinity&&L(M,ot,st,wt);var pt={};for(var ot in wt)pt[ot]=wt[ot][0];return{length:mt,path:pt,allPath:wt}},Z=Q;it.default=Z;function L(P,C,M,k){if(P===C)return[P];if(k[C])return k[C];for(var B=[],R=0,F=M[C];R<F.length;R++){var K=F[R],O=L(P,K,M,k);if(!O)return;for(var _=0,ft=O;_<ft.length;_++){var mt=ft[_];(0,tt.isArray)(mt)?B.push((0,X.__spreadArray)((0,X.__spreadArray)([],mt,!0),[C],!1)):B.push([mt,C])}}return k[C]=B,k[C]}},41727:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.findShortestPath=it.findAllPath=void 0;var X=j($(78089)),tt=$(70643);function j(Z){return Z&&Z.__esModule?Z:{default:Z}}var W=function(L,P,C,M,k){var B=(0,X.default)(L,P,M,k),R=B.length,F=B.path,K=B.allPath;return{length:R[C],path:F[C],allPath:K[C]}};it.findShortestPath=W;var Q=function(L,P,C,M){var k;if(P===C)return[[P]];var B=L.edges,R=B===void 0?[]:B,F=[P],K=(k={},k[P]=!0,k),O=[],_=[],ft=M?(0,tt.getNeighbors)(P,R,"target"):(0,tt.getNeighbors)(P,R);for(O.push(ft);F.length>0&&O.length>0;){var mt=O[O.length-1];if(mt.length){var st=mt.shift();st&&(F.push(st),K[st]=!0,ft=M?(0,tt.getNeighbors)(st,R,"target"):(0,tt.getNeighbors)(st,R),O.push(ft.filter(function(gt){return!K[gt]})))}else{var ut=F.pop();K[ut]=!1,O.pop();continue}if(F[F.length-1]===C){var dt=F.map(function(wt){return wt});_.push(dt);var ut=F.pop();K[ut]=!1,O.pop()}}return _};it.findAllPath=Q},75033:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=tt($(62238));function tt(Q){return Q&&Q.__esModule?Q:{default:Q}}var j=function(Z,L){for(var P=(0,X.default)(Z,L),C=[],M=P.length,k=0;k<M;k+=1){C[k]=[];for(var B=0;B<M;B+=1)k===B?C[k][B]=0:P[k][B]===0||!P[k][B]?C[k][B]=Infinity:C[k][B]=P[k][B]}for(var R=0;R<M;R+=1)for(var k=0;k<M;k+=1)for(var B=0;B<M;B+=1)C[k][B]>C[k][R]+C[R][B]&&(C[k][B]=C[k][R]+C[R][B]);return C},W=j;it.default=W},21146:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=$(23044),tt=$(68575),j=function(){function B(R,F,K,O,_){this.fromNode=R,this.toNode=F,this.nodeEdgeNodeLabel={nodeLabel1:K||tt.VACANT_NODE_LABEL,edgeLabel:O||tt.VACANT_EDGE_LABEL,nodeLabel2:_||tt.VACANT_NODE_LABEL}}return B.prototype.equalTo=function(R){return this.fromNode===R.formNode&&this.toNode===R.toNode&&this.nodeEdgeNodeLabel===R.nodeEdgeNodeLabel},B.prototype.notEqualTo=function(R){return!this.equalTo(R)},B}(),W=function(){function B(){this.rmpath=[],this.dfsEdgeList=[]}return B.prototype.equalTo=function(R){var F=this.dfsEdgeList.length,K=R.length;if(F!==K)return!1;for(var O=0;O<F;O++)if(this.dfsEdgeList[O]!==R[O])return!1;return!0},B.prototype.notEqualTo=function(R){return!this.equalTo(R)},B.prototype.pushBack=function(R,F,K,O,_){return this.dfsEdgeList.push(new j(R,F,K,O,_)),this.dfsEdgeList},B.prototype.toGraph=function(R,F){R===void 0&&(R=tt.VACANT_GRAPH_ID),F===void 0&&(F=!1);var K=new tt.Graph(R,!0,F);return this.dfsEdgeList.forEach(function(O){var _=O.fromNode,ft=O.toNode,mt=O.nodeEdgeNodeLabel,st=mt.nodeLabel1,ut=mt.edgeLabel,dt=mt.nodeLabel2;st!==tt.VACANT_NODE_LABEL&&K.addNode(_,st),dt!==tt.VACANT_NODE_LABEL&&K.addNode(ft,dt),st!==tt.VACANT_NODE_LABEL&&dt!==st&&K.addEdge(void 0,_,ft,ut)}),K},B.prototype.buildRmpath=function(){this.rmpath=[];for(var R=void 0,F=this.dfsEdgeList.length,K=F-1;K>=0;K--){var O=this.dfsEdgeList[K],_=O.fromNode,ft=O.toNode;_<ft&&(R===void 0||ft===R)&&(this.rmpath.push(K),R=_)}return this.rmpath},B.prototype.getNodeNum=function(){var R={};return this.dfsEdgeList.forEach(function(F){R[F.fromNode]||(R[F.fromNode]=!0),R[F.toNode]||(R[F.toNode]=!0)}),Object.keys(R).length},B}(),Q=function(){function B(R){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],!!R){for(;R;){var F=R.edge;this.edges.push(F),this.nodesUsed[F.from]=1,this.nodesUsed[F.to]=1,this.edgesUsed[F.id]=1,R=R.preNode}this.edges=this.edges.reverse()}}return B.prototype.hasNode=function(R){return this.nodesUsed[R.id]===1},B.prototype.hasEdge=function(R){return this.edgesUsed[R.id]===1},B}(),Z=function(){function B(R){var F=R.graphs,K=R.minSupport,O=K===void 0?2:K,_=R.minNodeNum,ft=_===void 0?1:_,mt=R.maxNodeNum,st=mt===void 0?4:mt,ut=R.top,dt=ut===void 0?10:ut,gt=R.directed,wt=gt===void 0?!1:gt,ot=R.verbose,pt=ot===void 0?!1:ot;this.graphs=F,this.dfsCode=new W,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=O,this.top=dt,this.directed=wt,this.counter=0,this.maxNodeNum=st,this.minNodeNum=ft,this.verbose=pt,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return B.prototype.findForwardRootEdges=function(R,F){var K=this,O=[],_=R.nodeMap;return F.edges.forEach(function(ft){(K.directed||F.label<=_[ft.to].label)&&O.push(ft)}),O},B.prototype.findBackwardEdge=function(R,F,K,O){if(!this.directed&&F===K)return null;for(var _=R.nodeMap,ft=_[K.to],mt=ft.edges,st=mt.length,ut=0;ut<st;ut++){var dt=mt[ut];if(!(O.hasEdge(dt)||dt.to!==F.from)){if(this.directed){if(_[F.from].label<_[K.to].label||_[F.from].label===_[K.to].label&&F.label<=dt.label)return dt}else if(F.label<dt.label||F.label===dt.label&&_[F.to].label<=_[K.to].label)return dt}}return null},B.prototype.findForwardPureEdges=function(R,F,K,O){for(var _=[],ft=F.to,mt=R.nodeMap[ft].edges,st=mt.length,ut=0;ut<st;ut++){var dt=mt[ut],gt=R.nodeMap[dt.to];K<=gt.label&&!O.hasNode(gt)&&_.push(dt)}return _},B.prototype.findForwardRmpathEdges=function(R,F,K,O){for(var _=[],ft=R.nodeMap,mt=ft[F.to].label,st=ft[F.from],ut=st.edges,dt=ut.length,gt=0;gt<dt;gt++){var wt=ut[gt],ot=ft[wt.to].label;F.to===wt.to||K>ot||O.hasNode(ft[wt.to])||(F.label<wt.label||F.label===wt.label&&mt<=ot)&&_.push(wt)}return _},B.prototype.getSupport=function(R){var F={};return R.forEach(function(K){F[K.graphId]||(F[K.graphId]=!0)}),Object.keys(F).length},B.prototype.findMinLabel=function(R){var F=void 0;return Object.keys(R).forEach(function(K){var O=R[K],_=O.nodeLabel1,ft=O.edgeLabel,mt=O.nodeLabel2;if(!F){F={nodeLabel1:_,edgeLabel:ft,nodeLabel2:mt};return}(_<F.nodeLabel1||_===F.nodeLabel1&&ft<F.edgeLabel||_===F.nodeLabel1&&ft===F.edgeLabel&&mt<F.nodeLabel2)&&(F={nodeLabel1:_,edgeLabel:ft,nodeLabel2:mt})}),F},B.prototype.isMin=function(){var R=this,F=this.dfsCode;if(this.verbose&&console.log("isMin checking",F),F.dfsEdgeList.length===1)return!0;var K=this.directed,O=F.toGraph(tt.VACANT_GRAPH_ID,K),_=O.nodeMap,ft=new W,mt={};O.nodes.forEach(function(gt){var wt=R.findForwardRootEdges(O,gt);wt.forEach(function(ot){var pt=_[ot.to],Nt="".concat(gt.label,"-").concat(ot.label,"-").concat(pt.label);mt[Nt]||(mt[Nt]={projected:[],nodeLabel1:gt.label,edgeLabel:ot.label,nodeLabel2:pt.label});var Gt={graphId:O.id,edge:ot,preNode:null};mt[Nt].projected.push(Gt)})});var st=this.findMinLabel(mt);if(!!st){ft.dfsEdgeList.push(new j(0,1,st.nodeLabel1,st.edgeLabel,st.nodeLabel2));var ut=function gt(wt){for(var ot=ft.buildRmpath(),pt=ft.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,Nt=ft.dfsEdgeList[ot[0]].toNode,Gt={},se=!1,ie=0,Be=K?-1:0,ke=function(pe){if(se)return"break";wt.forEach(function(Ge){var te=new Q(Ge),Me=R.findBackwardEdge(O,te.edges[ot[pe]],te.edges[ot[0]],te);Me&&(Gt[Me.label]||(Gt[Me.label]={projected:[],edgeLabel:Me.label}),Gt[Me.label].projected.push({graphId:O.id,edge:Gt,preNode:Ge}),ie=ft.dfsEdgeList[ot[pe]].fromNode,se=!0)})},we=ot.length-1;we>Be;we--){var At=ke(we);if(At==="break")break}if(se){var Yt=R.findMinLabel(Gt);ft.dfsEdgeList.push(new j(Nt,ie,tt.VACANT_NODE_LABEL,Yt.edgeLabel,tt.VACANT_NODE_LABEL));var be=ft.dfsEdgeList.length-1;return R.dfsCode.dfsEdgeList[be]!==ft.dfsEdgeList[be]?!1:gt(Gt[Yt.edgeLabel].projected)}var nn={};se=!1;var Ee=0;wt.forEach(function(He){var pe=new Q(He),Ge=R.findForwardPureEdges(O,pe.edges[ot[0]],pt,pe);Ge.length>0&&(se=!0,Ee=Nt,Ge.forEach(function(te){var Me="".concat(te.label,"-").concat(_[te.to].label);nn[Me]||(nn[Me]={projected:[],edgeLabel:te.label,nodeLabel2:_[te.to].label}),nn[Me].projected.push({graphId:O.id,edge:te,preNode:He})}))});for(var le=ot.length,Le=function(pe){if(se)return"break";var Ge=ot[pe];wt.forEach(function(te){var Me=new Q(te),We=R.findForwardRmpathEdges(O,Me.edges[Ge],pt,Me);We.length>0&&(se=!0,Ee=ft.dfsEdgeList[Ge].fromNode,We.forEach(function(ee){var Pt="".concat(ee.label,"-").concat(_[ee.to].label);nn[Pt]||(nn[Pt]={projected:[],edgeLabel:ee.label,nodeLabel2:_[ee.to].label}),nn[Pt].projected.push({graphId:O.id,edge:ee,preNode:te})}))})},we=0;we<le;we++){var Ze=Le(we);if(Ze==="break")break}if(!se)return!0;var fe=R.findMinLabel(nn);ft.dfsEdgeList.push(new j(Ee,Nt+1,tt.VACANT_NODE_LABEL,fe.edgeLabel,fe.nodeLabel2));var Re=ft.dfsEdgeList.length-1;return F.dfsEdgeList[Re]!==ft.dfsEdgeList[Re]?!1:gt(nn["".concat(fe.edgeLabel,"-").concat(fe.nodeLabel2)].projected)},dt="".concat(st.nodeLabel1,"-").concat(st.edgeLabel,"-").concat(st.nodeLabel2);return ut(mt[dt].projected)}},B.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var R=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push((0,X.clone)(R))}},B.prototype.subGraphMining=function(R){var F=this,K=this.getSupport(R);if(!(K<this.minSupport)&&!!this.isMin()){this.report();var O=this.dfsCode.getNodeNum(),_=this.dfsCode.buildRmpath(),ft=this.dfsCode.dfsEdgeList[_[0]].toNode,mt=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,st={},ut={};R.forEach(function(dt){for(var gt=F.graphs[dt.graphId],wt=gt.nodeMap,ot=new Q(dt),pt=_.length-1;pt>=0;pt--){var Nt=F.findBackwardEdge(gt,ot.edges[_[pt]],ot.edges[_[0]],ot);if(Nt){var Gt="".concat(F.dfsCode.dfsEdgeList[_[pt]].fromNode,"-").concat(Nt.label);ut[Gt]||(ut[Gt]={projected:[],toNodeId:F.dfsCode.dfsEdgeList[_[pt]].fromNode,edgeLabel:Nt.label}),ut[Gt].projected.push({graphId:dt.graphId,edge:Nt,preNode:dt})}}if(!(O>=F.maxNodeNum)){var se=F.findForwardPureEdges(gt,ot.edges[_[0]],mt,ot);se.forEach(function(Be){var ke="".concat(ft,"-").concat(Be.label,"-").concat(wt[Be.to].label);st[ke]||(st[ke]={projected:[],fromNodeId:ft,edgeLabel:Be.label,nodeLabel2:wt[Be.to].label}),st[ke].projected.push({graphId:dt.graphId,edge:Be,preNode:dt})});for(var ie=function(ke){var we=F.findForwardRmpathEdges(gt,ot.edges[_[ke]],mt,ot);we.forEach(function(At){var Yt="".concat(F.dfsCode.dfsEdgeList[_[ke]].fromNode,"-").concat(At.label,"-").concat(wt[At.to].label);st[Yt]||(st[Yt]={projected:[],fromNodeId:F.dfsCode.dfsEdgeList[_[ke]].fromNode,edgeLabel:At.label,nodeLabel2:wt[At.to].label}),st[Yt].projected.push({graphId:dt.graphId,edge:At,preNode:dt})})},pt=0;pt<_.length;pt++)ie(pt)}}),Object.keys(ut).forEach(function(dt){var gt=ut[dt],wt=gt.toNodeId,ot=gt.edgeLabel;F.dfsCode.dfsEdgeList.push(new j(ft,wt,"-1",ot,"-1")),F.subGraphMining(ut[dt].projected),F.dfsCode.dfsEdgeList.pop()}),Object.keys(st).forEach(function(dt){var gt=st[dt],wt=gt.fromNodeId,ot=gt.edgeLabel,pt=gt.nodeLabel2;F.dfsCode.dfsEdgeList.push(new j(wt,ft+1,tt.VACANT_NODE_LABEL,ot,pt)),F.subGraphMining(st[dt].projected),F.dfsCode.dfsEdgeList.pop()})}},B.prototype.generate1EdgeFrequentSubGraphs=function(){var R=this.graphs,F=this.directed,K=this.minSupport,O=this.frequentSize1Subgraphs,_={},ft={},mt={},st={};return Object.keys(R).forEach(function(ut){var dt=R[ut],gt=dt.nodeMap;dt.nodes.forEach(function(wt,ot){var pt=wt.label,Nt="".concat(ut,"-").concat(pt);if(!mt[Nt]){var Gt=_[pt]||0;Gt++,_[pt]=Gt}mt[Nt]={graphKey:ut,label:pt},wt.edges.forEach(function(se){var ie=pt,Be=gt[se.to].label;if(!F&&ie>Be){var ke=Be;Be=ie,ie=ke}var we=se.label,At="".concat(ut,"-").concat(ie,"-").concat(we,"-").concat(Be),Yt="".concat(ie,"-").concat(we,"-").concat(Be);if(!ft[Yt]){var be=ft[Yt]||0;be++,ft[Yt]=be}st[At]={graphId:ut,nodeLabel1:ie,edgeLabel:we,nodeLabel2:Be}})})}),Object.keys(_).forEach(function(ut){var dt=_[ut];if(!(dt<K)){var gt={nodes:[],edges:[]};gt.nodes.push({id:"0",label:ut}),O.push(gt)}}),O},B.prototype.run=function(){var R=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var F=this.graphs,K=this.directed,O={};Object.keys(F).forEach(function(_){var ft=F[_],mt=ft.nodeMap;ft.nodes.forEach(function(st){var ut=R.findForwardRootEdges(ft,st);ut.forEach(function(dt){var gt=mt[dt.to],wt="".concat(st.label,"-").concat(dt.label,"-").concat(gt.label);O[wt]||(O[wt]={projected:[],nodeLabel1:st.label,edgeLabel:dt.label,nodeLabel2:gt.label});var ot={graphId:_,edge:dt,preNode:null};O[wt].projected.push(ot)})})}),Object.keys(O).forEach(function(_){var ft=O[_],mt=ft.projected,st=ft.nodeLabel1,ut=ft.edgeLabel,dt=ft.nodeLabel2;R.dfsCode.dfsEdgeList.push(new j(0,1,st,ut,dt)),R.subGraphMining(mt),R.dfsCode.dfsEdgeList.pop()})}},B}(),L=function(R,F,K,O){var _={};return Object.keys(R).forEach(function(ft,mt){var st=R[ft],ut=new tt.Graph(mt,!0,F),dt={};st.nodes.forEach(function(gt,wt){ut.addNode(wt,gt[K]),dt[gt.id]=wt}),st.edges.forEach(function(gt,wt){var ot=dt[gt.source],pt=dt[gt.target];ut.addEdge(-1,ot,pt,gt[O])}),ut&&ut.getNodeNum()&&(_[ut.id]=ut)}),_},P=function(R,F,K){var O=[];return R.forEach(function(_){var ft={nodes:[],edges:[]};_.nodes.forEach(function(mt){var st;ft.nodes.push((st={id:"".concat(mt.id)},st[F]=mt.label,st))}),_.edges.forEach(function(mt){var st;ft.edges.push((st={source:"".concat(mt.from),target:"".concat(mt.to)},st[K]=mt.label,st))}),O.push(ft)}),O},C="cluster",M=function(R){var F=R.graphs,K=R.directed,O=K===void 0?!1:K,_=R.nodeLabelProp,ft=_===void 0?C:_,mt=R.edgeLabelProp,st=mt===void 0?C:mt,ut=L(F,O,ft,st),dt=R.minSupport,gt=R.maxNodeNum,wt=R.minNodeNum,ot=R.verbose,pt=R.top,Nt={graphs:ut,minSupport:dt,maxNodeNum:gt,minNodeNum:wt,top:pt,verbose:ot,directed:O},Gt=new Z(Nt);Gt.run();var se=P(Gt.frequentSubgraphs,ft,st);return se},k=M;it.default=k},68575:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.VACANT_NODE_LABEL=it.VACANT_NODE_ID=it.VACANT_GRAPH_ID=it.VACANT_EDGE_LABEL=it.VACANT_EDGE_ID=it.Node=it.Graph=it.Edge=it.AUTO_EDGE_ID=void 0;var $=-1;it.VACANT_EDGE_ID=$;var X=-1;it.VACANT_NODE_ID=X;var tt="-1";it.VACANT_EDGE_LABEL=tt;var j="-1";it.VACANT_NODE_LABEL=j;var W=-1;it.VACANT_GRAPH_ID=W;var Q="-1";it.AUTO_EDGE_ID=Q;var Z=function(){function C(M,k,B,R){M===void 0&&(M=$),k===void 0&&(k=X),B===void 0&&(B=X),R===void 0&&(R=tt),this.id=M,this.from=k,this.to=B,this.label=R}return C}();it.Edge=Z;var L=function(){function C(M,k){M===void 0&&(M=X),k===void 0&&(k=j),this.id=M,this.label=k,this.edges=[],this.edgeMap={}}return C.prototype.addEdge=function(M){this.edges.push(M),this.edgeMap[M.id]=M},C}();it.Node=L;var P=function(){function C(M,k,B){M===void 0&&(M=X),k===void 0&&(k=!0),B===void 0&&(B=!1),this.id=M,this.edgeIdAutoIncrease=k,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=B}return C.prototype.getNodeNum=function(){return this.nodes.length},C.prototype.addNode=function(M,k){if(!this.nodeMap[M]){var B=new L(M,k);this.nodes.push(B),this.nodeMap[M]=B,this.nodeLabelMap[k]||(this.nodeLabelMap[k]=[]),this.nodeLabelMap[k].push(M)}},C.prototype.addEdge=function(M,k,B,R){if((this.edgeIdAutoIncrease||M===void 0)&&(M=this.counter++),!(this.nodeMap[k]&&this.nodeMap[B]&&this.nodeMap[B].edgeMap[M])){var F=new Z(M,k,B,R);if(this.edges.push(F),this.edgeMap[M]=F,this.nodeMap[k].addEdge(F),this.edgeLabelMap[R]||(this.edgeLabelMap[R]=[]),this.edgeLabelMap[R].push(F),!this.directed){var K=new Z(M,B,k,R);this.nodeMap[B].addEdge(K),this.edgeLabelMap[R].push(K)}}},C}();it.Graph=P},82812:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=$(65353),tt=Z($(75033)),j=Z($(21146)),W=Z($(78089)),Q=$(70643);function Z(st){return st&&st.__esModule?st:{default:st}}var L=function(ut,dt,gt,wt){gt===void 0&&(gt="cluster"),wt===void 0&&(wt=2);var ot=[],pt=ut.nodes;return dt.forEach(function(Nt,Gt){ot.push(P(pt,Nt,Gt,gt,wt))}),ot},P=function(ut,dt,gt,wt,ot){var pt=[gt],Nt=[],Gt={};return dt.forEach(function(se,ie){if(se<=ot&&gt!==ie){pt.push(ie),Nt.push(ut[ie]);var Be=ut[ie][wt];Gt[Be]?(Gt[Be].count++,Gt[Be].dists.push(se)):Gt[Be]={count:1,dists:[se]}}}),Object.keys(Gt).forEach(function(se){Gt[se].dists=Gt[se].dists.sort(function(ie,Be){return ie-Be})}),{nodeIdx:gt,nodeId:ut[gt].id,nodeIdxs:pt,neighbors:Nt,neighborNum:pt.length-1,nodeLabelCountMap:Gt}},C=function(ut,dt,gt,wt,ot){var pt=Math.ceil(gt/dt),Nt={},Gt=0;return wt.forEach(function(se,ie){for(var Be=0,ke=0,we=se.nodeIdxs,At=se.neighborNum-1;Be<pt;){for(var Yt=we[1+Math.floor(Math.random()*At)],be=0;(Nt["".concat(ie,"-").concat(Yt)]||Nt["".concat(Yt,"-").concat(ie)])&&(Yt=Math.floor(Math.random()*dt),be++,!(be>2*dt)););if(be<2*dt&&(Nt["".concat(ie,"-").concat(Yt)]={start:ie,end:Yt,distance:ot[ie][Yt]},Be++,Gt++,Gt>=gt))return Nt;if(ke++,ke>2*dt)break}if(Be<pt){var nn=pt-Be;pt=(pt+nn)/(dt-ie-1)}}),Nt},M=function(ut,dt,gt,wt){var ot=gt.nodes;return wt||(wt={}),Object.keys(ut).forEach(function(pt){var Nt,Gt;if(!(wt&&wt[pt])){wt[pt]={nodes:[],edges:[]};var se=ut[pt],ie=(Nt=dt[se.start])===null||Nt===void 0?void 0:Nt.nodeIdxs,Be=(Gt=dt[se.end])===null||Gt===void 0?void 0:Gt.nodeIdxs;if(!(!ie||!Be)){var ke=new Set(Be),we=ie.filter(function(Ee){return ke.has(Ee)});if(!(!we||!we.length)){for(var At={},Yt=we.length,be=0;be<Yt;be++){var nn=ot[we[be]];wt[pt].nodes.push(nn),At[nn.id]=!0}gt.edges.forEach(function(Ee){At[Ee.source]&&At[Ee.target]&&wt[pt].edges.push(Ee)})}}}}),wt},k=function(ut,dt,gt,wt){var ot,pt,Nt={};ut.nodes.forEach(function(se){Nt[se.id]=se});var Gt=0;return!((ot=dt==null?void 0:dt.edges)===null||ot===void 0?void 0:ot.length)||((pt=dt==null?void 0:dt.nodes)===null||pt===void 0?void 0:pt.length)<2?0:(ut.edges.forEach(function(se){var ie=Nt[se.source][gt],Be=Nt[se.target][gt],ke=dt==null?void 0:dt.nodes[0][gt],we=dt==null?void 0:dt.nodes[1][gt],At=dt==null?void 0:dt.edges[0][wt];se[wt]===At&&(ie===ke&&Be===we||ie===we&&Be===ke)&&Gt++}),Gt)},B=function(ut,dt,gt){for(var wt=Infinity,ot=0,pt=function(se){var ie=ut[se],Be=Object.keys(ie).sort(function(Ee,le){return ie[Ee]-ie[le]}),ke=10,we=[];Be.forEach(function(Ee,le){we[le%ke]||(we[le%ke]={graphs:[],totalCount:0,aveCount:0}),we[le%ke].graphs.push(Ee),we[le%ke].totalCount+=ie[Ee]});var At=0,Yt=[];we.forEach(function(Ee){var le=Ee.totalCount/Ee.graphs.length;Ee.aveCount=le,Yt.push(le);var Le=0,Ze=Ee.length;Ee.graphs.forEach(function(fe,Re){var He=ie[fe];Ee.graphs.forEach(function(pe,Ge){Re!==Ge&&(Le+=Math.abs(He-ie[pe]))})}),Le/=Ze*(Ze-1)/2,At+=Le}),At/=we.length;var be=0;Yt.forEach(function(Ee,le){Yt.forEach(function(Le,Ze){le!==Ze&&(be+=Math.abs(Ee-Le))}),be/=Yt.length*(Yt.length-1)/2});var nn=be-At;wt<nn&&(wt=nn,ot=se)},Nt=0;Nt<dt;Nt++)pt(Nt);return{structure:gt[ot],structureCountMap:ut[ot]}},R=function(ut,dt){var gt={},wt={};return ut.forEach(function(ot,pt){gt[ot.id]={idx:pt,node:ot,degree:0,inDegree:0,outDegree:0};var Nt=ot[dt];wt[Nt]||(wt[Nt]=[]),wt[Nt].push(ot)}),{nodeMap:gt,nodeLabelMap:wt}},F=function(ut,dt,gt){var wt={},ot={};return ut.forEach(function(pt,Nt){wt["".concat(Q.uniqueId)]={idx:Nt,edge:pt};var Gt=pt[dt];ot[Gt]||(ot[Gt]=[]),ot[Gt].push(pt);var se=gt[pt.source];se&&(se.degree++,se.outDegree++);var ie=gt[pt.target];ie&&(ie.degree++,ie.inDegree++)}),{edgeMap:wt,edgeLabelMap:ot}},K=function(ut,dt,gt){var wt=dt.length,ot={};return dt.forEach(function(pt,Nt){for(var Gt=gt?0:Nt+1,se=ut[Nt].id,ie=Gt;ie<wt;ie++)if(Nt!==ie){var Be=ut[ie].id,ke=pt[ie];ot["".concat(se,"-").concat(Be)]=ke,gt||(ot["".concat(Be,"-").concat(se)]=ke)}}),ot},O=function(ut,dt,gt,wt,ot,pt,Nt,Gt,se,ie,Be){var ke,we="".concat(dt.id,"-").concat(gt.id);if(ie&&ie[we])return ie[we];var At=Be?Be[we]:void 0;if(!At){var Yt=(ke={},ke[we]={start:wt[dt.id].idx,end:wt[gt.id].idx,distance:ot},ke);Be=M(Yt,pt,ut,Be),At=Be[we]}return k(At,Nt,Gt,se)},_=function(ut,dt,gt,wt){var ot,pt,Nt,Gt=(ot=ut[dt])===null||ot===void 0?void 0:ot.degree,se=(pt=ut[dt])===null||pt===void 0?void 0:pt.inDegree,ie=(Nt=ut[dt])===null||Nt===void 0?void 0:Nt.outDegree;return ut[dt]===void 0&&(Gt=Infinity,se=Infinity,ie=Infinity,wt[dt].forEach(function(Be){var ke=gt[Be.id].degree;Gt>ke&&(Gt=ke);var we=gt[Be.id].inDegree;se>we&&(se=we);var At=gt[Be.id].outDegree;ie>At&&(ie=At)}),ut[dt]={degree:Gt,inDegree:se,outDegree:ie}),{minPatternNodeLabelDegree:Gt,minPatternNodeLabelInDegree:se,minPatternNodeLabelOutDegree:ie}},ft=function(ut,dt,gt,wt,ot,pt,Nt){var Gt;if(gt===void 0&&(gt=!1),pt===void 0&&(pt="cluster"),Nt===void 0&&(Nt="cluster"),!(!ut||!ut.nodes)){var se=ut.nodes.length;if(!!se){var ie=(0,tt.default)(ut,gt),Be=(0,tt.default)(dt,gt),ke=K(ut.nodes,ie,gt),we=K(dt.nodes,Be,gt),At=R(ut.nodes,pt),Yt=At.nodeMap,be=At.nodeLabelMap,nn=R(dt.nodes,pt),Ee=nn.nodeMap,le=nn.nodeLabelMap;F(ut.edges,Nt,Yt);var Le=F(dt.edges,Nt,Ee).edgeLabelMap,Ze=[];Be==null||Be.forEach(function(vr){Ze=Ze.concat(vr)}),ot||(ot=Math.max.apply(Math,(0,X.__spreadArray)((0,X.__spreadArray)([],Ze,!1),[2],!1))),wt||(wt=ot);var fe=L(ut,ie,pt,wt),Re=L(dt,Be,pt,wt),He=Math.min(100,se*(se-1)/2),pe=C(wt,se,He,fe,ie),Ge=M(pe,fe,ut),te=10,Me=1,We=1,ee=4,Pt={graphs:Ge,nodeLabelProp:pt,edgeLabelProp:Nt,minSupport:Me,minNodeNum:We,maxNodeNum:ee,directed:gt},yt=(0,j.default)(Pt).slice(0,te),Ne=yt.length,tn=[];yt.forEach(function(vr,Tr){tn[Tr]={},Object.keys(Ge).forEach(function(ta){var ra=Ge[ta],Zr=k(ra,vr,pt,Nt);tn[Tr][ta]=Zr})});var fn=B(tn,Ne,yt),Rt=fn.structure,Yn=fn.structureCountMap,Un=dt.nodes[0],xr=[],cr=(Gt=dt.nodes[0])===null||Gt===void 0?void 0:Gt[pt],Ur=-Infinity;dt.nodes.forEach(function(vr){var Tr=vr[pt],ta=be[Tr];(ta==null?void 0:ta.length)>Ur&&(Ur=ta.length,xr=ta,cr=Tr,Un=vr)});var fa={},Sa={},sa={},Da={},Rr={},Mn={};Object.keys(le).forEach(function(vr,Tr){Rr[vr]=[],gt&&(Mn[vr]=[]);var ta=-Infinity,ra=le[vr],Zr={};ra.forEach(function(kt){var at=we["".concat(Un.id,"-").concat(kt.id)];if(at&&Rr[vr].push(at),ta<at&&(ta=at),Zr["".concat(Un.id,"-").concat(kt.id)]={start:0,end:Ee[kt.id].idx,distance:at},gt){var H=we["".concat(kt.id,"-").concat(Un.id)];H&&Mn[vr].push(H)}}),Rr[vr]=Rr[vr].sort(function(kt,at){return kt-at}),gt&&(Mn[vr]=Mn[vr].sort(function(kt,at){return kt-at})),Sa=M(Zr,Re,dt,Sa);var vt=[];if(Object.keys(Zr).forEach(function(kt){if(sa[kt]){vt.push(sa[kt]);return}var at=Sa[kt];sa[kt]=k(at,Rt,pt,Nt),vt.push(sa[kt])}),vt=vt.sort(function(kt,at){return at-kt}),Da["".concat(Un.id,"-").concat(vr)]=vt,vr!==cr)for(var _n=(xr==null?void 0:xr.length)||0,an=function(at){var H=xr[at],Y=fe[Yt[H.id].idx],bt=Y.nodeLabelCountMap[vr],$t=le[vr].length;if(!bt||bt.count<$t)return xr.splice(at,1),"continue";for(var jt=!1,Ht=0;Ht<$t;Ht++)if(bt.dists[Ht]>Rr[vr][Ht]){jt=!0;break}if(jt)return xr.splice(at,1),"continue";var re={};Y.neighbors.forEach(function(Ve){var qn=ke["".concat(H.id,"-").concat(Ve.id)];re["".concat(H.id,"-").concat(Ve.id)]={start:Yt[H.id].idx,end:Yt[Ve.id].idx,distance:qn}}),Ge=M(re,fe,ut,Ge);var on=[];Object.keys(re).forEach(function(Ve){if(Yn[Ve]){on.push(Yn[Ve]);return}var qn=Ge[Ve];Yn[Ve]=k(qn,Rt,pt,Nt),on.push(Yn[Ve])}),on=on.sort(function(Ve,qn){return qn-Ve});for(var Je=!1,Ht=0;Ht<$t;Ht++)if(on[Ht]<vt[Ht]){Je=!0;break}if(Je)return xr.splice(at,1),"continue"},Lt=_n-1;Lt>=0;Lt--)an(Lt)});var ar=[];xr==null||xr.forEach(function(vr){for(var Tr=Yt[vr.id].idx,ta=P(ut.nodes,ie[Tr],Tr,pt,ot),ra=ta.neighbors,Zr=ra.length,vt=!1,_n=Zr-1;_n>=0;_n--){if(ra.length+1<dt.nodes.length){vt=!0;return}var an=ra[_n],Lt=an[pt];if(!le[Lt]||!le[Lt].length){ra.splice(_n,1);continue}if(!Rr[Lt]||!Rr[Lt].length){ra.splice(_n,1);continue}var kt="".concat(vr.id,"-").concat(an.id),at=ke[kt],H=Rr[Lt].length-1,Y=Rr[Lt][H];if(at>Y){ra.splice(_n,1);continue}if(gt){var bt="".concat(an.id,"-").concat(vr.id),$t=ke[bt];H=Mn[Lt].length-1;var jt=Mn[Lt][H];if($t>jt){ra.splice(_n,1);continue}}var Ht=Yn[kt]?Yn[kt]:O(ut,vr,an,Yt,at,fe,Rt,pt,Nt,Yn,Ge),re="".concat(Un.id,"-").concat(Lt),on=Da[re][Da[re].length-1];if(Ht<on){ra.splice(_n,1);continue}var Je=_(fa,Lt,Ee,le),Ve=Je.minPatternNodeLabelDegree,qn=Je.minPatternNodeLabelInDegree,Ln=Je.minPatternNodeLabelOutDegree;if(Yt[an.id].degree<Ve){ra.splice(_n,1);continue}}vt||ar.push({nodes:[vr].concat(ra)})});var Fn=(0,W.default)(dt,Un.id,!1).length,tr={};gt?(Object.keys(Fn).forEach(function(vr){var Tr=Ee[vr].node[pt];tr[Tr]?tr[Tr].push(Fn[vr]):tr[Tr]=[Fn[vr]]}),Object.keys(tr).forEach(function(vr){tr[vr].sort(function(Tr,ta){return Tr-ta})})):tr=Rr;for(var Gn=ar.length,jr=function(Tr){var ta=ar[Tr],ra=ta.nodes[0],Zr={},vt={};ta.nodes.forEach(function(Pa,un){vt[Pa.id]={idx:un,node:Pa,degree:0,inDegree:0,outDegree:0};var Oe=Pa[pt];Zr[Oe]?Zr[Oe]++:Zr[Oe]=1});var _n=[],an={};ut.edges.forEach(function(Pa){vt[Pa.source]&&vt[Pa.target]&&(_n.push(Pa),an[Pa[Nt]]?an[Pa[Nt]]++:an[Pa[Nt]]=1,vt[Pa.source].degree++,vt[Pa.target].degree++,vt[Pa.source].outDegree++,vt[Pa.target].inDegree++)});for(var Lt=Object.keys(Le).length,kt=!1,at=0;at<Lt;at++){var H=Object.keys(Le)[at];if(!an[H]||an[H]<Le[H].length){kt=!0;break}}if(kt)return ar.splice(Tr,1),"continue";var Y=_n.length;if(Y<dt.edges.length)return ar.splice(Tr,1),"break";for(var bt=!1,$t=function(un){var Oe=_n[un],hn=Oe[Nt],Hn=Le[hn];if(!Hn||!Hn.length)return an[hn]--,Hn&&an[hn]<Hn.length?(bt=!0,"break"):(_n.splice(un,1),vt[Oe.source].degree--,vt[Oe.target].degree--,vt[Oe.source].outDegree--,vt[Oe.target].inDegree--,"continue");var Bn=vt[Oe.source].node[pt],Jn=vt[Oe.target].node[pt],Lr=!1;if(Hn.forEach(function(ya){var Fa=Ee[ya.source].node,ui=Ee[ya.target].node;Fa[pt]===Bn&&ui[pt]===Jn&&(Lr=!0),!gt&&Fa[pt]===Jn&&ui[pt]===Bn&&(Lr=!0)}),!Lr)return an[hn]--,Hn&&an[hn]<Hn.length?(bt=!0,"break"):(_n.splice(un,1),vt[Oe.source].degree--,vt[Oe.target].degree--,vt[Oe.source].outDegree--,vt[Oe.target].inDegree--,"continue")},at=Y-1;at>=0;at--){var jt=$t(at);if(jt==="break")break}if(bt)return ar.splice(Tr,1),"continue";ta.edges=_n;var Ht=(0,W.default)(ta,ta.nodes[0].id,!1).length;if(Object.keys(Ht).reverse().forEach(function(Pa){if(!(Pa===ta.nodes[0].id||bt)){if(Ht[Pa]===Infinity){var un=vt[Pa].node[pt];if(Zr[un]--,Zr[un]<le[un].length){bt=!0;return}var Oe=ta.nodes.indexOf(vt[Pa].node);ta.nodes.splice(Oe,1),vt[Pa]=void 0;return}var hn=Yt[Pa].node[pt];if(!tr[hn]||!tr[hn].length||Ht[Pa]>tr[hn][tr[hn].length-1]){var un=vt[Pa].node[pt];if(Zr[un]--,Zr[un]<le[un].length){bt=!0;return}var Oe=ta.nodes.indexOf(vt[Pa].node);ta.nodes.splice(Oe,1),vt[Pa]=void 0}}}),bt)return ar.splice(Tr,1),"continue";for(var re=!0,on=0;re&&!bt;){re=!1;var Je=gt?vt[ra.id].degree<Ee[Un.id].degree||vt[ra.id].inDegree<Ee[Un.id].inDegree||vt[ra.id].outDegree<Ee[Un.id].outDegree:vt[ra.id].degree<Ee[Un.id].degree;if(Je){bt=!0;break}if(Zr[ra[pt]]<le[ra[pt]].length){bt=!0;break}for(var Ve=ta.nodes.length,qn=Ve-1;qn>=0;qn--){var Ln=ta.nodes[qn],qr=vt[Ln.id].degree,Ca=vt[Ln.id].inDegree,Qn=vt[Ln.id].outDegree,_r=Ln[pt],ea=_(fa,_r,Ee,le),La=ea.minPatternNodeLabelDegree,ha=ea.minPatternNodeLabelInDegree,_i=ea.minPatternNodeLabelOutDegree,Ni=gt?qr<La||Ca<ha||Qn<_i:qr<La;if(Ni){if(Zr[Ln[pt]]--,Zr[Ln[pt]]<le[Ln[pt]].length){bt=!0;break}ta.nodes.splice(qn,1),vt[Ln.id]=void 0,re=!0}}if(bt||!re&&on!==0)break;Y=_n.length;for(var vi=Y-1;vi>=0;vi--){var si=_n[vi];if(!vt[si.source]||!vt[si.target]){_n.splice(vi,1);var Mi=si[Nt];if(an[Mi]--,vt[si.source]&&(vt[si.source].degree--,vt[si.source].outDegree--),vt[si.target]&&(vt[si.target].degree--,vt[si.target].inDegree--),Le[Mi]&&an[Mi]<Le[Mi].length){bt=!0;break}re=!0}}on++}if(bt||bt||ta.nodes.length<dt.nodes.length||_n.length<dt.edges.length)return ar.splice(Tr,1),"continue"},Hr=Gn-1;Hr>=0;Hr--){var Ea=jr(Hr);if(Ea==="break")break}for(var lr=ar.length,Cr=function(Tr){var ta=ar[Tr],ra={};ta.edges.forEach(function(_n){var an="".concat(_n.source,"-").concat(_n.target,"-").concat(_n.label);ra[an]?ra[an]++:ra[an]=1});for(var Zr=function(an){var Lt=ar[an],kt={};Lt.edges.forEach(function(H){var Y="".concat(H.source,"-").concat(H.target,"-").concat(H.label);kt[Y]?kt[Y]++:kt[Y]=1});var at=!0;Object.keys(kt).length!==Object.keys(ra).length?at=!1:Object.keys(ra).forEach(function(H){kt[H]!==ra[H]&&(at=!1)}),at&&ar.splice(an,1)},vt=lr-1;vt>Tr;vt--)Zr(vt);lr=ar.length},Hr=0;Hr<=lr-1;Hr++)Cr(Hr);return ar}}},mt=ft;it.default=mt},5170:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=j($(62238)),tt=$(70643);function j(Z){return Z&&Z.__esModule?Z:{default:Z}}var W=function(L,P,C,M){P===void 0&&(P=!1),C===void 0&&(C="weight"),M===void 0&&(M=1e3);var k=L.nodes,B=k===void 0?[]:k,R=L.edges,F=R===void 0?[]:R,K={},O={};B.forEach(function(pt,Nt){var Gt=(0,tt.uniqueId)();pt.clusterId=Gt,K[Gt]={id:Gt,nodes:[pt]},O[pt.id]={node:pt,idx:Nt}});var _=(0,X.default)(L,P),ft=[],mt={};_.forEach(function(pt,Nt){var Gt=0,se=B[Nt].id;mt[se]={},pt.forEach(function(ie,Be){if(!!ie){Gt+=ie;var ke=B[Be].id;mt[se][ke]=ie}}),ft.push(Gt)});for(var st=0,ut=function(){var Nt=!1;if(B.forEach(function(Gt){var se={};Object.keys(mt[Gt.id]).forEach(function(nn){var Ee=mt[Gt.id][nn],le=O[nn].node,Le=le.clusterId;se[Le]||(se[Le]=0),se[Le]+=Ee});var ie=-Infinity,Be=[];if(Object.keys(se).forEach(function(nn){ie<se[nn]?(ie=se[nn],Be=[nn]):ie===se[nn]&&Be.push(nn)}),!(Be.length===1&&Be[0]===Gt.clusterId)){var ke=Be.indexOf(Gt.clusterId);if(ke>=0&&Be.splice(ke,1),Be&&Be.length){Nt=!0;var we=K[Gt.clusterId],At=we.nodes.indexOf(Gt);we.nodes.splice(At,1);var Yt=Math.floor(Math.random()*Be.length),be=K[Be[Yt]];be.nodes.push(Gt),Gt.clusterId=be.id}}}),!Nt)return"break";st++};st<M;){var dt=ut();if(dt==="break")break}Object.keys(K).forEach(function(pt){var Nt=K[pt];(!Nt.nodes||!Nt.nodes.length)&&delete K[pt]});var gt=[],wt={};F.forEach(function(pt){var Nt=pt.source,Gt=pt.target,se=pt[C]||1,ie=O[Nt].node.clusterId,Be=O[Gt].node.clusterId,ke="".concat(ie,"---").concat(Be);if(wt[ke])wt[ke].weight+=se,wt[ke].count++;else{var we={source:ie,target:Be,weight:se,count:1};wt[ke]=we,gt.push(we)}});var ot=[];return Object.keys(K).forEach(function(pt){ot.push(K[pt])}),{clusters:ot,clusterEdges:gt}},Q=W;it.default=Q},57363:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=$(23044),tt=Z($(62238)),j=Z($(29741)),W=$(3665),Q=$(26838);function Z(k){return k&&k.__esModule?k:{default:k}}var L=function(B,R,F,K){for(var O=R.length,_=2*K,ft=0,mt=0;mt<O;mt++)for(var st=B[mt].clusterId,ut=0;ut<O;ut++){var dt=B[ut].clusterId;if(st===dt){var gt=R[mt][ut]||0,wt=F[mt]||0,ot=F[ut]||0;ft+=gt-wt*ot/_}}return ft*=1/_,ft},P=function(B,R){B===void 0&&(B=[]);for(var F=B.length,K=new j.default([]),O=0;O<F;O++)K=K.add(new j.default(R[O]));var _=K.avg(F);_.normalize();for(var ft=0,O=0;O<F;O++){var mt=new j.default(R[O]),st=mt.squareEuclideanDistance(_);ft+=st}var ut=[];B.forEach(function(){ut.push([])});for(var O=0;O<F;O++){var mt=new j.default(R[O]);B[O].clusterInertial=0;for(var dt=0;dt<F;dt++){if(O===dt){ut[O][dt]=0;continue}var gt=new j.default(R[dt]);ut[O][dt]=mt.squareEuclideanDistance(gt),B[O].clusterInertial+=ut[O][dt]}}for(var wt=0,ot=2*F*ft,O=0;O<F;O++)for(var pt=B[O].clusterId,dt=0;dt<F;dt++){var Nt=B[dt].clusterId;if(!(O===dt||pt!==Nt)){var Gt=B[O].clusterInertial*B[dt].clusterInertial/Math.pow(ot,2)-ut[O][dt]/ot;wt+=Gt}}return Number(wt.toFixed(4))},C=function(B,R,F,K,O,_,ft,mt,st){R===void 0&&(R=!1),F===void 0&&(F="weight"),K===void 0&&(K=1e-4),O===void 0&&(O=!1),_===void 0&&(_=void 0),ft===void 0&&(ft=[]),mt===void 0&&(mt=["id"]),st===void 0&&(st=1);var ut=B.nodes,dt=ut===void 0?[]:ut,gt=B.edges,wt=gt===void 0?[]:gt,ot=[];if(O){dt.forEach(function(Ge,te){Ge.properties=Ge.properties||{},Ge.originIndex=te});var pt=[];dt.every(function(Ge){return Ge.hasOwnProperty("nodeType")})&&(pt=Array.from(new Set(dt.map(function(Ge){return Ge.nodeType}))),dt.forEach(function(Ge){Ge.properties.nodeType=pt.findIndex(function(te){return te===Ge.nodeType})}));var Nt=(0,W.getAllProperties)(dt,_);ot=(0,Q.oneHot)(Nt,ft,mt)}var Gt=1,se={},ie={};dt.forEach(function(Ge,te){var Me=String(Gt++);Ge.clusterId=Me,se[Me]={id:Me,nodes:[Ge]},ie[Ge.id]={node:Ge,idx:te}});var Be=(0,tt.default)(B,R),ke=[],we={},At=0;Be.forEach(function(Ge,te){var Me=0,We=dt[te].id;we[We]={},Ge.forEach(function(ee,Pt){if(!!ee){Me+=ee;var yt=dt[Pt].id;we[We][yt]=ee,At+=ee}}),ke.push(Me)}),At/=2;for(var Yt=Infinity,be=Infinity,nn=0,Ee=[],le={};;){O&&dt.every(function(Ge){return Ge.hasOwnProperty("properties")})?Yt=L(dt,Be,ke,At)+P(dt,ot)*st:Yt=L(dt,Be,ke,At),nn===0&&(be=Yt,Ee=dt,le=se);var Le=Yt>0&&Yt>be&&Yt-be<K;if(Yt>be&&(Ee=dt.map(function(Ge){return{node:Ge,clusterId:Ge.clusterId}}),le=(0,X.clone)(se),be=Yt),Le||nn>100)break;nn++,Object.keys(se).forEach(function(Ge){var te=0;wt.forEach(function(Me){var We=Me.source,ee=Me.target,Pt=ie[We].node.clusterId,yt=ie[ee].node.clusterId;(Pt===Ge&&yt!==Ge||yt===Ge&&Pt!==Ge)&&(te=te+(Me[F]||1))}),se[Ge].sumTot=te}),dt.forEach(function(Ge,te){var Me=se[Ge.clusterId],We=0,ee,Pt=ke[te]/(2*At),yt=0,Ne=Me.nodes;Ne.forEach(function(Sa){var sa=ie[Sa.id].idx;yt+=Be[te][sa]||0});var tn=yt-Me.sumTot*Pt,fn=Ne.filter(function(Sa){return Sa.id!==Ge.id}),Rt=[];fn.forEach(function(Sa,sa){Rt[sa]=ot[Sa.originIndex]});var Yn=P(fn,ot)*st,Un=we[Ge.id];if(Object.keys(Un).forEach(function(Sa){var sa=ie[Sa].node,Da=sa.clusterId;if(Da!==Ge.clusterId){var Rr=se[Da],Mn=Rr.nodes;if(!(!Mn||!Mn.length)){var ar=0;Mn.forEach(function(Ea){var lr=ie[Ea.id].idx;ar+=Be[te][lr]||0});var Fn=ar-Rr.sumTot*Pt,tr=Mn.concat([Ge]),Gn=[];tr.forEach(function(Ea,lr){Gn[lr]=ot[Ea.originIndex]});var jr=P(tr,ot)*st,Hr=Fn-tn;O&&(Hr=Fn+jr-(tn+Yn)),Hr>We&&(We=Hr,ee=Rr)}}}),We>0){ee.nodes.push(Ge);var xr=Ge.clusterId;Ge.clusterId=ee.id;var cr=Me.nodes.indexOf(Ge);Me.nodes.splice(cr,1);var Ur=0,fa=0;wt.forEach(function(Sa){var sa=Sa.source,Da=Sa.target,Rr=ie[sa].node.clusterId,Mn=ie[Da].node.clusterId;(Rr===ee.id&&Mn!==ee.id||Mn===ee.id&&Rr!==ee.id)&&(Ur=Ur+(Sa[F]||1)),(Rr===xr&&Mn!==xr||Mn===xr&&Rr!==xr)&&(fa=fa+(Sa[F]||1))}),ee.sumTot=Ur,Me.sumTot=fa}})}var Ze={},fe=0;Object.keys(le).forEach(function(Ge){var te=le[Ge];if(!te.nodes||!te.nodes.length){delete le[Ge];return}var Me=String(fe+1);Me!==Ge&&(te.id=Me,te.nodes=te.nodes.map(function(We){return{id:We.id,clusterId:Me}}),le[Me]=te,Ze[Ge]=Me,delete le[Ge],fe++)}),Ee.forEach(function(Ge){var te=Ge.node,Me=Ge.clusterId;!te||(te.clusterId=Me,te.clusterId&&Ze[te.clusterId]&&(te.clusterId=Ze[te.clusterId]))});var Re=[],He={};wt.forEach(function(Ge){var te=Ge.source,Me=Ge.target,We=Ge[F]||1,ee=ie[te].node.clusterId,Pt=ie[Me].node.clusterId;if(!(!ee||!Pt)){var yt="".concat(ee,"---").concat(Pt);if(He[yt])He[yt].weight+=We,He[yt].count++;else{var Ne={source:ee,target:Pt,weight:We,count:1};He[yt]=Ne,Re.push(Ne)}}});var pe=[];return Object.keys(le).forEach(function(Ge){pe.push(le[Ge])}),{clusters:pe,clusterEdges:Re}},M=C;it.default=M},89454:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=W($(38823)),tt=W($(57085)),j=$(70643);function W(C){return C&&C.__esModule?C:{default:C}}var Q=function(M,k){var B=[],R=M.nodes,F=R===void 0?[]:R,K=M.edges,O=K===void 0?[]:K;if(F.length===0)return B;var _=F[0],ft=new Set;ft.add(_);var mt=function(ot,pt){return k?ot.weight-pt.weight:0},st=new tt.default(mt);for((0,j.getEdgesByNodeId)(_.id,O).forEach(function(wt){st.insert(wt)});!st.isEmpty();){var ut=st.delMin(),dt=ut.source,gt=ut.target;ft.has(dt)&&ft.has(gt)||(B.push(ut),ft.has(dt)||(ft.add(dt),(0,j.getEdgesByNodeId)(dt,O).forEach(function(wt){st.insert(wt)})),ft.has(gt)||(ft.add(gt),(0,j.getEdgesByNodeId)(gt,O).forEach(function(wt){st.insert(wt)})))}return B},Z=function(M,k){var B=[],R=M.nodes,F=R===void 0?[]:R,K=M.edges,O=K===void 0?[]:K;if(F.length===0)return B;var _=O.map(function(dt){return dt});k&&_.sort(function(dt,gt){return dt.weight-gt.weight});for(var ft=new X.default(F.map(function(dt){return dt.id}));_.length>0;){var mt=_.shift(),st=mt.source,ut=mt.target;ft.connected(st,ut)||(B.push(mt),ft.union(st,ut))}return B},L=function(M,k,B){var R={prim:Q,kruskal:Z};return B?R[B](M,k):Z(M,k)},P=L;it.default=P},74926:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=j($(82556)),tt=$(70643);function j(Z){return Z&&Z.__esModule?Z:{default:Z}}var W=function(L,P,C){typeof P!="number"&&(P=1e-6),typeof C!="number"&&(C=.85);for(var M=1,k=0,B=1e3,R=L.nodes,F=R===void 0?[]:R,K=L.edges,O=K===void 0?[]:K,_=F.length,ft,mt={},st={},ut=0;ut<_;++ut){var dt=F[ut],gt=dt.id;mt[gt]=1/_,st[gt]=1/_}for(var wt=(0,X.default)(L);B>0&&M>P;){k=0;for(var ut=0;ut<_;++ut){var dt=F[ut],gt=dt.id;if(ft=0,wt[dt.id].inDegree===0)mt[gt]=0;else{for(var ot=(0,tt.getNeighbors)(gt,O,"source"),pt=0;pt<ot.length;++pt){var Nt=ot[pt],Gt=wt[Nt].outDegree;Gt>0&&(ft+=st[Nt]/Gt)}mt[gt]=C*ft,k+=mt[gt]}}k=(1-k)/_,M=0;for(var ut=0;ut<_;++ut){var dt=F[ut],gt=dt.id;ft=mt[gt]+k,M+=Math.abs(ft-st[gt]),st[gt]=ft}B-=1}return st},Q=W;it.default=Q},57085:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var $=function(W,Q){return W-Q},X=function(){function j(W){W===void 0&&(W=$),this.compareFn=W,this.list=[]}return j.prototype.getLeft=function(W){return 2*W+1},j.prototype.getRight=function(W){return 2*W+2},j.prototype.getParent=function(W){return W===0?null:Math.floor((W-1)/2)},j.prototype.isEmpty=function(){return this.list.length<=0},j.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},j.prototype.delMin=function(){var W=this.top(),Q=this.list.pop();return this.list.length>0&&(this.list[0]=Q,this.moveDown(0)),W},j.prototype.insert=function(W){if(W!==null){this.list.push(W);var Q=this.list.length-1;return this.moveUp(Q),!0}return!1},j.prototype.moveUp=function(W){for(var Q=this.getParent(W);W&&W>0&&this.compareFn(this.list[Q],this.list[W])>0;){var Z=this.list[Q];this.list[Q]=this.list[W],this.list[W]=Z,W=Q,Q=this.getParent(W)}},j.prototype.moveDown=function(W){var Q,Z=W,L=this.getLeft(W),P=this.getRight(W),C=this.list.length;L!==null&&L<C&&this.compareFn(this.list[Z],this.list[L])>0?Z=L:P!==null&&P<C&&this.compareFn(this.list[Z],this.list[P])>0&&(Z=P),W!==Z&&(Q=[this.list[Z],this.list[W]],this.list[W]=Q[0],this.list[Z]=Q[1],this.moveDown(Z))},j}(),tt=X;it.default=tt},88481:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=it.LinkedListNode=void 0;var $=function(Q,Z){return Q===Z},X=function(){function W(Q,Z){Z===void 0&&(Z=null),this.value=Q,this.next=Z}return W.prototype.toString=function(Q){return Q?Q(this.value):"".concat(this.value)},W}();it.LinkedListNode=X;var tt=function(){function W(Q){Q===void 0&&(Q=$),this.head=null,this.tail=null,this.compare=Q}return W.prototype.prepend=function(Q){var Z=new X(Q,this.head);return this.head=Z,this.tail||(this.tail=Z),this},W.prototype.append=function(Q){var Z=new X(Q);return this.head?(this.tail.next=Z,this.tail=Z,this):(this.head=Z,this.tail=Z,this)},W.prototype.delete=function(Q){if(!this.head)return null;for(var Z=null;this.head&&this.compare(this.head.value,Q);)Z=this.head,this.head=this.head.next;var L=this.head;if(L!==null)for(;L.next;)this.compare(L.next.value,Q)?(Z=L.next,L.next=L.next.next):L=L.next;return this.compare(this.tail.value,Q)&&(this.tail=L),Z},W.prototype.find=function(Q){var Z=Q.value,L=Z===void 0?void 0:Z,P=Q.callback,C=P===void 0?void 0:P;if(!this.head)return null;for(var M=this.head;M;){if(C&&C(M.value)||L!==void 0&&this.compare(M.value,L))return M;M=M.next}return null},W.prototype.deleteTail=function(){var Q=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,Q;for(var Z=this.head;Z.next;)Z.next.next?Z=Z.next:Z.next=null;return this.tail=Z,Q},W.prototype.deleteHead=function(){if(!this.head)return null;var Q=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),Q},W.prototype.fromArray=function(Q){var Z=this;return Q.forEach(function(L){return Z.append(L)}),this},W.prototype.toArray=function(){for(var Q=[],Z=this.head;Z;)Q.push(Z),Z=Z.next;return Q},W.prototype.reverse=function(){for(var Q=this.head,Z=null,L=null;Q;)L=Q.next,Q.next=Z,Z=Q,Q=L;this.tail=this.head,this.head=Z},W.prototype.toString=function(Q){return Q===void 0&&(Q=void 0),this.toArray().map(function(Z){return Z.toString(Q)}).toString()},W}(),j=tt;it.default=j},93026:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=tt($(88481));function tt(Q){return Q&&Q.__esModule?Q:{default:Q}}var j=function(){function Q(){this.linkedList=new X.default}return Q.prototype.isEmpty=function(){return!this.linkedList.head},Q.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},Q.prototype.enqueue=function(Z){this.linkedList.append(Z)},Q.prototype.dequeue=function(){var Z=this.linkedList.deleteHead();return Z?Z.value:null},Q.prototype.toString=function(Z){return this.linkedList.toString(Z)},Q}(),W=j;it.default=W},38823:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var $=function(){function tt(j){this.count=j.length,this.parent={};for(var W=0,Q=j;W<Q.length;W++){var Z=Q[W];this.parent[Z]=Z}}return tt.prototype.find=function(j){for(;this.parent[j]!==j;)j=this.parent[j];return j},tt.prototype.union=function(j,W){var Q=this.find(j),Z=this.find(W);Q!==Z&&(Q<Z?(this.parent[W]!==W&&this.union(this.parent[W],j),this.parent[W]=this.parent[j]):(this.parent[j]!==j&&this.union(this.parent[j],W),this.parent[j]=this.parent[W]))},tt.prototype.connected=function(j,W){return this.find(j)===this.find(W)},tt}(),X=$;it.default=X},17892:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.DistanceType=void 0;var $;it.DistanceType=$,function(X){X.EuclideanDistance="euclideanDistance"}($||(it.DistanceType=$={}))},70643:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.uniqueId=it.getOutEdgesNodeId=it.getNeighbors=it.getEdgesByNodeId=void 0;var $=function(Q,Z,L){Z===void 0&&(Z=[]);var P=Z.filter(function(B){return B.source===Q||B.target===Q});if(L==="target"){var C=function(R){return R.source===Q};return P.filter(C).map(function(B){return B.target})}if(L==="source"){var M=function(R){return R.target===Q};return P.filter(M).map(function(B){return B.source})}var k=function(R){return R.source===Q?R.target:R.source};return P.map(k)};it.getNeighbors=$;var X=function(Q,Z){return Z.filter(function(L){return L.source===Q})};it.getOutEdgesNodeId=X;var tt=function(Q,Z){return Z.filter(function(L){return L.source===Q||L.target===Q})};it.getEdgesByNodeId=tt;var j=function(Q){Q===void 0&&(Q=0);var Z="".concat(Math.random()).split(".")[1].substr(0,5),L="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(Q,"-").concat(Z).concat(L)};it.uniqueId=j},26838:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.oneHot=it.getDistance=it.getAllKeyValueMap=it.default=void 0;var X=$(23044),tt=$(17892),j=W($(29741));function W(C){return C&&C.__esModule?C:{default:C}}var Q=function(M,k,B){var R=[];(k==null?void 0:k.length)?R=k:(M.forEach(function(K){R=R.concat(Object.keys(K))}),R=(0,X.uniq)(R));var F={};return R.forEach(function(K){var O=[];M.forEach(function(_){_[K]!==void 0&&_[K]!==""&&O.push(_[K])}),O.length&&!(B==null?void 0:B.includes(K))&&(F[K]=(0,X.uniq)(O))}),F};it.getAllKeyValueMap=Q;var Z=function(M,k,B){var R=Q(M,k,B),F=[];if(!Object.keys(R).length)return F;var K=Object.values(R),O=K.every(function(_){return _.every(function(ft){return typeof ft=="number"})});return M.forEach(function(_,ft){var mt=[];Object.keys(R).forEach(function(st){var ut=_[st],dt=R[st],gt=dt.findIndex(function(pt){return ut===pt}),wt=[];if(O)wt.push(ut);else for(var ot=0;ot<dt.length;ot++)ot===gt?wt.push(1):wt.push(0);mt=mt.concat(wt)}),F[ft]=mt}),F};it.oneHot=Z;var L=function(M,k,B,R){B===void 0&&(B=tt.DistanceType.EuclideanDistance);var F=0;switch(B){case tt.DistanceType.EuclideanDistance:F=new j.default(M).euclideanDistance(new j.default(k));break;default:break}return F};it.getDistance=L;var P={getAllKeyValueMap:Q,oneHot:Z,getDistance:L};it.default=P},3665:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.getPropertyWeight=it.getAllSortProperties=it.getAllProperties=it.default=void 0;var X=$(92935),tt=function(P,C){P===void 0&&(P=[]),C===void 0&&(C=100);var M={};P.forEach(function(B){!B.properties||Object.keys(B.properties).forEach(function(R){if(R==="id"||!"".concat(B.properties[R]).match(X.secondReg)&&!"".concat(B.properties[R]).match(X.dateReg)&&isNaN(Number(B.properties[R]))){M.hasOwnProperty(R)&&delete M[R];return}M.hasOwnProperty(R)?M[R]+=1:M[R]=1})});var k=Object.keys(M).sort(function(B,R){return M[R]-M[B]});return k.length<C?k:k.slice(0,C)};it.getAllSortProperties=tt;var j=function(P,C){return C.map(function(M){return P.hasOwnProperty(M)?P[M]:0})},W=function(P){for(var C=tt(P),M=[],k=0;k<P.length;k++)M[k]=j(P[k].properties,C);return M};it.getPropertyWeight=W;var Q=function(P,C){C===void 0&&(C=void 0);var M=[];return P.forEach(function(k){C===void 0&&M.push(k),k[C]!==void 0&&M.push(k[C])}),M};it.getAllProperties=Q;var Z={getAllSortProperties:tt,getPropertyWeight:W,getAllProperties:Q};it.default=Z},29741:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=$(23044),tt=function(){function W(Q){this.arr=Q}return W.prototype.getArr=function(){return this.arr||[]},W.prototype.add=function(Q){var Z,L=Q.arr;if(!((Z=this.arr)===null||Z===void 0?void 0:Z.length))return new W(L);if(!(L==null?void 0:L.length))return new W(this.arr);if(this.arr.length===L.length){var P=[];for(var C in this.arr)P[C]=this.arr[C]+L[C];return new W(P)}},W.prototype.subtract=function(Q){var Z,L=Q.arr;if(!((Z=this.arr)===null||Z===void 0?void 0:Z.length))return new W(L);if(!(L==null?void 0:L.length))return new W(this.arr);if(this.arr.length===L.length){var P=[];for(var C in this.arr)P[C]=this.arr[C]-L[C];return new W(P)}},W.prototype.avg=function(Q){var Z=[];if(Q!==0)for(var L in this.arr)Z[L]=this.arr[L]/Q;return new W(Z)},W.prototype.negate=function(){var Q=[];for(var Z in this.arr)Q[Z]=-this.arr[Z];return new W(Q)},W.prototype.squareEuclideanDistance=function(Q){var Z,L=Q.arr;if(!((Z=this.arr)===null||Z===void 0?void 0:Z.length)||!(L==null?void 0:L.length))return 0;if(this.arr.length===L.length){var P=0;for(var C in this.arr)P+=Math.pow(this.arr[C]-Q.arr[C],2);return P}},W.prototype.euclideanDistance=function(Q){var Z,L=Q.arr;if(!((Z=this.arr)===null||Z===void 0?void 0:Z.length)||!(L==null?void 0:L.length))return 0;if(this.arr.length===L.length){var P=0;for(var C in this.arr)P+=Math.pow(this.arr[C]-Q.arr[C],2);return Math.sqrt(P)}else console.error("The two vectors are unequal in length.")},W.prototype.normalize=function(){var Q=[],Z=(0,X.clone)(this.arr);Z.sort(function(M,k){return M-k});var L=Z[Z.length-1],P=Z[0];for(var C in this.arr)Q[C]=(this.arr[C]-P)/(L-P);return new W(Q)},W.prototype.norm2=function(){var Q;if(!((Q=this.arr)===null||Q===void 0?void 0:Q.length))return 0;var Z=0;for(var L in this.arr)Z+=Math.pow(this.arr[L],2);return Math.sqrt(Z)},W.prototype.dot=function(Q){var Z,L=Q.arr;if(!((Z=this.arr)===null||Z===void 0?void 0:Z.length)||!(L==null?void 0:L.length))return 0;if(this.arr.length===L.length){var P=0;for(var C in this.arr)P+=this.arr[C]*Q.arr[C];return P}else console.error("The two vectors are unequal in length.")},W.prototype.equal=function(Q){var Z,L=Q.arr;if(((Z=this.arr)===null||Z===void 0?void 0:Z.length)!==(L==null?void 0:L.length))return!1;for(var P in this.arr)if(this.arr[P]!==L[P])return!1;return!0},W}(),j=tt;it.default=j},31656:function(sr,it,$){"use strict";function X(st){return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ut){return typeof ut}:function(ut){return ut&&typeof Symbol=="function"&&ut.constructor===Symbol&&ut!==Symbol.prototype?"symbol":typeof ut},X(st)}Object.defineProperty(it,"__esModule",{value:!0}),Object.defineProperty(it,"GADDI",{enumerable:!0,get:function(){return K.default}}),Object.defineProperty(it,"breadthFirstSearch",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(it,"connectedComponent",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(it,"depthFirstSearch",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(it,"detectCycle",{enumerable:!0,get:function(){return Z.default}}),Object.defineProperty(it,"dijkstra",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(it,"findAllPath",{enumerable:!0,get:function(){return C.findAllPath}}),Object.defineProperty(it,"findShortestPath",{enumerable:!0,get:function(){return C.findShortestPath}}),Object.defineProperty(it,"floydWarshall",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(it,"getAdjMatrix",{enumerable:!0,get:function(){return tt.default}}),Object.defineProperty(it,"getDegree",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(it,"getInDegree",{enumerable:!0,get:function(){return Q.getInDegree}}),Object.defineProperty(it,"getNeighbors",{enumerable:!0,get:function(){return O.getNeighbors}}),Object.defineProperty(it,"getOutDegree",{enumerable:!0,get:function(){return Q.getOutDegree}}),Object.defineProperty(it,"labelPropagation",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(it,"louvain",{enumerable:!0,get:function(){return B.default}}),Object.defineProperty(it,"minimumSpanningTree",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(it,"pageRank",{enumerable:!0,get:function(){return F.default}});var tt=mt($(62238)),j=mt($(83764)),W=mt($(59527)),Q=ft($(82556)),Z=mt($(94282)),L=mt($(45891)),P=mt($(78089)),C=$(41727),M=mt($(75033)),k=mt($(5170)),B=mt($(57363)),R=mt($(89454)),F=mt($(74926)),K=mt($(82812)),O=$(70643);function _(st){if(typeof WeakMap!="function")return null;var ut=new WeakMap,dt=new WeakMap;return(_=function(wt){return wt?dt:ut})(st)}function ft(st,ut){if(!ut&&st&&st.__esModule)return st;if(st===null||X(st)!=="object"&&typeof st!="function")return{default:st};var dt=_(ut);if(dt&&dt.has(st))return dt.get(st);var gt={},wt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ot in st)if(ot!=="default"&&Object.prototype.hasOwnProperty.call(st,ot)){var pt=wt?Object.getOwnPropertyDescriptor(st,ot):null;pt&&(pt.get||pt.set)?Object.defineProperty(gt,ot,pt):gt[ot]=st[ot]}return gt.default=st,dt&&dt.set(st,gt),gt}function mt(st){return st&&st.__esModule?st:{default:st}}},66044:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.MESSAGE=it.ALGORITHM=void 0;var $={pageRank:"pageRank",breadthFirstSearch:"breadthFirstSearch",connectedComponent:"connectedComponent",depthFirstSearch:"depthFirstSearch",detectCycle:"detectCycle",detectDirectedCycle:"detectDirectedCycle",detectAllCycles:"detectAllCycles",detectAllDirectedCycle:"detectAllDirectedCycle",detectAllUndirectedCycle:"detectAllUndirectedCycle",dijkstra:"dijkstra",findAllPath:"findAllPath",findShortestPath:"findShortestPath",floydWarshall:"floydWarshall",getAdjMatrix:"getAdjMatrix",getDegree:"getDegree",getInDegree:"getInDegree",getNeighbors:"getNeighbors",getOutDegree:"getOutDegree",labelPropagation:"labelPropagation",louvain:"louvain",GADDI:"GADDI",minimumSpanningTree:"minimumSpanningTree",SUCCESS:"SUCCESS",FAILURE:"FAILURE"};it.ALGORITHM=$;var X={SUCCESS:"SUCCESS",FAILURE:"FAILURE"};it.MESSAGE=X},70585:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var X=$(66044),tt=j($(12067));function j(Z){return Z&&Z.__esModule?Z:{default:Z}}var W=function(L){return function(){for(var P=[],C=0;C<arguments.length;C++)P[C]=arguments[C];return new Promise(function(M,k){var B=new tt.default;B.postMessage({_algorithmType:L,data:P}),B.onmessage=function(R){var F=R.data,K=F.data,O=F._algorithmType;X.MESSAGE.SUCCESS===O?M(K):k(),B.terminate()}})}},Q=W;it.default=Q},30485:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.pageRankAsync=it.minimumSpanningTreeAsync=it.louvainAsync=it.labelPropagationAsync=it.getOutDegreeAsync=it.getNeighborsAsync=it.getInDegreeAsync=it.getDegreeAsync=it.getAdjMatrixAsync=it.floydWarshallAsync=it.findShortestPathAsync=it.findAllPathAsync=it.dijkstraAsync=it.detectCycleAsync=it.detectAllUndirectedCycleAsync=it.detectAllDirectedCycleAsync=it.detectAllCyclesAsync=it.connectedComponentAsync=it.GADDIAsync=void 0;var X=j($(70585)),tt=$(66044);function j(gt){return gt&&gt.__esModule?gt:{default:gt}}var W=function(wt,ot){return(0,X.default)(tt.ALGORITHM.getAdjMatrix).apply(void 0,[wt,ot])};it.getAdjMatrixAsync=W;var Q=function(wt,ot){return(0,X.default)(tt.ALGORITHM.connectedComponent).apply(void 0,[wt,ot])};it.connectedComponentAsync=Q;var Z=function(wt){return(0,X.default)(tt.ALGORITHM.getDegree)(wt)};it.getDegreeAsync=Z;var L=function(wt,ot){return(0,X.default)(tt.ALGORITHM.getInDegree)(wt,ot)};it.getInDegreeAsync=L;var P=function(wt,ot){return(0,X.default)(tt.ALGORITHM.getOutDegree)(wt,ot)};it.getOutDegreeAsync=P;var C=function(wt){return(0,X.default)(tt.ALGORITHM.detectCycle)(wt)};it.detectCycleAsync=C;var M=function(wt){return(0,X.default)(tt.ALGORITHM.detectAllCycles)(wt)};it.detectAllCyclesAsync=M;var k=function(wt){return(0,X.default)(tt.ALGORITHM.detectAllDirectedCycle)(wt)};it.detectAllDirectedCycleAsync=k;var B=function(wt){return(0,X.default)(tt.ALGORITHM.detectAllUndirectedCycle)(wt)};it.detectAllUndirectedCycleAsync=B;var R=function(wt,ot,pt,Nt){return(0,X.default)(tt.ALGORITHM.dijkstra).apply(void 0,[wt,ot,pt,Nt])};it.dijkstraAsync=R;var F=function(wt,ot,pt,Nt){return(0,X.default)(tt.ALGORITHM.findAllPath).apply(void 0,[wt,ot,pt,Nt])};it.findAllPathAsync=F;var K=function(wt,ot,pt,Nt,Gt){return(0,X.default)(tt.ALGORITHM.findShortestPath).apply(void 0,[wt,ot,pt,Nt,Gt])};it.findShortestPathAsync=K;var O=function(wt,ot){return(0,X.default)(tt.ALGORITHM.floydWarshall).apply(void 0,[wt,ot])};it.floydWarshallAsync=O;var _=function(wt,ot,pt,Nt){return Nt===void 0&&(Nt=1e3),(0,X.default)(tt.ALGORITHM.labelPropagation)(wt,ot,pt,Nt)};it.labelPropagationAsync=_;var ft=function(wt,ot,pt,Nt){return(0,X.default)(tt.ALGORITHM.louvain)(wt,ot,pt,Nt)};it.louvainAsync=ft;var mt=function(wt,ot,pt){return(0,X.default)(tt.ALGORITHM.minimumSpanningTree).apply(void 0,[wt,ot,pt])};it.minimumSpanningTreeAsync=mt;var st=function(wt,ot,pt){return(0,X.default)(tt.ALGORITHM.pageRank).apply(void 0,[wt,ot,pt])};it.pageRankAsync=st;var ut=function(wt,ot,pt){return(0,X.default)(tt.ALGORITHM.getNeighbors).apply(void 0,[wt,ot,pt])};it.getNeighborsAsync=ut;var dt=function(wt,ot,pt,Nt,Gt,se,ie){return pt===void 0&&(pt=!1),se===void 0&&(se="cluster"),ie===void 0&&(ie="cluster"),(0,X.default)(tt.ALGORITHM.GADDI).apply(void 0,[wt,ot,pt,Nt,Gt,se,ie])};it.GADDIAsync=dt},12067:function(sr,it,$){"use strict";function X(P){return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},X(P)}Object.defineProperty(it,"__esModule",{value:!0}),it.default=void 0;var tt=Q($(31656)),j=$(66044);function W(P){if(typeof WeakMap!="function")return null;var C=new WeakMap,M=new WeakMap;return(W=function(B){return B?M:C})(P)}function Q(P,C){if(!C&&P&&P.__esModule)return P;if(P===null||X(P)!=="object"&&typeof P!="function")return{default:P};var M=W(C);if(M&&M.has(P))return M.get(P);var k={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in P)if(R!=="default"&&Object.prototype.hasOwnProperty.call(P,R)){var F=B?Object.getOwnPropertyDescriptor(P,R):null;F&&(F.get||F.set)?Object.defineProperty(k,R,F):k[R]=P[R]}return k.default=P,M&&M.set(P,k),k}var Z=typeof self!="undefined"?self:{};Z.onmessage=function(P){var C=P.data,M=C._algorithmType,k=C.data;if(!!M){if(typeof tt[M]=="function"){var B=tt[M].apply(tt,k);Z.postMessage({_algorithmType:j.MESSAGE.SUCCESS,data:B});return}Z.postMessage({_algorithmType:j.MESSAGE.FAILURE})}};var L=null;it.default=L},79984:function(sr,it,$){"use strict";$.r(it),$.d(it,{Kernel:function(){return se},World:function(){return Zr}});var X=$(92137),tt=$(96156),j=$(6610),W=$(5991),Q=$(36719),Z=$.n(Q),L=$(81763),P=$.n(L),C=$(1469),M=$.n(C),k=$(87757),B=$.n(k),R=null,F=1;function K(){return F++}var O=null,_=null,ft;(function(vt){vt[vt.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",vt[vt.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",vt[vt.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",vt[vt.POINTS=0]="POINTS",vt[vt.LINES=1]="LINES",vt[vt.LINE_LOOP=2]="LINE_LOOP",vt[vt.LINE_STRIP=3]="LINE_STRIP",vt[vt.TRIANGLES=4]="TRIANGLES",vt[vt.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",vt[vt.TRIANGLE_FAN=6]="TRIANGLE_FAN",vt[vt.ZERO=0]="ZERO",vt[vt.ONE=1]="ONE",vt[vt.SRC_COLOR=768]="SRC_COLOR",vt[vt.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",vt[vt.SRC_ALPHA=770]="SRC_ALPHA",vt[vt.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",vt[vt.DST_ALPHA=772]="DST_ALPHA",vt[vt.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",vt[vt.DST_COLOR=774]="DST_COLOR",vt[vt.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",vt[vt.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",vt[vt.FUNC_ADD=32774]="FUNC_ADD",vt[vt.BLEND_EQUATION=32777]="BLEND_EQUATION",vt[vt.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",vt[vt.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",vt[vt.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",vt[vt.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",vt[vt.MAX_EXT=32776]="MAX_EXT",vt[vt.MIN_EXT=32775]="MIN_EXT",vt[vt.BLEND_DST_RGB=32968]="BLEND_DST_RGB",vt[vt.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",vt[vt.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",vt[vt.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",vt[vt.CONSTANT_COLOR=32769]="CONSTANT_COLOR",vt[vt.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",vt[vt.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",vt[vt.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",vt[vt.BLEND_COLOR=32773]="BLEND_COLOR",vt[vt.ARRAY_BUFFER=34962]="ARRAY_BUFFER",vt[vt.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",vt[vt.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",vt[vt.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",vt[vt.STREAM_DRAW=35040]="STREAM_DRAW",vt[vt.STATIC_DRAW=35044]="STATIC_DRAW",vt[vt.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",vt[vt.BUFFER_SIZE=34660]="BUFFER_SIZE",vt[vt.BUFFER_USAGE=34661]="BUFFER_USAGE",vt[vt.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",vt[vt.FRONT=1028]="FRONT",vt[vt.BACK=1029]="BACK",vt[vt.FRONT_AND_BACK=1032]="FRONT_AND_BACK",vt[vt.CULL_FACE=2884]="CULL_FACE",vt[vt.BLEND=3042]="BLEND",vt[vt.DITHER=3024]="DITHER",vt[vt.STENCIL_TEST=2960]="STENCIL_TEST",vt[vt.DEPTH_TEST=2929]="DEPTH_TEST",vt[vt.SCISSOR_TEST=3089]="SCISSOR_TEST",vt[vt.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",vt[vt.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",vt[vt.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",vt[vt.NO_ERROR=0]="NO_ERROR",vt[vt.INVALID_ENUM=1280]="INVALID_ENUM",vt[vt.INVALID_VALUE=1281]="INVALID_VALUE",vt[vt.INVALID_OPERATION=1282]="INVALID_OPERATION",vt[vt.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",vt[vt.CW=2304]="CW",vt[vt.CCW=2305]="CCW",vt[vt.LINE_WIDTH=2849]="LINE_WIDTH",vt[vt.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",vt[vt.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",vt[vt.CULL_FACE_MODE=2885]="CULL_FACE_MODE",vt[vt.FRONT_FACE=2886]="FRONT_FACE",vt[vt.DEPTH_RANGE=2928]="DEPTH_RANGE",vt[vt.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",vt[vt.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",vt[vt.DEPTH_FUNC=2932]="DEPTH_FUNC",vt[vt.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",vt[vt.STENCIL_FUNC=2962]="STENCIL_FUNC",vt[vt.STENCIL_FAIL=2964]="STENCIL_FAIL",vt[vt.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",vt[vt.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",vt[vt.STENCIL_REF=2967]="STENCIL_REF",vt[vt.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",vt[vt.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",vt[vt.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",vt[vt.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",vt[vt.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",vt[vt.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",vt[vt.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",vt[vt.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",vt[vt.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",vt[vt.VIEWPORT=2978]="VIEWPORT",vt[vt.SCISSOR_BOX=3088]="SCISSOR_BOX",vt[vt.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",vt[vt.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",vt[vt.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",vt[vt.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",vt[vt.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",vt[vt.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",vt[vt.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",vt[vt.RED_BITS=3410]="RED_BITS",vt[vt.GREEN_BITS=3411]="GREEN_BITS",vt[vt.BLUE_BITS=3412]="BLUE_BITS",vt[vt.ALPHA_BITS=3413]="ALPHA_BITS",vt[vt.DEPTH_BITS=3414]="DEPTH_BITS",vt[vt.STENCIL_BITS=3415]="STENCIL_BITS",vt[vt.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",vt[vt.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",vt[vt.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",vt[vt.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",vt[vt.SAMPLES=32937]="SAMPLES",vt[vt.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",vt[vt.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",vt[vt.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",vt[vt.DONT_CARE=4352]="DONT_CARE",vt[vt.FASTEST=4353]="FASTEST",vt[vt.NICEST=4354]="NICEST",vt[vt.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",vt[vt.BYTE=5120]="BYTE",vt[vt.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",vt[vt.SHORT=5122]="SHORT",vt[vt.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",vt[vt.INT=5124]="INT",vt[vt.UNSIGNED_INT=5125]="UNSIGNED_INT",vt[vt.FLOAT=5126]="FLOAT",vt[vt.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",vt[vt.ALPHA=6406]="ALPHA",vt[vt.RGB=6407]="RGB",vt[vt.RGBA=6408]="RGBA",vt[vt.LUMINANCE=6409]="LUMINANCE",vt[vt.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",vt[vt.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",vt[vt.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",vt[vt.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",vt[vt.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",vt[vt.VERTEX_SHADER=35633]="VERTEX_SHADER",vt[vt.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",vt[vt.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",vt[vt.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",vt[vt.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",vt[vt.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",vt[vt.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",vt[vt.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",vt[vt.SHADER_TYPE=35663]="SHADER_TYPE",vt[vt.DELETE_STATUS=35712]="DELETE_STATUS",vt[vt.LINK_STATUS=35714]="LINK_STATUS",vt[vt.VALIDATE_STATUS=35715]="VALIDATE_STATUS",vt[vt.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",vt[vt.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",vt[vt.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",vt[vt.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",vt[vt.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",vt[vt.NEVER=512]="NEVER",vt[vt.LESS=513]="LESS",vt[vt.EQUAL=514]="EQUAL",vt[vt.LEQUAL=515]="LEQUAL",vt[vt.GREATER=516]="GREATER",vt[vt.NOTEQUAL=517]="NOTEQUAL",vt[vt.GEQUAL=518]="GEQUAL",vt[vt.ALWAYS=519]="ALWAYS",vt[vt.KEEP=7680]="KEEP",vt[vt.REPLACE=7681]="REPLACE",vt[vt.INCR=7682]="INCR",vt[vt.DECR=7683]="DECR",vt[vt.INVERT=5386]="INVERT",vt[vt.INCR_WRAP=34055]="INCR_WRAP",vt[vt.DECR_WRAP=34056]="DECR_WRAP",vt[vt.VENDOR=7936]="VENDOR",vt[vt.RENDERER=7937]="RENDERER",vt[vt.VERSION=7938]="VERSION",vt[vt.NEAREST=9728]="NEAREST",vt[vt.LINEAR=9729]="LINEAR",vt[vt.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",vt[vt.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",vt[vt.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",vt[vt.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",vt[vt.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",vt[vt.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",vt[vt.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",vt[vt.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",vt[vt.TEXTURE_2D=3553]="TEXTURE_2D",vt[vt.TEXTURE=5890]="TEXTURE",vt[vt.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",vt[vt.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",vt[vt.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",vt[vt.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",vt[vt.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",vt[vt.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",vt[vt.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",vt[vt.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",vt[vt.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",vt[vt.TEXTURE0=33984]="TEXTURE0",vt[vt.TEXTURE1=33985]="TEXTURE1",vt[vt.TEXTURE2=33986]="TEXTURE2",vt[vt.TEXTURE3=33987]="TEXTURE3",vt[vt.TEXTURE4=33988]="TEXTURE4",vt[vt.TEXTURE5=33989]="TEXTURE5",vt[vt.TEXTURE6=33990]="TEXTURE6",vt[vt.TEXTURE7=33991]="TEXTURE7",vt[vt.TEXTURE8=33992]="TEXTURE8",vt[vt.TEXTURE9=33993]="TEXTURE9",vt[vt.TEXTURE10=33994]="TEXTURE10",vt[vt.TEXTURE11=33995]="TEXTURE11",vt[vt.TEXTURE12=33996]="TEXTURE12",vt[vt.TEXTURE13=33997]="TEXTURE13",vt[vt.TEXTURE14=33998]="TEXTURE14",vt[vt.TEXTURE15=33999]="TEXTURE15",vt[vt.TEXTURE16=34e3]="TEXTURE16",vt[vt.TEXTURE17=34001]="TEXTURE17",vt[vt.TEXTURE18=34002]="TEXTURE18",vt[vt.TEXTURE19=34003]="TEXTURE19",vt[vt.TEXTURE20=34004]="TEXTURE20",vt[vt.TEXTURE21=34005]="TEXTURE21",vt[vt.TEXTURE22=34006]="TEXTURE22",vt[vt.TEXTURE23=34007]="TEXTURE23",vt[vt.TEXTURE24=34008]="TEXTURE24",vt[vt.TEXTURE25=34009]="TEXTURE25",vt[vt.TEXTURE26=34010]="TEXTURE26",vt[vt.TEXTURE27=34011]="TEXTURE27",vt[vt.TEXTURE28=34012]="TEXTURE28",vt[vt.TEXTURE29=34013]="TEXTURE29",vt[vt.TEXTURE30=34014]="TEXTURE30",vt[vt.TEXTURE31=34015]="TEXTURE31",vt[vt.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",vt[vt.REPEAT=10497]="REPEAT",vt[vt.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",vt[vt.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",vt[vt.FLOAT_VEC2=35664]="FLOAT_VEC2",vt[vt.FLOAT_VEC3=35665]="FLOAT_VEC3",vt[vt.FLOAT_VEC4=35666]="FLOAT_VEC4",vt[vt.INT_VEC2=35667]="INT_VEC2",vt[vt.INT_VEC3=35668]="INT_VEC3",vt[vt.INT_VEC4=35669]="INT_VEC4",vt[vt.BOOL=35670]="BOOL",vt[vt.BOOL_VEC2=35671]="BOOL_VEC2",vt[vt.BOOL_VEC3=35672]="BOOL_VEC3",vt[vt.BOOL_VEC4=35673]="BOOL_VEC4",vt[vt.FLOAT_MAT2=35674]="FLOAT_MAT2",vt[vt.FLOAT_MAT3=35675]="FLOAT_MAT3",vt[vt.FLOAT_MAT4=35676]="FLOAT_MAT4",vt[vt.SAMPLER_2D=35678]="SAMPLER_2D",vt[vt.SAMPLER_CUBE=35680]="SAMPLER_CUBE",vt[vt.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",vt[vt.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",vt[vt.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",vt[vt.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",vt[vt.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",vt[vt.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",vt[vt.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",vt[vt.COMPILE_STATUS=35713]="COMPILE_STATUS",vt[vt.LOW_FLOAT=36336]="LOW_FLOAT",vt[vt.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",vt[vt.HIGH_FLOAT=36338]="HIGH_FLOAT",vt[vt.LOW_INT=36339]="LOW_INT",vt[vt.MEDIUM_INT=36340]="MEDIUM_INT",vt[vt.HIGH_INT=36341]="HIGH_INT",vt[vt.FRAMEBUFFER=36160]="FRAMEBUFFER",vt[vt.RENDERBUFFER=36161]="RENDERBUFFER",vt[vt.RGBA4=32854]="RGBA4",vt[vt.RGB5_A1=32855]="RGB5_A1",vt[vt.RGB565=36194]="RGB565",vt[vt.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",vt[vt.STENCIL_INDEX=6401]="STENCIL_INDEX",vt[vt.STENCIL_INDEX8=36168]="STENCIL_INDEX8",vt[vt.DEPTH_STENCIL=34041]="DEPTH_STENCIL",vt[vt.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",vt[vt.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",vt[vt.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",vt[vt.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",vt[vt.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",vt[vt.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",vt[vt.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",vt[vt.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",vt[vt.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",vt[vt.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",vt[vt.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",vt[vt.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",vt[vt.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",vt[vt.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",vt[vt.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",vt[vt.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",vt[vt.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",vt[vt.NONE=0]="NONE",vt[vt.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",vt[vt.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",vt[vt.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",vt[vt.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",vt[vt.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",vt[vt.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",vt[vt.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",vt[vt.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",vt[vt.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",vt[vt.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",vt[vt.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",vt[vt.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",vt[vt.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",vt[vt.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",vt[vt.COPY_SRC=1]="COPY_SRC",vt[vt.COPY_DST=2]="COPY_DST",vt[vt.SAMPLED=4]="SAMPLED",vt[vt.STORAGE=8]="STORAGE",vt[vt.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(ft||(ft={}));var mt=function(){function vt(){(0,j.Z)(this,vt),this.config=void 0}return(0,W.Z)(vt,[{key:"get",value:function(){return this.config}},{key:"set",value:function(an){this.config=an}}]),vt}(),st=typeof navigator!="undefined"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),ut;(function(vt){vt.Void="Void",vt.Boolean="Boolean",vt.Float="Float",vt.Uint32="Uint32",vt.Int32="Int32",vt.Vector="Vector",vt.Vector2Float="vec2<f32>",vt.Vector3Float="vec3<f32>",vt.Vector4Float="vec4<f32>",vt.Vector2Boolean="vec2<bool>",vt.Vector3Boolean="vec3<bool>",vt.Vector4Boolean="vec4<bool>",vt.Vector2Uint="vec2<u32>",vt.Vector3Uint="vec3<u32>",vt.Vector4Uint="vec4<u32>",vt.Vector2Int="vec2<i32>",vt.Vector3Int="vec3<i32>",vt.Vector4Int="vec4<i32>",vt.Matrix="Matrix",vt.Matrix3x3Float="mat3x3<f32>",vt.Matrix4x4Float="mat4x4<i32>",vt.Struct="Struct",vt.FloatArray="Float[]",vt.Vector4FloatArray="vec4<f32>[]"})(ut||(ut={}));var dt;(function(vt){vt.Program="Program",vt.Identifier="Identifier",vt.VariableDeclaration="VariableDeclaration",vt.BlockStatement="BlockStatement",vt.ReturnStatement="ReturnStatement",vt.FunctionDeclaration="FunctionDeclaration",vt.VariableDeclarator="VariableDeclarator",vt.AssignmentExpression="AssignmentExpression",vt.LogicalExpression="LogicalExpression",vt.BinaryExpression="BinaryExpression",vt.ArrayExpression="ArrayExpression",vt.UnaryExpression="UnaryExpression",vt.UpdateExpression="UpdateExpression",vt.FunctionExpression="FunctionExpression",vt.MemberExpression="MemberExpression",vt.ConditionalExpression="ConditionalExpression",vt.ExpressionStatement="ExpressionStatement",vt.CallExpression="CallExpression",vt.NumThreadStatement="NumThreadStatement",vt.StorageStatement="StorageStatement",vt.DoWhileStatement="DoWhileStatement",vt.WhileStatement="WhileStatement",vt.ForStatement="ForStatement",vt.BreakStatement="BreakStatement",vt.ContinueStatement="ContinueStatement",vt.IfStatement="IfStatement",vt.ImportedFunctionStatement="ImportedFunctionStatement"})(dt||(dt={}));var gt;(function(vt){vt.Input="Input",vt.Output="Output",vt.Uniform="Uniform",vt.Workgroup="Workgroup",vt.UniformConstant="UniformConstant",vt.Image="Image",vt.StorageBuffer="StorageBuffer",vt.Private="Private",vt.Function="Function"})(gt||(gt={}));var wt;(function(vt){vt.GLSL100="GLSL100",vt.GLSL450="GLSL450",vt.WGSL="WGSL"})(wt||(wt={}));var ot="__DefineValuePlaceholder__";function pt(){if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Nt(vt,_n){var an=Object.keys(vt);if(Object.getOwnPropertySymbols){var Lt=Object.getOwnPropertySymbols(vt);_n&&(Lt=Lt.filter(function(kt){return Object.getOwnPropertyDescriptor(vt,kt).enumerable})),an.push.apply(an,Lt)}return an}function Gt(vt){for(var _n=1;_n<arguments.length;_n++){var an=arguments[_n]!=null?arguments[_n]:{};_n%2?Nt(Object(an),!0).forEach(function(Lt){(0,tt.Z)(vt,Lt,an[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(vt,Object.getOwnPropertyDescriptors(an)):Nt(Object(an)).forEach(function(Lt){Object.defineProperty(vt,Lt,Object.getOwnPropertyDescriptor(an,Lt))})}return vt}var se=function(){function vt(_n,an){(0,j.Z)(this,vt),this.engine=_n,this.configService=an,this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}return(0,W.Z)(vt,[{key:"init",value:function(){var an=this.configService.get(),Lt=an.canvas,kt=an.engineOptions;this.initPromise=this.engine.init(Gt({canvas:Lt||pt(),antialiasing:!1},kt))}},{key:"setBundle",value:function(an){this.compiledBundle=JSON.parse(JSON.stringify(an))}},{key:"setDispatch",value:function(an){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=an),this}},{key:"setMaxIteration",value:function(an){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=an),this}},{key:"setBinding",value:function(an,Lt){var kt=this;if(typeof an=="string"){var at=P()(Lt)||Z()(Lt)||M()(Lt);if(this.compiledBundle&&this.compiledBundle.context){var H=this.compiledBundle.context.defines.find(function(bt){return bt.name===an});if(H)return H.value=Lt,this;var Y=this.compiledBundle.context.uniforms.find(function(bt){return bt.name===an});Y&&(at?(Y.data=Lt,Y.isReferer=!1,Y.storageClass===gt.Uniform?this.model&&this.model.updateUniform(an,Lt):this.model&&this.model.updateBuffer(an,Lt)):(Y.isReferer=!0,Y.data=Lt))}}else Object.keys(an).forEach(function(bt){kt.setBinding(bt,an[bt])});return this}},{key:"execute",value:function(){var _n=(0,X.Z)(B().mark(function Lt(){var kt=this,at,H,Y=arguments;return B().wrap(function($t){for(;;)switch($t.prev=$t.next){case 0:if(at=Y.length>0&&Y[0]!==void 0?Y[0]:1,!this.dirty){$t.next=6;break}return this.compiledBundle.context&&(at>1?this.compiledBundle.context.maxIteration=at:this.compiledBundle.context.maxIteration++),$t.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(jt){var Ht=jt.isReferer;return Ht}).forEach(function(jt){var Ht=jt.data,re=jt.name;kt.model.confirmInput(Ht.model,re)}),H=0;H<at;H++)this.model.run();return this.engine.endFrame(),$t.abrupt("return",this);case 12:case"end":return $t.stop()}},Lt,this)}));function an(){return _n.apply(this,arguments)}return an}()},{key:"getOutput",value:function(){var _n=(0,X.Z)(B().mark(function Lt(){return B().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return at.abrupt("return",this.model.readData());case 1:case"end":return at.stop()}},Lt,this)}));function an(){return _n.apply(this,arguments)}return an}()},{key:"compile",value:function(){var _n=(0,X.Z)(B().mark(function Lt(){var kt,at,H;return B().wrap(function(bt){for(;;)switch(bt.prev=bt.next){case 0:return bt.next=2,this.initPromise;case 2:return kt=Gt({},this.compiledBundle.context),at=this.engine.supportWebGPU?this.engine.useWGSL?wt.WGSL:wt.GLSL450:wt.GLSL100,H=this.compiledBundle.shaders[at],kt.defines.filter(function($t){return $t.runtime}).forEach(function($t){var jt="".concat(ot).concat($t.name);H=H.replace(jt,"".concat($t.value))}),kt.shader=H,kt.uniforms.forEach(function($t){if(!$t.data&&$t.storageClass===gt.StorageBuffer){var jt=1;$t.type===ut.FloatArray?jt=1:$t.type===ut.Vector4FloatArray&&(jt=4),$t.data=new Float32Array(kt.output.length*jt).fill(0)}}),this.compiledBundle.context=kt,bt.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=bt.sent;case 12:case"end":return bt.stop()}},Lt,this)}));function an(){return _n.apply(this,arguments)}return an}()}]),vt}(),ie=$(81550),Be=$.n(ie),ke=function(){function vt(_n,an){(0,j.Z)(this,vt),this.attribute=void 0,this.buffer=void 0;var Lt=an.buffer,kt=an.offset,at=an.stride,H=an.normalized,Y=an.size,bt=an.divisor;this.buffer=Lt,this.attribute={buffer:Lt.get(),offset:kt||0,stride:at||0,normalized:H||!1,divisor:bt||0},Y&&(this.attribute.size=Y)}return(0,W.Z)(vt,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(an){this.buffer.subData(an)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),vt}(),we,At,Yt,be,nn,Ee,le,Le,Ze,fe,Re,He,pe,Ge,te=(we={},(0,tt.Z)(we,ft.POINTS,"points"),(0,tt.Z)(we,ft.LINES,"lines"),(0,tt.Z)(we,ft.LINE_LOOP,"line loop"),(0,tt.Z)(we,ft.LINE_STRIP,"line strip"),(0,tt.Z)(we,ft.TRIANGLES,"triangles"),(0,tt.Z)(we,ft.TRIANGLE_FAN,"triangle fan"),(0,tt.Z)(we,ft.TRIANGLE_STRIP,"triangle strip"),we),Me=(At={},(0,tt.Z)(At,ft.STATIC_DRAW,"static"),(0,tt.Z)(At,ft.DYNAMIC_DRAW,"dynamic"),(0,tt.Z)(At,ft.STREAM_DRAW,"stream"),At),We=(Yt={},(0,tt.Z)(Yt,ft.BYTE,"int8"),(0,tt.Z)(Yt,ft.UNSIGNED_INT,"int16"),(0,tt.Z)(Yt,ft.INT,"int32"),(0,tt.Z)(Yt,ft.UNSIGNED_BYTE,"uint8"),(0,tt.Z)(Yt,ft.UNSIGNED_SHORT,"uint16"),(0,tt.Z)(Yt,ft.UNSIGNED_INT,"uint32"),(0,tt.Z)(Yt,ft.FLOAT,"float"),Yt),ee=(be={},(0,tt.Z)(be,ft.ALPHA,"alpha"),(0,tt.Z)(be,ft.LUMINANCE,"luminance"),(0,tt.Z)(be,ft.LUMINANCE_ALPHA,"luminance alpha"),(0,tt.Z)(be,ft.RGB,"rgb"),(0,tt.Z)(be,ft.RGBA,"rgba"),(0,tt.Z)(be,ft.RGBA4,"rgba4"),(0,tt.Z)(be,ft.RGB5_A1,"rgb5 a1"),(0,tt.Z)(be,ft.RGB565,"rgb565"),(0,tt.Z)(be,ft.DEPTH_COMPONENT,"depth"),(0,tt.Z)(be,ft.DEPTH_STENCIL,"depth stencil"),be),Pt=(nn={},(0,tt.Z)(nn,ft.DONT_CARE,"dont care"),(0,tt.Z)(nn,ft.NICEST,"nice"),(0,tt.Z)(nn,ft.FASTEST,"fast"),nn),yt=(Ee={},(0,tt.Z)(Ee,ft.NEAREST,"nearest"),(0,tt.Z)(Ee,ft.LINEAR,"linear"),(0,tt.Z)(Ee,ft.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,tt.Z)(Ee,ft.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,tt.Z)(Ee,ft.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,tt.Z)(Ee,ft.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Ee),Ne=(le={},(0,tt.Z)(le,ft.REPEAT,"repeat"),(0,tt.Z)(le,ft.CLAMP_TO_EDGE,"clamp"),(0,tt.Z)(le,ft.MIRRORED_REPEAT,"mirror"),le),tn=(Le={},(0,tt.Z)(Le,ft.NONE,"none"),(0,tt.Z)(Le,ft.BROWSER_DEFAULT_WEBGL,"browser"),Le),fn=(Ze={},(0,tt.Z)(Ze,ft.NEVER,"never"),(0,tt.Z)(Ze,ft.ALWAYS,"always"),(0,tt.Z)(Ze,ft.LESS,"less"),(0,tt.Z)(Ze,ft.LEQUAL,"lequal"),(0,tt.Z)(Ze,ft.GREATER,"greater"),(0,tt.Z)(Ze,ft.GEQUAL,"gequal"),(0,tt.Z)(Ze,ft.EQUAL,"equal"),(0,tt.Z)(Ze,ft.NOTEQUAL,"notequal"),Ze),Rt=(fe={},(0,tt.Z)(fe,ft.FUNC_ADD,"add"),(0,tt.Z)(fe,ft.MIN_EXT,"min"),(0,tt.Z)(fe,ft.MAX_EXT,"max"),(0,tt.Z)(fe,ft.FUNC_SUBTRACT,"subtract"),(0,tt.Z)(fe,ft.FUNC_REVERSE_SUBTRACT,"reverse subtract"),fe),Yn=(Re={},(0,tt.Z)(Re,ft.ZERO,"zero"),(0,tt.Z)(Re,ft.ONE,"one"),(0,tt.Z)(Re,ft.SRC_COLOR,"src color"),(0,tt.Z)(Re,ft.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,tt.Z)(Re,ft.SRC_ALPHA,"src alpha"),(0,tt.Z)(Re,ft.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,tt.Z)(Re,ft.DST_COLOR,"dst color"),(0,tt.Z)(Re,ft.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,tt.Z)(Re,ft.DST_ALPHA,"dst alpha"),(0,tt.Z)(Re,ft.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,tt.Z)(Re,ft.CONSTANT_COLOR,"constant color"),(0,tt.Z)(Re,ft.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,tt.Z)(Re,ft.CONSTANT_ALPHA,"constant alpha"),(0,tt.Z)(Re,ft.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,tt.Z)(Re,ft.SRC_ALPHA_SATURATE,"src alpha saturate"),Re),Un=(He={},(0,tt.Z)(He,ft.NEVER,"never"),(0,tt.Z)(He,ft.ALWAYS,"always"),(0,tt.Z)(He,ft.LESS,"less"),(0,tt.Z)(He,ft.LEQUAL,"lequal"),(0,tt.Z)(He,ft.GREATER,"greater"),(0,tt.Z)(He,ft.GEQUAL,"gequal"),(0,tt.Z)(He,ft.EQUAL,"equal"),(0,tt.Z)(He,ft.NOTEQUAL,"notequal"),He),xr=(pe={},(0,tt.Z)(pe,ft.ZERO,"zero"),(0,tt.Z)(pe,ft.KEEP,"keep"),(0,tt.Z)(pe,ft.REPLACE,"replace"),(0,tt.Z)(pe,ft.INVERT,"invert"),(0,tt.Z)(pe,ft.INCR,"increment"),(0,tt.Z)(pe,ft.DECR,"decrement"),(0,tt.Z)(pe,ft.INCR_WRAP,"increment wrap"),(0,tt.Z)(pe,ft.DECR_WRAP,"decrement wrap"),pe),cr=(Ge={},(0,tt.Z)(Ge,ft.FRONT,"front"),(0,tt.Z)(Ge,ft.BACK,"back"),Ge),Ur=function(){function vt(_n,an){(0,j.Z)(this,vt),this.buffer=void 0;var Lt=an.data,kt=an.usage,at=an.type;this.buffer=_n.buffer({data:Lt,usage:Me[kt||ft.STATIC_DRAW],type:We[at||ft.UNSIGNED_BYTE]})}return(0,W.Z)(vt,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(an){var Lt=an.data,kt=an.offset;this.buffer.subdata(Lt,kt)}}]),vt}(),fa=$(85061);function Sa(vt,_n){var an=Object.keys(vt);if(Object.getOwnPropertySymbols){var Lt=Object.getOwnPropertySymbols(vt);_n&&(Lt=Lt.filter(function(kt){return Object.getOwnPropertyDescriptor(vt,kt).enumerable})),an.push.apply(an,Lt)}return an}function sa(vt){for(var _n=1;_n<arguments.length;_n++){var an=arguments[_n]!=null?arguments[_n]:{};_n%2?Sa(Object(an),!0).forEach(function(Lt){(0,tt.Z)(vt,Lt,an[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(vt,Object.getOwnPropertyDescriptors(an)):Sa(Object(an)).forEach(function(Lt){Object.defineProperty(vt,Lt,Object.getOwnPropertyDescriptor(an,Lt))})}return vt}var Da=`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,Rr=0,Mn=!1,ar=function(){function vt(_n,an){var Lt=this;(0,j.Z)(this,vt),this.reGl=_n,this.context=an,this.entity=K(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var kt={};this.context.uniforms.forEach(function($t){var jt=$t.name,Ht=$t.type,re=$t.data,on=$t.isReferer,Je=$t.storageClass;if(Je===gt.StorageBuffer){if(on)Lt.textureCache[jt]={data:void 0},kt["".concat(jt,"Size")]=function(){return re.compiledBundle.context.output.textureSize};else{Lt.textureCache[jt]=Lt.calcDataTexture(jt,Ht,re);var Ve=Lt.textureCache[jt],qn=Ve.textureWidth,Ln=Ve.isOutput;kt["".concat(jt,"Size")]=[qn,qn],Ln&&(Lt.outputTextureName=jt,Lt.context.needPingpong&&(Lt.outputTextureName="".concat(jt,"Output"),Lt.textureCache[Lt.outputTextureName]=Lt.calcDataTexture(jt,Ht,re)))}kt[jt]=function(){return Mn&&console.log("[".concat(Lt.entity,"]: ").concat(jt," ").concat(Lt.textureCache[jt].id)),Lt.textureCache[jt].texture}}else if(Je===gt.Uniform){if(re&&(Array.isArray(re)||Z()(re))&&re.length>16)throw new Error("invalid data type ".concat(Ht));kt[jt]=function(){return $t.data}}});var at=this.getOuputDataTexture(),H=at.textureWidth,Y=at.texelCount;kt.u_OutputTextureSize=[H,H],kt.u_OutputTexelCount=Y,this.context.output.textureSize=[H,H];var bt={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:kt,vert:Da,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(bt)}return(0,W.Z)(vt,[{key:"run",value:function(){var an=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){an.computeCommand()}),Mn&&console.log("[".concat(this.entity,"]: output ").concat(this.getOuputDataTexture().id))}},{key:"readData",value:function(){var _n=(0,X.Z)(B().mark(function Lt(){var kt=this,at,H,Y,bt,$t,jt,Ht,re;return B().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){at=kt.reGl.read()}),!at){Je.next=6;break}if(H=this.getOuputDataTexture(),Y=H.originalDataLength,bt=H.elementsPerTexel,$t=H.typedArrayConstructor,jt=$t===void 0?Float32Array:$t,Ht=[],bt!==4)for(re=0;re<at.length;re+=4)bt===1?Ht.push(at[re]):bt===2?Ht.push(at[re],at[re+1]):Ht.push(at[re],at[re+1],at[re+2]);else Ht=at;return Je.abrupt("return",new jt(Ht.slice(0,Y)));case 6:return Je.abrupt("return",new Float32Array);case 7:case"end":return Je.stop()}},Lt,this)}));function an(){return _n.apply(this,arguments)}return an}()},{key:"confirmInput",value:function(an,Lt){var kt;this.entity===an.entity?(this.dynamicPingpong=!0,kt=this):kt=an,this.textureCache[Lt].id=kt.getOuputDataTexture().id,this.textureCache[Lt].texture=kt.getOuputDataTexture().texture,Mn&&console.log("[".concat(this.entity,"]: confirm input ").concat(Lt," from model ").concat(kt.entity,", ").concat(kt.getOuputDataTexture().id))}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(an,Lt){var kt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,at=this.context.uniforms.find(function($t){var jt=$t.name;return jt===an});if(at){var H=this.calcDataTexture(an,at.type,Lt),Y=H.texture,bt=H.data;this.textureCache[an].data=bt,this.textureCache[an].texture=Y}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var an=this.context.output.name;this.textureCache[an].id=this.getOuputDataTexture().id,this.textureCache[an].texture=this.getOuputDataTexture().texture}var Lt=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=Lt,Mn&&console.log("[".concat(this.entity,"]: after swap, output ").concat(this.getOuputDataTexture().id))}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var an=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=an}},{key:"cloneDataTexture",value:function(an){var Lt=an.data,kt=an.textureWidth;return sa(sa({},an),{},{id:Rr++,texture:this.reGl.texture({width:kt,height:kt,data:Lt,type:"float"})})}},{key:"calcDataTexture",value:function(an,Lt,kt){var at=1;Lt===ut.Vector4FloatArray&&(at=4);for(var H=[],Y=0;Y<kt.length;Y+=at)at===1?H.push(kt[Y],0,0,0):at===2?H.push(kt[Y],kt[Y+1],0,0):at===3?H.push(kt[Y],kt[Y+1],kt[Y+2],0):at===4&&H.push(kt[Y],kt[Y+1],kt[Y+2],kt[Y+3]);var bt=kt.length,$t=Math.ceil(bt/at),jt=Math.ceil(Math.sqrt($t)),Ht=jt*jt;$t<Ht&&H.push.apply(H,(0,fa.Z)(new Array((Ht-$t)*4).fill(0)));var re=this.reGl.texture({width:jt,height:jt,data:H,type:"float"});return{id:Rr++,data:H,originalDataLength:bt,typedArrayConstructor:Z()(kt)?kt.constructor:void 0,textureWidth:jt,texture:re,texelCount:$t,elementsPerTexel:at,isOutput:an===this.context.output.name}}}]),vt}(),Fn=function(){function vt(_n,an){(0,j.Z)(this,vt),this.elements=void 0;var Lt=an.data,kt=an.usage,at=an.type,H=an.count;this.elements=_n.elements({data:Lt,usage:Me[kt||ft.STATIC_DRAW],type:We[at||ft.UNSIGNED_BYTE],count:H})}return(0,W.Z)(vt,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(an){var Lt=an.data;this.elements.subdata(Lt)}},{key:"destroy",value:function(){this.elements.destroy()}}]),vt}(),tr=function(){function vt(_n,an){(0,j.Z)(this,vt),this.framebuffer=void 0;var Lt=an.width,kt=an.height,at=an.color,H=an.colors,Y=an.depth,bt=an.stencil,$t={width:Lt,height:kt};Array.isArray(H)&&($t.colors=H.map(function(jt){return jt.get()})),at&&typeof at!="boolean"&&($t.color=at.get()),this.framebuffer=_n.framebuffer($t)}return(0,W.Z)(vt,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(an){var Lt=an.width,kt=an.height;this.framebuffer.resize(Lt,kt)}}]),vt}(),Gn=$(90484),jr=$(68630),Hr=$.n(jr);function Ea(vt){var _n={};return Object.keys(vt).forEach(function(an){lr(an,vt[an],_n,"")}),_n}function lr(vt,_n,an,Lt){if(_n===null||typeof _n=="number"||typeof _n=="boolean"||Array.isArray(_n)&&typeof _n[0]=="number"||Z()(_n)||_n===""||_n.resize!==void 0){an["".concat(Lt&&Lt+".").concat(vt)]=_n;return}Hr()(_n)&&Object.keys(_n).forEach(function(kt){lr(kt,_n[kt],an,"".concat(Lt&&Lt+".").concat(vt))}),Array.isArray(_n)&&_n.forEach(function(kt,at){Object.keys(kt).forEach(function(H){lr(H,kt[H],an,"".concat(Lt&&Lt+".").concat(vt,"[").concat(at,"]"))})})}function Cr(vt,_n){var an=Object.keys(vt);if(Object.getOwnPropertySymbols){var Lt=Object.getOwnPropertySymbols(vt);_n&&(Lt=Lt.filter(function(kt){return Object.getOwnPropertyDescriptor(vt,kt).enumerable})),an.push.apply(an,Lt)}return an}function vr(vt){for(var _n=1;_n<arguments.length;_n++){var an=arguments[_n]!=null?arguments[_n]:{};_n%2?Cr(Object(an),!0).forEach(function(Lt){(0,tt.Z)(vt,Lt,an[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(vt,Object.getOwnPropertyDescriptors(an)):Cr(Object(an)).forEach(function(Lt){Object.defineProperty(vt,Lt,Object.getOwnPropertyDescriptor(an,Lt))})}return vt}var Tr=function(){function vt(_n,an){(0,j.Z)(this,vt),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=_n;var Lt=an.vs,kt=an.fs,at=an.defines,H=an.attributes,Y=an.uniforms,bt=an.primitive,$t=an.count,jt=an.elements,Ht=an.depth,re=an.blend,on=an.stencil,Je=an.cull,Ve=an.instances,qn=an.scissor,Ln=an.viewport,qr={};Y&&(this.uniforms=Ea(Y),Object.keys(Y).forEach(function(ea){qr[ea]=_n.prop(ea)}));var Ca={};Object.keys(H).forEach(function(ea){Ca[ea]=H[ea].get()});var Qn=at&&this.generateDefines(at)||"",_r={attributes:Ca,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(Qn,`
`).concat(kt),uniforms:qr,vert:`
`.concat(Qn,`
`).concat(Lt),primitive:te[bt===void 0?ft.TRIANGLES:bt]};Ve&&(_r.instances=Ve),$t&&(_r.count=$t),jt&&(_r.elements=jt.get()),qn&&(_r.scissor=qn),Ln&&(_r.viewport=Ln),this.initDepthDrawParams({depth:Ht},_r),this.initBlendDrawParams({blend:re},_r),this.initStencilDrawParams({stencil:on},_r),this.initCullDrawParams({cull:Je},_r),this.drawCommand=_n(_r)}return(0,W.Z)(vt,[{key:"addUniforms",value:function(an){this.uniforms=vr(vr({},this.uniforms),Ea(an))}},{key:"draw",value:function(an){var Lt=vr(vr({},this.uniforms),Ea(an.uniforms||{})),kt={};Object.keys(Lt).forEach(function(at){var H=(0,Gn.Z)(Lt[at]);H==="boolean"||H==="number"||Array.isArray(Lt[at])||Lt[at].BYTES_PER_ELEMENT?kt[at]=Lt[at]:H==="string"||(kt[at]=Lt[at].get())}),this.drawCommand(kt)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(an,Lt){var kt=an.depth;kt&&(Lt.depth={enable:kt.enable===void 0?!0:!!kt.enable,mask:kt.mask===void 0?!0:!!kt.mask,func:fn[kt.func||ft.LESS],range:kt.range||[0,1]})}},{key:"initBlendDrawParams",value:function(an,Lt){var kt=an.blend;if(kt){var at=kt.enable,H=kt.func,Y=kt.equation,bt=kt.color,$t=bt===void 0?[0,0,0,0]:bt;Lt.blend={enable:!!at,func:{srcRGB:Yn[H&&H.srcRGB||ft.SRC_ALPHA],srcAlpha:Yn[H&&H.srcAlpha||ft.SRC_ALPHA],dstRGB:Yn[H&&H.dstRGB||ft.ONE_MINUS_SRC_ALPHA],dstAlpha:Yn[H&&H.dstAlpha||ft.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Rt[Y&&Y.rgb||ft.FUNC_ADD],alpha:Rt[Y&&Y.alpha||ft.FUNC_ADD]},color:$t}}}},{key:"initStencilDrawParams",value:function(an,Lt){var kt=an.stencil;if(kt){var at=kt.enable,H=kt.mask,Y=H===void 0?-1:H,bt=kt.func,$t=bt===void 0?{cmp:ft.ALWAYS,ref:0,mask:-1}:bt,jt=kt.opFront,Ht=jt===void 0?{fail:ft.KEEP,zfail:ft.KEEP,zpass:ft.KEEP}:jt,re=kt.opBack,on=re===void 0?{fail:ft.KEEP,zfail:ft.KEEP,zpass:ft.KEEP}:re;Lt.stencil={enable:!!at,mask:Y,func:vr(vr({},$t),{},{cmp:Un[$t.cmp]}),opFront:{fail:xr[Ht.fail],zfail:xr[Ht.zfail],zpass:xr[Ht.zpass]},opBack:{fail:xr[on.fail],zfail:xr[on.zfail],zpass:xr[on.zpass]}}}}},{key:"initCullDrawParams",value:function(an,Lt){var kt=an.cull;if(kt){var at=kt.enable,H=kt.face,Y=H===void 0?ft.BACK:H;Lt.cull={enable:!!at,face:cr[Y]}}}},{key:"generateDefines",value:function(an){return Object.keys(an).map(function(Lt){return"#define ".concat(Lt," ").concat(Number(an[Lt]))}).join(`
`)}}]),vt}(),ta=function(){function vt(_n,an){(0,j.Z)(this,vt),this.texture=void 0,this.width=void 0,this.height=void 0;var Lt=an.data,kt=an.type,at=kt===void 0?ft.UNSIGNED_BYTE:kt,H=an.width,Y=an.height,bt=an.flipY,$t=bt===void 0?!1:bt,jt=an.format,Ht=jt===void 0?ft.RGBA:jt,re=an.mipmap,on=re===void 0?!1:re,Je=an.wrapS,Ve=Je===void 0?ft.CLAMP_TO_EDGE:Je,qn=an.wrapT,Ln=qn===void 0?ft.CLAMP_TO_EDGE:qn,qr=an.aniso,Ca=qr===void 0?0:qr,Qn=an.alignment,_r=Qn===void 0?1:Qn,ea=an.premultiplyAlpha,La=ea===void 0?!1:ea,ha=an.mag,_i=ha===void 0?ft.NEAREST:ha,Ni=an.min,vi=Ni===void 0?ft.NEAREST:Ni,si=an.colorSpace,Mi=si===void 0?ft.BROWSER_DEFAULT_WEBGL:si;this.width=H,this.height=Y;var Pa={width:H,height:Y,type:We[at],format:ee[Ht],wrapS:Ne[Ve],wrapT:Ne[Ln],mag:yt[_i],min:yt[vi],alignment:_r,flipY:$t,colorSpace:tn[Mi],premultiplyAlpha:La,aniso:Ca};Lt&&(Pa.data=Lt),typeof on=="number"?Pa.mipmap=Pt[on]:typeof on=="boolean"&&(Pa.mipmap=on),this.texture=_n.texture(Pa)}return(0,W.Z)(vt,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(an){var Lt=an.width,kt=an.height;this.texture.resize(Lt,kt),this.width=Lt,this.height=kt}},{key:"destroy",value:function(){this.texture.destroy()}}]),vt}(),ra=function(){function vt(){var _n=this;(0,j.Z)(this,vt),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var an=(0,X.Z)(B().mark(function Lt(kt){return B().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!kt.uniforms){H.next=3;break}return H.next=3,Promise.all(Object.keys(kt.uniforms).map(function(){var Y=(0,X.Z)(B().mark(function bt($t){var jt;return B().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(!(kt.uniforms[$t]&&kt.uniforms[$t].load!==void 0)){re.next=5;break}return re.next=3,kt.uniforms[$t].load();case 3:jt=re.sent,kt.uniforms[$t]=jt;case 5:case"end":return re.stop()}},bt)}));return function(bt){return Y.apply(this,arguments)}}()));case 3:return H.abrupt("return",new Tr(_n.gl,kt));case 4:case"end":return H.stop()}},Lt)}));return function(Lt){return an.apply(this,arguments)}}(),this.createAttribute=function(an){return new ke(_n.gl,an)},this.createBuffer=function(an){return new Ur(_n.gl,an)},this.createElements=function(an){return new Fn(_n.gl,an)},this.createTexture2D=function(an){return new ta(_n.gl,an)},this.createFramebuffer=function(an){return new tr(_n.gl,an)},this.useFramebuffer=function(an,Lt){_n.gl({framebuffer:an?an.get():null})(Lt)},this.createComputeModel=function(){var an=(0,X.Z)(B().mark(function Lt(kt){return B().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.abrupt("return",new ar(_n.gl,kt));case 1:case"end":return H.stop()}},Lt)}));return function(Lt){return an.apply(this,arguments)}}(),this.clear=function(an){var Lt=an.color,kt=an.depth,at=an.stencil,H=an.framebuffer,Y=H===void 0?null:H,bt={color:Lt,depth:kt,stencil:at};bt.framebuffer=Y===null?Y:Y.get(),_n.gl.clear(bt)},this.setScissor=function(an){_n.gl&&_n.gl._gl&&(an.enable&&an.box?(_n.gl._gl.enable(ft.SCISSOR_TEST),_n.gl._gl.scissor(an.box.x,an.box.y,an.box.width,an.box.height)):_n.gl._gl.disable(ft.SCISSOR_TEST),_n.gl._refresh())},this.viewport=function(an){var Lt=an.x,kt=an.y,at=an.width,H=an.height;_n.gl&&_n.gl._gl&&(_n.gl._gl.viewport(Lt,kt,at,H),_n.gl._refresh())},this.readPixels=function(an){var Lt=an.framebuffer,kt=an.x,at=an.y,H=an.width,Y=an.height,bt={x:kt,y:at,width:H,height:Y};return Lt&&(bt.framebuffer=Lt.get()),_n.gl.read(bt)},this.getCanvas=function(){return _n.$canvas},this.getGLContext=function(){return _n.gl._gl},this.destroy=function(){_n.gl&&(_n.gl.destroy(),_n.inited=!1)}}return(0,W.Z)(vt,[{key:"init",value:function(){var _n=(0,X.Z)(B().mark(function Lt(kt){return B().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!this.inited){H.next=2;break}return H.abrupt("return");case 2:return this.$canvas=kt.canvas,H.next=5,new Promise(function(Y,bt){Be()({canvas:kt.canvas,attributes:{alpha:!0,antialias:kt.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(jt,Ht){(jt||!Ht)&&bt(jt),Y(Ht)}})});case 5:this.gl=H.sent,this.inited=!0;case 7:case"end":return H.stop()}},Lt,this)}));function an(Lt){return _n.apply(this,arguments)}return an}()},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),vt}(),Zr=function(){function vt(){(0,j.Z)(this,vt),this.engine=void 0,this.configService=new mt}return(0,W.Z)(vt,[{key:"setConfig",value:function(an){this.configService.set(an)}},{key:"setEngine",value:function(an){this.engine=an}},{key:"createEntity",value:function(){return K()}},{key:"createKernel",value:function(an){var Lt=new se(this.engine,this.configService);return typeof an=="string"?Lt.setBundle(JSON.parse(an)):Lt.setBundle(an),Lt.init(),Lt}},{key:"destroy",value:function(){this.engine.destroy()}}],[{key:"create",value:function(){var an=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Lt=new vt;return Lt.setConfig(an),Lt.setEngine(new ra),Lt}}]),vt}()},34763:function(sr,it,$){"use strict";$.d(it,{ZP:function(){return qA}});var X={};$.r(X),$.d(X,{GADDI:function(){return ls},Stack:function(){return Es},breadthFirstSearch:function(){return Me},connectedComponent:function(){return Pt},cosineSimilarity:function(){return qr},default:function(){return bu},depthFirstSearch:function(){return Un},detectAllCycles:function(){return fa},detectAllDirectedCycle:function(){return Ur},detectAllUndirectedCycle:function(){return cr},detectCycle:function(){return Sa},detectDirectedCycle:function(){return tl},dijkstra:function(){return Rr},findAllPath:function(){return Fn},findShortestPath:function(){return ar},floydWarshall:function(){return Gn},getAdjMatrix:function(){return Yt},getDegree:function(){return Ne},getInDegree:function(){return tn},getNeighbors:function(){return fe},getOutDegree:function(){return fn},iLouvain:function(){return Ht},kCore:function(){return on},kMeans:function(){return qn},labelPropagation:function(){return Hr},louvain:function(){return $t},minimumSpanningTree:function(){return Mi},nodesCosineSimilarity:function(){return Qn},pageRank:function(){return un}});var tt={};$.r(tt),$.d(tt,{Line:function(){return lu},applyMatrix:function(){return bn},compare:function(){return Vs},distance:function(){return Ra},floydWarshall:function(){return Co},fractionToLine:function(){return _s},getAdjMatrix:function(){return to},getBBoxBoundLine:function(){return Du},getCircleCenterByPoints:function(){return pa},getCircleIntersectByPoint:function(){return eu},getDegree:function(){return ms},getEllipseIntersectByPoint:function(){return Zu},getLineIntersect:function(){return Ns},getPointsCenter:function(){return Bu},getRectIntersectByPoint:function(){return tu},intersectBBox:function(){return kl},invertMatrix:function(){return Xr},isPointInPolygon:function(){return dl},isPointsOverlap:function(){return nu},isPolygonsIntersect:function(){return el},itemIntersectByLine:function(){return ns},lerp:function(){return Sl},lerpArray:function(){return ol},move:function(){return gs},pointLineDistance:function(){return xc},pointLineSquareDist:function(){return wu},pointRectSquareDist:function(){return Tl},rotate:function(){return ou},scale:function(){return vo},scaleMatrix:function(){return Qi},squareDist:function(){return Au},translate:function(){return xo}});var j={};$.r(j),$.d(j,{cloneBesidesImg:function(){return nl},getAnimateCfgWithCallback:function(){return Cl},getBBox:function(){return Ba},getComboBBox:function(){return Hs},getLabelPosition:function(){return ro},getLetterWidth:function(){return wo},getLoopCfgs:function(){return oi},getTextSize:function(){return Vo},plainCombosToTrees:function(){return ws},reconstructTree:function(){return ks},shouldRefreshEdge:function(){return Mu},traverseTree:function(){return _o},traverseTreeUp:function(){return To},truncateLabelByLength:function(){return js}});var W={};$.r(W),$.d(W,{catmullRomToBezier:function(){return nt},fillPath:function(){return Qu},fillPathByDiff:function(){return ps},formatPath:function(){return Ec},intersection:function(){return Ao},parsePathArray:function(){return De},parsePathString:function(){return A},pathToAbsolute:function(){return de},pathToCurve:function(){return wn},rectPath:function(){return ri}});var Q={};$.r(Q),$.d(Q,{easeBack:function(){return cu},easeBackIn:function(){return Df},easeBackInOut:function(){return cu},easeBackOut:function(){return Iv},easeBounce:function(){return lh},easeBounceIn:function(){return Sp},easeBounceInOut:function(){return Zs},easeBounceOut:function(){return lh},easeCircle:function(){return xp},easeCircleIn:function(){return Vd},easeCircleInOut:function(){return xp},easeCircleOut:function(){return pd},easeCubic:function(){return _h},easeCubicIn:function(){return eo},easeCubicInOut:function(){return _h},easeCubicOut:function(){return Hp},easeElastic:function(){return Qp},easeElasticIn:function(){return Yc},easeElasticInOut:function(){return Av},easeElasticOut:function(){return Qp},easeExp:function(){return Wd},easeExpIn:function(){return Zp},easeExpInOut:function(){return Wd},easeExpOut:function(){return Ah},easeLinear:function(){return ng},easePoly:function(){return Ud},easePolyIn:function(){return _g},easePolyInOut:function(){return Ud},easePolyOut:function(){return Ig},easeQuad:function(){return Xc},easeQuadIn:function(){return Cv},easeQuadInOut:function(){return Xc},easeQuadOut:function(){return vs},easeSin:function(){return Kp},easeSinIn:function(){return Ih},easeSinInOut:function(){return Kp},easeSinOut:function(){return Yp}});var Z={};$.r(Z),$.d(Z,{calculationItemsBBox:function(){return _t},cloneEvent:function(){return J},formatPadding:function(){return D},isNaN:function(){return xt},isViewportChanged:function(){return lt},processParallelEdges:function(){return Wt},uniqueId:function(){return S}});var L={};$.r(L),$.d(L,{getClosedSpline:function(){return um},getControlPoint:function(){return Ip},getSpline:function(){return Jh},getStarPath:function(){return N1},paddedHull:function(){return lm},pathToPoints:function(){return sm},pointsToPolygon:function(){return Mg},roundedHull:function(){return Qd}});var P={};$.r(P),$.d(P,{defaultSubjectColors:function(){return IS}});var C={};$.r(C),$.d(C,{isForce:function(){return vm}});var M={};$.r(M),$.d(M,{Base:function(){return Tp},Circle:function(){return LS},Ellipse:function(){return fg},Image:function(){return FS},Line:function(){return zS},Marker:function(){return GS},Path:function(){return V1},Polygon:function(){return uy},Polyline:function(){return KS},Rect:function(){return qS},Text:function(){return EA}});var k={};$.r(k),$.d(k,{Base:function(){return tp},Circle:function(){return r2},Dom:function(){return i2},Ellipse:function(){return s2},Image:function(){return Y1},Line:function(){return cy},Marker:function(){return K1},Path:function(){return nw},Polygon:function(){return Z1},Polyline:function(){return hy},Rect:function(){return Q1},Text:function(){return u0}});var B={};$.r(B),$.d(B,{getColorSetsBySubjectColors:function(){return G2},getColorsWithSubjectColor:function(){return ib},mixColor:function(){return bf}});var R={};$.r(R),$.d(R,{arrayToTextureData:function(){return pw},attributesToTextureData:function(){return H2},buildTextureData:function(){return xy},buildTextureDataWithOneEdgeAttr:function(){return V2},buildTextureDataWithTwoEdgeAttr:function(){return j2},proccessToFunc:function(){return dw},radialLayout:function(){return X2}});var F={};$.r(F),$.d(F,{gpuDetector:function(){return vw}});var K={};$.r(K),$.d(K,{assign:function(){return Kv},default:function(){return jw},defaultI18n:function(){return _0},format:function(){return Ww},parse:function(){return Vw},setGlobalDateI18n:function(){return Tb},setGlobalDateMasks:function(){return Uw}});var O=$(65353),_=$(23044),ft={getDefaultCfg:function(){return{}},getEvents:function(){return{}},updateCfg:function(a){return Object.assign(this,a),!0},shouldBegin:function(){return!0},shouldUpdate:function(){return!0},shouldEnd:function(){return!0},bind:function(a){var e=this,i=this.events;this.graph=a,(this.type==="drag-canvas"||this.type==="brush-select"||this.type==="lasso-select")&&a.get("canvas").set("draggable",!0),(0,_.each)(i,function(s,l){a.on(l,s)}),document.addEventListener("visibilitychange",function(){e.keydown=!1})},unbind:function(a){var e=this.events,i=a.get("canvas").get("draggable");(this.type==="drag-canvas"||this.type==="brush-select"||this.type==="lasso-select")&&a.get("canvas").set("draggable",!1),(0,_.each)(e,function(s,l){a.off(l,s)}),a.get("canvas").set("draggable",i)},get:function(a){return this[a]},set:function(a,e){return this[a]=e,this}},mt=function(){function c(){}return c.registerBehavior=function(a,e){if(!e)throw new Error("please specify handler for this behavior: ".concat(a));var i=(0,_.clone)(ft);Object.assign(i,e);var s=function(f){var d=this;Object.assign(this,this.getDefaultCfg(),f);var v=this.getEvents();this.events=null;var w={};v&&((0,_.each)(v,function(E,T){w[T]=(0,_.wrapBehavior)(d,E)}),this.events=w)};s.prototype=i,c.types[a]=s},c.hasBehavior=function(a){return!!c.types[a]},c.getBehavior=function(a){return c.types[a]},c.types={},c}(),st=mt,ut=st,dt="*",gt=function(){function c(){this._events={}}return c.prototype.on=function(a,e,i){return this._events[a]||(this._events[a]=[]),this._events[a].push({callback:e,once:!!i}),this},c.prototype.once=function(a,e){return this.on(a,e,!0)},c.prototype.emit=function(a){for(var e=this,i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var l=this._events[a]||[],f=this._events[dt]||[],d=function(v){for(var w=v.length,E=0;E<w;E++)if(!!v[E]){var T=v[E],G=T.callback,U=T.once;U&&(v.splice(E,1),v.length===0&&delete e._events[a],w--,E--),G.apply(e,i)}};d(l),d(f)},c.prototype.off=function(a,e){if(!a)this._events={};else if(!e)delete this._events[a];else{for(var i=this._events[a]||[],s=i.length,l=0;l<s;l++)i[l].callback===e&&(i.splice(l,1),s--,l--);i.length===0&&delete this._events[a]}return this},c.prototype.getEvents=function(){return this._events},c}(),wt=gt,ot=$(35600);function pt(c,a,e){var i=[0,0,0,0,0,0,0,0,0];return ot.fromTranslation(i,e),ot.multiply(c,i,a)}function Nt(c,a,e){var i=[0,0,0,0,0,0,0,0,0];return ot.fromRotation(i,e),ot.multiply(c,i,a)}function Gt(c,a,e){var i=[0,0,0,0,0,0,0,0,0];return ot.fromScaling(i,e),ot.multiply(c,i,a)}function se(c,a,e){return ot.multiply(c,e,a)}function ie(c,a){for(var e=c?[].concat(c):[1,0,0,0,1,0,0,0,1],i=0,s=a.length;i<s;i++){var l=a[i];switch(l[0]){case"t":pt(e,e,[l[1],l[2]]);break;case"s":Gt(e,e,[l[1],l[2]]);break;case"r":Nt(e,e,l[1]);break;case"m":se(e,e,l[1]);break;default:break}}return e}function Be(c,a){return c[0]*a[1]-a[0]*c[1]}function ke(c,a,e){var i=vec2.angle(c,a),s=Be(c,a)>=0;return e?s?Math.PI*2-i:i:s?i:Math.PI*2-i}function we(c,a,e){return e?(c[0]=a[1],c[1]=-1*a[0]):(c[0]=-1*a[1],c[1]=a[0]),c}var At=function(a,e){var i=a.nodes,s=a.edges,l=[],f={};if(!i)throw new Error("invalid nodes data!");return i&&i.forEach(function(d,v){f[d.id]=v;var w=[];l.push(w)}),s&&s.forEach(function(d){var v=d.source,w=d.target,E=f[v],T=f[w];!E&&E!==0||!T&&T!==0||(l[E][T]=1,e||(l[T][E]=1))}),l},Yt=At,be=function(a,e){return a===e},nn=function(){function c(a,e){e===void 0&&(e=null),this.value=a,this.next=e}return c.prototype.toString=function(a){return a?a(this.value):"".concat(this.value)},c}(),Ee=function(){function c(a){a===void 0&&(a=be),this.head=null,this.tail=null,this.compare=a}return c.prototype.prepend=function(a){var e=new nn(a,this.head);return this.head=e,this.tail||(this.tail=e),this},c.prototype.append=function(a){var e=new nn(a);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},c.prototype.delete=function(a){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,a);)e=this.head,this.head=this.head.next;var i=this.head;if(i!==null)for(;i.next;)this.compare(i.next.value,a)?(e=i.next,i.next=i.next.next):i=i.next;return this.compare(this.tail.value,a)&&(this.tail=i),e},c.prototype.find=function(a){var e=a.value,i=e===void 0?void 0:e,s=a.callback,l=s===void 0?void 0:s;if(!this.head)return null;for(var f=this.head;f;){if(l&&l(f.value)||i!==void 0&&this.compare(f.value,i))return f;f=f.next}return null},c.prototype.deleteTail=function(){var a=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,a;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,a},c.prototype.deleteHead=function(){if(!this.head)return null;var a=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),a},c.prototype.fromArray=function(a){var e=this;return a.forEach(function(i){return e.append(i)}),this},c.prototype.toArray=function(){for(var a=[],e=this.head;e;)a.push(e),e=e.next;return a},c.prototype.reverse=function(){for(var a=this.head,e=null,i=null;a;)i=a.next,a.next=e,e=a,a=i;this.tail=this.head,this.head=e},c.prototype.toString=function(a){return a===void 0&&(a=void 0),this.toArray().map(function(e){return e.toString(a)}).toString()},c}(),le=Ee,Le=function(){function c(){this.linkedList=new le}return c.prototype.isEmpty=function(){return!this.linkedList.head},c.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},c.prototype.enqueue=function(a){this.linkedList.append(a)},c.prototype.dequeue=function(){var a=this.linkedList.deleteHead();return a?a.value:null},c.prototype.toString=function(a){return this.linkedList.toString(a)},c}(),Ze=Le,fe=function(a,e,i){e===void 0&&(e=[]);var s=e.filter(function(v){return v.source===a||v.target===a});if(i==="target"){var l=function(w){return w.source===a};return s.filter(l).map(function(v){return v.target})}if(i==="source"){var f=function(w){return w.target===a};return s.filter(f).map(function(v){return v.source})}var d=function(w){return w.source===a?w.target:w.source};return s.map(d)},Re=function(a,e){return e.filter(function(i){return i.source===a})},He=function(a,e){return e.filter(function(i){return i.source===a||i.target===a})},pe=function(a){a===void 0&&(a=0);var e="".concat(Math.random()).split(".")[1].substr(0,5),i="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(a,"-").concat(e).concat(i)};function Ge(c){c===void 0&&(c={});var a=c,e=function(){},i=function(){var s={};return function(l){var f=l.next,d=f;return s[d]?!1:(s[d]=!0,!0)}}();return a.allowTraversal=c.allowTraversal||i,a.enter=c.enter||e,a.leave=c.leave||e,a}var te=function(a,e,i,s){s===void 0&&(s=!0);var l=Ge(i),f=new Ze,d=a.edges,v=d===void 0?[]:d;f.enqueue(e);for(var w="",E=function(){var G=f.dequeue();l.enter({current:G,previous:w}),fe(G,v,s?"target":void 0).forEach(function(U){l.allowTraversal({previous:w,current:G,next:U})&&f.enqueue(U)}),l.leave({current:G,previous:w}),w=G};!f.isEmpty();)E()},Me=te,We=function(a){for(var e=a.nodes,i=e===void 0?[]:e,s=a.edges,l=s===void 0?[]:s,f=[],d={},v=[],w=function U(et){v.push(et),d[et.id]=!0;for(var ct=fe(et.id,l),Ct=function(zt){var Qt=ct[zt];if(!d[Qt]){var Ie=i.filter(function(je){return je.id===Qt});Ie.length>0&&U(Ie[0])}},Mt=0;Mt<ct.length;++Mt)Ct(Mt)},E=0;E<i.length;E++){var T=i[E];if(!d[T.id]){w(T);for(var G=[];v.length>0;)G.push(v.pop());f.push(G)}}return f},ee=function(a){for(var e=a.nodes,i=e===void 0?[]:e,s=a.edges,l=s===void 0?[]:s,f=[],d={},v={},w={},E=[],T=0,G=function Ct(Mt){v[Mt.id]=T,w[Mt.id]=T,T+=1,f.push(Mt),d[Mt.id]=!0;for(var Dt=fe(Mt.id,l,"target").filter(function(ze){return i.map(function(mn){return mn.id}).indexOf(ze)>-1}),zt=function(mn){var $n=Dt[mn];if(!v[$n]&&v[$n]!==0){var Tn=i.filter(function(or){return or.id===$n});Tn.length>0&&Ct(Tn[0]),w[Mt.id]=Math.min(w[Mt.id],w[$n])}else d[$n]&&(w[Mt.id]=Math.min(w[Mt.id],v[$n]))},Qt=0;Qt<Dt.length;Qt++)zt(Qt);if(w[Mt.id]===v[Mt.id]){for(var Ie=[];f.length>0;){var je=f.pop();if(d[je.id]=!1,Ie.push(je),je===Mt)break}Ie.length>0&&E.push(Ie)}},U=0,et=i;U<et.length;U++){var ct=et[U];!v[ct.id]&&v[ct.id]!==0&&G(ct)}return E};function Pt(c,a){return a?ee(c):We(c)}var yt=function(a){var e={},i=a.nodes,s=i===void 0?[]:i,l=a.edges,f=l===void 0?[]:l;return s.forEach(function(d){e[d.id]={degree:0,inDegree:0,outDegree:0}}),f.forEach(function(d){e[d.source].degree++,e[d.source].outDegree++,e[d.target].degree++,e[d.target].inDegree++}),e},Ne=yt,tn=function(a,e){var i=yt(a);return i[e]?yt(a)[e].inDegree:0},fn=function(a,e){var i=yt(a);return i[e]?yt(a)[e].outDegree:0};function Rt(c){c===void 0&&(c={});var a=c,e=function(){},i=function(){var s={};return function(l){var f=l.next;return s[f]?!1:(s[f]=!0,!0)}}();return a.allowTraversal=c.allowTraversal||i,a.enter=c.enter||e,a.leave=c.leave||e,a}function Yn(c,a,e,i){i.enter({current:a,previous:e});var s=c.edges,l=s===void 0?[]:s;fe(a,l,"target").forEach(function(f){i.allowTraversal({previous:e,current:a,next:f})&&Yn(c,f,a,i)}),i.leave({current:a,previous:e})}function Un(c,a,e){Yn(c,a,"",Rt(e))}var xr=function(a){var e=null,i=a.nodes,s=i===void 0?[]:i,l={},f={},d={},v={};s.forEach(function(T){f[T.id]=T});for(var w={enter:function(G){var U=G.current,et=G.previous;if(d[U]){e={};for(var ct=U,Ct=et;Ct!==U;)e[ct]=Ct,ct=Ct,Ct=l[Ct];e[ct]=Ct}else d[U]=U,delete f[U],l[U]=et},leave:function(G){var U=G.current;v[U]=U,delete d[U]},allowTraversal:function(G){var U=G.next;return e?!1:!v[U]}};Object.keys(f).length;){var E=Object.keys(f)[0];Un(a,E,w)}return e},cr=function(a,e,i){var s,l;i===void 0&&(i=!0);for(var f=[],d=Pt(a,!1),v=0,w=d;v<w.length;v++){var E=w[v];if(!!E.length)for(var T=E[0],G=T.id,U=[T],et=(s={},s[G]=T,s),ct=(l={},l[G]=new Set,l);U.length>0;)for(var Ct=U.pop(),Mt=Ct.id,Dt=fe(Mt,a.edges),zt=function(je){var ze,mn=Dt[je],$n=a.nodes.find(function(ei){return ei.id===mn});if(mn===Mt)f.push((ze={},ze[mn]=Ct,ze));else if(!(mn in ct))et[mn]=Ct,U.push($n),ct[mn]=new Set([Ct]);else if(!ct[Mt].has($n)){for(var Tn=!0,or=[$n,Ct],kr=et[Mt];ct[mn].size&&!ct[mn].has(kr)&&(or.push(kr),kr!==et[kr.id]);)kr=et[kr.id];if(or.push(kr),e&&i?(Tn=!1,or.findIndex(function(ei){return e.indexOf(ei.id)>-1})>-1&&(Tn=!0)):e&&!i&&or.findIndex(function(ei){return e.indexOf(ei.id)>-1})>-1&&(Tn=!1),Tn){for(var Ta={},fi=1;fi<or.length;fi+=1)Ta[or[fi-1].id]=or[fi];or.length&&(Ta[or[or.length-1].id]=or[0]),f.push(Ta)}ct[mn].add(Ct)}},Qt=0;Qt<Dt.length;Qt+=1)zt(Qt)}return f},Ur=function(a,e,i){i===void 0&&(i=!0);for(var s=[],l=new Set,f=[],d=[],v={},w={},E=function(kr){for(var Ta=[kr];Ta.length>0;){var fi=Ta.pop();l.has(fi)&&(l.delete(fi),f[fi.id].forEach(function(ei){Ta.push(ei)}),f[fi.id].clear())}},T=function or(kr,Ta,fi){var ei=!1;if(e&&i===!1&&e.indexOf(kr.id)>-1)return ei;s.push(kr),l.add(kr);for(var Ia=fi[kr.id],Gi=0;Gi<Ia.length;Gi+=1){var Ri=v[Ia[Gi]];if(Ri===Ta){for(var xa={},ja=1;ja<s.length;ja+=1)xa[s[ja-1].id]=s[ja];s.length&&(xa[s[s.length-1].id]=s[0]),d.push(xa),ei=!0}else l.has(Ri)||or(Ri,Ta,fi)&&(ei=!0)}if(ei)E(kr);else for(var Gi=0;Gi<Ia.length;Gi+=1){var Ri=v[Ia[Gi]];f[Ri.id].has(kr)||f[Ri.id].add(kr)}return s.pop(),ei},G=a.nodes,U=G===void 0?[]:G,et=0;et<U.length;et+=1){var ct=U[et],Ct=ct.id;w[Ct]=et,v[et]=ct}if(e&&i)for(var Mt=function(kr){var Ta=e[kr];w[U[kr].id]=w[Ta],w[Ta]=0,v[0]=U.find(function(fi){return fi.id===Ta}),v[w[U[kr].id]]=U[kr]},et=0;et<e.length;et++)Mt(et);for(var Dt=function(kr){for(var Ta,fi,ei=Infinity,Ia=0;Ia<kr.length;Ia+=1)for(var Gi=kr[Ia],Ri=0;Ri<Gi.length;Ri++){var xa=w[Gi[Ri].id];xa<ei&&(ei=xa,fi=Ia)}for(var ja=kr[fi],di=[],Ia=0;Ia<ja.length;Ia+=1){var hi=ja[Ia];di[hi.id]=[];for(var qi=0,fo=fe(hi.id,a.edges,"target").filter(function(cl){return ja.map(function(Fu){return Fu.id}).indexOf(cl)>-1});qi<fo.length;qi++){var es=fo[qi];es===hi.id&&!(i===!1&&e.indexOf(hi.id)>-1)?d.push((Ta={},Ta[hi.id]=hi,Ta)):di[hi.id].push(w[es])}}return{component:ja,adjList:di,minIdx:ei}},zt=0;zt<U.length;){var Qt=U.filter(function(or){return w[or.id]>=zt}),Ie=ee({nodes:Qt,edges:a.edges}).filter(function(or){return or.length>1});if(Ie.length===0)break;var je=Dt(Ie),ze=je.minIdx,mn=je.adjList,$n=je.component;if($n.length>1){$n.forEach(function(or){f[or.id]=new Set});var Tn=v[ze];if(e&&i&&e.indexOf(Tn.id)===-1)return d;T(Tn,Tn,mn),zt=ze+1}else break}return d},fa=function(a,e,i,s){return s===void 0&&(s=!0),e?Ur(a,i,s):cr(a,i,s)},Sa=xr,sa=function(a,e,i){for(var s=Infinity,l,f=0;f<e.length;f++){var d=e[f].id;!i[d]&&a[d]<=s&&(s=a[d],l=e[f])}return l},Da=function(a,e,i,s){var l=a.nodes,f=l===void 0?[]:l,d=a.edges,v=d===void 0?[]:d,w=[],E={},T={},G={};f.forEach(function(zt,Qt){var Ie=zt.id;w.push(Ie),T[Ie]=Infinity,Ie===e&&(T[Ie]=0)});for(var U=f.length,et=function(Qt){var Ie=sa(T,f,E),je=Ie.id;if(E[je]=!0,T[je]===Infinity)return"continue";var ze=[];i?ze=Re(je,v):ze=He(je,v),ze.forEach(function(mn){var $n=mn.target,Tn=mn.source,or=$n===je?Tn:$n,kr=s&&mn[s]?mn[s]:1;T[or]>T[Ie.id]+kr?(T[or]=T[Ie.id]+kr,G[or]=[Ie.id]):T[or]===T[Ie.id]+kr&&G[or].push(Ie.id)})},ct=0;ct<U;ct++)et(ct);G[e]=[e];var Ct={};for(var Mt in T)T[Mt]!==Infinity&&Mn(e,Mt,G,Ct);var Dt={};for(var Mt in Ct)Dt[Mt]=Ct[Mt][0];return{length:T,path:Dt,allPath:Ct}},Rr=Da;function Mn(c,a,e,i){if(c===a)return[c];if(i[a])return i[a];for(var s=[],l=0,f=e[a];l<f.length;l++){var d=f[l],v=Mn(c,d,e,i);if(!v)return;for(var w=0,E=v;w<E.length;w++){var T=E[w];(0,_.isArray)(T)?s.push((0,O.__spreadArray)((0,O.__spreadArray)([],T,!0),[a],!1)):s.push([T,a])}}return i[a]=s,i[a]}var ar=function(a,e,i,s,l){var f=Rr(a,e,s,l),d=f.length,v=f.path,w=f.allPath;return{length:d[i],path:v[i],allPath:w[i]}},Fn=function(a,e,i,s){var l;if(e===i)return[[e]];var f=a.edges,d=f===void 0?[]:f,v=[e],w=(l={},l[e]=!0,l),E=[],T=[],G=s?fe(e,d,"target"):fe(e,d);for(E.push(G);v.length>0&&E.length>0;){var U=E[E.length-1];if(U.length){var et=U.shift();et&&(v.push(et),w[et]=!0,G=s?fe(et,d,"target"):fe(et,d),E.push(G.filter(function(Mt){return!w[Mt]})))}else{var ct=v.pop();w[ct]=!1,E.pop();continue}if(v[v.length-1]===i){var Ct=v.map(function(Dt){return Dt});T.push(Ct);var ct=v.pop();w[ct]=!1,E.pop()}}return T},tr=function(a,e){for(var i=Yt(a,e),s=[],l=i.length,f=0;f<l;f+=1){s[f]=[];for(var d=0;d<l;d+=1)f===d?s[f][d]=0:i[f][d]===0||!i[f][d]?s[f][d]=Infinity:s[f][d]=i[f][d]}for(var v=0;v<l;v+=1)for(var f=0;f<l;f+=1)for(var d=0;d<l;d+=1)s[f][d]>s[f][v]+s[v][d]&&(s[f][d]=s[f][v]+s[v][d]);return s},Gn=tr,jr=function(a,e,i,s){e===void 0&&(e=!1),i===void 0&&(i="weight"),s===void 0&&(s=1e3);var l=a.nodes,f=l===void 0?[]:l,d=a.edges,v=d===void 0?[]:d,w={},E={};f.forEach(function(Qt,Ie){var je=pe();Qt.clusterId=je,w[je]={id:je,nodes:[Qt]},E[Qt.id]={node:Qt,idx:Ie}});var T=Yt(a,e),G=[],U={};T.forEach(function(Qt,Ie){var je=0,ze=f[Ie].id;U[ze]={},Qt.forEach(function(mn,$n){if(!!mn){je+=mn;var Tn=f[$n].id;U[ze][Tn]=mn}}),G.push(je)});for(var et=0,ct=function(){var Ie=!1;if(f.forEach(function(je){var ze={};Object.keys(U[je.id]).forEach(function(ei){var Ia=U[je.id][ei],Gi=E[ei].node,Ri=Gi.clusterId;ze[Ri]||(ze[Ri]=0),ze[Ri]+=Ia});var mn=-Infinity,$n=[];if(Object.keys(ze).forEach(function(ei){mn<ze[ei]?(mn=ze[ei],$n=[ei]):mn===ze[ei]&&$n.push(ei)}),!($n.length===1&&$n[0]===je.clusterId)){var Tn=$n.indexOf(je.clusterId);if(Tn>=0&&$n.splice(Tn,1),$n&&$n.length){Ie=!0;var or=w[je.clusterId],kr=or.nodes.indexOf(je);or.nodes.splice(kr,1);var Ta=Math.floor(Math.random()*$n.length),fi=w[$n[Ta]];fi.nodes.push(je),je.clusterId=fi.id}}}),!Ie)return"break";et++};et<s;){var Ct=ct();if(Ct==="break")break}Object.keys(w).forEach(function(Qt){var Ie=w[Qt];(!Ie.nodes||!Ie.nodes.length)&&delete w[Qt]});var Mt=[],Dt={};v.forEach(function(Qt){var Ie=Qt.source,je=Qt.target,ze=Qt[i]||1,mn=E[Ie].node.clusterId,$n=E[je].node.clusterId,Tn="".concat(mn,"---").concat($n);if(Dt[Tn])Dt[Tn].weight+=ze,Dt[Tn].count++;else{var or={source:mn,target:$n,weight:ze,count:1};Dt[Tn]=or,Mt.push(or)}});var zt=[];return Object.keys(w).forEach(function(Qt){zt.push(w[Qt])}),{clusters:zt,clusterEdges:Mt}},Hr=jr,Ea=function(){function c(a){this.arr=a}return c.prototype.getArr=function(){return this.arr||[]},c.prototype.add=function(a){var e,i=a.arr;if(!((e=this.arr)===null||e===void 0?void 0:e.length))return new c(i);if(!(i==null?void 0:i.length))return new c(this.arr);if(this.arr.length===i.length){var s=[];for(var l in this.arr)s[l]=this.arr[l]+i[l];return new c(s)}},c.prototype.subtract=function(a){var e,i=a.arr;if(!((e=this.arr)===null||e===void 0?void 0:e.length))return new c(i);if(!(i==null?void 0:i.length))return new c(this.arr);if(this.arr.length===i.length){var s=[];for(var l in this.arr)s[l]=this.arr[l]-i[l];return new c(s)}},c.prototype.avg=function(a){var e=[];if(a!==0)for(var i in this.arr)e[i]=this.arr[i]/a;return new c(e)},c.prototype.negate=function(){var a=[];for(var e in this.arr)a[e]=-this.arr[e];return new c(a)},c.prototype.squareEuclideanDistance=function(a){var e,i=a.arr;if(!((e=this.arr)===null||e===void 0?void 0:e.length)||!(i==null?void 0:i.length))return 0;if(this.arr.length===i.length){var s=0;for(var l in this.arr)s+=Math.pow(this.arr[l]-a.arr[l],2);return s}},c.prototype.euclideanDistance=function(a){var e,i=a.arr;if(!((e=this.arr)===null||e===void 0?void 0:e.length)||!(i==null?void 0:i.length))return 0;if(this.arr.length===i.length){var s=0;for(var l in this.arr)s+=Math.pow(this.arr[l]-a.arr[l],2);return Math.sqrt(s)}else console.error("The two vectors are unequal in length.")},c.prototype.normalize=function(){var a=[],e=(0,_.clone)(this.arr);e.sort(function(f,d){return f-d});var i=e[e.length-1],s=e[0];for(var l in this.arr)a[l]=(this.arr[l]-s)/(i-s);return new c(a)},c.prototype.norm2=function(){var a;if(!((a=this.arr)===null||a===void 0?void 0:a.length))return 0;var e=0;for(var i in this.arr)e+=Math.pow(this.arr[i],2);return Math.sqrt(e)},c.prototype.dot=function(a){var e,i=a.arr;if(!((e=this.arr)===null||e===void 0?void 0:e.length)||!(i==null?void 0:i.length))return 0;if(this.arr.length===i.length){var s=0;for(var l in this.arr)s+=this.arr[l]*a.arr[l];return s}else console.error("The two vectors are unequal in length.")},c.prototype.equal=function(a){var e,i=a.arr;if(((e=this.arr)===null||e===void 0?void 0:e.length)!==(i==null?void 0:i.length))return!1;for(var s in this.arr)if(this.arr[s]!==i[s])return!1;return!0},c}(),lr=Ea,Cr=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/,vr=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/,Tr=function(a,e){a===void 0&&(a=[]),e===void 0&&(e=100);var i={};a.forEach(function(l){!l.properties||Object.keys(l.properties).forEach(function(f){if(f==="id"||!"".concat(l.properties[f]).match(Cr)&&!"".concat(l.properties[f]).match(vr)&&isNaN(Number(l.properties[f]))){i.hasOwnProperty(f)&&delete i[f];return}i.hasOwnProperty(f)?i[f]+=1:i[f]=1})});var s=Object.keys(i).sort(function(l,f){return i[f]-i[l]});return s.length<e?s:s.slice(0,e)},ta=function(a,e){return e.map(function(i){return a.hasOwnProperty(i)?a[i]:0})},ra=function(a){for(var e=Tr(a),i=[],s=0;s<a.length;s++)i[s]=ta(a[s].properties,e);return i},Zr=function(a,e){e===void 0&&(e=void 0);var i=[];return a.forEach(function(s){e===void 0&&i.push(s),s[e]!==void 0&&i.push(s[e])}),i},vt={getAllSortProperties:Tr,getPropertyWeight:ra,getAllProperties:Zr},_n;(function(c){c.EuclideanDistance="euclideanDistance"})(_n||(_n={}));var an=function(a,e,i){var s=[];(e==null?void 0:e.length)?s=e:(a.forEach(function(f){s=s.concat(Object.keys(f))}),s=(0,_.uniq)(s));var l={};return s.forEach(function(f){var d=[];a.forEach(function(v){v[f]!==void 0&&v[f]!==""&&d.push(v[f])}),d.length&&!(i==null?void 0:i.includes(f))&&(l[f]=(0,_.uniq)(d))}),l},Lt=function(a,e,i){var s=an(a,e,i),l=[];if(!Object.keys(s).length)return l;var f=Object.values(s),d=f.every(function(v){return v.every(function(w){return typeof w=="number"})});return a.forEach(function(v,w){var E=[];Object.keys(s).forEach(function(T){var G=v[T],U=s[T],et=U.findIndex(function(Mt){return G===Mt}),ct=[];if(d)ct.push(G);else for(var Ct=0;Ct<U.length;Ct++)Ct===et?ct.push(1):ct.push(0);E=E.concat(ct)}),l[w]=E}),l},kt=function(a,e,i,s){i===void 0&&(i=_n.EuclideanDistance);var l=0;switch(i){case _n.EuclideanDistance:l=new lr(a).euclideanDistance(new lr(e));break;default:break}return l},at={getAllKeyValueMap:an,oneHot:Lt,getDistance:kt},H=function(a,e,i,s){for(var l=e.length,f=2*s,d=0,v=0;v<l;v++)for(var w=a[v].clusterId,E=0;E<l;E++){var T=a[E].clusterId;if(w===T){var G=e[v][E]||0,U=i[v]||0,et=i[E]||0;d+=G-U*et/f}}return d*=1/f,d},Y=function(a,e){a===void 0&&(a=[]);for(var i=a.length,s=new lr([]),l=0;l<i;l++)s=s.add(new lr(e[l]));var f=s.avg(i);f.normalize();for(var d=0,l=0;l<i;l++){var v=new lr(e[l]),w=v.squareEuclideanDistance(f);d+=w}var E=[];a.forEach(function(){E.push([])});for(var l=0;l<i;l++){var v=new lr(e[l]);a[l].clusterInertial=0;for(var T=0;T<i;T++){if(l===T){E[l][T]=0;continue}var G=new lr(e[T]);E[l][T]=v.squareEuclideanDistance(G),a[l].clusterInertial+=E[l][T]}}for(var U=0,et=2*i*d,l=0;l<i;l++)for(var ct=a[l].clusterId,T=0;T<i;T++){var Ct=a[T].clusterId;if(!(l===T||ct!==Ct)){var Mt=a[l].clusterInertial*a[T].clusterInertial/Math.pow(et,2)-E[l][T]/et;U+=Mt}}return Number(U.toFixed(4))},bt=function(a,e,i,s,l,f,d,v,w){e===void 0&&(e=!1),i===void 0&&(i="weight"),s===void 0&&(s=1e-4),l===void 0&&(l=!1),f===void 0&&(f=void 0),d===void 0&&(d=[]),v===void 0&&(v=["id"]),w===void 0&&(w=1);var E=a.nodes,T=E===void 0?[]:E,G=a.edges,U=G===void 0?[]:G,et=[];if(l){T.forEach(function(xa,ja){xa.properties=xa.properties||{},xa.originIndex=ja});var ct=[];T.every(function(xa){return xa.hasOwnProperty("nodeType")})&&(ct=Array.from(new Set(T.map(function(xa){return xa.nodeType}))),T.forEach(function(xa){xa.properties.nodeType=ct.findIndex(function(ja){return ja===xa.nodeType})}));var Ct=Zr(T,f);et=Lt(Ct,d,v)}var Mt=1,Dt={},zt={};T.forEach(function(xa,ja){var di=String(Mt++);xa.clusterId=di,Dt[di]={id:di,nodes:[xa]},zt[xa.id]={node:xa,idx:ja}});var Qt=Yt(a,e),Ie=[],je={},ze=0;Qt.forEach(function(xa,ja){var di=0,hi=T[ja].id;je[hi]={},xa.forEach(function(qi,fo){if(!!qi){di+=qi;var es=T[fo].id;je[hi][es]=qi,ze+=qi}}),Ie.push(di)}),ze/=2;for(var mn=Infinity,$n=Infinity,Tn=0,or=[],kr={};;){l&&T.every(function(xa){return xa.hasOwnProperty("properties")})?mn=H(T,Qt,Ie,ze)+Y(T,et)*w:mn=H(T,Qt,Ie,ze),Tn===0&&($n=mn,or=T,kr=Dt);var Ta=mn>0&&mn>$n&&mn-$n<s;if(mn>$n&&(or=T.map(function(xa){return{node:xa,clusterId:xa.clusterId}}),kr=(0,_.clone)(Dt),$n=mn),Ta||Tn>100)break;Tn++,Object.keys(Dt).forEach(function(xa){var ja=0;U.forEach(function(di){var hi=di.source,qi=di.target,fo=zt[hi].node.clusterId,es=zt[qi].node.clusterId;(fo===xa&&es!==xa||es===xa&&fo!==xa)&&(ja=ja+(di[i]||1))}),Dt[xa].sumTot=ja}),T.forEach(function(xa,ja){var di=Dt[xa.clusterId],hi=0,qi,fo=Ie[ja]/(2*ze),es=0,Bs=di.nodes;Bs.forEach(function(Ef){var Ac=zt[Ef.id].idx;es+=Qt[ja][Ac]||0});var cl=es-di.sumTot*fo,Fu=Bs.filter(function(Ef){return Ef.id!==xa.id}),fl=[];Fu.forEach(function(Ef,Ac){fl[Ac]=et[Ef.originIndex]});var El=Y(Fu,et)*w,ec=je[xa.id];if(Object.keys(ec).forEach(function(Ef){var Ac=zt[Ef].node,Gh=Ac.clusterId;if(Gh!==xa.clusterId){var Sf=Dt[Gh],Qf=Sf.nodes;if(!(!Qf||!Qf.length)){var Qs=0;Qf.forEach(function(su){var Iu=zt[su.id].idx;Qs+=Qt[ja][Iu]||0});var Ju=Qs-Sf.sumTot*fo,Js=Qf.concat([xa]),Xu=[];Js.forEach(function(su,Iu){Xu[Iu]=et[su.originIndex]});var Il=Y(Js,et)*w,Fo=Ju-cl;l&&(Fo=Ju+Il-(cl+El)),Fo>hi&&(hi=Fo,qi=Sf)}}}),hi>0){qi.nodes.push(xa);var Gl=xa.clusterId;xa.clusterId=qi.id;var Dp=di.nodes.indexOf(xa);di.nodes.splice(Dp,1);var wf=0,Op=0;U.forEach(function(Ef){var Ac=Ef.source,Gh=Ef.target,Sf=zt[Ac].node.clusterId,Qf=zt[Gh].node.clusterId;(Sf===qi.id&&Qf!==qi.id||Qf===qi.id&&Sf!==qi.id)&&(wf=wf+(Ef[i]||1)),(Sf===Gl&&Qf!==Gl||Qf===Gl&&Sf!==Gl)&&(Op=Op+(Ef[i]||1))}),qi.sumTot=wf,di.sumTot=Op}})}var fi={},ei=0;Object.keys(kr).forEach(function(xa){var ja=kr[xa];if(!ja.nodes||!ja.nodes.length){delete kr[xa];return}var di=String(ei+1);di!==xa&&(ja.id=di,ja.nodes=ja.nodes.map(function(hi){return{id:hi.id,clusterId:di}}),kr[di]=ja,fi[xa]=di,delete kr[xa],ei++)}),or.forEach(function(xa){var ja=xa.node,di=xa.clusterId;!ja||(ja.clusterId=di,ja.clusterId&&fi[ja.clusterId]&&(ja.clusterId=fi[ja.clusterId]))});var Ia=[],Gi={};U.forEach(function(xa){var ja=xa.source,di=xa.target,hi=xa[i]||1,qi=zt[ja].node.clusterId,fo=zt[di].node.clusterId;if(!(!qi||!fo)){var es="".concat(qi,"---").concat(fo);if(Gi[es])Gi[es].weight+=hi,Gi[es].count++;else{var Bs={source:qi,target:fo,weight:hi,count:1};Gi[es]=Bs,Ia.push(Bs)}}});var Ri=[];return Object.keys(kr).forEach(function(xa){Ri.push(kr[xa])}),{clusters:Ri,clusterEdges:Ia}},$t=bt,jt=function(a,e,i,s,l,f,d,v){return e===void 0&&(e=!1),i===void 0&&(i="weight"),s===void 0&&(s=1e-4),l===void 0&&(l=void 0),f===void 0&&(f=[]),d===void 0&&(d=["id"]),v===void 0&&(v=1),$t(a,e,i,s,!0,l,f,d,v)},Ht=jt,re=function(a,e){var i;e===void 0&&(e=1);for(var s=(0,_.clone)(a),l=s.nodes,f=l===void 0?[]:l,d=s.edges,v=d===void 0?[]:d,w=function(){var G=Ne({nodes:f,edges:v}),U=Object.keys(G);U.sort(function(Ct,Mt){var Dt,zt;return((Dt=G[Ct])===null||Dt===void 0?void 0:Dt.degree)-((zt=G[Mt])===null||zt===void 0?void 0:zt.degree)});var et=U[0];if(!f.length||((i=G[et])===null||i===void 0?void 0:i.degree)>=e)return"break";var ct=f.findIndex(function(Ct){return Ct.id===et});f.splice(ct,1),v=v.filter(function(Ct){return!(Ct.source===et||Ct.target===et)})};;){var E=w();if(E==="break")break}return{nodes:f,edges:v}},on=re,Je=function(a,e,i){var s=[];switch(a){case _n.EuclideanDistance:s=e[i];break;default:s=[];break}return s},Ve=function(a,e,i,s,l,f){e===void 0&&(e=3),i===void 0&&(i=void 0),s===void 0&&(s=[]),l===void 0&&(l=["id"]),f===void 0&&(f=_n.EuclideanDistance);var d=a.nodes,v=d===void 0?[]:d,w=a.edges,E=w===void 0?[]:w,T={clusters:[{id:"0",nodes:v}],clusterEdges:[]};if(f===_n.EuclideanDistance&&!v.every(function(di){return di.hasOwnProperty(i)}))return T;var G=[],U=[];if(f===_n.EuclideanDistance&&(G=Zr(v,i),U=Lt(G,s,l)),!U.length)return T;for(var et=(0,_.uniq)(U.map(function(di){return di.join("")})),ct=Math.min(e,v.length,et.length),Ct=0;Ct<v.length;Ct++)v[Ct].originIndex=Ct;for(var Mt=[],Dt=[],zt=[],Ct=0;Ct<ct;Ct++)if(Ct===0){var Qt=Math.floor(Math.random()*v.length);switch(f){case _n.EuclideanDistance:Mt[Ct]=U[Qt];break;default:Mt[Ct]=[];break}Dt.push(Qt),zt[Ct]=[v[Qt]],v[Qt].clusterId=String(Ct)}else{for(var Ie=-Infinity,je=0,ze=function(qi){if(!Dt.includes(qi)){for(var fo=0,es=0;es<Mt.length;es++){var Bs=0;switch(f){case _n.EuclideanDistance:Bs=kt(U[v[qi].originIndex],Mt[es],f);break;default:break}fo+=Bs}var cl=fo/Mt.length;cl>Ie&&!Mt.find(function(Fu){return(0,_.isEqual)(Fu,Je(f,U,v[qi].originIndex))})&&(Ie=cl,je=qi)}},mn=0;mn<v.length;mn++)ze(mn);Mt[Ct]=Je(f,U,je),Dt.push(je),zt[Ct]=[v[je]],v[je].clusterId=String(Ct)}for(var $n=0;;){for(var Ct=0;Ct<v.length;Ct++){var Tn=0,or=Infinity;if(!($n===0&&Dt.includes(Ct))){for(var kr=0;kr<Mt.length;kr++){var Ta=0;switch(f){case _n.EuclideanDistance:Ta=kt(U[Ct],Mt[kr],f);break;default:break}Ta<or&&(or=Ta,Tn=kr)}if(v[Ct].clusterId!==void 0)for(var fi=zt[Number(v[Ct].clusterId)].length-1;fi>=0;fi--)zt[Number(v[Ct].clusterId)][fi].id===v[Ct].id&&zt[Number(v[Ct].clusterId)].splice(fi,1);v[Ct].clusterId=String(Tn),zt[Tn].push(v[Ct])}}for(var ei=!1,Ct=0;Ct<zt.length;Ct++){for(var Ia=zt[Ct],Gi=new lr([]),kr=0;kr<Ia.length;kr++)Gi=Gi.add(new lr(U[Ia[kr].originIndex]));var Ri=Gi.avg(Ia.length);Ri.equal(new lr(Mt[Ct]))||(ei=!0,Mt[Ct]=Ri.getArr())}if($n++,v.every(function(di){return di.clusterId!==void 0})&&ei||$n>=1e3)break}var xa=[],ja={};return E.forEach(function(di){var hi,qi,fo=di.source,es=di.target,Bs=(hi=v.find(function(El){return El.id===fo}))===null||hi===void 0?void 0:hi.clusterId,cl=(qi=v.find(function(El){return El.id===es}))===null||qi===void 0?void 0:qi.clusterId,Fu="".concat(Bs,"---").concat(cl);if(ja[Fu])ja[Fu].count++;else{var fl={source:Bs,target:cl,count:1};ja[Fu]=fl,xa.push(fl)}}),{clusters:zt,clusterEdges:xa}},qn=Ve,Ln=function(a,e){var i=new lr(e),s=i.norm2(),l=new lr(a),f=l.norm2(),d=i.dot(l),v=s*f,w=v?d/v:0;return w},qr=Ln,Ca=function(a,e,i,s,l){a===void 0&&(a=[]),i===void 0&&(i=void 0),s===void 0&&(s=[]),l===void 0&&(l=[]);var f=(0,_.clone)(a.filter(function(G){return G.id!==e.id})),d=a.findIndex(function(G){return G.id===e.id}),v=Zr(a,i),w=Lt(v,s,l),E=w[d],T=[];return f.forEach(function(G,U){if(G.id!==e.id){var et=w[U],ct=qr(et,E);T.push(ct),G.cosineSimilarity=ct}}),f.sort(function(G,U){return U.cosineSimilarity-G.cosineSimilarity}),{allCosineSimilarity:T,similarNodes:f}},Qn=Ca,_r=function(){function c(a){this.count=a.length,this.parent={};for(var e=0,i=a;e<i.length;e++){var s=i[e];this.parent[s]=s}}return c.prototype.find=function(a){for(;this.parent[a]!==a;)a=this.parent[a];return a},c.prototype.union=function(a,e){var i=this.find(a),s=this.find(e);i!==s&&(i<s?(this.parent[e]!==e&&this.union(this.parent[e],a),this.parent[e]=this.parent[a]):(this.parent[a]!==a&&this.union(this.parent[a],e),this.parent[a]=this.parent[e]))},c.prototype.connected=function(a,e){return this.find(a)===this.find(e)},c}(),ea=_r,La=function(a,e){return a-e},ha=function(){function c(a){a===void 0&&(a=La),this.compareFn=a,this.list=[]}return c.prototype.getLeft=function(a){return 2*a+1},c.prototype.getRight=function(a){return 2*a+2},c.prototype.getParent=function(a){return a===0?null:Math.floor((a-1)/2)},c.prototype.isEmpty=function(){return this.list.length<=0},c.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},c.prototype.delMin=function(){var a=this.top(),e=this.list.pop();return this.list.length>0&&(this.list[0]=e,this.moveDown(0)),a},c.prototype.insert=function(a){if(a!==null){this.list.push(a);var e=this.list.length-1;return this.moveUp(e),!0}return!1},c.prototype.moveUp=function(a){for(var e=this.getParent(a);a&&a>0&&this.compareFn(this.list[e],this.list[a])>0;){var i=this.list[e];this.list[e]=this.list[a],this.list[a]=i,a=e,e=this.getParent(a)}},c.prototype.moveDown=function(a){var e,i=a,s=this.getLeft(a),l=this.getRight(a),f=this.list.length;s!==null&&s<f&&this.compareFn(this.list[i],this.list[s])>0?i=s:l!==null&&l<f&&this.compareFn(this.list[i],this.list[l])>0&&(i=l),a!==i&&(e=[this.list[i],this.list[a]],this.list[a]=e[0],this.list[i]=e[1],this.moveDown(i))},c}(),_i=ha,Ni=function(a,e){var i=[],s=a.nodes,l=s===void 0?[]:s,f=a.edges,d=f===void 0?[]:f;if(l.length===0)return i;var v=l[0],w=new Set;w.add(v);var E=function(Ct,Mt){return e?Ct.weight-Mt.weight:0},T=new _i(E);for(He(v.id,d).forEach(function(ct){T.insert(ct)});!T.isEmpty();){var G=T.delMin(),U=G.source,et=G.target;w.has(U)&&w.has(et)||(i.push(G),w.has(U)||(w.add(U),He(U,d).forEach(function(ct){T.insert(ct)})),w.has(et)||(w.add(et),He(et,d).forEach(function(ct){T.insert(ct)})))}return i},vi=function(a,e){var i=[],s=a.nodes,l=s===void 0?[]:s,f=a.edges,d=f===void 0?[]:f;if(l.length===0)return i;var v=d.map(function(U){return U});e&&v.sort(function(U,et){return U.weight-et.weight});for(var w=new ea(l.map(function(U){return U.id}));v.length>0;){var E=v.shift(),T=E.source,G=E.target;w.connected(T,G)||(i.push(E),w.union(T,G))}return i},si=function(a,e,i){var s={prim:Ni,kruskal:vi};return i?s[i](a,e):vi(a,e)},Mi=si,Pa=function(a,e,i){typeof e!="number"&&(e=1e-6),typeof i!="number"&&(i=.85);for(var s=1,l=0,f=1e3,d=a.nodes,v=d===void 0?[]:d,w=a.edges,E=w===void 0?[]:w,T=v.length,G,U={},et={},ct=0;ct<T;++ct){var Ct=v[ct],Mt=Ct.id;U[Mt]=1/T,et[Mt]=1/T}for(var Dt=Ne(a);f>0&&s>e;){l=0;for(var ct=0;ct<T;++ct){var Ct=v[ct],Mt=Ct.id;if(G=0,Dt[Ct.id].inDegree===0)U[Mt]=0;else{for(var zt=fe(Mt,E,"source"),Qt=0;Qt<zt.length;++Qt){var Ie=zt[Qt],je=Dt[Ie].outDegree;je>0&&(G+=et[Ie]/je)}U[Mt]=i*G,l+=U[Mt]}}l=(1-l)/T,s=0;for(var ct=0;ct<T;++ct){var Ct=v[ct],Mt=Ct.id;G=U[Mt]+l,s+=Math.abs(G-et[Mt]),et[Mt]=G}f-=1}return et},un=Pa,Oe=-1,hn=-1,Hn="-1",Bn="-1",Jn=-1,Lr="-1",ya=function(){function c(a,e,i,s){a===void 0&&(a=Oe),e===void 0&&(e=hn),i===void 0&&(i=hn),s===void 0&&(s=Hn),this.id=a,this.from=e,this.to=i,this.label=s}return c}(),Fa=function(){function c(a,e){a===void 0&&(a=hn),e===void 0&&(e=Bn),this.id=a,this.label=e,this.edges=[],this.edgeMap={}}return c.prototype.addEdge=function(a){this.edges.push(a),this.edgeMap[a.id]=a},c}(),ui=function(){function c(a,e,i){a===void 0&&(a=hn),e===void 0&&(e=!0),i===void 0&&(i=!1),this.id=a,this.edgeIdAutoIncrease=e,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=i}return c.prototype.getNodeNum=function(){return this.nodes.length},c.prototype.addNode=function(a,e){if(!this.nodeMap[a]){var i=new Fa(a,e);this.nodes.push(i),this.nodeMap[a]=i,this.nodeLabelMap[e]||(this.nodeLabelMap[e]=[]),this.nodeLabelMap[e].push(a)}},c.prototype.addEdge=function(a,e,i,s){if((this.edgeIdAutoIncrease||a===void 0)&&(a=this.counter++),!(this.nodeMap[e]&&this.nodeMap[i]&&this.nodeMap[i].edgeMap[a])){var l=new ya(a,e,i,s);if(this.edges.push(l),this.edgeMap[a]=l,this.nodeMap[e].addEdge(l),this.edgeLabelMap[s]||(this.edgeLabelMap[s]=[]),this.edgeLabelMap[s].push(l),!this.directed){var f=new ya(a,i,e,s);this.nodeMap[i].addEdge(f),this.edgeLabelMap[s].push(f)}}},c}(),Ei=function(){function c(a,e,i,s,l){this.fromNode=a,this.toNode=e,this.nodeEdgeNodeLabel={nodeLabel1:i||Bn,edgeLabel:s||Hn,nodeLabel2:l||Bn}}return c.prototype.equalTo=function(a){return this.fromNode===a.formNode&&this.toNode===a.toNode&&this.nodeEdgeNodeLabel===a.nodeEdgeNodeLabel},c.prototype.notEqualTo=function(a){return!this.equalTo(a)},c}(),oo=function(){function c(){this.rmpath=[],this.dfsEdgeList=[]}return c.prototype.equalTo=function(a){var e=this.dfsEdgeList.length,i=a.length;if(e!==i)return!1;for(var s=0;s<e;s++)if(this.dfsEdgeList[s]!==a[s])return!1;return!0},c.prototype.notEqualTo=function(a){return!this.equalTo(a)},c.prototype.pushBack=function(a,e,i,s,l){return this.dfsEdgeList.push(new Ei(a,e,i,s,l)),this.dfsEdgeList},c.prototype.toGraph=function(a,e){a===void 0&&(a=Jn),e===void 0&&(e=!1);var i=new ui(a,!0,e);return this.dfsEdgeList.forEach(function(s){var l=s.fromNode,f=s.toNode,d=s.nodeEdgeNodeLabel,v=d.nodeLabel1,w=d.edgeLabel,E=d.nodeLabel2;v!==Bn&&i.addNode(l,v),E!==Bn&&i.addNode(f,E),v!==Bn&&E!==v&&i.addEdge(void 0,l,f,w)}),i},c.prototype.buildRmpath=function(){this.rmpath=[];for(var a=void 0,e=this.dfsEdgeList.length,i=e-1;i>=0;i--){var s=this.dfsEdgeList[i],l=s.fromNode,f=s.toNode;l<f&&(a===void 0||f===a)&&(this.rmpath.push(i),a=l)}return this.rmpath},c.prototype.getNodeNum=function(){var a={};return this.dfsEdgeList.forEach(function(e){a[e.fromNode]||(a[e.fromNode]=!0),a[e.toNode]||(a[e.toNode]=!0)}),Object.keys(a).length},c}(),po=function(){function c(a){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],!!a){for(;a;){var e=a.edge;this.edges.push(e),this.nodesUsed[e.from]=1,this.nodesUsed[e.to]=1,this.edgesUsed[e.id]=1,a=a.preNode}this.edges=this.edges.reverse()}}return c.prototype.hasNode=function(a){return this.nodesUsed[a.id]===1},c.prototype.hasEdge=function(a){return this.edgesUsed[a.id]===1},c}(),bo=function(){function c(a){var e=a.graphs,i=a.minSupport,s=i===void 0?2:i,l=a.minNodeNum,f=l===void 0?1:l,d=a.maxNodeNum,v=d===void 0?4:d,w=a.top,E=w===void 0?10:w,T=a.directed,G=T===void 0?!1:T,U=a.verbose,et=U===void 0?!1:U;this.graphs=e,this.dfsCode=new oo,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=s,this.top=E,this.directed=G,this.counter=0,this.maxNodeNum=v,this.minNodeNum=f,this.verbose=et,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return c.prototype.findForwardRootEdges=function(a,e){var i=this,s=[],l=a.nodeMap;return e.edges.forEach(function(f){(i.directed||e.label<=l[f.to].label)&&s.push(f)}),s},c.prototype.findBackwardEdge=function(a,e,i,s){if(!this.directed&&e===i)return null;for(var l=a.nodeMap,f=l[i.to],d=f.edges,v=d.length,w=0;w<v;w++){var E=d[w];if(!(s.hasEdge(E)||E.to!==e.from)){if(this.directed){if(l[e.from].label<l[i.to].label||l[e.from].label===l[i.to].label&&e.label<=E.label)return E}else if(e.label<E.label||e.label===E.label&&l[e.to].label<=l[i.to].label)return E}}return null},c.prototype.findForwardPureEdges=function(a,e,i,s){for(var l=[],f=e.to,d=a.nodeMap[f].edges,v=d.length,w=0;w<v;w++){var E=d[w],T=a.nodeMap[E.to];i<=T.label&&!s.hasNode(T)&&l.push(E)}return l},c.prototype.findForwardRmpathEdges=function(a,e,i,s){for(var l=[],f=a.nodeMap,d=f[e.to].label,v=f[e.from],w=v.edges,E=w.length,T=0;T<E;T++){var G=w[T],U=f[G.to].label;e.to===G.to||i>U||s.hasNode(f[G.to])||(e.label<G.label||e.label===G.label&&d<=U)&&l.push(G)}return l},c.prototype.getSupport=function(a){var e={};return a.forEach(function(i){e[i.graphId]||(e[i.graphId]=!0)}),Object.keys(e).length},c.prototype.findMinLabel=function(a){var e=void 0;return Object.keys(a).forEach(function(i){var s=a[i],l=s.nodeLabel1,f=s.edgeLabel,d=s.nodeLabel2;if(!e){e={nodeLabel1:l,edgeLabel:f,nodeLabel2:d};return}(l<e.nodeLabel1||l===e.nodeLabel1&&f<e.edgeLabel||l===e.nodeLabel1&&f===e.edgeLabel&&d<e.nodeLabel2)&&(e={nodeLabel1:l,edgeLabel:f,nodeLabel2:d})}),e},c.prototype.isMin=function(){var a=this,e=this.dfsCode;if(this.verbose&&console.log("isMin checking",e),e.dfsEdgeList.length===1)return!0;var i=this.directed,s=e.toGraph(Jn,i),l=s.nodeMap,f=new oo,d={};s.nodes.forEach(function(T){var G=a.findForwardRootEdges(s,T);G.forEach(function(U){var et=l[U.to],ct="".concat(T.label,"-").concat(U.label,"-").concat(et.label);d[ct]||(d[ct]={projected:[],nodeLabel1:T.label,edgeLabel:U.label,nodeLabel2:et.label});var Ct={graphId:s.id,edge:U,preNode:null};d[ct].projected.push(Ct)})});var v=this.findMinLabel(d);if(!!v){f.dfsEdgeList.push(new Ei(0,1,v.nodeLabel1,v.edgeLabel,v.nodeLabel2));var w=function T(G){for(var U=f.buildRmpath(),et=f.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,ct=f.dfsEdgeList[U[0]].toNode,Ct={},Mt=!1,Dt=0,zt=i?-1:0,Qt=function(Gi){if(Mt)return"break";G.forEach(function(Ri){var xa=new po(Ri),ja=a.findBackwardEdge(s,xa.edges[U[Gi]],xa.edges[U[0]],xa);ja&&(Ct[ja.label]||(Ct[ja.label]={projected:[],edgeLabel:ja.label}),Ct[ja.label].projected.push({graphId:s.id,edge:Ct,preNode:Ri}),Dt=f.dfsEdgeList[U[Gi]].fromNode,Mt=!0)})},Ie=U.length-1;Ie>zt;Ie--){var je=Qt(Ie);if(je==="break")break}if(Mt){var ze=a.findMinLabel(Ct);f.dfsEdgeList.push(new Ei(ct,Dt,Bn,ze.edgeLabel,Bn));var mn=f.dfsEdgeList.length-1;return a.dfsCode.dfsEdgeList[mn]!==f.dfsEdgeList[mn]?!1:T(Ct[ze.edgeLabel].projected)}var $n={};Mt=!1;var Tn=0;G.forEach(function(Ia){var Gi=new po(Ia),Ri=a.findForwardPureEdges(s,Gi.edges[U[0]],et,Gi);Ri.length>0&&(Mt=!0,Tn=ct,Ri.forEach(function(xa){var ja="".concat(xa.label,"-").concat(l[xa.to].label);$n[ja]||($n[ja]={projected:[],edgeLabel:xa.label,nodeLabel2:l[xa.to].label}),$n[ja].projected.push({graphId:s.id,edge:xa,preNode:Ia})}))});for(var or=U.length,kr=function(Gi){if(Mt)return"break";var Ri=U[Gi];G.forEach(function(xa){var ja=new po(xa),di=a.findForwardRmpathEdges(s,ja.edges[Ri],et,ja);di.length>0&&(Mt=!0,Tn=f.dfsEdgeList[Ri].fromNode,di.forEach(function(hi){var qi="".concat(hi.label,"-").concat(l[hi.to].label);$n[qi]||($n[qi]={projected:[],edgeLabel:hi.label,nodeLabel2:l[hi.to].label}),$n[qi].projected.push({graphId:s.id,edge:hi,preNode:xa})}))})},Ie=0;Ie<or;Ie++){var Ta=kr(Ie);if(Ta==="break")break}if(!Mt)return!0;var fi=a.findMinLabel($n);f.dfsEdgeList.push(new Ei(Tn,ct+1,Bn,fi.edgeLabel,fi.nodeLabel2));var ei=f.dfsEdgeList.length-1;return e.dfsEdgeList[ei]!==f.dfsEdgeList[ei]?!1:T($n["".concat(fi.edgeLabel,"-").concat(fi.nodeLabel2)].projected)},E="".concat(v.nodeLabel1,"-").concat(v.edgeLabel,"-").concat(v.nodeLabel2);return w(d[E].projected)}},c.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var a=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push((0,_.clone)(a))}},c.prototype.subGraphMining=function(a){var e=this,i=this.getSupport(a);if(!(i<this.minSupport)&&!!this.isMin()){this.report();var s=this.dfsCode.getNodeNum(),l=this.dfsCode.buildRmpath(),f=this.dfsCode.dfsEdgeList[l[0]].toNode,d=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,v={},w={};a.forEach(function(E){for(var T=e.graphs[E.graphId],G=T.nodeMap,U=new po(E),et=l.length-1;et>=0;et--){var ct=e.findBackwardEdge(T,U.edges[l[et]],U.edges[l[0]],U);if(ct){var Ct="".concat(e.dfsCode.dfsEdgeList[l[et]].fromNode,"-").concat(ct.label);w[Ct]||(w[Ct]={projected:[],toNodeId:e.dfsCode.dfsEdgeList[l[et]].fromNode,edgeLabel:ct.label}),w[Ct].projected.push({graphId:E.graphId,edge:ct,preNode:E})}}if(!(s>=e.maxNodeNum)){var Mt=e.findForwardPureEdges(T,U.edges[l[0]],d,U);Mt.forEach(function(zt){var Qt="".concat(f,"-").concat(zt.label,"-").concat(G[zt.to].label);v[Qt]||(v[Qt]={projected:[],fromNodeId:f,edgeLabel:zt.label,nodeLabel2:G[zt.to].label}),v[Qt].projected.push({graphId:E.graphId,edge:zt,preNode:E})});for(var Dt=function(Qt){var Ie=e.findForwardRmpathEdges(T,U.edges[l[Qt]],d,U);Ie.forEach(function(je){var ze="".concat(e.dfsCode.dfsEdgeList[l[Qt]].fromNode,"-").concat(je.label,"-").concat(G[je.to].label);v[ze]||(v[ze]={projected:[],fromNodeId:e.dfsCode.dfsEdgeList[l[Qt]].fromNode,edgeLabel:je.label,nodeLabel2:G[je.to].label}),v[ze].projected.push({graphId:E.graphId,edge:je,preNode:E})})},et=0;et<l.length;et++)Dt(et)}}),Object.keys(w).forEach(function(E){var T=w[E],G=T.toNodeId,U=T.edgeLabel;e.dfsCode.dfsEdgeList.push(new Ei(f,G,"-1",U,"-1")),e.subGraphMining(w[E].projected),e.dfsCode.dfsEdgeList.pop()}),Object.keys(v).forEach(function(E){var T=v[E],G=T.fromNodeId,U=T.edgeLabel,et=T.nodeLabel2;e.dfsCode.dfsEdgeList.push(new Ei(G,f+1,Bn,U,et)),e.subGraphMining(v[E].projected),e.dfsCode.dfsEdgeList.pop()})}},c.prototype.generate1EdgeFrequentSubGraphs=function(){var a=this.graphs,e=this.directed,i=this.minSupport,s=this.frequentSize1Subgraphs,l={},f={},d={},v={};return Object.keys(a).forEach(function(w){var E=a[w],T=E.nodeMap;E.nodes.forEach(function(G,U){var et=G.label,ct="".concat(w,"-").concat(et);if(!d[ct]){var Ct=l[et]||0;Ct++,l[et]=Ct}d[ct]={graphKey:w,label:et},G.edges.forEach(function(Mt){var Dt=et,zt=T[Mt.to].label;if(!e&&Dt>zt){var Qt=zt;zt=Dt,Dt=Qt}var Ie=Mt.label,je="".concat(w,"-").concat(Dt,"-").concat(Ie,"-").concat(zt),ze="".concat(Dt,"-").concat(Ie,"-").concat(zt);if(!f[ze]){var mn=f[ze]||0;mn++,f[ze]=mn}v[je]={graphId:w,nodeLabel1:Dt,edgeLabel:Ie,nodeLabel2:zt}})})}),Object.keys(l).forEach(function(w){var E=l[w];if(!(E<i)){var T={nodes:[],edges:[]};T.nodes.push({id:"0",label:w}),s.push(T)}}),s},c.prototype.run=function(){var a=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var e=this.graphs,i=this.directed,s={};Object.keys(e).forEach(function(l){var f=e[l],d=f.nodeMap;f.nodes.forEach(function(v){var w=a.findForwardRootEdges(f,v);w.forEach(function(E){var T=d[E.to],G="".concat(v.label,"-").concat(E.label,"-").concat(T.label);s[G]||(s[G]={projected:[],nodeLabel1:v.label,edgeLabel:E.label,nodeLabel2:T.label});var U={graphId:l,edge:E,preNode:null};s[G].projected.push(U)})})}),Object.keys(s).forEach(function(l){var f=s[l],d=f.projected,v=f.nodeLabel1,w=f.edgeLabel,E=f.nodeLabel2;a.dfsCode.dfsEdgeList.push(new Ei(0,1,v,w,E)),a.subGraphMining(d),a.dfsCode.dfsEdgeList.pop()})}},c}(),ts=function(a,e,i,s){var l={};return Object.keys(a).forEach(function(f,d){var v=a[f],w=new ui(d,!0,e),E={};v.nodes.forEach(function(T,G){w.addNode(G,T[i]),E[T.id]=G}),v.edges.forEach(function(T,G){var U=E[T.source],et=E[T.target];w.addEdge(-1,U,et,T[s])}),w&&w.getNodeNum()&&(l[w.id]=w)}),l},Wo=function(a,e,i){var s=[];return a.forEach(function(l){var f={nodes:[],edges:[]};l.nodes.forEach(function(d){var v;f.nodes.push((v={id:"".concat(d.id)},v[e]=d.label,v))}),l.edges.forEach(function(d){var v;f.edges.push((v={source:"".concat(d.from),target:"".concat(d.to)},v[i]=d.label,v))}),s.push(f)}),s},Yi="cluster",wi=function(a){var e=a.graphs,i=a.directed,s=i===void 0?!1:i,l=a.nodeLabelProp,f=l===void 0?Yi:l,d=a.edgeLabelProp,v=d===void 0?Yi:d,w=ts(e,s,f,v),E=a.minSupport,T=a.maxNodeNum,G=a.minNodeNum,U=a.verbose,et=a.top,ct={graphs:w,minSupport:E,maxNodeNum:T,minNodeNum:G,top:et,verbose:U,directed:s},Ct=new bo(ct);Ct.run();var Mt=Wo(Ct.frequentSubgraphs,f,v);return Mt},gi=wi,us=function(a,e,i,s){i===void 0&&(i="cluster"),s===void 0&&(s=2);var l=[],f=a.nodes;return e.forEach(function(d,v){l.push(Do(f,d,v,i,s))}),l},Do=function(a,e,i,s,l){var f=[i],d=[],v={};return e.forEach(function(w,E){if(w<=l&&i!==E){f.push(E),d.push(a[E]);var T=a[E][s];v[T]?(v[T].count++,v[T].dists.push(w)):v[T]={count:1,dists:[w]}}}),Object.keys(v).forEach(function(w){v[w].dists=v[w].dists.sort(function(E,T){return E-T})}),{nodeIdx:i,nodeId:a[i].id,nodeIdxs:f,neighbors:d,neighborNum:f.length-1,nodeLabelCountMap:v}},Io=function(a,e,i,s,l){var f=Math.ceil(i/e),d={},v=0;return s.forEach(function(w,E){for(var T=0,G=0,U=w.nodeIdxs,et=w.neighborNum-1;T<f;){for(var ct=U[1+Math.floor(Math.random()*et)],Ct=0;(d["".concat(E,"-").concat(ct)]||d["".concat(ct,"-").concat(E)])&&(ct=Math.floor(Math.random()*e),Ct++,!(Ct>2*e)););if(Ct<2*e&&(d["".concat(E,"-").concat(ct)]={start:E,end:ct,distance:l[E][ct]},T++,v++,v>=i))return d;if(G++,G>2*e)break}if(T<f){var Mt=f-T;f=(f+Mt)/(e-E-1)}}),d},zs=function(a,e,i,s){var l=i.nodes;return s||(s={}),Object.keys(a).forEach(function(f){var d,v;if(!(s&&s[f])){s[f]={nodes:[],edges:[]};var w=a[f],E=(d=e[w.start])===null||d===void 0?void 0:d.nodeIdxs,T=(v=e[w.end])===null||v===void 0?void 0:v.nodeIdxs;if(!(!E||!T)){var G=new Set(T),U=E.filter(function(Dt){return G.has(Dt)});if(!(!U||!U.length)){for(var et={},ct=U.length,Ct=0;Ct<ct;Ct++){var Mt=l[U[Ct]];s[f].nodes.push(Mt),et[Mt.id]=!0}i.edges.forEach(function(Dt){et[Dt.source]&&et[Dt.target]&&s[f].edges.push(Dt)})}}}}),s},mu=function(a,e,i,s){var l,f,d={};a.nodes.forEach(function(w){d[w.id]=w});var v=0;return!((l=e==null?void 0:e.edges)===null||l===void 0?void 0:l.length)||((f=e==null?void 0:e.nodes)===null||f===void 0?void 0:f.length)<2?0:(a.edges.forEach(function(w){var E=d[w.source][i],T=d[w.target][i],G=e==null?void 0:e.nodes[0][i],U=e==null?void 0:e.nodes[1][i],et=e==null?void 0:e.edges[0][s];w[s]===et&&(E===G&&T===U||E===U&&T===G)&&v++}),v)},ds=function(a,e,i){for(var s=Infinity,l=0,f=function(w){var E=a[w],T=Object.keys(E).sort(function(Dt,zt){return E[Dt]-E[zt]}),G=10,U=[];T.forEach(function(Dt,zt){U[zt%G]||(U[zt%G]={graphs:[],totalCount:0,aveCount:0}),U[zt%G].graphs.push(Dt),U[zt%G].totalCount+=E[Dt]});var et=0,ct=[];U.forEach(function(Dt){var zt=Dt.totalCount/Dt.graphs.length;Dt.aveCount=zt,ct.push(zt);var Qt=0,Ie=Dt.length;Dt.graphs.forEach(function(je,ze){var mn=E[je];Dt.graphs.forEach(function($n,Tn){ze!==Tn&&(Qt+=Math.abs(mn-E[$n]))})}),Qt/=Ie*(Ie-1)/2,et+=Qt}),et/=U.length;var Ct=0;ct.forEach(function(Dt,zt){ct.forEach(function(Qt,Ie){zt!==Ie&&(Ct+=Math.abs(Dt-Qt))}),Ct/=ct.length*(ct.length-1)/2});var Mt=Ct-et;s<Mt&&(s=Mt,l=w)},d=0;d<e;d++)f(d);return{structure:i[l],structureCountMap:a[l]}},Ms=function(a,e){var i={},s={};return a.forEach(function(l,f){i[l.id]={idx:f,node:l,degree:0,inDegree:0,outDegree:0};var d=l[e];s[d]||(s[d]=[]),s[d].push(l)}),{nodeMap:i,nodeLabelMap:s}},yu=function(a,e,i){var s={},l={};return a.forEach(function(f,d){s["".concat(pe)]={idx:d,edge:f};var v=f[e];l[v]||(l[v]=[]),l[v].push(f);var w=i[f.source];w&&(w.degree++,w.outDegree++);var E=i[f.target];E&&(E.degree++,E.inDegree++)}),{edgeMap:s,edgeLabelMap:l}},uu=function(a,e,i){var s=e.length,l={};return e.forEach(function(f,d){for(var v=i?0:d+1,w=a[d].id,E=v;E<s;E++)if(d!==E){var T=a[E].id,G=f[E];l["".concat(w,"-").concat(T)]=G,i||(l["".concat(T,"-").concat(w)]=G)}}),l},Cs=function(a,e,i,s,l,f,d,v,w,E,T){var G,U="".concat(e.id,"-").concat(i.id);if(E&&E[U])return E[U];var et=T?T[U]:void 0;if(!et){var ct=(G={},G[U]={start:s[e.id].idx,end:s[i.id].idx,distance:l},G);T=zs(ct,f,a,T),et=T[U]}return mu(et,d,v,w)},qo=function(a,e,i,s){var l,f,d,v=(l=a[e])===null||l===void 0?void 0:l.degree,w=(f=a[e])===null||f===void 0?void 0:f.inDegree,E=(d=a[e])===null||d===void 0?void 0:d.outDegree;return a[e]===void 0&&(v=Infinity,w=Infinity,E=Infinity,s[e].forEach(function(T){var G=i[T.id].degree;v>G&&(v=G);var U=i[T.id].inDegree;w>U&&(w=U);var et=i[T.id].outDegree;E>et&&(E=et)}),a[e]={degree:v,inDegree:w,outDegree:E}),{minPatternNodeLabelDegree:v,minPatternNodeLabelInDegree:w,minPatternNodeLabelOutDegree:E}},Wi=function(a,e,i,s,l,f,d){var v;if(i===void 0&&(i=!1),f===void 0&&(f="cluster"),d===void 0&&(d="cluster"),!(!a||!a.nodes)){var w=a.nodes.length;if(!!w){var E=Gn(a,i),T=Gn(e,i),G=uu(a.nodes,E,i),U=uu(e.nodes,T,i),et=Ms(a.nodes,f),ct=et.nodeMap,Ct=et.nodeLabelMap,Mt=Ms(e.nodes,f),Dt=Mt.nodeMap,zt=Mt.nodeLabelMap;yu(a.edges,d,ct);var Qt=yu(e.edges,d,Dt).edgeLabelMap,Ie=[];T==null||T.forEach(function(Qs){Ie=Ie.concat(Qs)}),l||(l=Math.max.apply(Math,(0,O.__spreadArray)((0,O.__spreadArray)([],Ie,!1),[2],!1))),s||(s=l);var je=us(a,E,f,s),ze=us(e,T,f,s),mn=Math.min(100,w*(w-1)/2),$n=Io(s,w,mn,je,E),Tn=zs($n,je,a),or=10,kr=1,Ta=1,fi=4,ei={graphs:Tn,nodeLabelProp:f,edgeLabelProp:d,minSupport:kr,minNodeNum:Ta,maxNodeNum:fi,directed:i},Ia=gi(ei).slice(0,or),Gi=Ia.length,Ri=[];Ia.forEach(function(Qs,Ju){Ri[Ju]={},Object.keys(Tn).forEach(function(Js){var Xu=Tn[Js],Il=mu(Xu,Qs,f,d);Ri[Ju][Js]=Il})});var xa=ds(Ri,Gi,Ia),ja=xa.structure,di=xa.structureCountMap,hi=e.nodes[0],qi=[],fo=(v=e.nodes[0])===null||v===void 0?void 0:v[f],es=-Infinity;e.nodes.forEach(function(Qs){var Ju=Qs[f],Js=Ct[Ju];(Js==null?void 0:Js.length)>es&&(es=Js.length,qi=Js,fo=Ju,hi=Qs)});var Bs={},cl={},Fu={},fl={},El={},ec={};Object.keys(zt).forEach(function(Qs,Ju){El[Qs]=[],i&&(ec[Qs]=[]);var Js=-Infinity,Xu=zt[Qs],Il={};Xu.forEach(function(Tu){var Gu=U["".concat(hi.id,"-").concat(Tu.id)];if(Gu&&El[Qs].push(Gu),Js<Gu&&(Js=Gu),Il["".concat(hi.id,"-").concat(Tu.id)]={start:0,end:Dt[Tu.id].idx,distance:Gu},i){var hc=U["".concat(Tu.id,"-").concat(hi.id)];hc&&ec[Qs].push(hc)}}),El[Qs]=El[Qs].sort(function(Tu,Gu){return Tu-Gu}),i&&(ec[Qs]=ec[Qs].sort(function(Tu,Gu){return Tu-Gu})),cl=zs(Il,ze,e,cl);var Fo=[];if(Object.keys(Il).forEach(function(Tu){if(Fu[Tu]){Fo.push(Fu[Tu]);return}var Gu=cl[Tu];Fu[Tu]=mu(Gu,ja,f,d),Fo.push(Fu[Tu])}),Fo=Fo.sort(function(Tu,Gu){return Gu-Tu}),fl["".concat(hi.id,"-").concat(Qs)]=Fo,Qs!==fo)for(var su=(qi==null?void 0:qi.length)||0,Iu=function(Gu){var hc=qi[Gu],Id=je[ct[hc.id].idx],Jc=Id.nodeLabelCountMap[Qs],qg=zt[Qs].length;if(!Jc||Jc.count<qg)return qi.splice(Gu,1),"continue";for(var bg=!1,Uh=0;Uh<qg;Uh++)if(Jc.dists[Uh]>El[Qs][Uh]){bg=!0;break}if(bg)return qi.splice(Gu,1),"continue";var Td={};Id.neighbors.forEach(function(zf){var Rp=G["".concat(hc.id,"-").concat(zf.id)];Td["".concat(hc.id,"-").concat(zf.id)]={start:ct[hc.id].idx,end:ct[zf.id].idx,distance:Rp}}),Tn=zs(Td,je,a,Tn);var Ad=[];Object.keys(Td).forEach(function(zf){if(di[zf]){Ad.push(di[zf]);return}var Rp=Tn[zf];di[zf]=mu(Rp,ja,f,d),Ad.push(di[zf])}),Ad=Ad.sort(function(zf,Rp){return Rp-zf});for(var xg=!1,Uh=0;Uh<qg;Uh++)if(Ad[Uh]<Fo[Uh]){xg=!0;break}if(xg)return qi.splice(Gu,1),"continue"},Nl=su-1;Nl>=0;Nl--)Iu(Nl)});var Gl=[];qi==null||qi.forEach(function(Qs){for(var Ju=ct[Qs.id].idx,Js=Do(a.nodes,E[Ju],Ju,f,l),Xu=Js.neighbors,Il=Xu.length,Fo=!1,su=Il-1;su>=0;su--){if(Xu.length+1<e.nodes.length){Fo=!0;return}var Iu=Xu[su],Nl=Iu[f];if(!zt[Nl]||!zt[Nl].length){Xu.splice(su,1);continue}if(!El[Nl]||!El[Nl].length){Xu.splice(su,1);continue}var Tu="".concat(Qs.id,"-").concat(Iu.id),Gu=G[Tu],hc=El[Nl].length-1,Id=El[Nl][hc];if(Gu>Id){Xu.splice(su,1);continue}if(i){var Jc="".concat(Iu.id,"-").concat(Qs.id),qg=G[Jc];hc=ec[Nl].length-1;var bg=ec[Nl][hc];if(qg>bg){Xu.splice(su,1);continue}}var Uh=di[Tu]?di[Tu]:Cs(a,Qs,Iu,ct,Gu,je,ja,f,d,di,Tn),Td="".concat(hi.id,"-").concat(Nl),Ad=fl[Td][fl[Td].length-1];if(Uh<Ad){Xu.splice(su,1);continue}var xg=qo(Bs,Nl,Dt,zt),zf=xg.minPatternNodeLabelDegree,Rp=xg.minPatternNodeLabelInDegree,yv=xg.minPatternNodeLabelOutDegree;if(ct[Iu.id].degree<zf){Xu.splice(su,1);continue}}Fo||Gl.push({nodes:[Qs].concat(Xu)})});var Dp=Rr(e,hi.id,!1).length,wf={};i?(Object.keys(Dp).forEach(function(Qs){var Ju=Dt[Qs].node[f];wf[Ju]?wf[Ju].push(Dp[Qs]):wf[Ju]=[Dp[Qs]]}),Object.keys(wf).forEach(function(Qs){wf[Qs].sort(function(Ju,Js){return Ju-Js})})):wf=El;for(var Op=Gl.length,Ef=function(Ju){var Js=Gl[Ju],Xu=Js.nodes[0],Il={},Fo={};Js.nodes.forEach(function(nc,hf){Fo[nc.id]={idx:hf,node:nc,degree:0,inDegree:0,outDegree:0};var tf=nc[f];Il[tf]?Il[tf]++:Il[tf]=1});var su=[],Iu={};a.edges.forEach(function(nc){Fo[nc.source]&&Fo[nc.target]&&(su.push(nc),Iu[nc[d]]?Iu[nc[d]]++:Iu[nc[d]]=1,Fo[nc.source].degree++,Fo[nc.target].degree++,Fo[nc.source].outDegree++,Fo[nc.target].inDegree++)});for(var Nl=Object.keys(Qt).length,Tu=!1,Gu=0;Gu<Nl;Gu++){var hc=Object.keys(Qt)[Gu];if(!Iu[hc]||Iu[hc]<Qt[hc].length){Tu=!0;break}}if(Tu)return Gl.splice(Ju,1),"continue";var Id=su.length;if(Id<e.edges.length)return Gl.splice(Ju,1),"break";for(var Jc=!1,qg=function(hf){var tf=su[hf],Pp=tf[d],Fp=Qt[Pp];if(!Fp||!Fp.length)return Iu[Pp]--,Fp&&Iu[Pp]<Fp.length?(Jc=!0,"break"):(su.splice(hf,1),Fo[tf.source].degree--,Fo[tf.target].degree--,Fo[tf.source].outDegree--,Fo[tf.target].inDegree--,"continue");var OE=Fo[tf.source].node[f],RE=Fo[tf.target].node[f],s1=!1;if(Fp.forEach(function(LE){var up=Dt[LE.source].node,ax=Dt[LE.target].node;up[f]===OE&&ax[f]===RE&&(s1=!0),!i&&up[f]===RE&&ax[f]===OE&&(s1=!0)}),!s1)return Iu[Pp]--,Fp&&Iu[Pp]<Fp.length?(Jc=!0,"break"):(su.splice(hf,1),Fo[tf.source].degree--,Fo[tf.target].degree--,Fo[tf.source].outDegree--,Fo[tf.target].inDegree--,"continue")},Gu=Id-1;Gu>=0;Gu--){var bg=qg(Gu);if(bg==="break")break}if(Jc)return Gl.splice(Ju,1),"continue";Js.edges=su;var Uh=Rr(Js,Js.nodes[0].id,!1).length;if(Object.keys(Uh).reverse().forEach(function(nc){if(!(nc===Js.nodes[0].id||Jc)){if(Uh[nc]===Infinity){var hf=Fo[nc].node[f];if(Il[hf]--,Il[hf]<zt[hf].length){Jc=!0;return}var tf=Js.nodes.indexOf(Fo[nc].node);Js.nodes.splice(tf,1),Fo[nc]=void 0;return}var Pp=ct[nc].node[f];if(!wf[Pp]||!wf[Pp].length||Uh[nc]>wf[Pp][wf[Pp].length-1]){var hf=Fo[nc].node[f];if(Il[hf]--,Il[hf]<zt[hf].length){Jc=!0;return}var tf=Js.nodes.indexOf(Fo[nc].node);Js.nodes.splice(tf,1),Fo[nc]=void 0}}}),Jc)return Gl.splice(Ju,1),"continue";for(var Td=!0,Ad=0;Td&&!Jc;){Td=!1;var xg=i?Fo[Xu.id].degree<Dt[hi.id].degree||Fo[Xu.id].inDegree<Dt[hi.id].inDegree||Fo[Xu.id].outDegree<Dt[hi.id].outDegree:Fo[Xu.id].degree<Dt[hi.id].degree;if(xg){Jc=!0;break}if(Il[Xu[f]]<zt[Xu[f]].length){Jc=!0;break}for(var zf=Js.nodes.length,Rp=zf-1;Rp>=0;Rp--){var yv=Js.nodes[Rp],ex=Fo[yv.id].degree,nx=Fo[yv.id].inDegree,CI=Fo[yv.id].outDegree,_I=yv[f],rx=qo(Bs,_I,Dt,zt),F0=rx.minPatternNodeLabelDegree,II=rx.minPatternNodeLabelInDegree,TI=rx.minPatternNodeLabelOutDegree,DE=i?ex<F0||nx<II||CI<TI:ex<F0;if(DE){if(Il[yv[f]]--,Il[yv[f]]<zt[yv[f]].length){Jc=!0;break}Js.nodes.splice(Rp,1),Fo[yv.id]=void 0,Td=!0}}if(Jc||!Td&&Ad!==0)break;Id=su.length;for(var wg=Id-1;wg>=0;wg--){var Lp=su[wg];if(!Fo[Lp.source]||!Fo[Lp.target]){su.splice(wg,1);var Qg=Lp[d];if(Iu[Qg]--,Fo[Lp.source]&&(Fo[Lp.source].degree--,Fo[Lp.source].outDegree--),Fo[Lp.target]&&(Fo[Lp.target].degree--,Fo[Lp.target].inDegree--),Qt[Qg]&&Iu[Qg]<Qt[Qg].length){Jc=!0;break}Td=!0}}Ad++}if(Jc||Jc||Js.nodes.length<e.nodes.length||su.length<e.edges.length)return Gl.splice(Ju,1),"continue"},Ac=Op-1;Ac>=0;Ac--){var Gh=Ef(Ac);if(Gh==="break")break}for(var Sf=Gl.length,Qf=function(Ju){var Js=Gl[Ju],Xu={};Js.edges.forEach(function(su){var Iu="".concat(su.source,"-").concat(su.target,"-").concat(su.label);Xu[Iu]?Xu[Iu]++:Xu[Iu]=1});for(var Il=function(Iu){var Nl=Gl[Iu],Tu={};Nl.edges.forEach(function(hc){var Id="".concat(hc.source,"-").concat(hc.target,"-").concat(hc.label);Tu[Id]?Tu[Id]++:Tu[Id]=1});var Gu=!0;Object.keys(Tu).length!==Object.keys(Xu).length?Gu=!1:Object.keys(Xu).forEach(function(hc){Tu[hc]!==Xu[hc]&&(Gu=!1)}),Gu&&Gl.splice(Iu,1)},Fo=Sf-1;Fo>Ju;Fo--)Il(Fo);Sf=Gl.length},Ac=0;Ac<=Sf-1;Ac++)Qf(Ac);return Gl}}},ls=Wi,is=function(){function c(a){a===void 0&&(a=10),this.linkedList=new le,this.maxStep=a}return Object.defineProperty(c.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),c.prototype.isEmpty=function(){return!this.linkedList.head},c.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},c.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},c.prototype.push=function(a){this.linkedList.prepend(a),this.length>this.maxStep&&this.linkedList.deleteTail()},c.prototype.pop=function(){var a=this.linkedList.deleteHead();return a?a.value:null},c.prototype.toArray=function(){return this.linkedList.toArray().map(function(a){return a.value})},c.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},c}(),Es=is,tl=Sa,bu={getAdjMatrix:Yt,breadthFirstSearch:Me,connectedComponent:Pt,getDegree:Ne,getInDegree:tn,getOutDegree:fn,detectCycle:Sa,detectDirectedCycle:tl,detectAllCycles:fa,detectAllDirectedCycle:Ur,detectAllUndirectedCycle:cr,depthFirstSearch:Un,dijkstra:Rr,findAllPath:Fn,findShortestPath:ar,floydWarshall:Gn,labelPropagation:Hr,louvain:$t,iLouvain:Ht,kCore:on,kMeans:qn,cosineSimilarity:qr,nodesCosineSimilarity:Qn,minimumSpanningTree:Mi,pageRank:un,getNeighbors:fe,Stack:Es,GADDI:ls},Ys=$(77160),ka=$(31437),Ku=ie,Vs=function(a){return function(e,i){return e[a]-i[a]}},Ro=function(a,e,i){return a>=e&&a<=i},Ns=function(a,e,i,s){var l=1e-4,f={x:i.x-a.x,y:i.y-a.y},d={x:e.x-a.x,y:e.y-a.y},v={x:s.x-i.x,y:s.y-i.y},w=d.x*v.y-d.y*v.x,E=w*w,T=1/w,G=d.x*d.x+d.y*d.y,U=v.x*v.x+v.y*v.y;if(E>l*G*U){var et=(f.x*v.y-f.y*v.x)*T,ct=(f.x*d.y-f.y*d.x)*T;return!Ro(et,0,1)||!Ro(ct,0,1)?null:{x:a.x+et*d.x,y:a.y+et*d.y}}return null},tu=function(a,e){var i=a.x,s=a.y,l=a.width,f=a.height,d=i+l/2,v=s+f/2,w=[],E={x:d,y:v};w.push({x:i,y:s}),w.push({x:i+l,y:s}),w.push({x:i+l,y:s+f}),w.push({x:i,y:s+f}),w.push({x:i,y:s});for(var T=null,G=1;G<w.length&&(T=Ns(w[G-1],w[G],E,e),!T);G++);return T},eu=function(a,e){var i=a.x,s=a.y,l=a.r,f=e.x,d=e.y,v=f-i,w=d-s;if(v*v+w*w<l*l)return null;var E=Math.atan(w/v);return{x:i+Math.abs(l*Math.cos(E))*Math.sign(v),y:s+Math.abs(l*Math.sin(E))*Math.sign(w)}},Zu=function(a,e){var i=a.rx,s=a.ry,l=a.x,f=a.y,d=e.x-l,v=e.y-f,w=Math.atan2(v/s,d/i);return w<0&&(w+=2*Math.PI),{x:l+i*Math.cos(w),y:f+s*Math.sin(w)}},bn=function(a,e,i){i===void 0&&(i=1);var s=[a.x,a.y,i];return(!e||isNaN(e[0]))&&(e=[1,0,0,0,1,0,0,0,1]),Ys.transformMat3(s,s,e),{x:s[0],y:s[1]}},Xr=function(a,e,i){i===void 0&&(i=1),(!e||isNaN(e[0]))&&(e=[1,0,0,0,1,0,0,0,1]);var s=ot.invert([1,0,0,0,1,0,0,0,1],e);s||(s=[1,0,0,0,1,0,0,0,1]);var l=[a.x,a.y,i];return Ys.transformMat3(l,l,s),{x:l[0],y:l[1]}},pa=function(a,e,i){var s=a.x-e.x,l=a.y-e.y,f=a.x-i.x,d=a.y-i.y,v=(a.x*a.x-e.x*e.x-e.y*e.y+a.y*a.y)/2,w=(a.x*a.x-i.x*i.x-i.y*i.y+a.y*a.y)/2,E=l*f-s*d;return{x:-(d*v-l*w)/E,y:-(s*w-f*v)/E}},Ra=function(a,e){var i=a.x-e.x,s=a.y-e.y;return Math.sqrt(i*i+s*s)},Qi=function(a,e){var i=[];return a.forEach(function(s){var l=[];s.forEach(function(f){l.push(f*e)}),i.push(l)}),i},Co=function(a){for(var e=[],i=a.length,s=0;s<i;s+=1){e[s]=[];for(var l=0;l<i;l+=1)s===l?e[s][l]=0:a[s][l]===0||!a[s][l]?e[s][l]=Infinity:e[s][l]=a[s][l]}for(var f=0;f<i;f+=1)for(var s=0;s<i;s+=1)for(var l=0;l<i;l+=1)e[s][l]>e[s][f]+e[f][l]&&(e[s][l]=e[s][f]+e[f][l]);return e},to=function(a,e){var i=a.nodes,s=a.edges,l=[],f={};if(!i)throw new Error("invalid nodes data!");return i&&i.forEach(function(d,v){f[d.id]=v;var w=[];l.push(w)}),s&&s.forEach(function(d){var v=d.source,w=d.target,E=f[v],T=f[w];l[E][T]=1,e||(l[T][E]=1)}),l},xo=function(a,e){a.translate(e.x,e.y)},gs=function(a,e,i,s){s===void 0&&(s={duration:500});var l=a.getMatrix();l||(l=[1,0,0,0,1,0,0,0,1]);var f=a.getCanvasBBox(),d=e.x-f.minX,v=e.y-f.minY;if(i){var w=d*l[0],E=v*l[4],T=0,G=0,U=0,et=0;a.animate(function(Ct){return U=w*Ct,et=E*Ct,l=Ku(l,[["t",U-T,et-G]]),T=U,G=et,{matrix:l}},s)}else{var ct=Ku(l,[["t",d,v]]);a.setMatrix(ct)}},vo=function(a,e){var i=a.getMatrix();i||(i=[1,0,0,0,1,0,0,0,1]);var s=e;(0,_.isArray)(e)||(s=[e,e]),(0,_.isArray)(e)&&e.length===1&&(s=[e[0],e[0]]),i=Ku(i,[["s",s[0],s[1]]]),a.setMatrix(i)},ou=function(a,e){var i=a.getMatrix();i||(i=[1,0,0,0,1,0,0,0,1]),i=Ku(i,[["r",e]]),a.setMatrix(i)},ms=function(a,e,i){for(var s=[],l=0;l<a;l++)s[l]=0;return i.forEach(function(f){f.source&&(s[e[f.source]]+=1),f.target&&(s[e[f.target]]+=1)}),s};function xu(c,a,e){return(e[0]-c[0])*(a[1]-c[1])==(a[0]-c[0])*(e[1]-c[1])&&Math.min(c[0],a[0])<=e[0]&&e[0]<=Math.max(c[0],a[0])&&Math.min(c[1],a[1])<=e[1]&&e[1]<=Math.max(c[1],a[1])}var dl=function(a,e,i){var s=!1,l=a.length,f=1e-6;function d(T){return Math.abs(T)<f?0:T<0?-1:1}if(l<=2)return!1;for(var v=0;v<l;v++){var w=a[v],E=a[(v+1)%l];if(xu(w,E,[e,i]))return!0;d(w[1]-i)>0!=d(E[1]-i)>0&&d(e-(i-w[1])*(w[0]-E[0])/(w[1]-E[1])-w[0])<0&&(s=!s)}return s},kl=function(a,e){return!(e.minX>a.maxX||e.maxX<a.minX||e.minY>a.maxY||e.maxY<a.minY)},Ks=function(a,e){var i=!1;return(0,_.each)(a,function(s){if(Ns(s.from,s.to,e.from,e.to))return i=!0,!1}),i},el=function(a,e){var i=function(G){var U=G.map(function(ct){return ct[0]}),et=G.map(function(ct){return ct[1]});return{minX:Math.min.apply(null,U),maxX:Math.max.apply(null,U),minY:Math.min.apply(null,et),maxY:Math.max.apply(null,et)}},s=function(G){for(var U=[],et=G.length,ct=0;ct<et-1;ct++){var Ct=G[ct],Mt=G[ct+1];U.push({from:{x:Ct[0],y:Ct[1]},to:{x:Mt[0],y:Mt[1]}})}if(U.length>1){var Dt=G[0],zt=G[et-1];U.push({from:{x:zt[0],y:zt[1]},to:{x:Dt[0],y:Dt[1]}})}return U};if(a.length<2||e.length<2)return!1;var l=i(a),f=i(e);if(!kl(l,f))return!1;var d=!1;if((0,_.each)(e,function(T){if(dl(a,T[0],T[1]))return d=!0,!1}),d||((0,_.each)(a,function(T){if(dl(e,T[0],T[1]))return d=!0,!1}),d))return!0;var v=s(a),w=s(e),E=!1;return(0,_.each)(w,function(T){if(Ks(v,T))return E=!0,!1}),E},lu=function(){function c(a,e,i,s){this.x1=a,this.y1=e,this.x2=i,this.y2=s}return c.prototype.getBBox=function(){var a=Math.min(this.x1,this.x2),e=Math.min(this.y1,this.y2),i=Math.max(this.x1,this.x2),s=Math.max(this.y1,this.y2),l={x:a,y:e,minX:a,minY:e,maxX:i,maxY:s,width:i-a,height:s-e};return l},c}(),Du=function(a,e){var i={top:[a.minX,a.minY,a.maxX,a.minY],left:[a.minX,a.minY,a.minX,a.maxY],bottom:[a.minX,a.maxY,a.maxX,a.maxY],right:[a.maxX,a.minY,a.maxX,a.maxY]};return i[e]},pl=function(a,e){var i=(e.x2-e.x1)*(a.y1-e.y1)-(e.y2-e.y1)*(a.x1-e.x1),s=(a.x2-a.x1)*(a.y1-e.y1)-(a.y2-a.y1)*(a.x1-e.x1),l=(e.y2-e.y1)*(a.x2-a.x1)-(e.x2-e.x1)*(a.y2-a.y1);if(l){var f=i/l,d=s/l;if(f>=0&&f<=1&&d>=0&&d<=1)return f}return Number.POSITIVE_INFINITY},ns=function(a,e){for(var i=["top","left","bottom","right"],s=a.getBBox(),l=0,f=[],d=0;d<4;d++){var v=Du(s,i[d]),w=v[0],E=v[1],T=v[2],G=v[3];f[d]=Ns({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},{x:w,y:E},{x:T,y:G}),f[d]&&(l+=1)}return[f,l]},_s=function(a,e){for(var i=["top","left","bottom","right"],s=a.getBBox(),l=Number.POSITIVE_INFINITY,f=0,d=0;d<4;d++){var v=Du(s,i[d]),w=v[0],E=v[1],T=v[2],G=v[3],U=pl(e,new lu(w,E,T,G));U=Math.abs(U-.5),U>=0&&U<=1&&(f+=1,l=U<l?U:l)}return f===0?-1:l},Bu=function(a){var e=0,i=0;if(a.length>0){for(var s=0,l=a;s<l.length;s++){var f=l[s];e+=f.x,i+=f.y}e/=a.length,i/=a.length}return{x:e,y:i}},Au=function(a,e){return Math.pow(a.x-e.x,2)+Math.pow(a.y-e.y,2)},wu=function(a,e){var i=e.x1,s=e.y1,l=e.x2-i,f=e.y2-s,d=a.x-i,v=a.y-s,w=d*l+v*f,E;w<=0?E=0:(d=l-d,v=f-v,w=d*l+v*f,w<=0?E=0:E=w*w/(l*l+f*f));var T=d*d+v*v-E;return T<0&&(T=0),T},nu=function(a,e,i){return i===void 0&&(i=.001),Math.pow(a.x-e.x,2)+Math.pow(a.y-e.y,2)<Math.pow(i,2)},Tl=function(a,e){var i=a.x<e.x,s=a.x>e.x+e.width,l=a.y>e.y+e.height,f=a.y<e.y,d=i||s||l||f;if(!d)return 0;if(l&&!i&&!s)return Math.pow(e.y+e.height-a.y,2);if(f&&!i&&!s)return Math.pow(a.y-e.y,2);if(i&&!l&&!f)return Math.pow(e.x-a.x,2);if(s&&!l&&!f)return Math.pow(e.x+e.width-a.x,2);var v=Math.min(Math.abs(e.x-a.x),Math.abs(e.x+e.width-a.x)),w=Math.min(Math.abs(e.y-a.y),Math.abs(e.y+e.height-a.y));return v*v+w*w},xc=function(a,e){var i=a[0],s=a[1],l=a[2],f=a[3],d=e.x,v=e.y,w=[l-i,f-s];if(ka.exactEquals(w,[0,0]))return NaN;var E=[-w[1],w[0]];ka.normalize(E,E);var T=[d-i,v-s];return Math.abs(ka.dot(T,E))},Sl=function(a,e,i){return a+(e-a)*i},ol=function(a,e,i){for(var s=Math.min(a.length,e.length),l=new Array(s),f=0;f<s;f++)l[f]=Sl(a[f],e[f],i);return l},ys="rgb(95, 149, 255)",vl="rgb(255, 255, 255)",kc="rgb(0, 0, 0)",Dl="rgb(247, 250, 255)",Ol="rgb(239, 244, 255)",_e="rgb(253, 253, 253)",ve="rgb(250, 250, 250)",Bt="rgb(224, 224, 224)",ae="rgb(234, 234, 234)",me="rgb(245, 245, 245)",En="rgb(191, 213, 255)",Zn="#4572d9",Kt="rgb(223, 234, 255)",ge={mainStroke:ys,mainFill:Ol,activeStroke:ys,activeFill:Dl,inactiveStroke:En,inactiveFill:Dl,selectedStroke:ys,selectedFill:vl,highlightStroke:Zn,highlightFill:Kt,disableStroke:Bt,disableFill:ve,edgeMainStroke:Bt,edgeActiveStroke:ys,edgeInactiveStroke:ae,edgeSelectedStroke:ys,edgeHighlightStroke:ys,edgeDisableStroke:me,comboMainStroke:Bt,comboMainFill:_e,comboActiveStroke:ys,comboActiveFill:Dl,comboInactiveStroke:Bt,comboInactiveFill:_e,comboSelectedStroke:ys,comboSelectedFill:_e,comboHighlightStroke:Zn,comboHighlightFill:_e,comboDisableStroke:ae,comboDisableFill:ve},Ae={version:"0.8.14",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:ge.mainStroke,fill:Ol},size:20,color:ge.mainStroke,linkPoints:{size:8,lineWidth:1,fill:ge.activeFill,stroke:ge.activeStroke}},nodeStateStyles:{active:{fill:ge.activeFill,stroke:ge.activeStroke,lineWidth:2,shadowColor:ge.mainStroke,shadowBlur:10},selected:{fill:ge.selectedFill,stroke:ge.selectedStroke,lineWidth:4,shadowColor:ge.selectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:ge.highlightFill,stroke:ge.highlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:ge.inactiveFill,stroke:ge.inactiveStroke,lineWidth:1},disable:{fill:ge.disableFill,stroke:ge.disableStroke,lineWidth:1}},edgeLabel:{style:{fill:kc,textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:ge.edgeMainStroke,lineAppendWidth:2},color:ge.edgeMainStroke},edgeStateStyles:{active:{stroke:ge.edgeActiveStroke,lineWidth:1},selected:{stroke:ge.edgeSelectedStroke,lineWidth:2,shadowColor:ge.edgeSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:ge.edgeHighlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:ge.edgeInactiveStroke,lineWidth:1},disable:{stroke:ge.edgeDisableStroke,lineWidth:1}},comboLabel:{style:{fill:kc,textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:ge.comboMainFill,lineWidth:1,stroke:ge.comboMainStroke,r:5,width:20,height:10},size:[20,5],color:ge.comboMainStroke,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:ge.comboActiveStroke,lineWidth:1,fill:ge.comboActiveFill},selected:{stroke:ge.comboSelectedStroke,lineWidth:2,fill:ge.comboSelectedFill,shadowColor:ge.comboSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:ge.comboHighlightStroke,lineWidth:2,fill:ge.comboHighlightFill,"text-shape":{fontWeight:500}},inactive:{stroke:ge.comboInactiveStroke,fill:ge.comboInactiveFill,lineWidth:1},disable:{stroke:ge.comboDisableStroke,fill:ge.comboDisableFill,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},windowFontFamily:typeof window!="undefined"&&window.getComputedStyle&&document.body&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"},sn={" ":.3329986572265625,a:.5589996337890625,A:.6569992065429687,b:.58599853515625,B:.6769989013671875,c:.5469985961914062,C:.7279998779296875,d:.58599853515625,D:.705999755859375,e:.554998779296875,E:.63699951171875,f:.37299957275390627,F:.5769989013671875,g:.5909988403320312,G:.7479995727539063,h:.555999755859375,H:.7199996948242188,i:.255999755859375,I:.23699951171875,j:.26699981689453123,J:.5169998168945312,k:.5289993286132812,K:.6899993896484375,l:.23499908447265624,L:.5879989624023437,m:.854998779296875,M:.8819992065429687,n:.5589996337890625,N:.7189987182617188,o:.58599853515625,O:.7669998168945312,p:.58599853515625,P:.6419998168945312,q:.58599853515625,Q:.7669998168945312,r:.3649993896484375,R:.6759994506835938,s:.504998779296875,S:.6319992065429687,t:.354998779296875,T:.6189987182617187,u:.5599990844726562,U:.7139999389648437,v:.48199920654296874,V:.6389999389648438,w:.754998779296875,W:.929998779296875,x:.5089996337890625,X:.63699951171875,y:.4959991455078125,Y:.66199951171875,z:.48699951171875,Z:.6239990234375,"0":.6,"1":.40099945068359377,"2":.6,"3":.6,"4":.6,"5":.6,"6":.6,"7":.5469985961914062,"8":.6,"9":.6,"[":.3329986572265625,"]":.3329986572265625,",":.26399993896484375,".":.26399993896484375,";":.26399993896484375,":":.26399993896484375,"{":.3329986572265625,"}":.3329986572265625,"\\":.5,"|":.19499969482421875,"=":.604998779296875,"+":.604998779296875,"-":.604998779296875,_:.5,"`":.3329986572265625," ~":.8329986572265625,"!":.3329986572265625,"@":.8579986572265625,"#":.6,$:.6,"%":.9699996948242188,"^":.517999267578125,"&":.7259994506835937,"*":.505999755859375,"(":.3329986572265625,")":.3329986572265625,"<":.604998779296875,">":.604998779296875,"/":.5,"?":.53699951171875},xn=Math.PI,ir=Math.sin,$r=Math.cos,Aa=ir(xn/8),Va=$r(xn/8),Ba=function(a,e){var i=a.getBBox(),s={x:i.minX,y:i.minY},l={x:i.maxX,y:i.maxY};if(e){var f=e.getMatrix();f||(f=[1,0,0,0,1,0,0,0,1]),s=bn(s,f),l=bn(l,f)}var d=s.x,v=s.y,w=l.x,E=l.y;return{x:d,y:v,minX:d,minY:v,maxX:w,maxY:E,width:w-d,height:E-v}},oi=function(a){var e=a.sourceNode||a.targetNode,i=e.get("group"),s=i.getMatrix();s||(s=[1,0,0,0,1,0,0,0,1]);var l=e.getKeyShape(),f=l.getBBox(),d=a.loopCfg||{},v=d.dist||Math.max(f.width,f.height)*2,w=d.position||Ae.defaultLoopPosition,E=[(f.minX+f.maxX)/2+s[6],(f.minY+f.maxY)/2+s[7]],T=[a.startPoint.x,a.startPoint.y],G=[a.endPoint.x,a.endPoint.y],U=f.height/2,et=f.width/2,ct=U,Ct=U,Mt=ct*Aa,Dt=ct*Va,zt=Ct*Aa,Qt=Ct*Va,Ie=l.get("type"),je=Math.min(U/2,et/2),ze=Math.min(U,et),mn=(d==null?void 0:d.pointPadding)?Math.min(ze,d==null?void 0:d.pointPadding):je;if(T[0]===G[0]&&T[1]===G[1]){switch(w){case"top":Ie==="circle"?(T=[E[0]-Mt,E[1]-Dt],G=[E[0]+zt,E[1]-Qt]):(T=[E[0]-mn,E[1]-U],G=[E[0]+mn,E[1]-U]);break;case"top-right":ct=U,Ct=et,Ie==="circle"?(Mt=ct*Aa,Dt=ct*Va,zt=Ct*Aa,Qt=Ct*Va,T=[E[0]+Mt,E[1]-Dt],G=[E[0]+Qt,E[1]-zt]):(T=[E[0]+et-mn,E[1]-U],G=[E[0]+et,E[1]-U+mn]);break;case"right":ct=et,Ct=et,Ie==="circle"?(Mt=ct*Aa,Dt=ct*Va,zt=Ct*Aa,Qt=Ct*Va,T=[E[0]+Dt,E[1]-Mt],G=[E[0]+Qt,E[1]+zt]):(T=[E[0]+et,E[1]-mn],G=[E[0]+et,E[1]+mn]);break;case"bottom-right":ct=et,Ct=U,Ie==="circle"?(Mt=ct*Aa,Dt=ct*Va,zt=Ct*Aa,Qt=Ct*Va,T=[E[0]+Dt,E[1]+Mt],G=[E[0]+zt,E[1]+Qt]):(T=[E[0]+et,E[1]+U-mn],G=[E[0]+et-mn,E[1]+U]);break;case"bottom":ct=U,Ct=U,Ie==="circle"?(Mt=ct*Aa,Dt=ct*Va,zt=Ct*Aa,Qt=Ct*Va,T=[E[0]+Mt,E[1]+Dt],G=[E[0]-zt,E[1]+Qt]):(T=[E[0]-mn,E[1]+U],G=[E[0]+mn,E[1]+U]);break;case"bottom-left":ct=U,Ct=et,Ie==="circle"?(Mt=ct*Aa,Dt=ct*Va,zt=Ct*Aa,Qt=Ct*Va,T=[E[0]-Mt,E[1]+Dt],G=[E[0]-Qt,E[1]+zt]):(T=[E[0]-et,E[1]+U-mn],G=[E[0]-et+mn,E[1]+U]);break;case"left":ct=et,Ct=et,Ie==="circle"?(Mt=ct*Aa,Dt=ct*Va,zt=Ct*Aa,Qt=Ct*Va,T=[E[0]-Dt,E[1]+Mt],G=[E[0]-Qt,E[1]-zt]):(T=[E[0]-et,E[1]-mn],G=[E[0]-et,E[1]+mn]);break;case"top-left":ct=et,Ct=U,Ie==="circle"?(Mt=ct*Aa,Dt=ct*Va,zt=Ct*Aa,Qt=Ct*Va,T=[E[0]-Dt,E[1]-Mt],G=[E[0]-zt,E[1]-Qt]):(T=[E[0]-et+mn,E[1]-U],G=[E[0]-et,E[1]-U+mn]);break;default:ct=et,Ct=et,Mt=ct*Aa,Dt=ct*Va,zt=Ct*Aa,Qt=Ct*Va,T=[E[0]-Mt,E[1]-Dt],G=[E[0]+zt,E[1]-Qt]}if(d.clockwise===!1){var $n=[T[0],T[1]];T=[G[0],G[1]],G=[$n[0],$n[1]]}}var Tn=[T[0]-E[0],T[1]-E[1]],or=(ct+v)/ct,kr=(Ct+v)/Ct;d.clockwise===!1&&(or=(Ct+v)/Ct,kr=(ct+v)/ct);var Ta=ka.scale([0,0],Tn,or),fi=[E[0]+Ta[0],E[1]+Ta[1]],ei=[G[0]-E[0],G[1]-E[1]],Ia=ka.scale([0,0],ei,kr),Gi=[E[0]+Ia[0],E[1]+Ia[1]];return a.startPoint={x:T[0],y:T[1]},a.endPoint={x:G[0],y:G[1]},a.controlPoints=[{x:fi[0],y:fi[1]},{x:Gi[0],y:Gi[1]}],a},ro=function(a,e,i,s,l){var f=1e-4,d=[],v=a==null?void 0:a.getPoint(e);if(!v)return{x:0,y:0,angle:0};if(e<f)d=a.getStartTangent().reverse();else if(e>1-f)d=a.getEndTangent();else{var w=a==null?void 0:a.getPoint(e+f);d.push([v.x,v.y]),d.push([w.x,w.y])}var E=Math.atan2(d[1][1]-d[0][1],d[1][0]-d[0][0]);if(E<0&&(E+=xn*2),i&&(v.x+=$r(E)*i,v.y+=ir(E)*i),s){var T=E-xn/2;E>1/2*xn&&E<3*1/2*xn&&(T-=xn),v.x+=$r(T)*s,v.y+=ir(T)*s}var G={x:v.x,y:v.y,angle:E};return l?(E>.5*xn&&E<1.5*xn&&(E-=xn),(0,O.__assign)({rotate:E},G)):G},Di=function c(a,e,i,s){if(s(a,e,i)===!1)return!1;if(a&&a.children){for(var l=a.children.length-1;l>=0;l--)if(!c(a.children[l],a,l,s))return!1}return!0},Si=function c(a,e,i,s){if(a&&a.children){for(var l=a.children.length-1;l>=0;l--)if(!c(a.children[l],a,l,s))return}return s(a,e,i)!==!1},_o=function(a,e){typeof e=="function"&&Di(a,null,-1,e)},To=function(a,e){typeof e=="function"&&Si(a,null,-1,e)},wo=function(a,e){return e*(sn[a]||1)},Vo=function(a,e){var i=0,s=new RegExp("[\u4E00-\u9FA5]+");return a.split("").forEach(function(l){s.test(l)?i+=e:i+=wo(l,e)}),[i,e]},js=function(a,e){return typeof e!="number"||e<=0||e>=a.length?a:a.substring(0,e)+"..."},ws=function(a,e){var i=[],s={},l={};a.forEach(function(v){l[v.id]=v}),a.forEach(function(v,w){var E=(0,_.clone)(v);E.itemType="combo",E.children=void 0,E.parentId===E.id?(console.warn("The parentId for combo ".concat(E.id," can not be the same as the combo's id")),delete E.parentId):E.parentId&&!l[E.parentId]&&(console.warn("The parent combo for combo ".concat(E.id," does not exist!")),delete E.parentId);var T=s[E.id];if(T){if(E.children=T.children,s[E.id]=E,T=E,!T.parentId){i.push(T);return}var G=s[T.parentId];if(G)G.children?G.children.push(E):G.children=[E];else{var U={id:T.parentId,children:[T]};s[T.parentId]=U,s[E.id]=E}return}if((0,_.isString)(v.parentId)){var et=s[v.parentId];if(et)et.children?et.children.push(E):et.children=[E],s[E.id]=E;else{var ct={id:v.parentId,children:[E]};s[ct.id]=ct,s[E.id]=E}}else i.push(E),s[E.id]=E});var f={};(e||[]).forEach(function(v){f[v.id]=v;var w=s[v.comboId];if(w){var E={id:v.id,comboId:v.comboId};w.children?w.children.push(E):w.children=[E],E.itemType="node",s[v.id]=E}});var d=0;return i.forEach(function(v){v.depth=d+10,_o(v,function(w){var E,T=s[w.id].itemType;T==="node"?E=s[w.comboId]:E=s[w.parentId],E&&T==="node"?w.depth=d+1:w.depth=d+10,d<w.depth&&(d=w.depth);var G=f[w.id];return G&&(G.depth=w.depth),!0})}),i},ks=function(a,e,i){var s,l=a,f,d={root:{children:a}},v=!1,w="root";(a||[]).forEach(function(et){if(!v){if(et.id===e){f=et,et.itemType==="combo"?f.parentId=i:f.comboId=i,v=!0;return}_o(et,function(ct){var Ct;return d[ct.id]={children:(ct==null?void 0:ct.children)||[]},l=(Ct=d[ct.parentId||ct.comboId||"root"])===null||Ct===void 0?void 0:Ct.children,ct&&(ct.removed||e===ct.id)&&l?(w=ct.parentId||ct.comboId||"root",f=ct,ct.itemType==="combo"?f.parentId=i:f.comboId=i,v=!0,!1):!0})}}),l=(s=d[w])===null||s===void 0?void 0:s.children;var E=l?l.indexOf(f):-1;if(E>-1&&l.splice(E,1),v||(f={id:e,itemType:"node",comboId:i},d[e]={children:void 0}),e){var T=!1;if(i){var G=0;(a||[]).forEach(function(et){T||_o(et,function(ct){return i===ct.id?(T=!0,ct.children?ct.children.push(f):ct.children=[f],G=ct.depth,f.itemType==="node"?f.depth=G+2:f.depth=G+1,!1):!0})})}else(!i||!T)&&f.itemType!=="node"&&a.push(f);var U=f.depth;_o(f,function(et){return et.itemType==="node"?U+=2:U+=1,et.depth=U,!0})}return a},Hs=function(a,e,i){var s={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity,x:void 0,y:void 0,width:void 0,height:void 0,centerX:void 0,centerY:void 0};if(!a||a.length===0){var l=i==null?void 0:i.getModel(),f=l||{},d=f.x,v=f.y,w=f.fixSize,E=f.collapsed,T=f.fixCollapseSize,G=E?T:w,U=(0,_.isArray)(G)?G:[G,G],et=U[0],ct=U[1],Ct=[et/2,ct/2];return{minX:d-Ct[0],minY:v-Ct[1],maxX:d+Ct[0],maxY:v+Ct[1],x:d,y:v,width:et,height:ct}}return a.forEach(function(Mt){var Dt=e.findById(Mt.id);if(!(!Dt||!Dt.isVisible())){Dt.set("bboxCanvasCache",void 0);var zt=Dt.getCanvasBBox();zt.x&&s.minX>zt.minX&&(s.minX=zt.minX),zt.y&&s.minY>zt.minY&&(s.minY=zt.minY),zt.x&&s.maxX<zt.maxX&&(s.maxX=zt.maxX),zt.y&&s.maxY<zt.maxY&&(s.maxY=zt.maxY)}}),s.x=(s.minX+s.maxX)/2,s.y=(s.minY+s.maxY)/2,s.width=s.maxX-s.minX,s.height=s.maxY-s.minY,s.centerX=(s.minX+s.maxX)/2,s.centerY=(s.minY+s.maxY)/2,(i==null?void 0:i.getKeyShape().get("type"))==="circle"&&(s.width=Math.hypot(s.height,s.width),s.height=s.width),Object.keys(s).forEach(function(Mt){(s[Mt]===Infinity||s[Mt]===-Infinity)&&(s[Mt]=void 0)}),s},Mu=function(a){var e=(0,_.isNumber)(a.x)||(0,_.isNumber)(a.y)||a.type||a.anchorPoints||a.size;return a.style&&(e=e||(0,_.isNumber)(a.style.r)||(0,_.isNumber)(a.style.width)||(0,_.isNumber)(a.style.height)||(0,_.isNumber)(a.style.rx)||(0,_.isNumber)(a.style.ry)),e},nl=function(a){var e={};return Object.keys(a).forEach(function(i){var s=a[i];if((0,_.isObject)(s)&&!(0,_.isArray)(s)){var l={};Object.keys(s).forEach(function(f){var d=s[f];f==="img"&&!(0,_.isString)(d)||(l[f]=(0,_.clone)(d))}),e[i]=l}else e[i]=(0,_.clone)(s)}),e},Cl=function(a){var e=a.animateCfg,i=a.callback,s;if(!e)s={duration:500,callback:i};else if(s=(0,_.clone)(e),e.callback){var l=e.callback;s.callback=function(){i(),l()}}else s.callback=i;return s},Yl=function(a){if(!a)return console.error("G6 Error Tips: the data must be defined"),!1;var e=a.nodes,i=a.edges,s=a.combos,l=s===void 0?[]:s;if(!e&&!i){var f=!0;return _o(a,function(G){return(0,_.isString)(G.id)?!0:(f=!1,!1)}),f}var d=(e||[]).find(function(G){return!(0,_.isString)(G.id)});if(d)return console.warn("G6 Warning Tips: missing 'id' property, or %c".concat(d.id,"%c is not a string."),"font-size: 20px; color: red;",""),!1;var v=(e||[]).map(function(G){return G.id}),w=l==null?void 0:l.map(function(G){return G.id}),E=(0,O.__spreadArray)((0,O.__spreadArray)([],v,!0),w,!0),T=(i||[]).find(function(G){return!E.includes(G.source)||!E.includes(G.target)});return T?(console.warn("G6 Warning Tips: The source %c".concat(T.source,"%c or the target %c").concat(T.target,"%c of the edge do not exist in the nodes or combos."),"font-size: 20px; color: red;","","font-size: 20px; color: red;",""),!1):!0},sl=function(a,e){if(a==="node"||a==="combo"){if(e.id&&!(0,_.isString)(e.id))return console.warn("G6 Warning Tips: missing 'id' property, or the 'id' %c".concat(e.id,"%c is not a string."),"font-size: 20px; color: red;",""),!1}else if(a==="edge"&&(!e.source||!e.target))return console.warn("G6 Warning Tips: missing 'source' or 'target' for the edge."),!1;return!0},rl=function(){function c(a){this.graph=a,this.destroyed=!1,this.modes=a.get("modes")||{default:[]},this.formatModes(),this.mode=a.get("defaultMode")||"default",this.currentBehaves=[],this.setMode(this.mode)}return c.prototype.formatModes=function(){var a=this.modes;(0,_.each)(a,function(e){(0,_.each)(e,function(i,s){(0,_.isString)(i)&&(e[s]={type:i})})})},c.prototype.setBehaviors=function(a){var e=this.graph,i=this.modes[a],s=[],l;(0,_.each)(i||[],function(f){var d=st.getBehavior(f.type||f);!d||(l=new d(f),l&&(l.bind(e),s.push(l)))}),this.currentBehaves=s},c.mergeBehaviors=function(a,e){return(0,_.each)(e,function(i){a.indexOf(i)<0&&((0,_.isString)(i)&&(i={type:i}),a.push(i))}),a},c.filterBehaviors=function(a,e){var i=[];return a.forEach(function(s){var l="";(0,_.isString)(s)?l=s:l=s.type,e.indexOf(l)<0&&i.push(s)}),i},c.prototype.setMode=function(a){var e=this,i=e.modes,s=e.graph,l=a,f=i[l];!f||(s.emit("beforemodechange",{mode:a}),(0,_.each)(this.currentBehaves,function(d){d.delegate&&d.delegate.remove(),d.unbind(s)}),this.setBehaviors(l),s.emit("aftermodechange",{mode:a}),this.mode=a)},c.prototype.getMode=function(){return this.mode},c.prototype.manipulateBehaviors=function(a,e,i){var s=this,l;if((0,_.isArray)(a)?l=a:l=[a],(0,_.isArray)(e))return(0,_.each)(e,function(d){s.modes[d]?i?s.modes[d]=c.mergeBehaviors(s.modes[d]||[],l):s.modes[d]=c.filterBehaviors(s.modes[d]||[],l):i&&(s.modes[d]=l)}),this;var f=e;return e||(f=this.mode),this.modes[f]||i&&(this.modes[f]=l),i?this.modes[f]=c.mergeBehaviors(this.modes[f]||[],l):this.modes[f]=c.filterBehaviors(this.modes[f]||[],l),this.formatModes(),this.setMode(this.mode),this},c.prototype.updateBehavior=function(a,e,i){(0,_.isString)(a)&&(a={type:a});var s=[];if(!i||i===this.mode||i==="default"){if(s=this.currentBehaves,!s||!s.length)return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."),this;for(var l=s.length,f=0;f<l;f++){var d=s[f];if(d.type===a.type)return d.updateCfg(e),this;f===l-1&&console.warn("Update behavior failed! There is no such behavior in the mode")}}else{if(s=this.modes[i],!s||!s.length)return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."),this;for(var v=s.length,f=0;f<v;f++){var d=s[f];if(d.type===a.type||d===a.type)return d===a.type&&(d={type:d}),Object.assign(d,e),s[f]=d,this;f===v-1&&console.warn("Update behavior failed! There is no such behavior in the mode")}}return this},c.prototype.destroy=function(){this.graph=null,this.modes=null,this.currentBehaves=null,this.destroyed=!0},c}(),_f=rl,Dc=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,wc=new RegExp("([a-z])["+Dc+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Dc+"]*,?["+Dc+"]*)+)","ig"),ef=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Dc+"]*,?["+Dc+"]*","ig"),A=function(c){if(!c)return null;if((0,_.isArray)(c))return c;var a={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},e=[];return String(c).replace(wc,function(i,s,l){var f=[],d=s.toLowerCase();if(l.replace(ef,function(v,w){w&&f.push(+w)}),d==="m"&&f.length>2&&(e.push([s].concat(f.splice(0,2))),d="l",s=s==="m"?"l":"L"),d==="o"&&f.length===1&&e.push([s,f[0]]),d==="r")e.push([s].concat(f));else for(;f.length>=a[d]&&(e.push([s].concat(f.splice(0,a[d]))),!!a[d]););return c}),e},nt=function(c,a){for(var e=[],i=0,s=c.length;s-2*!a>i;i+=2){var l=[{x:+c[i-2],y:+c[i-1]},{x:+c[i],y:+c[i+1]},{x:+c[i+2],y:+c[i+3]},{x:+c[i+4],y:+c[i+5]}];a?i?s-4===i?l[3]={x:+c[0],y:+c[1]}:s-2===i&&(l[2]={x:+c[0],y:+c[1]},l[3]={x:+c[2],y:+c[3]}):l[0]={x:+c[s-2],y:+c[s-1]}:s-4===i?l[3]=l[2]:i||(l[0]={x:+c[i],y:+c[i+1]}),e.push(["C",(-l[0].x+6*l[1].x+l[2].x)/6,(-l[0].y+6*l[1].y+l[2].y)/6,(l[1].x+6*l[2].x-l[3].x)/6,(l[1].y+6*l[2].y-l[3].y)/6,l[2].x,l[2].y])}return e},Zt=function(c,a,e,i,s){var l=[];if(s===null&&i===null&&(i=e),c=+c,a=+a,e=+e,i=+i,s!==null){var f=Math.PI/180,d=c+e*Math.cos(-i*f),v=c+e*Math.cos(-s*f),w=a+e*Math.sin(-i*f),E=a+e*Math.sin(-s*f);l=[["M",d,w],["A",e,e,0,+(s-i>180),0,v,E]]}else l=[["M",c,a],["m",0,-i],["a",e,i,0,1,1,0,2*i],["a",e,i,0,1,1,0,-2*i],["z"]];return l},de=function(c){if(c=A(c),!c||!c.length)return[["M",0,0]];var a=[],e=0,i=0,s=0,l=0,f=0,d,v;c[0][0]==="M"&&(e=+c[0][1],i=+c[0][2],s=e,l=i,f++,a[0]=["M",e,i]);for(var w=c.length===3&&c[0][0]==="M"&&c[1][0].toUpperCase()==="R"&&c[2][0].toUpperCase()==="Z",E=void 0,T=void 0,G=f,U=c.length;G<U;G++){if(a.push(E=[]),T=c[G],d=T[0],d!==d.toUpperCase())switch(E[0]=d.toUpperCase(),E[0]){case"A":E[1]=T[1],E[2]=T[2],E[3]=T[3],E[4]=T[4],E[5]=T[5],E[6]=+T[6]+e,E[7]=+T[7]+i;break;case"V":E[1]=+T[1]+i;break;case"H":E[1]=+T[1]+e;break;case"R":v=[e,i].concat(T.slice(1));for(var et=2,ct=v.length;et<ct;et++)v[et]=+v[et]+e,v[++et]=+v[et]+i;a.pop(),a=a.concat(nt(v,w));break;case"O":a.pop(),v=Zt(e,i,T[1],T[2]),v.push(v[0]),a=a.concat(v);break;case"U":a.pop(),a=a.concat(Zt(e,i,T[1],T[2],T[3])),E=["U"].concat(a[a.length-1].slice(-2));break;case"M":s=+T[1]+e,l=+T[2]+i;break;default:for(var et=1,ct=T.length;et<ct;et++)E[et]=+T[et]+(et%2?e:i)}else if(d==="R")v=[e,i].concat(T.slice(1)),a.pop(),a=a.concat(nt(v,w)),E=["R"].concat(T.slice(-2));else if(d==="O")a.pop(),v=Zt(e,i,T[1],T[2]),v.push(v[0]),a=a.concat(v);else if(d==="U")a.pop(),a=a.concat(Zt(e,i,T[1],T[2],T[3])),E=["U"].concat(a[a.length-1].slice(-2));else for(var Ct=0,Mt=T.length;Ct<Mt;Ct++)E[Ct]=T[Ct];if(d=d.toUpperCase(),d!=="O")switch(E[0]){case"Z":e=+s,i=+l;break;case"H":e=E[1];break;case"V":i=E[1];break;case"M":s=E[E.length-2],l=E[E.length-1];break;default:e=E[E.length-2],i=E[E.length-1]}}return a},Pe=function(c,a,e,i){return[c,a,e,i,e,i]},Qe=function(c,a,e,i,s,l){var f=1/3,d=2/3;return[f*c+d*e,f*a+d*i,f*s+d*e,f*l+d*i,s,l]},rn=function(c,a,e,i,s,l,f,d,v,w){e===i&&(e+=1);var E=Math.PI*120/180,T=Math.PI/180*(+s||0),G=[],U,et,ct,Ct,Mt,Dt=function(cl,Fu,fl){var El=cl*Math.cos(fl)-Fu*Math.sin(fl),ec=cl*Math.sin(fl)+Fu*Math.cos(fl);return{x:El,y:ec}};if(w)et=w[0],ct=w[1],Ct=w[2],Mt=w[3];else{U=Dt(c,a,-T),c=U.x,a=U.y,U=Dt(d,v,-T),d=U.x,v=U.y,c===d&&a===v&&(d+=1,v+=1);var zt=(c-d)/2,Qt=(a-v)/2,Ie=zt*zt/(e*e)+Qt*Qt/(i*i);Ie>1&&(Ie=Math.sqrt(Ie),e=Ie*e,i=Ie*i);var je=e*e,ze=i*i,mn=(l===f?-1:1)*Math.sqrt(Math.abs((je*ze-je*Qt*Qt-ze*zt*zt)/(je*Qt*Qt+ze*zt*zt)));Ct=mn*e*Qt/i+(c+d)/2,Mt=mn*-i*zt/e+(a+v)/2,et=Math.asin(((a-Mt)/i).toFixed(9)),ct=Math.asin(((v-Mt)/i).toFixed(9)),et=c<Ct?Math.PI-et:et,ct=d<Ct?Math.PI-ct:ct,et<0&&(et=Math.PI*2+et),ct<0&&(ct=Math.PI*2+ct),f&&et>ct&&(et=et-Math.PI*2),!f&&ct>et&&(ct=ct-Math.PI*2)}var $n=ct-et;if(Math.abs($n)>E){var Tn=ct,or=d,kr=v;ct=et+E*(f&&ct>et?1:-1),d=Ct+e*Math.cos(ct),v=Mt+i*Math.sin(ct),G=rn(d,v,e,i,s,0,f,or,kr,[ct,Tn,Ct,Mt])}$n=ct-et;var Ta=Math.cos(et),fi=Math.sin(et),ei=Math.cos(ct),Ia=Math.sin(ct),Gi=Math.tan($n/4),Ri=4/3*e*Gi,xa=4/3*i*Gi,ja=[c,a],di=[c+Ri*fi,a-xa*Ta],hi=[d+Ri*Ia,v-xa*ei],qi=[d,v];if(di[0]=2*ja[0]-di[0],di[1]=2*ja[1]-di[1],w)return[di,hi,qi].concat(G);G=[di,hi,qi].concat(G).join().split(",");for(var fo=[],es=0,Bs=G.length;es<Bs;es++)fo[es]=es%2?Dt(G[es-1],G[es],T).y:Dt(G[es],G[es+1],T).x;return fo},wn=function(c,a){var e=de(c),i=a&&de(a),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},l={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},f=[],d=[],v="",w="",E,T=function(zt,Qt,Ie){var je,ze;if(!zt)return["C",Qt.x,Qt.y,Qt.x,Qt.y,Qt.x,Qt.y];switch(!(zt[0]in{T:1,Q:1})&&(Qt.qx=Qt.qy=null),zt[0]){case"M":Qt.X=zt[1],Qt.Y=zt[2];break;case"A":zt=["C"].concat(rn.apply(0,[Qt.x,Qt.y].concat(zt.slice(1))));break;case"S":Ie==="C"||Ie==="S"?(je=Qt.x*2-Qt.bx,ze=Qt.y*2-Qt.by):(je=Qt.x,ze=Qt.y),zt=["C",je,ze].concat(zt.slice(1));break;case"T":Ie==="Q"||Ie==="T"?(Qt.qx=Qt.x*2-Qt.qx,Qt.qy=Qt.y*2-Qt.qy):(Qt.qx=Qt.x,Qt.qy=Qt.y),zt=["C"].concat(Qe(Qt.x,Qt.y,Qt.qx,Qt.qy,zt[1],zt[2]));break;case"Q":Qt.qx=zt[1],Qt.qy=zt[2],zt=["C"].concat(Qe(Qt.x,Qt.y,zt[1],zt[2],zt[3],zt[4]));break;case"L":zt=["C"].concat(Pe(Qt.x,Qt.y,zt[1],zt[2]));break;case"H":zt=["C"].concat(Pe(Qt.x,Qt.y,zt[1],Qt.y));break;case"V":zt=["C"].concat(Pe(Qt.x,Qt.y,Qt.x,zt[1]));break;case"Z":zt=["C"].concat(Pe(Qt.x,Qt.y,Qt.X,Qt.Y));break;default:break}return zt},G=function(zt,Qt){if(zt[Qt].length>7){zt[Qt].shift();for(var Ie=zt[Qt];Ie.length;)f[Qt]="A",i&&(d[Qt]="A"),zt.splice(Qt++,0,["C"].concat(Ie.splice(0,6)));zt.splice(Qt,1),E=Math.max(e.length,i&&i.length||0)}},U=function(zt,Qt,Ie,je,ze){zt&&Qt&&zt[ze][0]==="M"&&Qt[ze][0]!=="M"&&(Qt.splice(ze,0,["M",je.x,je.y]),Ie.bx=0,Ie.by=0,Ie.x=zt[ze][1],Ie.y=zt[ze][2],E=Math.max(e.length,i&&i.length||0))};E=Math.max(e.length,i&&i.length||0);for(var et=0;et<E;et++){e[et]&&(v=e[et][0]),v!=="C"&&(f[et]=v,et&&(w=f[et-1])),e[et]=T(e[et],s,w),f[et]!=="A"&&v==="C"&&(f[et]="C"),G(e,et),i&&(i[et]&&(v=i[et][0]),v!=="C"&&(d[et]=v,et&&(w=d[et-1])),i[et]=T(i[et],l,w),d[et]!=="A"&&v==="C"&&(d[et]="C"),G(i,et)),U(e,i,s,l,et),U(i,e,l,s,et);var ct=e[et],Ct=i&&i[et],Mt=ct.length,Dt=i&&Ct.length;s.x=ct[Mt-2],s.y=ct[Mt-1],s.bx=parseFloat(ct[Mt-4])||s.x,s.by=parseFloat(ct[Mt-3])||s.y,l.bx=i&&(parseFloat(Ct[Dt-4])||l.x),l.by=i&&(parseFloat(Ct[Dt-3])||l.y),l.x=i&&Ct[Dt-2],l.y=i&&Ct[Dt-1]}return i?[e,i]:e},kn=/,?([a-z]),?/gi,De=function(c){return c.join(",").replace(kn,"$1")},wr=function(c,a,e,i,s){var l=-3*a+9*e-9*i+3*s,f=c*l+6*a-12*e+6*i;return c*f-3*a+3*e},ca=function(c,a,e,i,s,l,f,d,v){v===null&&(v=1),v=v>1?1:v<0?0:v;for(var w=v/2,E=12,T=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],G=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],U=0,et=0;et<E;et++){var ct=w*T[et]+w,Ct=wr(ct,c,e,s,f),Mt=wr(ct,a,i,l,d),Dt=Ct*Ct+Mt*Mt;U+=G[et]*Math.sqrt(Dt)}return w*U},Ar=function(c,a,e,i,s,l,f,d){for(var v=[],w=[[],[]],E,T,G,U,et=0;et<2;++et){if(et===0?(T=6*c-12*e+6*s,E=-3*c+9*e-9*s+3*f,G=3*e-3*c):(T=6*a-12*i+6*l,E=-3*a+9*i-9*l+3*d,G=3*i-3*a),Math.abs(E)<1e-12){if(Math.abs(T)<1e-12)continue;U=-G/T,U>0&&U<1&&v.push(U);continue}var ct=T*T-4*G*E,Ct=Math.sqrt(ct);if(!(ct<0)){var Mt=(-T+Ct)/(2*E);Mt>0&&Mt<1&&v.push(Mt);var Dt=(-T-Ct)/(2*E);Dt>0&&Dt<1&&v.push(Dt)}}for(var zt=v.length,Qt=zt,Ie;zt--;)U=v[zt],Ie=1-U,w[0][zt]=Ie*Ie*Ie*c+3*Ie*Ie*U*e+3*Ie*U*U*s+U*U*U*f,w[1][zt]=Ie*Ie*Ie*a+3*Ie*Ie*U*i+3*Ie*U*U*l+U*U*U*d;return w[0][Qt]=c,w[1][Qt]=a,w[0][Qt+1]=f,w[1][Qt+1]=d,w[0].length=w[1].length=Qt+2,{min:{x:Math.min.apply(0,w[0]),y:Math.min.apply(0,w[1])},max:{x:Math.max.apply(0,w[0]),y:Math.max.apply(0,w[1])}}},ua=function(c,a,e,i,s,l,f,d){if(!(Math.max(c,e)<Math.min(s,f)||Math.min(c,e)>Math.max(s,f)||Math.max(a,i)<Math.min(l,d)||Math.min(a,i)>Math.max(l,d))){var v=(c*i-a*e)*(s-f)-(c-e)*(s*d-l*f),w=(c*i-a*e)*(l-d)-(a-i)*(s*d-l*f),E=(c-e)*(l-d)-(a-i)*(s-f);if(!!E){var T=v/E,G=w/E,U=+T.toFixed(2),et=+G.toFixed(2);if(!(U<+Math.min(c,e).toFixed(2)||U>+Math.max(c,e).toFixed(2)||U<+Math.min(s,f).toFixed(2)||U>+Math.max(s,f).toFixed(2)||et<+Math.min(a,i).toFixed(2)||et>+Math.max(a,i).toFixed(2)||et<+Math.min(l,d).toFixed(2)||et>+Math.max(l,d).toFixed(2)))return{x:T,y:G}}}},$a=function(c,a,e){return a>=c.x&&a<=c.x+c.width&&e>=c.y&&e<=c.y+c.height},ri=function(c,a,e,i,s){if(s)return[["M",+c+ +s,a],["l",e-s*2,0],["a",s,s,0,0,1,s,s],["l",0,i-s*2],["a",s,s,0,0,1,-s,s],["l",s*2-e,0],["a",s,s,0,0,1,-s,-s],["l",0,s*2-i],["a",s,s,0,0,1,s,-s],["z"]];var l=[["M",c,a],["l",e,0],["l",0,i],["l",-e,0],["z"]];return l.parsePathArray=De,l},ba=function(c,a,e,i){return c===null&&(c=a=e=i=0),a===null&&(a=c.y,e=c.width,i=c.height,c=c.x),{x:c,y:a,width:e,w:e,height:i,h:i,x2:c+e,y2:a+i,cx:c+e/2,cy:a+i/2,r1:Math.min(e,i)/2,r2:Math.max(e,i)/2,r0:Math.sqrt(e*e+i*i)/2,path:ri(c,a,e,i),vb:[c,a,e,i].join(" ")}},ki=function(c,a){return c=ba(c),a=ba(a),$a(a,c.x,c.y)||$a(a,c.x2,c.y)||$a(a,c.x,c.y2)||$a(a,c.x2,c.y2)||$a(c,a.x,a.y)||$a(c,a.x2,a.y)||$a(c,a.x,a.y2)||$a(c,a.x2,a.y2)||(c.x<a.x2&&c.x>a.x||a.x<c.x2&&a.x>c.x)&&(c.y<a.y2&&c.y>a.y||a.y<c.y2&&a.y>c.y)},Eo=function(c,a,e,i,s,l,f,d){(0,_.isArray)(c)||(c=[c,a,e,i,s,l,f,d]);var v=Ar.apply(null,c);return ba(v.min.x,v.min.y,v.max.x-v.min.x,v.max.y-v.min.y)},Lo=function(c,a,e,i,s,l,f,d,v){var w=1-v,E=Math.pow(w,3),T=Math.pow(w,2),G=v*v,U=G*v,et=E*c+T*3*v*e+w*3*v*v*s+U*f,ct=E*a+T*3*v*i+w*3*v*v*l+U*d,Ct=c+2*v*(e-c)+G*(s-2*e+c),Mt=a+2*v*(i-a)+G*(l-2*i+a),Dt=e+2*v*(s-e)+G*(f-2*s+e),zt=i+2*v*(l-i)+G*(d-2*l+i),Qt=w*c+v*e,Ie=w*a+v*i,je=w*s+v*f,ze=w*l+v*d,mn=90-Math.atan2(Ct-Dt,Mt-zt)*180/Math.PI;return{x:et,y:ct,m:{x:Ct,y:Mt},n:{x:Dt,y:zt},start:{x:Qt,y:Ie},end:{x:je,y:ze},alpha:mn}},Bo=function(c,a,e){var i=Eo(c),s=Eo(a);if(!ki(i,s))return e?0:[];for(var l=ca.apply(0,c),f=ca.apply(0,a),d=~~(l/8),v=~~(f/8),w=[],E=[],T={},G=e?0:[],U=0;U<d+1;U++){var et=Lo.apply(0,c.concat(U/d));w.push({x:et.x,y:et.y,t:U/d})}for(var U=0;U<v+1;U++){var et=Lo.apply(0,a.concat(U/v));E.push({x:et.x,y:et.y,t:U/v})}for(var U=0;U<d;U++)for(var ct=0;ct<v;ct++){var Ct=w[U],Mt=w[U+1],Dt=E[ct],zt=E[ct+1],Qt=Math.abs(Mt.x-Ct.x)<.001?"y":"x",Ie=Math.abs(zt.x-Dt.x)<.001?"y":"x",je=ua(Ct.x,Ct.y,Mt.x,Mt.y,Dt.x,Dt.y,zt.x,zt.y);if(je){if(T[je.x.toFixed(4)]===je.y.toFixed(4))continue;T[je.x.toFixed(4)]=je.y.toFixed(4);var ze=Ct.t+Math.abs((je[Qt]-Ct[Qt])/(Mt[Qt]-Ct[Qt]))*(Mt.t-Ct.t),mn=Dt.t+Math.abs((je[Ie]-Dt[Ie])/(zt[Ie]-Dt[Ie]))*(zt.t-Dt.t);ze>=0&&ze<=1&&mn>=0&&mn<=1&&(e?G+=1:G.push({x:je.x,y:je.y,t1:ze,t2:mn}))}}return G},go=function(c,a,e){c=wn(c),a=wn(a);for(var i,s,l,f,d,v,w,E,T,G,U=e?0:[],et=0,ct=c.length;et<ct;et++){var Ct=c[et];if(Ct[0]==="M")i=d=Ct[1],s=v=Ct[2];else{Ct[0]==="C"?(T=[i,s].concat(Ct.slice(1)),i=T[6],s=T[7]):(T=[i,s,i,s,d,v,d,v],i=d,s=v);for(var Mt=0,Dt=a.length;Mt<Dt;Mt++){var zt=a[Mt];if(zt[0]==="M")l=w=zt[1],f=E=zt[2];else{zt[0]==="C"?(G=[l,f].concat(zt.slice(1)),l=G[6],f=G[7]):(G=[l,f,l,f,w,E,w,E],l=w,f=E);var Qt=Bo(T,G,e);if(e)U+=Qt;else{for(var Ie=0,je=Qt.length;Ie<je;Ie++)Qt[Ie].segment1=et,Qt[Ie].segment2=Mt,Qt[Ie].bez1=T,Qt[Ie].bez2=G;U=U.concat(Qt)}}}}}return U},Ao=function(c,a){return go(c,a)};function qu(c,a){var e=[],i=[];function s(l,f){if(l.length===1)e.push(l[0]),i.push(l[0]);else{for(var d=[],v=0;v<l.length-1;v++)v===0&&e.push(l[0]),v===l.length-2&&i.push(l[v+1]),d[v]=[(1-f)*l[v][0]+f*l[v+1][0],(1-f)*l[v][1]+f*l[v+1][1]];s(d,f)}}return c.length&&s(c,a),{left:e,right:i.reverse()}}function zu(c,a,e){var i=[[c[1],c[2]]];e=e||2;var s=[];a[0]==="A"?(i.push(a[6]),i.push(a[7])):a[0]==="C"?(i.push([a[1],a[2]]),i.push([a[3],a[4]]),i.push([a[5],a[6]])):a[0]==="S"||a[0]==="Q"?(i.push([a[1],a[2]]),i.push([a[3],a[4]])):i.push([a[1],a[2]]);for(var l=i,f=1/e,d=0;d<e-1;d++){var v=f/(1-f*d),w=qu(l,v);s.push(w.left),l=w.right}s.push(l);var E=s.map(function(T){var G=[];return T.length===4&&(G.push("C"),G=G.concat(T[2])),T.length>=3&&(T.length===3&&G.push("Q"),G=G.concat(T[1])),T.length===2&&G.push("L"),G=G.concat(T[T.length-1]),G});return E}var Uu=function(c,a,e){if(e===1)return[[].concat(c)];var i=[];if(a[0]==="L"||a[0]==="C"||a[0]==="Q")i=i.concat(zu(c,a,e));else{var s=[].concat(c);s[0]==="M"&&(s[0]="L");for(var l=0;l<=e-1;l++)i.push(s)}return i},Qu=function(c,a){if(c.length===1)return c;var e=c.length-1,i=a.length-1,s=e/i,l=[];if(c.length===1&&c[0][0]==="M"){for(var f=0;f<i-e;f++)c.push(c[0]);return c}for(var f=0;f<i;f++){var d=Math.floor(s*f);l[d]=(l[d]||0)+1}var v=l.reduce(function(w,E,T){return T===e?w.concat(c[e]):w.concat(Uu(c[T],c[T+1],E))},[]);return v.unshift(c[0]),(a[i]==="Z"||a[i]==="z")&&v.push("Z"),v},Wu=function(c,a){if(c.length!==a.length)return!1;var e=!0;return(0,_.each)(c,function(i,s){if(i!==a[s])return e=!1,!1}),e};function al(c,a,e){var i=null,s=e;return a<s&&(s=a,i="add"),c<s&&(s=c,i="del"),{type:i,min:s}}var Vu=function(c,a){var e=c.length,i=a.length,s,l,f=0;if(e===0||i===0)return null;for(var d=[],v=0;v<=e;v++)d[v]=[],d[v][0]={min:v};for(var w=0;w<=i;w++)d[0][w]={min:w};for(var v=1;v<=e;v++){s=c[v-1];for(var w=1;w<=i;w++){l=a[w-1],Wu(s,l)?f=0:f=1;var E=d[v-1][w].min+1,T=d[v][w-1].min+1,G=d[v-1][w-1].min+f;d[v][w]=al(E,T,G)}}return d},ps=function(c,a){var e=Vu(c,a),i=c.length,s=a.length,l=[],f=1,d=1;if(e[i][s].min!==i){for(var v=1;v<=i;v++){var w=e[v][v].min;d=v;for(var E=f;E<=s;E++)e[v][E].min<w&&(w=e[v][E].min,d=E);f=d,e[v][f].type&&l.push({index:v-1,type:e[v][f].type})}for(var v=l.length-1;v>=0;v--)f=l[v].index,l[v].type==="add"?c.splice(f,0,[].concat(c[f])):c.splice(f,1)}i=c.length;var T=s-i;if(i<s)for(var v=0;v<T;v++)c[i-1][0]==="z"||c[i-1][0]==="Z"?c.splice(i-2,0,c[i-2]):c.push(c[i-1]),i+=1;return c};function ru(c,a,e){for(var i=[].concat(c),s,l=1/(e+1),f=pf(a)[0],d=1;d<=e;d++)l*=d,s=Math.floor(c.length*l),s===0?i.unshift([f[0]*l+c[s][0]*(1-l),f[1]*l+c[s][1]*(1-l)]):i.splice(s,0,[f[0]*l+c[s][0]*(1-l),f[1]*l+c[s][1]*(1-l)]);return i}function pf(c){var a=[];switch(c[0]){case"M":a.push([c[1],c[2]]);break;case"L":a.push([c[1],c[2]]);break;case"A":a.push([c[6],c[7]]);break;case"Q":a.push([c[3],c[4]]),a.push([c[1],c[2]]);break;case"T":a.push([c[1],c[2]]);break;case"C":a.push([c[5],c[6]]),a.push([c[1],c[2]]),a.push([c[3],c[4]]);break;case"S":a.push([c[3],c[4]]),a.push([c[1],c[2]]);break;case"H":a.push([c[1],c[1]]);break;case"V":a.push([c[1],c[1]]);break;default:}return a}var Ec=function(c,a){if(c.length<=1)return c;for(var e,i=0;i<a.length;i++)if(c[i][0]!==a[i][0])switch(e=pf(c[i]),a[i][0]){case"M":c[i]=["M"].concat(e[0]);break;case"L":c[i]=["L"].concat(e[0]);break;case"A":c[i]=[].concat(a[i]),c[i][6]=e[0][0],c[i][7]=e[0][1];break;case"Q":if(e.length<2)if(i>0)e=ru(e,c[i-1],1);else{c[i]=a[i];break}c[i]=["Q"].concat(e.reduce(function(s,l){return s.concat(l)},[]));break;case"T":c[i]=["T"].concat(e[0]);break;case"C":if(e.length<3)if(i>0)e=ru(e,c[i-1],2);else{c[i]=a[i];break}c[i]=["C"].concat(e.reduce(function(s,l){return s.concat(l)},[]));break;case"S":if(e.length<2)if(i>0)e=ru(e,c[i-1],1);else{c[i]=a[i];break}c[i]=["S"].concat(e.reduce(function(s,l){return s.concat(l)},[]));break;default:c[i]=a[i]}return c},Ou=function(){function c(a,e){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=a,this.name=a,this.originalEvent=e,this.timeStamp=e.timeStamp}return c.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},c.prototype.stopPropagation=function(){this.propagationStopped=!0},c.prototype.toString=function(){var a=this.type;return"[Event (type="+a+")]"},c.prototype.save=function(){},c.prototype.restore=function(){},c}(),Uc=Ou;function Wh(c,a){var e=c.indexOf(a);e!==-1&&c.splice(e,1)}var pp=typeof window!="undefined"&&typeof window.document!="undefined";function $p(c,a){if(c.isCanvas())return!0;for(var e=a.getParent(),i=!1;e;){if(e===c){i=!0;break}e=e.getParent()}return i}function sd(c){return c.cfg.visible&&c.cfg.capture}var kd=function(c){(0,O.__extends)(a,c);function a(e){var i=c.call(this)||this;i.destroyed=!1;var s=i.getDefaultCfg();return i.cfg=(0,_.mix)(s,e),i}return a.prototype.getDefaultCfg=function(){return{}},a.prototype.get=function(e){return this.cfg[e]},a.prototype.set=function(e,i){this.cfg[e]=i},a.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},a}(wt),vp=kd,$f=$(34155),If=function(c,a,e){if(e||arguments.length===2)for(var i=0,s=a.length,l;i<s;i++)(l||!(i in a))&&(l||(l=Array.prototype.slice.call(a,0,i)),l[i]=a[i]);return c.concat(l||Array.prototype.slice.call(a))},Dd=function(){function c(a,e,i){this.name=a,this.version=e,this.os=i,this.type="browser"}return c}(),eh=function(){function c(a){this.version=a,this.type="node",this.name="node",this.os=$f.platform}return c}(),Gp=function(){function c(a,e,i,s){this.name=a,this.version=e,this.os=i,this.bot=s,this.type="bot-device"}return c}(),Oc=function(){function c(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return c}(),vh=function(){function c(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return c}(),Pi=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,gh=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,cs=3,Wc=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Pi]],Gf=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function nf(c){return c?Nu(c):typeof document=="undefined"&&typeof navigator!="undefined"&&navigator.product==="ReactNative"?new vh:typeof navigator!="undefined"?Nu(navigator.userAgent):mh()}function rf(c){return c!==""&&Wc.reduce(function(a,e){var i=e[0],s=e[1];if(a)return a;var l=s.exec(c);return!!l&&[i,l]},!1)}function Od(c){var a=rf(c);return a?a[0]:null}function Nu(c){var a=rf(c);if(!a)return null;var e=a[0],i=a[1];if(e==="searchbot")return new Oc;var s=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);s?s.length<cs&&(s=If(If([],s,!0),oc(cs-s.length),!0)):s=[];var l=s.join("."),f=ic(c),d=gh.exec(c);return d&&d[1]?new Gp(e,l,f,d[1]):new Dd(e,l,f)}function ic(c){for(var a=0,e=Gf.length;a<e;a++){var i=Gf[a],s=i[0],l=i[1],f=l.exec(c);if(f)return s}return null}function mh(){var c=typeof $f!="undefined"&&$f.version;return c?new eh($f.version.slice(1)):null}function oc(c){for(var a=[],e=0;e<c;e++)a.push("0");return a}function Ot(c,a){var e=[],i=c[0],s=c[1],l=c[2],f=c[3],d=c[4],v=c[5],w=c[6],E=c[7],T=c[8],G=a[0],U=a[1],et=a[2],ct=a[3],Ct=a[4],Mt=a[5],Dt=a[6],zt=a[7],Qt=a[8];return e[0]=G*i+U*f+et*w,e[1]=G*s+U*d+et*E,e[2]=G*l+U*v+et*T,e[3]=ct*i+Ct*f+Mt*w,e[4]=ct*s+Ct*d+Mt*E,e[5]=ct*l+Ct*v+Mt*T,e[6]=Dt*i+zt*f+Qt*w,e[7]=Dt*s+zt*d+Qt*E,e[8]=Dt*l+zt*v+Qt*T,e}function ne(c,a){var e=[],i=a[0],s=a[1];return e[0]=c[0]*i+c[3]*s+c[6],e[1]=c[1]*i+c[4]*s+c[7],e}function Se(c){var a=[],e=c[0],i=c[1],s=c[2],l=c[3],f=c[4],d=c[5],v=c[6],w=c[7],E=c[8],T=E*f-d*w,G=-E*l+d*v,U=w*l-f*v,et=e*T+i*G+s*U;return et?(et=1/et,a[0]=T*et,a[1]=(-E*i+s*w)*et,a[2]=(d*i-s*f)*et,a[3]=G*et,a[4]=(E*e-s*v)*et,a[5]=(-d*e+s*l)*et,a[6]=U*et,a[7]=(-w*e+i*v)*et,a[8]=(f*e-i*l)*et,a):null}var Ke=ie,yn="matrix",yr=["zIndex","capture","visible","type"],Ir=["repeat"],la=":",Dn="*";function Ga(c){for(var a=[],e=0;e<c.length;e++)(0,_.isArray)(c[e])?a.push([].concat(c[e])):a.push(c[e]);return a}function xi(c,a){var e={},i=a.attrs;for(var s in c)e[s]=i[s];return e}function Ui(c,a){var e={},i=a.attr();return(0,_.each)(c,function(s,l){Ir.indexOf(l)===-1&&!(0,_.isEqual)(i[l],s)&&(e[l]=s)}),e}function Ii(c,a){if(a.onFrame)return c;var e=a.startTime,i=a.delay,s=a.duration,l=Object.prototype.hasOwnProperty;return(0,_.each)(c,function(f){e+i<f.startTime+f.delay+f.duration&&s>f.delay&&(0,_.each)(a.toAttrs,function(d,v){l.call(f.toAttrs,v)&&(delete f.toAttrs[v],delete f.fromAttrs[v])})}),c}var Mo=function(c){(0,O.__extends)(a,c);function a(e){var i=c.call(this,e)||this;i.attrs={};var s=i.getDefaultAttrs();return(0,_.mix)(s,e.attrs),i.attrs=s,i.initAttrs(s),i.initAnimate(),i}return a.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},a.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},a.prototype.onCanvasChange=function(e){},a.prototype.initAttrs=function(e){},a.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},a.prototype.isGroup=function(){return!1},a.prototype.getParent=function(){return this.get("parent")},a.prototype.getCanvas=function(){return this.get("canvas")},a.prototype.attr=function(){for(var e,i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var l=i[0],f=i[1];if(!l)return this.attrs;if((0,_.isObject)(l)){for(var d in l)this.setAttr(d,l[d]);return this.afterAttrsChange(l),this}return i.length===2?(this.setAttr(l,f),this.afterAttrsChange((e={},e[l]=f,e)),this):this.attrs[l]},a.prototype.isClipped=function(e,i){var s=this.getClip();return s&&!s.isHit(e,i)},a.prototype.setAttr=function(e,i){var s=this.attrs[e];s!==i&&(this.attrs[e]=i,this.onAttrChange(e,i,s))},a.prototype.onAttrChange=function(e,i,s){e==="matrix"&&this.set("totalMatrix",null)},a.prototype.afterAttrsChange=function(e){if(this.cfg.isClipShape){var i=this.cfg.applyTo;i&&i.onCanvasChange("clip")}else this.onCanvasChange("attr")},a.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},a.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},a.prototype.setZIndex=function(e){this.set("zIndex",e);var i=this.getParent();return i&&i.sort(),this},a.prototype.toFront=function(){var e=this.getParent();if(!!e){var i=e.getChildren(),s=this.get("el"),l=i.indexOf(this);i.splice(l,1),i.push(this),this.onCanvasChange("zIndex")}},a.prototype.toBack=function(){var e=this.getParent();if(!!e){var i=e.getChildren(),s=this.get("el"),l=i.indexOf(this);i.splice(l,1),i.unshift(this),this.onCanvasChange("zIndex")}},a.prototype.remove=function(e){e===void 0&&(e=!0);var i=this.getParent();i?(Wh(i.getChildren(),this),i.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),e&&this.destroy()},a.prototype.resetMatrix=function(){this.attr(yn,this.getDefaultMatrix()),this.onCanvasChange("matrix")},a.prototype.getMatrix=function(){return this.attr(yn)},a.prototype.setMatrix=function(e){this.attr(yn,e),this.onCanvasChange("matrix")},a.prototype.getTotalMatrix=function(){var e=this.cfg.totalMatrix;if(!e){var i=this.attr("matrix"),s=this.cfg.parentMatrix;s&&i?e=Ot(s,i):e=i||s,this.set("totalMatrix",e)}return e},a.prototype.applyMatrix=function(e){var i=this.attr("matrix"),s=null;e&&i?s=Ot(e,i):s=i||e,this.set("totalMatrix",s),this.set("parentMatrix",e)},a.prototype.getDefaultMatrix=function(){return null},a.prototype.applyToMatrix=function(e){var i=this.attr("matrix");return i?ne(i,e):e},a.prototype.invertFromMatrix=function(e){var i=this.attr("matrix");if(i){var s=Se(i);if(s)return ne(s,e)}return e},a.prototype.setClip=function(e){var i=this.getCanvas(),s=null;if(e){var l=this.getShapeBase(),f=(0,_.upperFirst)(e.type),d=l[f];d&&(s=new d({type:e.type,isClipShape:!0,applyTo:this,attrs:e.attrs,canvas:i}))}return this.set("clipShape",s),this.onCanvasChange("clip"),s},a.prototype.getClip=function(){var e=this.cfg.clipShape;return e||null},a.prototype.clone=function(){var e=this,i=this.attrs,s={};(0,_.each)(i,function(d,v){(0,_.isArray)(i[v])?s[v]=Ga(i[v]):s[v]=i[v]});var l=this.constructor,f=new l({attrs:s});return(0,_.each)(yr,function(d){f.set(d,e.get(d))}),f},a.prototype.destroy=function(){var e=this.destroyed;e||(this.attrs={},c.prototype.destroy.call(this))},a.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},a.prototype.animate=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(!(!this.get("timeline")&&!this.get("canvas"))){this.set("animating",!0);var s=this.get("timeline");s||(s=this.get("canvas").get("timeline"),this.set("timeline",s));var l=this.get("animations")||[];s.timer||s.initTimer();var f=e[0],d=e[1],v=e[2],w=v===void 0?"easeLinear":v,E=e[3],T=E===void 0?_.noop:E,G=e[4],U=G===void 0?0:G,et,ct,Ct,Mt,Dt;(0,_.isFunction)(f)?(et=f,f={}):(0,_.isObject)(f)&&f.onFrame&&(et=f.onFrame,ct=f.repeat),(0,_.isObject)(d)?(Dt=d,d=Dt.duration,w=Dt.easing||"easeLinear",U=Dt.delay||0,ct=Dt.repeat||ct||!1,T=Dt.callback||_.noop,Ct=Dt.pauseCallback||_.noop,Mt=Dt.resumeCallback||_.noop):((0,_.isNumber)(T)&&(U=T,T=null),(0,_.isFunction)(w)?(T=w,w="easeLinear"):w=w||"easeLinear");var zt=Ui(f,this),Qt={fromAttrs:xi(zt,this),toAttrs:zt,duration:d,easing:w,repeat:ct,callback:T,pauseCallback:Ct,resumeCallback:Mt,delay:U,startTime:s.getTime(),id:(0,_.uniqueId)(),onFrame:et,pathFormatted:!1};l.length>0?l=Ii(l,Qt):s.addAnimator(this),l.push(Qt),this.set("animations",l),this.set("_pause",{isPaused:!1})}},a.prototype.stopAnimate=function(e){var i=this;e===void 0&&(e=!0);var s=this.get("animations");(0,_.each)(s,function(l){e&&(l.onFrame?i.attr(l.onFrame(1)):i.attr(l.toAttrs)),l.callback&&l.callback()}),this.set("animating",!1),this.set("animations",[])},a.prototype.pauseAnimate=function(){var e=this.get("timeline"),i=this.get("animations"),s=e.getTime();return(0,_.each)(i,function(l){l._paused=!0,l._pauseTime=s,l.pauseCallback&&l.pauseCallback()}),this.set("_pause",{isPaused:!0,pauseTime:s}),this},a.prototype.resumeAnimate=function(){var e=this.get("timeline"),i=e.getTime(),s=this.get("animations"),l=this.get("_pause").pauseTime;return(0,_.each)(s,function(f){f.startTime=f.startTime+(i-l),f._paused=!1,f._pauseTime=null,f.resumeCallback&&f.resumeCallback()}),this.set("_pause",{isPaused:!1}),this.set("animations",s),this},a.prototype.emitDelegation=function(e,i){var s=this,l=i.propagationPath,f=this.getEvents(),d;e==="mouseenter"?d=i.fromShape:e==="mouseleave"&&(d=i.toShape);for(var v=function(G){var U=l[G],et=U.get("name");if(et){if((U.isGroup()||U.isCanvas&&U.isCanvas())&&d&&$p(U,d))return"break";(0,_.isArray)(et)?(0,_.each)(et,function(ct){s.emitDelegateEvent(U,ct,i)}):w.emitDelegateEvent(U,et,i)}},w=this,E=0;E<l.length;E++){var T=v(E);if(T==="break")break}},a.prototype.emitDelegateEvent=function(e,i,s){var l=this.getEvents(),f=i+la+s.type;(l[f]||l[Dn])&&(s.name=f,s.currentTarget=e,s.delegateTarget=this,s.delegateObject=e.get("delegateObject"),this.emit(f,s))},a.prototype.translate=function(e,i){e===void 0&&(e=0),i===void 0&&(i=0);var s=this.getMatrix(),l=Ke(s,[["t",e,i]]);return this.setMatrix(l),this},a.prototype.move=function(e,i){var s=this.attr("x")||0,l=this.attr("y")||0;return this.translate(e-s,i-l),this},a.prototype.moveTo=function(e,i){return this.move(e,i)},a.prototype.scale=function(e,i){var s=this.getMatrix(),l=Ke(s,[["s",e,i||e]]);return this.setMatrix(l),this},a.prototype.rotate=function(e){var i=this.getMatrix(),s=Ke(i,[["r",e]]);return this.setMatrix(s),this},a.prototype.rotateAtStart=function(e){var i=this.attr(),s=i.x,l=i.y,f=this.getMatrix(),d=Ke(f,[["t",-s,-l],["r",e],["t",s,l]]);return this.setMatrix(d),this},a.prototype.rotateAtPoint=function(e,i,s){var l=this.getMatrix(),f=Ke(l,[["t",-e,-i],["r",s],["t",e,i]]);return this.setMatrix(f),this},a}(vp),rs=Mo,Xo={},so="_INDEX";function jo(c,a){if(c.set("canvas",a),c.isGroup()){var e=c.get("children");e.length&&e.forEach(function(i){jo(i,a)})}}function Ci(c,a){if(c.set("timeline",a),c.isGroup()){var e=c.get("children");e.length&&e.forEach(function(i){Ci(i,a)})}}function os(c,a){var e=c.getChildren();return e.indexOf(a)>=0}function zo(c,a,e){e===void 0&&(e=!0),e?a.destroy():(a.set("parent",null),a.set("canvas",null)),Wh(c.getChildren(),a)}function Xi(c){return function(a,e){var i=c(a,e);return i===0?a[so]-e[so]:i}}var Qo=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.isCanvas=function(){return!1},a.prototype.getBBox=function(){var e=Infinity,i=-Infinity,s=Infinity,l=-Infinity,f=this.getChildren().filter(function(v){return v.get("visible")&&(!v.isGroup()||v.isGroup()&&v.getChildren().length>0)});f.length>0?(0,_.each)(f,function(v){var w=v.getBBox(),E=w.minX,T=w.maxX,G=w.minY,U=w.maxY;E<e&&(e=E),T>i&&(i=T),G<s&&(s=G),U>l&&(l=U)}):(e=0,i=0,s=0,l=0);var d={x:e,y:s,minX:e,minY:s,maxX:i,maxY:l,width:i-e,height:l-s};return d},a.prototype.getCanvasBBox=function(){var e=Infinity,i=-Infinity,s=Infinity,l=-Infinity,f=this.getChildren().filter(function(v){return v.get("visible")&&(!v.isGroup()||v.isGroup()&&v.getChildren().length>0)});f.length>0?(0,_.each)(f,function(v){var w=v.getCanvasBBox(),E=w.minX,T=w.maxX,G=w.minY,U=w.maxY;E<e&&(e=E),T>i&&(i=T),G<s&&(s=G),U>l&&(l=U)}):(e=0,i=0,s=0,l=0);var d={x:e,y:s,minX:e,minY:s,maxX:i,maxY:l,width:i-e,height:l-s};return d},a.prototype.getDefaultCfg=function(){var e=c.prototype.getDefaultCfg.call(this);return e.children=[],e},a.prototype.onAttrChange=function(e,i,s){if(c.prototype.onAttrChange.call(this,e,i,s),e==="matrix"){var l=this.getTotalMatrix();this._applyChildrenMarix(l)}},a.prototype.applyMatrix=function(e){var i=this.getTotalMatrix();c.prototype.applyMatrix.call(this,e);var s=this.getTotalMatrix();s!==i&&this._applyChildrenMarix(s)},a.prototype._applyChildrenMarix=function(e){var i=this.getChildren();(0,_.each)(i,function(s){s.applyMatrix(e)})},a.prototype.addShape=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var s=e[0],l=e[1];(0,_.isObject)(s)?l=s:l.type=s;var f=Xo[l.type];f||(f=(0,_.upperFirst)(l.type),Xo[l.type]=f);var d=this.getShapeBase(),v=new d[f](l);return this.add(v),v},a.prototype.addGroup=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var s=e[0],l=e[1],f;if((0,_.isFunction)(s))l?f=new s(l):f=new s({parent:this});else{var d=s||{},v=this.getGroupBase();f=new v(d)}return this.add(f),f},a.prototype.getCanvas=function(){var e;return this.isCanvas()?e=this:e=this.get("canvas"),e},a.prototype.getShape=function(e,i,s){if(!sd(this))return null;var l=this.getChildren(),f;if(this.isCanvas())f=this._findShape(l,e,i,s);else{var d=[e,i,1];d=this.invertFromMatrix(d),this.isClipped(d[0],d[1])||(f=this._findShape(l,d[0],d[1],s))}return f},a.prototype._findShape=function(e,i,s,l){for(var f=null,d=e.length-1;d>=0;d--){var v=e[d];if(sd(v)&&(v.isGroup()?f=v.getShape(i,s,l):v.isHit(i,s)&&(f=v)),f)break}return f},a.prototype.add=function(e){var i=this.getCanvas(),s=this.getChildren(),l=this.get("timeline"),f=e.getParent();f&&zo(f,e,!1),e.set("parent",this),i&&jo(e,i),l&&Ci(e,l),s.push(e),e.onCanvasChange("add"),this._applyElementMatrix(e)},a.prototype._applyElementMatrix=function(e){var i=this.getTotalMatrix();i&&e.applyMatrix(i)},a.prototype.getChildren=function(){return this.get("children")},a.prototype.sort=function(){var e=this.getChildren();(0,_.each)(e,function(i,s){return i[so]=s,i}),e.sort(Xi(function(i,s){return i.get("zIndex")-s.get("zIndex")})),this.onCanvasChange("sort")},a.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var e=this.getChildren(),i=e.length-1;i>=0;i--)e[i].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},a.prototype.destroy=function(){this.get("destroyed")||(this.clear(),c.prototype.destroy.call(this))},a.prototype.getFirst=function(){return this.getChildByIndex(0)},a.prototype.getLast=function(){var e=this.getChildren();return this.getChildByIndex(e.length-1)},a.prototype.getChildByIndex=function(e){var i=this.getChildren();return i[e]},a.prototype.getCount=function(){var e=this.getChildren();return e.length},a.prototype.contain=function(e){var i=this.getChildren();return i.indexOf(e)>-1},a.prototype.removeChild=function(e,i){i===void 0&&(i=!0),this.contain(e)&&e.remove(i)},a.prototype.findAll=function(e){var i=[],s=this.getChildren();return(0,_.each)(s,function(l){e(l)&&i.push(l),l.isGroup()&&(i=i.concat(l.findAll(e)))}),i},a.prototype.find=function(e){var i=null,s=this.getChildren();return(0,_.each)(s,function(l){if(e(l)?i=l:l.isGroup()&&(i=l.find(e)),i)return!1}),i},a.prototype.findById=function(e){return this.find(function(i){return i.get("id")===e})},a.prototype.findByClassName=function(e){return this.find(function(i){return i.get("className")===e})},a.prototype.findAllByName=function(e){return this.findAll(function(i){return i.get("name")===e})},a}(rs),Is=Qo,$s=0,Ts=0,Ds=0,Gs=1e3,dr,Vi,af=0,Tf=0,sc=0,Af=typeof performance=="object"&&performance.now?performance:Date,Sc=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(c){setTimeout(c,17)};function _l(){return Tf||(Sc(Rd),Tf=Af.now()+sc)}function Rd(){Tf=0}function ud(){this._call=this._time=this._next=null}ud.prototype=pn.prototype={constructor:ud,restart:function(c,a,e){if(typeof c!="function")throw new TypeError("callback is not a function");e=(e==null?_l():+e)+(a==null?0:+a),!this._next&&Vi!==this&&(Vi?Vi._next=this:dr=this,Vi=this),this._call=c,this._time=e,Rc()},stop:function(){this._call&&(this._call=null,this._time=Infinity,Rc())}};function pn(c,a,e){var i=new ud;return i.restart(c,a,e),i}function nh(){_l(),++$s;for(var c=dr,a;c;)(a=Tf-c._time)>=0&&c._call.call(null,a),c=c._next;--$s}function ld(){Tf=(af=Af.now())+sc,$s=Ts=0;try{nh()}finally{$s=0,Vh(),Tf=0}}function br(){var c=Af.now(),a=c-af;a>Gs&&(sc-=a,af=c)}function Vh(){for(var c,a=dr,e,i=Infinity;a;)a._call?(i>a._time&&(i=a._time),c=a,a=a._next):(e=a._next,a._next=null,a=c?c._next=e:dr=e);Vi=c,Rc(i)}function Rc(c){if(!$s){Ts&&(Ts=clearTimeout(Ts));var a=c-Tf;a>24?(c<Infinity&&(Ts=setTimeout(ld,c-Af.now()-sc)),Ds&&(Ds=clearInterval(Ds))):(Ds||(af=Af.now(),Ds=setInterval(br,Gs)),$s=1,Sc(ld))}}function Lc(c,a,e){c.prototype=a.prototype=e,e.constructor=c}function Vc(c,a){var e=Object.create(c.prototype);for(var i in a)e[i]=a[i];return e}function Pc(){}var Ru=.7,Fc=1/Ru,Rl="\\s*([+-]?\\d+)\\s*",yh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",jc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",jh=/^#([0-9a-f]{3,8})$/,Hh=new RegExp("^rgb\\(".concat(Rl,",").concat(Rl,",").concat(Rl,"\\)$")),Hc=new RegExp("^rgb\\(".concat(jc,",").concat(jc,",").concat(jc,"\\)$")),Sv=new RegExp("^rgba\\(".concat(Rl,",").concat(Rl,",").concat(Rl,",").concat(yh,"\\)$")),vf=new RegExp("^rgba\\(".concat(jc,",").concat(jc,",").concat(jc,",").concat(yh,"\\)$")),Ld=new RegExp("^hsl\\(".concat(yh,",").concat(jc,",").concat(jc,"\\)$")),gf=new RegExp("^hsla\\(".concat(yh,",").concat(jc,",").concat(jc,",").concat(yh,"\\)$")),gp={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Lc(Pc,rh,{copy:function(a){return Object.assign(new this.constructor,this,a)},displayable:function(){return this.rgb().displayable()},hex:mp,formatHex:mp,formatHex8:Pd,formatHsl:yp,formatRgb:il,toString:il});function mp(){return this.rgb().formatHex()}function Pd(){return this.rgb().formatHex8()}function yp(){return ih(this).formatHsl()}function il(){return this.rgb().formatRgb()}function rh(c){var a,e;return c=(c+"").trim().toLowerCase(),(a=jh.exec(c))?(e=a[1].length,a=parseInt(a[1],16),e===6?Up(a):e===3?new Al(a>>8&15|a>>4&240,a>>4&15|a&240,(a&15)<<4|a&15,1):e===8?Xh(a>>24&255,a>>16&255,a>>8&255,(a&255)/255):e===4?Xh(a>>12&15|a>>8&240,a>>8&15|a>>4&240,a>>4&15|a&240,((a&15)<<4|a&15)/255):null):(a=Hh.exec(c))?new Al(a[1],a[2],a[3],1):(a=Hc.exec(c))?new Al(a[1]*255/100,a[2]*255/100,a[3]*255/100,1):(a=Sv.exec(c))?Xh(a[1],a[2],a[3],a[4]):(a=vf.exec(c))?Xh(a[1]*255/100,a[2]*255/100,a[3]*255/100,a[4]):(a=Ld.exec(c))?Bd(a[1],a[2]/100,a[3]/100,1):(a=gf.exec(c))?Bd(a[1],a[2]/100,a[3]/100,a[4]):gp.hasOwnProperty(c)?Up(gp[c]):c==="transparent"?new Al(NaN,NaN,NaN,0):null}function Up(c){return new Al(c>>16&255,c>>8&255,c&255,1)}function Xh(c,a,e,i){return i<=0&&(c=a=e=NaN),new Al(c,a,e,i)}function Fd(c){return c instanceof Pc||(c=rh(c)),c?(c=c.rgb(),new Al(c.r,c.g,c.b,c.opacity)):new Al}function Kl(c,a,e,i){return arguments.length===1?Fd(c):new Al(c,a,e,i==null?1:i)}function Al(c,a,e,i){this.r=+c,this.g=+a,this.b=+e,this.opacity=+i}Lc(Al,Kl,Vc(Pc,{brighter:function(a){return a=a==null?Fc:Math.pow(Fc,a),new Al(this.r*a,this.g*a,this.b*a,this.opacity)},darker:function(a){return a=a==null?Ru:Math.pow(Ru,a),new Al(this.r*a,this.g*a,this.b*a,this.opacity)},rgb:function(){return this},clamp:function(){return new Al(of(this.r),of(this.g),of(this.b),Ll(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ml,formatHex:Ml,formatHex8:ah,formatRgb:Os,toString:Os}));function Ml(){return"#".concat(Sn(this.r)).concat(Sn(this.g)).concat(Sn(this.b))}function ah(){return"#".concat(Sn(this.r)).concat(Sn(this.g)).concat(Sn(this.b)).concat(Sn((isNaN(this.opacity)?1:this.opacity)*255))}function Os(){var c=Ll(this.opacity);return"".concat(c===1?"rgb(":"rgba(").concat(of(this.r),", ").concat(of(this.g),", ").concat(of(this.b)).concat(c===1?")":", ".concat(c,")"))}function Ll(c){return isNaN(c)?1:Math.max(0,Math.min(1,c))}function of(c){return Math.max(0,Math.min(255,Math.round(c)||0))}function Sn(c){return c=of(c),(c<16?"0":"")+c.toString(16)}function Bd(c,a,e,i){return i<=0?c=a=e=NaN:e<=0||e>=1?c=a=NaN:a<=0&&(c=NaN),new Mf(c,a,e,i)}function ih(c){if(c instanceof Mf)return new Mf(c.h,c.s,c.l,c.opacity);if(c instanceof Pc||(c=rh(c)),!c)return new Mf;if(c instanceof Mf)return c;c=c.rgb();var a=c.r/255,e=c.g/255,i=c.b/255,s=Math.min(a,e,i),l=Math.max(a,e,i),f=NaN,d=l-s,v=(l+s)/2;return d?(a===l?f=(e-i)/d+(e<i)*6:e===l?f=(i-a)/d+2:f=(a-e)/d+4,d/=v<.5?l+s:2-l-s,f*=60):d=v>0&&v<1?0:f,new Mf(f,d,v,c.opacity)}function zd(c,a,e,i){return arguments.length===1?ih(c):new Mf(c,a,e,i==null?1:i)}function Mf(c,a,e,i){this.h=+c,this.s=+a,this.l=+e,this.opacity=+i}Lc(Mf,zd,Vc(Pc,{brighter:function(a){return a=a==null?Fc:Math.pow(Fc,a),new Mf(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=a==null?Ru:Math.pow(Ru,a),new Mf(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=this.h%360+(this.h<0)*360,e=isNaN(a)||isNaN(this.s)?0:this.s,i=this.l,s=i+(i<.5?i:1-i)*e,l=2*i-s;return new Al($d(a>=240?a-240:a+120,l,s),$d(a,l,s),$d(a<120?a+240:a-120,l,s),this.opacity)},clamp:function(){return new Mf(sf(this.h),Uf(this.s),Uf(this.l),Ll(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var a=Ll(this.opacity);return"".concat(a===1?"hsl(":"hsla(").concat(sf(this.h),", ").concat(Uf(this.s)*100,"%, ").concat(Uf(this.l)*100,"%").concat(a===1?")":", ".concat(a,")"))}}));function sf(c){return c=(c||0)%360,c<0?c+360:c}function Uf(c){return Math.max(0,Math.min(1,c||0))}function $d(c,a,e){return(c<60?a+(e-a)*c/60:c<180?e:c<240?a+(e-a)*(240-c)/60:a)*255}function Wf(c,a,e,i,s){var l=c*c,f=l*c;return((1-3*c+3*l-f)*a+(4-6*l+3*f)*e+(1+3*c+3*l-3*f)*i+f*s)/6}function bh(c){var a=c.length-1;return function(e){var i=e<=0?e=0:e>=1?(e=1,a-1):Math.floor(e*a),s=c[i],l=c[i+1],f=i>0?c[i-1]:2*s-l,d=i<a-1?c[i+2]:2*l-s;return Wf((e-i/a)*a,f,s,l,d)}}function Wp(c){var a=c.length;return function(e){var i=Math.floor(((e%=1)<0?++e:e)*a),s=c[(i+a-1)%a],l=c[i%a],f=c[(i+1)%a],d=c[(i+2)%a];return Wf((e-i/a)*a,s,l,f,d)}}var xh=function(c){return function(){return c}};function ju(c,a){return function(e){return c+e*a}}function oh(c,a,e){return c=Math.pow(c,e),a=Math.pow(a,e)-c,e=1/e,function(i){return Math.pow(c+i*a,e)}}function bp(c,a){var e=a-c;return e?ju(c,e>180||e<-180?e-360*Math.round(e/360):e):constant(isNaN(c)?a:c)}function cd(c){return(c=+c)==1?Cc:function(a,e){return e-a?oh(a,e,c):xh(isNaN(a)?e:a)}}function Cc(c,a){var e=a-c;return e?ju(c,e):xh(isNaN(c)?a:c)}var Yh=function c(a){var e=cd(a);function i(s,l){var f=e((s=Kl(s)).r,(l=Kl(l)).r),d=e(s.g,l.g),v=e(s.b,l.b),w=Cc(s.opacity,l.opacity);return function(E){return s.r=f(E),s.g=d(E),s.b=v(E),s.opacity=w(E),s+""}}return i.gamma=c,i}(1);function uf(c){return function(a){var e=a.length,i=new Array(e),s=new Array(e),l=new Array(e),f,d;for(f=0;f<e;++f)d=Kl(a[f]),i[f]=d.r||0,s[f]=d.g||0,l[f]=d.b||0;return i=c(i),s=c(s),l=c(l),d.opacity=1,function(v){return d.r=i(v),d.g=s(v),d.b=l(v),d+""}}}var wh=uf(bh),sh=uf(Wp);function Pl(c,a){a||(a=[]);var e=c?Math.min(a.length,c.length):0,i=a.slice(),s;return function(l){for(s=0;s<e;++s)i[s]=c[s]*(1-l)+a[s]*l;return i}}function Nf(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)}function Eh(c,a){return(Nf(a)?Pl:fd)(c,a)}function fd(c,a){var e=a?a.length:0,i=c?Math.min(e,c.length):0,s=new Array(i),l=new Array(e),f;for(f=0;f<i;++f)s[f]=Ch(c[f],a[f]);for(;f<e;++f)l[f]=a[f];return function(d){for(f=0;f<i;++f)l[f]=s[f](d);return l}}function Vp(c,a){var e=new Date;return c=+c,a=+a,function(i){return e.setTime(c*(1-i)+a*i),e}}function hd(c,a){return c=+c,a=+a,function(e){return c*(1-e)+a*e}}function jp(c,a){var e={},i={},s;(c===null||typeof c!="object")&&(c={}),(a===null||typeof a!="object")&&(a={});for(s in a)s in c?e[s]=Ch(c[s],a[s]):i[s]=a[s];return function(l){for(s in e)i[s]=e[s](l);return i}}var Gd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Kh=new RegExp(Gd.source,"g");function Fl(c){return function(){return c}}function uh(c){return function(a){return c(a)+""}}function Sh(c,a){var e=Gd.lastIndex=Kh.lastIndex=0,i,s,l,f=-1,d=[],v=[];for(c=c+"",a=a+"";(i=Gd.exec(c))&&(s=Kh.exec(a));)(l=s.index)>e&&(l=a.slice(e,l),d[f]?d[f]+=l:d[++f]=l),(i=i[0])===(s=s[0])?d[f]?d[f]+=s:d[++f]=s:(d[++f]=null,v.push({i:f,x:hd(i,s)})),e=Kh.lastIndex;return e<a.length&&(l=a.slice(e),d[f]?d[f]+=l:d[++f]=l),d.length<2?v[0]?uh(v[0].x):Fl(a):(a=v.length,function(w){for(var E=0,T;E<a;++E)d[(T=v[E]).i]=T.x(w);return d.join("")})}function Ch(c,a){var e=typeof a,i;return a==null||e==="boolean"?xh(a):(e==="number"?hd:e==="string"?(i=rh(a))?(a=i,Yh):Sh:a instanceof rh?Yh:a instanceof Date?Vp:Nf(a)?Pl:Array.isArray(a)?fd:typeof a.valueOf!="function"&&typeof a.toString!="function"||isNaN(a)?jp:hd)(c,a)}function ng(c){return+c}function Cv(c){return c*c}function vs(c){return c*(2-c)}function Xc(c){return((c*=2)<=1?c*c:--c*(2-c)+1)/2}function eo(c){return c*c*c}function Hp(c){return--c*c*c+1}function _h(c){return((c*=2)<=1?c*c*c:(c-=2)*c*c+2)/2}var dd=3,_g=function c(a){a=+a;function e(i){return Math.pow(i,a)}return e.exponent=c,e}(dd),Ig=function c(a){a=+a;function e(i){return 1-Math.pow(1-i,a)}return e.exponent=c,e}(dd),Ud=function c(a){a=+a;function e(i){return((i*=2)<=1?Math.pow(i,a):2-Math.pow(2-i,a))/2}return e.exponent=c,e}(dd),Xp=Math.PI,_v=Xp/2;function Ih(c){return+c==1?1:1-Math.cos(c*_v)}function Yp(c){return Math.sin(c*_v)}function Kp(c){return(1-Math.cos(Xp*c))/2}function Th(c){return(Math.pow(2,-10*c)-.0009765625)*1.0009775171065494}function Zp(c){return Th(1-+c)}function Ah(c){return 1-Th(c)}function Wd(c){return((c*=2)<=1?Th(1-c):2-Th(c-1))/2}function Vd(c){return 1-Math.sqrt(1-c*c)}function pd(c){return Math.sqrt(1- --c*c)}function xp(c){return((c*=2)<=1?1-Math.sqrt(1-c*c):Math.sqrt(1-(c-=2)*c)+1)/2}var vd=4/11,jd=6/11,kf=8/11,Hd=3/4,wp=9/11,Xd=10/11,Mh=15/16,Zh=21/22,Ep=63/64,Nh=1/vd/vd;function Sp(c){return 1-lh(1-c)}function lh(c){return(c=+c)<vd?Nh*c*c:c<kf?Nh*(c-=jd)*c+Hd:c<Xd?Nh*(c-=wp)*c+Mh:Nh*(c-=Zh)*c+Ep}function Zs(c){return((c*=2)<=1?1-lh(1-c):lh(c-1)+1)/2}var ch=1.70158,Df=function c(a){a=+a;function e(i){return(i=+i)*i*(a*(i-1)+i)}return e.overshoot=c,e}(ch),Iv=function c(a){a=+a;function e(i){return--i*i*((i+1)*a+i)+1}return e.overshoot=c,e}(ch),cu=function c(a){a=+a;function e(i){return((i*=2)<1?i*i*((a+1)*i-a):(i-=2)*i*((a+1)*i+a)+2)/2}return e.overshoot=c,e}(ch),Yd=2*Math.PI,Tv=1,qp=.3,Yc=function c(a,e){var i=Math.asin(1/(a=Math.max(1,a)))*(e/=Yd);function s(l){return a*Th(- --l)*Math.sin((i-l)/e)}return s.amplitude=function(l){return c(l,e*Yd)},s.period=function(l){return c(a,l)},s}(Tv,qp),Qp=function c(a,e){var i=Math.asin(1/(a=Math.max(1,a)))*(e/=Yd);function s(l){return 1-a*Th(l=+l)*Math.sin((l+i)/e)}return s.amplitude=function(l){return c(l,e*Yd)},s.period=function(l){return c(a,l)},s}(Tv,qp),Av=function c(a,e){var i=Math.asin(1/(a=Math.max(1,a)))*(e/=Yd);function s(l){return((l=l*2-1)<0?a*Th(-l)*Math.sin((i-l)/e):2-a*Th(l)*Math.sin((i+l)/e))/2}return s.amplitude=function(l){return c(l,e*Yd)},s.period=function(l){return c(a,l)},s}(Tv,qp),qh={};function Jp(c){return qh[c.toLowerCase()]||Q[c]}function Mv(c,a){qh[c.toLowerCase()]=a}var Nv=function(c){return["fill","stroke","fillStyle","strokeStyle"].includes(c)},Bl=function(c){return/^[r,R,L,l]{1}[\s]*\(/.test(c)},gd=[1,0,0,0,1,0,0,0,1];function Of(c,a,e){var i={},s=a.fromAttrs,l=a.toAttrs;if(!c.destroyed){var f;for(var d in l)if(!(0,_.isEqual)(s[d],l[d]))if(d==="path"){var v=l[d],w=s[d];v.length>w.length?(v=A(l[d]),w=A(s[d]),w=ps(w,v),w=Ec(w,v),a.fromAttrs.path=w,a.toAttrs.path=v):a.pathFormatted||(v=A(l[d]),w=A(s[d]),w=Ec(w,v),a.fromAttrs.path=w,a.toAttrs.path=v,a.pathFormatted=!0),i[d]=[];for(var E=0;E<v.length;E++){for(var T=v[E],G=w[E],U=[],et=0;et<T.length;et++)(0,_.isNumber)(T[et])&&G&&(0,_.isNumber)(G[et])?(f=Ch(G[et],T[et]),U.push(f(e))):U.push(T[et]);i[d].push(U)}}else if(d==="matrix"){var ct=Eh(s[d]||gd,l[d]||gd),Ct=ct(e);i[d]=Ct}else Nv(d)&&Bl(l[d])?i[d]=l[d]:(0,_.isFunction)(l[d])||(f=Ch(s[d],l[d]),i[d]=f(e));c.attr(i)}}function kh(c,a,e){var i=a.startTime,s=a.delay;if(e<i+s||a._paused)return!1;var l,f=a.duration,d=a.easing,v=Jp(d);if(e=e-i-a.delay,a.repeat)l=e%f/f,l=v(l);else if(l=e/f,l<1)l=v(l);else return a.onFrame?c.attr(a.onFrame(1)):c.attr(a.toAttrs),!0;if(a.onFrame){var w=a.onFrame(l);c.attr(w)}else Of(c,a,l);return!1}var kv=function(){function c(a){this.animators=[],this.current=0,this.timer=null,this.canvas=a}return c.prototype.initTimer=function(){var a=this,e=!1,i,s,l;this.timer=pn(function(f){if(a.current=f,a.animators.length>0){for(var d=a.animators.length-1;d>=0;d--){if(i=a.animators[d],i.destroyed){a.removeAnimator(d);continue}if(!i.isAnimatePaused()){s=i.get("animations");for(var v=s.length-1;v>=0;v--)l=s[v],e=kh(i,l,f),e&&(s.splice(v,1),e=!1,l.callback&&l.callback())}s.length===0&&a.removeAnimator(d)}var w=a.canvas.get("autoDraw");w||a.canvas.draw()}})},c.prototype.addAnimator=function(a){this.animators.push(a)},c.prototype.removeAnimator=function(a){this.animators.splice(a,1)},c.prototype.isAnimating=function(){return!!this.animators.length},c.prototype.stop=function(){this.timer&&this.timer.stop()},c.prototype.stopAllAnimations=function(a){a===void 0&&(a=!0),this.animators.forEach(function(e){e.stopAnimate(a)}),this.animators=[],this.canvas.draw()},c.prototype.getTime=function(){return this.current},c}(),md=kv,Kd=40,tv=0,Bc=":",Vf=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function zl(c,a){for(var e in c)if(c.hasOwnProperty(e)&&e.indexOf(Bc+a)>=0)return!0;return!1}function vc(c,a,e){e.name=a,e.target=c,e.currentTarget=c,e.delegateTarget=c,c.emit(a,e)}function yd(c,a,e){if(e.bubbles){var i=void 0,s=!1;if(a==="mouseenter"?(i=e.fromShape,s=!0):a==="mouseleave"&&(s=!0,i=e.toShape),c.isCanvas()&&s)return;if(i&&$p(c,i)){e.bubbles=!1;return}e.name=a,e.currentTarget=c,e.delegateTarget=c,c.emit(a,e)}}var Dv=function(){function c(a){var e=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(i){var s=i.type;e._triggerEvent(s,i)},this._onDocumentMove=function(i){var s=e.canvas,l=s.get("el");if(l!==i.target&&(e.dragging||e.currentShape)){var f=e._getPointInfo(i);e.dragging&&e._emitEvent("drag",i,f,e.draggingShape)}},this._onDocumentMouseUp=function(i){var s=e.canvas,l=s.get("el");if(l!==i.target&&e.dragging){var f=e._getPointInfo(i);e.draggingShape&&e._emitEvent("drop",i,f,null),e._emitEvent("dragend",i,f,e.draggingShape),e._afterDrag(e.draggingShape,f,i)}},this.canvas=a.canvas}return c.prototype.init=function(){this._bindEvents()},c.prototype._bindEvents=function(){var a=this,e=this.canvas.get("el");(0,_.each)(Vf,function(i){e.addEventListener(i,a._eventCallback)}),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},c.prototype._clearEvents=function(){var a=this,e=this.canvas.get("el");(0,_.each)(Vf,function(i){e.removeEventListener(i,a._eventCallback)}),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},c.prototype._getEventObj=function(a,e,i,s,l,f){var d=new Uc(a,e);return d.fromShape=l,d.toShape=f,d.x=i.x,d.y=i.y,d.clientX=i.clientX,d.clientY=i.clientY,d.propagationPath.push(s),d},c.prototype._getShape=function(a,e){return this.canvas.getShape(a.x,a.y,e)},c.prototype._getPointInfo=function(a){var e=this.canvas,i=e.getClientByEvent(a),s=e.getPointByEvent(a);return{x:s.x,y:s.y,clientX:i.x,clientY:i.y}},c.prototype._triggerEvent=function(a,e){var i=this._getPointInfo(e),s=this._getShape(i,e),l=this["_on"+a],f=!1;if(l)l.call(this,i,s,e);else{var d=this.currentShape;a==="mouseenter"||a==="dragenter"||a==="mouseover"?(this._emitEvent(a,e,i,null,null,s),s&&this._emitEvent(a,e,i,s,null,s),a==="mouseenter"&&this.draggingShape&&this._emitEvent("dragenter",e,i,null)):a==="mouseleave"||a==="dragleave"||a==="mouseout"?(f=!0,d&&this._emitEvent(a,e,i,d,d,null),this._emitEvent(a,e,i,null,d,null),a==="mouseleave"&&this.draggingShape&&this._emitEvent("dragleave",e,i,null)):this._emitEvent(a,e,i,s,null,null)}if(f||(this.currentShape=s),s&&!s.get("destroyed")){var v=this.canvas,w=v.get("el");w.style.cursor=s.attr("cursor")||v.get("cursor")}},c.prototype._onmousedown=function(a,e,i){i.button===tv&&(this.mousedownShape=e,this.mousedownPoint=a,this.mousedownTimeStamp=i.timeStamp),this._emitEvent("mousedown",i,a,e,null,null)},c.prototype._emitMouseoverEvents=function(a,e,i,s){var l=this.canvas.get("el");i!==s&&(i&&(this._emitEvent("mouseout",a,e,i,i,s),this._emitEvent("mouseleave",a,e,i,i,s),(!s||s.get("destroyed"))&&(l.style.cursor=this.canvas.get("cursor"))),s&&(this._emitEvent("mouseover",a,e,s,i,s),this._emitEvent("mouseenter",a,e,s,i,s)))},c.prototype._emitDragoverEvents=function(a,e,i,s,l){s?(s!==i&&(i&&this._emitEvent("dragleave",a,e,i,i,s),this._emitEvent("dragenter",a,e,s,i,s)),l||this._emitEvent("dragover",a,e,s)):i&&this._emitEvent("dragleave",a,e,i,i,s),l&&this._emitEvent("dragover",a,e,s)},c.prototype._afterDrag=function(a,e,i){a&&(a.set("capture",!0),this.draggingShape=null),this.dragging=!1;var s=this._getShape(e,i);s!==a&&this._emitMouseoverEvents(i,e,a,s),this.currentShape=s},c.prototype._onmouseup=function(a,e,i){if(i.button===tv){var s=this.draggingShape;this.dragging?(s&&this._emitEvent("drop",i,a,e),this._emitEvent("dragend",i,a,s),this._afterDrag(s,a,i)):(this._emitEvent("mouseup",i,a,e),e===this.mousedownShape&&this._emitEvent("click",i,a,e),this.mousedownShape=null,this.mousedownPoint=null)}},c.prototype._ondragover=function(a,e,i){i.preventDefault();var s=this.currentShape;this._emitDragoverEvents(i,a,s,e,!0)},c.prototype._onmousemove=function(a,e,i){var s=this.canvas,l=this.currentShape,f=this.draggingShape;if(this.dragging)f&&this._emitDragoverEvents(i,a,l,e,!1),this._emitEvent("drag",i,a,f);else{var d=this.mousedownPoint;if(d){var v=this.mousedownShape,w=i.timeStamp,E=w-this.mousedownTimeStamp,T=d.clientX-a.clientX,G=d.clientY-a.clientY,U=T*T+G*G;E>120||U>Kd?v&&v.get("draggable")?(f=this.mousedownShape,f.set("capture",!1),this.draggingShape=f,this.dragging=!0,this._emitEvent("dragstart",i,a,f),this.mousedownShape=null,this.mousedownPoint=null):!v&&s.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",i,a,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(i,a,l,e),this._emitEvent("mousemove",i,a,e)):(this._emitMouseoverEvents(i,a,l,e),this._emitEvent("mousemove",i,a,e))}else this._emitMouseoverEvents(i,a,l,e),this._emitEvent("mousemove",i,a,e)}},c.prototype._emitEvent=function(a,e,i,s,l,f){var d=this._getEventObj(a,e,i,s,l,f);if(s){d.shape=s,vc(s,a,d);for(var v=s.getParent();v;)v.emitDelegation(a,d),d.propagationStopped||yd(v,a,d),d.propagationPath.push(v),v=v.getParent()}else{var w=this.canvas;vc(w,a,d)}},c.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},c}(),ev=Dv,Zd="px",nv=nf(),Dh=nv&&nv.name==="firefox",lf=function(c){(0,O.__extends)(a,c);function a(e){var i=c.call(this,e)||this;return i.initContainer(),i.initDom(),i.initEvents(),i.initTimeline(),i}return a.prototype.getDefaultCfg=function(){var e=c.prototype.getDefaultCfg.call(this);return e.cursor="default",e.supportCSSTransform=!1,e},a.prototype.initContainer=function(){var e=this.get("container");(0,_.isString)(e)&&(e=document.getElementById(e),this.set("container",e))},a.prototype.initDom=function(){var e=this.createDom();this.set("el",e);var i=this.get("container");i.appendChild(e),this.setDOMSize(this.get("width"),this.get("height"))},a.prototype.initEvents=function(){var e=new ev({canvas:this});e.init(),this.set("eventController",e)},a.prototype.initTimeline=function(){var e=new md(this);this.set("timeline",e)},a.prototype.setDOMSize=function(e,i){var s=this.get("el");pp&&(s.style.width=e+Zd,s.style.height=i+Zd)},a.prototype.changeSize=function(e,i){this.setDOMSize(e,i),this.set("width",e),this.set("height",i),this.onCanvasChange("changeSize")},a.prototype.getRenderer=function(){return this.get("renderer")},a.prototype.getCursor=function(){return this.get("cursor")},a.prototype.setCursor=function(e){this.set("cursor",e);var i=this.get("el");pp&&i&&(i.style.cursor=e)},a.prototype.getPointByEvent=function(e){var i=this.get("supportCSSTransform");if(i){if(Dh&&!(0,_.isNil)(e.layerX)&&e.layerX!==e.offsetX)return{x:e.layerX,y:e.layerY};if(!(0,_.isNil)(e.offsetX))return{x:e.offsetX,y:e.offsetY}}var s=this.getClientByEvent(e),l=s.x,f=s.y;return this.getPointByClient(l,f)},a.prototype.getClientByEvent=function(e){var i=e;return e.touches&&(e.type==="touchend"?i=e.changedTouches[0]:i=e.touches[0]),{x:i.clientX,y:i.clientY}},a.prototype.getPointByClient=function(e,i){var s=this.get("el"),l=s.getBoundingClientRect();return{x:e-l.left,y:i-l.top}},a.prototype.getClientByPoint=function(e,i){var s=this.get("el"),l=s.getBoundingClientRect();return{x:e+l.left,y:i+l.top}},a.prototype.draw=function(){},a.prototype.removeDom=function(){var e=this.get("el");e.parentNode.removeChild(e)},a.prototype.clearEvents=function(){var e=this.get("eventController");e.destroy()},a.prototype.isCanvas=function(){return!0},a.prototype.getParent=function(){return null},a.prototype.destroy=function(){var e=this.get("timeline");this.get("destroyed")||(this.clear(),e&&e.stop(),this.clearEvents(),this.removeDom(),c.prototype.destroy.call(this))},a}(Is),ci=lf,rv=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.isGroup=function(){return!0},a.prototype.isEntityGroup=function(){return!1},a.prototype.clone=function(){for(var e=c.prototype.clone.call(this),i=this.getChildren(),s=0;s<i.length;s++){var l=i[s];e.add(l.clone())}return e},a}(Is),av=rv,rg=function(c){(0,O.__extends)(a,c);function a(e){return c.call(this,e)||this}return a.prototype._isInBBox=function(e,i){var s=this.getBBox();return s.minX<=e&&s.maxX>=e&&s.minY<=i&&s.maxY>=i},a.prototype.afterAttrsChange=function(e){c.prototype.afterAttrsChange.call(this,e),this.clearCacheBBox()},a.prototype.getBBox=function(){var e=this.cfg.bbox;return e||(e=this.calculateBBox(),this.set("bbox",e)),e},a.prototype.getCanvasBBox=function(){var e=this.cfg.canvasBBox;return e||(e=this.calculateCanvasBBox(),this.set("canvasBBox",e)),e},a.prototype.applyMatrix=function(e){c.prototype.applyMatrix.call(this,e),this.set("canvasBBox",null)},a.prototype.calculateCanvasBBox=function(){var e=this.getBBox(),i=this.getTotalMatrix(),s=e.minX,l=e.minY,f=e.maxX,d=e.maxY;if(i){var v=ne(i,[e.minX,e.minY]),w=ne(i,[e.maxX,e.minY]),E=ne(i,[e.minX,e.maxY]),T=ne(i,[e.maxX,e.maxY]);s=Math.min(v[0],w[0],E[0],T[0]),f=Math.max(v[0],w[0],E[0],T[0]),l=Math.min(v[1],w[1],E[1],T[1]),d=Math.max(v[1],w[1],E[1],T[1])}var G=this.attrs;if(G.shadowColor){var U=G.shadowBlur,et=U===void 0?0:U,ct=G.shadowOffsetX,Ct=ct===void 0?0:ct,Mt=G.shadowOffsetY,Dt=Mt===void 0?0:Mt,zt=s-et+Ct,Qt=f+et+Ct,Ie=l-et+Dt,je=d+et+Dt;s=Math.min(s,zt),f=Math.max(f,Qt),l=Math.min(l,Ie),d=Math.max(d,je)}return{x:s,y:l,minX:s,minY:l,maxX:f,maxY:d,width:f-s,height:d-l}},a.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},a.prototype.isClipShape=function(){return this.get("isClipShape")},a.prototype.isInShape=function(e,i){return!1},a.prototype.isOnlyHitBox=function(){return!1},a.prototype.isHit=function(e,i){var s=this.get("startArrowShape"),l=this.get("endArrowShape"),f=[e,i,1];f=this.invertFromMatrix(f);var d=f[0],v=f[1],w=this._isInBBox(d,v);return this.isOnlyHitBox()?w:!!(w&&!this.isClipped(d,v)&&(this.isInShape(d,v)||s&&s.isHit(d,v)||l&&l.isHit(d,v)))},a}(rs),qd=rg,Qh=new Map;function jf(c,a){Qh.set(c,a)}function ag(c){return Qh.get(c)}function Ov(c){var a=c.attr(),e=a.x,i=a.y,s=a.width,l=a.height;return{x:e,y:i,width:s,height:l}}function Cp(c){var a=c.attr(),e=a.x,i=a.y,s=a.r;return{x:e-s,y:i-s,width:s*2,height:s*2}}function Zl(c,a,e,i){var s=c-e,l=a-i;return Math.sqrt(s*s+l*l)}function ce(c,a){return Math.abs(c-a)<.001}function vn(c,a){var e=(0,_.min)(c),i=(0,_.min)(a),s=(0,_.max)(c),l=(0,_.max)(a);return{x:e,y:i,width:s-e,height:l-i}}function er(c,a,e,i){return{minX:(0,_.min)([c,e]),maxX:(0,_.max)([c,e]),minY:(0,_.min)([a,i]),maxY:(0,_.max)([a,i])}}function ia(c){return(c+Math.PI*2)%(Math.PI*2)}var da={box:function(c,a,e,i){return vn([c,e],[a,i])},length:function(c,a,e,i){return Zl(c,a,e,i)},pointAt:function(c,a,e,i,s){return{x:(1-s)*c+s*e,y:(1-s)*a+s*i}},pointDistance:function(c,a,e,i,s,l){var f=(e-c)*(s-c)+(i-a)*(l-a);if(f<0)return Zl(c,a,s,l);var d=(e-c)*(e-c)+(i-a)*(i-a);return f>d?Zl(e,i,s,l):this.pointToLine(c,a,e,i,s,l)},pointToLine:function(c,a,e,i,s,l){var f=[e-c,i-a];if(ka.exactEquals(f,[0,0]))return Math.sqrt((s-c)*(s-c)+(l-a)*(l-a));var d=[-f[1],f[0]];ka.normalize(d,d);var v=[s-c,l-a];return Math.abs(ka.dot(v,d))},tangentAngle:function(c,a,e,i){return Math.atan2(i-a,e-c)}},aa=1e-4;function na(c,a,e,i,s,l){var f,d=Infinity,v=[e,i],w=20;l&&l>200&&(w=l/10);for(var E=1/w,T=E/10,G=0;G<=w;G++){var U=G*E,et=[s.apply(null,c.concat([U])),s.apply(null,a.concat([U]))],ct=Zl(v[0],v[1],et[0],et[1]);ct<d&&(f=U,d=ct)}if(f===0)return{x:c[0],y:a[0]};if(f===1){var Ct=c.length;return{x:c[Ct-1],y:a[Ct-1]}}d=Infinity;for(var G=0;G<32&&!(T<aa);G++){var Mt=f-T,Dt=f+T,et=[s.apply(null,c.concat([Mt])),s.apply(null,a.concat([Mt]))],ct=Zl(v[0],v[1],et[0],et[1]);if(Mt>=0&&ct<d)f=Mt,d=ct;else{var zt=[s.apply(null,c.concat([Dt])),s.apply(null,a.concat([Dt]))],Qt=Zl(v[0],v[1],zt[0],zt[1]);Dt<=1&&Qt<d?(f=Dt,d=Qt):T*=.5}}return{x:s.apply(null,c.concat([f])),y:s.apply(null,a.concat([f]))}}function Xa(c,a){for(var e=0,i=c.length,s=0;s<i;s++){var l=c[s],f=a[s],d=c[(s+1)%i],v=a[(s+1)%i];e+=Zl(l,f,d,v)}return e/2}function Oa(c,a,e,i){var s=1-i;return s*s*c+2*i*s*a+i*i*e}function Qa(c,a,e){var i=c+e-2*a;if(ce(i,0))return[.5];var s=(c-a)/i;return s<=1&&s>=0?[s]:[]}function Ka(c,a,e,i){return 2*(1-i)*(a-c)+2*i*(e-a)}function zn(c,a,e,i,s,l,f){var d=Oa(c,e,s,f),v=Oa(a,i,l,f),w=da.pointAt(c,a,e,i,f),E=da.pointAt(e,i,s,l,f);return[[c,a,w.x,w.y,d,v],[d,v,E.x,E.y,s,l]]}function N(c,a,e,i,s,l,f){if(f===0)return(Zl(c,a,e,i)+Zl(e,i,s,l)+Zl(c,a,s,l))/2;var d=zn(c,a,e,i,s,l,.5),v=d[0],w=d[1];return v.push(f-1),w.push(f-1),N.apply(null,v)+N.apply(null,w)}var q={box:function(c,a,e,i,s,l){var f=Qa(c,e,s)[0],d=Qa(a,i,l)[0],v=[c,s],w=[a,l];return f!==void 0&&v.push(Oa(c,e,s,f)),d!==void 0&&w.push(Oa(a,i,l,d)),vn(v,w)},length:function(c,a,e,i,s,l){return N(c,a,e,i,s,l,3)},nearestPoint:function(c,a,e,i,s,l,f,d){return na([c,e,s],[a,i,l],f,d,Oa)},pointDistance:function(c,a,e,i,s,l,f,d){var v=this.nearestPoint(c,a,e,i,s,l,f,d);return Zl(v.x,v.y,f,d)},interpolationAt:Oa,pointAt:function(c,a,e,i,s,l,f){return{x:Oa(c,e,s,f),y:Oa(a,i,l,f)}},divide:function(c,a,e,i,s,l,f){return zn(c,a,e,i,s,l,f)},tangentAngle:function(c,a,e,i,s,l,f){var d=Ka(c,e,s,f),v=Ka(a,i,l,f),w=Math.atan2(v,d);return ia(w)}};function ht(c,a,e,i,s){var l=1-s;return l*l*l*c+3*a*s*l*l+3*e*s*s*l+i*s*s*s}function It(c,a,e,i,s){var l=1-s;return 3*(l*l*(a-c)+2*l*s*(e-a)+s*s*(i-e))}function Ft(c,a,e,i){var s=-3*c+9*a-9*e+3*i,l=6*c-12*a+6*e,f=3*a-3*c,d=[],v,w,E;if(ce(s,0))ce(l,0)||(v=-f/l,v>=0&&v<=1&&d.push(v));else{var T=l*l-4*s*f;ce(T,0)?d.push(-l/(2*s)):T>0&&(E=Math.sqrt(T),v=(-l+E)/(2*s),w=(-l-E)/(2*s),v>=0&&v<=1&&d.push(v),w>=0&&w<=1&&d.push(w))}return d}function Xt(c,a,e,i,s,l,f,d,v){var w=ht(c,e,s,f,v),E=ht(a,i,l,d,v),T=da.pointAt(c,a,e,i,v),G=da.pointAt(e,i,s,l,v),U=da.pointAt(s,l,f,d,v),et=da.pointAt(T.x,T.y,G.x,G.y,v),ct=da.pointAt(G.x,G.y,U.x,U.y,v);return[[c,a,T.x,T.y,et.x,et.y,w,E],[w,E,ct.x,ct.y,U.x,U.y,f,d]]}function oe(c,a,e,i,s,l,f,d,v){if(v===0)return Xa([c,e,s,f],[a,i,l,d]);var w=Xt(c,a,e,i,s,l,f,d,.5),E=w[0],T=w[1];return E.push(v-1),T.push(v-1),oe.apply(null,E)+oe.apply(null,T)}var he={extrema:Ft,box:function(c,a,e,i,s,l,f,d){for(var v=[c,f],w=[a,d],E=Ft(c,e,s,f),T=Ft(a,i,l,d),G=0;G<E.length;G++)v.push(ht(c,e,s,f,E[G]));for(var G=0;G<T.length;G++)w.push(ht(a,i,l,d,T[G]));return vn(v,w)},length:function(c,a,e,i,s,l,f,d){return oe(c,a,e,i,s,l,f,d,3)},nearestPoint:function(c,a,e,i,s,l,f,d,v,w,E){return na([c,e,s,f],[a,i,l,d],v,w,ht,E)},pointDistance:function(c,a,e,i,s,l,f,d,v,w,E){var T=this.nearestPoint(c,a,e,i,s,l,f,d,v,w,E);return Zl(T.x,T.y,v,w)},interpolationAt:ht,pointAt:function(c,a,e,i,s,l,f,d,v){return{x:ht(c,e,s,f,v),y:ht(a,i,l,d,v)}},divide:function(c,a,e,i,s,l,f,d,v){return Xt(c,a,e,i,s,l,f,d,v)},tangentAngle:function(c,a,e,i,s,l,f,d,v){var w=It(c,e,s,f,v),E=It(a,i,l,d,v);return ia(Math.atan2(E,w))}};function Te(c,a){var e=Math.abs(c);return a>0?e:e*-1}var Ye={box:function(c,a,e,i){return{x:c-e,y:a-i,width:e*2,height:i*2}},length:function(c,a,e,i){return Math.PI*(3*(e+i)-Math.sqrt((3*e+i)*(e+3*i)))},nearestPoint:function(c,a,e,i,s,l){var f=e,d=i;if(f===0||d===0)return{x:c,y:a};for(var v=s-c,w=l-a,E=Math.abs(v),T=Math.abs(w),G=f*f,U=d*d,et=Math.PI/4,ct,Ct,Mt=0;Mt<4;Mt++){ct=f*Math.cos(et),Ct=d*Math.sin(et);var Dt=(G-U)*Math.pow(Math.cos(et),3)/f,zt=(U-G)*Math.pow(Math.sin(et),3)/d,Qt=ct-Dt,Ie=Ct-zt,je=E-Dt,ze=T-zt,mn=Math.hypot(Ie,Qt),$n=Math.hypot(ze,je),Tn=mn*Math.asin((Qt*ze-Ie*je)/(mn*$n)),or=Tn/Math.sqrt(G+U-ct*ct-Ct*Ct);et+=or,et=Math.min(Math.PI/2,Math.max(0,et))}return{x:c+Te(ct,v),y:a+Te(Ct,w)}},pointDistance:function(c,a,e,i,s,l){var f=this.nearestPoint(c,a,e,i,s,l);return Zl(f.x,f.y,s,l)},pointAt:function(c,a,e,i,s){var l=2*Math.PI*s;return{x:c+e*Math.cos(l),y:a+i*Math.sin(l)}},tangentAngle:function(c,a,e,i,s){var l=2*Math.PI*s,f=Math.atan2(i*Math.cos(l),-e*Math.sin(l));return ia(f)}};function gn(c,a,e,i,s,l,f,d){return-1*e*Math.cos(s)*Math.sin(d)-i*Math.sin(s)*Math.cos(d)}function cn(c,a,e,i,s,l,f,d){return-1*e*Math.sin(s)*Math.sin(d)+i*Math.cos(s)*Math.cos(d)}function Vn(c,a,e){return Math.atan(-a/c*Math.tan(e))}function An(c,a,e){return Math.atan(a/(c*Math.tan(e)))}function ma(c,a,e,i,s,l){return e*Math.cos(s)*Math.cos(l)-i*Math.sin(s)*Math.sin(l)+c}function Or(c,a,e,i,s,l){return e*Math.sin(s)*Math.cos(l)+i*Math.cos(s)*Math.sin(l)+a}function Fr(c,a,e,i){var s=Math.atan2(i*c,e*a);return(s+Math.PI*2)%(Math.PI*2)}function rr(c,a,e){return{x:c*Math.cos(e),y:a*Math.sin(e)}}function Za(c,a,e){var i=Math.cos(e),s=Math.sin(e);return[c*i-a*s,c*s+a*i]}var Xn={box:function(c,a,e,i,s,l,f){for(var d=Vn(e,i,s),v=Infinity,w=-Infinity,E=[l,f],T=-Math.PI*2;T<=Math.PI*2;T+=Math.PI){var G=d+T;l<f?l<G&&G<f&&E.push(G):f<G&&G<l&&E.push(G)}for(var T=0;T<E.length;T++){var U=ma(c,a,e,i,s,E[T]);U<v&&(v=U),U>w&&(w=U)}for(var et=An(e,i,s),ct=Infinity,Ct=-Infinity,Mt=[l,f],T=-Math.PI*2;T<=Math.PI*2;T+=Math.PI){var Dt=et+T;l<f?l<Dt&&Dt<f&&Mt.push(Dt):f<Dt&&Dt<l&&Mt.push(Dt)}for(var T=0;T<Mt.length;T++){var zt=Or(c,a,e,i,s,Mt[T]);zt<ct&&(ct=zt),zt>Ct&&(Ct=zt)}return{x:v,y:ct,width:w-v,height:Ct-ct}},length:function(c,a,e,i,s,l,f){},nearestPoint:function(c,a,e,i,s,l,f,d,v){var w=Za(d-c,v-a,-s),E=w[0],T=w[1],G=Ye.nearestPoint(0,0,e,i,E,T),U=Fr(e,i,G.x,G.y);U<l?G=rr(e,i,l):U>f&&(G=rr(e,i,f));var et=Za(G.x,G.y,s);return{x:et[0]+c,y:et[1]+a}},pointDistance:function(c,a,e,i,s,l,f,d,v){var w=this.nearestPoint(c,a,e,i,d,v);return Zl(w.x,w.y,d,v)},pointAt:function(c,a,e,i,s,l,f,d){var v=(f-l)*d+l;return{x:ma(c,a,e,i,s,v),y:Or(c,a,e,i,s,v)}},tangentAngle:function(c,a,e,i,s,l,f,d){var v=(f-l)*d+l,w=gn(c,a,e,i,s,l,f,v),E=cn(c,a,e,i,s,l,f,v);return ia(Math.atan2(E,w))}};function ii(c){for(var a=0,e=[],i=0;i<c.length-1;i++){var s=c[i],l=c[i+1],f=Zl(s[0],s[1],l[0],l[1]),d={from:s,to:l,length:f};e.push(d),a+=f}return{segments:e,totalLength:a}}function Ti(c){if(c.length<2)return 0;for(var a=0,e=0;e<c.length-1;e++){var i=c[e],s=c[e+1];a+=Zl(i[0],i[1],s[0],s[1])}return a}function Ki(c,a){if(a>1||a<0||c.length<2)return null;var e=ii(c),i=e.segments,s=e.totalLength;if(s===0)return{x:c[0][0],y:c[0][1]};for(var l=0,f=null,d=0;d<i.length;d++){var v=i[d],w=v.from,E=v.to,T=v.length/s;if(a>=l&&a<=l+T){var G=(a-l)/T;f=da.pointAt(w[0],w[1],E[0],E[1],G);break}l+=T}return f}function Ai(c,a){if(a>1||a<0||c.length<2)return 0;for(var e=ii(c),i=e.segments,s=e.totalLength,l=0,f=0,d=0;d<i.length;d++){var v=i[d],w=v.from,E=v.to,T=v.length/s;if(a>=l&&a<=l+T){f=Math.atan2(E[1]-w[1],E[0]-w[0]);break}l+=T}return f}function Yo(c,a,e){for(var i=Infinity,s=0;s<c.length-1;s++){var l=c[s],f=c[s+1],d=da.pointDistance(l[0],l[1],f[0],f[1],a,e);d<i&&(i=d)}return i}var bi={box:function(c){for(var a=[],e=[],i=0;i<c.length;i++){var s=c[i];a.push(s[0]),e.push(s[1])}return vn(a,e)},length:function(c){return Ti(c)},pointAt:function(c,a){return Ki(c,a)},pointDistance:function(c,a,e){return Yo(c,a,e)},tangentAngle:function(c,a){return Ai(c,a)}};function Lu(c){var a=c.slice(0);return c.length&&a.push(c[0]),a}var as={box:function(c){return bi.box(c)},length:function(c){return Ti(Lu(c))},pointAt:function(c,a){return Ki(Lu(c),a)},pointDistance:function(c,a,e){return Yo(Lu(c),a,e)},tangentAngle:function(c,a){return Ai(Lu(c),a)}};function gl(c,a){return!c||!a?c||a:{minX:Math.min(c.minX,a.minX),minY:Math.min(c.minY,a.minY),maxX:Math.max(c.maxX,a.maxX),maxY:Math.max(c.maxY,a.maxY)}}function fu(c,a){var e=c.get("startArrowShape"),i=c.get("endArrowShape"),s=null,l=null;return e&&(s=e.getCanvasBBox(),a=gl(a,s)),i&&(l=i.getCanvasBBox(),a=gl(a,l)),a}function Rs(c){for(var a=c.attr(),e=a.points,i=[],s=[],l=0;l<e.length;l++){var f=e[l];i.push(f[0]),s.push(f[1])}var d=vn(i,s),v=d.x,w=d.y,E=d.width,T=d.height,G={minX:v,minY:w,maxX:v+E,maxY:w+T};return G=fu(c,G),{x:G.minX,y:G.minY,width:G.maxX-G.minX,height:G.maxY-G.minY}}function Eu(c){for(var a=c.attr(),e=a.points,i=[],s=[],l=0;l<e.length;l++){var f=e[l];i.push(f[0]),s.push(f[1])}return vn(i,s)}var gu=null;function zi(){if(!gu){var c=document.createElement("canvas");c.width=1,c.height=1,gu=c.getContext("2d")}return gu}function ul(c,a,e){var i=1;if((0,_.isString)(c)&&(i=c.split(`
`).length),i>1){var s=ml(a,e);return a*i+s*(i-1)}return a}function ml(c,a){return a?a-c:c*.14}function Jo(c,a){var e=zi(),i=0;if((0,_.isNil)(c)||c==="")return i;if(e.save(),e.font=a,(0,_.isString)(c)&&c.includes(`
`)){var s=c.split(`
`);(0,_.each)(s,function(l){var f=e.measureText(l).width;i<f&&(i=f)})}else i=e.measureText(c).width;return e.restore(),i}function Vl(c){var a=c.fontSize,e=c.fontFamily,i=c.fontWeight,s=c.fontStyle,l=c.fontVariant;return[s,l,i,a+"px",e].join(" ").trim()}function Su(c){var a=c.attr(),e=a.x,i=a.y,s=a.text,l=a.fontSize,f=a.lineHeight,d=a.font;d||(d=Vl(a));var v=Jo(s,d),w;if(!v)w={x:e,y:i,width:0,height:0};else{var E=a.textAlign,T=a.textBaseline,G=ul(s,l,f),U={x:e,y:i-G};E&&(E==="end"||E==="right"?U.x-=v:E==="center"&&(U.x-=v/2)),T&&(T==="top"?U.y+=G:T==="middle"&&(U.y+=G/2)),w={x:U.x,y:U.y,width:v,height:G}}return w}var co=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig,Ls=/[^\s\,]+/ig;function pi(c){var a=c||[];if((0,_.isArray)(a))return a;if((0,_.isString)(a))return a=a.match(co),(0,_.each)(a,function(e,i){if(e=e.match(Ls),e[0].length>1){var s=e[0].charAt(0);e.splice(1,0,e[0].substr(1)),e[0]=s}(0,_.each)(e,function(l,f){isNaN(l)||(e[f]=+l)}),a[i]=e}),a}var ll=pi;function Hf(c,a,e,i){var s=[],l=!!i,f,d,v,w,E,T,G;if(l){v=i[0],w=i[1];for(var U=0,et=c.length;U<et;U+=1){var ct=c[U];v=ka.min([0,0],v,ct),w=ka.max([0,0],w,ct)}}for(var U=0,Ct=c.length;U<Ct;U+=1){var ct=c[U];if(U===0&&!e)G=ct;else if(U===Ct-1&&!e)T=ct,s.push(G),s.push(T);else{var Mt=[U?U-1:Ct-1,U-1][e?0:1];f=c[Mt],d=c[e?(U+1)%Ct:U+1];var Dt=[0,0];Dt=ka.sub(Dt,d,f),Dt=ka.scale(Dt,Dt,a);var zt=ka.distance(ct,f),Qt=ka.distance(ct,d),Ie=zt+Qt;Ie!==0&&(zt/=Ie,Qt/=Ie);var je=ka.scale([0,0],Dt,-zt),ze=ka.scale([0,0],Dt,Qt);T=ka.add([0,0],ct,je),E=ka.add([0,0],ct,ze),E=ka.min([0,0],E,ka.max([0,0],d,ct)),E=ka.max([0,0],E,ka.min([0,0],d,ct)),je=ka.sub([0,0],E,ct),je=ka.scale([0,0],je,-zt/Qt),T=ka.add([0,0],ct,je),T=ka.min([0,0],T,ka.max([0,0],f,ct)),T=ka.max([0,0],T,ka.min([0,0],f,ct)),ze=ka.sub([0,0],ct,T),ze=ka.scale([0,0],ze,Qt/zt),E=ka.add([0,0],ct,ze),l&&(T=ka.max([0,0],T,v),T=ka.min([0,0],T,w),E=ka.max([0,0],E,v),E=ka.min([0,0],E,w)),s.push(G),s.push(T),G=E}}return e&&s.push(s.shift()),s}function bl(c,a,e){a===void 0&&(a=!1),e===void 0&&(e=[[0,0],[1,1]]);for(var i=!!a,s=[],l=0,f=c.length;l<f;l+=2)s.push([c[l],c[l+1]]);for(var d=Hf(s,.4,i,e),v=s.length,w=[],E,T,G,l=0;l<v-1;l+=1)E=d[l*2],T=d[l*2+1],G=s[l+1],w.push(["C",E[0],E[1],T[0],T[1],G[0],G[1]]);return i&&(E=d[v],T=d[v+1],G=s[0],w.push(["C",E[0],E[1],T[0],T[1],G[0],G[1]])),w}var Wn=bl;function Jr(c,a,e){var i=null,s=e;return a<s&&(s=a,i="add"),c<s&&(s=c,i="del"),{type:i,min:s}}var Nr=function(c,a){var e=c.length,i=a.length,s,l,f=0;if(e===0||i===0)return null;for(var d=[],v=0;v<=e;v++)d[v]=[],d[v][0]={min:v};for(var w=0;w<=i;w++)d[0][w]={min:w};for(var v=1;v<=e;v++){s=c[v-1];for(var w=1;w<=i;w++){l=a[w-1],isEqual(s,l)?f=0:f=1;var E=d[v-1][w].min+1,T=d[v][w-1].min+1,G=d[v-1][w-1].min+f;d[v][w]=Jr(E,T,G)}}return d};function ji(c,a){var e=Nr(c,a),i=c.length,s=a.length,l=[],f=1,d=1;if(e[i][s]!==i){for(var v=1;v<=i;v++){var w=e[v][v].min;d=v;for(var E=f;E<=s;E++)e[v][E].min<w&&(w=e[v][E].min,d=E);f=d,e[v][f].type&&l.push({index:v-1,type:e[v][f].type})}for(var v=l.length-1;v>=0;v--)f=l[v].index,l[v].type==="add"?c.splice(f,0,[].concat(c[f])):c.splice(f,1)}if(i=c.length,i<s)for(var v=0;v<s-i;v++)c[i-1][0]==="z"||c[i-1][0]==="Z"?c.splice(i-2,0,c[i-2]):c.push(c[i-1]);return c}var Po=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,Nn=new RegExp("([a-z])["+Po+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Po+"]*,?["+Po+"]*)+)","ig"),ln=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Po+"]*,?["+Po+"]*","ig");function fr(c){if(!c)return null;if((0,_.isArray)(c))return c;var a={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},e=[];return String(c).replace(Nn,function(i,s,l){var f=[],d=s.toLowerCase();if(l.replace(ln,function(v,w){w&&f.push(+w)}),d==="m"&&f.length>2&&(e.push([s].concat(f.splice(0,2))),d="l",s=s==="m"?"l":"L"),d==="o"&&f.length===1&&e.push([s,f[0]]),d==="r")e.push([s].concat(f));else for(;f.length>=a[d]&&(e.push([s].concat(f.splice(0,a[d]))),!!a[d]););return""}),e}var Pr=/[a-z]/;function Vr(c,a){return[a[0]+(a[0]-c[0]),a[1]+(a[1]-c[1])]}function mr(c){var a=fr(c);if(!a||!a.length)return[["M",0,0]];for(var e=!1,i=0;i<a.length;i++){var s=a[i][0];if(Pr.test(s)||["V","H","T","S"].indexOf(s)>=0){e=!0;break}}if(!e)return a;var l=[],f=0,d=0,v=0,w=0,E=0,T,G,U=a[0];(U[0]==="M"||U[0]==="m")&&(f=+U[1],d=+U[2],v=f,w=d,E++,l[0]=["M",f,d]);for(var i=E,et=a.length;i<et;i++){var ct=a[i],Ct=l[i-1],Mt=[],s=ct[0],Dt=s.toUpperCase();if(s!==Dt)switch(Mt[0]=Dt,Dt){case"A":Mt[1]=ct[1],Mt[2]=ct[2],Mt[3]=ct[3],Mt[4]=ct[4],Mt[5]=ct[5],Mt[6]=+ct[6]+f,Mt[7]=+ct[7]+d;break;case"V":Mt[1]=+ct[1]+d;break;case"H":Mt[1]=+ct[1]+f;break;case"M":v=+ct[1]+f,w=+ct[2]+d,Mt[1]=v,Mt[2]=w;break;default:for(var zt=1,Qt=ct.length;zt<Qt;zt++)Mt[zt]=+ct[zt]+(zt%2?f:d)}else Mt=a[i];switch(Dt){case"Z":f=+v,d=+w;break;case"H":f=Mt[1],Mt=["L",f,d];break;case"V":d=Mt[1],Mt=["L",f,d];break;case"T":f=Mt[1],d=Mt[2];var Ie=Vr([Ct[1],Ct[2]],[Ct[3],Ct[4]]);Mt=["Q",Ie[0],Ie[1],f,d];break;case"S":f=Mt[Mt.length-2],d=Mt[Mt.length-1];var je=Ct.length,ze=Vr([Ct[je-4],Ct[je-3]],[Ct[je-2],Ct[je-1]]);Mt=["C",ze[0],ze[1],Mt[1],Mt[2],f,d];break;case"M":v=Mt[Mt.length-2],w=Mt[Mt.length-1];break;default:f=Mt[Mt.length-2],d=Mt[Mt.length-1]}l.push(Mt)}return l}var hr=Math.PI*2,Mr=function(c,a,e,i,s,l,f){var d=c.x,v=c.y;d*=a,v*=e;var w=i*d-s*v,E=s*d+i*v;return{x:w+l,y:E+f}},On=function(c,a){var e=a===1.5707963267948966?.551915024494:a===-1.5707963267948966?-.551915024494:4/3*Math.tan(a/4),i=Math.cos(c),s=Math.sin(c),l=Math.cos(c+a),f=Math.sin(c+a);return[{x:i-s*e,y:s+i*e},{x:l+f*e,y:f-l*e},{x:l,y:f}]},ur=function(c,a,e,i){var s=c*i-a*e<0?-1:1,l=c*e+a*i;return l>1&&(l=1),l<-1&&(l=-1),s*Math.acos(l)},Cn=function(c,a,e,i,s,l,f,d,v,w,E,T){var G=Math.pow(s,2),U=Math.pow(l,2),et=Math.pow(E,2),ct=Math.pow(T,2),Ct=G*U-G*ct-U*et;Ct<0&&(Ct=0),Ct/=G*ct+U*et,Ct=Math.sqrt(Ct)*(f===d?-1:1);var Mt=Ct*s/l*T,Dt=Ct*-l/s*E,zt=w*Mt-v*Dt+(c+e)/2,Qt=v*Mt+w*Dt+(a+i)/2,Ie=(E-Mt)/s,je=(T-Dt)/l,ze=(-E-Mt)/s,mn=(-T-Dt)/l,$n=ur(1,0,Ie,je),Tn=ur(Ie,je,ze,mn);return d===0&&Tn>0&&(Tn-=hr),d===1&&Tn<0&&(Tn+=hr),[zt,Qt,$n,Tn]},Dr=function(c){var a=c.px,e=c.py,i=c.cx,s=c.cy,l=c.rx,f=c.ry,d=c.xAxisRotation,v=d===void 0?0:d,w=c.largeArcFlag,E=w===void 0?0:w,T=c.sweepFlag,G=T===void 0?0:T,U=[];if(l===0||f===0)return[{x1:0,y1:0,x2:0,y2:0,x:i,y:s}];var et=Math.sin(v*hr/360),ct=Math.cos(v*hr/360),Ct=ct*(a-i)/2+et*(e-s)/2,Mt=-et*(a-i)/2+ct*(e-s)/2;if(Ct===0&&Mt===0)return[{x1:0,y1:0,x2:0,y2:0,x:i,y:s}];l=Math.abs(l),f=Math.abs(f);var Dt=Math.pow(Ct,2)/Math.pow(l,2)+Math.pow(Mt,2)/Math.pow(f,2);Dt>1&&(l*=Math.sqrt(Dt),f*=Math.sqrt(Dt));var zt=Cn(a,e,i,s,l,f,E,G,et,ct,Ct,Mt),Qt=zt[0],Ie=zt[1],je=zt[2],ze=zt[3],mn=Math.abs(ze)/(hr/4);Math.abs(1-mn)<1e-7&&(mn=1);var $n=Math.max(Math.ceil(mn),1);ze/=$n;for(var Tn=0;Tn<$n;Tn++)U.push(On(je,ze)),je+=ze;return U.map(function(or){var kr=Mr(or[0],l,f,ct,et,Qt,Ie),Ta=kr.x,fi=kr.y,ei=Mr(or[1],l,f,ct,et,Qt,Ie),Ia=ei.x,Gi=ei.y,Ri=Mr(or[2],l,f,ct,et,Qt,Ie),xa=Ri.x,ja=Ri.y;return{x1:Ta,y1:fi,x2:Ia,y2:Gi,x:xa,y:ja}})};function Qr(c,a,e,i,s,l,f,d,v){var w=Dr({px:c,py:a,cx:d,cy:v,rx:e,ry:i,xAxisRotation:s,largeArcFlag:l,sweepFlag:f});return w.reduce(function(E,T){var G=T.x1,U=T.y1,et=T.x2,ct=T.y2,Ct=T.x,Mt=T.y;return E.push(G,U,et,ct,Ct,Mt),E},[])}function _a(c,a){"TQ".indexOf(c[0])<0&&(a.qx=null,a.qy=null);var e=c.slice(1),i=e[0],s=e[1];switch(c[0]){case"M":return a.x=i,a.y=s,c;case"A":return["C"].concat(arcToCubic.apply(0,[a.x1,a.y1].concat(c.slice(1))));case"Q":return a.qx=i,a.qy=s,["C"].concat(quadToCubic.apply(0,[a.x1,a.y1].concat(c.slice(1))));case"L":return["C"].concat(lineToCubic(a.x1,a.y1,c[1],c[2]));case"H":return["C"].concat(lineToCubic(a.x1,a.y1,c[1],a.y1));case"V":return["C"].concat(lineToCubic(a.x1,a.y1,a.x1,c[1]));case"Z":return["C"].concat(lineToCubic(a.x1,a.y1,a.x,a.y));default:}return c}function Ma(c,a){a===void 0&&(a=!1);for(var e=path2Absolute(c),i={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},s=[],l="",f=e.length,d,v,w=[],E=0;E<f;E+=1)e[E]&&(l=e[E][0]),s[E]=l,e[E]=segmentToCubic(e[E],i),ga(e,s,E),f=e.length,l==="Z"&&w.push(E),d=e[E],v=d.length,i.x1=+d[v-2],i.y1=+d[v-1],i.x2=+d[v-4]||i.x1,i.y2=+d[v-3]||i.y1;return a?[e,w]:e}function ga(c,a,e){if(c[e].length>7){c[e].shift();for(var i=c[e],s=e;i.length;)a[e]="A",c.splice(s+=1,0,["C"].concat(i.splice(0,6)));c.splice(e,1)}}var ai=function(c,a,e,i,s){var l=-3*a+9*e-9*i+3*s,f=c*l+6*a-12*e+6*i;return c*f-3*a+3*e},uo=function(c,a,e,i,s,l,f,d,v){v===null&&(v=1),v=v>1?1:v<0?0:v;for(var w=v/2,E=12,T=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],G=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],U=0,et=0;et<E;et++){var ct=w*T[et]+w,Ct=ai(ct,c,e,s,f),Mt=ai(ct,a,i,l,d),Dt=Ct*Ct+Mt*Mt;U+=G[et]*Math.sqrt(Dt)}return w*U},bs=function(c,a,e,i,s,l,f,d){for(var v=[],w=[[],[]],E,T,G,U,et=0;et<2;++et){if(et===0?(T=6*c-12*e+6*s,E=-3*c+9*e-9*s+3*f,G=3*e-3*c):(T=6*a-12*i+6*l,E=-3*a+9*i-9*l+3*d,G=3*i-3*a),Math.abs(E)<1e-12){if(Math.abs(T)<1e-12)continue;U=-G/T,U>0&&U<1&&v.push(U);continue}var ct=T*T-4*G*E,Ct=Math.sqrt(ct);if(!(ct<0)){var Mt=(-T+Ct)/(2*E);Mt>0&&Mt<1&&v.push(Mt);var Dt=(-T-Ct)/(2*E);Dt>0&&Dt<1&&v.push(Dt)}}for(var zt=v.length,Qt=zt,Ie;zt--;)U=v[zt],Ie=1-U,w[0][zt]=Ie*Ie*Ie*c+3*Ie*Ie*U*e+3*Ie*U*U*s+U*U*U*f,w[1][zt]=Ie*Ie*Ie*a+3*Ie*Ie*U*i+3*Ie*U*U*l+U*U*U*d;return w[0][Qt]=c,w[1][Qt]=a,w[0][Qt+1]=f,w[1][Qt+1]=d,w[0].length=w[1].length=Qt+2,{min:{x:Math.min.apply(0,w[0]),y:Math.min.apply(0,w[1])},max:{x:Math.max.apply(0,w[0]),y:Math.max.apply(0,w[1])}}},Hi=function(c,a,e,i,s,l,f,d){if(!(Math.max(c,e)<Math.min(s,f)||Math.min(c,e)>Math.max(s,f)||Math.max(a,i)<Math.min(l,d)||Math.min(a,i)>Math.max(l,d))){var v=(c*i-a*e)*(s-f)-(c-e)*(s*d-l*f),w=(c*i-a*e)*(l-d)-(a-i)*(s*d-l*f),E=(c-e)*(l-d)-(a-i)*(s-f);if(!!E){var T=v/E,G=w/E,U=+T.toFixed(2),et=+G.toFixed(2);if(!(U<+Math.min(c,e).toFixed(2)||U>+Math.max(c,e).toFixed(2)||U<+Math.min(s,f).toFixed(2)||U>+Math.max(s,f).toFixed(2)||et<+Math.min(a,i).toFixed(2)||et>+Math.max(a,i).toFixed(2)||et<+Math.min(l,d).toFixed(2)||et>+Math.max(l,d).toFixed(2)))return{x:T,y:G}}}},ho=function(c,a,e){return a>=c.x&&a<=c.x+c.width&&e>=c.y&&e<=c.y+c.height},No=function(c,a,e,i){return c===null&&(c=a=e=i=0),a===null&&(a=c.y,e=c.width,i=c.height,c=c.x),{x:c,y:a,width:e,w:e,height:i,h:i,x2:c+e,y2:a+i,cx:c+e/2,cy:a+i/2,r1:Math.min(e,i)/2,r2:Math.max(e,i)/2,r0:Math.sqrt(e*e+i*i)/2,path:rectPath(c,a,e,i),vb:[c,a,e,i].join(" ")}},au=function(c,a){return c=No(c),a=No(a),ho(a,c.x,c.y)||ho(a,c.x2,c.y)||ho(a,c.x,c.y2)||ho(a,c.x2,c.y2)||ho(c,a.x,a.y)||ho(c,a.x2,a.y)||ho(c,a.x,a.y2)||ho(c,a.x2,a.y2)||(c.x<a.x2&&c.x>a.x||a.x<c.x2&&a.x>c.x)&&(c.y<a.y2&&c.y>a.y||a.y<c.y2&&a.y>c.y)},xl=function(c,a,e,i,s,l,f,d){isArray(c)||(c=[c,a,e,i,s,l,f,d]);var v=bs.apply(null,c);return No(v.min.x,v.min.y,v.max.x-v.min.x,v.max.y-v.min.y)},uc=function(c,a,e,i,s,l,f,d,v){var w=1-v,E=Math.pow(w,3),T=Math.pow(w,2),G=v*v,U=G*v,et=E*c+T*3*v*e+w*3*v*v*s+U*f,ct=E*a+T*3*v*i+w*3*v*v*l+U*d,Ct=c+2*v*(e-c)+G*(s-2*e+c),Mt=a+2*v*(i-a)+G*(l-2*i+a),Dt=e+2*v*(s-e)+G*(f-2*s+e),zt=i+2*v*(l-i)+G*(d-2*l+i),Qt=w*c+v*e,Ie=w*a+v*i,je=w*s+v*f,ze=w*l+v*d,mn=90-Math.atan2(Ct-Dt,Mt-zt)*180/Math.PI;return{x:et,y:ct,m:{x:Ct,y:Mt},n:{x:Dt,y:zt},start:{x:Qt,y:Ie},end:{x:je,y:ze},alpha:mn}},Rv=function(c,a,e){var i=xl(c),s=xl(a);if(!au(i,s))return e?0:[];for(var l=uo.apply(0,c),f=uo.apply(0,a),d=~~(l/8),v=~~(f/8),w=[],E=[],T={},G=e?0:[],U=0;U<d+1;U++){var et=uc.apply(0,c.concat(U/d));w.push({x:et.x,y:et.y,t:U/d})}for(var U=0;U<v+1;U++){var et=uc.apply(0,a.concat(U/v));E.push({x:et.x,y:et.y,t:U/v})}for(var U=0;U<d;U++)for(var ct=0;ct<v;ct++){var Ct=w[U],Mt=w[U+1],Dt=E[ct],zt=E[ct+1],Qt=Math.abs(Mt.x-Ct.x)<.001?"y":"x",Ie=Math.abs(zt.x-Dt.x)<.001?"y":"x",je=Hi(Ct.x,Ct.y,Mt.x,Mt.y,Dt.x,Dt.y,zt.x,zt.y);if(je){if(T[je.x.toFixed(4)]===je.y.toFixed(4))continue;T[je.x.toFixed(4)]=je.y.toFixed(4);var ze=Ct.t+Math.abs((je[Qt]-Ct[Qt])/(Mt[Qt]-Ct[Qt]))*(Mt.t-Ct.t),mn=Dt.t+Math.abs((je[Ie]-Dt[Ie])/(zt[Ie]-Dt[Ie]))*(zt.t-Dt.t);ze>=0&&ze<=1&&mn>=0&&mn<=1&&(e?G++:G.push({x:je.x,y:je.y,t1:ze,t2:mn}))}}return G},Xf=function(c,a,e){c=path2Curve(c),a=path2Curve(a);for(var i,s,l,f,d,v,w,E,T,G,U=e?0:[],et=0,ct=c.length;et<ct;et++){var Ct=c[et];if(Ct[0]==="M")i=d=Ct[1],s=v=Ct[2];else{Ct[0]==="C"?(T=[i,s].concat(Ct.slice(1)),i=T[6],s=T[7]):(T=[i,s,i,s,d,v,d,v],i=d,s=v);for(var Mt=0,Dt=a.length;Mt<Dt;Mt++){var zt=a[Mt];if(zt[0]==="M")l=w=zt[1],f=E=zt[2];else{zt[0]==="C"?(G=[l,f].concat(zt.slice(1)),l=G[6],f=G[7]):(G=[l,f,l,f,w,E,w,E],l=w,f=E);var Qt=Rv(T,G,e);if(e)U+=Qt;else{for(var Ie=0,je=Qt.length;Ie<je;Ie++)Qt[Ie].segment1=et,Qt[Ie].segment2=Mt,Qt[Ie].bez1=T,Qt[Ie].bez2=G;U=U.concat(Qt)}}}}}return U};function Tg(c,a){return Xf(c,a)}function Kc(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Rf(c,a){return Kc(c)*Kc(a)?(c[0]*a[0]+c[1]*a[1])/(Kc(c)*Kc(a)):1}function bd(c,a){return(c[0]*a[1]<c[1]*a[0]?-1:1)*Math.acos(Rf(c,a))}function ql(c,a){return c[0]===a[0]&&c[1]===a[1]}function _p(c,a){var e=a[1],i=a[2],s=(0,_.mod)((0,_.toRadian)(a[3]),Math.PI*2),l=a[4],f=a[5],d=c[0],v=c[1],w=a[6],E=a[7],T=Math.cos(s)*(d-w)/2+Math.sin(s)*(v-E)/2,G=-1*Math.sin(s)*(d-w)/2+Math.cos(s)*(v-E)/2,U=T*T/(e*e)+G*G/(i*i);U>1&&(e*=Math.sqrt(U),i*=Math.sqrt(U));var et=e*e*(G*G)+i*i*(T*T),ct=et?Math.sqrt((e*e*(i*i)-et)/et):1;l===f&&(ct*=-1),isNaN(ct)&&(ct=0);var Ct=i?ct*e*G/i:0,Mt=e?ct*-i*T/e:0,Dt=(d+w)/2+Math.cos(s)*Ct-Math.sin(s)*Mt,zt=(v+E)/2+Math.sin(s)*Ct+Math.cos(s)*Mt,Qt=[(T-Ct)/e,(G-Mt)/i],Ie=[(-1*T-Ct)/e,(-1*G-Mt)/i],je=bd([1,0],Qt),ze=bd(Qt,Ie);return Rf(Qt,Ie)<=-1&&(ze=Math.PI),Rf(Qt,Ie)>=1&&(ze=0),f===0&&ze>0&&(ze=ze-2*Math.PI),f===1&&ze<0&&(ze=ze+2*Math.PI),{cx:Dt,cy:zt,rx:ql(c,[w,E])?0:e,ry:ql(c,[w,E])?0:i,startAngle:je,endAngle:je+ze,xRotation:s,arcFlag:l,sweepFlag:f}}function Vm(c,a){return[a[0]+(a[0]-c[0]),a[1]+(a[1]-c[1])]}function X0(c){c=ll(c);for(var a=[],e=null,i=null,s=null,l=0,f=c.length,d=0;d<f;d++){var v=c[d];i=c[d+1];var w=v[0],E={command:w,prePoint:e,params:v,startTangent:null,endTangent:null};switch(w){case"M":s=[v[1],v[2]],l=d;break;case"A":var T=_p(e,v);E.arcParams=T;break;default:break}if(w==="Z")e=s,i=c[l+1];else{var G=v.length;e=[v[G-2],v[G-1]]}i&&i[0]==="Z"&&(i=c[l],a[l]&&(a[l].prePoint=e)),E.currentPoint=e,a[l]&&ql(e,a[l].currentPoint)&&(a[l].prePoint=E.prePoint);var U=i?[i[i.length-2],i[i.length-1]]:null;E.nextPoint=U;var et=E.prePoint;if(["L","H","V"].includes(w))E.startTangent=[et[0]-e[0],et[1]-e[1]],E.endTangent=[e[0]-et[0],e[1]-et[1]];else if(w==="Q"){var ct=[v[1],v[2]];E.startTangent=[et[0]-ct[0],et[1]-ct[1]],E.endTangent=[e[0]-ct[0],e[1]-ct[1]]}else if(w==="T"){var Ct=a[d-1],ct=Vm(Ct.currentPoint,et);Ct.command==="Q"?(E.command="Q",E.startTangent=[et[0]-ct[0],et[1]-ct[1]],E.endTangent=[e[0]-ct[0],e[1]-ct[1]]):(E.command="TL",E.startTangent=[et[0]-e[0],et[1]-e[1]],E.endTangent=[e[0]-et[0],e[1]-et[1]])}else if(w==="C"){var Mt=[v[1],v[2]],Dt=[v[3],v[4]];E.startTangent=[et[0]-Mt[0],et[1]-Mt[1]],E.endTangent=[e[0]-Dt[0],e[1]-Dt[1]],E.startTangent[0]===0&&E.startTangent[1]===0&&(E.startTangent=[Mt[0]-Dt[0],Mt[1]-Dt[1]]),E.endTangent[0]===0&&E.endTangent[1]===0&&(E.endTangent=[Dt[0]-Mt[0],Dt[1]-Mt[1]])}else if(w==="S"){var Ct=a[d-1],Mt=Vm(Ct.currentPoint,et),Dt=[v[1],v[2]];Ct.command==="C"?(E.command="C",E.startTangent=[et[0]-Mt[0],et[1]-Mt[1]],E.endTangent=[e[0]-Dt[0],e[1]-Dt[1]]):(E.command="SQ",E.startTangent=[et[0]-Dt[0],et[1]-Dt[1]],E.endTangent=[e[0]-Dt[0],e[1]-Dt[1]])}else if(w==="A"){var zt=.001,Qt=E.arcParams||{},Ie=Qt.cx,je=Ie===void 0?0:Ie,ze=Qt.cy,mn=ze===void 0?0:ze,$n=Qt.rx,Tn=$n===void 0?0:$n,or=Qt.ry,kr=or===void 0?0:or,Ta=Qt.sweepFlag,fi=Ta===void 0?0:Ta,ei=Qt.startAngle,Ia=ei===void 0?0:ei,Gi=Qt.endAngle,Ri=Gi===void 0?0:Gi;fi===0&&(zt*=-1);var xa=Tn*Math.cos(Ia-zt)+je,ja=kr*Math.sin(Ia-zt)+mn;E.startTangent=[xa-s[0],ja-s[1]];var di=Tn*Math.cos(Ia+Ri+zt)+je,hi=kr*Math.sin(Ia+Ri-zt)+mn;E.endTangent=[et[0]-di,et[1]-hi]}a.push(E)}return a}function Ag(c){for(var a=[],e=c.length,i=0;i<e-1;i++){var s=c[i],l=c[i+1];a.push({from:{x:s[0],y:s[1]},to:{x:l[0],y:l[1]}})}if(a.length>1){var f=c[0],d=c[e-1];a.push({from:{x:d[0],y:d[1]},to:{x:f[0],y:f[1]}})}return a}function im(c,a){var e=!1;return each(c,function(i){if(getLineIntersect(i.from,i.to,a.from,a.to))return e=!0,!1}),e}function om(c){var a=c.map(function(i){return i[0]}),e=c.map(function(i){return i[1]});return{minX:Math.min.apply(null,a),maxX:Math.max.apply(null,a),minY:Math.min.apply(null,e),maxY:Math.max.apply(null,e)}}function Lv(c,a){return!(a.minX>c.maxX||a.maxX<c.minX||a.minY>c.maxY||a.maxY<c.minY)}function M1(c,a){if(c.length<2||a.length<2)return!1;var e=om(c),i=om(a);if(!Lv(e,i))return!1;var s=!1;if(each(a,function(v){if(isPointInPolygon(c,v[0],v[1]))return s=!0,!1}),s||(each(c,function(v){if(isPointInPolygon(a,v[0],v[1]))return s=!0,!1}),s))return!0;var l=Ag(c),f=Ag(a),d=!1;return each(f,function(v){if(im(l,v))return d=!0,!1}),d}function Y0(c,a){for(var e=[],i=[],s=[],l=0;l<c.length;l++){var f=c[l],d=f.currentPoint,v=f.params,w=f.prePoint,E=void 0;switch(f.command){case"Q":E=q.box(w[0],w[1],v[1],v[2],v[3],v[4]);break;case"C":E=he.box(w[0],w[1],v[1],v[2],v[3],v[4],v[5],v[6]);break;case"A":var T=f.arcParams;E=Xn.box(T.cx,T.cy,T.rx,T.ry,T.xRotation,T.startAngle,T.endAngle);break;default:e.push(d[0]),i.push(d[1]);break}E&&(f.box=E,e.push(E.x,E.x+E.width),i.push(E.y,E.y+E.height)),a&&(f.command==="L"||f.command==="M")&&f.prePoint&&f.nextPoint&&s.push(f)}e=e.filter(function(Mt){return!Number.isNaN(Mt)&&Mt!==Infinity&&Mt!==-Infinity}),i=i.filter(function(Mt){return!Number.isNaN(Mt)&&Mt!==Infinity&&Mt!==-Infinity});var G=(0,_.min)(e),U=(0,_.min)(i),et=(0,_.max)(e),ct=(0,_.max)(i);if(s.length===0)return{x:G,y:U,width:et-G,height:ct-U};for(var l=0;l<s.length;l++){var f=s[l],d=f.currentPoint,Ct=void 0;d[0]===G?(Ct=xd(f,a),G=G-Ct.xExtra):d[0]===et&&(Ct=xd(f,a),et=et+Ct.xExtra),d[1]===U?(Ct=xd(f,a),U=U-Ct.yExtra):d[1]===ct&&(Ct=xd(f,a),ct=ct+Ct.yExtra)}return{x:G,y:U,width:et-G,height:ct-U}}function xd(c,a){var e=c.prePoint,i=c.currentPoint,s=c.nextPoint,l=Math.pow(i[0]-e[0],2)+Math.pow(i[1]-e[1],2),f=Math.pow(i[0]-s[0],2)+Math.pow(i[1]-s[1],2),d=Math.pow(e[0]-s[0],2)+Math.pow(e[1]-s[1],2),v=Math.acos((l+f-d)/(2*Math.sqrt(l)*Math.sqrt(f)));if(!v||Math.sin(v)===0||(0,_.isNumberEqual)(v,0))return{xExtra:0,yExtra:0};var w=Math.abs(Math.atan2(s[1]-i[1],s[0]-i[0])),E=Math.abs(Math.atan2(s[0]-i[0],s[1]-i[1]));w=w>Math.PI/2?Math.PI-w:w,E=E>Math.PI/2?Math.PI-E:E;var T={xExtra:Math.cos(v/2-w)*(a/2*(1/Math.sin(v/2)))-a/2||0,yExtra:Math.cos(E-v/2)*(a/2*(1/Math.sin(v/2)))-a/2||0};return T}function iv(c){var a=c.attr(),e=a.path,i=a.stroke,s=i?a.lineWidth:0,l=c.get("segments")||X0(e),f=Y0(l,s),d=f.x,v=f.y,w=f.width,E=f.height,T={minX:d,minY:v,maxX:d+w,maxY:v+E};return T=fu(c,T),{x:T.minX,y:T.minY,width:T.maxX-T.minX,height:T.maxY-T.minY}}function _c(c){var a=c.attr(),e=a.x1,i=a.y1,s=a.x2,l=a.y2,f=Math.min(e,s),d=Math.max(e,s),v=Math.min(i,l),w=Math.max(i,l),E={minX:f,maxX:d,minY:v,maxY:w};return E=fu(c,E),{x:E.minX,y:E.minY,width:E.maxX-E.minX,height:E.maxY-E.minY}}function m(c){var a=c.attr(),e=a.x,i=a.y,s=a.rx,l=a.ry;return{x:e-s,y:i-l,width:s*2,height:l*2}}jf("rect",Ov),jf("image",Ov),jf("circle",Cp),jf("marker",Cp),jf("polyline",Rs),jf("polygon",Eu),jf("text",Su),jf("path",iv),jf("line",_c),jf("ellipse",m);var y="0.5.11",b=function(c){(0,O.__extends)(a,c);function a(e,i){var s=c.call(this,e,i)||this;return s.item=i.item,s.canvasX=i.canvasX,s.canvasY=i.canvasY,s.wheelDelta=i.wheelDelta,s.detail=i.detail,s}return a}(Uc),S=function(a){return"".concat(a,"-").concat(Math.random()).concat(Date.now())},D=function(a){if((0,_.isArray)(a))switch(a.length){case 4:return a;case 3:return a.push(a[1]),a;case 2:return a.concat(a);case 1:return[a[0],a[0],a[0],a[0]];default:return[0,0,0,0]}if((0,_.isNumber)(a))return[a,a,a,a];if((0,_.isString)(a)){var e=parseInt(a,10);return[e,e,e,e]}return[0,0,0,0]},J=function(a){var e=new b(a.type,a);return e.clientX=a.clientX,e.clientY=a.clientY,e.x=a.x,e.y=a.y,e.target=a.target,e.currentTarget=a.currentTarget,e.bubbles=!0,e.item=a.item,e},lt=function(a){if(!a)return!1;for(var e=9,i=[1,0,0,0,1,0,0,0,1],s=0;s<e;s++)if(a[s]!==i[s])return!0;return!1},xt=function(a){return Number.isNaN(Number(a))},_t=function(a){for(var e=Infinity,i=-Infinity,s=Infinity,l=-Infinity,f=0;f<a.length;f++){var d=a[f],v=d.getBBox(),w=v.minX,E=v.minY,T=v.maxX,G=v.maxY;w<e&&(e=w),E<s&&(s=E),T>i&&(i=T),G>l&&(l=G)}var U=Math.floor(e),et=Math.floor(s),ct=Math.ceil(i)-Math.floor(e),Ct=Math.ceil(l)-Math.floor(s);return{x:U,y:et,width:ct,height:Ct,minX:e,minY:s,maxX:i,maxY:l}},Wt=function(a,e,i,s,l){e===void 0&&(e=15),i===void 0&&(i="quadratic"),s===void 0&&(s=void 0),l===void 0&&(l=void 0);for(var f=a.length,d=e*2,v=["top","top-right","right","bottom-right","bottom","bottom-left","left","top-left"],w={},E=[],T={},G=0;G<f;G++){var U=a[G],et=U.source,ct=U.target,Ct="".concat(et,"-").concat(ct);if(!E[G]){w[Ct]||(w[Ct]=[]),E[G]=!0,w[Ct].push(U);for(var Mt=0;Mt<f;Mt++)if(G!==Mt){var Dt=a[Mt],zt=Dt.source,Qt=Dt.target;E[Mt]||(et===Qt&&ct===zt?(w[Ct].push(Dt),E[Mt]=!0,T["".concat(zt,"|").concat(Qt,"|").concat(w[Ct].length-1)]=!0):et===zt&&ct===Qt&&(w[Ct].push(Dt),E[Mt]=!0))}}}for(var Ie in w)for(var je=w[Ie],ze=je.length,mn=0;mn<ze;mn++){var $n=je[mn];if($n.source===$n.target){l&&($n.type=l),$n.loopCfg={position:v[mn%8],dist:Math.floor(mn/8)*20+50};continue}if(ze===1&&s&&$n.source!==$n.target){$n.type=s;continue}$n.type=i;var Tn=(mn%2==0?1:-1)*(T["".concat($n.source,"|").concat($n.target,"|").concat(mn)]?-1:1);ze%2==1?$n.curveOffset=Tn*Math.ceil(mn/2)*d:$n.curveOffset=Tn*(Math.floor(mn/2)*d+e)}return a},qt=$(31278),Jt=function(){function c(a){this.destroyed=!1,this.graph=a,this.destroyed=!1}return c.prototype.getViewCenter=function(){var a=this.getFormatPadding(),e=this.graph,i=this.graph.get("width"),s=e.get("height");return{x:(i-a[1]-a[3])/2+a[3],y:(s-a[0]-a[2])/2+a[0]}},c.prototype.fitCenter=function(a,e){var i=this.graph,s=i.get("group"),l,f=i.getNodes();if(f.length>i.get("optimizeThreshold")){var d=Infinity,v=Infinity,w=-Infinity,E=-Infinity;f.forEach(function(Qt){var Ie=Qt.getModel(),je=Ie.x,ze=Ie.y;d>je&&(d=je),v>ze&&(v=ze),w<je&&(w=je),E<ze&&(E=ze)});var T=s.getMatrix()||[1,0,0,0,1,0,0,0,1],G=bn({x:d,y:v},T),U=G.x,et=G.y,ct=bn({x:w,y:E},T),Ct=ct.x,Mt=ct.y;l={minX:U,maxX:Ct,minY:et,maxY:Mt,width:Ct-U,height:Mt-et,x:U,y:et}}else l=s.getCanvasBBox();if(!(l.width===0||l.height===0)){var Dt=this.getViewCenter(),zt={x:l.x+l.width/2,y:l.y+l.height/2};i.translate(Dt.x-zt.x,Dt.y-zt.y,a,e)}},c.prototype.animatedFitView=function(a,e,i,s,l,f,d,v){var w=this.graph;i=i||{duration:500,easing:"easeCubic"};var E=[1,0,0,0,1,0,0,0,1],T=s.x+l.x-f.x-s.minX,G=s.y+l.y-f.y-s.minY;if(!(xt(T)||xt(G))){var U=(0,qt.vs)(E,[["t",T,G]]);if(!v){var et=Cl({animateCfg:i,callback:function(){w.emit("viewportchange",{action:"translate",matrix:U})}});a.animate(function(Qt){return{matrix:ol(e,U,Qt)}},et);return}var ct=w.get("minZoom"),Ct=w.get("maxZoom"),Mt=d;ct&&d<ct?(Mt=ct,console.warn("fitview failed, ratio out of range, ratio: %f",d,"graph minzoom has been used instead")):Ct&&d>Ct&&(Mt=Ct,console.warn("fitview failed, ratio out of range, ratio: %f",d,"graph maxzoom has been used instead"));var Dt=(0,qt.vs)(U,[["t",-l.x,-l.y],["s",Mt,Mt],["t",l.x,l.y]]),zt=Cl({animateCfg:i,callback:function(){a.setMatrix(Dt),w.emit("viewportchange",{action:"translate",matrix:U}),w.emit("viewportchange",{action:"zoom",matrix:Dt})}});a.stopAnimate(),a.setMatrix(e),a.animate(function(Qt){return{matrix:ol(e,Dt,Qt)}},zt)}},c.prototype.fitView=function(a,e){var i=this.graph,s=this.getFormatPadding(),l=i.get("width"),f=i.get("height"),d=i.get("group"),v=d.getMatrix()||[1,0,0,0,1,0,0,0,1];d.resetMatrix();var w,E=i.getNodes();if(E.length>i.get("optimizeThreshold")){var T=Infinity,G=Infinity,U=-Infinity,et=-Infinity;E.forEach(function(je){var ze=je.getModel(),mn=ze.x,$n=ze.y;T>mn&&(T=mn),G>$n&&(G=$n),U<mn&&(U=mn),et<$n&&(et=$n)}),w={minX:T,maxX:U,minY:G,maxY:et,width:U-T,height:et-G,x:T,y:G}}else w=d.getCanvasBBox();if(!(w.width===0||w.height===0)){var ct=this.getViewCenter(),Ct={x:w.x+w.width/2,y:w.y+w.height/2},Mt=(l-s[1]-s[3])/w.width,Dt=(f-s[0]-s[2])/w.height,zt=Mt;if(Mt>Dt&&(zt=Dt),a)this.animatedFitView(d,v,e,w,ct,Ct,zt,!0);else{var Qt=ct.x-Ct.x,Ie=ct.y-Ct.y;if(xt(Qt)||xt(Ie))return;i.translate(Qt,Ie),i.zoom(zt,ct)||console.warn("zoom failed, ratio out of range, ratio: %f",zt)}}},c.prototype.fitViewByRules=function(a,e,i){var s=a.onlyOutOfViewPort,l=s===void 0?!1:s,f=a.direction,d=f===void 0?"both":f,v=a.ratioRule,w=v===void 0?"min":v,E=this.graph,T=this.getFormatPadding(),G=E.get("width"),U=E.get("height"),et=E.get("group"),ct=et.getMatrix()||[1,0,0,0,1,0,0,0,1];et.resetMatrix();var Ct,Mt=E.getNodes();if(Mt.length>E.get("optimizeThreshold")){var Dt=Infinity,zt=Infinity,Qt=-Infinity,Ie=-Infinity;Mt.forEach(function(fi){var ei=fi.getModel(),Ia=ei.x,Gi=ei.y;Dt>Ia&&(Dt=Ia),zt>Gi&&(zt=Gi),Qt<Ia&&(Qt=Ia),Ie<Gi&&(Ie=Gi)}),Ct={minX:Dt,maxX:Qt,minY:zt,maxY:Ie,width:Qt-Dt,height:Ie-zt,x:Dt,y:zt}}else Ct=et.getCanvasBBox();if(!(Ct.width===0||Ct.height===0)){var je=this.getViewCenter(),ze={x:Ct.x+Ct.width/2,y:Ct.y+Ct.height/2},mn=(G-T[1]-T[3])/Ct.width,$n=(U-T[0]-T[2])/Ct.height,Tn;if(d==="x"?Tn=mn:d==="y"?Tn=$n:Tn=w==="max"?Math.max(mn,$n):Math.min(mn,$n),l&&(Tn=Tn<1?Tn:1),e)this.animatedFitView(et,ct,i,Ct,je,ze,Tn,!0);else{var or=E.getZoom(),kr=or*Tn,Ta=E.get("minZoom");kr<Ta&&(kr=Ta,console.warn("fitview failed, ratio out of range, ratio: %f",Tn,"graph minzoom has been used instead")),E.translate(je.x-ze.x,je.y-ze.y),E.zoomTo(kr,je)}}},c.prototype.getFormatPadding=function(){var a=this.graph.get("fitViewPadding");return D(a)},c.prototype.focusPoint=function(a,e,i){var s=this,l=this.getViewCenter(),f=this.getPointByCanvas(l.x,l.y),d=this.graph.get("group").getMatrix();if(d||(d=[1,0,0,0,1,0,0,0,1]),e){var v=(f.x-a.x)*d[0],w=(f.y-a.y)*d[4],E=0,T=0,G=0,U=0;this.graph.get("canvas").animate(function(et){G=v*et,U=w*et,s.graph.translate(G-E,U-T),E=G,T=U},(0,O.__assign)({},i))}else this.graph.translate((f.x-a.x)*d[0],(f.y-a.y)*d[4])},c.prototype.getPointByCanvas=function(a,e){var i=this.graph.get("group").getMatrix();i||(i=[1,0,0,0,1,0,0,0,1]);var s=Xr({x:a,y:e},i);return s},c.prototype.getPointByClient=function(a,e){var i=this.graph.get("canvas"),s=i.getPointByClient(a,e);return this.getPointByCanvas(s.x,s.y)},c.prototype.getClientByPoint=function(a,e){var i=this.graph.get("canvas"),s=this.getCanvasByPoint(a,e),l=i.getClientByPoint(s.x,s.y);return{x:l.x,y:l.y}},c.prototype.getCanvasByPoint=function(a,e){var i=this.graph.get("group").getMatrix();return i||(i=[1,0,0,0,1,0,0,0,1]),bn({x:a,y:e},i)},c.prototype.focus=function(a,e,i){if((0,_.isString)(a)&&(a=this.graph.findById(a)),a){var s=0,l=0;if(a.getType&&a.getType()==="edge"){var f=a.getSource().get("group").getMatrix(),d=a.getTarget().get("group").getMatrix();f&&d?(s=(f[6]+d[6])/2,l=(f[7]+d[7])/2):(f||d)&&(s=f?f[6]:d[6],l=f?f[7]:d[7])}else{var v=a.get("group"),w=v.getMatrix();w||(w=[1,0,0,0,1,0,0,0,1]),s=w[6],l=w[7]}this.focusPoint({x:s,y:l},e,i)}},c.prototype.focusItems=function(a,e,i,s){if(!!a.length){var l=this.graph,f=this.getFormatPadding(),d=l.get("width"),v=l.get("height"),w=l.get("group"),E=w.getMatrix()||[1,0,0,0,1,0,0,0,1];w.resetMatrix();for(var T={x:0,y:0,minX:Number.MAX_SAFE_INTEGER,minY:Number.MAX_SAFE_INTEGER,maxX:Number.MIN_SAFE_INTEGER,maxY:Number.MIN_SAFE_INTEGER,width:0,height:0},G=0,U=a;G<U.length;G++){var et=U[G],ct=et.getBBox();ct.minX<T.minX&&(T.minX=ct.minX),ct.minY<T.minY&&(T.minY=ct.minY),ct.maxX>T.maxX&&(T.maxX=ct.maxX),ct.maxY>T.maxY&&(T.maxY=ct.maxY)}if(T.x=T.minX,T.y=T.minY,T.width=T.maxX-T.minX,T.height=T.maxY-T.minY,!(T.width===0||T.height===0)){var Ct=this.getViewCenter(),Mt={x:T.x+T.width/2,y:T.y+T.height/2},Dt=(d-f[1]-f[3])/T.width,zt=(v-f[0]-f[2])/T.height,Qt=Dt;Dt>zt&&(Qt=zt),i?this.animatedFitView(w,E,s,T,Ct,Mt,Qt,e):(l.translate(Ct.x-Mt.x,Ct.y-Mt.y),e&&!l.zoom(Qt,Ct)&&console.warn("zoom failed, ratio out of range, ratio: %f",Qt))}}},c.prototype.changeSize=function(a,e){var i=this.graph;if(!(0,_.isNumber)(a)||!(0,_.isNumber)(e))throw Error("invalid canvas width & height, please make sure width & height type is number");i.set({width:a,height:e});var s=i.get("canvas");s.changeSize(a,e);var l=i.get("plugins");l.forEach(function(f){f.get("gridContainer")&&f.positionInit()})},c.prototype.destroy=function(){this.graph=null,this.destroyed=!1},c}(),Ut=Jt;function xe(c){return xe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},xe(c)}function Ce(c){if(typeof c!="string")return c;var a=function(ze){if(typeof ze!="string")return ze;try{return JSON.parse(ze.trim())}catch(mn){return ze.trim()}},e=a(c);if(typeof e!="string")return e;for(var i=function(ze){return ze[ze.length-1]},s=c.trim(),l=[],f=[],d=function(){for(var ze=[],mn=0;mn<arguments.length;mn++)ze[mn]=arguments[mn];return ze.some(function($n){return i(f)===$n})},v=function(){return i(l)},w=null,E=0,T="";E<s.length;){var G=s[E],U=d('"',"'");if(!U&&!G.trim()){E+=1;continue}var et=s[E-1]==="\\",ct=d("}"),Ct=d("]"),Mt=d(","),Dt=v();if(U)if(i(f)===G&&!et){f.pop();var zt=a(T);Dt.push(zt),w=zt,T=""}else T+=G;else if(Ct&&G===",")T&&(Dt.push(a(T)),T="");else if(ct&&G===":")f.push(","),T&&(Dt.push(T),T="");else if(Mt&&G===",")T&&(Dt.push(a(T)),T=""),f.pop();else if(G==="}"&&(ct||Mt)){T&&(Dt.push(a(T)),T=""),Mt&&f.pop();for(var Qt={},Ie=1;Ie<Dt.length;Ie+=2)Qt[Dt[Ie-1]]=Dt[Ie];l.pop(),l.length&&i(l).push(Qt),f.pop(),w=Qt}else G==="]"&&Ct?(T&&(Dt.push(a(T)),T=""),l.pop(),l.length&&i(l).push(Dt),f.pop(),w=Dt):G==="{"?(l.push([]),f.push("}")):G==="["?(l.push([]),f.push("]")):G==='"'?f.push('"'):G==="'"?f.push("'"):T+=G;E+=1}return w||T}var Ue=function(a){return a.split("-").reduce(function(e,i){return e+i.charAt(0).toUpperCase()+i.slice(1)})},en=function(a){return function(e){for(var i=a.length,s=[],l=0,f="";l<i;)if(a[l]==="{"&&a[l+1]==="{")s.push(f),f="",l+=2;else if(a[l]==="}"&&a[l+1]==="}"){if(s.length){var d=s.pop();f=(0,_.get)(e,f,d.endsWith("=")?'"{'.concat(f,'}"'):f),s.push(d+f)}l+=2,f=""}else f+=a[l],l+=1;return s.push(f),s.map(function(v,w){return s[w-1]&&s[w-1].endsWith("=")?'"{'.concat(v,'}"'):v}).join("")}};function dn(c,a){var e={},i=c.getAttributeNames&&c.getAttributeNames()||[],s=c.children&&Array.from(c.children).map(function(d){return dn(d,a)}),l={},f=c.tagName?c.tagName.toLowerCase():"group";return f==="text"&&(e.text=c.innerText),l.type=f,f==="img"&&(l.type="image"),Array.from(i).forEach(function(d){var v=Ue(d),w=c.getAttribute(d);try{if(v==="style"||v==="attrs"){var E=Ce(w);e=(0,O.__assign)((0,O.__assign)({},e),E)}else l[v]=Ce(w)}catch(T){if(v==="style")throw T;l[v]=w}}),l.attrs=e,a&&a.style&&l.name&&xe(a.style[l.name])==="object"&&(l.attrs=(0,O.__assign)((0,O.__assign)({},l.attrs),a.style[l.name])),a&&a.style&&l.keyshape&&(l.attrs=(0,O.__assign)((0,O.__assign)({},l.attrs),a.style)),s.length&&(l.children=s),l}function Rn(c,a,e){var i=c.attrs,s=i===void 0?{}:i,l={x:a.x||0,y:a.y||0,width:e.width||0,height:e.height||0},f,d;switch(c.type){case"maker":case"circle":s.r&&(d=2*s.r,f=2*s.r);break;case"text":s.text&&(d=Vo(s.text,s.fontSize||12)[0],f=16,l.y+=f,l.height=f,l.width=d,c.attrs=(0,O.__assign)({fontSize:12,fill:"#000"},s));break;default:s.width&&(d=s.width),s.height&&(f=s.height)}return f>=0&&(l.height=f),d>=0&&(l.width=d),s.marginTop&&(l.y+=s.marginTop),s.marginLeft&&(l.x+=s.marginLeft),l}function nr(c,a){var e;a===void 0&&(a={x:0,y:0});var i=(0,O.__assign)({x:0,y:0,width:0,height:0},a);if((e=c.children)===null||e===void 0?void 0:e.length){var s=c.attrs,l=s===void 0?{}:s,f=l.marginTop,d=(0,O.__assign)({},a);f&&(d.y+=f);for(var v=0;v<c.children.length;v++){c.children[v].attrs.key="".concat(l.key||"root"," -").concat(v," ");var w=nr(c.children[v],d);if(w.bbox){var E=w.bbox;w.attrs.next==="inline"?d.x+=w.bbox.width:d.y+=w.bbox.height,E.width+E.x>i.width&&(i.width=E.width+E.x),E.height+E.y>i.height&&(i.height=E.height+E.y)}}}return c.bbox=Rn(c,a,i),c.attrs=(0,O.__assign)((0,O.__assign)({},c.attrs),c.bbox),c}function Kn(c,a){var e,i,s,l,f=(c||{}).type,d=((a==null?void 0:a.attrs)||{}).key;if(d&&c&&(c.attrs.key=d),!c&&a)return{action:"delete",val:a,type:f,key:d};if(c&&!a)return{action:"add",val:c,type:f};if(!c&&!a)return{action:"same",type:f};var v=[];if(((e=c.children)===null||e===void 0?void 0:e.length)>0||((i=a.children)===null||i===void 0?void 0:i.length)>0)for(var w=Math.max((s=c.children)===null||s===void 0?void 0:s.length,(l=a.children)===null||l===void 0?void 0:l.length),E=a.children||[],T=c.children||[],G=0;G<w;G+=1)v.push(Kn(T[G],E[G]));var U=Object.keys(a.attrs),et=Object.keys(c.attrs);return a.type!==c.type?{action:"restructure",nowTarget:c,formerTarget:a,key:d,children:v}:U.filter(function(ct){return ct!=="children"}).some(function(ct){return c.attrs[ct]!==a.attrs[ct]||!et.includes(ct)})?{action:"change",val:c,children:v,type:f,key:d}:{action:"same",children:v,type:f,key:d}}function Sr(c){var a={},e=function(s){var l=typeof c=="function"?c(s):c,f=en(l)(s),d=document.createElement("div");d.innerHTML=f;var v=d.children[0],w=nr(dn(v,s));return d.remove(),w};return{draw:function(s,l){var f=e(s),d=l,v=function w(E){var T=E.attrs,G=T===void 0?{}:T,U=E.bbox,et=E.type,ct=E.children,Ct=(0,O.__rest)(E,["attrs","bbox","type","children"]);if(E.type!=="group"){var Mt=l.addShape(E.type,(0,O.__assign)({attrs:G,origin:{bbox:U,type:et,children:ct}},Ct));E.keyshape&&(d=Mt)}E.children&&E.children.forEach(function(Dt){return w(Dt)})};return v(f),a[s.id]=[f],d},update:function(s,l){a[s.id]||(a[s.id]=[]);var f=l.getContainer(),d=f.get("children"),v=e(s),w=a[s.id].pop(),E=Kn(v,w),T=function et(ct){var Ct;ct.type!=="group"&&f.addShape(ct.type,{attrs:ct.attrs}),((Ct=ct.children)===null||Ct===void 0?void 0:Ct.length)&&ct.children.map(function(Mt){return et(Mt)})},G=function et(ct){var Ct,Mt=d.find(function(Dt){return Dt.attrs.key===ct.attrs.key});Mt&&f.removeChild(Mt),((Ct=ct.children)===null||Ct===void 0?void 0:Ct.length)&&ct.children.map(function(Dt){return et(Dt)})},U=function et(ct){var Ct=ct.key;if(ct.type!=="group"){var Mt=d.find(function(zt){return zt.attrs.key===Ct});switch(ct.action){case"change":if(Mt){var Dt=ct.val.keyshape?l.getOriginStyle():{};Mt.attr((0,O.__assign)((0,O.__assign)({},Dt),ct.val.attrs))}break;case"add":T(ct.val);break;case"delete":G(ct.val);break;case"restructure":G(ct.formerTarget),T(ct.nowTarget);break;default:break}}ct.children&&ct.children.forEach(function(zt){return et(zt)})};U(E),a[s.id].push(v)},getAnchorPoints:function(){return[[0,.5],[1,.5],[.5,1],[.5,0]]}}}var jn={};function pr(c){return jn[c]||(jn[c]=(0,_.upperFirst)(c)),jn[c]}var zr={defaultShapeType:"defaultType",className:null,getShape:function(a){var e=this,i=e[a]||e[e.defaultShapeType]||e["simple-circle"];return i},draw:function(a,e,i){var s=this.getShape(a);i.shapeMap={};var l=s.draw(e,i);return s.afterDraw&&s.afterDraw(e,i,l),l},baseUpdate:function(a,e,i,s){var l,f,d=this.getShape(a);d.update&&(d.mergeStyle=(l=d.getOptions)===null||l===void 0?void 0:l.call(d,e,s),(f=d.update)===null||f===void 0||f.call(d,e,i,s)),d.afterUpdate&&d.afterUpdate(e,i)},setState:function(a,e,i,s){var l=this.getShape(a);l.setState(e,i,s)},shouldUpdate:function(a){var e=this.getShape(a);return!!e.update},getControlPoints:function(a,e){var i=this.getShape(a);return i.getControlPoints(e)},getAnchorPoints:function(a,e){var i=this.getShape(a);return i.getAnchorPoints(e)}},Er={options:{},draw:function(a,e){return this.drawShape(a,e)},drawShape:function(){},afterDraw:function(){},afterUpdate:function(){},setState:function(){},getControlPoints:function(a){return a.controlPoints},getAnchorPoints:function(a){var e=this.options.anchorPoints,i=a.anchorPoints||e;return i}},oa=function(){function c(){}return c.registerFactory=function(a,e){var i=pr(a),s=zr,l=(0,O.__assign)((0,O.__assign)({},s),e);return c[i]=l,l.className=i,l},c.getFactory=function(a){var e=pr(a);return c[e]},c.registerNode=function(a,e,i){var s=c.Node,l;if(typeof e=="string"||typeof e=="function"){var f=Sr(e);l=(0,O.__assign)((0,O.__assign)({},s.getShape("single-node")),f)}else if(e.jsx){var d=e.jsx,f=Sr(d);l=(0,O.__assign)((0,O.__assign)((0,O.__assign)({},s.getShape("single-node")),f),e)}else{s.getShape(i);var v=i?s.getShape(i):Er;l=(0,O.__assign)((0,O.__assign)({},v),e)}return l.type=a,l.itemType="node",s[a]=l,l},c.registerEdge=function(a,e,i){var s=c.Edge,l=i?s.getShape(i):Er,f=(0,O.__assign)((0,O.__assign)({},l),e);return f.type=a,f.itemType="edge",s[a]=f,f},c.registerCombo=function(a,e,i){var s=c.Combo,l=i?s.getShape(i):Er,f=(0,O.__assign)((0,O.__assign)({},l),e);return f.type=a,f.itemType="combo",s[a]=f,f},c}(),Gr=oa;oa.registerFactory("node",{defaultShapeType:"circle"}),oa.registerFactory("edge",{defaultShapeType:"line"}),oa.registerFactory("combo",{defaultShapeType:"circle"});var wa="bboxCache",va="bboxCanvasCache",Ua=null,Ja=function(){function c(a){this._cfg={},this.destroyed=!1,this.optimize=!1;var e={id:void 0,type:"item",model:{},group:void 0,animate:!1,visible:!0,locked:!1,event:!0,keyShape:void 0,states:[]};this._cfg=Object.assign(e,this.getDefaultCfg(),a);var i=this.get("model"),s=i.id,l=this.get("type");typeof s=="undefined"?s=S(l):typeof s!="string"&&(s=String(s)),this.get("model").id=s,this.set("id",s);var f=a.group;f&&(f.set("item",this),f.set("id",s)),this.init(),this.draw();var d=i.shape||i.type||(l==="edge"?"line":"circle"),v=this.get("shapeFactory");if(v&&v[d]){var w=v[d].options;if(w&&w.stateStyles){var E=this.get("styles")||i.stateStyles;E=(0,_.deepMix)({},w.stateStyles,E),this.set("styles",E)}}}return c.prototype.calculateBBox=function(){var a=this.get("keyShape"),e=this.get("group"),i=Ba(a,e);return i.x=i.minX,i.y=i.minY,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i.centerX=(i.minX+i.maxX)/2,i.centerY=(i.minY+i.maxY)/2,i},c.prototype.calculateCanvasBBox=function(){var a=this.get("keyShape"),e=this.get("group"),i=Ba(a,e);return i.x=i.minX,i.y=i.minY,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i.centerX=(i.minX+i.maxX)/2,i.centerY=(i.minY+i.maxY)/2,i},c.prototype.drawInner=function(){var a=this,e=a.get("shapeFactory"),i=a.get("group"),s=a.get("model");i.clear();var l=s.visible;if(l!==void 0&&!l&&a.changeVisibility(l),!!e){a.updatePosition(s);var f=a.getShapeCfg(s),d=f.type,v=e.draw(d,f,i);v&&(a.set("keyShape",v),v.set("isKeyShape",!0),v.set("draggable",!0)),this.setOriginStyle(),this.set("currentShape",d),this.restoreStates(e,d)}},c.prototype.setOriginStyle=function(){var a=this.get("group"),e=a.get("children"),i=this.getKeyShape(),s=this,l=i.get("name");if(this.get("originStyle")){var U=this.get("originStyle");l&&!U[l]&&(U[l]={});for(var et=this.getCurrentStatesStyle(),ct=function(Mt){var Dt=e[Mt],zt=Dt.get("name"),Qt=Dt.attr();if(zt&&zt!==l){var Ie=et[zt];U[zt]||(U[zt]={}),Ie?Object.keys(Qt).forEach(function(mn){var $n=Qt[mn];$n!==Ie[mn]&&(U[zt][mn]=$n)}):U[zt]=Dt.get("type")!=="image"?(0,_.clone)(Qt):s.getShapeStyleByName(zt)}else{var je=Dt.attr(),ze={};Object.keys(et).forEach(function(mn){var $n=et[mn];(mn===l||!(0,_.isPlainObject)($n))&&(ze[mn]=$n)}),Object.keys(je).forEach(function(mn){var $n=je[mn];ze[mn]!==$n&&(l?U[l][mn]=$n:U[mn]=$n)})}},d=0;d<e.length;d++)ct(d);delete U.path,delete U.matrix,delete U.x,delete U.y,U[l]&&(delete U[l].x,delete U[l].y,delete U[l].matrix,delete U[l].path),s.set("originStyle",U)}else{for(var f={},d=0;d<e.length;d++){var v=e[d],w=v.get("type"),E=v.get("name");if(E&&E!==l)f[E]=w!=="image"?(0,_.clone)(v.attr()):s.getShapeStyleByName(E),w==="text"&&f[E]&&(delete f[E].x,delete f[E].y,delete f[E].matrix);else{var T=s.getShapeStyleByName();if(delete T.path,delete T.matrix,!l)Object.assign(f,T);else if(E)f[l]=T;else{var G=S("shape");v.set("name",G),a.shapeMap[G]=v,f[G]=w!=="image"?(0,_.clone)(v.attr()):s.getShapeStyleByName(E)}}}s.set("originStyle",f)}},c.prototype.restoreStates=function(a,e){var i=this,s=i.get("states");(0,_.each)(s,function(l){a.setState(e,l,!0,i)})},c.prototype.init=function(){var a=Gr.getFactory(this.get("type"));this.set("shapeFactory",a)},c.prototype.get=function(a){return this._cfg[a]},c.prototype.set=function(a,e){(0,_.isPlainObject)(a)?this._cfg=(0,O.__assign)((0,O.__assign)({},this._cfg),a):this._cfg[a]=e},c.prototype.getDefaultCfg=function(){return{}},c.prototype.clearCache=function(){this.set(wa,null),this.set(va,null)},c.prototype.beforeDraw=function(){},c.prototype.afterDraw=function(){},c.prototype.afterUpdate=function(){},c.prototype.draw=function(){this.beforeDraw(),this.drawInner(),this.afterDraw()},c.prototype.getShapeStyleByName=function(a){var e=this.get("group"),i;if(a?i=e.shapeMap[a]:i=this.getKeyShape(),i){var s={};return(0,_.each)(i.attr(),function(l,f){(f!=="img"||(0,_.isString)(l))&&(s[f]=l)}),s}return{}},c.prototype.getShapeCfg=function(a,e){var i=this.get("styles");if(i){var s=a;return s.style=(0,O.__assign)((0,O.__assign)({},i),a.style),s}return a},c.prototype.getStateStyle=function(a){var e=this.get("styles"),i=e&&e[a];return i},c.prototype.getOriginStyle=function(){return this.get("originStyle")},c.prototype.getCurrentStatesStyle=function(){var a=this,e={},i=a.getStates();return!i||!i.length?this.get("originStyle"):((0,_.each)(a.getStates(),function(s){e=Object.assign(e,a.getStateStyle(s))}),e)},c.prototype.setState=function(a,e){var i=this.get("states"),s=this.get("shapeFactory"),l=a,f=a;(0,_.isString)(e)&&(l="".concat(a,":").concat(e),f="".concat(a,":"));var d=i;if((0,_.isBoolean)(e)){var v=i.indexOf(f);if(e){if(v>-1)return;i.push(l)}else v>-1&&i.splice(v,1)}else if((0,_.isString)(e)){var w=i.filter(function(G){return G.includes(f)});w.length>0&&this.clearStates(w),d=d.filter(function(G){return!G.includes(f)}),d.push(l),this.set("states",d)}if(s){var E=this.get("model"),T=E.type;s.setState(T,a,e,this)}},c.prototype.clearStates=function(a){var e=this,i=e.getStates(),s=e.get("shapeFactory"),l=e.get("model"),f=l.type;a||(a=i),(0,_.isString)(a)&&(a=[a]);var d=i.filter(function(v){return a.indexOf(v)===-1});e.set("states",d),a.forEach(function(v){s.setState(f,v,!1,e)})},c.prototype.setOptimize=function(a){this.optimize=a},c.prototype.getContainer=function(){return this.get("group")},c.prototype.getKeyShape=function(){return this.get("keyShape")},c.prototype.getModel=function(){return this.get("model")},c.prototype.getType=function(){return this.get("type")},c.prototype.getID=function(){return this.get("id")},c.prototype.isItem=function(){return!0},c.prototype.getStates=function(){return this.get("states")},c.prototype.hasState=function(a){var e=this.getStates();return e.indexOf(a)>=0},c.prototype.refresh=function(a){var e=this.get("model");this.updatePosition(e),this.updateShape(a),this.afterUpdate(),this.clearCache()},c.prototype.getUpdateType=function(a){},c.prototype.update=function(a,e){e===void 0&&(e=void 0);var i=this.get("model");if(e==="move")this.updatePosition(a);else{var s=i.visible,l=a.visible;s!==l&&l!==void 0&&this.changeVisibility(l);var f={x:i.x,y:i.y};a.x=isNaN(+a.x)?i.x:+a.x,a.y=isNaN(+a.y)?i.y:+a.y;var d=this.get("styles");if(a.stateStyles){var v=a.stateStyles;(0,_.mix)(d,v),delete a.stateStyles}Object.assign(i,a),(f.x!==a.x||f.y!==a.y)&&this.updatePosition(a),this.updateShape(e)}this.afterUpdate(),this.clearCache()},c.prototype.updateShape=function(a){var e=this.get("shapeFactory"),i=this.get("model"),s=i.type;if(e.shouldUpdate(s)&&s===this.get("currentShape")){var l=this.getShapeCfg(i,a);e.baseUpdate(s,l,this,a),a!=="move"&&this.setOriginStyle()}else this.draw();this.restoreStates(e,s)},c.prototype.updatePosition=function(a){var e=this.get("model"),i=isNaN(+a.x)?+e.x:+a.x,s=isNaN(+a.y)?+e.y:+a.y,l=this.get("group");if(isNaN(i)||isNaN(s))return!1;e.x=i,e.y=s;var f=l.getMatrix();return f&&f[6]===i&&f[7]===s?!1:(l.resetMatrix(),xo(l,{x:i,y:s}),this.clearCache(),!0)},c.prototype.getBBox=function(){var a=this.get(wa);return a||(a=this.calculateBBox(),this.set(wa,a)),a},c.prototype.getCanvasBBox=function(){var a=this.get(va);return a||(a=this.calculateCanvasBBox(),this.set(va,a)),a},c.prototype.toFront=function(){var a=this.get("group");a.toFront()},c.prototype.toBack=function(){var a=this.get("group");a.toBack()},c.prototype.show=function(){this.changeVisibility(!0)},c.prototype.hide=function(){this.changeVisibility(!1)},c.prototype.changeVisibility=function(a){var e=this.get("group");a?e.show():e.hide(),this.set("visible",a)},c.prototype.isVisible=function(){return this.get("visible")},c.prototype.enableCapture=function(a){var e=this.get("group");e&&e.set("capture",a)},c.prototype.destroy=function(){if(!this.destroyed){var a=this.get("animate"),e=this.get("group");a&&e.stopAnimate(),e.shapeMap={},this.clearCache(),e.remove(),this._cfg=null,this.destroyed=!0}},c}(),Li=Ja,Zi={source:"start",target:"end"},Oi="Node",li="Point",ti="Anchor",ao=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultCfg=function(){return{type:"edge",sourceNode:null,targetNode:null,startPoint:null,endPoint:null,linkCenter:!1}},a.prototype.setEnd=function(e,i){var s=Zi[e]+li,l=e+Oi,f=this.get(l);f&&!f.destroyed&&f.removeEdge(this),(0,_.isPlainObject)(i)?(this.set(s,i),this.set(l,null)):i&&(i.addEdge(this),this.set(l,i),this.set(s,null))},a.prototype.getLinkPoint=function(e,i,s){var l=Zi[e]+li,f=e+Oi,d=this.get(l);if(!d){var v=this.get(f),w=e+ti,E=this.getPrePoint(e,s),T=i[w];(0,_.isNil)(T)||(d=v.getLinkPointByAnchor(T)),d=d||v.getLinkPoint(E),(0,_.isNil)(d.index)||this.set("".concat(e,"AnchorIndex"),d.index)}return d},a.prototype.getPrePoint=function(e,i){if(i&&i.length){var s=e==="source"?0:i.length-1;return i[s]}var l=e==="source"?"target":"source";return this.getEndPoint(l)},a.prototype.getEndPoint=function(e){var i=e+Oi,s=Zi[e]+li,l=this.get(i);return l&&!l.destroyed?l.get("model"):this.get(s)},a.prototype.getControlPointsByCenter=function(e){var i=this.getEndPoint("source"),s=this.getEndPoint("target"),l=this.get("shapeFactory"),f=e.type;return l.getControlPoints(f,{startPoint:i,endPoint:s})},a.prototype.getEndCenter=function(e){var i=e+Oi,s=Zi[e]+li,l=this.get(i);if(l){var f=l.getBBox();return{x:f.centerX,y:f.centerY}}return this.get(s)},a.prototype.init=function(){c.prototype.init.call(this),this.setSource(this.get("source")),this.setTarget(this.get("target"))},a.prototype.getShapeCfg=function(e,i){var s=this,l=s.get("linkCenter"),f=(i==null?void 0:i.includes("move"))?e:c.prototype.getShapeCfg.call(this,e);if(l)f.startPoint=s.getEndCenter("source"),f.endPoint=s.getEndCenter("target");else{var d=f.controlPoints||s.getControlPointsByCenter(f);f.startPoint=s.getLinkPoint("source",e,d),f.endPoint=s.getLinkPoint("target",e,d)}return f.sourceNode=s.get("sourceNode"),f.targetNode=s.get("targetNode"),f},a.prototype.getModel=function(){var e=this.get("model"),i=this.get("source".concat(Oi)),s=this.get("target".concat(Oi));return i?delete e["source".concat(Oi)]:e.source=this.get("start".concat(li)),s?delete e["target".concat(Oi)]:e.target=this.get("end".concat(li)),!(0,_.isString)(e.source)&&!(0,_.isPlainObject)(e.source)&&(e.source=e.source.getID()),!(0,_.isString)(e.target)&&!(0,_.isPlainObject)(e.target)&&(e.target=e.target.getID()),e},a.prototype.setSource=function(e){this.setEnd("source",e),this.set("source",e)},a.prototype.setTarget=function(e){this.setEnd("target",e),this.set("target",e)},a.prototype.getSource=function(){return this.get("source")},a.prototype.getTarget=function(){return this.get("target")},a.prototype.updatePosition=function(){return!1},a.prototype.update=function(e,i){i===void 0&&(i=void 0);var s=this.get("model"),l=s.visible,f=e.visible;l!==f&&f!==void 0&&this.changeVisibility(f);var d=this.get("source"),v=this.get("target");if(!(!d||d.destroyed||!v||v.destroyed)){var w=this.get("styles");if(e.stateStyles){var E=e.stateStyles;(0,_.mix)(w,E),delete e.stateStyles}Object.assign(s,e),this.updateShape(i),this.afterUpdate(),this.clearCache()}},a.prototype.destroy=function(){var e=this.get("source".concat(Oi)),i=this.get("target".concat(Oi));e&&!e.destroyed&&e.removeEdge(this),i&&!i.destroyed&&i.removeEdge(this),c.prototype.destroy.call(this)},a}(Li),$o=ao,Oo="anchorPointsCache",Ss="bboxCache",mo=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getNearestPoint=function(e,i){for(var s=0,l=e[0],f=Ra(e[0],i),d=0;d<e.length;d++){var v=e[d],w=Ra(v,i);w<f&&(l=v,f=w,s=d)}return l.anchorIndex=s,l},a.prototype.getDefaultCfg=function(){return{type:"node",edges:[]}},a.prototype.getEdges=function(){return this.get("edges")},a.prototype.getInEdges=function(){var e=this;return this.get("edges").filter(function(i){return i.get("target")===e})},a.prototype.getOutEdges=function(){var e=this;return this.get("edges").filter(function(i){return i.get("source")===e})},a.prototype.getNeighbors=function(e){var i=this,s=this.get("edges");if(e==="target"){var l=function(w){return w.getSource()===i};return s.filter(l).map(function(v){return v.getTarget()})}if(e==="source"){var f=function(w){return w.getTarget()===i};return s.filter(f).map(function(v){return v.getSource()})}var d=function(w){return w.getSource()===i?w.getTarget():w.getSource()};return s.map(d)},a.prototype.getLinkPointByAnchor=function(e){var i=this.getAnchorPoints();return i[e]},a.prototype.getLinkPoint=function(e){var i=this.get("keyShape"),s=i.get("type"),l=this.get("type"),f,d,v=this.getBBox();l==="combo"?(f=v.centerX||(v.maxX+v.minX)/2,d=v.centerY||(v.maxY+v.minY)/2):(f=v.centerX,d=v.centerY);var w=this.getAnchorPoints(),E;switch(s){case"circle":E=eu({x:f,y:d,r:v.width/2},e);break;case"ellipse":E=Zu({x:f,y:d,rx:v.width/2,ry:v.height/2},e);break;default:E=tu(v,e)}var T=E;return w.length&&(T||(T=e),T=this.getNearestPoint(w,T)),T||(T={x:f,y:d}),T},a.prototype.getAnchorPoints=function(){var e=this.get(Oo);if(!e){e=[];var i=this.get("shapeFactory"),s=this.getBBox(),l=this.get("model"),f=this.getShapeCfg(l),d=l.type,v=i.getAnchorPoints(d,f)||[];(0,_.each)(v,function(w,E){var T={x:s.minX+w[0]*s.width,y:s.minY+w[1]*s.height,anchorIndex:E};e.push(T)}),this.set(Oo,e)}return e},a.prototype.addEdge=function(e){this.get("edges").push(e)},a.prototype.lock=function(){this.set("locked",!0)},a.prototype.unlock=function(){this.set("locked",!1)},a.prototype.hasLocked=function(){return this.get("locked")},a.prototype.removeEdge=function(e){var i=this.getEdges(),s=i.indexOf(e);s>-1&&i.splice(s,1)},a.prototype.clearCache=function(){this.set(Ss,null),this.set(Oo,null)},a.prototype.getUpdateType=function(e){var i,s,l,f,d;if(!!e){var v=!(0,_.isNil)(e.x),w=!(0,_.isNil)(e.y),E=Object.keys(e);if(E.length===1&&(v||w)||E.length===2&&v&&w)return"move";if((0,_.isNumber)(e.x)||(0,_.isNumber)(e.y)||e.type||e.anchorPoints||e.size||(e==null?void 0:e.style)&&(((i=e==null?void 0:e.style)===null||i===void 0?void 0:i.r)||((s=e==null?void 0:e.style)===null||s===void 0?void 0:s.width)||((l=e==null?void 0:e.style)===null||l===void 0?void 0:l.height)||((f=e==null?void 0:e.style)===null||f===void 0?void 0:f.rx)||((d=e==null?void 0:e.style)===null||d===void 0?void 0:d.ry)))return"bbox|label";var T=E.includes("label")||E.includes("labelCfg");return T?"style|label":"style"}},a.prototype.setState=function(e,i){var s=this;if(this.optimize){c.prototype.setState.call(this,e,i);return}this.runWithBBoxAffected(function(){return c.prototype.setState.call(s,e,i)})},a.prototype.clearStates=function(e){var i=this;if(this.optimize){c.prototype.clearStates.call(this,e);return}this.runWithBBoxAffected(function(){return c.prototype.clearStates.call(i,e)})},a.prototype.runWithBBoxAffected=function(e){var i=["r","width","height","rx","ry","lineWidth"],s=this.getKeyShape().attr(),l={};Object.keys(this.getKeyShape().attr()).forEach(function(w){i.includes(w)&&(l[w]=s[w])}),e();for(var f=this.getKeyShape().attr(),d=0;d<i.length;d++){var v=i[d];if(f[v]!==l[v]){this.clearCache(),this.getEdges().forEach(function(w){return w.refresh()});break}}},a}(Li),So=mo,fs="bboxCache",As="bboxCanvasCache",qs="sizeCache",Ko="anchorPointsCache",Ho=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultCfg=function(){return{type:"combo",nodes:[],edges:[],combos:[]}},a.prototype.getShapeCfg=function(e){var i=this.get("styles"),s=this.get("bbox");if(i&&s){var l=e,f=(0,_.isNumber)(e.size)?[e.size,e.size]:e.size,d=(0,_.isNumber)(e.fixSize)?[e.fixSize,e.fixSize]:e.fixSize,v=f||d||Ae.defaultCombo.size,w={r:(Math.max(s.width,s.height)||Math.max(v[0],v[1]))/2,width:s.width||v[0],height:s.height||v[1]};l.style=(0,O.__assign)((0,O.__assign)((0,O.__assign)({},i),e.style),w);var E=e.padding||Ae.defaultCombo.padding;return(0,_.isNumber)(E)?(w.r+=E,w.width+=E*2,w.height+=E*2):(w.r=w.r+Math.max.apply(Math,E),w.width+=E[1]+E[3]||E[1]*2,w.height+=E[0]+E[2]||E[0]*2),this.set(qs,w),l}return e},a.prototype.calculateCanvasBBox=function(){if(!this.destroyed){var e=this.get("keyShape"),i=this.get("group"),s=Ba(e,i);s.centerX=(s.minX+s.maxX)/2,s.centerY=(s.minY+s.maxY)/2;var l=this.get(fs)||{},f=l.x,d=l.x;return s.width=s.maxX-s.minX,s.height=s.maxY-s.minY,s.centerX=(s.minX+s.maxX)/2,s.centerY=(s.minY+s.maxY)/2,s.x=s.minX,s.y=s.minY,(s.x!==f||s.y!==d)&&this.set(Ko,null),s}},a.prototype.getChildren=function(){var e=this;return{nodes:e.getNodes(),combos:e.getCombos()}},a.prototype.getNodes=function(){var e=this;return e.get("nodes")},a.prototype.getCombos=function(){var e=this;return e.get("combos")},a.prototype.addChild=function(e){var i=this,s=e.getType();switch(s){case"node":i.addNode(e);break;case"combo":i.addCombo(e);break;default:return console.warn("Only node or combo items are allowed to be added into a combo"),!1}return!0},a.prototype.addCombo=function(e){var i=this;return i.get("combos").push(e),!0},a.prototype.addNode=function(e){var i=this;return i.get("nodes").push(e),!0},a.prototype.removeChild=function(e){var i=this,s=e.getType();switch(s){case"node":i.removeNode(e);break;case"combo":i.removeCombo(e);break;default:return console.warn("Only node or combo items are allowed to be added into a combo"),!1}return!0},a.prototype.removeCombo=function(e){if(!!e){var i=this.getCombos(),s=i.indexOf(e);return s>-1?(i.splice(s,1),!0):!1}},a.prototype.removeNode=function(e){if(!!e){var i=this.getNodes(),s=i.indexOf(e);return s>-1?(i.splice(s,1),!0):!1}},a.prototype.getUpdateType=function(e){},a.prototype.getBBox=function(){this.set(As,null);var e=this.calculateCanvasBBox();return e},a.prototype.clearCache=function(){this.set(fs,null),this.set(As,null),this.set(Ko,null)},a.prototype.destroy=function(){if(!this.destroyed){var e=this.get("animate"),i=this.get("group");e&&i.stopAnimate(),i.shapeMap={},this.clearCache(),this.set(qs,null),this.set("bbox",null),i.remove(),this._cfg=null,this.destroyed=!0}},a}(So),Cu=Ho,Xs="node",jl="edge",_u="vedge",hu="combo",yl="default",du="Mapper",Us="stateStyles",Pu=function(){function c(a){var e=this;this.edgeToBeUpdateMap={},this.throttleRefresh=(0,_.throttle)(function(i){var s=e.graph;if(!(!s||s.get("destroyed"))){var l=e.edgeToBeUpdateMap;if(!!l){var f=Object.values(l);!f.length||(f.forEach(function(d){var v=d.edge;if(!(!v||v.destroyed)){var w=v.getSource(),E=v.getTarget();!w||w.destroyed||!E||E.destroyed||v.refresh(d.updateType)}}),e.edgeToBeUpdateMap={})}}},16,{trailing:!0,leading:!0}),this.graph=a,this.destroyed=!1}return c.prototype.addItem=function(a,e){var i=this.graph,s=a===_u?jl:a,l=i.get("".concat(s,"Group"))||i.get("group"),f=(0,_.upperFirst)(s),d=null,v=i.get(s+(0,_.upperFirst)(Us))||{},w=i.get(yl+f);e[Us]&&(v=e[Us]),w&&(0,_.each)(w,function(je,ze){(0,_.isObject)(je)&&!(0,_.isArray)(je)?e[ze]=(0,_.deepMix)({},je,e[ze]):(0,_.isArray)(je)?e[ze]=e[ze]||(0,_.clone)(w[ze]):e[ze]=e[ze]||w[ze]});var E=i.get(s+du);if(E){var T=E(e);T[Us]&&(v=T[Us],delete T[Us]),(0,_.each)(T,function(je,ze){(0,_.isObject)(je)&&!(0,_.isArray)(je)?e[ze]=(0,_.deepMix)({},e[ze],je):e[ze]=T[ze]||e[ze]})}if(i.emit("beforeadditem",{type:a,model:e}),a===jl||a===_u){var G=void 0,U=void 0;if(G=e.source,U=e.target,G&&(0,_.isString)(G)&&(G=i.findById(G)),U&&(0,_.isString)(U)&&(U=i.findById(U)),!G||!U){console.warn("The source or target node of edge ".concat(e.id," does not exist!"));return}G.getType&&G.getType()==="combo"&&(e.isComboEdge=!0),U.getType&&U.getType()==="combo"&&(e.isComboEdge=!0),d=new $o({model:e,source:G,target:U,styles:v,linkCenter:i.get("linkCenter"),group:l.addGroup()})}else if(a===Xs)d=new So({model:e,styles:v,group:l.addGroup()});else if(a===hu){var et=e.children,ct=Hs(et,i),Ct=void 0,Mt=void 0;if(isNaN(ct.x)?isNaN(e.x)&&(Ct=Math.random()*100):Ct=ct.x,isNaN(ct.y)?isNaN(e.y)&&(Mt=Math.random()*100):Mt=ct.y,isNaN(e.x)||isNaN(e.y))e.x=Ct,e.y=Mt;else{var Dt=e.x-Ct,zt=e.y-Mt;this.updateComboSucceeds(e.id,Dt,zt,et)}var Qt=l.addGroup();Qt.setZIndex(e.depth),d=new Cu({model:e,styles:v,animate:i.get("animate"),bbox:e.collapsed?Hs([],i):ct,group:Qt}),!e.collapsed&&d.getKeyShape().get("type")==="circle"&&(ct.width=Math.hypot(ct.height,ct.width),ct.height=ct.width,d.set("bbox",ct),d.refresh());var Ie=d.getModel();(et||[]).forEach(function(je){var ze=i.findById(je.id);d.addChild(ze),je.depth=Ie.depth+2})}if(d)return d.setOptimize(i.getNodes().length>i.get("optimizeThreshold")),i.get("".concat(a,"s")).push(d),i.get("itemMap")[d.get("id")]=d,i.emit("afteradditem",{item:d,model:e}),d},c.prototype.updateItem=function(a,e){var i=this,s,l,f=this.graph;if((0,_.isString)(a)&&(a=f.findById(a)),!(!a||a.destroyed)){var d="";a.getType&&(d=a.getType());var v=f.get(d+du),w=a.getModel(),E=w.x,T=w.y,G=a.getUpdateType(e);if(v){var U=(0,_.deepMix)({},w,e),et=v(U),ct=(0,_.deepMix)({},w,et,e);et[Us]&&(a.set("styles",ct[Us]),delete ct[Us]),(0,_.each)(ct,function(Tn,or){e[or]=Tn})}else(0,_.each)(e,function(Tn,or){w[or]&&(0,_.isObject)(Tn)&&!(0,_.isArray)(Tn)&&(e[or]=(0,O.__assign)((0,O.__assign)({},w[or]),e[or]))});if(f.emit("beforeupdateitem",{item:a,cfg:e}),d===jl){if(e.source){var Ct=e.source;(0,_.isString)(Ct)&&(Ct=f.findById(Ct)),a.setSource(Ct)}if(e.target){var Mt=e.target;(0,_.isString)(Mt)&&(Mt=f.findById(Mt)),a.setTarget(Mt)}a.update(e)}else if(d===Xs){a.update(e,G);var Dt=a.getEdges();G==="move"?(0,_.each)(Dt,function(Tn){i.edgeToBeUpdateMap[Tn.getID()]={edge:Tn,updateType:G},i.throttleRefresh()}):(G==null?void 0:G.includes("bbox"))&&(0,_.each)(Dt,function(Tn){Tn.refresh(G)})}else if(d===hu){if(a.update(e,G),!isNaN(e.x)||!isNaN(e.y)){var zt=e.x-E||0,Qt=e.y-T||0;this.updateComboSucceeds(w.id,zt,Qt)}var Ie=a.getEdges(),je=(G==null?void 0:G.includes("bbox"))||G==="move";if(je&&d===hu){var ze=a.get("shapeFactory"),mn=w.type||"circle",$n=w.animate===void 0||e.animate===void 0?(l=(s=ze[mn])===null||s===void 0?void 0:s.options)===null||l===void 0?void 0:l.animate:w.animate||e.animate;$n?setTimeout(function(){if(!(!a||a.destroyed)){var Tn=a.getKeyShape();!Tn||Tn.destroyed||(0,_.each)(Ie,function(or){or&&!or.destroyed&&or.refresh()})}},201):(0,_.each)(Ie,function(Tn){Tn.refresh()})}}a.setOptimize(f.getNodes().length>f.get("optimizeThreshold")),f.emit("afterupdateitem",{item:a,cfg:e})}},c.prototype.updateCombo=function(a,e,i){var s=this,l,f,d=this.graph;if((0,_.isString)(a)&&(a=d.findById(a)),!(!a||a.destroyed)){var v=a.getModel(),w=Hs(e,d,a),E=w.x,T=w.y;a.set("bbox",w);var G=E,U=T;i?(G=isNaN(v.x)?E:v.x,U=isNaN(v.y)?T:v.y):(G=isNaN(E)?v.x:E,U=isNaN(T)?v.y:T),a.update({x:G,y:U});var et=a.get("shapeFactory"),ct=v.type||"circle",Ct=v.animate===void 0?(f=(l=et[ct])===null||l===void 0?void 0:l.options)===null||f===void 0?void 0:f.animate:v.animate;Ct?setTimeout(function(){if(!(!a||a.destroyed)){var Mt=a.getKeyShape();!Mt||Mt.destroyed||(a.getShapeCfg(v),s.updateComboEdges(a))}},201):this.updateComboEdges(a)}},c.prototype.updateComboEdges=function(a){for(var e,i,s=a.getEdges()||[],l=0;l<s.length;l++){var f=s[l];!(f==null?void 0:f.destroyed)&&!((e=f==null?void 0:f.getSource())===null||e===void 0?void 0:e.destroyed)&&!((i=f==null?void 0:f.getTarget())===null||i===void 0?void 0:i.destroyed)&&f.refresh()}},c.prototype.collapseCombo=function(a,e){e===void 0&&(e=!0);var i=this.graph;(0,_.isString)(a)&&(a=i.findById(a));var s=a.getChildren();s.nodes.forEach(function(l){i.hideItem(l,e)}),s.combos.forEach(function(l){i.hideItem(l,e)})},c.prototype.updateComboSucceeds=function(a,e,i,s){var l=this;s===void 0&&(s=[]);var f=this.graph;if(!(!e&&!i)){var d=s;if(!(d==null?void 0:d.length)){var v=f.get("comboTrees");v==null||v.forEach(function(w){_o(w,function(E){return E.id===a?(d=E.children,!1):!0})})}d==null||d.forEach(function(w){var E=f.findById(w.id);if(E){var T=E.getModel();l.updateItem(w.id,{x:(T.x||0)+e,y:(T.y||0)+i})}})}},c.prototype.expandCombo=function(a,e){e===void 0&&(e=!0);var i=this.graph;(0,_.isString)(a)&&(a=i.findById(a));var s=a.getChildren(),l=new Set;s.nodes.forEach(function(f){i.showItem(f,e),f.getEdges().forEach(function(d){return l.add(d)})}),s.combos.forEach(function(f){f.getModel().collapsed?f.show():i.showItem(f,e),f.getEdges().forEach(function(d){return l.add(d)})}),l.forEach(function(f){return f.refresh()})},c.prototype.removeItem=function(a){var e=this,i=this.graph;if((0,_.isString)(a)&&(a=i.findById(a)),!(!a||a.destroyed)){var s=(0,_.clone)(a.getModel()),l="";a.getType&&(l=a.getType()),i.emit("beforeremoveitem",{item:s,type:l});var f=i.get("".concat(l,"s")),d=f.indexOf(a);if(d>-1&&f.splice(d,1),l===jl){var v=i.get("v".concat(l,"s")),w=v.indexOf(a);w>-1&&v.splice(w,1)}var E=a.get("id"),T=i.get("itemMap");delete T[E];var G=i.get("comboTrees"),U=a.get("id");if(l===Xs){var et=a.getModel().comboId;if(G&&et){var ct=G,Ct=!1;G.forEach(function(je){Ct||_o(je,function(ze){if(ze.id===U&&ct){var mn=ct.indexOf(ze);return ct.splice(mn,1),Ct=!0,!1}return ct=ze.children,!0})})}for(var Mt=a.getEdges(),Dt=Mt.length-1;Dt>=0;Dt--)i.removeItem(Mt[Dt],!1);et&&i.updateCombo(et)}else if(l===hu){var zt=a.getModel().parentId,Qt,Ie=!1;(G||[]).forEach(function(ze){Ie||_o(ze,function(mn){return mn.id===U?(Qt=mn,Ie=!0,!1):!0})}),Qt.removed=!0,Qt&&Qt.children&&Qt.children.forEach(function(ze){e.removeItem(ze.id)});for(var Mt=a.getEdges(),Dt=Mt.length;Dt>=0;Dt--)i.removeItem(Mt[Dt],!1);zt&&i.updateCombo(zt)}a.destroy(),i.emit("afterremoveitem",{item:s,type:l})}},c.prototype.setItemState=function(a,e,i){var s=this.graph,l=e;(0,_.isString)(i)&&(l="".concat(e,":").concat(i)),!(a.hasState(l)===i&&i||(0,_.isString)(i)&&a.hasState(l))&&(s.emit("beforeitemstatechange",{item:a,state:l,enabled:i}),a.setState(e,i),s.autoPaint(),s.emit("afteritemstatechange",{item:a,state:l,enabled:i}))},c.prototype.priorityState=function(a,e){var i=this.graph,s=a;(0,_.isString)(a)&&(s=i.findById(a)),this.setItemState(s,e,!1),this.setItemState(s,e,!0)},c.prototype.clearItemStates=function(a,e){var i=this.graph;(0,_.isString)(a)&&(a=i.findById(a)),i.emit("beforeitemstatesclear",{item:a,states:e}),a.clearStates(e),i.emit("afteritemstatesclear",{item:a,states:e})},c.prototype.refreshItem=function(a){var e=this.graph;(0,_.isString)(a)&&(a=e.findById(a)),e.emit("beforeitemrefresh",{item:a}),a.refresh(),e.emit("afteritemrefresh",{item:a})},c.prototype.addCombos=function(a,e){var i=this,s=this.graph;(a||[]).forEach(function(f){To(f,function(d){var v;return e.forEach(function(w){w.id===d.id&&(w.children=d.children,w.depth=d.depth,v=w)}),v&&i.addItem("combo",v),!0})});var l=s.get("comboGroup");l&&l.sort()},c.prototype.changeItemVisibility=function(a,e){var i=this,s=this.graph;if((0,_.isString)(a)&&(a=s.findById(a)),!a){console.warn("The item to be shown or hidden does not exist!");return}if(s.emit("beforeitemvisibilitychange",{item:a,visible:e}),a.changeVisibility(e),a.getType&&a.getType()===Xs){var l=a.getEdges();(0,_.each)(l,function(E){e&&!(E.get("source").isVisible()&&E.get("target").isVisible())||i.changeItemVisibility(E,e)})}else if(a.getType&&a.getType()===hu){var f=s.get("comboTrees"),d=a.get("id"),v=[],w=!1;(f||[]).forEach(function(T){w||!T.children||T.children.length===0||_o(T,function(G){return G.id===d?(v=G.children,w=!0,!1):!0})}),v&&(!e||e&&!a.getModel().collapsed)&&v.forEach(function(T){var G=s.findById(T.id);i.changeItemVisibility(G,e)});var l=a.getEdges();(0,_.each)(l,function(T){e&&!(T.get("source").isVisible()&&T.get("target").isVisible())||i.changeItemVisibility(T,e)})}return s.emit("afteritemvisibilitychange",{item:a,visible:e}),a},c.prototype.destroy=function(){this.graph=null,this.destroyed=!0},c}(),fh=Pu,ov=function(){function c(a){this.graph=a,this.destroyed=!1}return c.prototype.updateState=function(a,e,i){var s=this.graph.get("states"),l=e;(0,_.isString)(i)&&(l="".concat(e,":").concat(i)),s[l]||(s[l]=[]),i?s[l].push(a):s[l]=s[l].filter(function(f){return f!==a}),this.graph.set("states",s),this.graph.emit("graphstatechange",{states:s})},c.prototype.updateStates=function(a,e,i){var s=this.graph.get("states"),l=(0,_.isString)(e)?[e]:e;l.forEach(function(f){var d=f;s[d]||(s[d]=[]),(0,_.isString)(i)&&(d="".concat(f,":").concat(i)),i?s[d].push(a):s[d]=s[d].filter(function(v){return v!==a})}),this.graph.set("states",s),this.graph.emit("graphstatechange",{states:e})},c.prototype.destroy=function(){this.graph=null,this.destroyed=!0},c}(),lc=ov,mf=function(a,e){return!a||!e?a:a.replace(/\\?\{([^{}]+)\}/g,function(i,s){if(i.charAt(0)==="\\")return i.slice(1);var l=e[s];return l===0&&(l="0"),l||""})},Jh=function(a){var e=[];if(a.length<2)throw new Error("point length must largn than 2, now it's ".concat(a.length));for(var i=0,s=a;i<s.length;i++){var l=s[i],f=l.x,d=l.y;e.push(f),e.push(d)}var v=Wn(e);return v.unshift(["M",a[0].x,a[0].y]),v},Ip=function(a,e,i,s){i===void 0&&(i=0),s===void 0&&(s=0);var l={x:(1-i)*a.x+i*e.x,y:(1-i)*a.y+i*e.y},f=[0,0];ka.normalize(f,[e.x-a.x,e.y-a.y]),(!f||!f[0]&&!f[1])&&(f=[0,0]);var d=[-f[1]*s,f[0]*s];return l.x+=d[0],l.y+=d[1],l},Mg=function(a,e){var i=a.length;if(!i)return"";for(var s="",l="",f=0;f<i;f++){var d=a[f];f===0?l="M{x} {y}":l="L{x} {y}",s+=mf(l,d)}return e&&(s+="Z"),s},sm=function(a){var e=[];return a.forEach(function(i){var s=i[0];if(s!=="A")for(var l=1;l<i.length;l=l+2)e.push([i[l],i[l+1]]);else{var f=i.length;e.push([i[f-2],i[f-1]])}}),e},um=function(a){if(a.length<2)throw new Error("point length must largn than 2, now it's ".concat(a.length));var e=a[0],i=a[1],s=a[a.length-1],l=a[a.length-2];a.unshift(s),a.unshift(l),a.push(e),a.push(i);for(var f=[],d=1;d<a.length-2;d+=1){var v=a[d-1].x,w=a[d-1].y,E=a[d].x,T=a[d].y,G=a[d+1].x,U=a[d+1].y,et=d!==a.length-2?a[d+2].x:G,ct=d!==a.length-2?a[d+2].y:U,Ct=E+(G-v)/6,Mt=T+(U-w)/6,Dt=G-(et-E)/6,zt=U-(ct-T)/6;f.push(["C",Ct,Mt,Dt,zt,G,U])}return f.unshift(["M",s.x,s.y]),f},Ng=function(a,e){return ka.scale([0,0],ka.normalize([0,0],a),e)},ig=function(a,e){var i=[a[1]-e[1],e[0]-a[0]],s=Math.sqrt(i[0]*i[0]+i[1]*i[1]);if(s===0)throw new Error("p0 should not be equal to p1");return[i[0]/s,i[1]/s]},K0=function(a,e){return[e[0]-a[0],e[1]-a[1]]};function Qd(c,a){var e=function(T){var G=[T[0][0],T[0][1]-a],U=[T[0][0],T[0][1]+a];return"M ".concat(G," A ").concat(a,",").concat(a,",0,0,0,").concat(U," A ").concat(a,",").concat(a,",0,0,0,").concat(G)},i=function(T){var G=ka.scale([0,0],ig(T[0],T[1]),a),U=ka.scale([0,0],G,-1),et=ka.add([0,0],T[0],G),ct=ka.add([0,0],T[1],G),Ct=ka.add([0,0],T[1],U),Mt=ka.add([0,0],T[0],U);return"M ".concat(et," L ").concat(ct," A ").concat([a,a,"0,0,0",Ct].join(",")," L ").concat(Mt," A ").concat([a,a,"0,0,0",et].join(","))};if(!c||c.length<1)return"";if(c.length===1)return e(c);if(c.length===2)return i(c);for(var s=new Array(c.length),l=0;l<s.length;++l){var f=l===0?c[c.length-1]:c[l-1],d=c[l],v=ka.scale([0,0],ig(f,d),a);s[l]=[ka.add([0,0],f,v),ka.add([0,0],d,v)]}var w="A ".concat([a,a,"0,0,0,"].join(","));return s=s.map(function(E,T){var G="";return T===0&&(G="M ".concat(s[s.length-1][1]," ")),G+="".concat(w+E[0]," L ").concat(E[1]),G}),s.join(" ")}function lm(c,a){var e=c.length,i=function(E){var T=[E[0][0],E[0][1]-a],G=[E[0][0],E[0][1]+a];return"M ".concat(T," A ").concat([a,a,"0,0,0",G].join(",")," A ").concat([a,a,"0,0,0",T].join(","))},s=function(E){var T=K0(E[0],E[1]),G=Ng(T,a),U=ka.add([0,0],E[0],ka.scale([0,0],G,-1)),et=ka.add([0,0],E[1],G),ct=1.2*a,Ct=Ng(ka.normalize([0,0],T),ct),Mt=ka.scale([0,0],Ct,-1),Dt=ka.add([0,0],U,Mt),zt=ka.add([0,0],et,Mt),Qt=ka.add([0,0],U,Ct);return"M ".concat(U," C ").concat([Dt,zt,et].join(",")," S ").concat([Qt,U].join(",")," Z")};if(!c||e<1)return"";if(e===1)return i(c);if(e===2)return s(c);for(var l=c.map(function(w,E){var T=c[(E+1)%e];return{p:w,v:ka.normalize([0,0],K0(w,T))}}),f=0;f<l.length;++f){var d=f>0?f-1:e-1,v=ka.normalize([0,0],ka.add([0,0],l[d].v,ka.scale([0,0],l[f].v,-1)));l[f].p=ka.add([0,0],l[f].p,ka.scale([0,0],v,a))}return l.map(function(w){var E=w.p;return{x:E[0],y:E[1]}})}var N1=function(a,e){for(var i=[],s=0;s<5;s++){var l=Math.cos((18+72*s)/180*Math.PI)*a,f=Math.sin((18+72*s)/180*Math.PI)*a,d=Math.cos((54+72*s)/180*Math.PI)*e,v=Math.sin((54+72*s)/180*Math.PI)*e;s===0?i.push(["M",l,-f]):i.push(["L",l,-f]),i.push(["L",d,-v])}return i.push(["Z"]),i},Z0=function(a,e,i){return(a.y-i.y)*(e.x-i.x)-(a.x-i.x)*(e.y-i.y)},cm=function(a){var e=a.map(function(T){return{x:T.getModel().x,y:T.getModel().y}});e.sort(function(T,G){return T.x===G.x?T.y-G.y:T.x-G.x});for(var i={},s=e.length-1;s>=0;s--){var l=e[s],f=l.x,d=l.y;i["".concat(f,"-").concat(d)]&&e.splice(s,1),i["".concat(f,"-").concat(d)]=!0}if(e.length===1)return e;for(var v=[],s=0;s<e.length;s++){for(;v.length>=2&&Z0(v[v.length-2],v[v.length-1],e[s])<=0;)v.pop();v.push(e[s])}for(var w=[],s=e.length-1;s>=0;s--){for(;w.length>=2&&Z0(w[w.length-2],w[w.length-1],e[s])<=0;)w.pop();w.push(e[s])}w.pop(),v.pop();var E=v.concat(w);return E},jm={maxRoutingIterations:100,maxMarchingIterations:100,pixelGroupSize:2,edgeR0:10,edgeR1:10,nodeR0:5,nodeR1:10,morphBuffer:5,threshold:.001,skip:16,nodeInfluenceFactor:1,edgeInfluenceFactor:1,negativeNodeInfluenceFactor:-.5};function Hu(c,a,e){var i=!1,s=function(v,w){return a.cells[v+w*a.width]},l=function(v,w){var E=0;return s(v-1,w-1)>=e&&(E+=1),s(v,w-1)>e&&(E+=2),s(v-1,w)>e&&(E+=4),s(v,w)>e&&(E+=8),E},f=function(v,w){for(var E=v,T=w,G,U,et=0;et<a.width*a.height;et++){if(G=E,U=T,c.findIndex(function(Ct){return Ct.x===E&&Ct.y===T})>-1){if(!(c[0].x!==E||c[0].y!==T))return!0}else c.push({x:E,y:T});var ct=l(E,T);switch(ct){case-1:return console.warn("Marched out of bounds"),!0;case 0:case 3:case 2:case 7:E++;break;case 12:case 14:case 4:E--;break;case 6:G===0&&(U===-1?E-=1:E+=1);break;case 1:case 13:case 5:T--;break;case 9:G===1&&(U===0?T-=1:T+=1);break;case 10:case 8:case 11:T++;break;default:return console.warn("Marching squares invalid state: ".concat(ct)),!0}}};this.march=function(){for(var d=0;d<a.width&&!i;d+=1)for(var v=0;v<a.height&&!i;v+=1)s(d,v)>e&&l(d,v)!==15&&(i=f(d,v));return i}}var Yf=function(a,e,i){var s=Math.ceil(a/i),l=Math.ceil(e/i),f=new Float32Array(Math.max(0,s*l)).fill(0);return{cells:f,width:s,height:l}},Lf=function(a,e,i){var s=null,l=Number.POSITIVE_INFINITY;return e.forEach(function(f){var d={x:a.getModel().x,y:a.getModel().y},v={x:f.getModel().x,y:f.getModel().y},w=Au(d,v),E=new lu(d.x,d.y,v.x,v.y),T=i.reduce(function(G,U){return _s(U,E)>0?G+1:G},0);w*Math.pow(T+1,2)<l&&(s=f,l=w*Math.pow(T+1,2))}),s},Hm=function(a,e){var i=Number.POSITIVE_INFINITY,s=null;return a.forEach(function(l){var f=_s(l,e);f>=0&&f<i&&(s=l,i=f)}),s},Xm=function(a,e,i,s){var l=[],f=[];f.push(a);for(var d=!0,v=0,w=function(U,et){var ct=!1;return et.forEach(function(Ct){ct||(nu(U,{x:Ct.x1,y:Ct.y1})||nu(U,{x:Ct.x2,y:Ct.y2}))&&(ct=!0)}),ct},E=function(U,et){for(var ct=0,Ct=et;ct<Ct.length;ct++){var Mt=Ct[ct],Dt=Mt.getBBox(),zt=[[Dt.x,Dt.y],[Dt.x+Dt.width,Dt.y],[Dt.x,Dt.y+Dt.height],[Dt.x+Dt.width,Dt.y+Dt.height]];if(dl(zt,U.x,U.y))return!0}return!1};d&&v<i;){d=!1;for(var T=function(){var U=f.pop(),et=Hm(e,U);if(et){var ct=ns(et,U),Ct=ct[0],Mt=ct[1];if(Mt===2){var Dt=function(Qt){for(var Ie=s,je=Ox(et,Ie,Ct,Qt),ze=w(je,f)||w(je,l),mn=E(je,e);!ze&&mn&&Ie>=1;)Ie/=1.5,je=Ox(et,Ie,Ct,Qt),ze=w(je,f)||w(je,l),mn=E(je,e);je&&!ze&&(!Qt||!mn)&&(f.push(new lu(U.x1,U.y1,je.x,je.y)),f.push(new lu(je.x,je.y,U.x2,U.y2)),d=!0)};Dt(!0),d||Dt(!1)}}d||l.push(U),v+=1};!d&&f.length;)T()}for(;f.length;)l.push(f.pop());return l};function Ym(c,a,e,i,s){var l=Lf(c,e,a);if(l===null)return[];var f=function(T){for(var G=[];T.length>0;){var U=T.pop();if(T.length===0){G.push(U);break}var et=T.pop(),ct=new lu(U.x1,U.y1,et.x2,et.y2),Ct=Hm(a,ct);Ct?(G.push(U),T.push(et)):T.push(ct)}return G},d=new lu(c.getModel().x,c.getModel().y,l.getModel().x,l.getModel().y),v=Xm(d,a,i,s),w=f(v);return w}var Dx=function(a,e,i){var s=Object.assign(jm,i),l=Bu(a.map(function(Dt){return{x:Dt.getModel().x,y:Dt.getModel().y}}));a=a.sort(function(Dt,zt){return Au({x:Dt.getModel().x,y:Dt.getModel().y},l)-Au({x:zt.getModel().x,y:zt.getModel().y},l)});var f=[],d=[];a.forEach(function(Dt){var zt=Ym(Dt,e,f,s.maxRoutingIterations,s.morphBuffer);zt.forEach(function(Qt){d.push(Qt)}),f.push(Dt)});for(var v=xS(a,d,s.nodeR0),w=Yf(v.width,v.height,s.pixelGroupSize),E=[],T=[],G=0;G<s.maxMarchingIterations;G++)if(fm(a,e,d,v,w,s),E=[],T=[],!!new Hu(E,w,s.threshold).march()){var U=E.map(function(Dt){return{x:Math.round(Dt.x*s.pixelGroupSize+v.minX),y:Math.round(Dt.y*s.pixelGroupSize+v.minY)}});if(U){var et=U.length;if(s.skip>1)for(et=Math.floor(U.length/s.skip);et<3&&s.skip>1;)s.skip-=1,et=Math.floor(U.length/s.skip);for(var ct=0,Ct=0;Ct<et;Ct+=1,ct+=s.skip)T.push({x:U[ct].x,y:U[ct].y})}var Mt=function(){for(var zt=0,Qt=a;zt<Qt.length;zt++){var Ie=Qt[zt],je=T.map(function(ze){return[ze.x,ze.y]});if(!dl(je,Ie.getBBox().centerX,Ie.getBBox().centerY))return!1}return!0};if(T&&Mt())return T;if(s.threshold*=.9,G<=s.maxMarchingIterations*.5)s.memberInfluenceFactor*=1.2,s.edgeInfluenceFactor*=1.2;else if(s.nonMemberInfluenceFactor!==0&&e.length>0)s.nonMemberInfluenceFactor*=.8;else break}return T};function xS(c,a,e){var i={minX:Number.POSITIVE_INFINITY,minY:Number.POSITIVE_INFINITY,maxX:Number.NEGATIVE_INFINITY,maxY:Number.NEGATIVE_INFINITY,width:0,height:0,x:0,y:0},s=[];c.forEach(function(v){s.push(v.getBBox())}),a.forEach(function(v){s.push(v.getBBox())});for(var l=0,f=s;l<f.length;l++){var d=f[l];i.minX=(d.minX<i.minX?d.minX:i.minX)-e,i.minY=(d.minY<i.minY?d.minY:i.minY)-e,i.maxX=(d.maxX>i.maxX?d.maxX:i.maxX)+e,i.maxY=(d.maxY>i.maxY?d.maxY:i.maxY)+e}return i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i.x=i.minX,i.y=i.minY,i}function fm(c,a,e,i,s,l){function f(U,et){var ct=Math.floor((U-et)/l.pixelGroupSize);return ct<0?0:ct}function d(U,et){return U*l.pixelGroupSize+et}var v=(l.nodeR0-l.nodeR1)*(l.nodeR0-l.nodeR1),w=(l.edgeR0-l.edgeR1)*(l.edgeR0-l.edgeR1),E=function(et,ct){var Ct=Math.min(f(et.minX,ct+i.minX),s.width),Mt=Math.min(f(et.minY,ct+i.minY),s.height),Dt=Math.min(f(et.maxX,-ct+i.minX),s.width),zt=Math.min(f(et.maxY,-ct+i.minY),s.height);return[Ct,Mt,Dt,zt]},T=function(et,ct){for(var Ct=et.getBBox(),Mt=E(Ct,l.nodeR1),Dt=Mt[0],zt=Mt[1],Qt=Mt[2],Ie=Mt[3],je=zt;je<Ie;je+=1)for(var ze=Dt;ze<Qt;ze+=1)if(!(ct<0&&s[ze+je*s.width]<=0)){var mn=d(ze,i.minX),$n=d(je,i.minY),Tn=Tl({x:mn,y:$n},{x:Ct.minX,y:Ct.minY,width:Ct.width,height:Ct.height});if(Tn<Math.pow(l.nodeR1,2)){var or=Math.sqrt(Tn)-l.nodeR1;s.cells[ze+je*s.width]+=ct*or*or}}},G=function(et,ct){for(var Ct=et.getBBox(),Mt=E(Ct,l.edgeR1),Dt=Mt[0],zt=Mt[1],Qt=Mt[2],Ie=Mt[3],je=zt;je<Ie;je+=1)for(var ze=Dt;ze<Qt;ze+=1)if(!(ct<0&&s.cells[ze+je*s.width]<=0)){var mn=d(ze,i.minX),$n=d(je,i.minY),Tn=wu({x:mn,y:$n},et);if(Tn<Math.pow(l.edgeR1,2)){var or=Math.sqrt(Tn)-l.edgeR1;s.cells[ze+je*s.width]+=ct*or*or}}};l.nodeInfluenceFactor&&c.forEach(function(U){T(U,l.nodeInfluenceFactor/v)}),l.edgeInfluenceFactor&&e.forEach(function(U){G(U,l.edgeInfluenceFactor/w)}),l.negativeNodeInfluenceFactor&&a.forEach(function(U){T(U,l.negativeNodeInfluenceFactor/v)})}function Ox(c,a,e,i){var s=c.getBBox(),l=e[0],f=e[1],d=e[2],v=e[3],w={topLeft:{x:s.minX-a,y:s.minY-a},topRight:{x:s.maxX+a,y:s.minY-a},bottomLeft:{x:s.minX-a,y:s.maxY+a},bottomRight:{x:s.maxX+a,y:s.maxY+a}},E=s.height*s.width;function T(et,ct){return s.width*((et.y-s.minY+(ct.y-s.minY))*.5)}if(f){if(l)return i?w.topLeft:w.bottomRight;if(d)return i?w.bottomLeft:w.topRight;var G=T(f,v);return G<E*.5?f.y>v.y?i?w.topLeft:w.bottomRight:i?w.topRight:w.bottomLeft:f.y<v.y?i?w.bottomLeft:w.topRight:i?w.bottomRight:w.topLeft}if(v){if(l)return i?w.topRight:w.bottomLeft;if(d)return i?w.bottomRight:w.topLeft}var U=T(l,d);return U<E*.5?l.x>d.x?i?w.topLeft:w.bottomRight:i?w.bottomLeft:w.topRight:l.x<d.x?i?w.topRight:w.bottomLeft:i?w.bottomRight:w.topLeft}var k1=function(){function c(a,e){this.cfg=(0,_.deepMix)(this.getDefaultCfg(),e),this.graph=a,this.id=this.cfg.id,this.group=this.cfg.group,this.members=this.cfg.members.map(function(i){return(0,_.isString)(i)?a.findById(i):i}),this.nonMembers=this.cfg.nonMembers.map(function(i){return(0,_.isString)(i)?a.findById(i):i}),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()}return c.prototype.getDefaultCfg=function(){return{id:"g6-hull",type:"round-convex",members:[],nonMembers:[],style:{fill:"lightblue",stroke:"blue",opacity:.2},padding:10}},c.prototype.setPadding=function(){var a=this.members.length&&this.members[0].getKeyShape().getCanvasBBox().width/2;this.padding=this.cfg.padding>0?this.cfg.padding+a:10+a,this.cfg.bubbleCfg={nodeR0:this.padding-a,nodeR1:this.padding-a,morphBuffer:this.padding-a}},c.prototype.setType=function(){this.type=this.cfg.type,this.members.length<3&&(this.type="round-convex"),this.type!=="round-convex"&&this.type!=="smooth-convex"&&this.type!=="bubble"&&(console.warn("The hull type should be either round-convex, smooth-convex or bubble, round-convex is used by default."),this.type="round-convex")},c.prototype.calcPath=function(a,e){var i,s,l;switch(this.type){case"round-convex":i=cm(a),l=Qd(i.map(function(f){return[f.x,f.y]}),this.padding),s=fr(l);break;case"smooth-convex":i=cm(a),i.length===2?(l=Qd(i.map(function(f){return[f.x,f.y]}),this.padding),s=fr(l)):i.length>2&&(l=lm(i.map(function(f){return[f.x,f.y]}),this.padding),s=um(l));break;case"bubble":i=Dx(a,e,this.cfg.bubbleCfg),s=i.length>=2&&um(i);break;default:}return s},c.prototype.render=function(){this.group.addShape("path",{attrs:(0,O.__assign)({path:this.path},this.cfg.style),id:this.id,name:this.cfg.id,capture:!1}),this.group.toBack()},c.prototype.addMember=function(a){if(!!a){(0,_.isString)(a)&&(a=this.graph.findById(a)),this.members.push(a);var e=this.nonMembers.indexOf(a);return e>-1&&this.nonMembers.splice(e,1),this.updateData(this.members,this.nonMembers),!0}},c.prototype.addNonMember=function(a){if(!!a){(0,_.isString)(a)&&(a=this.graph.findById(a)),this.nonMembers.push(a);var e=this.members.indexOf(a);return e>-1&&this.members.splice(e,1),this.updateData(this.members,this.nonMembers),!0}},c.prototype.removeMember=function(a){if(!!a){(0,_.isString)(a)&&(a=this.graph.findById(a));var e=this.members.indexOf(a);return e>-1?(this.members.splice(e,1),this.updateData(this.members,this.nonMembers),!0):!1}},c.prototype.removeNonMember=function(a){if(!!a){(0,_.isString)(a)&&(a=this.graph.findById(a));var e=this.nonMembers.indexOf(a);return e>-1?(this.nonMembers.splice(e,1),this.updateData(this.members,this.nonMembers),!0):!1}},c.prototype.updateData=function(a,e){var i=this;this.group.findById(this.id).remove(),a&&(this.members=a.map(function(s){return(0,_.isString)(s)?i.graph.findById(s):s})),e&&(this.nonMembers=e.map(function(s){return(0,_.isString)(s)?i.graph.findById(s):s})),this.path=this.calcPath(this.members,this.nonMembers),this.render()},c.prototype.updateStyle=function(a){var e=this.group.findById(this.id);e.attr((0,O.__assign)({},a))},c.prototype.updateCfg=function(a){var e=this;this.cfg=(0,_.deepMix)(this.cfg,a),this.id=this.cfg.id,this.group=this.cfg.group,a.members&&(this.members=this.cfg.members.map(function(i){return(0,_.isString)(i)?e.graph.findById(i):i})),a.nonMembers&&(this.nonMembers=this.cfg.nonMembers.map(function(i){return(0,_.isString)(i)?e.graph.findById(i):i})),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()},c.prototype.contain=function(a){var e=this,i;(0,_.isString)(a)?i=this.graph.findById(a):i=a;var s,l=i.getKeyShape();if(i.get("type")==="path")s=sm(l.attr("path"));else{var f=l.getCanvasBBox();s=[[f.minX,f.minY],[f.maxX,f.minY],[f.maxX,f.maxY],[f.minX,f.maxY]]}return s=s.map(function(d){var v=e.graph.getPointByCanvas(d[0],d[1]);return[v.x,v.y]}),el(s,sm(this.path))},c.prototype.destroy=function(){this.group.remove(),this.cfg=null},c}(),Rx=k1,Kf=ie,wS="node",wd=function(c){(0,O.__extends)(a,c);function a(e){var i=c.call(this)||this;return i.sortCombos=(0,_.debounce)(function(){var s=i.get("comboSorted");if(!(!i||i.destroyed||s)){i.set("comboSorted",!0);var l=[],f={},d=i.get("comboTrees");(d||[]).forEach(function(w){_o(w,function(E){return l[E.depth]?l[E.depth].push(E.id):l[E.depth]=[E.id],f[E.id]=E.depth,!0})});var v=i.getEdges().concat(i.get("vedges"));(v||[]).forEach(function(w){var E=w.getModel(),T=f[E.source]||0,G=f[E.target]||0,U=Math.max(T,G);l[U]?l[U].push(E.id):l[U]=[E.id]}),l.forEach(function(w){if(!(!w||!w.length))for(var E=w.length-1;E>=0;E--){var T=i.findById(w[E]);T&&T.toFront()}})}},500,!1),i.cfg=(0,_.deepMix)(i.getDefaultCfg(),e),i.init(),i.animating=!1,i.destroyed=!1,i.cfg.enabledStack&&(i.undoStack=new Es(i.cfg.maxStep),i.redoStack=new Es(i.cfg.maxStep)),i}return a.prototype.init=function(){this.initCanvas();var e=new Ut(this),i=new _f(this),s=new fh(this),l=new lc(this);this.set({viewController:e,modeController:i,itemController:s,stateController:l}),this.initLayoutController(),this.initEventController(),this.initGroups(),this.initPlugins()},a.prototype.initGroups=function(){var e=this.get("canvas");if(!!e){var i=e.get("el"),s=(i||{}).id,l=s===void 0?"g6":s,f=e.addGroup({id:"".concat(l,"-root"),className:Ae.rootContainerClassName});if(this.get("groupByTypes")){var d=f.addGroup({id:"".concat(l,"-edge"),className:Ae.edgeContainerClassName}),v=f.addGroup({id:"".concat(l,"-node"),className:Ae.nodeContainerClassName}),w=f.addGroup({id:"".concat(l,"-combo"),className:Ae.comboContainerClassName});w.toBack(),this.set({nodeGroup:v,edgeGroup:d,comboGroup:w})}var E=f.addGroup({id:"".concat(l,"-delegate"),className:Ae.delegateContainerClassName});this.set({delegateGroup:E}),this.set("group",f)}},a.prototype.getDefaultCfg=function(){return{container:void 0,width:void 0,height:void 0,renderer:"canvas",modes:{},plugins:[],data:{},fitViewPadding:10,minZoom:.02,maxZoom:10,event:!0,groupByTypes:!0,directed:!1,autoPaint:!0,nodes:[],edges:[],combos:[],vedges:[],itemMap:{},linkCenter:!1,defaultNode:{},defaultEdge:{},nodeStateStyles:{},edgeStateStyles:{},states:{},animate:!1,animateCfg:{onFrame:void 0,duration:500,easing:"easeLinear"},callback:void 0,enabledStack:!1,maxStep:10,tooltips:[],optimizeThreshold:1e3}},a.prototype.set=function(e,i){return(0,_.isPlainObject)(e)?this.cfg=(0,O.__assign)((0,O.__assign)({},this.cfg),e):this.cfg[e]=i,e==="enabledStack"&&i&&!this.undoStack&&!this.redoStack&&(this.undoStack=new Es(this.cfg.maxStep),this.redoStack=new Es(this.cfg.maxStep)),this},a.prototype.get=function(e){var i;return(i=this.cfg)===null||i===void 0?void 0:i[e]},a.prototype.getGroup=function(){return this.get("group")},a.prototype.getContainer=function(){return this.get("container")},a.prototype.getMinZoom=function(){return this.get("minZoom")},a.prototype.setMinZoom=function(e){return this.set("minZoom",e)},a.prototype.getMaxZoom=function(){return this.get("maxZoom")},a.prototype.setMaxZoom=function(e){return this.set("maxZoom",e)},a.prototype.getWidth=function(){return this.get("width")},a.prototype.getHeight=function(){return this.get("height")},a.prototype.clearItemStates=function(e,i){(0,_.isString)(e)&&(e=this.findById(e));var s=this.get("itemController");i||(i=e.get("states")),s.clearItemStates(e,i);var l=this.get("stateController");l.updateStates(e,i,!1)},a.prototype.node=function(e){typeof e=="function"&&this.set("nodeMapper",e)},a.prototype.edge=function(e){typeof e=="function"&&this.set("edgeMapper",e)},a.prototype.combo=function(e){typeof e=="function"&&this.set("comboMapper",e)},a.prototype.findById=function(e){return this.get("itemMap")[e]},a.prototype.find=function(e,i){var s,l=this.get("".concat(e,"s"));return(0,_.each)(l,function(f,d){if(i(f,d))return s=f,s}),s},a.prototype.findAll=function(e,i){var s=[];return(0,_.each)(this.get("".concat(e,"s")),function(l,f){i(l,f)&&s.push(l)}),s},a.prototype.findAllByState=function(e,i,s){return s?this.findAll(e,function(l){return l.hasState(i)&&s(l)}):this.findAll(e,function(l){return l.hasState(i)})},a.prototype.translate=function(e,i,s,l){var f=this,d=this.get("group"),v=(0,_.clone)(d.getMatrix());if(v||(v=[1,0,0,0,1,0,0,0,1]),s){var w=Cl({animateCfg:l,callback:function(){return f.emit("viewportchange",{action:"translate",matrix:d.getMatrix()})}});gs(d,{x:d.getCanvasBBox().x+e,y:d.getCanvasBBox().y+i},s,w||{duration:500,easing:"easeCubic"})}else v=Kf(v,[["t",e,i]]),d.setMatrix(v),this.emit("viewportchange",{action:"translate",matrix:v}),this.autoPaint()},a.prototype.moveTo=function(e,i,s,l){var f=this.get("group");gs(f,{x:e,y:i},s,l||{duration:500,easing:"easeCubic"}),this.emit("viewportchange",{action:"move",matrix:f.getMatrix()})},a.prototype.fitView=function(e,i,s,l){e&&this.set("fitViewPadding",e);var f=this.get("viewController");i?f.fitViewByRules(i,s,l):f.fitView(s,l),this.autoPaint()},a.prototype.fitCenter=function(e,i){var s=this.get("viewController");s.fitCenter(e,i),this.autoPaint()},a.prototype.addBehaviors=function(e,i){var s=this.get("modeController");return s.manipulateBehaviors(e,i,!0),this},a.prototype.removeBehaviors=function(e,i){var s=this.get("modeController");return s.manipulateBehaviors(e,i,!1),this},a.prototype.updateBehavior=function(e,i,s){var l=this.get("modeController");return l.updateBehavior(e,i,s),this},a.prototype.zoom=function(e,i,s,l){var f=this,d=this.get("group"),v=(0,_.clone)(d.getMatrix())||[1,0,0,0,1,0,0,0,1],w=this.get("minZoom"),E=this.get("maxZoom"),T=this.getZoom()||1,G=T*e,U=e,et=!1;if(w&&G<w?(U=w/T,et=!0):E&&G>E&&(U=E/T,et=!0),i?v=Kf(v,[["t",-i.x,-i.y],["s",U,U],["t",i.x,i.y]]):v=Kf(v,[["s",U,U]]),s){var ct=(0,_.clone)(d.getMatrix());ct||(ct=[1,0,0,0,1,0,0,0,1]);var Ct=ct[0],Mt=Ct*U,Dt=Cl({animateCfg:l,callback:function(){return f.emit("viewportchange",{action:"zoom",matrix:d.getMatrix()})}});d.animate(function(zt){if(zt===1)ct=v;else{var Qt=Sl(Ct,Mt,zt)/ct[0];i?ct=Kf(ct,[["t",-i.x,-i.y],["s",Qt,Qt],["t",i.x,i.y]]):ct=Kf(ct,[["s",Qt,Qt]])}return{matrix:ct}},Dt)}else d.setMatrix(v),this.emit("viewportchange",{action:"zoom",matrix:v}),this.autoPaint();return!et},a.prototype.zoomTo=function(e,i,s,l){var f=e/this.getZoom();return this.zoom(f,i,s,l)},a.prototype.focusItem=function(e,i,s){var l=this.get("viewController"),f=!1;i?f=!0:i===void 0&&(f=this.get("animate"));var d={};s?d=s:s===void 0&&(d=this.get("animateCfg")),l.focus(e,f,d),this.autoPaint()},a.prototype.focusItems=function(e,i,s,l){var f=this.get("viewController");f.focusItems(e,i,s,l)},a.prototype.autoPaint=function(){this.get("autoPaint")&&this.paint()},a.prototype.paint=function(){this.emit("beforepaint"),this.get("canvas").draw(),this.emit("afterpaint")},a.prototype.getPointByClient=function(e,i){var s=this.get("viewController");return s.getPointByClient(e,i)},a.prototype.getClientByPoint=function(e,i){var s=this.get("viewController");return s.getClientByPoint(e,i)},a.prototype.getPointByCanvas=function(e,i){var s=this.get("viewController");return s.getPointByCanvas(e,i)},a.prototype.getCanvasByPoint=function(e,i){var s=this.get("viewController");return s.getCanvasByPoint(e,i)},a.prototype.getGraphCenterPoint=function(){var e=this.get("group").getCanvasBBox();return{x:(e.minX+e.maxX)/2,y:(e.minY+e.maxY)/2}},a.prototype.getViewPortCenterPoint=function(){return this.getPointByCanvas(this.get("width")/2,this.get("height")/2)},a.prototype.showItem=function(e,i){i===void 0&&(i=!0);var s=this.get("itemController"),l=s.changeItemVisibility(e,!0);if(i&&this.get("enabledStack")){var f=l.getID(),d=l.getType(),v={},w={};switch(d){case"node":v.nodes=[{id:f,visible:!1}],w.nodes=[{id:f,visible:!0}];break;case"edge":v.nodes=[{id:f,visible:!1}],w.edges=[{id:f,visible:!0}];break;case"combo":v.nodes=[{id:f,visible:!1}],w.combos=[{id:f,visible:!0}];break;default:break}this.pushStack("visible",{before:v,after:w})}},a.prototype.hideItem=function(e,i){i===void 0&&(i=!0);var s=this.get("itemController"),l=s.changeItemVisibility(e,!1);if(i&&this.get("enabledStack")){var f=l.getID(),d=l.getType(),v={},w={};switch(d){case"node":v.nodes=[{id:f,visible:!0}],w.nodes=[{id:f,visible:!1}];break;case"edge":v.nodes=[{id:f,visible:!0}],w.edges=[{id:f,visible:!1}];break;case"combo":v.nodes=[{id:f,visible:!0}],w.combos=[{id:f,visible:!1}];break;default:break}this.pushStack("visible",{before:v,after:w})}},a.prototype.refreshItem=function(e){var i=this.get("itemController");i.refreshItem(e)},a.prototype.setAutoPaint=function(e){var i=this;i.set("autoPaint",e);var s=i.get("canvas");s.set("autoDraw",e)},a.prototype.remove=function(e,i){i===void 0&&(i=!0),this.removeItem(e,i)},a.prototype.removeItem=function(e,i){i===void 0&&(i=!0);var s=e;if((0,_.isString)(e)&&(s=this.findById(e)),!s&&(0,_.isString)(e))console.warn("The item ".concat(e," to be removed does not exist!"));else if(s){var l="";if(s.getType&&(l=s.getType()),i&&this.get("enabledStack")){var f=(0,O.__assign)((0,O.__assign)({},s.getModel()),{itemType:l}),d={};switch(l){case"node":{d.nodes=[f],d.edges=[];for(var v=s.getEdges(),w=v.length-1;w>=0;w--)d.edges.push((0,O.__assign)((0,O.__assign)({},v[w].getModel()),{itemType:"edge"}));break}case"edge":d.edges=[f];break;case"combo":d.combos=[f];break;default:break}this.pushStack("delete",{before:d,after:{}})}if(l==="node"){var E=s.getModel();E.comboId&&this.updateComboTree(s,void 0,!1)}var T=this.get("itemController");if(T.removeItem(s),l==="combo"){var G=ks(this.get("comboTrees"));this.set("comboTrees",G)}}},a.prototype.innerAddItem=function(e,i,s){if(!sl(e,i))return!1;if(i.id&&this.findById(i.id)){console.warn("This item exists already. Be sure the id %c".concat(i.id,"%c is unique."),"font-size: 20px; color: red;","");return}var l,f=this.get("comboTrees")||[];if(e==="combo"){var d=this.get("itemMap"),v=!1;if(f.forEach(function(et){v||To(et,function(ct){if(i.parentId===ct.id){v=!0;var Ct=(0,O.__assign)({id:i.id,depth:ct.depth+2},i);ct.children?ct.children.push(Ct):ct.children=[Ct],i.depth=Ct.depth,l=s.addItem(e,i)}var Mt=d[ct.id];return v&&Mt&&Mt.getType&&Mt.getType()==="combo"&&s.updateCombo(Mt,ct.children),!0})}),!v){var w=(0,O.__assign)({id:i.id,depth:0},i);i.depth=w.depth,f.push(w),l=s.addItem(e,i)}this.set("comboTrees",f),i.collapsed&&(this.collapseCombo(l,!1),this.updateCombo(l))}else if(e==="node"&&(0,_.isString)(i.comboId)&&f){var E=this.findById(i.comboId);E&&E.getType&&E.getType()!=="combo"&&console.warn("'".concat(i.comboId,"' is not a id of a combo in the graph, the node will be added without combo.")),l=s.addItem(e,i);var T=this.get("itemMap"),G=!1,U=!1;f.forEach(function(et){U||G||To(et,function(ct){if(ct.id===i.id)return U=!0,!1;if(i.comboId===ct.id&&!U){G=!0;var Ct=(0,_.clone)(i);Ct.itemType="node",ct.children?ct.children.push(Ct):ct.children=[Ct],Ct.depth=ct.depth+1}return G&&T[ct.id].getType&&T[ct.id].getType()==="combo"&&s.updateCombo(T[ct.id],ct.children),!0})})}else l=s.addItem(e,i);if(e==="node"&&i.comboId||e==="combo"&&i.parentId){var E=this.findById(i.comboId||i.parentId);E&&E.getType&&E.getType()==="combo"&&E.addChild(l)}return l},a.prototype.addItem=function(e,i,s,l){s===void 0&&(s=!0),l===void 0&&(l=!0);var f=this.get("comboSorted");this.set("comboSorted",f&&!l);var d=this.get("itemController"),v=this.innerAddItem(e,i,d);if(v===!1||v===!0)return v;var w=this.get("combos");if(w&&w.length>0&&this.sortCombos(),this.autoPaint(),s&&this.get("enabledStack")){var E=(0,O.__assign)((0,O.__assign)({},v.getModel()),{itemType:e}),T={};switch(e){case"node":T.nodes=[E];break;case"edge":T.edges=[E];break;case"combo":T.combos=[E];break;default:break}this.pushStack("add",{before:{},after:T})}return v},a.prototype.addItems=function(e,i,s){e===void 0&&(e=[]),i===void 0&&(i=!0),s===void 0&&(s=!0);var l=this.get("comboSorted");this.set("comboSorted",l&&!s);for(var f=this.get("itemController"),d=[],v=0;v<e.length;v++){var w=e[v];w.type!=="edge"&&w.type!=="vedge"?d.push(this.innerAddItem(w.type,w.model,f)):d.push(void 0)}for(var v=0;v<e.length;v++){var w=e[v];(w.type==="edge"||w.type==="vedge")&&(d[v]=this.innerAddItem(w.type,w.model,f))}if(s){var E=this.get("combos");E&&E.length>0&&this.sortCombos()}if(this.autoPaint(),i&&this.get("enabledStack")){for(var T={nodes:[],edges:[],combos:[]},v=0;v<e.length;v++){var G=e[v].type,U=d[v];if(!!U&&U!==!0){var et=(0,O.__assign)((0,O.__assign)({},U.getModel()),{itemType:G});switch(G){case"node":T.nodes.push(et);break;case"edge":T.edges.push(et);break;case"combo":T.combos.push(et);break;default:break}}}this.pushStack("addItems",{before:{},after:T})}return d},a.prototype.add=function(e,i,s,l){return s===void 0&&(s=!0),l===void 0&&(l=!0),this.addItem(e,i,s,l)},a.prototype.updateItem=function(e,i,s){var l=this;s===void 0&&(s=!0);var f=this.get("itemController"),d;(0,_.isString)(e)?d=this.findById(e):d=e;var v=s&&this.get("enabledStack"),w;v&&(w=(0,_.clone)(d.getModel()));var E="";d.getType&&(E=d.getType());var T=(0,O.__spreadArray)([],d.getStates(),!0);if(E==="combo"&&(0,_.each)(T,function(ct){return l.setItemState(d,ct,!1)}),f.updateItem(d,i),E==="combo"&&(0,_.each)(T,function(ct){return l.setItemState(d,ct,!0)}),v){var G={nodes:[],edges:[],combos:[]},U={nodes:[],edges:[],combos:[]},et=(0,O.__assign)({id:w.id},i);switch(E){case"node":G.nodes.push(w),U.nodes.push(et);break;case"edge":G.edges.push(w),U.edges.push(et);break;case"combo":G.combos.push(w),U.combos.push(et);break;default:break}this.pushStack("update",{before:G,after:U})}},a.prototype.update=function(e,i,s){s===void 0&&(s=!0),this.updateItem(e,i,s)},a.prototype.setItemState=function(e,i,s){(0,_.isString)(e)&&(e=this.findById(e));var l=this.get("itemController");l.setItemState(e,i,s);var f=this.get("stateController");f.updateState(e,i,s)},a.prototype.priorityState=function(e,i){var s=this.get("itemController");s.priorityState(e,i)},a.prototype.data=function(e){Yl(e),this.set("data",e)},a.prototype.render=function(){var e=this;this.set("comboSorted",!1);var i=this.get("data");if(this.get("enabledStack")&&this.clearStack(),!i)throw new Error("data must be defined first");var s=i.nodes,l=s===void 0?[]:s,f=i.edges,d=f===void 0?[]:f,v=i.combos,w=v===void 0?[]:v;if(this.clear(!0),this.emit("beforerender"),e.addItems(l.map(function(Ct){return{type:"node",model:Ct}}),!1,!1),(w==null?void 0:w.length)!==0){var E=ws(w,l);this.set("comboTrees",E),e.addCombos(w)}e.addItems(d.map(function(Ct){return{type:"edge",model:Ct}}),!1,!1);var T=e.get("animate");(e.get("fitView")||e.get("fitCenter"))&&e.set("animate",!1);var G=e.get("layoutController");if(G){if(G.layout(U),this.destroyed)return}else U();function U(){(e.get("comboTrees")||[]).forEach(function(Ct){To(Ct,function(Mt){var Dt=e.findById(Mt.id);return Dt.getType()==="combo"&&Mt.collapsed&&(e.collapseCombo(Mt.id,!1),e.updateCombo(Dt)),!0})}),e.get("fitView")?e.fitView():e.get("fitCenter")&&e.fitCenter(),e.autoPaint(),e.emit("afterrender"),(e.get("fitView")||e.get("fitCenter"))&&e.set("animate",T),setTimeout(function(){var Ct;(Ct=e.getCombos())===null||Ct===void 0||Ct.forEach(function(Mt){Mt.set("animate",!0)})},0)}if(!this.get("groupByTypes"))if(w&&w.length!==0)this.sortCombos();else if(i.nodes&&i.edges&&i.nodes.length<i.edges.length){var et=this.getNodes();et.forEach(function(Ct){Ct.toFront()})}else{var ct=this.getEdges();ct.forEach(function(Ct){Ct.toBack()})}},a.prototype.read=function(e){this.data(e),this.render()},a.prototype.diffItems=function(e,i,s){var l=this,f,d=this.get("itemMap");(0,_.each)(s,function(v){if(f=d[v.id],f){if(l.get("animate")&&e===wS){var w=f.getContainer().getMatrix();w||(w=[1,0,0,0,1,0,0,0,1]),f.set("originAttrs",{x:w[6],y:w[7]})}l.updateItem(f,v,!1)}else f=l.addItem(e,v,!1);f&&i["".concat(e,"s")].push(f)})},a.prototype.changeData=function(e,i){var s=this,l;i===void 0&&(i=!0);var f=this,d=e||f.get("data");if(!Yl(d))return this;this.emit("beforechangedata"),i&&this.get("enabledStack")&&this.pushStack("changedata",{before:f.save(),after:d}),this.set("comboSorted",!1),this.removeHulls(),this.getNodes().map(function(Dt){return f.clearItemStates(Dt)}),this.getEdges().map(function(Dt){return f.clearItemStates(Dt)});var v=this.get("canvas"),w=v.get("localRefresh");v.set("localRefresh",!1),f.get("data")||(f.data(d),f.render());var E=this.get("itemMap"),T={nodes:[],edges:[]},G=d.combos;if(G){var U=ws(G,d.nodes);this.set("comboTrees",U)}else this.set("comboTrees",[]);this.diffItems("node",T,d.nodes),(0,_.each)(E,function(Dt,zt){E[zt].getModel().depth=0,!(Dt.getType&&Dt.getType()==="edge")&&(Dt.getType&&Dt.getType()==="combo"?(delete E[zt],Dt.destroy()):T.nodes.indexOf(Dt)<0&&(delete E[zt],f.remove(Dt,!1)))});for(var et=this.getCombos(),ct=et.length,Ct=ct-1;Ct>=0;Ct--)et[Ct].destroyed&&et.splice(Ct,1);G&&(f.addCombos(G),this.get("groupByTypes")||this.sortCombos()),this.diffItems("edge",T,d.edges),(0,_.each)(E,function(Dt,zt){Dt.getType&&(Dt.getType()==="node"||Dt.getType()==="combo")||T.edges.indexOf(Dt)<0&&(delete E[zt],f.remove(Dt,!1))}),(this.get("comboTrees")||[]).forEach(function(Dt){To(Dt,function(zt){var Qt=s.findById(zt.id);return Qt.getType()==="combo"&&zt.collapsed&&s.collapseCombo(zt.id,!1),!0})}),this.set({nodes:T.nodes,edges:T.edges});var Mt=this.get("layoutController");return Mt&&(Mt.changeData(function(){setTimeout(function(){var Dt;(Dt=f.getCombos())===null||Dt===void 0||Dt.forEach(function(zt){zt.set("animate",!0)})},0)}),f.get("animate")&&!Mt.getLayoutType()?(f.positionsAnimate(),(l=f.getCombos())===null||l===void 0||l.forEach(function(Dt){return Dt.set("animate",!0)})):f.autoPaint()),setTimeout(function(){v.set("localRefresh",w)},16),this.set("data",d),this.emit("afterchangedata"),this},a.prototype.addCombos=function(e){var i=this,s=i.get("comboTrees"),l=this.get("itemController");l.addCombos(s,e)},a.prototype.createCombo=function(e,i,s){var l=this;s===void 0&&(s=!0);var f=this.get("itemController");this.set("comboSorted",!1);var d="",v;if(!!e){if((0,_.isString)(e))d=e,v={id:e};else{if(d=e.id,!d){console.warn("Create combo failed. Please assign a unique string id for the adding combo.");return}v=e}var w=s&&this.get("enabledStack"),E={nodes:[],combos:[]};w&&i.forEach(function(Mt){var Dt=l.findById(Mt),zt=Dt.getType();if(!(zt!=="node"&&zt!=="combo")){var Qt=Dt.getModel();E["".concat(zt,"s")].push({id:Mt,parentId:zt==="node"?Qt.comboId:Qt.parentId})}});var T=this.get("comboTrees"),G=new Set(i),U=new Map;T&&(T.forEach(function(Mt){To(Mt,function(Dt,zt,Qt){if(G.has(Dt.id)){if(zt){var Ie=l.findById(zt.id),je=l.findById(Dt.id);zt.children.splice(Qt,1),Ie.removeChild(je),f.updateCombo(Ie,zt.children)}Dt.itemType==="combo"&&U.set(Dt.id,Dt)}return!0})}),T=T.filter(function(Mt){return!G.has(Mt.id)}),this.set("comboTrees",T));var et={nodes:[],combos:[]},ct=i.map(function(Mt){var Dt=l.findById(Mt),zt=Dt.getModel(),Qt="";Dt.getType&&(Qt=Dt.getType());var Ie=U.get(Mt)||{id:Dt.getID(),itemType:Qt};return Qt==="combo"?(Ie.parentId=d,zt.parentId=d):Qt==="node"&&(Ie.comboId=d,zt.comboId=d),w&&et["".concat(Qt,"s")].push({id:zt.id,parentId:d}),Ie});v.children=ct,this.addItem("combo",v,!1),this.set("comboSorted",!1),T&&(T.forEach(function(Mt){_o(Mt,function(Dt){return Dt.id===d?(Dt.itemType="combo",Dt.children=ct,!1):!0})}),this.sortCombos()),w&&(et.combos.push(v),this.pushStack("createCombo",{before:E,after:et}));var Ct=this.findById(d);!Ct.getModel().parentId&&Ct.getChildren().combos.length&&this.updateComboTree(Ct,void 0,!1)}},a.prototype.uncombo=function(e,i){var s=this,l,f;i===void 0&&(i=!0);var d=this,v=e;if((0,_.isString)(e)&&(v=this.findById(e)),!v||v.getType&&v.getType()!=="combo"){console.warn("The item is not a combo!");return}var w=v.getModel(),E=v.getModel().parentId,T=d.get("comboTrees");T||(T=[]);var G=this.get("itemMap"),U=v.get("id"),et,ct=[],Ct=this.get("combos"),Mt=this.findById(E),Dt=i&&this.get("enabledStack"),zt={};if(Dt&&(zt=(0,_.clone)(w),zt.children=[]),T.forEach(function(ze){et||To(ze,function(mn){var $n;if(mn.id===U){et=mn;var Tn=v.getEdges().map(function(Ta){return Ta.getID()});Tn.forEach(function(Ta){s.removeItem(Ta,!1)});var or=Ct.indexOf(v);Ct.splice(or,1),delete G[U];var kr=(0,_.clone)(v.getModel());v.destroy(),s.emit("afterremoveitem",{item:kr,type:"combo"})}if(E&&et&&mn.id===E){Mt.removeCombo(v),ct=mn.children;var or=ct.indexOf(et);return or!==-1&&ct.splice(or,1),($n=et.children)===null||$n===void 0||$n.forEach(function(fi){var ei=s.findById(fi.id),Ia=ei.getModel();ei.getType&&ei.getType()==="combo"?(fi.parentId=E,delete fi.comboId,Ia.parentId=E,delete Ia.comboId):ei.getType&&ei.getType()==="node"&&(fi.comboId=E,Ia.comboId=E),Mt.addChild(ei),ct.push(fi)}),s.updateCombo(Mt),!1}return!0})}),!E&&et){var Qt=T.indexOf(et);T.splice(Qt,1),(l=et.children)===null||l===void 0||l.forEach(function(ze){ze.parentId=void 0;var mn=s.findById(ze.id).getModel();delete mn.parentId,delete mn.comboId,ze.itemType!=="node"&&T.push(ze)})}if(Dt){var Ie={nodes:[],combos:[]},je={nodes:[],combos:[]};(f=et.children)===null||f===void 0||f.forEach(function(ze){var mn=s.findById(ze.id),$n=mn.getType();$n!=="node"&&$n!=="combo"||(Ie["".concat($n,"s")].push({id:ze.id,parentId:U}),je["".concat($n,"s")].push({id:ze.id,parentId:E}))}),Ie.combos.push(zt),this.pushStack("uncombo",{before:Ie,after:je})}},a.prototype.updateCombos=function(e){var i=this;e===void 0&&(e=!1);var s=this,l=this.get("comboTrees"),f=s.get("itemController"),d=s.get("itemMap");(l||[]).forEach(function(v){To(v,function(w){var E;if(!w)return!0;var T=d[w.id];if(((E=T==null?void 0:T.getType)===null||E===void 0?void 0:E.call(T))==="combo"){var G=(0,O.__spreadArray)([],T.getStates(),!0);(0,_.each)(G,function(U){return i.setItemState(T,U,!1)}),f.updateCombo(T,w.children,e),(0,_.each)(G,function(U){return i.setItemState(T,U,!0)})}return!0})}),s.sortCombos()},a.prototype.updateCombo=function(e){var i=this,s=this,l=e,f;if((0,_.isString)(e)&&(l=this.findById(e)),!l||l.getType&&l.getType()!=="combo"){console.warn("The item to be updated is not a combo!");return}f=l.get("id");var d=this.get("comboTrees"),v=s.get("itemController"),w=s.get("itemMap");(d||[]).forEach(function(E){To(E,function(T){if(!T)return!0;var G=w[T.id];if(f===T.id&&G&&G.getType&&G.getType()==="combo"){var U=(0,O.__spreadArray)([],G.getStates(),!0);(0,_.each)(U,function(et){G.getStateStyle(et)&&i.setItemState(G,et,!1)}),v.updateCombo(G,T.children),(0,_.each)(U,function(et){G.getStateStyle(et)&&i.setItemState(G,et,!0)}),f&&(f=T.parentId)}return!0})})},a.prototype.updateComboTree=function(e,i,s){s===void 0&&(s=!0);var l=this;this.set("comboSorted",!1);var f;(0,_.isString)(e)?f=l.findById(e):f=e;var d=f.getModel(),v=d.comboId||d.parentId,w="";if(f.getType&&(w=f.getType()),i&&w==="combo"){var E=this.get("comboTrees"),T=!0,G;if((E||[]).forEach(function(Dt){G||_o(Dt,function(zt){if(!G)return zt.id===f.getID()&&(G=zt),!0})}),_o(G,function(Dt){return Dt.id===i?(T=!1,!1):!0}),!T){console.warn("Failed to update the combo tree! The parentId points to a descendant of the combo!");return}}if(s&&this.get("enabledStack")){var U={},et={};w==="combo"?(U.combos=[{id:d.id,parentId:d.parentId}],et.combos=[{id:d.id,parentId:i}]):w==="node"&&(U.nodes=[{id:d.id,parentId:d.comboId}],et.nodes=[{id:d.id,parentId:i}]),this.pushStack("updateComboTree",{before:U,after:et})}if(d.parentId||d.comboId){var ct=this.findById(d.parentId||d.comboId);ct&&ct.removeChild(f)}if(w==="combo"?d.parentId=i:w==="node"&&(d.comboId=i),i){var Ct=this.findById(i);Ct&&Ct.addChild(f)}if(v){var Ct=this.findById(v);Ct&&Ct.removeChild(f)}var Mt=ks(this.get("comboTrees"),d.id,i);this.set("comboTrees",Mt),this.updateCombos()},a.prototype.save=function(){var e=[],i=[],s=[];return(0,_.each)(this.get("nodes"),function(l){e.push(l.getModel())}),(0,_.each)(this.get("edges"),function(l){i.push(l.getModel())}),(0,_.each)(this.get("combos"),function(l){s.push(l.getModel())}),{nodes:e,edges:i,combos:s}},a.prototype.changeSize=function(e,i){var s=this.get("viewController");return s.changeSize(e,i),this},a.prototype.refresh=function(){var e=this;if(e.emit("beforegraphrefresh"),e.get("animate"))e.positionsAnimate();else{var i=e.get("nodes"),s=e.get("edges"),l=e.get("edges");(0,_.each)(i,function(f){f.refresh()}),(0,_.each)(s,function(f){f.refresh()}),(0,_.each)(l,function(f){f.refresh()})}e.emit("aftergraphrefresh"),e.autoPaint()},a.prototype.getNodes=function(){return this.get("nodes")},a.prototype.getEdges=function(){return this.get("edges")},a.prototype.getCombos=function(){return this.get("combos")},a.prototype.getComboChildren=function(e){if((0,_.isString)(e)&&(e=this.findById(e)),!e||e.getType&&e.getType()!=="combo"){console.warn("The combo does not exist!");return}return e.getChildren()},a.prototype.positionsAnimate=function(e){var i=this;i.emit("beforeanimate");var s=i.get("animateCfg"),l=s.onFrame,f=e?i.getNodes().concat(i.getCombos()):i.getNodes(),d=f.map(function(w){var E=w.getModel();return{id:E.id,x:E.x,y:E.y}});i.stopAnimate();var v=i.get("canvas");i.animating=!0,setTimeout(function(){v.animate(function(w){(0,_.each)(d,function(E){var T=i.findById(E.id);if(!(!T||T.destroyed)){var G=T.get("originAttrs"),U=T.get("model"),et=T.getContainer().getMatrix();if(G==null&&(et&&(G={x:et[6],y:et[7]}),T.set("originAttrs",G||0)),l){var ct=l(T,w,E,G||{x:0,y:0});T.set("model",Object.assign(U,ct))}else G?(U.x=G.x+(E.x-G.x)*w,U.y=G.y+(E.y-G.y)*w):(U.x=E.x,U.y=E.y)}}),i.refreshPositions(e)},{duration:s.duration,easing:s.easing,callback:function(){(0,_.each)(f,function(E){E.set("originAttrs",null)}),s.callback&&s.callback(),i.emit("afteranimate"),i.animating=!1}})},0)},a.prototype.refreshPositions=function(e){var i=this;i.emit("beforegraphrefreshposition");var s=i.get("nodes"),l=i.get("edges"),f=i.get("vedges"),d=i.get("combos"),v,w={},E=function(G){(0,_.each)(G,function(U){v=U.getModel();var et=U.get("originAttrs");if(!(et&&v.x===et.x&&v.y===et.y)){var ct=U.updatePosition({x:v.x,y:v.y});w[v.id]=ct,v.comboId&&(w[v.comboId]=w[v.comboId]||ct),v.parentId&&(w[v.parentId]=w[v.parentId]||ct)}})};E(d),E(s),d&&d.length!==0&&(e&&E(d),i.updateCombos()),(0,_.each)(l,function(T){var G=T.getSource().getModel(),U=T.getTarget();if(!(0,_.isPlainObject)(U)){var et=U.getModel();(w[G.id]||w[et.id]||T.getModel().isComboEdge)&&T.refresh()}}),(0,_.each)(f,function(T){T.refresh()}),i.emit("aftergraphrefreshposition"),i.autoPaint()},a.prototype.stopAnimate=function(){var e=this.get("canvas"),i=e.cfg.timeline;i&&i.stopAllAnimations()},a.prototype.isAnimating=function(){return this.animating},a.prototype.getZoom=function(){var e=this.get("group").getMatrix();return e?e[0]:1},a.prototype.getCurrentMode=function(){var e=this.get("modeController");return e.getMode()},a.prototype.setMode=function(e){var i=this.get("modeController");return i.setMode(e),this},a.prototype.clear=function(e){var i;return e===void 0&&(e=!1),(i=this.get("canvas"))===null||i===void 0||i.clear(),this.initGroups(),this.set({itemMap:{},nodes:[],edges:[],vedges:[],groups:[],combos:[],comboTrees:[]}),e||this.emit("afterrender"),this},a.prototype.updateLayout=function(e,i,s,l){var f=this;e===void 0&&(e={}),l===void 0&&(l=!0);var d=this.get("layoutController");if((0,_.isString)(e)&&(e={type:e}),i){var v=s;v||(i==="begin"?v={x:0,y:0}:v={x:this.getWidth()/2,y:this.getHeight()/2}),v=this.getPointByCanvas(v.x,v.y);var w=["force","gForce","fruchterman","force2"];w.includes(e.type)||!e.type&&w.includes(d==null?void 0:d.layoutType)?e.center=[v.x,v.y]:this.once("afterlayout",function(G){var U=f.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];v.x=v.x*U[0]+U[6],v.y=v.y*U[0]+U[7];var et=f.getGroup().getCanvasBBox(),ct=et.minX,Ct=et.maxX,Mt=et.minY,Dt=et.maxY,zt={x:(ct+Ct)/2,y:(Mt+Dt)/2};i==="begin"&&(zt.x=ct,zt.y=Mt),f.translate(v.x-zt.x,v.y-zt.y)})}var E=(0,O.__assign)({},this.get("layout")),T={};Object.assign(T,E,e),e.pipes&&!e.type?delete T.type:!e.pipes&&T.type&&delete T.pipes,this.set("layout",T),!!d&&(d.isLayoutTypeSame(T)&&T.gpuEnabled===E.gpuEnabled?d.updateLayoutCfg(T):d.changeLayout(T),l&&this.get("enabledStack")&&this.pushStack("layout",{before:E,after:T}))},a.prototype.destroyLayout=function(){var e=this.get("layoutController");e==null||e.destroyLayout()},a.prototype.layout=function(){var e,i=this.get("layoutController"),s=this.get("layout");if(!(!s||!i)){if(s.workerEnabled){i.layout();return}((e=i.layoutMethods)===null||e===void 0?void 0:e.length)?i.relayout(!0):i.layout()}},a.prototype.collapseCombo=function(e,i){var s=this;if(i===void 0&&(i=!0),!this.destroyed){if((0,_.isString)(e)&&(e=this.findById(e)),!e){console.warn("The combo to be collapsed does not exist!");return}this.emit("beforecollapseexpandcombo",{action:"expand",item:e});var l=e.getModel(),f=this.get("itemController");f.collapseCombo(e,i),l.collapsed=!0;var d=this.getEdges().concat(this.get("vedges")),v=[],w=this.get("comboTrees"),E=!1;(w||[]).forEach(function(G){E||_o(G,function(U){if(E&&U.depth<=l.depth)return!1;if(l.id===U.id&&(E=!0),E){var et=s.findById(U.id);et&&et.getType&&et.getType()==="combo"&&(v=v.concat(et.getNodes()),v=v.concat(et.getCombos()))}return!0})});var T={};d.forEach(function(G){var U=G.getModel(),et=U.isVEdge,ct=U.size,Ct=ct===void 0?1:ct;if(!(G.isVisible()&&!et)){var Mt=G.getSource(),Dt=G.getTarget(),zt=null,Qt;if(Mt.getModel().id===l.id||v.includes(Mt)&&!v.includes(Dt)?(zt=Dt,Qt=!1):(Dt.getModel().id===l.id||!v.includes(Mt)&&v.includes(Dt))&&(zt=Mt,Qt=!0),zt){if(et){s.removeItem(G,!1);return}for(var Ie=zt.getModel();!zt.isVisible();){var je=Ie.parentId,ze=Ie.comboId,mn=je||ze;if(zt=s.findById(mn),!zt||!mn)return;Ie=zt.getModel()}var $n=Ie.id,Tn=Qt?{source:$n,target:l.id,size:Ct,isVEdge:!0}:{source:l.id,target:$n,size:Ct,isVEdge:!0},or="".concat(Tn.source,"-").concat(Tn.target);if(T[or]){T[or].size+=Ct;return}T[or]=Tn}}}),this.addItems(Object.values(T).map(function(G){return{type:"vedge",model:G}}),!1),this.emit("aftercollapseexpandcombo",{action:"collapse",item:e})}},a.prototype.expandCombo=function(e,i){var s=this;if(i===void 0&&(i=!0),(0,_.isString)(e)&&(e=this.findById(e)),!e||e.getType&&e.getType()!=="combo"){console.warn("The combo to be collapsed does not exist!");return}this.emit("beforecollapseexpandcombo",{action:"expand",item:e});var l=e.getModel(),f=this.get("itemController");f.expandCombo(e,i),l.collapsed=!1;var d=this.getEdges().concat(this.get("vedges")),v=[],w=this.get("comboTrees"),E=!1;(w||[]).forEach(function(G){E||_o(G,function(U){if(E&&U.depth<=l.depth)return!1;if(l.id===U.id&&(E=!0),E){var et=s.findById(U.id);et&&et.getType&&et.getType()==="combo"&&(v=v.concat(et.getNodes()),v=v.concat(et.getCombos()))}return!0})});var T={};d.forEach(function(G){if(!(G.isVisible()&&!G.getModel().isVEdge)){var U=G.getSource(),et=G.getTarget(),ct=U.get("id"),Ct=et.get("id"),Mt=null,Dt;if(ct===l.id||v.includes(U)&&!v.includes(et)?(Mt=et,Dt=!1):Ct===l.id||!v.includes(U)&&v.includes(et)?(Mt=U,Dt=!0):v.includes(U)&&v.includes(et)&&U.isVisible()&&et.isVisible()&&G.show(),Mt){var zt=G.getModel(),Qt=zt.isVEdge,Ie=zt.size,je=Ie===void 0?1:Ie;if(Qt){s.removeItem(G,!1);return}for(var ze=Mt.getModel();!Mt.isVisible();){var mn=ze.parentId,$n=ze.comboId,Tn=mn||$n;if(Mt=s.findById(Tn),!Mt||!Tn)return;ze=Mt.getModel()}for(var or=ze.id,kr=Dt?et:U,Ta=kr.getModel();!kr.isVisible();){var fi=Ta.parentId,ei=Ta.comboId,Ia=fi||ei;if(kr=s.findById(Ia),!kr||!Ia)return;if(Ta.comboId===l.id||Ta.parentId===l.id)break;Ta=kr.getModel()}var Gi=Ta.id;if(or){var Ri=Dt?{source:or,target:Gi,isVEdge:!0,size:je}:{source:Gi,target:or,isVEdge:!0,size:je},xa="".concat(Ri.source,"-").concat(Ri.target);if(T[xa]){T[xa].size+=je;return}T[xa]=Ri}}}}),this.addItems(Object.values(T).map(function(G){return{type:"vedge",model:G}}),!1),this.emit("aftercollapseexpandcombo",{action:"expand",item:e})},a.prototype.collapseExpandCombo=function(e,i){if(i===void 0&&(i=!0),(0,_.isString)(e)&&(e=this.findById(e)),!(!e||e.getType&&e.getType()!=="combo")){for(var s=e.getModel(),l=this.findById(s.parentId);l;){var f=l.getModel();if(f.collapsed){console.warn("Fail to expand the combo since it's ancestor combo is collapsed."),l=void 0;return}l=this.findById(f.parentId)}var d=s.collapsed;d?this.expandCombo(e,i):this.collapseCombo(e,i),this.updateCombo(e)}},a.prototype.getNeighbors=function(e,i){var s=e;return(0,_.isString)(e)&&(s=this.findById(e)),s.getNeighbors(i)},a.prototype.getNodeDegree=function(e,i,s){i===void 0&&(i=void 0),s===void 0&&(s=!1);var l=e;(0,_.isString)(e)&&(l=this.findById(e));var f=this.get("degrees");(!f||s)&&(f=Ne(this.save()),this.set("degrees",f));var d=f[l.getID()],v=0;if(!d)return 0;switch(i){case"in":v=d.inDegree;break;case"out":v=d.outDegree;break;case"all":v=d;break;default:v=d.degree;break}return v},a.prototype.getUndoStack=function(){return this.undoStack},a.prototype.getRedoStack=function(){return this.redoStack},a.prototype.getStackData=function(){return this.get("enabledStack")?{undoStack:this.undoStack.toArray(),redoStack:this.redoStack.toArray()}:null},a.prototype.clearStack=function(){this.get("enabledStack")&&(this.undoStack.clear(),this.redoStack.clear(),this.emit("stackchange",{undoStack:this.undoStack,redoStack:this.redoStack}))},a.prototype.pushStack=function(e,i,s){if(e===void 0&&(e="update"),s===void 0&&(s="undo"),!this.get("enabledStack")){console.warn("\u8BF7\u5148\u542F\u7528 undo & redo \u529F\u80FD\uFF0C\u5728\u5B9E\u4F8B\u5316 Graph \u65F6\u5019\u914D\u7F6E enabledStack: true !");return}var l=i?(0,_.clone)(i):{before:{},after:(0,_.clone)(this.save())};s==="redo"?this.redoStack.push({action:e,data:l}):this.undoStack.push({action:e,data:l}),this.emit("stackchange",{action:e,stackType:s,undoStack:this.undoStack,redoStack:this.redoStack})},a.prototype.getAdjMatrix=function(e,i){e===void 0&&(e=!0),i===void 0&&(i=this.get("directed"));var s=this.get("adjMatrix");return(!s||!e)&&(s=Yt(this.save(),i),this.set("adjMatrix",s)),s},a.prototype.getShortestPathMatrix=function(e,i){e===void 0&&(e=!0),i===void 0&&(i=this.get("directed"));var s=this.get("adjMatrix"),l=this.get("shortestPathMatrix");return(!s||!e)&&(s=Yt(this.save(),i),this.set("adjMatrix",s)),(!l||!e)&&(l=Gn(this.save(),i),this.set("shortestPathMatrix",l)),l},a.prototype.on=function(e,i,s){return c.prototype.on.call(this,e,i,s)},a.prototype.destroy=function(){var e,i,s,l,f;this.clear(),this.clearStack(),(e=this.get("itemController"))===null||e===void 0||e.destroy(),(i=this.get("modeController"))===null||i===void 0||i.destroy(),(s=this.get("viewController"))===null||s===void 0||s.destroy(),(l=this.get("stateController"))===null||l===void 0||l.destroy(),(f=this.get("canvas"))===null||f===void 0||f.destroy(),this.cfg=null,this.destroyed=!0,this.redoStack=null,this.undoStack=null},a.prototype.createHull=function(e){if(!e.members||e.members.length<1){console.warn("Create hull failed! The members is empty.");return}var i=this.get("hullGroup"),s=this.get("hullMap");if(s||(s={},this.set("hullMap",s)),(!i||i.get("destroyed"))&&(i=this.get("group").addGroup({id:"hullGroup"}),i.toBack(),this.set("hullGroup",i)),s[e.id])return console.warn("Existed hull id."),s[e.id];var l=i.addGroup({id:"".concat(e.id,"-container")}),f=new Rx(this,(0,O.__assign)((0,O.__assign)({},e),{group:l})),d=f.id;return s[d]=f,f},a.prototype.getHulls=function(){return this.get("hullMap")},a.prototype.getHullById=function(e){return this.get("hullMap")[e]},a.prototype.removeHull=function(e){var i,s;(0,_.isString)(e)?s=this.getHullById(e):s=e,(i=this.get("hullMap"))===null||i===void 0||delete i[s.id],s.destroy()},a.prototype.removeHulls=function(){var e=this.getHulls();!e||!Object.keys(e).length||(Object.keys(e).forEach(function(i){var s=e[i];s.destroy()}),this.set("hullMap",{}))},a}(wt),Lx=wd;function Km(c){return Km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Km(c)}var hm=ie,Pv="-shape",D1="-label",dm=["startArrow","endArrow"],Px={lineWidth:1,stroke:void 0,fill:void 0,lineAppendWidth:1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,x:0,y:0,r:10,width:20,height:20,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},pm={lineWidth:1,stroke:"#000",lineDash:void 0,startArrow:!1,endArrow:!1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},q0={edge:pm,node:Px,combo:Px},Fv="-label-bg",O1={options:{labelCfg:{style:{fontFamily:Ae.windowFontFamily}},descriptionCfg:{style:{fontFamily:Ae.windowFontFamily}}},itemType:"",type:"",getCustomConfig:function(a){return{}},getOptions:function(a,e){return e==="move"||(e==null?void 0:e.includes("bbox"))?a:(0,_.deepMix)({},this.options,this.getCustomConfig(a)||{},a)},draw:function(a,e){e.shapeMap={},this.mergeStyle=this.getOptions(a);var i=this.drawShape(a,e);if(i.set("className",this.itemType+Pv),e.shapeMap[this.itemType+Pv]=i,a.label){var s=this.drawLabel(a,e);s.set("className",this.itemType+D1),e.shapeMap[this.itemType+D1]=s}return i},afterDraw:function(a,e,i){},drawShape:function(a,e){return null},drawLabel:function(a,e){var i=(this.mergeStyle||this.getOptions(a)||{}).labelCfg,s=i||{},l=this.getLabelStyle(a,s,e),f=l.rotate;delete l.rotate;var d=e.addShape("text",{attrs:l,draggable:!0,className:"text-shape",name:"text-shape",labelRelated:!0});if(e.shapeMap["text-shape"]=d,!isNaN(f)&&f!==""){var v=d.getBBox(),w=[1,0,0,0,1,0,0,0,1];if(l.rotateCenter)switch(l.rotateCenter){case"center":w=hm(w,[["t",-v.width/2,-v.height/2],["r",f],["t",v.width/2,v.height/2]]);break;case"lefttop":w=hm(w,[["t",-l.x,-l.y],["r",f],["t",l.x,l.y]]);break;case"leftcenter":w=hm(w,[["t",-l.x,-l.y-v.height/2],["r",f],["t",l.x,l.y+v.height/2]]);break;default:w=hm(w,[["t",-v.width/2,-v.height/2],["r",f],["t",v.width/2,v.height/2]]);break}else w=hm(w,[["t",-l.x,-l.y-v.height/2],["r",f],["t",l.x,l.y+v.height/2]]);d.setMatrix(w)}if(l.background){var E=this.drawLabelBg(a,e,d),T=this.itemType+Fv;E.set("classname",T),e.shapeMap[T]=E,d.toFront()}return d},drawLabelBg:function(a,e,i){var s=this.options.labelCfg,l=(0,_.mix)({},s,a.labelCfg),f=this.getLabelBgStyleByPosition(i,l),d=e.addShape("rect",{name:"text-bg-shape",attrs:f,labelRelated:!0});return e.shapeMap["text-bg-shape"]=d,d},getLabelStyleByPosition:function(a,e,i){return{text:a.label}},getLabelBgStyleByPosition:function(a,e){return{}},getLabelStyle:function(a,e,i){var s=this.getLabelStyleByPosition(a,e,i),l="".concat(this.itemType,"Label"),f=Ae[l]?Ae[l].style:null;return(0,O.__assign)((0,O.__assign)((0,O.__assign)({},f),s),e.style)},getShapeStyle:function(a){return a.style},update:function(a,e,i){this.updateShapeStyle(a,e,i),this.updateLabel(a,e,i)},updateShapeStyle:function(a,e,i){var s,l=e.getContainer(),f=e.getKeyShape(),d=(0,_.mix)({},f.attr(),a.style),v=function(T){var G,U=d[T];if((0,_.isPlainObject)(U)){var et=((s=l.shapeMap)===null||s===void 0?void 0:s[T])||l.find(function(ct){return ct.get("name")===T});et==null||et.attr(U)}else f.attr((G={},G[T]=U,G))};for(var w in d)v(w)},updateLabel:function(a,e,i){var s,l,f=e.getContainer(),d=(this.mergeStyle||this.getOptions({},i)||{}).labelCfg,v=d===void 0?{}:d,w=this.itemType+D1,E=f.shapeMap[w]||f.find(function(Qt){return Qt.get("className")===w}),T=this.itemType+Fv,G=f.shapeMap[T]||f.find(function(Qt){return Qt.get("className")===T});if(E&&a.label===void 0&&(f.removeChild(E),delete f.shapeMap[w],G&&(f.removeChild(G),delete f.shapeMap[T])),a.label||a.label==="")if(E){(!i||i==="bbox|label"||this.itemType==="edge"&&i!=="style")&&(v=(0,_.deepMix)(v,a.labelCfg));var et=this.getLabelStyleByPosition(a,v,f),ct=(s=a.labelCfg)===null||s===void 0?void 0:s.style,Ct=(0,O.__assign)((0,O.__assign)({},et),ct),Mt=Ct.rotate;if(delete Ct.rotate,!isNaN(Mt)&&Mt!==""){var Dt=[1,0,0,0,1,0,0,0,1];Dt=hm(Dt,[["t",-Ct.x,-Ct.y],["r",Mt],["t",Ct.x,Ct.y]]),Ct.matrix=Dt,E.attr(Ct)}else((l=E.getMatrix())===null||l===void 0?void 0:l[4])!==1&&E.resetMatrix(),E.attr(Ct);if(!G)Ct.background&&(G=this.drawLabelBg(a,f,E),G.set("classname",T),f.shapeMap[T]=G,E.toFront());else if(Ct.background){var zt=this.getLabelBgStyleByPosition(E,v);G.attr(zt)}else f.removeChild(G)}else{var U=this.drawLabel(a,f);U.set("className",w),f.shapeMap[w]=U}},afterUpdate:function(a,e){},setState:function(a,e,i){var s,l,f,d=i.get("keyShape");if(!(!d||d.destroyed)){var v=i.getType(),w=(0,_.isBoolean)(e)?a:"".concat(a,":").concat(e),E=this.getStateStyle(w,i),T=i.getStateStyle(w);if(!(!T&&!E)){var G=(0,_.mix)({},T||E),U=i.getContainer(),et={x:1,y:1,cx:1,cy:1,matrix:1};if(v==="combo"&&(et.r=1,et.width=1,et.height=1),e){var ct=function(Ia){var Gi,Ri=G[Ia];if((0,_.isPlainObject)(Ri)&&!dm.includes(Ia)){var xa=((f=U.shapeMap)===null||f===void 0?void 0:f[Ia])||U.find(function(ja){return ja.get("name")===Ia});xa==null||xa.attr(Ri)}else d.attr((Gi={},Gi[Ia]=Ri,Gi))};for(var Ct in G)ct(Ct)}else{var Mt=nl(i.getCurrentStatesStyle()),Dt=i.getModel(),zt=(0,_.mix)({},Dt.style,nl(i.getOriginStyle())),Qt=d.get("name"),Ie=d.attr(),je={};Object.keys(Ie).forEach(function(ei){if(ei!=="img"){var Ia=Ie[ei];Ia&&Km(Ia)==="object"?je[ei]=(0,_.clone)(Ia):je[ei]=Ia}});var ze={},mn=function(Ia){var Gi=G[Ia];if((0,_.isPlainObject)(Gi)&&!dm.includes(Ia)){var Ri=U.shapeMap[Ia]||U.find(function(di){return di.get("name")===Ia});if(Ri){var xa=nl(Ri.attr());(0,_.each)(Gi,function(di,hi){if(Ia===Qt&&je[hi]&&!et[hi]){delete je[hi];var qi=zt[Ia][hi]||q0[v][hi];d.attr(hi,qi)}else if(xa[hi]||xa[hi]===0){delete xa[hi];var fo=zt[Ia][hi]||q0[v][hi];Ri.attr(hi,fo)}}),ze[Ia]=xa}}else if(je[Ia]&&!et[Ia]){delete je[Ia];var ja=zt[Ia]||(zt[Qt]?zt[Qt][Ia]:void 0)||q0[v][Ia];d.attr(Ia,ja)}};for(var $n in G)mn($n);Qt?ze[Qt]=je:(0,_.mix)(ze,je);for(var Ct in Mt)if(!et[Ct]){var Tn=Mt[Ct];(!(0,_.isPlainObject)(Tn)||dm.includes(Ct))&&(Qt?((0,_.mix)(zt[Qt],(l={},l[Ct]=Tn,l)),delete zt[Ct]):(0,_.mix)(zt,(s={},s[Ct]=Tn,s)),delete Mt[Ct])}var or={};(0,_.deepMix)(or,zt,ze,Mt);var kr=!1,Ta=function(Ia){var Gi,Ri,xa=or[Ia];if((0,_.isPlainObject)(xa)&&!dm.includes(Ia)){var ja=U.shapeMap[Ia]||U.find(function(hi){return hi.get("name")===Ia});ja&&((ja.get("type")==="text"||ja.get("labelRelated"))&&(delete xa.x,delete xa.y,delete xa.matrix),Ia===Qt&&(v==="combo"&&(delete xa.r,delete xa.width,delete xa.height),kr=!0),ja.attr(xa))}else if(!kr){var di=xa||q0[v][Ia];v==="combo"?Qt||d.attr((Gi={},Gi[Ia]=di,Gi)):d.attr((Ri={},Ri[Ia]=di,Ri))}};for(var fi in or)Ta(fi)}}}},getStateStyle:function(a,e){var i=e.getModel(),s=e.getType(),l=this.getOptions(i),f=l.stateStyles,d=l.style,v=d===void 0?{}:d,w=i.stateStyles?i.stateStyles[a]:f&&f[a];return s==="combo"?(0,_.clone)(w):(0,_.mix)({},v,w)},getControlPoints:function(a){return a.controlPoints},getAnchorPoints:function(a){var e,i,s=(a==null?void 0:a.anchorPoints)||((e=this.getCustomConfig(a))===null||e===void 0?void 0:e.anchorPoints)||((i=this.options)===null||i===void 0?void 0:i.anchorPoints);return s}},Ed={itemType:"node",shapeType:"single-node",labelPosition:"center",offset:Ae.nodeLabel.offset,getSize:function(a){var e,i=((e=this.mergeStyle)===null||e===void 0?void 0:e.size)||a.size||this.getOptions({}).size||Ae.defaultNode.size;return(0,_.isArray)(i)&&i.length===1&&(i=[i[0],i[0]]),(0,_.isArray)(i)||(i=[i,i]),i},getLabelStyleByPosition:function(a,e){var i=e.maxLength,s=a.label;i&&(s=js(s,i));var l=e.position||this.labelPosition;if(l==="center")return{x:0,y:0,text:s,textBaseline:"middle",textAlign:"center"};var f=e.offset;(0,_.isNil)(f)&&(f=this.offset);var d=this.getSize(a),v;switch(l){case"top":v={x:0,y:-d[1]/2-f,textBaseline:"bottom",textAlign:"center"};break;case"bottom":v={x:0,y:d[1]/2+f,textBaseline:"top",textAlign:"center"};break;case"left":v={x:-d[0]/2-f,y:0,textBaseline:"middle",textAlign:"right"};break;default:v={x:d[0]/2+f,y:0,textBaseline:"middle",textAlign:"left"};break}return v.text=s,v},getLabelBgStyleByPosition:function(a,e){var i;if(!a)return{};var s=(i=e.style)===null||i===void 0?void 0:i.background;if(!s)return{};var l=a.getBBox(),f=D(s.padding),d=l.width+f[1]+f[3],v=l.height+f[0]+f[2];return(0,O.__assign)((0,O.__assign)({x:l.minX-f[3],y:l.minY-f[0]},s),{width:d,height:v})},drawShape:function(a,e){var i=this.shapeType,s=this.getShapeStyle(a),l=e.addShape(i,{attrs:s,draggable:!0,name:"node-shape"});return e.shapeMap["node-shape"]=l,l},updateLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=e.shapeMap["link-point-left"]||e.find(function(or){return or.get("className")==="link-point-left"}),l=e.shapeMap["link-point-right"]||e.find(function(or){return or.get("className")==="link-point-right"}),f=e.shapeMap["link-point-top"]||e.find(function(or){return or.get("className")==="link-point-top"}),d=e.shapeMap["link-point-bottom"]||e.find(function(or){return or.get("className")==="link-point-bottom"}),v;s&&(v=s.attr()),l&&!v&&(v=l.attr()),f&&!v&&(v=f.attr()),d&&!v&&(v=d.attr()),v||(v=i);var w=(0,_.mix)({},v,a.linkPoints),E=w.fill,T=w.stroke,G=w.lineWidth,U=w.size/2;U||(U=w.r);var et=a.linkPoints?a.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},ct=et.left,Ct=et.right,Mt=et.top,Dt=et.bottom,zt=this.getSize(a),Qt=zt[0],Ie=zt[1],je={r:U,fill:E,stroke:T,lineWidth:G};if(s)!ct&&ct!==void 0?(s.remove(),delete e.shapeMap["link-point-left"]):s.attr((0,O.__assign)((0,O.__assign)({},je),{x:-Qt/2,y:0}));else if(ct){var ze="link-point-left";e.shapeMap[ze]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},je),{x:-Qt/2,y:0}),className:ze,name:ze,isAnchorPoint:!0})}if(l)!Ct&&Ct!==void 0&&(l.remove(),delete e.shapeMap["link-point-right"]),l.attr((0,O.__assign)((0,O.__assign)({},je),{x:Qt/2,y:0}));else if(Ct){var mn="link-point-right";e.shapeMap[mn]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},je),{x:Qt/2,y:0}),className:mn,name:mn,isAnchorPoint:!0})}if(f)!Mt&&Mt!==void 0&&(f.remove(),delete e.shapeMap["link-point-top"]),f.attr((0,O.__assign)((0,O.__assign)({},je),{x:0,y:-Ie/2}));else if(Mt){var $n="link-point-top";e.shapeMap[$n]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},je),{x:0,y:-Ie/2}),className:$n,name:$n,isAnchorPoint:!0})}if(d)!Dt&&Dt!==void 0?(d.remove(),delete e.shapeMap["link-point-bottom"]):d.attr((0,O.__assign)((0,O.__assign)({},je),{x:0,y:Ie/2}));else if(Dt){var Tn="link-point-bottom";e.shapeMap[Tn]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},je),{x:0,y:Ie/2}),className:Tn,name:Tn,isAnchorPoint:!0})}},updateShape:function(a,e,i,s,l){var f=e.get("keyShape");f.attr((0,O.__assign)({},i)),this.updateLabel(a,e,l),s&&this.updateIcon(a,e)},updateIcon:function(a,e){var i=this,s=e.getContainer(),l=(this.mergeStyle||this.getOptions(a)).icon,f=a.icon?a.icon:{show:void 0,text:void 0},d=f.show,v=f.text,w=s.shapeMap["".concat(this.type,"-icon")]||s.find(function(Mt){return Mt.get("name")==="".concat(i.type,"-icon")});if(w)if(d||d===void 0){var E=(0,_.mix)({},w.attr(),l),T=E.width,G=T===void 0?20:T,U=E.height,et=U===void 0?20:U;(E.fontFamily==="iconfont"||E.hasOwnProperty("text"))&&(G=0,et=0),w.attr((0,O.__assign)((0,O.__assign)({},E),{x:-G/2,y:-et/2}))}else w.remove(),delete s.shapeMap["".concat(this.type,"-icon")];else if(d){var ct="".concat(this.type,"-icon");if(v)s.shapeMap[ct]=s.addShape("text",{attrs:(0,O.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},l),className:ct,name:ct});else{var G=l.width,et=l.height;s.shapeMap[ct]=s.addShape("image",{attrs:(0,O.__assign)((0,O.__assign)({},l),{x:-G/2,y:-et/2}),className:ct,name:ct})}var Ct=s.shapeMap["node-label"]||s.find(function(Mt){return Mt.get("name")==="node-label"});Ct&&Ct.toFront()}}},ES=(0,O.__assign)((0,O.__assign)({},O1),Ed);Gr.registerNode("single-node",ES);var Jd="edge-shape";function SS(c){var a=c;return c==="start"?a="end":c==="end"&&(a="start"),a}var Q0={itemType:"edge",labelPosition:"center",refX:0,refY:0,labelAutoRotate:!1,options:{size:Ae.defaultEdge.size,style:{x:0,y:0,stroke:Ae.defaultEdge.style.stroke,lineAppendWidth:Ae.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:Ae.edgeLabel.style.fill,fontSize:Ae.edgeLabel.style.fontSize,fontFamily:Ae.windowFontFamily}},stateStyles:(0,O.__assign)({},Ae.edgeStateStyles)},getPath:function(a){var e=[];return(0,_.each)(a,function(i,s){s===0?e.push(["M",i.x,i.y]):e.push(["L",i.x,i.y])}),e},getShapeStyle:function(a){var e=this.options.style,i={stroke:a.color},s=(0,_.mix)({},e,i,a.style),l=a.size||Ae.defaultEdge.size;a=this.getPathPoints(a);var f=a.startPoint,d=a.endPoint,v=this.getControlPoints(a),w=[f];v&&(w=w.concat(v)),w.push(d);var E=this.getPath(w),T=(0,_.mix)({},Ae.defaultEdge.style,{stroke:Ae.defaultEdge.color,lineWidth:l,path:E},s);return T},updateShapeStyle:function(a,e,i){var s,l=e.getContainer(),f=((s=e.getKeyShape)===null||s===void 0?void 0:s.call(e))||l.shapeMap["edge-shape"],d=a.size;a=this.getPathPoints(a);var v=a.startPoint,w=a.endPoint,E=this.getControlPoints(a),T=[v];E&&(T=T.concat(E)),T.push(w);var G=f.attr(),U=a.style||{};U.stroke===void 0&&(U.stroke=a.color);var et=a.sourceNode,ct=a.targetNode,Ct={radius:U.radius};E||(Ct={source:et,target:ct,offset:U.offset,radius:U.radius});var Mt=this.getPath(T,Ct),Dt={};i==="move"?Dt={path:Mt}:(G.endArrow&&U.endArrow===!1&&(a.style.endArrow={path:""}),G.startArrow&&U.startArrow===!1&&(a.style.startArrow={path:""}),Dt=(0,O.__assign)({},a.style),Dt.lineWidth===void 0&&(Dt.lineWdith=((0,_.isNumber)(d)?d:d==null?void 0:d[0])||G.lineWidth),Dt.path===void 0&&(Dt.path=Mt),Dt.stroke===void 0&&(Dt.stroke=G.stroke||a.color)),f&&f.attr(Dt)},getLabelStyleByPosition:function(a,e,i){var s=e.position||this.labelPosition,l={},f=i==null?void 0:i.shapeMap[Jd],d;s==="start"?d=0:s==="end"?d=1:d=.5;var v=e.refX||this.refX,w=e.refY||this.refY;if(a.startPoint.x===a.endPoint.x&&a.startPoint.y===a.endPoint.y)return l.x=a.startPoint.x+v,l.y=a.startPoint.y+w,l.text=a.label,l;var E;(0,_.isNil)(e.autoRotate)?E=this.labelAutoRotate:E=e.autoRotate;var T=ro(f,d,v,w,E);return l.x=T.x,l.y=T.y,l.rotate=T.rotate,l.textAlign=this._getTextAlign(s,T.angle),l.text=a.label,l},getLabelBgStyleByPosition:function(a,e){if(!a)return{};var i=a.getBBox(),s=e.style&&e.style.background;if(!s)return{};var l=s.padding,f=i.width+l[1]+l[3],d=i.height+l[0]+l[2],v=(0,O.__assign)((0,O.__assign)({},s),{width:f,height:d,x:i.minX-l[3],y:i.minY-l[0],matrix:[1,0,0,0,1,0,0,0,1]}),w;return(0,_.isNil)(e.autoRotate)?w=this.labelAutoRotate:w=e.autoRotate,w&&(v.matrix=a.attr("matrix")||[1,0,0,0,1,0,0,0,1]),v},_getTextAlign:function(a,e){var i="center";return e?(e=e%(Math.PI*2),a!=="center"&&(e>=0&&e<=Math.PI/2||e>=3/2*Math.PI&&e<2*Math.PI?i=a:i=SS(a)),i):a},getControlPoints:function(a){return a.controlPoints},getPathPoints:function(a){return a},drawShape:function(a,e){var i=this.getShapeStyle(a),s=e.addShape("path",{className:Jd,name:Jd,attrs:i});return e.shapeMap[Jd]=s,s},drawLabel:function(a,e){var i=this.options.labelCfg,s=(0,_.deepMix)({},i,a.labelCfg),l=this.getLabelStyle(a,s,e),f=l.rotate;delete l.rotate;var d=e.addShape("text",{attrs:l,name:"text-shape",labelRelated:!0});if(e.shapeMap["text-shape"]=d,!isNaN(f)&&f!==""&&d.rotateAtStart(f),l.background){var v=this.drawLabelBg(a,e,d,l,f),w=this.itemType+Fv;v.set("classname",w),e.shapeMap[w]=v,d.toFront()}return d},drawLabelBg:function(a,e,i,s,l){var f=this.options.labelCfg,d=(0,_.deepMix)({},f,a.labelCfg),v=this.getLabelBgStyleByPosition(i,d),w=e.addShape("rect",{name:"text-bg-shape",attrs:v,labelRelated:!0});return e.shapeMap["text-bg-shape"]=w,w}},CS=(0,O.__assign)((0,O.__assign)({},O1),Q0);Gr.registerEdge("single-edge",CS),Gr.registerEdge("line",{getControlPoints:function(){}},"single-edge"),Gr.registerEdge("spline",{getPath:function(a){var e=Jh(a);return e}},"single-edge"),Gr.registerEdge("arc",{curveOffset:20,clockwise:1,getControlPoints:function(a){var e=a.startPoint,i=a.endPoint,s={x:(e.x+i.x)/2,y:(e.y+i.y)/2},l,f;if(a.controlPoints!==void 0){if(f=a.controlPoints[0],l=pa(e,f,i),e.x<=i.x&&e.y>i.y?this.clockwise=l.x>f.x?0:1:e.x<=i.x&&e.y<i.y?this.clockwise=l.x>f.x?1:0:e.x>i.x&&e.y<=i.y?this.clockwise=l.y<f.y?0:1:this.clockwise=l.y<f.y?1:0,(f.x-e.x)/(f.y-e.y)==(i.x-e.x)/(i.y-e.y))return[]}else{a.curveOffset===void 0&&(a.curveOffset=this.curveOffset),(0,_.isArray)(a.curveOffset)&&(a.curveOffset=a.curveOffset[0]),a.curveOffset<0?this.clockwise=0:this.clockwise=1;var d={x:i.x-e.x,y:i.y-e.y},v=Math.atan2(d.y,d.x);f={x:a.curveOffset*Math.cos(-Math.PI/2+v)+s.x,y:a.curveOffset*Math.sin(-Math.PI/2+v)+s.y},l=pa(e,f,i)}var w=Ra(e,l),E=[{x:w,y:w}];return E},getPath:function(a){var e=[];return e.push(["M",a[0].x,a[0].y]),a.length===2?e.push(["L",a[1].x,a[1].y]):e.push(["A",a[1].x,a[1].y,0,0,this.clockwise,a[2].x,a[2].y]),e}},"single-edge"),Gr.registerEdge("quadratic",{curvePosition:.5,curveOffset:-20,getControlPoints:function(a){var e=a.controlPoints;if(!e||!e.length){var i=a.startPoint,s=a.endPoint;a.curveOffset===void 0&&(a.curveOffset=this.curveOffset),a.curvePosition===void 0&&(a.curvePosition=this.curvePosition),(0,_.isArray)(a.curveOffset)&&(a.curveOffset=a.curveOffset[0]),(0,_.isArray)(a.curvePosition)&&(a.curvePosition=a.curveOffset[0]);var l=Ip(i,s,a.curvePosition,a.curveOffset);e=[l]}return e},getPath:function(a){var e=[];return e.push(["M",a[0].x,a[0].y]),e.push(["Q",a[1].x,a[1].y,a[2].x,a[2].y]),e}},"single-edge"),Gr.registerEdge("cubic",{curvePosition:[1/2,1/2],curveOffset:[-20,20],getControlPoints:function(a){var e=a.controlPoints;if(a.curveOffset===void 0&&(a.curveOffset=this.curveOffset),a.curvePosition===void 0&&(a.curvePosition=this.curvePosition),(0,_.isNumber)(a.curveOffset)&&(a.curveOffset=[a.curveOffset,-a.curveOffset]),(0,_.isNumber)(a.curvePosition)&&(a.curvePosition=[a.curvePosition,1-a.curvePosition]),!e||!e.length||e.length<2){var i=a.startPoint,s=a.endPoint,l=Ip(i,s,a.curvePosition[0],a.curveOffset[0]),f=Ip(i,s,a.curvePosition[1],a.curveOffset[1]);e=[l,f]}return e},getPath:function(a){var e=[];return e.push(["M",a[0].x,a[0].y]),e.push(["C",a[1].x,a[1].y,a[2].x,a[2].y,a[3].x,a[3].y]),e}},"single-edge"),Gr.registerEdge("cubic-vertical",{curvePosition:[1/2,1/2],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(a){var e=a.startPoint,i=a.endPoint;a.curvePosition===void 0&&(a.curvePosition=this.curvePosition),a.curveOffset===void 0&&(a.curveOffset=this.curveOffset),a.minCurveOffset===void 0&&(a.minCurveOffset=this.minCurveOffset),(0,_.isNumber)(a.curveOffset)&&(a.curveOffset=[a.curveOffset,-a.curveOffset]),(0,_.isNumber)(a.minCurveOffset)&&(a.minCurveOffset=[a.minCurveOffset,-a.minCurveOffset]),(0,_.isNumber)(a.curvePosition)&&(a.curvePosition=[a.curvePosition,1-a.curvePosition]);var s=i.y-e.y,l=[0,0];a.curveOffset?l=a.curveOffset:Math.abs(s)<Math.abs(a.minCurveOffset[0])&&(l=a.minCurveOffset);var f={x:e.x,y:e.y+s*this.curvePosition[0]+l[0]},d={x:i.x,y:i.y-s*this.curvePosition[1]+l[1]};return[f,d]}},"cubic"),Gr.registerEdge("cubic-horizontal",{curvePosition:[1/2,1/2],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(a){var e=a.startPoint,i=a.endPoint;a.curvePosition===void 0&&(a.curvePosition=this.curvePosition),a.curveOffset===void 0&&(a.curveOffset=this.curveOffset),a.minCurveOffset===void 0&&(a.minCurveOffset=this.minCurveOffset),(0,_.isNumber)(a.curveOffset)&&(a.curveOffset=[a.curveOffset,-a.curveOffset]),(0,_.isNumber)(a.minCurveOffset)&&(a.minCurveOffset=[a.minCurveOffset,-a.minCurveOffset]),(0,_.isNumber)(a.curvePosition)&&(a.curvePosition=[a.curvePosition,1-a.curvePosition]);var s=i.x-e.x,l=[0,0];a.curveOffset?l=a.curveOffset:Math.abs(s)<Math.abs(a.minCurveOffset[0])&&(l=a.minCurveOffset);var f={x:e.x+s*this.curvePosition[0]+l[0],y:e.y},d={x:i.x-s*this.curvePosition[1]+l[1],y:i.y},v=[f,d];return v}},"cubic"),Gr.registerEdge("loop",{getPathPoints:function(a){return oi(a)},getControlPoints:function(a){return a.controlPoints},afterDraw:function(a){a.controlPoints=void 0},afterUpdate:function(a){a.controlPoints=void 0}},"cubic");var Fx={itemType:"combo",shapeType:"single-combo",labelPosition:"top",refX:Ae.comboLabel.refX,refY:Ae.comboLabel.refY,options:{style:{stroke:Ae.defaultCombo.style.stroke,fill:Ae.defaultCombo.style.fill,lineWidth:Ae.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Ae.comboLabel.style.fill,fontSize:Ae.comboLabel.style.fontSize,fontFamily:Ae.windowFontFamily}},stateStyles:(0,O.__assign)({},Ae.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},getSize:function(a){var e=(0,_.clone)(a.size||this.options.size||Ae.defaultCombo.size);return(0,_.isArray)(e)&&e.length===1&&(e=[e[0],e[0]]),(0,_.isArray)(e)||(e=[e,e]),e},getLabelStyleByPosition:function(a,e){var i=e.position||this.labelPosition,s=a.style,l=a.padding||this.options.padding;(0,_.isArray)(l)&&(l=Math.max.apply(Math,l));var f=e.refX,d=e.refY;(0,_.isNil)(f)&&(f=this.refX),(0,_.isNil)(d)&&(d=this.refY);var v=this.getSize(a),w=Math.max(s.r,v[0]/2)||v[0]/2,E=w+l,T;switch(i){case"top":T={x:0,y:-E-d,textBaseline:"bottom",textAlign:"center"};break;case"bottom":T={x:0,y:E+d,textBaseline:"bottom",textAlign:"center"};break;case"left":T={x:-E+f,y:0,textAlign:"left"};break;case"center":T={x:0,y:0,text:a.label,textAlign:"center"};break;default:T={x:E+f,y:0,textAlign:"right"};break}return T.text=a.label,T},drawShape:function(a,e){var i=this.shapeType,s=this.getShapeStyle(a),l=e.addShape(i,{attrs:s,draggable:!0,name:"combo-shape"});return l},updateCollapsedIcon:function(a,e,i){var s=a.collapsed,l=a.collapsedSubstituteIcon,f=l===void 0?{}:l,d=Object.assign({},this.options.collapsedSubstituteIcon,f),v=d.show,w=d.img,E=d.width,T=d.height,G=e.getContainer(),U=G.find(function(Mt){return Mt.get("name")==="combo-collapsed-substitute-icon"}),et=U&&!U.destroyed,ct=e.get("keyShape");if(s&&v){if(et)U.show();else{var Ct={width:E||i.r*2||i.width,height:T||i.r*2||i.height};U=G.addShape("image",{attrs:(0,O.__assign)({img:w,x:-Ct.width/2,y:-Ct.height/2},Ct),name:"combo-collapsed-substitute-icon",draggable:!0})}ct.hide()}else et&&(U.hide(),ct.show())},updateShape:function(a,e,i){var s=this,l=e.get("keyShape"),f=e.get("animate"),d=f&&(a.animate===void 0?this.options.animate:a.animate);d&&l.animate?(a.collapsed||this.updateCollapsedIcon(a,e,i),l.animate(i,{duration:200,easing:"easeLinear",callback:function(){a.collapsed&&s.updateCollapsedIcon(a,e,i)}})):(l.attr((0,O.__assign)({},i)),this.updateCollapsedIcon(a,e,i)),this.updateLabel(a,e)}},_S=(0,O.__assign)((0,O.__assign)({},O1),Fx);Gr.registerCombo("single-combo",_S),Gr.registerCombo("circle",{options:{size:[Ae.defaultCombo.size[0],Ae.defaultCombo.size[0]],padding:Math.max.apply(Math,Ae.defaultCombo.padding),animate:!0,style:{stroke:Ae.defaultCombo.style.stroke,fill:Ae.defaultCombo.style.fill,lineWidth:Ae.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Ae.comboLabel.style.fill,fontSize:Ae.comboLabel.style.fontSize},refX:0,refY:0},stateStyles:(0,O.__assign)({},Ae.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},shapeType:"circle",labelPosition:"top",drawShape:function(a,e){var i=this.getShapeStyle(a);delete i.height,delete i.width;var s=e.addShape("circle",{attrs:i,className:"circle-combo",name:"circle-combo",draggable:!0});return s},getShapeStyle:function(a){var e=this.options.style,i=a.padding||this.options.padding;(0,_.isArray)(i)&&(i=Math.max.apply(Math,i));var s={stroke:a.color},l=(0,_.mix)({},e,s,a.style),f=a.collapsed&&a.fixCollapseSize?a.fixCollapseSize:a.fixSize,d;if(f)d=(0,_.isNumber)(f)?f/2:f[0]/2;else{var v=this.getSize(a);!(0,_.isNumber)(l.r)||isNaN(l.r)?d=v[0]/2||Ae.defaultCombo.style.r:d=Math.max(l.r,v[0]/2)||v[0]/2}l.r=d+i;var w=(0,O.__assign)({x:0,y:0},l);return a.style?a.style.r=d:a.style={r:d},w},update:function(a,e){var i=this.getSize(a),s=a.padding||this.options.padding;(0,_.isArray)(s)&&(s=Math.max.apply(Math,s));var l=(0,_.clone)(a.style),f=a.collapsed&&a.fixCollapseSize?a.fixCollapseSize:a.fixSize,d;f?d=(0,_.isNumber)(f)?f/2:f[0]/2:d=Math.max(l.r,i[0]/2)||i[0]/2,l.r=d+s;var v=e.get("sizeCache");v&&(v.r=l.r);var w={stroke:a.color},E=e.get("keyShape"),T=(0,_.mix)({},E.attr(),w,l);a.style?a.style.r=d:a.style={r:d},this.updateShape(a,e,T,!0)}},"single-combo"),Gr.registerCombo("rect",{options:{size:[40,5],padding:[25,20,15,20],animate:!0,style:{radius:0,stroke:Ae.defaultCombo.style.stroke,fill:Ae.defaultCombo.style.fill,lineWidth:Ae.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Ae.comboLabel.style.fill,fontSize:Ae.comboLabel.style.fontSize,fontFamily:Ae.windowFontFamily}},anchorPoints:[[0,.5],[1,.5]],stateStyles:(0,O.__assign)({},Ae.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},shapeType:"rect",labelPosition:"top",drawShape:function(a,e){var i=this.getShapeStyle(a),s=e.addShape("rect",{attrs:i,className:"rect-combo",name:"rect-combo",draggable:!0});return s},getLabelStyleByPosition:function(a,e){var i=e.position||this.labelPosition,s=a.style,l=a.padding||this.options.padding;(0,_.isNumber)(l)&&(l=[l,l,l,l]);var f=e.refX,d=e.refY;(0,_.isNil)(f)&&(f=this.refX),(0,_.isNil)(d)&&(d=this.refY);var v=-s.width/2-l[3],w=s.width/2+l[1],E=-s.height/2-l[0],T=s.height/2+l[2],G;switch(i){case"top":G={x:v+f,y:E+d,textBaseline:"top",textAlign:"left"};break;case"bottom":G={x:0,y:T+d,textBaseline:"top",textAlign:"center"};break;case"left":G={x:v+d,y:0,textAlign:"left"};break;case"center":G={x:0,y:0,text:a.label,textAlign:"center"};break;case"top-center":G={x:0,y:E+d,textBaseline:"top",textAlign:"center"};break;default:G={x:w+f,y:0,textAlign:"right"};break}return G.text=a.label,G},getShapeStyle:function(a){var e=this.options.style,i=a.padding||this.options.padding;(0,_.isNumber)(i)&&(i=[i,i,i,i]);var s={stroke:a.color},l=(0,_.mix)({},e,s,a.style),f=this.getSize(a),d,v,w=a.collapsed&&a.fixCollapseSize?a.fixCollapseSize:a.fixSize;w?(0,_.isNumber)(w)?(d=w,v=w):(d=w[0],v=w[1]):(!(0,_.isNumber)(l.width)||isNaN(l.width)?d=f[0]||Ae.defaultCombo.style.width:d=Math.max(l.width,f[0])||f[0],!(0,_.isNumber)(l.height)||isNaN(l.height)?v=f[1]||Ae.defaultCombo.style.height:v=Math.max(l.height,f[1])||f[1]);var E=-d/2-i[3],T=-v/2-i[0];l.width=d+i[1]+i[3],l.height=v+i[0]+i[2];var G=(0,O.__assign)({x:E,y:T},l);return a.style?(a.style.width=d,a.style.height=v):a.style={width:d,height:v},G},update:function(a,e){var i=this.getSize(a),s=a.padding||this.options.padding;(0,_.isNumber)(s)&&(s=[s,s,s,s]);var l=(0,_.clone)(a.style),f,d,v=a.collapsed&&a.fixCollapseSize?a.fixCollapseSize:a.fixSize;v?(0,_.isNumber)(v)?(f=v,d=v):(f=v[0],d=v[1]):(f=Math.max(l.width,i[0])||i[0],d=Math.max(l.height,i[1])||i[1]),l.width=f+s[1]+s[3],l.height=d+s[0]+s[2];var w=e.get("sizeCache");w&&(w.width=l.width,w.height=l.height),l.x=-f/2-s[3],l.y=-d/2-s[0];var E={stroke:a.color},T=e.get("keyShape"),G=(0,_.mix)({},T.attr(),E,l);a.style?(a.style.width=f,a.style.height=d):a.style={width:f,height:d},this.updateShape(a,e,G,!1)}},"single-combo"),Gr.registerNode("simple-circle",{options:{size:Ae.defaultNode.size,style:{x:0,y:0,stroke:Ae.defaultNode.style.stroke,fill:Ae.defaultNode.style.fill,lineWidth:Ae.defaultNode.style.lineWidth},labelCfg:{style:{fill:Ae.nodeLabel.style.fill,fontSize:Ae.nodeLabel.style.fontSize,fontFamily:Ae.windowFontFamily}},stateStyles:(0,O.__assign)({},Ae.nodeStateStyles)},shapeType:"simple-circle",labelPosition:"center",shapeMap:{},drawShape:function(a,e){var i=this.getShapeStyle(a),s="".concat(this.type,"-keyShape"),l=e.addShape("circle",{attrs:i,className:"".concat(this.type,"-keyShape"),name:s,draggable:!0});return e.shapeMap[s]=l,l},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,_.deepMix)({},e,i),l=this.getSize(a),f=l[0]/2,d=(0,O.__assign)({x:0,y:0,r:f},s);return d},update:function(a,e,i){var s=this.getSize(a),l={stroke:a.color,r:s[0]/2},f=e.get("keyShape"),d=(0,_.deepMix)({},f.attr(),l,a.style);this.updateShape(a,e,d,!0,i)}},"single-node"),Gr.registerNode("simple-rect",{options:{size:[100,30],style:{radius:0,stroke:Ae.defaultNode.style.stroke,fill:Ae.defaultNode.style.fill,lineWidth:Ae.defaultNode.style.lineWidth},labelCfg:{style:{fill:Ae.nodeLabel.style.fill,fontSize:Ae.nodeLabel.style.fontSize,fontFamily:Ae.windowFontFamily}},anchorPoints:[[0,.5],[1,.5]],stateStyles:(0,O.__assign)({},Ae.nodeStateStyles)},shapeType:"simple-rect",labelPosition:"center",drawShape:function(a,e){var i=this.getShapeStyle(a),s=e.addShape("rect",{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return s},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,_.mix)({},e,i),l=this.getSize(a),f=s.width||l[0],d=s.height||l[1],v=(0,O.__assign)({x:-f/2,y:-d/2,width:f,height:d},s);return v},update:function(a,e,i){var s=e.getContainer(),l=(this.mergeStyle||this.getOptions(a)).style,f=this.getSize(a),d=e.get("keyShape");a.size||(f[0]=d.attr("width")||l.width,f[1]=d.attr("height")||l.height);var v={stroke:a.color,x:-f[0]/2,y:-f[1]/2,width:f[0],height:f[1]},w=(0,_.mix)({},l,d.attr(),v);w=(0,_.mix)(w,a.style),this.updateShape(a,e,w,!1,i)}},"single-node"),Gr.registerNode("image",{options:{img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*eD7nT6tmYgAAAAAAAAAAAABkARQnAQ",size:200,labelCfg:{style:{fontFamily:Ae.windowFontFamily}},clipCfg:{show:!1,type:"circle",r:50,rx:50,ry:35,width:50,height:35,points:[[30,12],[12,30],[30,48],[48,30]],path:[["M",25,25],["L",50,25],["A",12.5,12.5,0,1,1,50,50],["A",12.5,12.5,0,1,0,50,50],["L",25,75],["Z"]],x:0,y:0}},shapeType:"image",labelPosition:"bottom",drawShape:function(a,e){var i=this.shapeType,s=this.getShapeStyle(a);delete s.fill;var l=e.addShape(i,{attrs:s,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return this.drawClip(a,l),l},drawClip:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).clipCfg;if(!!i.show){var s=i.type,l=i.x,f=i.y,d=i.style;if(s==="circle"){var v=i.r;e.setClip({type:"circle",attrs:(0,O.__assign)({r:v,x:l,y:f},d)})}else if(s==="rect"){var w=i.width,E=i.height,T=l-w/2,G=f-E/2;e.setClip({type:"rect",attrs:(0,O.__assign)({x:T,y:G,width:w,height:E},d)})}else if(s==="ellipse"){var U=i.rx,et=i.ry;e.setClip({type:"ellipse",attrs:(0,O.__assign)({x:l,y:f,rx:U,ry:et},d)})}else if(s==="polygon"){var ct=i.points;e.setClip({type:"polygon",attrs:(0,O.__assign)({points:ct},d)})}else if(s==="path"){var Ct=i.path;e.setClip({type:"path",attrs:(0,O.__assign)({path:Ct},d)})}}},getShapeStyle:function(a){var e=this.mergeStyle||this.getOptions(a),i=e.style,s=e.img,l=this.getSize(a),f=l[0],d=l[1];i&&(f=i.width||l[0],d=i.height||l[1]);var v=(0,O.__assign)({x:-f/2,y:-d/2,width:f,height:d,img:s},i);return v},updateShapeStyle:function(a,e){var i=e.getContainer(),s="".concat(this.itemType,"-shape"),l=i.shapeMap[s]||i.find(function(d){return d.get("className")===s})||e.getKeyShape(),f=this.getShapeStyle(a);l&&!l.destroyed&&l.attr(f)}},"single-node");var R1={triangle:function(a,e,i){a===void 0&&(a=10),e===void 0&&(e=15),i===void 0&&(i=0);var s=i*2,l="M ".concat(s,",0 L ").concat(s+e,",-").concat(a/2," L ").concat(s+e,",").concat(a/2," Z");return l},vee:function(a,e,i){a===void 0&&(a=15),e===void 0&&(e=20),i===void 0&&(i=0);var s=i*2,l="M ".concat(s,",0 L ").concat(s+e,",-").concat(a/2,`
        L `).concat(s+2*e/3,",0 L ").concat(s+e,",").concat(a/2," Z");return l},circle:function(a,e){a===void 0&&(a=5),e===void 0&&(e=0);var i=e*2,s="M ".concat(i,`, 0
            a `).concat(a,",").concat(a," 0 1,0 ").concat(a*2,`,0
            a `).concat(a,",").concat(a," 0 1,0 ").concat(-a*2,",0");return s},rect:function(a,e,i){a===void 0&&(a=10),e===void 0&&(e=10),i===void 0&&(i=0);var s=i*2,l="M ".concat(s,",").concat(-a/2,` 
        L `).concat(s+e,",").concat(-a/2,` 
        L `).concat(s+e,",").concat(a/2,` 
        L `).concat(s,",").concat(a/2," Z");return l},diamond:function(a,e,i){a===void 0&&(a=15),e===void 0&&(e=15),i===void 0&&(i=0);var s=i*2,l="M ".concat(s,`,0 
        L `).concat(s+e/2,",").concat(-a/2,` 
        L `).concat(s+e,`,0 
        L `).concat(s+e/2,",").concat(a/2," Z");return l},triangleRect:function(a,e,i,s,l,f){a===void 0&&(a=15),e===void 0&&(e=15),i===void 0&&(i=15),s===void 0&&(s=3),l===void 0&&(l=5),f===void 0&&(f=0);var d=f*2,v=d+e+l,w="M ".concat(d,",0 L ").concat(d+e,",-").concat(a/2," L ").concat(d+e,",").concat(a/2,` Z
            M `).concat(v,", -").concat(i/2,`
            L `).concat(v+s," -").concat(i/2,`
            L `).concat(v+s," ").concat(i/2,`
            L `).concat(v," ").concat(i/2,`
            Z`);return w}},Bx={collapse:function(a,e,i){return[["M",a-i,e],["a",i,i,0,1,0,i*2,0],["a",i,i,0,1,0,-i*2,0],["M",a-i+4,e],["L",a+i-4,e]]},expand:function(a,e,i){return[["M",a-i,e],["a",i,i,0,1,0,i*2,0],["a",i,i,0,1,0,-i*2,0],["M",a-i+4,e],["L",a-i+2*i-4,e],["M",a-i+i,e-i+4],["L",a,e+i-4]]},upTriangle:function(a,e,i){var s=i*Math.cos(Math.PI/6),l=i*Math.sin(Math.PI/6);return[["M",a-s,e+l],["L",a+s,e+l],["L",a,e-i],["Z"]]},downTriangle:function(a,e,i){var s=i*Math.cos(Math.PI/6),l=i*Math.sin(Math.PI/6);return[["M",a-s,e-l],["L",a+s,e-l],["L",a,e+i],["Z"]]}},Bv=Gr,IS=["#5F95FF","#61DDAA","#65789B","#F6BD16","#7262FD","#78D3F8","#9661BC","#F6903D","#008685","#F08BB4"],vm=function(a){return a==="force"||a==="g6force"||a==="gForce"||a==="force2"},TS=ie,Zm=(0,O.__assign)((0,O.__assign)((0,O.__assign)((0,O.__assign)((0,O.__assign)((0,O.__assign)((0,O.__assign)({},Z),j),L),tt),P),C),{transform:TS,mat3:ot}),Zf=Zm,og=function(){function c(a){this.graph=a,this.layoutCfg=a.get("layout")||{},this.layoutType=this.getLayoutType(),this.layoutMethods=[],this.initLayout()}return c.prototype.initLayout=function(){},c.prototype.getLayoutType=function(){return this.getLayoutCfgType(this.layoutCfg)},c.prototype.getLayoutCfgType=function(a){var e=a.type;if(e)return e;var i=a.pipes;return Array.isArray(i)?i.map(function(s){return(s==null?void 0:s.type)||""}):null},c.prototype.isLayoutTypeSame=function(a){var e=this.getLayoutCfgType(a),i=Array.isArray(this.layoutType),s=Array.isArray(e);return i&&s?this.layoutType.every(function(l,f){return l===e[f]}):Array.isArray(e)||Array.isArray(this.layoutType)?!1:(a==null?void 0:a.type)===this.layoutType},c.prototype.refreshLayout=function(){var a=this,e=a.graph,i=a.layoutType,s=a.layoutCfg,l=s===void 0?{}:s;if(!!e){var f=l.animate,d=f===void 0&&(i==="force"||i==="force2"),v=vm(i)&&(f||d);e.get("animate")&&!v?e.positionsAnimate(i==="comboCombined"):e.refreshPositions(i==="comboCombined")}},c.prototype.changeLayout=function(a){var e=a.disableTriggerLayout,i=(0,O.__rest)(a,["disableTriggerLayout"]);this.layoutCfg=i,this.layoutType=i.type||this.layoutType,!e&&this.layout()},c.prototype.changeData=function(a){this.layout(a)},c.prototype.destoryLayoutMethods=function(){var a=this.layoutMethods,e=[];return a==null||a.forEach(function(i){var s,l=(s=i.getType)===null||s===void 0?void 0:s.call(i);l&&e.push(l),i.destroy()}),this.layoutMethods=[],e},c.prototype.destroyLayout=function(){this.destoryLayoutMethods();var a=this.graph;a&&!a.get("destroyed")&&a.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0},c.prototype.setDataFromGraph=function(){for(var a,e=[],i=[],s=[],l=[],f=[],d=[],v=[],w=this.graph.getNodes(),E=this.graph.getEdges(),T=this.graph.getCombos(),G=w.length,U=0;U<G;U++){var et=w[U];if(!(!et||et.destroyed)){var ct=et.getModel();if(!et.isVisible()){i.push(ct);continue}e.push(ct)}}for(var Ct=E.length,U=0;U<Ct;U++){var Mt=E[U];if(!(!Mt||Mt.destroyed)){var ct=Mt.getModel();if(!Mt.isVisible()){l.push(ct);continue}ct.isComboEdge?f.push(ct):s.push(ct)}}for(var Dt=T.length,U=0;U<Dt;U++){var zt=T[U];if(!zt.destroyed){var ct=zt.getModel();if(!zt.isVisible()){v.push(ct);continue}d.push(ct)}}return{nodes:e,hiddenNodes:i,edges:s,hiddenEdges:l,combos:d,hiddenCombos:v,comboEdges:f,vedges:(a=this.graph.get("vedges"))===null||a===void 0?void 0:a.map(function(Qt){return Qt.getModel()})}},c.prototype.relayout=function(a){var e=this,i=this,s=i.graph,l=i.layoutMethods,f=i.layoutCfg;if(!(!s||s.get("destroyed"))){var d=Promise.resolve();if(a){this.data=this.setDataFromGraph();var v=this.data.nodes;if(!v)return!1;d=this.initPositions(f.center,v)}s.emit("beforelayout"),l==null||l.forEach(function(w,E){var T=f[E]||f;d=d.then(function(){var G,U=e.execLayoutMethod(T,E);return E===l.length-1&&((G=f.onAllLayoutEnd)===null||G===void 0||G.call(f)),U})})}},c.prototype.filterLayoutData=function(a,e){var i=a.nodes,s=a.edges,l=(0,O.__rest)(a,["nodes","edges"]);if(!i)return a;var f,d;(0,_.isFunction)(e==null?void 0:e.nodesFilter)?f=e.nodesFilter:f=function(){return!0};var v=i.filter(f);if((0,_.isFunction)(e==null?void 0:e.edgesFilter))d=e.edgesFilter;else{var w=v.reduce(function(E,T){return E[T.id]=!0,E},{});d=function(T){return w[T.source]&&w[T.target]}}return(0,O.__assign)({nodes:v,edges:s.filter(d)},l)},c.prototype.getLayoutBBox=function(a){var e=this.graph,i=(0,_.groupBy)(e.getNodes(),function(f){return f.getModel().layoutOrder}),s=Object.values(i).map(function(f){var d=_t(f);return d.size=[d.width,d.height],d}),l=Object.values((0,_.groupBy)(a,"layoutOrder"));return{groupNodes:l,layoutNodes:s}},c.prototype.layoutAnimate=function(){},c.prototype.moveToZero=function(){var a=this.graph,e=a.get("data"),i=e.nodes;if(!(i[0].x===void 0||i[0].x===null||xt(i[0].x))){for(var s=[0,0],l=i.length,f=0;f<l;f++){var d=i[f];s[0]+=d.x,s[1]+=d.y}s[0]/=i.length,s[1]/=i.length;for(var f=0;f<l;f++){var d=i[f];d.x-=s[0],d.y-=s[1]}}},c.prototype.initPositions=function(a,e){var i;return(0,O.__awaiter)(this,void 0,void 0,function(){var s,l,f;return(0,O.__generator)(this,function(d){return s=this.graph,(e==null?void 0:e.length)?(l=e.filter(function(v){return xt(v.x)||xt(v.y)}),f=l?l.length:0,f?[2,(i=this.initWithPreset)===null||i===void 0?void 0:i.call(this,function(){},function(){var v=s.get("width")*.85,w=s.get("height")*.85,E=Math.ceil(Math.sqrt(f)*(v/w)),T=Math.ceil(f/E),G=v/(E-1),U=w/(T-1);(!isFinite(G)||!G)&&(G=0),(!isFinite(U)||!G)&&(U=0);for(var et=a[0]-v/2,ct=a[1]-w/2,Ct=!0,Mt=0;Mt<f;Mt++){var Dt=l[Mt];xt(+Dt.x)&&(Ct=!1,Dt.x=Mt%E*G+et),xt(+Dt.y)&&(Ct=!1,Dt.y=Math.floor(Mt/E)*U+ct)}})]:[2]):[2,Promise.resolve()]})})},c.prototype.destroy=function(){this.graph=null,this.destoryLayoutMethods(),this.destroyed=!0},c}(),L1=og,AS=function(){function c(a){this.graph=a,this.destroyed=!1,this.initEvents()}return c}(),J0=AS,zv=Bv.registerNode,Oh=Bv.registerEdge,MS=Bv.registerCombo,qm=ut.registerBehavior,$i=Ae,Ic={version:Ae.version,AbstractGraph:Lx,BaseGlobal:$i,Util:Zf,Shape:Bv,Node:So,Edge:$o,Combo:Cu,Hull:Rx,registerNode:Bv.registerNode,registerEdge:Bv.registerEdge,registerCombo:Bv.registerCombo,registerBehavior:ut.registerBehavior,Arrow:R1,Marker:Bx,AbstractLayout:L1,AbstractEvent:J0},NS=$(10369);function gm(){return window?window.devicePixelRatio:1}function zx(c,a,e,i){var s=c-e,l=a-i;return Math.sqrt(s*s+l*l)}function sg(c,a,e,i,s,l){return s>=c&&s<=c+e&&l>=a&&l<=a+i}function Qm(c,a){return!(a.minX>c.maxX||a.maxX<c.minX||a.minY>c.maxY||a.maxY<c.minY)}function Sd(c,a){return!c||!a?c||a:{minX:Math.min(c.minX,a.minX),minY:Math.min(c.minY,a.minY),maxX:Math.max(c.maxX,a.maxX),maxY:Math.max(c.maxY,a.maxY)}}function $x(c,a){return c[0]===a[0]&&c[1]===a[1]}var ss=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,kS=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,ty=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,ey=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function P1(c,a){var e=c.match(ey);(0,_.each)(e,function(i){var s=i.split(":");a.addColorStop(s[0],s[1])})}function yf(c,a,e){var i=ss.exec(e),s=parseFloat(i[1])%360*(Math.PI/180),l=i[2],f=a.getBBox(),d,v;s>=0&&s<1/2*Math.PI?(d={x:f.minX,y:f.minY},v={x:f.maxX,y:f.maxY}):1/2*Math.PI<=s&&s<Math.PI?(d={x:f.maxX,y:f.minY},v={x:f.minX,y:f.maxY}):Math.PI<=s&&s<3/2*Math.PI?(d={x:f.maxX,y:f.maxY},v={x:f.minX,y:f.minY}):(d={x:f.minX,y:f.maxY},v={x:f.maxX,y:f.minY});var w=Math.tan(s),E=w*w,T=(v.x-d.x+w*(v.y-d.y))/(E+1)+d.x,G=w*(v.x-d.x+w*(v.y-d.y))/(E+1)+d.y,U=c.createLinearGradient(d.x,d.y,T,G);return P1(l,U),U}function zc(c,a,e){var i=kS.exec(e),s=parseFloat(i[1]),l=parseFloat(i[2]),f=parseFloat(i[3]),d=i[4];if(f===0){var v=d.match(ey);return v[v.length-1].split(":")[1]}var w=a.getBBox(),E=w.maxX-w.minX,T=w.maxY-w.minY,G=Math.sqrt(E*E+T*T)/2,U=c.createRadialGradient(w.minX+E*s,w.minY+T*l,0,w.minX+E/2,w.minY+T/2,f*G);return P1(d,U),U}function Pf(c,a,e){if(a.get("patternSource")&&a.get("patternSource")===e)return a.get("pattern");var i,s,l=ty.exec(e),f=l[1],d=l[2];function v(){i=c.createPattern(s,f),a.set("pattern",i),a.set("patternSource",e)}switch(f){case"a":f="repeat";break;case"x":f="repeat-x";break;case"y":f="repeat-y";break;case"n":f="no-repeat";break;default:f="no-repeat"}return s=new Image,d.match(/^data:/i)||(s.crossOrigin="Anonymous"),s.src=d,s.complete?v():(s.onload=v,s.src=s.src),i}function $c(c,a,e){var i=a.getBBox();if(isNaN(i.x)||isNaN(i.y)||isNaN(i.width)||isNaN(i.height))return e;if((0,_.isString)(e)){if(e[1]==="("||e[2]==="("){if(e[0]==="l")return yf(c,a,e);if(e[0]==="r")return zc(c,a,e);if(e[0]==="p")return Pf(c,a,e)}return e}if(e instanceof CanvasPattern)return e}function mm(c){var a=0,e=0,i=0,s=0;return(0,_.isArray)(c)?c.length===1?a=e=i=s=c[0]:c.length===2?(a=i=c[0],e=s=c[1]):c.length===3?(a=c[0],e=s=c[1],i=c[2]):(a=c[0],e=c[1],i=c[2],s=c[3]):a=e=i=s=c,[a,e,i,s]}function gc(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function F1(c,a){return gc(c)*gc(a)?(c[0]*a[0]+c[1]*a[1])/(gc(c)*gc(a)):1}function ny(c,a){return(c[0]*a[1]<c[1]*a[0]?-1:1)*Math.acos(F1(c,a))}function Gx(c,a){var e=a[1],i=a[2],s=(0,_.mod)((0,_.toRadian)(a[3]),Math.PI*2),l=a[4],f=a[5],d=c[0],v=c[1],w=a[6],E=a[7],T=Math.cos(s)*(d-w)/2+Math.sin(s)*(v-E)/2,G=-1*Math.sin(s)*(d-w)/2+Math.cos(s)*(v-E)/2,U=T*T/(e*e)+G*G/(i*i);U>1&&(e*=Math.sqrt(U),i*=Math.sqrt(U));var et=e*e*(G*G)+i*i*(T*T),ct=et?Math.sqrt((e*e*(i*i)-et)/et):1;l===f&&(ct*=-1),isNaN(ct)&&(ct=0);var Ct=i?ct*e*G/i:0,Mt=e?ct*-i*T/e:0,Dt=(d+w)/2+Math.cos(s)*Ct-Math.sin(s)*Mt,zt=(v+E)/2+Math.sin(s)*Ct+Math.cos(s)*Mt,Qt=[(T-Ct)/e,(G-Mt)/i],Ie=[(-1*T-Ct)/e,(-1*G-Mt)/i],je=ny([1,0],Qt),ze=ny(Qt,Ie);return F1(Qt,Ie)<=-1&&(ze=Math.PI),F1(Qt,Ie)>=1&&(ze=0),f===0&&ze>0&&(ze=ze-2*Math.PI),f===1&&ze<0&&(ze=ze+2*Math.PI),{cx:Dt,cy:zt,rx:$x(c,[w,E])?0:e,ry:$x(c,[w,E])?0:i,startAngle:je,endAngle:je+ze,xRotation:s,arcFlag:l,sweepFlag:f}}var Rh=Math.sin,ry=Math.cos,kg=Math.atan2,ay=Math.PI;function Jm(c,a,e,i,s,l,f){var d=a.stroke,v=a.lineWidth,w=e-s,E=i-l,T=kg(E,w),G=new V1({type:"path",canvas:c.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*ry(ay/6)+","+10*Rh(ay/6)+" L0,0 L"+10*ry(ay/6)+",-"+10*Rh(ay/6),stroke:d,lineWidth:v}});G.translate(s,l),G.rotateAtPoint(s,l,T),c.set(f?"startArrowShape":"endArrowShape",G)}function Ux(c,a,e,i,s,l,f){var d=a.startArrow,v=a.endArrow,w=a.stroke,E=a.lineWidth,T=f?d:v,G=T.d,U=T.fill,et=T.stroke,ct=T.lineWidth,Ct=(0,O.__rest)(T,["d","fill","stroke","lineWidth"]),Mt=e-s,Dt=i-l,zt=kg(Dt,Mt);G&&(s=s-ry(zt)*G,l=l-Rh(zt)*G);var Qt=new V1({type:"path",canvas:c.get("canvas"),isArrowShape:!0,attrs:(0,O.__assign)((0,O.__assign)({},Ct),{stroke:et||w,lineWidth:ct||E,fill:U})});Qt.translate(s,l),Qt.rotateAtPoint(s,l,zt),c.set(f?"startArrowShape":"endArrowShape",Qt)}function ug(c,a,e,i,s){var l=kg(i-a,e-c);return{dx:ry(l)*s,dy:Rh(l)*s}}function B1(c,a,e,i,s,l){typeof a.startArrow=="object"?Ux(c,a,e,i,s,l,!0):a.startArrow?Jm(c,a,e,i,s,l,!0):c.set("startArrowShape",null)}function Dg(c,a,e,i,s,l){typeof a.endArrow=="object"?Ux(c,a,e,i,s,l,!1):a.endArrow?Jm(c,a,e,i,s,l,!1):c.set("startArrowShape",null)}var Wx={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function lg(c,a){var e=a.attr();for(var i in e){var s=e[i],l=Wx[i]?Wx[i]:i;l==="matrix"&&s?c.transform(s[0],s[1],s[3],s[4],s[6],s[7]):l==="lineDash"&&c.setLineDash?(0,_.isArray)(s)&&c.setLineDash(s):(l==="strokeStyle"||l==="fillStyle"?s=$c(c,a,s):l==="globalAlpha"&&(s=s*c.globalAlpha),c[l]=s)}}function z1(c,a,e){for(var i=0;i<a.length;i++){var s=a[i];s.cfg.visible?s.draw(c,e):s.skipDraw()}}function Vx(c,a,e){var i=c.get("refreshElements");(0,_.each)(i,function(s){if(s!==c)for(var l=s.cfg.parent;l&&l!==c&&!l.cfg.refresh;)l.cfg.refresh=!0,l=l.cfg.parent}),i[0]===c?G1(a,e):$1(a,e)}function $1(c,a){for(var e=0;e<c.length;e++){var i=c[e];if(i.cfg.visible)if(i.cfg.hasChanged)i.cfg.refresh=!0,i.isGroup()&&G1(i.cfg.children,a);else if(i.cfg.refresh)i.isGroup()&&$1(i.cfg.children,a);else{var s=ym(i,a);i.cfg.refresh=s,s&&i.isGroup()&&$1(i.cfg.children,a)}}}function cc(c){for(var a=0;a<c.length;a++){var e=c[a];e.cfg.hasChanged=!1,e.isGroup()&&!e.destroyed&&cc(e.cfg.children)}}function G1(c,a){for(var e=0;e<c.length;e++){var i=c[e];!i.cfg.visible||(i.cfg.refresh=!0,i.isGroup()&&G1(i.get("children"),a))}}function ym(c,a){var e=c.cfg.cacheCanvasBBox,i=c.cfg.isInView&&e&&Qm(e,a);return i}function jx(c,a,e,i){var s=e.path,l=e.startArrow,f=e.endArrow;if(!!s){var d=[0,0],v=[0,0],w={dx:0,dy:0};a.beginPath();for(var E=0;E<s.length;E++){var T=s[E],G=T[0];if(E===0&&l&&l.d){var U=c.getStartTangent();w=ug(U[0][0],U[0][1],U[1][0],U[1][1],l.d)}else if(E===s.length-2&&s[E+1][0]==="Z"&&f&&f.d){var et=s[E+1];if(et[0]==="Z"){var U=c.getEndTangent();w=ug(U[0][0],U[0][1],U[1][0],U[1][1],f.d)}}else if(E===s.length-1&&f&&f.d&&s[0]!=="Z"){var U=c.getEndTangent();w=ug(U[0][0],U[0][1],U[1][0],U[1][1],f.d)}var ct=w.dx,Ct=w.dy;switch(G){case"M":a.moveTo(T[1]-ct,T[2]-Ct),v=[T[1],T[2]];break;case"L":a.lineTo(T[1]-ct,T[2]-Ct);break;case"Q":a.quadraticCurveTo(T[1],T[2],T[3]-ct,T[4]-Ct);break;case"C":a.bezierCurveTo(T[1],T[2],T[3],T[4],T[5]-ct,T[6]-Ct);break;case"A":{var Mt=void 0;i?(Mt=i[E],Mt||(Mt=Gx(d,T),i[E]=Mt)):Mt=Gx(d,T);var Dt=Mt.cx,zt=Mt.cy,Qt=Mt.rx,Ie=Mt.ry,je=Mt.startAngle,ze=Mt.endAngle,mn=Mt.xRotation,$n=Mt.sweepFlag;if(a.ellipse)a.ellipse(Dt,zt,Qt,Ie,mn,je,ze,1-$n);else{var Tn=Qt>Ie?Qt:Ie,or=Qt>Ie?1:Qt/Ie,kr=Qt>Ie?Ie/Qt:1;a.translate(Dt,zt),a.rotate(mn),a.scale(or,kr),a.arc(0,0,Tn,je,ze,1-$n),a.scale(1/or,1/kr),a.rotate(-mn),a.translate(-Dt,-zt)}break}case"Z":a.closePath();break;default:break}if(G==="Z")d=v;else{var Ta=T.length;d=[T[Ta-2],T[Ta-1]]}}}}function cg(c,a){var e=c.get("canvas");e&&(a==="remove"&&(c._cacheCanvasBBox=c.get("cacheCanvasBBox")),c.get("hasChanged")||(c.set("hasChanged",!0),c.cfg.parent&&c.cfg.parent.get("hasChanged")||(e.refreshElement(c,a,e),e.get("autoDraw")&&e.draw())))}function DS(c){var a;if(c.destroyed)a=c._cacheCanvasBBox;else{var e=c.get("cacheCanvasBBox"),i=e&&!!(e.width&&e.height),s=c.getCanvasBBox(),l=s&&!!(s.width&&s.height);i&&l?a=Sd(e,s):i?a=e:l&&(a=s)}return a}function U1(c){if(!c.length)return null;var a=[],e=[],i=[],s=[];return(0,_.each)(c,function(l){var f=DS(l);f&&(a.push(f.minX),e.push(f.minY),i.push(f.maxX),s.push(f.maxY))}),{minX:(0,_.min)(a),minY:(0,_.min)(e),maxX:(0,_.max)(i),maxY:(0,_.max)(s)}}function OS(c,a){return!c||!a||!Qm(c,a)?null:{minX:Math.max(c.minX,a.minX),minY:Math.max(c.minY,a.minY),maxX:Math.min(c.maxX,a.maxX),maxY:Math.min(c.maxY,a.maxY)}}var iy=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.onCanvasChange=function(e){cg(this,e)},a.prototype.getShapeBase=function(){return M},a.prototype.getGroupBase=function(){return a},a.prototype._applyClip=function(e,i){i&&(e.save(),lg(e,i),i.createPath(e),e.restore(),e.clip(),i._afterDraw())},a.prototype.cacheCanvasBBox=function(){var e=this.cfg.children,i=[],s=[];(0,_.each)(e,function(G){var U=G.cfg.cacheCanvasBBox;U&&G.cfg.isInView&&(i.push(U.minX,U.maxX),s.push(U.minY,U.maxY))});var l=null;if(i.length){var f=(0,_.min)(i),d=(0,_.max)(i),v=(0,_.min)(s),w=(0,_.max)(s);l={minX:f,minY:v,x:f,y:v,maxX:d,maxY:w,width:d-f,height:w-v};var E=this.cfg.canvas;if(E){var T=E.getViewRange();this.set("isInView",Qm(l,T))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",l)},a.prototype.draw=function(e,i){var s=this.cfg.children,l=i?this.cfg.refresh:!0;s.length&&l&&(e.save(),lg(e,this),this._applyClip(e,this.getClip()),z1(e,s,i),e.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},a.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},a}(av),Hx=iy,oy=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},a.prototype.getShapeBase=function(){return M},a.prototype.getGroupBase=function(){return Hx},a.prototype.onCanvasChange=function(e){cg(this,e)},a.prototype.calculateBBox=function(){var e=this.get("type"),i=this.getHitLineWidth(),s=ag(e),l=s(this),f=i/2,d=l.x-f,v=l.y-f,w=l.x+l.width+f,E=l.y+l.height+f;return{x:d,minX:d,y:v,minY:v,width:l.width+i,height:l.height+i,maxX:w,maxY:E}},a.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},a.prototype.isStroke=function(){return!!this.attrs.stroke},a.prototype._applyClip=function(e,i){i&&(e.save(),lg(e,i),i.createPath(e),e.restore(),e.clip(),i._afterDraw())},a.prototype.draw=function(e,i){var s=this.cfg.clipShape;if(i){if(this.cfg.refresh===!1){this.set("hasChanged",!1);return}var l=this.getCanvasBBox();if(!Qm(i,l)){this.set("hasChanged",!1),this.cfg.isInView&&this._afterDraw();return}}e.save(),lg(e,this),this._applyClip(e,s),this.drawPath(e),e.restore(),this._afterDraw()},a.prototype.getCanvasViewBox=function(){var e=this.cfg.canvas;return e?e.getViewRange():null},a.prototype.cacheCanvasBBox=function(){var e=this.getCanvasViewBox();if(e){var i=this.getCanvasBBox(),s=Qm(i,e);this.set("isInView",s),s?this.set("cacheCanvasBBox",i):this.set("cacheCanvasBBox",null)}},a.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},a.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},a.prototype.drawPath=function(e){this.createPath(e),this.strokeAndFill(e),this.afterDrawPath(e)},a.prototype.fill=function(e){e.fill()},a.prototype.stroke=function(e){e.stroke()},a.prototype.strokeAndFill=function(e){var i=this.attrs,s=i.lineWidth,l=i.opacity,f=i.strokeOpacity,d=i.fillOpacity;this.isFill()&&(!(0,_.isNil)(d)&&d!==1?(e.globalAlpha=d,this.fill(e),e.globalAlpha=l):this.fill(e)),this.isStroke()&&s>0&&(!(0,_.isNil)(f)&&f!==1&&(e.globalAlpha=f),this.stroke(e)),this.afterDrawPath(e)},a.prototype.createPath=function(e){},a.prototype.afterDrawPath=function(e){},a.prototype.isInShape=function(e,i){var s=this.isStroke(),l=this.isFill(),f=this.getHitLineWidth();return this.isInStrokeOrPath(e,i,s,l,f)},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){return!1},a.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var e=this.attrs;return e.lineWidth+e.lineAppendWidth},a}(qd),Tp=oy,RS=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x:0,y:0,r:0})},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){var d=this.attr(),v=d.x,w=d.y,E=d.r,T=f/2,G=zx(v,w,e,i);return l&&s?G<=E+T:l?G<=E:s?G>=E-T&&G<=E+T:!1},a.prototype.createPath=function(e){var i=this.attr(),s=i.x,l=i.y,f=i.r;e.beginPath(),e.arc(s,l,f,0,Math.PI*2,!1),e.closePath()},a}(Tp),LS=RS;function t0(c,a,e,i){return c/(e*e)+a/(i*i)}var PS=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x:0,y:0,rx:0,ry:0})},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){var d=this.attr(),v=f/2,w=d.x,E=d.y,T=d.rx,G=d.ry,U=(e-w)*(e-w),et=(i-E)*(i-E);return l&&s?t0(U,et,T+v,G+v)<=1:l?t0(U,et,T,G)<=1:s?t0(U,et,T-v,G-v)>=1&&t0(U,et,T+v,G+v)<=1:!1},a.prototype.createPath=function(e){var i=this.attr(),s=i.x,l=i.y,f=i.rx,d=i.ry;if(e.beginPath(),e.ellipse)e.ellipse(s,l,f,d,0,0,Math.PI*2,!1);else{var v=f>d?f:d,w=f>d?1:f/d,E=f>d?d/f:1;e.save(),e.translate(s,l),e.scale(w,E),e.arc(0,0,v,0,Math.PI*2),e.restore(),e.closePath()}},a}(Tp),fg=PS;function Tc(c){return c instanceof HTMLElement&&(0,_.isString)(c.nodeName)&&c.nodeName.toUpperCase()==="CANVAS"}var sv=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x:0,y:0,width:0,height:0})},a.prototype.initAttrs=function(e){this._setImage(e.img)},a.prototype.isStroke=function(){return!1},a.prototype.isOnlyHitBox=function(){return!0},a.prototype._afterLoading=function(){if(this.get("toDraw")===!0){var e=this.get("canvas");e?e.draw():this.createPath(this.get("context"))}},a.prototype._setImage=function(e){var i=this,s=this.attrs;if((0,_.isString)(e)){var l=new Image;l.onload=function(){if(i.destroyed)return!1;i.attr("img",l),i.set("loading",!1),i._afterLoading();var f=i.get("callback");f&&f.call(i)},l.crossOrigin="Anonymous",l.src=e,this.set("loading",!0)}else e instanceof Image?(s.width||(s.width=e.width),s.height||(s.height=e.height)):Tc(e)&&(s.width||(s.width=Number(e.getAttribute("width"))),s.height||(s.height,Number(e.getAttribute("height"))))},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),e==="img"&&this._setImage(i)},a.prototype.createPath=function(e){if(this.get("loading")){this.set("toDraw",!0),this.set("context",e);return}var i=this.attr(),s=i.x,l=i.y,f=i.width,d=i.height,v=i.sx,w=i.sy,E=i.swidth,T=i.sheight,G=i.img;(G instanceof Image||Tc(G))&&(!(0,_.isNil)(v)&&!(0,_.isNil)(w)&&!(0,_.isNil)(E)&&!(0,_.isNil)(T)?e.drawImage(G,v,w,E,T,s,l,f,d):e.drawImage(G,s,l,f,d))},a}(Tp),FS=sv;function Zc(c,a,e,i,s,l,f){var d=Math.min(c,e),v=Math.max(c,e),w=Math.min(a,i),E=Math.max(a,i),T=s/2;return l>=d-T&&l<=v+T&&f>=w-T&&f<=E+T?da.pointToLine(c,a,e,i,l,f)<=s/2:!1}var BS=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},a.prototype.initAttrs=function(e){this.setArrow()},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),this.setArrow()},a.prototype.setArrow=function(){var e=this.attr(),i=e.x1,s=e.y1,l=e.x2,f=e.y2,d=e.startArrow,v=e.endArrow;d&&B1(this,e,l,f,i,s),v&&Dg(this,e,i,s,l,f)},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){if(!s||!f)return!1;var d=this.attr(),v=d.x1,w=d.y1,E=d.x2,T=d.y2;return Zc(v,w,E,T,f,e,i)},a.prototype.createPath=function(e){var i=this.attr(),s=i.x1,l=i.y1,f=i.x2,d=i.y2,v=i.startArrow,w=i.endArrow,E={dx:0,dy:0},T={dx:0,dy:0};v&&v.d&&(E=ug(s,l,f,d,i.startArrow.d)),w&&w.d&&(T=ug(s,l,f,d,i.endArrow.d)),e.beginPath(),e.moveTo(s+E.dx,l+E.dy),e.lineTo(f-T.dx,d-T.dy)},a.prototype.afterDrawPath=function(e){var i=this.get("startArrowShape"),s=this.get("endArrowShape");i&&i.draw(e),s&&s.draw(e)},a.prototype.getTotalLength=function(){var e=this.attr(),i=e.x1,s=e.y1,l=e.x2,f=e.y2;return da.length(i,s,l,f)},a.prototype.getPoint=function(e){var i=this.attr(),s=i.x1,l=i.y1,f=i.x2,d=i.y2;return da.pointAt(s,l,f,d,e)},a}(Tp),zS=BS,$S={circle:function(c,a,e){return[["M",c-e,a],["A",e,e,0,1,0,c+e,a],["A",e,e,0,1,0,c-e,a]]},square:function(c,a,e){return[["M",c-e,a-e],["L",c+e,a-e],["L",c+e,a+e],["L",c-e,a+e],["Z"]]},diamond:function(c,a,e){return[["M",c-e,a],["L",c,a-e],["L",c+e,a],["L",c,a+e],["Z"]]},triangle:function(c,a,e){var i=e*Math.sin(1/3*Math.PI);return[["M",c-e,a+i],["L",c,a-i],["L",c+e,a+i],["Z"]]},"triangle-down":function(c,a,e){var i=e*Math.sin(1/3*Math.PI);return[["M",c-e,a-i],["L",c+e,a-i],["L",c,a+i],["Z"]]}},$v=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.initAttrs=function(e){this._resetParamsCache()},a.prototype._resetParamsCache=function(){this.set("paramsCache",{})},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),["symbol","x","y","r","radius"].indexOf(e)!==-1&&this._resetParamsCache()},a.prototype.isOnlyHitBox=function(){return!0},a.prototype._getR=function(e){return(0,_.isNil)(e.r)?e.radius:e.r},a.prototype._getPath=function(){var e=this.attr(),i=e.x,s=e.y,l=e.symbol||"circle",f=this._getR(e),d,v;if((0,_.isFunction)(l))d=l,v=d(i,s,f),v=mr(v);else{if(d=a.Symbols[l],!d)return console.warn(l+" marker is not supported."),null;v=d(i,s,f)}return v},a.prototype.createPath=function(e){var i=this._getPath(),s=this.get("paramsCache");jx(this,e,{path:i},s)},a.Symbols=$S,a}(Tp),GS=$v;function Xx(c,a,e){var i=zi();return c.createPath(i),i.isPointInPath(a,e)}var US=1e-6;function W1(c){return Math.abs(c)<US?0:c<0?-1:1}function WS(c,a,e){return(e[0]-c[0])*(a[1]-c[1])==(a[0]-c[0])*(e[1]-c[1])&&Math.min(c[0],a[0])<=e[0]&&e[0]<=Math.max(c[0],a[0])&&Math.min(c[1],a[1])<=e[1]&&e[1]<=Math.max(c[1],a[1])}function Yx(c,a,e){var i=!1,s=c.length;if(s<=2)return!1;for(var l=0;l<s;l++){var f=c[l],d=c[(l+1)%s];if(WS(f,d,[a,e]))return!0;W1(f[1]-e)>0!=W1(d[1]-e)>0&&W1(a-(e-f[1])*(f[0]-d[0])/(f[1]-d[1])-f[0])<0&&(i=!i)}return i}function e0(c,a,e,i,s,l,f,d){var v=(Math.atan2(d-a,f-c)+Math.PI*2)%(Math.PI*2);if(v<i||v>s)return!1;var w={x:c+e*Math.cos(v),y:a+e*Math.sin(v)};return zx(w.x,w.y,f,d)<=l/2}var VS=ie;function jS(c){for(var a=!1,e=c.length,i=0;i<e;i++){var s=c[i],l=s[0];if(l==="C"||l==="A"||l==="Q"){a=!0;break}}return a}function n0(c,a,e,i,s){for(var l=!1,f=a/2,d=0;d<c.length;d++){var v=c[d],w=v.currentPoint,E=v.params,T=v.prePoint,G=v.box;if(!(G&&!sg(G.x-f,G.y-f,G.width+a,G.height+a,e,i))){switch(v.command){case"L":case"Z":l=Zc(T[0],T[1],w[0],w[1],a,e,i);break;case"Q":var U=q.pointDistance(T[0],T[1],E[1],E[2],E[3],E[4],e,i);l=U<=a/2;break;case"C":var et=he.pointDistance(T[0],T[1],E[1],E[2],E[3],E[4],E[5],E[6],e,i,s);l=et<=a/2;break;case"A":var ct=v.arcParams,Ct=ct.cx,Mt=ct.cy,Dt=ct.rx,zt=ct.ry,Qt=ct.startAngle,Ie=ct.endAngle,je=ct.xRotation,ze=[e,i,1],mn=Dt>zt?Dt:zt,$n=Dt>zt?1:Dt/zt,Tn=Dt>zt?zt/Dt:1,or=VS(null,[["t",-Ct,-Mt],["r",-je],["s",1/$n,1/Tn]]);Ys.transformMat3(ze,ze,or),l=e0(0,0,mn,Qt,Ie,a,ze[0],ze[1]);break;default:break}if(l)break}}return l}function HS(c){for(var a=c.length,e=[],i=[],s=[],l=0;l<a;l++){var f=c[l],d=f[0];d==="M"?(s.length&&(i.push(s),s=[]),s.push([f[1],f[2]])):d==="Z"?s.length&&(e.push(s),s=[]):s.push([f[1],f[2]])}return s.length>0&&i.push(s),{polygons:e,polylines:i}}var sy=(0,O.__assign)({hasArc:jS,extractPolygons:HS,isPointInStroke:n0},W);function Kx(c,a,e){for(var i=!1,s=0;s<c.length;s++){var l=c[s];if(i=Yx(l,a,e),i)break}return i}var Zx=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{startArrow:!1,endArrow:!1})},a.prototype.initAttrs=function(e){this._setPathArr(e.path),this.setArrow()},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),e==="path"&&this._setPathArr(i),this.setArrow()},a.prototype._setPathArr=function(e){this.attrs.path=mr(e);var i=sy.hasArc(e);this.set("hasArc",i),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},a.prototype.getSegments=function(){var e=this.get("segements");return e||(e=X0(this.attr("path")),this.set("segments",e)),e},a.prototype.setArrow=function(){var e=this.attr(),i=e.startArrow,s=e.endArrow;if(i){var l=this.getStartTangent();B1(this,e,l[0][0],l[0][1],l[1][0],l[1][1])}if(s){var l=this.getEndTangent();Dg(this,e,l[0][0],l[0][1],l[1][0],l[1][1])}},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){var d=this.getSegments(),v=this.get("hasArc"),w=!1;if(s){var E=this.getTotalLength();w=sy.isPointInStroke(d,f,e,i,E)}if(!w&&l)if(v)w=Xx(this,e,i);else{var T=this.attr("path"),G=sy.extractPolygons(T);w=Kx(G.polygons,e,i)||Kx(G.polylines,e,i)}return w},a.prototype.createPath=function(e){var i=this.attr(),s=this.get("paramsCache");jx(this,e,i,s)},a.prototype.afterDrawPath=function(e){var i=this.get("startArrowShape"),s=this.get("endArrowShape");i&&i.draw(e),s&&s.draw(e)},a.prototype.getTotalLength=function(){var e=this.get("totalLength");return(0,_.isNil)(e)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):e},a.prototype.getPoint=function(e){var i=this.get("tCache");i||(this._calculateCurve(),this._setTcache(),i=this.get("tCache"));var s,l,f=this.get("curve");if(!i||i.length===0)return f?{x:f[0][1],y:f[0][2]}:null;(0,_.each)(i,function(E,T){e>=E[0]&&e<=E[1]&&(s=(e-E[0])/(E[1]-E[0]),l=T)});var d=f[l];if((0,_.isNil)(d)||(0,_.isNil)(l))return null;var v=d.length,w=f[l+1];return he.pointAt(d[v-2],d[v-1],w[1],w[2],w[3],w[4],w[5],w[6],s)},a.prototype._calculateCurve=function(){var e=this.attr().path;this.set("curve",sy.pathToCurve(e))},a.prototype._setTcache=function(){var e=0,i=0,s=[],l,f,d,v,w=this.get("curve");if(!!w){if((0,_.each)(w,function(E,T){d=w[T+1],v=E.length,d&&(e+=he.length(E[v-2],E[v-1],d[1],d[2],d[3],d[4],d[5],d[6])||0)}),this.set("totalLength",e),e===0){this.set("tCache",[]);return}(0,_.each)(w,function(E,T){d=w[T+1],v=E.length,d&&(l=[],l[0]=i/e,f=he.length(E[v-2],E[v-1],d[1],d[2],d[3],d[4],d[5],d[6]),i+=f||0,l[1]=i/e,s.push(l))}),this.set("tCache",s)}},a.prototype.getStartTangent=function(){var e=this.getSegments(),i;if(e.length>1){var s=e[0].currentPoint,l=e[1].currentPoint,f=e[1].startTangent;i=[],f?(i.push([s[0]-f[0],s[1]-f[1]]),i.push([s[0],s[1]])):(i.push([l[0],l[1]]),i.push([s[0],s[1]]))}return i},a.prototype.getEndTangent=function(){var e=this.getSegments(),i=e.length,s;if(i>1){var l=e[i-2].currentPoint,f=e[i-1].currentPoint,d=e[i-1].endTangent;s=[],d?(s.push([f[0]-d[0],f[1]-d[1]]),s.push([f[0],f[1]])):(s.push([l[0],l[1]]),s.push([f[0],f[1]]))}return s},a}(Tp),V1=Zx;function bm(c,a,e,i,s){var l=c.length;if(l<2)return!1;for(var f=0;f<l-1;f++){var d=c[f][0],v=c[f][1],w=c[f+1][0],E=c[f+1][1];if(Zc(d,v,w,E,a,e,i))return!0}if(s){var T=c[0],G=c[l-1];if(Zc(T[0],T[1],G[0],G[1],a,e,i))return!0}return!1}var XS=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.isInStrokeOrPath=function(e,i,s,l,f){var d=this.attr().points,v=!1;return s&&(v=bm(d,f,e,i,!0)),!v&&l&&(v=Yx(d,e,i)),v},a.prototype.createPath=function(e){var i=this.attr(),s=i.points;if(!(s.length<2)){e.beginPath();for(var l=0;l<s.length;l++){var f=s[l];l===0?e.moveTo(f[0],f[1]):e.lineTo(f[0],f[1])}e.closePath()}},a}(Tp),uy=XS,YS=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{startArrow:!1,endArrow:!1})},a.prototype.initAttrs=function(e){this.setArrow()},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),this.setArrow(),["points"].indexOf(e)!==-1&&this._resetCache()},a.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},a.prototype.setArrow=function(){var e=this.attr(),i=this.attrs,s=i.points,l=i.startArrow,f=i.endArrow,d=s.length,v=s[0][0],w=s[0][1],E=s[d-1][0],T=s[d-1][1];l&&B1(this,e,s[1][0],s[1][1],v,w),f&&Dg(this,e,s[d-2][0],s[d-2][1],E,T)},a.prototype.isFill=function(){return!1},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){if(!s||!f)return!1;var d=this.attr().points;return bm(d,f,e,i,!1)},a.prototype.isStroke=function(){return!0},a.prototype.createPath=function(e){var i=this.attr(),s=i.points,l=i.startArrow,f=i.endArrow,d=s.length;if(!(s.length<2)){var v=s[0][0],w=s[0][1],E=s[d-1][0],T=s[d-1][1];if(l&&l.d){var G=ug(v,w,s[1][0],s[1][1],l.d);v+=G.dx,w+=G.dy}if(f&&f.d){var G=ug(s[d-2][0],s[d-2][1],E,T,f.d);E-=G.dx,T-=G.dy}e.beginPath(),e.moveTo(v,w);for(var U=0;U<d-1;U++){var et=s[U];e.lineTo(et[0],et[1])}e.lineTo(E,T)}},a.prototype.afterDrawPath=function(e){var i=this.get("startArrowShape"),s=this.get("endArrowShape");i&&i.draw(e),s&&s.draw(e)},a.prototype.getTotalLength=function(){var e=this.attr().points,i=this.get("totalLength");return(0,_.isNil)(i)?(this.set("totalLength",bi.length(e)),this.get("totalLength")):i},a.prototype.getPoint=function(e){var i=this.attr().points,s=this.get("tCache");s||(this._setTcache(),s=this.get("tCache"));var l,f;return(0,_.each)(s,function(d,v){e>=d[0]&&e<=d[1]&&(l=(e-d[0])/(d[1]-d[0]),f=v)}),da.pointAt(i[f][0],i[f][1],i[f+1][0],i[f+1][1],l)},a.prototype._setTcache=function(){var e=this.attr().points;if(!(!e||e.length===0)){var i=this.getTotalLength();if(!(i<=0)){var s=0,l=[],f,d;(0,_.each)(e,function(v,w){e[w+1]&&(f=[],f[0]=s/i,d=da.length(v[0],v[1],e[w+1][0],e[w+1][1]),s+=d,f[1]=s/i,l.push(f))}),this.set("tCache",l)}}},a.prototype.getStartTangent=function(){var e=this.attr().points,i=[];return i.push([e[1][0],e[1][1]]),i.push([e[0][0],e[0][1]]),i},a.prototype.getEndTangent=function(){var e=this.attr().points,i=e.length-1,s=[];return s.push([e[i-1][0],e[i-1][1]]),s.push([e[i][0],e[i][1]]),s},a}(Tp),KS=YS;function xm(c,a,e,i,s,l,f){var d=s/2;return sg(c-d,a-d,e,s,l,f)||sg(c+e-d,a-d,s,i,l,f)||sg(c+d,a+i-d,e,s,l,f)||sg(c-d,a+d,s,i,l,f)}function j1(c,a,e,i,s,l,f,d){var v=l/2;return Zc(c+s,a,c+e-s,a,l,f,d)||Zc(c+e,a+s,c+e,a+i-s,l,f,d)||Zc(c+e-s,a+i,c+s,a+i,l,f,d)||Zc(c,a+i-s,c,a+s,l,f,d)||e0(c+e-s,a+s,s,1.5*Math.PI,2*Math.PI,l,f,d)||e0(c+e-s,a+i-s,s,0,.5*Math.PI,l,f,d)||e0(c+s,a+i-s,s,.5*Math.PI,Math.PI,l,f,d)||e0(c+s,a+s,s,Math.PI,1.5*Math.PI,l,f,d)}var ZS=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x:0,y:0,width:0,height:0,radius:0})},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){var d=this.attr(),v=d.x,w=d.y,E=d.width,T=d.height,G=d.radius;if(G){var et=!1;return s&&(et=j1(v,w,E,T,G,f,e,i)),!et&&l&&(et=Xx(this,e,i)),et}else{var U=f/2;if(l&&s)return sg(v-U,w-U,E+U,T+U,e,i);if(l)return sg(v,w,E,T,e,i);if(s)return xm(v,w,E,T,f,e,i)}},a.prototype.createPath=function(e){var i=this.attr(),s=i.x,l=i.y,f=i.width,d=i.height,v=i.radius;if(e.beginPath(),v===0)e.rect(s,l,f,d);else{var w=mm(v),E=w[0],T=w[1],G=w[2],U=w[3];e.moveTo(s+E,l),e.lineTo(s+f-T,l),T!==0&&e.arc(s+f-T,l+T,T,-Math.PI/2,0),e.lineTo(s+f,l+d-G),G!==0&&e.arc(s+f-G,l+d-G,G,0,Math.PI/2),e.lineTo(s+U,l+d),U!==0&&e.arc(s+U,l+d-U,U,Math.PI/2,Math.PI),e.lineTo(s,l+E),E!==0&&e.arc(s+E,l+E,E,Math.PI,Math.PI*1.5),e.closePath()}},a}(Tp),qS=ZS,wA=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},a.prototype.isOnlyHitBox=function(){return!0},a.prototype.initAttrs=function(e){this._assembleFont(),e.text&&this._setText(e.text)},a.prototype._assembleFont=function(){var e=this.attrs;e.font=Vl(e)},a.prototype._setText=function(e){var i=null;(0,_.isString)(e)&&e.indexOf(`
`)!==-1&&(i=e.split(`
`)),this.set("textArr",i)},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),e.startsWith("font")&&this._assembleFont(),e==="text"&&this._setText(i)},a.prototype._getSpaceingY=function(){var e=this.attrs,i=e.lineHeight,s=e.fontSize*1;return i?i-s:s*.14},a.prototype._drawTextArr=function(e,i,s){var l=this.attrs,f=l.textBaseline,d=l.x,v=l.y,w=l.fontSize*1,E=this._getSpaceingY(),T=ul(l.text,l.fontSize,l.lineHeight),G;(0,_.each)(i,function(U,et){G=v+et*(E+w)-T+w,f==="middle"&&(G+=T-w-(T-w)/2),f==="top"&&(G+=T-w),(0,_.isNil)(U)||(s?e.fillText(U,d,G):e.strokeText(U,d,G))})},a.prototype._drawText=function(e,i){var s=this.attr(),l=s.x,f=s.y,d=this.get("textArr");if(d)this._drawTextArr(e,d,i);else{var v=s.text;(0,_.isNil)(v)||(i?e.fillText(v,l,f):e.strokeText(v,l,f))}},a.prototype.strokeAndFill=function(e){var i=this.attrs,s=i.lineWidth,l=i.opacity,f=i.strokeOpacity,d=i.fillOpacity;this.isStroke()&&s>0&&(!(0,_.isNil)(f)&&f!==1&&(e.globalAlpha=l),this.stroke(e)),this.isFill()&&(!(0,_.isNil)(d)&&d!==1?(e.globalAlpha=d,this.fill(e),e.globalAlpha=l):this.fill(e)),this.afterDrawPath(e)},a.prototype.fill=function(e){this._drawText(e,!0)},a.prototype.stroke=function(e){this._drawText(e,!1)},a}(Tp),EA=wA;function H1(c,a){if(a){var e=Se(a);return ne(e,c)}return c}function qx(c,a,e){var i=c.getTotalMatrix();if(i){var s=H1([a,e,1],i),l=s[0],f=s[1];return[l,f]}return[a,e]}function Qx(c,a,e){if(c.isCanvas&&c.isCanvas())return!0;if(!sd(c)||c.cfg.isInView===!1)return!1;if(c.cfg.clipShape){var i=qx(c,a,e),s=i[0],l=i[1];if(c.isClipped(s,l))return!1}var f=c.cfg.cacheCanvasBBox||c.getCanvasBBox();return a>=f.minX&&a<=f.maxX&&e>=f.minY&&e<=f.maxY}function Jx(c,a,e){if(!Qx(c,a,e))return null;for(var i=null,s=c.getChildren(),l=s.length,f=l-1;f>=0;f--){var d=s[f];if(d.isGroup())i=Jx(d,a,e);else if(Qx(d,a,e)){var v=d,w=qx(d,a,e),E=w[0],T=w[1];v.isInShape(E,T)&&(i=d)}if(i)break}return i}var QS=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultCfg=function(){var e=c.prototype.getDefaultCfg.call(this);return e.renderer="canvas",e.autoDraw=!0,e.localRefresh=!0,e.refreshElements=[],e.clipView=!0,e.quickHit=!1,e},a.prototype.onCanvasChange=function(e){(e==="attr"||e==="sort"||e==="changeSize")&&(this.set("refreshElements",[this]),this.draw())},a.prototype.getShapeBase=function(){return M},a.prototype.getGroupBase=function(){return Hx},a.prototype.getPixelRatio=function(){var e=this.get("pixelRatio")||gm();return e>=1?Math.ceil(e):1},a.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},a.prototype.createDom=function(){var e=document.createElement("canvas"),i=e.getContext("2d");return this.set("context",i),e},a.prototype.setDOMSize=function(e,i){c.prototype.setDOMSize.call(this,e,i);var s=this.get("context"),l=this.get("el"),f=this.getPixelRatio();l.width=f*e,l.height=f*i,f>1&&s.scale(f,f)},a.prototype.clear=function(){c.prototype.clear.call(this),this._clearFrame();var e=this.get("context"),i=this.get("el");e.clearRect(0,0,i.width,i.height)},a.prototype.getShape=function(e,i){var s;return this.get("quickHit")?s=Jx(this,e,i):s=c.prototype.getShape.call(this,e,i,null),s},a.prototype._getRefreshRegion=function(){var e=this.get("refreshElements"),i=this.getViewRange(),s;if(e.length&&e[0]===this)s=i;else if(s=U1(e),s){s.minX=Math.floor(s.minX),s.minY=Math.floor(s.minY),s.maxX=Math.ceil(s.maxX),s.maxY=Math.ceil(s.maxY),s.maxY+=1;var l=this.get("clipView");l&&(s=OS(s,i))}return s},a.prototype.refreshElement=function(e){var i=this.get("refreshElements");i.push(e)},a.prototype._clearFrame=function(){var e=this.get("drawFrame");e&&((0,_.clearAnimationFrame)(e),this.set("drawFrame",null),this.set("refreshElements",[]))},a.prototype.draw=function(){var e=this.get("drawFrame");this.get("autoDraw")&&e||this._startDraw()},a.prototype._drawAll=function(){var e=this.get("context"),i=this.get("el"),s=this.getChildren();e.clearRect(0,0,i.width,i.height),lg(e,this),z1(e,s),this.set("refreshElements",[])},a.prototype._drawRegion=function(){var e=this.get("context"),i=this.get("refreshElements"),s=this.getChildren(),l=this._getRefreshRegion();l?(e.clearRect(l.minX,l.minY,l.maxX-l.minX,l.maxY-l.minY),e.save(),e.beginPath(),e.rect(l.minX,l.minY,l.maxX-l.minX,l.maxY-l.minY),e.clip(),lg(e,this),Vx(this,s,l),z1(e,s,l),e.restore()):i.length&&cc(i),(0,_.each)(i,function(f){f.get("hasChanged")&&f.set("hasChanged",!1)}),this.set("refreshElements",[])},a.prototype._startDraw=function(){var e=this,i=this.get("drawFrame");i||(i=(0,_.requestAnimationFrame)(function(){e.get("localRefresh")?e._drawRegion():e._drawAll(),e.set("drawFrame",null)}),this.set("drawFrame",i))},a.prototype.skipDraw=function(){},a.prototype.removeDom=function(){var e=this.get("el");e.width=0,e.height=0,e.parentNode.removeChild(e)},a}(ci),Gv=QS,SA="0.5.12",ly={rect:"path",circle:"circle",line:"line",path:"path",marker:"path",text:"text",polyline:"polyline",polygon:"polygon",image:"image",ellipse:"ellipse",dom:"foreignObject"},$u={opacity:"opacity",fillStyle:"fill",fill:"fill",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",x:"x",y:"y",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",x1:"x1",x2:"x2",y1:"y1",y2:"y2",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",startArrow:"marker-start",endArrow:"marker-end",path:"d",class:"class",id:"id",style:"style",preserveAspectRatio:"preserveAspectRatio"},r0=null;function Lh(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}function tw(c){var a=ly[c.type],e=c.getParent();if(!a)throw new Error("the type "+c.type+" is not supported by svg");var i=Lh(a);if(c.get("id")&&(i.id=c.get("id")),c.set("el",i),c.set("attrs",{}),e){var s=e.get("el");s||(s=e.createDom(),e.set("el",s)),s.appendChild(i)}return i}function wm(c,a){var e=c.get("el"),i=(0,_.toArray)(e.children).sort(a),s=document.createDocumentFragment();i.forEach(function(l){s.appendChild(l)}),e.appendChild(s)}function JS(c,a){var e=c.parentNode,i=Array.from(e.childNodes).filter(function(d){return d.nodeType===1&&d.nodeName.toLowerCase()!=="defs"}),s=i[a],l=i.indexOf(c);if(s){if(l>a)e.insertBefore(c,s);else if(l<a){var f=i[a+1];f?e.insertBefore(c,f):e.appendChild(c)}}else e.appendChild(c)}function X1(c,a){var e=c.cfg.el,i=c.attr(),s={dx:i.shadowOffsetX,dy:i.shadowOffsetY,blur:i.shadowBlur,color:i.shadowColor};if(!s.dx&&!s.dy&&!s.blur&&!s.color)e.removeAttribute("filter");else{var l=a.find("filter",s);l||(l=a.addShadow(s)),e.setAttribute("filter","url(#"+l+")")}}function a0(c){var a=c.attr().matrix;if(a){for(var e=c.cfg.el,i=[],s=0;s<9;s+=3)i.push(a[s]+","+a[s+1]);i=i.join(","),i.indexOf("NaN")===-1?e.setAttribute("transform","matrix("+i+")"):console.warn("invalid matrix:",a)}}function td(c,a){var e=c.getClip(),i=c.get("el");if(!e)i.removeAttribute("clip-path");else if(e&&!i.hasAttribute("clip-path")){tw(e),e.createPath(a);var s=a.addClip(e);i.setAttribute("clip-path","url(#"+s+")")}}function ew(c,a){a.forEach(function(e){e.draw(c)})}function i0(c,a){var e=c.get("canvas");if(e&&e.get("autoDraw")){var i=e.get("context"),s=c.getParent(),l=s?s.getChildren():[e],f=c.get("el");if(a==="remove"){var d=c.get("isClipShape");if(d){var v=f&&f.parentNode,w=v&&v.parentNode;v&&w&&w.removeChild(v)}else f&&f.parentNode&&f.parentNode.removeChild(f)}else if(a==="show")f.setAttribute("visibility","visible");else if(a==="hide")f.setAttribute("visibility","hidden");else if(a==="zIndex")JS(f,l.indexOf(c));else if(a==="sort"){var E=c.get("children");E&&E.length&&wm(c,function(T,G){return E.indexOf(T)-E.indexOf(G)?1:0})}else a==="clear"?f&&(f.innerHTML=""):a==="matrix"?a0(c):a==="clip"?td(c,i):a==="attr"||a==="add"&&c.draw(i)}}var t2=function(c){(0,O.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.isEntityGroup=function(){return!0},a.prototype.createDom=function(){var e=Lh("g");this.set("el",e);var i=this.getParent();if(i){var s=i.get("el");s||(s=i.createDom(),i.set("el",s)),s.appendChild(e)}return e},a.prototype.afterAttrsChange=function(e){c.prototype.afterAttrsChange.call(this,e);var i=this.get("canvas");if(i&&i.get("autoDraw")){var s=i.get("context");this.createPath(s,e)}},a.prototype.onCanvasChange=function(e){i0(this,e)},a.prototype.getShapeBase=function(){return k},a.prototype.getGroupBase=function(){return a},a.prototype.draw=function(e){var i=this.getChildren(),s=this.get("el");this.get("destroyed")?s&&s.parentNode.removeChild(s):(s||this.createDom(),td(this,e),this.createPath(e),i.length&&ew(e,i))},a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,_.each)(i||s,function(f,d){$u[d]&&l.setAttribute($u[d],f)}),a0(this)},a}(av),Ph=t2,e2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="svg",e.canFill=!1,e.canStroke=!1,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},a.prototype.afterAttrsChange=function(e){c.prototype.afterAttrsChange.call(this,e);var i=this.get("canvas");if(i&&i.get("autoDraw")){var s=i.get("context");this.draw(s,e)}},a.prototype.getShapeBase=function(){return k},a.prototype.getGroupBase=function(){return Ph},a.prototype.onCanvasChange=function(e){i0(this,e)},a.prototype.calculateBBox=function(){var e=this.get("el"),i=null;if(e)i=e.getBBox();else{var s=ag(this.get("type"));s&&(i=s(this))}if(i){var l=i.x,f=i.y,d=i.width,v=i.height,w=this.getHitLineWidth(),E=w/2,T=l-E,G=f-E,U=l+d+E,et=f+v+E;return{x:T,y:G,minX:T,minY:G,maxX:U,maxY:et,width:d+w,height:v+w}}return{x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}},a.prototype.isFill=function(){var e=this.attr(),i=e.fill,s=e.fillStyle;return(i||s||this.isClipShape())&&this.canFill},a.prototype.isStroke=function(){var e=this.attr(),i=e.stroke,s=e.strokeStyle;return(i||s)&&this.canStroke},a.prototype.draw=function(e,i){var s=this.get("el");this.get("destroyed")?s&&s.parentNode.removeChild(s):(s||tw(this),td(this,e),this.createPath(e,i),this.shadow(e,i),this.strokeAndFill(e,i),this.transform(i))},a.prototype.createPath=function(e,i){},a.prototype.strokeAndFill=function(e,i){var s=i||this.attr(),l=s.fill,f=s.fillStyle,d=s.stroke,v=s.strokeStyle,w=s.fillOpacity,E=s.strokeOpacity,T=s.lineWidth,G=this.get("el");this.canFill&&(i?"fill"in s?this._setColor(e,"fill",l):"fillStyle"in s&&this._setColor(e,"fill",f):this._setColor(e,"fill",l||f),w&&G.setAttribute($u.fillOpacity,w)),this.canStroke&&T>0&&(i?"stroke"in s?this._setColor(e,"stroke",d):"strokeStyle"in s&&this._setColor(e,"stroke",v):this._setColor(e,"stroke",d||v),E&&G.setAttribute($u.strokeOpacity,E),T&&G.setAttribute($u.lineWidth,T))},a.prototype._setColor=function(e,i,s){var l=this.get("el");if(!s){l.setAttribute($u[i],"none");return}if(s=s.trim(),/^[r,R,L,l]{1}[\s]*\(/.test(s)){var f=e.find("gradient",s);f||(f=e.addGradient(s)),l.setAttribute($u[i],"url(#"+f+")")}else if(/^[p,P]{1}[\s]*\(/.test(s)){var f=e.find("pattern",s);f||(f=e.addPattern(s)),l.setAttribute($u[i],"url(#"+f+")")}else l.setAttribute($u[i],s)},a.prototype.shadow=function(e,i){var s=this.attr(),l=i||s,f=l.shadowOffsetX,d=l.shadowOffsetY,v=l.shadowBlur,w=l.shadowColor;(f||d||v||w)&&X1(this,e)},a.prototype.transform=function(e){var i=this.attr(),s=(e||i).matrix;s&&a0(this)},a.prototype.isInShape=function(e,i){return this.isPointInPath(e,i)},a.prototype.isPointInPath=function(e,i){var s=this.get("el"),l=this.get("canvas"),f=l.get("el").getBoundingClientRect(),d=e+f.left,v=i+f.top,w=document.elementFromPoint(d,v);return!!(w&&w.isEqualNode(s))},a.prototype.getHitLineWidth=function(){var e=this.attrs,i=e.lineWidth,s=e.lineAppendWidth;return this.isStroke()?i+s:0},a}(qd),tp=e2,n2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="circle",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x:0,y:0,r:0})},a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,_.each)(i||s,function(f,d){d==="x"||d==="y"?l.setAttribute("c"+d,f):$u[d]&&l.setAttribute($u[d],f)})},a}(tp),r2=n2,a2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="dom",e.canFill=!1,e.canStroke=!1,e}return a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");if((0,_.each)(i||s,function(w,E){$u[E]&&l.setAttribute($u[E],w)}),typeof s.html=="function"){var f=s.html.call(this,s);if(f instanceof Element||f instanceof HTMLDocument){for(var d=l.childNodes,v=d.length-1;v>=0;v--)l.removeChild(d[v]);l.appendChild(f)}else l.innerHTML=f}else l.innerHTML=s.html},a}(tp),i2=a2,o2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="ellipse",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x:0,y:0,rx:0,ry:0})},a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,_.each)(i||s,function(f,d){d==="x"||d==="y"?l.setAttribute("c"+d,f):$u[d]&&l.setAttribute($u[d],f)})},a}(tp),s2=o2,u2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="image",e.canFill=!1,e.canStroke=!1,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x:0,y:0,width:0,height:0})},a.prototype.createPath=function(e,i){var s=this,l=this.attr(),f=this.get("el");(0,_.each)(i||l,function(d,v){v==="img"?s._setImage(l.img):$u[v]&&f.setAttribute($u[v],d)})},a.prototype.setAttr=function(e,i){this.attrs[e]=i,e==="img"&&this._setImage(i)},a.prototype._setImage=function(e){var i=this.attr(),s=this.get("el");if((0,_.isString)(e))s.setAttribute("href",e);else if(e instanceof window.Image)i.width||(s.setAttribute("width",e.width),this.attr("width",e.width)),i.height||(s.setAttribute("height",e.height),this.attr("height",e.height)),s.setAttribute("href",e.src);else if(e instanceof HTMLElement&&(0,_.isString)(e.nodeName)&&e.nodeName.toUpperCase()==="CANVAS")s.setAttribute("href",e.toDataURL());else if(e instanceof ImageData){var l=document.createElement("canvas");l.setAttribute("width",""+e.width),l.setAttribute("height",""+e.height),l.getContext("2d").putImageData(e,0,0),i.width||(s.setAttribute("width",""+e.width),this.attr("width",e.width)),i.height||(s.setAttribute("height",""+e.height),this.attr("height",e.height)),s.setAttribute("href",l.toDataURL())}},a}(tp),Y1=u2,l2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="line",e.canFill=!1,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,_.each)(i||s,function(f,d){if(d==="startArrow"||d==="endArrow")if(f){var v=(0,_.isObject)(f)?e.addArrow(s,$u[d]):e.getDefaultArrow(s,$u[d]);l.setAttribute($u[d],"url(#"+v+")")}else l.removeAttribute($u[d]);else $u[d]&&l.setAttribute($u[d],f)})},a.prototype.getTotalLength=function(){var e=this.attr(),i=e.x1,s=e.y1,l=e.x2,f=e.y2;return da.length(i,s,l,f)},a.prototype.getPoint=function(e){var i=this.attr(),s=i.x1,l=i.y1,f=i.x2,d=i.y2;return da.pointAt(s,l,f,d,e)},a}(tp),cy=l2,fy={circle:function(c,a,e){return[["M",c,a],["m",-e,0],["a",e,e,0,1,0,e*2,0],["a",e,e,0,1,0,-e*2,0]]},square:function(c,a,e){return[["M",c-e,a-e],["L",c+e,a-e],["L",c+e,a+e],["L",c-e,a+e],["Z"]]},diamond:function(c,a,e){return[["M",c-e,a],["L",c,a-e],["L",c+e,a],["L",c,a+e],["Z"]]},triangle:function(c,a,e){var i=e*Math.sin(1/3*Math.PI);return[["M",c-e,a+i],["L",c,a-i],["L",c+e,a+i],["z"]]},triangleDown:function(c,a,e){var i=e*Math.sin(1/3*Math.PI);return[["M",c-e,a-i],["L",c+e,a-i],["L",c,a+i],["Z"]]}},o0={get:function(c){return fy[c]},register:function(c,a){fy[c]=a},remove:function(c){delete fy[c]},getAll:function(){return fy}},c2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="marker",e.canFill=!0,e.canStroke=!0,e}return a.prototype.createPath=function(e){var i=this.get("el");i.setAttribute("d",this._assembleMarker())},a.prototype._assembleMarker=function(){var e=this._getPath();return(0,_.isArray)(e)?e.map(function(i){return i.join(" ")}).join(""):e},a.prototype._getPath=function(){var e=this.attr(),i=e.x,s=e.y,l=e.r||e.radius,f=e.symbol||"circle",d;return(0,_.isFunction)(f)?d=f:d=o0.get(f),d?d(i,s,l):(console.warn(d+" symbol is not exist."),null)},a.symbolsFactory=o0,a}(tp),K1=c2,f2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="path",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{startArrow:!1,endArrow:!1})},a.prototype.createPath=function(e,i){var s=this,l=this.attr(),f=this.get("el");(0,_.each)(i||l,function(d,v){if(v==="path"&&(0,_.isArray)(d))f.setAttribute("d",s._formatPath(d));else if(v==="startArrow"||v==="endArrow")if(d){var w=(0,_.isObject)(d)?e.addArrow(l,$u[v]):e.getDefaultArrow(l,$u[v]);f.setAttribute($u[v],"url(#"+w+")")}else f.removeAttribute($u[v]);else $u[v]&&f.setAttribute($u[v],d)})},a.prototype._formatPath=function(e){var i=e.map(function(s){return s.join(" ")}).join("");return~i.indexOf("NaN")?"":i},a.prototype.getTotalLength=function(){var e=this.get("el");return e?e.getTotalLength():null},a.prototype.getPoint=function(e){var i=this.get("el"),s=this.getTotalLength();if(s===0)return null;var l=i?i.getPointAtLength(e*s):null;return l?{x:l.x,y:l.y}:null},a}(tp),nw=f2,h2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="polygon",e.canFill=!0,e.canStroke=!0,e}return a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,_.each)(i||s,function(f,d){d==="points"&&(0,_.isArray)(f)&&f.length>=2?l.setAttribute("points",f.map(function(v){return v[0]+","+v[1]}).join(" ")):$u[d]&&l.setAttribute($u[d],f)})},a}(tp),Z1=h2,d2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="polyline",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{startArrow:!1,endArrow:!1})},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),["points"].indexOf(e)!==-1&&this._resetCache()},a.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,_.each)(i||s,function(f,d){d==="points"&&(0,_.isArray)(f)&&f.length>=2?l.setAttribute("points",f.map(function(v){return v[0]+","+v[1]}).join(" ")):$u[d]&&l.setAttribute($u[d],f)})},a.prototype.getTotalLength=function(){var e=this.attr().points,i=this.get("totalLength");return(0,_.isNil)(i)?(this.set("totalLength",bi.length(e)),this.get("totalLength")):i},a.prototype.getPoint=function(e){var i=this.attr().points,s=this.get("tCache");s||(this._setTcache(),s=this.get("tCache"));var l,f;return(0,_.each)(s,function(d,v){e>=d[0]&&e<=d[1]&&(l=(e-d[0])/(d[1]-d[0]),f=v)}),da.pointAt(i[f][0],i[f][1],i[f+1][0],i[f+1][1],l)},a.prototype._setTcache=function(){var e=this.attr().points;if(!(!e||e.length===0)){var i=this.getTotalLength();if(!(i<=0)){var s=0,l=[],f,d;(0,_.each)(e,function(v,w){e[w+1]&&(f=[],f[0]=s/i,d=da.length(v[0],v[1],e[w+1][0],e[w+1][1]),s+=d,f[1]=s/i,l.push(f))}),this.set("tCache",l)}}},a.prototype.getStartTangent=function(){var e=this.attr().points,i=[];return i.push([e[1][0],e[1][1]]),i.push([e[0][0],e[0][1]]),i},a.prototype.getEndTangent=function(){var e=this.attr().points,i=e.length-1,s=[];return s.push([e[i-1][0],e[i-1][1]]),s.push([e[i][0],e[i][1]]),s},a}(tp),hy=d2,p2=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/gi,dy=/[^\s,]+/gi;function v2(c){var a=0,e=0,i=0,s=0;return(0,_.isArray)(c)?c.length===1?a=e=i=s=c[0]:c.length===2?(a=i=c[0],e=s=c[1]):c.length===3?(a=c[0],e=s=c[1],i=c[2]):(a=c[0],e=c[1],i=c[2],s=c[3]):a=e=i=s=c,{r1:a,r2:e,r3:i,r4:s}}function q1(c){if(c=c||[],isArray(c))return c;if(isString(c))return c=c.match(p2),each(c,function(a,e){if(a=a.match(dy),a[0].length>1){var i=a[0].charAt(0);a.splice(1,0,a[0].substr(1)),a[0]=i}each(a,function(s,l){isNaN(s)||(a[l]=+s)}),c[e]=a}),c}var g2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="rect",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x:0,y:0,width:0,height:0,radius:0})},a.prototype.createPath=function(e,i){var s=this,l=this.attr(),f=this.get("el"),d=!1,v=["x","y","width","height","radius"];(0,_.each)(i||l,function(w,E){v.indexOf(E)!==-1&&!d?(f.setAttribute("d",s._assembleRect(l)),d=!0):v.indexOf(E)===-1&&$u[E]&&f.setAttribute($u[E],w)})},a.prototype._assembleRect=function(e){var i=e.x,s=e.y,l=e.width,f=e.height,d=e.radius;if(!d)return"M "+i+","+s+" l "+l+",0 l 0,"+f+" l"+-l+" 0 z";var v=v2(d);(0,_.isArray)(d)?d.length===1?v.r1=v.r2=v.r3=v.r4=d[0]:d.length===2?(v.r1=v.r3=d[0],v.r2=v.r4=d[1]):d.length===3?(v.r1=d[0],v.r2=v.r4=d[1],v.r3=d[2]):(v.r1=d[0],v.r2=d[1],v.r3=d[2],v.r4=d[3]):v.r1=v.r2=v.r3=v.r4=d;var w=[["M "+(i+v.r1)+","+s],["l "+(l-v.r1-v.r2)+",0"],["a "+v.r2+","+v.r2+",0,0,1,"+v.r2+","+v.r2],["l 0,"+(f-v.r2-v.r3)],["a "+v.r3+","+v.r3+",0,0,1,"+-v.r3+","+v.r3],["l "+(v.r3+v.r4-l)+",0"],["a "+v.r4+","+v.r4+",0,0,1,"+-v.r4+","+-v.r4],["l 0,"+(v.r4+v.r1-f)],["a "+v.r1+","+v.r1+",0,0,1,"+v.r1+","+-v.r1],["z"]];return w.join(" ")},a}(tp),Q1=g2,rw=.3,py={top:"before-edge",middle:"central",bottom:"after-edge",alphabetic:"baseline",hanging:"hanging"},m2={top:"text-before-edge",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",hanging:"hanging"},s0={left:"left",start:"left",center:"middle",right:"end",end:"end"},y2=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="text",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,O.__assign)((0,O.__assign)({},e),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},a.prototype.createPath=function(e,i){var s=this,l=this.attr(),f=this.get("el");this._setFont(),(0,_.each)(i||l,function(d,v){v==="text"?s._setText(""+d):v==="matrix"&&d?a0(s):$u[v]&&f.setAttribute($u[v],d)}),f.setAttribute("paint-order","stroke"),f.setAttribute("style","stroke-linecap:butt; stroke-linejoin:miter;")},a.prototype._setFont=function(){var e=this.get("el"),i=this.attr(),s=i.textBaseline,l=i.textAlign,f=nf();f&&f.name==="firefox"?e.setAttribute("dominant-baseline",m2[s]||"alphabetic"):e.setAttribute("alignment-baseline",py[s]||"baseline"),e.setAttribute("text-anchor",s0[l]||"left")},a.prototype._setText=function(e){var i=this.get("el"),s=this.attr(),l=s.x,f=s.textBaseline,d=f===void 0?"bottom":f;if(!e)i.innerHTML="";else if(~e.indexOf(`
`)){var v=e.split(`
`),w=v.length-1,E="";(0,_.each)(v,function(T,G){G===0?d==="alphabetic"?E+='<tspan x="'+l+'" dy="'+-w+'em">'+T+"</tspan>":d==="top"?E+='<tspan x="'+l+'" dy="0.9em">'+T+"</tspan>":d==="middle"?E+='<tspan x="'+l+'" dy="'+-(w-1)/2+'em">'+T+"</tspan>":d==="bottom"?E+='<tspan x="'+l+'" dy="-'+(w+rw)+'em">'+T+"</tspan>":d==="hanging"&&(E+='<tspan x="'+l+'" dy="'+(-(w-1)-rw)+'em">'+T+"</tspan>"):E+='<tspan x="'+l+'" dy="1em">'+T+"</tspan>"}),i.innerHTML=E}else i.innerHTML=e},a}(tp),u0=y2,b2=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,l0=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,x2=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function Og(c){var a=c.match(x2);if(!a)return"";var e="";return a.sort(function(i,s){return i=i.split(":"),s=s.split(":"),Number(i[0])-Number(s[0])}),(0,_.each)(a,function(i){i=i.split(":"),e+='<stop offset="'+i[0]+'" stop-color="'+i[1]+'"></stop>'}),e}function w2(c,a){var e=b2.exec(c),i=(0,_.mod)((0,_.toRadian)(parseFloat(e[1])),Math.PI*2),s=e[2],l,f;i>=0&&i<.5*Math.PI?(l={x:0,y:0},f={x:1,y:1}):.5*Math.PI<=i&&i<Math.PI?(l={x:1,y:0},f={x:0,y:1}):Math.PI<=i&&i<1.5*Math.PI?(l={x:1,y:1},f={x:0,y:0}):(l={x:0,y:1},f={x:1,y:0});var d=Math.tan(i),v=d*d,w=(f.x-l.x+d*(f.y-l.y))/(v+1)+l.x,E=d*(f.x-l.x+d*(f.y-l.y))/(v+1)+l.y;a.setAttribute("x1",l.x),a.setAttribute("y1",l.y),a.setAttribute("x2",w),a.setAttribute("y2",E),a.innerHTML=Og(s)}function vy(c,a){var e=l0.exec(c),i=parseFloat(e[1]),s=parseFloat(e[2]),l=parseFloat(e[3]),f=e[4];a.setAttribute("cx",i),a.setAttribute("cy",s),a.setAttribute("r",l),a.innerHTML=Og(f)}var E2=function(){function c(a){this.cfg={};var e=null,i=(0,_.uniqueId)("gradient_");return a.toLowerCase()[0]==="l"?(e=Lh("linearGradient"),w2(a,e)):(e=Lh("radialGradient"),vy(a,e)),e.setAttribute("id",i),this.el=e,this.id=i,this.cfg=a,this}return c.prototype.match=function(a,e){return this.cfg===e},c}(),ed=E2,S2={shadowColor:"color",shadowOpacity:"opacity",shadowBlur:"blur",shadowOffsetX:"dx",shadowOffsetY:"dy"},c0={x:"-40%",y:"-40%",width:"200%",height:"200%"},C2=function(){function c(a){this.type="filter",this.cfg={},this.type="filter";var e=Lh("filter");return(0,_.each)(c0,function(i,s){e.setAttribute(s,i)}),this.el=e,this.id=(0,_.uniqueId)("filter_"),this.el.id=this.id,this.cfg=a,this._parseShadow(a,e),this}return c.prototype.match=function(a,e){if(this.type!==a)return!1;var i=!0,s=this.cfg;return(0,_.each)(Object.keys(s),function(l){if(s[l]!==e[l])return i=!1,!1}),i},c.prototype.update=function(a,e){var i=this.cfg;return i[S2[a]]=e,this._parseShadow(i,this.el),this},c.prototype._parseShadow=function(a,e){var i=`<feDropShadow
      dx="`+(a.dx||0)+`"
      dy="`+(a.dy||0)+`"
      stdDeviation="`+(a.blur?a.blur/10:0)+`"
      flood-color="`+(a.color?a.color:"#000")+`"
      flood-opacity="`+(a.opacity?a.opacity:1)+`"
      />`;e.innerHTML=i},c}(),f0=C2,_2=function(){function c(a,e){this.cfg={};var i=Lh("marker"),s=(0,_.uniqueId)("marker_");i.setAttribute("id",s);var l=Lh("path");l.setAttribute("stroke",a.stroke||"none"),l.setAttribute("fill",a.fill||"none"),i.appendChild(l),i.setAttribute("overflow","visible"),i.setAttribute("orient","auto-start-reverse"),this.el=i,this.child=l,this.id=s;var f=a[e==="marker-start"?"startArrow":"endArrow"];return this.stroke=a.stroke||"#000",f===!0?this._setDefaultPath(e,l):(this.cfg=f,this._setMarker(a.lineWidth,l)),this}return c.prototype.match=function(){return!1},c.prototype._setDefaultPath=function(a,e){var i=this.el;e.setAttribute("d","M0,0 L"+10*Math.cos(Math.PI/6)+",5 L0,10"),i.setAttribute("refX",""+10*Math.cos(Math.PI/6)),i.setAttribute("refY",""+5)},c.prototype._setMarker=function(a,e){var i=this.el,s=this.cfg.path,l=this.cfg.d;(0,_.isArray)(s)&&(s=s.map(function(f){return f.join(" ")}).join("")),e.setAttribute("d",s),i.appendChild(e),l&&i.setAttribute("refX",""+l/a)},c.prototype.update=function(a){var e=this.child;e.attr?e.attr("fill",a):e.setAttribute("fill",a)},c}(),Uv=_2,I2=function(){function c(a){this.type="clip",this.cfg={};var e=Lh("clipPath");this.el=e,this.id=(0,_.uniqueId)("clip_"),e.id=this.id;var i=a.cfg.el;return e.appendChild(i),this.cfg=a,this}return c.prototype.match=function(){return!1},c.prototype.remove=function(){var a=this.el;a.parentNode.removeChild(a)},c}(),nd=I2,T2=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Em=function(){function c(a){this.cfg={};var e=Lh("pattern");e.setAttribute("patternUnits","userSpaceOnUse");var i=Lh("image");e.appendChild(i);var s=(0,_.uniqueId)("pattern_");e.id=s,this.el=e,this.id=s,this.cfg=a;var l=T2.exec(a),f=l[2];i.setAttribute("href",f);var d=new Image;f.match(/^data:/i)||(d.crossOrigin="Anonymous"),d.src=f;function v(){e.setAttribute("width",""+d.width),e.setAttribute("height",""+d.height)}return d.complete?v():(d.onload=v,d.src=d.src),this}return c.prototype.match=function(a,e){return this.cfg===e},c}(),A2=Em,J1=function(){function c(a){var e=Lh("defs"),i=(0,_.uniqueId)("defs_");e.id=i,a.appendChild(e),this.children=[],this.defaultArrow={},this.el=e,this.canvas=a}return c.prototype.find=function(a,e){for(var i=this.children,s=null,l=0;l<i.length;l++)if(i[l].match(a,e)){s=i[l].id;break}return s},c.prototype.findById=function(a){for(var e=this.children,i=null,s=0;s<e.length;s++)if(e[s].id===a){i=e[s];break}return i},c.prototype.add=function(a){this.children.push(a),a.canvas=this.canvas,a.parent=this},c.prototype.getDefaultArrow=function(a,e){var i=a.stroke||a.strokeStyle;if(this.defaultArrow[i])return this.defaultArrow[i].id;var s=new Uv(a,e);return this.defaultArrow[i]=s,this.el.appendChild(s.el),this.add(s),s.id},c.prototype.addGradient=function(a){var e=new ed(a);return this.el.appendChild(e.el),this.add(e),e.id},c.prototype.addArrow=function(a,e){var i=new Uv(a,e);return this.el.appendChild(i.el),this.add(i),i.id},c.prototype.addShadow=function(a){var e=new f0(a);return this.el.appendChild(e.el),this.add(e),e.id},c.prototype.addPattern=function(a){var e=new A2(a);return this.el.appendChild(e.el),this.add(e),e.id},c.prototype.addClip=function(a){var e=new nd(a);return this.el.appendChild(e.el),this.add(e),e.id},c}(),M2=J1,tb=function(c){(0,O.__extends)(a,c);function a(e){return c.call(this,(0,O.__assign)((0,O.__assign)({},e),{autoDraw:!0,renderer:"svg"}))||this}return a.prototype.getShapeBase=function(){return k},a.prototype.getGroupBase=function(){return Ph},a.prototype.getShape=function(e,i,s){var l=s.target||s.srcElement;if(!ly[l.tagName]){for(var f=l.parentNode;f&&!ly[f.tagName];)f=f.parentNode;l=f}return this.find(function(d){return d.get("el")===l})},a.prototype.createDom=function(){var e=Lh("svg"),i=new M2(e);return e.setAttribute("width",""+this.get("width")),e.setAttribute("height",""+this.get("height")),this.set("context",i),e},a.prototype.onCanvasChange=function(e){var i=this.get("context"),s=this.get("el");if(e==="sort"){var l=this.get("children");l&&l.length&&wm(this,function(d,v){return l.indexOf(d)-l.indexOf(v)?1:0})}else if(e==="clear"){if(s){s.innerHTML="";var f=i.el;f.innerHTML="",s.appendChild(f)}}else e==="matrix"?a0(this):e==="clip"?td(this,i):e==="changeSize"&&(s.setAttribute("width",""+this.get("width")),s.setAttribute("height",""+this.get("height")))},a.prototype.draw=function(){var e=this.get("context"),i=this.getChildren();td(this,e),i.length&&ew(e,i)},a}(ci),Ff=tb,Sm="0.5.6",N2=$(6767),h0=$.n(N2),gy=$(21997),my=2,yy=.16,k2=.05,by=.05,D2=.15,d0=5,aw=4,eb=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function iw(c,a,e){var i;return Math.round(c.h)>=60&&Math.round(c.h)<=240?i=e?Math.round(c.h)-my*a:Math.round(c.h)+my*a:i=e?Math.round(c.h)+my*a:Math.round(c.h)-my*a,i<0?i+=360:i>=360&&(i-=360),i}function Cd(c,a,e){if(c.h===0&&c.s===0)return c.s;var i;return e?i=c.s-yy*a:a===aw?i=c.s+yy:i=c.s+k2*a,i>1&&(i=1),e&&a===d0&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function nb(c,a,e){var i;return e?i=c.v+by*a:i=c.v-D2*a,i>1&&(i=1),Number(i.toFixed(2))}function Rg(c){for(var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=[],i=(0,gy.Z)(c),s=d0;s>0;s-=1){var l=i.toHsv(),f=(0,gy.Z)({h:iw(l,s,!0),s:Cd(l,s,!0),v:nb(l,s,!0)}).toHexString();e.push(f)}e.push(i.toHexString());for(var d=1;d<=aw;d+=1){var v=i.toHsv(),w=(0,gy.Z)({h:iw(v,d),s:Cd(v,d),v:nb(v,d)}).toHexString();e.push(w)}return a.theme==="dark"?eb.map(function(E){var T=E.index,G=E.opacity,U=gy.Z.mix(a.backgroundColor||"#141414",e[T],G*100).toHexString();return U}):e}var rb={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},Bf={},ab={};Object.keys(rb).forEach(function(c){Bf[c]=Rg(rb[c]),Bf[c].primary=Bf[c][5],ab[c]=Rg(rb[c],{theme:"dark",backgroundColor:"#141414"}),ab[c].primary=ab[c][5]});var CA=Bf.red,_A=Bf.volcano,IA=Bf.gold,TA=Bf.orange,AA=Bf.yellow,MA=Bf.lime,NA=Bf.green,O2=Bf.cyan,R2=Bf.blue,L2=Bf.geekblue,P2=Bf.purple,F2=Bf.magenta,B2=Bf.grey,bf=function(a,e,i){var s=h0()(a),l=h0()(e);return h0()([(1-i)*s.red()+i*l.red(),(1-i)*s.green()+i*l.green(),(1-i)*s.blue()+i*l.blue()]).rgb()},z2=function(a,e,i){e===void 0&&(e="#fff"),i===void 0&&(i="rgb(150, 150, 150)");var s=bf(e,a,.05).rgb().toString(),l=bf(e,a,.1).rgb().toString(),f=bf(e,a,.2).rgb().toString(),d=bf(e,a,.4).rgb().toString(),v=bf(e,i,.02).rgb().toString(),w=bf(e,i,.05).rgb().toString(),E=bf(e,i,.1).rgb().toString(),T=bf(e,i,.2).rgb().toString(),G=bf(e,i,.3).rgb().toString(),U=Rg(a,{theme:"default",backgroundColor:e}),et=h0()(a).hex().toLowerCase(),ct=U.indexOf(et),Ct=a;return ct!==-1&&(Ct=U[ct+1]),{mainStroke:a,mainFill:l,activeStroke:a,activeFill:s,inactiveStroke:d,inactiveFill:s,selectedStroke:a,selectedFill:e,highlightStroke:Ct,highlightFill:f,disableStroke:G,disableFill:w,edgeMainStroke:G,edgeActiveStroke:a,edgeInactiveStroke:T,edgeSelectedStroke:a,edgeHighlightStroke:a,edgeDisableStroke:E,comboMainStroke:G,comboMainFill:v,comboActiveStroke:a,comboActiveFill:s,comboInactiveStroke:G,comboInactiveFill:v,comboSelectedStroke:a,comboSelectedFill:v,comboHighlightStroke:Ct,comboHighlightFill:v,comboDisableStroke:T,comboDisableFill:w}},$2=function(a,e,i){e===void 0&&(e="#fff"),i===void 0&&(i="#777");var s=bf(e,a,.2).rgb().toString(),l=bf(e,a,.3).rgb().toString(),f=bf(e,a,.6).rgb().toString(),d=bf(e,a,.8).rgb().toString(),v=bf(e,i,.2).rgb().toString(),w=bf(e,i,.25).rgb().toString(),E=bf(e,i,.3).rgb().toString(),T=bf(e,i,.4).rgb().toString(),G=bf(e,i,.5).rgb().toString(),U=Rg(a,{theme:"dark",backgroundColor:e}),et=h0()(a).hex().toLowerCase(),ct=U.indexOf(et),Ct=a;return ct!==-1&&(Ct=U[ct+1]),{mainStroke:d,mainFill:s,activeStroke:a,activeFill:l,inactiveStroke:d,inactiveFill:s,selectedStroke:a,selectedFill:s,highlightStroke:a,highlightFill:f,disableStroke:G,disableFill:w,edgeMainStroke:i,edgeActiveStroke:a,edgeInactiveStroke:i,edgeSelectedStroke:a,edgeHighlightStroke:a,edgeDisableStroke:E,comboMainStroke:T,comboMainFill:w,comboActiveStroke:a,comboActiveFill:v,comboInactiveStroke:T,comboInactiveFill:w,comboSelectedStroke:a,comboSelectedFill:v,comboHighlightStroke:Ct,comboHighlightFill:w,comboDisableStroke:T,comboDisableFill:v}},ib=function(a,e,i,s){return e===void 0&&(e="#fff"),i===void 0&&(i="default"),s===void 0&&(s="rgb(150, 150, 150)"),i==="default"?z2(a,e,"rgb(150, 150, 150)"):$2(a,e,"#777")},G2=function(a,e,i,s){e===void 0&&(e="#fff"),i===void 0&&(i="default"),s===void 0&&(s="rgb(150, 150, 150)");var l=[];return a.forEach(function(f){l.push(ib(f,e,i,s))}),l},U2="rgb(95, 149, 255)",W2="rgb(255, 255, 255)",ow="rgb(0, 0, 0)",ku=ib(U2,W2),hg={version:"0.8.14",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:ku.mainStroke,fill:ku.mainFill},size:20,color:ku.mainStroke,linkPoints:{size:8,lineWidth:1,fill:ku.activeFill,stroke:ku.activeStroke}},nodeStateStyles:{active:{fill:ku.activeFill,stroke:ku.activeStroke,lineWidth:2,shadowColor:ku.mainStroke,shadowBlur:10},selected:{fill:ku.selectedFill,stroke:ku.selectedStroke,lineWidth:4,shadowColor:ku.selectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:ku.highlightFill,stroke:ku.highlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:ku.inactiveFill,stroke:ku.inactiveStroke,lineWidth:1},disable:{fill:ku.disableFill,stroke:ku.disableStroke,lineWidth:1}},edgeLabel:{style:{fill:ow,textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:ku.edgeMainStroke,lineAppendWidth:2},color:ku.edgeMainStroke},edgeStateStyles:{active:{stroke:ku.edgeActiveStroke,lineWidth:1},selected:{stroke:ku.edgeSelectedStroke,lineWidth:2,shadowColor:ku.edgeSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:ku.edgeHighlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:ku.edgeInactiveStroke,lineWidth:1},disable:{stroke:ku.edgeDisableStroke,lineWidth:1}},comboLabel:{style:{fill:ow,textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:ku.comboMainFill,lineWidth:1,stroke:ku.comboMainStroke,r:5,width:20,height:10},size:[20,5],color:ku.comboMainStroke,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:ku.comboActiveStroke,lineWidth:1,fill:ku.comboActiveFill},selected:{stroke:ku.comboSelectedStroke,lineWidth:2,fill:ku.comboSelectedFill,shadowColor:ku.comboSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:ku.comboHighlightStroke,lineWidth:2,fill:ku.comboHighlightFill,"text-shape":{fontWeight:500}},inactive:{stroke:ku.comboInactiveStroke,fill:ku.comboInactiveFill,lineWidth:1},disable:{stroke:ku.comboDisableStroke,fill:ku.comboDisableFill,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},textWaterMarkerConfig:{width:150,height:100,compatible:!1,text:{x:0,y:60,lineHeight:20,rotate:20,fontSize:14,fontFamily:"Microsoft YaHei",fill:"rgba(0, 0, 0, 0.1)",baseline:"Middle"}},imageWaterMarkerConfig:{width:150,height:130,compatible:!1,image:{x:0,y:0,width:30,height:20,rotate:0}},waterMarkerImage:"https://gw.alipayobjects.com/os/s/prod/antv/assets/image/logo-with-text-73b8a.svg"};function p0(c,a,e){if(c){if(typeof c.addEventListener=="function")return c.addEventListener(a,e,!1),{remove:function(){c.removeEventListener(a,e,!1)}};if(typeof c.attachEvent=="function")return c.attachEvent("on"+a,e),{remove:function(){c.detachEvent("on"+a,e)}}}}var sw=Zf.cloneEvent,uw=Zf.isViewportChanged,lw=function(c){(0,O.__extends)(a,c);function a(e){var i=c.call(this,e)||this;return i.extendEvents=[],i.dragging=!1,i.mousedown=!1,i.preItem=null,i.destroy(),i.graph=e,i.destroyed=!1,i.initEvents(),i}return a.prototype.initEvents=function(){var e=this,i=e.graph,s=e.extendEvents,l=s===void 0?[]:s,f=i.get("canvas"),d=f.get("el"),v=(0,_.wrapBehavior)(this,"onCanvasEvents"),w=(0,_.wrapBehavior)(this,"onExtendEvents"),E=(0,_.wrapBehavior)(this,"onWheelEvent");f.off("*").on("*",v),this.canvasHandler=v,l.push(p0(d,"wheel",E)),typeof window!="undefined"&&(l.push(p0(window,"keydown",w)),l.push(p0(window,"keyup",w)),l.push(p0(window,"focus",w))),this.resetHandler&&i.off("afterchangedata",this.resetHandler),this.resetHandler=(0,_.wrapBehavior)(this,"resetStatus"),i.on("afterchangedata",this.resetHandler)},a.getItemRoot=function(e){for(;e&&!e.get("item");)e=e.get("parent");return e},a.prototype.onCanvasEvents=function(e){var i=this,s=this.graph,l=s.get("canvas"),f=e.target,d=e.type;switch(d){case"drag":this.onCanvasEvents(Object.assign({},e,{type:"mousemove"}));break;case"dragend":this.onCanvasEvents(Object.assign({},e,{type:"mouseup"}));break;case"mousedown":this.mousedown=!0;break;case"dragend":case"mouseup":setTimeout(function(){return i.mousedown=!1});break;case"click":if(!this.mousedown)return;break;default:break}e.canvasX=e.x,e.canvasY=e.y;var v={x:e.canvasX,y:e.canvasY},w=s.get("group"),E=w.getMatrix();if(E||(E=[1,0,0,0,1,0,0,0,1]),uw(E)&&(v=s.getPointByClient(e.clientX,e.clientY)),e.x=v.x,e.y=v.y,e.currentTarget=s,f===l){(d==="mousemove"||d==="mouseleave")&&this.handleMouseMove(e,"canvas"),e.target=l,e.item=null,s.emit(d,e),s.emit("canvas:".concat(d),e);return}var T=a.getItemRoot(f);if(!T){s.emit(d,e);return}var G=T.get("item");if(!G.destroyed){var U=G.getType();if(e.target=f,e.item=G,e.canvasX===e.x&&e.canvasY===e.y){var et=s.getCanvasByPoint(e.x,e.y);e.canvasX=et.x,e.canvasY=et.y}e.name&&!e.name.includes(":")?(s.emit("".concat(U,":").concat(d),e),s.emit(d,e)):e.name&&s.emit(e.name,e),d==="dragstart"&&(this.dragging=!0),d==="dragend"&&(this.dragging=!1),d==="mousemove"&&this.handleMouseMove(e,U)}},a.prototype.onExtendEvents=function(e){this.graph.emit(e.type,e)},a.prototype.onWheelEvent=function(e){(0,_.isNil)(e.wheelDelta)&&(e.wheelDelta=-e.detail),this.graph.emit("wheel",e)},a.prototype.handleMouseMove=function(e,i){var s=this,l=s.graph,f=s.preItem,d=l.get("canvas"),v=e.target===d?null:e.item;e=sw(e),f&&f!==v&&!f.destroyed&&(e.item=f,this.emitCustomEvent(f.getType(),"mouseleave",e),this.dragging&&this.emitCustomEvent(f.getType(),"dragleave",e)),v&&f!==v&&(e.item=v,this.emitCustomEvent(i,"mouseenter",e),this.dragging&&this.emitCustomEvent(i,"dragenter",e)),this.preItem=v},a.prototype.emitCustomEvent=function(e,i,s){s.type=i,this.graph.emit("".concat(e,":").concat(i),s)},a.prototype.resetStatus=function(){this.mousedown=!1,this.dragging=!1,this.preItem=null},a.prototype.destroy=function(){var e=this,i=e.graph,s=e.canvasHandler,l=e.extendEvents,f=i.get("canvas");f.off("*",s),(0,_.each)(l,function(d){d.remove()}),this.resetStatus(),this.extendEvents.length=0,this.canvasHandler=null,this.resetHandler=null,this.destroyed=!0},a}(J0),cw=lw,pu=$(83360),fw=$(81746),v0=$.n(fw),hw=Zf.traverseTree,dw=function(a,e){var i;return a?(0,_.isNumber)(a)?i=function(l){return a}:i=a:i=function(l){return e||1},i},xy=function(a,e){var i=[],s=[],l={},f=0;for(f=0;f<a.length;f++){var d=a[f];l[d.id]=f,i.push(d.x),i.push(d.y),i.push(0),i.push(0),s.push([])}for(f=0;f<e.length;f++){var v=e[f];s[l[v.source]].push(l[v.target]),s[l[v.target]].push(l[v.source])}var w=0;for(f=0;f<a.length;f++){var E=i.length,T=s[f],G=T.length;i[f*4+2]=E,i[f*4+3]=T.length,w=Math.max(w,T.length);for(var U=0;U<G;++U){var et=T[U];i.push(+et)}}for(;i.length%4!=0;)i.push(0);return{array:new Float32Array(i),maxEdgePerVetex:w}},V2=function(a,e,i){var s=[],l=[],f={},d=0;for(d=0;d<a.length;d++){var v=a[d];f[v.id]=d,s.push(v.x),s.push(v.y),s.push(0),s.push(0),l.push([])}for(d=0;d<e.length;d++){var w=e[d];l[f[w.source]].push(f[w.target]),l[f[w.source]].push(i(w)),l[f[w.target]].push(f[w.source]),l[f[w.target]].push(i(w))}var E=0;for(d=0;d<a.length;d++){var T=s.length,G=l[d],U=G.length;s[d*4+2]=T,s[d*4+3]=U/2,E=Math.max(E,U/2);for(var et=0;et<U;++et){var ct=G[et];s.push(+ct)}}for(;s.length%4!=0;)s.push(0);return{array:new Float32Array(s),maxEdgePerVetex:E}},j2=function(a,e,i,s){var l=[],f=[],d={},v=0;for(v=0;v<a.length;v++){var w=a[v];d[w.id]=v,l.push(w.x),l.push(w.y),l.push(0),l.push(0),f.push([])}for(v=0;v<e.length;v++){var E=e[v];f[d[E.source]].push(d[E.target]),f[d[E.source]].push(i(E)),f[d[E.source]].push(s(E)),f[d[E.source]].push(0),f[d[E.target]].push(d[E.source]),f[d[E.target]].push(i(E)),f[d[E.target]].push(s(E)),f[d[E.target]].push(0)}var T=0;for(v=0;v<a.length;v++){var G=l.length,U=f[v],et=U.length;l[v*4+2]=G+1048576*et/4,l[v*4+3]=0,T=Math.max(T,et/4);for(var ct=0;ct<et;++ct){var Ct=U[ct];l.push(+Ct)}}for(;l.length%4!=0;)l.push(0);return{array:new Float32Array(l),maxEdgePerVetex:T}},H2=function(a,e){var i=[],s=a.length,l={};return e.forEach(function(f){a.forEach(function(d,v){if(l[f[d]]===void 0&&(l[f[d]]=Object.keys(l).length),i.push(l[f[d]]),v===s-1)for(;i.length%4!=0;)i.push(0)})}),{array:new Float32Array(i),count:Object.keys(l).length}},pw=function(a){for(var e=[],i=a.length,s=a[0].length,l=function(v){a.forEach(function(w,E){if(e.push(w[v]),E===i-1)for(;e.length%4!=0;)e.push(0)})},f=0;f<s;f++)l(f);return new Float32Array(e)},X2=function(a,e){var i=["V","TB","BT"],s={x:Infinity,y:Infinity},l={x:-Infinity,y:-Infinity},f="x",d="y";e&&i.indexOf(e)>=0&&(d="x",f="y");var v=0;hw(a,function(T){return v++,T.x>l.x&&(l.x=T.x),T.x<s.x&&(s.x=T.x),T.y>l.y&&(l.y=T.y),T.y<s.y&&(s.y=T.y),!0});var w=Math.PI*2/v,E=l[d]-s[d];return E===0||hw(a,function(T){var G=(T[d]-s[d])/E*(Math.PI*2-w)+w,U=Math.abs(f==="x"?T.x-a.x:T.y-a.y);return T.x=U*Math.cos(G),T.y=U*Math.sin(G),!0}),a},vw=function c(){return typeof window=="undefined"||typeof document=="undefined"?{}:{canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var a=document.createElement("canvas");return!!(window.WebGLRenderingContext&&(a.getContext("webgl")||a.getContext("experimental-webgl")))}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`)),e},addGetWebGLMessage:function(e){e=e||{};var i=e.parent!==void 0?e.parent:document.body,s=e.id!==void 0?e.id:"oldie",l=c().getWebGLErrorMessage();l.id=s,i.appendChild(l)}}},ob=(0,O.__assign)((0,O.__assign)((0,O.__assign)((0,O.__assign)({},Zf),B),R),F),Wv=ob,gw=Wv.radialLayout,Y2=function(){function c(a){this.type=a.type,this.radial=a.radial,this.config=a}return c.prototype.init=function(a){var e=this;if(this.data=a,this.radial){this.layoutMethod=function(i){var s=v0()[e.type](i,e.config);return gw(s),s};return}this.layoutMethod=function(i){return v0()[e.type](i,e.config)}},c.prototype.execute=function(){return this.layoutMethod(this.data,this.config)},c.prototype.layout=function(a){return this.init(a),this.execute()},c}(),K2=Y2;(0,pu.registerLayout)("grid",pu.GridLayout),(0,pu.registerLayout)("random",pu.RandomLayout),(0,pu.registerLayout)("force",pu.ForceLayout),(0,pu.registerLayout)("circular",pu.CircularLayout),(0,pu.registerLayout)("dagre",pu.DagreLayout),(0,pu.registerLayout)("dagreCompound",pu.DagreCompoundLayout),(0,pu.registerLayout)("radial",pu.RadialLayout),(0,pu.registerLayout)("concentric",pu.ConcentricLayout),(0,pu.registerLayout)("mds",pu.MDSLayout),(0,pu.registerLayout)("fruchterman",pu.FruchtermanLayout),(0,pu.registerLayout)("fruchterman-gpu",pu.FruchtermanGPULayout),(0,pu.registerLayout)("gForce",pu.GForceLayout),(0,pu.registerLayout)("force2",pu.Force2Layout),(0,pu.registerLayout)("gForce-gpu",pu.GForceGPULayout),(0,pu.registerLayout)("comboForce",pu.ComboForceLayout),(0,pu.registerLayout)("comboCombined",pu.ComboCombinedLayout),(0,pu.registerLayout)("forceAtlas2",pu.ForceAtlas2Layout);var mw=function(a,e){e.isCustomLayout=!0,pu.Layouts[a]=(0,pu.registerLayout)(a,e)},yw=function(){function c(a,e){var i=a.toString(),s=new Blob(["importScripts('".concat(e,"');(").concat(i,")()")],{type:"text/javascript"});return new Worker(URL.createObjectURL(s))}return c}(),sb=yw,Z2=function(a){a===void 0&&(a="https://unpkg.com/@antv/layout@latest/dist/layout.min.js");function e(){var s={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};layout.registerLayout("grid",layout.GridLayout),layout.registerLayout("random",layout.RandomLayout),layout.registerLayout("force",layout.ForceLayout),layout.registerLayout("force2",layout.Force2Layout),layout.registerLayout("circular",layout.CircularLayout),layout.registerLayout("dagre",layout.DagreLayout),layout.registerLayout("dagreCompound",layout.DagreCompoundLayout),layout.registerLayout("radial",layout.RadialLayout),layout.registerLayout("concentric",layout.ConcentricLayout),layout.registerLayout("mds",layout.MDSLayout),layout.registerLayout("fruchterman",layout.FruchtermanLayout),layout.registerLayout("fruchterman-gpu",layout.FruchtermanGPULayout),layout.registerLayout("gForce",layout.GForceLayout),layout.registerLayout("gForce-gpu",layout.GForceGPULayout),layout.registerLayout("comboForce",layout.ComboForceLayout),layout.registerLayout("comboCombined",layout.ComboCombinedLayout),layout.registerLayout("forceAtlas2",layout.ForceAtlas2Layout);function l(d){var v=d.data.type;return v===s.RUN||v===s.GPURUN}function f(d){var v=this,w=d.data.type;switch(w){case s.RUN:{var E=d.data,T=E.nodes,G=E.edges,U=E.layoutCfg,et=U===void 0?{}:U,ct=et.type,Ct=layout.getLayoutByName(ct);if(!Ct){this.postMessage({type:s.ERROR,message:"layout ".concat(ct," not found")});break}var Mt;et.onLayoutEnd=function(){v.postMessage({type:s.END,nodes:T}),Mt==null||Mt.destroy()},Mt=new Ct(et),Mt.init({nodes:T,edges:G}),Mt.execute();break}case s.GPURUN:{var Dt=d.data,zt=Dt.nodes,G=Dt.edges,Qt=Dt.layoutCfg,et=Qt===void 0?{}:Qt,Ie=Dt.canvas,ct=et.type,Ct=layout.getLayoutByName(ct);if(!Ct){this.postMessage({type:s.ERROR,message:"layout ".concat(ct," not found")});break}if(ct.split("-")[1]!=="gpu"){this.postMessage({type:s.ERROR,message:"layout ".concat(ct," does not support GPU")});break}var je=new Ct(et);je.init({nodes:zt,edges:G}),je.executeWithWorker(Ie,this);break}default:break}}onmessage=function(v){l(v)&&f(v)}}var i=new sb(e,a);return i},Cm={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};function ub(c){return ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ub(c)}var wy=function(a){return setTimeout(a,16)},g0=function(a){return clearTimeout(a)},Lg={requestAnimationFrame:function(a){var e=typeof window!="undefined"&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame)||wy;return e(a)},cancelAnimationFrame:function(a){var e=typeof window!="undefined"&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame)||g0;return e(a)}},Ey=["fruchterman","gForce"],Sy=["force","grid","circular"],q2=function(c){(0,O.__extends)(a,c);function a(e){var i=c.call(this,e)||this;return i.graph=e,i.layoutCfg=e.get("layout")||{},i.layoutType=i.getLayoutType(),i.worker=null,i.workerData={},i.initLayout(),i}return a.prototype.initLayout=function(){},a.prototype.getWorker=function(){return this.worker?this.worker:(typeof Worker=="undefined"?(console.warn("Web worker is not supported in current browser."),this.worker=null):this.worker=Z2(this.layoutCfg.workerScriptURL),this.worker)},a.prototype.stopWorker=function(){var e=this.workerData;!this.worker||(this.worker.terminate(),this.worker=null,e.requestId&&(Lg.cancelAnimationFrame(e.requestId),e.requestId=null),e.requestId2&&(Lg.cancelAnimationFrame(e.requestId2),e.requestId2=null))},a.prototype.execLayoutMethod=function(e,i){var s=this;return new Promise(function(l,f){return(0,O.__awaiter)(s,void 0,void 0,function(){var d,v,w,E,T,G,U,et,ct,G,Ct;return(0,O.__generator)(this,function(Mt){switch(Mt.label){case 0:if(d=this.graph,!d||d.get("destroyed"))return[2];v=e.type,e.onLayoutEnd=function(){d.emit("aftersublayout",{type:v}),l()},v&&this.isGPU&&(ww(v)?v="".concat(v,"-gpu"):console.warn("The '".concat(v,"' layout does not support GPU calculation for now, it will run in CPU."))),Zf.isForce(v)?(w=e.onTick,E=e.animate,T=E===void 0&&(v==="force"||v==="force2"),G=function(){w&&w(),(E||T)&&d.refreshPositions()},e.tick=G):(v==="comboForce"||v==="comboCombined")&&(e.comboTrees=d.get("comboTrees")),U=!1;try{et=new pu.Layouts[v](e),this.layoutMethods[i]&&this.layoutMethods[i].destroy(),this.layoutMethods[i]=et}catch(Dt){console.warn("The layout method: '".concat(v,"' does not exist! Please specify it first.")),f()}return U=et.enableTick,U&&(ct=e.onTick,G=function(){ct&&ct(),d.refreshPositions()},et.tick=G),Ct=this.filterLayoutData(this.data,e),xw(Ct,i),et.init(Ct),d.emit("beforesublayout",{type:v}),[4,et.execute()];case 1:return Mt.sent(),et.isCustomLayout&&e.onLayoutEnd&&e.onLayoutEnd(),[2]}})})})},a.prototype.updateLayoutMethod=function(e,i){var s=this;return new Promise(function(l,f){return(0,O.__awaiter)(s,void 0,void 0,function(){var d,v,w,E,T,G,U;return(0,O.__generator)(this,function(et){switch(et.label){case 0:return d=this.graph,v=i==null?void 0:i.type,i.onLayoutEnd=function(){d.emit("aftersublayout",{type:v}),l()},Zf.isForce(v)&&(w=i.onTick,E=i.animate,T=E===void 0&&(v==="force"||v==="force2"),G=function(){w==null||w(),(E||T)&&d.refreshPositions()},i.tick=G),U=this.filterLayoutData(this.data,i),e.init(U),e.updateCfg(i),d.emit("beforesublayout",{type:v}),[4,e.execute()];case 1:return et.sent(),e.isCustomLayout&&i.onLayoutEnd&&i.onLayoutEnd(),[2]}})})})},a.prototype.layout=function(e){var i=this,s,l=this.graph;if(!(!l||l.get("destroyed"))){this.data=this.setDataFromGraph();var f=this.data,d=f.nodes,v=f.hiddenNodes;if(!d)return!1;var w=l.get("width"),E=l.get("height"),T={};Object.assign(T,{width:w,height:E,center:[w/2,E/2]},this.layoutCfg),this.layoutCfg=T;var G=T.type,U=!1;(s=this.layoutMethods)===null||s===void 0||s.forEach(function(Ie){var je;return U=!!((je=Ie.nodes)===null||je===void 0?void 0:je.length)||U});var et=this.destoryLayoutMethods();l.emit("beforelayout");var ct=Promise.resolve();U&&G&&(et==null?void 0:et.length)===1&&et[0]===G?this.tweakInit():ct=this.initPositions(T.center,d);var Ct=this.initPositions(T.center,v);Ct.then(),this.isGPU=fb(T,G);var Mt=T.onLayoutEnd,Dt=T.layoutEndFormatted,zt=T.adjust;if(Dt||(T.layoutEndFormatted=!0,T.onAllLayoutEnd=function(){return(0,O.__awaiter)(i,void 0,void 0,function(){return(0,O.__generator)(this,function(Ie){switch(Ie.label){case 0:return Mt&&Mt(d),this.refreshLayout(),zt&&T.pipes?[4,this.adjustPipesBox(this.data,zt)]:[3,2];case 1:Ie.sent(),this.refreshLayout(),Ie.label=2;case 2:return l.emit("afterlayout"),[2]}})})}),this.stopWorker(),T.workerEnabled&&this.layoutWithWorker(this.data,e))return!0;var Qt=!1;return T.type?(Qt=!0,ct=ct.then(function(){return(0,O.__awaiter)(i,void 0,void 0,function(){return(0,O.__generator)(this,function(Ie){switch(Ie.label){case 0:return[4,this.execLayoutMethod(T,0)];case 1:return[2,Ie.sent()]}})})})):T.pipes&&(Qt=!0,T.pipes.forEach(function(Ie,je){ct=ct.then(function(){return(0,O.__awaiter)(i,void 0,void 0,function(){return(0,O.__generator)(this,function(ze){switch(ze.label){case 0:return[4,this.execLayoutMethod(Ie,je)];case 1:return[2,ze.sent()]}})})})})),Qt?ct.then(function(){T.onAllLayoutEnd&&T.onAllLayoutEnd(),e&&e()}).catch(function(Ie){console.warn("graph layout failed,",Ie)}):(l.refreshPositions(),e==null||e()),!1}},a.prototype.tweakInit=function(){var e=this,i=e.data,s=e.graph,l=i.nodes,f=i.edges;if(!!(l==null?void 0:l.length)){var d={};l.forEach(function(E){var T=E.x,G=E.y;!isNaN(T)&&!isNaN(G)&&(d[E.id]={x:T,y:G},E.mass=E.mass||2)}),f.forEach(function(E){var T=E.source,G=E.target,U=d[T],et=d[G];!U&&et?d[T]={x:et.x+(Math.random()-.5)*80,y:et.y+(Math.random()-.5)*80}:!et&&U&&(d[G]={x:U.x+(Math.random()-.5)*80,y:U.y+(Math.random()-.5)*80})});var v=s.get("width"),w=s.get("height");l.forEach(function(E){var T=d[E.id]||{x:v/2+(Math.random()-.5)*20,y:w/2+(Math.random()-.5)*20};E.x=T.x,E.y=T.y})}},a.prototype.initWithPreset=function(e,i){var s=this;return new Promise(function(l,f){return(0,O.__awaiter)(s,void 0,void 0,function(){var d,v,w,E,T,G,U;return(0,O.__generator)(this,function(et){switch(et.label){case 0:return d=this,v=d.layoutCfg,w=d.data,E=v.preset,!(E==null?void 0:E.type)||!pu.Layouts[E==null?void 0:E.type]?(i==null||i(),l(),[2,!1]):(T=fb(E,E.type),G=T?"".concat(E.type,"-gpu"):E.type,U=new pu.Layouts[G](E),delete v.preset,U.init(w),[4,U.execute()]);case 1:return et.sent(),e==null||e(),l(),[2,!0]}})})})},a.prototype.layoutWithWorker=function(e,i){var s=this,l=this,f=l.layoutCfg,d=l.graph,v=this.getWorker(),w=this.workerData;if(!v)return!1;w.requestId=null,w.requestId2=null,w.currentTick=null,w.currentTickData=null,d.emit("beforelayout");var E=Promise.resolve(),T=!1;if(f.type)T=!0,E=E.then(function(){return s.runWebworker(v,e,f)});else if(f.pipes){T=!0;for(var G=function(Mt){E=E.then(function(){return s.runWebworker(v,e,Mt)})},U=0,et=f.pipes;U<et.length;U++){var ct=et[U];G(ct)}}return T&&E.then(function(){f.onAllLayoutEnd&&f.onAllLayoutEnd(),i==null||i()}).catch(function(Ct){console.error("layout failed",Ct)}),!0},a.prototype.runWebworker=function(e,i,s){var l=this,f=this.isGPU,d=this.filterLayoutData(i,s),v=d.nodes,w=d.edges,E=document.createElement("canvas"),T=f&&typeof window!="undefined"&&window.navigator&&!navigator.gpu&&"OffscreenCanvas"in window&&"transferControlToOffscreen"in E,G=bw(s,function(et){return typeof et!="function"});if(!T)e.postMessage({type:Cm.RUN,nodes:v,edges:w,layoutCfg:G});else{var U=E.transferControlToOffscreen();G.type="".concat(G.type,"-gpu"),e.postMessage({type:Cm.GPURUN,nodes:v,edges:w,layoutCfg:G,canvas:U},[U])}return new Promise(function(et,ct){e.onmessage=function(Ct){l.handleWorkerMessage(et,ct,Ct,d,s)}})},a.prototype.handleWorkerMessage=function(e,i,s,l,f){var d=this,v=d.graph,w=d.workerData,E=s.data,T=E.type,G=function(){f.onTick&&f.onTick()};switch(T){case Cm.TICK:w.currentTick=E.currentTick,w.currentTickData=E,w.requestId||(w.requestId=Lg.requestAnimationFrame(function(){cb(l,E),v.refreshPositions(),G(),E.currentTick===E.totalTicks?e():w.currentTick===E.totalTicks&&(w.requestId2=Lg.requestAnimationFrame(function(){cb(l,w.currentTickData),v.refreshPositions(),w.requestId2=null,G(),e()})),w.requestId=null}));break;case Cm.END:w.currentTick==null&&(cb(l,E),e());break;case Cm.GPUEND:w.currentTick==null&&(Q2(l,E),e());break;case Cm.ERROR:console.warn("Web-Worker layout error!",E.message),i();break;default:i();break}},a.prototype.updateLayoutCfg=function(e){var i=this,s=this,l=s.graph,f=s.layoutMethods;if(!(!l||l.get("destroyed"))){var d=e.disableTriggerLayout,v=(0,O.__rest)(e,["disableTriggerLayout"]),w=(0,_.mix)({},this.layoutCfg,v);if(this.layoutCfg=w,!d){if(!(f==null?void 0:f.length)){this.layout();return}if(this.data=this.setDataFromGraph(),this.stopWorker(),!(v.workerEnabled&&this.layoutWithWorker(this.data,null))){l.emit("beforelayout");var E=Promise.resolve(),T=!1;(f==null?void 0:f.length)===1?(T=!0,E=E.then(function(){return(0,O.__awaiter)(i,void 0,void 0,function(){return(0,O.__generator)(this,function(G){switch(G.label){case 0:return[4,this.updateLayoutMethod(f[0],w)];case 1:return[2,G.sent()]}})})})):(f==null?void 0:f.length)&&(T=!0,f.forEach(function(G,U){var et=w.pipes[U];E=E.then(function(){return(0,O.__awaiter)(i,void 0,void 0,function(){return(0,O.__generator)(this,function(ct){switch(ct.label){case 0:return[4,this.updateLayoutMethod(G,et)];case 1:return[2,ct.sent()]}})})})})),T&&E.then(function(){w.onAllLayoutEnd&&w.onAllLayoutEnd()}).catch(function(G){console.warn("layout failed",G)})}}}},a.prototype.adjustPipesBox=function(e,i){var s=this;return new Promise(function(l){var f=e.nodes;(f==null?void 0:f.length)||l(),Sy.includes(i)||(console.warn("The adjust type ".concat(i," is not supported yet, please assign it with 'force', 'grid', or 'circular'.")),l());var d={center:s.layoutCfg.center,nodeSize:function(et){return Math.max(et.height,et.width)},preventOverlap:!0,onLayoutEnd:function(){}},v=s.getLayoutBBox(f),w=v.groupNodes,E=v.layoutNodes,T=(0,_.clone)(E);d.onLayoutEnd=function(){E==null||E.forEach(function(U,et){var ct,Ct,Mt,Dt=U.x-((ct=T[et])===null||ct===void 0?void 0:ct.x),zt=U.y-((Ct=T[et])===null||Ct===void 0?void 0:Ct.y);(Mt=w[et])===null||Mt===void 0||Mt.forEach(function(Qt){Qt.x+=Dt,Qt.y+=zt})}),l()};var G=new pu.Layouts[i](d);G.layout({nodes:E})})},a.prototype.destroy=function(){this.destoryLayoutMethods();var e=this.worker;e&&(e.terminate(),this.worker=null),this.destroyed=!0,this.graph.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0,this.graph=null},a}(L1),lb=q2;function cb(c,a){for(var e=c.nodes,i=a.nodes,s=e.length,l=0;l<s;l++){var f=e[l];f.x=i[l].x,f.y=i[l].y}}function bw(c,a){var e={};return c&&ub(c)==="object"?(Object.keys(c).forEach(function(i){c.hasOwnProperty(i)&&a(c[i])&&(e[i]=c[i])}),e):c}function Q2(c,a){for(var e=c.nodes,i=a.vertexEdgeData,s=e.length,l=0;l<s;l++){var f=e[l],d=i[4*l],v=i[4*l+1];f.x=d,f.y=v}}function xw(c,a){var e;if(!!((e=c==null?void 0:c.nodes)===null||e===void 0?void 0:e.length)){var i=c.nodes;i.forEach(function(s){s.layoutOrder=a})}}function ww(c){return Ey.includes(c)}function fb(c,a){var e=a;a&&a.split("-")[1]==="gpu"&&(e=a.split("-")[0],c.gpuEnabled=!0);var i=!1;return c.gpuEnabled&&(i=!0,vw().webgl||(console.warn("Your browser does not support webGL or GPGPU. The layout will run in CPU."),i=!1)),i&&!ww(e)&&(console.warn("The '".concat(e,"' layout does not support GPU calculation for now, it will run in CPU.")),i=!1),i}var m0,_m,Ew,hb;function J2(){m0=document.createElement("table"),_m=document.createElement("tr"),Ew=/^\s*<(\w+|!)[^>]*>/,hb={tr:document.createElement("tbody"),tbody:m0,thead:m0,tfoot:m0,td:_m,th:_m,"*":document.createElement("div")}}function Hl(c){m0||J2();var a=Ew.test(c)&&RegExp.$1;(!a||!(a in hb))&&(a="*");var e=hb[a];c=typeof c=="string"?c.replace(/(^\s*)|(\s*$)/g,""):c,e.innerHTML=""+c;var i=e.childNodes[0];return i&&e.contains(i)&&e.removeChild(i),i}var tC=function(a){var e=a.clone();return Sw(a,e),e},Sw=function c(a,e){var i;a.isGroup()&&e.isGroup()&&((i=a.get("children"))===null||i===void 0||i.forEach(function(d,v){var w=e.get("children")[v];c(d,w)}));var s=a.get("type"),l=e.get("type");if(!(s!=="image"||l!=="image")){var f=a.get("clipShape");f&&e.setClip({type:f.get("type"),attrs:f.attr()})}},Cw=ie,eC="svg",nC=function(c){(0,O.__extends)(a,c);function a(e){var i=c.call(this,e)||this,s=i.get("defaultNode");return s||i.set("defaultNode",{type:"circle"}),s.type||(s.type="circle",i.set("defaultNode",s)),i.destroyed=!1,i}return a.prototype.initLayoutController=function(){var e=new lb(this);this.set({layoutController:e})},a.prototype.initEventController=function(){var e=new cw(this);this.set({eventController:e})},a.prototype.initCanvas=function(){var e=this.get("container");if(typeof e=="string"&&(e=document.getElementById(e),this.set("container",e)),!e)throw new Error("invalid container");var i=e.clientWidth,s=e.clientHeight,l=this.get("width")||i,f=this.get("height")||s;!this.get("width")&&!this.get("height")&&(this.set("width",i),this.set("height",s));var d=this.get("renderer"),v;if(d===eC)v=new Ff({container:e,width:l,height:f});else{var w={container:e,width:l,height:f},E=this.get("pixelRatio");E&&(w.pixelRatio=E,window.devicePixelRatio=E),v=new Gv(w)}this.set("canvas",v)},a.prototype.initPlugins=function(){var e=this;(0,_.each)(e.get("plugins"),function(i){!i.destroyed&&i.initPlugin&&i.initPlugin(e)})},a.prototype.downloadImageWatermark=function(e,i,s,l){return(0,O.__awaiter)(this,void 0,void 0,function(){var f,d,v;return(0,O.__generator)(this,function(w){switch(w.label){case 0:return f=e.style.backgroundImage,d=f.slice(5,f.length-2),v=new Image,v.src=d,[4,new Promise(function(E){v.onload=function(){var T=i.createPattern(v,"repeat");i.rect(0,0,s,l),i.fillStyle=T,i.fill(),E("")}})];case 1:return w.sent(),[2]}})})},a.prototype.asyncToDataUrl=function(e,i,s,l,f,d){var v=this,w=document.querySelector(".g6-graph-watermarker"),E=this.get("canvas"),T=E.getRenderer(),G=d||E.get("el"),U="";e||(e="image/png"),setTimeout(function(){return(0,O.__awaiter)(v,void 0,void 0,function(){var et,ct,Ct,Mt,Dt,zt,Qt,Ie,je,ze;return(0,O.__generator)(this,function(mn){switch(mn.label){case 0:return T!=="svg"?[3,1]:(et=G.cloneNode(!0),ct=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),Ct=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",ct),Ct.replaceChild(et,Ct.documentElement),Mt=new XMLSerializer().serializeToString(Ct),U="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(Mt)),[3,4]);case 1:return Dt=void 0,zt=G.getContext("2d"),Qt=l||this.get("width"),Ie=f||this.get("height"),je=void 0,w?[4,this.downloadImageWatermark(w,zt,Qt,Ie)]:[3,3];case 2:mn.sent(),mn.label=3;case 3:if(i){ze=typeof window!="undefined"?window.devicePixelRatio:1;try{Dt=zt.getImageData(0,0,Qt*ze,Ie*ze),je=zt.globalCompositeOperation,zt.globalCompositeOperation="destination-over",zt.fillStyle=i,zt.fillRect(0,0,Qt,Ie)}catch($n){console.error("Download image failed. Out of memory at ImageData creation")}}U=G.toDataURL(e),i&&(zt.clearRect(0,0,Qt,Ie),zt.putImageData(Dt,0,0),zt.globalCompositeOperation=je),mn.label=4;case 4:return s&&s(U),[2]}})})},16)},a.prototype.toDataURL=function(e,i){var s=this.get("canvas"),l=s.getRenderer(),f=s.get("el");e||(e="image/png");var d="";if(l==="svg"){var v=f.cloneNode(!0),w=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),E=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",w);E.replaceChild(v,E.documentElement);var T=new XMLSerializer().serializeToString(E);d="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(T))}else{var G=void 0,U=f.getContext("2d"),et=Math.max(this.get("width"),500),ct=Math.max(this.get("height"),500),Ct=void 0;if(i){var Mt=typeof window!="undefined"&&window.devicePixelRatio||1;try{G=U.getImageData(0,0,et*Mt,ct*Mt),Ct=U.globalCompositeOperation,U.globalCompositeOperation="destination-over",U.fillStyle=i,U.fillRect(0,0,et,ct)}catch(Dt){console.error("Download image failed. Out of memory at ImageData creation")}}d=f.toDataURL(e),i&&(U.clearRect(0,0,et,ct),U.putImageData(G,0,0),U.globalCompositeOperation=Ct)}return d},a.prototype.toFullDataURL=function(e,i,s){var l=this.get("group").getCanvasBBox(),f=l.height,d=l.width,v=this.get("renderer"),w=Hl('<div id="virtual-image"></div>'),E=s?s.backgroundColor:void 0,T=s?s.padding:void 0;T?(0,_.isNumber)(T)&&(T=[T,T,T,T]):T=[0,0,0,0];var G=f+T[0]+T[2],U=d+T[1]+T[3],et={container:w,height:G,width:U,quickHit:!0},ct=v==="svg"?new Ff(et):new Gv(et),Ct=this.get("group"),Mt=Ct.clone(),Dt=(0,_.clone)(Mt.getMatrix());Dt||(Dt=[1,0,0,0,1,0,0,0,1]);var zt=(l.maxX+l.minX)/2,Qt=(l.maxY+l.minY)/2;Dt=Cw(Dt,[["t",-zt,-Qt],["t",d/2+T[3],f/2+T[0]]]),Mt.resetMatrix(),Mt.setMatrix(Dt),ct.add(Mt);var Ie=ct.get("el"),je="";i||(i="image/png"),setTimeout(function(){if(v==="svg"){var ze=Ie.cloneNode(!0),mn=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),$n=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",mn);$n.replaceChild(ze,$n.documentElement);var Tn=new XMLSerializer().serializeToString($n);je="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(Tn))}else{var or=void 0,kr=Ie.getContext("2d"),Ta=void 0;if(E){var fi=typeof window!="undefined"?window.devicePixelRatio:1;try{or=kr.getImageData(0,0,U*fi,G*fi),Ta=kr.globalCompositeOperation,kr.globalCompositeOperation="destination-over",kr.fillStyle=E,kr.fillRect(0,0,U,G)}catch(ei){console.error("Download image failed. Out of memory at ImageData creation")}}je=Ie.toDataURL(i),E&&(kr.clearRect(0,0,U,G),kr.putImageData(or,0,0),kr.globalCompositeOperation=Ta)}e&&e(je)},16)},a.prototype.downloadFullImage=function(e,i,s){var l=this,f=this.get("group").getCanvasBBox(),d=f.height,v=f.width,w=this.get("renderer"),E=Hl('<div id="virtual-image"></div>'),T=document.querySelector(".g6-graph-watermarker"),G=s?s.backgroundColor:void 0,U=s?s.padding:void 0;U?(0,_.isNumber)(U)&&(U=[U,U,U,U]):U=[0,0,0,0];var et=d+U[0]+U[2],ct=v+U[1]+U[3];if(T){var Ct=this.get("graphWaterMarker").cfg||{},Mt=Ct.width,Dt=Ct.height;et=Math.ceil(et/Dt)*Dt,ct=Math.ceil(ct/Mt)*Mt}var zt={container:E,height:et,width:ct},Qt=w==="svg"?new Ff(zt):new Gv(zt),Ie=this.get("group"),je=tC(Ie),ze=(0,_.clone)(je.getMatrix());ze||(ze=[1,0,0,0,1,0,0,0,1]);var mn=(f.maxX+f.minX)/2,$n=(f.maxY+f.minY)/2;ze=Cw(ze,[["t",-mn,-$n],["t",v/2+U[3],d/2+U[0]]]),je.resetMatrix(),je.setMatrix(ze),Qt.add(je);var Tn=Qt.get("el");i||(i="image/png"),this.asyncToDataUrl(i,G,function(or){var kr=document.createElement("a"),Ta=(e||"graph")+(w==="svg"?".svg":".".concat(i.split("/")[1]));l.dataURLToImage(or,w,kr,Ta);var fi=document.createEvent("MouseEvents");fi.initEvent("click",!1,!1),kr.dispatchEvent(fi)},ct,et,Tn)},a.prototype.downloadImage=function(e,i,s){var l=this,f=this;f.stopAnimate();var d=f.get("canvas"),v=d.getRenderer();i||(i="image/png");var w=(e||"graph")+(v==="svg"?".svg":i.split("/")[1]),E=document.createElement("a");f.asyncToDataUrl(i,s,function(T){l.dataURLToImage(T,v,E,w);var G=document.createEvent("MouseEvents");G.initEvent("click",!1,!1),E.dispatchEvent(G)})},a.prototype.dataURLToImage=function(e,i,s,l){if(!e||e==="data:"){console.error("Download image failed. The graph is too large or there is invalid attribute values in graph items");return}if(typeof window!="undefined")if(window.Blob&&window.URL&&i!=="svg"){var f=e.split(","),d="";if(f&&f.length>0){var v=f[0].match(/:(.*?);/);v&&v.length>=2&&(d=v[1])}for(var w=atob(f[1]),E=w.length,T=new Uint8Array(E);E--;)T[E]=w.charCodeAt(E);var G=new Blob([T],{type:d});window.navigator.msSaveBlob?window.navigator.msSaveBlob(G,l):s.addEventListener("click",function(){s.download=l,s.href=window.URL.createObjectURL(G)})}else s.addEventListener("click",function(){s.download=l,s.href=e})},a.prototype.addPlugin=function(e){var i=this;e.destroyed||(i.get("plugins").push(e),e.initPlugin(i))},a.prototype.removePlugin=function(e){var i=this.get("plugins"),s=i.indexOf(e);s>=0&&(e.destroyPlugin(),i.splice(s,1))},a.prototype.setImageWaterMarker=function(e,i){e===void 0&&(e=hg.waterMarkerImage);var s=this.get("container");(0,_.isString)(s)&&(s=document.getElementById(s)),s.style.position||(s.style.position="relative");var l=this.get("graphWaterMarker"),f=(0,_.deepMix)({},hg.imageWaterMarkerConfig,i),d=f.width,v=f.height,w=f.compatible,E=f.image;if(!e){var T=w?s:document.querySelector(".g6-graph-watermarker");T&&(T.style.cssText=void 0),l&&l.clear();return}if(l)l.clear();else{var G={container:s,width:d,height:v,capture:!1},U=this.get("pixelRatio");U&&(G.pixelRatio=U,window.devicePixelRatio=U),l=new Gv(G),this.set("graphWaterMarker",l)}l.get("el").style.display="none";var et=l.get("context"),ct=E.rotate,Ct=E.x,Mt=E.y;et.rotate(-ct*Math.PI/180);var Dt=new Image;Dt.crossOrigin="anonymous",Dt.src=e,Dt.onload=function(){if(et.drawImage(Dt,Ct,Mt,E.width,E.height),et.rotate(ct*Math.PI/180),w)s.style.cssText="background-image: url(".concat(l.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var zt=document.querySelector(".g6-graph-watermarker");zt||(zt=document.createElement("div"),zt.className="g6-graph-watermarker"),zt.className="g6-graph-watermarker",l.destroyed||(zt.style.cssText="background-image: url(".concat(l.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:-1;"),s.appendChild(zt))}}},a.prototype.setTextWaterMarker=function(e,i){var s=this.get("container");(0,_.isString)(s)&&(s=document.getElementById(s)),s.style.position||(s.style.position="relative");var l=this.get("graphWaterMarker"),f=(0,_.deepMix)({},hg.textWaterMarkerConfig,i),d=f.width,v=f.height,w=f.compatible,E=f.text;if(!(e==null?void 0:e.length)){var T=w?s:document.querySelector(".g6-graph-watermarker");T&&(T.style.cssText=void 0),l&&l.clear();return}if(l)l.clear();else{var G={container:s,width:d,height:v,capture:!1},U=this.get("pixelRatio");U&&(G.pixelRatio=U,window.devicePixelRatio=U),l=new Gv(G),this.set("graphWaterMarker",l)}l.get("el").style.display="none";var et=l.get("context"),ct=E.rotate,Ct=E.fill,Mt=E.fontFamily,Dt=E.fontSize,zt=E.baseline,Qt=E.x,Ie=E.y,je=E.lineHeight;et.rotate(-ct*Math.PI/180),et.font="".concat(Dt,"px ").concat(Mt),et.fillStyle=Ct,et.textBaseline=zt;for(var ze=(0,_.isString)(e)?[e]:e,mn=ze.length-1;mn>=0;mn--)et.fillText(ze[mn],Qt,Ie+mn*je);if(et.rotate(ct*Math.PI/180),w)s.style.cssText="background-image: url(".concat(l.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var $n=document.querySelector(".g6-graph-watermarker");$n||($n=document.createElement("div"),$n.className="g6-graph-watermarker"),$n.style.cssText="background-image: url(".concat(l.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:99;"),s.appendChild($n)}},a.prototype.destroy=function(){var e,i,s,l;(0,_.each)(this.get("plugins"),function(E){E.destroyPlugin()});var f=this.get("tooltips");if(f)for(var d=0;d<f.length;d++){var v=f[d];if(!!v){var w=v.parentElement;!w||w.removeChild(v)}}(e=this.get("eventController"))===null||e===void 0||e.destroy(),(i=this.get("layoutController"))===null||i===void 0||i.destroy(),(s=this.get("graphWaterMarker"))===null||s===void 0||s.destroy(),(l=document.querySelector(".g6-graph-watermarker"))===null||l===void 0||l.remove(),c.prototype.destroy.call(this)},a}(Lx),_w=nC,rC=Wv.radialLayout,db=Wv.traverseTree,aC=function(c){(0,O.__extends)(a,c);function a(e){var i=c.call(this,e)||this;return i.layoutAnimating=!1,i.set("removeList",[]),i.set("layoutMethod",i.getLayout()),i}return a.prototype.getLayout=function(){var e=this.get("layout");return e?typeof e=="function"?e:(e.type||(e.type="dendrogram"),e.direction||(e.direction=e.type==="indented"?"LR":"TB"),e.radial?function(i){var s=v0()[e.type](i,e);return rC(s),s}:function(i){return v0()[e.type](i,e)}):null},a.indexOfChild=function(e,i){var s=-1;return(0,_.each)(e,function(l,f){if(i===l.id)return s=f,!1}),s},a.prototype.getDefaultCfg=function(){var e=c.prototype.getDefaultCfg.call(this);return e.animate=!0,e},a.prototype.innerAddChild=function(e,i,s){var l=this,f=e.data;f&&(f.x=e.x,f.y=e.y,f.depth=e.depth);var d=l.addItem("node",f,!1);if(i){if(d.set("parent",i),s){var v=i.get("originAttrs");if(v)d.set("originAttrs",v);else{var w=i.getModel();d.set("originAttrs",{x:w.x,y:w.y})}}var E=i.get("children");E?E.push(d):i.set("children",[d]),l.addItem("edge",{source:i.get("id"),target:d.get("id"),id:"".concat(i.get("id"),":").concat(d.get("id"))},!1)}return(0,_.each)(e.children||[],function(T){l.innerAddChild(T,d,s)}),l.emit("afteraddchild",{item:d,parent:i}),d},a.prototype.innerUpdateChild=function(e,i,s){var l=this,f=l.findById(e.id);if(!f){l.innerAddChild(e,i,s);return}(0,_.each)(e.children||[],function(et){l.innerUpdateChild(et,f,s)});var d=f.get("children");if(d){var v=d.length;if(v>0)for(var w=d.length-1;w>=0;w--){var E=d[w].getModel();a.indexOfChild(e.children||[],E.id)===-1&&(l.innerRemoveChild(E.id,{x:e.x,y:e.y},s),d.splice(w,1))}}var T,G;f.get("originAttrs")&&(T=f.get("originAttrs").x,G=f.get("originAttrs").y);var U=f.getModel();s&&f.set("originAttrs",{x:U.x,y:U.y}),f.set("model",Object.assign(U,e.data)),(T!==e.x||G!==e.y)&&f.updatePosition({x:e.x,y:e.y})},a.prototype.innerRemoveChild=function(e,i,s){var l=this,f=l.findById(e);if(!!f)if((0,_.each)(f.get("children"),function(v){l.innerRemoveChild(v.getModel().id,i,s)}),s){var d=f.getModel();f.set("to",i),f.set("originAttrs",{x:d.x,y:d.y}),l.get("removeList").push(f)}else l.removeItem(f,!1)},a.prototype.changeData=function(e,i){i===void 0&&(i=!0);var s=this;this.getNodes().map(function(l){return s.clearItemStates(l)}),this.getEdges().map(function(l){return s.clearItemStates(l)}),i&&this.get("enabledStack")&&this.pushStack("changedata",{before:s.get("originData"),after:e||s.get("data")}),e?(s.data(e),s.render(!1)):s.layout(this.get("fitView"))},a.prototype.changeLayout=function(e){console.warn("Please call updateLayout instead of changeLayout. changeLayout will be discarded soon");var i=this;i.updateLayout(e)},a.prototype.updateLayout=function(e,i,s,l){l===void 0&&(l=!0);var f=this;if(!e){console.warn("layout cannot be null");return}if(l&&this.get("enabledStack")&&this.pushStack("layout",{before:f.get("layout"),after:e}),f.set("layout",e),f.set("layoutMethod",f.getLayout()),f.layout(),i){var d=s;d||(i==="begin"?d={x:0,y:0}:d={x:this.getWidth()/2,y:this.getHeight()/2}),d=this.getPointByCanvas(d.x,d.y);var v=this.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];d.x=d.x*v[0]+v[6],d.y=d.y*v[0]+v[7];var w=this.getGroup().getCanvasBBox(),E=w.minX,T=w.maxX,G=w.minY,U=w.maxY,et={x:(E+T)/2,y:(G+U)/2};i==="begin"&&(et.x=E,et.y=G),this.translate(d.x-et.x,d.y-et.y)}},a.prototype.refreshLayout=function(e){console.warn("Please call layout instead of refreshLayout. refreshLayout will be discarded soon");var i=this;i.layout(e)},a.prototype.layout=function(e){var i=this,s=this,l=s.get("data"),f=s.get("layoutMethod"),d=s.get("layout"),v=l;if(d==null?void 0:d.excludeInvisibles){l=(0,_.clone)(s.get("data"));var w={};db(l,function(G){var U=G.children;if(!(U==null?void 0:U.length))return!0;for(var et=U.length-1;et>=0;et--){var ct=i.findById(U[et].id),Ct=ct?!ct.isVisible():U[et].visible===!1;Ct&&(w[G.id]=w[G.id]||[],w[G.id].push({idx:et,child:U.splice(et,1)[0]}))}}),v=f?f(l,s.get("layout")):l,db(v,function(G){var U=w[G.id];if(U==null?void 0:U.length)for(var et=U.length-1;et>=0;et--){var ct=U[et],Ct=ct.idx,Mt=ct.child;G.children.splice(Ct,0,Mt)}})}else v=f?f(l,s.get("layout")):l;var E=s.get("animate");if(s.emit("beforerefreshlayout",{data:l,layoutData:v}),s.emit("beforelayout"),s.innerUpdateChild(v,void 0,E),e){var T=s.get("viewController");T.fitView()}E?s.layoutAnimate(v):(s.refresh(),s.paint()),s.emit("afterrefreshlayout",{data:l,layoutData:v}),s.emit("afterlayout")},a.prototype.addChild=function(e,i,s){s===void 0&&(s=!0);var l=this;l.emit("beforeaddchild",{model:e,parent:i}),(0,_.isString)(i)||(i=i.get("id"));var f=l.findDataById(i);if(f){f.children||(f.children=[]),f.children.push(e);var d=l.findById(i);d.refresh(),l.changeData(void 0,s)}},a.prototype.updateChildren=function(e,i,s){s===void 0&&(s=!0);var l=this,f=l.findById(i);if(!i||!f){console.warn("Update children failed! There is no node with id '".concat(i,"'"));return}var d=l.findDataById(i);d.children=e,f.refresh(),l.changeData(void 0,s)},a.prototype.updateChild=function(e,i,s){s===void 0&&(s=!0);var l=this;if(!i||!l.findById(i)){l.changeData(e,s);return}var f=l.findDataById(i),d=l.findById(e.id);if(f.children||(f.children=[]),!d)f.children.push(e);else{var v=a.indexOfChild(f.children,e.id);v>-1&&(f.children[v]=e)}var w=l.findById(i);w==null||w.refresh(),l.changeData(void 0,s)},a.prototype.removeChild=function(e,i){i===void 0&&(i=!0);var s=this,l=s.findById(e),f;if(l?f=l==null?void 0:l.get("parent"):f=s.getNodes().find(function(T){var G=T.getModel().children||[];return!!G.find(function(U){return U.id===e})}),f&&!f.destroyed){var d=f.get("id"),v=s.findDataById(d),w=v&&v.children||[],E=a.indexOfChild(w,e);w.splice(E,1),f.refresh()}s.changeData(void 0,i)},a.prototype.findDataById=function(e,i){var s=this;if(i||(i=s.get("data")),e===i.id)return i;var l=null;return(0,_.each)(i.children||[],function(f){if(f.id===e)return l=f,!1;if(l=s.findDataById(e,f),l)return!1}),l},a.prototype.layoutAnimate=function(e,i){var s=this,l=this.get("animateCfg");s.emit("beforeanimate",{data:e}),s.getEdges().forEach(function(f){var d=f.get("model");d.sourceAnchor||(d.sourceAnchor=f.get("sourceAnchorIndex"))}),this.get("canvas").animate(function(f){db(e,function(d){var v=s.findById(d.id);if(v){var w=v.get("originAttrs"),E=v.get("model");if(w||(w={x:E.x,y:E.y},v.set("originAttrs",w)),i){var T=i(v,f,w,e);v.set("model",Object.assign(E,T))}else E.x=w.x+(d.x-w.x)*f,E.y=w.y+(d.y-w.y)*f}return!0}),(0,_.each)(s.get("removeList"),function(d){var v=d.getModel(),w=d.get("originAttrs"),E=d.get("to");v.x=w.x+(E.x-w.x)*f,v.y=w.y+(E.y-w.y)*f}),s.refreshPositions()},{duration:l.duration,easing:l.ease,callback:function(){(0,_.each)(s.getNodes(),function(d){d.set("originAttrs",null)}),(0,_.each)(s.get("removeList"),function(d){s.removeItem(d,!1)}),s.set("removeList",[]),l.callback&&l.callback(),s.emit("afteranimate",{data:e})},delay:l.delay})},a.prototype.stopLayoutAnimate=function(){this.get("canvas").stopAnimate(),this.emit("layoutanimateend",{data:this.get("data")}),this.layoutAnimating=!1},a.prototype.isLayoutAnimating=function(){return this.layoutAnimating},a.prototype.render=function(e){e===void 0&&(e=!0);var i=this,s=i.get("data");if(!s||!(0,_.isObject)(s)||!Object.keys(s).length)throw new Error("data must be defined first");i.clear(),e&&this.get("enabledStack")&&this.clearStack(),i.emit("beforerender"),i.layout(this.get("fitView")),i.emit("afterrender")},a.prototype.save=function(){return this.get("data")},a.prototype.data=function(e){c.prototype.data.call(this,e),this.set("originData",JSON.parse(JSON.stringify(e)))},a}(_w),iC=aC;function Ps(c,a){if(c)for(var e in a)a.hasOwnProperty(e)&&(c.style[e]=a[e]);return c}var oC=function(){function c(a){this._cfgs=(0,_.deepMix)(this.getDefaultCfgs(),a),this._events={},this.destroyed=!1}return c.prototype.getDefaultCfgs=function(){return{}},c.prototype.initPlugin=function(a){var e=this;e.set("graph",a);var i=e.getEvents(),s={};(0,_.each)(i,function(l,f){var d=(0,_.wrapBehavior)(e,l);s[f]=d,a.on(f,d)}),this._events=s,this.init()},c.prototype.getEvents=function(){return{}},c.prototype.get=function(a){var e;return(e=this._cfgs)===null||e===void 0?void 0:e[a]},c.prototype.set=function(a,e){this._cfgs[a]=e},c.prototype.destroy=function(){},c.prototype.destroyPlugin=function(){this.destroy();var a=this.get("graph"),e=this._events;(0,_.each)(e,function(i,s){a.off(s,i)}),this._events=null,this._cfgs=null,this.destroyed=!0},c}(),rd=oC,sC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Iw="url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2UwZTBlMCIgb3BhY2l0eT0iMC4yIiBzdHJva2Utd2lkdGg9IjEiLz48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZTBlMGUwIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=)",uC=function(c){sC(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{img:Iw,follow:!0}},a.prototype.init=function(){var e=this.get("graph"),i=e.get("container"),s=e.get("canvas").get("el"),l=this.get("img")||Iw;l.includes("url(")||(l='url("'.concat(l,'")'));var f=Hl(`<div class='g6-grid-container' style="position:absolute;overflow:hidden;z-index: -1;"></div>`),d=Hl(`<div
        class='g6-grid'
        style='position:absolute;
        background-image: `.concat(l,`;
        user-select: none
        '></div>`));this.set("container",f),this.set("gridContainer",d),this.positionInit(),f.appendChild(d),i.insertBefore(f,s)},a.prototype.positionInit=function(){var e=this.get("graph"),i=e.get("minZoom"),s=e.get("width"),l=e.get("height");Ps(this.get("container"),{width:"".concat(s,"px"),height:"".concat(l,"px")});var f=s*80/i,d=l*80/i;Ps(this.get("gridContainer"),{width:"".concat(f,"px"),height:"".concat(d,"px"),left:"-".concat(f/2,"px"),top:"-".concat(d/2,"px")})},a.prototype.getEvents=function(){return{viewportchange:"updateGrid"}},a.prototype.updateGrid=function(e){var i=this.get("gridContainer"),s=e.matrix;s||(s=[1,0,0,0,1,0,0,0,1]);var l=this.get("follow"),f="matrix(".concat(s[0],", ").concat(s[1],", ").concat(s[3],", ").concat(s[4],", ").concat(l?s[6]:"0",", ").concat(l?s[7]:"0",")");Ps(i,{transform:f})},a.prototype.getContainer=function(){return this.get("container")},a.prototype.destroy=function(){var e=this.get("graph"),i=e.get("container"),s=this.get("container");i.removeChild(s)},a}(rd),lC=uC,Cy=$(38186),Pg=$.n(Cy),_y=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();typeof document!="undefined"&&Pg()(`
  .g6-component-contextmenu {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .g6-contextmenu-ul {
    padding: 0;
    margin: 0;
    list-style: none;
  }

`);var pb=function(c){_y(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,handleMenuClick:void 0,getContent:function(i){return`
          <ul class='g6-contextmenu-ul'>
            <li>\u83DC\u5355\u98791</li>
            <li>\u83DC\u5355\u98792</li>
          </ul>
        `},shouldBegin:function(i){return!0},onHide:function(){return!0},itemTypes:["node","edge","combo"],trigger:"contextmenu"}},a.prototype.getEvents=function(){return this.get("trigger")==="click"?{click:"onMenuShow",touchend:"onMenuShow"}:{contextmenu:"onMenuShow"}},a.prototype.init=function(){var e=this.get("className"),i=Hl("<div class=".concat(e||"g6-component-contextmenu","></div>"));Ps(i,{top:"0px",position:"absolute",visibility:"hidden"});var s=this.get("container");s||(s=this.get("graph").get("container")),(0,_.isString)(s)&&(s=document.getElementById(s)),s.appendChild(i),this.set("menu",i)},a.prototype.onMenuShow=function(e){var i=this;e.preventDefault();var s=this.get("itemTypes");if(e.item){if(e.item&&e.item.getType&&s.indexOf(e.item.getType())===-1){i.onMenuHide();return}}else if(s.indexOf("canvas")===-1){i.onMenuHide();return}var l=this.get("shouldBegin");if(!!l(e)){var f=this.get("menu"),d=this.get("getContent"),v=this.get("graph"),w=d(e,v);(0,_.isString)(w)?f.innerHTML=w:f.innerHTML=w.outerHTML,this.removeMenuEventListener();var E=this.get("handleMenuClick");if(E){var T=function(mn){E(mn.target,e.item,v)};this.set("handleMenuClickWrapper",T),f.addEventListener("click",T)}var G=v.get("width"),U=v.get("height"),et=f.getBoundingClientRect(),ct=this.get("offsetX")||0,Ct=this.get("offsetY")||0,Mt=v.getContainer().offsetTop,Dt=v.getContainer().offsetLeft,zt=e.canvasX+Dt+ct,Qt=e.canvasY+Mt+Ct;zt+et.width>G&&(zt=e.canvasX-et.width-ct+Dt),Qt+et.height>U&&(Qt=e.canvasY-et.height-Ct+Mt),Ps(f,{top:"".concat(Qt,"px"),left:"".concat(zt,"px"),visibility:"visible"});var Ie=this.get("trigger")==="click",je=function(mn){if(Ie){Ie=!1;return}i.onMenuHide()};document.body.addEventListener("click",je),this.set("handler",je)}},a.prototype.removeMenuEventListener=function(){var e=this.get("handleMenuClickWrapper"),i=this.get("handler");if(e){var s=this.get("menu");s.removeEventListener("click",e),this.set("handleMenuClickWrapper",null)}i&&document.body.removeEventListener("click",i)},a.prototype.onMenuHide=function(){var e=this.get("menu");e&&Ps(e,{visibility:"hidden"}),this.removeMenuEventListener()},a.prototype.destroy=function(){var e=this.get("menu");if(this.removeMenuEventListener(),e){var i=this.get("container");i||(i=this.get("graph").get("container")),(0,_.isString)(i)&&(i=document.getElementById(i)),i.removeChild(e)}},a}(rd),cC=pb,fC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Iy=function(){return Iy=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},Iy.apply(this,arguments)},Tw=Math.max,hC=ie,dC="default",pC="keyShape",vC="delegate",Aw="svg",gC=function(c){fC(a,c);function a(e){var i=c.call(this,e)||this;return i.handleUpdateCanvas=(0,_.debounce)(function(s){var l=i;l.destroyed||l.updateCanvas()},100,!1),i}return a.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",type:"default",padding:50,size:[200,120],delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0,hideEdge:!1}},a.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},a.prototype.disableRefresh=function(){this.set("refresh",!1)},a.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},a.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},a.prototype.initViewport=function(){var e=this,i=this._cfgs,s=i.size,l=i.graph;if(!this.destroyed){var f=this.get("canvas"),d=f.get("container"),v=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,w=navigator.userAgent.toLowerCase().indexOf("safari")>-1,E=Hl(`
      <div
        class=`.concat(i.viewportClassName,`
        style='position:absolute;
          left:0;
          top:0;
          box-sizing:border-box;
          outline: 2px solid #1980ff;
          cursor:move'
        draggable=`).concat(!(w||v),`
      </div>`)),T=0,G=0,U=!1,et=0,ct=0,Ct=0,Mt=0,Dt=0,zt=0,Qt=w||v?"mousedown":"dragstart";E.addEventListener(Qt,function(mn){var $n,Tn;if(mn.dataTransfer){var or=new Image;or.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' %3E%3Cpath /%3E%3C/svg%3E",(Tn=($n=mn.dataTransfer).setDragImage)===null||Tn===void 0||Tn.call($n,or,0,0);try{mn.dataTransfer.setData("text/html","view-port-minimap")}catch(Ta){mn.dataTransfer.setData("text","view-port-minimap")}}if(i.refresh=!1,mn.target===E){var kr=E.style;et=parseInt(kr.left,10),ct=parseInt(kr.top,10),Ct=parseInt(kr.width,10),Mt=parseInt(kr.height,10),!(Ct>s[0]||Mt>s[1])&&(zt=l.getZoom(),Dt=e.get("ratio"),U=!0,T=mn.clientX,G=mn.clientY)}},!1);var Ie=function($n){if(!(!U||(0,_.isNil)($n.clientX)||(0,_.isNil)($n.clientY))){var Tn=T-$n.clientX,or=G-$n.clientY;(et-Tn<0||et-Tn+Ct>=s[0])&&(Tn=0),(ct-or<0||ct-or+Mt>=s[1])&&(or=0),et-=Tn,ct-=or,Ps(E,{left:"".concat(et,"px"),top:"".concat(ct,"px")}),l.translate(Tn*zt/Dt,or*zt/Dt),T=$n.clientX,G=$n.clientY}};!w&&!v&&E.addEventListener("drag",Ie,!1);var je=function(){U=!1,i.refresh=!0},ze=w||v?"mouseup":"dragend";E.addEventListener(ze,je,!1),d.addEventListener("mouseleave",je),d.addEventListener("mouseup",je),(w||v)&&d.addEventListener("mousemove",Ie,!1),this.set("viewport",E),d.appendChild(E)}},a.prototype.updateViewport=function(){if(!this.destroyed){var e=this.get("ratio"),i=this.get("totaldx"),s=this.get("totaldy"),l=this.get("graph"),f=this.get("size"),d=l.get("canvas").get("el"),v=l.get("width")||d.scrollWidth||500,w=l.get("height")||d.scrollHeight||500,E=l.getPointByCanvas(0,0),T=l.getPointByCanvas(v,w),G=this.get("viewport");G||this.initViewport();var U=(T.x-E.x)*e,et=(T.y-E.y)*e,ct=E.x*e+i,Ct=E.y*e+s,Mt=ct+U,Dt=Ct+et;ct<0&&(U+=ct,ct=0),Mt>f[0]&&(U=U-(Mt-f[0])),Ct<0&&(et+=Ct,Ct=0),Dt>f[1]&&(et=et-(Dt-f[1])),this.set("ratio",e);var zt="".concat(ct,"px"),Qt="".concat(Ct,"px");Ps(G,{left:zt,top:Qt,width:"".concat(U,"px"),height:"".concat(et,"px")})}},a.prototype.updateGraphShapes=function(){var e=this._cfgs.graph,i=this.get("canvas"),s=e.get("group");if(!s.destroyed){i.clear();var l;this.get("hideEdge")?(l=i.addGroup(),s.get("children").forEach(function(d){d.get("id").includes("-edge")||l.add(d.clone())})):(l=s.clone(),l.resetMatrix(),i.add(l));var f=e.get("renderer");f===Aw&&this.updateVisible(l)}},a.prototype.updateVisible=function(e){var i=this;if(!e.isGroup()&&!e.get("visible"))e.hide();else{var s=e.get("children");if(!s||!s.length)return;s.forEach(function(l){l.get("visible")||l.hide(),i.updateVisible(l)})}},a.prototype.updateKeyShapes=function(){var e=this,i=this._cfgs.graph,s=this.get("canvas"),l=s.get("children")[0]||s.addGroup();this.get("hideEdge")||(0,_.each)(i.getEdges(),function(v){e.updateOneEdgeKeyShape(v,l)}),(0,_.each)(i.getNodes(),function(v){e.updateOneNodeKeyShape(v,l)});var f=i.getCombos();if(f&&f.length){var d=l.find(function(v){return v.get("name")==="comboGroup"})||l.addGroup({name:"comboGroup"});setTimeout(function(){e.destroyed||((0,_.each)(f,function(v){e.updateOneComboKeyShape(v,d)}),d==null||d.sort(),d==null||d.toBack(),e.updateCanvas())},250)}this.clearDestroyedShapes()},a.prototype.updateOneComboKeyShape=function(e,i){if(!this.destroyed){var s=this.get("itemMap")||{},l=s[e.get("id")],f=e.getBBox(),d=e.get("keyShape").clone(),v=d.attr(),w={x:f.centerX,y:f.centerY};l?w=Object.assign(v,w):(l=d,i.add(l));var E=l.get("type");(E==="rect"||E==="image")&&(w.x=f.minX,w.y=f.minY),l.attr(w),e.isVisible()?l.show():l.hide(),l.exist=!0;var T=e.getModel().depth;isNaN(T)||l.set("zIndex",T),s[e.get("id")]=l,this.set("itemMap",s)}},a.prototype.updateOneNodeKeyShape=function(e,i){var s=this.get("itemMap")||{},l=s[e.get("id")],f=e.getBBox(),d=e.get("keyShape").clone(),v=d.attr(),w={x:f.centerX,y:f.centerY};l?(w=Object.assign(v,w),l.toFront()):(l=d,i.add(l));var E=l.get("type");(E==="rect"||E==="image")&&(w.x=f.minX,w.y=f.minY),l.attr(w),e.isVisible()?l.show():l.hide(),l.exist=!0;var T=e.getModel().depth;isNaN(T)||l.set("zIndex",T),s[e.get("id")]=l,this.set("itemMap",s)},a.prototype.updateDelegateShapes=function(){var e=this,i=this._cfgs.graph,s=this.get("canvas"),l=s.get("children")[0]||s.addGroup();this.get("hideEdge")||(0,_.each)(i.getEdges(),function(v){e.updateOneEdgeKeyShape(v,l)}),(0,_.each)(i.getNodes(),function(v){e.updateOneNodeDelegateShape(v,l)});var f=i.getCombos();if(f&&f.length){var d=l.find(function(v){return v.get("name")==="comboGroup"})||l.addGroup({name:"comboGroup"});setTimeout(function(){e.destroyed||((0,_.each)(f,function(v){e.updateOneComboKeyShape(v,d)}),d==null||d.sort(),d==null||d.toBack(),e.updateCanvas())},250)}this.clearDestroyedShapes()},a.prototype.clearDestroyedShapes=function(){var e=this.get("itemMap")||{},i=Object.keys(e);if(!(!i||i.length===0))for(var s=i.length-1;s>=0;s--){var l=e[i[s]],f=l.exist;l.exist=!1,f||(l.remove(),delete e[i[s]])}},a.prototype.updateOneEdgeKeyShape=function(e,i){var s=this.get("itemMap")||{},l=s[e.get("id")];if(l){var f=e.get("keyShape").attr("path");l.attr("path",f)}else l=e.get("keyShape").clone(),i.add(l);e.isVisible()?l.show():l.hide(),l.exist=!0,s[e.get("id")]=l,this.set("itemMap",s)},a.prototype.updateOneNodeDelegateShape=function(e,i){var s=this.get("delegateStyle"),l=this.get("itemMap")||{},f=l[e.get("id")],d=e.getBBox();if(f){var v={x:d.minX,y:d.minY,width:d.width,height:d.height};f.attr(v),f.toFront()}else f=i.addShape("rect",{attrs:Iy({x:d.minX,y:d.minY,width:d.width,height:d.height},s),name:"minimap-node-shape"});e.isVisible()?f.show():f.hide(),f.exist=!0,l[e.get("id")]=f,this.set("itemMap",l)},a.prototype.init=function(){this.initContainer(),this.get("graph").on("afterupdateitem",this.handleUpdateCanvas),this.get("graph").on("afteritemstatechange",this.handleUpdateCanvas),this.get("graph").on("afteradditem",this.handleUpdateCanvas),this.get("graph").on("afterremoveitem",this.handleUpdateCanvas),this.get("graph").on("afterrender",this.handleUpdateCanvas),this.get("graph").on("afterlayout",this.handleUpdateCanvas)},a.prototype.initContainer=function(){var e=this,i=e.get("graph"),s=e.get("size"),l=e.get("className"),f=e.get("container"),d=Hl("<div class='".concat(l,"' style='width: ").concat(s[0],"px; height: ").concat(s[1],"px; overflow: hidden'></div>"));(0,_.isString)(f)&&(f=document.getElementById(f)),f?f.appendChild(d):i.get("container").appendChild(d),e.set("container",d);var v=Hl('<div class="g6-minimap-container" style="position: relative;"></div>');d.appendChild(v),v.addEventListener("dragenter",function(T){T.preventDefault()}),v.addEventListener("dragover",function(T){T.preventDefault()});var w,E=i.get("renderer");E===Aw?w=new Ff({container:v,width:s[0],height:s[1]}):w=new Gv({container:v,width:s[0],height:s[1]}),e.set("canvas",w),e.updateCanvas()},a.prototype.updateCanvas=function(){if(!this.destroyed){var e=this.get("refresh");if(!!e){var i=this.get("graph");if(!i.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var s=this.get("size"),l=this.get("canvas"),f=this.get("type"),d=this.get("padding");if(!l.destroyed){switch(f){case dC:this.updateGraphShapes();break;case pC:this.updateKeyShapes();break;case vC:this.updateDelegateShapes();break;default:break}var v=l.get("children")[0];if(!!v){v.resetMatrix();var w=v.getCanvasBBox(),E=i.get("canvas").getCanvasBBox(),T=i.getZoom()||1,G=E.width/T,U=E.height/T;Number.isFinite(w.width)&&(G=Tw(w.width,G),U=Tw(w.height,U)),G+=2*d,U+=2*d;var et=Math.min(s[0]/G,s[1]/U),ct=[1,0,0,0,1,0,0,0,1],Ct=0,Mt=0;Number.isFinite(w.minX)&&(Ct=-w.minX),Number.isFinite(w.minY)&&(Mt=-w.minY);var Dt=(s[0]-(G-2*d)*et)/2,zt=(s[1]-(U-2*d)*et)/2;ct=hC(ct,[["t",Ct,Mt],["s",et,et],["t",Dt,zt]]),v.setMatrix(ct),this.set("ratio",et),this.set("totaldx",Dt+Ct*et),this.set("totaldy",zt+Mt*et),this.set("dx",Dt),this.set("dy",zt),this.updateViewport()}}}}}},a.prototype.getCanvas=function(){return this.get("canvas")},a.prototype.getViewport=function(){return this.get("viewport")},a.prototype.getContainer=function(){return this.get("container")},a.prototype.destroy=function(){var e;(e=this.get("canvas"))===null||e===void 0||e.destroy();var i=this.get("container");(i==null?void 0:i.parentNode)&&i.parentNode.removeChild(i)},a}(rd),mC=gC,yC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();function uv(c,a,e){var i=c.x-a.x,s=c.y-a.y;return!e||Math.abs(i)>e||Math.abs(s)>e?Math.sqrt(i*i+s*s):e}function bC(c,a){return c.x*a.x+c.y*a.y}function vb(c,a){var e=(a.source.y-a.target.y)/(a.source.x-a.target.x),i=(e*e*a.source.x+e*(c.y-a.source.y)+c.x)/(e*e+1),s=e*(i-a.source.x)+a.source.y;return{x:i,y:s}}var xC=function(c){yC(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{edgeBundles:[],edgePoints:[],K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:.6666667,bundleThreshold:.6,eps:1e-6,onLayoutEnd:function(){},onTick:function(){}}},a.prototype.init=function(){var e=this.get("graph"),i=this.get("onTick"),s=function(){i&&i(),e.refreshPositions()};this.set("tick",s)},a.prototype.bundling=function(e){var i=this;if(i.set("data",e),!i.isTicking()){var s=e.edges||[],l=e.nodes||[],f={},d=!1;if(l.forEach(function(Qt){(Qt.x===null||!Qt.y===null||Qt.x===void 0||!Qt.y===void 0)&&(d=!0),f[Qt.id]=Qt}),d)throw new Error("please layout the graph or assign x and y for nodes first");i.set("nodeIdMap",f);var v=i.get("divisions"),w=i.get("divRate"),E=i.divideEdges(v);i.set("edgePoints",E);var T=i.getEdgeBundles();i.set("edgeBundles",T);for(var G=i.get("cycles"),U=i.get("iterations"),et=i.get("iterRate"),ct=i.get("lambda"),Ct=0;Ct<G;Ct++){for(var Mt=function(Ie){var je=[];s.forEach(function(ze,mn){if(ze.source!==ze.target){var $n=f[ze.source],Tn=f[ze.target];je[mn]=i.getEdgeForces({source:$n,target:Tn},mn,v,ct);for(var or=0;or<v+1;or++)E[mn][or].x+=je[mn][or].x,E[mn][or].y+=je[mn][or].y}})},Dt=0;Dt<U;Dt++)Mt(Dt);ct=ct/2,v*=w,U*=et,E=i.divideEdges(v),i.set("edgePoints",E)}s.forEach(function(Qt,Ie){Qt.source!==Qt.target&&(Qt.type="polyline",Qt.controlPoints=E[Ie].slice(1,E[Ie].length-1))});var zt=i.get("graph");zt.refresh()}},a.prototype.updateBundling=function(e){var i=this,s=e.data;if(s&&i.set("data",s),i.get("ticking")&&i.set("ticking",!1),Object.keys(e).forEach(function(f){i.set(f,e[f])}),e.onTick){var l=this.get("graph");i.set("tick",function(){e.onTick(),l.refresh()})}i.bundling(s)},a.prototype.divideEdges=function(e){var i=this,s=i.get("data").edges,l=i.get("nodeIdMap"),f=i.get("edgePoints");return(!f||f===void 0)&&(f=[]),s.forEach(function(d,v){var w;(!f[v]||f[v]===void 0)&&(f[v]=[]);var E=l[d.source],T=l[d.target];if(e===1)f[v].push({x:E.x,y:E.y}),f[v].push({x:.5*(E.x+T.x),y:.5*(E.y+T.y)}),f[v].push({x:T.x,y:T.y});else{var G=0;((w=f[v])===null||w===void 0?void 0:w.length)?G=i.getEdgeLength(f[v]):G=uv({x:E.x,y:E.y},{x:T.x,y:T.y});var U=G/(e+1),et=U,ct=[{x:E.x,y:E.y}];f[v].forEach(function(Ct,Mt){if(Mt!==0){for(var Dt=uv(Ct,f[v][Mt-1]);Dt>et;){var zt=et/Dt,Qt={x:f[v][Mt-1].x,y:f[v][Mt-1].y};Qt.x+=zt*(Ct.x-f[v][Mt-1].x),Qt.y+=zt*(Ct.y-f[v][Mt-1].y),ct.push(Qt),Dt-=et,et=U}et-=Dt}}),ct.push({x:T.x,y:T.y}),f[v]=ct}}),f},a.prototype.getEdgeLength=function(e){var i=0;return e.forEach(function(s,l){l!==0&&(i+=uv(s,e[l-1]))}),i},a.prototype.getEdgeBundles=function(){var e=this,i=e.get("data"),s=i.edges||[],l=e.get("bundleThreshold"),f=e.get("nodeIdMap"),d=e.get("edgeBundles");return d||(d=[]),s.forEach(function(v,w){(!d[w]||d[w]===void 0)&&(d[w]=[])}),s.forEach(function(v,w){var E=f[v.source],T=f[v.target];s.forEach(function(G,U){if(!(U<=w)){var et=f[G.source],ct=f[G.target],Ct=e.getBundleScore({source:E,target:T},{source:et,target:ct});Ct>=l&&(d[w].push(U),d[U].push(w))}})}),d},a.prototype.getBundleScore=function(e,i){var s=this;e.vx=e.target.x-e.source.x,e.vy=e.target.y-e.source.y,i.vx=i.target.x-i.source.x,i.vy=i.target.y-i.source.y,e.length=uv({x:e.source.x,y:e.source.y},{x:e.target.x,y:e.target.y}),i.length=uv({x:i.source.x,y:i.source.y},{x:i.target.x,y:i.target.y});var l=s.getAngleScore(e,i),f=s.getScaleScore(e,i),d=s.getPositionScore(e,i),v=s.getVisibilityScore(e,i);return l*f*d*v},a.prototype.getAngleScore=function(e,i){var s=bC({x:e.vx,y:e.vy},{x:i.vx,y:i.vy});return s/(e.length*i.length)},a.prototype.getScaleScore=function(e,i){var s=(e.length+i.length)/2,l=2/(s/Math.min(e.length,i.length)+Math.max(e.length,i.length)/s);return l},a.prototype.getPositionScore=function(e,i){var s=(e.length+i.length)/2,l={x:(e.source.x+e.target.x)/2,y:(e.source.y+e.target.y)/2},f={x:(i.source.x+i.target.x)/2,y:(i.source.y+i.target.y)/2},d=uv(l,f);return s/(s+d)},a.prototype.getVisibilityScore=function(e,i){var s=this.getEdgeVisibility(e,i),l=this.getEdgeVisibility(i,e);return s<l?s:l},a.prototype.getEdgeVisibility=function(e,i){var s=vb(i.source,e),l=vb(i.target,e),f={x:(s.x+l.x)/2,y:(s.y+l.y)/2},d={x:(e.source.x+e.target.x)/2,y:(e.source.y+e.target.y)/2};return Math.max(0,1-2*uv(f,d)/uv(s,l))},a.prototype.getEdgeForces=function(e,i,s,l){for(var f=this,d=f.get("edgePoints"),v=f.get("K"),w=v/(uv(e.source,e.target)*(s+1)),E=[{x:0,y:0}],T=1;T<s;T++){var G={x:0,y:0},U=f.getSpringForce({pre:d[i][T-1],cur:d[i][T],next:d[i][T+1]},w),et=f.getElectrostaticForce(T,i);G.x=l*(U.x+et.x),G.y=l*(U.y+et.y),E.push(G)}return E.push({x:0,y:0}),E},a.prototype.getSpringForce=function(e,i){var s=e.pre.x+e.next.x-2*e.cur.x,l=e.pre.y+e.next.y-2*e.cur.y;return s*=i,l*=i,{x:s,y:l}},a.prototype.getElectrostaticForce=function(e,i){var s=this,l=s.get("eps"),f=s.get("edgeBundles"),d=s.get("edgePoints"),v=f[i],w={x:0,y:0};return v.forEach(function(E){var T={x:d[E][e].x-d[i][e].x,y:d[E][e].y-d[i][e].y};if(Math.abs(T.x)>l||Math.abs(T.y)>l){var G=uv(d[E][e],d[i][e]),U=1/G;w.x+=T.x*U,w.y+=T.y*U}}),w},a.prototype.isTicking=function(){return this.get("ticking")},a.prototype.getSimulation=function(){return this.get("forceSimulation")},a.prototype.destroy=function(){this.get("ticking")&&this.getSimulation().stop(),c.prototype.destroy.call(this)},a}(rd),Mw=xC,wC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),gb=function(){return gb=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},gb.apply(this,arguments)},Ty=.05,Nw={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:.1,fill:"#ccc"},EC=function(c){wC(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{trigger:"mousemove",d:1.5,r:300,delegateStyle:(0,_.clone)(Nw),showLabel:!1,maxD:5,minD:0,scaleRBy:"unset",scaleDBy:"unset",showDPercent:!0}},a.prototype.getEvents=function(){var e;switch(this.get("trigger")){case"click":e={click:"magnify"};break;case"drag":e={click:"createDelegate"};break;default:e={mousemove:"magnify"};break}return e},a.prototype.init=function(){var e=this,i=e.get("r");e.set("cachedMagnifiedModels",[]),e.set("cachedOriginPositions",{}),e.set("r2",i*i);var s=e.get("d");e.set("molecularParam",(s+1)*i)},a.prototype.createDelegate=function(e){var i=this,s=this,l=s.get("delegate");(!l||l.destroyed)&&(s.magnify(e),l=s.get("delegate"),l.on("dragstart",function(f){s.set("delegateCenterDiff",{x:l.attr("x")-f.x,y:l.attr("y")-f.y})}),l.on("drag",function(f){s.magnify(f)}),this.get("scaleDBy")==="wheel"&&l.on("mousewheel",function(f){i.scaleDByWheel(f)}),this.get("scaleRBy")==="wheel"&&l.on("mousewheel",function(f){s.scaleRByWheel(f)}))},a.prototype.scaleRByWheel=function(e){var i=this;if(!(!e||!e.originalEvent)){e.preventDefault&&e.preventDefault();var s=i.get("graph"),l,f=i.get("delegate"),d=f?{x:f.attr("x"),y:f.attr("y")}:void 0,v=d||s.getPointByClient(e.clientX,e.clientY);e.originalEvent.wheelDelta<0?l=1-Ty:l=1/(1-Ty);var w=i.get("maxR"),E=i.get("minR"),T=i.get("r");(T>(w||s.get("height"))&&l>1||T<(E||s.get("height")*.05)&&l<1)&&(l=1),T*=l,i.set("r",T),i.set("r2",T*T);var G=i.get("d");i.set("molecularParam",(G+1)*T),i.set("delegateCenterDiff",void 0),i.magnify(e,v)}},a.prototype.scaleRByDrag=function(e){var i=this;if(!!e){var s=i.get("dragPrePos"),l=i.get("graph"),f,d=l.getPointByClient(e.clientX,e.clientY);e.x-s.x<0?f=1-Ty:f=1/(1-Ty);var v=i.get("maxR"),w=i.get("minR"),E=i.get("r");(E>(v||l.get("height"))&&f>1||E<(w||l.get("height")*.05)&&f<1)&&(f=1),E*=f,i.set("r",E),i.set("r2",E*E);var T=i.get("d");i.set("molecularParam",(T+1)*E),i.magnify(e,d),i.set("dragPrePos",{x:e.x,y:e.y})}},a.prototype.scaleDByWheel=function(e){var i=this;if(!(!e&&!e.originalEvent)){e.preventDefault&&e.preventDefault();var s=0;e.originalEvent.wheelDelta<0?s=-.1:s=.1;var l=i.get("d"),f=l+s,d=i.get("maxD"),v=i.get("minD");if(f<d&&f>v){i.set("d",f);var w=i.get("r");i.set("molecularParam",(f+1)*w);var E=i.get("delegate"),T=E?{x:E.attr("x"),y:E.attr("y")}:void 0;i.set("delegateCenterDiff",void 0),i.magnify(e,T)}}},a.prototype.scaleDByDrag=function(e){var i=this,s=i.get("dragPrePos"),l=e.x-s.x>0?.1:-.1,f=i.get("d"),d=f+l,v=i.get("maxD"),w=i.get("minD");if(d<v&&d>w){i.set("d",d);var E=i.get("r");i.set("molecularParam",(d+1)*E),i.magnify(e)}i.set("dragPrePos",{x:e.x,y:e.y})},a.prototype.magnify=function(e,i){var s=this;s.restoreCache();var l=s.get("graph"),f=s.get("cachedMagnifiedModels"),d=s.get("cachedOriginPositions"),v=s.get("showLabel"),w=s.get("r"),E=s.get("r2"),T=s.get("d"),G=s.get("molecularParam"),U=l.getNodes(),et=U.length,ct=i?{x:i.x,y:i.y}:{x:e.x,y:e.y};s.get("dragging")&&(s.get("trigger")==="mousemove"||s.get("trigger")==="click")&&(ct=s.get("cacheCenter"));var Ct=s.get("delegateCenterDiff");Ct&&(ct.x+=Ct.x,ct.y+=Ct.y),s.updateDelegate(ct,w);for(var Mt=0;Mt<et;Mt++){var Dt=U[Mt].getModel(),zt=Dt.x,Qt=Dt.y;if(!(isNaN(zt)||isNaN(Qt))){var Ie=(zt-ct.x)*(zt-ct.x)+(Qt-ct.y)*(Qt-ct.y);if(!isNaN(Ie)&&Ie<E&&Ie!==0){var je=Math.sqrt(Ie),ze=G*je/(T*je+w),mn=(zt-ct.x)/je,$n=(Qt-ct.y)/je;if(Dt.x=mn*ze+ct.x,Dt.y=$n*ze+ct.y,d[Dt.id]||(d[Dt.id]={x:zt,y:Qt,texts:[]}),f.push(Dt),v&&2*je<w)for(var Tn=U[Mt],or=Tn.getContainer(),kr=or.getChildren(),Ta=kr.length,fi=0;fi<Ta;fi++){var ei=kr[fi];ei.get("type")==="text"&&(d[Dt.id].texts.push({visible:ei.get("visible"),shape:ei}),ei.set("visible",!0))}}}}l.refreshPositions()},a.prototype.restoreCache=function(){for(var e=this,i=e.get("cachedMagnifiedModels"),s=e.get("cachedOriginPositions"),l=i.length,f=0;f<l;f++){var d=i[f],v=d.id,w=s[v];d.x=w.x,d.y=w.y;for(var E=w.texts.length,T=0;T<E;T++){var G=w.texts[T];G.shape.set("visible",G.visible)}}e.set("cachedMagnifiedModels",[]),e.set("cachedOriginPositions",{})},a.prototype.updateParams=function(e){var i=this,s=e.r,l=e.d,f=e.trigger,d=e.minD,v=e.maxD,w=e.minR,E=e.maxR,T=e.scaleDBy,G=e.scaleRBy;isNaN(e.r)||(i.set("r",s),i.set("r2",s*s)),isNaN(l)||i.set("d",l),isNaN(v)||i.set("maxD",v),isNaN(d)||i.set("minD",d),isNaN(E)||i.set("maxR",E),isNaN(w)||i.set("minR",w);var U=i.get("d"),et=i.get("r");if(i.set("molecularParam",(U+1)*et),(f==="mousemove"||f==="click"||f==="drag")&&i.set("trigger",f),T==="drag"||T==="wheel"||T==="unset"){i.set("scaleDBy",T),i.get("delegate").remove(),i.get("delegate").destroy();var ct=i.get("dPercentText");ct&&(ct.remove(),ct.destroy())}if(G==="drag"||G==="wheel"||G==="unset"){i.set("scaleRBy",G),i.get("delegate").remove(),i.get("delegate").destroy();var ct=i.get("dPercentText");ct&&(ct.remove(),ct.destroy())}},a.prototype.updateDelegate=function(e,i){var s=this,l=this,f=l.get("graph"),d=l.get("delegate");if(!d||d.destroyed){var v=f.get("group"),w=l.get("delegateStyle")||Nw;d=v.addShape("circle",{attrs:gb({r:i/1.5,x:e.x,y:e.y},w),name:"lens-shape",draggable:!0}),this.get("trigger")!=="drag"&&(this.get("scaleRBy")==="wheel"?d.on("mousewheel",function(et){l.scaleRByWheel(et)}):this.get("scaleRBy")==="drag"&&(d.on("dragstart",function(et){l.set("dragging",!0),l.set("cacheCenter",{x:et.x,y:et.y}),l.set("dragPrePos",{x:et.x,y:et.y})}),d.on("drag",function(et){l.scaleRByDrag(et)}),d.on("dragend",function(et){l.set("dragging",!1)})),this.get("scaleDBy")==="wheel"?d.on("mousewheel",function(et){s.scaleDByWheel(et)}):this.get("scaleDBy")==="drag"&&(d.on("dragstart",function(et){l.set("dragging",!0),l.set("cacheCenter",{x:et.x,y:et.y}),l.set("dragPrePos",{x:et.x,y:et.y})}),d.on("drag",function(et){s.scaleDByDrag(et)}),d.on("dragend",function(et){l.set("dragging",!1)})))}else d.attr({x:e.x,y:e.y,r:i/1.5});if(l.get("showDPercent")){var E=Math.round((l.get("d")-l.get("minD"))/(l.get("maxD")-l.get("minD"))*100),T=l.get("dPercentText"),G=e.y+i/1.5+16;if(!T||T.destroyed){var U=f.get("group");T=U.addShape("text",{attrs:{text:"".concat(E,"%"),x:e.x,y:G,fill:"#aaa",stroke:"#fff",lineWidth:1,fontSize:12}}),l.set("dPercentText",T)}else T.attr({text:"".concat(E,"%"),x:e.x,y:G})}l.set("delegate",d)},a.prototype.clear=function(){var e=this.get("graph");this.restoreCache(),e.refreshPositions();var i=this.get("delegate");i&&!i.destroyed&&(i.remove(),i.destroy());var s=this.get("dPercentText");s&&!s.destroyed&&(s.remove(),s.destroy())},a.prototype.destroy=function(){this.clear()},a}(rd),kw=EC,SC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),qf=.05;typeof document!="undefined"&&Pg()(`
  .g6-component-toolbar {
    position: absolute;
    list-style-type: none;
    padding: 6px;
    left: 0px;
    top: 0px;
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    margin: 0;
  }
  .g6-component-toolbar li {
    float: left;
    text-align: center;
    width: 35px;
    height: 24px;
    cursor: pointer;
		list-style-type:none;
    list-style: none;
    margin-left: 0px;
  }
  .g6-component-toolbar li .icon {
    opacity: 0.7;
  }
  .g6-component-toolbar li .icon:hover {
    opacity: 1;
  }
`);var CC=function(a){if(!a)return[];if(a.composedPath)return a.composedPath();for(var e=[],i=a.target;i;){if(e.push(i),i.tagName==="HTML")return e.push(document,window),e;i=i.parentElement}return e},Vv=function(c){SC(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{handleClick:void 0,getContent:function(i){return`
          <ul class='g6-component-toolbar'>
            <li code='redo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M256 682.666667c0-102.741333 66.730667-213.333333 213.333333-213.333334 107.008 0 190.762667 56.576 230.570667 125.354667L611.968 682.666667H853.333333v-241.365334l-91.562666 91.562667C704.768 448.469333 601.130667 384 469.333333 384c-196.096 0-298.666667 150.229333-298.666666 298.666667h85.333333z" fill="" p-id="2041"></path>
              </svg>
            </li>
            <li code='undo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M170.666667 682.666667h241.365333l-87.936-87.978667C363.904 525.909333 447.658667 469.333333 554.666667 469.333333c146.602667 0 213.333333 110.592 213.333333 213.333334h85.333333c0-148.437333-102.570667-298.666667-298.666666-298.666667-131.797333 0-235.392 64.469333-292.48 148.821333L170.666667 441.301333V682.666667z" fill="" p-id="2764"></path>
              </svg>
            </li>
            <li  code='zoomOut'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M658.432 428.736a33.216 33.216 0 0 1-33.152 33.152H525.824v99.456a33.216 33.216 0 0 1-66.304 0V461.888H360.064a33.152 33.152 0 0 1 0-66.304H459.52V296.128a33.152 33.152 0 0 1 66.304 0V395.52H625.28c18.24 0 33.152 14.848 33.152 33.152z m299.776 521.792a43.328 43.328 0 0 1-60.864-6.912l-189.248-220.992a362.368 362.368 0 0 1-215.36 70.848 364.8 364.8 0 1 1 364.8-364.736 363.072 363.072 0 0 1-86.912 235.968l192.384 224.64a43.392 43.392 0 0 1-4.8 61.184z m-465.536-223.36a298.816 298.816 0 0 0 298.432-298.432 298.816 298.816 0 0 0-298.432-298.432A298.816 298.816 0 0 0 194.24 428.8a298.816 298.816 0 0 0 298.432 298.432z"></path>
              </svg>
            </li>
            <li code='zoomIn'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M639.936 416a32 32 0 0 1-32 32h-256a32 32 0 0 1 0-64h256a32 32 0 0 1 32 32z m289.28 503.552a41.792 41.792 0 0 1-58.752-6.656l-182.656-213.248A349.76 349.76 0 0 1 480 768 352 352 0 1 1 832 416a350.4 350.4 0 0 1-83.84 227.712l185.664 216.768a41.856 41.856 0 0 1-4.608 59.072zM479.936 704c158.784 0 288-129.216 288-288S638.72 128 479.936 128a288.32 288.32 0 0 0-288 288c0 158.784 129.216 288 288 288z" p-id="3853"></path>
              </svg>
            </li>
            <li code='realZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M384 320v384H320V320h64z m256 0v384H576V320h64zM512 576v64H448V576h64z m0-192v64H448V384h64z m355.968 576H92.032A28.16 28.16 0 0 1 64 931.968V28.032C64 12.608 76.608 0 95.168 0h610.368L896 192v739.968a28.16 28.16 0 0 1-28.032 28.032zM704 64v128h128l-128-128z m128 192h-190.464V64H128v832h704V256z"></path>
              </svg>
            </li>
            <li code='autoZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M684.288 305.28l0.128-0.64-0.128-0.64V99.712c0-19.84 15.552-35.904 34.496-35.712a35.072 35.072 0 0 1 34.56 35.776v171.008h170.944c19.648 0 35.84 15.488 35.712 34.432a35.072 35.072 0 0 1-35.84 34.496h-204.16l-0.64-0.128a32.768 32.768 0 0 1-20.864-7.552c-1.344-1.024-2.816-1.664-3.968-2.816-0.384-0.32-0.512-0.768-0.832-1.088a33.472 33.472 0 0 1-9.408-22.848zM305.28 64a35.072 35.072 0 0 0-34.56 35.776v171.008H99.776A35.072 35.072 0 0 0 64 305.216c0 18.944 15.872 34.496 35.84 34.496h204.16l0.64-0.128a32.896 32.896 0 0 0 20.864-7.552c1.344-1.024 2.816-1.664 3.904-2.816 0.384-0.32 0.512-0.768 0.768-1.088a33.024 33.024 0 0 0 9.536-22.848l-0.128-0.64 0.128-0.704V99.712A35.008 35.008 0 0 0 305.216 64z m618.944 620.288h-204.16l-0.64 0.128-0.512-0.128c-7.808 0-14.72 3.2-20.48 7.68-1.28 1.024-2.752 1.664-3.84 2.752-0.384 0.32-0.512 0.768-0.832 1.088a33.664 33.664 0 0 0-9.408 22.912l0.128 0.64-0.128 0.704v204.288c0 19.712 15.552 35.904 34.496 35.712a35.072 35.072 0 0 0 34.56-35.776V753.28h170.944c19.648 0 35.84-15.488 35.712-34.432a35.072 35.072 0 0 0-35.84-34.496z m-593.92 11.52c-0.256-0.32-0.384-0.768-0.768-1.088-1.088-1.088-2.56-1.728-3.84-2.688a33.088 33.088 0 0 0-20.48-7.68l-0.512 0.064-0.64-0.128H99.84a35.072 35.072 0 0 0-35.84 34.496 35.072 35.072 0 0 0 35.712 34.432H270.72v171.008c0 19.84 15.552 35.84 34.56 35.776a35.008 35.008 0 0 0 34.432-35.712V720l-0.128-0.64 0.128-0.704a33.344 33.344 0 0 0-9.472-22.848zM512 374.144a137.92 137.92 0 1 0 0.128 275.84A137.92 137.92 0 0 0 512 374.08z"></path>
              </svg>
            </li>
          </ul>
        `},zoomSensitivity:2}},a.prototype.init=function(){var e=this,i=this.get("graph"),s=this.get("getContent"),l=s(i),f=l;(0,_.isString)(l)&&(f=Hl(l));var d=this.get("className");f.setAttribute("class",d||"g6-component-toolbar");var v=this.get("container");v||(v=this.get("graph").get("container")),(0,_.isString)(v)&&(v=document.getElementById(v)),v.appendChild(f),this.set("toolBar",f);var w=this.get("handleClick");f.addEventListener("click",function(T){var G=CC(T).filter(function(et){return et.nodeName==="LI"});if(G.length!==0){var U=G[0].getAttribute("code");!U||(w?w(U,i):e.handleDefaultOperator(U))}});var E=this.get("position");E&&Ps(f,{top:"".concat(E.y,"px"),left:"".concat(E.x,"px")}),this.bindUndoRedo()},a.prototype.bindUndoRedo=function(){var e=this.get("graph"),i=document.querySelector('.g6-component-toolbar li[code="undo"]'),s=document.querySelector('.g6-component-toolbar li[code="undo"] svg'),l=document.querySelector('.g6-component-toolbar li[code="redo"]'),f=document.querySelector('.g6-component-toolbar li[code="redo"] svg');!i||!s||!l||!f||(i.setAttribute("style","cursor: not-allowed"),s.setAttribute("style","opacity: 0.4"),l.setAttribute("style","cursor: not-allowed"),f.setAttribute("style","opacity: 0.4"),e.on("stackchange",function(d){var v=d.undoStack,w=d.redoStack,E=v.length,T=w.length;E===0?(i.setAttribute("style","cursor: not-allowed"),s.setAttribute("style","opacity: 0.4")):(i.removeAttribute("style"),s.removeAttribute("style")),T===0?(l.setAttribute("style","cursor: not-allowed"),f.setAttribute("style","opacity: 0.4")):(l.removeAttribute("style"),f.removeAttribute("style"))}))},a.prototype.undo=function(){var e=this.get("graph"),i=e.getUndoStack();if(!(!i||i.length===0)){var s=i.pop();if(s){var l=s.action;e.pushStack(l,(0,_.clone)(s.data),"redo");var f=s.data.before;if(l==="add"&&(f=s.data.after),!f)return;switch(l){case"visible":{Object.keys(f).forEach(function(T){var G=f[T];!G||G.forEach(function(U){var et=e.findById(U.id);U.visible?e.showItem(et,!1):e.hideItem(et,!1)})});break}case"render":case"update":Object.keys(f).forEach(function(T){var G=f[T];!G||G.forEach(function(U){var et=e.findById(U.id);delete U.id,e.updateItem(et,U,!1),et.getType()==="combo"&&e.updateCombo(et)})});break;case"changedata":e.changeData(f,!1);break;case"delete":{Object.keys(f).forEach(function(T){var G=f[T];!G||G.forEach(function(U){var et=U.itemType;delete U.itemType,e.addItem(et,U,!1)})});break}case"add":Object.keys(f).forEach(function(T){var G=f[T];!G||G.forEach(function(U){e.removeItem(U.id,!1)})});break;case"updateComboTree":Object.keys(f).forEach(function(T){var G=f[T];!G||G.forEach(function(U){e.updateComboTree(U.id,U.parentId,!1)})});break;case"createCombo":var d=s.data.after.combos,v=d[d.length-1];Object.keys(f).forEach(function(T){var G=f[T];!G||G.forEach(function(U){e.updateComboTree(U.id,U.parentId,!1)})}),e.removeItem(v.id,!1);break;case"uncombo":var w=f.combos[f.combos.length-1],E=f.nodes.concat(f.combos).map(function(T){return T.id}).filter(function(T){return T!==w.id});e.createCombo(w,E,!1);break;case"layout":e.updateLayout(f,void 0,void 0,!1);break;default:}}}},a.prototype.redo=function(){var e=this.get("graph"),i=e.getRedoStack();if(!(!i||i.length===0)){var s=i.pop();if(s){var l=s.action,f=s.data.after;if(e.pushStack(l,(0,_.clone)(s.data)),l==="delete"&&(f=s.data.before),!f)return;switch(l){case"visible":{Object.keys(f).forEach(function(E){var T=f[E];!T||T.forEach(function(G){var U=e.findById(G.id);G.visible?e.showItem(U,!1):e.hideItem(U,!1)})});break}case"render":case"update":Object.keys(f).forEach(function(E){var T=f[E];!T||T.forEach(function(G){var U=e.findById(G.id);delete G.id,e.updateItem(U,G,!1),U.getType()==="combo"&&e.updateCombo(U)})});break;case"changedata":e.changeData(f,!1);break;case"delete":f.edges&&f.edges.forEach(function(E){e.removeItem(E.id,!1)}),f.nodes&&f.nodes.forEach(function(E){e.removeItem(E.id,!1)}),f.combos&&f.combos.forEach(function(E){e.removeItem(E.id,!1)});break;case"add":{Object.keys(f).forEach(function(E){var T=f[E];!T||T.forEach(function(G){var U=G.itemType;delete G.itemType,e.addItem(U,G,!1)})});break}case"updateComboTree":Object.keys(f).forEach(function(E){var T=f[E];!T||T.forEach(function(G){e.updateComboTree(G.id,G.parentId,!1)})});break;case"createCombo":var d=f.combos[f.combos.length-1];e.createCombo(d,d.children.map(function(E){return E.id}),!1);break;case"uncombo":var v=s.data.before.combos,w=v[v.length-1];e.uncombo(w.id,!1);break;case"layout":e.updateLayout(f,void 0,void 0,!1);break;default:}}}},a.prototype.zoomOut=function(){var e=this.get("graph"),i=e.getZoom(),s=1/(1-qf*this.get("zoomSensitivity")),l=this.get("maxZoom")||e.get("maxZoom");s*i>l||e.zoomTo(i*s)},a.prototype.zoomIn=function(){var e=this.get("graph"),i=e.getZoom(),s=1-qf*this.get("zoomSensitivity"),l=this.get("minZoom")||e.get("minZoom");s*i<l||e.zoomTo(i*s)},a.prototype.realZoom=function(){var e=this.get("graph");e.zoomTo(1)},a.prototype.autoZoom=function(){var e=this.get("graph");e.fitView([20,20])},a.prototype.handleDefaultOperator=function(e){switch(e){case"redo":this.redo();break;case"undo":this.undo();break;case"zoomOut":this.zoomOut();break;case"zoomIn":this.zoomIn();break;case"realZoom":this.realZoom();break;case"autoZoom":this.autoZoom();break;default:}},a.prototype.destroy=function(){var e=this.get("toolBar");if(e){var i=this.get("container");i||(i=this.get("graph").get("container")),(0,_.isString)(i)&&(i=document.getElementById(i)),i.removeChild(e)}var s=this.get("handleClick");s&&e.removeEventListener("click",s)},a}(rd),_C=Vv,IC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();typeof document!="undefined"&&Pg()(`
  .g6-component-tooltip {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .tooltip-type {
    padding: 0;
    margin: 0;
  }
  .tooltip-id {
    color: #531dab;
  }
`);var TC=function(c){IC(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,getContent:function(i){return`
          <h4 class='tooltip-type'>\u7C7B\u578B\uFF1A`.concat(i.item.getType(),`</h4>
          <span class='tooltip-id'>ID\uFF1A`).concat(i.item.getID(),`</span>
        `)},shouldBegin:function(i){return!0},itemTypes:["node","edge","combo"],trigger:"mouseenter",fixToNode:void 0}},a.prototype.getEvents=function(){return this.get("trigger")==="click"?{"node:click":"onClick","edge:click":"onClick","combo:click":"onClick","canvas:click":"onMouseLeave",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave",drag:"onMouseLeave"}:{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove","edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove","combo:mouseenter":"onMouseEnter","combo:mouseleave":"onMouseLeave","combo:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave","node:drag":"onMouseLeave"}},a.prototype.init=function(){var e=this,i=e.get("className")||"g6-component-tooltip",s=Hl("<div class='".concat(i,"'></div>")),l=e.get("container");l||(l=e.get("graph").get("container")),(0,_.isString)(l)&&(l=document.getElementById(l)),Ps(s,{position:"absolute",visibility:"hidden",display:"none"}),l.appendChild(s),e.get("trigger")!=="click"&&(s.addEventListener("mouseenter",function(f){Ps(s,{visibility:"visible",display:"unset"})}),s.addEventListener("mouseleave",function(f){e.hideTooltip()})),e.set("tooltip",s)},a.prototype.onClick=function(e){var i=this.get("itemTypes");if(!(e.item&&e.item.getType&&i.indexOf(e.item.getType())===-1)){var s=e.item,l=this.get("graph");this.currentTarget===s?(this.currentTarget=null,this.hideTooltip(),l.emit("tooltipchange",{item:e.item,action:"hide"})):(this.currentTarget=s,this.showTooltip(e),l.emit("tooltipchange",{item:e.item,action:"show"}))}},a.prototype.onMouseEnter=function(e){var i=this.get("itemTypes");if(!(e.item&&e.item.getType&&i.indexOf(e.item.getType())===-1)){var s=e.item,l=this.get("graph");this.currentTarget=s,this.showTooltip(e),l.emit("tooltipchange",{item:e.item,action:"show"})}},a.prototype.onMouseMove=function(e){var i=this.get("itemTypes");e.item&&e.item.getType&&i.indexOf(e.item.getType())===-1||!this.currentTarget||e.item!==this.currentTarget||this.showTooltip(e)},a.prototype.onMouseLeave=function(){this.hideTooltip();var e=this.get("graph");e.emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null},a.prototype.clearContainer=function(){var e=this.get("tooltip");e&&(e.innerHTML="")},a.prototype.showTooltip=function(e){if(!!e.item){var i=this.get("itemTypes");if(!(e.item.getType&&i.indexOf(e.item.getType())===-1)){var s=this.get("tooltip"),l=this.get("getContent"),f=l(e);(0,_.isString)(f)?s.innerHTML=f:(this.clearContainer(),s.appendChild(f)),this.updatePosition(e)}}},a.prototype.hideTooltip=function(){var e=this.get("tooltip");e&&Ps(e,{visibility:"hidden",display:"none"})},a.prototype.updatePosition=function(e){var i=this.get("shouldBegin"),s=this.get("tooltip");if(!i(e)){Ps(s,{visibility:"hidden",display:"none"});return}var l=this.get("graph"),f=l.get("width"),d=l.get("height"),v=this.get("offsetX")||0,w=this.get("offsetY")||0,E=l.getPointByClient(e.clientX,e.clientY),T=this.get("fixToNode"),G=e.item;if(G.getType&&G.getType()==="node"&&T&&(0,_.isArray)(T)&&T.length>=2){var U=G.getBBox();E={x:U.minX+U.width*T[0],y:U.minY+U.height*T[1]}}var et=l.getCanvasByPoint(E.x,E.y),ct=et.x,Ct=et.y,Mt=l.getContainer(),Dt={x:ct+Mt.offsetLeft+v,y:Ct+Mt.offsetTop+w};Ps(s,{visibility:"visible",display:"unset"});var zt=s.getBoundingClientRect();ct+zt.width+v>f&&(Dt.x-=zt.width+v),Ct+zt.height+w>d&&(Dt.y-=zt.height+w,Dt.y<0&&(Dt.y=0)),Ps(s,{left:"".concat(Dt.x,"px"),top:"".concat(Dt.y,"px")})},a.prototype.hide=function(){this.onMouseLeave()},a.prototype.destroy=function(){var e=this.get("tooltip");if(e){var i=this.get("container");i||(i=this.get("graph").get("container")),(0,_.isString)(i)&&(i=document.getElementById(i)),i.removeChild(e)}},a}(rd),AC=TC,Dw="timebarstartplay",Ow="timebarendplay",lv="valuechange",Fg="timebarConfigChanged",dg="playPauseBtn",y0="nextStepBtn",b0="preStepBtn",kA={opacity:.5,fill:"#000"},DA={opacity:.5,fill:"#000",r:5},OA={fill:"#fff",fontSize:12},MC=function(){function c(a){var e=a.x,i=e===void 0?0:e,s=a.y,l=s===void 0?0:s,f=a.container,d=a.text,v=a.padding,w=v===void 0?[4,4,4,4]:v,E=a.className,T=E===void 0?"g6-component-timebar-tooltip":E,G=a.backgroundColor,U=G===void 0?"#000":G,et=a.textColor,ct=et===void 0?"#fff":et,Ct=a.opacity,Mt=Ct===void 0?.8:Ct,Dt=a.fontSize,zt=Dt===void 0?12:Dt;this.container=f,this.className=T,this.backgroundColor=U,this.textColor=ct,this.x=i,this.y=l,this.text=d,this.padding=w,this.opacity=Mt,this.fontSize=zt,this.render()}return c.prototype.render=function(){var a=this,e=a.className,i=a.x,s=a.y,l=a.backgroundColor,f=a.textColor,d=a.text,v=a.padding,w=a.opacity,E=a.fontSize,T=a.container,G=Hl("<div class='".concat(e,`' style="position: absolute; width: fit-content; height: fit-content; opacity: `).concat(w,'"></div>'));(0,_.isString)(T)&&(T=document.getElementById(T)),T.appendChild(G),a.parentHeight=T.offsetHeight,a.parentWidth=T.offsetWidth,Ps(G,{visibility:"hidden",top:0,left:0});var U=Hl(`
      <div style='position: absolute; white-space:nowrap; background-color: `.concat(l,"; font-size: ").concat(E,"px; border-radius: 4px; width: fit-content; height: fit-content; color: ").concat(f,"; padding: ").concat(v[0],"px ").concat(v[1],"px ").concat(v[2],"px ").concat(v[3],"px'></div>"));U.innerHTML=d,G.appendChild(U),a.backgroundDOM=U;var et=Hl("<div style='position: absolute; width: 0px; height: 0px; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 10px solid ".concat(l,"'></div>"));G.appendChild(et),a.arrowDOM=et,a.container=G},c.prototype.show=function(a){var e=this,i=a.text,s=a.x,l=a.y,f=a.clientX,d=a.clientY;e.backgroundDOM.innerHTML=i;var v=e.backgroundDOM.offsetWidth,w=e.backgroundDOM.offsetHeight,E=e.arrowDOM.offsetWidth,T=e.arrowDOM.offsetHeight;Ps(e.container,{top:"".concat(-w-T,"px"),left:"".concat(s,"px"),visibility:"visible"}),Ps(e.backgroundDOM,{marginLeft:"".concat(-v/2,"px")}),Ps(e.arrowDOM,{marginLeft:"".concat(-E/2,"px"),top:"".concat(w,"px")});var G=s-v/2,U=s+v/2;G<0?Ps(e.backgroundDOM,{marginLeft:"".concat(-v/2-G,"px")}):U>e.parentWidth&&Ps(e.backgroundDOM,{marginLeft:"".concat(-v/2-U+e.parentWidth+12,"px")})},c.prototype.hide=function(){Ps(this.container,{top:0,left:0,visibility:"hidden"})},c}(),NC=MC,mb=function(){return mb=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},mb.apply(this,arguments)},kC=function(){function c(a){this.config=(0,_.deepMix)({},a),this.init()}return c.prototype.update=function(a){this.config=(0,_.deepMix)({},this.config,a),this.updateElement(),this.renderMarker()},c.prototype.init=function(){this.initElement(),this.renderMarker()},c.prototype.initElement=function(){var a=this.config,e=a.group,i=a.style,s=i.scale,l=s===void 0?1:s,f=i.offsetX,d=f===void 0?0:f,v=i.offsetY,w=v===void 0?0:v,E=this.config.x+d,T=this.config.y+w,G=e.addGroup({name:dg});this.startMarkerGroup=G.addGroup({name:dg}),this.circle=e.addShape("circle",{attrs:mb({x:E,y:T,r:this.config.r*l},i),name:dg}),this.startMarker=this.startMarkerGroup.addShape("path",{attrs:{path:this.getStartMarkerPath(E,T,l),fill:i.stroke||"#aaa"},name:"start-marker"}),this.pauseMarkerGroup=G.addGroup({name:dg});var U=.25*this.config.r*l,et=.5*this.config.r*Math.sqrt(3)*l;this.pauseLeftMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:E-.375*this.config.r*l,y:T-et/2,width:U,height:et,fill:i.stroke||"#aaa",lineWidth:0}}),this.pauseRightMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:E+1/8*this.config.r*l,y:T-et/2,width:U,height:et,fill:i.stroke||"#aaa",lineWidth:0}})},c.prototype.updateElement=function(){var a=this.config.style,e=a.scale,i=e===void 0?1:e,s=a.offsetX,l=s===void 0?0:s,f=a.offsetY,d=f===void 0?0:f,v=this.config.x+l,w=this.config.y+d;this.circle.attr("x",v),this.circle.attr("y",w),this.circle.attr("r",this.config.r*i),this.startMarker.attr("path",this.getStartMarkerPath(v,w,i));var E=.25*this.config.r*i,T=.5*this.config.r*Math.sqrt(3)*i;this.pauseLeftMarker.attr("x",v-(1/4+1/8)*this.config.r*i),this.pauseLeftMarker.attr("y",w-T/2),this.pauseLeftMarker.attr("width",E),this.pauseLeftMarker.attr("height",T),this.pauseRightMarker.attr("x",v+1/8*this.config.r*i),this.pauseRightMarker.attr("y",w-T/2),this.pauseRightMarker.attr("width",E),this.pauseRightMarker.attr("height",T)},c.prototype.renderMarker=function(){this.config.isPlay?(this.startMarkerGroup.hide(),this.pauseMarkerGroup.show()):(this.startMarkerGroup.show(),this.pauseMarkerGroup.hide())},c.prototype.getStartMarkerPath=function(a,e,i){var s=.5*this.config.r*Math.sqrt(3)*i;return[["M",a-s/Math.sqrt(3)/2,e-s/2],["L",a+s/Math.sqrt(3),e],["L",a-s/Math.sqrt(3)/2,e+s/2]]},c}(),DC=kC,qc=function(){return qc=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},qc.apply(this,arguments)},ep=ie,Rw="#aaa",OC="green",Bg={fill:"#aaa",fillOpacity:.35,stroke:"#aaa"},zg={fill:"#fff"},RC={fill:"green"},x0={pointer:{fill:"#aaa",lineWidth:0},scroller:{stroke:"#aaa",fill:"#aaa",lineWidth:1,lineAppendWidth:5,cursor:"pointer"},text:{fill:"#aaa",textBaseline:"top"}},Ay={check:{stroke:"green",lineWidth:3},box:{fill:"#fff",stroke:"#aaa",lineWidth:2,radius:3,width:12,height:12},text:{fill:"#aaa",fontSize:12,textBaseline:"top"}},jv={speed:1,loop:!1,fill:"#fff",stroke:"#fff",hideTimeTypeController:!1,preBtnStyle:{fill:"#aaa",stroke:"#aaa"},nextBtnStyle:{fill:"#aaa",stroke:"#aaa"},playBtnStyle:{fill:"#aaa",stroke:"#aaa",fillOpacity:.05},speedControllerStyle:x0,timeTypeControllerStyle:Ay},w0=110,Ap=50,np={SINGLE:"single",RANGE:"range"},E0=function(){function c(a){this.controllerCfg=(0,_.deepMix)({},jv,a),this.group=a.group,this.controllerGroup=this.group.addGroup({name:"controller-group"}),this.speedAxisY=[],this.currentSpeed=this.controllerCfg.speed,this.currentType=this.controllerCfg.defaultTimeType||np.RANGE,this.fontFamily=a.fontFamily||"Arial, sans-serif",this.init()}return c.prototype.init=function(){this.renderPlayButton()},c.prototype.getNextMarkerPath=function(a,e,i){return[["M",a,e-i],["L",a+i,e],["L",a,e+i],["Z",a,e-i],["M",a,e],["L",a-i,e-i],["L",a-i,e+i],["Z"]]},c.prototype.getPreMarkerPath=function(a,e,i){return[["M",a,e-i],["L",a-i,e],["L",a,e+i],["L",a,e-i],["M",a,e],["L",a+i,e-i],["L",a+i,e+i],["Z"]]},c.prototype.renderPlayButton=function(){var a=this.controllerCfg,e=a.width,i=a.height,s=a.x,l=a.y,f=a.hideTimeTypeController,d=a.fill,v=d===void 0?Rw:d,w=a.stroke,E=w===void 0?OC:w,T=a.containerStyle,G=T===void 0?{}:T,U=qc(qc({},Bg),a.playBtnStyle||{}),et=qc(qc({},zg),a.preBtnStyle||{}),ct=qc(qc({},RC),a.nextBtnStyle||{}),Ct=i/2-5,Mt=l+10,Dt=this.controllerGroup.addShape("rect",{attrs:qc({x:s,y:Mt,width:e,height:i,stroke:E,fill:v},G),name:"container-rect"});this.playButton?this.playButton.update({x:e/2,y:Mt,r:Ct}):this.playButton=new DC({group:this.controllerGroup,x:e/2,y:Mt+Ct+5,r:Ct,isPlay:this.isPlay,style:U});var zt=et.offsetX||0,Qt=et.offsetY||0,Ie=(et.scale||1)*Ct;this.controllerGroup.addShape("path",{attrs:qc({path:this.getPreMarkerPath(e/2-5*Ct+zt,Mt+Ct+5+Qt,Ie*.5)},et),name:b0});var je=ct.offsetX||0,ze=ct.offsetY||0,mn=(ct.scale||1)*Ct;this.controllerGroup.addShape("path",{attrs:qc({path:this.getNextMarkerPath(e/2+5*Ct+je,Mt+Ct+5+ze,mn*.5)},ct),name:y0}),Dt.toBack(),this.renderSpeedBtn(),f||this.renderToggleTime(),this.bindEvent();var $n=this.controllerCfg.scale,Tn=$n===void 0?1:$n,or=this.controllerGroup.getCanvasBBox(),kr=(or.maxX+or.minX)/2,Ta=(or.maxY+or.minY)/2,fi=ep([1,0,0,0,1,0,0,0,1],[["t",-kr,-Ta],["s",Tn,Tn],["t",kr,Ta]]);this.controllerGroup.setMatrix(fi)},c.prototype.renderSpeedBtn=function(){var a=this.controllerCfg,e=a.y,i=a.width,s=a.hideTimeTypeController,l=qc(qc({},x0),this.controllerCfg.speedControllerStyle||{}),f=l.scroller,d=f===void 0?{}:f,v=l.text,w=v===void 0?{}:v,E=l.pointer,T=E===void 0?{}:E,G=l.scale,U=G===void 0?1:G,et=l.offsetX,ct=et===void 0?0:et,Ct=l.offsetY,Mt=Ct===void 0?0:Ct,Dt=this.controllerGroup.addGroup({name:"speed-group"});this.speedGroup=Dt;var zt=[],Qt=5;this.speedAxisY=[19,22,26,32,39];for(var Ie=0;Ie<5;Ie++){var je=e+this.speedAxisY[Ie],ze=i-(s?Ap:w0);Dt.addShape("line",{attrs:qc({x1:ze,x2:ze+15,y1:je,y2:je},d),speed:Qt,name:"speed-rect"}),this.speedAxisY[Ie]=je,zt.push(Qt),Qt=Qt-1}this.speedText=Dt.addShape("text",{attrs:qc({x:i-(s?Ap:w0)+20,y:this.speedAxisY[0]+4,text:"1.0X",fontFamily:this.fontFamily||"Arial, sans-serif"},w),name:"speed-text"}),this.speedPoint=Dt.addShape("path",{attrs:qc({path:this.getPointerPath(i-(s?Ap:w0),0),matrix:[1,0,0,0,1,0,0,this.speedAxisY[4],1]},T),name:"speed-pointer"});var mn=this.speedGroup.getCanvasBBox(),$n=(mn.maxX+mn.minX)/2,Tn=(mn.maxY+mn.minY)/2,or=this.speedGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];or=ep(or,[["t",-$n,-Tn],["s",U,U],["t",$n+ct*U,Tn+Mt*U]]),this.speedGroup.setMatrix(or)},c.prototype.getPointerPath=function(a,e){return[["M",a,e],["L",a-10,e-4],["L",a-10,e+4],["Z"]]},c.prototype.renderToggleTime=function(){var a,e,i=this.controllerCfg,s=i.width,l=i.defaultTimeType,f=qc(qc({},Ay),this.controllerCfg.timeTypeControllerStyle||{}),d=f.scale,v=d===void 0?1:d,w=f.offsetX,E=w===void 0?0:w,T=f.offsetY,G=T===void 0?0:T,U=f.box,et=U===void 0?{}:U,ct=f.check,Ct=ct===void 0?{}:ct,Mt=f.text,Dt=Mt===void 0?{}:Mt;this.toggleGroup=this.controllerGroup.addGroup({name:"toggle-group"});var zt=l===np.SINGLE;this.toggleGroup.addShape("rect",{attrs:qc({x:s-Ap,y:this.speedAxisY[0]+3.5},et),isChecked:zt,name:"toggle-model"}),this.checkedIcon=this.toggleGroup.addShape("path",{attrs:qc({path:[["M",s-Ap+3,this.speedAxisY[1]+6],["L",s-Ap+7,this.speedAxisY[1]+10],["L",s-Ap+12,this.speedAxisY[1]+4]]},Ct),capture:!1,name:"check-icon"}),zt||this.checkedIcon.hide(),this.checkedText=this.toggleGroup.addShape("text",{attrs:qc({text:zt?((a=this.controllerCfg)===null||a===void 0?void 0:a.timeRangeControllerText)||"\u65F6\u95F4\u8303\u56F4":((e=this.controllerCfg)===null||e===void 0?void 0:e.timePointControllerText)||"\u5355\u4E00\u65F6\u95F4",x:s-Ap+15,y:this.speedAxisY[0]+4,fontFamily:typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"},Dt),name:"checked-text"});var Qt=this.toggleGroup.getCanvasBBox(),Ie=(Qt.maxX+Qt.minX)/2,je=(Qt.maxY+Qt.minY)/2,ze=this.toggleGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];ze=ep(ze,[["t",-Ie,-je],["s",v,v],["t",Ie+E*v,je+G*v]]),this.toggleGroup.setMatrix(ze)},c.prototype.bindEvent=function(){var a=this;this.speedGroup.on("speed-rect:click",function(e){var i=e.target.attr("y1"),s=a.speedPoint.attr("matrix"),l=a.speedAxisY.indexOf(s[7]||0),f=a.speedAxisY.indexOf(i),d=a.speedAxisY[f]-a.speedAxisY[l];s=ep(s,[["t",0,d]]),a.speedPoint.setMatrix(s),a.currentSpeed=a.speedAxisY.length-f,a.speedText.attr("text","".concat(a.currentSpeed,".0X")),a.group.emit(Fg,{speed:a.currentSpeed,type:a.currentType})}),this.speedGroup.on("mousewheel",function(e){e.preventDefault();var i=a.speedPoint.attr("matrix")||[1,0,0,0,1,0,0,0,1],s=i[7],l=a.speedAxisY.indexOf(s);if(l===-1){var f=Infinity;a.speedAxisY.forEach(function(v,w){var E=Math.abs(v-s);f>E&&(f=E,l=w)})}e.originalEvent.deltaY>0?l=Math.max(0,l-1):l=Math.min(a.speedAxisY.length-1,l+1);var d=a.speedAxisY[l]-s;i=ep(i,[["t",0,d]]),a.speedPoint.setMatrix(i),a.currentSpeed=a.speedAxisY.length-l,a.speedText.attr("text","".concat(a.currentSpeed,".0X")),a.group.emit(Fg,{speed:a.currentSpeed,type:a.currentType})}),this.toggleGroup&&this.toggleGroup.on("toggle-model:click",function(e){var i,s,l=e.target.get("isChecked");l?(a.checkedIcon.hide(),a.checkedText.attr("text",((s=a.controllerCfg)===null||s===void 0?void 0:s.timePointControllerText)||"\u5355\u4E00\u65F6\u95F4"),a.currentType=np.RANGE):(a.checkedIcon.show(),a.checkedText.attr("text",((i=a.controllerCfg)===null||i===void 0?void 0:i.timeRangeControllerText)||"\u65F6\u95F4\u8303\u56F4"),a.currentType=np.SINGLE),e.target.set("isChecked",!l),a.group.emit(Fg,{type:a.currentType,speed:a.currentSpeed})})},c.prototype.destroy=function(){this.speedGroup.off("speed-rect:click"),this.toggleGroup&&(this.toggleGroup.off("toggle-model:click"),this.toggleGroup.destroy()),this.speedGroup.destroy()},c}(),Im=E0,Hv=function(){return Hv=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},Hv.apply(this,arguments)},yb=ie,bb={fill:"#5B8FF9"},My={fill:"#e6e8e9"},Ny=function(){function c(a){this.frameCount=0,this.fontFamily="Arial, sans-serif";var e=a.graph,i=a.canvas,s=a.group,l=a.width,f=a.height,d=a.padding,v=a.data,w=a.start,E=a.end,T=a.x,G=T===void 0?0:T,U=a.y,et=U===void 0?0:U,ct=a.tickLabelFormatter,Ct=a.selectedTickStyle,Mt=Ct===void 0?bb:Ct,Dt=a.unselectedTickStyle,zt=Dt===void 0?My:Dt,Qt=a.tooltipBackgroundColor,Ie=a.tooltipFomatter,je=a.tickLabelStyle,ze=a.controllerCfg,mn=ze===void 0?{speed:1}:ze;this.graph=e,this.group=s,this.sliceGroup=s.addGroup({name:"slice-group"}),this.canvas=i,this.width=l,this.height=f,this.padding=d,this.data=v,this.start=w,this.end=E,this.tickLabelFormatter=ct,this.tickLabelStyle=je||{},this.selectedTickStyle=Mt,this.unselectedTickStyle=zt,this.controllerCfg=mn,this.currentSpeed=mn.speed||1,this.x=G,this.y=et,this.tooltipBackgroundColor=Qt,this.tooltipFomatter=Ie,this.fontFamily=typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlices(),this.initEvent()}return c.prototype.renderSlices=function(){var a=this,e=this,i=e.width,s=e.height,l=e.padding,f=e.data,d=e.start,v=e.end,w=e.tickLabelFormatter,E=e.selectedTickStyle,T=e.unselectedTickStyle,G=e.tickLabelStyle,U=i-2*l,et=10,ct=4,Ct=3*l+ct+et,Mt=s-Ct-2*l,Dt=2,zt=f.length,Qt=(U-Dt*(zt-1))/zt;this.tickWidth=Qt;var Ie=this.sliceGroup,je=[],ze=[],mn=Math.round(zt*d),$n=Math.round(zt*v);this.startTickRectId=mn,this.endTickRectId=$n;var Tn=G.rotate;delete G.rotate,f.forEach(function(kr,Ta){var fi=Ta>=mn&&Ta<=$n,ei=fi?E:T,Ia=Ie.addShape("rect",{attrs:Hv({x:l+Ta*(Qt+Dt),y:l,width:Qt,height:Mt},ei),draggable:!0,name:"tick-rect-".concat(Ta)}),Gi=Ie.addShape("rect",{attrs:{x:l+Ta*Qt+Dt*(2*Ta-1)/2,y:l,width:Ta===0||Ta===zt-1?Qt+Dt/2:Qt+Dt,height:Mt,fill:"#fff",opacity:0},draggable:!0,name:"pick-rect-".concat(Ta)});Gi.toFront();var Ri=Ia.getBBox(),xa=(Ri.minX+Ri.maxX)/2;je.push({rect:Ia,pickRect:Gi,value:kr.date,x:xa,y:Ri.minY});var ja;if(w?(ja=w(kr),!(0,_.isString)(ja)&&ja&&(ja=kr.date)):Ta%Math.round(zt/10)==0&&(ja=kr.date),ja){ze.push(ja);var di=Ri.maxY+l*2;Ie.addShape("line",{attrs:{stroke:"#BFBFBF",x1:xa,y1:di,x2:xa,y2:di+ct},name:"tick-line"});var hi=di+ct+l,qi=Ie.addShape("text",{attrs:Hv({fill:"#8c8c8c",stroke:"#fff",lineWidth:1,x:xa,y:hi,textAlign:"center",text:ja,textBaseline:"top",fontSize:10,fontFamily:a.fontFamily||"Arial, sans-serif"},G),capture:!1,name:"tick-label"}),fo=qi.getBBox();if(fo.maxX>i?qi.attr("textAlign","right"):fo.minX<0&&qi.attr("textAlign","left"),(0,_.isNumber)(Tn)&&ze.length!==10){var es=yb([1,0,0,0,1,0,0,0,1],[["t",-xa,-hi],["r",Tn],["t",xa-5,hi+2]]);qi.attr({textAlign:"left",matrix:es})}ze.length===1?qi.attr({textAlign:"left"}):ze.length===10&&qi.attr({textAlign:"right"})}}),this.tickRects=je;var or=this.group;this.currentSpeed=1,this.controllerBtnGroup=new Im(Hv({group:or,x:this.x,y:this.y+s+5,width:i,height:40,hideTimeTypeController:!0,speed:this.currentSpeed,fontFamily:this.fontFamily||"Arial, sans-serif"},this.controllerCfg))},c.prototype.initEvent=function(){var a=this,e=this.sliceGroup;e.on("click",function(E){var T=E.target;if(!(T.get("type")!=="rect"||!T.get("name"))){var G=parseInt(T.get("name").split("-")[2],10);if(!isNaN(G)){var U=a.tickRects,et=a.unselectedTickStyle;U.forEach(function(Dt){Dt.rect.attr(et)});var ct=a.selectedTickStyle;U[G].rect.attr(ct),a.startTickRectId=G,a.endTickRectId=G;var Ct=U.length,Mt=G/Ct;a.graph.emit(lv,{value:[Mt,Mt]})}}}),e.on("dragstart",function(E){var T=a.tickRects,G=a.unselectedTickStyle;T.forEach(function(Dt){Dt.rect.attr(G)});var U=E.target,et=parseInt(U.get("name").split("-")[2],10),ct=a.selectedTickStyle;T[et].rect.attr(ct),a.startTickRectId=et;var Ct=T.length,Mt=et/Ct;a.graph.emit(lv,{value:[Mt,Mt]}),a.dragging=!0}),e.on("dragover",function(E){if(!!a.dragging&&E.target.get("type")==="rect"){for(var T=parseInt(E.target.get("name").split("-")[2],10),G=a.startTickRectId,U=a.tickRects,et=a.selectedTickStyle,ct=a.unselectedTickStyle,Ct=0;Ct<U.length;Ct++){var Mt=Ct>=G&&Ct<=T?et:ct;U[Ct].rect.attr(Mt)}var Dt=U.length;a.endTickRectId=T;var zt=G/Dt,Qt=T/Dt;a.graph.emit(lv,{value:[zt,Qt]})}}),e.on("drop",function(E){if(!!a.dragging&&(a.dragging=!1,E.target.get("type")==="rect")){var T=a.startTickRectId,G=parseInt(E.target.get("name").split("-")[2],10);if(!(G<T)){var U=a.selectedTickStyle,et=a.tickRects;et[G].rect.attr(U),a.endTickRectId=G;var ct=et.length,Ct=T/ct,Mt=G/ct;a.graph.emit(lv,{value:[Ct,Mt]})}}});var i=this,s=i.tooltipBackgroundColor,l=i.tooltipFomatter,f=i.canvas,d=new NC({container:f.get("container"),backgroundColor:s}),v=this.tickRects;v.forEach(function(E){var T=E.pickRect;T.on("mouseenter",function(G){var U=G.target;if(U.get("type")==="rect"){var et=parseInt(U.get("name").split("-")[2],10),ct=f.getClientByPoint(v[et].x,v[et].y);d.show({x:v[et].x,y:v[et].y,clientX:ct.x,clientY:ct.y,text:l?l(v[et].value):v[et].value})}}),T.on("mouseleave",function(G){d.hide()})});var w=this.group;w.on("".concat(dg,":click"),function(){a.isPlay=!a.isPlay,a.changePlayStatus()}),w.on("".concat(y0,":click"),function(){a.updateStartEnd(1)}),w.on("".concat(b0,":click"),function(){a.updateStartEnd(-1)}),w.on(Fg,function(E){var T=E.type,G=E.speed;a.currentSpeed=G})},c.prototype.changePlayStatus=function(a){a===void 0&&(a=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit(Dw,null)):this.playHandler&&(typeof window!="undefined"&&window.cancelAnimationFrame(this.playHandler),a&&this.graph.emit(Ow,null))},c.prototype.startPlay=function(){var a=this;return typeof window!="undefined"?window.requestAnimationFrame(function(){var e=a.currentSpeed;a.frameCount%(60/e)==0&&(a.frameCount=0,a.updateStartEnd(1)),a.frameCount++,a.isPlay&&(a.playHandler=a.startPlay())}):void 0},c.prototype.updateStartEnd=function(a){var e=this,i=this.tickRects,s=i.length,l=this.unselectedTickStyle,f=this.selectedTickStyle,d=e.endTickRectId;if(a>0?e.endTickRectId++:(i[e.endTickRectId].rect.attr(l),e.endTickRectId--),d!==e.startTickRectId)e.endTickRectId<e.startTickRectId&&(e.startTickRectId=e.endTickRectId);else{for(var v=e.startTickRectId;v<=e.endTickRectId-1;v++)i[v].rect.attr(l);e.startTickRectId=e.endTickRectId}if(i[e.endTickRectId]){i[e.endTickRectId].rect.attr(f);var w=e.startTickRectId/s,E=e.endTickRectId/s;this.graph.emit(lv,{value:[w,E]})}},c.prototype.destory=function(){var a=this.sliceGroup;a.off("click"),a.off("dragstart"),a.off("dragover"),a.off("drop"),this.tickRects.forEach(function(e){var i=e.pickRect;i.off("mouseenter"),i.off("mouseleave")}),this.tickRects.length=0,a.off("".concat(dg,":click")),a.off("".concat(y0,":click")),a.off("".concat(b0,":click")),a.off(Fg),this.sliceGroup.destroy()},c}(),xb=Ny,ky={};function wb(c){return ky[c]}function rp(c,a){ky[c]=a}var Eb=function(){function c(a){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=a,this.initCfg(),this.init()}return c.prototype.translate=function(a){return a},c.prototype.change=function(a){(0,_.assign)(this.__cfg__,a),this.init()},c.prototype.clone=function(){return this.constructor(this.__cfg__)},c.prototype.getTicks=function(){var a=this;return(0,_.map)(this.ticks,function(e,i){return(0,_.isObject)(e)?e:{text:a.getText(e,i),tickValue:e,value:a.scale(e)}})},c.prototype.getText=function(a,e){var i=this.formatter,s=i?i(a,e):a;return(0,_.isNil)(s)||!(0,_.isFunction)(s.toString)?"":s.toString()},c.prototype.getConfig=function(a){return this.__cfg__[a]},c.prototype.init=function(){(0,_.assign)(this,this.__cfg__),this.setDomain(),(0,_.isEmpty)(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},c.prototype.initCfg=function(){},c.prototype.setDomain=function(){},c.prototype.calculateTicks=function(){var a=this.tickMethod,e=[];if((0,_.isString)(a)){var i=wb(a);if(!i)throw new Error("There is no method to to calculate ticks!");e=i(this)}else(0,_.isFunction)(a)&&(e=a(this));return e},c.prototype.rangeMin=function(){return this.range[0]},c.prototype.rangeMax=function(){return this.range[1]},c.prototype.calcPercent=function(a,e,i){return(0,_.isNumber)(a)?(a-e)/(i-e):NaN},c.prototype.calcValue=function(a,e,i){return e+a*(i-e)},c}(),S0=Eb,Tm=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="cat",e.isCategory=!0,e}return a.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var e=0;e<this.values.length;e++)this.translateIndexMap.set(this.values[e],e)}},a.prototype.translate=function(e){this.buildIndexMap();var i=this.translateIndexMap.get(e);return i===void 0&&(i=(0,_.isNumber)(e)?e:NaN),i},a.prototype.scale=function(e){var i=this.translate(e),s=this.calcPercent(i,this.min,this.max);return this.calcValue(s,this.rangeMin(),this.rangeMax())},a.prototype.invert=function(e){var i=this.max-this.min,s=this.calcPercent(e,this.rangeMin(),this.rangeMax()),l=Math.round(i*s)+this.min;return l<this.min||l>this.max?NaN:this.values[l]},a.prototype.getText=function(e){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var l=e;return(0,_.isNumber)(e)&&!this.values.includes(e)&&(l=this.values[l]),c.prototype.getText.apply(this,(0,O.__spreadArrays)([l],i))},a.prototype.initCfg=function(){this.tickMethod="cat"},a.prototype.setDomain=function(){if((0,_.isNil)(this.getConfig("min"))&&(this.min=0),(0,_.isNil)(this.getConfig("max"))){var e=this.values.length;this.max=e>1?e-1:e}this.translateIndexMap&&(this.translateIndexMap=void 0)},a}(S0),C0=Tm,cv=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,Xv="\\d\\d?",Yv="\\d\\d",Lw="\\d{3}",Sb="\\d{4}",Am="[^\\s]+",Cb=/\[([^]*?)\]/gm;function _b(c,a){for(var e=[],i=0,s=c.length;i<s;i++)e.push(c[i].substr(0,a));return e}var Dy=function(c){return function(a,e){var i=e[c].map(function(l){return l.toLowerCase()}),s=i.indexOf(a.toLowerCase());return s>-1?s:null}};function Kv(c){for(var a=[],e=1;e<arguments.length;e++)a[e-1]=arguments[e];for(var i=0,s=a;i<s.length;i++){var l=s[i];for(var f in l)c[f]=l[f]}return c}var Ib=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Oy=["January","February","March","April","May","June","July","August","September","October","November","December"],LC=_b(Oy,3),PC=_b(Ib,3),_0={dayNamesShort:PC,dayNames:Ib,monthNamesShort:LC,monthNames:Oy,amPm:["am","pm"],DoFn:function(c){return c+["th","st","nd","rd"][c%10>3?0:(c-c%10!=10?1:0)*c%10]}},I0=Kv({},_0),Tb=function(c){return I0=Kv(I0,c)},Pw=function(c){return c.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},ad=function(c,a){for(a===void 0&&(a=2),c=String(c);c.length<a;)c="0"+c;return c},FC={D:function(c){return String(c.getDate())},DD:function(c){return ad(c.getDate())},Do:function(c,a){return a.DoFn(c.getDate())},d:function(c){return String(c.getDay())},dd:function(c){return ad(c.getDay())},ddd:function(c,a){return a.dayNamesShort[c.getDay()]},dddd:function(c,a){return a.dayNames[c.getDay()]},M:function(c){return String(c.getMonth()+1)},MM:function(c){return ad(c.getMonth()+1)},MMM:function(c,a){return a.monthNamesShort[c.getMonth()]},MMMM:function(c,a){return a.monthNames[c.getMonth()]},YY:function(c){return ad(String(c.getFullYear()),4).substr(2)},YYYY:function(c){return ad(c.getFullYear(),4)},h:function(c){return String(c.getHours()%12||12)},hh:function(c){return ad(c.getHours()%12||12)},H:function(c){return String(c.getHours())},HH:function(c){return ad(c.getHours())},m:function(c){return String(c.getMinutes())},mm:function(c){return ad(c.getMinutes())},s:function(c){return String(c.getSeconds())},ss:function(c){return ad(c.getSeconds())},S:function(c){return String(Math.round(c.getMilliseconds()/100))},SS:function(c){return ad(Math.round(c.getMilliseconds()/10),2)},SSS:function(c){return ad(c.getMilliseconds(),3)},a:function(c,a){return c.getHours()<12?a.amPm[0]:a.amPm[1]},A:function(c,a){return c.getHours()<12?a.amPm[0].toUpperCase():a.amPm[1].toUpperCase()},ZZ:function(c){var a=c.getTimezoneOffset();return(a>0?"-":"+")+ad(Math.floor(Math.abs(a)/60)*100+Math.abs(a)%60,4)},Z:function(c){var a=c.getTimezoneOffset();return(a>0?"-":"+")+ad(Math.floor(Math.abs(a)/60),2)+":"+ad(Math.abs(a)%60,2)}},Fw=function(c){return+c-1},Bw=[null,Xv],zw=[null,Am],$w=["isPm",Am,function(c,a){var e=c.toLowerCase();return e===a.amPm[0]?0:e===a.amPm[1]?1:null}],Gw=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(c){var a=(c+"").match(/([+-]|\d\d)/gi);if(a){var e=+a[1]*60+parseInt(a[2],10);return a[0]==="+"?e:-e}return 0}],BC={D:["day",Xv],DD:["day",Yv],Do:["day",Xv+Am,function(c){return parseInt(c,10)}],M:["month",Xv,Fw],MM:["month",Yv,Fw],YY:["year",Yv,function(c){var a=new Date,e=+(""+a.getFullYear()).substr(0,2);return+(""+(+c>68?e-1:e)+c)}],h:["hour",Xv,void 0,"isPm"],hh:["hour",Yv,void 0,"isPm"],H:["hour",Xv],HH:["hour",Yv],m:["minute",Xv],mm:["minute",Yv],s:["second",Xv],ss:["second",Yv],YYYY:["year",Sb],S:["millisecond","\\d",function(c){return+c*100}],SS:["millisecond",Yv,function(c){return+c*10}],SSS:["millisecond",Lw],d:Bw,dd:Bw,ddd:zw,dddd:zw,MMM:["month",Am,Dy("monthNamesShort")],MMMM:["month",Am,Dy("monthNames")],a:$w,A:$w,ZZ:Gw,Z:Gw},Ry={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},Uw=function(c){return Kv(Ry,c)},Ww=function(c,a,e){if(a===void 0&&(a=Ry.default),e===void 0&&(e={}),typeof c=="number"&&(c=new Date(c)),Object.prototype.toString.call(c)!=="[object Date]"||isNaN(c.getTime()))throw new Error("Invalid Date pass to format");a=Ry[a]||a;var i=[];a=a.replace(Cb,function(l,f){return i.push(f),"@@@"});var s=Kv(Kv({},I0),e);return a=a.replace(cv,function(l){return FC[l](c,s)}),a.replace(/@@@/g,function(){return i.shift()})};function Vw(c,a,e){if(e===void 0&&(e={}),typeof a!="string")throw new Error("Invalid format in fecha parse");if(a=Ry[a]||a,c.length>1e3)return null;var i=new Date,s={year:i.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},l=[],f=[],d=a.replace(Cb,function(Qt,Ie){return f.push(Pw(Ie)),"@@@"}),v={},w={};d=Pw(d).replace(cv,function(Qt){var Ie=BC[Qt],je=Ie[0],ze=Ie[1],mn=Ie[3];if(v[je])throw new Error("Invalid format. "+je+" specified twice in format");return v[je]=!0,mn&&(w[mn]=!0),l.push(Ie),"("+ze+")"}),Object.keys(w).forEach(function(Qt){if(!v[Qt])throw new Error("Invalid format. "+Qt+" is required in specified format")}),d=d.replace(/@@@/g,function(){return f.shift()});var E=c.match(new RegExp(d,"i"));if(!E)return null;for(var T=Kv(Kv({},I0),e),G=1;G<E.length;G++){var U=l[G-1],et=U[0],ct=U[2],Ct=ct?ct(E[G],T):+E[G];if(Ct==null)return null;s[et]=Ct}s.isPm===1&&s.hour!=null&&+s.hour!=12?s.hour=+s.hour+12:s.isPm===0&&+s.hour==12&&(s.hour=0);var Mt;if(s.timezoneOffset==null){Mt=new Date(s.year,s.month,s.day,s.hour,s.minute,s.second,s.millisecond);for(var Dt=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],G=0,zt=Dt.length;G<zt;G++)if(v[Dt[G][0]]&&s[Dt[G][0]]!==Mt[Dt[G][1]]())return null}else if(Mt=new Date(Date.UTC(s.year,s.month,s.day,s.hour,s.minute-s.timezoneOffset,s.second,s.millisecond)),s.month>11||s.month<0||s.day>31||s.day<1||s.hour>23||s.hour<0||s.minute>59||s.minute<0||s.second>59||s.second<0)return null;return Mt}var zC={format:Ww,parse:Vw,defaultI18n:_0,setGlobalDateI18n:Tb,setGlobalDateMasks:Uw},jw=zC;function $C(c){return function(a,e,i,s){for(var l=(0,_.isNil)(i)?0:i,f=(0,_.isNil)(s)?a.length:s;l<f;){var d=l+f>>>1;c(a[d])>e?f=d:l=d+1}return l}}var Hw="format";function Xw(c,a){var e=K[Hw]||jw[Hw];return e(c,a)}function Ly(c){return(0,_.isString)(c)&&(c.indexOf("T")>0?c=new Date(c).getTime():c=new Date(c.replace(/-/gi,"/")).getTime()),(0,_.isDate)(c)&&(c=c.getTime()),c}var Mp=1e3,$g=60*Mp,Gg=60*$g,Zv=24*Gg,T0=Zv*31,Yw=Zv*365,A0=[["HH:mm:ss",Mp],["HH:mm:ss",Mp*10],["HH:mm:ss",Mp*30],["HH:mm",$g],["HH:mm",$g*10],["HH:mm",$g*30],["HH",Gg],["HH",Gg*6],["HH",Gg*12],["YYYY-MM-DD",Zv],["YYYY-MM-DD",Zv*4],["YYYY-WW",Zv*7],["YYYY-MM",T0],["YYYY-MM",T0*4],["YYYY-MM",T0*6],["YYYY",Zv*380]];function GC(c,a,e){var i=(a-c)/e,s=$C(function(f){return f[1]})(A0,i)-1,l=A0[s];return s<0?l=A0[0]:s>=A0.length&&(l=(0,_.last)(A0)),l}var UC=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="timeCat",e}return a.prototype.translate=function(e){e=Ly(e);var i=this.values.indexOf(e);return i===-1&&((0,_.isNumber)(e)&&e<this.values.length?i=e:i=NaN),i},a.prototype.getText=function(e,i){var s=this.translate(e);if(s>-1){var l=this.values[s],f=this.formatter;return l=f?f(l,i):Xw(l,this.mask),l}return e},a.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},a.prototype.setDomain=function(){var e=this.values;(0,_.each)(e,function(i,s){e[s]=Ly(i)}),e.sort(function(i,s){return i-s}),c.prototype.setDomain.call(this)},a}(C0),WC=UC,VC=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.isContinuous=!0,e}return a.prototype.scale=function(e){if((0,_.isNil)(e))return NaN;var i=this.rangeMin(),s=this.rangeMax(),l=this.max,f=this.min;if(l===f)return i;var d=this.getScalePercent(e);return i+d*(s-i)},a.prototype.init=function(){c.prototype.init.call(this);var e=this.ticks,i=(0,_.head)(e),s=(0,_.last)(e);i<this.min&&(this.min=i),s>this.max&&(this.max=s),(0,_.isNil)(this.minLimit)||(this.min=i),(0,_.isNil)(this.maxLimit)||(this.max=s)},a.prototype.setDomain=function(){var e=(0,_.getRange)(this.values),i=e.min,s=e.max;(0,_.isNil)(this.min)&&(this.min=i),(0,_.isNil)(this.max)&&(this.max=s),this.min>this.max&&(this.min=i,this.max=s)},a.prototype.calculateTicks=function(){var e=this,i=c.prototype.calculateTicks.call(this);return this.nice||(i=(0,_.filter)(i,function(s){return s>=e.min&&s<=e.max})),i},a.prototype.getScalePercent=function(e){var i=this.max,s=this.min;return(e-s)/(i-s)},a.prototype.getInvertPercent=function(e){return(e-this.rangeMin())/(this.rangeMax()-this.rangeMin())},a}(S0),Py=VC,jC=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="linear",e.isLinear=!0,e}return a.prototype.invert=function(e){var i=this.getInvertPercent(e);return this.min+i*(this.max-this.min)},a.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},a}(Py),M0=jC;function pg(c,a){var e=Math.E,i;return a>=0?i=Math.pow(e,Math.log(a)/c):i=Math.pow(e,Math.log(-a)/c)*-1,i}function ap(c,a){return c===1?1:Math.log(a)/Math.log(c)}function Kw(c,a,e){(0,_.isNil)(e)&&(e=Math.max.apply(null,c));var i=e;return(0,_.each)(c,function(s){s>0&&s<i&&(i=s)}),i===e&&(i=e/a),i>1&&(i=1),i}function Zw(c){var a=c.toString().split(/[eE]/),e=(a[0].split(".")[1]||"").length-+(a[1]||0);return e>0?e:0}function RA(c,a){var e=Zw(c),i=Zw(a),s=Math.pow(10,Math.max(e,i));return(c*s+a*s)/s}var HC=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="log",e}return a.prototype.invert=function(e){var i=this.base,s=ap(i,this.max),l=this.rangeMin(),f=this.rangeMax()-l,d,v=this.positiveMin;if(v){if(e===0)return 0;d=ap(i,v/i);var w=1/(s-d)*f;if(e<w)return e/w*v}else d=ap(i,this.min);var E=(e-l)/f,T=E*(s-d)+d;return Math.pow(i,T)},a.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},a.prototype.setDomain=function(){c.prototype.setDomain.call(this);var e=this.min;if(e<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");e===0&&(this.positiveMin=Kw(this.values,this.base,this.max))},a.prototype.getScalePercent=function(e){var i=this.max,s=this.min;if(i===s||e<=0)return 0;var l=this.base,f=this.positiveMin;f&&(s=f*1/l);var d;return e<f?d=e/f/(ap(l,i)-ap(l,s)):d=(ap(l,e)-ap(l,s))/(ap(l,i)-ap(l,s)),d},a}(Py),XC=HC,YC=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="pow",e}return a.prototype.invert=function(e){var i=this.getInvertPercent(e),s=this.exponent,l=pg(s,this.max),f=pg(s,this.min),d=i*(l-f)+f,v=d>=0?1:-1;return Math.pow(d,s)*v},a.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},a.prototype.getScalePercent=function(e){var i=this.max,s=this.min;if(i===s)return 0;var l=this.exponent,f=(pg(l,e)-pg(l,s))/(pg(l,i)-pg(l,s));return f},a}(Py),KC=YC,ZC=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="time",e}return a.prototype.getText=function(e,i){var s=this.translate(e),l=this.formatter;return l?l(s,i):Xw(s,this.mask)},a.prototype.scale=function(e){var i=e;return((0,_.isString)(i)||(0,_.isDate)(i))&&(i=this.translate(i)),c.prototype.scale.call(this,i)},a.prototype.translate=function(e){return Ly(e)},a.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},a.prototype.setDomain=function(){var e=this.values,i=this.getConfig("min"),s=this.getConfig("max");if((!(0,_.isNil)(i)||!(0,_.isNumber)(i))&&(this.min=this.translate(this.min)),(!(0,_.isNil)(s)||!(0,_.isNumber)(s))&&(this.max=this.translate(this.max)),e&&e.length){var l=[],f=Infinity,d=f,v=0;(0,_.each)(e,function(w){var E=Ly(w);if(isNaN(E))throw new TypeError("Invalid Time: "+w+" in time scale!");f>E?(d=f,f=E):d>E&&(d=E),v<E&&(v=E),l.push(E)}),e.length>1&&(this.minTickInterval=d-f),(0,_.isNil)(i)&&(this.min=f),(0,_.isNil)(s)&&(this.max=v)}},a}(M0),qC=ZC,qw=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="quantize",e}return a.prototype.invert=function(e){var i=this.ticks,s=i.length,l=this.getInvertPercent(e),f=Math.floor(l*(s-1));if(f>=s-1)return(0,_.last)(i);if(f<0)return(0,_.head)(i);var d=i[f],v=i[f+1],w=f/(s-1),E=(f+1)/(s-1);return d+(l-w)/(E-w)*(v-d)},a.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},a.prototype.calculateTicks=function(){var e=c.prototype.calculateTicks.call(this);return this.nice||((0,_.last)(e)!==this.max&&e.push(this.max),(0,_.head)(e)!==this.min&&e.unshift(this.min)),e},a.prototype.getScalePercent=function(e){var i=this.ticks;if(e<(0,_.head)(i))return 0;if(e>(0,_.last)(i))return 1;var s=0;return(0,_.each)(i,function(l,f){if(e>=l)s=f;else return!1}),s/(i.length-1)},a}(Py),Ab=qw,QC=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="quantile",e}return a.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},a}(Ab),JC=QC,Qw={};function t_(c){return Qw[c]}function fv(c,a){if(t_(c))throw new Error("type '"+c+"' existed.");Qw[c]=a}var e_=function(c){(0,O.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="identity",e.isIdentity=!0,e}return a.prototype.calculateTicks=function(){return this.values},a.prototype.scale=function(e){return this.values[0]!==e&&(0,_.isNumber)(e)?e:this.range[0]},a.prototype.invert=function(e){var i=this.range;return e<i[0]||e>i[1]?NaN:this.values[0]},a}(S0),n_=e_;function Jw(c){var a=c.values,e=c.tickInterval,i=c.tickCount,s=c.showLast;if((0,_.isNumber)(e)){var l=(0,_.filter)(a,function(et,ct){return ct%e==0}),f=(0,_.last)(a);return s&&(0,_.last)(l)!==f&&l.push(f),l}var d=a.length,v=c.min,w=c.max;if((0,_.isNil)(v)&&(v=0),(0,_.isNil)(w)&&(w=a.length-1),!(0,_.isNumber)(i)||i>=d)return a.slice(v,w+1);if(i<=0||w<=0)return[];for(var E=i===1?d:Math.floor(d/(i-1)),T=[],G=v,U=0;U<i&&!(G>=w);U++)G=Math.min(v+U*E,w),U===i-1&&s?T.push(a[w]):T.push(a[G]);return T}function r_(c){var a=c.min,e=c.max,i=c.nice,s=c.tickCount,l=new nE;return l.domain([a,e]),i&&l.nice(s),l.ticks(s)}var Mb=5,tE=Math.sqrt(50),eE=Math.sqrt(10),Nb=Math.sqrt(2),nE=function(){function c(){this._domain=[0,1]}return c.prototype.domain=function(a){return a?(this._domain=Array.from(a,Number),this):this._domain.slice()},c.prototype.nice=function(a){var e,i;a===void 0&&(a=Mb);var s=this._domain.slice(),l=0,f=this._domain.length-1,d=this._domain[l],v=this._domain[f],w;return v<d&&(e=[v,d],d=e[0],v=e[1],i=[f,l],l=i[0],f=i[1]),w=Fy(d,v,a),w>0?(d=Math.floor(d/w)*w,v=Math.ceil(v/w)*w,w=Fy(d,v,a)):w<0&&(d=Math.ceil(d*w)/w,v=Math.floor(v*w)/w,w=Fy(d,v,a)),w>0?(s[l]=Math.floor(d/w)*w,s[f]=Math.ceil(v/w)*w,this.domain(s)):w<0&&(s[l]=Math.ceil(d*w)/w,s[f]=Math.floor(v*w)/w,this.domain(s)),this},c.prototype.ticks=function(a){return a===void 0&&(a=Mb),a_(this._domain[0],this._domain[this._domain.length-1],a||Mb)},c}();function a_(c,a,e){var i,s=-1,l,f,d;if(a=+a,c=+c,e=+e,c===a&&e>0)return[c];if((i=a<c)&&(l=c,c=a,a=l),(d=Fy(c,a,e))===0||!isFinite(d))return[];if(d>0)for(c=Math.ceil(c/d),a=Math.floor(a/d),f=new Array(l=Math.ceil(a-c+1));++s<l;)f[s]=(c+s)*d;else for(c=Math.floor(c*d),a=Math.ceil(a*d),f=new Array(l=Math.ceil(c-a+1));++s<l;)f[s]=(c-s)/d;return i&&f.reverse(),f}function Fy(c,a,e){var i=(a-c)/Math.max(0,e),s=Math.floor(Math.log(i)/Math.LN10),l=i/Math.pow(10,s);return s>=0?(l>=tE?10:l>=eE?5:l>=Nb?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(l>=tE?10:l>=eE?5:l>=Nb?2:1)}function rE(c,a,e){var i;return e==="ceil"?i=Math.ceil(c/a):e==="floor"?i=Math.floor(c/a):i=Math.round(c/a),i*a}function kb(c,a,e){var i=rE(c,e,"floor"),s=rE(a,e,"ceil");i=(0,_.fixedBase)(i,e),s=(0,_.fixedBase)(s,e);for(var l=[],f=Math.max((s-i)/(Math.pow(2,12)-1),e),d=i;d<=s;d=d+f){var v=(0,_.fixedBase)(d,f);l.push(v)}return{min:i,max:s,ticks:l}}function Db(c,a,e){var i,s=c.minLimit,l=c.maxLimit,f=c.min,d=c.max,v=c.tickCount,w=v===void 0?5:v,E=(0,_.isNil)(s)?(0,_.isNil)(a)?f:a:s,T=(0,_.isNil)(l)?(0,_.isNil)(e)?d:e:l;if(E>T&&(i=[E,T],T=i[0],E=i[1]),w<=2)return[E,T];for(var G=(T-E)/(w-1),U=[],et=0;et<w;et++)U.push(E+G*et);return U}function i_(c){var a=c.min,e=c.max,i=c.tickInterval,s=c.minLimit,l=c.maxLimit,f=r_(c);return!(0,_.isNil)(s)||!(0,_.isNil)(l)?Db(c,(0,_.head)(f),(0,_.last)(f)):i?kb(a,e,i).ticks:f}function Ug(c){return Math.abs(c)<1e-15?c:parseFloat(c.toFixed(15))}var o_=[1,5,2,2.5,4,3],LA=null,aE=Number.EPSILON*100;function s_(c,a){return(c%a+a)%a}function u_(c){return Math.round(c*1e12)/1e12}function l_(c,a,e,i,s,l){var f=(0,_.size)(a),d=(0,_.indexOf)(a,c),v=0,w=s_(i,l);return(w<aE||l-w<aE)&&i<=0&&s>=0&&(v=1),1-d/(f-1)-e+v}function c_(c,a,e){var i=(0,_.size)(a),s=(0,_.indexOf)(a,c),l=1;return 1-s/(i-1)-e+l}function f_(c,a,e,i,s,l){var f=(c-1)/(l-s),d=(a-1)/(Math.max(l,i)-Math.min(e,s));return 2-Math.max(f/d,d/f)}function h_(c,a){return c>=a?2-(c-1)/(a-1):1}function d_(c,a,e,i){var s=a-c;return 1-.5*(Math.pow(a-i,2)+Math.pow(c-e,2))/Math.pow(.1*s,2)}function iE(c,a,e){var i=a-c;if(e>i){var s=(e-i)/2;return 1-Math.pow(s,2)/Math.pow(.1*i,2)}return 1}function p_(){return 1}function v_(c,a,e,i,s,l){e===void 0&&(e=5),i===void 0&&(i=!0),s===void 0&&(s=o_),l===void 0&&(l=[.25,.2,.5,.05]);var f=e<0?0:Math.round(e);if(Number.isNaN(c)||Number.isNaN(a)||typeof c!="number"||typeof a!="number"||!f)return{min:0,max:0,ticks:[]};if(a-c<1e-15||f===1)return{min:c,max:a,ticks:[c]};if(a-c>1e148){var d=e||5,v=(a-c)/d;return{min:c,max:a,ticks:Array(d).fill(null).map(function(di,hi){return Ug(c+v*hi)})}}for(var w={score:-2,lmin:0,lmax:0,lstep:0},E=1;E<Infinity;){for(var T=0;T<s.length;T+=1){var G=s[T],U=c_(G,s,E);if(l[0]*U+l[1]+l[2]+l[3]<w.score){E=Infinity;break}for(var et=2;et<Infinity;){var ct=h_(et,f);if(l[0]*U+l[1]+l[2]*ct+l[3]<w.score)break;for(var Ct=(a-c)/(et+1)/E/G,Mt=Math.ceil(Math.log10(Ct));Mt<Infinity;){var Dt=E*G*Math.pow(10,Mt),zt=iE(c,a,Dt*(et-1));if(l[0]*U+l[1]*zt+l[2]*ct+l[3]<w.score)break;var Qt=Math.floor(a/Dt)*E-(et-1)*E,Ie=Math.ceil(c/Dt)*E;if(Qt<=Ie)for(var d=Ie-Qt,je=0;je<=d;je+=1){var ze=Qt+je,mn=ze*(Dt/E),$n=mn+Dt*(et-1),Tn=Dt,or=l_(G,s,E,mn,$n,Tn),kr=d_(c,a,mn,$n),Ta=f_(et,f,c,a,mn,$n),fi=p_(),ei=l[0]*or+l[1]*kr+l[2]*Ta+l[3]*fi;ei>w.score&&(!i||mn<=c&&$n>=a)&&(w.lmin=mn,w.lmax=$n,w.lstep=Tn,w.score=ei)}Mt+=1}et+=1}}E+=1}var Ia=Ug(w.lmax),Gi=Ug(w.lmin),Ri=Ug(w.lstep),xa=Math.floor(u_((Ia-Gi)/Ri))+1,ja=new Array(xa);ja[0]=Ug(Gi);for(var T=1;T<xa;T++)ja[T]=Ug(ja[T-1]+Ri);return{min:Math.min(c,(0,_.head)(ja)),max:Math.max(a,(0,_.last)(ja)),ticks:ja}}function g_(c){var a=c.min,e=c.max,i=c.tickCount,s=c.nice,l=c.tickInterval,f=c.minLimit,d=c.maxLimit,v=v_(a,e,i,s).ticks;return!(0,_.isNil)(f)||!(0,_.isNil)(d)?Db(c,(0,_.head)(v),(0,_.last)(v)):l?kb(a,e,l).ticks:v}function m_(c){var a=c.base,e=c.tickCount,i=c.min,s=c.max,l=c.values,f,d=ap(a,s);if(i>0)f=Math.floor(ap(a,i));else{var v=Kw(l,a,s);f=Math.floor(ap(a,v))}for(var w=d-f,E=Math.ceil(w/e),T=[],G=f;G<d+E;G=G+E)T.push(Math.pow(a,G));return i<=0&&T.unshift(0),T}function oE(c,a,e){if(e===void 0&&(e=5),c===a)return{max:a,min:c,ticks:[c]};var i=e<0?0:Math.round(e);if(i===0)return{max:a,min:c,ticks:[]};var s=1.5,l=.5+1.5*s,f=a-c,d=f/i,v=Math.pow(10,Math.floor(Math.log10(d))),w=v;2*v-d<s*(d-w)&&(w=2*v,5*v-d<l*(d-w)&&(w=5*v,10*v-d<s*(d-w)&&(w=10*v)));for(var E=Math.ceil(a/w),T=Math.floor(c/w),G=Math.max(E*w,a),U=Math.min(T*w,c),et=Math.floor((G-U)/w)+1,ct=new Array(et),Ct=0;Ct<et;Ct++)ct[Ct]=Ug(U+Ct*w);return{min:U,max:G,ticks:ct}}function y_(c){var a=c.exponent,e=c.tickCount,i=Math.ceil(pg(a,c.max)),s=Math.floor(pg(a,c.min)),l=oE(s,i,e).ticks;return l.map(function(f){var d=f>=0?1:-1;return Math.pow(f,a)*d})}function b_(c,a){var e=c.length*a;return a===1?c[c.length-1]:a===0?c[0]:e%1!=0?c[Math.ceil(e)-1]:c.length%2==0?(c[e-1]+c[e])/2:c[e]}function x_(c){var a=c.tickCount,e=c.values;if(!e||!e.length)return[];for(var i=e.slice().sort(function(d,v){return d-v}),s=[],l=0;l<a;l++){var f=l/(a-1);s.push(b_(i,f))}return s}function w_(c){var a=c.min,e=c.max,i=c.tickCount,s=c.tickInterval,l=c.minLimit,f=c.maxLimit,d=oE(a,e,i).ticks;return!(0,_.isNil)(l)||!(0,_.isNil)(f)?Db(c,(0,_.head)(d),(0,_.last)(d)):s?kb(a,e,s).ticks:d}function E_(c){var a=c.min,e=c.max,i=c.minTickInterval,s=c.tickInterval,l=c.tickCount;if(s)l=Math.ceil((e-a)/s);else{s=GC(a,e,l)[1];var f=(e-a)/s,d=f/l;d>1&&(s=s*Math.ceil(d)),i&&s<i&&(s=i)}s=Math.max(Math.floor((e-a)/(Math.pow(2,12)-1)),s);for(var v=[],w=a;w<e+s;w+=s)v.push(w);return v}function S_(c){var a=Jw((0,O.__assign)({showLast:!0},c));return a}function By(c){return new Date(c).getFullYear()}function C_(c){return new Date(c,0,1).getTime()}function Ob(c){return new Date(c).getMonth()}function __(c,a){var e=By(c),i=By(a),s=Ob(c),l=Ob(a);return(i-e)*12+(l-s)%12}function I_(c,a){return new Date(c,a,1).getTime()}function T_(c,a){return Math.ceil((a-c)/Zv)}function A_(c,a){return Math.ceil((a-c)/Gg)}function M_(c,a){return Math.ceil((a-c)/(60*1e3))}function N_(c){var a=c.min,e=c.max,i=c.minTickInterval,s=c.tickCount,l=c.tickInterval,f=[];l||(l=(e-a)/s,i&&l<i&&(l=i)),l=Math.max(Math.floor((e-a)/(Math.pow(2,12)-1)),l);var d=By(a);if(l>Yw)for(var v=By(e),w=Math.ceil(l/Yw),E=d;E<=v+w;E=E+w)f.push(C_(E));else if(l>T0)for(var T=Math.ceil(l/T0),G=Ob(a),U=__(a,e),E=0;E<=U+T;E=E+T)f.push(I_(d,E+G));else if(l>Zv)for(var et=new Date(a),ct=et.getFullYear(),Ct=et.getMonth(),Mt=et.getDate(),Dt=Math.ceil(l/Zv),zt=T_(a,e),E=0;E<zt+Dt;E=E+Dt)f.push(new Date(ct,Ct,Mt+E).getTime());else if(l>Gg)for(var et=new Date(a),ct=et.getFullYear(),Ct=et.getMonth(),Dt=et.getDate(),Qt=et.getHours(),Ie=Math.ceil(l/Gg),je=A_(a,e),E=0;E<=je+Ie;E=E+Ie)f.push(new Date(ct,Ct,Dt,Qt+E).getTime());else if(l>$g)for(var ze=M_(a,e),mn=Math.ceil(l/$g),E=0;E<=ze+mn;E=E+mn)f.push(a+E*$g);else{var $n=l;$n<Mp&&($n=Mp);for(var Tn=Math.floor(a/Mp)*Mp,or=Math.ceil((e-a)/Mp),kr=Math.ceil($n/Mp),E=0;E<or+kr;E=E+kr)f.push(Tn+E*Mp)}return f.length>=512&&console.warn("Notice: current ticks length("+f.length+') >= 512, may cause performance issues, even out of memory. Because of the configure "tickInterval"(in milliseconds, current is '+l+") is too small, increase the value to solve the problem!"),f}rp("cat",Jw),rp("time-cat",S_),rp("wilkinson-extended",g_),rp("r-pretty",w_),rp("time",E_),rp("time-pretty",N_),rp("log",m_),rp("pow",y_),rp("quantile",x_),rp("d3-linear",i_),fv("cat",C0),fv("category",C0),fv("identity",n_),fv("linear",M0),fv("log",XC),fv("pow",KC),fv("time",qC),fv("timeCat",WC),fv("quantize",Ab),fv("quantile",JC);var k_=function(c,a,e){if(e||arguments.length===2)for(var i=0,s=a.length,l;i<s;i++)(l||!(i in a))&&(l||(l=Array.prototype.slice.call(a,0,i)),l[i]=a[i]);return c.concat(l||Array.prototype.slice.call(a))};function sE(c){return(0,_.map)(c,function(a,e){var i=e===0?"M":"L",s=a[0],l=a[1];return[i,s,l]})}function Rb(c){return sE(c)}function D_(c){if(c.length<=2)return Rb(c);var a=[];(0,_.each)(c,function(f){(0,_.isEqual)(f,a.slice(a.length-2))||a.push(f[0],f[1])});var e=Wn(a,!1),i=(0,_.head)(c),s=i[0],l=i[1];return e.unshift(["M",s,l]),e}function O_(c,a,e,i){i===void 0&&(i=!0);var s=new M0({values:c}),l=new C0({values:(0,_.map)(c,function(d,v){return v})}),f=(0,_.map)(c,function(d,v){return[l.scale(v)*a,e-s.scale(d)*e]});return i?D_(f):Rb(f)}function R_(c,a,e,i){i===void 0&&(i=5);for(var s=new M0({values:c}),l=new C0({values:(0,_.map)(c,function(G,U){return U})}),f=(0,_.map)(c,function(G,U){return[l.scale(U)*a,e-s.scale(G)*e]}),d=[],v=0;v<f.length;v++){var w=f[v],E={x:w[0],y:w[1],y0:e,size:i},T=F_(E);d.push.apply(d,T)}return B_(d)}function L_(c,a){var e=new M0({values:c}),i=Math.max(0,e.min);return a-e.scale(i)*a}function P_(c,a,e,i){var s=k_([],c,!0),l=L_(i,e);return s.push(["L",a,l]),s.push(["L",0,l]),s.push(["Z"]),s}function F_(c){var a=c.x,e=c.y,i=c.y0,s=c.size,l,f;(0,_.isArray)(e)?(l=e[0],f=e[1]):(l=i,f=e);var d,v;(0,_.isArray)(a)?(d=a[0],v=a[1]):(d=a-s/2,v=a+s/2);var w=[{x:d,y:l},{x:d,y:f}];return w.push({x:v,y:f},{x:v,y:l}),w}function B_(c,a){a===void 0&&(a=!0);var e=[],i=c[0];e.push(["M",i.x,i.y]);for(var s=1,l=c.length;s<l;s++)e.push(["L",c[s].x,c[s].y]);return a&&(e.push(["L",i.x,i.y]),e.push(["z"])),e}var N0=function(){return N0=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},N0.apply(this,arguments)},z_={stroke:"#C5C5C5",strokeOpacity:.85},$_={fill:"#CACED4",opacity:.85},G_=function(){function c(a){var e=a.x,i=e===void 0?0:e,s=a.y,l=s===void 0?0:s,f=a.width,d=f===void 0?200:f,v=a.height,w=v===void 0?26:v,E=a.smooth,T=E===void 0?!0:E,G=a.isArea,U=G===void 0?!1:G,et=a.data,ct=et===void 0?[]:et,Ct=a.lineStyle,Mt=a.areaStyle,Dt=a.group,zt=a.interval,Qt=zt===void 0?null:zt;this.group=Dt,this.x=i,this.y=l,this.width=d,this.height=w,this.data=ct,this.smooth=T,this.isArea=U,this.lineStyle=Object.assign({},z_,Ct),this.areaStyle=Object.assign({},$_,Mt),this.intervalConfig=Qt,this.renderLine()}return c.prototype.renderLine=function(){var a=this,e=a.x,i=a.y,s=a.width,l=a.height,f=a.barWidth,d=a.data,v=a.smooth,w=a.isArea,E=a.lineStyle,T=a.areaStyle,G=this.group.addGroup({name:"trend-group"});if(d){var U=O_(d,s,l,v);if(G.addShape("path",{attrs:N0({path:U},E),name:"trend-line"}),w){var et=P_(U,s,l,d);G.addShape("path",{attrs:N0({path:et},T),name:"trend-area"})}}this.intervalConfig&&G.addShape("path",{attrs:N0({path:R_(this.intervalConfig.data,s,l,this.intervalConfig.style.barWidth)},this.intervalConfig.style),name:"trend-interval"}),G.move(e,i)},c.prototype.destory=function(){this.group.destroy()},c}(),U_=G_,Mm=function(){return Mm=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},Mm.apply(this,arguments)},W_={fill:"#1890ff",stroke:"#1890ff",type:"trend",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#0050b3"},V_={fill:"#fff",stroke:"#1890ff",radius:2,opacity:1,cursor:"ew-resize"},zy=function(){function c(a){var e=a.group,i=a.name,s=a.type,l=a.x,f=l===void 0?0:l,d=a.y,v=d===void 0?0:d,w=a.width,E=w===void 0?2:w,T=a.height,G=T===void 0?24:T,U=a.style,et=U===void 0?{}:U;this.group=e,this.name=i,this.handleType=s,this.x=f,this.y=v,this.width=E,this.height=G,s==="trend"?this.style=Mm(Mm({},W_),et):s==="simple"&&(this.style=Mm(Mm({},V_),et)),this.renderHandle()}return c.prototype.setX=function(a){this.setXY(a,void 0)},c.prototype.setY=function(a){this.setXY(void 0,a)},c.prototype.setXY=function(a,e){(0,_.isNumber)(a)&&(this.x=a),(0,_.isNumber)(e)&&(this.y=e),this.updateXY()},c.prototype.renderHandle=function(){var a=this,e=a.width,i=a.height,s=a.style,l=a.name,f=s.fill,d=s.stroke,v=s.radius,w=s.opacity,E=s.cursor;this.handleGroup=this.group.addGroup(),this.handleType==="trend"?(this.verticalLine=this.handleGroup.addShape("rect",{attrs:{x:0,y:0,width:e,height:i,fill:f,stroke:d,radius:v,opacity:w,cursor:E},name:"".concat(l,"-handler")}),this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:e/2,y:0,r:2*e,fill:f,stroke:d,radius:v,opacity:w,cursor:E,lineAppendWidth:12},name:"".concat(l,"-handler")}),this.bottomCircle=this.handleGroup.addShape("circle",{attrs:{x:e/2,y:i,r:2*e,fill:f,stroke:d,radius:v,opacity:w,cursor:E},name:"".concat(l,"-handler")})):this.handleType==="simple"&&(this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:e/2,y:i/2,r:2*e,fill:f,stroke:d,radius:v,opacity:w,cursor:E,lineWidth:2},name:"".concat(l,"-handler")})),this.updateXY(),this.handleType==="trend"?this.bindTrendEvents():this.handleType==="simple"&&this.bindSimpleEvents()},c.prototype.bindSimpleEvents=function(){var a=this,e=this.name;this.handleGroup.on("".concat(e,"-handler:mouseenter"),function(){var i=a.style.highLightFill;a.topCircle.attr("fill",i)}),this.handleGroup.on("".concat(e,"-handler:mouseleave"),function(){var i=a.style.fill;a.topCircle.attr("fill",i)})},c.prototype.bindTrendEvents=function(){var a=this,e=this.name;this.handleGroup.on("".concat(e,"-handler:mouseenter"),function(){var i=a.style.highLightFill;a.verticalLine.attr("fill",i),a.topCircle.attr("fill",i),a.bottomCircle.attr("fill",i)}),this.handleGroup.on("".concat(e,"-handler:mouseleave"),function(){var i=a.style.fill;a.verticalLine.attr("fill",i),a.topCircle.attr("fill",i),a.bottomCircle.attr("fill",i)})},c.prototype.show=function(){this.handleGroup.show()},c.prototype.hide=function(){this.handleGroup.hide()},c.prototype.updateXY=function(){this.handleGroup.setMatrix([1,0,0,0,1,0,this.x,this.y,1])},c}(),Qc=zy,Ql=function(){return Ql=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},Ql.apply(this,arguments)},Np=ie,hv={fill:"#416180",opacity:.05},ip={fill:"#416180",opacity:.15,radius:5},Yr={fill:"#5B8FF9",opacity:.3,cursor:"grab"},Fs=2,Lb={width:Fs,height:24},uE={textBaseline:"middle",fill:"#000",opacity:.45},Wg={textAlign:"center",textBaseline:"top",fill:"#607889",opacity:.35},_d={lineWidth:1,stroke:"#ccc"},lE=function(){function c(a){var e=this;this.prevX=0,this.onMouseDown=function(di){return function(hi){e.currentHandler=di;var qi=hi.originalEvent;qi.stopPropagation(),qi.preventDefault(),e.prevX=(0,_.get)(qi,"touches.0.pageX",qi.pageX);var fo=e.canvas.get("container");fo.addEventListener("mousemove",e.onMouseMove),fo.addEventListener("mouseup",e.onMouseUp),fo.addEventListener("mouseleave",e.onMouseUp),fo.addEventListener("touchmove",e.onMouseMove),fo.addEventListener("touchend",e.onMouseUp),fo.addEventListener("touchcancel",e.onMouseUp)}},this.onMouseMove=function(di){di.stopPropagation(),di.preventDefault();var hi=(0,_.get)(di,"touches.0.pageX",di.pageX),qi=hi-e.prevX,fo=e.adjustOffsetRange(qi/e.width);e.updateStartEnd(fo),e.updateUI(),e.prevX=hi},this.onMouseUp=function(){e.currentHandler&&(e.currentHandler=void 0);var di=e.canvas.get("container");di&&(di.removeEventListener("mousemove",e.onMouseMove),di.removeEventListener("mouseup",e.onMouseUp),di.removeEventListener("mouseleave",e.onMouseUp),di.removeEventListener("touchmove",e.onMouseMove),di.removeEventListener("touchend",e.onMouseUp),di.removeEventListener("touchcancel",e.onMouseUp))};var i=a.x,s=i===void 0?0:i,l=a.y,f=l===void 0?0:l,d=a.width,v=d===void 0?100:d,w=a.height,E=a.padding,T=E===void 0?10:E,G=a.trendCfg,U=a.controllerCfg,et=U===void 0?{speed:1}:U,ct=a.backgroundStyle,Ct=ct===void 0?{}:ct,Mt=a.foregroundStyle,Dt=Mt===void 0?{}:Mt,zt=a.handlerStyle,Qt=zt===void 0?{}:zt,Ie=a.textStyle,je=Ie===void 0?{}:Ie,ze=a.start,mn=ze===void 0?0:ze,$n=a.end,Tn=$n===void 0?1:$n,or=a.minText,kr=or===void 0?"":or,Ta=a.maxText,fi=Ta===void 0?"":Ta,ei=a.group,Ia=a.graph,Gi=a.canvas,Ri=a.tick,xa=Ri===void 0?{tickLabelStyle:{},tickLineStyle:{},tickLabelFormatter:function(hi){return hi},ticks:[]}:Ri,ja=a.type;this.graph=Ia,this.canvas=Gi,this.group=ei,this.timeBarType=ja,this.x=s,this.y=f,this.width=v,this.height=w,this.padding=T,this.ticks=xa.ticks,this.trendCfg=G,this.controllerCfg=et,this.currentSpeed=et.speed||1,this.tickLabelFormatter=xa.tickLabelFormatter,ja==="trend"?this.backgroundStyle=Ql(Ql({},hv),Ct):ja==="simple"&&(this.backgroundStyle=Ql(Ql({},ip),Ct)),this.foregroundStyle=Ql(Ql({},Yr),Dt),this.handlerStyle=Ql(Ql({},Lb),Qt),this.textStyle=Ql(Ql({},uE),je),this.tickLabelStyle=Ql(Ql({},Wg),xa.tickLabelStyle),this.tickLineStyle=Ql(Ql({},_d),xa.tickLineStyle),this.currentMode=et.defaultTimeType||np.RANGE,this.start=mn,this.end=Tn,this.minText=kr,this.maxText=fi,this.fontFamily=typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlider()}return c.prototype.update=function(a){var e=a.x,i=a.y,s=a.width,l=a.height,f=a.minText,d=a.maxText,v=a.start,w=a.end;this.start=Math.min(1,Math.max(v,0)),this.end=Math.min(1,Math.max(w,0)),(0,_.assign)(this,{x:e,y:i,width:s,height:l,minText:f,maxText:d}),this.updateUI()},c.prototype.setText=function(a,e){this.minTextShape.attr("text",a),this.maxTextShape.attr("text",e)},c.prototype.renderSlider=function(){var a=this,e=this,i=e.width,s=e.height,l=e.timeBarType;if(l==="trend"&&(0,_.size)((0,_.get)(this.trendCfg,"data"))){var f=new U_(Ql(Ql({x:this.x,y:this.y,width:i,height:s},this.trendCfg),{group:this.group}));this.trendComponent=f}var d=this.group.addGroup({name:"slider-group"});d.addShape("rect",{attrs:Ql({x:0,y:0,width:i,height:s},this.backgroundStyle),name:"background"});var v=this.group.addGroup();l==="trend"?(this.minTextShape=v.addShape("text",{attrs:Ql({x:0,y:s/2+this.y,textAlign:"right",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"min-text-shape"}),this.maxTextShape=v.addShape("text",{attrs:Ql({y:s/2+this.y,textAlign:"left",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"max-text-shape"})):(this.minTextShape=v.addShape("text",{attrs:Ql({x:0,y:this.y-10,textAlign:"center",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"min-text-shape"}),this.maxTextShape=v.addShape("text",{attrs:Ql({y:this.y-10,textAlign:"center",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"max-text-shape"})),this.foregroundShape=this.group.addGroup().addShape("rect",{attrs:Ql({x:0,y:this.y,height:s},this.foregroundStyle),name:"foreground-shape"}),this.foregroundShape.on("mousedown",function(Mt){Mt.target.attr("cursor","grabbing")}),this.foregroundShape.on("mouseup",function(Mt){Mt.target.attr("cursor",a.foregroundStyle.cursor||"grab")});var w=(0,_.get)(this.handlerStyle,"width",2),E=(0,_.get)(this.handlerStyle,"height",24),T=this.group.addGroup({name:"minHandlerShape"});this.minHandlerShape=new Qc({name:"minHandlerShape",group:T,type:l,x:this.x,y:this.y,width:w,height:E,style:this.handlerStyle});var G=this.group.addGroup({name:"maxHandlerShape"});this.maxHandlerShape=new Qc({name:"maxHandlerShape",group:G,type:l,x:this.x,y:this.y,width:w,height:E,style:this.handlerStyle});var U=this.ticks,et=i/(U.length-1);this.tickPosList=[],this.textList&&this.textList.length&&this.textList.forEach(function(Mt){Mt.destroy()});var ct=-Infinity,Ct=this.tickLabelStyle.rotate;delete this.tickLabelStyle.rotate,this.textList=U.map(function(Mt,Dt){a.tickPosList.push(a.x+Dt*et);var zt;a.tickLabelFormatter?(zt=a.tickLabelFormatter(Mt),!(0,_.isString)(zt)&&zt&&(zt=Mt.date)):zt=Mt.date;var Qt=a.x+Dt*et,Ie=a.y+s+5,je=a.group.addShape("text",{attrs:Ql({x:Qt,y:Ie,text:zt,fontFamily:a.fontFamily||"Arial, sans-serif"},a.tickLabelStyle),name:"tick-label"});if((0,_.isNumber)(Ct)&&Dt!==U.length-1){var ze=Np([1,0,0,0,1,0,0,0,1],[["t",-Qt,-Ie],["r",Ct],["t",Qt-5,Ie+2]]);je.attr({textAlign:"left",matrix:ze})}Dt===0?je.attr({textAlign:"left"}):Dt!==U.length-1&&je.attr({textAlign:"right"});var mn=a.group.addShape("line",{attrs:Ql({x1:a.x+Dt*et,y1:a.y+s+2,x2:a.x+Dt*et,y2:a.y+s+6},a.tickLineStyle),name:"tick-line"});mn.toBack();var $n=je.getBBox();return $n.minX>ct?(je.show(),mn.show(),ct=$n.minX+$n.width+10):(je.hide(),mn.hide()),je}),this.controllerBtnGroup=new Im(Ql({group:this.group,x:this.x,y:this.y+s+25,width:i,height:35},this.controllerCfg)),this.updateStartEnd(0),this.updateUI(),d.move(this.x,this.y),this.bindEvents(),this.currentMode===np.SINGLE&&(this.minHandlerShape.hide(),this.foregroundShape.hide(),this.minTextShape.hide())},c.prototype.bindEvents=function(){var a=this,e=this.group.find(function(s){return s.get("name")==="minHandlerShape"});e&&(e.on("minHandlerShape-handler:mousedown",this.onMouseDown(this.minHandlerShape)),e.on("minHandlerShape-handler:touchstart",this.onMouseDown(this.minHandlerShape)));var i=this.group.find(function(s){return s.get("name")==="maxHandlerShape"});i&&(i.on("maxHandlerShape-handler:mousedown",this.onMouseDown(this.maxHandlerShape)),i.on("maxHandlerShape-handler:touchstart",this.onMouseDown(this.maxHandlerShape))),this.foregroundShape.on("mousedown",this.onMouseDown(this.foregroundShape)),this.foregroundShape.on("touchstart",this.onMouseDown(this.foregroundShape)),this.group.on("".concat(dg,":click"),function(){a.isPlay=!a.isPlay,a.currentHandler=a.maxHandlerShape,a.changePlayStatus()}),this.group.on("".concat(y0,":click"),function(){a.currentHandler=a.maxHandlerShape,a.updateStartEnd(.01),a.updateUI()}),this.group.on("".concat(b0,":click"),function(){a.currentHandler=a.maxHandlerShape,a.updateStartEnd(-.01),a.updateUI()}),this.group.on(Fg,function(s){var l=s.type,f=s.speed;a.currentSpeed=f,a.currentMode=l,l===np.SINGLE?(a.minHandlerShape.hide(),a.foregroundShape.hide(),a.minTextShape.hide()):l===np.RANGE&&(a.minHandlerShape.show(),a.foregroundShape.show(),a.minTextShape.show())})},c.prototype.adjustTickIndex=function(a){for(var e=0;e<this.tickPosList.length-1;e++)if(this.tickPosList[e]<=a&&a<=this.tickPosList[e+1])return Math.abs(this.tickPosList[e]-a)<Math.abs(a-this.tickPosList[e+1])?e:e+1;return 0},c.prototype.adjustOffsetRange=function(a){switch(this.currentHandler){case this.minHandlerShape:{var e=0-this.start,i=1-this.start;return Math.min(i,Math.max(e,a))}case this.maxHandlerShape:{var e=0-this.end,i=1-this.end;return Math.min(i,Math.max(e,a))}case this.foregroundShape:{var e=0-this.start,i=1-this.end;return Math.min(i,Math.max(e,a))}default:return 0}},c.prototype.updateStartEnd=function(a){var e=this.ticks[this.adjustTickIndex(this.start*this.width)],i=this.ticks[this.adjustTickIndex(this.end*this.width)];if(!this.currentHandler){this.minText=this.tickLabelFormatter?this.tickLabelFormatter(e):e==null?void 0:e.date,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(i):i==null?void 0:i.date;return}switch(this.currentHandler){case this.minHandlerShape:this.maxText=this.maxTextShape.attr("text"),this.start+=a,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(e):e.date;break;case this.maxHandlerShape:this.minText=this.minTextShape.attr("text"),this.end+=a,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(i):i.date;break;case this.foregroundShape:this.start+=a,this.end+=a,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(e):e.date,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(i):i.date;break;default:break}},c.prototype.updateUI=function(){var a=this;this.start<0&&(this.start=0),this.end>1&&(this.end=1);var e=this.x+this.start*this.width,i=this.x+this.end*this.width;this.foregroundShape.attr("x",e),this.foregroundShape.attr("width",i-e);var s=(0,_.get)(this.handlerStyle,"width",Fs);this.setText(this.minText,this.maxText);var l=this.dodgeText([e,i]),f=l[0],d=l[1];this.minHandlerShape.setX(e-s/2),(0,_.each)(f,function(v,w){return a.minTextShape.attr(w,v)}),this.maxHandlerShape.setX(i-s/2),(0,_.each)(d,function(v,w){return a.maxTextShape.attr(w,v)}),this.currentMode===np.RANGE?this.graph.emit(lv,{value:[this.start,this.end].sort()}):this.currentMode===np.SINGLE&&this.graph.emit(lv,{value:[this.end,this.end]})},c.prototype.dodgeText=function(a){var e,i,s=2,l=(0,_.get)(this.handlerStyle,"width",Fs),f=this.minTextShape,d=this.maxTextShape,v=a[0],w=a[1],E=!1;v>w&&(e=[w,v],v=e[0],w=e[1],i=[d,f],f=i[0],d=i[1],E=!0);var T=f.getBBox(),G=d.getBBox(),U=null,et=null;return this.timeBarType==="trend"?(U=v-T.width<this.x+s?{x:v+l/2+s,textAlign:"left"}:{x:v-l/2-s,textAlign:"right"},et=w+G.width>this.x+this.width?{x:w-l/2-s,textAlign:"right"}:{x:w+l/2+s,textAlign:"left"}):this.timeBarType==="simple"&&(U=f.attr("x")>T.width?{x:v,textAlign:"center"}:{x:v,textAlign:"left"},et=d.attr("x")>this.width-G.width?{x:w,textAlign:"right"}:{x:w,textAlign:"center"}),E?[et,U]:[U,et]},c.prototype.startPlay=function(){var a=this;return typeof window!="undefined"?window.requestAnimationFrame(function(){var e=a,i=e.ticks,s=e.width,l=a.currentSpeed,f=s/i.length,d=f/((10-l)*1e3/60),v=a.adjustOffsetRange(d/a.width);a.updateStartEnd(v),a.updateUI(),a.isPlay&&(a.playHandler=a.startPlay())}):void 0},c.prototype.changePlayStatus=function(a){a===void 0&&(a=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit(Dw,null)):this.playHandler&&(typeof window!="undefined"&&window.cancelAnimationFrame(this.playHandler),a&&this.graph.emit(Ow,null))},c.prototype.destory=function(){this.graph.off(lv,function(){});var a=this.group,e=a.find(function(s){return s.get("name")==="minHandlerShape"});e&&(e.off("minHandlerShape-handler:mousedown"),e.off("minHandlerShape-handler:touchstart"),e.destroy());var i=a.find(function(s){return s.get("name")==="maxHandlerShape"});i&&(i.off("maxHandlerShape-handler:mousedown"),i.off("maxHandlerShape-handler:touchstart"),i.destroy()),this.foregroundShape.off("mousedown"),this.foregroundShape.off("touchstart"),this.foregroundShape.destroy(),a.off("".concat(dg,":click")),a.off("".concat(y0,":click")),a.off("".concat(b0,":click")),a.off(Fg),a.destroy(),this.trendComponent&&this.trendComponent.destory()},c}(),Fh=lE,Xl=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),vg=function(){return vg=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},vg.apply(this,arguments)},qv=function(c,a){var e={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&a.indexOf(i)<0&&(e[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(c);s<i.length;s++)a.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(c,i[s])&&(e[i[s]]=c[i[s]]);return e},Vg=4,op=26,Pb=function(c){Xl(a,c);function a(e){var i=c.call(this,e)||this;return i.afterrenderListener=function(s){return i.filterData({})},i.valueChangeListener=(0,_.throttle)(function(s){return i.filterData(s)},200,{trailing:!0,leading:!0}),i.changeData=function(s){var l=i.get("graph");i.cacheGraphData=l.get("data"),i.filterData({})},i}return a.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-component-timebar",padding:10,type:"trend",trend:{data:[],isArea:!1,smooth:!0},controllerCfg:{speed:1,loop:!1},slider:{start:.1,end:.9,minText:"min",maxText:"max"},tick:{start:.1,end:.9,data:[]},textStyle:{},filterEdge:!1,filterItemTypes:["node"],containerCSS:{},putInGraphContainer:!0}},a.prototype.initContainer=function(){var e=this.get("graph"),i=this._cfgs,s=i.width,l=i.height,f=i.putInGraphContainer,d=this.get("className")||"g6-component-timebar",v=this.get("container"),w;if(v?((0,_.isString)(v)&&(v=document.getElementById(v)),w=v):(w=Hl("<div class='".concat(d,"'></div>")),Ps(w,{position:"relative"})),f){var E=this.get("graph").get("container");E.appendChild(w)}this.set("timeBarContainer",w);var T,G=e.get("renderer");G==="SVG"?T=new Ff({container:w,width:s,height:l}):T=new Gv({container:w,width:s,height:l}),this.get("containerCSS")&&Ps(w,this.get("containerCSS")),this.set("canvas",T)},a.prototype.init=function(){this.initContainer();var e=this.get("canvas"),i=e.addGroup({name:"timebar-group"});this.set("timeBarGroup",i),this.renderTrend(),this.initEvent();var s=typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif";this.set("fontFamily",s)},a.prototype.play=function(){this.togglePlay(!0)},a.prototype.pause=function(){this.togglePlay(!1)},a.prototype.togglePlay=function(e){var i=this.get("timebar");!i||(i.isPlay=!!e,i.changePlayStatus())},a.prototype.renderTrend=function(){var e=this,i=this._cfgs,s=i.width,l=i.x,f=i.y,d=i.padding,v=i.type,w=i.trend,E=i.slider,T=i.controllerCfg,G=i.textStyle,U=i.tick,et=i.backgroundStyle,ct=i.foregroundStyle,Ct=w.data,Mt=qv(w,["data"]),Dt=s-2*d,zt=v==="trend"?op:Vg,Qt=this.get("graph"),Ie=this.get("timeBarGroup"),je=this.get("canvas"),ze=null;if(v==="trend"||v==="simple"){var mn=this.get("getValue");ze=new Fh(vg(vg({graph:Qt,canvas:je,group:Ie,type:v,x:l+d,y:v==="trend"?f+d:f+d+15,width:Dt,height:zt,padding:d,backgroundStyle:et,foregroundStyle:ct,trendCfg:vg(vg({},Mt),{data:Ct.map(function(Tn){return(mn==null?void 0:mn(Tn))||Tn.value})})},E),{tick:{ticks:Ct,tickLabelFormatter:U.tickLabelFormatter,tickLabelStyle:U.tickLabelStyle,tickLineStyle:U.tickLineStyle},handlerStyle:vg(vg({},E.handlerStyle),{height:E.height||zt}),controllerCfg:T,textStyle:G}))}else v==="tick"&&(ze=new xb(vg({graph:Qt,canvas:je,group:Ie,x:l+d,y:f+d,width:s,height:42,padding:2,controllerCfg:T},U)));var $n=function Tn(){var or=e.get("timebar");or.draggingHandler=!1,or.isPlay&&(or.isPlay=!1,or.currentHandler=or.maxHandlerShape,or.changePlayStatus()),document.removeEventListener("mouseup",Tn)};je.on("mousedown",function(Tn){(Tn.target.get("name")==="maxHandlerShape-handler"||Tn.target.get("name")==="minHandlerShape-handler"||Tn.target===ze.foregroundShape)&&document.addEventListener("mouseup",$n)}),this.set("timebar",ze)},a.prototype.filterData=function(e){var i,s=e.value;if(!s){s=[];var l=this._cfgs.type;!l||l==="trend"||l==="simple"?(s[0]=this._cfgs.slider.start,s[1]=this._cfgs.slider.end):l==="tick"&&(s[0]=this._cfgs.tick.start,s[1]=this._cfgs.tick.end)}var f=null,d=this._cfgs.type;if(d==="trend"||d==="simple"?f=this._cfgs.trend.data:d==="tick"&&(f=this._cfgs.tick.data),!f||f.length===0){console.warn("\u8BF7\u914D\u7F6E TimeBar \u7EC4\u4EF6\u7684\u6570\u636E");return}var v=this.get("rangeChange"),w=this.get("graph"),E=Math.round(f.length*s[0]),T=Math.round(f.length*s[1]);T=T>=f.length?f.length-1:T,E=E>=f.length?f.length-1:E;var G=(i=this._cfgs.tick)===null||i===void 0?void 0:i.tickLabelFormatter,U=G?G(f[E]):f[E].date,et=G?G(f[T]):f[T].date;if(d!=="tick"){var ct=this.get("timebar");ct.setText(U,et)}if(v)v(w,U,et);else{(!this.cacheGraphData||this.cacheGraphData.nodes&&this.cacheGraphData.nodes.length===0)&&(this.cacheGraphData=w.get("data"));var Ct=this.get("filterItemTypes"),Mt=this.get("changeData"),Dt=this.get("getDate"),zt=this.get("shouldIgnore"),Qt=f[E].date,Ie=f[T].date;if(Mt||Mt===void 0){var je=this.cacheGraphData.nodes,ze=this.cacheGraphData.edges,mn={},$n={};w.getNodes().forEach(function(Tn){return mn[Tn.getID()]=!0}),w.getEdges().forEach(function(Tn){return $n[Tn.getID()]=!0}),Ct.includes("node")&&(je==null||je.forEach(function(Tn){var or=+((Dt==null?void 0:Dt(Tn))||Tn.date),kr=or>=Qt&&or<=Ie||(zt==null?void 0:zt("node",Tn,{min:Qt,max:Ie})),Ta=mn[Tn.id];Ta&&!kr?(w.removeItem(Tn.id),mn[Tn.id]=!1):!Ta&&kr&&(w.addItem("node",Tn),mn[Tn.id]=!0)}),ze==null||ze.forEach(function(Tn){var or=mn[Tn.source]&&mn[Tn.target]||(zt==null?void 0:zt("edge",Tn,{min:Qt,max:Ie})),kr=!!w.findById(Tn.id);kr&&!or?(w.removeItem(Tn.id),$n[Tn.id]=!1):!kr&&or?(w.addItem("edge",Tn),$n[Tn.id]=!0):kr||($n[Tn.id]=!1)})),(this.get("filterEdge")||Ct.includes("edge"))&&(ze==null||ze.filter(function(Tn){var or=+((Dt==null?void 0:Dt(Tn))||Tn.date),kr=or>=Qt&&or<=Ie||(zt==null?void 0:zt("edge",Tn,{min:Qt,max:Ie})),Ta=mn[Tn.source]&&mn[Tn.target],fi=kr&&Ta,ei=$n[Tn.id];ei&&!fi?($n[Tn.id]=!1,w.removeItem(Tn.id)):!ei&&fi&&($n[Tn.id]=!0,w.addItem("edge",Tn))}))}else Ct.includes("node")&&w.getNodes().forEach(function(Tn){var or=Tn.getModel();if(!(zt==null?void 0:zt("node",or,{min:Qt,max:Ie}))){var kr=+((Dt==null?void 0:Dt(or))||or.date);kr<Qt||kr>Ie?w.hideItem(Tn):w.showItem(Tn)}}),(this.get("filterEdge")||Ct.includes("edge"))&&w.getEdges().forEach(function(Tn){var or=Tn.getModel();if(!(zt==null?void 0:zt("edge",or,{min:f[E].date,max:f[T].date}))){var kr=+((Dt==null?void 0:Dt(or))||or.date);if(kr<f[E].date||kr>f[T].date)w.hideItem(Tn);else{var Ta=Tn.getSource().isVisible(),fi=Tn.getTarget().isVisible();Ta&&fi&&w.showItem(Tn)}}})}},a.prototype.initEvent=function(){var e=this.get("graph");e.on("afterchangedata",this.changeData),e.on("afterrender",this.afterrenderListener),e.on(lv,this.valueChangeListener)},a.prototype.destroy=function(){var e=this.get("graph");e.off("afterchangedata",this.changeData),e.off("afterrender",this.afterrenderListener),e.off(lv,this.valueChangeListener);var i=this.get("timebar");i&&i.destory&&i.destory(),c.prototype.destroy.call(this);var s=this.get("timeBarContainer");if(s){var l=this.get("container");l||(l=this.get("graph").get("container")),(0,_.isString)(l)&&(l=document.getElementById(l)),l===s&&(l=l.parentElement),l.removeChild(s)}},a}(rd),Fb=Pb,k0=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),j_=Zf.applyMatrix;function $y(c,a){var e,i;if(c.naturalWidth)e=c.naturalWidth,i=c.naturalHeight;else{var s=new Image;s.src=c.src,s.onload=function(){a&&a(s.width,s.height)}}return[e,i]}var PA=function(c){k0(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",width:200,delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0}},a.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},a.prototype.disableRefresh=function(){this.set("refresh",!1)},a.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},a.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},a.prototype.initViewport=function(){var e=this,i=this._cfgs,s=i.graph;if(!this.destroyed){var l=this.get("container");(0,_.isString)(l)&&(l=document.getElementById(l));var f=Hl("<div class=".concat(i.viewportClassName,`
      style='position:absolute;
        left:0;
        top:0;
        box-sizing:border-box;
        border: 2px solid #1980ff;
        cursor:move'
      </div>`)),d=0,v=0,w=!1,E=0,T=0,G=0,U=0,et=0,ct=0;l.addEventListener("mousedown",function(Ct){if(i.refresh=!1,Ct.target===f){var Mt=f.style;G=parseInt(Mt.width,10),U=parseInt(Mt.height,10);var Dt=e.get("width"),zt=e.get("height");G>Dt||U>zt||(ct=s.getZoom(),et=e.get("ratio"),w=!0,d=Ct.clientX,v=Ct.clientY)}},!1),l.addEventListener("mousemove",function(Ct){if(!(!w||(0,_.isNil)(Ct.clientX)||(0,_.isNil)(Ct.clientY))){var Mt=e.get("width"),Dt=e.get("height"),zt=f.style;E=parseInt(zt.left,10),T=parseInt(zt.top,10),G=parseInt(zt.width,10),U=parseInt(zt.height,10);var Qt=d-Ct.clientX,Ie=v-Ct.clientY;E-Qt<0?Qt=E:E-Qt+G>=Mt&&(Qt=0),T-Ie<0?Ie=T:T-Ie+U>=Dt&&(Ie=0),E-=Qt,T-=Ie,Ps(f,{left:"".concat(E,"px"),top:"".concat(T,"px")}),s.translate(Qt*ct/et,Ie*ct/et),d=Ct.clientX,v=Ct.clientY}},!1),l.addEventListener("mouseleave",function(){w=!1,i.refresh=!0},!1),l.addEventListener("mouseup",function(){w=!1,i.refresh=!0},!1),this.set("viewport",f),l.appendChild(f)}},a.prototype.updateViewport=function(){if(!this.destroyed){var e=this.get("ratio"),i=this.get("width"),s=this.get("height"),l=this.get("graph"),f=l.get("width"),d=l.get("height"),v=f/d,w=l.getGroup(),E=w.getCanvasBBox(),T=[(E.minX+E.maxX)/2,(E.minY+E.maxY)/2],G=[E.maxX-E.minX,E.maxY-E.minY],U={centerX:T[0],centerY:T[1],width:0,height:0,minX:0,minY:0};E[0]/E[1]>v?(U.width=G[0],U.height=U.width/v):(U.height=G[1],U.width=U.height*v),U.minX=T[0]-U.width/2,U.minY=T[1]-U.height/2;var et=w.getMatrix();et||(et=[1,0,0,0,1,0,0,0,1]);var ct=ot.invert([1,0,0,0,1,0,0,0,1],et),Ct=j_({x:U.minX,y:U.minY},ct),Mt=l.getCanvasByPoint(Ct.x,Ct.y),Dt=this.get("viewport");Dt||this.initViewport();var zt=f/U.width,Qt=zt*i,Ie=zt*s,je=i*-Mt.x/U.width,ze=s*-Mt.y/U.height,mn=je+Qt,$n=ze+Ie;je<0&&(Qt+=je,je=0),mn>i&&(Qt=Qt-(mn-i)),ze<0&&(Ie+=ze,ze=0),$n>s&&(Ie=Ie-($n-s)),this.set("ratio",e);var Tn="".concat(je,"px"),or="".concat(ze,"px");Ps(Dt,{left:Tn,top:or,width:"".concat(Qt,"px"),height:"".concat(Ie,"px")})}},a.prototype.init=function(){this.initContainer()},a.prototype.initContainer=function(){var e=this,i=e.get("graph"),s=i.get("width"),l=i.get("height"),f=l/s,d=e.get("className"),v=e.get("container"),w=e.get("width"),E=e.get("height");!w&&!E&&(w=200),w?(E=f*w,e.set("height",E)):(w=1/f*E,e.set("width",w));var T=Hl("<div class='".concat(d,"' style='width: ").concat(w,"px; height: ").concat(E,"px; overflow: hidden; position: relative;'></div>"));(0,_.isString)(v)&&(v=document.getElementById(v)),v?v.appendChild(T):i.get("container").appendChild(T),e.set("container",T);var G=Hl('<div class="g6-minimap-container" style="position: relative; width: 100%; height: 100%; text-align: center; display: table;"></div>');T.appendChild(G);var U=Hl('<span style="display: table-cell; vertical-align: middle; "></span>');G.appendChild(U),e.set("containerDOM",G),e.set("containerSpan",U);var et=Hl('<img alt="" src="'.concat(this.get("graphImg"),'" style="display: inline-block; user-select: none;" draggable="false" />'));e.set("imgDOM",et),e.updateImgSize(),U.appendChild(et),e.updateCanvas()},a.prototype.updateImgSize=function(){var e=this,i=e.get("imgDOM"),s=e.get("width"),l=e.get("height");i.onload=function(){var f=$y(i);f[0]>f[1]?i.width=s:i.height=l}},a.prototype.updateCanvas=function(){var e=this.get("refresh");if(!!e){var i=this.get("graph");if(!i.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var s=this.get("width"),l=i.get("canvas").getCanvasBBox(),f=l.width,d=s/f;this.set("ratio",d),this.updateViewport()}}},a.prototype.getViewport=function(){return this.get("viewport")},a.prototype.getContainer=function(){return this.get("container")},a.prototype.updateGraphImg=function(e){var i=this,s=i.get("imgDOM");s.remove(),i.set("graphImg",e);var l=Hl('<img alt="" src="'.concat(e,'" style="display: inline-block;" ondragstart="return false;" onselectstart="return false;"/>'));i.set("imgDOM",l),l.src=e,i.updateImgSize();var f=i.get("containerSpan");f.appendChild(l),i.updateCanvas()},a.prototype.destroy=function(){var e=this.get("container");e.parentNode.removeChild(e)},a}(rd),FA=PA,gg=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Bb=function(){return Bb=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},Bb.apply(this,arguments)},jg=Zf.distance,Gy=.05,cf={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:1,fill:"#fff"},cE=function(c){gg(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{type:"both",trigger:"mousemove",r:60,delegateStyle:(0,_.clone)(cf),showLabel:"edge",scaleRBy:"wheel"}},a.prototype.getEvents=function(){var e;switch(this.get("trigger")){case"click":e={click:"filter"};break;case"drag":e={click:"createDelegate"};break;default:e={mousemove:"filter"};break}return e},a.prototype.init=function(){var e=this,i=e.get("showLabel"),s=i==="node"||i==="both",l=i==="edge"||i==="both";e.set("showNodeLabel",s),e.set("showEdgeLabel",l);var f=e.get("shouldShow");f||e.set("shouldShow",function(){return!0})},a.prototype.createDelegate=function(e){var i=this,s=i.get("delegate");(!s||s.destroyed)&&(i.filter(e),s=i.get("delegate"),s.on("dragstart",function(l){}),s.on("drag",function(l){i.filter(l)}),this.get("scaleRBy")==="wheel"&&s.on("mousewheel",function(l){i.scaleRByWheel(l)}))},a.prototype.scaleRByWheel=function(e){var i=this;if(!(!e||!e.originalEvent)){e.preventDefault&&e.preventDefault();var s=i.get("graph"),l,f=i.get("delegate"),d=f?{x:f.attr("x"),y:f.attr("y")}:void 0,v=d||s.getPointByClient(e.clientX,e.clientY);e.originalEvent.wheelDelta<0?l=1-Gy:l=1/(1-Gy);var w=i.get("maxR"),E=i.get("minR"),T=i.get("r");(T>(w||s.get("height"))&&l>1||T<(E||s.get("height")*.05)&&l<1)&&(l=1),T*=l,i.set("r",T),i.filter(e)}},a.prototype.filter=function(e){var i=this,s=i.get("graph"),l=s.getNodes(),f={},d=i.get("r"),v=i.get("type"),w={x:e.x,y:e.y};i.updateDelegate(w,d);var E=i.get("shouldShow"),T=i.get("vShapes");T&&T.forEach(function(Mt){Mt.remove(),Mt.destroy()}),T=[],l.forEach(function(Mt){var Dt=Mt.getModel(),zt=Dt.x,Qt=Dt.y;jg({x:zt,y:Qt},w)<d&&(f[Dt.id]=Mt)});var G=s.getEdges(),U=[];G.forEach(function(Mt){var Dt=Mt.getModel(),zt=Dt.source,Qt=Dt.target;E(Dt)&&(v==="only-source"||v==="one"?f[zt]&&!f[Qt]&&U.push(Mt):v==="only-target"||v==="one"?f[Qt]&&!f[zt]&&U.push(Mt):v==="both"&&f[zt]&&f[Qt]&&U.push(Mt))});var et=i.get("showNodeLabel"),ct=i.get("showEdgelabel"),Ct=s.get("group");U.forEach(function(Mt){var Dt=Mt.get("group").get("children");Dt.forEach(function(zt){var Qt=zt.get("type"),Ie=Ct.addShape(Qt,{attrs:zt.attr()});T.push(Ie),et&&Qt==="text"&&Ie.set("visible",!0)})}),Object.keys(f).forEach(function(Mt){var Dt=f[Mt],zt=Dt.get("group").clone();if(Ct.add(zt),T.push(zt),ct)for(var Qt=zt.get("children"),Ie=0;Ie<Qt.length;Ie++){var je=Qt[Ie];je.get("type")==="text"&&je.set("visible",!0)}}),i.set("vShapes",T)},a.prototype.updateParams=function(e){var i=this,s=e.r,l=e.trigger,f=e.minR,d=e.maxR,v=e.scaleRBy,w=e.showLabel,E=e.shouldShow;if(isNaN(e.r)||i.set("r",s),isNaN(d)||i.set("maxR",d),isNaN(f)||i.set("minR",f),(l==="mousemove"||l==="click")&&i.set("trigger",l),v==="wheel"||v==="unset"){i.set("scaleRBy",v),i.get("delegate").remove(),i.get("delegate").destroy();var T=i.get("dPercentText");T&&(T.remove(),T.destroy())}(w==="node"||w==="both")&&i.set("showNodeLabel",!0),(w==="edge"||w==="both")&&i.set("showEdgeLabel",!0),E&&i.set("shouldShow",E)},a.prototype.updateDelegate=function(e,i){var s=this,l=s.get("graph"),f=s.get("delegate");if(!f||f.destroyed){var d=l.get("group"),v=s.get("delegateStyle")||cf;f=d.addShape("circle",{attrs:Bb({r:i,x:e.x,y:e.y},v),name:"lens-shape",draggable:!0}),this.get("trigger")!=="drag"&&this.get("scaleRBy")==="wheel"&&f.on("mousewheel",function(w){s.scaleRByWheel(w)})}else f.attr({x:e.x,y:e.y,r:i});s.set("delegate",f)},a.prototype.clear=function(){var e=this,i=e.get("vShapes");i&&i.forEach(function(l){l.remove(),l.destroy()}),i=[],e.set("vShapes",i);var s=e.get("delegate");s&&!s.destroyed&&(s.remove(),s.destroy())},a.prototype.destroy=function(){this.clear()},a}(rd),H_=cE,fE=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),BA=Zf.pointLineDistance,zb={stroke:"#FA8C16",lineWidth:1},D0=function(c){fE(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{line:zb,itemAlignType:"center",tolerance:5,horizontalLines:{},verticalLines:{},alignLines:[]}},a.prototype.init=function(){},a.prototype.getEvents=function(){return{"node:dragstart":"onDragStart","node:drag":"onDrag","node:dragend":"onDragEnd"}},a.prototype.onDragStart=function(){this.initBoxLine()},a.prototype.onDrag=function(e){var i=e.item,s=i.get("delegateShape")||i,l=s.getBBox(),f=i.getModel(),d=f.x-l.x,v=f.y-l.y;this.show({x:l.minX+d,y:l.minY+v},{width:l.width,height:l.height})},a.prototype.onDragEnd=function(){this.destory()},a.prototype.initBoxLine=function(){var e=this._cfgs,i=e.horizontalLines,s=e.verticalLines,l=e.itemAlignType,f=this.get("graph"),d=f.getNodes();d.forEach(function(v){var w=v.getBBox(),E=v.get("id");l===!0||l==="horizontal"?(i["".concat(E,"tltr")]=[w.minX,w.minY,w.maxX,w.minY,v],i["".concat(E,"lcrc")]=[w.minX,w.centerY,w.maxX,w.centerY,v],i["".concat(E,"blbr")]=[w.minX,w.maxY,w.maxX,w.maxY,v]):l==="center"&&(i["".concat(E,"lcrc")]=[w.minX,w.centerY,w.maxX,w.centerY,v]),l===!0||l==="vertical"?(s["".concat(E,"tlbl")]=[w.minX,w.minY,w.minX,w.maxY,v],s["".concat(E,"tcbc")]=[w.centerX,w.minY,w.centerX,w.maxY,v],s["".concat(E,"trbr")]=[w.maxX,w.minY,w.maxX,w.maxY,v]):l==="center"&&(s["".concat(E,"tcbc")]=[w.centerX,w.minY,w.centerX,w.maxY,v])})},a.prototype.show=function(e,i){var s=(0,_.mix)({},e);return this.itemAlign(e,i,s),e},a.prototype.itemAlign=function(e,i,s){var l=this,f=this._cfgs,d=f.horizontalLines,v=f.verticalLines,w=f.tolerance,E={x:s.x+i.width/2,y:s.y},T={x:s.x+i.width/2,y:s.y+i.height/2},G={x:s.x+i.width/2,y:s.y+i.height},U={x:s.x,y:s.y+i.height/2},et={x:s.x+i.width,y:s.y+i.height/2},ct=[],Ct=[],Mt=null;if(this.clearAlignLine(),(0,_.each)(d,function(zt){zt[4].isVisible&&(ct.push(l.getLineDisObject(zt,E)),ct.push(l.getLineDisObject(zt,T)),ct.push(l.getLineDisObject(zt,G)))}),(0,_.each)(v,function(zt){zt[4].isVisible&&(Ct.push(l.getLineDisObject(zt,U)),Ct.push(l.getLineDisObject(zt,T)),Ct.push(l.getLineDisObject(zt,et)))}),ct.sort(function(zt,Qt){return zt.dis-Qt.dis}),Ct.sort(function(zt,Qt){return zt.dis-Qt.dis}),ct.length!==0&&ct[0].dis<w){e.y=ct[0].line[1]-ct[0].point.y+s.y,Mt={type:"item",horizontals:[ct[0]]};for(var Dt=1;Dt<3;Dt++)ct[0].dis===ct[Dt].dis&&Mt.horizontals.push(ct[Dt])}if(Ct.length!==0&&Ct[0].dis<w){e.x=Ct[0].line[0]-Ct[0].point.x+s.x,Mt?Mt.verticals=[Ct[0]]:Mt={type:"item",verticals:[Ct[0]]};for(var Dt=1;Dt<3;Dt++)Ct[0].dis===Ct[Dt].dis&&Mt.verticals.push(Ct[Dt])}Mt&&(Mt.bbox=i,this.addAlignLine(Mt))},a.prototype.addAlignLine=function(e){var i=e.bbox,s=e.type,l=e.horizontals,f=e.verticals,d=this._cfgs,v=d.line,w=d.alignLines,E=this.get("graph"),T=E.get("group");s==="item"&&(l&&(0,_.each)(l,function(G){var U=G.line,et=G.point,ct=(U[0]+U[2])/2,Ct,Mt;et.x<ct?(Ct=et.x-i.width/2,Mt=Math.max(U[0],U[2])):(Ct=et.x+i.width/2,Mt=Math.min(U[0],U[2]));var Dt=(0,_.mix)({x1:Ct,y1:U[1],x2:Mt,y2:U[1]},v),zt=T.addShape("line",{attrs:Dt,capture:!1});w.push(zt)}),f&&(0,_.each)(f,function(G){var U=G.line,et=G.point,ct=(U[1]+U[3])/2,Ct,Mt;et.y<ct?(Ct=et.y-i.height/2,Mt=Math.max(U[1],U[3])):(Ct=et.y+i.height/2,Mt=Math.min(U[1],U[3]));var Dt=(0,_.mix)({x1:U[0],y1:Ct,x2:U[0],y2:Mt},v),zt=T.addShape("line",{attrs:Dt,capture:!1});w.push(zt)}))},a.prototype.getLineDisObject=function(e,i){return{line:e,point:i,dis:BA(e,i)}},a.prototype.getContainer=function(){return this.get("container")},a.prototype.clearAlignLine=function(){var e=this._cfgs.alignLines;(0,_.each)(e,function(i){i.remove()}),e.length=0},a.prototype.destory=function(){var e=this._cfgs,i=e.horizontalLines,s=e.verticalLines,l=this.get("graph"),f=l.getNodes();f.forEach(function(d){var v=d.get("id");delete i["".concat(v,"tltr")],delete i["".concat(v,"lcrc")],delete i["".concat(v,"blbr")],delete s["".concat(v,"tlbl")],delete s["".concat(v,"tcbc")],delete s["".concat(v,"trbr")]}),this.clearAlignLine()},a}(rd),$b=D0,Gb=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Jl=function(){return Jl=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},Jl.apply(this,arguments)},Ub=["click","mouseenter"],hE=function(c){Gb(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{data:{},position:"top",padding:8,margin:8,offsetX:0,offsetY:0,layout:"horizontal",flipPage:!1,containerStyle:{},align:void 0,horiSep:8,vertiSep:8,filter:{enable:!1,trigger:"click"}}},a.prototype.init=function(){this.formatArray("padding"),this.formatArray("margin");var e=this.get("filter")||{},i=e.multiple;i&&e.trigger==="mouseenter"&&this.set("multiple",!1);var s=this.get("align");if(!s){var l=this.get("position").split("-");l.includes("left")&&(s="left"),l.includes("right")?s="right":s="center",this.set("align",s)}var f=this.get("graph"),d=f.get("container"),v=Hl(`<div class='g6-legend-container' style="position: absolute;"></div>`);d.appendChild(v),this.set("container",v);var w=this.render();Ps(v,this.getContainerPos(w)),this.bindEvents()},a.prototype.getContainerPos=function(e){e===void 0&&(e=[0,0]);var i=this,s=i.get("graph"),l=this.get("offsetX"),f=this.get("offsetY"),d=this.get("margin"),v=this.get("position").split("-"),w={top:0,right:1,bottom:2,left:3},E=0,T=0,G={left:(s.getWidth()-e[0])/2+E,top:(s.getHeight()-e[1])/2+T};return v.forEach(function(U){var et=d[w[U]],ct=U;switch(U){case"top":et+=T;break;case"left":et+=E;break;case"bottom":et=s.getHeight()-e[1]-et+T,ct="top";break;default:et=s.getWidth()-e[0]-et+E,ct="left";break}G[ct]=et}),G.top+=f+s.getContainer().offsetTop,G.left+=l+s.getContainer().offsetLeft,Object.keys(G).forEach(function(U){G[U]="".concat(G[U],"px")}),G},a.prototype.bindEvents=function(){var e=this,i=e.get("filter");if(!(!i||!i.enable)){var s=i.trigger||"click";Ub.includes(s)||(console.warn("Trigger for legend filterling must be 'click' or 'mouseenter', 'click' will take effect by default."),s="click");var l=e.get("legendCanvas");s==="mouseenter"?(l.on("node-container:mouseenter",function(f){return e.filterData(f)}),l.on("node-container:mouseleave",function(f){e.clearFilter(),e.clearActiveLegend()})):(l.on("node-container:click",function(f){return e.filterData(f)}),l.on("click",function(f){f.target&&f.target.isCanvas&&f.target.isCanvas()&&(e.clearFilter(),e.clearActiveLegend())}))}},a.prototype.changeData=function(e){this.set("data",e);var i=this.render();Ps(this.get("container"),this.getContainerPos(i))},a.prototype.activateLegend=function(e){var i=this.get("filter"),s=i==null?void 0:i.multiple;s||this.clearActiveLegend();var l=e.get("parent");l.get("active")?(l.set("active",!1),this.findLegendItemsByState("active").length&&l.set("inactive",!0)):(l.set("inactive",!1),l.set("active",!0)),this.findLegendItemsByState("active").length?this.findLegendItemsByState("active","all",!1).forEach(function(T){T.set("inactive",!0)}):this.clearActiveLegend();var f=(i==null?void 0:i.legendStateStyles)||{},d=(f==null?void 0:f.inactive)||{opacity:.5,"text-shape":{opacity:.5}},v=d["text-shape"]||{};this.findLegendItemsByState("inactive").forEach(function(T){var G=T.get("children"),U=G[0],et=G[1];U.attr(Jl(Jl({},U.get("oriAttrs")),d)),et.attr(Jl(Jl({},et.get("oriAttrs")),v))});var w=(f==null?void 0:f.active)||{stroke:"#000",lineWidth:2,"text-shape":{fontWeight:"bold"}},E=w["text-shape"]||{};this.findLegendItemsByState("active").forEach(function(T){var G=T.get("children"),U=G[0],et=G[1];U.attr(Jl(Jl({},U.get("oriAttrs")),w)),et.attr(Jl(Jl({},et.get("oriAttrs")),E))})},a.prototype.findLegendItemsByState=function(e,i,s){i===void 0&&(i="all"),s===void 0&&(s=!0);var l=this.get("legendCanvas").find(function(v){return v.get("name")==="root"}),f=l.find(function(v){return v.get("name")==="node-group"}),d=l.find(function(v){return v.get("name")==="edge-group"});return i==="node"?f.get("children").filter(function(v){return!!v.get(e)===s}):i==="edge"?d.get("children").filter(function(v){return!!v.get(e)===s}):f.get("children").filter(function(v){return!!v.get(e)===s}).concat(d.get("children").filter(function(v){return!!v.get(e)===s}))},a.prototype.clearActiveLegend=function(){var e=this.get("legendCanvas"),i=e.find(function(l){return l.get("name")==="root"}),s=[i.find(function(l){return l.get("name")==="node-group"}),i.find(function(l){return l.get("name")==="edge-group"})];s.forEach(function(l){l.get("children").forEach(function(f){f.set("active",!1),f.set("inactive",!1);var d=f.get("children"),v=d[0],w=d[1];v.attr(v.get("oriAttrs")),w.attr(w.get("oriAttrs"))})})},a.prototype.filterData=function(e){var i=this.get("filter"),s=i==null?void 0:i.filterFunctions;if(!(!i||!s)){var l=this.get("legendCanvas"),f=this.get("graph"),d=i.graphActiveState||"active",v=i.graphInactiveState||"inactive",w=i.multiple;this.clearFilter(),w||this.clearActiveLegend(),this.activateLegend(e.target);var E=l.find(function(Mt){return Mt.get("name")==="root"}),T=E.find(function(Mt){return Mt.get("name")==="node-group"}),G=E.find(function(Mt){return Mt.get("name")==="edge-group"}),U=T.get("children").filter(function(Mt){return Mt.get("active")}),et=G.get("children").filter(function(Mt){return Mt.get("active")}),ct=0,Ct=["getNodes","getEdges"];Ct.forEach(function(Mt){f[Mt]().forEach(function(Dt){var zt=!1,Qt=Mt==="getNodes"?U:et;Qt.forEach(function(Ie){var je=s[Ie.get("id")];zt=zt||je(Dt.getModel())}),zt?(f.setItemState(Dt,v,!1),f.setItemState(Dt,d,!0),ct++):(f.setItemState(Dt,d,!1),f.setItemState(Dt,v,!0))})}),ct||Ct.forEach(function(Mt){f[Mt]().forEach(function(Dt){f.clearItemStates(Dt,[v])})})}},a.prototype.clearFilter=function(){var e=this.get("graph"),i=this.get("filter");if(!!i){var s=i.graphActiveState||"active",l=i.graphInactiveState||"inactive";e.getNodes().forEach(function(f){e.clearItemStates(f,[s,l])}),e.getEdges().forEach(function(f){e.clearItemStates(f,[s,l])})}},a.prototype.render=function(){var e=this;this.processData();var i=this.get("legendCanvas");i?i.clear():i=new Gv({container:this.get("container"),width:200,height:200});var s=i.addGroup({name:"root"}),l=s.addGroup({name:"node-group"}),f=s.addGroup({name:"edge-group"});this.set("legendCanvas",i);var d=this.get("itemsData"),v=["nodes","edges"],w=[l,f];v.forEach(function(Ia,Gi){d[Ia].forEach(function(Ri){var xa,ja=w[Gi].addGroup({id:Ri.id,name:"node-container"}),di,hi=Ri.type,qi=e.getShapeSize(Ri),fo=qi.width,es=qi.height,Bs=qi.r,cl=e.getStyle(Ia.substr(0,4),Ri);switch(Ri.type){case"circle":di={r:Bs,x:0,y:0};break;case"rect":di={width:fo,height:es,x:-fo/2,y:-es/2};break;case"ellipse":di={rx:fo,ry:es,x:0,y:0},hi="ellipse";break;case"line":di={x1:-fo/2,y1:0,x2:fo/2,y2:0},hi="line";break;case"quadratic":di={path:[["M",-fo/2,0],["Q",0,fo/2,fo/2,0]]},hi="path";break;case"cubic":di={path:[["M",-fo/2,0],["C",-fo/6,fo/2,fo/6,-fo/2,fo/2,0]]},hi="path";break;case"diamond":di={path:[["M",0,-es],["L",fo,0],["L",0,es],["L",-fo,0],["Z"]]},hi="path";break;case"triangle":di={path:[["M",-fo,es],["L",0,-es],["L",fo,es],["Z"]]},hi="path";break;case"star":di={path:Zf.getStarPath(Bs*3,Bs*1.2)},hi="path";break;default:di={r:Bs,x:0,y:0};break}var Fu=ja.addShape(hi,{attrs:Jl(Jl({},di),cl),name:"".concat(Ri.type,"-node-keyShape"),oriAttrs:Jl({opacity:1},cl)});if(Ri.label){var fl=Fu.getBBox(),El=((xa=Ri.labelCfg)===null||xa===void 0?void 0:xa.style)||{},ec=Jl({textAlign:"begin",fontSize:12,textBaseline:"middle",fill:"#000",opacity:1,fontWeight:"normal"},El);ja.addShape("text",{attrs:Jl({x:fl.maxX+4,y:0,text:Ri.label},ec),className:"legend-label",name:"".concat(Ri.type,"-node-text"),oriAttrs:ec})}})});var E=this.get("padding"),T,G=s.find(function(Ia){return Ia.get("name")==="title-container"}),U={height:0,maxY:0,width:0};if(this.get("title")){G||(G=s.addGroup({name:"title-container"}));var et={fontSize:20,fontFamily:"Arial",fontWeight:300,textBaseline:"top",textAlign:"center",fill:"#000",x:0,y:E[0]},ct=this.get("titleConfig")||{},Ct=Object.assign(et,ct.style||{});T=G.addShape("text",{attrs:Jl({text:this.get("title")},Ct)}),U=G.getCanvasBBox(),G.setMatrix([1,0,0,0,1,0,ct.offsetX,ct.offsetY,1])}this.layoutItems();var Mt=s.getCanvasBBox(),Dt=l.getCanvasBBox(),zt=Dt.minX<0?Math.abs(Dt.minX)+E[3]:E[3],Qt=U.maxY<Dt.minY?Math.abs(U.maxY-Dt.minY)+E[0]:U.maxY+E[0],Ie=[1,0,0,0,1,0,zt,Qt,1];l.setMatrix(Ie),Mt=s.getCanvasBBox();var je=[Mt.minX+Mt.width+E[1],Mt.minY+Mt.height+E[2]];if(T){var ct=Jl({position:"center",offsetX:0,offsetY:0},this.get("titleConfig"));U=G.getCanvasBBox();var ze=G.getMatrix()||[1,0,0,0,1,0,0,0,1];ct.position==="center"?ze[6]=je[0]/2+ct.offsetX:ct.position==="right"?(ze[6]=je[0]-E[3]+ct.offsetX,T.attr({textAlign:"right"})):(ze[6]=E[3]+ct.offsetX,T.attr({textAlign:"left"})),G.setMatrix(ze),U=G.getCanvasBBox(),zt=Dt.minX<0?Math.abs(Dt.minX)+E[3]:E[3],Qt=Dt.minY<U.maxY?Math.abs(U.maxY-Dt.minY)+E[0]:U.maxY+E[0],Ie=[1,0,0,0,1,0,zt,Qt,1],l.setMatrix(Ie);var mn=[1,0,0,0,1,0,zt,Qt,1];this.get("layout")==="vertical"?mn[6]+=Dt.maxX+this.get("horiSep"):mn[7]+=Dt.maxY+this.get("vertiSep"),f.setMatrix(mn)}else{Dt=l.getCanvasBBox();var $n=[1,0,0,0,1,0,0,0,1];this.get("layout")==="vertical"?$n[6]+=Ie[6]+Dt.maxX+this.get("horiSep"):$n[7]+=Ie[7]+Dt.maxY+this.get("vertiSep"),f.setMatrix($n)}Mt=s.getCanvasBBox(),Dt=l.getCanvasBBox(),Ie=l.getMatrix()||[1,0,0,0,1,0,0,0,1];var Tn=f.getMatrix()||[1,0,0,0,1,0,0,0,1],or=f.getCanvasBBox();je=[Math.max(Dt.width+Ie[6],or.width+Tn[6])+E[1],Math.max(Dt.height+Ie[7],or.height+Tn[7])+E[2]],i.changeSize(je[0],je[1]);var kr=this.get("containerStyle"),Ta=s.getMatrix()||[1,0,0,0,1,0,0,0,1],fi=Zf.invertMatrix({x:0,y:0},Ta),ei=s.addShape("rect",{attrs:Jl({x:fi.x+(kr.lineWidth||1),y:fi.y+(kr.lineWidth||1),width:je[0]-2*(kr.lineWidth||1),height:je[1]-2*(kr.lineWidth||1),fill:"#f00",stroke:"#000",lineWidth:1,opacity:.5},kr),name:"legend-back-rect",capture:!1});return ei.toBack(),je},a.prototype.layoutItems=function(){var e=this.get("legendCanvas"),i=this.get("horiSep"),s=this.get("vertiSep"),l=this.get("layout"),f=this.get("align"),d=[0,0],v=e.find(function(Qt){return Qt.get("name")==="root"}),w=v.find(function(Qt){return Qt.get("name")==="node-group"}),E=v.find(function(Qt){return Qt.get("name")==="edge-group"}),T={min:0,max:-Infinity},G=-Infinity;w.get("children").forEach(function(Qt,Ie){Ie===0&&(T.min=d[0]);var je=Qt.get("children")[0],ze=Qt.getCanvasBBox(),mn=je.getBBox(),$n=mn.width,Tn=mn.height,or=0,kr=0,Ta=0;l==="vertical"?(kr=d[1],Ta=d[0]+$n/2,d[0]=Ta+ze.height+s,or=ze.maxX+kr+$n/2):(kr=d[0]+$n/2,Ta=d[1],d[0]=kr+ze.width+i,or=ze.maxY+Ta+Tn/2),d[0]>T.max&&(T.max=d[0]),or>G&&(G=or),Qt.setMatrix([1,0,0,0,1,0,kr,Ta,1])});var U=T.max-T.min,et={min:0,max:-Infinity},ct=w.getCanvasBBox();d[0]=0,d[1]=l==="vertical"?ct.maxX+i:ct.maxY+s,E.get("children").forEach(function(Qt,Ie){Ie===0&&(et.min=d[0]);var je=Qt.get("children")[0],ze=Qt.getCanvasBBox(),mn=je.getBBox(),$n=mn.width,Tn=mn.height,or=0,kr=0;l==="vertical"?(or=d[1],kr=d[0],d[0]=kr+ze.height+s,Qt.setMatrix([1,0,0,0,1,0,0,kr+Tn/2,1])):(or=d[0],kr=d[1],d[0]=or+ze.width+i,Qt.setMatrix([1,0,0,0,1,0,or+$n/2,0,1])),d[0]>et.max&&(et.max=d[0])});var Ct=et.max-et.min;if(f&&f!==""&&f!=="left"){var Mt=U-Ct,Dt=f==="center"?Math.abs(Mt)/2:Math.abs(Mt),zt=Mt<0?w:E;zt.get("children").forEach(function(Qt){var Ie=Qt.getMatrix()||[1,0,0,0,1,0,0,0,1];l==="vertical"?Ie[7]+=Dt:Ie[6]+=Dt,Qt.setMatrix(Ie)})}},a.prototype.processData=function(){var e=this.get("data"),i={nodes:[],edges:[]};e.nodes&&(e.nodes.sort(function(s,l){return s.order-l.order}),e.nodes.forEach(function(s){var l,f,d,v,w,E=s.size||[((l=s.style)===null||l===void 0?void 0:l.width)||((f=s.style)===null||f===void 0?void 0:f.r)||8,((d=s.style)===null||d===void 0?void 0:d.height)||((v=s.style)===null||v===void 0?void 0:v.r)||8],T=((w=s.labelCfg)===null||w===void 0?void 0:w.style)||{};i.nodes.push({id:s.id||(0,_.uniqueId)(),type:s.type||"circle",style:Jl({},s.style),order:s.order,label:s.label,itemType:"node",size:E,labelCfg:{position:"right",style:Jl({fontFamily:"Arial"},T)}})})),e.edges&&(e.edges.sort(function(s,l){return s.order-l.order}),e.edges.forEach(function(s){var l,f,d=s.type||"line";s.type==="cubic-horizontal"&&(d="cubic");var v=((l=s.labelCfg)===null||l===void 0?void 0:l.style)||{},w=s.size||[((f=s.style)===null||f===void 0?void 0:f.width)||8,1];i.edges.push({id:s.id||(0,_.uniqueId)(),type:d,size:w,style:Jl({lineWidth:(0,_.isArray)(w)?w[1]:1},s.style),order:s.order,label:s.label,itemType:"edge",labelCfg:{position:"right",style:Jl({fontFamily:"Arial"},v)}})})),this.set("itemsData",i)},a.prototype.getContainer=function(){return this.get("container")},a.prototype.formatArray=function(e){var i=this.get(e);if((0,_.isNumber)(i))this.set(e,[i,i,i,i]);else if((0,_.isArray)(i))switch(i.length){case 0:this.set(e,[0,0,0,0]);break;case 1:this.set(e,[i[0],i[0],i[0],i[0]]);break;case 2:this.set(e,[i[0],i[1],i[0],i[1]]);break;case 3:this.set(e,[i[0],i[1],i[2],i[1]]);break;default:break}return this.get(e)},a.prototype.getShapeSize=function(e){var i,s,l;return e.size&&((0,_.isArray)(e.size)?(i=e.size[0],s=e.size[1]||e.size[0],l=e.size[0]/2):(0,_.isNumber)(e.size)&&(i=e.size,s=e.size,l=e.size/2)),e.style&&(e.style.width&&(i=e.style.width),e.style.height&&(s=e.style.height),e.style.r&&(l=e.style.r)),l||(l=5),i||(i=l),s||(s=l),{width:i,height:s,r:l}},a.prototype.getStyle=function(e,i){var s=e==="node"?{fill:"#ccc",lineWidth:0}:{stroke:"#000",lineWidth:1};return Jl(Jl({},s),i.style||{})},a.prototype.destroy=function(){var e=this.get("legendCanvas");e==null||e.destroy();var i=this.get("graph"),s=i.get("container"),l=this.get("container");s.removeChild(l)},a}(rd),ff=hE,dE=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),wl=function(){return wl=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},wl.apply(this,arguments)},pE=function(c,a){var e={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&a.indexOf(i)<0&&(e[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(c);s<i.length;s++)a.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(c,i[s])&&(e[i[s]]=c[i[s]]);return e};typeof document!="undefined"&&Pg()(`
  .g6-annotation-container {
    background-color: rgba(255, 255, 255, 0.3);
    padding: 8px;
  }
  .g6-annotation-wrapper {
    background-color: #fff;
    box-shadow: 0 0 8px rgba(0, 0, 0, 0.85);
  }
  .g6-annotation-header-wapper {
    height: fit-content;
    width: 100%;
    background-color: #5B8FF9;
    display: inline-flex;
    cursor: move;
  }
  .g6-annotation-title {
    margin: 4px 40px 4px 8px;
    cursor: text;
    min-width: 32px;
  }
  .g6-annotation-collapse {
    margin: 4px;
    cursor: pointer;
  }
  .g6-annotation-expand {
    margin: 4px;
    cursor: pointer;
  }
  .g6-annotation-close {
    margin: 4px 8px 4px 0;
    cursor: pointer;
  }
  .g6-annotation-content {
    padding: 8px;
    width: fit-content;
    cursor: text;
    word-break: break-all;
    min-width: 32px;
  }
  .g6-annotation-title-input-wrapper {
    margin: 4px 40px 4px 8px;
  }
  .g6-annotation-content-input {
    height: 100%;
    word-break: break-all;
  }
  .g6-annotation-content-input-wrapper {
    margin: 8px;
    height: 100%;
  }
`);var vE="canvas-annotation",X_=function(c){dE(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{trigger:"click",editable:!0,itemHighlightState:"highlight",linkHighlightStyle:{shadowColor:"#5B8FF9",shadowBlur:10},cardCfg:{minHeight:60,width:"fit-content",height:"fit-content",collapseType:"minimize",closeType:"hide",borderRadius:5,maxTitleLength:20}}},a.prototype.getEvents=function(){var e={viewportchange:"updateLinks",afterlayout:"updateLinks",aftergraphrefreshposition:"updateLinks",afterupdateitem:"updateLink",afterchangedata:"onGraphDataChange",afteritemvisibilitychange:"onGraphItemVisibilityChange"};switch(this.get("trigger")){case"click":e=wl(wl({},e),{"node:click":"showAnnotation","edge:click":"showAnnotation"})}return e},a.prototype.getDOMContent=function(e){if(!this.destroyed){var i=e.collapsed,s=e.maxWidth,l=e.title,f=l===void 0?"":l,d=e.content,v=d===void 0?"":d,w=e.borderRadius,E=w===void 0?5:w,T=i?"<p class='g6-annotation-expand'>+</p>":"<p class='g6-annotation-collapse'>-</p>",G=i?"":" <p class='g6-annotation-content'>".concat(v,"</p>"),U="<p class='g6-annotation-close'>x</p>",et=i?"".concat(E,"px"):"".concat(E,"px ").concat(E,"px 0 0");return'<div class="g6-annotation-wrapper" style="border-radius: '.concat(E,"px; max-width: ").concat(s,`px">
        <div
          class="g6-annotation-header-wapper"
          style="border-radius: `).concat(et,`;"
        >
          <h4 class='g6-annotation-title'>`).concat(f,`</h4>
          `).concat(T,`
          `).concat(U,`
        </div>
        `).concat(G,`
      </div>`)}},a.prototype.init=function(){var e=this;if(!e.destroyed){var i=e.get("graph"),s=i.getContainer(),l=e.get("container"),f=this.get("containerCfg");f?(l=this.createContainer(),s.appendChild(l)):l=s,this.set("container",l);var d=s.getBoundingClientRect(),v=new Gv({container:s,width:d.right-d.left,height:d.bottom-d.top});Ps(v.get("el"),{position:"absolute",top:0,left:0,pointerEvents:"none"}),window.addEventListener("resize",(0,_.debounce)(function(){return e.resizeCanvas(e)},100));var w=v.addGroup({id:"annotation-link-group"});e.set("linkGroup",w),e.set("canvas",v),e.get("getTitle")||e.set("getTitle",function(T){var G,U=((G=T==null?void 0:T.getModel)===null||G===void 0?void 0:G.call(T))||{},et=U.label,ct=U.id;return et||ct||"-"}),e.get("getContent")||e.set("getContent",function(T){var G,U;if(!T)return"-";var et=((G=T.getModel)===null||G===void 0?void 0:G.call(T))||{},ct=et.label,Ct=et.id,Mt=(U=T.getType)===null||U===void 0?void 0:U.call(T),Dt=Mt?"".concat(Mt,": "):"";return"".concat(Dt).concat(ct||Ct||"")});var E=e.get("defaultData");E&&this.readData(E)}},a.prototype.createContainer=function(){var e=this;if(!this.destroyed){var i=this.get("containerCfg"),s=this.get("graph"),l=s.getContainer(),f=l.getBoundingClientRect(),d=f.left,v=f.right,w=f.top,E=f.bottom,T=E-w,G=v-d,U=i.position,et=U===void 0?"top":U,ct=i.offsetX,Ct=ct===void 0?0:ct,Mt=i.offsetY,Dt=Mt===void 0?0:Mt,zt=pE(i,["position","offsetX","offsetY"]),Qt=i.height,Ie=Qt===void 0?"fit-content":Qt,je=i.width,ze=je===void 0?s.getWidth():je;Ie==="100%"&&(Ie=T),ze==="100%"&&(ze=G);var mn="unset",$n="unset",Tn={};switch(et){case"right":mn="".concat(T,"px"),Tn={top:0,right:0},Tn.right+=d+Ct,Tn.top+=w+Dt;break;case"bottom":$n="".concat(G,"px"),Tn={bottom:0,left:0},Tn.left+=d+Ct,Tn.bottom+=w+Dt;break;case"top":$n="".concat(G,"px");case"left":mn="".concat(T,"px");default:Tn={top:0,left:0},Tn.left+=d+Ct,Tn.top+=w+Dt;break}Object.keys(Tn).forEach(function(kr){Tn[kr]="".concat(Tn[kr],"px")});var or=Hl("<div class='".concat(i.className," g6-annotation-container'></div>"));return Ps(or,wl(wl({position:"absolute",display:et==="top"||et==="bottom"?"inline-flex":"unset",width:(0,_.isNumber)(ze)?"".concat(ze,"px"):ze,height:(0,_.isNumber)(Ie)?"".concat(Ie,"px"):Ie,maxHeight:mn,maxWidth:$n,overflow:"scroll"},Tn),zt)),l.appendChild(or),or.addEventListener("scroll",function(kr){e.updateLinks()}),or}},a.prototype.resizeCanvas=function(e){clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){if(!(!e||e.destroyed)){var i=e.get("container").getBoundingClientRect(),s=i.right-i.left,l=i.bottom-i.top;e.get("canvas").changeSize(s,l),e.updateOutsideCards(e)}},250)},a.prototype.updateOutsideCards=function(e){var i=e||this,s=i.get("cardInfoMap")||{},l=i.get("graph"),f=l.getPointByCanvas(0,0),d=l.getPointByCanvas(l.getWidth(),l.getHeight()),v=l.getClientByPoint(f.x,f.y),w=v.x,E=v.y,T=l.getClientByPoint(d.x,d.y),G=T.x,U=T.y;Object.values(s).forEach(function(et){var ct=et.card;if(!!ct){var Ct=ct.style,Mt=Hg(Ct.left),Dt=Hg(Ct.top),zt=ct.getBoundingClientRect(),Qt=zt.width,Ie=zt.height,je=Mt,ze=Dt;Mt+Qt>G-w&&(je=G-w-Qt),Mt<0&&(je=0),Dt+Ie>U-E&&(ze=U-E-Ie),Dt<0&&(ze=0),Ps(ct,{left:"".concat(je,"px"),top:"".concat(ze,"px")})}}),i.updateLinks()},a.prototype.showAnnotation=function(e){if(!this.destroyed){var i=e.item;this.toggleAnnotation(i)}},a.prototype.hideCards=function(){var e=this;if(!e.destroyed){var i=e.get("cardInfoMap")||{};Object.keys(i).forEach(function(s){e.hideCard(s)})}},a.prototype.toggleAnnotation=function(e,i){var s,l;i===void 0&&(i={});var f=this;if(!f.destroyed){var d=f.get("cardInfoMap")||{},v=f.get("graph"),w=f.get("container"),E=f.get("containerCfg"),T=Object.assign({},f.get("cardCfg")||{},i),G=T.minHeight,U=T.minWidth,et=T.width,ct=T.height,Ct=T.collapsed,Mt=Ct===void 0?!1:Ct,Dt=T.x,zt=T.y,Qt=T.title,Ie=T.content,je=T.maxTitleLength,ze=T.defaultBegin,mn=pE(T,["minHeight","minWidth","width","height","collapsed","x","y","title","content","maxTitleLength","defaultBegin"]),$n=f.get("linkGroup"),Tn=this.get("rows")||[[]],or=(s=e.isCanvas)===null||s===void 0?void 0:s.call(e),kr=or?vE:e.getID(),Ta=d[kr]||{},fi=Ta.card,ei=Ta.link,Ia=Ta.x,Gi=Ta.y,Ri=Ta.title,xa=Ta.content,ja=this.get("getTitle"),di=this.get("getContent"),hi=this.get("getContentPlaceholder")||function(){return""},qi=this.get("getTitlePlaceHolder")||function(){return""},fo=hi(e),es=qi(e),Bs=Hl(this.getDOMContent(wl({itemId:kr,collapsed:Mt,title:((l=Ri||Qt||(ja==null?void 0:ja(e)))===null||l===void 0?void 0:l.substr(0,je))||es,content:xa||Ie||(di==null?void 0:di(e))||fo},mn))),cl=(0,_.isNumber)(G)?"".concat(G,"px"):G;Ps(Bs,{minHeight:Mt?"unset":cl,minWidth:(0,_.isNumber)(U)?"".concat(U,"px"):U,height:ct,width:et});var Fu=!!fi;Fu?(ei==null||ei.remove(!0),w.replaceChild(Bs,fi)):w.appendChild(Bs);var fl;if(!E){if(fl=w.getBoundingClientRect()||{},Dt!==void 0&&zt!==void 0)Ia=Dt,Gi=zt;else if(!Fu&&!or){var El=fl.top,ec=ze||{},Gl=ec.left,Dp=ec.right,wf=Dp===void 0?16:Dp,Op=ec.top,Ef=Op===void 0?8:Op,Ac=ec.bottom,Gh=wf,Sf=Ef;isNaN(Gl)||(Gh=w.scrollWidth-Gl),isNaN(Ac)||(Sf=w.scrollHeight-Ac);var Qf=(0,_.isNumber)(U)?U:100;Ia=w.scrollWidth-Bs.scrollWidth-(Tn.length-1)*Qf-Gh;var Qs=Tn[Tn.length-1],Ju=(Qs[Qs.length-1]||{}).bbox;Gi=(Ju==null?void 0:Ju.bottom)-El||Sf}Ps(Bs,{position:"absolute",left:"".concat(Ia,"px"),top:"".concat(Gi,"px"),cusor:E?"unset":"move"})}this.bindListener(Bs,kr);var Js=Bs.getBoundingClientRect();if(!or){var Xu=Wb(e,Js,v,this.get("canvas")),Il=this.get("linkStyle");ei=$n.addShape("path",{attrs:wl({lineWidth:1,lineDash:[5,5],stroke:"#ccc",path:Xu},Il)})}if(d[kr]=wl(wl({},d[kr]||{}),{id:kr,collapsed:Mt,card:Bs,link:ei,x:Ia,y:Gi,cardBBox:Js,content:xa||Ie,title:Ri||Qt,contentPlaceholder:fo,titlePlaceholder:es,isCanvas:or}),f.set("cardInfoMap",d),E)this.updateCardPositionsInConatainer(),this.updateLinks();else{var Fo=!isNaN(Dt)&&!isNaN(zt);if(!Fu&&!or&&!Fo){var su=fl.bottom,Iu=su===void 0?0:su,El=fl.top;Tn[Tn.length-1].push({id:kr,bbox:Js}),Js.top>Iu-El-Js.height-16&&Tn.push([]),this.set("rows",Tn)}}this.updateCardSize(kr);var Nl=this.get("onAnnotationChange");Nl==null||Nl(d[kr],Fu?"update":"create")}},a.prototype.updateCardPositionsInConatainer=function(){if(!this.destroyed){var e=this.get("cardInfoMap");if(!!e){var i=this.get("container"),s=this.get("containerCfg").position,l=i.getBoundingClientRect().width,f=getComputedStyle(i),d=Hg(f.paddingLeft)+Hg(f.paddingRight);l-=d,Object.values(e).forEach(function(v){var w=v.card,E=w.getBoundingClientRect().width;switch(s){case"right":Ps(w,{marginLeft:l?"".concat(l-E,"px"):"0px"});break;case"top":case"bottom":Ps(w,{marginLeft:"8px"});default:break}})}}},a.prototype.handleExpandCollapseCard=function(e){if(!this.destroyed){var i=this.get("graph"),s=this.get("cardInfoMap");if(!!s){var l=s[e].collapsed,f=i.findById(e);if(!!f){var d=this.get("cardCfg").collapseType;d==="hide"&&!l?this.hideCard(e):this.toggleAnnotation(f,{collapsed:!l}),s[e]=wl(wl({},s[e]),{collapsed:!l})}}}},a.prototype.hideCard=function(e){if(!this.destroyed){var i=this.get("cardInfoMap");if(!(!i||!i[e])){var s=i[e],l=s.card,f=s.link;Ps(l,{display:"none"}),f==null||f.hide();var d=this.get("onAnnotationChange");d(i[e],"hide")}}},a.prototype.removeCard=function(e){if(!this.destroyed){var i=this.get("cardInfoMap");if(!!i){var s=i[e],l=s.card,f=s.link,d=this.get("container");d.removeChild(l),f==null||f.remove(!0),delete i[e];var v=this.get("onAnnotationChange");v(s,"remove")}}},a.prototype.bindListener=function(e,i){var s=this;if(!this.destroyed){e.addEventListener("mousemove",function(v){var w;if(v.target.className==="g6-annotation-collapse"?w="collapse":v.target.className==="g6-annotation-expand"?w="expand":v.target.className==="g6-annotation-close"&&(w="close"),w){var E=s.get("cardCfg").onMouseEnterIcon,T=E===void 0?function(){}:E;T(v,i,w)}}),e.addEventListener("mouseout",function(v){var w;if(v.target.className==="g6-annotation-collapse"?w="collapse":v.target.className==="g6-annotation-expand"?w="expand":v.target.className==="g6-annotation-close"&&(w="close"),w){var E=s.get("cardCfg").onMouseLeaveIcon,T=E===void 0?function(){}:E;T(v,i,w)}}),e.addEventListener("mouseenter",function(v){var w=s.get("cardInfoMap");if(!!w){var E=s.get("graph"),T=E.findById(i);if(T){var G=s.get("itemHighlightState");E.setItemState(T,G,!0)}var U=w[i].link;if(U){var et=s.get("linkHighlightStyle")||{};U.attr(et)}}}),e.addEventListener("mouseleave",function(v){var w=s.get("cardInfoMap");if(!!w){var E=s.get("graph"),T=E.findById(i);if(T){var G=s.get("itemHighlightState");E.setItemState(T,G,!1)}var U=w[i].link;if(U){var et=s.get("linkHighlightStyle")||{};Object.keys(et).forEach(function(Ct){U.attr(Ct,void 0),U.attr(Ct,void 0)});var ct=s.get("linkStyle");U.attr(ct)}}}),e.addEventListener("click",function(v){var w=(s.get("cardCfg")||{}).onClickIcon;if(v.target.className==="g6-annotation-collapse"||v.target.className==="g6-annotation-expand"){var E=s.get("cardCfg").collapseType;E==="hide"?s.hideCard(i):s.handleExpandCollapseCard(i),w==null||w(v,i,v.target.className==="g6-annotation-collapse"?"collapse":"expand")}else if(v.target.className==="g6-annotation-close"){var T=s.get("cardCfg").closeType;T==="remove"?s.removeCard(i):s.hideCard(i),w==null||w(v,i,"close")}});var l=this.get("editable");l&&e.addEventListener("dblclick",function(v){var w=s.get("cardInfoMap"),E=(s.get("cardCfg")||{}).maxTitleLength,T=E===void 0?20:E;if(!!w){var G=v.target,U=G.className;if(!(U!=="g6-annotation-title"&&U!=="g6-annotation-content")){var et=U==="g6-annotation-title"?G.getBoundingClientRect():G.parentNode.getBoundingClientRect(),ct=et.width,Ct=et.height,Mt=getComputedStyle(G),Dt=U==="g6-annotation-title"?"input":"textarea",zt=Hl("<".concat(Dt,' class="').concat(U,'-input" type="textarea" style="width:').concat(ct,"px; height: ").concat(Ct,'px; min-width: 16px;"/>')),Qt=Hl('<div class="'.concat(U,'-input-wrapper" style="width: ').concat(ct,"px; height: ").concat(Ct,"px; min-width: 16px; margin-right: ").concat(Mt.marginRight,'" />'));Qt.appendChild(zt),G.parentNode.replaceChild(Qt,G);var Ie=w[i],je=Ie.contentPlaceholder,ze=Ie.titlePlaceholder,mn=Ie.content,$n=Ie.title,Tn=mn;U==="g6-annotation-title"?(zt.name="title",zt.maxLength=T,Tn=$n):zt.name="content",Tn?(zt.innerHTML=G.innerHTML,zt.value=G.innerHTML):zt.placeholder=U==="g6-annotation-title"?ze:je,zt.focus(),zt.addEventListener("blur",function(or){zt.value&&(G.innerHTML=zt.value,Ie[zt.name||"title"]=zt.value),Qt.parentNode.replaceChild(G,Qt),s.updateCardSize(i);var kr=s.get("onAnnotationChange");kr==null||kr(Ie,"update")})}}});var f=["g6-annotation-title","g6-annotation-content","g6-annotation-title-input","g6-annotation-content-input"];e.draggable=!0,e.addEventListener("dragstart",function(v){var w=v.target.className;if(!f.includes(w)){var E=e.style;s.set("dragging",{card:e,x:v.clientX,y:v.clientY,left:Hg(E.left),top:Hg(E.top)})}}),e.addEventListener("drag",function(v){v.preventDefault();var w=s.get("cardInfoMap");if(!!w){var E=v.clientX,T=v.clientY,G=s.get("dragging");if(!(isNaN(E)||isNaN(T)||!G)){var U=G.x,et=G.y,ct=G.left,Ct=G.top,Mt=G.card,Dt=E-U,zt=T-et;ct+=Dt,Ct+=zt;var Qt=s.get("graph"),Ie=Qt.getPointByCanvas(0,0),je=Qt.getPointByCanvas(Qt.getWidth(),Qt.getHeight()),ze=Qt.getClientByPoint(Ie.x,Ie.y),mn=ze.x,$n=ze.y,Tn=Qt.getClientByPoint(je.x,je.y),or=Tn.x,kr=Tn.y,Ta=Mt.getBoundingClientRect(),fi=Ta.right-Ta.left,ei=Ta.bottom-Ta.top;(ct>or-mn-fi&&Dt>0||ct<0&&Dt<0)&&(ct-=Dt),(Ct>kr-$n-ei&&zt>0||Ct<0&&zt<0)&&(Ct-=zt),Ps(Mt,{left:"".concat(ct,"px"),top:"".concat(Ct,"px"),visibility:"hidden"}),U=E,et=T;var Ia=(w[i]||{}).link;if(Ia){var Gi=Qt.findById(i);Ia.attr("path",Wb(Gi,Ta,Qt,s.get("canvas")))}s.set("dragging",{x:U,y:et,left:ct,top:Ct,card:Mt})}}});var d=function(w){var E=s.get("cardInfoMap");if(!!E){var T=s.get("dragging");if(T){var G=T.left,U=T.top,et=T.card;E[i].x=G,E[i].y=U,Ps(et,{visibility:"visible"}),s.set("dragging",!1);var ct=s.get("rows");ct==null||ct.forEach(function(Mt){for(var Dt=Mt.length-1;Dt>=0;Dt--)Mt[Dt].id===i&&Mt.splice(Dt,1)});var Ct=s.get("onAnnotationChange");Ct==null||Ct(E[i],"update")}}};e.addEventListener("dragend",d)}},a.prototype.updateCardSize=function(e){var i=this.get("cardInfoMap");if(!!i){var s=i[e].card,l=s.getBoundingClientRect().width,f=s.getElementsByClassName("g6-annotation-title")[0];if(f){var d=getComputedStyle(f),v=Hg(d.marginLeft),w=f.getBoundingClientRect().width;Ps(f,{marginRight:"".concat(l-v-24-16-w,"px")})}}},a.prototype.updateLink=function(e){var i=e.item;if(!!i){var s=this.get("cardInfoMap");if(!!s){var l=this.get("canvas"),f=this.get("graph"),d=i.getID(),v=s[d]||{},w=v.link,E=v.card;if(w){var T=Wb(i,E.getBoundingClientRect(),f,l);w.attr("path",T)}}}},a.prototype.updateLinks=function(){var e=this;if(!this.destroyed){var i=this.get("cardInfoMap");if(!!i){var s=this.get("graph");Object.values(i).forEach(function(l){var f=l.id,d=s.findById(f);e.updateLink({item:d})})}}},a.prototype.onGraphDataChange=function(){var e=this,i=this.get("cardInfoMap");if(!!i){var s=this.get("graph");Object.values(i).forEach(function(l){var f=l.id,d=l.card,v=l.isCanvas;if(!(!d||v||d.style.display==="none")){var w=s.findById(f);w&&w.isVisible()?e.toggleAnnotation(w):e.hideCard(f)}})}},a.prototype.onGraphItemVisibilityChange=function(e){var i=e.item,s=e.visible;if(!(!i||i.destroyed)){var l=this.get("cardInfoMap");if(!!l){var f=i.getID();!l[f]||s||this.hideCard(f)}}},a.prototype.saveData=function(e){e===void 0&&(e=!1);var i=this.get("cardInfoMap");if(!!i){var s=this.get("graph"),l=this.get("getTitle"),f=this.get("getContent"),d=[];return Object.values(i).forEach(function(v){var w=v.title,E=v.content,T=v.x,G=v.y,U=v.id,et=v.collapsed,ct=v.card;if(!(ct&&ct.style.display==="none"&&!e)){var Ct=s.findById(U)||s.get("canvas");d.push({id:U,x:T,y:G,collapsed:et,title:w||(l==null?void 0:l(Ct)),content:E||(f==null?void 0:f(Ct)),visible:ct&&ct.style.display!=="none"})}}),d}},a.prototype.readData=function(e){var i=this,s=this.get("graph");e.forEach(function(l){var f=l.id,d=l.x,v=l.y,w=l.title,E=l.content,T=l.collapsed,G=l.visible,U=s.findById(f);if(!U&&f===vE&&(U=s.get("canvas")),!U){var et=i.get("cardInfoMap")||{};et[f]=l,i.set("cardInfoMap",et);return}i.toggleAnnotation(U,{x:d,y:v,title:w,content:E,collapsed:T}),G||i.hideCard(f)})},a.prototype.clear=function(){var e=this.get("cardInfoMap");if(!!e){var i=this.get("container");Object.values(e).forEach(function(s){var l=s.card,f=s.link;i.removeChild(l),f==null||f.remove(!0)}),this.set("cardInfoMap",{})}},a.prototype.destroy=function(){var e;this.clear(),(e=this.get("canvas"))===null||e===void 0||e.destroy();var i=this.get("graph");!i||i.destroyed||(this.get("containerCfg")&&i.getContainer().removeChild(this.get("container")),this.destroyed=!0)},a}(rd),Y_=X_,K_=function(a,e){var i,s,l,f=Infinity;Object.keys(a).forEach(function(w){var E=a[w];Object.keys(e).forEach(function(T){var G=e[T],U=E.x-G.x,et=E.y-G.y,ct=U*U+et*et;f>ct&&(f=ct,i=E,s=G,l=[w,T])})});var d=20,v=Zf.getControlPoint(i,s,.5,d);return[["M",i.x,i.y],["Q",v.x,v.y,s.x,s.y]]},Wb=function(a,e,i,s){var l,f,d=a.getType();if(d==="edge")f=[a.getKeyShape().getPoint(.5)];else{var v=(l=a.getKeyShape)===null||l===void 0?void 0:l.call(a).getBBox(),w=v.minX,E=v.minY,T=v.maxX,G=v.maxY,U=a.getModel(),et=U.x,ct=U.y;w+=et,E+=ct,T+=et,G+=ct,f={left:{x:w,y:(E+G)/2},right:{x:T,y:(E+G)/2},top:{x:(w+T)/2,y:E},bottom:{x:(w+T)/2,y:G}}}Object.keys(f).forEach(function($n){var Tn=f[$n],or=Tn.x,kr=Tn.y,Ta=i.getClientByPoint(or,kr);f[$n]=s.getPointByClient(Ta.x,Ta.y)});var Ct=e.top,Mt=Ct===void 0?0:Ct,Dt=e.left,zt=Dt===void 0?0:Dt,Qt=e.right,Ie=Qt===void 0?0:Qt,je=e.bottom,ze=je===void 0?0:je,mn={left:s.getPointByClient(zt,(Mt+ze)/2),right:s.getPointByClient(Ie,(Mt+ze)/2),top:s.getPointByClient((zt+Ie)/2,Mt),bottom:s.getPointByClient((zt+Ie)/2,ze)};return K_(f,mn)},Hg=function(a){return Number(a.replace(/\s+|px/gi,""))||0},Z_={PluginBase:rd,Menu:cC,Grid:lC,Minimap:mC,Bundling:Mw,ToolBar:_C,Tooltip:AC,Fisheye:kw,TimeBar:Fb,ImageMinimap:FA,EdgeFilterLens:H_,SnapLine:$b,Legend:ff,Annotation:Y_},q_=Z_,xf=q_;zv("circle",{options:{size:$i.defaultNode.size,style:{x:0,y:0,stroke:$i.defaultNode.style.stroke,fill:$i.defaultNode.style.fill,lineWidth:$i.defaultNode.style.lineWidth},labelCfg:{style:{fill:$i.nodeLabel.style.fill,fontSize:$i.nodeLabel.style.fontSize,fontFamily:$i.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:$i.defaultNode.linkPoints.size,lineWidth:$i.defaultNode.linkPoints.lineWidth,fill:$i.defaultNode.linkPoints.fill,stroke:$i.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:(0,O.__assign)({},$i.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).icon,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=(0,_.deepMix)({},s,a.icon),d="".concat(this.type,"-keyShape"),v=e.addShape("circle",{attrs:l,className:d,name:d,draggable:!0});e.shapeMap[d]=v;var w=f.width,E=f.height,T=f.show,G=f.text;if(T){var U="".concat(this.type,"-icon");G?e.shapeMap[U]=e.addShape("text",{attrs:(0,O.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},f),className:U,name:U,draggable:!0}):e.shapeMap[U]=e.addShape("image",{attrs:(0,O.__assign)({x:-w/2,y:-E/2},f),className:U,name:U,draggable:!0})}return this.drawLinkPoints(a,e),v},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints;if(!!i){var s=i||{},l=s.top,f=s.left,d=s.right,v=s.bottom,w=s.size,E=s.r,T=(0,O.__rest)(s,["top","left","right","bottom","size","r"]),G=this.getSize(a),U=G[0]/2;if(f){var et="link-point-left";e.shapeMap[et]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:-U,y:0,r:w/2||E||5}),className:et,name:et,isAnchorPoint:!0})}if(d){var ct="link-point-right";e.shapeMap[ct]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:U,y:0,r:w/2||E||5}),className:ct,name:ct,isAnchorPoint:!0})}if(l){var Ct="link-point-top";e.shapeMap[Ct]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:0,y:-U,r:w/2||E||5}),className:Ct,name:Ct,isAnchorPoint:!0})}if(v){var Mt="link-point-bottom";e.shapeMap[Mt]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:0,y:U,r:w/2||E||5}),className:Mt,name:Mt,isAnchorPoint:!0})}}},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,_.deepMix)({},e,i),l=this.getSize(a),f=l[0]/2,d=(0,O.__assign)({x:0,y:0,r:f},s);return d},update:function(a,e,i){var s=e.getContainer(),l=this.getSize(a),f=(0,O.__assign)({},a.style);a.style.stroke===void 0&&a.color&&(f.stroke=a.color),a.style.r===void 0&&!isNaN(l[0])&&(f.r=l[0]/2),this.updateShape(a,e,f,!0,i),this.updateLinkPoints(a,s)}},"single-node"),zv("rect",{options:{size:[100,30],style:{radius:0,stroke:$i.defaultNode.style.stroke,fill:$i.defaultNode.style.fill,lineWidth:$i.defaultNode.style.lineWidth},labelCfg:{style:{fill:$i.nodeLabel.style.fill,fontSize:$i.nodeLabel.style.fontSize,fontFamily:$i.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:$i.defaultNode.linkPoints.size,lineWidth:$i.defaultNode.linkPoints.lineWidth,fill:$i.defaultNode.linkPoints.fill,stroke:$i.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},anchorPoints:[[0,.5],[1,.5]],stateStyles:(0,O.__assign)({},$i.nodeStateStyles)},shapeType:"rect",labelPosition:"center",drawShape:function(a,e){var i=this.getShapeStyle(a),s=e.addShape("rect",{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return e.shapeMap["".concat(this.type,"-keyShape")]=s,this.drawLinkPoints(a,e),s},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=i===void 0?{}:i,l=s.top,f=s.left,d=s.right,v=s.bottom,w=s.size,E=s.r,T=(0,O.__rest)(s,["top","left","right","bottom","size","r"]),G=this.getSize(a),U=G[0],et=G[1];f&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:-U/2,y:0,r:w/2||E||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),d&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:U/2,y:0,r:w/2||E||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),l&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:0,y:-et/2,r:w/2||E||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),v&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:0,y:et/2,r:w/2||E||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,_.mix)({},e,i),l=this.getSize(a),f=s.width||l[0],d=s.height||l[1],v=(0,O.__assign)({x:-f/2,y:-d/2,width:f,height:d},s);return v},update:function(a,e,i){var s=e.getContainer(),l=this.getOptions({}).style,f=this.getSize(a),d=e.get("keyShape");a.size||(f[0]=d.attr("width")||l.width,f[1]=d.attr("height")||l.height);var v={stroke:a.color,x:-f[0]/2,y:-f[1]/2,width:f[0],height:f[1]},w=(0,_.mix)({},l,d.attr(),v);w=(0,_.mix)(w,a.style),this.updateShape(a,e,w,!1,i),this.updateLinkPoints(a,s)}},"single-node"),zv("ellipse",{options:{size:[80,40],style:{x:0,y:0,stroke:$i.defaultNode.style.stroke,fill:$i.defaultNode.style.fill,lineWidth:$i.defaultNode.style.lineWidth},labelCfg:{style:{fill:$i.nodeLabel.style.fill,fontSize:$i.nodeLabel.style.fontSize,fontFamily:$i.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:$i.defaultNode.linkPoints.size,lineWidth:$i.defaultNode.linkPoints.lineWidth,fill:$i.defaultNode.linkPoints.fill,stroke:$i.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:(0,O.__assign)({},$i.nodeStateStyles)},shapeType:"ellipse",labelPosition:"center",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).icon,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=e.addShape("ellipse",{attrs:l,className:"ellipse-keyShape",name:"ellipse-keyShape",draggable:!0});e.shapeMap["ellipse-keyShape"]=f;var d=s.width,v=s.height,w=s.show,E=s.text;return w&&(E?e.shapeMap["".concat(this.type,"-icon")]=e.addShape("text",{attrs:(0,O.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.shapeMap["".concat(this.type,"-icon")]=e.addShape("image",{attrs:(0,O.__assign)({x:-d/2,y:-v/2},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(a,e),f},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=i===void 0?{}:i,l=s.top,f=s.left,d=s.right,v=s.bottom,w=s.size,E=s.r,T=(0,O.__rest)(s,["top","left","right","bottom","size","r"]),G=this.getSize(a),U=G[0]/2,et=G[1]/2;f&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:-U,y:0,r:w/2||E||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),d&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:U,y:0,r:w/2||E||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),l&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:0,y:-et,r:w/2||E||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),v&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:0,y:et,r:w/2||E||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,_.mix)({},e,i),l=this.getSize(a),f=l[0]/2,d=l[1]/2,v=(0,O.__assign)({x:0,y:0,rx:f,ry:d},s);return v},update:function(a,e,i){var s=e.getContainer(),l=this.getOptions({}).style,f=this.getSize(a),d={stroke:a.color,rx:f[0]/2,ry:f[1]/2},v=e.get("keyShape"),w=(0,_.mix)({},l,v.attr(),d);w=(0,_.mix)(w,a.style),this.updateShape(a,e,w,!0,i),this.updateLinkPoints(a,s)}},"single-node"),zv("diamond",{options:{size:[80,80],style:{stroke:$i.defaultNode.style.stroke,fill:$i.defaultNode.style.fill,lineWidth:$i.defaultNode.style.lineWidth},labelCfg:{style:{fill:$i.nodeLabel.style.fill,fontSize:$i.nodeLabel.style.fontSize,fontFamily:$i.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:$i.defaultNode.linkPoints.size,lineWidth:$i.defaultNode.linkPoints.lineWidth,fill:$i.defaultNode.linkPoints.fill,stroke:$i.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:(0,O.__assign)({},$i.nodeStateStyles)},shapeType:"diamond",labelPosition:"center",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).icon,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=e.addShape("path",{attrs:l,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e.shapeMap["".concat(this.type,"-keyShape")]=f;var d=s.width,v=s.height,w=s.show,E=s.text;return w&&(E?e.shapeMap["".concat(this.type,"-icon")]=e.addShape("text",{attrs:(0,O.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.shapeMap["".concat(this.type,"-icon")]=e.addShape("image",{attrs:(0,O.__assign)({x:-d/2,y:-v/2},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(a,e),f},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=i===void 0?{}:i,l=s.top,f=s.left,d=s.right,v=s.bottom,w=s.size,E=s.r,T=(0,O.__rest)(s,["top","left","right","bottom","size","r"]),G=this.getSize(a),U=G[0],et=G[1];f&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:-U/2,y:0,r:w/2||E||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),d&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:U/2,y:0,r:w/2||E||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),l&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:0,y:-et/2,r:w/2||E||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),v&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:0,y:et/2,r:w/2||E||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getPath:function(a){var e=this.getSize(a),i=e[0],s=e[1],l=[["M",0,-s/2],["L",i/2,0],["L",0,s/2],["L",-i/2,0],["Z"]];return l},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,_.mix)({},e,i),l=this.getPath(a),f=(0,O.__assign)({path:l},s);return f},update:function(a,e,i){var s=e.getContainer(),l=this.getOptions({}).style,f=this.getPath(a),d={stroke:a.color,path:f},v=e.get("keyShape"),w=(0,_.mix)({},l,v.attr(),d);w=(0,_.mix)(w,a.style),this.updateShape(a,e,w,!0,i),this.updateLinkPoints(a,s)}},"single-node"),zv("triangle",{options:{size:40,direction:"up",style:{stroke:$i.defaultNode.style.stroke,fill:$i.defaultNode.style.fill,lineWidth:$i.defaultNode.style.lineWidth},labelCfg:{style:{fill:$i.nodeLabel.style.fill,fontSize:$i.nodeLabel.style.fontSize},offset:15},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:$i.defaultNode.linkPoints.size,lineWidth:$i.defaultNode.linkPoints.lineWidth,fill:$i.defaultNode.linkPoints.fill,stroke:$i.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20,offset:6},stateStyles:(0,O.__assign)({},$i.nodeStateStyles)},shapeType:"triangle",labelPosition:"bottom",drawShape:function(a,e){var i=this.mergeStyle||this.getOptions(a),s=i.icon,l=s===void 0?{}:s,f=i.direction,d=this.getShapeStyle(a),v=a.direction||f,w=e.addShape("path",{attrs:d,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e.shapeMap["".concat(this.type,"-keyShape")]=w;var E=l.width,T=l.height,G=l.show,U=l.offset,et=l.text;if(G)if(et)e.shapeMap["".concat(this.type,"-icon")]=e.addShape("text",{attrs:(0,O.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},l),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0});else{var ct=-E/2,Ct=-T/2;(v==="up"||v==="down")&&(Ct+=U),(v==="left"||v==="right")&&(ct+=U),e.shapeMap["".concat(this.type,"-icon")]=e.addShape("image",{attrs:(0,O.__assign)({x:ct,y:Ct},l),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})}return this.drawLinkPoints(a,e),w},drawLinkPoints:function(a,e){var i=this.mergeStyle||this.getOptions(a),s=i.linkPoints,l=s===void 0?{}:s,f=i.direction,d=a.direction||f,v=l.top,w=l.left,E=l.right,T=l.bottom,G=l.size,U=l.r,et=(0,O.__rest)(l,["top","left","right","bottom","size","r"]),ct=this.getSize(a),Ct=ct[0];if(w){var Mt=null,Dt=Ct*Math.sin(1/3*Math.PI),zt=Ct*Math.sin(1/3*Math.PI);d==="up"?Mt=[-zt,Dt]:d==="down"?Mt=[-zt,-Dt]:d==="left"&&(Mt=[-zt,zt-Dt]),Mt&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},et),{x:Mt[0],y:Mt[1],r:G/2||U||5}),className:"link-point-left",name:"link-point-left"}))}if(E){var Qt=null,Dt=Ct*Math.sin(1/3*Math.PI),zt=Ct*Math.sin(1/3*Math.PI);d==="up"?Qt=[zt,Dt]:d==="down"?Qt=[zt,-Dt]:d==="right"&&(Qt=[zt,zt-Dt]),Qt&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},et),{x:Qt[0],y:Qt[1],r:G/2||U||5}),className:"link-point-right",name:"link-point-right"}))}if(v){var Ie=null,Dt=Ct*Math.sin(1/3*Math.PI),zt=Ct*Math.sin(1/3*Math.PI);d==="up"?Ie=[zt-Dt,-Dt]:d==="left"?Ie=[zt,-Dt]:d==="right"&&(Ie=[-zt,-Dt]),Ie&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},et),{x:Ie[0],y:Ie[1],r:G/2||U||5}),className:"link-point-top",name:"link-point-top"}))}if(T){var je=null,Dt=Ct*Math.sin(1/3*Math.PI),zt=Ct*Math.sin(1/3*Math.PI);d==="down"?je=[-zt+Dt,Dt]:d==="left"?je=[zt,Dt]:d==="right"&&(je=[-zt,Dt]),je&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},et),{x:je[0],y:je[1],r:G/2||U||5}),className:"link-point-bottom",name:"link-point-bottom"}))}},getPath:function(a){var e=(this.mergeStyle||this.getOptions(a)).direction,i=a.direction||e,s=this.getSize(a),l=s[0],f=l*Math.sin(1/3*Math.PI),d=l*Math.sin(1/3*Math.PI),v=[["M",-d,f],["L",0,-f],["L",d,f],["Z"]];return i==="down"?v=[["M",-d,-f],["L",d,-f],["L",0,f],["Z"]]:i==="left"?v=[["M",-d,d-f],["L",d,-d],["L",d,d],["Z"]]:i==="right"&&(v=[["M",d,d-f],["L",-d,d],["L",-d,-d],["Z"]]),v},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,_.mix)({},e,i),l=this.getPath(a),f=(0,O.__assign)({path:l},s);return f},update:function(a,e,i){var s=e.getContainer(),l=this.getOptions({}).style,f=this.getPath(a),d={stroke:a.color,path:f},v=e.get("keyShape"),w=(0,_.mix)({},l,v.attr(),d);w=(0,_.mix)(w,a.style),this.updateShape(a,e,w,!0,i),this.updateLinkPoints(a,s)},updateLinkPoints:function(a,e){var i=this.getOptions({}),s=i.linkPoints,l=i.direction,f=a.direction||l,d=e.shapeMap["link-point-left"]||e.find(function(Ia){return Ia.get("className")==="link-point-left"}),v=e.shapeMap["link-point-right"]||e.find(function(Ia){return Ia.get("className")==="link-point-right"}),w=e.shapeMap["link-point-top"]||e.find(function(Ia){return Ia.get("className")==="link-point-top"}),E=e.shapeMap["link-point-bottom"]||e.find(function(Ia){return Ia.get("className")==="link-point-bottom"}),T=s,G=d||v||w||E;G&&(T=G.attr());var U=(0,_.mix)({},T,a.linkPoints),et=U.fill,ct=U.stroke,Ct=U.lineWidth,Mt=U.size/2;Mt||(Mt=U.r);var Dt=a.linkPoints?a.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},zt=Dt.left,Qt=Dt.right,Ie=Dt.top,je=Dt.bottom,ze=this.getSize(a),mn=ze[0],$n={r:Mt,fill:et,stroke:ct,lineWidth:Ct},Tn=null,or=mn*Math.sin(1/3*Math.PI),kr=mn*Math.sin(1/3*Math.PI);f==="up"?Tn=[-kr,or]:f==="down"?Tn=[-kr,-or]:f==="left"&&(Tn=[-kr,kr-or]),Tn&&(d?!zt&&zt!==void 0?(d.remove(),delete e.shapeMap["link-point-left"]):d.attr((0,O.__assign)((0,O.__assign)({},$n),{x:Tn[0],y:Tn[1]})):zt&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},$n),{x:Tn[0],y:Tn[1]}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})));var Ta=null;f==="up"?Ta=[kr,or]:f==="down"?Ta=[kr,-or]:f==="right"&&(Ta=[kr,kr-or]),Ta&&(v?!Qt&&Qt!==void 0?(v.remove(),delete e.shapeMap["link-point-right"]):v.attr((0,O.__assign)((0,O.__assign)({},$n),{x:Ta[0],y:Ta[1]})):Qt&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},$n),{x:Ta[0],y:Ta[1]}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})));var fi=null;f==="up"?fi=[kr-or,-or]:f==="left"?fi=[kr,-or]:f==="right"&&(fi=[-kr,-or]),fi&&(w?!Ie&&Ie!==void 0?(w.remove(),delete e.shapeMap["link-point-top"]):w.attr((0,O.__assign)((0,O.__assign)({},$n),{x:fi[0],y:fi[1]})):Ie&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},$n),{x:fi[0],y:fi[1]}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})));var ei=null;f==="down"?ei=[-kr+or,or]:f==="left"?ei=[kr,or]:f==="right"&&(ei=[-kr,or]),ei&&(E?!je&&je!==void 0?(E.remove(),delete e.shapeMap["link-point-bottom"]):E.attr((0,O.__assign)((0,O.__assign)({},$n),{x:ei[0],y:ei[1]})):je&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},$n),{x:ei[0],y:ei[1]}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})))}},"single-node"),zv("modelRect",{options:{size:[185,70],style:{radius:5,stroke:"#69c0ff",fill:"#ffffff",lineWidth:$i.defaultNode.style.lineWidth,fillOpacity:1},labelCfg:{style:{fill:"#595959",fontSize:14,fontFamily:$i.windowFontFamily},offset:30},descriptionCfg:{style:{fontSize:12,fill:"#bfbfbf",fontFamily:$i.windowFontFamily},paddingTop:0},preRect:{show:!0,width:4,fill:"#40a9ff",radius:2},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:10,lineWidth:1,fill:"#72CC4A",stroke:"#72CC4A"},logoIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg",width:16,height:16,offset:0},stateIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg",width:16,height:16,offset:-5},anchorPoints:[[0,.5],[1,.5]]},shapeType:"modelRect",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).preRect,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=this.getSize(a),d=f[0],v=f[1],w=e.addShape("rect",{attrs:l,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e.shapeMap["".concat(this.type,"-keyShape")]=w;var E=s.show,T=(0,O.__rest)(s,["show"]);return E&&(e.shapeMap["pre-rect"]=e.addShape("rect",{attrs:(0,O.__assign)({x:-d/2,y:-v/2,height:v},T),className:"pre-rect",name:"pre-rect",draggable:!0})),this.drawLogoIcon(a,e),this.drawStateIcon(a,e),this.drawLinkPoints(a,e),w},drawLogoIcon:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).logoIcon,s=i===void 0?{}:i,l=this.getSize(a),f=l[0];if(s.show){var d=s.width,v=s.height,w=s.x,E=s.y,T=s.offset,G=s.text,U=(0,O.__rest)(s,["width","height","x","y","offset","text"]);G?e.shapeMap["rect-logo-icon"]=e.addShape("text",{attrs:(0,O.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},U),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0}):e.shapeMap["rect-logo-icon"]=e.addShape("image",{attrs:(0,O.__assign)((0,O.__assign)({},U),{x:w||-f/2+d+T,y:E||-v/2,width:d,height:v}),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0})}},drawStateIcon:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).stateIcon,s=i===void 0?{}:i,l=this.getSize(a),f=l[0];if(s.show){var d=s.width,v=s.height,w=s.x,E=s.y,T=s.offset,G=s.text,U=(0,O.__rest)(s,["width","height","x","y","offset","text"]);G?e.shapeMap["rect-state-icon"]=e.addShape("text",{attrs:(0,O.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},U),className:"rect-state-icon",name:"rect-state-icon",draggable:!0}):e.shapeMap["rect-state-icon"]=e.addShape("image",{attrs:(0,O.__assign)((0,O.__assign)({},U),{x:w||f/2-d+T,y:E||-v/2,width:d,height:v}),className:"rect-state-icon",name:"rect-state-icon",draggable:!0})}},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=i===void 0?{}:i,l=s.top,f=s.left,d=s.right,v=s.bottom,w=s.size,E=s.r,T=(0,O.__rest)(s,["top","left","right","bottom","size","r"]),G=this.getSize(a),U=G[0],et=G[1];f&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:-U/2,y:0,r:w/2||E||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),d&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:U/2,y:0,r:w/2||E||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),l&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:0,y:-et/2,r:w/2||E||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),v&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},T),{x:0,y:et/2,r:w/2||E||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},drawLabel:function(a,e){var i=this.getOptions(a),s=i.labelCfg,l=s===void 0?{}:s,f=i.logoIcon,d=f===void 0?{}:f,v=i.descriptionCfg,w=v===void 0?{}:v,E=this.getSize(a),T=E[0],G=null,U=d.show,et=d.width,ct=-T/2+l.offset;U&&(ct=-T/2+et+l.offset);var Ct=l.style,Mt=w.style,Dt=w.paddingTop;return(0,_.isString)(a.description)?(G=e.addShape("text",{attrs:(0,O.__assign)((0,O.__assign)({},Ct),{x:ct,y:-5,text:a.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),e.shapeMap["text-shape"]=G,e.shapeMap["rect-description"]=e.addShape("text",{attrs:(0,O.__assign)((0,O.__assign)({},Mt),{x:ct,y:17+(Dt||0),text:a.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0})):(G=e.addShape("text",{attrs:(0,O.__assign)((0,O.__assign)({},Ct),{x:ct,y:7,text:a.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),e.shapeMap["text-shape"]=G),G},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,_.mix)({},e,i),l=this.getSize(a),f=s.width||l[0],d=s.height||l[1],v=(0,O.__assign)({x:-f/2,y:-d/2,width:f,height:d},s);return v},update:function(a,e){var i=this.mergeStyle||this.getOptions(a),s=i.style,l=s===void 0?{}:s,f=i.labelCfg,d=f===void 0?{}:f,v=i.descriptionCfg,w=v===void 0?{}:v,E=this.getSize(a),T=E[0],G=E[1],U=e.get("keyShape");U.attr((0,O.__assign)((0,O.__assign)({},l),{x:-T/2,y:-G/2,width:T,height:G}));var et=e.getContainer(),ct=et.shapeMap["rect-logo-icon"]||et.find(function(Bs){return Bs.get("className")==="rect-logo-icon"}),Ct=ct?ct.attr():{},Mt=(0,_.mix)({},Ct,a.logoIcon),Dt=Mt.width;Dt===void 0&&(Dt=this.options.logoIcon.width);var zt=a.logoIcon?a.logoIcon.show:void 0,Qt=d.offset,Ie=-T/2+Dt+Qt;!zt&&zt!==void 0&&(Ie=-T/2+Qt);var je=et.shapeMap["node-label"]||et.find(function(Bs){return Bs.get("className")==="node-label"}),ze=et.shapeMap["rect-description"]||et.find(function(Bs){return Bs.get("className")==="rect-description"});if(a.label)if(!je)et.shapeMap["node-label"]=et.addShape("text",{attrs:(0,O.__assign)((0,O.__assign)({},d.style),{x:Ie,y:a.description?-5:7,text:a.label}),className:"node-label",name:"node-label",draggable:!0,labelRelated:!0});else{var mn=a.labelCfg?a.labelCfg.style:{},$n=(0,_.mix)({},je.attr(),mn);a.label&&($n.text=a.label),$n.x=Ie,(0,_.isString)(a.description)&&($n.y=-5),ze&&(ze.resetMatrix(),ze.attr({x:Ie})),je.resetMatrix(),je.attr($n)}if((0,_.isString)(a.description)){var Tn=w.paddingTop;if(!ze)et.shapeMap["rect-description"]=et.addShape("text",{attrs:(0,O.__assign)((0,O.__assign)({},w.style),{x:Ie,y:17+(Tn||0),text:a.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0});else{var mn=a.descriptionCfg?a.descriptionCfg.style:{},or=(0,_.mix)({},ze.attr(),mn);(0,_.isString)(a.description)&&(or.text=a.description),or.x=Ie,ze.resetMatrix(),ze.attr((0,O.__assign)((0,O.__assign)({},or),{y:17+(Tn||0)}))}}var kr=et.shapeMap["pre-rect"]||et.find(function(Bs){return Bs.get("className")==="pre-rect"});if(kr&&!kr.destroyed){var Ta=(0,_.mix)({},kr.attr(),a.preRect);kr.attr((0,O.__assign)((0,O.__assign)({},Ta),{x:-T/2,y:-G/2,height:G}))}if(ct&&!ct.destroyed)if(!zt&&zt!==void 0)ct.remove(),delete et.shapeMap["pre-rect"];else{var fi=Mt.width,ei=Mt.height,Ia=Mt.x,Gi=Mt.y,Ri=Mt.offset,xa=(0,O.__rest)(Mt,["width","height","x","y","offset"]);ct.attr((0,O.__assign)((0,O.__assign)({},xa),{x:Ia||-T/2+fi+Ri,y:Gi||-ei/2,width:fi,height:ei}))}else zt&&this.drawLogoIcon(a,et);var ja=et.shapeMap["rect-state-icon"]||et.find(function(Bs){return Bs.get("className")==="rect-state-icon"}),di=ja?ja.attr():{},hi=(0,_.mix)({},di,a.stateIcon);if(ja){!hi.show&&hi.show!==void 0&&(ja.remove(),delete et.shapeMap["rect-state-icon"]);var qi=hi.width,ei=hi.height,Ia=hi.x,Gi=hi.y,fo=hi.offset,es=(0,O.__rest)(hi,["width","height","x","y","offset"]);ja.attr((0,O.__assign)((0,O.__assign)({},es),{x:Ia||T/2-qi+fo,y:Gi||-ei/2,width:qi,height:ei}))}else hi.show&&this.drawStateIcon(a,et);this.updateLinkPoints(a,et)},getOptions:function(a,e){return e==="move"?a:(0,_.deepMix)({},this.options,this.getCustomConfig(a)||{},a)}},"single-node"),zv("star",{options:{size:60,style:{stroke:$i.defaultNode.style.stroke,fill:$i.defaultNode.style.fill,lineWidth:$i.defaultNode.style.lineWidth},labelCfg:{style:{fill:$i.nodeLabel.style.fill,fontSize:$i.nodeLabel.style.fontSize,fontFamily:$i.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:$i.defaultNode.linkPoints.size,lineWidth:$i.defaultNode.linkPoints.lineWidth,fill:$i.defaultNode.linkPoints.fill,stroke:$i.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:(0,O.__assign)({},$i.nodeStateStyles)},shapeType:"star",labelPosition:"center",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).icon,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=e.addShape("path",{attrs:l,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e.shapeMap["".concat(this.type,"-keyShape")]=f;var d=s.width,v=s.height,w=s.show,E=s.text;return w&&(E?e.shapeMap["".concat(this.type,"-icon")]=e.addShape("text",{attrs:(0,O.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.shapeMap["".concat(this.type,"-icon")]=e.addShape("image",{attrs:(0,O.__assign)({x:-d/2,y:-v/2},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(a,e),f},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=i===void 0?{}:i,l=s.top,f=s.left,d=s.right,v=s.leftBottom,w=s.rightBottom,E=s.size,T=s.r,G=(0,O.__rest)(s,["top","left","right","leftBottom","rightBottom","size","r"]),U=this.getSize(a),et=U[0];if(d){var ct=Math.cos((18+72*0)/180*Math.PI)*et,Ct=Math.sin((18+72*0)/180*Math.PI)*et;e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},G),{x:ct,y:-Ct,r:E/2||T||5}),className:"link-point-right",name:"link-point-right"})}if(l){var ct=Math.cos((18+72*1)/180*Math.PI)*et,Ct=Math.sin((18+72*1)/180*Math.PI)*et;e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},G),{x:ct,y:-Ct,r:E/2||T||5}),className:"link-point-top",name:"link-point-top"})}if(f){var ct=Math.cos((18+72*2)/180*Math.PI)*et,Ct=Math.sin((18+72*2)/180*Math.PI)*et;e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},G),{x:ct,y:-Ct,r:E/2||T||5}),className:"link-point-left",name:"link-point-left"})}if(v){var ct=Math.cos((18+72*3)/180*Math.PI)*et,Ct=Math.sin((18+72*3)/180*Math.PI)*et;e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},G),{x:ct,y:-Ct,r:E/2||T||5}),className:"link-point-left-bottom",name:"link-point-left-bottom"})}if(w){var ct=Math.cos((18+72*4)/180*Math.PI)*et,Ct=Math.sin((18+72*4)/180*Math.PI)*et;e.shapeMap["link-point-right-bottom"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},G),{x:ct,y:-Ct,r:E/2||T||5}),className:"link-point-right-bottom",name:"link-point-right-bottom"})}},getPath:function(a){var e=this.getSize(a),i=e[0],s=i*3/8,l=a.innerR||s;return Zf.getStarPath(i,l)},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,_.mix)({},e,i),l=this.getPath(a),f=(0,O.__assign)({path:l},s);return f},update:function(a,e,i){var s=e.getContainer(),l=this.getOptions({}).style,f=this.getPath(a),d={stroke:a.color,path:f},v=e.get("keyShape"),w=(0,_.mix)({},l,v.attr(),d);w=(0,_.mix)(w,a.style),this.updateShape(a,e,w,!0,i),this.updateLinkPoints(a,s)},updateLinkPoints:function(a,e){var i=this.getOptions({}).linkPoints,s=e.shapeMap["link-point-left"]||e.find(function(or){return or.get("className")==="link-point-left"}),l=e.shapeMap["link-point-right"]||e.find(function(or){return or.get("className")==="link-point-right"}),f=e.shapeMap["link-point-top"]||e.find(function(or){return or.get("className")==="link-point-top"}),d=e.shapeMap["link-point-left-bottom"]||e.find(function(or){return or.get("className")==="link-point-left-bottom"}),v=e.shapeMap["link-point-left-bottom"]||e.find(function(or){return or.get("className")==="link-point-right-bottom"}),w=i,E=s||l||f||d||v;E&&(w=E.attr());var T=(0,_.mix)({},w,a.linkPoints),G=T.fill,U=T.stroke,et=T.lineWidth,ct=T.size/2;ct||(ct=T.r);var Ct=a.linkPoints?a.linkPoints:{left:void 0,right:void 0,top:void 0,leftBottom:void 0,rightBottom:void 0},Mt=Ct.left,Dt=Ct.right,zt=Ct.top,Qt=Ct.leftBottom,Ie=Ct.rightBottom,je=this.getSize(a),ze=je[0],mn={r:ct,fill:G,stroke:U,lineWidth:et},$n=Math.cos((18+72*0)/180*Math.PI)*ze,Tn=Math.sin((18+72*0)/180*Math.PI)*ze;l?!Dt&&Dt!==void 0?(l.remove(),delete e.shapeMap["link-point-right"]):l.attr((0,O.__assign)((0,O.__assign)({},mn),{x:$n,y:-Tn})):Dt&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},mn),{x:$n,y:-Tn}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),$n=Math.cos((18+72*1)/180*Math.PI)*ze,Tn=Math.sin((18+72*1)/180*Math.PI)*ze,f?!zt&&zt!==void 0?(f.remove(),delete e.shapeMap["link-point-top"]):f.attr((0,O.__assign)((0,O.__assign)({},mn),{x:$n,y:-Tn})):zt&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},mn),{x:$n,y:-Tn}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),$n=Math.cos((18+72*2)/180*Math.PI)*ze,Tn=Math.sin((18+72*2)/180*Math.PI)*ze,s?!Mt&&Mt!==void 0?(s.remove(),delete e.shapeMap["link-point-left"]):s.attr((0,O.__assign)((0,O.__assign)({},mn),{x:$n,y:-Tn})):Mt&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},mn),{x:$n,y:-Tn}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),$n=Math.cos((18+72*3)/180*Math.PI)*ze,Tn=Math.sin((18+72*3)/180*Math.PI)*ze,d?!Qt&&Qt!==void 0?(d.remove(),delete e.shapeMap["link-point-left-bottom"]):d.attr((0,O.__assign)((0,O.__assign)({},mn),{x:$n,y:-Tn})):Qt&&(e.shapeMap["link-point-left-bottom"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},mn),{x:$n,y:-Tn}),className:"link-point-left-bottom",name:"link-point-left-bottom",isAnchorPoint:!0})),$n=Math.cos((18+72*4)/180*Math.PI)*ze,Tn=Math.sin((18+72*4)/180*Math.PI)*ze,v?!Ie&&Ie!==void 0?(v.remove(),delete e.shapeMap["link-point-right-bottom"]):v.attr((0,O.__assign)((0,O.__assign)({},mn),{x:$n,y:-Tn})):Ie&&(e.shapeMap["link-point-right-bottom"]=e.addShape("circle",{attrs:(0,O.__assign)((0,O.__assign)({},mn),{x:$n,y:-Tn}),className:"link-point-right-bottom",name:"link-point-right-bottom",isAnchorPoint:!0}))}},"single-node");var Xg=Zf.defaultSubjectColors,tc="fan-shape-";zv("donut",{options:{size:$i.defaultNode.size,style:{x:0,y:0,stroke:$i.defaultNode.style.stroke,fill:$i.defaultNode.style.fill,lineWidth:$i.defaultNode.style.lineWidth},labelCfg:{style:{fill:$i.nodeLabel.style.fill,fontSize:$i.nodeLabel.style.fontSize,fontFamily:$i.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:$i.defaultNode.linkPoints.size,lineWidth:$i.defaultNode.linkPoints.lineWidth,fill:$i.defaultNode.linkPoints.fill,stroke:$i.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:(0,O.__assign)({},$i.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).icon,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=(0,_.deepMix)({},s,a.icon),d=e.addShape("circle",{attrs:l,className:"".concat(this.type,"-keyShape"),draggable:!0,name:"".concat(this.type,"-keyShape")});e.shapeMap["".concat(this.type,"-keyShape")]=d;var v=f.width,w=f.height,E=f.show,T=f.text;return E&&(T?e.shapeMap["".concat(this.type,"-icon")]=e.addShape("text",{attrs:(0,O.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},f),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.shapeMap["".concat(this.type,"-icon")]=e.addShape("image",{attrs:(0,O.__assign)({x:-v/2,y:-w/2},f),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),Q_(a,e,d),this.drawLinkPoints(a,e),d},updateShape:function(a,e,i,s,l){var f=e.get("keyShape");f.attr((0,O.__assign)({},i)),gE(a,e,f),this.updateLabel(a,e,l),s&&this.updateIcon(a,e)}},"circle");var Q_=function(a,e,i){var s=a.donutAttrs,l=s===void 0?{}:s,f=a.donutColorMap,d=f===void 0?{}:f,v=Object.keys(l).length;if(l&&v>1){var w=Nm(l,d),E=w.configs,T=w.totalValue;if(T){var G=Vb(i),U=G.lineWidth,et=G.arcR,ct=[et,0],Ct=0;if(v===1){Bh(e,{arcR:et,arcBegin:ct,beginAngle:Ct,config:E[0],fanIndex:0,lineWidth:U,totalValue:T,drawWhole:!0});return}for(var Mt=0;Mt<E.length;Mt++){var Dt=Bh(e,{arcR:et,arcBegin:ct,beginAngle:Ct,config:E[Mt],fanIndex:Mt,lineWidth:U,totalValue:T});if(Dt.shouldEnd)return;ct=Dt.arcBegin,Ct=Dt.beginAngle}}}},Bh=function(a,e){var i=e.arcR,s=e.arcBegin,l=e.beginAngle,f=e.config,d=e.fanIndex,v=e.lineWidth,w=e.totalValue,E=e.drawWhole,T=E===void 0?!1:E,G=e.updateShape,U=G===void 0?void 0:G,et=f.value/w;if(et<.001)return{beginAngle:l,arcBegin:s,shape:void 0,shouldEnd:!1};var ct,Ct,Mt;if(T||et>.999)ct=[i,1e-4],Mt=1;else{var Dt=et*Math.PI*2;Ct=l+Dt,ct=[i*Math.cos(Ct),-i*Math.sin(Ct)],Mt=Dt>Math.PI?1:0}var zt={path:[["M",s[0],s[1]],["A",i,i,0,Mt,0,ct[0],ct[1]]],stroke:f.color||(U==null?void 0:U.attr("stroke"))||Xg[d%Xg.length],lineWidth:v};return U?U.attr(zt):a.shapeMap["".concat(tc).concat(d)]=a.addShape("path",{attrs:zt,name:"".concat(tc).concat(d),draggable:!0}),{beginAngle:Ct,arcBegin:ct,shape:a.shapeMap["".concat(tc).concat(d)],shouldEnd:T||et>.999}},gE=function(a,e,i){var s=a.donutAttrs,l=a.donutColorMap,f=l===void 0?{}:l,d={},v=e.getContainer();if(s){var w=Nm(s,f),E=w.configs,T=w.totalValue;if(T)for(var G=Vb(i),U=G.lineWidth,et=G.arcR,ct=[et,0],Ct=0,Mt=0;Mt<E.length;Mt++){var Dt="".concat(tc).concat(Mt),zt=Bh(v,{arcR:et,arcBegin:ct,beginAngle:Ct,config:E[Mt],fanIndex:Mt,lineWidth:U,totalValue:T,drawWhole:E.length===1,updateShape:v.shapeMap[Dt]});if(zt.shape&&(d[Dt]=!0),zt.shouldEnd)break;ct=zt.arcBegin,Ct=zt.beginAngle}}var Qt=Object.keys(v.shapeMap).filter(function(Ie){return Ie.includes(tc)});Qt.forEach(function(Ie){d[Ie]||(v.shapeMap[Ie].remove(!0),delete v.shapeMap[Ie])})},Nm=function(a,e){var i=0,s=[];return Object.keys(a).forEach(function(l){var f=+a[l];isNaN(f)||(s.push({key:l,value:f,color:e[l]}),i+=f)}),{totalValue:i,configs:s}},Vb=function(a){var e=a.attr("r"),i=.6*e,s=(e+i)/2,l=e-i;return{lineWidth:l,arcR:s}},dv=function(a){var e=a.x,i=a.y;return{x:e,y:i,centerX:e,centerY:i,minX:e,minY:i,maxX:e,maxY:i,height:0,width:0}},J_=function(a){a===void 0&&(a=[]);var e=[],i=[];a.forEach(function(v){e.push(v.x),i.push(v.y)});var s=Math.min.apply(Math,e),l=Math.max.apply(Math,e),f=Math.min.apply(Math,i),d=Math.max.apply(Math,i);return{centerX:(s+l)/2,centerY:(f+d)/2,maxX:l,maxY:d,minX:s,minY:f,height:d-f,width:l-s}},tI=function(a,e){return Math.abs(a.centerX-e.centerX)*2<a.width+e.width&&Math.abs(a.centerY-e.centerY)*2<a.height+e.height},Uy=function(a){for(var e=[],i={},s=a.length,l=s-1;l>=0;l--){var f=a[l];f.id="".concat(f.x,"|||").concat(f.y),i[f.id]||(i[f.id]=f,e.push(f))}return e},mE=function(a){return Uy(a)},eI=function(a,e){return[a,{x:a.x,y:e.y},e]},Wy=function(a,e){return a.width||a.height?{centerX:a.centerX,centerY:a.centerY,minX:a.minX-e,minY:a.minY-e,maxX:a.maxX+e,maxY:a.maxY+e,height:a.height+2*e,width:a.width+2*e}:a},mg=function(a,e){var i=Math.abs(a.x-e.centerX),s=Math.abs(a.y-e.centerY);return i===0&&s===0?0:i/e.width>s/e.height},km=function(a,e,i){var s=mg(e,a);if(s===0){var l=a.centerX,f=a.centerY;return i.y<e.y?f=a.minY:i.x>e.x?l=a.maxX:i.x<e.x?l=a.minX:i.x===e.x&&(f=a.maxY),{x:l,y:f}}return s?{x:e.x>a.centerX?a.maxX:a.minX,y:e.y}:{x:e.x,y:e.y>a.centerY?a.maxY:a.minY}},Yg=function(a,e){var i=Math.min(a.minX,e.minX),s=Math.min(a.minY,e.minY),l=Math.max(a.maxX,e.maxX),f=Math.max(a.maxY,e.maxY);return{centerX:(i+l)/2,centerY:(s+f)/2,minX:i,minY:s,maxX:l,maxY:f,height:f-s,width:l-i}},pv=function(a){return[{x:a.minX,y:a.minY},{x:a.maxX,y:a.minY},{x:a.maxX,y:a.maxY},{x:a.minX,y:a.maxY}]},Vy=function(a,e){var i=a.x,s=a.y;return i<e.minX||i>e.maxX||s<e.minY||s>e.maxY},nI=function(a,e){return e<a.minX||e>a.maxX?[]:[{x:e,y:a.minY},{x:e,y:a.maxY}]},zA=function(a,e){return e<a.minY||e>a.maxY?[]:[{x:a.minX,y:e},{x:a.maxX,y:e}]},$A=function(a,e){return nI(a,e.x).concat(zA(a,e.y))},zh=function(a,e){return Math.abs(a.x-e.x)+Math.abs(a.y-e.y)},yE=function(a,e){var i=-2,s=0;return e.forEach(function(l){l&&(a.x===l.x&&(s+=i),a.y===l.y&&(s+=i))}),s},rI=function(a,e,i,s,l){return zh(a,e)+zh(a,i)+yE(a,[e,i,s,l])},GA=function c(a,e,i,s,l){l===void 0&&(l=0),a.unshift(e[s]),i[s]&&i[s]!==s&&l<=100&&c(a,e,i,i[s],l+1)},PD=function(a,e){var i=a.indexOf(e);i>-1&&a.splice(i,1)},jb=function(a,e,i,s){var l=i.x-a.x,f=i.y-a.y,d=s.x-a.x,v=s.y-a.y,w=i.x-e.x,E=i.y-e.y,T=s.x-e.x,G=s.y-e.y,U=l*v-f*d,et=w*G-E*T,ct=l*E-f*w,Ct=d*G-v*T;return U*et<=0&&ct*Ct<=0},Kg=function(a,e,i){if(i.width||i.height){var s=pv(i),l=s[0],f=s[1],d=s[2],v=s[3];return jb(a,e,l,f)||jb(a,e,l,v)||jb(a,e,f,d)||jb(a,e,d,v)}return!1},O0=function(a,e,i,s){var l=[];return a.forEach(function(f){if(f!==e&&(f.x===e.x||f.y===e.y)){if(Kg(f,e,i)||Kg(f,e,s))return;l.push(f)}}),Uy(l)},aI=function(a,e,i,s,l,f,d){var v,w=[],E=(v={},v[e.id]=e,v),T={},G={},U={};G[e.id]=0,U[e.id]=rI(e,i,e);var et=new Xy;et.add({id:e.id,value:U[e.id]});var ct={};a.forEach(function(Ie){ct[Ie.id]=Ie});for(var Ct;Object.keys(E).length;){var Mt=et.minId(!1);if(Mt)Ct=E[Mt];else break;if(Ct===i){var Dt=[];return GA(Dt,ct,T,i.id),Dt}delete E[Ct.id],et.remove(Ct.id),w.push(Ct);var zt=O0(a,Ct,s,l),Qt=function(je){je.forEach(function(ze){if(w.indexOf(ze)===-1){var mn=ze.id;E[mn]||(E[mn]=ze);var $n=U[Ct.id]+zh(Ct,ze);if(G[mn]&&$n>=G[mn]){et.add({id:mn,value:U[mn]});return}T[mn]=Ct.id,G[mn]=$n,U[mn]=G[mn]+rI(ze,i,e,f,d),et.add({id:mn,value:U[mn]})}})};Qt(zt)}return[e,i]},iI=function(a,e,i){return!(a.x===e.x&&e.x===i.x||a.y===e.y&&e.y===i.y)},oI=function(a,e,i,s){var l=zh(a,e),f=zh(i,e);l<s&&(s=l),f<s&&(s=f);var d={x:e.x-s/l*(e.x-a.x),y:e.y-s/l*(e.y-a.y)},v={x:e.x-s/f*(e.x-i.x),y:e.y-s/f*(e.y-i.y)};return[d,v]},yg=function(a,e){var i=[],s=a[0];return i.push("M".concat(s.x," ").concat(s.y)),a.forEach(function(l,f){var d=a[f+1],v=a[f+2];if(d&&v)if(iI(l,d,v)){var w=oI(l,d,v,e),E=w[0],T=w[1];i.push("L".concat(E.x," ").concat(E.y)),i.push("Q".concat(d.x," ").concat(d.y," ").concat(T.x," ").concat(T.y)),i.push("L".concat(T.x," ").concat(T.y))}else i.push("L".concat(d.x," ").concat(d.y));else d&&i.push("L".concat(d.x," ").concat(d.y))}),i.join("")},jy=function(a,e,i,s,l){var f,d;if(!i||!i.getType())f=dv(a);else if(i.getType()==="combo"){var v=i.getKeyShape().getBBox();if(v){var w=i.getModel(),E=w.x,T=w.y;f={x:E,y:T,width:v.width,height:v.height,minX:v.minX+E,maxX:v.maxX+E,minY:v.minY+T,maxY:v.maxY+T},f.centerX=(f.minX+f.maxX)/2,f.centerY=(f.minY+f.maxY)/2}else f=dv(a)}else f=i&&i.getBBox();if(!s||!s.getType())d=dv(e);else if(s.getType()==="combo"){var G=s.getKeyShape().getBBox();if(G){var U=s.getModel(),et=U.x,ct=U.y;d={x:et,y:ct,width:G.width,height:G.height,minX:G.minX+et,maxX:G.maxX+et,minY:G.minY+ct,maxY:G.maxY+ct},d.centerX=(d.minX+d.maxX)/2,d.centerY=(d.minY+d.maxY)/2}else d=dv(e)}else d=s&&s.getBBox();var Ct=Wy(f,l),Mt=Wy(d,l),Dt=km(Ct,a,e),zt=km(Mt,e,a),Qt=J_([Dt,zt]),Ie=Yg(Ct,Qt),je=Yg(Mt,Qt),ze=[];ze=ze.concat(pv(Ie)).concat(pv(je));var mn={x:(a.x+e.x)/2,y:(a.y+e.y)/2};[Qt,Ie,je].forEach(function(Tn){ze=ze.concat($A(Tn,mn).filter(function(or){return Vy(or,Ct)&&Vy(or,Mt)}))}),[{x:Dt.x,y:zt.y},{x:zt.x,y:Dt.y}].forEach(function(Tn){Vy(Tn,Ct)&&Vy(Tn,Mt)&&ze.push(Tn)}),ze.unshift(Dt),ze.push(zt),ze=Uy(ze);var $n=aI(ze,Dt,zt,f,d,a,e);return $n.unshift(a),$n.push(e),mE($n)},Hy=function(a){if(!(a==null?void 0:a.length))return a;for(var e=a[a.length-1],i={x:e.x,y:e.y},s=[e],l=[e],f=a.length-2;f>=0;f--){var d=a[f];if(d.x===i.x?s.push(d):(s=[d],i.x=d.x),d.y===i.y?l.push(d):(l=[d],i.y=d.y),s.length>2){var v=a.indexOf(s[1]);v>-1&&a.splice(v,1);continue}if(l.length>2){var v=a.indexOf(l[1]);v>-1&&a.splice(v,1)}}return a},Xy=function(){function c(){this.arr=[],this.map={},this.arr=[],this.map={}}return c.prototype._innerAdd=function(a,e){for(var i=[0,e-1];i[1]-i[0]>1;){var s=Math.floor((i[0]+i[1])/2);if(this.arr[s].value>a.value)i[1]=s;else if(this.arr[s].value<a.value)i[0]=s;else{this.arr.splice(s,0,a),this.map[a.id]=!0;return}}this.arr.splice(i[1],0,a),this.map[a.id]=!0},c.prototype.add=function(a){delete this.map[a.id];var e=this.arr.length;if(!e){this.arr.push(a),this.map[a.id]=!0;return}if(this.arr[e-1].value<a.value){this.arr.push(a),this.map[a.id]=!0;return}this._innerAdd(a,e)},c.prototype.remove=function(a){!this.map[a]||delete this.map[a]},c.prototype._clearAndGetMinId=function(){for(var a,e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?a=this.arr[e].id:this.arr.splice(e,1);return a},c.prototype._findFirstId=function(){for(;this.arr.length;){var a=this.arr.shift();if(this.map[a.id])return a.id}},c.prototype.minId=function(a){return a?this._clearAndGetMinId():this._findFirstId()},c}(),bE=function(a,e){return Math.abs(a.x-e.x)+Math.abs(a.y-e.y)},Hb=function(a,e){return Math.sqrt(Math.pow(a.x-e.x,2)+Math.pow(a.y-e.y,2))},Yy=function(a,e){return[a,e]},vv=function(a,e,i,s,l){return mE(jy(a,e,i,s,l.offset))},UA={offset:20,maxAllowedDirectionChange:Math.PI/2,maximumLoops:2e3,gridSize:10,directions:[{stepX:1,stepY:0},{stepX:-1,stepY:0},{stepX:0,stepY:1},{stepX:0,stepY:-1}],get penalties(){return{0:0,45:this.gridSize/2,90:this.gridSize/2}},distFunc:bE,fallbackRoute:vv},FD={maxAllowedDirectionChange:Math.PI/4,directions:[{stepX:1,stepY:0},{stepX:1,stepY:1},{stepX:0,stepY:1},{stepX:-1,stepY:1},{stepX:-1,stepY:0},{stepX:-1,stepY:-1},{stepX:0,stepY:-1},{stepX:1,stepY:-1}],distFunc:Hb,fallbackRoute:Yy},gv=function(a,e){var i=Math.round(Math.abs(a/e)),s=a<0?-1:1;return i<0?0:s*i},R0=function(a,e,i){var s={};return a.forEach(function(l){if(!!l)for(var f=Wy(l.getBBox(),i),d=gv(f.minX,e);d<=gv(f.maxX,e);d+=1)for(var v=gv(f.minY,e);v<=gv(f.maxY,e);v+=1)s["".concat(d,"|||").concat(v)]=!0}),s},xE=function(a,e){var i=e.x-a.x,s=e.y-a.y;return i||s?Math.atan2(s,i):0},Ky=function(a,e){var i=Math.abs(a-e);return i>Math.PI?2*Math.PI-i:i},kp=function(a,e,i){for(var s=Infinity,l=0,f=e.length;l<f;l++){var d=i(a,e[l]);d<s&&(s=d)}return s},wE=function(a,e,i,s,l){var f=[];if(!i)return[a];var d=l.directions,v=l.offset,w=i.getBBox(),E=e.x>w.minX&&e.x<w.maxX&&e.y>w.minY&&e.y<w.maxY,T=Wy(w,v);for(var G in T)T[G]=gv(T[G],l.gridSize);if(E){for(var U=0,et=d;U<et.length;U++)for(var ct=et[U],Ct=[[{x:T.minX,y:T.minY},{x:T.maxX,y:T.minY}],[{x:T.minX,y:T.minY},{x:T.minX,y:T.maxY}],[{x:T.maxX,y:T.minY},{x:T.maxX,y:T.maxY}],[{x:T.minX,y:T.maxY},{x:T.maxX,y:T.maxY}]],G=0;G<4;G++){var Mt=Ct[G],Dt=Zf.getLineIntersect(a,{x:a.x+ct.stepX*T.width,y:a.y+ct.stepY*T.height},Mt[0],Mt[1]);Dt&&!Kg(a,Dt,w)&&(Dt.id="".concat(Dt.x,"|||").concat(Dt.y),f.push(Dt))}return f}var zt=km(T,a,s);return zt.id="".concat(zt.x,"|||").concat(zt.y),[zt]},Xb=function(a,e,i,s){var l=xE(a,e),f=i[a.id];if(!f){var d=xE(s,a);return Ky(d,l)}var v=xE({x:f.x,y:f.y},a);return Ky(v,l)},EE=function(a,e,i,s,l,f,d){var v=[s],w=s,E=a.id,T=a.x,G=a.y,U={x:T,y:G,id:E};Xb(U,f,e,i)&&(w={x:f.x===s.x?s.x:U.x*d,y:f.y===s.y?s.y:U.y*d},v.unshift(w));for(var et=e[E];et&&et.id!==E;){var ct={x:T,y:G,id:E},Ct={x:et.x,y:et.y,id:et.id},Mt=Xb(Ct,ct,e,i);Mt&&(w={x:Ct.x===ct.x?w.x:Ct.x*d,y:Ct.y===ct.y?w.y:Ct.y*d},v.unshift(w)),E=Ct.id,T=Ct.x,G=Ct.y,et=e[E]}return v[0].x=T===i.x?l.x:w.x,v[0].y=G===i.y?l.y:w.y,v.unshift(l),v},sI=function(a,e,i,s,l){if(isNaN(a.x)||isNaN(e.x))return[];var f=(0,_.deepMix)(UA,l);f.obstacles=f.obstacles||[];var d=f.penalties,v=f.gridSize,w=R0(f.obstacles.concat([i,s]),v,f.offset),E={x:gv(a.x,v),y:gv(a.y,v)},T={x:gv(e.x,v),y:gv(e.y,v)};a.id="".concat(E.x,"|||").concat(E.y),e.id="".concat(T.x,"|||").concat(T.y);var G=wE(E,a,i,T,f),U=wE(T,e,s,E,f);G.forEach(function(xa){delete w[xa.id]}),U.forEach(function(xa){delete w[xa.id]});for(var et={},ct={},Ct={},Mt={},Dt={},zt=new Xy,Qt=0;Qt<G.length;Qt++){var Ie=G[Qt];et[Ie.id]=Ie,Mt[Ie.id]=0,Dt[Ie.id]=kp(Ie,U,f.distFunc),zt.add({id:Ie.id,value:Dt[Ie.id]})}var je=f.maximumLoops,ze,mn,$n,Tn,or,kr,Ta=Infinity,fi={};for(U.forEach(function(xa){fi["".concat(xa.x,"|||").concat(xa.y)]=!0}),Object.keys(et).forEach(function(xa){var ja=et[xa].id;Dt[ja]<=Ta&&(Ta=Dt[ja],ze=et[ja])});Object.keys(et).length>0&&je>0;){var ei=zt.minId((je+1)%30==0);if(ei)ze=et[ei];else break;if(fi["".concat(ze.x,"|||").concat(ze.y)])return EE(ze,Ct,E,e,a,T,v);delete et[ze.id],zt.remove(ze.id),ct[ze.id]=!0;for(var Qt=0;Qt<f.directions.length;Qt++){mn=f.directions[Qt];var Ia="".concat(Math.round(ze.x)+mn.stepX,"|||").concat(Math.round(ze.y)+mn.stepY);if($n={x:ze.x+mn.stepX,y:ze.y+mn.stepY,id:Ia},!ct[Ia]&&(kr=Xb(ze,$n,Ct,E),!(kr>f.maxAllowedDirectionChange)&&!w[Ia])){et[Ia]||(et[Ia]=$n);var Gi=d[kr];Tn=f.distFunc(ze,$n)+(isNaN(Gi)?v:Gi),or=Mt[ze.id]+Tn;var Ri=Mt[Ia];Ri&&or>=Ri||(Ct[Ia]=ze,Mt[Ia]=or,Dt[Ia]=or+kp($n,U,f.distFunc),zt.add({id:Ia,value:Dt[Ia]}))}}je-=1}return f.fallbackRoute(a,e,i,s,f)};Oh("polyline",{options:{color:$i.defaultEdge.color,size:$i.defaultEdge.size,style:{radius:0,offset:15,x:0,y:0,stroke:$i.defaultEdge.style.stroke,lineAppendWidth:$i.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:$i.edgeLabel.style.fill,fontSize:$i.edgeLabel.style.fontSize,fontFamily:$i.windowFontFamily}},routeCfg:{obstacles:[],maxAllowedDirectionChange:Math.PI,maximumLoops:500,gridSize:10},stateStyles:(0,O.__assign)({},$i.edgeStateStyles)},shapeType:"polyline",labelPosition:"center",drawShape:function(a,e){var i=this.getShapeStyle(a);i.radius===0&&delete i.radius;var s=e.addShape("path",{className:"edge-shape",name:"edge-shape",attrs:i});return e.shapeMap["edge-shape"]=s,s},getShapeStyle:function(a){var e=this.options.style,i={stroke:a.color},s=(0,_.mix)({},e,i,a.style);a=this.getPathPoints(a),this.radius=s.radius,this.offset=s.offset;var l=a.startPoint,f=a.endPoint,d=this.getControlPoints(a),v=[l];d&&(v=v.concat(d)),v.push(f);var w=a.sourceNode,E=a.targetNode,T=s.radius,G=this.options.routeCfg,U=(0,_.mix)({},G,a.routeCfg);U.offset=s.offset;var et=this.getPath(v,w,E,T,U,!Boolean(d));((0,_.isArray)(et)&&et.length<=1||(0,_.isString)(et)&&et.indexOf("L")===-1)&&(et="M0 0, L0 0"),(isNaN(l.x)||isNaN(l.y)||isNaN(f.x)||isNaN(f.y))&&(et="M0 0, L0 0");var ct=(0,_.mix)({},$i.defaultEdge.style,s,{lineWidth:a.size,path:et});return ct},updateShapeStyle:function(a,e){var i=e.getContainer();if(!!e.isVisible()){var s={stroke:a.color},l=i.shapeMap["edge-shape"]||i.find(function(Qt){return Qt.get("className")==="edge-shape"})||e.getKeyShape(),f=a.size;a=this.getPathPoints(a);var d=a.startPoint,v=a.endPoint,w=this.getControlPoints(a),E=[d];w&&(E=E.concat(w)),E.push(v);var T=l.attr(),G=(0,_.mix)({},s,T,a.style),U=a.sourceNode,et=a.targetNode,ct=G.radius,Ct=this.options.routeCfg,Mt=(0,_.mix)({},Ct,a.routeCfg);Mt.offset=G.offset;var Dt=this.getPath(E,U,et,ct,Mt,!Boolean(w));((0,_.isArray)(Dt)&&Dt.length<=1||(0,_.isString)(Dt)&&Dt.indexOf("L")===-1)&&(Dt="M0 0, L0 0"),(isNaN(d.x)||isNaN(d.y)||isNaN(v.x)||isNaN(v.y))&&(Dt="M0 0, L0 0"),T.endArrow&&G.endArrow===!1&&(a.style.endArrow={path:""}),T.startArrow&&G.startArrow===!1&&(a.style.startArrow={path:""});var zt=(0,_.mix)(s,l.attr(),{lineWidth:f,path:Dt},a.style);l&&l.attr(zt)}},getPath:function(a,e,i,s,l,f){var d=l.offset,v=l.obstacles,w=l.simple;if(!d||a.length>2||f===!1){if(s)return yg(a,s);var E=[];return(0,_.each)(a,function(et,ct){ct===0?E.push(["M",et.x,et.y]):E.push(["L",et.x,et.y])}),E}w!==!1&&!(v==null?void 0:v.length)&&(w=!0);var T=w?jy(a[a.length-1],a[0],i,e,d):sI(a[0],a[a.length-1],e,i,l);if(!T||!T.length)return"M0 0, L0 0";if(s){var G=yg(T,s);return G}T=Hy(T);var U=Zf.pointsToPolygon(T);return U}},"single-edge");var Dm=Wv.cloneEvent,SE=Wv.isNaN,CE=Math.abs,WA=10,uI=["shift","ctrl","alt","control"],lI={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,scalableRange:0,allowDragOnItem:!1}},getEvents:function(){return{mousedown:"onMouseDown",drag:"onDragMove",dragend:"onMouseUp","canvas:click":"onMouseUp",keyup:"onKeyUp",focus:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onMouseUp"}},updateViewport:function(a){var e=this.origin,i=+a.clientX,s=+a.clientY;if(!(SE(i)||SE(s))){var l=i-e.x,f=s-e.y;this.get("direction")==="x"?f=0:this.get("direction")==="y"&&(l=0),this.origin={x:i,y:s};var d=this.graph.get("width"),v=this.graph.get("height"),w=this.graph.get("canvas").getCanvasBBox(),E=this.scalableRange,T=this.scalableRange;E<1&&E>-1&&(E=d*E,T=v*T),(w.minX<=d+E&&w.minX+l>d+E||w.maxX+E>=0&&w.maxX+E+l<0)&&(l=0),(w.minY<=v+T&&w.minY+f>v+T||w.maxY+T>=0&&w.maxY+T+f<0)&&(f=0),this.graph.translate(l,f)}},onTouchStart:function(a){var e=this,i=a.originalEvent.touches,s=i[0],l=i[1];s&&l||(a.preventDefault(),this.mousedown=!0,e.onDragStart(a))},onMouseDown:function(a){this.mousedown=!0},onDragMove:function(a){!this.mousedown||(this.dragstart?this.onDrag(a):(this.dragstart=!0,this.onDragStart(a)))},onDragStart:function(a){var e=this,i=a.originalEvent;if(!(i&&a.name!=="touchstart"&&i.button!==0)&&!(a.name!=="touchstart"&&typeof window!="undefined"&&window.event&&!window.event.buttons&&!window.event.button)&&!!this.shouldBegin(a,this)&&!e.keydown&&!!this.allowDrag(a)){if(e.origin={x:a.clientX,y:a.clientY},e.dragging=!1,this.enableOptimize){for(var s=this.graph,l=s.getEdges(),f=0,d=l.length;f<d;f++){var v=l[f].get("group").get("children");!v||v.forEach(function(zt){zt.set("ori-visibility",zt.get("ori-visibility")||zt.get("visible")),zt.hide()})}for(var w=s.getNodes(),E=0,T=w.length;E<T;E++)for(var G=w[E].getContainer(),U=G.get("children"),et=0,ct=U;et<ct.length;et++){var Ct=ct[et],Mt=Ct.get("isKeyShape");Mt||(Ct.set("ori-visibility",Ct.get("ori-visibility")||Ct.get("visible")),Ct.hide())}}if(typeof window!="undefined"){var Dt=this;this.handleDOMContextMenu=function(zt){return Dt.onMouseUp(zt)},document.body.addEventListener("contextmenu",this.handleDOMContextMenu)}}},onTouchMove:function(a){var e=this,i=a.originalEvent.touches,s=i[0],l=i[1];if(s&&l){this.onMouseUp(a);return}a.preventDefault(),e.onDrag(a)},onDrag:function(a){if(!!this.mousedown){var e=this.graph;if(!this.keydown&&!!this.allowDrag(a)&&(a=Dm(a),!!this.origin)){if(this.dragging)a.type="drag",e.emit("canvas:drag",a);else{if(CE(this.origin.x-a.clientX)+CE(this.origin.y-a.clientY)<WA)return;this.shouldBegin(a,this)&&(a.type="dragstart",e.emit("canvas:dragstart",a),this.originPosition={x:a.clientX,y:a.clientY},this.dragging=!0)}this.shouldUpdate(a,this)&&this.updateViewport(a)}}},onMouseUp:function(a){var e,i;this.mousedown=!1,this.dragstart=!1;var s=this.graph;if(!this.keydown){var l=s.getZoom(),f=s.get("modeController"),d=(i=(e=f==null?void 0:f.modes[f.mode])===null||e===void 0?void 0:e.filter(function(ze){return ze.type==="zoom-canvas"}))===null||i===void 0?void 0:i[0],v=d?d.optimizeZoom||.1:0;if(this.enableOptimize){for(var w=s.getEdges(),E=0,T=w.length;E<T;E++){var G=w[E].get("group").get("children");!G||G.forEach(function(ze){var mn=ze.get("ori-visibility");ze.set("ori-visibility",void 0),mn&&ze.show()})}if(l>v)for(var U=s.getNodes(),et=0,ct=U.length;et<ct;et++)for(var Ct=U[et].getContainer(),Mt=Ct.get("children"),Dt=0,zt=Mt;Dt<zt.length;Dt++){var Qt=zt[Dt],Ie=Qt.get("isKeyShape");if(!Ie){var je=Qt.get("ori-visibility");Qt.set("ori-visibility",void 0),je&&Qt.show()}}}if(!this.dragging){this.origin=null;return}a=Dm(a),this.shouldEnd(a,this)&&this.updateViewport(a),a.type="dragend",a.dx=a.clientX-this.originPosition.x,a.dy=a.clientY-this.originPosition.y,s.emit("canvas:dragend",a),this.endDrag(),typeof window!="undefined"&&document.body.removeEventListener("contextmenu",this.handleDOMContextMenu)}},endDrag:function(){this.origin=null,this.dragging=!1,this.dragbegin=!1,this.mousedown=!1,this.dragstart=!1},onKeyDown:function(a){var e=this,i=a.key;!i||(uI.indexOf(i.toLowerCase())>-1?e.keydown=!0:e.keydown=!1)},onKeyUp:function(){this.keydown=!1,this.origin=null,this.dragging=!1,this.dragbegin=!1},allowDrag:function(a){var e,i,s=a.target,l=s&&s.isCanvas&&s.isCanvas();if((0,_.isBoolean)(this.allowDragOnItem)&&!this.allowDragOnItem&&!l)return!1;if((0,_.isObject)(this.allowDragOnItem)){var f=this.allowDragOnItem,d=f.node,v=f.edge,w=f.combo,E=(i=(e=a.item)===null||e===void 0?void 0:e.getType)===null||i===void 0?void 0:i.call(e);if(!d&&E==="node"||!v&&E==="edge"||!w&&E==="combo")return!1}return!0}},sp={getDefaultCfg:function(){return{updateEdge:!0,delegateStyle:{},enableDelegate:!1,onlyChangeComboSize:!1,comboActiveState:"",selectedState:"selected",enableOptimize:!1,enableDebounce:!1,enableStack:!0}},getEvents:function(){return{"node:mousedown":"onMouseDown",drag:"onDragMove",dragend:"onDragEnd","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave","combo:drop":"onDropCombo","node:drop":"onDropNode","canvas:drop":"onDropCanvas",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onDragEnd",afterchangedata:"onDragEnd"}},validationCombo:function(a){if(!this.origin||!a||a.destroyed)return!1;var e=a.getType();return e==="combo"},onTouchStart:function(a){if(!!a.item){var e=this;try{var i=a.originalEvent.touches,s=i[0],l=i[1];if(s&&l)return;a.preventDefault()}catch(f){console.warn("Touch original event not exist!")}this.mousedown={item:a.item,target:a.target,origin:{x:a.x,y:a.y}},this.dragstart=!0,e.onDragStart(a)}},onTouchMove:function(a){var e=this;try{var i=a.originalEvent.touches,s=i[0],l=i[1];if(s&&l){e.onDragEnd(a);return}a.preventDefault()}catch(f){console.warn("Touch original event not exist!")}e.onDrag(a)},onMouseDown:function(a){this.mousedown={item:a.item,target:a.target,origin:{x:a.x,y:a.y}},typeof window!="undefined"&&!this.windowEventBinded&&(this.windowEventBinded=!0,document.body.addEventListener("contextmenu",this.onDragEnd.bind(this)),document.body.addEventListener("mouseup",this.onDragEnd.bind(this)))},onDragMove:function(a){var e,i;if(((i=(e=a.item)===null||e===void 0?void 0:e.getType)===null||i===void 0?void 0:i.call(e))!=="node"){this.onDragEnd();return}!this.mousedown||(this.dragstart?this.onDrag((0,O.__assign)((0,O.__assign)({},a),this.mousedown)):(this.dragstart=!0,this.onDragStart(a)))},onDragStart:function(a){var e=this;if(this.currentShouldEnd=!0,!!this.shouldBegin((0,O.__assign)((0,O.__assign)({},a),this.mousedown),this)){var i=this.mousedown,s=i.item,l=i.target;if(!(!s||s.destroyed||s.hasLocked())){var f=s.getContainer();if(f.set("capture",!1),this.cachedCaptureItems||(this.cachedCaptureItems=[]),this.cachedCaptureItems.push(s),l){var d=l.get("isAnchorPoint");if(d)return}var v=this.graph;this.targets=[],this.targetCombo=null;var w=v.findAllByState("node",this.selectedState),E=s.get("id"),T=w.filter(function(U){var et=U.get("id");return E===et});if(T.length===0?this.targets.push(s):w.length>1?w.forEach(function(U){var et=U.hasLocked();et||e.targets.push(U)}):this.targets.push(s),this.graph.get("enabledStack")&&this.enableStack){var G=[];this.targets.forEach(function(U){var et=U.getModel(),ct=et.x,Ct=et.y,Mt=et.id;G.push({x:ct,y:Ct,id:Mt})}),this.set("beforeDragNodes",G)}this.hidenEdge={},this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach(function(U){var et=U.getEdges();et.forEach(function(ct){!ct.isVisible()||(e.hidenEdge[ct.getID()]=!0,ct.hide())})}),this.origin=this.mousedown.origin,this.point={},this.originPoint={}}}},onDrag:function(a){var e=this;if(!(!this.mousedown||!this.origin)&&!!this.shouldUpdate(a,this))if(this.get("enableDelegate"))this.updateDelegate(a);else if(this.enableDebounce)this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:a,updateEdge:this.get("updateEdge"),onlyChangeComboSize:this.onlyChangeComboSize,updateParentCombos:this.updateParentCombos});else{var i={};this.targets.map(function(s){e.update(s,a);var l=s.getModel().comboId;l&&(i[l]=e.graph.findById(l))}),this.onlyChangeComboSize&&this.updateParentCombos()}},onDragEnd:function(a){var e=this,i;if(this.mousedown=!1,this.dragstart=!1,typeof window!="undefined"&&this.windowEventBinded&&(this.windowEventBinded=!1,document.body.removeEventListener("contextmenu",this.onDragEnd.bind(this)),document.body.removeEventListener("mouseup",this.onDragEnd.bind(this))),!!this.origin){(i=this.cachedCaptureItems)===null||i===void 0||i.forEach(function(f){var d=f.getContainer();d.set("capture",!0)}),this.cachedCaptureItems=[],this.delegateRect&&(this.delegateRect.remove(),this.delegateRect=null),this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach(function(f){var d=f.getEdges();d.forEach(function(v){e.hidenEdge[v.getID()]&&v.show(),v.refresh()})}),this.hidenEdge={};var s=this.graph;if(s.get("enabledStack")&&this.enableStack){var l={before:{nodes:[],edges:[],combos:[]},after:{nodes:[],edges:[],combos:[]}};this.get("beforeDragNodes").forEach(function(f){l.before.nodes.push(f)}),this.targets.forEach(function(f){var d=f.getModel(),v=d.x,w=d.y,E=d.id;l.after.nodes.push({x:v,y:w,id:E})}),s.pushStack("update",(0,_.clone)(l))}s.emit("dragnodeend",{items:this.targets,targetItem:null}),this.point={},this.origin=null,this.originPoint={},this.targets.length=0,this.targetCombo=null}},onDropCombo:function(a){var e=a.item;if(this.currentShouldEnd=this.shouldEnd(a,e,this),this.updatePositions(a,!this.currentShouldEnd),!(!this.currentShouldEnd||!this.validationCombo(e))){var i=this.graph;if(this.comboActiveState&&i.setItemState(e,this.comboActiveState,!1),this.targetCombo=e,this.onlyChangeComboSize)i.updateCombos();else{var s=e.getModel();this.targets.map(function(l){var f=l.getModel();f.comboId!==s.id&&i.updateComboTree(l,s.id)}),i.updateCombo(e)}i.emit("dragnodeend",{items:this.targets,targetItem:this.targetCombo})}},onDropCanvas:function(a){var e=this.graph;this.currentShouldEnd=this.shouldEnd(a,void 0,this),this.updatePositions(a,!this.currentShouldEnd),!(!this.targets||this.targets.length===0||!this.currentShouldEnd)&&(this.onlyChangeComboSize?this.updateParentCombos():this.targets.map(function(i){var s=i.getModel();s.comboId&&e.updateComboTree(i)}))},onDropNode:function(a){if(!(!this.targets||this.targets.length===0)){var e=this,i=a.item,s=e.graph,l=i.getModel().comboId,f=l?s.findById(l):void 0;if(this.currentShouldEnd=this.shouldEnd(a,f,this),this.updatePositions(a,!this.currentShouldEnd),!!this.currentShouldEnd){if(this.onlyChangeComboSize)this.updateParentCombos();else if(l){var d=s.findById(l);e.comboActiveState&&s.setItemState(d,e.comboActiveState,!1),this.targets.map(function(v){var w=v.getModel();l!==w.comboId&&s.updateComboTree(v,l)}),s.updateCombo(d)}else this.targets.map(function(v){var w=v.getModel();w.comboId&&s.updateComboTree(v)});s.emit("dragnodeend",{items:this.targets,targetItem:i})}}},onDragEnter:function(a){var e=a.item;if(!!this.validationCombo(e)){var i=this.graph;this.comboActiveState&&i.setItemState(e,this.comboActiveState,!0)}},onDragLeave:function(a){var e=a.item;if(!!this.validationCombo(e)){var i=this.graph;this.comboActiveState&&i.setItemState(e,this.comboActiveState,!1)}},updatePositions:function(a,e){var i=this;!this.targets||this.targets.length===0||(this.get("enableDelegate")?this.enableDebounce?this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:a,updateEdge:this.get("updateEdge"),onlyChangeComboSize:this.onlyChangeComboSize,updateParentCombos:this.updateParentCombos}):e||this.targets.map(function(s){return i.update(s,a)}):this.targets.map(function(s){return i.update(s,a,e)}))},update:function(a,e,i){var s=this.origin,l=a.get("model"),f=a.get("id");this.point[f]||(this.point[f]={x:l.x||0,y:l.y||0});var d=e.x-s.x+this.point[f].x,v=e.y-s.y+this.point[f].y;i&&(d+=s.x-e.x,v+=s.y-e.y);var w={x:d,y:v};this.get("updateEdge")?this.graph.updateItem(a,w,!1):a.updatePosition(w)},debounceUpdate:(0,_.debounce)(function(c){var a=c.targets,e=c.graph,i=c.point,s=c.origin,l=c.evt,f=c.updateEdge,d=c.onlyChangeComboSize,v=c.updateParentCombos;a.map(function(w){var E=w.get("model"),T=w.get("id");i[T]||(i[T]={x:E.x||0,y:E.y||0});var G=l.x-s.x+i[T].x,U=l.y-s.y+i[T].y,et={x:G,y:U};f?e.updateItem(w,et,!1):w.updatePosition(et)}),d&&v(e,a)},50,!0),updateDelegate:function(a){var e=this.graph;if(this.delegateRect){var G=a.x-this.origin.x+this.originPoint.minX,U=a.y-this.origin.y+this.originPoint.minY;this.delegateRect.attr({x:G,y:U})}else{var i=e.get("group"),s=(0,_.deepMix)({},hg.delegateStyle,this.delegateStyle),l=this.calculationGroupPosition(a),f=l.x,d=l.y,v=l.width,w=l.height,E=l.minX,T=l.minY;this.originPoint={x:f,y:d,width:v,height:w,minX:E,minY:T},this.delegateRect=i.addShape("rect",{attrs:(0,O.__assign)({width:v,height:w,x:f,y:d},s),name:"rect-delegate-shape"}),this.delegate=this.delegateRect,this.delegateRect.set("capture",!1)}},calculationGroupPosition:function(a){var e=this.targets;e.length===0&&e.push(a.item);for(var i=Infinity,s=-Infinity,l=Infinity,f=-Infinity,d=0;d<e.length;d++){var v=e[d],w=v.getBBox(),E=w.minX,T=w.minY,G=w.maxX,U=w.maxY;E<i&&(i=E),T<l&&(l=T),G>s&&(s=G),U>f&&(f=U)}var et=Math.floor(i),ct=Math.floor(l),Ct=Math.ceil(s)-Math.floor(i),Mt=Math.ceil(f)-Math.floor(l);return{x:et,y:ct,width:Ct,height:Mt,minX:i,minY:l}},updateParentCombos:function(a,e){var i=a||this.graph,s=e||this.targets,l={};s==null||s.forEach(function(f){var d=f.getModel().comboId;d&&(l[d]=i.findById(d))}),Object.values(l).forEach(function(f){f&&i.updateCombo(f)})}},Yb={getDefaultCfg:function(){return{trigger:"mouseenter",activeState:"active",inactiveState:"inactive",resetSelected:!1,shouldUpdate:function(){return!0}}},getEvents:function(){return this.get("trigger")==="mouseenter"?{"node:mouseenter":"setAllItemStates","combo:mouseenter":"setAllItemStates","node:mouseleave":"clearActiveState","combo:mouseleave":"clearActiveState"}:{"node:click":"setAllItemStates","combo:click":"setAllItemStates","canvas:click":"clearActiveState","node:touchstart":"setOnTouchStart","combo:touchstart":"setOnTouchStart","canvas:touchstart":"clearOnTouchStart"}},setOnTouchStart:function(a){var e=this;try{var i=a.originalEvent.touches,s=i[0],l=i[1];if(s&&l)return;a.preventDefault()}catch(f){console.warn("Touch original event not exist!")}e.setAllItemStates(a)},clearOnTouchStart:function(a){var e=this;try{var i=a.originalEvent.touches,s=i[0],l=i[1];if(s&&l)return;a.preventDefault()}catch(f){console.warn("Touch original event not exist!")}e.clearActiveState(a)},setAllItemStates:function(a){clearTimeout(this.timer),this.throttleSetAllItemStates(a,this)},clearActiveState:function(a){var e=this;this.timer=setTimeout(function(){e.throttleClearActiveState(a,e)},50)},throttleSetAllItemStates:(0,_.throttle)(function(c,a){var e=c.item,i=a.graph;if(!(!i||i.destroyed)&&(a.item=e,!!a.shouldUpdate(c.item,{event:c,action:"activate"},a))){for(var s=a.activeState,l=a.inactiveState,f=i.getNodes(),d=i.getCombos(),v=i.getEdges(),w=i.get("vedges"),E=f.length,T=d.length,G=v.length,U=w.length,et=a.inactiveItems||{},ct=a.activeItems||{},Ct=0;Ct<E;Ct++){var Mt=f[Ct],Dt=Mt.getID(),zt=Mt.hasState("selected");a.resetSelected&&zt&&i.setItemState(Mt,"selected",!1),ct[Dt]&&(i.setItemState(Mt,s,!1),delete ct[Dt]),l&&!et[Dt]&&(i.setItemState(Mt,l,!0),et[Dt]=Mt)}for(var Ct=0;Ct<T;Ct++){var Qt=d[Ct],Ie=Qt.getID(),zt=Qt.hasState("selected");a.resetSelected&&zt&&i.setItemState(Qt,"selected",!1),ct[Ie]&&(i.setItemState(Qt,s,!1),delete ct[Ie]),l&&!et[Ie]&&(i.setItemState(Qt,l,!0),et[Ie]=Qt)}for(var Ct=0;Ct<G;Ct++){var je=v[Ct],ze=je.getID();ct[ze]&&(i.setItemState(je,s,!1),delete ct[ze]),l&&!et[ze]&&(i.setItemState(je,l,!0),et[ze]=je)}for(var Ct=0;Ct<U;Ct++){var mn=w[Ct],$n=mn.getID();ct[$n]&&(i.setItemState(mn,s,!1),delete ct[$n]),l&&!et[$n]&&(i.setItemState(mn,l,!0),et[$n]=mn)}if(e&&!e.destroyed){l&&(i.setItemState(e,l,!1),delete et[e.getID()]),ct[e.getID()]||(i.setItemState(e,s,!0),ct[e.getID()]=e);for(var Tn=e.getEdges(),or=Tn.length,Ct=0;Ct<or;Ct++){var je=Tn[Ct],ze=je.getID(),kr=void 0;je.getSource()===e?kr=je.getTarget():kr=je.getSource();var Ta=kr.getID();l&&et[Ta]&&(i.setItemState(kr,l,!1),delete et[Ta]),ct[Ta]||(i.setItemState(kr,s,!0),ct[Ta]=kr),et[ze]&&(i.setItemState(je,l,!1),delete et[ze]),ct[ze]||(i.setItemState(je,s,!0),ct[ze]=je),je.toFront()}}a.activeItems=ct,a.inactiveItems=et,i.emit("afteractivaterelations",{item:c.item,action:"activate"})}},50,{trailing:!0,leading:!0}),throttleClearActiveState:(0,_.throttle)(function(c,a){var e=a.get("graph");if(!(!e||e.destroyed)&&!!a.shouldUpdate(c.item,{event:c,action:"deactivate"},a)){var i=a.activeState,s=a.inactiveState,l=a.activeItems||{},f=a.inactiveItems||{};Object.values(l).filter(function(d){return!d.destroyed}).forEach(function(d){e.clearItemStates(d,i)}),Object.values(f).filter(function(d){return!d.destroyed}).forEach(function(d){e.clearItemStates(d,s)}),a.activeItems={},a.inactiveItems={},e.emit("afteractivaterelations",{item:c.item||a.get("item"),action:"deactivate"})}},50,{trailing:!0,leading:!0})},Zg=Math.min,Zy=Math.max,qy=Math.abs,Qy="shift",Kb=["drag","shift","ctrl","alt","control"],Zb={getDefaultCfg:function(){return{brushStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:Qy,includeEdges:!0,includeCombos:!1,selectedEdges:[],selectedNodes:[],selectedCombos:[]}},getEvents:function(){return Kb.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=Qy,console.warn("Behavior brush-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")),this.trigger==="drag"?{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates"}:{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates",keyup:"onKeyUp",keydown:"onKeyDown"}},onMouseDown:function(a){var e=a.item,i=this.brush;e||this.trigger!=="drag"&&!this.keydown||(this.selectedNodes&&this.selectedNodes.length!==0&&this.clearStates(),i||(i=this.createBrush()),this.originPoint={x:a.canvasX,y:a.canvasY},i.attr({width:0,height:0}),i.show(),this.dragging=!0)},onMouseMove:function(a){!this.dragging||this.trigger!=="drag"&&!this.keydown||this.updateBrush(a)},onMouseUp:function(a){var e=this.graph;!this.brush&&!this.dragging||this.trigger!=="drag"&&!this.keydown||(this.brush.remove(!0),this.brush=null,this.getSelectedNodes(a),this.dragging=!1)},clearStates:function(){var a=this,e=a.graph,i=a.selectedState,s=e.findAllByState("node",i),l=e.findAllByState("edge",i),f=e.findAllByState("combo",i);s.forEach(function(d){return e.setItemState(d,i,!1)}),l.forEach(function(d){return e.setItemState(d,i,!1)}),f.forEach(function(d){return e.setItemState(d,i,!1)}),this.selectedNodes=[],this.selectedEdges=[],this.selectedCombos=[],this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges,this.selectedCombos),e.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1})},isBBoxCenterInRect:function(a,e,i,s,l){var f=a.getBBox();return f.centerX>=e&&f.centerX<=i&&f.centerY>=s&&f.centerY<=l},getSelectedNodes:function(a){var e=this,i=this,s=i.graph,l=i.originPoint,f=i.shouldUpdate,d=i.isBBoxCenterInRect,v=this.selectedState,w={x:a.x,y:a.y},E=s.getPointByCanvas(l.x,l.y),T=Zg(w.x,E.x),G=Zy(w.x,E.x),U=Zg(w.y,E.y),et=Zy(w.y,E.y),ct=[],Ct=[];s.getNodes().forEach(function(zt){if(zt.isVisible()&&d(zt,T,G,U,et)&&f(zt,"select",e)){ct.push(zt);var Qt=zt.getModel();Ct.push(Qt.id),s.setItemState(zt,v,!0)}});var Mt=[];this.includeEdges&&ct.forEach(function(zt){var Qt=zt.getOutEdges();Qt.forEach(function(Ie){if(!!Ie.isVisible()){var je=Ie.getModel(),ze=je.source,mn=je.target;Ct.includes(ze)&&Ct.includes(mn)&&f(Ie,"select",e)&&(Mt.push(Ie),s.setItemState(Ie,e.selectedState,!0))}})});var Dt=[];this.includeCombos&&s.getCombos().forEach(function(zt){if(zt.isVisible()&&d(zt,T,G,U,et)&&f(zt,"select",e)){Dt.push(zt);var Qt=zt.getModel();Ct.push(Qt.id),s.setItemState(zt,v,!0)}}),this.selectedEdges=Mt,this.selectedNodes=ct,this.selectedCombos=Dt,this.onSelect&&this.onSelect(ct,Mt,Dt),s.emit("nodeselectchange",{selectedItems:{nodes:ct,edges:Mt,combos:Dt},select:!0})},createBrush:function(){var a=this,e=a.graph.get("canvas").addShape("rect",{attrs:a.brushStyle,capture:!1,name:"brush-shape"});return this.brush=e,this.delegate=e,e},updateBrush:function(a){var e=this.originPoint;this.brush.attr({width:qy(a.canvasX-e.x),height:qy(a.canvasY-e.y),x:Zg(a.canvasX,e.x),y:Zg(a.canvasY,e.y)})},onKeyDown:function(a){var e=a.key;if(!!e){var i=this.trigger.toLowerCase(),s=e.toLowerCase();s===i||s==="control"&&i==="ctrl"||s==="ctrl"&&i==="control"?this.keydown=!0:this.keydown=!1}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.keydown=!1}},_E="shift",$h=["shift","ctrl","alt","control"],Jy={getDefaultCfg:function(){return{multiple:!0,trigger:_E,selectedState:"selected",selectNode:!0,selectEdge:!1,selectCombo:!0}},getEvents:function(){var a=this;return $h.indexOf(a.trigger.toLowerCase())>-1||(a.trigger=_E,console.warn("Behavior click-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")),a.multiple?{"node:click":"onClick","combo:click":"onClick","edge:click":"onClick","canvas:click":"onCanvasClick",keyup:"onKeyUp",keydown:"onKeyDown"}:{"node:click":"onClick","combo:click":"onClick","edge:click":"onClick","canvas:click":"onCanvasClick"}},onClick:function(a){var e=this,i=a.item;if(!(!i||i.destroyed)){var s=i.getType(),l=e.graph,f=e.keydown,d=e.multiple,v=e.shouldUpdate,w=e.shouldBegin;if(!!w(a,e)){if(!f||!d){var E=l.findAllByState("node",e.selectedState).concat(l.findAllByState("edge",e.selectedState)).concat(l.findAllByState("combo",e.selectedState));(0,_.each)(E,function(ct){ct!==i&&l.setItemState(ct,e.selectedState,!1)})}var T=function(){switch(s){case"node":return e.selectNode;case"edge":return e.selectEdge;case"combo":return e.selectCombo;default:return!1}}();if(!T){var G=l.findAllByState("node",e.selectedState),U=l.findAllByState("edge",e.selectedState),et=l.findAllByState("combo",e.selectedState);l.emit("nodeselectchange",{selectedItems:{nodes:G,edges:U,combos:et},select:!1});return}if(i.hasState(e.selectedState)){v(a,e)&&l.setItemState(i,e.selectedState,!1);var G=l.findAllByState("node",e.selectedState),U=l.findAllByState("edge",e.selectedState),et=l.findAllByState("combo",e.selectedState);l.emit("nodeselectchange",{target:i,selectedItems:{nodes:G,edges:U,combos:et},select:!1})}else{v(a,e)&&l.setItemState(i,e.selectedState,!0);var G=l.findAllByState("node",e.selectedState),U=l.findAllByState("edge",e.selectedState),et=l.findAllByState("combo",e.selectedState);l.emit("nodeselectchange",{target:i,selectedItems:{nodes:G,edges:U,combos:et},select:!0})}}}},onCanvasClick:function(a){var e=this,i=this,s=i.graph,l=i.shouldBegin;if(!!l(a,this)){var f=s.findAllByState("node",this.selectedState);(0,_.each)(f,function(w){s.setItemState(w,e.selectedState,!1)});var d=s.findAllByState("edge",this.selectedState);(0,_.each)(d,function(w){s.setItemState(w,e.selectedState,!1)});var v=s.findAllByState("combo",this.selectedState);(0,_.each)(v,function(w){s.setItemState(w,e.selectedState,!1)}),s.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1})}},onKeyDown:function(a){var e=this,i=a.key;!i||(i.toLowerCase()===this.trigger.toLowerCase()||i.toLowerCase()==="control"?e.keydown=!0:e.keydown=!1)},onKeyUp:function(){var a=this;a.keydown=!1}},t1=ie,L0=.05,e1={getDefaultCfg:function(){return{sensitivity:2,minZoom:void 0,maxZoom:void 0,enableOptimize:!1,optimizeZoom:.1,fixSelectedItems:{fixAll:!1,fixLineWidth:!1,fixLabel:!1,fixState:"selected"},animate:!1,animateCfg:{duration:500}}},getEvents:function(){var a=this.fixSelectedItems;return a.fixState||(a.fixState="selected"),a.fixAll&&(a.fixLineWidth=!0,a.fixLabel=!0),{wheel:"onWheel",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd"}},onTouchStart:function(a){var e=a.originalEvent.touches,i=e[0],s=e[1];a.preventDefault(),!!s&&(this.shouldBegin&&!this.shouldBegin(a,this)||(this.startPoint={pageX:i.pageX,pageY:i.pageY},this.moveable=!0,s&&(this.endPoint={pageX:s.pageX,pageY:s.pageY}),this.originScale=this.graph.getZoom()||this.currentScale||1))},onTouchMove:function(a){if(!!this.moveable){a.preventDefault();var e=a.originalEvent.touches,i=e[0],s=e[1];if(!!s){this.endPoint||(this.endPoint={pageX:s.pageX,pageY:s.pageY});var l=function(ct,Ct){return Math.hypot(Ct.x-ct.x,Ct.y-ct.y)},f=l({x:i.pageX,y:i.pageY},{x:s.pageX,y:s.pageY})/l({x:this.startPoint.pageX,y:this.startPoint.pageY},{x:this.endPoint.pageX,y:this.endPoint.pageY}),d=this.originScale*f;this.currentScale=d;var v=this.get("minZoom")||this.graph.get("minZoom"),w=this.get("maxZoom")||this.graph.get("maxZoom");if(!(d>w||d<v)){var E=this.get("animate"),T=this.get("animateCfg"),G=this.graph.get("canvas"),U=G.getPointByClient(a.clientX,a.clientY);this.graph.zoomTo(d,{x:U.x,y:U.y},E,T),this.graph.emit("wheelzoom",a)}}}},onTouchEnd:function(){this.moveable=!1,this.endPoint=null},onWheel:function(a){var e=this,i=this,s=i.graph,l=i.fixSelectedItems;if(!(this.shouldBegin&&!this.shouldBegin(a,this))&&!!this.shouldUpdate(a,this)){a.preventDefault();var f=s.get("canvas"),d=f.getPointByClient(a.clientX,a.clientY),v=this.get("sensitivity"),w=s.getZoom(),E=w,T=w;a.wheelDelta<0?E=1-L0*v:E=1/(1-L0*v),T=w*E;var G=this.get("minZoom")||s.get("minZoom"),U=this.get("maxZoom")||s.get("maxZoom");T>U?T=U:T<G&&(T=G);var et=this.get("enableOptimize");if(et){var ct=this.get("optimizeZoom"),Ct=this.get("optimized"),Mt=s.getNodes(),Dt=s.getEdges(),zt=Mt.length,Qt=Dt.length;if(!Ct){for(var Ie=0;Ie<zt;Ie++){var je=Mt[Ie];if(!je.destroyed)for(var ze=je.get("group").get("children"),mn=ze.length,$n=0;$n<mn;$n++){var Tn=ze[$n];!Tn.destoryed&&!Tn.get("isKeyShape")&&(Tn.set("ori-visibility",Tn.get("ori-visibility")||Tn.get("visible")),Tn.hide())}}for(var or=0;or<Qt;or++)for(var kr=Dt[or],ze=kr.get("group").get("children"),mn=ze.length,$n=0;$n<mn;$n++){var Tn=ze[$n];Tn.set("ori-visibility",Tn.get("ori-visibility")||Tn.get("visible")),Tn.hide()}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var Ta=setTimeout(function(){var Qs=s.getZoom(),Ju=e.get("optimized");if(Ju){e.set("optimized",!1);for(var Js=0;Js<zt;Js++){var Xu=Mt[Js],Il=Xu.get("group").get("children"),Fo=Il.length;if(Qs<ct){var su=Xu.getKeyShape(),Iu=su.get("ori-visibility");su.set("ori-visibility",void 0),Iu&&su.show()}else for(var Nl=0;Nl<Fo;Nl++){var Tu=Il[Nl],Iu=Tu.get("ori-visibility");Tu.set("ori-visibility",void 0),!Tu.get("visible")&&Iu&&Iu&&Tu.show()}}for(var Gu=0;Gu<Qt;Gu++){var hc=Dt[Gu],Il=hc.get("group").get("children"),Fo=Il.length;if(Qs<ct){var su=hc.getKeyShape(),Iu=su.get("ori-visibility");su.set("ori-visibility",void 0),Iu&&su.show()}else for(var Nl=0;Nl<Fo;Nl++){var Tu=Il[Nl];if(!Tu.get("visible")){var Iu=Tu.get("ori-visibility");Tu.set("ori-visibility",void 0),Iu&&Tu.show()}}}}},100);this.set("timeout",Ta)}if(w<=1){var fi=void 0,ei=void 0;if(l.fixAll||l.fixLineWidth||l.fixLabel){fi=s.findAllByState("node",l.fixState),ei=s.findAllByState("edge",l.fixState);for(var Ia=w/T,Gi=fi.length,Ri=0;Ri<Gi;Ri++){var je=fi[Ri],xa=je.getContainer(),ja=je.getModel(),di=je.getOriginStyle(),hi=je.getStateStyle(l.fixState),qi=je.get("shapeFactory").getShape(ja.type).getStateStyle(l.fixState,je)[l.fixState];if(l.fixAll){if(T<=1){var fo=(0,_.clone)(xa.getMatrix());fo||(fo=[1,0,0,0,1,0,0,0,1]);var es=je.getModel(),Bs=es.x,cl=es.y;fo=t1(fo,[["t",-Bs,-cl],["s",Ia,Ia],["t",Bs,cl]]),xa.setMatrix(fo)}}else for(var ze=xa.get("children"),mn=ze.length,$n=0;$n<mn;$n++){var Tn=ze[$n],Fu=void 0,fl=void 0;if(l.fixLabel){var El=Tn.get("type");if(El==="text"){Fu=Tn.attr("fontSize")||12;var ec=hi[Tn.get("name")],Gl=qi[Tn.get("name")],Dp=ec?ec.fontSize:12,wf=Gl?Gl.fontSize:12,Op=Dp||wf||12;if(T<=1&&Tn.attr("fontSize",Op/T),fl)break}}if(l.fixLineWidth&&Tn.get("isKeyShape")){fl=Tn.attr("lineWidth")||0;var Ef=hi.lineWidth||qi.lineWidth||di.lineWidth||0;if(T<=1&&Tn.attr("lineWidth",Ef/T),Fu)break}}}for(var Ac=ei.length,Gh=0;Gh<Ac;Gh++)for(var kr=ei[Gh],xa=kr.getContainer(),ze=xa.get("children"),ja=kr.getModel(),hi=kr.getStateStyle(l.fixState),qi=kr.get("shapeFactory").getShape(ja.type).getStateStyle(l.fixState,kr)[l.fixState],mn=ze.length,$n=0;$n<mn;$n++){var Tn=ze[$n],Fu=void 0,fl=void 0;if(l.fixLabel||l.fixAll){var El=Tn.get("type");if(El==="text"){Fu=Tn.attr("fontSize")||12;var ec=hi[Tn.get("name")],Gl=qi[Tn.get("name")],Dp=ec?ec.fontSize:12,wf=Gl?Gl.fontSize:12,Op=Dp||wf||12;if(T<=1&&Tn.attr("fontSize",Op/T),fl)break}}if((l.fixLineWidth||l.fixAll)&&Tn.get("isKeyShape")){fl=Tn.attr("lineWidth")||0;var Ef=hi.lineWidth||qi.lineWidth||1;if(T<=1&&Tn.attr("lineWidth",Ef/T),Fu)break}}}}var Sf=this.get("animate"),Qf=this.get("animateCfg");s.zoomTo(T,{x:d.x,y:d.y},Sf,Qf),s.emit("wheelzoom",a)}}},P0={onMouseEnter:function(a){var e=a.item;this.currentTarget=e,this.showTooltip(a),this.graph.emit("tooltipchange",{item:a.item,action:"show"})},onMouseMove:function(a){if(!this.shouldUpdate(a,this)){this.hideTooltip();return}!this.currentTarget||a.item!==this.currentTarget||this.updatePosition(a)},onMouseLeave:function(a){!this.shouldEnd(a,this)||(this.hideTooltip(),this.graph.emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null)},showTooltip:function(a){var e=this.container;if(!(!a.item||a.item.destroyed)){e||(e=this.createTooltip(this.graph.get("canvas")),this.container=e);var i=this.formatText(a.item.get("model"),a);e.innerHTML=i,Ps(this.container,{visibility:"visible"}),this.updatePosition(a)}},hideTooltip:function(){Ps(this.container,{visibility:"hidden"})},updatePosition:function(a){var e=this.get("shouldBegin"),i=this,s=i.width,l=i.height,f=i.container,d=i.graph;if(!e(a,this)){Ps(f,{visibility:"hidden"});return}var v=d.getPointByClient(a.clientX,a.clientY),w=d.getCanvasByPoint(v.x,v.y),E=w.x,T=w.y,G=f.getBoundingClientRect();E>s/2?E-=G.width:E+=this.offset,T>l/2?T-=G.height:T+=this.offset;var U="".concat(E,"px"),et="".concat(T,"px");Ps(this.container,{left:U,top:et,visibility:"visible"})},createTooltip:function(a){var e=a.get("el");e.style.position="relative";var i=Hl('<div class="g6-tooltip g6-'.concat(this.item,'-tooltip"></div>'));return e.parentNode.appendChild(i),Ps(i,{position:"absolute",visibility:"visible"}),this.width=a.get("width"),this.height=a.get("height"),this.container=i,this.graph.get("tooltips").push(i),i}},n1=(0,O.__assign)({getDefaultCfg:function(){return{item:"node",offset:12,formatText:function(e){return e.label}}},getEvents:function(){return{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},P0),qb=(0,O.__assign)({getDefaultCfg:function(){return{item:"edge",offset:12,formatText:function(e){return"source: ".concat(e.source," target: ").concat(e.target)}}},getEvents:function(){return{"edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},P0),Qb="click",IE=["click","dblclick"],mc={getDefaultCfg:function(){return{trigger:Qb,onChange:function(){}}},getEvents:function(){var a,e;return IE.includes(this.trigger)?e=this.trigger:(e=Qb,console.warn("Behavior collapse-expand \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click' \u6216 'dblclick'")),a={},a["node:".concat(e)]="onNodeClick",a.touchstart="onNodeClick",a},onNodeClick:function(a){var e=this;if(this.trigger==="click"){if(this.timer){clearTimeout(this.timer),this.timer=0;return}this.timer=setTimeout(function(){e.toggle(a),clearTimeout(e.timer),e.timer=0},200)}else this.toggle(a)},toggle:function(a){var e=a.item;if(!!e){var i=this.graph.findDataById(e.get("id"));if(!!i){var s=i.children;if(!(!s||s.length===0)){var l=!i.collapsed;!this.shouldBegin(a,l,this)||(i.collapsed=l,e.getModel().collapsed=l,this.graph.emit("itemcollapsed",{item:a.item,collapsed:l}),!!this.shouldUpdate(a,l,this)&&(this.onChange(e,l,this),this.graph.layout()))}}}}},fc=Wv.calculationItemsBBox,cI=function c(a,e){if(e(a)!==!1&&a){var i=a.get("combos");if(i.length===0)return!1;(0,_.each)(i,function(s){c(s,e)})}},fI={getDefaultCfg:function(){return{enableDelegate:!1,delegateStyle:{},onlyChangeComboSize:!1,activeState:"",selectedState:"selected",enableStack:!0}},getEvents:function(){return{"combo:mousedown":"onMouseDown","combo:dragstart":"onDragStart","combo:drag":"onDrag","combo:dragend":"onDragEnd","combo:drop":"onDrop","node:drop":"onNodeDrop","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave"}},validationCombo:function(a){var e=a.item;if(!e||e.destroyed||!this.shouldUpdate(a,this))return!1;var i=e.getType();return i==="combo"},onMouseDown:function(a){this.origin={x:a.x,y:a.y}},onDragStart:function(a){var e=this,i=this.graph,s=a.item;if(this.currentShouldEnd=!0,!!this.validationCombo(a)){this.targets=[];var l=i.findAllByState("combo",this.selectedState),f=s.get("id"),d=l.filter(function(w){var E=w.get("id");return f===E});d.length===0?this.targets.push(s):this.targets=l;var v=[];this.targets.forEach(function(w){var E=w.getModel(),T=E.x,G=E.y,U=E.id;v.push({x:T,y:G,id:U})}),this.set("beforeDragItems",v),this.activeState&&this.targets.map(function(w){var E=w.getModel();if(E.parentId){var T=i.findById(E.parentId);T&&i.setItemState(T,e.activeState,!0)}}),this.point={},this.originPoint={},this.currentItemChildCombos=[],cI(s,function(w){if(w.destroyed)return!1;var E=w.getModel();return e.currentItemChildCombos.push(E.id),!0})}},onDrag:function(a){var e=this;if(!!this.origin&&!!this.validationCombo(a))if(this.enableDelegate)this.updateDelegate(a);else{if(this.activeState){var i=this.graph,s=a.item,l=s.getModel(),f=i.getCombos(),d=s.getBBox(),v=d.centerX,w=d.centerY,E=d.width,T=f.filter(function(G){var U=G.getModel();return l.parentId,U.id!==l.id&&!e.currentItemChildCombos.includes(U.id)});T.map(function(G){var U=G.getBBox(),et=U.centerX,ct=U.centerY,Ct=U.width,Mt=v-et,Dt=w-ct,zt=2*Math.sqrt(Mt*Mt+Dt*Dt);E+Ct-zt>.8*E?i.setItemState(G,e.activeState,!0):i.setItemState(G,e.activeState,!1)})}(0,_.each)(this.targets,function(G){e.updateCombo(G,a)}),this.onlyChangeComboSize&&this.updateParentCombos()}},updatePositions:function(a,e){var i=this;(this.enableDelegate||e)&&(0,_.each)(this.targets,function(s){i.updateCombo(s,a,e)})},onDrop:function(a){var e=this,i=a.item;if(this.currentShouldEnd=this.shouldEnd(a,i,this),this.updatePositions(a,!this.currentShouldEnd),!(!this.currentShouldEnd||!i||!this.targets||i.destroyed)){var s=this.graph,l=i.getModel();this.targets.map(function(f){var d=f.getModel();d.parentId!==l.id?(e.activeState&&s.setItemState(i,e.activeState,!1),e.onlyChangeComboSize?s.updateCombo(f):s.updateComboTree(f,l.id,!1)):s.updateCombo(i)}),this.end(i,a),this.endComparison=!0}},onNodeDrop:function(a){var e=this;if(!(!this.targets||this.targets.length===0)){var i=this.graph,s=a.item,l=s.getModel().comboId,f=l?i.findById(l):void 0;if(this.currentShouldEnd=this.shouldEnd(a,f,this),this.updatePositions(a,!this.currentShouldEnd),!!this.currentShouldEnd){var d;if(l){if(this.activeState){var v=i.findById(l);i.setItemState(v,this.activeState,!1)}this.targets.map(function(w){e.onlyChangeComboSize?i.updateCombo(w):l!==w.getID()&&(d=i.findById(l),l!==w.getModel().parentId&&i.updateComboTree(w,l,!1))})}else this.targets.map(function(w){if(e.onlyChangeComboSize)i.updateCombo(w);else{var E=w.getModel();E.comboId&&i.updateComboTree(w,void 0,!1)}});this.endComparison=!0,this.end(d,a)}}},onDragEnter:function(a){if(!!this.origin&&!!this.validationCombo(a)){var e=a.item,i=this.graph;this.activeState&&i.setItemState(e,this.activeState,!0)}},onDragLeave:function(a){if(!!this.origin&&!!this.validationCombo(a)){var e=a.item,i=this.graph;this.activeState&&i.setItemState(e,this.activeState,!1)}},onDragEnd:function(a){if(!(!this.targets||this.targets.length===0)){var e=a.item;this.currentShouldEnd&&this.updatePositions(a);var i=this.getParentCombo(e.getModel().parentId),s=this.graph;i&&this.activeState&&s.setItemState(i,this.activeState,!1),this.end(void 0,a)}},end:function(a,e){var i=this;if(!!this.origin){var s=this.graph;if(this.delegateShape){var l=s.get("delegateGroup");l.clear(),this.delegateShape=null}if(a&&this.activeState&&s.setItemState(a,this.activeState,!1),!a){var f=s.get("enabledStack")&&this.enableStack,d={before:{nodes:[],edges:[],combos:[].concat(this.get("beforeDragItems"))},after:{nodes:[],edges:[],combos:[]}};this.targets.map(function(v){if(!i.onlyChangeComboSize)s.updateComboTree(v,void 0,f);else{s.updateCombo(v);var w=v.getModel(),E=w.x,T=w.y,G=w.id;d.after.combos.push({x:E,y:T,id:G}),s.pushStack("update",d)}})}this.point=[],this.origin=null,this.originPoint=null,this.targets.length=0}},traverse:function(a,e,i){var s=this;if(i===void 0&&(i={}),e(a,i)!==!1&&a){var l=a.get("combos");(0,_.each)(l,function(d){s.traverse(d,e,i)});var f=a.get("nodes");(0,_.each)(f,function(d){s.traverse(d,e,i)})}},updateCombo:function(a,e,i){this.updateSingleItem(a,e,i);var s={};this.traverse(a,function(l,f){return l.destroyed?!1:(l.getEdges().forEach(function(d){return f[d.getID()]=d}),!0)},s),Object.values(s).forEach(function(l){return l.refresh()})},updateSingleItem:function(a,e,i){var s=this.origin,l=this.graph,f=a.getModel(),d=a.get("id");this.point[d]||(this.point[d]={x:f.x,y:f.y});var v=e.x-s.x+this.point[d].x,w=e.y-s.y+this.point[d].y;i&&(v+=s.x-e.x,w+=s.y-e.y),l.updateItem(a,{x:v,y:w},!1)},getParentCombo:function(a){var e=this.graph;if(!!a){var i=e.findById(a);if(!!i)return i}},updateDelegate:function(a){var e=this.graph;if(this.delegateShape){var G=a.x-this.origin.x+this.originPoint.minX,U=a.y-this.origin.y+this.originPoint.minY;this.delegateShape.attr({x:G,y:U})}else{var i=e.get("delegateGroup"),s=null;this.targets.length>1?s=fc(this.targets):s=this.targets[0].getBBox();var l=s.x,f=s.y,d=s.width,v=s.height,w=s.minX,E=s.minY;this.originPoint={x:l,y:f,width:d,height:v,minX:w,minY:E};var T=(0,O.__assign)((0,O.__assign)({},hg.delegateStyle),this.delegateStyle);this.delegateShape=i.addShape("rect",{attrs:(0,O.__assign)({width:s.width,height:s.height,x:s.x,y:s.y},T),name:"combo-delegate-shape"}),this.delegateShape.set("capture",!1),this.delegate=this.delegateShape}},updateParentCombos:function(){var a=this,e=a.graph,i=a.targets,s={};i==null||i.forEach(function(l){var f=l.getModel().parentId;f&&(s[f]=e.findById(f))}),Object.values(s).forEach(function(l){l&&e.updateCombo(l)})}},TE="dblclick",hI=["click","dblclick"],dI={getDefaultCfg:function(){return{trigger:TE,relayout:!0}},getEvents:function(){var a,e;return hI.includes(this.trigger)?e=this.trigger:(e=TE,console.warn("Behavior collapse-expand-group \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click' \u6216 'dblclick'")),a={},a["combo:".concat(e)]="onComboClick",a},onComboClick:function(a){var e=a.item,i=this,s=i.graph,l=i.relayout;if(!(!e||e.destroyed||e.getType()!=="combo")){var f=e.getModel(),d=f.id;!d||(s.collapseExpandCombo(d),l&&s.get("layout")?s.layout():s.refreshPositions())}}},pI=Wv.isPolygonsIntersect,vI=Wv.pathToPoints,AE="shift",gI=["drag","shift","ctrl","alt","control"],mI=function(a,e){var i,s=a.getKeyShape();if(a.get("type")==="path")i=vI(s.attr("path"));else{var l=s.getCanvasBBox();i=[[l.minX,l.minY],[l.maxX,l.minY],[l.maxX,l.maxY],[l.minX,l.maxY]]}return pI(e,i)},yI={getDefaultCfg:function(){return{delegateStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},shouldDeselect:void 0,selectedState:"selected",trigger:AE,includeEdges:!0,selectedEdges:[],selectedNodes:[]}},getEvents:function(){return gI.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=AE,console.warn("Behavior lasso-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")),this.trigger==="drag"?{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd","canvas:click":"clearStates"}:{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd",keyup:"onKeyUp",keydown:"onKeyDown","canvas:click":"clearStates"}},onDragStart:function(a){var e=this.lasso,i=a.item;i||this.trigger!=="drag"&&!this.keydown||(this.selectedNodes&&this.selectedNodes.length!==0&&this.clearStates("dragstart"),e||(e=this.createLasso()),this.dragging=!0,this.originPoint={x:a.x,y:a.y},this.points.push(this.originPoint),e.show())},onDragMove:function(a){!this.dragging||this.trigger!=="drag"&&!this.keydown||(this.points.push({x:a.x,y:a.y}),this.updateLasso(a))},onDragEnd:function(a){!this.lasso&&!this.dragging||this.trigger!=="drag"&&!this.keydown||(this.points.push(this.originPoint),this.getSelectedItems(),this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1)},getLassoPath:function(){var a=this.points,e=[];return a.length&&(a.forEach(function(i,s){s===0?e.push(["M",i.x,i.y]):e.push(["L",i.x,i.y])}),e.push(["L",a[0].x,a[0].y])),e},clearStates:function(a){a===void 0&&(a="canvas:click");var e=this,i=e.graph,s=e.selectedState,l=e.shouldDeselect,f=i.findAllByState("node",s),d=i.findAllByState("edge",s);(!l||l({action:a,nodes:f,edges:d}))&&(f.forEach(function(v){return i.setItemState(v,s,!1)}),d.forEach(function(v){return i.setItemState(v,s,!1)})),this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges),this.selectedNodes=[],this.selectedEdges=[],i.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[]},select:!1})},getSelectedItems:function(){var a=this,e=this,i=e.graph,s=e.shouldUpdate,l=this.points.map(function(E){return[i.getCanvasByPoint(E.x,E.y).x,i.getCanvasByPoint(E.x,E.y).y]}),f=this.selectedState,d=[],v=[];i.getNodes().forEach(function(E){if(!!E.isVisible()&&mI(E,l)&&s(E,"select",a)){d.push(E);var T=E.getModel();v.push(T.id),i.setItemState(E,f,!0)}});var w=[];this.includeEdges&&d.forEach(function(E){var T=E.getOutEdges();T.forEach(function(G){if(!!G.isVisible()){var U=G.getModel(),et=U.source,ct=U.target;v.includes(et)&&v.includes(ct)&&s(G,"select",a)&&(w.push(G),i.setItemState(G,a.selectedState,!0))}})}),this.selectedEdges=w,this.selectedNodes=d,this.onSelect&&this.onSelect(d,w),i.emit("nodeselectchange",{selectedItems:{nodes:d,edges:w},select:!0})},createLasso:function(){var a=this,e=a.graph.get("delegateGroup").addShape("path",{attrs:(0,O.__assign)({path:[]},a.delegateStyle),capture:!1,name:"lasso-shape"});return this.lasso=e,this.delegate=e,this.points=[],e},updateLasso:function(a){var e=this;this.lasso.attr({path:e.getLassoPath()})},onKeyDown:function(a){var e=a.key;!e||(e.toLowerCase()===this.trigger.toLowerCase()?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.lasso&&(this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1),this.keydown=!1}},ME="click",bI=["click","drag"],NE=void 0,xI=["shift","ctrl","control","alt","meta",void 0],wI={getDefaultCfg:function(){return{trigger:ME,key:NE,edgeConfig:{},getEdgeConfig:void 0}},getEvents:function(){var a=this;bI.indexOf(a.trigger.toLowerCase())>-1||(a.trigger=ME,console.warn("Behavior create-edge \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click'\uFF0C'drag'")),a.key&&xI.indexOf(a.key.toLowerCase())===-1&&(a.trigger=NE,console.warn("Behavior create-edge \u7684 key \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'shift'\uFF0C'ctrl'\uFF0C'alt'\uFF0C'control'\uFF0C\u6216 undefined"));var e;return a.trigger==="drag"?e={"node:dragstart":"onClick","combo:dragstart":"onClick",drag:"updateEndPoint","node:drop":"onClick","combo:drop":"onClick",dragend:"onDragEnd"}:a.trigger==="click"&&(e={"node:click":"onClick",mousemove:"updateEndPoint","edge:click":"cancelCreating","canvas:click":"cancelCreating","combo:click":"onClick"}),a.key&&(e.keydown="onKeyDown",e.keyup="onKeyUp"),e},onDragEnd:function(a){var e=this;if(!(e.key&&!e.keydown)){var i=a.item;(!i||i.getID()===e.source||i.getType()!=="node")&&e.cancelCreating({item:e.edge,x:a.x,y:a.y})}},onClick:function(a){var e=this;if(!(e.key&&!e.keydown)){var i=a.item,s=e.graph,l=i.getModel(),f=e.getEdgeConfig;if(e.addingEdge&&e.edge){if(!e.shouldEnd(a,e))return;var d=void 0;f&&(0,_.isFunction)(f)?d=f({source:e.source,target:l.id},e):d=e.edgeConfig;var v=(0,O.__assign)({target:l.id},d);if(e.source===l.id&&(v.type="loop"),s.emit("beforecreateedge",{}),s.updateItem(e.edge,v,!1),s.get("enabledStack")){var w=(0,O.__assign)((0,O.__assign)({},e.edge.getModel()),{itemType:"edge"}),E={};E.edges=[w],s.pushStack("add",{before:{},after:E})}s.emit("aftercreateedge",{edge:e.edge}),e.edge.getKeyShape().set("capture",!0),e.edge=null,e.addingEdge=!1}else{if(!e.shouldBegin(a,e))return;var d=void 0;f&&(0,_.isFunction)(f)?d=f({source:l.id,target:l.id},e):d=e.edgeConfig,e.edge=s.addItem("edge",(0,O.__assign)({source:l.id,target:l.id},d),!1),e.source=l.id,e.addingEdge=!0,e.edge.getKeyShape().set("capture",!1)}}},updateEndPoint:function(a){var e=this;if(!(e.key&&!e.keydown)){e.edge&&e.edge.destroyed&&e.cancelCreating({item:e.edge});var i={x:a.x,y:a.y};if(!e.graph.findById(e.source)){e.addingEdge=!1;return}e.addingEdge&&e.edge&&e.graph.updateItem(e.edge,{target:i},!1)}},cancelCreating:function(a){var e,i,s=this;if(!(s.key&&!s.keydown)){var l=s.graph,f=a.item;if(s.addingEdge&&(s.edge===f||((i=(e=a.target)===null||e===void 0?void 0:e.isCanvas)===null||i===void 0?void 0:i.call(e)))){s.edge&&!s.edge.destroyed&&l.removeItem(s.edge,!1),s.edge=null,s.addingEdge=!1;return}}},onKeyDown:function(a){var e=this,i=a.key;!i||(i.toLowerCase()===e.key.toLowerCase()?e.keydown=!0:e.keydown=!1)},onKeyUp:function(){var a=this;a.addingEdge&&a.edge&&(a.graph.removeItem(a.edge,!1),a.addingEdge=!1,a.edge=null),this.keydown=!1}},Jb="ctrl",r1=["shift","ctrl","alt","control"],a1="1",tx={getDefaultCfg:function(){return{trigger:Jb,combinedKey:a1,functionName:"fitView",functionParams:[]}},getEvents:function(){return r1.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=Jb,console.warn("Behavior shortcuts-fit-view \u7684 trigger \u53C2\u6570 '".concat(this.trigger,"' \u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'"))),this.combinedKey===this.trigger&&(this.combinedKey=void 0),{keyup:"onKeyUp",keydown:"onKeyDown"}},onKeyDown:function(a){var e=a.key;if(!!e){var i=this.trigger.toLowerCase(),s=e.toLowerCase();this.triggerKeydown||(s===i||s==="control"&&i==="ctrl"||s==="ctrl"&&i==="control"?this.triggerKeydown=!0:this.triggerKeydown=!1);var l=this.graph;if(!l[this.functionName])return console.warn("Behavior shortcuts-fit-view \u7684 functionName \u53C2\u6570 '".concat(this.functionName,"' \u4E0D\u5408\u6CD5\uFF0C\u5B83\u4E0D\u662F Graph \u7684\u4E00\u4E2A\u51FD\u6570\u540D")),{};if(this.triggerKeydown&&!this.combinedKey){this.functionParams&&this.functionParams.length?l[this.functionName].apply(l,this.functionParams):l[this.functionName]();return}var f=this.combinedKey.toLowerCase();this.triggerKeydown&&(s===f||s==="control"&&f==="ctrl"||s==="ctrl"&&f==="control")&&(this.functionParams&&this.functionParams.length?l[this.functionName].apply(l,this.functionParams):l[this.functionName]())}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.triggerKeydown=!1}},i1=["shift","ctrl","alt","control","meta"],vu={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,zoomKey:"ctrl",scalableRange:0,allowDragOnItem:!0}},getEvents:function(){return(!this.zoomKey||i1.indexOf(this.zoomKey)===-1)&&(this.zoomKey="ctrl"),{wheel:"onWheel"}},onWheel:function(a){var e=this;if(!!this.allowDrag(a)){var i=this.graph,s=Array.isArray(this.zoomKey)?[].concat(this.zoomKey):[this.zoomKey];s.includes("control")&&s.push("ctrl");var l=s.some(function(ja){return a["".concat(ja,"Key")]});if(l){var f=i.get("canvas"),d=f.getPointByClient(a.clientX,a.clientY),v=i.getZoom();a.wheelDelta>0?v=v+v*.05:v=v-v*.05,i.zoomTo(v,{x:d.x,y:d.y})}else{var w=a.deltaX||a.movementX,E=a.deltaY||a.movementY;!E&&navigator.userAgent.indexOf("Firefox")>-1&&(E=-a.wheelDelta*125/3);var T=this.graph.get("width"),G=this.graph.get("height"),U=this.graph.get("canvas").getCanvasBBox(),et=this.scalableRange,ct=this.scalableRange;et<1&&et>-1&&(et=T*et,ct=G*ct);var Ct=U.minX,Mt=U.maxX,Dt=U.minY,zt=U.maxY;w>0?Mt<-et?w=0:Mt-w<-et&&(w=Mt+et):w<0&&(Ct>T+et?w=0:Ct-w>T+et&&(w=Ct-(T+et))),E>0?zt<-ct?E=0:zt-E<-ct&&(E=zt+ct):E<0&&(Dt>G+ct?E=0:Dt-E>G+ct&&(E=Dt-(G+ct))),this.get("direction")==="x"?E=0:this.get("direction")==="y"&&(w=0),i.translate(-w,-E)}a.preventDefault();var Qt=this.get("enableOptimize");if(Qt){var Ie=this.get("optimizeZoom"),je=this.get("optimized"),ze=i.getNodes(),mn=i.getEdges(),$n=ze.length,Tn=mn.length;if(!je){for(var or=0;or<$n;or++){var kr=ze[or];if(!kr.destroyed)for(var Ta=kr.get("group").get("children"),fi=Ta.length,ei=0;ei<fi;ei++){var Ia=Ta[ei];!Ia.destoryed&&!Ia.get("isKeyShape")&&(Ia.set("ori-visibility",Ia.get("ori-visibility")||Ia.get("visible")),Ia.hide())}}for(var Gi=0;Gi<Tn;Gi++)for(var Ri=mn[Gi],Ta=Ri.get("group").get("children"),fi=Ta.length,ei=0;ei<fi;ei++){var Ia=Ta[ei];Ia.set("ori-visibility",Ia.get("ori-visibility")||Ia.get("visible")),Ia.hide()}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var xa=setTimeout(function(){var ja=i.getZoom(),di=e.get("optimized");if(di){e.set("optimized",!1);for(var hi=0;hi<$n;hi++){var qi=ze[hi],fo=qi.get("group").get("children"),es=fo.length;if(ja<Ie){var Bs=qi.getKeyShape(),cl=Bs.get("ori-visibility");cl&&Bs.show()}else for(var Fu=0;Fu<es;Fu++){var fl=fo[Fu],cl=fl.get("ori-visibility");!fl.get("visible")&&cl&&cl&&fl.show()}}for(var El=0;El<Tn;El++){var ec=mn[El],fo=ec.get("group").get("children"),es=fo.length;if(ja<Ie){var Bs=ec.getKeyShape(),cl=Bs.get("ori-visibility");cl&&Bs.show()}else for(var Fu=0;Fu<es;Fu++){var fl=fo[Fu];if(!fl.get("visible")){var cl=fl.get("ori-visibility");cl&&fl.show()}}}}},100);this.set("timeout",xa)}}},allowDrag:function(a){var e,i,s=a.target,l=s&&s.isCanvas&&s.isCanvas();if((0,_.isBoolean)(this.allowDragOnItem)&&!this.allowDragOnItem&&!l)return!1;if((0,_.isObject)(this.allowDragOnItem)){var f=this.allowDragOnItem,d=f.node,v=f.edge,w=f.combo,E=(i=(e=a.item)===null||e===void 0?void 0:e.getType)===null||i===void 0?void 0:i.call(e);if(!d&&E==="node"||!v&&E==="edge"||!w&&E==="combo")return!1}return!0}},$l={"drag-canvas":lI,"zoom-canvas":e1,"drag-node":sp,"activate-relations":Yb,"brush-select":Zb,"click-select":Jy,"lasso-select":yI,tooltip:n1,"edge-tooltip":qb,"collapse-expand":mc,"drag-combo":fI,"collapse-expand-combo":dI,"create-edge":wI,"shortcuts-call":tx,"scroll-canvas":vu};(0,_.each)($l,function(c,a){qm(a,c)});var o1=(0,O.__assign)((0,O.__assign)({},X),NS),EI=xf.Grid,mv=xf.Minimap,VA=xf.Bundling,BD=xf.Menu,jA=xf.Fisheye,zD=xf.ToolBar,$D=xf.Tooltip,HA=xf.TimeBar,XA=xf.ImageMinimap,YA=xf.EdgeFilterLens,KA=xf.SnapLine,GD=xf.Legend,ZA=xf.Annotation,SI={version:hg.version,Graph:_w,TreeGraph:iC,Util:Wv,Layout:pu.Layouts,TreeLayout:K2,registerLayout:mw,Global:hg,registerBehavior:qm,registerCombo:MS,registerEdge:Oh,registerNode:zv,Minimap:xf.Minimap,Grid:xf.Grid,Bundling:xf.Bundling,Menu:xf.Menu,ToolBar:xf.ToolBar,Tooltip:xf.Tooltip,Legend:xf.Legend,TimeBar:HA,SnapLine:KA,Fisheye:jA,ImageMinimap:XA,EdgeFilterLens:YA,Annotation:ZA,Algorithm:o1,Arrow:R1,Marker:Bx,Shape:Bv};SI.version="4.8.14";var qA=SI,kE="4.8.14"},4714:function(sr,it,$){"use strict";$.d(it,{Z:function(){return ft}});var X=$(67294),tt=$(36950),j=$(90314),W=function(st){var ut=st.children,dt=st.onClick,gt=dt===void 0?function(){}:dt,wt=X.useContext(tt.Z),ot=function(){gt();var Nt=wt.contextmenu;Nt.node&&Nt.node.handleClose(),Nt.edge&&Nt.edge.handleClose(),Nt.canvas&&Nt.canvas.handleClose()};return X.createElement("li",{onClick:ot},ut)},Q=function(st){var ut=st.bindType,dt=ut===void 0?"node":ut,gt=X.useContext(tt.Z),wt=st.options,ot=st.onChange,pt=function(se){try{var ie=gt.contextmenu,Be=null;dt==="node"&&(Be=ie.node.item.getModel()),dt==="edge"&&(Be=ie.edge.item.getModel()),dt==="canvas"&&(Be=null),ot&&(ot(se,Be),ie[dt].handleClose())}catch(ke){console.log(ke)}},Nt=st.children;return wt?X.createElement("ul",{className:"graphin-components-contextmenu-content"},wt.map(function(Gt){var se=Gt.key,ie=Gt.icon,Be=Gt.name;return X.createElement(W,{key:se||Be,onClick:function(){pt(Gt)}},ie," ",Be)})):X.createElement("ul",{className:"graphin-components-contextmenu-content"},Nt)};Q.Item=W;var Z=Q;function L(mt,st,ut){return st in mt?Object.defineProperty(mt,st,{value:ut,enumerable:!0,configurable:!0,writable:!0}):mt[st]=ut,mt}function P(mt,st){return R(mt)||B(mt,st)||M(mt,st)||C()}function C(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M(mt,st){if(!!mt){if(typeof mt=="string")return k(mt,st);var ut=Object.prototype.toString.call(mt).slice(8,-1);if(ut==="Object"&&mt.constructor&&(ut=mt.constructor.name),ut==="Map"||ut==="Set")return Array.from(mt);if(ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ut))return k(mt,st)}}function k(mt,st){(st==null||st>mt.length)&&(st=mt.length);for(var ut=0,dt=new Array(st);ut<st;ut++)dt[ut]=mt[ut];return dt}function B(mt,st){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(mt)))){var ut=[],dt=!0,gt=!1,wt=void 0;try{for(var ot=mt[Symbol.iterator](),pt;!(dt=(pt=ot.next()).done)&&(ut.push(pt.value),!(st&&ut.length===st));dt=!0);}catch(Nt){gt=!0,wt=Nt}finally{try{!dt&&ot.return!=null&&ot.return()}finally{if(gt)throw wt}}return ut}}function R(mt){if(Array.isArray(mt))return mt}var F=tt.Z,K={width:200,background:"#fff"},O,_=function(st){var ut=st.children,dt=st.bindType,gt=dt===void 0?"node":dt,wt=st.style,ot=X.useContext(F),pt=ot.graph,Nt=X.useState({visible:!1,x:0,y:0,item:null}),Gt=P(Nt,2),se=Gt[0],ie=Gt[1],Be=function(Le){Le.preventDefault(),Le.stopPropagation();var Ze=pt.get("width"),fe=pt.get("height"),Re=O.getBoundingClientRect(),He=pt.get("offsetX")||0,pe=pt.get("offsetY")||0,Ge=pt.getContainer().offsetTop,te=pt.getContainer().offsetLeft,Me=Le.canvasX+te+He,We=Le.canvasY+Ge+pe;if(Me+Re.width>Ze&&(Me=Le.canvasX-Re.width-He+te),We+Re.height>fe&&(We=Le.canvasY-Re.height-pe+Ge),gt==="node"){var ee=Le.item&&Le.item.getModel(),Pt=ee.x,yt=ee.y,Ne=pt.getCanvasByPoint(Pt,yt),tn=Le.canvasX-Ne.x,fn=Le.canvasY-Ne.y;Me=Me-tn,We=We-fn}ie(function(Rt){return Object.assign(Object.assign({},Rt),{visible:!0,x:Me,y:We,item:Le.item})})},ke=function(){ie(function(Le){return Le.visible?Object.assign(Object.assign({},Le),{visible:!1,x:0,y:0}):Le})};(0,X.useEffect)(function(){return pt.on("".concat(gt,":contextmenu"),Be),pt.on("canvas:click",ke),pt.on("canvas:drag",ke),pt.on("wheelzoom",ke),function(){pt.off("".concat(gt,":contextmenu"),Be),pt.off("canvas:click",ke),pt.off("canvas:drag",ke),pt.off("wheelzoom",ke)}},[]);var we=se.x,At=se.y,Yt=se.visible,be=se.item,nn={position:"absolute",left:we,top:At};ot.contextmenu=Object.assign(Object.assign({},ot.contextmenu),L({},gt,{handleOpen:Be,handleClose:ke,item:be,visible:Yt,x:we,y:At,bindType:gt}));var Ee=be&&!be.destroyed&&be.getModel&&be.getModel().id||"";return X.createElement(X.Fragment,null,X.createElement("div",{ref:function(Le){O=Le},className:"graphin-components-contextmenu",style:Object.assign(Object.assign(Object.assign({},K),wt),nn),key:Ee},Yt&&ut))};_.Menu=Z;var ft=_},49346:function(sr,it,$){"use strict";var X=$(36950),tt=$(34763),j=$(67294),W={r:249,scaleRByWheel:!0,minR:100,maxR:500,delegateStyle:{stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:.1,fill:"#ccc"},showLabel:!1},Q=function(L){var P=j.useContext(X.Z),C=P.graph,M=L.options,k=L.visible,B=L.handleEscListener;return j.useEffect(function(){var R=Object.assign(Object.assign({},W),M);R.showLabel&&C.getNodes().forEach(function(O){O.getContainer().getChildren().forEach(function(_){_.get("type")==="text"&&_.hide()})});var F=new tt.ZP.Fisheye(R),K=function(_){_.keyCode===27&&B&&(B(),C.get("canvas").setCursor("default"))};return k&&(C.addPlugin(F),C.get("canvas").setCursor("zoom-in")),B&&window.addEventListener("keydown",K),function(){C&&!C.destroyed&&(C.get("canvas").setCursor("default"),C.removePlugin(F)),B&&window.removeEventListener("keydown",K)}},[C,M,k,B]),null};it.Z=Q},50651:function(sr,it,$){"use strict";var X=$(36950),tt=$(75345),j=$(67294),W=$(10410),Q=$.n(W),Z=X.Z,L={background:"#fff"},P=function(k){var B=k.children,R=k.onClick,F=R===void 0?function(){}:R;return j.createElement("li",{onClick:F,onKeyDown:F},B)},C=function(k){var B=k.children,R=k.style,F=R===void 0?{}:R,K=k.direction,O=K===void 0?"horizontal":K,_=k.options,ft=k.onChange,mt=j.useContext(Z),st=O==="horizontal",ut={position:"absolute"};st?(ut.right=0,ut.top=0):(ut.left=0,ut.bottom=0);var dt=function(wt){try{ft&&ft(mt,wt)}catch(ot){console.log(ot)}};return _?j.createElement("div",{className:"graphin-components-toolbar",style:Object.assign(Object.assign(Object.assign({},L),ut),F)},j.createElement("ul",{className:"graphin-components-toolbar-content",style:{display:st?"flex":""}},_.map(function(gt){var wt=gt.key,ot=gt.name;return j.createElement(P,{key:wt||ot,onClick:function(){dt(gt)}},ot)}))):j.createElement("div",{style:Object.assign(Object.assign(Object.assign({},L),ut),F),className:"graphin-components-toolbar"},(0,tt.Z)(B)||B&&B.type===P?j.createElement("ul",{className:"graphin-components-toolbar-content",style:{display:st?"flex":""}},B):B)};C.Item=P,it.Z=C},36950:function(sr,it,$){"use strict";var X=$(67294),tt={graph:{},apis:{},theme:{},layout:{}},j=X.createContext(tt);it.Z=j},98818:function(sr,it,$){"use strict";$.d(it,{Z:function(){return Me}});var X=$(67294),tt=$(36950),j=function(We,ee){var Pt={};for(var yt in We)Object.prototype.hasOwnProperty.call(We,yt)&&ee.indexOf(yt)<0&&(Pt[yt]=We[yt]);if(We!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ne=0,yt=Object.getOwnPropertySymbols(We);Ne<yt.length;Ne++)ee.indexOf(yt[Ne])<0&&Object.prototype.propertyIsEnumerable.call(We,yt[Ne])&&(Pt[yt[Ne]]=We[yt[Ne]]);return Pt},W=function(ee){var Pt=ee.type,yt=ee.defaultConfig,Ne=ee.userProps,tn=ee.mode,fn=tn===void 0?"default":tn,Rt=X.useContext(tt.Z),Yn=Rt.graph,Un=Ne.disabled,xr=j(Ne,["disabled"]);X.useEffect(function(){if(Yn.removeBehaviors(Pt,fn),!Un)return Yn.addBehaviors(Object.assign(Object.assign({type:Pt},yt),xr),fn),function(){Yn.destroyed||Yn.removeBehaviors(Pt,fn)}},[])},Q=W,Z={disabled:!1,trigger:"mouseenter",activeState:"active",inactiveState:"inactive",resetSelected:!1},L=function(ee){return Q({type:"activate-relations",userProps:ee,defaultConfig:Z}),null},P=L,C="shift",M={disabled:!1,brushStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:C,includeEdges:!0,includeCombos:!1},k=function(ee){return Q({type:"brush-select",userProps:ee,defaultConfig:M}),null},B=k,R="shift",F={disabled:!1,multiple:!0,trigger:R,selectedState:"selected",selectNode:!0,selectEdge:!1,selectCombo:!0},K=function(ee){return Q({type:"click-select",userProps:ee,defaultConfig:F}),null},O=K,_={direction:"both",enableOptimize:!1,scalableRange:0,shouldBegin:function(){return!0},disabled:!1},ft=function(ee){return Q({type:"drag-canvas",userProps:ee,defaultConfig:_}),null},mt=ft,st={disabled:!1,enableDelegate:!1,delegateStyle:{},onlyChangeComboSize:!1,activeState:"",selectedState:"selected"},ut=function(ee){return Q({type:"drag-combo",userProps:ee,defaultConfig:st}),null},dt=ut,gt={disabled:!1,updateEdge:!0,delegateStyle:{},enableDelegate:!1,onlyChangeComboSize:!1,comboActiveState:"",selectedState:"selected"},wt=function(ee){return Q({type:"drag-node",userProps:ee,defaultConfig:gt}),null},ot=wt,pt=function(ee){var Pt=X.useContext(tt.Z),yt=Pt.graph,Ne=Pt.layout,tn=Pt.dragNodes,fn=Pt.updateContext,Rt=ee.autoPin,Yn=ee.pinAction,Un=ee.dragNodeMass,xr=Un===void 0?1e10:Un,cr=Ne.instance;return(0,X.useEffect)(function(){var Ur,fa=cr||{type:(Ur=yt.get("layout"))===null||Ur===void 0?void 0:Ur.type},Sa=fa.simulation,sa=fa.type,Da=function(){var ar;if(Sa)Sa.stop();else{var Fn=((ar=yt.get("layoutController"))===null||ar===void 0?void 0:ar.layoutMethods)||[];Fn.forEach(function(tr){var Gn;return(Gn=tr.stop)===null||Gn===void 0?void 0:Gn.call(tr)})}},Rr=function(ar){if(!(sa!=="graphin-force"&&sa!=="force2")&&ar.item){var Fn=ar.item.get("model");Fn.layout=Object.assign(Object.assign({},Fn.layout),{force:{mass:Rt?xr:null}});var tr=[];yt.getNodes().forEach(function(jr){if(jr.hasState("selected")){var Hr=jr.get("model");Hr.layout||(Hr.layout={}),Hr.layout.force={mass:Rt?xr:null},tr.push(Hr)}});var Gn=tn.concat([Fn]);tr.length>1&&(Gn=Gn.concat(tr)),fn({dragNodes:Gn})}};return yt.on("node:dragstart",Da),yt.on("node:dragend",Rr),function(){yt.off("node:dragstart",Da),yt.off("node:dragend",Rr)}},[yt,Rt,cr,tn,fn]),(0,X.useEffect)(function(){var Ur=Yn||{},fa=Ur.id,Sa=Ur.pinned;if(!!fa){var sa=tn;if(!Sa)sa=tn.filter(function(Mn){return Mn.id!==fa});else{var Da=yt.findById(fa);if(!Da)return;var Rr=Da.get("model");Rr.layout||(Rr.layout={}),Rr.layout.force={mass:Rt?xr:null},sa.push(Rr)}fn({dragNodes:sa})}},[Yn]),null};pt.defaultProps={autoPin:!1,dragNodeMass:1e10,pinAction:void 0};var Nt=pt,Gt=function(ee){var Pt=ee.padding,yt=ee.isBindLayoutChange,Ne=X.useContext(tt.Z),tn=Ne.graph;return(0,X.useEffect)(function(){var fn=function(){tn.fitView(Pt)};return fn(),yt&&tn.on("afterlayout",fn),function(){yt&&tn.off("afterlayout",fn)}},[]),null},se=Gt,ie=function(){var ee=X.useContext(tt.Z),Pt=ee.graph;return X.useEffect(function(){var yt=setTimeout(function(){Pt.getNodes().forEach(function(Ne){Pt.setItemState(Ne,"normal",!0)}),Pt.paint()},1600);return function(){clearTimeout(yt)}},[]),null},Be=ie,ke=function(ee){var Pt=X.useContext(tt.Z),yt=ee.bindType,Ne=yt===void 0?"node":yt,tn=ee.disabled,fn=Pt.graph;return X.useEffect(function(){if(!tn){var Rt=function(Ur){fn.setItemState(Ur.item,"hover",!0)},Yn=function(Ur){fn.setItemState(Ur.item,"hover",!1)},Un=function(Ur){fn.setItemState(Ur.item,"hover",!0)},xr=function(Ur){fn.setItemState(Ur.item,"hover",!1)};return Ne==="node"&&(fn.on("node:mouseenter",Rt),fn.on("node:mouseleave",Yn)),Ne==="edge"&&(fn.on("edge:mouseenter",Un),fn.on("edge:mouseleave",xr)),function(){Ne==="node"&&(fn.off("node:mouseenter",Rt),fn.off("node:mouseleave",Yn)),Ne==="edge"&&(fn.off("edge:mouseenter",Un),fn.off("edge:mouseleave",xr))}}},[fn,tn]),null},we=ke,At="shift",Yt={disabled:!1,delegateStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:At,includeEdges:!0},be=function(ee){return Q({type:"lasso-select",userProps:ee,defaultConfig:Yt}),null},nn=be,Ee=$(23044),le=function(ee){var Pt=ee.graphDOM,yt=X.useContext(tt.Z);return X.useEffect(function(){var Ne=yt.graph,tn=(0,Ee.debounce)(function(){var fn=Pt.clientWidth,Rt=Pt.clientHeight;Ne.set("width",fn),Ne.set("height",Rt);var Yn=Ne.get("canvas");Yn&&(Yn.changeSize(fn,Rt),Ne.autoPaint())},200);return window.addEventListener("resize",tn,!1),function(){window.removeEventListener("resize",tn,!1)}},[]),null},Le=le,Ze=function(We,ee){var Pt={};for(var yt in We)Object.prototype.hasOwnProperty.call(We,yt)&&ee.indexOf(yt)<0&&(Pt[yt]=We[yt]);if(We!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ne=0,yt=Object.getOwnPropertySymbols(We);Ne<yt.length;Ne++)ee.indexOf(yt[Ne])<0&&Object.prototype.propertyIsEnumerable.call(We,yt[Ne])&&(Pt[yt[Ne]]=We[yt[Ne]]);return Pt},fe={trigger:"click"},Re=function(ee){var Pt=ee.onChange,yt=Ze(ee,["onChange"]),Ne=X.useContext(tt.Z),tn=Ne.graph;return Q({defaultConfig:fe,userProps:yt,type:"collapse-expand"}),X.useEffect(function(){var fn=function(Yn){var Un=Yn.item,xr=Yn.collapsed,cr=Un.get("model");cr.collapsed=xr,Pt&&Pt(Un,xr)};return tn.on("itemcollapsed",fn),function(){tn.off("itemcollapsed",fn)}},[]),null},He=Re,pe={sensitivity:2,minZoom:void 0,maxZoom:void 0,enableOptimize:!1,optimizeZoom:.1,fixSelectedItems:{fixAll:!1,fixLineWidth:!1,fixLabel:!1,fixState:"selected"},disabled:!1,animate:!1,animateCfg:{duration:500}},Ge=function(ee){return Q({type:"zoom-canvas",userProps:ee,defaultConfig:pe}),null},te=Ge,Me={DragCanvas:mt,ZoomCanvas:te,ClickSelect:O,BrushSelect:B,DragNode:ot,ResizeCanvas:Le,LassoSelect:nn,DragCombo:dt,ActivateRelations:P,TreeCollapse:He,FitView:se,FontPaint:Be,DragNodeWithForce:Nt,Hoverable:we}},82735:function(sr,it,$){"use strict";$.d(it,{Z:function(){return Ea}});var X=$(67294),tt=$(36950);function j(lr,Cr){return P(lr)||L(lr,Cr)||Q(lr,Cr)||W()}function W(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q(lr,Cr){if(!!lr){if(typeof lr=="string")return Z(lr,Cr);var vr=Object.prototype.toString.call(lr).slice(8,-1);if(vr==="Object"&&lr.constructor&&(vr=lr.constructor.name),vr==="Map"||vr==="Set")return Array.from(lr);if(vr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(vr))return Z(lr,Cr)}}function Z(lr,Cr){(Cr==null||Cr>lr.length)&&(Cr=lr.length);for(var vr=0,Tr=new Array(Cr);vr<Cr;vr++)Tr[vr]=lr[vr];return Tr}function L(lr,Cr){var vr=lr==null?null:typeof Symbol!="undefined"&&lr[Symbol.iterator]||lr["@@iterator"];if(vr!=null){var Tr=[],ta=!0,ra=!1,Zr,vt;try{for(vr=vr.call(lr);!(ta=(Zr=vr.next()).done)&&(Tr.push(Zr.value),!(Cr&&Tr.length===Cr));ta=!0);}catch(_n){ra=!0,vt=_n}finally{try{!ta&&vr.return!=null&&vr.return()}finally{if(ra)throw vt}}return Tr}}function P(lr){if(Array.isArray(lr))return lr}var C=function(Cr){var vr=Cr.bindType,Tr=vr===void 0?"node":vr,ta=Cr.container,ra=X.useContext(tt.Z),Zr=ra.graph,vt=X.useState({visible:!1,x:0,y:0,item:null,selectedItems:[]}),_n=j(vt,2),an=_n[0],Lt=_n[1],kt=function(re){re.preventDefault(),re.stopPropagation();var on=Zr.get("width"),Je=Zr.get("height");if(!!ta.current){var Ve=ta.current.getBoundingClientRect(),qn=Zr.get("offsetX")||0,Ln=Zr.get("offsetY")||0,qr=Zr.getContainer().offsetTop,Ca=Zr.getContainer().offsetLeft,Qn=re.canvasX+Ca+qn,_r=re.canvasY+qr+Ln;if(Qn+Ve.width>on&&(Qn=re.canvasX-Ve.width-qn+Ca),_r+Ve.height>Je&&(_r=re.canvasY-Ve.height-Ln+qr),Tr==="node"){var ea=re.item&&re.item.getModel(),La=ea.x,ha=ea.y,_i=Zr.getCanvasByPoint(La,ha),Ni=re.canvasX-_i.x,vi=re.canvasY-_i.y;Qn=Qn-Ni,_r=_r-vi}Lt(function(si){return Object.assign(Object.assign({},si),{visible:!0,x:Qn,y:_r,item:re.item})})}},at=function(){Lt(function(re){return re.visible?Object.assign(Object.assign({},re),{visible:!1,x:0,y:0}):re})};(0,X.useEffect)(function(){var Ht=function(on){Lt(function(Je){return Object.assign(Object.assign({},Je),{selectedItems:on.selectedItems})})};return Zr.on("".concat(Tr,":contextmenu"),kt),Zr.on("canvas:click",at),Zr.on("canvas:drag",at),Zr.on("wheelzoom",at),Tr==="canvas"&&Zr.on("nodeselectchange",Ht),function(){Zr.off("".concat(Tr,":contextmenu"),kt),Zr.off("canvas:click",at),Zr.off("canvas:drag",at),Zr.off("wheelzoom",at),Zr.off("nodeselectchange",Ht)}},[Zr,Tr]);var H=an.x,Y=an.y,bt=an.visible,$t=an.item,jt=an.selectedItems;return{oneShow:kt,onClose:at,item:$t,selectedItems:jt,visible:bt,x:H,y:Y}},M=C,k={width:"120px",boxShadow:"0 4px 12px rgb(0 0 0 / 15%)"},B=X.createRef(),R=function(Cr){var vr=Cr.bindType,Tr=Cr.children,ta=Cr.style,ra=M({bindType:vr,container:B}),Zr=ra.visible,vt=ra.x,_n=ra.y,an=ra.item,Lt={position:"absolute",left:vt,top:_n};if(typeof Tr!="function")return console.error("<ContextMenu /> children should be a function"),null;var kt=an&&!an.destroyed&&an.getModel&&an.getModel().id||"";return X.createElement("div",{ref:B,className:"graphin-components-contextmenu",style:Object.assign(Object.assign(Object.assign({},k),ta),Lt),key:kt},Zr&&Tr(Object.assign(Object.assign({},ra),{id:kt})))},F=R,K=$(34763),O={r:249,scaleRByWheel:!0,minR:100,maxR:500,delegateStyle:{stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:.1,fill:"#ccc"},showLabel:!1},_=function(Cr){var vr=X.useContext(tt.Z),Tr=vr.graph,ta=Cr.options,ra=Cr.visible,Zr=Cr.handleEscListener;return X.useEffect(function(){var vt=Object.assign(Object.assign({},O),ta);vt.showLabel&&Tr.getNodes().forEach(function(Lt){Lt.getContainer().getChildren().forEach(function(kt){kt.get("type")==="text"&&kt.hide()})});var _n=new K.ZP.Fisheye(vt),an=function(kt){kt.keyCode===27&&Zr&&(Zr(),Tr.get("canvas").setCursor("default"))};return ra&&(Tr.addPlugin(_n),Tr.get("canvas").setCursor("zoom-in")),Zr&&window.addEventListener("keydown",an),function(){Tr&&!Tr.destroyed&&(Tr.get("canvas").setCursor("default"),Tr.removePlugin(_n)),Zr&&window.removeEventListener("keydown",an)}},[Tr,ta,ra,Zr]),null},ft=_,mt=$(23044),st=function(lr,Cr){var vr={};for(var Tr in lr)Object.prototype.hasOwnProperty.call(lr,Tr)&&Cr.indexOf(Tr)<0&&(vr[Tr]=lr[Tr]);if(lr!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ta=0,Tr=Object.getOwnPropertySymbols(lr);ta<Tr.length;ta++)Cr.indexOf(Tr[ta])<0&&Object.prototype.propertyIsEnumerable.call(lr,Tr[ta])&&(vr[Tr[ta]]=lr[Tr[ta]]);return vr},ut={members:[],type:"round-convex",nonMembers:[],style:{fill:"lightblue",stroke:"blue",opacity:.2},padding:10},dt=function(Cr,vr){var Tr=Cr.style,ta=Tr===void 0?{}:Tr,ra=st(Cr,["style"]),Zr=vr.style,vt=Zr===void 0?{}:Zr,_n=st(vr,["style"]);return Object.assign(Object.assign(Object.assign({},ra),_n),{style:Object.assign(Object.assign({},ta),vt)})},gt,wt=function(Cr){var vr=X.useContext(tt.Z),Tr=vr.graph,ta=Cr.options;return X.useEffect(function(){gt&&gt.length&&gt.forEach(function(Zr){return Tr.removeHull(Zr)}),gt=ta.map(function(Zr){return Tr.createHull(dt(ut,Object.assign({id:"".concat(Math.random())},Zr)))});var ra=(0,mt.debounce)(function(){gt.forEach(function(Zr,vt){Zr.group.destroyed?gt[vt]=Tr.createHull(dt(ut,Object.assign({id:"".concat(Math.random())},ta[vt]))):Zr.updateData(Zr.members)})});return Tr.on("afterupdateitem",ra),Tr.on("aftergraphrefreshposition",ra),function(){Tr.off("afterupdateitem",ra),Tr.off("aftergraphrefreshposition",ra)}},[Tr,ta]),null},ot=wt,pt=$(94635);function Nt(lr,Cr){return ke(lr)||Be(lr,Cr)||se(lr,Cr)||Gt()}function Gt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function se(lr,Cr){if(!!lr){if(typeof lr=="string")return ie(lr,Cr);var vr=Object.prototype.toString.call(lr).slice(8,-1);if(vr==="Object"&&lr.constructor&&(vr=lr.constructor.name),vr==="Map"||vr==="Set")return Array.from(lr);if(vr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(vr))return ie(lr,Cr)}}function ie(lr,Cr){(Cr==null||Cr>lr.length)&&(Cr=lr.length);for(var vr=0,Tr=new Array(Cr);vr<Cr;vr++)Tr[vr]=lr[vr];return Tr}function Be(lr,Cr){var vr=lr==null?null:typeof Symbol!="undefined"&&lr[Symbol.iterator]||lr["@@iterator"];if(vr!=null){var Tr=[],ta=!0,ra=!1,Zr,vt;try{for(vr=vr.call(lr);!(ta=(Zr=vr.next()).done)&&(Tr.push(Zr.value),!(Cr&&Tr.length===Cr));ta=!0);}catch(_n){ra=!0,vt=_n}finally{try{!ta&&vr.return!=null&&vr.return()}finally{if(ra)throw vt}}return Tr}}function ke(lr){if(Array.isArray(lr))return lr}var we=function(Cr){var vr=X.useContext(tt.Z),Tr=vr.graph,ta=vr.theme,ra=Cr.options,Zr=Cr.dataMap,vt=Cr.onChange,_n=ta.mode,an=X.useState({options:ra}),Lt=Nt(an,2),kt=Lt[0],at=Lt[1];(0,X.useEffect)(function(){at({options:ra})},[ra]);var H=kt.options,Y=function($t){var jt=Object.assign(Object.assign({},$t),{checked:!$t.checked}),Ht=H.map(function(on){var Je=on.value===$t.value;return Je?jt:on});at({options:Ht});var re=Zr.get(jt.value);re.forEach(function(on){Tr.setItemState(on.id,"active",jt.checked),Tr.setItemState(on.id,"inactive",!jt.checked);var Je=on.id,Ve=Tr.findById(Je),qn=Ve.getEdges();qn.forEach(function(Ln){Tr.setItemState(Ln,"normal",jt.checked),Tr.setItemState(Ln,"inactive",!jt.checked)})}),vt(jt,Ht)};return X.createElement("ul",{className:"graphin-components-legend-content"},H.map(function(bt){var $t=bt.label,jt=bt.checked,Ht=bt.color,re={light:{active:Ht,inactive:"#ddd"},dark:{active:Ht,inactive:"#2f2f2f"}},on={light:{active:"#000",inactive:"#ddd"},dark:{active:"#fff",inactive:"#2f2f2f"}},Je=jt?"active":"inactive";return X.createElement("li",{key:bt.value,className:"item",onClick:function(){Y(bt)},onKeyDown:function(){Y(bt)}},X.createElement("span",{className:"dot",style:{background:re[_n][Je]}}),X.createElement("span",{className:"label",style:{color:on[_n][Je]}},$t))}))},At=we,Yt=$(43054);function be(lr){return Le(lr)||le(lr)||Ee(lr)||nn()}function nn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ee(lr,Cr){if(!!lr){if(typeof lr=="string")return Ze(lr,Cr);var vr=Object.prototype.toString.call(lr).slice(8,-1);if(vr==="Object"&&lr.constructor&&(vr=lr.constructor.name),vr==="Map"||vr==="Set")return Array.from(lr);if(vr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(vr))return Ze(lr,Cr)}}function le(lr){if(typeof Symbol!="undefined"&&lr[Symbol.iterator]!=null||lr["@@iterator"]!=null)return Array.from(lr)}function Le(lr){if(Array.isArray(lr))return Ze(lr)}function Ze(lr,Cr){(Cr==null||Cr>lr.length)&&(Cr=lr.length);for(var vr=0,Tr=new Array(Cr);vr<Cr;vr++)Tr[vr]=lr[vr];return Tr}var fe=Yt.Z.getEnumValue,Re=Yt.Z.getEnumDataMap,He=function(Cr){var vr=Cr.bindType,Tr=vr===void 0?"node":vr,ta=Cr.sortKey,ra=X.useContext(tt.Z),Zr=ra.graph,vt=Zr.save();if(vt.children)return console.error("not support tree graph"),{dataMap:new Map,options:{}};var _n=Re(vt["".concat(Tr,"s")],ta),an=be(_n.keys()),Lt=an.map(function(kt){var at=(_n.get(kt)||[{}])[0],H=fe(at,"style.keyshape.fill"),Y=fe(at,"style.color"),bt=H||Y;return{color:bt,value:kt,label:kt,checked:!0}});return{dataMap:_n,options:Lt}},pe=He,Ge={position:"absolute",top:"0px",right:"0px"},te=function(Cr){var vr=Cr.bindType,Tr=vr===void 0?"node":vr,ta=Cr.sortKey,ra=Cr.children,Zr=Cr.style,vt=pe({bindType:Tr,sortKey:ta}),_n=vt.dataMap,an=vt.options;return X.createElement("div",{className:"graphin-components-legend",style:Object.assign(Object.assign({},Ge),Zr)},ra({bindType:Tr,sortKey:ta,dataMap:_n,options:an}))};te.Node=At;var Me=te,We={className:"graphin-minimap",viewportClassName:"graphin-minimap-viewport",type:"default",padding:50,size:[200,120],delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0},ee={container:{position:"absolute",bottom:0,left:0,background:"#fff",boxShadow:"0px 8px 10px -5px rgba(0,0,0,0.2), 0px 16px 24px 2px rgba(0,0,0,0.14), 0px 6px 30px 5px rgba(0,0,0,0.12)"}},Pt=null,yt=120,Ne=function(Cr){var vr=X.useContext(tt.Z),Tr=vr.graph,ta=Cr.options,ra=Cr.style,Zr=ra===void 0?{}:ra;X.useEffect(function(){var _n=Tr.getWidth(),an=Tr.getHeight(),Lt=Tr.get("fitViewPadding"),kt=[(_n-Lt*2)/(an-Lt*2)*yt,yt],at=Object.assign(Object.assign(Object.assign({container:Pt},We),{size:kt}),ta),H=new K.ZP.Minimap(at);return Tr.addPlugin(H),function(){H&&!H.destroyed&&Tr.removePlugin(H)}},[ta]);var vt=Object.assign(Object.assign({},ee.container),Zr);return X.createElement("div",{ref:function(an){Pt=an},style:vt})},tn=Ne,fn={line:{stroke:"#FA8C16",lineWidth:.5},itemAlignType:"center"},Rt=function(Cr){var vr=X.useContext(tt.Z),Tr=vr.graph,ta=Cr.options,ra=Cr.visible;return X.useEffect(function(){var Zr=Object.assign(Object.assign({},fn),ta),vt=new K.ZP.SnapLine(Zr);return ra&&Tr.addPlugin(vt),function(){Tr&&!Tr.destroyed&&Tr.removePlugin(vt)}},[Tr,ta,ra]),null},Yn=Rt;function Un(lr,Cr,vr){var Tr=lr.get("canvas"),ta=Tr.get("width"),ra=Tr.get("height"),Zr=vr<=ra/4,vt=vr>=3*ra/4,_n=Cr<=ta/4,an=Cr>=3*ta/4;return _n&&Zr?"bottom-right":an&&Zr?"bottom-left":_n&&vt?"top-right":an&&vt?"top-left":Zr?"bottom":vt?"top":_n?"right":an?"left":"center"}var xr=function(Cr){var vr=Cr.graph,Tr=Cr.placement,ta=Cr.nodeSize,ra=Cr.x,Zr=Cr.y,vt=Cr.bindType,_n=vt===void 0?"node":vt,an=Cr.visible;return _n==="edge"?an?{left:ra,top:Zr}:{visibility:"hidden",left:ra,top:Zr}:(Tr==="auto"&&(Tr=Un(vr,ra,Zr)),Tr==="top"?an?{left:ra,top:Zr-ta/2,opacity:1,transform:"translate(-50%,calc(-100% - 6px))",transition:"opacity 0.5s,transform 0.5s"}:{visibility:"hidden",left:0,top:0,opacity:0,transform:"translate(-50%,-100%)",transition:"opacity 0.5s,transform 0.5s"}:Tr==="bottom"?an?{left:ra,top:Zr+ta/2,opacity:1,transform:"translate(-50%,6px)",transition:"opacity 0.5s,transform 0.5s"}:{visibility:"hidden",left:ra,top:Zr+ta/2,opacity:0,transform:"translate(-50%,0px)",transition:"opacity 0.5s,transform 0.5s"}:Tr==="left"?an?{left:ra-ta/2,top:Zr,transform:"translate(calc(-100% - 6px),-50%)",opacity:1,transition:"opacity 0.5s,transform 0.5s"}:{visibility:"hidden",opacity:0,left:ra-ta/2,top:Zr,transform:"translate(-100%,-50%)",transition:"opacity 0.5s,transform 0.5s"}:Tr==="right"?an?{left:ra+ta/2,top:Zr,transform:"translate(6px,-50%)",opacity:1,transition:"opacity 0.5s,transform 0.5s"}:{visibility:"hidden",left:ra+ta/2,top:Zr,transform:"translate(0,-50%)",opacity:0,transition:"opacity 0.5s,transform 0.5s"}:Tr==="top-left"?an?{left:ra-ta/2,top:Zr-ta/2,opacity:1,transform:"translate(calc(-100% - 6px),calc(-100% - 6px))",transition:"opacity 0.5s,transform 0.5s"}:{left:ra-ta/2,top:Zr-ta/2,opacity:0,transform:"translate(-100%,-100%)",transition:"opacity 0.5s,transform 0.5s"}:Tr==="top-right"?an?{left:ra+ta/2,top:Zr-ta/2,opacity:1,transform:"translate(6px,calc(-100% - 6px))",transition:"opacity 0.5s,transform 0.5s"}:{left:ra+ta/2,top:Zr-ta/2,opacity:0,transform:"translate(0,-100%)",transition:"opacity 0.5s,transform 0.5s"}:Tr==="bottom-left"?an?{left:ra-ta/2,top:Zr+ta/2,opacity:1,transform:"translate(calc(-100% - 6px),6px)",transition:"opacity 0.5s,transform 0.5s"}:{left:ra-ta/2,top:Zr+ta/2,opacity:0,transform:"translate(-100%,0px)",transition:"opacity 0.5s,transform 0.5s"}:Tr==="bottom-right"?an?{left:ra+ta/2,top:Zr+ta/2,opacity:1,transform:"translate(6px,6px)",transition:"opacity 0.5s,transform 0.5s"}:{left:ra+ta/2,top:Zr+ta/2,opacity:0,transform:"translate(0,0)",transition:"opacity 0.5s,transform 0.5s"}:Tr==="center"?an?{left:ra,top:Zr,opacity:1,transition:"opacity 0.5s,transform 0.5s"}:{visibility:"hidden",left:ra,top:Zr,opacity:0,transition:"opacity 0.5s,transform 0.5s"}:{left:ra,top:Zr})},cr=xr,Ur=$(81355);function fa(lr,Cr){return Mn(lr)||Rr(lr,Cr)||sa(lr,Cr)||Sa()}function Sa(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sa(lr,Cr){if(!!lr){if(typeof lr=="string")return Da(lr,Cr);var vr=Object.prototype.toString.call(lr).slice(8,-1);if(vr==="Object"&&lr.constructor&&(vr=lr.constructor.name),vr==="Map"||vr==="Set")return Array.from(lr);if(vr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(vr))return Da(lr,Cr)}}function Da(lr,Cr){(Cr==null||Cr>lr.length)&&(Cr=lr.length);for(var vr=0,Tr=new Array(Cr);vr<Cr;vr++)Tr[vr]=lr[vr];return Tr}function Rr(lr,Cr){var vr=lr==null?null:typeof Symbol!="undefined"&&lr[Symbol.iterator]||lr["@@iterator"];if(vr!=null){var Tr=[],ta=!0,ra=!1,Zr,vt;try{for(vr=vr.call(lr);!(ta=(Zr=vr.next()).done)&&(Tr.push(Zr.value),!(Cr&&Tr.length===Cr));ta=!0);}catch(_n){ra=!0,vt=_n}finally{try{!ta&&vr.return!=null&&vr.return()}finally{if(ra)throw vt}}return Tr}}function Mn(lr){if(Array.isArray(lr))return lr}var ar=function(Cr){var vr=Cr.bindType,Tr=vr===void 0?"node":vr,ta=Cr.container,ra=X.useContext(tt.Z),Zr=ra.graph,vt=(0,X.useRef)(),_n=X.useState({visible:!1,x:0,y:0,item:null}),an=fa(_n,2),Lt=an[0],kt=an[1],at=function(Ht){Ht.preventDefault(),Ht.stopPropagation(),vt.current&&window.clearTimeout(vt.current);var re=Zr.getPointByClient(Ht.clientX,Ht.clientY),on=Zr.getCanvasByPoint(re.x,re.y),Je=on.x,Ve=on.y;if(Tr==="node"&&Ht.item){var qn=Ht.item.getModel(),Ln=qn.x,qr=Ln===void 0?0:Ln,Ca=qn.y,Qn=Ca===void 0?0:Ca,_r=Zr.getCanvasByPoint(qr,Qn),ea=Ht.canvasX-_r.x,La=Ht.canvasY-_r.y;Je=Je-ea,Ve=Ve-La}vt.current=window.setTimeout(function(){kt(function(ha){return Object.assign(Object.assign({},ha),{visible:!0,item:Ht.item,x:Je,y:Ve})})},Cr.delay.show)},H=function(){vt.current&&window.clearTimeout(vt.current),vt.current=window.setTimeout(function(){kt(function(Ht){return Object.assign(Object.assign({},Ht),{visible:!1,item:null,x:0,y:0})})},Cr.delay.hide)},Y=function(){kt(Object.assign(Object.assign({},Lt),{visible:!1,x:0,y:0,item:null}))},bt=function(Ht){var re=Zr.getPointByClient(Ht.clientX,Ht.clientY),on=Zr.getCanvasByPoint(re.x,re.y),Je=on.x,Ve=on.y;if(Tr==="node"){if(Ht.item){var qn=Ht.item.getModel(),Ln=qn.x,qr=Ln===void 0?0:Ln,Ca=qn.y,Qn=Ca===void 0?0:Ca,_r=Zr.getCanvasByPoint(qr,Qn),ea=Ht.canvasX-_r.x,La=Ht.canvasY-_r.y;Je=Je-ea,Ve=Ve-La}kt(Object.assign(Object.assign({},Lt),{visible:!0,x:Je,y:Ve,item:Ht.item}))}},$t=function(){clearTimeout(vt.current)};return(0,X.useEffect)(function(){var jt,Ht;return Zr.on("".concat(Tr,":mouseenter"),at),Zr.on("".concat(Tr,":mouseleave"),H),Zr.on("afterremoveitem",H),Zr.on("node:dragstart",Y),Zr.on("node:dragend",bt),(jt=ta.current)===null||jt===void 0||jt.addEventListener("mouseenter",$t),(Ht=ta.current)===null||Ht===void 0||Ht.addEventListener("mouseleave",H),function(){var re,on;console.log("effect..remove...."),Zr.off("".concat(Tr,":mouseenter"),at),Zr.off("".concat(Tr,":mouseleave"),H),Zr.off("afterremoveitem",H),Zr.off("node:dragstart",Y),Zr.off("node:dragend",bt),(re=ta.current)===null||re===void 0||re.removeEventListener("mouseenter",$t),(on=ta.current)===null||on===void 0||on.removeEventListener("mouseleave",H)}},[]),Object.assign({},Lt)},Fn=ar,tr={width:"120px",boxShadow:"0 4px 12px rgb(0 0 0 / 15%)"},Gn=X.createRef(),jr=function(Cr){var vr=Cr.children,Tr=Cr.bindType,ta=Tr===void 0?"node":Tr,ra=Cr.style,Zr=Cr.placement,vt=Zr===void 0?"top":Zr,_n=Cr.hasArrow,an=Cr.delay,Lt=an===void 0?{show:0,hide:200}:an,kt=Fn({bindType:ta,container:Gn,delay:Lt}),at=kt.x,H=kt.y,Y=kt.visible,bt=kt.item,$t=X.useContext(tt.Z),jt=$t.graph,Ht=40;try{if(bt){var re=bt.getModel(),on=re.type;if(on==="graphin-cirle"){var Je=bt.getModel(),Ve=Je.style;Ve&&(Ht=Ve.keyshape.size)}}}catch(_r){console.log(_r)}var qn=12,Ln=cr({graph:jt,placement:vt,nodeSize:Ht+qn,x:at,y:H,bindType:ta,visible:Y}),qr=Object.assign({position:"absolute"},Ln);if(typeof vr!="function")return console.error("<Tooltip /> children should be a function"),null;var Ca=bt&&!bt.destroyed&&bt.getModel&&bt.getModel()||{},Qn=Ca.id||"";return X.createElement(X.Fragment,null,X.createElement("div",{ref:Gn,className:"graphin-components-tooltip ".concat(vt),style:Object.assign(Object.assign(Object.assign({},tr),qr),ra)},Y&&X.createElement("div",null,_n&&X.createElement("div",{className:"tooltip-arrow ".concat(vt)}),vr({item:bt,bindType:ta,model:Ca,id:Qn}))))},Hr=jr,Ea={ContextMenu:F,Hull:ot,MiniMap:tn,FishEye:ft,SnapLine:Yn,Tooltip:Hr,Legend:Me,useLegend:pe,useTooltip:Fn,useContextMenu:M}},42134:function(sr,it,$){"use strict";$.d(it,{ZP:function(){return Ol}});var X={};$.r(X),$.d(X,{handleAutoZoom:function(){return C},handleChangeZoom:function(){return L},handleRealZoom:function(){return P},handleZoomIn:function(){return Z},handleZoomOut:function(){return Q}});var tt={};$.r(tt),$.d(tt,{focusNodeById:function(){return k},highlightNodeById:function(){return M}});var j=$(34763),W=$(67294),Q=function(ve){return function(){if(!(!ve||ve.destroyed)){var Bt=ve.getZoom(),ae=ve.get("canvas"),me=ae.getPointByClient(ae.get("width")/2,ae.get("height")/2),En=ae.get("pixelRatio")||1,Zn=1+.05*5;if(!(Zn*Bt>5))return ve.zoom(Zn,{x:me.x/En,y:me.y/En},!0,{easing:"easeCubic",duration:150}),{text:"".concat(Math.round(Zn*Bt*100),"%"),ratio:Zn*Bt}}}},Z=function(ve){return function(){if(!(!ve||ve.destroyed)){var Bt=ve.getZoom(),ae=ve.get("canvas"),me=ae.getPointByClient(ae.get("width")/2,ae.get("height")/2),En=ae.get("pixelRatio")||1,Zn=1-.05*5;if(!(Zn*Bt<.3))return ve.zoom(Zn,{x:me.x/En,y:me.y/En},!0,{easing:"easeCubic",duration:150}),{text:"".concat(Math.round(Zn*Bt*100),"%"),ratio:Zn*Bt}}}},L=function(ve){return function(Bt){var ae=Bt.text,me=Bt.ratio;if(!(!ve||ve.destroyed)){var En=ve.get("canvas"),Zn=En.getPointByClient(En.get("width")/2,En.get("height")/2),Kt=En.get("pixelRatio")||1;return ve.zoomTo(me,{x:Zn.x/Kt,y:Zn.y/Kt},!0,{easing:"easeCubic",duration:150}),{text:ae,ratio:me}}}},P=function(ve){return function(){if(!(!ve||ve.destroyed)){var Bt=ve.getZoom();return ve.zoom(1/Bt),ve.fitCenter(),{text:"100%",ratio:1}}}},C=function(ve){return function(){if(!(!ve||ve.destroyed)){var Bt=ve.getNodes();Bt.length>0&&ve.fitView([20,20],{},!0);var ae=ve.getZoom();return{text:"".concat(Math.round(ae*100),"%"),ratio:ae}}}},M=function(ve){return function(Bt){ve.getNodes().forEach(function(ae){ve.clearItemStates(ae,["active","inactive"]),Bt.indexOf(ae.get("id"))!==-1?ve.setItemState(ae,"active",!0):ve.setItemState(ae,"active",!1)})}},k=function(ve){return function(Bt){if(!(!ve||typeof Bt!="string")){var ae=ve.findById(Bt);if(!ae){console.warn("The node ".concat(Bt," does not exist!"));return}ve.focusItem(Bt,!0,{duration:200,easing:"easeCubic"}),ve.setItemState(ae,"selected",!0),ae.toFront()}}};function B(_e,ve,Bt){return ve in _e?Object.defineProperty(_e,ve,{value:Bt,enumerable:!0,configurable:!0,writable:!0}):_e[ve]=Bt,_e}var R=Object.assign(Object.assign({},X),tt),F=function(ve){var Bt=Object.keys(R);return Bt.reduce(function(ae,me){return Object.assign(Object.assign({},ae),B({},me,R[me](ve)))},{})},K=F,O=$(98818),_={type:"compactBox",direction:"LR",getId:function(ve){return ve.id},getHeight:function(){return 16},getWidth:function(){return 16},getVGap:function(){return 80},getHGap:function(){return 20}},ft=["dendrogram","compactBox","mindmap","indented"],mt={type:"force2"},st=$(36950),ut=function(){return Math.round((Math.random()-.5)*80)},dt=500,gt=300,wt=function(ve,Bt){var ae=ve.nodes,me=ve.edges,En=Bt.nodes,Zn=new Map;En.forEach(function(Ae){var sn=Ae.id,xn=Ae.x,ir=Ae.y;Zn.set(sn,{x:xn,y:ir})});var Kt=new Map;ae.forEach(function(Ae){var sn=Ae.id,xn=Zn.get(sn),ir=xn.x,$r=xn.y;!window.isNaN(ir)&&!window.isNaN($r)?(Ae.x=ir,Ae.y=$r):Kt.set(sn,Ae)});var ge=new Map;return me.forEach(function(Ae){var sn=Ae.source,xn=Ae.target,ir=Kt.get(sn),$r=Kt.get(xn),Aa=Zn.get(sn),Va=!window.isNaN(Aa.x)&&!window.isNaN(Aa.y),Ba=Zn.get(xn),oi=!window.isNaN(Ba.x)&&!window.isNaN(Ba.y);ir&&oi&&ge.set(sn,{x:Ba.x+ut(),y:Ba.y+ut()}),$r&&Va&&ge.set(xn,{x:Aa.x+ut(),y:Aa.y+ut()})}),ae.forEach(function(Ae){var sn=Ae.id,xn=Zn.get(sn);(window.isNaN(xn.x)||window.isNaN(xn.y))&&(xn=ge.get(sn)||{}),!window.isNaN(xn.x)&&!window.isNaN(xn.y)?(Ae.x=xn.x,Ae.y=xn.y):(Ae.x=dt/2+Math.round(Math.random()*dt),Ae.y=gt/2+Math.round(Math.random()*gt))}),Object.assign(Object.assign({},ve),{nodes:ae,edges:me})},ot=wt,pt=$(9419);function Nt(_e,ve){if(!(_e instanceof ve))throw new TypeError("Cannot call a class as a function")}function Gt(_e,ve){for(var Bt=0;Bt<ve.length;Bt++){var ae=ve[Bt];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(_e,ae.key,ae)}}function se(_e,ve,Bt){return ve&&Gt(_e.prototype,ve),Bt&&Gt(_e,Bt),Object.defineProperty(_e,"prototype",{writable:!1}),_e}var ie=function(ve){return!(ve&&ve.nodes&&ve.nodes.length!==0)},Be=["force","graphin-force","g6force","gForce","comboForce"],ke=function(){function _e(ve){var Bt=this;Nt(this,_e),this.updateOptions=function(){var ae={type:"concentric"},me=Bt.graphin,En=me.width,Zn=me.height,Kt=me.props,ge=Kt.layout,Ae=ge===void 0?ae:ge,sn=Ae.type,xn=sn===void 0?"concentric":sn,ir=Ae.preset,$r={width:En,height:Zn,center:[En/2,Zn/2]};if(Bt.options=Object.assign(Object.assign(Object.assign({},$r),pt.Z[xn]||{}),Ae),ie(Bt.graphin.data)){Bt.prevOptions={};return}if(Be.indexOf(xn)!==-1){var Aa=Bt.prevOptions.type||"grid";(ir==null?void 0:ir.type)&&(Aa=ir.type),ie(Bt.graphin.data)&&(Aa=ir.type||"grid"),Bt.options.preset=Object.assign(Object.assign(Object.assign({type:Aa},$r),pt.Z[Aa]||{}),ir)}},this.processForce=function(){var ae=Bt,me=ae.options,En=ae.graphin,Zn=En.graph,Kt=me.type,ge=me.animation,Ae=me.animate;if(Kt==="graphin-force"&&(ae.options.graph=Zn),Kt==="force"||Kt==="g6force"||Kt==="gForce"||Kt==="comboCombined"){var sn=ae.options.onTick,xn=function(){sn&&sn(),(ge||Ae)&&ae.refreshPosition()};ae.options.tick=xn;var ir=ae.options.onLayoutEnd;ae.options.onLayoutEnd=function(){ae.refreshPosition(),ir==null||ir(),Zn.emit("afterlayout")}}(Kt==="comboForce"||Kt==="comboCombined")&&(ae.options.comboTrees=Zn.get("comboTrees"));var $r={prev:Be.indexOf(ae.prevOptions.type)!==-1,current:Be.indexOf(ae.options.type)!==-1},Aa=ae.options.type===ae.prevOptions.type;if(!ie(En.data)){if($r.current&&!Aa){var Va=ae.options.preset;ae.presetLayout=new j.ZP.Layout[Va.type](Object.assign({},Va)||{}),ae.presetLayout.init(En.data),ae.presetLayout.execute(),ae.presetLayout.data=Object.assign({},En.data)}if($r.current&&$r.prev&&!ae.hasPosition()){var Ba=ae.graph.save(),oi=ae.options.preset;ie(Ba)&&(ae.presetLayout=new j.ZP.Layout[oi.type](Object.assign({},oi)||{}),ae.presetLayout.init(En.data),ae.presetLayout.execute(),Ba=En.data),En.data=ot(En.data,Ba)}}},this.refreshPosition=function(){var ae=Bt.graphin,me=ae.options,En=me.animate,Zn=me.layoutAnimate,Kt=Bt.options.type;En&&!Zn&&!Bt.options.animation?Bt.graph.positionsAnimate(Kt==="comboCombined"):Bt.graph.refreshPositions(Kt==="comboCombined")},this.destroy=function(){Bt.presetLayout&&Bt.presetLayout.destroy&&Bt.presetLayout.destroy(),Bt.instance&&Bt.instance.destroy&&Bt.instance.destroy(),Bt.presetLayout=null,Bt.instance=null},this.getDataFromGraph=function(){for(var ae=[],me=[],En=[],Zn=[],Kt=Bt.graph.getNodes(),ge=Bt.graph.getEdges(),Ae=Bt.graph.getCombos(),sn=Kt.length,xn=0;xn<sn;xn++){var ir=Kt[xn];if(ir&&ir.isVisible()){var $r=ir.getModel();ae.push($r)}}for(var Aa=ge.length,Va=0;Va<Aa;Va++){var Ba=ge[Va];if(Ba&&Ba.isVisible()){var oi=Ba.getModel();oi.isComboEdge?Zn.push(oi):me.push(oi)}}for(var ro=Ae.length,Di=0;Di<ro;Di++){var Si=Ae[Di];if(Si&&Si.isVisible()){var _o=Si.getModel();En.push(_o)}}return{nodes:ae,edges:me,combos:En,comboEdges:Zn}},this.graphin=ve,this.graph=this.graphin.graph,this.presetLayout=null,this.prevOptions={},this.init()}return se(_e,[{key:"hasPosition",value:function(){var Bt=this.graphin,ae=Bt.data,me=ae===void 0?{}:ae;return!me.nodes||me.nodes.length===0?!1:me.nodes.every(function(En){return!window.isNaN(Number(En.x))&&!window.isNaN(Number(En.y))})}},{key:"init",value:function(){this.updateOptions();var Bt=this.options,ae=this.graphin,me=ae.data,En=Bt.type;this.processForce(),j.ZP.Layout[En]||console.warn("".concat(En," layout not found, current layout is grid"));var Zn=j.ZP.Layout[En]||j.ZP.Layout.grid;this.graph.emit("beforelayout"),this.instance=new Zn(this.options),this.instance.init(me)}},{key:"start",value:function(){var Bt=this.options.type;this.instance.execute(),!(Bt==="force"||Bt==="g6force"||Bt==="gForce"||Bt==="comboCombined"||Bt==="force2")&&(this.refreshPosition(),this.graph.emit("afterlayout"))}},{key:"changeLayout",value:function(){var Bt=this.graphin,ae=Bt.graph,me=Bt.data,En=Bt.isTree,Zn=Bt.layoutCache;if(!ae||ae.destroyed||!me||!me.nodes||!me.nodes.length||Zn&&this.hasPosition()||En)return!1;Be.indexOf(this.options.type)!==-1&&this.destroy(),this.prevOptions=Object.assign({},this.options),this.init(),this.start()}}]),_e}(),we=ke,At=$(81710),Yt=$(46581),be=$(76575),nn={mode:"light",primaryColor:"#873bf4",nodeSize:26,edgeSize:1,primaryEdgeColor:"#ddd"},Ee=function(ve){var Bt=Object.assign(Object.assign({},nn),ve),ae=Bt.primaryColor,me=Bt.primaryEdgeColor,En=Bt.nodeSize,Zn=Bt.edgeSize,Kt=Bt.mode,ge=Bt.background,Ae=(0,be.Z)({primaryColor:ae,nodeSize:En,mode:Kt}),sn=(0,Yt.Z)({primaryEdgeColor:me,edgeSize:Zn,mode:Kt}),xn=(0,At.Z)(),ir={light:"#fff",dark:"#1f1f1f"};return Object.assign(Object.assign({},Bt),{mode:Kt,background:ge||ir[Kt],defaultNodeStyle:{type:Ae.type,style:Ae.style},defaultNodeStatusStyle:{status:Ae.status},defaultEdgeStyle:{type:sn.type,style:sn.style},defaultEdgeStatusStyle:{status:sn.status},defaultComboStyle:{type:xn.type,style:xn.style},defaultComboStatusStyle:{status:xn.status}})},le=$(57804),Le=function _e(ve,Bt){if(window.isNaN(ve)&&window.isNaN(Bt)&&typeof ve=="number"&&typeof Bt=="number"||ve===Bt)return!0;if(typeof ve=="function"&&typeof Bt=="function"||ve instanceof Date&&Bt instanceof Date||ve instanceof RegExp&&Bt instanceof RegExp||ve instanceof String&&Bt instanceof String||ve instanceof Number&&Bt instanceof Number)return ve.toString()===Bt.toString();if(!(ve instanceof Object&&Bt instanceof Object))return!1;var ae=[],me=Object.keys(ve),En=Object.keys(Bt);if(me.length!==En.length)return!1;for(var Zn=0;Zn<me.length;Zn++){var Kt=me[Zn],ge=_e(ve[Kt],Bt[Kt]);ae.push(ge)}return ae.every(function(Ae){return Ae})},Ze=Le,fe={animation:"animate",minDistanceThreshold:"minMovement",maxIterations:"maxIterations"},Re=function _e(ve,Bt){if(!ve)return ve;var ae={};if(Object.keys(ve).forEach(function(sn){var xn;if(sn==="preset"&&((xn=ve.preset)===null||xn===void 0?void 0:xn.type)){ae.preset=_e(ve.preset,Bt);return}var ir=fe[sn];ir?ae[ir]=ve[sn]:ae[sn]=ve[sn]}),ve.done&&(ve.onLayoutEnd?ae.onLayoutEnd=function(sn){ve.onLayoutEnd(Bt,sn),ve.done(Bt,sn)}:ae.onLayoutEnd=function(sn){ve.done(Bt,sn)}),ae.type==="concentric"){var me=ae.minNodeSpacing,En=me===void 0?60:me,Zn=ae.preventOverlap,Kt=Zn===void 0?!0:Zn,ge=ae.nodeSize,Ae=ge===void 0?60:ge;ae.minNodeSpacing=En,ae.preventOverlap=Kt,ae.nodeSize=Ae}return ae};function He(_e){return He=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ve){return typeof ve}:function(ve){return ve&&typeof Symbol=="function"&&ve.constructor===Symbol&&ve!==Symbol.prototype?"symbol":typeof ve},He(_e)}function pe(_e,ve){if(!(_e instanceof ve))throw new TypeError("Cannot call a class as a function")}function Ge(_e,ve){for(var Bt=0;Bt<ve.length;Bt++){var ae=ve[Bt];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(_e,ae.key,ae)}}function te(_e,ve,Bt){return ve&&Ge(_e.prototype,ve),Bt&&Ge(_e,Bt),Object.defineProperty(_e,"prototype",{writable:!1}),_e}function Me(_e,ve){if(typeof ve!="function"&&ve!==null)throw new TypeError("Super expression must either be null or a function");_e.prototype=Object.create(ve&&ve.prototype,{constructor:{value:_e,writable:!0,configurable:!0}}),Object.defineProperty(_e,"prototype",{writable:!1}),ve&&We(_e,ve)}function We(_e,ve){return We=Object.setPrototypeOf||function(ae,me){return ae.__proto__=me,ae},We(_e,ve)}function ee(_e){var ve=Ne();return function(){var ae=tn(_e),me;if(ve){var En=tn(this).constructor;me=Reflect.construct(ae,arguments,En)}else me=ae.apply(this,arguments);return Pt(this,me)}}function Pt(_e,ve){if(ve&&(He(ve)==="object"||typeof ve=="function"))return ve;if(ve!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yt(_e)}function yt(_e){if(_e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _e}function Ne(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(_e){return!1}}function tn(_e){return tn=Object.setPrototypeOf?Object.getPrototypeOf:function(Bt){return Bt.__proto__||Object.getPrototypeOf(Bt)},tn(_e)}var fn=function(_e,ve){var Bt={};for(var ae in _e)Object.prototype.hasOwnProperty.call(_e,ae)&&ve.indexOf(ae)<0&&(Bt[ae]=_e[ae]);if(_e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var me=0,ae=Object.getOwnPropertySymbols(_e);me<ae.length;me++)ve.indexOf(ae[me])<0&&Object.prototype.propertyIsEnumerable.call(_e,ae[me])&&(Bt[ae[me]]=_e[ae[me]]);return Bt},Rt=O.Z.DragCanvas,Yn=O.Z.ZoomCanvas,Un=O.Z.DragNode,xr=O.Z.DragCombo,cr=O.Z.ClickSelect,Ur=O.Z.BrushSelect,fa=O.Z.ResizeCanvas,Sa=function(_e){Me(Bt,_e);var ve=ee(Bt);function Bt(ae){var me;pe(this,Bt),me=ve.call(this,ae),me.graphDOM=null,me.initData=function(xn){xn.children&&(me.isTree=!0),me.data=(0,le.Z)(xn)},me.initGraphInstance=function(){var xn=me.props,ir=xn.theme,$r=xn.data,Aa=xn.layout,Va=xn.width,Ba=xn.height,oi=xn.defaultCombo,ro=oi===void 0?{style:{},type:"graphin-combo"}:oi,Di=xn.defaultEdge,Si=Di===void 0?{style:{},type:"graphin-line"}:Di,_o=xn.defaultNode,To=_o===void 0?{style:{},type:"graphin-circle"}:_o,wo=xn.nodeStateStyles,Vo=xn.edgeStateStyles,js=xn.comboStateStyles,ws=xn.modes,ks=ws===void 0?{default:[]}:ws,Hs=xn.animate,Mu=xn.handleAfterLayout,nl=fn(xn,["theme","data","layout","width","height","defaultCombo","defaultEdge","defaultNode","nodeStateStyles","edgeStateStyles","comboStateStyles","modes","animate","handleAfterLayout"]);ks.default.length>0&&console.info("%c suggestion: you can use @antv/graphin Behaviors components","color:lightgreen");var Cl=me.graphDOM,Yl=Cl.clientWidth,sl=Cl.clientHeight;me.initData($r),me.width=Number(Va)||Yl||500,me.height=Number(Ba)||sl||500;var rl=Ee(ir),_f=rl.defaultNodeStyle,Dc=rl.defaultEdgeStyle,wc=rl.defaultComboStyle,ef=rl.defaultNodeStatusStyle,A=rl.defaultEdgeStatusStyle,nt=rl.defaultComboStatusStyle,Zt=fn(rl,["defaultNodeStyle","defaultEdgeStyle","defaultComboStyle","defaultNodeStatusStyle","defaultEdgeStatusStyle","defaultComboStatusStyle"]);me.isTree=Boolean($r.children)||ft.indexOf(String(Aa&&Aa.type))!==-1;var de={defaultNode:{style:Object.assign(Object.assign({},To.style),{_theme:ir}),type:To.type||"graphin-circle"},defaultEdge:{style:Object.assign(Object.assign({},Si.style),{_theme:ir}),type:Si.type||"graphin-line"},defaultCombo:{style:Object.assign(Object.assign({},ro.style),{_theme:ir}),type:ro.type||"combo",labelCfg:ro.labelCfg},nodeStateStyles:wo,edgeStateStyles:Vo,comboStateStyles:js};me.theme=Object.assign(Object.assign({},de),Zt),me.options=Object.assign(Object.assign(Object.assign({container:me.graphDOM,renderer:"canvas",width:me.width,height:me.height,animate:Hs!==!1},de),{modes:ks}),nl),me.isTree?(me.options.layout=Aa||_,me.graph=new j.ZP.TreeGraph(me.options)):(me.useGraphinLayoutController||(me.options.layout=Re(Aa,me.graph)||mt),me.graph=new j.ZP.Graph(me.options)),me.graph.on("afterlayout",function(){Mu&&Mu(me.graph)}),me.graph.data(me.data),me.setTextDirection(),me.graph.render(),!me.isTree&&me.useGraphinLayoutController&&(me.layout=new we(yt(me)),me.layout.start()),me.initStatus(),me.apis=K(me.graph),me.setState({isReady:!0,context:{graph:me.graph,apis:me.apis,theme:me.theme,layout:me.layout,dragNodes:me.dragNodes,updateContext:me.updateContext}})},me.updateLayout=function(){me.useGraphinLayoutController&&me.layout.changeLayout()},me.updateOptions=function(){var xn=fn(me.props,[]);return xn},me.initStatus=function(){if(!me.isTree){var xn=me.props.data,ir=xn.nodes,$r=ir===void 0?[]:ir,Aa=xn.edges,Va=Aa===void 0?[]:Aa;$r.forEach(function(Ba){var oi=Ba.status;oi&&Object.keys(oi).forEach(function(ro){me.graph.setItemState(Ba.id,ro,Boolean(oi[ro]))})}),Va.forEach(function(Ba){var oi=Ba.status;oi&&Object.keys(oi).forEach(function(ro){me.graph.setItemState(Ba.id,ro,Boolean(oi[ro]))})})}},me.updateContext=function(xn){me.setState(function(ir){return{context:Object.assign(Object.assign({},ir.context),xn)}})},me.clear=function(){me.layout&&me.layout.destroy&&me.layout.destroy(),me.layout={},me.graph.clear(),me.data={nodes:[],edges:[],combos:[]},me.graph.destroy()};var En=ae.data,Zn=ae.layout,Kt=ae.width,ge=ae.height,Ae=ae.layoutCache,sn=fn(ae,["data","layout","width","height","layoutCache"]);return me.data=En,me.isTree=Boolean(ae.data&&ae.data.children)||ft.indexOf(String(Zn&&Zn.type))!==-1,me.graph={},me.height=Number(ge),me.width=Number(Kt),me.theme={},me.apis={},me.layoutCache=Ae,me.layout={},me.dragNodes=[],me.useGraphinLayoutController=(Zn==null?void 0:Zn.type)==="graphin-force",me.options=Object.assign({},sn),me.state={isReady:!1,context:{graph:me.graph,apis:me.apis,theme:me.theme,layout:me.layout,dragNodes:me.dragNodes,updateContext:me.updateContext}},me}return te(Bt,[{key:"setTextDirection",value:function(){var me=this.props.dir,En=me===void 0?"ltr":me;this.graph.get("canvas").get("el").setAttribute("dir",En)}},{key:"componentDidMount",value:function(){this.initGraphInstance()}},{key:"componentDidUpdate",value:function(me){var En=this,Zn,Kt,ge=this.shouldUpdate(me,"data"),Ae=this.shouldUpdate(me,"layout"),sn=this.shouldUpdate(me,"options"),xn=this.shouldUpdate(me,"theme"),ir=this.props,$r=ir.data,Aa=ir.layoutCache,Va=ir.rtl,Ba=ir.layout,oi=(0,le.Z)(Ba);this.layoutCache=Aa,sn&&me.rtl!==Va&&(this.setTextDirection(),this.graph.render());var ro;if(ge){if(this.initData($r),this.isTree)this.graph.changeData(this.data);else{var Di=this.state.context.dragNodes;if(ro=Di.filter(function(wo){var Vo;return((Vo=En.data)===null||Vo===void 0?void 0:Vo.nodes)&&En.data.nodes.find(function(js){return js.id===wo.id})}),(Kt=(Zn=this.data)===null||Zn===void 0?void 0:Zn.nodes)===null||Kt===void 0||Kt.forEach(function(wo){var Vo,js,ws,ks,Hs=ro.find(function(Mu){return Mu.id===wo.id});Hs&&(wo.mass=(js=(Vo=Hs.layout)===null||Vo===void 0?void 0:Vo.force)===null||js===void 0?void 0:js.mass,wo.layout=Object.assign(Object.assign({},wo.layout),{force:{mass:(ks=(ws=Hs.layout)===null||ws===void 0?void 0:ws.force)===null||ks===void 0?void 0:ks.mass}}))}),this.useGraphinLayoutController)this.graph.data(this.data),this.graph.set("layoutController",null),this.graph.changeData(this.data),this.data=this.layout.getDataFromGraph(),this.layout.changeLayout();else{oi&&(oi.disableTriggerLayout=!0);var Si=Re(oi,this.graph);this.graph.updateLayout(Si),this.graph.data(this.data),this.graph.changeData(this.data),this.data=this.graph.get("data")}}this.initStatus(),this.apis=K(this.graph),this.setState(function(wo){return Object.assign(Object.assign({},wo),{context:{graph:En.graph,apis:En.apis,theme:En.theme,layout:En.layout,dragNodes:ro||wo.context.dragNodes,updateContext:En.updateContext}})},function(){En.graph.emit("graphin:datachange"),Ae&&En.graph.emit("graphin:layoutchange",{prevLayout:me.layout,layout:oi})});return}if(Ae){if(this.useGraphinLayoutController=(oi==null?void 0:oi.type)==="graphin-force",this.isTree){this.graph.updateLayout(oi);return}if(this.useGraphinLayoutController)Object.keys(this.layout).length===0&&(this.layout=new we(this)),this.data=this.layout.getDataFromGraph(),this.layout.changeLayout();else{var _o=this.graph.get("layoutController");_o||this.graph.initLayoutController();var To=Re(oi,this.graph);To&&(To.disableTriggerLayout=!1),this.graph.updateLayout(To),this.data=this.graph.get("data")}this.graph.emit("graphin:layoutchange",{prevLayout:me.layout,layout:oi})}}},{key:"componentWillUnmount",value:function(){var me=this.props.willUnmount;me?(me(),this.layout&&this.layout.destroy&&this.layout.destroy(),this.layout={},this.graph.destroyLayout()):this.clear()}},{key:"componentDidCatch",value:function(me,En){console.error("Catch component error: ",me,En)}},{key:"shouldUpdate",value:function(me,En){var Zn=me[En],Kt=this.props[En],ge=Ze(Zn,Kt);return!ge}},{key:"render",value:function(){var me=this,En,Zn=this.state.isReady,Kt=this.props,ge=Kt.modes,Ae=Kt.style,sn=Kt.containerId,xn=Kt.containerStyle;return W.createElement(st.Z.Provider,{value:this.state.context},W.createElement("div",{id:sn||"graphin-container",style:Object.assign({height:"100%",width:"100%",position:"relative"},xn)},W.createElement("div",{"data-testid":"custom-element",className:"graphin-core",ref:function($r){me.graphDOM=$r},style:Object.assign({height:"100%",width:" 100%",minHeight:"500px",background:((En=this.theme)===null||En===void 0?void 0:En.background)||"#fff"},Ae)}),W.createElement("div",{className:"graphin-components"},Zn&&W.createElement(W.Fragment,null,!ge&&W.createElement(W.Fragment,null,W.createElement(Rt,null),W.createElement(Yn,null),W.createElement(Un,null),W.createElement(xr,null),W.createElement(cr,null),W.createElement(Ur,null)),W.createElement(fa,{graphDOM:this.graphDOM}),this.props.children))))}}],[{key:"registerBehavior",value:function(me,En){j.ZP.registerBehavior(me,En)}},{key:"registerFontFamily",value:function(me){var En=me(),Zn=En.glyphs,Kt=En.fontFamily,ge=Zn.map(function(Ae){return{name:Ae.name,unicode:String.fromCodePoint(Ae.unicode_decimal)}});return new Proxy(ge,{get:function(sn,xn){var ir=sn.find(function($r){return $r.name===xn});return ir?ir==null?void 0:ir.unicode:(console.error("%c fontFamily:".concat(Kt,",does not found ").concat(xn," icon")),"")}})}},{key:"registerLayout",value:function(me,En){j.ZP.registerLayout(me,En)}}]),Bt}(W.PureComponent);Sa.registerNode=function(_e,ve,Bt){j.ZP.registerNode(_e,ve,Bt)},Sa.registerEdge=function(_e,ve,Bt){j.ZP.registerEdge(_e,ve,Bt)},Sa.registerCombo=function(_e,ve,Bt){j.ZP.registerCombo(_e,ve,Bt)};var sa=Sa,Da=$(43054);function Rr(_e){return tr(_e)||Fn(_e)||ar(_e)||Mn()}function Mn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ar(_e,ve){if(!!_e){if(typeof _e=="string")return Gn(_e,ve);var Bt=Object.prototype.toString.call(_e).slice(8,-1);if(Bt==="Object"&&_e.constructor&&(Bt=_e.constructor.name),Bt==="Map"||Bt==="Set")return Array.from(_e);if(Bt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Bt))return Gn(_e,ve)}}function Fn(_e){if(typeof Symbol!="undefined"&&_e[Symbol.iterator]!=null||_e["@@iterator"]!=null)return Array.from(_e)}function tr(_e){if(Array.isArray(_e))return Gn(_e)}function Gn(_e,ve){(ve==null||ve>_e.length)&&(ve=_e.length);for(var Bt=0,ae=new Array(ve);Bt<ve;Bt++)ae[Bt]=_e[Bt];return ae}var jr=function(ve,Bt){var ae=ve.data.id,me=0,En=0,Zn=0;return Bt.forEach(function(Kt){Kt.source.id===ae&&(En+=1,me+=1),Kt.target.id===ae&&(Zn+=1,me+=1)}),{degree:me,sDegree:En,tDegree:Zn}},Hr=function(ve,Bt){return Rr(new Set(ve==null?void 0:ve.map(function(ae){var me;return(me=ae==null?void 0:ae.data)===null||me===void 0?void 0:me[Bt]})))||[]},Ea=function(ve,Bt,ae){var me,En;return ve==="source"?((me=ae==null?void 0:ae.find(function(Zn){var Kt;return((Kt=Zn.target)===null||Kt===void 0?void 0:Kt.id)===Bt.id}))===null||me===void 0?void 0:me.source)||{}:((En=ae==null?void 0:ae.find(function(Zn){var Kt;return((Kt=Zn.source)===null||Kt===void 0?void 0:Kt.id)===Bt.id}))===null||En===void 0?void 0:En.target)||{}},lr=function(ve,Bt,ae,me){var En,Zn=((En=ae==null?void 0:ae.data)===null||En===void 0?void 0:En[Bt])||"",Kt=(me==null?void 0:me.filter(function(ge){var Ae;return((Ae=ge==null?void 0:ge.data)===null||Ae===void 0?void 0:Ae[Bt])===Zn}))||[];return ve==="leaf"&&(Kt=Kt.filter(function(ge){var Ae,sn,xn,ir;return((sn=(Ae=ge.data)===null||Ae===void 0?void 0:Ae.layout)===null||sn===void 0?void 0:sn.sDegree)===0||((ir=(xn=ge.data)===null||xn===void 0?void 0:xn.layout)===null||ir===void 0?void 0:ir.tDegree)===0})),Kt},Cr=function(ve,Bt,ae){var me=[];switch(ve){case"source":me=ae==null?void 0:ae.filter(function(En){var Zn;return((Zn=En.source)===null||Zn===void 0?void 0:Zn.id)===Bt.id}).map(function(En){return En.target});break;case"target":me=ae==null?void 0:ae.filter(function(En){var Zn;return((Zn=En.target)===null||Zn===void 0?void 0:Zn.id)===Bt.id}).map(function(En){return En.source});break;case"both":me=ae==null?void 0:ae.filter(function(En){var Zn;return((Zn=En.source)===null||Zn===void 0?void 0:Zn.id)===Bt.id}).map(function(En){return En.target}).concat(ae==null?void 0:ae.filter(function(En){var Zn;return((Zn=En.target)===null||Zn===void 0?void 0:Zn.id)===Bt.id}).map(function(En){return En.source}));break;default:break}return me=Da.Z.uniqBy(me,function(En,Zn){return En.id===Zn.id}),me},vr=function(ve,Bt,ae,me){var En,Zn=((En=Bt==null?void 0:Bt.data)===null||En===void 0?void 0:En.layout)||{},Kt=Zn.sDegree,ge=Zn.tDegree,Ae=Bt,sn=[];Kt===0?(Ae=Ea("source",Bt,ae),sn=Cr("both",Ae,ae)):ge===0&&(Ae=Ea("target",Bt,ae),sn=Cr("both",Ae,ae)),sn=sn.filter(function(ir){var $r;return(($r=ir.data)===null||$r===void 0?void 0:$r.layout)&&(ir.data.layout.sDegree===0||ir.data.layout.tDegree===0)});var xn=lr(ve,me,Bt,sn);return{coreNode:Ae,relativeLeafNodes:sn,sameTypeLeafNodes:xn}},Tr=function(ve){var Bt=ve.map(function(ge){return ge.x}),ae=ve.map(function(ge){return ge.y}),me=(Math.max.apply(null,Bt)+Math.min.apply(null,Bt))/2,En=(Math.max.apply(null,ae)+Math.min.apply(null,ae))/2,Zn=function(Ae,sn){return Math.sqrt((Ae-me)*(Ae-me)+(sn-En)*(sn-En))},Kt=ve.map(function(ge){return Zn(ge.x||0,ge.y||0)});return ve[Kt.findIndex(function(ge){return ge===Math.min.apply(null,Kt)})]},ta=function(ve){var Bt={x:0,y:0};ve.forEach(function(me){Bt.x+=me.x||0,Bt.y+=me.y||0});var ae=ve.length||1;return{x:Bt.x/ae,y:Bt.y/ae}},ra={getDegree:jr,getRelativeNodesType:Hr,getCoreNodeAndRelativeLeafNodes:vr,getCoreNode:Ea,getSameTypeNodes:lr,getMinDistanceNode:Tr,getAvgNodePosition:ta};function Zr(_e,ve){for(var Bt=0;Bt<ve.length;Bt++){var ae=ve[Bt];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(_e,ae.key,ae)}}function vt(_e,ve,Bt){return ve&&Zr(_e.prototype,ve),Bt&&Zr(_e,Bt),Object.defineProperty(_e,"prototype",{writable:!1}),_e}function _n(_e,ve){if(!(_e instanceof ve))throw new TypeError("Cannot call a class as a function")}var an=vt(function _e(ve){_n(this,_e),this.id=ve.id,this.data=ve||{},this.x=ve.x||0,this.y=ve.y||0}),Lt=vt(function _e(ve,Bt,ae,me){_n(this,_e),this.id=ve,this.source=Bt,this.target=ae,this.data=me||{}});function kt(_e){const ve=+this._x.call(null,_e),Bt=+this._y.call(null,_e);return at(this.cover(ve,Bt),ve,Bt,_e)}function at(_e,ve,Bt,ae){if(isNaN(ve)||isNaN(Bt))return _e;var me,En=_e._root,Zn={data:ae},Kt=_e._x0,ge=_e._y0,Ae=_e._x1,sn=_e._y1,xn,ir,$r,Aa,Va,Ba,oi,ro;if(!En)return _e._root=Zn,_e;for(;En.length;)if((Va=ve>=(xn=(Kt+Ae)/2))?Kt=xn:Ae=xn,(Ba=Bt>=(ir=(ge+sn)/2))?ge=ir:sn=ir,me=En,!(En=En[oi=Ba<<1|Va]))return me[oi]=Zn,_e;if($r=+_e._x.call(null,En.data),Aa=+_e._y.call(null,En.data),ve===$r&&Bt===Aa)return Zn.next=En,me?me[oi]=Zn:_e._root=Zn,_e;do me=me?me[oi]=new Array(4):_e._root=new Array(4),(Va=ve>=(xn=(Kt+Ae)/2))?Kt=xn:Ae=xn,(Ba=Bt>=(ir=(ge+sn)/2))?ge=ir:sn=ir;while((oi=Ba<<1|Va)==(ro=(Aa>=ir)<<1|$r>=xn));return me[ro]=En,me[oi]=Zn,_e}function H(_e){var ve,Bt,ae=_e.length,me,En,Zn=new Array(ae),Kt=new Array(ae),ge=Infinity,Ae=Infinity,sn=-Infinity,xn=-Infinity;for(Bt=0;Bt<ae;++Bt)isNaN(me=+this._x.call(null,ve=_e[Bt]))||isNaN(En=+this._y.call(null,ve))||(Zn[Bt]=me,Kt[Bt]=En,me<ge&&(ge=me),me>sn&&(sn=me),En<Ae&&(Ae=En),En>xn&&(xn=En));if(ge>sn||Ae>xn)return this;for(this.cover(ge,Ae).cover(sn,xn),Bt=0;Bt<ae;++Bt)at(this,Zn[Bt],Kt[Bt],_e[Bt]);return this}function Y(_e,ve){if(isNaN(_e=+_e)||isNaN(ve=+ve))return this;var Bt=this._x0,ae=this._y0,me=this._x1,En=this._y1;if(isNaN(Bt))me=(Bt=Math.floor(_e))+1,En=(ae=Math.floor(ve))+1;else{for(var Zn=me-Bt||1,Kt=this._root,ge,Ae;Bt>_e||_e>=me||ae>ve||ve>=En;)switch(Ae=(ve<ae)<<1|_e<Bt,ge=new Array(4),ge[Ae]=Kt,Kt=ge,Zn*=2,Ae){case 0:me=Bt+Zn,En=ae+Zn;break;case 1:Bt=me-Zn,En=ae+Zn;break;case 2:me=Bt+Zn,ae=En-Zn;break;case 3:Bt=me-Zn,ae=En-Zn;break}this._root&&this._root.length&&(this._root=Kt)}return this._x0=Bt,this._y0=ae,this._x1=me,this._y1=En,this}function bt(){var _e=[];return this.visit(function(ve){if(!ve.length)do _e.push(ve.data);while(ve=ve.next)}),_e}function $t(_e){return arguments.length?this.cover(+_e[0][0],+_e[0][1]).cover(+_e[1][0],+_e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function jt(_e,ve,Bt,ae,me){this.node=_e,this.x0=ve,this.y0=Bt,this.x1=ae,this.y1=me}function Ht(_e,ve,Bt){var ae,me=this._x0,En=this._y0,Zn,Kt,ge,Ae,sn=this._x1,xn=this._y1,ir=[],$r=this._root,Aa,Va;for($r&&ir.push(new jt($r,me,En,sn,xn)),Bt==null?Bt=Infinity:(me=_e-Bt,En=ve-Bt,sn=_e+Bt,xn=ve+Bt,Bt*=Bt);Aa=ir.pop();)if(!(!($r=Aa.node)||(Zn=Aa.x0)>sn||(Kt=Aa.y0)>xn||(ge=Aa.x1)<me||(Ae=Aa.y1)<En))if($r.length){var Ba=(Zn+ge)/2,oi=(Kt+Ae)/2;ir.push(new jt($r[3],Ba,oi,ge,Ae),new jt($r[2],Zn,oi,Ba,Ae),new jt($r[1],Ba,Kt,ge,oi),new jt($r[0],Zn,Kt,Ba,oi)),(Va=(ve>=oi)<<1|_e>=Ba)&&(Aa=ir[ir.length-1],ir[ir.length-1]=ir[ir.length-1-Va],ir[ir.length-1-Va]=Aa)}else{var ro=_e-+this._x.call(null,$r.data),Di=ve-+this._y.call(null,$r.data),Si=ro*ro+Di*Di;if(Si<Bt){var _o=Math.sqrt(Bt=Si);me=_e-_o,En=ve-_o,sn=_e+_o,xn=ve+_o,ae=$r.data}}return ae}function re(_e){if(isNaN(sn=+this._x.call(null,_e))||isNaN(xn=+this._y.call(null,_e)))return this;var ve,Bt=this._root,ae,me,En,Zn=this._x0,Kt=this._y0,ge=this._x1,Ae=this._y1,sn,xn,ir,$r,Aa,Va,Ba,oi;if(!Bt)return this;if(Bt.length)for(;;){if((Aa=sn>=(ir=(Zn+ge)/2))?Zn=ir:ge=ir,(Va=xn>=($r=(Kt+Ae)/2))?Kt=$r:Ae=$r,ve=Bt,!(Bt=Bt[Ba=Va<<1|Aa]))return this;if(!Bt.length)break;(ve[Ba+1&3]||ve[Ba+2&3]||ve[Ba+3&3])&&(ae=ve,oi=Ba)}for(;Bt.data!==_e;)if(me=Bt,!(Bt=Bt.next))return this;return(En=Bt.next)&&delete Bt.next,me?(En?me.next=En:delete me.next,this):ve?(En?ve[Ba]=En:delete ve[Ba],(Bt=ve[0]||ve[1]||ve[2]||ve[3])&&Bt===(ve[3]||ve[2]||ve[1]||ve[0])&&!Bt.length&&(ae?ae[oi]=Bt:this._root=Bt),this):(this._root=En,this)}function on(_e){for(var ve=0,Bt=_e.length;ve<Bt;++ve)this.remove(_e[ve]);return this}function Je(){return this._root}function Ve(){var _e=0;return this.visit(function(ve){if(!ve.length)do++_e;while(ve=ve.next)}),_e}function qn(_e){var ve=[],Bt,ae=this._root,me,En,Zn,Kt,ge;for(ae&&ve.push(new jt(ae,this._x0,this._y0,this._x1,this._y1));Bt=ve.pop();)if(!_e(ae=Bt.node,En=Bt.x0,Zn=Bt.y0,Kt=Bt.x1,ge=Bt.y1)&&ae.length){var Ae=(En+Kt)/2,sn=(Zn+ge)/2;(me=ae[3])&&ve.push(new jt(me,Ae,sn,Kt,ge)),(me=ae[2])&&ve.push(new jt(me,En,sn,Ae,ge)),(me=ae[1])&&ve.push(new jt(me,Ae,Zn,Kt,sn)),(me=ae[0])&&ve.push(new jt(me,En,Zn,Ae,sn))}return this}function Ln(_e){var ve=[],Bt=[],ae;for(this._root&&ve.push(new jt(this._root,this._x0,this._y0,this._x1,this._y1));ae=ve.pop();){var me=ae.node;if(me.length){var En,Zn=ae.x0,Kt=ae.y0,ge=ae.x1,Ae=ae.y1,sn=(Zn+ge)/2,xn=(Kt+Ae)/2;(En=me[0])&&ve.push(new jt(En,Zn,Kt,sn,xn)),(En=me[1])&&ve.push(new jt(En,sn,Kt,ge,xn)),(En=me[2])&&ve.push(new jt(En,Zn,xn,sn,Ae)),(En=me[3])&&ve.push(new jt(En,sn,xn,ge,Ae))}Bt.push(ae)}for(;ae=Bt.pop();)_e(ae.node,ae.x0,ae.y0,ae.x1,ae.y1);return this}function qr(_e){return _e[0]}function Ca(_e){return arguments.length?(this._x=_e,this):this._x}function Qn(_e){return _e[1]}function _r(_e){return arguments.length?(this._y=_e,this):this._y}function ea(_e,ve,Bt){var ae=new La(ve==null?qr:ve,Bt==null?Qn:Bt,NaN,NaN,NaN,NaN);return _e==null?ae:ae.addAll(_e)}function La(_e,ve,Bt,ae,me,En){this._x=_e,this._y=ve,this._x0=Bt,this._y0=ae,this._x1=me,this._y1=En,this._root=void 0}function ha(_e){for(var ve={data:_e.data},Bt=ve;_e=_e.next;)Bt=Bt.next={data:_e.data};return ve}var _i=ea.prototype=La.prototype;_i.copy=function(){var _e=new La(this._x,this._y,this._x0,this._y0,this._x1,this._y1),ve=this._root,Bt,ae;if(!ve)return _e;if(!ve.length)return _e._root=ha(ve),_e;for(Bt=[{source:ve,target:_e._root=new Array(4)}];ve=Bt.pop();)for(var me=0;me<4;++me)(ae=ve.source[me])&&(ae.length?Bt.push({source:ae,target:ve.target[me]=new Array(4)}):ve.target[me]=ha(ae));return _e},_i.add=kt,_i.addAll=H,_i.cover=Y,_i.data=bt,_i.extent=$t,_i.find=Ht,_i.remove=re,_i.removeAll=on,_i.root=Je,_i.size=Ve,_i.visit=qn,_i.visitAfter=Ln,_i.x=Ca,_i.y=_r;var Ni=.81,vi=.1;function si(_e,ve,Bt){return _e.map(function(ae,me){var En={vx:0,vy:0};return _e.forEach(function(Zn,Kt){if(me!==Kt){var ge=ae.x-Zn.x||.001,Ae=ae.y-Zn.y||.001,sn=Math.sqrt(ge*ge+Ae*Ae)+vi,xn=sn*ve,ir=Bt/(xn*xn)||0;En.vx+=(ge/sn||0)*ir,En.vy+=(Ae/sn||0)*ir}}),En})}function Mi(_e,ve,Bt){var ae=Bt/(ve*ve),me=_e.map(function(Zn,Kt){return Object.assign(Object.assign({index:Kt},Zn),{vx:0,vy:0,weight:ae})}),En=ea(me,function(Zn){return Zn.x},function(Zn){return Zn.y}).visitAfter(Pa);return me.forEach(function(Zn){un(Zn,En)}),me.map(function(Zn){return{vx:Zn.vx,vy:Zn.vy}})}function Pa(_e){var ve=0,Bt=0,ae=0;if(_e.length){for(var me=0;me<4;me++){var En=_e[me];En&&En.weight&&(ve+=En.weight,Bt+=En.x*En.weight,ae+=En.y*En.weight)}_e.x=Bt/ve,_e.y=ae/ve,_e.weight=ve}else{var Zn=_e;_e.x=Zn.data.x,_e.y=Zn.data.y,_e.weight=Zn.data.weight}}function un(_e,ve){var Bt=function(me,En,Zn,Kt,ge){var Ae=_e.x-me.x||.001,sn=_e.y-me.y||.001,xn=Kt-En,ir=Ae*Ae+sn*sn+vi,$r=Math.sqrt(ir)+vi;if(xn*xn/Ni<ir)return _e.vx+=Ae/$r*me.weight/ir,_e.vy+=sn/$r*me.weight/ir,!0;if(me.length)return!1;me.data!==_e&&(_e.vx+=Ae/$r*me.data.weight/ir,_e.vy+=sn/$r*me.data.weight/ir)};ve.visit(Bt)}function Oe(_e,ve){for(var Bt=0;Bt<ve.length;Bt++){var ae=ve[Bt];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(_e,ae.key,ae)}}function hn(_e,ve,Bt){return ve&&Oe(_e.prototype,ve),Bt&&Oe(_e,Bt),Object.defineProperty(_e,"prototype",{writable:!1}),_e}function Hn(_e,ve){if(!(_e instanceof ve))throw new TypeError("Cannot call a class as a function")}var Bn=hn(function _e(ve,Bt){var ae=this;Hn(this,_e),this.getvec=function(){return ae},this.add=function(me){return new _e(ae.x+me.x,ae.y+me.y)},this.subtract=function(me){return new _e(ae.x-me.x,ae.y-me.y)},this.magnitude=function(){return Math.sqrt(ae.x*ae.x+ae.y*ae.y)},this.normalise=function(){return ae.divide(ae.magnitude())},this.divide=function(me){return new _e(ae.x/me||0,ae.y/me||0)},this.scalarMultip=function(me){return new _e(ae.x*me,ae.y*me)},this.x=ve,this.y=Bt}),Jn=Bn;function Lr(_e,ve){for(var Bt=0;Bt<ve.length;Bt++){var ae=ve[Bt];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(_e,ae.key,ae)}}function ya(_e,ve,Bt){return ve&&Lr(_e.prototype,ve),Bt&&Lr(_e,Bt),Object.defineProperty(_e,"prototype",{writable:!1}),_e}function Fa(_e,ve){if(!(_e instanceof ve))throw new TypeError("Cannot call a class as a function")}var ui=ya(function _e(ve,Bt,ae){var me=this,En=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;Fa(this,_e),this.updateAcc=function(Zn){me.a=me.a.add(Zn.divide(me.m))},this.p=ve,this.m=En,this.v=new Jn(0,0),this.a=new Jn(0,0),this.id=Bt,this.data=ae}),Ei=ui;function oo(_e,ve){for(var Bt=0;Bt<ve.length;Bt++){var ae=ve[Bt];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(_e,ae.key,ae)}}function po(_e,ve,Bt){return ve&&oo(_e.prototype,ve),Bt&&oo(_e,Bt),Object.defineProperty(_e,"prototype",{writable:!1}),_e}function bo(_e,ve){if(!(_e instanceof ve))throw new TypeError("Cannot call a class as a function")}var ts=po(function _e(ve,Bt,ae){bo(this,_e),this.source=ve,this.target=Bt,this.length=ae}),Wo=ts;function Yi(_e,ve){for(var Bt=0;Bt<ve.length;Bt++){var ae=ve[Bt];ae.enumerable=ae.enumerable||!1,ae.configurable=!0,"value"in ae&&(ae.writable=!0),Object.defineProperty(_e,ae.key,ae)}}function wi(_e,ve,Bt){return ve&&Yi(_e.prototype,ve),Bt&&Yi(_e,Bt),Object.defineProperty(_e,"prototype",{writable:!1}),_e}function gi(_e,ve){if(!(_e instanceof ve))throw new TypeError("Cannot call a class as a function")}var us=wi(function _e(ve){var Bt=this;gi(this,_e),this.updateOptions=function(ae){!ae||Object.keys(ae).forEach(function(me){Bt.props[me]=ae[me]})},this.setData=function(ae){Bt.nodes=[],Bt.edges=[],Bt.nodeSet={},Bt.edgeSet={},Bt.nodePoints=new Map,Bt.edgeSprings=new Map,Bt.sourceData=ae,Bt.judgingDistance=0,("nodes"in ae||"edges"in ae)&&(Bt.addNodes(ae.nodes),Bt.addEdges(ae.edges))},this.getMass=function(ae){var me,En=ae.layout||{},Zn=En.degree,Kt=Zn===void 0?(me=ra.getDegree(ae,Bt.edges))===null||me===void 0?void 0:me.degree:Zn,ge=En.force;return ge&&ge.mass?ge.mass:Kt<5?1:Kt*5},this.init=function(){var ae=Bt.props,me=ae.width,En=ae.height,Zn=Bt.props.centripetalOptions,Kt=Bt.props,ge=Kt.leafCluster,Ae=Kt.clustering,sn=Kt.nodeClusterBy,xn=Kt.clusterNodeStrength,ir=function(Si){return typeof xn=="function"?xn(Si):xn},$r;if(Bt.nodes.forEach(function(Di){var Si=Di.data.x||me/2,_o=Di.data.y||En/2,To=new Jn(Si,_o);Di.data.layout||(Di.data.layout={});var wo=ra.getDegree(Di,Bt.edges);Di.data.layout=Object.assign(Object.assign({},Di.data.layout),wo);var Vo=Bt.getMass(Di.data);Bt.nodePoints.set(Di.id,new Ei(To,String(Di.id),Di.data,Vo))}),Bt.edges.forEach(function(Di){var Si=Bt.nodePoints.get(Di.source.id),_o=Bt.nodePoints.get(Di.target.id),To=Bt.props.defSpringLen(Di,Si,_o);Bt.edgeSprings.set(Di.id,new Wo(Si,_o,To))}),ge){$r=Bt.getSameTypeLeafMap();var Aa=ra.getRelativeNodesType(Bt.nodes,sn);Zn={single:100,leaf:function(Si,_o,To){var wo=$r[Si.id]||{},Vo=wo.relativeLeafNodes,js=wo.sameTypeLeafNodes;return(js==null?void 0:js.length)===(Vo==null?void 0:Vo.length)||(Aa==null?void 0:Aa.length)===1?1:ir(Si)},others:1,center:function(Si,_o,To){var wo,Vo=((wo=Si.data)===null||wo===void 0?void 0:wo.layout)||{},js=Vo.degree;if(!js)return{x:100,y:100};var ws;if(js===1){var ks=$r[Si.id]||{},Hs=ks.sameTypeLeafNodes,Mu=Hs===void 0?[]:Hs;Mu.length===1?ws=void 0:Mu.length>1&&(ws=ra.getAvgNodePosition(Mu))}else ws=void 0;return{x:ws==null?void 0:ws.x,y:ws==null?void 0:ws.y}}}}if(Ae){$r||($r=Bt.getSameTypeLeafMap());var Va=Array.from(new Set(Bt.nodes.map(function(Di){var Si;return(Si=Di.data)===null||Si===void 0?void 0:Si[sn]}))).filter(function(Di){return Di!==void 0}),Ba={};Va.forEach(function(Di){var Si=Bt.nodes.filter(function(_o){var To;return((To=_o.data)===null||To===void 0?void 0:To[sn])===Di});Ba[Di]=ra.getAvgNodePosition(Si)}),Zn={single:function(Si){return ir(Si)},leaf:function(Si){return ir(Si)},others:function(Si){return ir(Si)},center:function(Si,_o,To){var wo,Vo=Ba[(wo=Si.data)===null||wo===void 0?void 0:wo[sn]];return{x:Vo==null?void 0:Vo.x,y:Vo==null?void 0:Vo.y}}}}Bt.centripetalOptions=Object.assign(Object.assign({},Bt.centripetalOptions),Zn);var oi=Bt.nodePoints.size,ro=Math.pow(10,2);Bt.props.minEnergyThreshold=1/2*Math.pow(1,2)*1*oi*ro},this.start=function(){Bt.init(),Bt.props.animation?Bt.animation():Bt.slienceForce()},this.calTotalEnergy=function(){var ae=0;return Bt.nodes.forEach(function(me){var En=Bt.nodePoints.get(me.id),Zn=En.v.magnitude(),Kt=En.m;ae+=Kt*Math.pow(Zn,2)*.5}),ae},this.slienceForce=function(){for(var ae=Bt.props,me=ae.done,En=ae.maxIterations,Zn=ae.minDistanceThreshold,Kt=0;(Bt.judgingDistance>Zn||Kt<1)&&Kt<En;Kt++)Bt.tick(Bt.props.tickInterval),Bt.iterations++;Bt.render(),me&&me(Bt.renderNodes)},this.requestAnimationFrame=function(ae){var me=Bt.props.enableWorker;return me?setInterval(function(){ae()},16):window.requestAnimationFrame(ae)},this.cancelAnimationFrame=function(ae){var me=Bt.props.enableWorker;me?clearInterval(ae):window.cancelAnimationFrame(ae)},this.animation=function(){var ae=Bt.props,me=ae.enableWorker,En=ae.maxIterations,Zn=ae.minDistanceThreshold,Kt=ae.done,ge=ae.tickInterval;if(me){for(var Ae=new Date().valueOf(),sn=.22,xn=function(Di){return Di>10?2e3:20*Di*Di},ir=0;ir<En;ir++){var $r=Math.max(.02,sn-ir*.002);Bt.tick($r);var Aa=new Date().valueOf()-Ae;Aa>=xn(ir)&&(Bt.render(),Ae=new Date().valueOf());var Va=Bt.calTotalEnergy(),Ba=Bt.registers.get("monitor");if(Ba&&Ba(Bt.reportMointor(Va)),Bt.judgingDistance<Zn){Bt.render(),Kt&&Kt(Bt.renderNodes);return}}return}var oi=function ro(){Bt.tick(ge),Bt.render(),Bt.iterations++;var Di=Bt.calTotalEnergy(),Si=Bt.registers.get("monitor");Si&&Si(Bt.reportMointor(Di)),Bt.judgingDistance<Zn||Bt.iterations>Bt.props.maxIterations?(Bt.cancelAnimationFrame(Bt.timer),Bt.iterations=0,Bt.done=!0,Kt&&Kt(Bt.renderNodes)):Bt.timer=Bt.requestAnimationFrame(ro)};Bt.timer=Bt.requestAnimationFrame(oi)},this.render=function(){var ae=Bt.registers.get("render");Bt.renderNodes=[],Bt.nodePoints.forEach(function(me){Bt.renderNodes.push(Object.assign(Object.assign({},Bt.nodeSet[me.id]&&Bt.nodeSet[me.id].data),{x:me.p.x,y:me.p.y}))}),ae?ae({nodes:Bt.renderNodes,edges:Bt.sourceData.edges}):console.error("need a render function")},this.reportMointor=function(ae){var me={energy:ae,iterations:Bt.iterations,nodes:Bt.nodes,edges:Bt.edges};return me},this.tick=function(ae){Bt.updateCoulombsLawOptimized(),Bt.updateHookesLaw(),Bt.attractToCentre(),Bt.attractToSide(),Bt.updateVelocity(ae),Bt.updatePosition(ae)},this.updateCoulombsLawOptimized=function(){var ae=Bt.props.coulombDisScale,me=Bt.props.repulsion,En=Bt.nodes.map(function(Kt){var ge=Bt.nodePoints.get(Kt.id).p;return{x:ge.x,y:ge.y}}),Zn=Mi(En,ae,me);Bt.nodes.forEach(function(Kt,ge){Bt.nodePoints.get(Kt.id).updateAcc(new Jn(Zn[ge].vx,Zn[ge].vy))})},this.updateCoulombsLaw=function(){for(var ae=Bt.nodes.length,me=0;me<ae;me++)for(var En=me+1;En<ae;En++)if(me!==En){var Zn=Bt.nodes[me],Kt=Bt.nodes[En],ge=Bt.props.coulombDisScale,Ae=Bt.props.repulsion,sn=Bt.nodePoints.get(Zn.id).p.subtract(Bt.nodePoints.get(Kt.id).p),xn=(sn.magnitude()+.1)*ge,ir=sn.normalise(),$r=1;Bt.nodePoints.get(Zn.id).updateAcc(ir.scalarMultip(Ae*$r).divide(Math.pow(xn,2))),Bt.nodePoints.get(Kt.id).updateAcc(ir.scalarMultip(Ae*$r).divide(-Math.pow(xn,2)))}},this.updateHookesLaw=function(){Bt.edges.forEach(function(ae){var me=Bt.edgeSprings.get(ae.id),En=me.target.p.subtract(me.source.p),Zn=me.length-En.magnitude(),Kt=En.normalise();me.source.updateAcc(Kt.scalarMultip(-Bt.props.stiffness*Zn)),me.target.updateAcc(Kt.scalarMultip(Bt.props.stiffness*Zn))})},this.implementForce=function(ae,me){var En=arguments.length>2&&arguments[2]!==void 0?arguments[2]:2,Zn=Bt.nodePoints.get(ae.id),Kt=Zn.p.subtract(me);Zn.updateAcc(Kt.scalarMultip(-En))},this.attractToCentre=function(){Bt.nodes.forEach(function(ae){var me,En=(me=ae.data)===null||me===void 0?void 0:me.layout,Zn=En.degree,Kt=En.sDegree,ge=En.tDegree,Ae=Bt.centripetalOptions,sn=Ae.leaf,xn=Ae.single,ir=Ae.others,$r=Ae.center,Aa=Bt.props,Va=Aa.width,Ba=Aa.height;if($r!==void 0){var oi=$r(ae,Bt.nodes,Bt.edges,Va,Ba),ro=oi.x,Di=oi.y,Si=oi.centerStrength;if(!(ro===void 0||Di===void 0)){var _o=new Jn(ro,Di);if(Si){Bt.implementForce(ae,_o,Si);return}var To=typeof sn=="function"?sn(ae,Bt.nodes,Bt.edges):sn,wo=typeof xn=="function"?xn(ae):xn,Vo=typeof ir=="function"?ir(ae):ir,js=ge===0||Kt===0,ws=Zn===0;if(!(To===0||wo===0||Vo===0)){if(ws){Bt.implementForce(ae,_o,wo);return}if(js){Bt.implementForce(ae,_o,To);return}Bt.implementForce(ae,_o,Vo)}}}})},this.attractToSide=function(){if(!(!Bt.props.defSideCoe||typeof Bt.props.defSideCoe!="function")){var ae=Bt.props.height;Bt.nodes.forEach(function(me){var En=Bt.props.defSideCoe(me);if(En!==0){var Zn=Bt.nodePoints.get(me.id),Kt=Zn.p.x,ge=En>0?0:ae,Ae=new Jn(Kt,ge);Bt.implementForce(me,Ae,Math.abs(En))}})}},this.updateVelocity=function(ae){Bt.nodes.forEach(function(me){var En=Bt.nodePoints.get(me.id);En.v=En.v.add(En.a.scalarMultip(ae)).scalarMultip(Bt.props.damping),En.v.magnitude()>Bt.props.maxSpeed&&(En.v=En.v.normalise().scalarMultip(Bt.props.maxSpeed)),En.a=new Jn(0,0)})},this.updatePosition=function(ae){var me;if(!((me=Bt.nodes)===null||me===void 0?void 0:me.length)){Bt.judgingDistance=0;return}var En=Bt.props.distanceThresholdMode,Zn=0;En==="max"?Bt.judgingDistance=-Infinity:En==="min"&&(Bt.judgingDistance=Infinity),Bt.nodes.forEach(function(Kt){var ge=Bt.nodePoints.get(Kt.id);ge.p=ge.p.add(ge.v.scalarMultip(ae));var Ae=ge.v.scalarMultip(ae),sn=Ae.magnitude();switch(En){case"max":Bt.judgingDistance<sn&&(Bt.judgingDistance=sn);break;case"min":Bt.judgingDistance>sn&&(Bt.judgingDistance=sn);break;default:Zn=Zn+sn;break}}),(!En||En==="mean")&&(Bt.judgingDistance=Zn/Bt.nodes.length)},this.addNode=function(ae){var me=Bt.props.ignore;me&&me(ae)||(ae.id in Bt.nodeSet||Bt.nodes.push(ae),Bt.nodeSet[ae.id]=ae)},this.addNodes=function(ae){ae.forEach(function(me){Bt.addNode(new an(me))})},this.addEdge=function(ae){return ae.id in Bt.edgeSet||Bt.edges.push(ae),Bt.edgeSet[ae.id]=ae,ae},this.addEdges=function(ae){try{for(var me=ae.length,En=0;En<me;En++){var Zn=ae[En],Kt=Zn.source,ge=Zn.target,Ae=Bt.nodeSet[Kt];if(Ae===void 0)throw new TypeError("invalid node name: ".concat(Zn.source));var sn=Bt.nodeSet[ge];if(sn===void 0)throw new TypeError("invalid node name: ".concat(Zn.target));var xn=Zn.data,ir=new Lt(String(Bt.nextEdgeId++),Ae,sn,xn);Bt.addEdge(ir)}}catch($r){console.error($r)}},this.register=function(ae,me){Bt.registers.set(ae,me)},this.restart=function(ae,me){var En=Bt.props.ignore;me.getNodes().forEach(function(Kt){var ge=Kt.get("model");if(!(En&&En(ge))){var Ae=new Jn(ge.x,ge.y),sn=Bt.nodePoints.get(ge.id);sn&&(sn.p=Ae,Bt.nodePoints.set(ge.id,sn))}});var Zn=function(ge){var Ae=new Jn(ge.x,ge.y),sn=Bt.getMass(ge);Bt.nodePoints.set(ge.id,new Ei(Ae,ge.id,ge.data,sn)),Bt.edges.forEach(function(xn){var ir=Bt.nodePoints.get(xn.source.id),$r=Bt.nodePoints.get(xn.target.id);if(ir.id===ge.id||$r.id===ge.id){var Aa=Bt.edgeSprings.get(xn.id).length||100;Bt.edgeSprings.set(xn.id,new Wo(ir,$r,Aa))}})};ae.forEach(Zn),Bt.props.restartAnimation?Bt.animation():Bt.slienceForce()},this.stop=function(){window.cancelAnimationFrame(Bt.timer),Bt.done=!0},this.getSameTypeLeafMap=function(){var ae=Bt.props.nodeClusterBy,me={};return Bt.nodes.forEach(function(En){var Zn,Kt=((Zn=En.data)===null||Zn===void 0?void 0:Zn.layout)||{},ge=Kt.degree;ge===1&&(me[En.id]=ra.getCoreNodeAndRelativeLeafNodes("leaf",En,Bt.edges,ae))}),me},this.props={stiffness:200,enableWorker:!1,defSpringLen:function(me){return me.data.spring||200},repulsion:200*5,centripetalOptions:{leaf:2,single:2},leafCluster:!1,clustering:!1,nodeClusterBy:"cluster",clusterNodeStrength:20,damping:.9,minEnergyThreshold:.1,maxSpeed:1e3,coulombDisScale:.005,tickInterval:.02,groupFactor:4,maxIterations:7440,minDistanceThreshold:.4,distanceThresholdMode:"mean",animation:!0,restartAnimation:!0,width:200,height:200},this.updateOptions(ve),this.sourceData={nodes:[],edges:[],combos:[]},this.nodes=[],this.edges=[],this.nodeSet={},this.edgeSet={},this.renderNodes=[],this.nodePoints=new Map,this.edgeSprings=new Map,this.registers=new Map,this.done=!1,this.judgingDistance=0,this.iterations=0,this.nextEdgeId=0,this.timer=0,this.center=new Jn(0,0),this.centripetalOptions={leaf:2,single:2,others:1,center:function(me){return{x:Bt.props.width/2,y:Bt.props.height/2}}},this.dragNodes=[]}),Do=us,Io=Do,zs=function(_e,ve){var Bt={};for(var ae in _e)Object.prototype.hasOwnProperty.call(_e,ae)&&ve.indexOf(ae)<0&&(Bt[ae]=_e[ae]);if(_e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var me=0,ae=Object.getOwnPropertySymbols(_e);me<ae.length;me++)ve.indexOf(ae[me])<0&&Object.prototype.propertyIsEnumerable.call(_e,ae[me])&&(Bt[ae[me]]=_e[ae[me]]);return Bt},mu=function(){j.ZP.registerLayout("graphin-force",{getDefaultCfg:function(){return{preset:{name:"grid",options:{}},stiffness:200,repulsion:200*5,centripetalOptions:{leaf:1.6,single:1.6},damping:.9,minEnergyThreshold:.1,maxSpeed:1e3,MaxIterations:1e4,animation:!0}},init:function(ve){this.nodes=ve.nodes,this.edges=ve.edges;var Bt=this,ae=Bt.graph,me=zs(Bt,["graph"]),En=Object.assign(Object.assign({},this.getDefaultCfg()),me),Zn=En.width,Kt=En.height,ge=En.animation,Ae=En.done,sn=Ae===void 0?function(){}:Ae,xn=zs(En,["width","height","animation","done"]);this.simulation=new Io(Object.assign(Object.assign(Object.assign({width:Zn,height:Kt,animation:ge},xn),me),{done:function($r){sn(ae,$r)}})),this.simulation.setData(ve),this.simulation.register("render",function(ir){if(!ge&&ve&&ve.nodes&&ve.nodes.length>0){var $r=ir.nodes;return ve.nodes.forEach(function(Va,Ba){var oi=$r[Ba];if(oi&&oi.id===Va.id)Va.x=$r[Ba].x,Va.y=$r[Ba].y;else{var ro=$r.find(function(Di){return Di.id===Va.id});ro&&(Va.x=ro.x,Va.y=ro.y)}}),Object.assign({},ir)}try{if(!ae||ae.destroyed)return;var Aa=!1;ir.nodes.forEach(function(Va){var Ba=ae.findById(Va.id);if(Ba){var oi=Ba.get("model");oi.x=Va.x,oi.y=Va.y,Ba.getType()==="combo"&&(Aa=!0)}}),ae.refreshPositions(Aa)}catch(Va){console.error(Va)}})},execute:function(){this.simulation.start()},layout:function(ve){this.init(ve),this.execute()},updateCfg:function(ve){this.cfg=Object.assign(Object.assign({},this.cfg),ve)},destroy:function(){this.destroyed=!0,this.simulation.stop(),this.simulation=null},getType:function(){return"graphin-force"}})},ds=function(){j.ZP.registerLayout("preset",{init:function(){},execute:function(){},destroy:function(){this.destroyed=!0}})},Ms=$(23044);function yu(_e,ve){return ls(_e)||Wi(_e,ve)||Cs(_e,ve)||uu()}function uu(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cs(_e,ve){if(!!_e){if(typeof _e=="string")return qo(_e,ve);var Bt=Object.prototype.toString.call(_e).slice(8,-1);if(Bt==="Object"&&_e.constructor&&(Bt=_e.constructor.name),Bt==="Map"||Bt==="Set")return Array.from(_e);if(Bt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Bt))return qo(_e,ve)}}function qo(_e,ve){(ve==null||ve>_e.length)&&(ve=_e.length);for(var Bt=0,ae=new Array(ve);Bt<ve;Bt++)ae[Bt]=_e[Bt];return ae}function Wi(_e,ve){var Bt=_e==null?null:typeof Symbol!="undefined"&&_e[Symbol.iterator]||_e["@@iterator"];if(Bt!=null){var ae=[],me=!0,En=!1,Zn,Kt;try{for(Bt=Bt.call(_e);!(me=(Zn=Bt.next()).done)&&(ae.push(Zn.value),!(ve&&ae.length===ve));me=!0);}catch(ge){En=!0,Kt=ge}finally{try{!me&&Bt.return!=null&&Bt.return()}finally{if(En)throw Kt}}return ae}}function ls(_e){if(Array.isArray(_e))return _e}var is=function(_e,ve){var Bt={};for(var ae in _e)Object.prototype.hasOwnProperty.call(_e,ae)&&ve.indexOf(ae)<0&&(Bt[ae]=_e[ae]);if(_e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var me=0,ae=Object.getOwnPropertySymbols(_e);me<ae.length;me++)ve.indexOf(ae[me])<0&&Object.prototype.propertyIsEnumerable.call(_e,ae[me])&&(Bt[ae[me]]=_e[ae[me]]);return Bt},Es=function(ve,Bt,ae){if(!!Bt)try{ve.forEach(function(me){var En=me.cfg.name,Zn=Bt[En];if(Zn){var Kt=ae(Bt,En),ge=Kt.animate,Ae=Kt.visible,sn=is(Kt,["animate","visible"]);if(me.attrs.img)sn.opacity!==void 0&&me.attr({opacity:sn.opacity});else if(me.attr(sn),me.cfg.visible=Ae!==!1,ge){var xn=ge.attrs,ir=is(ge,["attrs"]);me.animate(xn,ir)}}})}catch(me){console.error(me)}};function tl(_e){return Object.keys(_e).forEach(function(ve){_e[ve]===void 0&&delete _e[ve]}),_e}var bu=function(ve){if(!ve)return[0,0];var Bt=0,ae=0;if((0,Ms.isNumber)(ve))Bt=ve,ae=ve;else if((0,Ms.isArray)(ve)){if(ve.length===1){var me=yu(ve,1),En=me[0];Bt=En,ae=En}else if(ve.length===2){var Zn=yu(ve,2),Kt=Zn[0],ge=Zn[1];Bt=Kt,ae=ge}}return[Bt,ae]},Ys=function(ve){var Bt=ve.label,ae=ve.keyshape;if(!(ae==null?void 0:ae.size)&&!(Bt==null?void 0:Bt.offset))return{x:void 0,y:void 0,textBaseline:Bt==null?void 0:Bt.textBaseline};!(ae==null?void 0:ae.size)&&(Bt==null?void 0:Bt.offset)&&(ae.size=26,console.info("you should set keyshape.size when you update label position,the default keyshape size value is  26"));var me=ae.size,En=[0,0],Zn=Bt.position,Kt=Bt.offset,ge=Kt===void 0?En:Kt;(typeof ge=="number"||typeof ge=="string")&&(En=[Number(ge),Number(ge)]),ge.length>0&&(En=ge);var Ae=En,sn=yu(Ae,2),xn=sn[0],ir=sn[1];if(Zn==="center")return{x:0+xn,y:0+ir};var $r=bu(me),Aa=$r[0],Va=$r[1],Ba;switch(Zn){case"top":Ba={x:0+xn,y:-Va/2-ir,textBaseline:"bottom"};break;case"bottom":Ba={x:0+xn,y:Va/2+ir,textBaseline:"top"};break;case"left":Ba={x:0-Aa-xn,y:0+ir,textAlign:"right"};break;case"right":Ba={x:0+Aa+xn,y:0+ir,textAlign:"left"};break;default:Ba={x:0+xn,y:Va/2+ir,textBaseline:"top"};break}return Ba},ka=function(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"RT",Bt=arguments.length>1?arguments[1]:void 0,ae=0,me=0;return ve==="LT"?(ae=Bt*Math.cos(Math.PI*3/4),me=-Bt*Math.sin(Math.PI*3/4)):ve==="LB"?(ae=Bt*Math.cos(Math.PI*5/4),me=-Bt*Math.sin(Math.PI*5/4)):ve==="RT"?(ae=Bt*Math.cos(Math.PI*1/4),me=-Bt*Math.sin(Math.PI*1/4)):ve==="RB"&&(ae=Bt*Math.cos(Math.PI*7/4),me=-Bt*Math.sin(Math.PI*7/4)),{x:ae,y:me}};function Ku(_e){return Ns(_e)||Ro(_e)||Zu(_e)||Vs()}function Vs(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ro(_e){if(typeof Symbol!="undefined"&&_e[Symbol.iterator]!=null||_e["@@iterator"]!=null)return Array.from(_e)}function Ns(_e){if(Array.isArray(_e))return bn(_e)}function tu(_e,ve){return pa(_e)||Xr(_e,ve)||Zu(_e,ve)||eu()}function eu(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zu(_e,ve){if(!!_e){if(typeof _e=="string")return bn(_e,ve);var Bt=Object.prototype.toString.call(_e).slice(8,-1);if(Bt==="Object"&&_e.constructor&&(Bt=_e.constructor.name),Bt==="Map"||Bt==="Set")return Array.from(_e);if(Bt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Bt))return bn(_e,ve)}}function bn(_e,ve){(ve==null||ve>_e.length)&&(ve=_e.length);for(var Bt=0,ae=new Array(ve);Bt<ve;Bt++)ae[Bt]=_e[Bt];return ae}function Xr(_e,ve){var Bt=_e==null?null:typeof Symbol!="undefined"&&_e[Symbol.iterator]||_e["@@iterator"];if(Bt!=null){var ae=[],me=!0,En=!1,Zn,Kt;try{for(Bt=Bt.call(_e);!(me=(Zn=Bt.next()).done)&&(ae.push(Zn.value),!(ve&&ae.length===ve));me=!0);}catch(ge){En=!0,Kt=ge}finally{try{!me&&Bt.return!=null&&Bt.return()}finally{if(En)throw Kt}}return ae}}function pa(_e){if(Array.isArray(_e))return _e}var Ra=function(_e,ve){var Bt={};for(var ae in _e)Object.prototype.hasOwnProperty.call(_e,ae)&&ve.indexOf(ae)<0&&(Bt[ae]=_e[ae]);if(_e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var me=0,ae=Object.getOwnPropertySymbols(_e);me<ae.length;me++)ve.indexOf(ae[me])<0&&Object.prototype.propertyIsEnumerable.call(_e,ae[me])&&(Bt[ae[me]]=_e[ae[me]]);return Bt};function Qi(_e){var ve;return(0,Ms.isNumber)(_e)?ve=_e/2:(0,Ms.isArray)(_e)&&(ve=_e[0]/2),ve}var Co=function(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Bt=Ee(ve),ae=Bt.defaultNodeStyle,me=Bt.defaultNodeStatusStyle;return{style:ae.style,status:me.status}},to=function(ve){var Bt=ve.halo,ae=ve.keyshape,me=Bt.size,En=Bt.visible,Zn=Bt.fill,Kt=Bt.fillOpacity,ge=Ra(Bt,["size","visible","fill","fillOpacity"]),Ae=Qi(me),sn,xn,ir;if(ae&&ae.size){var $r=Qi(ae.size);sn=$r+15}ae&&ae.fill&&(xn=ae.fill),ae&&ae.stroke&&(ir=ae.stroke);var Aa=Object.assign({x:0,y:0,r:Ae||sn,fill:Zn||xn||ir,fillOpacity:Kt||.1,visible:En!==!1},ge);return{name:"halo",visible:En!==!1,attrs:tl(Aa)}},xo=function(ve){var Bt=ve.keyshape,ae=Bt.size,me=Bt.visible,En=Bt.stroke,Zn=Bt.fill,Kt=Bt.fillOpacity,ge=Bt.strokeOpacity,Ae=Ra(Bt,["size","visible","stroke","fill","fillOpacity","strokeOpacity"]),sn=Qi(ae),xn=Object.assign({x:0,y:0,r:sn,cursor:"pointer",visible:me!==!1,stroke:En,strokeOpacity:ge||1,fill:Zn||En,fillOpacity:Kt||.2},Ae);return{name:"keyshape",visible:me!==!1,attrs:tl(xn)}},gs=function(ve){var Bt=ve.label,ae=Bt.value,me=Bt.fill,En=Bt.fontSize,Zn=Bt.visible,Kt=Ra(Bt,["value","fill","fontSize","visible"]),ge=Ys(ve),Ae=Object.assign({x:ge.x,y:ge.y,fontSize:En,text:ae,textAlign:"center",fill:me,textBaseline:ge.textBaseline,visible:Zn!==!1},Kt);return{name:"label",visible:Zn!==!1,attrs:tl(Ae)}},vo=function(ve){var Bt=ve.icon,ae=Bt.value,me=ae===void 0?"":ae,En=Bt.type,Zn=Bt.fontFamily,Kt=Bt.textAlign,ge=Kt===void 0?"center":Kt,Ae=Bt.textBaseline,sn=Ae===void 0?"middle":Ae,xn=Bt.fill,ir=Bt.size,$r=Bt.visible,Aa=Bt.clip,Va=Ra(Bt,["value","type","fontFamily","textAlign","textBaseline","fill","size","visible","clip"]),Ba=bu(ir),oi=tu(Ba,2),ro=oi[0],Di=oi[1],Si={name:"icon",visible:$r!==!1,capture:!1};return En==="text"||En==="font"?Object.assign(Object.assign({},Si),{attrs:Object.assign({x:0,y:0,textAlign:ge,textBaseline:sn,text:me,fontSize:ro,fontFamily:Zn,fill:xn,visible:$r!==!1},Va)}):Object.assign(Object.assign({},Si),{attrs:Object.assign({x:-ro/2,y:-Di/2,img:me,width:ro,height:Di,visible:$r!==!1},Va)})},ou=function(ve,Bt){return Bt==="keyshape"?xo(ve).attrs:Bt==="halo"?to(ve).attrs:Bt==="label"?gs(ve).attrs:Bt==="icon"?vo(ve).attrs:ve[Bt]||{}},ms=function(ve,Bt,ae){var me=ve.type,En=ve.position,Zn=ve.value,Kt=Zn===void 0?"":Zn,ge=ve.size,Ae=ve.fill,sn=ve.stroke,xn=ve.color,ir=ve.fontSize,$r=ve.fontFamily,Aa=ve.padding,Va=Aa===void 0?0:Aa,Ba=ve.offset,oi=Ba===void 0?[0,0]:Ba,ro=ve.id,Di=bu(oi),Si=bu(ge),_o=tu(Si,2),To=_o[0],wo=_o[1],Vo=ka(En,ae),js=Vo.x,ws=Vo.y,ks=js,Hs=ws;if(To===wo){ks+=Di[0],Hs+=Di[1];var Mu={attrs:{r:To/2+Va,fill:Ae,stroke:sn,x:ks,y:Hs},name:"badges-circle"};ro&&(Mu.id=ro),Bt.addShape("circle",Mu)}else{ks=js-To-Va*2,Hs=ws-wo-Va*2,En==="LB"?Hs=ws:En==="RT"?(ks=js,Hs=ws-wo-Va*2):En==="RB"&&(ks=js,Hs=ws),ks+=Di[0],Hs+=Di[1];var nl={attrs:{width:To+Va*2,height:wo+Va*2,fill:Ae,stroke:sn,x:ks,y:Hs,radius:(wo+Va*2)/3},name:"badges-rect"};ro&&(nl.id=ro),Bt.addShape("rect",nl)}me==="font"||me==="text"?Bt.addShape("text",{attrs:{x:To!==wo?ks+To/2+Va:ks,y:To!==wo?Hs+wo/2+Va:Hs,text:Kt,fontSize:ir,textAlign:"center",textBaseline:"middle",fontFamily:$r,fill:xn},capture:!1,name:"badges-text"}):me==="image"&&Bt.addShape("image",{attrs:{x:ks-To/2,y:ks-wo/2,width:To,height:wo,img:Kt},capture:!1,name:"badges-image"})},xu=function(){j.ZP.registerNode("graphin-circle",{options:{style:{},status:{}},draw:function(ve,Bt){var ae=ve.style._theme;this.options=Co(ae);var me=(0,Ms.deepMix)({},this.options.style,ve.style);ve._initialStyle=Object.assign({},me);var En=me.icon,Zn=me.badges,Kt=Zn===void 0?[]:Zn,ge=me.keyshape,Ae=Qi(ge.size);Bt.addShape("circle",to(me));var sn=Bt.addShape("circle",xo(me));Bt.addShape("text",gs(me));var xn=En.type;if((xn==="text"||xn==="font")&&Bt.addShape("text",vo(me)),xn==="image"){var ir=vo(me),$r=Bt.addShape("image",ir),Aa=me.icon.clip;if(Aa){var Va=Aa.r,Ba=Ra(Aa,["r"]);$r.setClip({type:"circle",attrs:Object.assign({x:0,y:0,r:Va},Ba)})}}return Kt.forEach(function(oi){ms(oi,Bt,Ae)}),sn},setState:function(ve,Bt,ae){var me;if(!!ve){var En=ae.getModel(),Zn=ae.getContainer().get("children"),Kt=(0,Ms.deepMix)({},this.options.status,En.style.status),ge=ae.getModel()._initialStyle,Ae=((me=ae._cfg)===null||me===void 0?void 0:me.states)||[];try{Object.keys(Kt).forEach(function(sn){ve===sn&&(Bt?Es(Zn,Kt[sn],ou):(Es(Zn,ge,ou),Ae.forEach(function(xn){Es(Zn,Kt[xn],ou)})))})}catch(sn){console.error(sn)}}},update:function(ve,Bt){if(!!ve.style)try{var ae=(0,Ms.deepMix)({},ve._initialStyle,ve.style);ve._initialStyle=Object.assign({},ae);var me=ae.badges,En=ae.keyshape,Zn=Qi(En.size),Kt=Bt.getContainer(),ge=Kt.get("children");Es(ge,ae,ou);var Ae=Ku(ge);if(me){var sn=0;Ae.forEach(function(xn){xn.cfg.name.startsWith("badges")?ge.splice(sn,1):sn=sn+1}),me.forEach(function(xn){ms(xn,Kt,Zn)})}}catch(xn){console.error("error")}}})},dl=$(32096);function kl(_e,ve,Bt){return ve in _e?Object.defineProperty(_e,ve,{value:Bt,enumerable:!0,configurable:!0,writable:!0}):_e[ve]=Bt,_e}function Ks(_e,ve){return ns(_e)||pl(_e,ve)||lu(_e,ve)||el()}function el(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lu(_e,ve){if(!!_e){if(typeof _e=="string")return Du(_e,ve);var Bt=Object.prototype.toString.call(_e).slice(8,-1);if(Bt==="Object"&&_e.constructor&&(Bt=_e.constructor.name),Bt==="Map"||Bt==="Set")return Array.from(_e);if(Bt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Bt))return Du(_e,ve)}}function Du(_e,ve){(ve==null||ve>_e.length)&&(ve=_e.length);for(var Bt=0,ae=new Array(ve);Bt<ve;Bt++)ae[Bt]=_e[Bt];return ae}function pl(_e,ve){var Bt=_e==null?null:typeof Symbol!="undefined"&&_e[Symbol.iterator]||_e["@@iterator"];if(Bt!=null){var ae=[],me=!0,En=!1,Zn,Kt;try{for(Bt=Bt.call(_e);!(me=(Zn=Bt.next()).done)&&(ae.push(Zn.value),!(ve&&ae.length===ve));me=!0);}catch(ge){En=!0,Kt=ge}finally{try{!me&&Bt.return!=null&&Bt.return()}finally{if(En)throw Kt}}return ae}}function ns(_e){if(Array.isArray(_e))return _e}var _s=function(_e,ve){var Bt={};for(var ae in _e)Object.prototype.hasOwnProperty.call(_e,ae)&&ve.indexOf(ae)<0&&(Bt[ae]=_e[ae]);if(_e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var me=0,ae=Object.getOwnPropertySymbols(_e);me<ae.length;me++)ve.indexOf(ae[me])<0&&Object.prototype.propertyIsEnumerable.call(_e,ae[me])&&(Bt[ae[me]]=_e[ae[me]]);return Bt},Bu=function(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Bt=Ee(ve),ae=Bt.defaultEdgeStyle,me=Bt.defaultEdgeStatusStyle;return{style:ae.style,status:me.status}},Au;(function(_e){_e.NORMAL="normal",_e.SELECTED="selected",_e.HOVERED="hovered",_e.DISABLED="disabled"})(Au||(Au={}));function wu(_e){return Object.keys(_e).forEach(function(ve){_e[ve]===void 0&&delete _e[ve]}),_e}function nu(_e){var ve=_e.value,Bt=_s(_e,["value"]),ae=Object.assign({id:"label",text:ve},Bt);return wu(ae)}function Tl(_e){var ve=_s(_e,[]),Bt=Object.assign({id:"keyshape"},ve);return wu(Bt)}function xc(_e){var ve=_s(_e,[]),Bt=Object.assign({id:"halo"},ve);return wu(Bt)}function Sl(_e){return Object.assign({id:"label-background"},_e)}var ol=function(ve,Bt){return Bt==="keyshape"?Tl(ve.keyshape||{}):Bt==="halo"?xc(ve.halo||{}):Bt==="label"?nu(ve.label||{}):Bt==="label-background"?Sl(ve[Bt]||{}):{}},ys=function(ve,Bt,ae){var me={x:(Bt.x+ve.x)/2,y:(Bt.y+ve.y)/2},En=Bt.x-ve.x,Zn=Bt.y-ve.y,Kt=Math.sqrt(Math.pow(En,2)+Math.pow(Zn,2)),ge=me.y-En*ae/Kt||0,Ae=me.x+Zn*ae/Kt||0;return{x:Ae,y:ge}},vl=function(ve,Bt){var ae,me,En,Zn=ve.startPoint,Kt=Zn===void 0?{x:0,y:0}:Zn,ge=ve.endPoint,Ae=ge===void 0?{x:0,y:0}:ge,sn=ve.sourceNode,xn=ve.targetNode,ir=Bt.keyshape,$r=ir.type,Aa=$r===void 0?"line":$r,Va=ir.poly,Ba=Va===void 0?{distance:0}:Va,oi=ir.loop,ro=oi===void 0?{}:oi,Di=sn.get("model"),Si=((ae=xn)===null||ae===void 0?void 0:ae.get("model"))||{id:"temp"};if(Aa==="loop"||Di.id===Si.id){var _o=((En=(me=Di.style)===null||me===void 0?void 0:me.keyshape)===null||En===void 0?void 0:En.size)||26,To=Object.assign({distance:0,dx:8,rx:void 0,ry:void 0},ro),wo=To.distance,Vo=To.dx,js=To.rx,ws=To.ry,ks=_o/2,Hs=Math.sqrt(Math.max(Math.pow(ks,2)-Math.pow(Vo,2),0)),Mu=js||ks*2*.5,nl=ws||ks*2*.6;return[["M",Kt.x-Vo,Kt.y-Hs],["A",Mu+wo,nl+wo,0,1,1,Kt.x+Vo,Kt.y-Hs]]}if(Aa==="poly"){var Cl=ys(Kt,Ae,(Ba==null?void 0:Ba.distance)||0);return[["M",Kt.x,Kt.y],["Q",Cl.x,Cl.y,Ae.x,Ae.y]]}return[["M",Kt.x,Kt.y],["L",Ae.x,Ae.y]]},kc=function(){j.ZP.registerEdge("graphin-line",{draw:function(ve,Bt){var ae,me,En,Zn,Kt,ge,Ae,sn=ve.style._theme;this.options=Bu(sn);var xn=(0,Ms.deepMix)({},this.options.style,ve.style);ve&&(ve._initialStyle=Object.assign({},xn));var ir=ve.startPoint,$r=ir===void 0?{x:0,y:0}:ir,Aa=ve.endPoint,Va=Aa===void 0?{x:0,y:0}:Aa,Ba=ve.sourceNode,oi=ve.targetNode,ro=xn.label,Di=xn.halo,Si=xn.keyshape,_o=Ba.get("model"),To=((ae=oi)===null||ae===void 0?void 0:ae.get("model"))||{id:"temp"},wo=((En=(me=_o.style)===null||me===void 0?void 0:me.keyshape)===null||En===void 0?void 0:En.size)||28,Vo=(Si==null?void 0:Si.type)==="loop"||_o.id===To.id,js=ro.value,ws=(Si==null?void 0:Si.type)==="poly",ks=ys($r,Va,((Zn=Si==null?void 0:Si.poly)===null||Zn===void 0?void 0:Zn.distance)||0),Hs=(Si==null?void 0:Si.lineWidth)||1,Mu=Hs+5,nl=vl(ve,xn);Bt.addShape("path",{attrs:Object.assign({id:"halo",path:nl,lineWidth:Hs+10,stroke:Di.stroke||Si.stroke,strokeOpacity:Di.strokeOpacity||.4},Di),draggable:!0,name:"halo",visible:Di.visible!==!1});var Cl=Bt.addShape("path",{attrs:Object.assign({id:"keyshape",path:nl,endArrow:Vo?void 0:{d:0,path:"M 0,0 L ".concat(Mu,",").concat(Mu/2," L ").concat(Mu,",-").concat(Mu/2," Z"),fill:Si.stroke},startArrow:Vo?{d:0,path:"M 0,0 L ".concat(Mu,",").concat(Mu/2," L ").concat(Mu,",-").concat(Mu/2," Z"),fill:Si.stroke}:void 0},Si),draggable:!0,name:"keyshape"});if(js){var Yl=ro.value,sl=ro.fontSize,rl=sl===void 0?8:sl,_f=ro.offset,Dc=_f===void 0?[0,0]:_f,wc=ro.background,ef=_s(ro,["value","fontSize","offset","background"]),A=Boolean(wc),nt=Ks(Dc,2),Zt=nt[0],de=nt[1],Pe=Math.atan((Va.y-$r.y)/(Va.x-$r.x)),Qe=[($r.x+Va.x)/2,($r.y+Va.y)/2];if(ws&&(Qe=[(ks.x+Qe[0])/2,(ks.y+Qe[1])/2]),Va.x-$r.x==0&&(Pe=Math.PI/2),Vo&&(Pe=2*Math.PI),A){var rn=(0,dl.Z)(Yl),wn=rn*rl*.6,kn=rl*1.8,De={fill:"#fff",width:wn,height:kn,stroke:Si.stroke,lineWidth:1,radius:6},wr=Object.assign(Object.assign({},De),wc),ca=wr.fill,Ar=wr.width,ua=wr.height,$a=wr.stroke,ri=_s(wr,["fill","width","height","stroke"]),ba=-ua/2+de;Vo&&(ba=-(ua/2+de+rl+wo*1+(((Kt=Si==null?void 0:Si.loop)===null||Kt===void 0?void 0:Kt.distance)||0)*2));var ki=Bt.addShape("rect",{attrs:Object.assign({id:"label-background",x:-Ar/2+Zt,y:ba,width:Ar,height:ua,fill:ca,stroke:$a},ri),draggable:!0,name:"label-background"});ki.rotate(Pe),ki.translate(Qe[0],Qe[1])}var Eo=de-rl/2;A&&(Eo=de+rl/2),Vo&&(A?Eo=-(de+rl/2+wo*1+(((ge=Si==null?void 0:Si.loop)===null||ge===void 0?void 0:ge.distance)||0)*2):Eo=-(de+rl+wo*1+(((Ae=Si==null?void 0:Si.loop)===null||Ae===void 0?void 0:Ae.distance)||0)*2));var Lo=Bt.addShape("text",{attrs:Object.assign({id:"label",x:Zt,y:Eo,text:Yl,fontSize:rl},ef),draggable:!0,name:"label"});Lo.rotate(Pe),Lo.translate(Qe[0],Qe[1])}return Cl},setState:function(ve,Bt,ae){var me;if(!!ve){var En=ae.getModel(),Zn=ae.getContainer().get("children"),Kt=(0,Ms.deepMix)({},this.options.status,En.style.status),ge=ae.getModel()._initialStyle,Ae=((me=ae._cfg)===null||me===void 0?void 0:me.states)||[];try{Object.keys(Kt).forEach(function(sn){var xn;ve===sn&&(Bt?Es(Zn,Kt[sn],ol):(Es(Zn,Object.assign(Object.assign({},ge),kl({},"label-background",(xn=ge.label)===null||xn===void 0?void 0:xn.background)),ol),Ae.forEach(function(ir){Es(Zn,Kt[ir],ol)})))})}catch(sn){console.error(sn)}}},afterDraw:function(ve,Bt){var ae=(0,Ms.deepMix)({},this.options.style,ve.style),me=ae.animate,En=ae.keyshape;if(!(!me||!me.type||me.visible===!1)){var Zn=Bt.get("children").find(function(ro){return ro.get("name")==="keyshape"}),Kt=me.color,ge=me.type,Ae=me.repeat,sn=Ae===void 0?!0:Ae,xn=me.duration,ir=xn===void 0?3e3:xn;if(ge==="circle-running"){var $r=Zn.getPoint(0),Aa=Bt.addShape("circle",{attrs:{x:$r.x,y:$r.y,fill:Kt||En.stroke,r:En.lineWidth*1.5+2},name:"circle-shape"});Aa.animate(function(ro){var Di=Zn.getPoint(ro);return{x:Di.x,y:Di.y}},{repeat:sn,duration:ir})}if(ge==="line-dash"){var Va=0,Ba=me.lineDash||En.lineDash||[4,2,1,2];Zn.animate(function(){return Va++,Va>9&&(Va=0),{lineDash:Ba,lineDashOffset:-Va}},{repeat:sn,duration:ir})}if(ge==="line-growth"){var oi=Zn.getTotalLength();Zn.animate(function(ro){var Di=ro*oi;return{lineDash:[Di,oi-Di]}},{repeat:sn,duration:ir})}}}})};mu(),ds(),xu(),kc();var Dl=sa.registerFontFamily,Ol=sa},9419:function(sr,it,$){"use strict";$.d(it,{$:function(){return tt}});function X(W,Q,Z){return Q in W?Object.defineProperty(W,Q,{value:Z,enumerable:!0,configurable:!0,writable:!0}):W[Q]=Z,W}var tt=[{type:"graphin-force",options:{},title:"\u6E10\u8FDB\u529B\u5BFC"},{type:"force",title:"D3\u529B\u5BFC",options:{preventOverlap:!0,linkDistance:250,nodeStrength:30,edgeStrength:.1,collideStrength:.8,nodeSize:30,alpha:.3,alphaDecay:.028,alphaMin:.01,forceSimulation:null,clustering:!1}},{type:"concentric",title:"\u540C\u5FC3\u5706\u5E03\u5C40",options:{minNodeSpacing:60,preventOverlap:!0,nodeSize:60}},{type:"grid",options:{},title:"\u7F51\u683C\u5E03\u5C40"},{type:"radial",options:{},title:"\u8F90\u5C04\u5E03\u5C40"},{type:"dagre",title:"\u5C42\u6B21\u5E03\u5C40",options:{}},{type:"circular",options:{},title:"\u73AF\u5F62\u5E03\u5C40"},{type:"gForce",options:{linkDistance:function(){return 200},preventOverlap:!0},title:"G6\u529B\u5BFC"},{type:"mds",options:{},title:"\u964D\u7EF4\u5E03\u5C40"},{type:"random",options:{},title:"\u968F\u673A\u5E03\u5C40"}],j=tt.map(function(W){var Q=W.type,Z=W.options;return Object.assign({type:Q},Z)}).reduce(function(W,Q){return Object.assign(Object.assign({},W),X({},Q.type,Q))},{});it.Z=j},81710:function(sr,it){"use strict";var $=function(){var tt={type:"circle",style:{labelCfg:{position:"top"}},status:{}};return tt};it.Z=$},46581:function(sr,it){"use strict";var $={primaryEdgeColor:"#ddd",edgeSize:1,mode:"light"},X=function(j){var W=Object.assign(Object.assign({},$),j),Q=W.edgeSize,Z=W.primaryEdgeColor,L=W.mode,P={light:{stroke:Z,label:Z,disabled:"#ddd"},dark:{stroke:Z,label:Z,disabled:"#ddd3"}},C=P[L],M={type:"graphin-line",style:{keyshape:{type:"line",lineWidth:Q,stroke:C.stroke,strokeOpacity:1,lineAppendWidth:9,cursor:"pointer"},halo:{visible:!1,cursor:"pointer",strokeOpacity:.4},label:{value:"",position:"top",fill:C.label,fontSize:12,textAlign:"center"},animate:{}},status:{hover:{halo:{visible:!0}},selected:{halo:{visible:!0},keyshape:{lineWidth:2},label:{visible:!0}},active:{halo:{visible:!0},keyshape:{lineWidth:2},label:{visible:!0}},inactive:{halo:{visible:!1},keyshape:{strokeOpacity:.1},label:{visible:!1}},disabled:{halo:{visible:!1},keyshape:{lineWidth:.5,stroke:C.disabled},label:{visible:!1}}}};return M};it.Z=X},76575:function(sr,it){"use strict";var $={primaryColor:"#FF6A00",nodeSize:26,mode:"light"},X=function(j){var W=Object.assign(Object.assign({},$),j),Q=W.nodeSize,Z=W.primaryColor,L=W.mode,P=12,C={light:{fill:Z,fillOpacity:.1,stroke:Z,strokeOpacity:1,icon:Z,badge:{fill:Z,stroke:Z,font:"#fff"},label:"#000",disabled:"#ddd"},dark:{fill:Z,fillOpacity:.3,stroke:Z,strokeOpacity:1,icon:"#fff",badge:{fill:Z,stroke:Z,font:"#fff"},label:"#fff",disabled:"#ddd3"}},M=C[L],k={type:"graphin-circle",style:{keyshape:{size:Q,fill:M.fill,fillOpacity:M.fillOpacity,stroke:M.stroke,strokeOpacity:M.strokeOpacity,lineWidth:1,opacity:1,type:"circle"},label:{position:"bottom",value:"",fill:M.label,fontSize:P,offset:0,background:void 0,fillOpacity:1},icon:{type:"text",value:"",size:Q/2,fill:M.icon,fillOpacity:1,offset:[0,0]},badges:[],halo:{visible:!1,fillOpacity:.1}},status:{normal:{},selected:{halo:{visible:!0},keyshape:{lineWidth:5}},hover:{halo:{visible:!0}},active:{},inactive:{keyshape:{fillOpacity:.04,strokeOpacity:.04},icon:{fillOpacity:.04},label:{fillOpacity:.04}},disabled:{halo:{visible:!1},keyshape:{fill:M.disabled,stroke:M.disabled},icon:{fill:M.disabled},label:{fill:M.disabled}}}};return k};it.Z=X},32096:function(sr,it){"use strict";var $=function(tt){return Array.from(String(tt)).reduce(function(j,W){return W.charCodeAt(0)>255?j+2:j+1},0)};it.Z=$},57804:function(sr,it,$){"use strict";sr=$.hmd(sr);function X(bn){return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Xr){return typeof Xr}:function(Xr){return Xr&&typeof Symbol=="function"&&Xr.constructor===Symbol&&Xr!==Symbol.prototype?"symbol":typeof Xr},X(bn)}var tt=200,j="__lodash_hash_undefined__",W=9007199254740991,Q="[object Arguments]",Z="[object Array]",L="[object Boolean]",P="[object Date]",C="[object Error]",M="[object Function]",k="[object GeneratorFunction]",B="[object Map]",R="[object Number]",F="[object Object]",K="[object Promise]",O="[object RegExp]",_="[object Set]",ft="[object String]",mt="[object Symbol]",st="[object WeakMap]",ut="[object ArrayBuffer]",dt="[object DataView]",gt="[object Float32Array]",wt="[object Float64Array]",ot="[object Int8Array]",pt="[object Int16Array]",Nt="[object Int32Array]",Gt="[object Uint8Array]",se="[object Uint8ClampedArray]",ie="[object Uint16Array]",Be="[object Uint32Array]",ke=/[\\^$.*+?()[\]{}|]/g,we=/\w*$/,At=/^\[object .+?Constructor\]$/,Yt=/^(?:0|[1-9]\d*)$/,be={};be[Q]=be[Z]=be[ut]=be[dt]=be[L]=be[P]=be[gt]=be[wt]=be[ot]=be[pt]=be[Nt]=be[B]=be[R]=be[F]=be[O]=be[_]=be[ft]=be[mt]=be[Gt]=be[se]=be[ie]=be[Be]=!0,be[C]=be[M]=be[st]=!1;var nn=(typeof $.g=="undefined"?"undefined":X($.g))=="object"&&$.g&&$.g.Object===Object&&$.g,Ee=(typeof self=="undefined"?"undefined":X(self))=="object"&&self&&self.Object===Object&&self,le=nn||Ee||Function("return this")(),Le=(typeof exports=="undefined"?"undefined":X(exports))=="object"&&exports&&!exports.nodeType&&exports,Ze=Le&&X(sr)=="object"&&sr&&!sr.nodeType&&sr,fe=Ze&&Ze.exports===Le;function Re(bn,Xr){return bn.set(Xr[0],Xr[1]),bn}function He(bn,Xr){return bn.add(Xr),bn}function pe(bn,Xr){for(var pa=-1,Ra=bn?bn.length:0;++pa<Ra&&Xr(bn[pa],pa,bn)!==!1;);return bn}function Ge(bn,Xr){for(var pa=-1,Ra=Xr.length,Qi=bn.length;++pa<Ra;)bn[Qi+pa]=Xr[pa];return bn}function te(bn,Xr,pa,Ra){var Qi=-1,Co=bn?bn.length:0;for(Ra&&Co&&(pa=bn[++Qi]);++Qi<Co;)pa=Xr(pa,bn[Qi],Qi,bn);return pa}function Me(bn,Xr){for(var pa=-1,Ra=Array(bn);++pa<bn;)Ra[pa]=Xr(pa);return Ra}function We(bn,Xr){return bn==null?void 0:bn[Xr]}function ee(bn){var Xr=!1;if(bn!=null&&typeof bn.toString!="function")try{Xr=!!(bn+"")}catch(pa){}return Xr}function Pt(bn){var Xr=-1,pa=Array(bn.size);return bn.forEach(function(Ra,Qi){pa[++Xr]=[Qi,Ra]}),pa}function yt(bn,Xr){return function(pa){return bn(Xr(pa))}}function Ne(bn){var Xr=-1,pa=Array(bn.size);return bn.forEach(function(Ra){pa[++Xr]=Ra}),pa}var tn=Array.prototype,fn=Function.prototype,Rt=Object.prototype,Yn=le["__core-js_shared__"],Un=function(){var bn=/[^.]+$/.exec(Yn&&Yn.keys&&Yn.keys.IE_PROTO||"");return bn?"Symbol(src)_1."+bn:""}(),xr=fn.toString,cr=Rt.hasOwnProperty,Ur=Rt.toString,fa=RegExp("^"+xr.call(cr).replace(ke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sa=fe?le.Buffer:void 0,sa=le.Symbol,Da=le.Uint8Array,Rr=yt(Object.getPrototypeOf,Object),Mn=Object.create,ar=Rt.propertyIsEnumerable,Fn=tn.splice,tr=Object.getOwnPropertySymbols,Gn=Sa?Sa.isBuffer:void 0,jr=yt(Object.keys,Object),Hr=Do(le,"DataView"),Ea=Do(le,"Map"),lr=Do(le,"Promise"),Cr=Do(le,"Set"),vr=Do(le,"WeakMap"),Tr=Do(Object,"create"),ta=Wi(Hr),ra=Wi(Ea),Zr=Wi(lr),vt=Wi(Cr),_n=Wi(vr),an=sa?sa.prototype:void 0,Lt=an?an.valueOf:void 0;function kt(bn){var Xr=-1,pa=bn?bn.length:0;for(this.clear();++Xr<pa;){var Ra=bn[Xr];this.set(Ra[0],Ra[1])}}function at(){this.__data__=Tr?Tr(null):{}}function H(bn){return this.has(bn)&&delete this.__data__[bn]}function Y(bn){var Xr=this.__data__;if(Tr){var pa=Xr[bn];return pa===j?void 0:pa}return cr.call(Xr,bn)?Xr[bn]:void 0}function bt(bn){var Xr=this.__data__;return Tr?Xr[bn]!==void 0:cr.call(Xr,bn)}function $t(bn,Xr){var pa=this.__data__;return pa[bn]=Tr&&Xr===void 0?j:Xr,this}kt.prototype.clear=at,kt.prototype.delete=H,kt.prototype.get=Y,kt.prototype.has=bt,kt.prototype.set=$t;function jt(bn){var Xr=-1,pa=bn?bn.length:0;for(this.clear();++Xr<pa;){var Ra=bn[Xr];this.set(Ra[0],Ra[1])}}function Ht(){this.__data__=[]}function re(bn){var Xr=this.__data__,pa=Pa(Xr,bn);if(pa<0)return!1;var Ra=Xr.length-1;return pa==Ra?Xr.pop():Fn.call(Xr,pa,1),!0}function on(bn){var Xr=this.__data__,pa=Pa(Xr,bn);return pa<0?void 0:Xr[pa][1]}function Je(bn){return Pa(this.__data__,bn)>-1}function Ve(bn,Xr){var pa=this.__data__,Ra=Pa(pa,bn);return Ra<0?pa.push([bn,Xr]):pa[Ra][1]=Xr,this}jt.prototype.clear=Ht,jt.prototype.delete=re,jt.prototype.get=on,jt.prototype.has=Je,jt.prototype.set=Ve;function qn(bn){var Xr=-1,pa=bn?bn.length:0;for(this.clear();++Xr<pa;){var Ra=bn[Xr];this.set(Ra[0],Ra[1])}}function Ln(){this.__data__={hash:new kt,map:new(Ea||jt),string:new kt}}function qr(bn){return us(this,bn).delete(bn)}function Ca(bn){return us(this,bn).get(bn)}function Qn(bn){return us(this,bn).has(bn)}function _r(bn,Xr){return us(this,bn).set(bn,Xr),this}qn.prototype.clear=Ln,qn.prototype.delete=qr,qn.prototype.get=Ca,qn.prototype.has=Qn,qn.prototype.set=_r;function ea(bn){this.__data__=new jt(bn)}function La(){this.__data__=new jt}function ha(bn){return this.__data__.delete(bn)}function _i(bn){return this.__data__.get(bn)}function Ni(bn){return this.__data__.has(bn)}function vi(bn,Xr){var pa=this.__data__;if(pa instanceof jt){var Ra=pa.__data__;if(!Ea||Ra.length<tt-1)return Ra.push([bn,Xr]),this;pa=this.__data__=new qn(Ra)}return pa.set(bn,Xr),this}ea.prototype.clear=La,ea.prototype.delete=ha,ea.prototype.get=_i,ea.prototype.has=Ni,ea.prototype.set=vi;function si(bn,Xr){var pa=tl(bn)||Es(bn)?Me(bn.length,String):[],Ra=pa.length,Qi=!!Ra;for(var Co in bn)(Xr||cr.call(bn,Co))&&!(Qi&&(Co=="length"||yu(Co,Ra)))&&pa.push(Co);return pa}function Mi(bn,Xr,pa){var Ra=bn[Xr];(!(cr.call(bn,Xr)&&is(Ra,pa))||pa===void 0&&!(Xr in bn))&&(bn[Xr]=pa)}function Pa(bn,Xr){for(var pa=bn.length;pa--;)if(is(bn[pa][0],Xr))return pa;return-1}function un(bn,Xr){return bn&&Yi(Xr,tu(Xr),bn)}function Oe(bn,Xr,pa,Ra,Qi,Co,to){var xo;if(Ra&&(xo=Co?Ra(bn,Qi,Co,to):Ra(bn)),xo!==void 0)return xo;if(!Ro(bn))return bn;var gs=tl(bn);if(gs){if(xo=mu(bn),!Xr)return Wo(bn,xo)}else{var vo=zs(bn),ou=vo==M||vo==k;if(ka(bn))return ya(bn,Xr);if(vo==F||vo==Q||ou&&!Co){if(ee(bn))return Co?bn:{};if(xo=ds(ou?{}:bn),!Xr)return wi(bn,un(xo,bn))}else{if(!be[vo])return Co?bn:{};xo=Ms(bn,vo,Oe,Xr)}}to||(to=new ea);var ms=to.get(bn);if(ms)return ms;if(to.set(bn,xo),!gs)var xu=pa?gi(bn):tu(bn);return pe(xu||bn,function(dl,kl){xu&&(kl=dl,dl=bn[kl]),Mi(xo,kl,Oe(dl,Xr,pa,Ra,kl,bn,to))}),xo}function hn(bn){return Ro(bn)?Mn(bn):{}}function Hn(bn,Xr,pa){var Ra=Xr(bn);return tl(bn)?Ra:Ge(Ra,pa(bn))}function Bn(bn){return Ur.call(bn)}function Jn(bn){if(!Ro(bn)||Cs(bn))return!1;var Xr=Ku(bn)||ee(bn)?fa:At;return Xr.test(Wi(bn))}function Lr(bn){if(!qo(bn))return jr(bn);var Xr=[];for(var pa in Object(bn))cr.call(bn,pa)&&pa!="constructor"&&Xr.push(pa);return Xr}function ya(bn,Xr){if(Xr)return bn.slice();var pa=new bn.constructor(bn.length);return bn.copy(pa),pa}function Fa(bn){var Xr=new bn.constructor(bn.byteLength);return new Da(Xr).set(new Da(bn)),Xr}function ui(bn,Xr){var pa=Xr?Fa(bn.buffer):bn.buffer;return new bn.constructor(pa,bn.byteOffset,bn.byteLength)}function Ei(bn,Xr,pa){var Ra=Xr?pa(Pt(bn),!0):Pt(bn);return te(Ra,Re,new bn.constructor)}function oo(bn){var Xr=new bn.constructor(bn.source,we.exec(bn));return Xr.lastIndex=bn.lastIndex,Xr}function po(bn,Xr,pa){var Ra=Xr?pa(Ne(bn),!0):Ne(bn);return te(Ra,He,new bn.constructor)}function bo(bn){return Lt?Object(Lt.call(bn)):{}}function ts(bn,Xr){var pa=Xr?Fa(bn.buffer):bn.buffer;return new bn.constructor(pa,bn.byteOffset,bn.length)}function Wo(bn,Xr){var pa=-1,Ra=bn.length;for(Xr||(Xr=Array(Ra));++pa<Ra;)Xr[pa]=bn[pa];return Xr}function Yi(bn,Xr,pa,Ra){pa||(pa={});for(var Qi=-1,Co=Xr.length;++Qi<Co;){var to=Xr[Qi],xo=Ra?Ra(pa[to],bn[to],to,pa,bn):void 0;Mi(pa,to,xo===void 0?bn[to]:xo)}return pa}function wi(bn,Xr){return Yi(bn,Io(bn),Xr)}function gi(bn){return Hn(bn,tu,Io)}function us(bn,Xr){var pa=bn.__data__;return uu(Xr)?pa[typeof Xr=="string"?"string":"hash"]:pa.map}function Do(bn,Xr){var pa=We(bn,Xr);return Jn(pa)?pa:void 0}var Io=tr?yt(tr,Object):eu,zs=Bn;(Hr&&zs(new Hr(new ArrayBuffer(1)))!=dt||Ea&&zs(new Ea)!=B||lr&&zs(lr.resolve())!=K||Cr&&zs(new Cr)!=_||vr&&zs(new vr)!=st)&&(zs=function(Xr){var pa=Ur.call(Xr),Ra=pa==F?Xr.constructor:void 0,Qi=Ra?Wi(Ra):void 0;if(Qi)switch(Qi){case ta:return dt;case ra:return B;case Zr:return K;case vt:return _;case _n:return st}return pa});function mu(bn){var Xr=bn.length,pa=bn.constructor(Xr);return Xr&&typeof bn[0]=="string"&&cr.call(bn,"index")&&(pa.index=bn.index,pa.input=bn.input),pa}function ds(bn){return typeof bn.constructor=="function"&&!qo(bn)?hn(Rr(bn)):{}}function Ms(bn,Xr,pa,Ra){var Qi=bn.constructor;switch(Xr){case ut:return Fa(bn);case L:case P:return new Qi(+bn);case dt:return ui(bn,Ra);case gt:case wt:case ot:case pt:case Nt:case Gt:case se:case ie:case Be:return ts(bn,Ra);case B:return Ei(bn,Ra,pa);case R:case ft:return new Qi(bn);case O:return oo(bn);case _:return po(bn,Ra,pa);case mt:return bo(bn)}}function yu(bn,Xr){return Xr=Xr==null?W:Xr,!!Xr&&(typeof bn=="number"||Yt.test(bn))&&bn>-1&&bn%1==0&&bn<Xr}function uu(bn){var Xr=X(bn);return Xr=="string"||Xr=="number"||Xr=="symbol"||Xr=="boolean"?bn!=="__proto__":bn===null}function Cs(bn){return!!Un&&Un in bn}function qo(bn){var Xr=bn&&bn.constructor,pa=typeof Xr=="function"&&Xr.prototype||Rt;return bn===pa}function Wi(bn){if(bn!=null){try{return xr.call(bn)}catch(Xr){}try{return bn+""}catch(Xr){}}return""}function ls(bn){return Oe(bn,!0,!0)}function is(bn,Xr){return bn===Xr||bn!==bn&&Xr!==Xr}function Es(bn){return Ys(bn)&&cr.call(bn,"callee")&&(!ar.call(bn,"callee")||Ur.call(bn)==Q)}var tl=Array.isArray;function bu(bn){return bn!=null&&Vs(bn.length)&&!Ku(bn)}function Ys(bn){return Ns(bn)&&bu(bn)}var ka=Gn||Zu;function Ku(bn){var Xr=Ro(bn)?Ur.call(bn):"";return Xr==M||Xr==k}function Vs(bn){return typeof bn=="number"&&bn>-1&&bn%1==0&&bn<=W}function Ro(bn){var Xr=X(bn);return!!bn&&(Xr=="object"||Xr=="function")}function Ns(bn){return!!bn&&X(bn)=="object"}function tu(bn){return bu(bn)?si(bn):Lr(bn)}function eu(){return[]}function Zu(){return!1}it.Z=ls},43054:function(sr,it,$){"use strict";$.d(it,{Z:function(){return ar}});var X=$(23044),tt=$(9419),j=$(81710),W=$(46581),Q=$(76575),Z=function(tr,Gn){return tr.reduce(function(jr,Hr){return jr.some(function(Ea){return Gn(Hr,Ea)})||jr.push(Hr),jr},[])},L=$(32096),P=$(57804),C=!0,M=function(tr){return Math.floor(Math.random()*tr)},k=function(){var tr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,Gn=M(255),jr=M(255),Hr=M(255),Ea="rgba(".concat(Gn,",").concat(jr,",").concat(Hr,",").concat(tr,")");return Ea},B={},R=function(tr){B[tr]||(B[tr]=k());var Gn=B[tr];return function(){if(C,!1){var jr;for(var Hr,Ea,lr;lr<Hr;lr++);}}},F=R,K=function(tr){return tr.charAt(0)==="#"?tr.slice(1):tr},O=function(tr){var Gn=tr.length===3||tr.length===4,jr=Gn?"".concat(tr.slice(0,1)).concat(tr.slice(0,1)):tr.slice(0,2),Hr=Gn?"".concat(tr.slice(1,2)).concat(tr.slice(1,2)):tr.slice(2,4),Ea=Gn?"".concat(tr.slice(2,3)).concat(tr.slice(2,3)):tr.slice(4,6),lr=(Gn?"".concat(tr.slice(3,4)).concat(tr.slice(3,4)):tr.slice(6,8))||"ff";return{r:jr,g:Hr,b:Ea,a:lr}},_=function(tr){return parseInt(tr,16)},ft=function(tr){var Gn=tr.r,jr=tr.g,Hr=tr.b,Ea=tr.a;return{r:_(Gn),g:_(jr),b:_(Hr),a:+(_(Ea)/255).toFixed(2)}},mt=function(tr){return!isNaN(parseFloat(String(tr)))&&isFinite(Number(tr))},st=function(tr,Gn){var jr=tr.r,Hr=tr.g,Ea=tr.b,lr=tr.a,Cr=mt(Gn)?Gn:lr;return"rgba(".concat(jr,", ").concat(Hr,", ").concat(Ea,", ").concat(Cr,")")},ut=function(tr,Gn){var jr=K(tr),Hr=O(jr),Ea=ft(Hr);return st(Ea,Gn)},dt=function(tr){var Gn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,jr=K(tr),Hr=O(jr),Ea=ft(Hr),lr=Ea.r,Cr=Ea.g,vr=Ea.b,Tr=lr.toString(16),ta=Cr.toString(16),ra=vr.toString(16),Zr=Math.round(Number(Gn)*255).toString(16);return Tr.length===1&&(Tr="0".concat(Tr)),ta.length===1&&(ta="0".concat(ta)),ra.length===1&&(ra="0".concat(ra)),Zr.length===1&&(Zr="0".concat(Zr)),"#".concat(Tr).concat(ta).concat(ra).concat(Zr)},gt=ut;function wt(Fn){return Gt(Fn)||Nt(Fn)||pt(Fn)||ot()}function ot(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pt(Fn,tr){if(!!Fn){if(typeof Fn=="string")return se(Fn,tr);var Gn=Object.prototype.toString.call(Fn).slice(8,-1);if(Gn==="Object"&&Fn.constructor&&(Gn=Fn.constructor.name),Gn==="Map"||Gn==="Set")return Array.from(Fn);if(Gn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Gn))return se(Fn,tr)}}function Nt(Fn){if(typeof Symbol!="undefined"&&Fn[Symbol.iterator]!=null||Fn["@@iterator"]!=null)return Array.from(Fn)}function Gt(Fn){if(Array.isArray(Fn))return se(Fn)}function se(Fn,tr){(tr==null||tr>Fn.length)&&(tr=Fn.length);for(var Gn=0,jr=new Array(tr);Gn<tr;Gn++)jr[Gn]=Fn[Gn];return jr}function ie(Fn,tr){for(var Gn=0;Gn<tr.length;Gn++){var jr=tr[Gn];jr.enumerable=jr.enumerable||!1,jr.configurable=!0,"value"in jr&&(jr.writable=!0),Object.defineProperty(Fn,jr.key,jr)}}function Be(Fn,tr,Gn){return tr&&ie(Fn.prototype,tr),Gn&&ie(Fn,Gn),Object.defineProperty(Fn,"prototype",{writable:!1}),Fn}function ke(Fn,tr){if(!(Fn instanceof tr))throw new TypeError("Cannot call a class as a function")}var we=Be(function Fn(tr){var Gn=this;ke(this,Fn),this.nodeIds=[],this.bfs=function(jr){var Hr;if(!!Gn.root){var Ea=[];for(Ea.push(Gn.root);Ea.length;){var lr=Ea.shift();if(jr(lr))return lr;((Hr=lr==null?void 0:lr.children)===null||Hr===void 0?void 0:Hr.length)&&Ea.push.apply(Ea,wt(lr.children))}}},this.getRoot=function(){return Gn.root},this.getNode=function(jr){var Hr=Gn.bfs(function(Ea){return Ea.id===jr});return Hr},this.addRoot=function(jr,Hr){Gn.root={id:jr,children:[]},Gn.nodeIds.push(jr)},this.addNode=function(jr){var Hr=jr.parentId,Ea=jr.id,lr=jr.data;if(!Gn.root){Gn.addRoot(Ea,lr);return}var Cr;if(Hr)Cr=Gn.getNode(Hr);else{var vr=Math.floor(Math.random()*Gn.nodeIds.length);Cr=Gn.getNode(Gn.nodeIds[vr])}if(!Cr){console.error("Parent node doesn't exist!");return}Gn.nodeIds.push(Ea),Cr.children.push({id:Ea,parent:Cr,children:[]})},tr&&(this.root=tr)}),At=function Fn(tr,Gn){Gn(tr),tr.children&&tr.children.length>0&&tr.children.forEach(function(jr){Fn(jr,Gn)})},Yt=At;function be(Fn){return Le(Fn)||le(Fn)||Ee(Fn)||nn()}function nn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ee(Fn,tr){if(!!Fn){if(typeof Fn=="string")return Ze(Fn,tr);var Gn=Object.prototype.toString.call(Fn).slice(8,-1);if(Gn==="Object"&&Fn.constructor&&(Gn=Fn.constructor.name),Gn==="Map"||Gn==="Set")return Array.from(Fn);if(Gn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Gn))return Ze(Fn,tr)}}function le(Fn){if(typeof Symbol!="undefined"&&Fn[Symbol.iterator]!=null||Fn["@@iterator"]!=null)return Array.from(Fn)}function Le(Fn){if(Array.isArray(Fn))return Ze(Fn)}function Ze(Fn,tr){(tr==null||tr>Fn.length)&&(tr=Fn.length);for(var Gn=0,jr=new Array(tr);Gn<tr;Gn++)jr[Gn]=Fn[Gn];return jr}function fe(Fn,tr){for(var Gn=0;Gn<tr.length;Gn++){var jr=tr[Gn];jr.enumerable=jr.enumerable||!1,jr.configurable=!0,"value"in jr&&(jr.writable=!0),Object.defineProperty(Fn,jr.key,jr)}}function Re(Fn,tr,Gn){return tr&&fe(Fn.prototype,tr),Gn&&fe(Fn,Gn),Object.defineProperty(Fn,"prototype",{writable:!1}),Fn}function He(Fn,tr){if(!(Fn instanceof tr))throw new TypeError("Cannot call a class as a function")}var pe={nodeCount:10,nodeType:"company"},Ge=Re(function Fn(tr){var Gn=this;He(this,Fn),this.initNodes=function(){var jr=Gn.options,Hr=jr.nodeCount,Ea=jr.nodeType,lr=Array.from({length:Hr});Gn.nodes=lr.map(function(Tr,ta){return{id:"node-".concat(ta),label:"node-".concat(ta),type:Ea}});for(var Cr=0;Cr<Hr;Cr=Cr+1)for(var vr=0;vr<Hr-1;vr=vr+1)Gn.edges.push({source:"node-".concat(Cr),target:"node-".concat(vr)});Gn.nodeIds=Gn.nodes.map(function(Tr){return Tr.id})},this.expand=function(jr){return Gn.edges=[],Gn.nodes=[],jr.forEach(function(Hr){for(var Ea=0;Ea<Gn.options.nodeCount;Ea+=1)Gn.nodes.push({id:"".concat(Hr.id,"-").concat(Ea),type:Hr.type}),Gn.edges.push({source:"".concat(Hr.id,"-").concat(Ea),target:Hr.id})}),Gn},this.type=function(jr){return Gn.nodes=Gn.nodes.map(function(Hr){return Object.assign(Object.assign({},Hr),{type:jr})}),Gn},this.circle=function(){var jr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Hr=jr;return Gn.nodeIds.indexOf(Hr)===-1&&(Hr="node-0"),Gn.edges=Gn.edges.filter(function(Ea){return Ea.source===Hr||Ea.target===Hr}),Gn},this.random=function(){var jr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.5,Hr=Gn.options.nodeCount,Ea=parseInt(String(Hr*jr)),lr=Gn.nodeIds.sort(function(){return Math.random()-.5}).slice(0,Ea);return Gn.edges=Gn.edges.filter(function(Cr){return lr.indexOf(Cr.target)!==-1}),Gn.edges=Gn.edges.sort(function(){return Math.random()-.5}).slice(0,Ea),Gn},this.tree=function(){Gn.edges=[],Gn.treeData=new we;var jr=Gn.nodeIds[0];return Gn.nodeIds.forEach(function(Hr){Gn.treeData.addNode({id:Hr,style:{label:{value:Hr}}})}),Gn.treeData.bfs(function(Hr){var Ea;return Hr.id!==jr&&Gn.edges.push({source:(Ea=Hr==null?void 0:Hr.parent)===null||Ea===void 0?void 0:Ea.id,target:Hr.id,properties:[]}),!1}),Gn},this.value=function(){return{nodes:Gn.nodes,edges:Gn.edges}},this.combos=function(jr){var Hr=new Set;return Gn.nodes=Gn.nodes.map(function(Ea,lr){var Cr=Math.ceil((lr+1)/jr),vr="combo-".concat(Cr);return Hr.add(vr),Object.assign(Object.assign({},Ea),{comboId:vr})}),Gn.combosData=be(Hr).map(function(Ea){return{id:Ea,label:Ea}}),Gn},this.graphin=function(){return{nodes:Gn.nodes.map(function(jr){return Object.assign(Object.assign({},jr),{id:jr.id,type:"graphin-circle",comboId:jr.comboId,style:{label:{value:"".concat(jr.id)}}})}),edges:Gn.edges.map(function(jr){return{source:jr.source,target:jr.target}}),combos:Gn.combosData}},this.graphinTree=function(){var jr=Gn.treeData.getRoot();return Yt(jr,function(Hr){delete Hr.parent}),jr},this.options=pe,this.options.nodeCount=tr,this.nodes=[],this.edges=[],this.nodeIds=[],this.treeData=new we,this.initNodes()}),te=function(tr){return new Ge(tr)},Me=te;function We(Fn){return Fn%2==0}function ee(Fn){return!We(Fn)}var Pt=30,yt=10,Ne=1,tn=function(tr){var Gn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{poly:Pt,loop:yt,loopLabelPosition:Ne},jr=Gn.poly,Hr=jr===void 0?Pt:jr,Ea=Gn.loop,lr=Ea===void 0?yt:Ea,Cr=Gn.loopLabelPosition,vr=Cr===void 0?Ne:Cr,Tr={};tr.forEach(function(Zr,vt){var _n=Object.assign({},Zr),an=_n.source,Lt=_n.target,kt="".concat(an,"-").concat(Lt);_n.id=_n.id||"".concat(an,"-").concat(Lt,"-").concat(vt);var at="".concat(Lt,"-").concat(an);Tr[kt]?Tr[kt].push(_n):Tr[at]?(_n.revert=!0,Tr[at].push(_n)):Tr[kt]=[_n]});var ta=Object.values(Tr),ra=[];return ta.forEach(function(Zr){if(Zr.length>1){var vt=We(Zr.length);Zr.forEach(function(_n,an){var Lt,kt=_n.source,at=_n.target,H=kt===at,Y=an,bt;if(vt){var $t=Math.ceil((Y+1)/2);bt=Hr*$t}else{var jt=ee(Y)?Y+1:Y,Ht=Math.ceil(jt/2);bt=Hr*Ht}var re=We(Y)?bt:-bt;_n.revert&&(re=-re,delete _n.revert);var on;if(H){var Je=Y*lr;if(on={type:"loop",loop:{distance:Je}},(Lt=_n.style)===null||Lt===void 0?void 0:Lt.label){var Ve=0,qn=-(Pt*vr+Je*2);_n.style.label.offset=[Ve,qn]}}else on={type:"poly",poly:{distance:re}};(0,X.deepMix)(_n,{style:{keyshape:on}}),_n.isMultiple=!0,ra.push(_n)})}else ra.push(Zr[0])}),ra},fn=tn;function Rt(Fn){return cr(Fn)||xr(Fn)||Un(Fn)||Yn()}function Yn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Un(Fn,tr){if(!!Fn){if(typeof Fn=="string")return Ur(Fn,tr);var Gn=Object.prototype.toString.call(Fn).slice(8,-1);if(Gn==="Object"&&Fn.constructor&&(Gn=Fn.constructor.name),Gn==="Map"||Gn==="Set")return Array.from(Fn);if(Gn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Gn))return Ur(Fn,tr)}}function xr(Fn){if(typeof Symbol!="undefined"&&Fn[Symbol.iterator]!=null||Fn["@@iterator"]!=null)return Array.from(Fn)}function cr(Fn){if(Array.isArray(Fn))return Ur(Fn)}function Ur(Fn,tr){(tr==null||tr>Fn.length)&&(tr=Fn.length);for(var Gn=0,jr=new Array(tr);Gn<tr;Gn++)jr[Gn]=Fn[Gn];return jr}var fa=function(tr,Gn){var jr=Gn.split("."),Hr=jr.reduce(function(Ea,lr,Cr,vr){var Tr=Ea[lr];return!Tr&&Cr!==vr.length-1?{}:Tr},tr);return Hr},Sa=function(tr,Gn){var jr=new Map;return tr.forEach(function(Hr){var Ea=fa(Hr,Gn),lr=jr.get(Ea);lr?jr.set(Ea,[].concat(Rt(lr),[Hr])):jr.set(Ea,[Hr])}),jr},sa=function(tr,Gn){var jr=!0,Hr=Object.keys(tr),Ea=Object.keys(Gn);if(Hr.length!==Ea.length)return!1;for(var lr=0;lr<Hr.length;lr++){var Cr=Hr[lr];if(tr[Cr]!==Gn[Cr]){jr=!1;break}}return jr},Da=sa,Rr=function(){function tr(){return((1+Math.random())*65536|0).toString(16).substring(1)}return"".concat(tr()+tr(),"-").concat(tr(),"-").concat(tr(),"-").concat(tr(),"-").concat(tr()).concat(tr()).concat(tr())},Mn=Rr,ar={hexToRgba:gt,debug:F,mock:Me,shallowEqual:Da,hexToRgbaToHex:dt,getNodeStyleByTheme:Q.Z,getEdgeStyleByTheme:W.Z,getComboStyleByTheme:j.Z,deepMix:X.deepMix,cloneDeep:P.Z,uuid:Mn,walk:Yt,processEdges:fn,calcByteLength:L.Z,layouts:tt.$,uniqBy:Z,getEnumDataMap:Sa,getEnumValue:fa}},69787:function(sr,it,$){"use strict";$.r(it),$.d(it,{Graph:function(){return gt},GraphWithEvent:function(){return nn},algorithm:function(){return X},comparision:function(){return j},essence:function(){return tt},generate:function(){return W}});var X={};$.r(X),$.d(X,{components:function(){return pe},dfs:function(){return Me},dijkstra:function(){return Un},dijkstraAll:function(){return cr},findCycles:function(){return sa},floydWarshall:function(){return $t},isAcyclic:function(){return _n},postorder:function(){return Lt},preorder:function(){return at},prim:function(){return Re},tarjan:function(){return fa},topsort:function(){return Zr}});var tt={};$.r(tt),$.d(tt,{hasSelfLoop:function(){return si},isGraph:function(){return _i},isNullGraph:function(){return vi},isSimpleGraph:function(){return Ni}});var j={};$.r(j),$.d(j,{containAllSameEdges:function(){return qn},containAllSameNodes:function(){return Ve},containSameEdges:function(){return Ht},containSameNodes:function(){return jt},getSameEdges:function(){return on},getSameNodes:function(){return re},isGraphComplement:function(){return Mi},isGraphContainsAnother:function(){return qr},isGraphOptionSame:function(){return Je},isGraphSame:function(){return Ln}});var W={};$.r(W),$.d(W,{getGraphComplement:function(){return Pa}});var Q;(function(un){un.DEFAULT_EDGE_NAME="\0",un.GRAPH_NODE="\0",un.EDGE_KEY_DELIM=""})(Q||(Q={}));function Z(un,Oe){var hn=un.get(Oe)||0;un.set(Oe,hn+1)}function L(un,Oe){var hn=un.get(Oe);hn!==void 0&&(hn=hn-1,hn>0?un.set(Oe,hn):un.delete(Oe))}function P(un,Oe,hn,Hn){var Bn=String(Oe),Jn=String(hn);if(!un&&Bn>Jn){var Lr=Bn;Bn=Jn,Jn=Lr}return Bn+Q.EDGE_KEY_DELIM+Jn+Q.EDGE_KEY_DELIM+(Hn===void 0?Q.DEFAULT_EDGE_NAME:Hn)}function C(un,Oe,hn,Hn){var Bn=String(Oe),Jn=String(hn),Lr={v:Oe,w:hn};if(!un&&Bn>Jn){var ya=Lr.v;Lr.v=Lr.w,Lr.w=ya}return Hn!==void 0&&(Lr.name=Hn),Lr}function M(un,Oe){return P(un,Oe.v,Oe.w,Oe.name)}function k(un){return typeof un=="function"}var B=function(Oe){return Oe.nodes().map(function(hn){var Hn=Oe.node(hn),Bn=Oe.parent(hn),Jn={id:hn,value:Hn,parent:Bn};return Jn.value===void 0&&delete Jn.value,Jn.parent===void 0&&delete Jn.parent,Jn})},R=function(Oe){return Oe.edges().map(function(hn){var Hn=Oe.edge(hn),Bn={v:hn.v,w:hn.w,value:Hn,name:hn.name};return Bn.name===void 0&&delete Bn.name,Bn.value===void 0&&delete Bn.value,Bn})},F=function(Oe){var hn={options:{directed:Oe.isDirected(),multigraph:Oe.isMultigraph(),compound:Oe.isCompound()},nodes:B(Oe),edges:R(Oe),value:Oe.graph()};return hn.value===void 0&&delete hn.value,hn},K=function(Oe){var hn=new gt(Oe.options);return Oe.value!==void 0&&hn.setGraph(Oe.value),Oe.nodes.forEach(function(Hn){hn.setNode(Hn.id,Hn.value),Hn.parent&&hn.setParent(Hn.id,Hn.parent)}),Oe.edges.forEach(function(Hn){hn.setEdge(Hn.v,Hn.w,Hn.value,Hn.name)}),hn};function O(un,Oe){var hn=Object.keys(un);if(Object.getOwnPropertySymbols){var Hn=Object.getOwnPropertySymbols(un);Oe&&(Hn=Hn.filter(function(Bn){return Object.getOwnPropertyDescriptor(un,Bn).enumerable})),hn.push.apply(hn,Hn)}return hn}function _(un){for(var Oe=1;Oe<arguments.length;Oe++){var hn=arguments[Oe]!=null?arguments[Oe]:{};Oe%2?O(Object(hn),!0).forEach(function(Hn){ft(un,Hn,hn[Hn])}):Object.getOwnPropertyDescriptors?Object.defineProperties(un,Object.getOwnPropertyDescriptors(hn)):O(Object(hn)).forEach(function(Hn){Object.defineProperty(un,Hn,Object.getOwnPropertyDescriptor(hn,Hn))})}return un}function ft(un,Oe,hn){return Oe in un?Object.defineProperty(un,Oe,{value:hn,enumerable:!0,configurable:!0,writable:!0}):un[Oe]=hn,un}function mt(un,Oe){if(!(un instanceof Oe))throw new TypeError("Cannot call a class as a function")}function st(un,Oe){for(var hn=0;hn<Oe.length;hn++){var Hn=Oe[hn];Hn.enumerable=Hn.enumerable||!1,Hn.configurable=!0,"value"in Hn&&(Hn.writable=!0),Object.defineProperty(un,Hn.key,Hn)}}function ut(un,Oe,hn){return Oe&&st(un.prototype,Oe),hn&&st(un,hn),Object.defineProperty(un,"prototype",{writable:!1}),un}var dt={compound:!1,multigraph:!1,directed:!0},gt=function(){function un(){var Oe=this,hn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};mt(this,un),this.directed=!0,this.multigraph=!1,this.compound=!1,this.GRAPH_NODE=Q.GRAPH_NODE,this.label=void 0,this.nodeCountNum=0,this.edgeCountNum=0,this.defaultNodeLabelFn=function(){},this.defaultEdgeLabelFn=function(){},this.parentMap=void 0,this.childrenMap=void 0,this.nodesLabelMap=new Map,this.inEdgesMap=new Map,this.outEdgesMap=new Map,this.predecessorsMap=new Map,this.successorsMap=new Map,this.edgesMap=new Map,this.edgesLabelsMap=new Map,this.isDirected=function(){return Oe.directed},this.isMultigraph=function(){return Oe.multigraph},this.isCompound=function(){return Oe.compound},this.setGraph=function(Bn){return Oe.label=Bn,Oe},this.graph=function(){return Oe.label},this.setDefaultNodeLabel=function(Bn){return k(Bn)?Oe.defaultNodeLabelFn=Bn:Oe.defaultNodeLabelFn=function(){return Bn},Oe},this.nodeCount=function(){return Oe.nodeCountNum},this.node=function(Bn){return Oe.nodesLabelMap.get(Bn)},this.nodes=function(){return Array.from(Oe.nodesLabelMap.keys())},this.sources=function(){return Oe.nodes().filter(function(Bn){var Jn;return!((Jn=Oe.inEdgesMap.get(Bn))===null||Jn===void 0?void 0:Jn.size)})},this.sinks=function(){return Oe.nodes().filter(function(Bn){var Jn;return!((Jn=Oe.outEdgesMap.get(Bn))===null||Jn===void 0?void 0:Jn.size)})},this.setNodes=function(Bn,Jn){return Bn.map(function(Lr){return Oe.setNode(Lr,Jn)}),Oe},this.hasNode=function(Bn){return Oe.nodesLabelMap.has(Bn)},this.checkCompound=function(){if(!Oe.isCompound())throw new Error("Cannot construct parent-children relations in a non-compound graph")},this.parent=function(Bn){if(Oe.isCompound()){var Jn,Lr=(Jn=Oe.parentMap)===null||Jn===void 0?void 0:Jn.get(Bn);if(Lr!==Oe.GRAPH_NODE)return Lr}},this.removeFromParentsChildList=function(Bn){var Jn=Oe.parentMap.get(Bn);Oe.childrenMap.get(Jn).delete(Bn)},this.setParent=function(Bn,Jn){var Lr,ya;Oe.checkCompound();for(var Fa=Jn===void 0?Oe.GRAPH_NODE:Jn,ui=Oe.parent(Fa);ui;){if(Bn===ui)throw new Error("Setting "+Jn+" as parent of "+Bn+" would create a cycle");ui=Oe.parent(ui)}Jn&&Oe.setNode(Jn),Oe.setNode(Bn),Oe.removeFromParentsChildList(Bn),(Lr=Oe.parentMap)===null||Lr===void 0||Lr.set(Bn,Fa);var Ei=Oe.childrenMap.get(Fa);return Ei.set(Bn,!0),(ya=Oe.childrenMap)===null||ya===void 0||ya.set(Fa,Ei),Oe},this.children=function(Bn){var Jn=Bn===void 0?Oe.GRAPH_NODE:Bn;if(Oe.isCompound()){var Lr,ya=(Lr=Oe.childrenMap)===null||Lr===void 0?void 0:Lr.get(Jn);return ya?Array.from(ya.keys()):void 0}if(Jn===Oe.GRAPH_NODE)return Oe.nodes();if(Bn&&Oe.hasNode(Bn))return[]},this.predecessors=function(Bn){var Jn=Oe.predecessorsMap.get(Bn);return Jn?Array.from(Jn.keys()):void 0},this.successors=function(Bn){var Jn=Oe.successorsMap.get(Bn);return Jn?Array.from(Jn.keys()):void 0},this.neighbors=function(Bn){var Jn;if(!!Oe.hasNode(Bn))return Array.from(new Set((Jn=Oe.predecessors(Bn))===null||Jn===void 0?void 0:Jn.concat(Oe.successors(Bn))))},this.isLeaf=function(Bn){var Jn;if(Oe.isDirected()){var Lr;return!((Lr=Oe.successors(Bn))===null||Lr===void 0?void 0:Lr.length)}return!((Jn=Oe.neighbors(Bn))===null||Jn===void 0?void 0:Jn.length)},this.filterNodes=function(Bn){var Jn=Oe.directed,Lr=Oe.multigraph,ya=Oe.compound,Fa=new un({directed:Jn,multigraph:Lr,compound:ya});if(Fa.setGraph(Oe.graph()),Oe.nodes().forEach(function(Ei){Bn(Ei)&&Fa.setNode(Ei,Oe.node(Ei))}),Oe.edges().forEach(function(Ei){Fa.hasNode(Ei.v)&&Fa.hasNode(Ei.w)&&Fa.setEdgeObj(Ei,Oe.edge(Ei))}),ya){var ui=function(oo){for(var po=Oe.parent(oo);po!==void 0&&!Fa.hasNode(po);)po=Oe.parent(po);return po};Fa.nodes().forEach(function(Ei){Fa.setParent(Ei,ui(Ei))})}return Fa},this.setDefaultEdgeLabel=function(Bn){return k(Bn)?Oe.defaultEdgeLabelFn=Bn:Oe.defaultEdgeLabelFn=function(){return Bn},Oe},this.edgeCount=function(){return Oe.edgeCountNum},this.setEdgeObj=function(Bn,Jn){return Oe.setEdge(Bn.v,Bn.w,Jn,Bn.name)},this.setPath=function(Bn,Jn){return Bn.reduce(function(Lr,ya){return Oe.setEdge(Lr,ya,Jn),ya}),Oe},this.edgeFromArgs=function(Bn,Jn,Lr){return Oe.edge({v:Bn,w:Jn,name:Lr})},this.edge=function(Bn){return Oe.edgesLabelsMap.get(M(Oe.isDirected(),Bn))},this.hasEdge=function(Bn,Jn,Lr){return Oe.edgesLabelsMap.has(M(Oe.isDirected(),{v:Bn,w:Jn,name:Lr}))},this.removeEdgeObj=function(Bn){var Jn=Bn.v,Lr=Bn.w,ya=Bn.name;return Oe.removeEdge(Jn,Lr,ya)},this.edges=function(){return Array.from(Oe.edgesMap.values())},this.inEdges=function(Bn,Jn){var Lr=Oe.inEdgesMap.get(Bn);if(Lr)return Array.from(Lr.values()).filter(function(ya){return!Jn||ya.v===Jn})},this.outEdges=function(Bn,Jn){var Lr=Oe.outEdgesMap.get(Bn);if(Lr)return Array.from(Lr.values()).filter(function(ya){return!Jn||ya.w===Jn})},this.nodeEdges=function(Bn,Jn){var Lr;if(!!Oe.hasNode(Bn))return(Lr=Oe.inEdges(Bn,Jn))===null||Lr===void 0?void 0:Lr.concat(Oe.outEdges(Bn,Jn))},this.toJSON=function(){return F(Oe)},this.nodeInDegree=function(Bn){var Jn=Oe.inEdgesMap.get(Bn);return Jn?Jn.size:0},this.nodeOutDegree=function(Bn){var Jn=Oe.outEdgesMap.get(Bn);return Jn?Jn.size:0},this.nodeDegree=function(Bn){return Oe.nodeInDegree(Bn)+Oe.nodeOutDegree(Bn)},this.source=function(Bn){return Bn.v},this.target=function(Bn){return Bn.w};var Hn=_(_({},dt),hn);this.compound=Hn.compound,this.directed=Hn.directed,this.multigraph=Hn.multigraph,this.compound&&(this.parentMap=new Map,this.childrenMap=new Map)}return ut(un,[{key:"setNode",value:function(hn,Hn){var Bn=this.nodesLabelMap,Jn=this.defaultNodeLabelFn,Lr=this.isCompound,ya=this.parentMap,Fa=this.childrenMap,ui=this.inEdgesMap,Ei=this.outEdgesMap,oo=this.predecessorsMap,po=this.successorsMap;if(Bn.has(hn))return Hn!==void 0&&Bn.set(hn,Hn),this;if(Bn.set(hn,Hn||Jn(hn)),Lr()){var bo;ya==null||ya.set(hn,this.GRAPH_NODE),Fa==null||Fa.set(hn,new Map),(Fa==null?void 0:Fa.has(this.GRAPH_NODE))||Fa==null||Fa.set(this.GRAPH_NODE,new Map),Fa==null||(bo=Fa.get(this.GRAPH_NODE))===null||bo===void 0||bo.set(hn,!0)}return[ui,Ei,oo,po].forEach(function(ts){return ts.set(hn,new Map)}),this.nodeCountNum+=1,this}},{key:"removeNode",value:function(hn){var Hn=this;if(this.hasNode(hn)){var Bn=function(Yi){Hn.removeEdge(Yi.v,Yi.w,Yi.name)},Jn=this.inEdgesMap,Lr=this.outEdgesMap,ya=this.predecessorsMap,Fa=this.successorsMap,ui=this.nodesLabelMap;if(this.isCompound()){var Ei,oo,po;this.removeFromParentsChildList(hn),(Ei=this.parentMap)===null||Ei===void 0||Ei.delete(hn),(oo=this.children(hn))===null||oo===void 0||oo.forEach(function(Wo){return Hn.setParent(Wo)}),(po=this.childrenMap)===null||po===void 0||po.delete(hn)}var bo=Jn.get(hn),ts=Lr.get(hn);Array.from(bo.values()).forEach(function(Wo){return Bn(Wo)}),Array.from(ts.values()).forEach(function(Wo){return Bn(Wo)}),ui.delete(hn),Jn.delete(hn),Lr.delete(hn),ya.delete(hn),Fa.delete(hn),this.nodeCountNum-=1}return this}},{key:"setEdge",value:function(hn,Hn,Bn,Jn){var Lr,ya,Fa=C(this.isDirected(),hn,Hn,Jn),ui=M(this.isDirected(),Fa),Ei=Fa.v,oo=Fa.w;if(this.edgesLabelsMap.has(ui))return this.edgesLabelsMap.set(ui,Bn),this;if(Jn!==void 0&&!this.isMultigraph())throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(Ei),this.setNode(oo),this.edgesLabelsMap.set(ui,Bn||this.defaultEdgeLabelFn(Ei,oo,Jn)),Object.freeze(Fa),this.edgesMap.set(ui,Fa);var po=this.predecessorsMap.get(oo),bo=this.successorsMap.get(Ei);return Z(po,Ei),Z(bo,oo),(Lr=this.inEdgesMap.get(oo))===null||Lr===void 0||Lr.set(ui,Fa),(ya=this.outEdgesMap.get(Ei))===null||ya===void 0||ya.set(ui,Fa),this.edgeCountNum+=1,this}},{key:"removeEdge",value:function(hn,Hn,Bn){var Jn=P(this.isDirected(),hn,Hn,Bn),Lr=this.edgesMap.get(Jn);if(Lr){var ya=C(this.isDirected(),hn,Hn,Bn),Fa=ya.v,ui=ya.w;this.edgesLabelsMap.delete(Jn),this.edgesMap.delete(Jn);var Ei=this.predecessorsMap.get(ui),oo=this.successorsMap.get(Fa);L(Ei,Fa),L(oo,ui),this.inEdgesMap.get(ui).delete(Jn),this.outEdgesMap.get(Fa).delete(Jn),this.edgeCountNum-=1}return this}}]),un}();gt.fromJSON=K;function wt(un){return wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Oe){return typeof Oe}:function(Oe){return Oe&&typeof Symbol=="function"&&Oe.constructor===Symbol&&Oe!==Symbol.prototype?"symbol":typeof Oe},wt(un)}function ot(un,Oe){if(!(un instanceof Oe))throw new TypeError("Cannot call a class as a function")}function pt(un,Oe){for(var hn=0;hn<Oe.length;hn++){var Hn=Oe[hn];Hn.enumerable=Hn.enumerable||!1,Hn.configurable=!0,"value"in Hn&&(Hn.writable=!0),Object.defineProperty(un,Hn.key,Hn)}}function Nt(un,Oe,hn){return Oe&&pt(un.prototype,Oe),hn&&pt(un,hn),Object.defineProperty(un,"prototype",{writable:!1}),un}function Gt(){return typeof Reflect!="undefined"&&Reflect.get?Gt=Reflect.get:Gt=function(Oe,hn,Hn){var Bn=se(Oe,hn);if(!!Bn){var Jn=Object.getOwnPropertyDescriptor(Bn,hn);return Jn.get?Jn.get.call(arguments.length<3?Oe:Hn):Jn.value}},Gt.apply(this,arguments)}function se(un,Oe){for(;!Object.prototype.hasOwnProperty.call(un,Oe)&&(un=be(un),un!==null););return un}function ie(un,Oe){if(typeof Oe!="function"&&Oe!==null)throw new TypeError("Super expression must either be null or a function");un.prototype=Object.create(Oe&&Oe.prototype,{constructor:{value:un,writable:!0,configurable:!0}}),Object.defineProperty(un,"prototype",{writable:!1}),Oe&&Be(un,Oe)}function Be(un,Oe){return Be=Object.setPrototypeOf||function(Hn,Bn){return Hn.__proto__=Bn,Hn},Be(un,Oe)}function ke(un){var Oe=Yt();return function(){var Hn=be(un),Bn;if(Oe){var Jn=be(this).constructor;Bn=Reflect.construct(Hn,arguments,Jn)}else Bn=Hn.apply(this,arguments);return we(this,Bn)}}function we(un,Oe){if(Oe&&(wt(Oe)==="object"||typeof Oe=="function"))return Oe;if(Oe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return At(un)}function At(un){if(un===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return un}function Yt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(un){return!1}}function be(un){return be=Object.setPrototypeOf?Object.getPrototypeOf:function(hn){return hn.__proto__||Object.getPrototypeOf(hn)},be(un)}var nn=function(un){ie(hn,un);var Oe=ke(hn);function hn(){var Hn;ot(this,hn);for(var Bn=arguments.length,Jn=new Array(Bn),Lr=0;Lr<Bn;Lr++)Jn[Lr]=arguments[Lr];return Hn=Oe.call.apply(Oe,[this].concat(Jn)),Hn.eventPool={},Hn}return Nt(hn,[{key:"appendEvent",value:function(Bn,Jn){this.eventPool[Bn]||(this.eventPool[Bn]=[]),this.eventPool[Bn].push(Jn)}},{key:"removeEvent",value:function(Bn,Jn){if(!!this.eventPool[Bn]){var Lr=this.eventPool[Bn].indexOf(Jn);Lr>-1&&this.eventPool[Bn].splice(Lr,1)}}},{key:"emitEvent",value:function(Bn){for(var Jn=arguments.length,Lr=new Array(Jn>1?Jn-1:0),ya=1;ya<Jn;ya++)Lr[ya-1]=arguments[ya];!this.eventPool[Bn]||this.eventPool[Bn].forEach(function(Fa){Fa.apply(void 0,Lr)})}},{key:"setNode",value:function(Bn,Jn){return Gt(be(hn.prototype),"setNode",this).call(this,Bn,Jn),this.emitEvent("nodeAdd",Bn,Jn),this}},{key:"removeNode",value:function(Bn){return Gt(be(hn.prototype),"removeNode",this).call(this,Bn),this.emitEvent("nodeRemove",Bn),this}},{key:"setEdge",value:function(Bn,Jn,Lr,ya){return Gt(be(hn.prototype),"setEdge",this).call(this,Bn,Jn,Lr,ya),this.emitEvent("edgeAdd",Bn,Jn,Lr,ya),this}},{key:"removeEdge",value:function(Bn,Jn,Lr){return Gt(be(hn.prototype),"removeEdge",this).call(this,Bn,Jn,Lr),this.emitEvent("edgeRemove",Bn,Jn,Lr),this}}]),hn}(gt);function Ee(un,Oe){for(var hn=0;hn<Oe.length;hn++){var Hn=Oe[hn];Hn.enumerable=Hn.enumerable||!1,Hn.configurable=!0,"value"in Hn&&(Hn.writable=!0),Object.defineProperty(un,Hn.key,Hn)}}function le(un,Oe,hn){return Oe&&Ee(un.prototype,Oe),hn&&Ee(un,hn),Object.defineProperty(un,"prototype",{writable:!1}),un}function Le(un,Oe){if(!(un instanceof Oe))throw new TypeError("Cannot call a class as a function")}var Ze=le(function un(){var Oe=this;Le(this,un),this.arr=[],this.keyIndice=new Map,this.size=function(){return Oe.arr.length},this.keys=function(){return Oe.arr.map(function(hn){return hn.key})},this.has=function(hn){return Oe.keyIndice.has(hn)},this.priority=function(hn){var Hn=Oe.keyIndice.get(hn);if(Hn!==void 0)return Oe.arr[Hn].priority},this.swap=function(hn,Hn){var Bn=Oe.arr,Jn=Oe.keyIndice,Lr=[Bn[hn],Bn[Hn]],ya=Lr[0],Fa=Lr[1];Bn[hn]=Fa,Bn[Hn]=ya,Jn.set(ya.key,Hn),Jn.set(Fa.key,hn)},this.innerDecrease=function(hn){for(var Hn=Oe.arr,Bn=Hn[hn].priority,Jn,Lr=hn;Lr!==0;){var ya;if(Jn=Lr>>1,((ya=Hn[Jn])===null||ya===void 0?void 0:ya.priority)<Bn)break;Oe.swap(Lr,Jn),Lr=Jn}},this.heapify=function(hn){var Hn=Oe.arr,Bn=hn<<1,Jn=Bn+1,Lr=hn;Bn<Hn.length&&(Lr=Hn[Bn].priority<Hn[Lr].priority?Bn:Lr,Jn<Hn.length&&(Lr=Hn[Jn].priority<Hn[Lr].priority?Jn:Lr),Lr!==hn&&(Oe.swap(hn,Lr),Oe.heapify(Lr)))},this.min=function(){if(Oe.size()===0)throw new Error("Queue underflow");return Oe.arr[0].key},this.add=function(hn,Hn){var Bn=Oe.keyIndice,Jn=Oe.arr;if(!Bn.has(hn)){var Lr=Jn.length;return Bn.set(hn,Lr),Jn.push({key:hn,priority:Hn}),Oe.innerDecrease(Lr),!0}return!1},this.removeMin=function(){Oe.swap(0,Oe.arr.length-1);var hn=Oe.arr.pop();return Oe.keyIndice.delete(hn.key),Oe.heapify(0),hn.key},this.decrease=function(hn,Hn){if(!Oe.has(hn))throw new Error("There's no key named ".concat(hn));var Bn=Oe.keyIndice.get(hn);if(Hn>Oe.arr[Bn].priority)throw new Error("New priority is greater than current priority.Key: ".concat(hn," Old: + ").concat(Oe.arr[Bn].priority," New: ").concat(Hn));Oe.arr[Bn].priority=Hn,Oe.innerDecrease(Bn)}}),fe=function(Oe,hn){var Hn=new gt,Bn=new Map,Jn=new Ze,Lr;function ya(Ei){var oo=Ei.v===Lr?Ei.w:Ei.v,po=Jn.priority(oo);if(po!==void 0){var bo=hn(Ei);bo<po&&(Bn.set(oo,Lr),Jn.decrease(oo,bo))}}if(Oe.nodeCount()===0)return Hn;Oe.nodes().forEach(function(Ei){Jn.add(Ei,Number.POSITIVE_INFINITY),Hn.setNode(Ei)}),Jn.decrease(Oe.nodes()[0],0);for(var Fa=!1;Jn.size()>0;){var ui;if(Lr=Jn.removeMin(),Bn.has(Lr))Hn.setEdge(Lr,Bn.get(Lr));else{if(Fa)throw new Error("Input graph is not connected: "+Oe.graph());Fa=!0}(ui=Oe.nodeEdges(Lr))===null||ui===void 0||ui.forEach(ya)}return Hn},Re=fe,He=function(Oe){var hn=new Set,Hn=[],Bn=Oe.nodes();return Bn.forEach(function(Jn){for(var Lr=[],ya=[Jn];ya.length>0;){var Fa=ya.pop();if(!hn.has(Fa)){var ui,Ei;hn.add(Fa),Lr.push(Fa),(ui=Oe.successors(Fa))===null||ui===void 0||ui.forEach(function(oo){return ya.push(oo)}),(Ei=Oe.predecessors(Fa))===null||Ei===void 0||Ei.forEach(function(oo){return ya.push(oo)})}}Lr.length&&Hn.push(Lr)}),Hn},pe=He,Ge=function un(Oe,hn,Hn,Bn,Jn,Lr){Bn.includes(hn)||(Bn.push(hn),Hn||Lr.push(hn),Jn(hn).forEach(function(ya){return un(Oe,ya,Hn,Bn,Jn,Lr)}),Hn&&Lr.push(hn))},te=function(Oe,hn,Hn){var Bn=Array.isArray(hn)?hn:[hn],Jn=function(ui){return Oe.isDirected()?Oe.successors(ui):Oe.neighbors(ui)},Lr=[],ya=[];return Bn.forEach(function(Fa){if(Oe.hasNode(Fa))Ge(Oe,Fa,Hn==="post",ya,Jn,Lr);else throw new Error("Graph does not have node: "+Fa)}),Lr},Me=te;function We(un,Oe){return tn(un)||Ne(un,Oe)||Pt(un,Oe)||ee()}function ee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pt(un,Oe){if(!!un){if(typeof un=="string")return yt(un,Oe);var hn=Object.prototype.toString.call(un).slice(8,-1);if(hn==="Object"&&un.constructor&&(hn=un.constructor.name),hn==="Map"||hn==="Set")return Array.from(un);if(hn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(hn))return yt(un,Oe)}}function yt(un,Oe){(Oe==null||Oe>un.length)&&(Oe=un.length);for(var hn=0,Hn=new Array(Oe);hn<Oe;hn++)Hn[hn]=un[hn];return Hn}function Ne(un,Oe){var hn=un==null?null:typeof Symbol!="undefined"&&un[Symbol.iterator]||un["@@iterator"];if(hn!=null){var Hn=[],Bn=!0,Jn=!1,Lr,ya;try{for(hn=hn.call(un);!(Bn=(Lr=hn.next()).done)&&(Hn.push(Lr.value),!(Oe&&Hn.length===Oe));Bn=!0);}catch(Fa){Jn=!0,ya=Fa}finally{try{!Bn&&hn.return!=null&&hn.return()}finally{if(Jn)throw ya}}return Hn}}function tn(un){if(Array.isArray(un))return un}var fn=function(){return 1},Rt=function(Oe,hn,Hn,Bn){return Yn(Oe,hn,Hn||fn,Bn||function(Jn){return Oe.outEdges(Jn)})},Yn=function(Oe,hn,Hn,Bn){var Jn=new Map,Lr=new Ze,ya,Fa,ui=function(po){var bo=po.v!==ya?po.v:po.w,ts=Jn.get(bo),Wo=Hn(po),Yi=Fa.distance+Wo;if(Wo<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+po+" Weight: "+Wo);Yi<ts.distance&&(ts.distance=Yi,ts.predecessor=ya,Lr.decrease(bo,Yi))};for(Oe.nodes().forEach(function(oo){var po=oo===hn?0:Number.POSITIVE_INFINITY;Jn.set(oo,{distance:po}),Lr.add(oo,po)});Lr.size()>0&&(ya=Lr.removeMin(),Fa=Jn.get(ya),!(Fa&&Fa.distance===Number.POSITIVE_INFINITY));)Bn(ya).forEach(ui);var Ei={};return Array.from(Jn.entries()).forEach(function(oo){var po=We(oo,2),bo=po[0],ts=po[1];return Ei[String(bo)]=ts,Ei}),Ei},Un=Rt,xr=function(Oe,hn,Hn){var Bn={};return Oe.nodes().forEach(function(Jn){return Bn[String(Jn)]=Un(Oe,Jn,hn,Hn),Bn}),Bn},cr=xr,Ur=function(Oe){var hn=0,Hn=[],Bn=new Map,Jn=[];function Lr(ya){var Fa,ui={onStack:!0,lowlink:hn,index:hn};if(Bn.set(ya,ui),hn+=1,Hn.push(ya),(Fa=Oe.successors(ya))===null||Fa===void 0||Fa.forEach(function(bo){var ts;if(Bn.has(bo)){if((ts=Bn.get(bo))===null||ts===void 0?void 0:ts.onStack){var Yi=Bn.get(bo);ui.lowlink=Math.min(ui.lowlink,Yi.index)}}else{Lr(bo);var Wo=Bn.get(bo);ui.lowlink=Math.min(ui.lowlink,Wo.lowlink)}}),ui.lowlink===ui.index){var Ei=[],oo;do{oo=Hn.pop();var po=Bn.get(oo);po.onStack=!1,Ei.push(oo)}while(ya!==oo);Jn.push(Ei)}}return Oe.nodes().forEach(function(ya){Bn.has(ya)||Lr(ya)}),Jn},fa=Ur,Sa=function(Oe){return fa(Oe).filter(function(hn){return hn.length>1||hn.length===1&&Oe.hasEdge(hn[0],hn[0])})},sa=Sa;function Da(un){return Da=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Oe){return typeof Oe}:function(Oe){return Oe&&typeof Symbol=="function"&&Oe.constructor===Symbol&&Oe!==Symbol.prototype?"symbol":typeof Oe},Da(un)}function Rr(un,Oe){for(var hn=0;hn<Oe.length;hn++){var Hn=Oe[hn];Hn.enumerable=Hn.enumerable||!1,Hn.configurable=!0,"value"in Hn&&(Hn.writable=!0),Object.defineProperty(un,Hn.key,Hn)}}function Mn(un,Oe,hn){return Oe&&Rr(un.prototype,Oe),hn&&Rr(un,hn),Object.defineProperty(un,"prototype",{writable:!1}),un}function ar(un,Oe){if(!(un instanceof Oe))throw new TypeError("Cannot call a class as a function")}function Fn(un,Oe){if(typeof Oe!="function"&&Oe!==null)throw new TypeError("Super expression must either be null or a function");un.prototype=Object.create(Oe&&Oe.prototype,{constructor:{value:un,writable:!0,configurable:!0}}),Object.defineProperty(un,"prototype",{writable:!1}),Oe&&vr(un,Oe)}function tr(un){var Oe=lr();return function(){var Hn=Tr(un),Bn;if(Oe){var Jn=Tr(this).constructor;Bn=Reflect.construct(Hn,arguments,Jn)}else Bn=Hn.apply(this,arguments);return Gn(this,Bn)}}function Gn(un,Oe){if(Oe&&(Da(Oe)==="object"||typeof Oe=="function"))return Oe;if(Oe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jr(un)}function jr(un){if(un===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return un}function Hr(un){var Oe=typeof Map=="function"?new Map:void 0;return Hr=function(Hn){if(Hn===null||!Cr(Hn))return Hn;if(typeof Hn!="function")throw new TypeError("Super expression must either be null or a function");if(typeof Oe!="undefined"){if(Oe.has(Hn))return Oe.get(Hn);Oe.set(Hn,Bn)}function Bn(){return Ea(Hn,arguments,Tr(this).constructor)}return Bn.prototype=Object.create(Hn.prototype,{constructor:{value:Bn,enumerable:!1,writable:!0,configurable:!0}}),vr(Bn,Hn)},Hr(un)}function Ea(un,Oe,hn){return lr()?Ea=Reflect.construct:Ea=function(Bn,Jn,Lr){var ya=[null];ya.push.apply(ya,Jn);var Fa=Function.bind.apply(Bn,ya),ui=new Fa;return Lr&&vr(ui,Lr.prototype),ui},Ea.apply(null,arguments)}function lr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(un){return!1}}function Cr(un){return Function.toString.call(un).indexOf("[native code]")!==-1}function vr(un,Oe){return vr=Object.setPrototypeOf||function(Hn,Bn){return Hn.__proto__=Bn,Hn},vr(un,Oe)}function Tr(un){return Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(hn){return hn.__proto__||Object.getPrototypeOf(hn)},Tr(un)}var ta=function(un){Fn(hn,un);var Oe=tr(hn);function hn(){return ar(this,hn),Oe.apply(this,arguments)}return Mn(hn)}(Hr(Error));function ra(un){var Oe=new Set,hn=new Set,Hn=[];function Bn(Jn){if(hn.has(Jn))throw new ta;if(!Oe.has(Jn)){var Lr;hn.add(Jn),Oe.add(Jn),(Lr=un.predecessors(Jn))===null||Lr===void 0||Lr.forEach(Bn),hn.delete(Jn),Hn.push(Jn)}}if(un.sinks().forEach(Bn),Oe.size!==un.nodeCount())throw new ta;return Hn}var Zr=ra,vt=function(Oe){try{Zr(Oe)}catch(hn){if(hn instanceof ta)return!1;throw hn}return!0},_n=vt,an=function(Oe,hn){return Me(Oe,hn,"post")},Lt=an,kt=function(Oe,hn){return Me(Oe,hn,"pre")},at=kt,H=function(){return 1};function Y(un,Oe,hn){return bt(un,Oe||H,hn||function(Hn){return un.outEdges(Hn)})}function bt(un,Oe,hn){var Hn={},Bn=un.nodes();return Bn.forEach(function(Jn){var Lr=String(Jn);Hn[Lr]={},Hn[Lr][Lr]={distance:0},Bn.forEach(function(ya){Jn!==ya&&(Hn[Lr][String(ya)]={distance:Number.POSITIVE_INFINITY})}),hn(Jn).forEach(function(ya){var Fa=ya.v===Jn?ya.w:ya.v,ui=Oe(ya);Hn[Lr][String(Fa)]={distance:ui,predecessor:Jn}})}),Bn.forEach(function(Jn){var Lr=String(Jn),ya=Hn[Lr];Bn.forEach(function(Fa){var ui=String(Fa),Ei=Hn[ui];Bn.forEach(function(oo){var po=String(oo),bo=Ei[Lr],ts=ya[po],Wo=Ei[po],Yi=bo.distance+ts.distance;Yi<Wo.distance&&(Wo.distance=Yi,Wo.predecessor=ts.predecessor)})})}),Hn}var $t=Y,jt=function(Oe,hn){for(var Hn=Oe.nodes(),Bn=0;Bn<Hn.length;Bn++){var Jn=Hn[Bn];if(hn.hasNode(Jn))return!0}return!1},Ht=function(Oe,hn){for(var Hn=Oe.edges(),Bn=0;Bn<Hn.length;Bn++){var Jn=Hn[Bn];if(hn.hasEdge(Jn.v,Jn.w,Jn.name))return!0}return!1},re=function(Oe,hn){var Hn=Oe.nodes(),Bn=Hn.filter(function(Jn){return hn.hasNode(Jn)});return Bn},on=function(Oe,hn){var Hn=Oe.edges(),Bn=Hn.filter(function(Jn){return hn.hasEdge(Jn.v,Jn.w,Jn.name)});return Bn},Je=function(Oe,hn){return Oe.isCompound()===hn.isCompound()&&Oe.isDirected()===hn.isDirected()&&Oe.isMultigraph()===hn.isMultigraph()},Ve=function(Oe,hn){var Hn=re(Oe,hn);return Hn.length===Oe.nodes().length},qn=function(Oe,hn){var Hn=on(Oe,hn);return Hn.length===Oe.edges().length},Ln=function(Oe,hn){return Je(Oe,hn)&&Oe.nodeCount()===hn.nodeCount()&&Ve(Oe,hn)&&Oe.edgeCount()===hn.edgeCount()&&qn(Oe,hn)},qr=function(Oe,hn){return Ve(Oe,hn)&&qn(Oe,hn)};function Ca(un,Oe){return ha(un)||La(un,Oe)||_r(un,Oe)||Qn()}function Qn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _r(un,Oe){if(!!un){if(typeof un=="string")return ea(un,Oe);var hn=Object.prototype.toString.call(un).slice(8,-1);if(hn==="Object"&&un.constructor&&(hn=un.constructor.name),hn==="Map"||hn==="Set")return Array.from(un);if(hn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(hn))return ea(un,Oe)}}function ea(un,Oe){(Oe==null||Oe>un.length)&&(Oe=un.length);for(var hn=0,Hn=new Array(Oe);hn<Oe;hn++)Hn[hn]=un[hn];return Hn}function La(un,Oe){var hn=un==null?null:typeof Symbol!="undefined"&&un[Symbol.iterator]||un["@@iterator"];if(hn!=null){var Hn=[],Bn=!0,Jn=!1,Lr,ya;try{for(hn=hn.call(un);!(Bn=(Lr=hn.next()).done)&&(Hn.push(Lr.value),!(Oe&&Hn.length===Oe));Bn=!0);}catch(Fa){Jn=!0,ya=Fa}finally{try{!Bn&&hn.return!=null&&hn.return()}finally{if(Jn)throw ya}}return Hn}}function ha(un){if(Array.isArray(un))return un}function _i(un){return un instanceof gt}function Ni(un){if(un.isMultigraph())return!1;for(var Oe=un.edges(),hn=new Map,Hn=0;Hn<Oe.length;Hn++){var Bn=Oe[Hn];if(Bn.v===Bn.w)return!1;var Jn=[Bn.v,Bn.w].sort(),Lr=Ca(Jn,2),ya=Lr[0],Fa=Lr[1],ui="".concat(ya,"-").concat(Fa);if(hn.has(ui))return!1;hn.set(ui,!0)}return!0}function vi(un){return un.nodes().length===0}function si(un){for(var Oe=un.edges(),hn=0;hn<Oe.length;hn++){var Hn=Oe[hn];if(Hn.v===Hn.w)return!0}return!1}var Mi=function(Oe,hn){if(!Ni(Oe)||!Ni(hn)||!Ve(Oe,hn)||Ht(Oe,hn))return!1;var Hn=Oe.nodeCount();return Oe.edgeCount()+hn.edgeCount()===Hn*(Hn-1)/2},Pa=function(Oe){if(!Ni(Oe))return null;for(var hn=Oe.nodeCount(),Hn=new gt({compound:Oe.isCompound(),directed:Oe.isDirected(),multigraph:Oe.isMultigraph()}),Bn=Oe.nodes(),Jn=0;Jn<hn;Jn++){var Lr=Bn[Jn];Hn.setNode(Lr,Oe.node(Lr));for(var ya=Jn+1;ya<hn;ya++){var Fa=Bn[ya];Oe.hasEdge(Lr,Fa)||Hn.setEdge(Lr,Fa)}}return Hn}},81746:function(sr){(function($,X){sr.exports=X()})(typeof self!="undefined"?self:this,function(){return function(it){var $={};function X(tt){if($[tt])return $[tt].exports;var j=$[tt]={i:tt,l:!1,exports:{}};return it[tt].call(j.exports,j,j.exports,X),j.l=!0,j.exports}return X.m=it,X.c=$,X.d=function(tt,j,W){X.o(tt,j)||Object.defineProperty(tt,j,{configurable:!1,enumerable:!0,get:W})},X.n=function(tt){var j=tt&&tt.__esModule?function(){return tt.default}:function(){return tt};return X.d(j,"a",j),j},X.o=function(tt,j){return Object.prototype.hasOwnProperty.call(tt,j)},X.p="",X(X.s=36)}([function(it,$,X){"use strict";var tt=X(3);$.a=function(j){return Array.isArray?Array.isArray(j):Object(tt.a)(j,"Array")}},function(it,$,X){"use strict";var tt=function(j){return j!==null&&typeof j!="function"&&isFinite(j.length)};$.a=tt},function(it,$,X){"use strict";var tt=X(3);$.a=function(j){return Object(tt.a)(j,"Function")}},function(it,$,X){"use strict";var tt={}.toString,j=function(W,Q){return tt.call(W)==="[object "+Q+"]"};$.a=j},function(it,$,X){"use strict";var tt=X(3);$.a=function(j){return Object(tt.a)(j,"String")}},function(it,$,X){"use strict";var tt=X(3),j=function(W){return Object(tt.a)(W,"Number")};$.a=j},function(it,$,X){var tt=X(38),j=tt.mix;function W(Q,Z,L,P){return P===void 0&&(P="height"),L==="center"?(Q[P]+Z[P])/2:Q.height}it.exports={assign:j,getHeight:W}},function(it,$,X){"use strict";var tt=function(j){return j==null};$.a=tt},function(it,$,X){"use strict";var tt=X(0),j=X(12);function W(Q,Z){if(!!Q){var L;if(Object(tt.a)(Q))for(var P=0,C=Q.length;P<C&&(L=Z(Q[P],P),L!==!1);P++);else if(Object(j.a)(Q)){for(var M in Q)if(Q.hasOwnProperty(M)&&(L=Z(Q[M],M),L===!1))break}}}$.a=W},function(it,$,X){"use strict";var tt=X(7);$.a=function(j){return Object(tt.a)(j)?"":j.toString()}},function(it,$,X){"use strict";var tt=X(14),j=X(3),W=function(Q){if(!Object(tt.a)(Q)||!Object(j.a)(Q,"Object"))return!1;if(Object.getPrototypeOf(Q)===null)return!0;for(var Z=Q;Object.getPrototypeOf(Z)!==null;)Z=Object.getPrototypeOf(Z);return Object.getPrototypeOf(Q)===Z};$.a=W},function(it,$,X){var tt=X(18),j=function(){function W(Z,L){L===void 0&&(L={});var P=this;P.options=L,P.rootNode=tt(Z,L)}var Q=W.prototype;return Q.execute=function(){throw new Error("please override this method")},W}();it.exports=j},function(it,$,X){"use strict";$.a=function(tt){var j=typeof tt;return tt!==null&&j==="object"||j==="function"}},function(it,$,X){"use strict";var tt=X(1),j=function(W,Q){return Object(tt.a)(W)?W.indexOf(Q)>-1:!1};$.a=j},function(it,$,X){"use strict";var tt=function(j){return typeof j=="object"&&j!==null};$.a=tt},function(it,$,X){"use strict";var tt=X(8),j=X(2),W=Object.values?function(Q){return Object.values(Q)}:function(Q){var Z=[];return Object(tt.a)(Q,function(L,P){Object(j.a)(Q)&&P==="prototype"||Z.push(L)}),Z};$.a=W},function(it,$,X){"use strict";$.a=j;function tt(W,Q){for(var Z in Q)Q.hasOwnProperty(Z)&&Z!=="constructor"&&Q[Z]!==void 0&&(W[Z]=Q[Z])}function j(W,Q,Z,L){return Q&&tt(W,Q),Z&&tt(W,Z),L&&tt(W,L),W}},function(it,$,X){var tt=X(35),j=["LR","RL","TB","BT","H","V"],W=["LR","RL","H"],Q=function(P){return W.indexOf(P)>-1},Z=j[0];it.exports=function(L,P,C){var M=P.direction||Z;if(P.isHorizontal=Q(M),M&&j.indexOf(M)===-1)throw new TypeError("Invalid direction: "+M);if(M===j[0])C(L,P);else if(M===j[1])C(L,P),L.right2left();else if(M===j[2])C(L,P);else if(M===j[3])C(L,P),L.bottom2top();else if(M===j[4]||M===j[5]){var k=tt(L,P),B=k.left,R=k.right;C(B,P),C(R,P),P.isHorizontal?B.right2left():B.bottom2top(),R.translate(B.x-R.x,B.y-R.y),L.x=B.x,L.y=R.y;var F=L.getBoundingBox();P.isHorizontal?F.top<0&&L.translate(0,-F.top):F.left<0&&L.translate(-F.left,0)}var K=P.fixedRoot;return K===void 0&&(K=!0),K&&L.translate(-(L.x+L.width/2+L.hgap),-(L.y+L.height/2+L.vgap)),L}},function(it,$,X){var tt=X(6),j=18,W=j*2,Q=j,Z={getId:function(M){return M.id||M.name},getPreH:function(M){return M.preH||0},getPreV:function(M){return M.preV||0},getHGap:function(M){return M.hgap||Q},getVGap:function(M){return M.vgap||Q},getChildren:function(M){return M.children},getHeight:function(M){return M.height||W},getWidth:function(M){var k=M.label||" ";return M.width||k.split("").length*j}};function L(C,M){var k=this;if(k.vgap=k.hgap=0,C instanceof L)return C;k.data=C;var B=M.getHGap(C),R=M.getVGap(C);return k.preH=M.getPreH(C),k.preV=M.getPreV(C),k.width=M.getWidth(C),k.height=M.getHeight(C),k.width+=k.preH,k.height+=k.preV,k.id=M.getId(C),k.x=k.y=0,k.depth=0,k.children||(k.children=[]),k.addGap(B,R),k}tt.assign(L.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(M,k){var B=this;B.hgap+=M,B.vgap+=k,B.width+=2*M,B.height+=2*k},eachNode:function(M){for(var k=this,B=[k],R;R=B.shift();)M(R),B=R.children.concat(B)},DFTraverse:function(M){this.eachNode(M)},BFTraverse:function(M){for(var k=this,B=[k],R;R=B.shift();)M(R),B=B.concat(R.children)},getBoundingBox:function(){var M={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(k){M.left=Math.min(M.left,k.x),M.top=Math.min(M.top,k.y),M.width=Math.max(M.width,k.x+k.width),M.height=Math.max(M.height,k.y+k.height)}),M},translate:function(M,k){M===void 0&&(M=0),k===void 0&&(k=0),this.eachNode(function(B){B.x+=M,B.y+=k,B.x+=B.preH,B.y+=B.preV})},right2left:function(){var M=this,k=M.getBoundingBox();M.eachNode(function(B){B.x=B.x-(B.x-k.left)*2-B.width}),M.translate(k.width,0)},bottom2top:function(){var M=this,k=M.getBoundingBox();M.eachNode(function(B){B.y=B.y-(B.y-k.top)*2-B.height}),M.translate(0,k.height)}});function P(C,M,k){M===void 0&&(M={}),M=tt.assign({},Z,M);var B=new L(C,M),R=[B],F;if(!k&&!C.collapsed){for(;F=R.shift();)if(!F.data.collapsed){var K=M.getChildren(F.data),O=K?K.length:0;if(F.children=new Array(O),K&&O)for(var _=0;_<O;_++){var ft=new L(K[_],M);F.children[_]=ft,R.push(ft),ft.parent=F,ft.depth=F.depth+1}}}return B}it.exports=P},function(it,$,X){"use strict";var tt=X(1),j=function(W,Q){if(!Object(tt.a)(W))return W;for(var Z=[],L=0;L<W.length;L++){var P=W[L];Q(P,L)&&Z.push(P)}return Z};$.a=j},function(it,$,X){"use strict";var tt=X(7),j=X(21);function W(Q,Z){var L=Object(j.a)(Z),P=L.length;if(Object(tt.a)(Q))return!P;for(var C=0;C<P;C+=1){var M=L[C];if(Z[M]!==Q[M]||!(M in Q))return!1}return!0}$.a=W},function(it,$,X){"use strict";var tt=X(8),j=X(2),W=Object.keys?function(Q){return Object.keys(Q)}:function(Q){var Z=[];return Object(tt.a)(Q,function(L,P){Object(j.a)(Q)&&P==="prototype"||Z.push(P)}),Z};$.a=W},function(it,$,X){"use strict";var tt=X(0);$.a=function(j){if(!!Object(tt.a)(j))return j.reduce(function(W,Q){return Math.max(W,Q)},j[0])}},function(it,$,X){"use strict";var tt=X(0);$.a=function(j){if(!!Object(tt.a)(j))return j.reduce(function(W,Q){return Math.min(W,Q)},j[0])}},function(it,$,X){"use strict";var tt=X(1),j=Array.prototype.splice,W=function(Z,L){if(!Object(tt.a)(Z))return[];for(var P=Z?L.length:0,C=P-1;P--;){var M=void 0,k=L[P];(P===C||k!==M)&&(M=k,j.call(Z,k,1))}return Z};$.a=W},function(it,$,X){"use strict";var tt=X(8),j=X(0),W=X(10),Q=function(Z,L,P){if(!Object(j.a)(Z)&&!Object(W.a)(Z))return Z;var C=P;return Object(tt.a)(Z,function(M,k){C=L(C,M,k)}),C};$.a=Q},function(it,$,X){"use strict";$.a=tt;function tt(j,W){W===void 0&&(W=new Map);var Q=[];if(Array.isArray(j))for(var Z=0,L=j.length;Z<L;Z++){var P=j[Z];W.has(P)||(Q.push(P),W.set(P,!0))}return Q}},function(it,$,X){"use strict";$.a=Q;var tt=X(0),j=X(2),W=X(28);function Q(Z,L){if(!L)return{0:Z};if(!Object(j.a)(L)){var P=Object(tt.a)(L)?L:L.replace(/\s+/g,"").split("*");L=function(C){for(var M="_",k=0,B=P.length;k<B;k++)M+=C[P[k]]&&C[P[k]].toString();return M}}return Object(W.a)(Z,L)}},function(it,$,X){"use strict";var tt=X(0),j=X(2),W=Object.prototype.hasOwnProperty;function Q(Z,L){if(!L||!Object(tt.a)(Z))return{};for(var P={},C=Object(j.a)(L)?L:function(R){return R[L]},M,k=0;k<Z.length;k++){var B=Z[k];M=C(B),W.call(P,M)?P[M].push(B):P[M]=[B]}return P}$.a=Q},function(it,$,X){"use strict";$.a=function(tt,j){return tt.hasOwnProperty(j)}},function(it,$,X){"use strict";var tt={}.toString,j=function(W){return tt.call(W).replace(/^\[object /,"").replace(/]$/,"")};$.a=j},function(it,$,X){"use strict";var tt=Object.prototype,j=function(W){var Q=W&&W.constructor,Z=typeof Q=="function"&&Q.prototype||tt;return W===Z};$.a=j},function(it,$,X){"use strict";var tt=X(2);$.a=function(j,W){if(!Object(tt.a)(j))throw new TypeError("Expected a function");var Q=function(){for(var Z=[],L=0;L<arguments.length;L++)Z[L]=arguments[L];var P=W?W.apply(this,Z):Z[0],C=Q.cache;if(C.has(P))return C.get(P);var M=j.apply(this,Z);return C.set(P,M),M};return Q.cache=new Map,Q}},function(it,$,X){"use strict";var tt=X(14),j=X(1),W=X(4),Q=function(Z,L){if(Z===L)return!0;if(!Z||!L||Object(W.a)(Z)||Object(W.a)(L))return!1;if(Object(j.a)(Z)||Object(j.a)(L)){if(Z.length!==L.length)return!1;for(var P=!0,C=0;C<Z.length&&(P=Q(Z[C],L[C]),!!P);C++);return P}if(Object(tt.a)(Z)||Object(tt.a)(L)){var M=Object.keys(Z),k=Object.keys(L);if(M.length!==k.length)return!1;for(var P=!0,C=0;C<M.length&&(P=Q(Z[M[C]],L[M[C]]),!!P);C++);return P}return!1};$.a=Q},function(it,$,X){"use strict";var tt=X(116),j=X(15),W=X(32),Q=X(4),Z;$.a=Object(W.a)(function(L,P){P===void 0&&(P={});var C=P.fontSize,M=P.fontFamily,k=P.fontWeight,B=P.fontStyle,R=P.fontVariant;return Z||(Z=document.createElement("canvas").getContext("2d")),Z.font=[B,R,k,C+"px",M].join(" "),Z.measureText(Object(Q.a)(L)?L:"").width},function(L,P){return P===void 0&&(P={}),Object(tt.a)([L],Object(j.a)(P)).join("")})},function(it,$,X){var tt=X(18);it.exports=function(j,W){for(var Q=tt(j.data,W,!0),Z=tt(j.data,W,!0),L=j.children.length,P=Math.round(L/2),C=W.getSide||function(R,F){return F<P?"right":"left"},M=0;M<L;M++){var k=j.children[M],B=C(k,M);B==="right"?Z.children.push(k):Q.children.push(k)}return Q.eachNode(function(R){R.isRoot()||(R.side="left")}),Z.eachNode(function(R){R.isRoot()||(R.side="right")}),{left:Q,right:Z}}},function(it,$,X){var tt={compactBox:X(37),dendrogram:X(120),indented:X(122),mindmap:X(124)};it.exports=tt},function(it,$,X){function tt(k,B){k.prototype=Object.create(B.prototype),k.prototype.constructor=k,j(k,B)}function j(k,B){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(F,K){return F.__proto__=K,F},j(k,B)}var W=X(11),Q=X(119),Z=X(17),L=X(6),P=function(k){tt(B,k);function B(){return k.apply(this,arguments)||this}var R=B.prototype;return R.execute=function(){var K=this;return Z(K.rootNode,K.options,Q)},B}(W),C={};function M(k,B){return B=L.assign({},C,B),new P(k,B).execute()}it.exports=M},function(it,$,X){"use strict";Object.defineProperty($,"__esModule",{value:!0});var tt=X(13);X.d($,"contains",function(){return tt.a}),X.d($,"includes",function(){return tt.a});var j=X(39);X.d($,"difference",function(){return j.a});var W=X(40);X.d($,"find",function(){return W.a});var Q=X(41);X.d($,"findIndex",function(){return Q.a});var Z=X(42);X.d($,"firstValue",function(){return Z.a});var L=X(43);X.d($,"flatten",function(){return L.a});var P=X(44);X.d($,"flattenDeep",function(){return P.a});var C=X(45);X.d($,"getRange",function(){return C.a});var M=X(46);X.d($,"pull",function(){return M.a});var k=X(24);X.d($,"pullAt",function(){return k.a});var B=X(25);X.d($,"reduce",function(){return B.a});var R=X(47);X.d($,"remove",function(){return R.a});var F=X(48);X.d($,"sortBy",function(){return F.a});var K=X(49);X.d($,"union",function(){return K.a});var O=X(26);X.d($,"uniq",function(){return O.a});var _=X(50);X.d($,"valuesOfKey",function(){return _.a});var ft=X(51);X.d($,"head",function(){return ft.a});var mt=X(52);X.d($,"last",function(){return mt.a});var st=X(53);X.d($,"startsWith",function(){return st.a});var ut=X(54);X.d($,"endsWith",function(){return ut.a});var dt=X(19);X.d($,"filter",function(){return dt.a});var gt=X(55);X.d($,"every",function(){return gt.a});var wt=X(56);X.d($,"some",function(){return wt.a});var ot=X(57);X.d($,"group",function(){return ot.a});var pt=X(28);X.d($,"groupBy",function(){return pt.a});var Nt=X(27);X.d($,"groupToMap",function(){return Nt.a});var Gt=X(58);X.d($,"getWrapBehavior",function(){return Gt.a});var se=X(59);X.d($,"wrapBehavior",function(){return se.a});var ie=X(60);X.d($,"number2color",function(){return ie.a});var Be=X(61);X.d($,"parseRadius",function(){return Be.a});var ke=X(62);X.d($,"clamp",function(){return ke.a});var we=X(63);X.d($,"fixedBase",function(){return we.a});var At=X(64);X.d($,"isDecimal",function(){return At.a});var Yt=X(65);X.d($,"isEven",function(){return Yt.a});var be=X(66);X.d($,"isInteger",function(){return be.a});var nn=X(67);X.d($,"isNegative",function(){return nn.a});var Ee=X(68);X.d($,"isNumberEqual",function(){return Ee.a});var le=X(69);X.d($,"isOdd",function(){return le.a});var Le=X(70);X.d($,"isPositive",function(){return Le.a});var Ze=X(22);X.d($,"max",function(){return Ze.a});var fe=X(71);X.d($,"maxBy",function(){return fe.a});var Re=X(23);X.d($,"min",function(){return Re.a});var He=X(72);X.d($,"minBy",function(){return He.a});var pe=X(73);X.d($,"mod",function(){return pe.a});var Ge=X(74);X.d($,"toDegree",function(){return Ge.a});var te=X(75);X.d($,"toInteger",function(){return te.a});var Me=X(76);X.d($,"toRadian",function(){return Me.a});var We=X(77);X.d($,"forIn",function(){return We.a});var ee=X(29);X.d($,"has",function(){return ee.a});var Pt=X(78);X.d($,"hasKey",function(){return Pt.a});var yt=X(79);X.d($,"hasValue",function(){return yt.a});var Ne=X(21);X.d($,"keys",function(){return Ne.a});var tn=X(20);X.d($,"isMatch",function(){return tn.a});var fn=X(15);X.d($,"values",function(){return fn.a});var Rt=X(80);X.d($,"lowerCase",function(){return Rt.a});var Yn=X(81);X.d($,"lowerFirst",function(){return Yn.a});var Un=X(82);X.d($,"substitute",function(){return Un.a});var xr=X(83);X.d($,"upperCase",function(){return xr.a});var cr=X(84);X.d($,"upperFirst",function(){return cr.a});var Ur=X(30);X.d($,"getType",function(){return Ur.a});var fa=X(85);X.d($,"isArguments",function(){return fa.a});var Sa=X(0);X.d($,"isArray",function(){return Sa.a});var sa=X(1);X.d($,"isArrayLike",function(){return sa.a});var Da=X(86);X.d($,"isBoolean",function(){return Da.a});var Rr=X(87);X.d($,"isDate",function(){return Rr.a});var Mn=X(88);X.d($,"isError",function(){return Mn.a});var ar=X(2);X.d($,"isFunction",function(){return ar.a});var Fn=X(89);X.d($,"isFinite",function(){return Fn.a});var tr=X(7);X.d($,"isNil",function(){return tr.a});var Gn=X(90);X.d($,"isNull",function(){return Gn.a});var jr=X(5);X.d($,"isNumber",function(){return jr.a});var Hr=X(12);X.d($,"isObject",function(){return Hr.a});var Ea=X(14);X.d($,"isObjectLike",function(){return Ea.a});var lr=X(10);X.d($,"isPlainObject",function(){return lr.a});var Cr=X(31);X.d($,"isPrototype",function(){return Cr.a});var vr=X(91);X.d($,"isRegExp",function(){return vr.a});var Tr=X(4);X.d($,"isString",function(){return Tr.a});var ta=X(3);X.d($,"isType",function(){return ta.a});var ra=X(92);X.d($,"isUndefined",function(){return ra.a});var Zr=X(93);X.d($,"isElement",function(){return Zr.a});var vt=X(94);X.d($,"requestAnimationFrame",function(){return vt.a});var _n=X(95);X.d($,"clearAnimationFrame",function(){return _n.a});var an=X(96);X.d($,"augment",function(){return an.a});var Lt=X(97);X.d($,"clone",function(){return Lt.a});var kt=X(98);X.d($,"debounce",function(){return kt.a});var at=X(32);X.d($,"memoize",function(){return at.a});var H=X(99);X.d($,"deepMix",function(){return H.a});var Y=X(8);X.d($,"each",function(){return Y.a});var bt=X(100);X.d($,"extend",function(){return bt.a});var $t=X(101);X.d($,"indexOf",function(){return $t.a});var jt=X(102);X.d($,"isEmpty",function(){return jt.a});var Ht=X(33);X.d($,"isEqual",function(){return Ht.a});var re=X(103);X.d($,"isEqualWith",function(){return re.a});var on=X(104);X.d($,"map",function(){return on.a});var Je=X(105);X.d($,"mapValues",function(){return Je.a});var Ve=X(16);X.d($,"mix",function(){return Ve.a}),X.d($,"assign",function(){return Ve.a});var qn=X(106);X.d($,"get",function(){return qn.a});var Ln=X(107);X.d($,"set",function(){return Ln.a});var qr=X(108);X.d($,"pick",function(){return qr.a});var Ca=X(109);X.d($,"omit",function(){return Ca.a});var Qn=X(110);X.d($,"throttle",function(){return Qn.a});var _r=X(111);X.d($,"toArray",function(){return _r.a});var ea=X(9);X.d($,"toString",function(){return ea.a});var La=X(112);X.d($,"uniqueId",function(){return La.a});var ha=X(113);X.d($,"noop",function(){return ha.a});var _i=X(114);X.d($,"identity",function(){return _i.a});var Ni=X(115);X.d($,"size",function(){return Ni.a});var vi=X(34);X.d($,"measureTextWidth",function(){return vi.a});var si=X(117);X.d($,"getEllipsisText",function(){return si.a});var Mi=X(118);X.d($,"Cache",function(){return Mi.a})},function(it,$,X){"use strict";var tt=X(19),j=X(13),W=function(Q,Z){return Z===void 0&&(Z=[]),Object(tt.a)(Q,function(L){return!Object(j.a)(Z,L)})};$.a=W},function(it,$,X){"use strict";var tt=X(2),j=X(20),W=X(0),Q=X(10);function Z(L,P){if(!Object(W.a)(L))return null;var C;if(Object(tt.a)(P)&&(C=P),Object(Q.a)(P)&&(C=function(k){return Object(j.a)(k,P)}),C){for(var M=0;M<L.length;M+=1)if(C(L[M]))return L[M]}return null}$.a=Z},function(it,$,X){"use strict";function tt(j,W,Q){Q===void 0&&(Q=0);for(var Z=Q;Z<j.length;Z++)if(W(j[Z],Z))return Z;return-1}$.a=tt},function(it,$,X){"use strict";var tt=X(7),j=X(0),W=function(Q,Z){for(var L=null,P=0;P<Q.length;P++){var C=Q[P],M=C[Z];if(!Object(tt.a)(M)){Object(j.a)(M)?L=M[0]:L=M;break}}return L};$.a=W},function(it,$,X){"use strict";var tt=X(0),j=function(W){if(!Object(tt.a)(W))return[];for(var Q=[],Z=0;Z<W.length;Z++)Q=Q.concat(W[Z]);return Q};$.a=j},function(it,$,X){"use strict";var tt=X(0),j=function(W,Q){if(Q===void 0&&(Q=[]),!Object(tt.a)(W))Q.push(W);else for(var Z=0;Z<W.length;Z+=1)j(W[Z],Q);return Q};$.a=j},function(it,$,X){"use strict";var tt=X(0),j=X(22),W=X(23),Q=function(Z){var L=Z.filter(function(B){return!isNaN(B)});if(!L.length)return{min:0,max:0};if(Object(tt.a)(Z[0])){for(var P=[],C=0;C<Z.length;C++)P=P.concat(Z[C]);L=P}var M=Object(j.a)(L),k=Object(W.a)(L);return{min:k,max:M}};$.a=Q},function(it,$,X){"use strict";var tt=Array.prototype,j=tt.splice,W=tt.indexOf,Q=function(Z){for(var L=[],P=1;P<arguments.length;P++)L[P-1]=arguments[P];for(var C=0;C<L.length;C++)for(var M=L[C],k=-1;(k=W.call(Z,M))>-1;)j.call(Z,k,1);return Z};$.a=Q},function(it,$,X){"use strict";var tt=X(1),j=X(24),W=function(Q,Z){var L=[];if(!Object(tt.a)(Q))return L;for(var P=-1,C=[],M=Q.length;++P<M;){var k=Q[P];Z(k,P,Q)&&(L.push(k),C.push(P))}return Object(j.a)(Q,C),L};$.a=W},function(it,$,X){"use strict";var tt=X(0),j=X(4),W=X(2);function Q(Z,L){var P;if(Object(W.a)(L))P=function(M,k){return L(M)-L(k)};else{var C=[];Object(j.a)(L)?C.push(L):Object(tt.a)(L)&&(C=L),P=function(M,k){for(var B=0;B<C.length;B+=1){var R=C[B];if(M[R]>k[R])return 1;if(M[R]<k[R])return-1}return 0}}return Z.sort(P),Z}$.a=Q},function(it,$,X){"use strict";var tt=X(26),j=function(){for(var W=[],Q=0;Q<arguments.length;Q++)W[Q]=arguments[Q];return Object(tt.a)([].concat.apply([],W))};$.a=j},function(it,$,X){"use strict";var tt=X(0),j=X(7);$.a=function(W,Q){for(var Z=[],L={},P=0;P<W.length;P++){var C=W[P],M=C[Q];if(!Object(j.a)(M)){Object(tt.a)(M)||(M=[M]);for(var k=0;k<M.length;k++){var B=M[k];L[B]||(Z.push(B),L[B]=!0)}}}return Z}},function(it,$,X){"use strict";$.a=j;var tt=X(1);function j(W){if(Object(tt.a)(W))return W[0]}},function(it,$,X){"use strict";$.a=j;var tt=X(1);function j(W){if(Object(tt.a)(W)){var Q=W;return Q[Q.length-1]}}},function(it,$,X){"use strict";var tt=X(0),j=X(4);function W(Q,Z){return Object(tt.a)(Q)||Object(j.a)(Q)?Q[0]===Z:!1}$.a=W},function(it,$,X){"use strict";var tt=X(0),j=X(4);function W(Q,Z){return Object(tt.a)(Q)||Object(j.a)(Q)?Q[Q.length-1]===Z:!1}$.a=W},function(it,$,X){"use strict";var tt=function(j,W){for(var Q=0;Q<j.length;Q++)if(!W(j[Q],Q))return!1;return!0};$.a=tt},function(it,$,X){"use strict";var tt=function(j,W){for(var Q=0;Q<j.length;Q++)if(W(j[Q],Q))return!0;return!1};$.a=tt},function(it,$,X){"use strict";var tt=X(27);$.a=function(j,W){if(!W)return[j];var Q=Object(tt.a)(j,W),Z=[];for(var L in Q)Z.push(Q[L]);return Z}},function(it,$,X){"use strict";function tt(j,W){return j["_wrap_"+W]}$.a=tt},function(it,$,X){"use strict";function tt(j,W){if(j["_wrap_"+W])return j["_wrap_"+W];var Q=function(Z){j[W](Z)};return j["_wrap_"+W]=Q,Q}$.a=tt},function(it,$,X){"use strict";var tt={};function j(W){var Q=tt[W];if(!Q){for(var Z=W.toString(16),L=Z.length;L<6;L++)Z="0"+Z;Q="#"+Z,tt[W]=Q}return Q}$.a=j},function(it,$,X){"use strict";var tt=X(0);function j(W){var Q=0,Z=0,L=0,P=0;return Object(tt.a)(W)?W.length===1?Q=Z=L=P=W[0]:W.length===2?(Q=L=W[0],Z=P=W[1]):W.length===3?(Q=W[0],Z=P=W[1],L=W[2]):(Q=W[0],Z=W[1],L=W[2],P=W[3]):Q=Z=L=P=W,{r1:Q,r2:Z,r3:L,r4:P}}$.a=j},function(it,$,X){"use strict";var tt=function(j,W,Q){return j<W?W:j>Q?Q:j};$.a=tt},function(it,$,X){"use strict";var tt=function(j,W){var Q=W.toString(),Z=Q.indexOf(".");if(Z===-1)return Math.round(j);var L=Q.substr(Z+1).length;return L>20&&(L=20),parseFloat(j.toFixed(L))};$.a=tt},function(it,$,X){"use strict";var tt=X(5),j=function(W){return Object(tt.a)(W)&&W%1!=0};$.a=j},function(it,$,X){"use strict";var tt=X(5),j=function(W){return Object(tt.a)(W)&&W%2==0};$.a=j},function(it,$,X){"use strict";var tt=X(5),j=Number.isInteger?Number.isInteger:function(W){return Object(tt.a)(W)&&W%1==0};$.a=j},function(it,$,X){"use strict";var tt=X(5),j=function(W){return Object(tt.a)(W)&&W<0};$.a=j},function(it,$,X){"use strict";$.a=j;var tt=1e-5;function j(W,Q,Z){return Z===void 0&&(Z=tt),Math.abs(W-Q)<Z}},function(it,$,X){"use strict";var tt=X(5),j=function(W){return Object(tt.a)(W)&&W%2!=0};$.a=j},function(it,$,X){"use strict";var tt=X(5),j=function(W){return Object(tt.a)(W)&&W>0};$.a=j},function(it,$,X){"use strict";var tt=X(0),j=X(2);$.a=function(W,Q){if(!!Object(tt.a)(W)){for(var Z,L=-Infinity,P=0;P<W.length;P++){var C=W[P],M=Object(j.a)(Q)?Q(C):C[Q];M>L&&(Z=C,L=M)}return Z}}},function(it,$,X){"use strict";var tt=X(0),j=X(2);$.a=function(W,Q){if(!!Object(tt.a)(W)){for(var Z,L=Infinity,P=0;P<W.length;P++){var C=W[P],M=Object(j.a)(Q)?Q(C):C[Q];M<L&&(Z=C,L=M)}return Z}}},function(it,$,X){"use strict";var tt=function(j,W){return(j%W+W)%W};$.a=tt},function(it,$,X){"use strict";var tt=180/Math.PI,j=function(W){return tt*W};$.a=j},function(it,$,X){"use strict";$.a=parseInt},function(it,$,X){"use strict";var tt=Math.PI/180,j=function(W){return tt*W};$.a=j},function(it,$,X){"use strict";var tt=X(8);$.a=tt.a},function(it,$,X){"use strict";var tt=X(29);$.a=tt.a},function(it,$,X){"use strict";var tt=X(13),j=X(15);$.a=function(W,Q){return Object(tt.a)(Object(j.a)(W),Q)}},function(it,$,X){"use strict";var tt=X(9),j=function(W){return Object(tt.a)(W).toLowerCase()};$.a=j},function(it,$,X){"use strict";var tt=X(9),j=function(W){var Q=Object(tt.a)(W);return Q.charAt(0).toLowerCase()+Q.substring(1)};$.a=j},function(it,$,X){"use strict";function tt(j,W){return!j||!W?j:j.replace(/\\?\{([^{}]+)\}/g,function(Q,Z){return Q.charAt(0)==="\\"?Q.slice(1):W[Z]===void 0?"":W[Z]})}$.a=tt},function(it,$,X){"use strict";var tt=X(9),j=function(W){return Object(tt.a)(W).toUpperCase()};$.a=j},function(it,$,X){"use strict";var tt=X(9),j=function(W){var Q=Object(tt.a)(W);return Q.charAt(0).toUpperCase()+Q.substring(1)};$.a=j},function(it,$,X){"use strict";var tt=X(3),j=function(W){return Object(tt.a)(W,"Arguments")};$.a=j},function(it,$,X){"use strict";var tt=X(3),j=function(W){return Object(tt.a)(W,"Boolean")};$.a=j},function(it,$,X){"use strict";var tt=X(3),j=function(W){return Object(tt.a)(W,"Date")};$.a=j},function(it,$,X){"use strict";var tt=X(3),j=function(W){return Object(tt.a)(W,"Error")};$.a=j},function(it,$,X){"use strict";var tt=X(5);$.a=function(j){return Object(tt.a)(j)&&isFinite(j)}},function(it,$,X){"use strict";var tt=function(j){return j===null};$.a=tt},function(it,$,X){"use strict";var tt=X(3),j=function(W){return Object(tt.a)(W,"RegExp")};$.a=j},function(it,$,X){"use strict";var tt=function(j){return j===void 0};$.a=tt},function(it,$,X){"use strict";var tt=function(j){return j instanceof Element||j instanceof HTMLDocument};$.a=tt},function(it,$,X){"use strict";$.a=tt;function tt(j){var W=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(Q){return setTimeout(Q,16)};return W(j)}},function(it,$,X){"use strict";$.a=tt;function tt(j){var W=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;W(j)}},function(it,$,X){"use strict";var tt=X(16),j=X(2),W=function(){for(var Q=[],Z=0;Z<arguments.length;Z++)Q[Z]=arguments[Z];for(var L=Q[0],P=1;P<Q.length;P++){var C=Q[P];Object(j.a)(C)&&(C=C.prototype),Object(tt.a)(L.prototype,C)}};$.a=W},function(it,$,X){"use strict";var tt=X(0),j=function(W){if(typeof W!="object"||W===null)return W;var Q;if(Object(tt.a)(W)){Q=[];for(var Z=0,L=W.length;Z<L;Z++)typeof W[Z]=="object"&&W[Z]!=null?Q[Z]=j(W[Z]):Q[Z]=W[Z]}else{Q={};for(var P in W)typeof W[P]=="object"&&W[P]!=null?Q[P]=j(W[P]):Q[P]=W[P]}return Q};$.a=j},function(it,$,X){"use strict";function tt(j,W,Q){var Z;return function(){var L=this,P=arguments,C=function(){Z=null,Q||j.apply(L,P)},M=Q&&!Z;clearTimeout(Z),Z=setTimeout(C,W),M&&j.apply(L,P)}}$.a=tt},function(it,$,X){"use strict";var tt=X(0),j=X(10),W=5;function Q(L,P,C,M){C=C||0,M=M||W;for(var k in P)if(P.hasOwnProperty(k)){var B=P[k];B!==null&&Object(j.a)(B)?(Object(j.a)(L[k])||(L[k]={}),C<M?Q(L[k],B,C+1,M):L[k]=P[k]):Object(tt.a)(B)?(L[k]=[],L[k]=L[k].concat(B)):B!==void 0&&(L[k]=B)}}var Z=function(L){for(var P=[],C=1;C<arguments.length;C++)P[C-1]=arguments[C];for(var M=0;M<P.length;M+=1)Q(L,P[M]);return L};$.a=Z},function(it,$,X){"use strict";var tt=X(16),j=X(2),W=function(Q,Z,L,P){Object(j.a)(Z)||(L=Z,Z=Q,Q=function(){});var C=Object.create?function(k,B){return Object.create(k,{constructor:{value:B}})}:function(k,B){function R(){}R.prototype=k;var F=new R;return F.constructor=B,F},M=C(Z.prototype,Q);return Q.prototype=Object(tt.a)(M,Q.prototype),Q.superclass=C(Z.prototype,Z),Object(tt.a)(M,L),Object(tt.a)(Q,P),Q};$.a=W},function(it,$,X){"use strict";var tt=X(1),j=function(W,Q){if(!Object(tt.a)(W))return-1;var Z=Array.prototype.indexOf;if(Z)return Z.call(W,Q);for(var L=-1,P=0;P<W.length;P++)if(W[P]===Q){L=P;break}return L};$.a=j},function(it,$,X){"use strict";var tt=X(7),j=X(1),W=X(30),Q=X(31),Z=Object.prototype.hasOwnProperty;function L(P){if(Object(tt.a)(P))return!0;if(Object(j.a)(P))return!P.length;var C=Object(W.a)(P);if(C==="Map"||C==="Set")return!P.size;if(Object(Q.a)(P))return!Object.keys(P).length;for(var M in P)if(Z.call(P,M))return!1;return!0}$.a=L},function(it,$,X){"use strict";var tt=X(2),j=X(33);$.a=function(W,Q,Z){return Object(tt.a)(Z)?!!Z(W,Q):Object(j.a)(W,Q)}},function(it,$,X){"use strict";var tt=X(1),j=function(W,Q){if(!Object(tt.a)(W))return W;for(var Z=[],L=0;L<W.length;L++){var P=W[L];Z.push(Q(P,L))}return Z};$.a=j},function(it,$,X){"use strict";var tt=X(7),j=X(12),W=function(Q){return Q};$.a=function(Q,Z){Z===void 0&&(Z=W);var L={};return Object(j.a)(Q)&&!Object(tt.a)(Q)&&Object.keys(Q).forEach(function(P){L[P]=Z(Q[P],P)}),L}},function(it,$,X){"use strict";var tt=X(4);$.a=function(j,W,Q){for(var Z=0,L=Object(tt.a)(W)?W.split("."):W;j&&Z<L.length;)j=j[L[Z++]];return j===void 0||Z<L.length?Q:j}},function(it,$,X){"use strict";var tt=X(12),j=X(4),W=X(5);$.a=function(Q,Z,L){var P=Q,C=Object(j.a)(Z)?Z.split("."):Z;return C.forEach(function(M,k){k<C.length-1?(Object(tt.a)(P[M])||(P[M]=Object(W.a)(C[k+1])?[]:{}),P=P[M]):P[M]=L}),Q}},function(it,$,X){"use strict";var tt=X(8),j=X(10),W=Object.prototype.hasOwnProperty;$.a=function(Q,Z){if(Q===null||!Object(j.a)(Q))return{};var L={};return Object(tt.a)(Z,function(P){W.call(Q,P)&&(L[P]=Q[P])}),L}},function(it,$,X){"use strict";var tt=X(25);$.a=function(j,W){return Object(tt.a)(j,function(Q,Z,L){return W.includes(L)||(Q[L]=Z),Q},{})}},function(it,$,X){"use strict";$.a=function(tt,j,W){var Q,Z,L,P,C=0;W||(W={});var M=function(){C=W.leading===!1?0:Date.now(),Q=null,P=tt.apply(Z,L),Q||(Z=L=null)},k=function(){var B=Date.now();!C&&W.leading===!1&&(C=B);var R=j-(B-C);return Z=this,L=arguments,R<=0||R>j?(Q&&(clearTimeout(Q),Q=null),C=B,P=tt.apply(Z,L),Q||(Z=L=null)):!Q&&W.trailing!==!1&&(Q=setTimeout(M,R)),P};return k.cancel=function(){clearTimeout(Q),C=0,Q=Z=L=null},k}},function(it,$,X){"use strict";var tt=X(1);$.a=function(j){return Object(tt.a)(j)?Array.prototype.slice.call(j):[]}},function(it,$,X){"use strict";var tt={};$.a=function(j){return j=j||"g",tt[j]?tt[j]+=1:tt[j]=1,j+tt[j]}},function(it,$,X){"use strict";$.a=function(){}},function(it,$,X){"use strict";$.a=function(tt){return tt}},function(it,$,X){"use strict";$.a=W;var tt=X(7),j=X(1);function W(Q){return Object(tt.a)(Q)?0:Object(j.a)(Q)?Q.length:Object.keys(Q).length}},function(it,$,X){"use strict";$.a=st;var tt=function(we,At){return tt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Yt,be){Yt.__proto__=be}||function(Yt,be){for(var nn in be)Object.prototype.hasOwnProperty.call(be,nn)&&(Yt[nn]=be[nn])},tt(we,At)};function j(we,At){if(typeof At!="function"&&At!==null)throw new TypeError("Class extends value "+String(At)+" is not a constructor or null");tt(we,At);function Yt(){this.constructor=we}we.prototype=At===null?Object.create(At):(Yt.prototype=At.prototype,new Yt)}var W=function(){return W=Object.assign||function(At){for(var Yt,be=1,nn=arguments.length;be<nn;be++){Yt=arguments[be];for(var Ee in Yt)Object.prototype.hasOwnProperty.call(Yt,Ee)&&(At[Ee]=Yt[Ee])}return At},W.apply(this,arguments)};function Q(we,At){var Yt={};for(var be in we)Object.prototype.hasOwnProperty.call(we,be)&&At.indexOf(be)<0&&(Yt[be]=we[be]);if(we!=null&&typeof Object.getOwnPropertySymbols=="function")for(var nn=0,be=Object.getOwnPropertySymbols(we);nn<be.length;nn++)At.indexOf(be[nn])<0&&Object.prototype.propertyIsEnumerable.call(we,be[nn])&&(Yt[be[nn]]=we[be[nn]]);return Yt}function Z(we,At,Yt,be){var nn=arguments.length,Ee=nn<3?At:be===null?be=Object.getOwnPropertyDescriptor(At,Yt):be,le;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Ee=Reflect.decorate(we,At,Yt,be);else for(var Le=we.length-1;Le>=0;Le--)(le=we[Le])&&(Ee=(nn<3?le(Ee):nn>3?le(At,Yt,Ee):le(At,Yt))||Ee);return nn>3&&Ee&&Object.defineProperty(At,Yt,Ee),Ee}function L(we,At){return function(Yt,be){At(Yt,be,we)}}function P(we,At,Yt,be,nn,Ee){function le(ee){if(ee!==void 0&&typeof ee!="function")throw new TypeError("Function expected");return ee}for(var Le=be.kind,Ze=Le==="getter"?"get":Le==="setter"?"set":"value",fe=!At&&we?be.static?we:we.prototype:null,Re=At||(fe?Object.getOwnPropertyDescriptor(fe,be.name):{}),He,pe=!1,Ge=Yt.length-1;Ge>=0;Ge--){var te={};for(var Me in be)te[Me]=Me==="access"?{}:be[Me];for(var Me in be.access)te.access[Me]=be.access[Me];te.addInitializer=function(ee){if(pe)throw new TypeError("Cannot add initializers after decoration has completed");Ee.push(le(ee||null))};var We=(0,Yt[Ge])(Le==="accessor"?{get:Re.get,set:Re.set}:Re[Ze],te);if(Le==="accessor"){if(We===void 0)continue;if(We===null||typeof We!="object")throw new TypeError("Object expected");(He=le(We.get))&&(Re.get=He),(He=le(We.set))&&(Re.set=He),(He=le(We.init))&&nn.push(He)}else(He=le(We))&&(Le==="field"?nn.push(He):Re[Ze]=He)}fe&&Object.defineProperty(fe,be.name,Re),pe=!0}function C(we,At,Yt){for(var be=arguments.length>2,nn=0;nn<At.length;nn++)Yt=be?At[nn].call(we,Yt):At[nn].call(we);return be?Yt:void 0}function M(we){return typeof we=="symbol"?we:"".concat(we)}function k(we,At,Yt){return typeof At=="symbol"&&(At=At.description?"[".concat(At.description,"]"):""),Object.defineProperty(we,"name",{configurable:!0,value:Yt?"".concat(Yt," ",At):At})}function B(we,At){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(we,At)}function R(we,At,Yt,be){function nn(Ee){return Ee instanceof Yt?Ee:new Yt(function(le){le(Ee)})}return new(Yt||(Yt=Promise))(function(Ee,le){function Le(Re){try{fe(be.next(Re))}catch(He){le(He)}}function Ze(Re){try{fe(be.throw(Re))}catch(He){le(He)}}function fe(Re){Re.done?Ee(Re.value):nn(Re.value).then(Le,Ze)}fe((be=be.apply(we,At||[])).next())})}function F(we,At){var Yt={label:0,sent:function(){if(Ee[0]&1)throw Ee[1];return Ee[1]},trys:[],ops:[]},be,nn,Ee,le;return le={next:Le(0),throw:Le(1),return:Le(2)},typeof Symbol=="function"&&(le[Symbol.iterator]=function(){return this}),le;function Le(fe){return function(Re){return Ze([fe,Re])}}function Ze(fe){if(be)throw new TypeError("Generator is already executing.");for(;le&&(le=0,fe[0]&&(Yt=0)),Yt;)try{if(be=1,nn&&(Ee=fe[0]&2?nn.return:fe[0]?nn.throw||((Ee=nn.return)&&Ee.call(nn),0):nn.next)&&!(Ee=Ee.call(nn,fe[1])).done)return Ee;switch(nn=0,Ee&&(fe=[fe[0]&2,Ee.value]),fe[0]){case 0:case 1:Ee=fe;break;case 4:return Yt.label++,{value:fe[1],done:!1};case 5:Yt.label++,nn=fe[1],fe=[0];continue;case 7:fe=Yt.ops.pop(),Yt.trys.pop();continue;default:if(Ee=Yt.trys,!(Ee=Ee.length>0&&Ee[Ee.length-1])&&(fe[0]===6||fe[0]===2)){Yt=0;continue}if(fe[0]===3&&(!Ee||fe[1]>Ee[0]&&fe[1]<Ee[3])){Yt.label=fe[1];break}if(fe[0]===6&&Yt.label<Ee[1]){Yt.label=Ee[1],Ee=fe;break}if(Ee&&Yt.label<Ee[2]){Yt.label=Ee[2],Yt.ops.push(fe);break}Ee[2]&&Yt.ops.pop(),Yt.trys.pop();continue}fe=At.call(we,Yt)}catch(Re){fe=[6,Re],nn=0}finally{be=Ee=0}if(fe[0]&5)throw fe[1];return{value:fe[0]?fe[1]:void 0,done:!0}}}var K=Object.create?function(we,At,Yt,be){be===void 0&&(be=Yt);var nn=Object.getOwnPropertyDescriptor(At,Yt);(!nn||("get"in nn?!At.__esModule:nn.writable||nn.configurable))&&(nn={enumerable:!0,get:function(){return At[Yt]}}),Object.defineProperty(we,be,nn)}:function(we,At,Yt,be){be===void 0&&(be=Yt),we[be]=At[Yt]};function O(we,At){for(var Yt in we)Yt!=="default"&&!Object.prototype.hasOwnProperty.call(At,Yt)&&K(At,we,Yt)}function _(we){var At=typeof Symbol=="function"&&Symbol.iterator,Yt=At&&we[At],be=0;if(Yt)return Yt.call(we);if(we&&typeof we.length=="number")return{next:function(){return we&&be>=we.length&&(we=void 0),{value:we&&we[be++],done:!we}}};throw new TypeError(At?"Object is not iterable.":"Symbol.iterator is not defined.")}function ft(we,At){var Yt=typeof Symbol=="function"&&we[Symbol.iterator];if(!Yt)return we;var be=Yt.call(we),nn,Ee=[],le;try{for(;(At===void 0||At-- >0)&&!(nn=be.next()).done;)Ee.push(nn.value)}catch(Le){le={error:Le}}finally{try{nn&&!nn.done&&(Yt=be.return)&&Yt.call(be)}finally{if(le)throw le.error}}return Ee}function mt(){for(var we=[],At=0;At<arguments.length;At++)we=we.concat(ft(arguments[At]));return we}function st(){for(var we=0,At=0,Yt=arguments.length;At<Yt;At++)we+=arguments[At].length;for(var be=Array(we),nn=0,At=0;At<Yt;At++)for(var Ee=arguments[At],le=0,Le=Ee.length;le<Le;le++,nn++)be[nn]=Ee[le];return be}function ut(we,At,Yt){if(Yt||arguments.length===2)for(var be=0,nn=At.length,Ee;be<nn;be++)(Ee||!(be in At))&&(Ee||(Ee=Array.prototype.slice.call(At,0,be)),Ee[be]=At[be]);return we.concat(Ee||Array.prototype.slice.call(At))}function dt(we){return this instanceof dt?(this.v=we,this):new dt(we)}function gt(we,At,Yt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var be=Yt.apply(we,At||[]),nn,Ee=[];return nn={},le("next"),le("throw"),le("return"),nn[Symbol.asyncIterator]=function(){return this},nn;function le(pe){be[pe]&&(nn[pe]=function(Ge){return new Promise(function(te,Me){Ee.push([pe,Ge,te,Me])>1||Le(pe,Ge)})})}function Le(pe,Ge){try{Ze(be[pe](Ge))}catch(te){He(Ee[0][3],te)}}function Ze(pe){pe.value instanceof dt?Promise.resolve(pe.value.v).then(fe,Re):He(Ee[0][2],pe)}function fe(pe){Le("next",pe)}function Re(pe){Le("throw",pe)}function He(pe,Ge){pe(Ge),Ee.shift(),Ee.length&&Le(Ee[0][0],Ee[0][1])}}function wt(we){var At,Yt;return At={},be("next"),be("throw",function(nn){throw nn}),be("return"),At[Symbol.iterator]=function(){return this},At;function be(nn,Ee){At[nn]=we[nn]?function(le){return(Yt=!Yt)?{value:dt(we[nn](le)),done:!1}:Ee?Ee(le):le}:Ee}}function ot(we){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=we[Symbol.asyncIterator],Yt;return At?At.call(we):(we=typeof _=="function"?_(we):we[Symbol.iterator](),Yt={},be("next"),be("throw"),be("return"),Yt[Symbol.asyncIterator]=function(){return this},Yt);function be(Ee){Yt[Ee]=we[Ee]&&function(le){return new Promise(function(Le,Ze){le=we[Ee](le),nn(Le,Ze,le.done,le.value)})}}function nn(Ee,le,Le,Ze){Promise.resolve(Ze).then(function(fe){Ee({value:fe,done:Le})},le)}}function pt(we,At){return Object.defineProperty?Object.defineProperty(we,"raw",{value:At}):we.raw=At,we}var Nt=Object.create?function(we,At){Object.defineProperty(we,"default",{enumerable:!0,value:At})}:function(we,At){we.default=At};function Gt(we){if(we&&we.__esModule)return we;var At={};if(we!=null)for(var Yt in we)Yt!=="default"&&Object.prototype.hasOwnProperty.call(we,Yt)&&K(At,we,Yt);return Nt(At,we),At}function se(we){return we&&we.__esModule?we:{default:we}}function ie(we,At,Yt,be){if(Yt==="a"&&!be)throw new TypeError("Private accessor was defined without a getter");if(typeof At=="function"?we!==At||!be:!At.has(we))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Yt==="m"?be:Yt==="a"?be.call(we):be?be.value:At.get(we)}function Be(we,At,Yt,be,nn){if(be==="m")throw new TypeError("Private method is not writable");if(be==="a"&&!nn)throw new TypeError("Private accessor was defined without a setter");if(typeof At=="function"?we!==At||!nn:!At.has(we))throw new TypeError("Cannot write private member to an object whose class did not declare it");return be==="a"?nn.call(we,Yt):nn?nn.value=Yt:At.set(we,Yt),Yt}function ke(we,At){if(At===null||typeof At!="object"&&typeof At!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof we=="function"?At===we:we.has(At)}},function(it,$,X){"use strict";var tt=X(4),j=X(9),W=X(34);$.a=function(Q,Z,L,P){P===void 0&&(P="...");var C=16,M=Object(W.a)(P,L),k=Object(tt.a)(Q)?Q:Object(j.a)(Q),B=Z,R=[],F,K;if(Object(W.a)(Q,L)<=Z)return Q;for(;F=k.substr(0,C),K=Object(W.a)(F,L),!(K+M>B&&K>B);)if(R.push(F),B-=K,k=k.substr(C),!k)return R.join("");for(;F=k.substr(0,1),K=Object(W.a)(F,L),!(K+M>B);)if(R.push(F),B-=K,k=k.substr(1),!k)return R.join("");return""+R.join("")+P}},function(it,$,X){"use strict";var tt=function(){function j(){this.map={}}return j.prototype.has=function(W){return this.map[W]!==void 0},j.prototype.get=function(W,Q){var Z=this.map[W];return Z===void 0?Q:Z},j.prototype.set=function(W,Q){this.map[W]=Q},j.prototype.clear=function(){this.map={}},j.prototype.delete=function(W){delete this.map[W]},j.prototype.size=function(){return Object.keys(this.map).length},j}();$.a=tt},function(it,$){function X(L,P,C,M){M===void 0&&(M=[]);var k=this;k.w=L||0,k.h=P||0,k.y=C||0,k.x=0,k.c=M||[],k.cs=M.length,k.prelim=0,k.mod=0,k.shift=0,k.change=0,k.tl=null,k.tr=null,k.el=null,k.er=null,k.msel=0,k.mser=0}X.fromNode=function(L,P){if(!L)return null;var C=[];return L.children.forEach(function(M){C.push(X.fromNode(M,P))}),P?new X(L.height,L.width,L.x,C):new X(L.width,L.height,L.y,C)};function tt(L,P,C){C?L.y+=P:L.x+=P,L.children.forEach(function(M){tt(M,P,C)})}function j(L,P){var C=P?L.y:L.x;return L.children.forEach(function(M){C=Math.min(j(M,P),C)}),C}function W(L,P){var C=j(L,P);tt(L,-C,P)}function Q(L,P,C){C?P.y=L.x:P.x=L.x,L.c.forEach(function(M,k){Q(M,P.children[k],C)})}function Z(L,P,C){C===void 0&&(C=0),P?(L.x=C,C+=L.width):(L.y=C,C+=L.height),L.children.forEach(function(M){Z(M,P,C)})}it.exports=function(L,P){P===void 0&&(P={});var C=P.isHorizontal;function M(ot){if(ot.cs===0){k(ot);return}M(ot.c[0]);for(var pt=gt(O(ot.c[0].el),0,null),Nt=1;Nt<ot.cs;++Nt){M(ot.c[Nt]);var Gt=O(ot.c[Nt].er);B(ot,Nt,pt),pt=gt(Gt,Nt,pt)}mt(ot),k(ot)}function k(ot){ot.cs===0?(ot.el=ot,ot.er=ot,ot.msel=ot.mser=0):(ot.el=ot.c[0].el,ot.msel=ot.c[0].msel,ot.er=ot.c[ot.cs-1].er,ot.mser=ot.c[ot.cs-1].mser)}function B(ot,pt,Nt){for(var Gt=ot.c[pt-1],se=Gt.mod,ie=ot.c[pt],Be=ie.mod;Gt!==null&&ie!==null;){O(Gt)>Nt.low&&(Nt=Nt.nxt);var ke=se+Gt.prelim+Gt.w-(Be+ie.prelim);ke>0&&(Be+=ke,R(ot,pt,Nt.index,ke));var we=O(Gt),At=O(ie);we<=At&&(Gt=K(Gt),Gt!==null&&(se+=Gt.mod)),we>=At&&(ie=F(ie),ie!==null&&(Be+=ie.mod))}!Gt&&!!ie?_(ot,pt,ie,Be):!!Gt&&!ie&&ft(ot,pt,Gt,se)}function R(ot,pt,Nt,Gt){ot.c[pt].mod+=Gt,ot.c[pt].msel+=Gt,ot.c[pt].mser+=Gt,ut(ot,pt,Nt,Gt)}function F(ot){return ot.cs===0?ot.tl:ot.c[0]}function K(ot){return ot.cs===0?ot.tr:ot.c[ot.cs-1]}function O(ot){return ot.y+ot.h}function _(ot,pt,Nt,Gt){var se=ot.c[0].el;se.tl=Nt;var ie=Gt-Nt.mod-ot.c[0].msel;se.mod+=ie,se.prelim-=ie,ot.c[0].el=ot.c[pt].el,ot.c[0].msel=ot.c[pt].msel}function ft(ot,pt,Nt,Gt){var se=ot.c[pt].er;se.tr=Nt;var ie=Gt-Nt.mod-ot.c[pt].mser;se.mod+=ie,se.prelim-=ie,ot.c[pt].er=ot.c[pt-1].er,ot.c[pt].mser=ot.c[pt-1].mser}function mt(ot){ot.prelim=(ot.c[0].prelim+ot.c[0].mod+ot.c[ot.cs-1].mod+ot.c[ot.cs-1].prelim+ot.c[ot.cs-1].w)/2-ot.w/2}function st(ot,pt){pt+=ot.mod,ot.x=ot.prelim+pt,dt(ot);for(var Nt=0;Nt<ot.cs;Nt++)st(ot.c[Nt],pt)}function ut(ot,pt,Nt,Gt){if(Nt!==pt-1){var se=pt-Nt;ot.c[Nt+1].shift+=Gt/se,ot.c[pt].shift-=Gt/se,ot.c[pt].change-=Gt-Gt/se}}function dt(ot){for(var pt=0,Nt=0,Gt=0;Gt<ot.cs;Gt++)pt+=ot.c[Gt].shift,Nt+=pt+ot.c[Gt].change,ot.c[Gt].mod+=Nt}function gt(ot,pt,Nt){for(;Nt!==null&&ot>=Nt.low;)Nt=Nt.nxt;return{low:ot,index:pt,nxt:Nt}}Z(L,C);var wt=X.fromNode(L,C);return M(wt),st(wt,0),Q(wt,L,C),W(L,C),L}},function(it,$,X){function tt(k,B){k.prototype=Object.create(B.prototype),k.prototype.constructor=k,j(k,B)}function j(k,B){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(F,K){return F.__proto__=K,F},j(k,B)}var W=X(11),Q=X(121),Z=X(17),L=X(6),P=function(k){tt(B,k);function B(){return k.apply(this,arguments)||this}var R=B.prototype;return R.execute=function(){var K=this;return K.rootNode.width=0,Z(K.rootNode,K.options,Q)},B}(W),C={};function M(k,B){return B=L.assign({},C,B),new P(k,B).execute()}it.exports=M},function(it,$,X){var tt=X(6);function j(Z,L){Z===void 0&&(Z=0),L===void 0&&(L=[]);var P=this;P.x=P.y=0,P.leftChild=P.rightChild=null,P.height=0,P.children=L}var W={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function Q(Z,L,P){P?(L.x=Z.x,L.y=Z.y):(L.x=Z.y,L.y=Z.x),Z.children.forEach(function(C,M){Q(C,L.children[M],P)})}it.exports=function(Z,L){L===void 0&&(L={}),L=tt.assign({},W,L);var P=0;function C(F){if(!F)return null;F.width=0,F.depth&&F.depth>P&&(P=F.depth);var K=F.children,O=K.length,_=new j(F.height,[]);return K.forEach(function(ft,mt){var st=C(ft);_.children.push(st),mt===0&&(_.leftChild=st),mt===O-1&&(_.rightChild=st)}),_.originNode=F,_.isLeaf=F.isLeaf(),_}function M(F){if(F.isLeaf||F.children.length===0)F.drawingDepth=P;else{var K=F.children.map(function(_){return M(_)}),O=Math.min.apply(null,K);F.drawingDepth=O-1}return F.drawingDepth}var k;function B(F){F.x=F.drawingDepth*L.rankSep,F.isLeaf?(F.y=0,k&&(F.y=k.y+k.height+L.nodeSep,F.originNode.parent!==k.originNode.parent&&(F.y+=L.subTreeSep)),k=F):(F.children.forEach(function(K){B(K)}),F.y=(F.leftChild.y+F.rightChild.y)/2)}var R=C(Z);return M(R),B(R),Q(R,Z,L.isHorizontal),Z}},function(it,$,X){function tt(R,F){R.prototype=Object.create(F.prototype),R.prototype.constructor=R,j(R,F)}function j(R,F){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(O,_){return O.__proto__=_,O},j(R,F)}var W=X(11),Q=X(123),Z=X(35),L=X(6),P=["LR","RL","H"],C=P[0],M=function(R){tt(F,R);function F(){return R.apply(this,arguments)||this}var K=F.prototype;return K.execute=function(){var _=this,ft=_.options,mt=_.rootNode;ft.isHorizontal=!0;var st=ft.indent,ut=st===void 0?20:st,dt=ft.dropCap,gt=dt===void 0?!0:dt,wt=ft.direction,ot=wt===void 0?C:wt,pt=ft.align;if(ot&&P.indexOf(ot)===-1)throw new TypeError("Invalid direction: "+ot);if(ot===P[0])Q(mt,ut,gt,pt);else if(ot===P[1])Q(mt,ut,gt,pt),mt.right2left();else if(ot===P[2]){var Nt=Z(mt,ft),Gt=Nt.left,se=Nt.right;Q(Gt,ut,gt,pt),Gt.right2left(),Q(se,ut,gt,pt);var ie=Gt.getBoundingBox();se.translate(ie.width,0),mt.x=se.x-mt.width/2}return mt},F}(W),k={};function B(R,F){return F=L.assign({},k,F),new M(R,F).execute()}it.exports=B},function(it,$,X){var tt=X(6);function j(W,Q,Z,L,P){var C=typeof Z=="function"?Z(W):Z*W.depth;if(!L)try{if(W.id===W.parent.children[0].id){W.x+=C,W.y=Q?Q.y:0;return}}catch(B){}if(W.x+=C,Q){if(W.y=Q.y+tt.getHeight(Q,W,P),Q.parent&&W.parent.id!==Q.parent.id){var M=Q.parent,k=M.y+tt.getHeight(M,W,P);W.y=k>W.y?k:W.y}}else W.y=0}it.exports=function(W,Q,Z,L){var P=null;W.eachNode(function(C){j(C,P,Q,Z,L),P=C})}},function(it,$,X){function tt(k,B){k.prototype=Object.create(B.prototype),k.prototype.constructor=k,j(k,B)}function j(k,B){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(F,K){return F.__proto__=K,F},j(k,B)}var W=X(11),Q=X(125),Z=X(17),L=X(6),P=function(k){tt(B,k);function B(){return k.apply(this,arguments)||this}var R=B.prototype;return R.execute=function(){var K=this;return Z(K.rootNode,K.options,Q)},B}(W),C={};function M(k,B){return B=L.assign({},C,B),new P(k,B).execute()}it.exports=M},function(it,$,X){var tt=X(6);function j(Z,L){var P=0;return Z.children.length?Z.children.forEach(function(C){P+=j(C,L)}):P=Z.height,Z._subTreeSep=L.getSubTreeSep(Z.data),Z.totalHeight=Math.max(Z.height,P)+2*Z._subTreeSep,Z.totalHeight}function W(Z){var L=Z.children,P=L.length;if(P){L.forEach(function(F){W(F)});var C=L[0],M=L[P-1],k=M.y-C.y+M.height,B=0;if(L.forEach(function(F){B+=F.totalHeight}),k>Z.height)Z.y=C.y+k/2-Z.height/2;else if(L.length!==1||Z.height>B){var R=Z.y+(Z.height-k)/2-C.y;L.forEach(function(F){F.translate(0,R)})}else Z.y=(C.y+C.height/2+M.y+M.height/2)/2-Z.height/2}}var Q={getSubTreeSep:function(){return 0}};it.exports=function(Z,L){L===void 0&&(L={}),L=tt.assign({},Q,L),Z.parent={x:0,width:0,height:0,y:0},Z.BFTraverse(function(P){P.x=P.parent.x+P.parent.width}),Z.parent=null,j(Z,L),Z.startY=0,Z.y=Z.totalHeight/2-Z.height/2,Z.eachNode(function(P){var C=P.children,M=C.length;if(M){var k=C[0];if(k.startY=P.startY+P._subTreeSep,M===1)k.y=P.y+P.height/2-k.height/2;else{k.y=k.startY+k.totalHeight/2-k.height/2;for(var B=1;B<M;B++){var R=C[B];R.startY=C[B-1].startY+C[B-1].totalHeight,R.y=R.startY+R.totalHeight/2-R.height/2}}}}),W(Z)}}])})},83360:function(sr,it,$){"use strict";var X=this&&this.__createBinding||(Object.create?function(W,Q,Z,L){L===void 0&&(L=Z);var P=Object.getOwnPropertyDescriptor(Q,Z);(!P||("get"in P?!Q.__esModule:P.writable||P.configurable))&&(P={enumerable:!0,get:function(){return Q[Z]}}),Object.defineProperty(W,L,P)}:function(W,Q,Z,L){L===void 0&&(L=Z),W[L]=Q[Z]}),tt=this&&this.__exportStar||function(W,Q){for(var Z in W)Z!=="default"&&!Object.prototype.hasOwnProperty.call(Q,Z)&&X(Q,W,Z)};Object.defineProperty(it,"__esModule",{value:!0}),it.getLayoutByName=it.unRegisterLayout=it.registerLayout=void 0;var j=$(95326);Object.defineProperty(it,"registerLayout",{enumerable:!0,get:function(){return j.registerLayout}}),Object.defineProperty(it,"unRegisterLayout",{enumerable:!0,get:function(){return j.unRegisterLayout}}),Object.defineProperty(it,"getLayoutByName",{enumerable:!0,get:function(){return j.getLayoutByName}}),tt($(2584),it)},62329:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Base=void 0;var $=function(){function X(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.vedges=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=function(){}}return X.prototype.layout=function(tt){return this.init(tt),this.execute(!0)},X.prototype.init=function(tt){this.nodes=tt.nodes||[],this.edges=tt.edges||[],this.combos=tt.combos||[],this.comboEdges=tt.comboEdges||[],this.hiddenNodes=tt.hiddenNodes||[],this.hiddenEdges=tt.hiddenEdges||[],this.hiddenCombos=tt.hiddenCombos||[],this.vedges=tt.vedges||[]},X.prototype.execute=function(tt){},X.prototype.executeWithWorker=function(){},X.prototype.getDefaultCfg=function(){return{}},X.prototype.updateCfg=function(tt){tt&&Object.assign(this,tt)},X.prototype.getType=function(){return"base"},X.prototype.destroy=function(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0},X}();it.Base=$},64885:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var P=function(C,M){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,B){k.__proto__=B}||function(k,B){for(var R in B)Object.prototype.hasOwnProperty.call(B,R)&&(k[R]=B[R])},P(C,M)};return function(C,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");P(C,M);function k(){this.constructor=C}C.prototype=M===null?Object.create(M):(k.prototype=M.prototype,new k)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.CircularLayout=void 0;var tt=$(62329),j=$(49784);function W(P,C,M,k){P.forEach(function(B,R){P[R].children=[],P[R].parent=[]}),k?C.forEach(function(B){var R=(0,j.getEdgeTerminal)(B,"source"),F=(0,j.getEdgeTerminal)(B,"target"),K=0;R&&(K=M[R]);var O=0;F&&(O=M[F]);var _=P[K].children,ft=P[O].parent;_.push(P[O].id),ft.push(P[K].id)}):C.forEach(function(B){var R=(0,j.getEdgeTerminal)(B,"source"),F=(0,j.getEdgeTerminal)(B,"target"),K=0;R&&(K=M[R]);var O=0;F&&(O=M[F]);var _=P[K].children,ft=P[O].children;_.push(P[O].id),ft.push(P[K].id)})}function Q(P,C,M){for(var k=M.length,B=0;B<k;B++){var R=(0,j.getEdgeTerminal)(M[B],"source"),F=(0,j.getEdgeTerminal)(M[B],"target");if(P.id===R&&C.id===F||C.id===R&&P.id===F)return!0}return!1}function Z(P,C){var M=P.degree,k=C.degree;return M<k?-1:M>k?1:0}var L=function(P){X(C,P);function C(M){var k=P.call(this)||this;return k.radius=null,k.nodeSize=void 0,k.startRadius=null,k.endRadius=null,k.startAngle=0,k.endAngle=2*Math.PI,k.clockwise=!0,k.divisions=1,k.ordering=null,k.angleRatio=1,k.nodes=[],k.edges=[],k.nodeMap={},k.degrees=[],k.width=300,k.height=300,k.updateCfg(M),k}return C.prototype.getDefaultCfg=function(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}},C.prototype.execute=function(){var M,k=this,B=k.nodes,R=k.edges,F=B.length;if(F===0){k.onLayoutEnd&&k.onLayoutEnd();return}!k.width&&typeof window!="undefined"&&(k.width=window.innerWidth),!k.height&&typeof window!="undefined"&&(k.height=window.innerHeight),k.center||(k.center=[k.width/2,k.height/2]);var K=k.center;if(F===1){B[0].x=K[0],B[0].y=K[1],k.onLayoutEnd&&k.onLayoutEnd();return}var O=k.radius,_=k.startRadius,ft=k.endRadius,mt=k.divisions,st=k.startAngle,ut=k.endAngle,dt=k.angleRatio,gt=k.ordering,wt=k.clockwise,ot=k.nodeSpacing,pt=k.nodeSize,Nt=(ut-st)/F,Gt={};B.forEach(function(Le,Ze){Gt[Le.id]=Ze}),k.nodeMap=Gt;var se=(0,j.getDegree)(B.length,Gt,R);if(k.degrees=se,ot){var ie=(0,j.getFuncByUnknownType)(10,ot),Be=(0,j.getFuncByUnknownType)(10,pt),ke=-Infinity;B.forEach(function(Le){var Ze=Be(Le);ke<Ze&&(ke=Ze)});var we=0;B.forEach(function(Le,Ze){Ze===0?we+=ke||10:we+=(ie(Le)||0)+(ke||10)}),O=we/(2*Math.PI)}else!O&&!_&&!ft?O=k.height>k.width?k.width/2:k.height/2:!_&&ft?_=ft:_&&!ft&&(ft=_);var At=Nt*dt,Yt=[];gt==="topology"?Yt=k.topologyOrdering():gt==="topology-directed"?Yt=k.topologyOrdering(!0):gt==="degree"?Yt=k.degreeOrdering():Yt=B;for(var be=Math.ceil(F/mt),nn=0;nn<F;++nn){var Ee=O;!Ee&&_!==null&&ft!==null&&(Ee=_+nn*(ft-_)/(F-1)),Ee||(Ee=10+nn*100/(F-1));var le=st+nn%be*At+2*Math.PI/mt*Math.floor(nn/be);wt||(le=ut-nn%be*At-2*Math.PI/mt*Math.floor(nn/be)),Yt[nn].x=K[0]+Math.cos(le)*Ee,Yt[nn].y=K[1]+Math.sin(le)*Ee,Yt[nn].weight=se[nn].all}return(M=k.onLayoutEnd)===null||M===void 0||M.call(k),{nodes:Yt,edges:this.edges}},C.prototype.topologyOrdering=function(M){M===void 0&&(M=!1);var k=this,B=k.degrees,R=k.edges,F=k.nodes,K=(0,j.clone)(F),O=k.nodeMap,_=[K[0]],ft=[F[0]],mt=[],st=F.length;mt[0]=!0,W(K,R,O,M);var ut=0;return K.forEach(function(dt,gt){if(gt!==0)if((gt===st-1||B[gt].all!==B[gt+1].all||Q(_[ut],dt,R))&&!mt[gt])_.push(dt),ft.push(F[O[dt.id]]),mt[gt]=!0,ut++;else{for(var wt=_[ut].children,ot=!1,pt=0;pt<wt.length;pt++){var Nt=O[wt[pt]];if(B[Nt].all===B[gt].all&&!mt[Nt]){_.push(K[Nt]),ft.push(F[O[K[Nt].id]]),mt[Nt]=!0,ot=!0;break}}for(var Gt=0;!ot&&(mt[Gt]||(_.push(K[Gt]),ft.push(F[O[K[Gt].id]]),mt[Gt]=!0,ot=!0),Gt++,Gt!==st););}}),ft},C.prototype.degreeOrdering=function(){var M=this,k=M.nodes,B=[],R=M.degrees;return k.forEach(function(F,K){F.degree=R[K].all,B.push(F)}),B.sort(Z),B},C.prototype.getType=function(){return"circular"},C}(tt.Base);it.CircularLayout=L},63861:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var P=function(C,M){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,B){k.__proto__=B}||function(k,B){for(var R in B)Object.prototype.hasOwnProperty.call(B,R)&&(k[R]=B[R])},P(C,M)};return function(C,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");P(C,M);function k(){this.constructor=C}C.prototype=M===null?Object.create(M):(k.prototype=M.prototype,new k)}}(),tt=this&&this.__assign||function(){return tt=Object.assign||function(P){for(var C,M=1,k=arguments.length;M<k;M++){C=arguments[M];for(var B in C)Object.prototype.hasOwnProperty.call(C,B)&&(P[B]=C[B])}return P},tt.apply(this,arguments)};Object.defineProperty(it,"__esModule",{value:!0}),it.ComboCombinedLayout=void 0;var j=$(16470),W=$(62329),Q=$(49784),Z=$(2584),L=function(P){X(C,P);function C(M){var k=P.call(this)||this;return k.center=[0,0],k.nodes=[],k.edges=[],k.combos=[],k.comboEdges=[],k.comboPadding=10,k.comboTrees=[],k.updateCfg(M),k}return C.prototype.getDefaultCfg=function(){return{}},C.prototype.execute=function(){var M=this,k=M.nodes,B=M.center;if(!k||k.length===0){M.onLayoutEnd&&M.onLayoutEnd();return}if(k.length===1){k[0].x=B[0],k[0].y=B[1],M.onLayoutEnd&&M.onLayoutEnd();return}M.initVals(),M.run(),M.onLayoutEnd&&M.onLayoutEnd()},C.prototype.run=function(){var M,k=this,B=k.nodes,R=k.edges,F=k.combos,K=k.comboEdges,O=k.center,_={};B.forEach(function(ke){_[ke.id]=ke});var ft={};F.forEach(function(ke){ft[ke.id]=ke});var mt=k.getInnerGraphs(_),st=[],ut=[],dt={},gt=!0;this.comboTrees.forEach(function(ke){var we=mt[ke.id],At=tt(tt({},ke),{x:we.x||ft[ke.id].x,y:we.y||ft[ke.id].y,fx:we.fx||ft[ke.id].fx,fy:we.fy||ft[ke.id].fy,mass:we.mass||ft[ke.id].mass,size:we.size});ut.push(At),!isNaN(At.x)&&At.x!==0&&!isNaN(At.y)&&At.y!==0?gt=!1:(At.x=Math.random()*100,At.y=Math.random()*100),st.push(ke.id),(0,Q.traverseTreeUp)(ke,function(Yt){return Yt.id!==ke.id&&(dt[Yt.id]=ke.id),!0})}),B.forEach(function(ke){if(!(ke.comboId&&ft[ke.comboId])){var we=tt({},ke);ut.push(we),!isNaN(we.x)&&we.x!==0&&!isNaN(we.y)&&we.y!==0?gt=!1:(we.x=Math.random()*100,we.y=Math.random()*100),st.push(ke.id)}});var wt=[];if(R.concat(K).forEach(function(ke){var we=dt[ke.source]||ke.source,At=dt[ke.target]||ke.target;we!==At&&st.includes(we)&&st.includes(At)&&wt.push({source:we,target:At})}),ut==null?void 0:ut.length){if(ut.length===1)ut[0].x=O[0],ut[0].y=O[1];else{var ot={nodes:ut,edges:wt},pt=this.outerLayout||new Z.GForceLayout({gravity:1,factor:4,linkDistance:function(ke,we,At){var Yt,be,nn=((((Yt=we.size)===null||Yt===void 0?void 0:Yt[0])||30)+(((be=At.size)===null||be===void 0?void 0:be[0])||30))/2;return Math.min(nn*1.5,700)}}),Nt=(M=pt.getType)===null||M===void 0?void 0:M.call(pt);if(pt.updateCfg({center:O,kg:5,preventOverlap:!0,animate:!1}),gt&&j.FORCE_LAYOUT_TYPE_MAP[Nt]){var Gt=ut.length<100?new Z.MDSLayout:new Z.GridLayout;Gt.layout(ot)}pt.layout(ot)}ut.forEach(function(ke){var we=mt[ke.id];if(!we){var At=_[ke.id];At&&(At.x=ke.x,At.y=ke.y);return}we.visited=!0,we.x=ke.x,we.y=ke.y,we.nodes.forEach(function(Yt){Yt.x+=ke.x,Yt.y+=ke.y})})}for(var se=Object.keys(mt),ie=function(ke){var we=se[ke],At=mt[we];if(!At)return"continue";At.nodes.forEach(function(Yt){At.visited||(Yt.x+=At.x||0,Yt.y+=At.y||0),_[Yt.id]&&(_[Yt.id].x=Yt.x,_[Yt.id].y=Yt.y)}),ft[we]&&(ft[we].x=At.x,ft[we].y=At.y)},Be=se.length-1;Be>=0;Be--)ie(Be);return{nodes:B,edges:R,combos:F,comboEdges:K}},C.prototype.getInnerGraphs=function(M){var k=this,B=k.comboTrees,R=k.nodeSize,F=k.edges,K=k.comboPadding,O=k.spacing,_={},ft=this.innerLayout||new Z.ConcentricLayout({sortBy:"id"});return ft.center=[0,0],ft.preventOverlap=!0,ft.nodeSpacing=O,(B||[]).forEach(function(mt){(0,Q.traverseTreeUp)(mt,function(st){var ut,dt=(K==null?void 0:K(st))||10;if((0,Q.isArray)(dt)&&(dt=Math.max.apply(Math,dt)),(ut=st.children)===null||ut===void 0?void 0:ut.length){var wt=st.children.map(function(Yt){if(Yt.itemType==="combo")return _[Yt.id];var be=M[Yt.id]||{};return tt(tt({},be),Yt)}),ot=wt.map(function(Yt){return Yt.id}),pt={nodes:wt,edges:F.filter(function(Yt){return ot.includes(Yt.source)&&ot.includes(Yt.target)})},Nt=Infinity;wt.forEach(function(Yt){var be;Yt.size||(Yt.size=((be=_[Yt.id])===null||be===void 0?void 0:be.size)||(R==null?void 0:R(Yt))||[30,30]),(0,Q.isNumber)(Yt.size)&&(Yt.size=[Yt.size,Yt.size]),Nt>Yt.size[0]&&(Nt=Yt.size[0]),Nt>Yt.size[1]&&(Nt=Yt.size[1])}),ft.layout(pt);var Gt=(0,Q.getLayoutBBox)(wt),se=Gt.minX,ie=Gt.minY,Be=Gt.maxX,ke=Gt.maxY,we={x:(Be+se)/2,y:(ke+ie)/2};pt.nodes.forEach(function(Yt){Yt.x-=we.x,Yt.y-=we.y});var At=Math.max(Be-se,ke-ie,Nt)+dt*2;_[st.id]={id:st.id,nodes:wt,size:[At,At]}}else if(st.itemType==="combo"){var gt=dt?[dt*2,dt*2]:[30,30];_[st.id]={id:st.id,nodes:[],size:gt}}return!0})}),_},C.prototype.initVals=function(){var M=this,k=M.nodeSize,B=M.spacing,R,F;if((0,Q.isNumber)(B)?F=function(){return B}:(0,Q.isFunction)(B)?F=B:F=function(){return 0},this.spacing=F,!k)R=function(st){var ut=F(st);if(st.size){if((0,Q.isArray)(st.size)){var dt=st.size[0]>st.size[1]?st.size[0]:st.size[1];return(dt+ut)/2}if((0,Q.isObject)(st.size)){var dt=st.size.width>st.size.height?st.size.width:st.size.height;return(dt+ut)/2}return(st.size+ut)/2}return 10+ut/2};else if((0,Q.isFunction)(k))R=function(st){var ut=k(st),dt=F(st);if((0,Q.isArray)(st.size)){var gt=st.size[0]>st.size[1]?st.size[0]:st.size[1];return(gt+dt)/2}return((ut||10)+dt)/2};else if((0,Q.isArray)(k)){var K=k[0]>k[1]?k[0]:k[1],O=K/2;R=function(st){return O+F(st)/2}}else{var _=k/2;R=function(st){return _+F(st)/2}}this.nodeSize=R;var ft=M.comboPadding,mt;(0,Q.isNumber)(ft)?mt=function(){return ft}:(0,Q.isArray)(ft)?mt=function(){return Math.max.apply(null,ft)}:(0,Q.isFunction)(ft)?mt=ft:mt=function(){return 0},this.comboPadding=mt},C.prototype.getType=function(){return"comboCombined"},C}(W.Base);it.ComboCombinedLayout=L},66590:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var Q=function(Z,L){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,C){P.__proto__=C}||function(P,C){for(var M in C)Object.prototype.hasOwnProperty.call(C,M)&&(P[M]=C[M])},Q(Z,L)};return function(Z,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");Q(Z,L);function P(){this.constructor=Z}Z.prototype=L===null?Object.create(L):(P.prototype=L.prototype,new P)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.ComboForceLayout=void 0;var tt=$(62329),j=$(49784),W=function(Q){X(Z,Q);function Z(L){var P=Q.call(this)||this;return P.center=[0,0],P.maxIteration=100,P.gravity=10,P.comboGravity=10,P.linkDistance=10,P.alpha=1,P.alphaMin=.001,P.alphaDecay=1-Math.pow(P.alphaMin,1/300),P.alphaTarget=0,P.velocityDecay=.6,P.edgeStrength=.6,P.nodeStrength=30,P.preventOverlap=!1,P.preventNodeOverlap=!1,P.preventComboOverlap=!1,P.collideStrength=void 0,P.nodeCollideStrength=.5,P.comboCollideStrength=.5,P.comboSpacing=20,P.comboPadding=10,P.optimizeRangeFactor=1,P.onTick=function(){},P.onLayoutEnd=function(){},P.depthAttractiveForceScale=1,P.depthRepulsiveForceScale=2,P.nodes=[],P.edges=[],P.combos=[],P.comboTrees=[],P.width=300,P.height=300,P.bias=[],P.nodeMap={},P.oriComboMap={},P.indexMap={},P.comboMap={},P.previousLayouted=!1,P.updateCfg(L),P}return Z.prototype.getDefaultCfg=function(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}},Z.prototype.execute=function(){var L=this,P=L.nodes,C=L.center;if(L.comboTree={id:"comboTreeRoot",depth:-1,children:L.comboTrees},!P||P.length===0){L.onLayoutEnd&&L.onLayoutEnd();return}if(P.length===1){P[0].x=C[0],P[0].y=C[1],L.onLayoutEnd&&L.onLayoutEnd();return}L.initVals(),L.run(),L.onLayoutEnd&&L.onLayoutEnd()},Z.prototype.run=function(){var L=this,P=L.nodes,C=L.previousLayouted?L.maxIteration/5:L.maxIteration;!L.width&&typeof window!="undefined"&&(L.width=window.innerWidth),!L.height&&typeof window!="undefined"&&(L.height=window.innerHeight);var M=L.center,k=L.velocityDecay,B=L.comboMap;L.previousLayouted||L.initPos(B);for(var R=function(_){var ft=[];P.forEach(function(mt,st){ft[st]={x:0,y:0}}),L.applyCalculate(ft),L.applyComboCenterForce(ft),P.forEach(function(mt,st){!(0,j.isNumber)(mt.x)||!(0,j.isNumber)(mt.y)||(mt.x+=ft[st].x*k,mt.y+=ft[st].y*k)}),L.alpha+=(L.alphaTarget-L.alpha)*L.alphaDecay,L.onTick()},F=0;F<C;F++)R(F);var K=[0,0];P.forEach(function(_){!(0,j.isNumber)(_.x)||!(0,j.isNumber)(_.y)||(K[0]+=_.x,K[1]+=_.y)}),K[0]/=P.length,K[1]/=P.length;var O=[M[0]-K[0],M[1]-K[1]];P.forEach(function(_,ft){!(0,j.isNumber)(_.x)||!(0,j.isNumber)(_.y)||(_.x+=O[0],_.y+=O[1])}),L.combos.forEach(function(_){var ft=B[_.id];ft&&ft.empty&&(_.x=ft.cx||_.x,_.y=ft.cy||_.y)}),L.previousLayouted=!0},Z.prototype.initVals=function(){var L=this,P=L.edges,C=L.nodes,M=L.combos,k={},B={},R={};C.forEach(function(Ee,le){B[Ee.id]=Ee,R[Ee.id]=le}),L.nodeMap=B,L.indexMap=R;var F={};M.forEach(function(Ee){F[Ee.id]=Ee}),L.oriComboMap=F,L.comboMap=L.getComboMap();var K=L.preventOverlap;L.preventComboOverlap=L.preventComboOverlap||K,L.preventNodeOverlap=L.preventNodeOverlap||K;var O=L.collideStrength;O&&(L.comboCollideStrength=O,L.nodeCollideStrength=O),L.comboCollideStrength=L.comboCollideStrength?L.comboCollideStrength:0,L.nodeCollideStrength=L.nodeCollideStrength?L.nodeCollideStrength:0;for(var _=0;_<P.length;++_){var ft=(0,j.getEdgeTerminal)(P[_],"source"),mt=(0,j.getEdgeTerminal)(P[_],"target");k[ft]?k[ft]++:k[ft]=1,k[mt]?k[mt]++:k[mt]=1}for(var st=[],_=0;_<P.length;++_){var ft=(0,j.getEdgeTerminal)(P[_],"source"),mt=(0,j.getEdgeTerminal)(P[_],"target");st[_]=k[ft]/(k[ft]+k[mt])}this.bias=st;var ut=L.nodeSize,dt=L.nodeSpacing,gt,wt;if((0,j.isNumber)(dt)?wt=function(){return dt}:(0,j.isFunction)(dt)?wt=dt:wt=function(){return 0},this.nodeSpacing=wt,!ut)gt=function(Ee){if(Ee.size){if((0,j.isArray)(Ee.size)){var le=Ee.size[0]>Ee.size[1]?Ee.size[0]:Ee.size[1];return le/2}if((0,j.isObject)(Ee.size)){var le=Ee.size.width>Ee.size.height?Ee.size.width:Ee.size.height;return le/2}return Ee.size/2}return 10};else if((0,j.isFunction)(ut))gt=function(Ee){return ut(Ee)};else if((0,j.isArray)(ut)){var ot=ut[0]>ut[1]?ut[0]:ut[1],pt=ot/2;gt=function(Ee){return pt}}else{var Nt=ut/2;gt=function(Ee){return Nt}}this.nodeSize=gt;var Gt=L.comboSpacing,se;(0,j.isNumber)(Gt)?se=function(){return Gt}:(0,j.isFunction)(Gt)?se=Gt:se=function(){return 0},this.comboSpacing=se;var ie=L.comboPadding,Be;(0,j.isNumber)(ie)?Be=function(){return ie}:(0,j.isArray)(ie)?Be=function(){return Math.max.apply(null,ie)}:(0,j.isFunction)(ie)?Be=ie:Be=function(){return 0},this.comboPadding=Be;var ke=this.linkDistance,we;ke||(ke=10),(0,j.isNumber)(ke)?we=function(Ee){return ke}:we=ke,this.linkDistance=we;var At=this.edgeStrength,Yt;At||(At=1),(0,j.isNumber)(At)?Yt=function(Ee){return At}:Yt=At,this.edgeStrength=Yt;var be=this.nodeStrength,nn;be||(be=30),(0,j.isNumber)(be)?nn=function(Ee){return be}:nn=be,this.nodeStrength=nn},Z.prototype.initPos=function(L){var P=this,C=P.nodes;C.forEach(function(M,k){var B=M.comboId,R=L[B];B&&R?(M.x=R.cx+100/(k+1),M.y=R.cy+100/(k+1)):(M.x=100/(k+1),M.y=100/(k+1))})},Z.prototype.getComboMap=function(){var L=this,P=L.nodeMap,C=L.comboTrees,M=L.oriComboMap,k={};return(C||[]).forEach(function(B){var R=[];(0,j.traverseTreeUp)(B,function(F){if(F.itemType==="node"||!M[F.id])return!0;if(k[F.id]===void 0){var K={id:F.id,name:F.id,cx:0,cy:0,count:0,depth:L.oriComboMap[F.id].depth||0,children:[]};k[F.id]=K}var O=F.children;O&&O.forEach(function(mt){if(!k[mt.id]&&!P[mt.id])return!0;R.push(mt)});var _=k[F.id];if(_.cx=0,_.cy=0,R.length===0){_.empty=!0;var ft=M[F.id];_.cx=ft.x,_.cy=ft.y}return R.forEach(function(mt){if(_.count++,mt.itemType!=="node"){var st=k[mt.id];(0,j.isNumber)(st.cx)&&(_.cx+=st.cx),(0,j.isNumber)(st.cy)&&(_.cy+=st.cy);return}var ut=P[mt.id];!ut||((0,j.isNumber)(ut.x)&&(_.cx+=ut.x),(0,j.isNumber)(ut.y)&&(_.cy+=ut.y))}),_.cx/=_.count||1,_.cy/=_.count||1,_.children=R,!0})}),k},Z.prototype.applyComboCenterForce=function(L){var P=this,C=P.gravity,M=P.comboGravity||C,k=this.alpha,B=P.comboTrees,R=P.indexMap,F=P.nodeMap,K=P.comboMap;(B||[]).forEach(function(O){(0,j.traverseTreeUp)(O,function(_){if(_.itemType==="node")return!0;var ft=K[_.id];if(!ft)return!0;var mt=K[_.id],st=(mt.depth+1)/10*.5,ut=mt.cx,dt=mt.cy;return mt.cx=0,mt.cy=0,mt.children.forEach(function(gt){if(gt.itemType!=="node"){var wt=K[gt.id];wt&&(0,j.isNumber)(wt.cx)&&(mt.cx+=wt.cx),wt&&(0,j.isNumber)(wt.cy)&&(mt.cy+=wt.cy);return}var ot=F[gt.id],pt=ot.x-ut||.005,Nt=ot.y-dt||.005,Gt=Math.sqrt(pt*pt+Nt*Nt),se=R[ot.id],ie=M*k/Gt*st;L[se].x-=pt*ie,L[se].y-=Nt*ie,(0,j.isNumber)(ot.x)&&(mt.cx+=ot.x),(0,j.isNumber)(ot.y)&&(mt.cy+=ot.y)}),mt.cx/=mt.count||1,mt.cy/=mt.count||1,!0})})},Z.prototype.applyCalculate=function(L){var P=this,C=P.comboMap,M=P.nodes,k={};M.forEach(function(R,F){M.forEach(function(K,O){if(!(F<O)){var _=R.x-K.x||.005,ft=R.y-K.y||.005,mt=_*_+ft*ft,st=Math.sqrt(mt);mt<1&&(mt=st),k["".concat(R.id,"-").concat(K.id)]={vx:_,vy:ft,vl2:mt,vl:st},k["".concat(K.id,"-").concat(R.id)]={vl2:mt,vl:st,vx:-_,vy:-ft}}})}),P.updateComboSizes(C),P.calRepulsive(L,k),P.calAttractive(L,k);var B=P.preventComboOverlap;B&&P.comboNonOverlapping(L,C)},Z.prototype.updateComboSizes=function(L){var P=this,C=P.comboTrees,M=P.nodeMap,k=P.nodeSize,B=P.comboSpacing,R=P.comboPadding;(C||[]).forEach(function(F){var K=[];(0,j.traverseTreeUp)(F,function(O){if(O.itemType==="node")return!0;var _=L[O.id];if(!_)return!1;var ft=O.children;ft&&ft.forEach(function(ut){!L[ut.id]&&!M[ut.id]||K.push(ut)}),_.minX=Infinity,_.minY=Infinity,_.maxX=-Infinity,_.maxY=-Infinity,K.forEach(function(ut){if(ut.itemType!=="node")return!0;var dt=M[ut.id];if(!dt)return!0;var gt=k(dt),wt=dt.x-gt,ot=dt.y-gt,pt=dt.x+gt,Nt=dt.y+gt;_.minX>wt&&(_.minX=wt),_.minY>ot&&(_.minY=ot),_.maxX<pt&&(_.maxX=pt),_.maxY<Nt&&(_.maxY=Nt)});var mt=P.oriComboMap[O.id].size||10;(0,j.isArray)(mt)&&(mt=mt[0]);var st=Math.max(_.maxX-_.minX,_.maxY-_.minY,mt);return _.r=st/2+B(_)/2+R(_),!0})})},Z.prototype.comboNonOverlapping=function(L,P){var C=this,M=C.comboTree,k=C.comboCollideStrength,B=C.indexMap,R=C.nodeMap;(0,j.traverseTreeUp)(M,function(F){if(!P[F.id]&&!R[F.id]&&F.id!=="comboTreeRoot")return!1;var K=F.children;return K&&K.length>1&&K.forEach(function(O,_){if(O.itemType==="node")return!1;var ft=P[O.id];!ft||K.forEach(function(mt,st){if(_<=st||mt.itemType==="node")return!1;var ut=P[mt.id];if(!ut)return!1;var dt=ft.cx-ut.cx||.005,gt=ft.cy-ut.cy||.005,wt=dt*dt+gt*gt,ot=ft.r||1,pt=ut.r||1,Nt=ot+pt,Gt=pt*pt,se=ot*ot;if(wt<Nt*Nt){var ie=O.children;if(!ie||ie.length===0)return!1;var Be=mt.children;if(!Be||Be.length===0)return!1;var ke=Math.sqrt(wt),we=(Nt-ke)/ke*k,At=dt*we,Yt=gt*we,be=Gt/(se+Gt),nn=1-be;ie.forEach(function(Ee){if(Ee.itemType!=="node")return!1;if(!!R[Ee.id]){var le=B[Ee.id];Be.forEach(function(Le){if(Le.itemType!=="node"||!R[Le.id])return!1;var Ze=B[Le.id];L[le].x+=At*be,L[le].y+=Yt*be,L[Ze].x-=At*nn,L[Ze].y-=Yt*nn})}})}})}),!0})},Z.prototype.calRepulsive=function(L,P){var C=this,M=C.nodes,k=C.width*C.optimizeRangeFactor,B=C.nodeStrength,R=C.alpha,F=C.nodeCollideStrength,K=C.preventNodeOverlap,O=C.nodeSize,_=C.nodeSpacing,ft=C.depthRepulsiveForceScale,mt=C.center;M.forEach(function(st,ut){if(!(!st.x||!st.y)){if(mt){var dt=C.gravity,gt=st.x-mt[0]||.005,wt=st.y-mt[1]||.005,ot=Math.sqrt(gt*gt+wt*wt);L[ut].x-=gt*dt*R/ot,L[ut].y-=wt*dt*R/ot}M.forEach(function(pt,Nt){if(ut!==Nt&&!(!pt.x||!pt.y)){var Gt=P["".concat(st.id,"-").concat(pt.id)],se=Gt.vl2,ie=Gt.vl;if(!(ie>k)){var Be=P["".concat(st.id,"-").concat(pt.id)],ke=Be.vx,we=Be.vy,At=Math.log(Math.abs(pt.depth-st.depth)/10)+1||1;At=At<1?1:At,pt.comboId!==st.comboId&&(At+=1);var Yt=At?Math.pow(ft,At):1,be=B(pt)*R/se*Yt;if(L[ut].x+=ke*be,L[ut].y+=we*be,ut<Nt&&K){var nn=O(st)+_(st)||1,Ee=O(pt)+_(pt)||1,le=nn+Ee;if(se<le*le){var Le=(le-ie)/ie*F,Ze=Ee*Ee,fe=Ze/(nn*nn+Ze),Re=ke*Le,He=we*Le;L[ut].x+=Re*fe,L[ut].y+=He*fe,fe=1-fe,L[Nt].x-=Re*fe,L[Nt].y-=He*fe}}}}})}})},Z.prototype.calAttractive=function(L,P){var C=this,M=C.edges,k=C.linkDistance,B=C.alpha,R=C.edgeStrength,F=C.bias,K=C.depthAttractiveForceScale;M.forEach(function(O,_){var ft=(0,j.getEdgeTerminal)(O,"source"),mt=(0,j.getEdgeTerminal)(O,"target");if(!(!ft||!mt||ft===mt)){var st=C.indexMap[ft],ut=C.indexMap[mt],dt=C.nodeMap[ft],gt=C.nodeMap[mt];if(!(!dt||!gt)){var wt=dt.depth===gt.depth?0:Math.log(Math.abs(dt.depth-gt.depth)/10);dt.comboId===gt.comboId&&(wt=wt/2);var ot=wt?Math.pow(K,wt):1;if(dt.comboId!==gt.comboId&&ot===1?ot=K/2:dt.comboId===gt.comboId&&(ot=2),!(!(0,j.isNumber)(gt.x)||!(0,j.isNumber)(dt.x)||!(0,j.isNumber)(gt.y)||!(0,j.isNumber)(dt.y))){var pt=P["".concat(mt,"-").concat(ft)],Nt=pt.vl,Gt=pt.vx,se=pt.vy,ie=(Nt-k(O))/Nt*B*R(O)*ot,Be=Gt*ie,ke=se*ie,we=F[_];L[ut].x-=Be*we,L[ut].y-=ke*we,L[st].x+=Be*(1-we),L[st].y+=ke*(1-we)}}}})},Z.prototype.getType=function(){return"comboForce"},Z}(tt.Base);it.ComboForceLayout=W},43281:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var Q=function(Z,L){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,C){P.__proto__=C}||function(P,C){for(var M in C)Object.prototype.hasOwnProperty.call(C,M)&&(P[M]=C[M])},Q(Z,L)};return function(Z,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");Q(Z,L);function P(){this.constructor=Z}Z.prototype=L===null?Object.create(L):(P.prototype=L.prototype,new P)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.ConcentricLayout=void 0;var tt=$(49784),j=$(62329),W=function(Q){X(Z,Q);function Z(L){var P=Q.call(this)||this;return P.nodeSize=30,P.minNodeSpacing=10,P.nodeSpacing=10,P.preventOverlap=!1,P.equidistant=!1,P.startAngle=3/2*Math.PI,P.clockwise=!0,P.sortBy="degree",P.nodes=[],P.edges=[],P.width=300,P.height=300,P.onLayoutEnd=function(){},P.updateCfg(L),P}return Z.prototype.getDefaultCfg=function(){return{nodeSize:30,minNodeSpacing:10,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}},Z.prototype.execute=function(){var L,P,C=this,M=C.nodes,k=C.edges,B=M.length;if(B===0){(L=C.onLayoutEnd)===null||L===void 0||L.call(C);return}!C.width&&typeof window!="undefined"&&(C.width=window.innerWidth),!C.height&&typeof window!="undefined"&&(C.height=window.innerHeight),C.center||(C.center=[C.width/2,C.height/2]);var R=C.center;if(B===1){M[0].x=R[0],M[0].y=R[1],(P=C.onLayoutEnd)===null||P===void 0||P.call(C);return}var F=C.nodeSize,K=C.nodeSpacing,O=[],_,ft=0;(0,tt.isArray)(F)?_=Math.max(F[0],F[1]):_=F,(0,tt.isArray)(K)?ft=Math.max(K[0],K[1]):(0,tt.isNumber)(K)&&(ft=K),M.forEach(function(At){O.push(At);var Yt=_;(0,tt.isArray)(At.size)?Yt=Math.max(At.size[0],At.size[1]):(0,tt.isNumber)(At.size)?Yt=At.size:(0,tt.isObject)(At.size)&&(Yt=Math.max(At.size.width,At.size.height)),_=Math.max(_,Yt),(0,tt.isFunction)(K)&&(ft=Math.max(K(At),ft))}),C.clockwise=C.counterclockwise!==void 0?!C.counterclockwise:C.clockwise;var mt={},st={};if(O.forEach(function(At,Yt){mt[At.id]=At,st[At.id]=Yt}),(C.sortBy==="degree"||!(0,tt.isString)(C.sortBy)||O[0][C.sortBy]===void 0)&&(C.sortBy="degree",!(0,tt.isNumber)(M[0].degree))){var ut=(0,tt.getDegree)(M.length,st,k);O.forEach(function(At,Yt){At.degree=ut[Yt].all})}O.sort(function(At,Yt){return Yt[C.sortBy]-At[C.sortBy]}),C.maxValueNode=O[0],C.maxLevelDiff=C.maxLevelDiff||C.maxValueNode[C.sortBy]/4;var dt=[[]],gt=dt[0];O.forEach(function(At){if(gt.length>0){var Yt=Math.abs(gt[0][C.sortBy]-At[C.sortBy]);C.maxLevelDiff&&Yt>=C.maxLevelDiff&&(gt=[],dt.push(gt))}gt.push(At)});var wt=_+(ft||C.minNodeSpacing);if(!C.preventOverlap){var ot=dt.length>0&&dt[0].length>1,pt=Math.min(C.width,C.height)/2-wt,Nt=pt/(dt.length+(ot?1:0));wt=Math.min(wt,Nt)}var Gt=0;if(dt.forEach(function(At){var Yt=C.sweep;Yt===void 0&&(Yt=2*Math.PI-2*Math.PI/At.length);var be=At.dTheta=Yt/Math.max(1,At.length-1);if(At.length>1&&C.preventOverlap){var nn=Math.cos(be)-Math.cos(0),Ee=Math.sin(be)-Math.sin(0),le=Math.sqrt(wt*wt/(nn*nn+Ee*Ee));Gt=Math.max(le,Gt)}At.r=Gt,Gt+=wt}),C.equidistant){for(var se=0,ie=0,Be=0;Be<dt.length;Be++){var ke=dt[Be],we=ke.r-ie;se=Math.max(se,we)}ie=0,dt.forEach(function(At,Yt){Yt===0&&(ie=At.r),At.r=ie,ie+=se})}return dt.forEach(function(At){var Yt=At.dTheta,be=At.r;At.forEach(function(nn,Ee){var le=C.startAngle+(C.clockwise?1:-1)*Yt*Ee;nn.x=R[0]+be*Math.cos(le),nn.y=R[1]+be*Math.sin(le)})}),C.onLayoutEnd&&C.onLayoutEnd(),{nodes:M,edges:k}},Z.prototype.getType=function(){return"concentric"},Z}(j.Base);it.ConcentricLayout=W},16470:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.FORCE_LAYOUT_TYPE_MAP=it.LAYOUT_MESSAGE=void 0,it.LAYOUT_MESSAGE={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"},it.FORCE_LAYOUT_TYPE_MAP={gForce:!0,force2:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0}},20171:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var C=function(M,k){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,R){B.__proto__=R}||function(B,R){for(var F in R)Object.prototype.hasOwnProperty.call(R,F)&&(B[F]=R[F])},C(M,k)};return function(M,k){if(typeof k!="function"&&k!==null)throw new TypeError("Class extends value "+String(k)+" is not a constructor or null");C(M,k);function B(){this.constructor=M}M.prototype=k===null?Object.create(k):(B.prototype=k.prototype,new B)}}(),tt=this&&this.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(it,"__esModule",{value:!0}),it.DagreLayout=void 0;var j=tt($(41106)),W=$(49784),Q=$(62329),Z=$(27652),L=function(C){X(M,C);function M(k){var B=C.call(this)||this;return B.rankdir="TB",B.nodesep=50,B.ranksep=50,B.controlPoints=!1,B.sortByCombo=!1,B.edgeLabelSpace=!0,B.radial=!1,B.nodes=[],B.edges=[],B.onLayoutEnd=function(){},B.layoutNode=function(R){var F=B,K=F.nodes,O=K.find(function(ft){return ft.id===R});if(O){var _=O.layout!==!1;return _}return!0},B.updateCfg(k),B}return M.prototype.getDefaultCfg=function(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}},M.prototype.execute=function(){var k=this,B,R,F,K,O=this,_=O.nodes,ft=O.nodeSize,mt=O.rankdir,st=O.combos,ut=O.begin,dt=O.radial,gt=O.comboEdges,wt=gt===void 0?[]:gt,ot=O.vedges,pt=ot===void 0?[]:ot;if(!!_){var Nt=O.edges||[],Gt=new Z.Graph({multigraph:!0,compound:!0});O.nodeMap={};var se={};_.forEach(function(Mn){O.nodeMap[Mn.id]=Mn,!!Mn.comboId&&(se[Mn.comboId]=se[Mn.comboId]||[],se[Mn.comboId].push(Mn.id))});var ie=[],Be={};((B=O.nodeOrder)===null||B===void 0?void 0:B.length)?(O.nodeOrder.forEach(function(Mn){Be[Mn]=!0,ie.push(O.nodeMap[Mn])}),_.forEach(function(Mn){Be[Mn.id]||ie.push(Mn)})):ie=_;var ke;ft?(0,W.isArray)(ft)?ke=function(){return ft}:ke=function(){return[ft,ft]}:ke=function(Mn){return Mn.size?(0,W.isArray)(Mn.size)?Mn.size:(0,W.isObject)(Mn.size)?[Mn.size.width||40,Mn.size.height||40]:[Mn.size,Mn.size]:[40,40]};var we=(0,W.getFunc)(O.ranksep,50,O.ranksepFunc),At=(0,W.getFunc)(O.nodesep,50,O.nodesepFunc),Yt=At,be=we;(mt==="LR"||mt==="RL")&&(Yt=we,be=At),Gt.setDefaultEdgeLabel(function(){return{}}),Gt.setGraph(O);var nn={};this.sortByCombo&&st&&st.forEach(function(Mn){if(nn[Mn.id]=Mn,Mn.collapsed){var ar=ke(Mn),Fn=be(Mn),tr=Yt(Mn),Gn=ar[0]+2*tr,jr=ar[1]+2*Fn;Gt.setNode(Mn.id,{width:Gn,height:jr})}!Mn.parentId||(nn[Mn.parentId]||Gt.setNode(Mn.parentId,{}),Gt.setParent(Mn.id,Mn.parentId))}),ie.filter(function(Mn){return Mn.layout!==!1}).forEach(function(Mn){var ar=ke(Mn),Fn=be(Mn),tr=Yt(Mn),Gn=ar[0]+2*tr,jr=ar[1]+2*Fn,Hr=Mn.layer;(0,W.isNumber)(Hr)?Gt.setNode(Mn.id,{width:Gn,height:jr,layer:Hr}):Gt.setNode(Mn.id,{width:Gn,height:jr}),k.sortByCombo&&Mn.comboId&&(nn[Mn.comboId]||(nn[Mn.comboId]={id:Mn.comboId},Gt.setNode(Mn.comboId,{})),Gt.setParent(Mn.id,Mn.comboId))}),Nt.forEach(function(Mn){var ar=(0,W.getEdgeTerminal)(Mn,"source"),Fn=(0,W.getEdgeTerminal)(Mn,"target");k.layoutNode(ar)&&k.layoutNode(Fn)&&Gt.setEdge(ar,Fn,{weight:Mn.weight||1})}),(R=wt==null?void 0:wt.concat(pt||[]))===null||R===void 0||R.forEach(function(Mn){var ar,Fn,tr=Mn.source,Gn=Mn.target,jr=((ar=nn[tr])===null||ar===void 0?void 0:ar.collapsed)?[tr]:se[tr]||[tr],Hr=((Fn=nn[Gn])===null||Fn===void 0?void 0:Fn.collapsed)?[Gn]:se[Gn]||[Gn];jr.forEach(function(Ea){Hr.forEach(function(lr){Gt.setEdge(Ea,lr,{weight:Mn.weight||1})})})});var Ee=void 0;((F=O.preset)===null||F===void 0?void 0:F.nodes)&&(Ee=new Z.Graph({multigraph:!0,compound:!0}),O.preset.nodes.forEach(function(Mn){Ee==null||Ee.setNode(Mn.id,Mn)})),j.default.layout(Gt,{prevGraph:Ee,edgeLabelSpace:O.edgeLabelSpace,keepNodeOrder:Boolean(!!O.nodeOrder),nodeOrder:O.nodeOrder});var le=[0,0];if(ut){var Le=Infinity,Ze=Infinity;Gt.nodes().forEach(function(Mn){var ar=Gt.node(Mn);Le>ar.x&&(Le=ar.x),Ze>ar.y&&(Ze=ar.y)}),Gt.edges().forEach(function(Mn){var ar,Fn=Gt.edge(Mn);(ar=Fn.points)===null||ar===void 0||ar.forEach(function(tr){Le>tr.x&&(Le=tr.x),Ze>tr.y&&(Ze=tr.y)})}),le[0]=ut[0]-Le,le[1]=ut[1]-Ze}var fe=mt==="LR"||mt==="RL";if(dt){var Re=this,He=Re.focusNode,pe=Re.ranksep,Ge=Re.getRadialPos,te=(0,W.isString)(He)?He:He==null?void 0:He.id,Me=te?(K=Gt.node(te))===null||K===void 0?void 0:K._rank:0,We=[],ee=fe?"y":"x",Pt=fe?"height":"width",yt=Infinity,Ne=-Infinity;Gt.nodes().forEach(function(Mn){var ar=Gt.node(Mn);if(!!O.nodeMap[Mn]){var Fn=At(O.nodeMap[Mn]);if(Me===0)We[ar._rank]||(We[ar._rank]={nodes:[],totalWidth:0,maxSize:-Infinity}),We[ar._rank].nodes.push(Mn),We[ar._rank].totalWidth+=Fn*2+ar[Pt],We[ar._rank].maxSize<Math.max(ar.width,ar.height)&&(We[ar._rank].maxSize=Math.max(ar.width,ar.height));else{var tr=ar._rank-Me;if(tr===0)We[tr]||(We[tr]={nodes:[],totalWidth:0,maxSize:-Infinity}),We[tr].nodes.push(Mn),We[tr].totalWidth+=Fn*2+ar[Pt],We[tr].maxSize<Math.max(ar.width,ar.height)&&(We[tr].maxSize=Math.max(ar.width,ar.height));else{var Gn=Math.abs(tr);We[Gn]||(We[Gn]={left:[],right:[],totalWidth:0,maxSize:-Infinity}),We[Gn].totalWidth+=Fn*2+ar[Pt],We[Gn].maxSize<Math.max(ar.width,ar.height)&&(We[Gn].maxSize=Math.max(ar.width,ar.height)),tr<0?We[Gn].left.push(Mn):We[Gn].right.push(Mn)}}var jr=ar[ee]-ar[Pt]/2-Fn,Hr=ar[ee]+ar[Pt]/2+Fn;jr<yt&&(yt=jr),Hr>Ne&&(Ne=Hr)}});var tn=pe||50,fn={},Rt=(Ne-yt)/.9,Yn=[(yt+Ne-Rt)*.5,(yt+Ne+Rt)*.5],Un=function(Mn,ar,Fn,tr){Fn===void 0&&(Fn=-Infinity),tr===void 0&&(tr=[0,1]);var Gn=Fn;return Mn.forEach(function(jr){var Hr=Gt.node(jr);fn[jr]=ar;var Ea=Ge(Hr[ee],Yn,Rt,ar,tr),lr=Ea.x,Cr=Ea.y;if(!!O.nodeMap[jr]){O.nodeMap[jr].x=lr+le[0],O.nodeMap[jr].y=Cr+le[1],O.nodeMap[jr]._order=Hr._order;var vr=we(O.nodeMap[jr]);Gn<vr&&(Gn=vr)}}),Gn},xr=!0,cr=0;We.forEach(function(Mn){var ar,Fn,tr,Gn,jr,Hr,Ea;if(!(!((ar=Mn==null?void 0:Mn.nodes)===null||ar===void 0?void 0:ar.length)&&!((Fn=Mn==null?void 0:Mn.left)===null||Fn===void 0?void 0:Fn.length)&&!((tr=Mn==null?void 0:Mn.right)===null||tr===void 0?void 0:tr.length))){if(xr&&Mn.nodes.length===1){var lr=Mn.nodes[0];if(!O.nodeMap[lr])return;O.nodeMap[lr].x=le[0],O.nodeMap[lr].y=le[1],fn[Mn.nodes[0]]=0,tn=we(O.nodeMap[lr]),xr=!1;return}tn=Math.max(tn,Mn.totalWidth/(2*Math.PI));var Cr=-Infinity;if(Me===0||((Gn=Mn.nodes)===null||Gn===void 0?void 0:Gn.length))Cr=Un(Mn.nodes,tn,Cr,[0,1]);else{var vr=((jr=Mn.left)===null||jr===void 0?void 0:jr.length)/(((Hr=Mn.left)===null||Hr===void 0?void 0:Hr.length)+((Ea=Mn.right)===null||Ea===void 0?void 0:Ea.length));Cr=Un(Mn.left,tn,Cr,[0,vr]),Cr=Un(Mn.right,tn,Cr,[vr+.05,1])}tn+=Cr,xr=!1,cr-Mn.maxSize}}),Gt.edges().forEach(function(Mn){var ar,Fn,tr,Gn=Gt.edge(Mn),jr=Nt.findIndex(function(ra){var Zr=(0,W.getEdgeTerminal)(ra,"source"),vt=(0,W.getEdgeTerminal)(ra,"target");return Zr===Mn.v&&vt===Mn.w});if(!(jr<=-1)&&O.edgeLabelSpace&&O.controlPoints&&Nt[jr].type!=="loop"){var Hr=ee==="x"?"y":"x",Ea=(ar=Gn==null?void 0:Gn.points)===null||ar===void 0?void 0:ar.slice(1,Gn.points.length-1),lr=[],Cr=(Fn=Gt.node(Mn.v))===null||Fn===void 0?void 0:Fn[Hr],vr=Cr-((tr=Gt.node(Mn.w))===null||tr===void 0?void 0:tr[Hr]),Tr=fn[Mn.v],ta=Tr-fn[Mn.w];Ea==null||Ea.forEach(function(ra){var Zr=(ra[Hr]-Cr)/vr*ta+Tr,vt=Ge(ra[ee],Yn,Rt,Zr);lr.push({x:vt.x+le[0],y:vt.y+le[1]})}),Nt[jr].controlPoints=lr}})}else{var Ur=new Set,fa=mt==="BT"||mt==="RL",Sa=fa?function(Mn,ar){return ar-Mn}:function(Mn,ar){return Mn-ar};Gt.nodes().forEach(function(Mn){var ar=Gt.node(Mn);if(!!ar){var Fn=k.nodeMap[Mn];Fn||(Fn=st==null?void 0:st.find(function(tr){return tr.id===Mn})),!!Fn&&(Fn.x=ar.x+le[0],Fn.y=ar.y+le[1],Fn._order=ar._order,Ur.add(fe?Fn.x:Fn.y))}});var sa=Array.from(Ur).sort(Sa),Da=fe?function(Mn,ar){return Mn.x!==ar.x}:function(Mn,ar){return Mn.y!==ar.y},Rr=fe?function(Mn,ar,Fn){var tr=Math.max(ar.y,Fn.y),Gn=Math.min(ar.y,Fn.y);return Mn.filter(function(jr){return jr.y<=tr&&jr.y>=Gn})}:function(Mn,ar,Fn){var tr=Math.max(ar.x,Fn.x),Gn=Math.min(ar.x,Fn.x);return Mn.filter(function(jr){return jr.x<=tr&&jr.x>=Gn})};Gt.edges().forEach(function(Mn){var ar,Fn=Gt.edge(Mn),tr=Nt.findIndex(function(Hr){var Ea=(0,W.getEdgeTerminal)(Hr,"source"),lr=(0,W.getEdgeTerminal)(Hr,"target");return Ea===Mn.v&&lr===Mn.w});if(!(tr<=-1)&&O.edgeLabelSpace&&O.controlPoints&&Nt[tr].type!=="loop"){(ar=Fn==null?void 0:Fn.points)===null||ar===void 0||ar.forEach(function(Hr){Hr.x+=le[0],Hr.y+=le[1]});var Gn=O.nodeMap[Mn.v],jr=O.nodeMap[Mn.w];Nt[tr].controlPoints=P(Fn==null?void 0:Fn.points,Gn,jr,sa,fe,Da,Rr)}})}return O.onLayoutEnd&&O.onLayoutEnd(),{nodes:_,edges:Nt}}},M.prototype.getRadialPos=function(k,B,R,F,K){K===void 0&&(K=[0,1]);var O=(k-B[0])/R;O=O*(K[1]-K[0])+K[0];var _=O*2*Math.PI;return{x:Math.cos(_)*F,y:Math.sin(_)*F}},M.prototype.getType=function(){return"dagre"},M}(Q.Base);it.DagreLayout=L;var P=function(C,M,k,B,R,F,K){var O=(C==null?void 0:C.slice(1,C.length-1))||[];if(M&&k){var _=M.x,ft=M.y,mt=k.x,st=k.y;if(R&&(_=M.y,ft=M.x,mt=k.y,st=k.x),st!==ft&&_!==mt){var ut=B.indexOf(ft),dt=B[ut+1];if(dt){var gt=O[0],wt=R?{x:(ft+dt)/2,y:(gt==null?void 0:gt.y)||mt}:{x:(gt==null?void 0:gt.x)||mt,y:(ft+dt)/2};(!gt||F(gt,wt))&&O.unshift(wt)}var ot=B.indexOf(st),pt=Math.abs(ot-ut);if(pt===1)O=K(O,M,k),O.length||O.push(R?{x:(ft+st)/2,y:_}:{x:_,y:(ft+st)/2});else if(pt>1){var Nt=B[ot-1];if(Nt){var Gt=O[O.length-1],se=R?{x:(st+Nt)/2,y:(Gt==null?void 0:Gt.y)||mt}:{x:(Gt==null?void 0:Gt.x)||_,y:(st+Nt)/2};(!Gt||F(Gt,se))&&O.push(se)}}}}return O}},27652:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var W=function(Q,Z){return W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,P){L.__proto__=P}||function(L,P){for(var C in P)Object.prototype.hasOwnProperty.call(P,C)&&(L[C]=P[C])},W(Q,Z)};return function(Q,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");W(Q,Z);function L(){this.constructor=Q}Q.prototype=Z===null?Object.create(Z):(L.prototype=Z.prototype,new L)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.Graph=void 0;var tt=$(69787),j=function(W){X(Q,W);function Q(){return W!==null&&W.apply(this,arguments)||this}return Q}(tt.Graph);it.Graph=j},41106:function(sr,it,$){"use strict";var X=this&&this.__importDefault||function(W){return W&&W.__esModule?W:{default:W}};Object.defineProperty(it,"__esModule",{value:!0});var tt=X($(65236)),j=$(69209);it.default={layout:tt.default,util:{time:j.time,notime:j.notime}}},78029:function(sr,it,$){"use strict";var X=this&&this.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}};Object.defineProperty(it,"__esModule",{value:!0});var tt=X($(40773)),j=function(Z){var L=function(C){return function(M){var k;return((k=C.edge(M))===null||k===void 0?void 0:k.weight)||1}},P=Z.graph().acyclicer==="greedy"?(0,tt.default)(Z,L(Z)):W(Z);P==null||P.forEach(function(C){var M=Z.edge(C);Z.removeEdgeObj(C),M.forwardName=C.name,M.reversed=!0,Z.setEdge(C.w,C.v,M,"rev-".concat(Math.random()))})},W=function(Z){var L=[],P={},C={},M=function(k){var B;C[k]||(C[k]=!0,P[k]=!0,(B=Z.outEdges(k))===null||B===void 0||B.forEach(function(R){P[R.w]?L.push(R):M(R.w)}),delete P[k])};return Z.nodes().forEach(M),L},Q=function(Z){Z.edges().forEach(function(L){var P=Z.edge(L);if(P.reversed){Z.removeEdgeObj(L);var C=P.forwardName;delete P.reversed,delete P.forwardName,Z.setEdge(L.w,L.v,P,C)}})};it.default={run:j,undo:Q}},11500:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var X=$(69209),tt=function(W){var Q,Z=function(L){var P=W.children(L),C=W.node(L);if((P==null?void 0:P.length)&&P.forEach(function(B){return Z(B)}),C.hasOwnProperty("minRank")){C.borderLeft=[],C.borderRight=[];for(var M=C.minRank,k=C.maxRank+1;M<k;M+=1)j(W,"borderLeft","_bl",L,C,M),j(W,"borderRight","_br",L,C,M)}};(Q=W.children())===null||Q===void 0||Q.forEach(function(L){return Z(L)})},j=function(W,Q,Z,L,P,C){var M={rank:C,borderType:Q,width:0,height:0},k=P[Q][C-1],B=(0,X.addDummyNode)(W,"border",M,Z);P[Q][C]=B,W.setParent(B,L),k&&W.setEdge(k,B,{weight:1})};it.default=tt},35279:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=function(P){var C,M=(C=P.graph().rankdir)===null||C===void 0?void 0:C.toLowerCase();(M==="lr"||M==="rl")&&tt(P)},X=function(P){var C,M=(C=P.graph().rankdir)===null||C===void 0?void 0:C.toLowerCase();(M==="bt"||M==="rl")&&W(P),(M==="lr"||M==="rl")&&(Z(P),tt(P))},tt=function(P){P.nodes().forEach(function(C){j(P.node(C))}),P.edges().forEach(function(C){j(P.edge(C))})},j=function(P){var C=P.width;P.width=P.height,P.height=C},W=function(P){P.nodes().forEach(function(C){Q(P.node(C))}),P.edges().forEach(function(C){var M,k=P.edge(C);(M=k.points)===null||M===void 0||M.forEach(function(B){return Q(B)}),k.hasOwnProperty("y")&&Q(k)})},Q=function(P){(P==null?void 0:P.y)&&(P.y=-P.y)},Z=function(P){P.nodes().forEach(function(C){L(P.node(C))}),P.edges().forEach(function(C){var M,k=P.edge(C);(M=k.points)===null||M===void 0||M.forEach(function(B){return L(B)}),k.hasOwnProperty("x")&&L(k)})},L=function(P){var C=P.x;P.x=P.y,P.y=C};it.default={adjust:$,undo:X}},55532:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=function(j,W){if(j!=="next"&&j!=="prev")return W},X=function(j){j.prev.next=j.next,j.next.prev=j.prev,delete j.next,delete j.prev},tt=function(){function j(){var W={};W.prev=W,W.next=W.prev,this.shortcut=W}return j.prototype.dequeue=function(){var W=this.shortcut,Q=W.prev;if(Q&&Q!==W)return X(Q),Q},j.prototype.enqueue=function(W){var Q=this.shortcut;W.prev&&W.next&&X(W),W.next=Q.next,Q.next.prev=W,Q.next=W,W.prev=Q},j.prototype.toString=function(){for(var W=[],Q=this.shortcut,Z=Q.prev;Z!==Q;)W.push(JSON.stringify(Z,$)),Z=Z==null?void 0:Z.prev;return"[".concat(W.join(", "),"]")},j}();it.default=tt},40773:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var R=function(F,K){return R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,_){O.__proto__=_}||function(O,_){for(var ft in _)Object.prototype.hasOwnProperty.call(_,ft)&&(O[ft]=_[ft])},R(F,K)};return function(F,K){if(typeof K!="function"&&K!==null)throw new TypeError("Class extends value "+String(K)+" is not a constructor or null");R(F,K);function O(){this.constructor=F}F.prototype=K===null?Object.create(K):(O.prototype=K.prototype,new O)}}(),tt=this&&this.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(it,"__esModule",{value:!0});var j=tt($(55532)),W=$(69787),Q=function(R){X(F,R);function F(){return R!==null&&R.apply(this,arguments)||this}return F}(j.default),Z=function(R){X(F,R);function F(){return R!==null&&R.apply(this,arguments)||this}return F}(W.Graph),L=function(){return 1},P=function(R,F){var K;if(R.nodeCount()<=1)return[];var O=k(R,F||L),_=C(O.graph,O.buckets,O.zeroIdx);return(K=_.map(function(ft){return R.outEdges(ft.v,ft.w)}))===null||K===void 0?void 0:K.flat()},C=function(R,F,K){for(var O=[],_=F[F.length-1],ft=F[0],mt;R.nodeCount();){for(;mt=ft.dequeue();)M(R,F,K,mt);for(;mt=_.dequeue();)M(R,F,K,mt);if(R.nodeCount()){for(var st=F.length-2;st>0;--st)if(mt=F[st].dequeue(),mt){O=O.concat(M(R,F,K,mt,!0));break}}}return O},M=function(R,F,K,O,_){var ft,mt,st=[];return(ft=R.inEdges(O.v))===null||ft===void 0||ft.forEach(function(ut){var dt=R.edge(ut),gt=R.node(ut.v);_&&st.push({v:ut.v,w:ut.w,in:0,out:0}),gt.out===void 0&&(gt.out=0),gt.out-=dt,B(F,K,gt)}),(mt=R.outEdges(O.v))===null||mt===void 0||mt.forEach(function(ut){var dt=R.edge(ut),gt=ut.w,wt=R.node(gt);wt.in===void 0&&(wt.in=0),wt.in-=dt,B(F,K,wt)}),R.removeNode(O.v),_?st:void 0},k=function(R,F){var K=new Z,O=0,_=0;R.nodes().forEach(function(dt){K.setNode(dt,{v:dt,in:0,out:0})}),R.edges().forEach(function(dt){var gt=K.edge(dt)||0,wt=(F==null?void 0:F(dt))||1,ot=gt+wt;K.setEdge(dt.v,dt.w,ot),_=Math.max(_,K.node(dt.v).out+=wt),O=Math.max(O,K.node(dt.w).in+=wt)});for(var ft=[],mt=_+O+3,st=0;st<mt;st++)ft.push(new Q);var ut=O+1;return K.nodes().forEach(function(dt){B(ft,ut,K.node(dt))}),{buckets:ft,zeroIdx:ut,graph:K}},B=function(R,F,K){K.out?K.in?R[K.out-K.in+F].enqueue(K):R[R.length-1].enqueue(K):R[0].enqueue(K)};it.default=P},65236:function(sr,it,$){"use strict";var X=this&&this.__assign||function(){return X=Object.assign||function(fe){for(var Re,He=1,pe=arguments.length;He<pe;He++){Re=arguments[He];for(var Ge in Re)Object.prototype.hasOwnProperty.call(Re,Ge)&&(fe[Ge]=Re[Ge])}return fe},X.apply(this,arguments)},tt=this&&this.__importDefault||function(fe){return fe&&fe.__esModule?fe:{default:fe}};Object.defineProperty(it,"__esModule",{value:!0});var j=tt($(78029)),W=tt($(46171)),Q=tt($(76827)),Z=$(69209),L=tt($(33562)),P=tt($(59596)),C=tt($(11500)),M=tt($(35279)),k=tt($(19597)),B=tt($(95)),R=tt($(24956)),F=$(27652),K=function(fe,Re){var He=Re&&Re.debugTiming?Z.time:Z.notime;He("layout",function(){Re&&!Re.keepNodeOrder&&Re.prevGraph&&He("  inheritOrder",function(){_(fe,Re.prevGraph)});var pe=He("  buildLayoutGraph",function(){return Nt(fe)});Re&&Re.edgeLabelSpace===!1||He("  makeSpaceForEdgeLabels",function(){Gt(pe)});try{He("  runLayout",function(){O(pe,He,Re)})}catch(Ge){if(Ge.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,Ge);return}throw Ge}He("  updateInputGraph",function(){ft(fe,pe)})})},O=function(fe,Re,He){Re("    removeSelfEdges",function(){nn(fe)}),Re("    acyclic",function(){j.default.run(fe)}),Re("    nestingGraph.run",function(){P.default.run(fe)}),Re("    rank",function(){(0,Q.default)((0,Z.asNonCompoundGraph)(fe))}),Re("    injectEdgeLabelProxies",function(){se(fe)}),Re("    removeEmptyRanks",function(){(0,Z.removeEmptyRanks)(fe)}),Re("    nestingGraph.cleanup",function(){P.default.cleanup(fe)}),Re("    normalizeRanks",function(){(0,Z.normalizeRanks)(fe)}),Re("    assignRankMinMax",function(){ie(fe)}),Re("    removeEdgeLabelProxies",function(){Be(fe)}),Re("    normalize.run",function(){W.default.run(fe)}),Re("    parentDummyChains",function(){(0,L.default)(fe)}),Re("    addBorderSegments",function(){(0,C.default)(fe)}),He&&He.keepNodeOrder&&Re("    initDataOrder",function(){(0,R.default)(fe,He.nodeOrder)}),Re("    order",function(){(0,k.default)(fe,He==null?void 0:He.keepNodeOrder)}),Re("    insertSelfEdges",function(){Ee(fe)}),Re("    adjustCoordinateSystem",function(){M.default.adjust(fe)}),Re("    position",function(){(0,B.default)(fe)}),Re("    positionSelfEdges",function(){le(fe)}),Re("    removeBorderNodes",function(){be(fe)}),Re("    normalize.undo",function(){W.default.undo(fe)}),Re("    fixupEdgeLabelCoords",function(){At(fe)}),Re("    undoCoordinateSystem",function(){M.default.undo(fe)}),Re("    translateGraph",function(){ke(fe)}),Re("    assignNodeIntersects",function(){we(fe)}),Re("    reversePoints",function(){Yt(fe)}),Re("    acyclic.undo",function(){j.default.undo(fe)})},_=function(fe,Re){fe.nodes().forEach(function(He){var pe=fe.node(He),Ge=Re.node(He);Ge!==void 0?(pe.fixorder=Ge._order,delete Ge._order):delete pe.fixorder})},ft=function(fe,Re){fe.nodes().forEach(function(He){var pe,Ge=fe.node(He);if(Ge){var te=Re.node(He);Ge.x=te.x,Ge.y=te.y,Ge._order=te.order,Ge._rank=te.rank,((pe=Re.children(He))===null||pe===void 0?void 0:pe.length)&&(Ge.width=te.width,Ge.height=te.height)}}),fe.edges().forEach(function(He){var pe=fe.edge(He),Ge=Re.edge(He);pe.points=Ge?Ge.points:[],Ge&&Ge.hasOwnProperty("x")&&(pe.x=Ge.x,pe.y=Ge.y)}),fe.graph().width=Re.graph().width,fe.graph().height=Re.graph().height},mt=["nodesep","edgesep","ranksep","marginx","marginy"],st={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},ut=["acyclicer","ranker","rankdir","align"],dt=["width","height","layer","fixorder"],gt={width:0,height:0},wt=["minlen","weight","width","height","labeloffset"],ot={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},pt=["labelpos"],Nt=function(fe){var Re=new F.Graph({multigraph:!0,compound:!0}),He=Ze(fe.graph()),pe={};return ut==null||ut.forEach(function(Ge){He[Ge]!==void 0&&(pe[Ge]=He[Ge])}),Re.setGraph(Object.assign({},st,Le(He,mt),pe)),fe.nodes().forEach(function(Ge){var te=Ze(fe.node(Ge)),Me=X(X({},gt),te),We=Le(Me,dt);Re.setNode(Ge,We),Re.setParent(Ge,fe.parent(Ge))}),fe.edges().forEach(function(Ge){var te=Ze(fe.edge(Ge)),Me={};pt==null||pt.forEach(function(We){te[We]!==void 0&&(Me[We]=te[We])}),Re.setEdgeObj(Ge,Object.assign({},ot,Le(te,wt),Me))}),Re},Gt=function(fe){var Re=fe.graph();Re.ranksep||(Re.ranksep=0),Re.ranksep/=2,fe.nodes().forEach(function(He){var pe=fe.node(He);isNaN(pe.layer)||pe.layer||(pe.layer=0)}),fe.edges().forEach(function(He){var pe,Ge=fe.edge(He);Ge.minlen*=2,((pe=Ge.labelpos)===null||pe===void 0?void 0:pe.toLowerCase())!=="c"&&(Re.rankdir==="TB"||Re.rankdir==="BT"?Ge.width+=Ge.labeloffset:Ge.height+=Ge.labeloffset)})},se=function(fe){fe.edges().forEach(function(Re){var He=fe.edge(Re);if(He.width&&He.height){var pe=fe.node(Re.v),Ge=fe.node(Re.w),te={e:Re,rank:(Ge.rank-pe.rank)/2+pe.rank};(0,Z.addDummyNode)(fe,"edge-proxy",te,"_ep")}})},ie=function(fe){var Re=0;fe.nodes().forEach(function(He){var pe,Ge,te=fe.node(He);te.borderTop&&(te.minRank=(pe=fe.node(te.borderTop))===null||pe===void 0?void 0:pe.rank,te.maxRank=(Ge=fe.node(te.borderBottom))===null||Ge===void 0?void 0:Ge.rank,Re=Math.max(Re,te.maxRank||-Infinity))}),fe.graph().maxRank=Re},Be=function(fe){fe.nodes().forEach(function(Re){var He=fe.node(Re);He.dummy==="edge-proxy"&&(fe.edge(He.e).labelRank=He.rank,fe.removeNode(Re))})},ke=function(fe){var Re,He=0,pe,Ge=0,te=fe.graph(),Me=te.marginx||0,We=te.marginy||0,ee=function(Pt){if(!!Pt){var yt=Pt.x,Ne=Pt.y,tn=Pt.width,fn=Pt.height;!isNaN(yt)&&!isNaN(tn)&&(Re===void 0&&(Re=yt-tn/2),Re=Math.min(Re,yt-tn/2),He=Math.max(He,yt+tn/2)),!isNaN(Ne)&&!isNaN(fn)&&(pe===void 0&&(pe=Ne-fn/2),pe=Math.min(pe,Ne-fn/2),Ge=Math.max(Ge,Ne+fn/2))}};fe.nodes().forEach(function(Pt){ee(fe.node(Pt))}),fe.edges().forEach(function(Pt){var yt=fe.edge(Pt);(yt==null?void 0:yt.hasOwnProperty("x"))&&ee(yt)}),Re-=Me,pe-=We,fe.nodes().forEach(function(Pt){var yt=fe.node(Pt);yt&&(yt.x-=Re,yt.y-=pe)}),fe.edges().forEach(function(Pt){var yt,Ne=fe.edge(Pt);(yt=Ne.points)===null||yt===void 0||yt.forEach(function(tn){tn.x-=Re,tn.y-=pe}),Ne.hasOwnProperty("x")&&(Ne.x-=Re),Ne.hasOwnProperty("y")&&(Ne.y-=pe)}),te.width=He-Re+Me,te.height=Ge-pe+We},we=function(fe){fe.edges().forEach(function(Re){var He=fe.edge(Re),pe=fe.node(Re.v),Ge=fe.node(Re.w),te,Me;He.points?(te=He.points[0],Me=He.points[He.points.length-1]):(He.points=[],te=Ge,Me=pe),He.points.unshift((0,Z.intersectRect)(pe,te)),He.points.push((0,Z.intersectRect)(Ge,Me))})},At=function(fe){fe.edges().forEach(function(Re){var He=fe.edge(Re);if(He==null?void 0:He.hasOwnProperty("x"))switch((He.labelpos==="l"||He.labelpos==="r")&&(He.width-=He.labeloffset),He.labelpos){case"l":He.x-=He.width/2+He.labeloffset;break;case"r":He.x+=He.width/2+He.labeloffset;break}})},Yt=function(fe){fe.edges().forEach(function(Re){var He,pe=fe.edge(Re);pe.reversed&&((He=pe.points)===null||He===void 0||He.reverse())})},be=function(fe){fe.nodes().forEach(function(Re){var He,pe,Ge;if((He=fe.children(Re))===null||He===void 0?void 0:He.length){var te=fe.node(Re),Me=fe.node(te.borderTop),We=fe.node(te.borderBottom),ee=fe.node(te.borderLeft[((pe=te.borderLeft)===null||pe===void 0?void 0:pe.length)-1]),Pt=fe.node(te.borderRight[((Ge=te.borderRight)===null||Ge===void 0?void 0:Ge.length)-1]);te.width=Math.abs((Pt==null?void 0:Pt.x)-(ee==null?void 0:ee.x))||10,te.height=Math.abs((We==null?void 0:We.y)-(Me==null?void 0:Me.y))||10,te.x=((ee==null?void 0:ee.x)||0)+te.width/2,te.y=((Me==null?void 0:Me.y)||0)+te.height/2}}),fe.nodes().forEach(function(Re){var He;((He=fe.node(Re))===null||He===void 0?void 0:He.dummy)==="border"&&fe.removeNode(Re)})},nn=function(fe){fe.edges().forEach(function(Re){if(Re.v===Re.w){var He=fe.node(Re.v);He.selfEdges||(He.selfEdges=[]),He.selfEdges.push({e:Re,label:fe.edge(Re)}),fe.removeEdgeObj(Re)}})},Ee=function(fe){var Re=(0,Z.buildLayerMatrix)(fe);Re==null||Re.forEach(function(He){var pe=0;He==null||He.forEach(function(Ge,te){var Me,We=fe.node(Ge);We.order=te+pe,(Me=We.selfEdges)===null||Me===void 0||Me.forEach(function(ee){(0,Z.addDummyNode)(fe,"selfedge",{width:ee.label.width,height:ee.label.height,rank:We.rank,order:te+ ++pe,e:ee.e,label:ee.label},"_se")}),delete We.selfEdges})})},le=function(fe){fe.nodes().forEach(function(Re){var He=fe.node(Re);if(He.dummy==="selfedge"){var pe=fe.node(He.e.v),Ge=pe.x+pe.width/2,te=pe.y,Me=He.x-Ge,We=pe.height/2;fe.setEdgeObj(He.e,He.label),fe.removeNode(Re),He.label.points=[{x:Ge+2*Me/3,y:te-We},{x:Ge+5*Me/6,y:te-We},{y:te,x:Ge+Me},{x:Ge+5*Me/6,y:te+We},{x:Ge+2*Me/3,y:te+We}],He.label.x=He.x,He.label.y=He.y}})},Le=function(fe,Re){var He={};return Re==null||Re.forEach(function(pe){fe[pe]!==void 0&&(He[pe]=+fe[pe])}),He},Ze=function(fe){fe===void 0&&(fe={});var Re={};return Object.keys(fe).forEach(function(He){Re[He.toLowerCase()]=fe[He]}),Re};it.default=K},59596:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var X=$(69209),tt=function(L){var P,C=(0,X.addDummyNode)(L,"root",{},"_root"),M=W(L),k=Math.max.apply(Math,Object.values(M));Math.abs(k)===Infinity&&(k=1);var B=k-1,R=2*B+1;L.graph().nestingRoot=C,L.edges().forEach(function(K){L.edge(K).minlen*=R});var F=Q(L)+1;(P=L.children())===null||P===void 0||P.forEach(function(K){j(L,C,R,F,B,M,K)}),L.graph().nodeRankFactor=R},j=function(L,P,C,M,k,B,R){var F=L.children(R);if(!(F==null?void 0:F.length)){R!==P&&L.setEdge(P,R,{weight:0,minlen:C});return}var K=(0,X.addBorderNode)(L,"_bt"),O=(0,X.addBorderNode)(L,"_bb"),_=L.node(R);L.setParent(K,R),_.borderTop=K,L.setParent(O,R),_.borderBottom=O,F==null||F.forEach(function(ft){j(L,P,C,M,k,B,ft);var mt=L.node(ft),st=mt.borderTop?mt.borderTop:ft,ut=mt.borderBottom?mt.borderBottom:ft,dt=mt.borderTop?M:2*M,gt=st!==ut?1:k-B[R]+1;L.setEdge(K,st,{minlen:gt,weight:dt,nestingEdge:!0}),L.setEdge(ut,O,{minlen:gt,weight:dt,nestingEdge:!0})}),L.parent(R)||L.setEdge(P,K,{weight:0,minlen:k+B[R]})},W=function(L){var P,C={},M=function(k,B){var R=L.children(k);R==null||R.forEach(function(F){return M(F,B+1)}),C[k]=B};return(P=L.children())===null||P===void 0||P.forEach(function(k){return M(k,1)}),C},Q=function(L){var P=0;return L.edges().forEach(function(C){P+=L.edge(C).weight}),P},Z=function(L){var P=L.graph();P.nestingRoot&&L.removeNode(P.nestingRoot),delete P.nestingRoot,L.edges().forEach(function(C){var M=L.edge(C);M.nestingEdge&&L.removeEdgeObj(C)})};it.default={run:tt,cleanup:Z}},46171:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var X=$(69209),tt=function(Q){Q.graph().dummyChains=[],Q.edges().forEach(function(Z){return j(Q,Z)})},j=function(Q,Z){var L=Z.v,P=Q.node(L).rank,C=Z.w,M=Q.node(C).rank,k=Z.name,B=Q.edge(Z),R=B.labelRank;if(M!==P+1){Q.removeEdgeObj(Z);var F=Q.graph(),K,O,_;for(_=0,++P;P<M;++_,++P)B.points=[],O={edgeLabel:B,width:0,height:0,edgeObj:Z,rank:P},K=(0,X.addDummyNode)(Q,"edge",O,"_d"),P===R&&(O.width=B.width,O.height=B.height,O.dummy="edge-label",O.labelpos=B.labelpos),Q.setEdge(L,K,{weight:B.weight},k),_===0&&(F.dummyChains||(F.dummyChains=[]),F.dummyChains.push(K)),L=K;Q.setEdge(L,C,{weight:B.weight},k)}},W=function(Q){var Z;(Z=Q.graph().dummyChains)===null||Z===void 0||Z.forEach(function(L){var P=Q.node(L),C=P.edgeLabel,M;P.edgeObj&&Q.setEdgeObj(P.edgeObj,C);for(var k=L;P.dummy;)M=Q.successors(k)[0],Q.removeNode(k),C.points.push({x:P.x,y:P.y}),P.dummy==="edge-label"&&(C.x=P.x,C.y=P.y,C.width=P.width,C.height=P.height),k=M,P=Q.node(k)})};it.default={run:tt,undo:W}},80314:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=function(X,tt,j){var W={},Q;j==null||j.forEach(function(Z){for(var L=X.parent(Z),P,C;L;){if(P=X.parent(L),P?(C=W[P],W[P]=L):(C=Q,Q=L),C&&C!==L){tt.setEdge(C,L);return}L=P}})};it.default=$},89921:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=function(X,tt){return tt.map(function(j){var W=X.inEdges(j);if(!(W==null?void 0:W.length))return{v:j};{var Q={sum:0,weight:0};return W==null||W.forEach(function(Z){var L=X.edge(Z),P=X.node(Z.v);Q.sum+=L.weight*P.order,Q.weight+=L.weight}),{v:j,barycenter:Q.sum/Q.weight,weight:Q.weight}}})};it.default=$},77006:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var X=$(27652),tt=function(W,Q,Z){var L=j(W),P=new X.Graph({compound:!0}).setGraph({root:L}).setDefaultNodeLabel(function(C){return W.node(C)});return W.nodes().forEach(function(C){var M,k=W.node(C),B=W.parent(C);(k.rank===Q||k.minRank<=Q&&Q<=k.maxRank)&&(P.setNode(C),P.setParent(C,B||L),(M=W[Z](C))===null||M===void 0||M.forEach(function(R){var F=R.v===C?R.w:R.v,K=P.edgeFromArgs(F,C),O=K!==void 0?K.weight:0;P.setEdge(F,C,{weight:W.edge(R).weight+O})}),k.hasOwnProperty("minRank")&&P.setNode(C,{borderLeft:k.borderLeft[Q],borderRight:k.borderRight[Q]}))}),P},j=function(W){for(var Q;W.hasNode(Q="_root".concat(Math.random())););return Q};it.default=tt},32957:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var X=$(69209),tt=function(W,Q,Z){for(var L=(0,X.zipObject)(Z,Z.map(function(F,K){return K})),P=Q.map(function(F){var K,O=(K=W.outEdges(F))===null||K===void 0?void 0:K.map(function(_){return{pos:L[_.w]||0,weight:W.edge(_).weight}});return O==null?void 0:O.sort(function(_,ft){return _.pos-ft.pos})}),C=P.flat().filter(function(F){return F!==void 0}),M=1;M<Z.length;)M<<=1;var k=2*M-1;M-=1;var B=Array(k).fill(0,0,k),R=0;return C==null||C.forEach(function(F){if(F){var K=F.pos+M;B[K]+=F.weight;for(var O=0;K>0;)K%2&&(O+=B[K+1]),K=K-1>>1,B[K]+=F.weight;R+=F.weight*O}}),R},j=function(W,Q){for(var Z=0,L=1;L<(Q==null?void 0:Q.length);L+=1)Z+=tt(W,Q[L-1],Q[L]);return Z};it.default=j},19597:function(sr,it,$){"use strict";var X=this&&this.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(it,"__esModule",{value:!0});var tt=X($(15697)),j=X($(32957)),W=X($(77006)),Q=X($(80314)),Z=X($(99455)),L=$(49784),P=$(27652),C=$(69209),M=function(F,K){for(var O=(0,C.maxRank)(F),_=[],ft=[],mt=1;mt<O+1;mt++)_.push(mt);for(var mt=O-1;mt>-1;mt--)ft.push(mt);var st=k(F,_,"inEdges"),ut=k(F,ft,"outEdges"),dt=(0,tt.default)(F);R(F,dt);for(var gt=Number.POSITIVE_INFINITY,wt,mt=0,ot=0;ot<4;++mt,++ot){B(mt%2?st:ut,mt%4>=2,!1,K),dt=(0,C.buildLayerMatrix)(F);var pt=(0,j.default)(F,dt);pt<gt&&(ot=0,wt=(0,L.clone)(dt),gt=pt)}dt=(0,tt.default)(F),R(F,dt);for(var mt=0,ot=0;ot<4;++mt,++ot){B(mt%2?st:ut,mt%4>=2,!0,K),dt=(0,C.buildLayerMatrix)(F);var pt=(0,j.default)(F,dt);pt<gt&&(ot=0,wt=(0,L.clone)(dt),gt=pt)}R(F,wt)},k=function(F,K,O){return K.map(function(_){return(0,W.default)(F,_,O)})},B=function(F,K,O,_){var ft=new P.Graph;F==null||F.forEach(function(mt){for(var st,ut=mt.graph().root,dt=(0,Z.default)(mt,ut,ft,K,O,_),gt=0;gt<((st=dt.vs)===null||st===void 0?void 0:st.length);gt++){var wt=mt.node(dt.vs[gt]);wt&&(wt.order=gt)}(0,Q.default)(mt,ft,dt.vs)})},R=function(F,K){K==null||K.forEach(function(O){O==null||O.forEach(function(_,ft){F.node(_).order=ft})})};it.default=M},24956:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=function(X,tt){for(var j=X.nodes().filter(function(P){var C;return!((C=X.children(P))===null||C===void 0?void 0:C.length)}),W=j.map(function(P){return X.node(P).rank}),Q=Math.max.apply(Math,W),Z=[],L=0;L<Q+1;L++)Z[L]=[];tt==null||tt.forEach(function(P){var C=X.node(P);!C||(C==null?void 0:C.dummy)||isNaN(C.rank)||(C.fixorder=Z[C.rank].length,Z[C.rank].push(P))})};it.default=$},15697:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var X=$(45603),tt=function(j){for(var W={},Q=j.nodes().filter(function(F){var K;return!((K=j.children(F))===null||K===void 0?void 0:K.length)}),Z=Q.map(function(F){return j.node(F).rank}),L=(0,X.max)(Z),P=[],C=0;C<L+1;C++)P.push([]);var M=function(F){var K;if(!W.hasOwnProperty(F)){W[F]=!0;var O=j.node(F);isNaN(O.rank)||P[O.rank].push(F),(K=j.successors(F))===null||K===void 0||K.forEach(function(_){return M(_)})}},k=Q.sort(function(F,K){return j.node(F).rank-j.node(K).rank}),B=k.filter(function(F){return j.node(F).fixorder!==void 0}),R=B.sort(function(F,K){return j.node(F).fixorder-j.node(K).fixorder});return R==null||R.forEach(function(F){isNaN(j.node(F).rank)||P[j.node(F).rank].push(F),W[F]=!0}),k==null||k.forEach(M),P};it.default=tt},7043:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=function(j,W){var Q,Z,L,P={};j==null||j.forEach(function(M,k){P[M.v]={i:k,indegree:0,in:[],out:[],vs:[M.v]};var B=P[M.v];M.barycenter!==void 0&&(B.barycenter=M.barycenter,B.weight=M.weight)}),(Q=W.edges())===null||Q===void 0||Q.forEach(function(M){var k=P[M.v],B=P[M.w];k!==void 0&&B!==void 0&&(B.indegree++,k.out.push(P[M.w]))});var C=(L=(Z=Object.values(P)).filter)===null||L===void 0?void 0:L.call(Z,function(M){return!M.indegree});return X(C)},X=function(j){for(var W,Q,Z=[],L=function(B){return function(R){R.merged||(R.barycenter===void 0||B.barycenter===void 0||R.barycenter>=B.barycenter)&&tt(B,R)}},P=function(B){return function(R){R.in.push(B),--R.indegree==0&&j.push(R)}},C=function(){var B=j.pop();Z.push(B),(W=B.in.reverse())===null||W===void 0||W.forEach(function(R){return L(B)(R)}),(Q=B.out)===null||Q===void 0||Q.forEach(function(R){return P(B)(R)})};j==null?void 0:j.length;)C();var M=Z.filter(function(B){return!B.merged}),k=["vs","i","barycenter","weight"];return M.map(function(B){var R={};return k==null||k.forEach(function(F){B[F]!==void 0&&(R[F]=B[F])}),R})},tt=function(j,W){var Q,Z=0,L=0;j.weight&&(Z+=j.barycenter*j.weight,L+=j.weight),W.weight&&(Z+=W.barycenter*W.weight,L+=W.weight),j.vs=(Q=W.vs)===null||Q===void 0?void 0:Q.concat(j.vs),j.barycenter=Z/L,j.weight=L,j.i=Math.min(W.i,j.i),W.merged=!0};it.default=$},99455:function(sr,it,$){"use strict";var X=this&&this.__importDefault||function(P){return P&&P.__esModule?P:{default:P}};Object.defineProperty(it,"__esModule",{value:!0});var tt=X($(89921)),j=X($(7043)),W=X($(21498)),Q=function(P,C,M,k,B,R){var F,K,O,_,ft=P.children(C),mt=P.node(C),st=mt?mt.borderLeft:void 0,ut=mt?mt.borderRight:void 0,dt={};st&&(ft=ft==null?void 0:ft.filter(function(Gt){return Gt!==st&&Gt!==ut}));var gt=(0,tt.default)(P,ft||[]);gt==null||gt.forEach(function(Gt){var se;if((se=P.children(Gt.v))===null||se===void 0?void 0:se.length){var ie=Q(P,Gt.v,M,k,R);dt[Gt.v]=ie,ie.hasOwnProperty("barycenter")&&L(Gt,ie)}});var wt=(0,j.default)(gt,M);Z(wt,dt),(F=wt.filter(function(Gt){return Gt.vs.length>0}))===null||F===void 0||F.forEach(function(Gt){var se=P.node(Gt.vs[0]);se&&(Gt.fixorder=se.fixorder,Gt.order=se.order)});var ot=(0,W.default)(wt,k,B,R);if(st&&(ot.vs=[st,ot.vs,ut].flat(),(K=P.predecessors(st))===null||K===void 0?void 0:K.length)){var pt=P.node(((O=P.predecessors(st))===null||O===void 0?void 0:O[0])||""),Nt=P.node(((_=P.predecessors(ut))===null||_===void 0?void 0:_[0])||"");ot.hasOwnProperty("barycenter")||(ot.barycenter=0,ot.weight=0),ot.barycenter=(ot.barycenter*ot.weight+pt.order+Nt.order)/(ot.weight+2),ot.weight+=2}return ot},Z=function(P,C){P==null||P.forEach(function(M){var k,B=(k=M.vs)===null||k===void 0?void 0:k.map(function(R){return C[R]?C[R].vs:R});M.vs=B.flat()})},L=function(P,C){P.barycenter!==void 0?(P.barycenter=(P.barycenter*P.weight+C.barycenter*C.weight)/(P.weight+C.weight),P.weight+=C.weight):(P.barycenter=C.barycenter,P.weight=C.weight)};it.default=Q},21498:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var X=$(69209),tt=function(Q,Z,L,P){var C=(0,X.partition)(Q,function(_){var ft=_.hasOwnProperty("fixorder")&&!isNaN(_.fixorder);return P?!ft&&_.hasOwnProperty("barycenter"):ft||_.hasOwnProperty("barycenter")}),M=C.lhs,k=C.rhs.sort(function(_,ft){return-_.i- -ft.i}),B=[],R=0,F=0,K=0;M==null||M.sort(W(!!Z,!!L)),K=j(B,k,K),M==null||M.forEach(function(_){var ft;K+=(ft=_.vs)===null||ft===void 0?void 0:ft.length,B.push(_.vs),R+=_.barycenter*_.weight,F+=_.weight,K=j(B,k,K)});var O={vs:B.flat()};return F&&(O.barycenter=R/F,O.weight=F),O},j=function(Q,Z,L){for(var P=L,C;Z.length&&(C=Z[Z.length-1]).i<=P;)Z.pop(),Q==null||Q.push(C.vs),P++;return P},W=function(Q,Z){return function(L,P){if(L.fixorder!==void 0&&P.fixorder!==void 0)return L.fixorder-P.fixorder;if(L.barycenter<P.barycenter)return-1;if(L.barycenter>P.barycenter)return 1;if(Z&&L.order!==void 0&&P.order!==void 0){if(L.order<P.order)return-1;if(L.order>P.order)return 1}return Q?P.i-L.i:L.i-P.i}};it.default=tt},33562:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=function(j){var W,Q={},Z=0,L=function(P){var C,M=Z;(C=j.children(P))===null||C===void 0||C.forEach(L),Q[P]={low:M,lim:Z++}};return(W=j.children())===null||W===void 0||W.forEach(L),Q},X=function(j,W,Q,Z){var L=[],P=[],C=Math.min(W[Q].low,W[Z].low),M=Math.max(W[Q].lim,W[Z].lim),k,B;k=Q;do k=j.parent(k),L.push(k);while(k&&(W[k].low>C||M>W[k].lim));for(B=k,k=Z;k&&k!==B;)P.push(k),k=j.parent(k);return{lca:B,path:L.concat(P.reverse())}},tt=function(j){var W,Q=$(j);(W=j.graph().dummyChains)===null||W===void 0||W.forEach(function(Z){var L,P,C=Z,M=j.node(C),k=M.edgeObj;if(!!k)for(var B=X(j,Q,k.v,k.w),R=B.path,F=B.lca,K=0,O=R[K],_=!0;C!==k.w;){if(M=j.node(C),_){for(;O!==F&&((L=j.node(O))===null||L===void 0?void 0:L.maxRank)<M.rank;)K++,O=R[K];O===F&&(_=!1)}if(!_){for(;K<R.length-1&&((P=j.node(R[K+1]))===null||P===void 0?void 0:P.minRank)<=M.rank;)K++;O=R[K]}j.setParent(C,O),C=j.successors(C)[0]}})};it.default=tt},71963:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var st=function(ut,dt){return st=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(gt,wt){gt.__proto__=wt}||function(gt,wt){for(var ot in wt)Object.prototype.hasOwnProperty.call(wt,ot)&&(gt[ot]=wt[ot])},st(ut,dt)};return function(ut,dt){if(typeof dt!="function"&&dt!==null)throw new TypeError("Class extends value "+String(dt)+" is not a constructor or null");st(ut,dt);function gt(){this.constructor=ut}ut.prototype=dt===null?Object.create(dt):(gt.prototype=dt.prototype,new gt)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.width=it.sep=it.positionX=it.balance=it.alignCoordinates=it.findSmallestWidthAlignment=it.buildBlockGraph=it.horizontalCompaction=it.verticalAlignment=it.hasConflict=it.addConflict=it.findOtherInnerSegmentNode=it.findType2Conflicts=it.findType1Conflicts=void 0;var tt=$(69787),j=$(45603),W=$(69209),Q=function(st){X(ut,st);function ut(){return st!==null&&st.apply(this,arguments)||this}return ut}(tt.Graph),Z=function(st,ut){var dt={},gt=function(wt,ot){var pt=0,Nt=0,Gt=wt.length,se=ot==null?void 0:ot[(ot==null?void 0:ot.length)-1];return ot==null||ot.forEach(function(ie,Be){var ke,we=(0,it.findOtherInnerSegmentNode)(st,ie),At=we?st.node(we).order:Gt;(we||ie===se)&&((ke=ot.slice(Nt,Be+1))===null||ke===void 0||ke.forEach(function(Yt){var be;(be=st.predecessors(Yt))===null||be===void 0||be.forEach(function(nn){var Ee,le=st.node(nn),Le=le.order;(Le<pt||At<Le)&&!(le.dummy&&((Ee=st.node(Yt))===null||Ee===void 0?void 0:Ee.dummy))&&(0,it.addConflict)(dt,nn,Yt)})}),Nt=Be+1,pt=At)}),ot};return(ut==null?void 0:ut.length)&&ut.reduce(gt),dt};it.findType1Conflicts=Z;var L=function(st,ut){var dt={};function gt(Nt,Gt,se,ie,Be){for(var ke,we,At,Yt=Gt;Yt<se;Yt++)At=Nt[Yt],((ke=st.node(At))===null||ke===void 0?void 0:ke.dummy)&&((we=st.predecessors(At))===null||we===void 0||we.forEach(function(be){var nn=st.node(be);nn.dummy&&(nn.order<ie||nn.order>Be)&&(0,it.addConflict)(dt,be,At)}))}function wt(Nt){return JSON.stringify(Nt.slice(1))}function ot(Nt,Gt){var se=wt(Nt);Gt.get(se)||(gt.apply(void 0,Nt),Gt.set(se,!0))}var pt=function(Nt,Gt){var se=-1,ie,Be=0,ke=new Map;return Gt==null||Gt.forEach(function(we,At){var Yt;if(((Yt=st.node(we))===null||Yt===void 0?void 0:Yt.dummy)==="border"){var be=st.predecessors(we)||[];be.length&&(ie=st.node(be[0]).order,ot([Gt,Be,At,se,ie],ke),Be=At,se=ie)}ot([Gt,Be,Gt.length,ie,Nt.length],ke)}),Gt};return(ut==null?void 0:ut.length)&&ut.reduce(pt),dt};it.findType2Conflicts=L;var P=function(st,ut){var dt,gt;if((dt=st.node(ut))===null||dt===void 0?void 0:dt.dummy)return(gt=st.predecessors(ut))===null||gt===void 0?void 0:gt.find(function(wt){return st.node(wt).dummy})};it.findOtherInnerSegmentNode=P;var C=function(st,ut,dt){var gt=ut,wt=dt;if(gt>wt){var ot=gt;gt=wt,wt=ot}var pt=st[gt];pt||(st[gt]=pt={}),pt[wt]=!0};it.addConflict=C;var M=function(st,ut,dt){var gt=ut,wt=dt;if(gt>wt){var ot=ut;gt=wt,wt=ot}return!!st[gt]};it.hasConflict=M;var k=function(st,ut,dt,gt){var wt={},ot={},pt={};return ut==null||ut.forEach(function(Nt){Nt==null||Nt.forEach(function(Gt,se){wt[Gt]=Gt,ot[Gt]=Gt,pt[Gt]=se})}),ut==null||ut.forEach(function(Nt){var Gt=-1;Nt==null||Nt.forEach(function(se){var ie=gt(se);if(ie.length){ie=ie.sort(function(Yt,be){return pt[Yt]-pt[be]});for(var Be=(ie.length-1)/2,ke=Math.floor(Be),we=Math.ceil(Be);ke<=we;++ke){var At=ie[ke];ot[se]===se&&Gt<pt[At]&&!(0,it.hasConflict)(dt,se,At)&&(ot[At]=se,ot[se]=wt[se]=wt[At],Gt=pt[At])}}})}),{root:wt,align:ot}};it.verticalAlignment=k;var B=function(st,ut,dt,gt,wt){var ot,pt={},Nt=(0,it.buildBlockGraph)(st,ut,dt,wt),Gt=wt?"borderLeft":"borderRight",se=function(ke,we){for(var At=Nt.nodes(),Yt=At.pop(),be={};Yt;)be[Yt]?ke(Yt):(be[Yt]=!0,At.push(Yt),At=At.concat(we(Yt))),Yt=At.pop()},ie=function(ke){pt[ke]=(Nt.inEdges(ke)||[]).reduce(function(we,At){return Math.max(we,(pt[At.v]||0)+Nt.edge(At))},0)},Be=function(ke){var we=(Nt.outEdges(ke)||[]).reduce(function(Yt,be){return Math.min(Yt,(pt[be.w]||0)-Nt.edge(be))},Number.POSITIVE_INFINITY),At=st.node(ke);we!==Number.POSITIVE_INFINITY&&At.borderType!==Gt&&(pt[ke]=Math.max(pt[ke],we))};return se(ie,Nt.predecessors.bind(Nt)),se(Be,Nt.successors.bind(Nt)),(ot=Object.values(gt))===null||ot===void 0||ot.forEach(function(ke){pt[ke]=pt[dt[ke]]}),pt};it.horizontalCompaction=B;var R=function(st,ut,dt,gt){var wt=new Q,ot=st.graph(),pt=(0,it.sep)(ot.nodesep,ot.edgesep,gt);return ut==null||ut.forEach(function(Nt){var Gt;Nt==null||Nt.forEach(function(se){var ie=dt[se];if(wt.setNode(ie),Gt){var Be=dt[Gt],ke=wt.edgeFromArgs(Be,ie);wt.setEdge(Be,ie,Math.max(pt(st,se,Gt),ke||0))}Gt=se})}),wt};it.buildBlockGraph=R;var F=function(st,ut){return(0,W.minBy)(Object.values(ut),function(dt){var gt,wt=Number.NEGATIVE_INFINITY,ot=Number.POSITIVE_INFINITY;return(gt=Object.keys(dt))===null||gt===void 0||gt.forEach(function(pt){var Nt=dt[pt],Gt=(0,it.width)(st,pt)/2;wt=Math.max(Nt+Gt,wt),ot=Math.min(Nt-Gt,ot)}),wt-ot})};it.findSmallestWidthAlignment=F;function K(st,ut){var dt=Object.values(ut),gt=(0,j.min)(dt),wt=(0,j.max)(dt);["u","d"].forEach(function(ot){["l","r"].forEach(function(pt){var Nt=ot+pt,Gt=st[Nt],se;if(Gt!==ut){var ie=Object.values(Gt);se=pt==="l"?gt-(0,j.min)(ie):wt-(0,j.max)(ie),se&&(st[Nt]={},Object.keys(Gt).forEach(function(Be){st[Nt][Be]=Gt[Be]+se}))}})})}it.alignCoordinates=K;var O=function(st,ut){var dt={};return Object.keys(st.ul).forEach(function(gt){if(ut)dt[gt]=st[ut.toLowerCase()][gt];else{var wt=Object.values(st).map(function(ot){return ot[gt]});dt[gt]=(wt[0]+wt[1])/2}}),dt};it.balance=O;var _=function(st){var ut=(0,W.buildLayerMatrix)(st),dt=Object.assign((0,it.findType1Conflicts)(st,ut),(0,it.findType2Conflicts)(st,ut)),gt={},wt;["u","d"].forEach(function(pt){wt=pt==="u"?ut:Object.values(ut).reverse(),["l","r"].forEach(function(Nt){Nt==="r"&&(wt=wt.map(function(Be){return Object.values(Be).reverse()}));var Gt=(pt==="u"?st.predecessors:st.successors).bind(st),se=(0,it.verticalAlignment)(st,wt,dt,Gt),ie=(0,it.horizontalCompaction)(st,wt,se.root,se.align,Nt==="r");Nt==="r"&&Object.keys(ie).forEach(function(Be){ie[Be]=-ie[Be]}),gt[pt+Nt]=ie})});var ot=(0,it.findSmallestWidthAlignment)(st,gt);return K(gt,ot),(0,it.balance)(gt,st.graph().align)};it.positionX=_;var ft=function(st,ut,dt){return function(gt,wt,ot){var pt=gt.node(wt),Nt=gt.node(ot),Gt=0,se;if(Gt+=pt.width/2,pt.hasOwnProperty("labelpos"))switch((pt.labelpos||"").toLowerCase()){case"l":se=-pt.width/2;break;case"r":se=pt.width/2;break}if(se&&(Gt+=dt?se:-se),se=0,Gt+=(pt.dummy?ut:st)/2,Gt+=(Nt.dummy?ut:st)/2,Gt+=Nt.width/2,Nt.labelpos)switch((Nt.labelpos||"").toLowerCase()){case"l":se=Nt.width/2;break;case"r":se=-Nt.width/2;break}return se&&(Gt+=dt?se:-se),se=0,Gt}};it.sep=ft;var mt=function(st,ut){return st.node(ut).width||0};it.width=mt},95:function(sr,it,$){"use strict";var X=this&&this.__spreadArray||function(L,P,C){if(C||arguments.length===2)for(var M=0,k=P.length,B;M<k;M++)(B||!(M in P))&&(B||(B=Array.prototype.slice.call(P,0,M)),B[M]=P[M]);return L.concat(B||Array.prototype.slice.call(P))};Object.defineProperty(it,"__esModule",{value:!0});var tt=$(69209),j=$(71963),W=function(L){var P=(0,tt.buildLayerMatrix)(L),C=L.graph().ranksep,M=0;P==null||P.forEach(function(k){var B=k.map(function(F){return L.node(F).height}),R=Math.max.apply(Math,X(X([],B,!1),[0],!1));k==null||k.forEach(function(F){L.node(F).y=M+R/2}),M+=R+C})},Q=function(L){var P=(0,tt.buildLayerMatrix)(L),C=Object.assign((0,j.findType1Conflicts)(L,P),(0,j.findType2Conflicts)(L,P)),M={},k=[];["u","d"].forEach(function(R){k=R==="u"?P:Object.values(P).reverse(),["l","r"].forEach(function(F){F==="r"&&(k=k.map(function(ft){return Object.values(ft).reverse()}));var K=(R==="u"?L.predecessors:L.successors).bind(L),O=(0,j.verticalAlignment)(L,k,C,K),_=(0,j.horizontalCompaction)(L,k,O.root,O.align,F==="r");F==="r"&&Object.keys(_).forEach(function(ft){return _[ft]=-_[ft]}),M[R+F]=_})});var B=(0,j.findSmallestWidthAlignment)(L,M);return B&&(0,j.alignCoordinates)(M,B),(0,j.balance)(M,L.graph().align)},Z=function(L){var P,C=(0,tt.asNonCompoundGraph)(L);W(C);var M=Q(C);(P=Object.keys(M))===null||P===void 0||P.forEach(function(k){C.node(k).x=M[k]})};it.default=Z},13614:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.feasibleTreeWithLayer=it.feasibleTree=void 0;var X=$(37323),tt=$(69209),j=$(27652),W=function(M){var k=new j.Graph({directed:!1}),B=M.nodes()[0],R=M.nodeCount();k.setNode(B,{});for(var F,K;Q(k,M)<R;)F=P(k,M),K=k.hasNode(F.v)?(0,X.slack)(M,F):-(0,X.slack)(M,F),C(k,M,K);return k};it.feasibleTree=W;var Q=function(M,k){var B=function(R){k.nodeEdges(R).forEach(function(F){var K=F.v,O=R===K?F.w:K;!M.hasNode(O)&&!(0,X.slack)(k,F)&&(M.setNode(O,{}),M.setEdge(R,O,{}),B(O))})};return M.nodes().forEach(B),M.nodeCount()},Z=function(M){var k=new j.Graph({directed:!1}),B=M.nodes()[0],R=M.nodes().filter(function(O){return!!M.node(O)}).length;k.setNode(B,{});for(var F,K;L(k,M)<R;)F=P(k,M),K=k.hasNode(F.v)?(0,X.slack)(M,F):-(0,X.slack)(M,F),C(k,M,K);return k};it.feasibleTreeWithLayer=Z;var L=function(M,k){var B=function(R){var F;(F=k.nodeEdges(R))===null||F===void 0||F.forEach(function(K){var O=K.v,_=R===O?K.w:O;!M.hasNode(_)&&(k.node(_).layer!==void 0||!(0,X.slack)(k,K))&&(M.setNode(_,{}),M.setEdge(R,_,{}),B(_))})};return M.nodes().forEach(B),M.nodeCount()},P=function(M,k){return(0,tt.minBy)(k.edges(),function(B){return M.hasNode(B.v)!==M.hasNode(B.w)?(0,X.slack)(k,B):Infinity})},C=function(M,k,B){M.nodes().forEach(function(R){k.node(R).rank||(k.node(R).rank=0),k.node(R).rank+=B})};it.default={feasibleTree:W,feasibleTreeWithLayer:Z}},76827:function(sr,it,$){"use strict";var X=this&&this.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(it,"__esModule",{value:!0});var tt=$(37323),j=$(13614),W=X($(32253)),Q=function(C){switch(C.graph().ranker){case"network-simplex":P(C);break;case"tight-tree":L(C);break;case"longest-path":Z(C);break;default:L(C)}},Z=tt.longestPath,L=function(C){(0,tt.longestPathWithLayer)(C),(0,j.feasibleTreeWithLayer)(C)},P=function(C){(0,W.default)(C)};it.default=Q},32253:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.exchangeEdges=it.enterEdge=it.leaveEdge=it.initLowLimValues=it.calcCutValue=it.initCutValues=void 0;var X=$(13614),tt=$(37323),j=$(69209),W=$(69787),Q=W.algorithm.preorder,Z=W.algorithm.postorder,L=function(mt){var st=(0,j.simplify)(mt);(0,tt.longestPath)(st);var ut=(0,X.feasibleTree)(st);(0,it.initLowLimValues)(ut),(0,it.initCutValues)(ut,st);for(var dt,gt;dt=(0,it.leaveEdge)(ut);)gt=(0,it.enterEdge)(ut,st,dt),(0,it.exchangeEdges)(ut,st,dt,gt)},P=function(mt,st){var ut=Z(mt,mt.nodes());ut=ut==null?void 0:ut.slice(0,(ut==null?void 0:ut.length)-1),ut==null||ut.forEach(function(dt){C(mt,st,dt)})};it.initCutValues=P;var C=function(mt,st,ut){var dt=mt.node(ut),gt=dt.parent;mt.edgeFromArgs(ut,gt).cutvalue=(0,it.calcCutValue)(mt,st,ut)},M=function(mt,st,ut){var dt,gt=mt.node(ut),wt=gt.parent,ot=!0,pt=st.edgeFromArgs(ut,wt),Nt=0;return pt||(ot=!1,pt=st.edgeFromArgs(wt,ut)),Nt=pt.weight,(dt=st.nodeEdges(ut))===null||dt===void 0||dt.forEach(function(Gt){var se=Gt.v===ut,ie=se?Gt.w:Gt.v;if(ie!==wt){var Be=se===ot,ke=st.edge(Gt).weight;if(Nt+=Be?ke:-ke,_(mt,ut,ie)){var we=mt.edgeFromArgs(ut,ie).cutvalue;Nt+=Be?-we:we}}}),Nt};it.calcCutValue=M;var k=function(mt,st){st===void 0&&(st=mt.nodes()[0]),B(mt,{},1,st)};it.initLowLimValues=k;var B=function(mt,st,ut,dt,gt){var wt,ot=ut,pt=ut,Nt=mt.node(dt);return st[dt]=!0,(wt=mt.neighbors(dt))===null||wt===void 0||wt.forEach(function(Gt){st[Gt]||(pt=B(mt,st,pt,Gt,dt))}),Nt.low=ot,Nt.lim=pt++,gt?Nt.parent=gt:delete Nt.parent,pt},R=function(mt){return mt.edges().find(function(st){return mt.edge(st).cutvalue<0})};it.leaveEdge=R;var F=function(mt,st,ut){var dt=ut.v,gt=ut.w;st.hasEdge(dt,gt)||(dt=ut.w,gt=ut.v);var wt=mt.node(dt),ot=mt.node(gt),pt=wt,Nt=!1;wt.lim>ot.lim&&(pt=ot,Nt=!0);var Gt=st.edges().filter(function(se){return Nt===ft(mt,mt.node(se.v),pt)&&Nt!==ft(mt,mt.node(se.w),pt)});return(0,j.minBy)(Gt,function(se){return(0,tt.slack)(st,se)})};it.enterEdge=F;var K=function(mt,st,ut,dt){var gt=ut.v,wt=ut.w;mt.removeEdge(gt,wt),mt.setEdge(dt.v,dt.w,{}),(0,it.initLowLimValues)(mt),(0,it.initCutValues)(mt,st),O(mt,st)};it.exchangeEdges=K;var O=function(mt,st){var ut=mt.nodes().find(function(gt){var wt;return!((wt=st.node(gt))===null||wt===void 0?void 0:wt.parent)}),dt=Q(mt,ut);dt=dt==null?void 0:dt.slice(1),dt==null||dt.forEach(function(gt){var wt=mt.node(gt).parent,ot=st.edgeFromArgs(gt,wt),pt=!1;ot||(ot=st.edgeFromArgs(wt,gt),pt=!0),st.node(gt).rank=st.node(wt).rank+(pt?ot.minlen:-ot.minlen)})},_=function(mt,st,ut){return mt.hasEdge(st,ut)},ft=function(mt,st,ut){return ut.low<=st.lim&&st.lim<=ut.lim};it.default=L},37323:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.slack=it.longestPathWithLayer=it.longestPath=void 0;var $=function(j){var W,Q={},Z=function(L){var P,C=j.node(L);if(!C)return 0;if(Q[L])return C.rank;Q[L]=!0;var M;return(P=j.outEdges(L))===null||P===void 0||P.forEach(function(k){var B=Z(k.w),R=j.edge(k).minlen,F=B-R;F&&(M===void 0||F<M)&&(M=F)}),M||(M=0),C.rank=M,M};(W=j.sources())===null||W===void 0||W.forEach(function(L){return Z(L)})};it.longestPath=$;var X=function(j){var W,Q={},Z,L=function(M){var k,B=j.node(M);if(!B)return 0;if(Q[M])return B.rank;Q[M]=!0;var R;return(k=j.outEdges(M))===null||k===void 0||k.forEach(function(F){var K=L(F.w),O=j.edge(F).minlen,_=K-O;_&&(R===void 0||_<R)&&(R=_)}),R||(R=0),(Z===void 0||R<Z)&&(Z=R),B.rank=R,R};(W=j.sources())===null||W===void 0||W.forEach(function(M){j.node(M)&&L(M)}),Z===void 0&&(Z=0);var P={},C=function(M,k){var B,R=j.node(M),F=isNaN(R.layer)?k:R.layer;(R.rank===void 0||R.rank<F)&&(R.rank=F),!P[M]&&(P[M]=!0,(B=j.outEdges(M))===null||B===void 0||B.map(function(K){C(K.w,F+j.edge(K).minlen)}))};j.nodes().forEach(function(M){var k=j.node(M);!k||(isNaN(k.layer)?k.rank-=Z:C(M,k.layer))})};it.longestPathWithLayer=X;var tt=function(j,W){return j.node(W.w).rank-j.node(W.v).rank-j.edge(W).minlen};it.slack=tt,it.default={longestPath:$,longestPathWithLayer:X,slack:tt}},69209:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.minBy=it.notime=it.time=it.partition=it.maxRank=it.addBorderNode=it.removeEmptyRanks=it.normalizeRanks=it.buildLayerMatrix=it.intersectRect=it.predecessorWeights=it.successorWeights=it.zipObject=it.asNonCompoundGraph=it.simplify=it.addDummyNode=void 0;var X=$(49784),tt=$(27652),j=function(st,ut){return Number(st)-Number(ut)},W=function(st,ut,dt,gt){var wt;do wt="".concat(gt).concat(Math.random());while(st.hasNode(wt));return dt.dummy=ut,st.setNode(wt,dt),wt};it.addDummyNode=W;var Q=function(st){var ut=new tt.Graph().setGraph(st.graph());return st.nodes().forEach(function(dt){ut.setNode(dt,st.node(dt))}),st.edges().forEach(function(dt){var gt=ut.edgeFromArgs(dt.v,dt.w)||{weight:0,minlen:1},wt=st.edge(dt);ut.setEdge(dt.v,dt.w,{weight:gt.weight+wt.weight,minlen:Math.max(gt.minlen,wt.minlen)})}),ut};it.simplify=Q;var Z=function(st){var ut=new tt.Graph({multigraph:st.isMultigraph()}).setGraph(st.graph());return st.nodes().forEach(function(dt){var gt;((gt=st.children(dt))===null||gt===void 0?void 0:gt.length)||ut.setNode(dt,st.node(dt))}),st.edges().forEach(function(dt){ut.setEdgeObj(dt,st.edge(dt))}),ut};it.asNonCompoundGraph=Z;var L=function(st,ut){return st==null?void 0:st.reduce(function(dt,gt,wt){return dt[gt]=ut[wt],dt},{})};it.zipObject=L;var P=function(st){var ut={};return st.nodes().forEach(function(dt){var gt,wt={};(gt=st.outEdges(dt))===null||gt===void 0||gt.forEach(function(ot){var pt;wt[ot.w]=(wt[ot.w]||0)+(((pt=st.edge(ot))===null||pt===void 0?void 0:pt.weight)||0)}),ut[dt]=wt}),ut};it.successorWeights=P;var C=function(st){var ut=st.nodes(),dt=ut.map(function(gt){var wt,ot={};return(wt=st.inEdges(gt))===null||wt===void 0||wt.forEach(function(pt){ot[pt.v]=(ot[pt.v]||0)+st.edge(pt).weight}),ot});return(0,it.zipObject)(ut,dt)};it.predecessorWeights=C;var M=function(st,ut){var dt=Number(st.x),gt=Number(st.y),wt=Number(ut.x)-dt,ot=Number(ut.y)-gt,pt=Number(st.width)/2,Nt=Number(st.height)/2;if(!wt&&!ot)return{x:0,y:0};var Gt,se;return Math.abs(ot)*pt>Math.abs(wt)*Nt?(ot<0&&(Nt=-Nt),Gt=Nt*wt/ot,se=Nt):(wt<0&&(pt=-pt),Gt=pt,se=pt*ot/wt),{x:dt+Gt,y:gt+se}};it.intersectRect=M;var k=function(st){for(var ut=[],dt=(0,it.maxRank)(st)+1,gt=0;gt<dt;gt++)ut.push([]);st.nodes().forEach(function(wt){var ot=st.node(wt);if(!!ot){var pt=ot.rank;pt!==void 0&&ut[pt]&&ut[pt].push(wt)}});for(var gt=0;gt<dt;gt++)ut[gt]=ut[gt].sort(function(ot,pt){var Nt,Gt;return j((Nt=st.node(ot))===null||Nt===void 0?void 0:Nt.order,(Gt=st.node(pt))===null||Gt===void 0?void 0:Gt.order)});return ut};it.buildLayerMatrix=k;var B=function(st){var ut=st.nodes().filter(function(gt){var wt;return((wt=st.node(gt))===null||wt===void 0?void 0:wt.rank)!==void 0}).map(function(gt){return st.node(gt).rank}),dt=Math.min.apply(Math,ut);st.nodes().forEach(function(gt){var wt=st.node(gt);wt.hasOwnProperty("rank")&&dt!==Infinity&&(wt.rank-=dt)})};it.normalizeRanks=B;var R=function(st){var ut=st.nodes(),dt=ut.filter(function(se){var ie;return((ie=st.node(se))===null||ie===void 0?void 0:ie.rank)!==void 0}).map(function(se){return st.node(se).rank}),gt=Math.min.apply(Math,dt),wt=[];ut.forEach(function(se){var ie,Be=(((ie=st.node(se))===null||ie===void 0?void 0:ie.rank)||0)-gt;wt[Be]||(wt[Be]=[]),wt[Be].push(se)});for(var ot=0,pt=st.graph().nodeRankFactor||0,Nt=0;Nt<wt.length;Nt++){var Gt=wt[Nt];Gt===void 0?Nt%pt!=0&&(ot-=1):ot&&(Gt==null||Gt.forEach(function(se){var ie=st.node(se);ie&&(ie.rank=ie.rank||0,ie.rank+=ot)}))}};it.removeEmptyRanks=R;var F=function(st,ut,dt,gt){var wt={width:0,height:0};return(0,X.isNumber)(dt)&&(0,X.isNumber)(gt)&&(wt.rank=dt,wt.order=gt),(0,it.addDummyNode)(st,"border",wt,ut)};it.addBorderNode=F;var K=function(st){var ut;return st.nodes().forEach(function(dt){var gt,wt=(gt=st.node(dt))===null||gt===void 0?void 0:gt.rank;wt!==void 0&&(ut===void 0||wt>ut)&&(ut=wt)}),ut||(ut=0),ut};it.maxRank=K;var O=function(st,ut){var dt={lhs:[],rhs:[]};return st==null||st.forEach(function(gt){ut(gt)?dt.lhs.push(gt):dt.rhs.push(gt)}),dt};it.partition=O;var _=function(st,ut){var dt=Date.now();try{return ut()}finally{console.log("".concat(st," time: ").concat(Date.now()-dt,"ms"))}};it.time=_;var ft=function(st,ut){return ut()};it.notime=ft;var mt=function(st,ut){return st.reduce(function(dt,gt){var wt=ut(dt),ot=ut(gt);return wt>ot?gt:dt})};it.minBy=mt},77057:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var P=function(C,M){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,B){k.__proto__=B}||function(k,B){for(var R in B)Object.prototype.hasOwnProperty.call(B,R)&&(k[R]=B[R])},P(C,M)};return function(C,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");P(C,M);function k(){this.constructor=C}C.prototype=M===null?Object.create(M):(k.prototype=M.prototype,new k)}}(),tt=this&&this.__assign||function(){return tt=Object.assign||function(P){for(var C,M=1,k=arguments.length;M<k;M++){C=arguments[M];for(var B in C)Object.prototype.hasOwnProperty.call(C,B)&&(P[B]=C[B])}return P},tt.apply(this,arguments)},j=this&&this.__spreadArray||function(P,C,M){if(M||arguments.length===2)for(var k=0,B=C.length,R;k<B;k++)(R||!(k in C))&&(R||(R=Array.prototype.slice.call(C,0,k)),R[k]=C[k]);return P.concat(R||Array.prototype.slice.call(C))};Object.defineProperty(it,"__esModule",{value:!0}),it.DagreCompoundLayout=void 0;var W=$(62329),Q=$(31969),Z=$(49784),L=function(P){X(C,P);function C(M){var k=P.call(this)||this;return k.rankdir="TB",k.nodesep=50,k.edgesep=5,k.ranksep=50,k.controlPoints=!0,k.anchorPoint=!0,k.nodes=[],k.edges=[],k.combos=[],k.onLayoutEnd=function(){},k.updateCfg(M),k}return C.prototype.getDefaultCfg=function(){return{rankdir:"TB",align:void 0,begin:void 0,nodeSize:void 0,nodesep:50,ranksep:50,controlPoints:!0,anchorPoint:!0}},C.prototype.init=function(M){var k=M.hiddenNodes||[],B=M.hiddenEdges||[],R=M.hiddenCombos||[];this.nodes=this.getDataByOrder((M.nodes||[]).concat(k)),this.edges=this.getDataByOrder((M.edges||[]).concat(B)),this.combos=(M.combos||[]).concat(R.map(function(F){return tt(tt({},F),{collapsed:!0})}))},C.prototype.execute=function(){var M=this,k=M.nodes,B=M.edges;if(!!k){var R=M.getLayoutConfig(),F=R.graphDef,K=R.graphOption,O=R.graphSettings,_=(0,Q.buildGraph)(F,K,O),ft=(0,Q.flatGraph)(_,!0);return this.updatePosition(ft),M.onLayoutEnd&&M.onLayoutEnd(),{nodes:k,edges:B}}},C.prototype.getNodePath=function(M){var k=this,B=k.nodes,R=k.combos,F=B.find(function(O){return O.id===M}),K=function(O,_){_===void 0&&(_=[]);var ft=R.find(function(mt){return mt.id===O});return ft?(_.unshift(O),ft.parentId?K(ft.parentId,_):_):_};return F&&F.comboId?K(F.comboId,[M]):[M]},C.prototype.getLayoutConfig=function(){var M,k,B,R=this,F=R.nodes,K=R.edges,O=R.combos,_=R.nodeSize,ft=R.rankdir,mt=R.align,st=R.edgesep,ut=R.nodesep,dt=R.ranksep,gt=R.settings,wt=(O||[]).reduce(function(Le,Ze){var fe=F.filter(function(He){return He.comboId===Ze.id}).map(function(He){return He.id}),Re=(O||[]).filter(function(He){return He.parentId===Ze.id}).map(function(He){return He.id});return(fe.length||Re.length)&&(Le[Ze.id]=j(j([],fe,!0),Re,!0)),Le},{}),ot;_?(0,Z.isArray)(_)?ot=function(){return _}:ot=function(){return[_,_]}:ot=function(Le){return Le&&Le.size?(0,Z.isArray)(Le.size)?Le.size:(0,Z.isObject)(Le.size)?[Le.size.width||40,Le.size.height||40]:[Le.size,Le.size]:[40,40]};var pt=function(Le){return Le&&Le.size?(0,Z.isArray)(Le.size)?Le.size:[Le.size,Le.size]:[80,40]},Nt=pt(O==null?void 0:O[0]),Gt=Nt[0],se=Nt[1],ie=(k=(M=R.graphSettings)===null||M===void 0?void 0:M.subScene)===null||k===void 0?void 0:k.meta,Be=((B=O.find(function(Le){return!Le.collapsed}))===null||B===void 0?void 0:B.padding)||[20,20,20,20],ke=Be[0],we=Be[1],At=Be[2],Yt=Be[3],be={compound:wt,nodes:j([],(F||[]).map(function(Le){var Ze=ot(Le),fe=Ze[0],Re=Ze[1];return tt(tt({},Le),{width:fe,height:Re})}),!0),edges:j([],(K||[]).map(function(Le){return tt(tt({},Le),{v:Le.source,w:Le.target})}),!0)},nn={expanded:(O||[]).filter(function(Le){return!Le.collapsed}).map(function(Le){return Le.id})},Ee={graph:{meta:{align:mt,rankDir:ft,nodeSep:ut,edgeSep:st,rankSep:dt}},subScene:{meta:{paddingTop:ke||(ie==null?void 0:ie.paddingTop)||20,paddingRight:we||(ie==null?void 0:ie.paddingRight)||20,paddingBottom:At||(ie==null?void 0:ie.paddingBottom)||20,paddingLeft:Yt||(ie==null?void 0:ie.paddingLeft)||20,labelHeight:0}},nodeSize:{meta:{width:Gt,height:se}}},le=(0,Q.mergeConfig)(gt,tt({},(0,Q.mergeConfig)(Ee,Q.LAYOUT_CONFIG)));return R.graphSettings=le,{graphDef:be,graphOption:nn,graphSettings:le}},C.prototype.updatePosition=function(M){var k=M.nodes,B=M.edges;this.updateNodePosition(k,B),this.updateEdgePosition(k,B)},C.prototype.getBegin=function(M,k){var B=this,R=B.begin,F=[0,0];if(R){var K=Infinity,O=Infinity;M.forEach(function(_){K>_.x&&(K=_.x),O>_.y&&(O=_.y)}),k.forEach(function(_){_.points.forEach(function(ft){K>ft.x&&(K=ft.x),O>ft.y&&(O=ft.y)})}),F[0]=R[0]-K,F[1]=R[1]-O}return F},C.prototype.updateNodePosition=function(M,k){var B=this,R=B.combos,F=B.nodes,K=B.edges,O=B.anchorPoint,_=B.graphSettings,ft=this.getBegin(M,k);M.forEach(function(mt){var st,ut=mt.x,dt=mt.y,gt=mt.id,wt=mt.type,ot=mt.coreBox;if(wt===Q.HierarchyNodeType.META&&gt!==Q.ROOT_NAME){var pt=R.findIndex(function(Be){return Be.id===gt}),Nt=(st=_==null?void 0:_.subScene)===null||st===void 0?void 0:st.meta;R[pt].offsetX=ut+ft[0],R[pt].offsetY=dt+ft[1],R[pt].fixSize=[ot.width,ot.height],R[pt].fixCollapseSize=[ot.width,ot.height],mt.expanded?R[pt].padding=[Nt==null?void 0:Nt.paddingTop,Nt==null?void 0:Nt.paddingRight,Nt==null?void 0:Nt.paddingBottom,Nt==null?void 0:Nt.paddingLeft]:R[pt].padding=[0,0,0,0]}else if(wt===Q.HierarchyNodeType.OP){var pt=F.findIndex(function(ke){return ke.id===gt});if(F[pt].x=ut+ft[0],F[pt].y=dt+ft[1],O){var Gt=[],se=k.filter(function(ke){return ke.v===gt}),ie=k.filter(function(ke){return ke.w===gt});se.length>0&&se.forEach(function(ke){var we=ke.points[0],At=(we.x-ut)/mt.width+.5,Yt=(we.y-dt)/mt.height+.5;Gt.push([At,Yt]),ke.baseEdgeList.forEach(function(be){var nn=K.find(function(Ee){return Ee.source===be.v&&Ee.target===be.w});nn&&(nn.sourceAnchor=Gt.length-1)})}),ie.length>0&&ie.forEach(function(ke){var we=ke.points[ke.points.length-1],At=(we.x-ut)/mt.width+.5,Yt=(we.y-dt)/mt.height+.5;Gt.push([At,Yt]),ke.baseEdgeList.forEach(function(be){var nn=K.find(function(Ee){return Ee.source===be.v&&Ee.target===be.w});nn&&(nn.targetAnchor=Gt.length-1)})}),F[pt].anchorPoints=Gt.length>0?Gt:F[pt].anchorPoints||[]}}})},C.prototype.updateEdgePosition=function(M,k){var B=this,R=B.combos,F=B.edges,K=B.controlPoints,O=this.getBegin(M,k);K&&(R.forEach(function(_){_.inEdges=[],_.outEdges=[]}),F.forEach(function(_){var ft,mt,st,ut,dt=M.find(function(Be){return Be.id===_.source}),gt=M.find(function(Be){return Be.id===_.target}),wt=[],ot=[];if(dt&&gt)ot=(0,Q.getEdges)(dt==null?void 0:dt.id,gt==null?void 0:gt.id,M);else if(!dt||!gt){var pt=B.getNodePath(_.source),Nt=B.getNodePath(_.target),Gt=pt.reverse().slice(dt?0:1).find(function(Be){return M.find(function(ke){return ke.id===Be})}),se=Nt.reverse().slice(gt?0:1).find(function(Be){return M.find(function(ke){return ke.id===Be})});dt=M.find(function(Be){return Be.id===Gt}),gt=M.find(function(Be){return Be.id===se}),ot=(0,Q.getEdges)(dt==null?void 0:dt.id,gt==null?void 0:gt.id,M,{v:_.source,w:_.target})}if(wt=ot.reduce(function(Be,ke){return j(j([],Be,!0),ke.points.map(function(we){return tt(tt({},we),{x:we.x+O[0],y:we.y+O[1]})}),!0)},[]),wt=wt.slice(1,-1),_.controlPoints=wt,(gt==null?void 0:gt.type)===Q.NodeType.META){var ie=R.findIndex(function(Be){return Be.id===(gt==null?void 0:gt.id)});if(!R[ie]||((ft=R[ie].inEdges)===null||ft===void 0?void 0:ft.some(function(Be){return Be.source===dt.id&&Be.target===gt.id})))return;(mt=R[ie].inEdges)===null||mt===void 0||mt.push({source:dt.id,target:gt.id,controlPoints:wt})}if((dt==null?void 0:dt.type)===Q.NodeType.META){var ie=R.findIndex(function(ke){return ke.id===(dt==null?void 0:dt.id)});if(!R[ie]||((st=R[ie].outEdges)===null||st===void 0?void 0:st.some(function(ke){return ke.source===dt.id&&ke.target===gt.id})))return;(ut=R[ie].outEdges)===null||ut===void 0||ut.push({source:dt.id,target:gt.id,controlPoints:wt})}}))},C.prototype.getType=function(){return"dagreCompound"},C.prototype.getDataByOrder=function(M){return M.every(function(k){return k.layoutOrder!==void 0})||M.forEach(function(k,B){k.layoutOrder=B}),M.sort(function(k,B){return k.layoutOrder-B.layoutOrder})},C}(W.Base);it.DagreCompoundLayout=L},34015:function(sr,it,$){"use strict";var X=this&&this.__assign||function(){return X=Object.assign||function(k){for(var B,R=1,F=arguments.length;R<F;R++){B=arguments[R];for(var K in B)Object.prototype.hasOwnProperty.call(B,K)&&(k[K]=B[K])}return k},X.apply(this,arguments)},tt=this&&this.__createBinding||(Object.create?function(k,B,R,F){F===void 0&&(F=R);var K=Object.getOwnPropertyDescriptor(B,R);(!K||("get"in K?!B.__esModule:K.writable||K.configurable))&&(K={enumerable:!0,get:function(){return B[R]}}),Object.defineProperty(k,F,K)}:function(k,B,R,F){F===void 0&&(F=R),k[F]=B[R]}),j=this&&this.__setModuleDefault||(Object.create?function(k,B){Object.defineProperty(k,"default",{enumerable:!0,value:B})}:function(k,B){k.default=B}),W=this&&this.__importStar||function(k){if(k&&k.__esModule)return k;var B={};if(k!=null)for(var R in k)R!=="default"&&Object.prototype.hasOwnProperty.call(k,R)&&tt(B,k,R);return j(B,k),B},Q=this&&this.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(it,"__esModule",{value:!0});var Z=W($(37674)),L=Q($(88221)),P=Q($(87064)),C=$(20171);function M(k,B){var R=k.nodes,F=k.edges,K=B.width,O=B.height;if(!(R==null?void 0:R.length))return Promise.resolve();var _=[];R.forEach(function(ot){var pt=F.filter(function(Gt){return Gt.source===ot.id||Gt.target===ot.id});if(pt.length>1){var Nt=X({},ot);delete Nt.size,_.push(Nt)}});var ft=[];F.forEach(function(ot){var pt=_.find(function(Gt){return Gt.id===ot.source}),Nt=_.find(function(Gt){return Gt.id===ot.target});pt&&Nt&&ft.push(ot)});var mt=new C.DagreLayout({type:"dagre",ranksep:B.nodeMinGap,nodesep:B.nodeMinGap}),st=mt.layout({nodes:_,edges:ft}).nodes;R.forEach(function(ot){var pt=(st||[]).find(function(Nt){return Nt.id===ot.id});ot.x=(pt==null?void 0:pt.x)||K/2,ot.y=(pt==null?void 0:pt.y)||O/2});var ut=JSON.parse(JSON.stringify(R)),dt=JSON.parse(JSON.stringify(F)),gt=Z.forceSimulation().nodes(ut).force("link",Z.forceLink(dt).id(function(ot){return ot.id}).distance(function(ot){var pt=ft.find(function(Nt){return Nt.source===ot.source&&Nt.target===ot.target});return pt?30:20})).force("charge",Z.forceManyBody()).force("center",Z.forceCenter(K/2,O/2)).force("x",Z.forceX(K/2)).force("y",Z.forceY(O/2)).alpha(.3).alphaDecay(.08).alphaMin(.001),wt=new Promise(function(ot){gt.on("end",function(){R.forEach(function(ke){var we=ut.find(function(At){return At.id===ke.id});we&&(ke.x=we.x,ke.y=we.y)});var pt=Math.min.apply(Math,R.map(function(ke){return ke.x})),Nt=Math.max.apply(Math,R.map(function(ke){return ke.x})),Gt=Math.min.apply(Math,R.map(function(ke){return ke.y})),se=Math.max.apply(Math,R.map(function(ke){return ke.y})),ie=K/(Nt-pt),Be=O/(se-Gt);R.forEach(function(ke){ke.x!==void 0&&ie<1&&(ke.x=(ke.x-pt)*ie),ke.y!==void 0&&Be<1&&(ke.y=(ke.y-Gt)*Be)}),R.forEach(function(ke){ke.sizeTemp=ke.size,ke.size=[10,10]}),(0,P.default)(R,F),R.forEach(function(ke){ke.size=ke.sizeTemp||[],delete ke.sizeTemp}),(0,L.default)({nodes:R,edges:F},B),ot()})});return wt}it.default=M},88221:function(sr,it,$){"use strict";var X=this&&this.__importDefault||function(W){return W&&W.__esModule?W:{default:W}};Object.defineProperty(it,"__esModule",{value:!0});var tt=X($(28611));function j(W,Q){if(!W.nodes||W.nodes.length===0)return W;var Z=Q.width,L=Q.height,P=Q.nodeMinGap,C=1e4,M=1e4;W.nodes.forEach(function(dt){var gt=dt.size[0]||50,wt=dt.size[1]||50;C=Math.min(gt,C),M=Math.min(wt,M)});var k=new tt.default;k.init(Z,L,{CELL_H:M,CELL_W:C}),W.nodes.forEach(function(dt){var gt=k.occupyNearest(dt);gt&&(gt.node={id:dt.id,size:dt.size},dt.x=gt.x,dt.y=gt.y,dt.dx=gt.dx,dt.dy=gt.dy)});for(var B=0;B<W.nodes.length;B++){var R=W.nodes[B],F=k.findGridByNodeId(R.id);if(!F)throw new Error("can not find node cell");var K=F.column,O=F.row;if(R.size[0]+P>C){for(var _=Math.ceil((R.size[0]+P)/C)-1,ft=_,mt=0;mt<_;mt++){var st=k.additionColumn.indexOf(K+mt+1)>-1;if(st&&!k.cells[K+mt+1][O].node)ft--;else break}k.insertColumn(K,ft)}if(R.size[1]+P>M){for(var _=Math.ceil((R.size[1]+P)/M)-1,ft=_,mt=0;mt<_;mt++){var st=k.additionRow.indexOf(O+mt+1)>-1;if(st&&!k.cells[K][O+mt+1].node)ft--;else break}k.insertRow(O,ft)}}for(var B=0;B<k.columnNum;B++)for(var ut=function(gt){var wt=k.cells[B][gt];if(wt.node){var ot=W.nodes.find(function(pt){var Nt;return pt.id===((Nt=wt==null?void 0:wt.node)===null||Nt===void 0?void 0:Nt.id)});ot&&(ot.x=wt.x+ot.size[0]/2,ot.y=wt.y+ot.size[1]/2)}},mt=0;mt<k.rowNum;mt++)ut(mt)}it.default=j},28611:function(sr,it){"use strict";var $=this&&this.__assign||function(){return $=Object.assign||function(tt){for(var j,W=1,Q=arguments.length;W<Q;W++){j=arguments[W];for(var Z in j)Object.prototype.hasOwnProperty.call(j,Z)&&(tt[Z]=j[Z])}return tt},$.apply(this,arguments)};Object.defineProperty(it,"__esModule",{value:!0});var X=function(){function tt(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}return tt.prototype.init=function(j,W,Q){this.cells=[],this.CELL_W=Q.CELL_W||tt.DEFAULT_CELL_W,this.CELL_H=Q.CELL_H||tt.DEFAULT_CELL_H,this.columnNum=Math.ceil(j/this.CELL_W),this.rowNum=Math.ceil(W/this.CELL_H),tt.MIN_DIST=Math.pow(j,2)+Math.pow(W,2);for(var Z=0;Z<this.columnNum;Z++){for(var L=[],P=0;P<this.rowNum;P++){var C={dx:Z,dy:P,x:Z*this.CELL_W,y:P*this.CELL_H,occupied:!1};L.push(C)}this.cells.push(L)}},tt.prototype.findGridByNodeId=function(j){for(var W,Q,Z=0;Z<this.columnNum;Z++)for(var L=0;L<this.rowNum;L++)if(this.cells[Z][L].node&&((Q=(W=this.cells[Z][L])===null||W===void 0?void 0:W.node)===null||Q===void 0?void 0:Q.id)===j)return{column:Z,row:L};return null},tt.prototype.sqdist=function(j,W){return Math.pow(j.x-W.x,2)+Math.pow(j.y-W.y,2)},tt.prototype.occupyNearest=function(j){for(var W=tt.MIN_DIST,Q,Z=null,L=0;L<this.columnNum;L++)for(var P=0;P<this.rowNum;P++)!this.cells[L][P].occupied&&(Q=this.sqdist(j,this.cells[L][P]))<W&&(W=Q,Z=this.cells[L][P]);return Z&&(Z.occupied=!0),Z},tt.prototype.insertColumn=function(j,W){if(!(W<=0)){for(var Q=0;Q<W;Q++){this.cells[Q+this.columnNum]=[];for(var Z=0;Z<this.rowNum;Z++)this.cells[Q+this.columnNum][Z]={dx:Q,dy:Z,x:Q*this.CELL_W,y:Z*this.CELL_H,occupied:!1,node:null}}for(var Q=this.columnNum-1;Q>j;Q--)for(var Z=0;Z<this.rowNum;Z++)this.cells[Q+W][Z]=$($({},this.cells[Q][Z]),{x:(Q+W)*this.CELL_W,y:Z*this.CELL_H}),this.cells[Q][Z]={x:Q*this.CELL_W,y:Z*this.CELL_H,occupied:!0,node:null};for(var Z=0;Z<this.additionColumn.length;Z++)this.additionColumn[Z]>=j&&(this.additionColumn[Z]+=W);for(var Q=0;Q<W;Q++)this.additionColumn.push(j+Q+1);this.columnNum+=W}},tt.prototype.insertRow=function(j,W){if(!(W<=0)){for(var Q=0;Q<W;Q++)for(var Z=0;Z<this.columnNum;Z++)this.cells[Z][Q+this.rowNum]={dx:Z,dy:Q,x:Z*this.CELL_W,y:Q*this.CELL_H,occupied:!1,node:null};for(var Z=0;Z<this.columnNum;Z++)for(var Q=this.rowNum-1;Q>j;Q--)this.cells[Z][Q+W]=$($({},this.cells[Z][Q]),{dx:Z,dy:Q+W,x:Z*this.CELL_W,y:(Q+W)*this.CELL_H}),this.cells[Z][Q]={dx:Z,dy:Q,x:Z*this.CELL_W,y:Q*this.CELL_H,occupied:!1,node:null};for(var Q=0;Q<this.additionRow.length;Q++)this.additionRow[Q]>=j&&(this.additionRow[Q]+=W);for(var Z=0;Z<W;Z++)this.additionRow.push(j+Z+1);this.rowNum+=W}},tt.prototype.getNodes=function(){for(var j=[],W=0;W<this.columnNum;W++)for(var Q=0;Q<this.rowNum;Q++)this.cells[W][Q].node&&j.push(this.cells[W][Q]);return j},tt.MIN_DIST=50,tt.DEFAULT_CELL_W=80,tt.DEFAULT_CELL_H=80,tt}();it.default=X},90441:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var Z=function(L,P){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,M){C.__proto__=M}||function(C,M){for(var k in M)Object.prototype.hasOwnProperty.call(M,k)&&(C[k]=M[k])},Z(L,P)};return function(L,P){if(typeof P!="function"&&P!==null)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");Z(L,P);function C(){this.constructor=L}L.prototype=P===null?Object.create(P):(C.prototype=P.prototype,new C)}}(),tt=this&&this.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}};Object.defineProperty(it,"__esModule",{value:!0}),it.ERLayout=void 0;var j=$(62329),W=tt($(34015)),Q=function(Z){X(L,Z);function L(P){var C=Z.call(this)||this;return C.width=300,C.height=300,C.nodeMinGap=50,C.onLayoutEnd=function(){},P&&C.updateCfg(P),C}return L.prototype.getDefaultCfg=function(){return{width:300,height:300,nodeMinGap:50}},L.prototype.execute=function(){var P=this,C=P.nodes,M=P.edges;return C==null||C.forEach(function(k){k.size||(k.size=[50,50])}),(0,W.default)({nodes:C,edges:M},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then(function(){P.onLayoutEnd&&P.onLayoutEnd()})},L.prototype.getType=function(){return"er"},L}(j.Base);it.ERLayout=Q},87064:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=1200,X=800,tt=1e7,j=10,W=3.141592653589793,Q=1.5707963267948966,Z=W*.375,L=W*.625,P=new Map,C=10,M=10,k=.8,B=.1,R=.5;function F(ut,dt,gt){var wt=ut.x-ut.size[0]/2,ot=ut.y-ut.size[1]/2,pt=ut.x+ut.size[0]/2,Nt=ut.y+ut.size[1]/2,Gt=dt.x-dt.size[0]/2,se=dt.y-dt.size[1]/2,ie=dt.x+dt.size[0]/2,Be=dt.y+dt.size[1]/2,ke=ut.x,we=ut.y,At=dt.x,Yt=dt.y,be=At-ke,nn=Math.atan2(be,Yt-we),Ee=0,le=0,Le=0,Ze=0;nn>Q?(le=ot-Be,Ee=Gt-pt,Le=parseFloat(le?(le/Math.cos(nn)).toFixed(2):Ee.toFixed(2)),Ze=parseFloat(Ee?(Ee/Math.sin(nn)).toFixed(2):le.toFixed(2))):0<nn&&nn<=Q?(le=se-Nt,Ee=Gt-pt,le>Ee?Le=Ze=parseFloat(le?(le/Math.cos(nn)).toFixed(2):Ee.toFixed(2)):Le=Ze=parseFloat(Ee?(Ee/Math.sin(nn)).toFixed(2):le.toFixed(2))):nn<-Q?(le=ot-Be,Ee=-(ie-wt),le>Ee?Le=Ze=parseFloat(le?(le/Math.cos(nn)).toFixed(2):Ee.toFixed(2)):Le=Ze=parseFloat(Ee?(Ee/Math.sin(nn)).toFixed(2):le.toFixed(2))):(le=se-Nt,Math.abs(be)>(pt-wt)/2?Ee=wt-ie:Ee=be,le>Ee?Le=Ze=parseFloat(le?(le/Math.cos(nn)).toFixed(2):Ee.toFixed(2)):Le=Ze=parseFloat(Ee&&nn!==0?(Ee/Math.sin(nn)).toFixed(2):le.toFixed(2)));var fe=parseFloat(nn.toFixed(2)),Re=gt;return gt&&(Re=Z<fe&&fe<L),{distance:Math.abs(Le<Ze?Le:Ze),isHoriz:Re}}function K(ut,dt){var gt=P.get(ut.id)||[],wt=gt.find(function(Ne){return Ne.source===dt.id||Ne.target===dt.id}),ot=ut.size[0]*ut.size[1],pt=dt.size[0]*dt.size[1],Nt=ot>pt?dt:ut,Gt=ot>pt?ut:dt,se=Nt.x-Nt.size[0]/2,ie=Nt.y-Nt.size[1]/2,Be=Nt.x+Nt.size[0]/2,ke=Nt.y+Nt.size[1]/2,we=Gt.x-Gt.size[0]/2,At=Gt.y-Gt.size[1]/2,Yt=Gt.x+Gt.size[0]/2,be=Gt.y+Gt.size[1]/2,nn=Nt.x,Ee=Nt.y,le=Gt.x,Le=Gt.y,Ze=Be>=we&&Yt>=se&&ke>=At&&be>=ie,fe=0,Re=0;if(Ze){Re=Math.sqrt(Math.pow(le-nn,2)+Math.pow(Le-Ee,2));var He=se>we?se:we,pe=ie>At?ie:At,Ge=Be<Yt?Be:Yt,te=ke<be?ke:be,Me=Ge-He,We=te-pe,ee=Me*We;Re===0&&(Re=1e-7),fe=j*1/Re*100+ee,fe*=tt}else{var Pt=!1,yt=F(Nt,Gt,Pt);Re=yt.distance,Pt=yt.isHoriz,Re<=j?Re!==0?wt?fe+=j+tt*1/Re:fe+=j+tt*j/Re:fe+=tt:(fe+=Re,wt&&(fe+=Re*Re))}return fe}function O(ut){for(var dt=0,gt=0;gt<ut.length;gt++){var wt=ut[gt];(wt.x<0||wt.y<0||wt.x>$||wt.y>X)&&(dt+=1e12);for(var ot=gt+1;ot<ut.length;ot++)dt+=K(wt,ut[ot])}return dt}function _(ut,dt,gt,wt){var ot=new Map;gt.forEach(function(nn,Ee){ot.set(nn.id,nn)});var pt=wt.filter(function(nn){return nn.source===ut.id||nn.target===ut.id})||[],Nt=[];pt.forEach(function(nn){var Ee=nn.source===ut.id?nn.target:nn.source,le=ot.get(Ee);le&&Nt.push(le)});for(var Gt=!0,se=0;se<Nt.length;se++){var ie=Nt[se],Be=Math.atan((ut.y-ie.y)/(ie.x-ut.y))*180,ke=Math.atan((dt.y-ie.y)/(ie.x-dt.y))*180,we=Be<30||Be>150,At=ke<30||ke>150,Yt=Be>70&&Be<110,be=ke>70&&ke<110;if(we&&!At||Be*ke<0){Gt=!1;break}else if(Yt&&!be||Be*ke<0){Gt=!1;break}else if((ie.x-ut.x)*(ie.x-dt.x)<0){Gt=!1;break}else if((ie.y-ut.y)*(ie.y-dt.y)<0){Gt=!1;break}}return Gt}function ft(ut,dt){for(var gt=!1,wt=1,ot=C*wt,pt=M*wt,Nt=[ot,-ot,0,0],Gt=[0,0,pt,-pt],se=0;se<ut.length;++se)for(var ie=ut[se],Be=mt(ie,ut),ke=0;ke<Nt.length;ke++){var we=_(ie,{x:ie.x+Nt[ke],y:ie.y+Gt[ke]},ut,dt);if(we){ie.x+=Nt[ke],ie.y+=Gt[ke];var At=mt(ie,ut),Yt=Math.random();At<Be||Yt<k&&Yt>B?(Be=At,gt=!0):(ie.x-=Nt[ke],ie.y-=Gt[ke])}}return k>B&&(k*=R),gt?O(ut):0}function mt(ut,dt){var gt=0;(ut.x<0||ut.y<0||ut.x+ut.size[0]+20>$||ut.y+ut.size[1]+20>X)&&(gt+=1e12);for(var wt=0;wt<dt.length;++wt)ut.id!==dt[wt].id&&(gt+=K(ut,dt[wt]));return gt}function st(ut,dt){if(ut.length===0)return{nodes:ut,edges:dt};ut.forEach(function(ie){var Be=dt.filter(function(ke){return ke.source===ie.id||ke.target===ie.id});P.set(ie,Be)}),ut.sort(function(ie,Be){var ke,we;return((ke=P.get(ie.id))===null||ke===void 0?void 0:ke.length)-((we=P.get(Be.id))===null||we===void 0?void 0:we.length)});for(var gt=O(ut),wt=20,ot=1,pt=0,Nt=50,Gt=0;wt>0&&(Gt++,!(Gt>=Nt));){var se=ft(ut,dt);se!==0&&(pt=se),ot=pt-gt,gt=pt,ot===0?--wt:wt=20}return ut.forEach(function(ie){ie.x=ie.x-ie.size[0]/2,ie.y=ie.y-ie.size[1]/2}),{nodes:ut,edges:dt}}it.default=st},89806:function(sr,it,$){"use strict";var X=this&&this.__createBinding||(Object.create?function(L,P,C,M){M===void 0&&(M=C);var k=Object.getOwnPropertyDescriptor(P,C);(!k||("get"in k?!P.__esModule:k.writable||k.configurable))&&(k={enumerable:!0,get:function(){return P[C]}}),Object.defineProperty(L,M,k)}:function(L,P,C,M){M===void 0&&(M=C),L[M]=P[C]}),tt=this&&this.__setModuleDefault||(Object.create?function(L,P){Object.defineProperty(L,"default",{enumerable:!0,value:P})}:function(L,P){L.default=P}),j=this&&this.__importStar||function(L){if(L&&L.__esModule)return L;var P={};if(L!=null)for(var C in L)C!=="default"&&Object.prototype.hasOwnProperty.call(L,C)&&X(P,L,C);return tt(P,L),P};Object.defineProperty(it,"__esModule",{value:!0});var W=j($(37674)),Q=$(49784);function Z(){function L(te){return function(){return te}}var P=function(te){return te.cluster},C=L(1),M=L(-1),k=L(100),B=L(.1),R=[0,0],F=[],K={},O=[],_=100,ft=100,mt={none:{x:0,y:0}},st=[],ut,dt="force",gt=!0,wt=.1;function ot(te){if(!gt)return ot;ut.tick(),Be();for(var Me=0,We=F.length,ee=void 0,Pt=te*wt;Me<We;++Me)ee=F[Me],ee.vx+=(mt[P(ee)].x-ee.x)*Pt,ee.vy+=(mt[P(ee)].y-ee.y)*Pt}function pt(){!F||Nt()}function Nt(){if(!(!F||!F.length)){if(P(F[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");var te=Gt();ut=W.forceSimulation(te.nodes).force("x",W.forceX(_).strength(.1)).force("y",W.forceY(ft).strength(.1)).force("collide",W.forceCollide(function(Me){return Me.r}).iterations(4)).force("charge",W.forceManyBody().strength(M)).force("links",W.forceLink(te.nodes.length?te.links:[]).distance(k).strength(B)),st=ut.nodes(),Be()}}function Gt(){var te=[],Me=[],We={},ee=[],Pt={},yt=[];return Pt=se(F),yt=ie(O),ee=Object.keys(Pt),ee.forEach(function(Ne,tn){var fn=Pt[Ne];te.push({id:Ne,size:fn.count,r:Math.sqrt(fn.sumforceNodeSize/Math.PI)}),We[Ne]=tn}),yt.forEach(function(Ne){var tn=(0,Q.getEdgeTerminal)(Ne,"source"),fn=(0,Q.getEdgeTerminal)(Ne,"target"),Rt=We[tn],Yn=We[fn];Rt!==void 0&&Yn!==void 0&&Me.push({source:Rt,target:Yn,count:Ne.count})}),{nodes:te,links:Me}}function se(te){var Me={};return te.forEach(function(We){var ee=P(We);Me[ee]||(Me[ee]={count:0,sumforceNodeSize:0})}),te.forEach(function(We){var ee=P(We),Pt=C(We),yt=Me[ee];yt.count=yt.count+1,yt.sumforceNodeSize=yt.sumforceNodeSize+Math.PI*(Pt*Pt)*1.3,Me[ee]=yt}),Me}function ie(te){var Me={},We=[];te.forEach(function(Pt){var yt=ke(Pt),Ne=0;Me[yt]!==void 0&&(Ne=Me[yt]),Ne+=1,Me[yt]=Ne});var ee=Object.entries(Me);return ee.forEach(function(Pt){var yt=Pt[0],Ne=Pt[1],tn=yt.split("~")[0],fn=yt.split("~")[1];tn!==void 0&&fn!==void 0&&We.push({source:tn,target:fn,count:Ne})}),We}function Be(){return mt={none:{x:0,y:0}},st.forEach(function(te){mt[te.id]={x:te.x-R[0],y:te.y-R[1]}}),mt}function ke(te){var Me=(0,Q.getEdgeTerminal)(te,"source"),We=(0,Q.getEdgeTerminal)(te,"target"),ee=P(K[Me]),Pt=P(K[We]);return ee<=Pt?"".concat(ee,"~").concat(Pt):"".concat(Pt,"~").concat(ee)}function we(te){K={},te.forEach(function(Me){K[Me.id]=Me})}function At(te){return arguments.length?(dt=te,pt(),ot):dt}function Yt(te){return arguments.length?typeof te=="string"?(P=function(Me){return Me[te]},ot):(P=te,ot):P}function be(te){return arguments.length?(gt=te,ot):gt}function nn(te){return arguments.length?(wt=te,ot):wt}function Ee(te){return arguments.length?(_=te,ot):_}function le(te){return arguments.length?(ft=te,ot):ft}function Le(te){return arguments.length?(we(te||[]),F=te||[],ot):F}function Ze(te){return arguments.length?(O=te||[],pt(),ot):O}function fe(te){return arguments.length?(typeof te=="function"?C=te:C=L(+te),pt(),ot):C}function Re(te){return arguments.length?(typeof te=="function"?M=te:M=L(+te),pt(),ot):M}function He(te){return arguments.length?(typeof te=="function"?k=te:k=L(+te),pt(),ot):k}function pe(te){return arguments.length?(typeof te=="function"?B=te:B=L(+te),pt(),ot):B}function Ge(te){return arguments.length?(R=te,ot):R}return ot.initialize=function(te){F=te,pt()},ot.template=At,ot.groupBy=Yt,ot.enableGrouping=be,ot.strength=nn,ot.centerX=Ee,ot.centerY=le,ot.nodes=Le,ot.links=Ze,ot.forceNodeSize=fe,ot.nodeSize=ot.forceNodeSize,ot.forceCharge=Re,ot.forceLinkDistance=He,ot.forceLinkStrength=pe,ot.offset=Ge,ot.getFocis=Be,ot}it.default=Z},8810:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var F=function(K,O){return F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,ft){_.__proto__=ft}||function(_,ft){for(var mt in ft)Object.prototype.hasOwnProperty.call(ft,mt)&&(_[mt]=ft[mt])},F(K,O)};return function(K,O){if(typeof O!="function"&&O!==null)throw new TypeError("Class extends value "+String(O)+" is not a constructor or null");F(K,O);function _(){this.constructor=K}K.prototype=O===null?Object.create(O):(_.prototype=O.prototype,new _)}}(),tt=this&&this.__createBinding||(Object.create?function(F,K,O,_){_===void 0&&(_=O);var ft=Object.getOwnPropertyDescriptor(K,O);(!ft||("get"in ft?!K.__esModule:ft.writable||ft.configurable))&&(ft={enumerable:!0,get:function(){return K[O]}}),Object.defineProperty(F,_,ft)}:function(F,K,O,_){_===void 0&&(_=O),F[_]=K[O]}),j=this&&this.__setModuleDefault||(Object.create?function(F,K){Object.defineProperty(F,"default",{enumerable:!0,value:K})}:function(F,K){F.default=K}),W=this&&this.__importStar||function(F){if(F&&F.__esModule)return F;var K={};if(F!=null)for(var O in F)O!=="default"&&Object.prototype.hasOwnProperty.call(F,O)&&tt(K,F,O);return j(K,F),K},Q=this&&this.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(it,"__esModule",{value:!0}),it.ForceLayout=void 0;var Z=W($(37674)),L=Q($(89806)),P=$(49784),C=$(62329),M=$(16470),k=function(F){X(K,F);function K(O){var _=F.call(this)||this;return _.center=[0,0],_.nodeStrength=null,_.edgeStrength=null,_.preventOverlap=!1,_.clusterNodeStrength=null,_.clusterEdgeStrength=null,_.clusterEdgeDistance=null,_.clusterNodeSize=null,_.clusterFociStrength=null,_.linkDistance=50,_.alphaDecay=.028,_.alphaMin=.001,_.alpha=.3,_.collideStrength=1,_.workerEnabled=!1,_.tick=function(){},_.onLayoutEnd=function(){},_.ticking=void 0,O&&_.updateCfg(O),_}return K.prototype.getDefaultCfg=function(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick:function(){},onLayoutEnd:function(){},workerEnabled:!1}},K.prototype.init=function(O){var _=this;_.nodes=O.nodes||[];var ft=O.edges||[];_.edges=ft.map(function(mt){var st={},ut=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(mt).forEach(function(dt){ut.indexOf(dt)>-1||(st[dt]=mt[dt])}),st}),_.ticking=!1},K.prototype.execute=function(O){var _=this,ft=_.nodes,mt=_.edges;if(!_.ticking){var st=_.forceSimulation,ut=_.alphaMin,dt=_.alphaDecay,gt=_.alpha;if(st){if(O){if(_.clustering&&_.clusterForce&&(_.clusterForce.nodes(ft),_.clusterForce.links(mt)),st.nodes(ft),mt&&_.edgeForce)_.edgeForce.links(mt);else if(mt&&!_.edgeForce){var pt=Z.forceLink().id(function(ie){return ie.id}).links(mt);_.edgeStrength&&pt.strength(_.edgeStrength),_.linkDistance&&pt.distance(_.linkDistance),_.edgeForce=pt,st.force("link",pt)}}_.preventOverlap&&_.overlapProcess(st),st.alpha(gt).restart(),this.ticking=!0}else try{var wt=Z.forceManyBody();if(_.nodeStrength&&wt.strength(_.nodeStrength),st=Z.forceSimulation().nodes(ft),_.clustering){var ot=(0,L.default)();ot.centerX(_.center[0]).centerY(_.center[1]).template("force").strength(_.clusterFociStrength),mt&&ot.links(mt),ft&&ot.nodes(ft),ot.forceLinkDistance(_.clusterEdgeDistance).forceLinkStrength(_.clusterEdgeStrength).forceCharge(_.clusterNodeStrength).forceNodeSize(_.clusterNodeSize),_.clusterForce=ot,st.force("group",ot)}if(st.force("center",Z.forceCenter(_.center[0],_.center[1])).force("charge",wt).alpha(gt).alphaDecay(dt).alphaMin(ut),_.preventOverlap&&_.overlapProcess(st),mt){var pt=Z.forceLink().id(function(se){return se.id}).links(mt);_.edgeStrength&&pt.strength(_.edgeStrength),_.linkDistance&&pt.distance(_.linkDistance),_.edgeForce=pt,st.force("link",pt)}if(_.workerEnabled&&!R()&&(_.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),!_.workerEnabled)st.on("tick",function(){_.tick()}).on("end",function(){_.ticking=!1,_.onLayoutEnd&&_.onLayoutEnd()}),_.ticking=!0;else{st.stop();for(var Nt=B(st),Gt=1;Gt<=Nt;Gt++)st.tick(),postMessage({nodes:ft,currentTick:Gt,totalTicks:Nt,type:M.LAYOUT_MESSAGE.TICK},void 0);_.ticking=!1}_.forceSimulation=st,_.ticking=!0}catch(se){_.ticking=!1,console.warn(se)}}},K.prototype.overlapProcess=function(O){var _=this,ft=_.nodeSize,mt=_.nodeSpacing,st,ut,dt=_.collideStrength;if((0,P.isNumber)(mt)?ut=function(){return mt}:(0,P.isFunction)(mt)?ut=mt:ut=function(){return 0},!ft)st=function(pt){if(pt.size){if((0,P.isArray)(pt.size)){var Nt=pt.size[0]>pt.size[1]?pt.size[0]:pt.size[1];return Nt/2+ut(pt)}if((0,P.isObject)(pt.size)){var Nt=pt.size.width>pt.size.height?pt.size.width:pt.size.height;return Nt/2+ut(pt)}return pt.size/2+ut(pt)}return 10+ut(pt)};else if((0,P.isFunction)(ft))st=function(pt){var Nt=ft(pt);return Nt+ut(pt)};else if((0,P.isArray)(ft)){var gt=ft[0]>ft[1]?ft[0]:ft[1],wt=gt/2;st=function(pt){return wt+ut(pt)}}else if((0,P.isNumber)(ft)){var ot=ft/2;st=function(pt){return ot+ut(pt)}}else st=function(){return 10};O.force("collisionForce",Z.forceCollide(st).strength(dt))},K.prototype.updateCfg=function(O){var _=this;_.ticking&&(_.forceSimulation.stop(),_.ticking=!1),_.forceSimulation=null,Object.assign(_,O)},K.prototype.destroy=function(){var O=this;O.ticking&&(O.forceSimulation.stop(),O.ticking=!1),O.nodes=null,O.edges=null,O.destroyed=!0},K}(C.Base);it.ForceLayout=k;function B(F){var K=F.alphaMin(),O=F.alphaTarget(),_=F.alpha(),ft=Math.log((K-O)/(_-O))/Math.log(1-F.alphaDecay()),mt=Math.ceil(ft);return mt}function R(){return typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope}},85717:function(sr,it,$){"use strict";var X=this&&this.__createBinding||(Object.create?function(j,W,Q,Z){Z===void 0&&(Z=Q);var L=Object.getOwnPropertyDescriptor(W,Q);(!L||("get"in L?!W.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return W[Q]}}),Object.defineProperty(j,Z,L)}:function(j,W,Q,Z){Z===void 0&&(Z=Q),j[Z]=W[Q]}),tt=this&&this.__exportStar||function(j,W){for(var Q in j)Q!=="default"&&!Object.prototype.hasOwnProperty.call(W,Q)&&X(W,j,Q)};Object.defineProperty(it,"__esModule",{value:!0}),tt($(8810),it)},91019:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.forceNBody=void 0;var X=$(76749),tt=.81,j=.1;function W(P,C,M,k,B){var R=M/k,F=P.map(function(O,_){var ft=C[O.id],mt=ft.data,st=ft.x,ut=ft.y,dt=ft.size,gt=mt.layout.force.nodeStrength;return{x:st,y:ut,size:dt,index:_,vx:0,vy:0,weight:R*gt}}),K=(0,X.quadtree)(F,function(O){return O.x},function(O){return O.y}).visitAfter(Q);return F.forEach(function(O){L(O,K)}),F.map(function(O,_){var ft=C[P[_].id],mt=ft.data.layout.force.mass,st=mt===void 0?1:mt;B[2*_]=O.vx/st,B[2*_+1]=O.vy/st}),B}it.forceNBody=W;function Q(P){var C=0,M=0,k=0;if(P.length){for(var B=0;B<4;B++){var R=P[B];R&&R.weight&&(C+=R.weight,M+=R.x*R.weight,k+=R.y*R.weight)}P.x=M/C,P.y=k/C,P.weight=C}else{var R=P;P.x=R.data.x,P.y=R.data.y,P.weight=R.data.weight}}var Z=function(P,C,M,k,B,R){var F=R.x-P.x||j,K=R.y-P.y||j,O=k-C,_=F*F+K*K,ft=Math.sqrt(_)*_;if(O*O*tt<_){var mt=P.weight/ft;return R.vx+=F*mt,R.vy+=K*mt,!0}if(P.length)return!1;if(P.data!==R){var mt=P.data.weight/ft;R.vx+=F*mt,R.vy+=K*mt}};function L(P,C){C.visit(function(M,k,B,R,F){return Z(M,k,B,R,F,P)})}},6740:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var P=function(C,M){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,B){k.__proto__=B}||function(k,B){for(var R in B)Object.prototype.hasOwnProperty.call(B,R)&&(k[R]=B[R])},P(C,M)};return function(C,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");P(C,M);function k(){this.constructor=C}C.prototype=M===null?Object.create(M):(k.prototype=M.prototype,new k)}}(),tt=this&&this.__assign||function(){return tt=Object.assign||function(P){for(var C,M=1,k=arguments.length;M<k;M++){C=arguments[M];for(var B in C)Object.prototype.hasOwnProperty.call(C,B)&&(P[B]=C[B])}return P},tt.apply(this,arguments)};Object.defineProperty(it,"__esModule",{value:!0}),it.Force2Layout=void 0;var j=$(62329),W=$(49784),Q=$(91019),Z=function(P,C){var M;return P?(0,W.isNumber)(P)?M=function(k){return P}:M=P:M=function(k){return C||1},M},L=function(P){X(C,P);function C(M){var k=P.call(this)||this;k.maxIteration=1e3,k.workerEnabled=!1,k.edgeStrength=200,k.nodeStrength=1e3,k.coulombDisScale=.005,k.damping=.9,k.maxSpeed=500,k.minMovement=.4,k.interval=.02,k.factor=1,k.linkDistance=200,k.gravity=0,k.clusterNodeStrength=20,k.preventOverlap=!0,k.distanceThresholdMode="mean",k.tick=function(){},k.nodes=[],k.edges=[],k.width=300,k.height=300,k.nodeMap={},k.nodeIdxMap={},k.judgingDistance=0,k.centripetalOptions={leaf:2,single:2,others:1,center:function(R){return{x:k.width/2,y:k.height/2}}};var B=M.getMass;return k.propsGetMass=B,k.updateCfg(M),k}return C.prototype.getCentripetalOptions=function(){var M=this,k=M.leafCluster,B=M.clustering,R=M.nodeClusterBy,F=M.nodes,K=M.nodeMap,O=M.clusterNodeStrength,_=function(Nt){return typeof O=="function"?O(Nt):O},ft={},mt;if(k){mt=this.getSameTypeLeafMap()||{};var st=Array.from(new Set(F==null?void 0:F.map(function(Nt){return Nt[R]})))||[];ft={single:100,leaf:function(Nt,Gt,se){var ie=mt[Nt.id]||{},Be=ie.relativeLeafNodes,ke=ie.sameTypeLeafNodes;return(ke==null?void 0:ke.length)===(Be==null?void 0:Be.length)||(st==null?void 0:st.length)===1?1:_(Nt)},others:1,center:function(Nt,Gt,se){var ie,Be=(((ie=Nt.data)===null||ie===void 0?void 0:ie.layout)||{}).degree;if(!Be)return{x:100,y:100};var ke;if(Be===1){var we=(mt[Nt.id]||{}).sameTypeLeafNodes,At=we===void 0?[]:we;At.length===1?ke=void 0:At.length>1&&(ke=(0,W.getAvgNodePosition)(At))}else ke=void 0;return{x:ke==null?void 0:ke.x,y:ke==null?void 0:ke.y}}}}if(B){mt||(mt=this.getSameTypeLeafMap());var ut=Array.from(new Set(F.map(function(Nt,Gt){return Nt[R]}))).filter(function(Nt){return Nt!==void 0}),dt={};ut.forEach(function(Nt){var Gt=F.filter(function(se){return se[R]===Nt}).map(function(se){return K[se.id]});dt[Nt]=(0,W.getAvgNodePosition)(Gt)}),ft={single:function(Nt){return _(Nt)},leaf:function(Nt){return _(Nt)},others:function(Nt){return _(Nt)},center:function(Nt,Gt,se){var ie=dt[Nt[R]];return{x:ie==null?void 0:ie.x,y:ie==null?void 0:ie.y}}}}this.centripetalOptions=tt(tt({},this.centripetalOptions),ft);var gt=this.centripetalOptions,wt=gt.leaf,ot=gt.single,pt=gt.others;wt&&typeof wt!="function"&&(this.centripetalOptions.leaf=function(){return wt}),ot&&typeof ot!="function"&&(this.centripetalOptions.single=function(){return ot}),pt&&typeof pt!="function"&&(this.centripetalOptions.others=function(){return pt})},C.prototype.updateCfg=function(M){M&&Object.assign(this,M)},C.prototype.getDefaultCfg=function(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}},C.prototype.execute=function(){var M=this;M.stop();var k=M.nodes,B=M.edges,R=M.defSpringLen;if(M.judgingDistance=0,!k||k.length===0){M.onLayoutEnd([]);return}!M.width&&typeof window!="undefined"&&(M.width=window.innerWidth),!M.height&&typeof window!="undefined"&&(M.height=window.innerHeight),M.center||(M.center=[M.width/2,M.height/2]);var F=M.center;if(k.length===1){k[0].x=F[0],k[0].y=F[1],M.onLayoutEnd([tt({},k[0])]);return}M.degreesMap=(0,W.getDegreeMap)(k,B),M.propsGetMass?M.getMass=M.propsGetMass:M.getMass=function(ut){var dt=1;(0,W.isNumber)(ut.mass)&&(dt=ut.mass);var gt=M.degreesMap[ut.id].all;return!gt||gt<5?dt:gt*5*dt};var K=M.nodeSize,O;if(M.preventOverlap){var _=M.nodeSpacing,ft;(0,W.isNumber)(_)?ft=function(){return _}:(0,W.isFunction)(_)?ft=_:ft=function(){return 0},K?(0,W.isArray)(K)?O=function(ut){return Math.max(K[0],K[1])+ft(ut)}:O=function(ut){return K+ft(ut)}:O=function(ut){return ut.size?(0,W.isArray)(ut.size)?Math.max(ut.size[0],ut.size[1])+ft(ut):(0,W.isObject)(ut.size)?Math.max(ut.size.width,ut.size.height)+ft(ut):ut.size+ft(ut):10+ft(ut)}}M.nodeSize=O,M.linkDistance=Z(M.linkDistance,1),M.nodeStrength=Z(M.nodeStrength,1),M.edgeStrength=Z(M.edgeStrength,1);var mt={},st={};k.forEach(function(ut,dt){(0,W.isNumber)(ut.x)||(ut.x=Math.random()*M.width),(0,W.isNumber)(ut.y)||(ut.y=Math.random()*M.height);var gt=M.degreesMap[ut.id];mt[ut.id]=tt(tt({},ut),{data:tt(tt({},ut.data),{size:M.nodeSize(ut)||30,layout:{inDegree:gt.in,outDegree:gt.out,degree:gt.all,tDegree:gt.in,sDegree:gt.out,force:{mass:M.getMass(ut),nodeStrength:M.nodeStrength(ut,B)}}})}),st[ut.id]=dt}),M.nodeMap=mt,M.nodeIdxMap=st,M.edgeInfos=[],B==null||B.forEach(function(ut){var dt=mt[ut.source],gt=mt[ut.target];!dt||!gt?elf.edgeInfos.push({}):M.edgeInfos.push({edgeStrength:M.edgeStrength(ut),linkDistance:R?R(tt(tt({},ut),{source:dt,target:gt}),dt,gt):M.linkDistance(ut,dt,gt)||1+(K(dt)+K(dt)||0)/2})}),this.getCentripetalOptions(),M.onLayoutEnd=M.onLayoutEnd||function(){},M.run()},C.prototype.run=function(){var M=this,k=M.maxIteration,B=M.nodes,R=M.edges,F=M.workerEnabled,K=M.minMovement,O=M.animate,_=M.nodeMap,ft=M.height;if(M.currentMinY=0,M.currentMaxY=ft,!!B){var mt=[];if(B.forEach(function(pt,Nt){mt[2*Nt]=0,mt[2*Nt+1]=0}),this.defSideCoe&&typeof this.defSideCoe=="function"){var st={};R.forEach(function(pt){var Nt=pt.source,Gt=pt.target;st[Nt]=st[Nt]||[],st[Nt].push(pt),st[Gt]=st[Gt]||[],st[Gt].push(pt)}),this.relatedEdges=st}var ut=k,dt=!O;if(F||dt){for(var gt=0,wt=0;(M.judgingDistance>K||wt<1)&&wt<ut;wt++)gt=wt,M.runOneStep(wt,mt);M.onLayoutEnd(Object.values(_))}else{if(typeof window=="undefined")return;var ot=0;this.timeInterval=window.setInterval(function(){!B||(M.runOneStep(ot,mt),ot++,(ot>=ut||M.judgingDistance<K)&&(M.onLayoutEnd(Object.values(_)),window.clearInterval(M.timeInterval)))},0)}}},C.prototype.runOneStep=function(M,k){var B,R=this,F=R.nodes,K=R.edges,O=R.nodeMap,_=R.monitor,ft=[];if(!!(F==null?void 0:F.length)){R.calRepulsive(ft),K&&R.calAttractive(ft),R.calGravity(ft),R.attractToSide(ft);var mt=R.interval;if(R.updateVelocity(ft,k,mt),R.updatePosition(k,mt),(B=R.tick)===null||B===void 0||B.call(R),_){var st=this.calTotalEnergy(ft);_({energy:st,nodes:F,edges:K,iterations:M})}}},C.prototype.calTotalEnergy=function(M){var k=this,B=k.nodes,R=k.nodeMap;if(!(B==null?void 0:B.length))return 0;var F=0;return B.forEach(function(K,O){var _=M[2*O],ft=M[2*O+1],mt=_*_+ft*ft,st=R[K.id].data.layout.force.mass,ut=st===void 0?1:st;F+=ut*mt*.5}),F},C.prototype.calRepulsive=function(M){var k=this,B=k.nodes,R=k.nodeMap,F=k.factor,K=k.coulombDisScale,O=k.nodeSize;(0,Q.forceNBody)(B,R,F,K*K,M)},C.prototype.calAttractive=function(M){var k=this,B=k.edges,R=k.nodeMap,F=k.nodeIdxMap,K=k.edgeInfos,O=k.nodeSize;B.forEach(function(_,ft){var mt=(0,W.getEdgeTerminal)(_,"source"),st=(0,W.getEdgeTerminal)(_,"target"),ut=R[mt],dt=R[st];if(!(!ut||!dt)){var gt=dt.x-ut.x,wt=dt.y-ut.y;!gt&&!wt&&(gt=Math.random()*.01,wt=Math.random()*.01);var ot=Math.sqrt(gt*gt+wt*wt),pt=gt/ot,Nt=wt/ot,Gt=K[ft]||{},se=Gt.linkDistance,ie=se===void 0?200:se,Be=Gt.edgeStrength,ke=Be===void 0?200:Be,we=ie-ot,At=we*ke,Yt=ut.data.layout.force.mass||1,be=dt.data.layout.force.mass||1,nn=1/Yt,Ee=1/be,le=pt*At,Le=Nt*At,Ze=2*F[mt],fe=2*F[st];M[Ze]-=le*nn,M[Ze+1]-=Le*nn,M[fe]+=le*Ee,M[fe+1]+=Le*Ee}})},C.prototype.calGravity=function(M){var k,B=this,R=B.nodes,F=B.edges,K=F===void 0?[]:F,O=B.nodeMap,_=B.width,ft=B.height,mt=B.center,st=B.gravity,ut=B.degreesMap,dt=B.centripetalOptions;if(!!R)for(var gt=R.length,wt=0;wt<gt;wt++){var ot=2*wt,pt=O[R[wt].id],Nt=pt.data.layout.force.mass,Gt=Nt===void 0?1:Nt,se=0,ie=0,Be=st,ke=ut[pt.id],we=ke.in,At=ke.out,Yt=ke.all,be=(k=B.getCenter)===null||k===void 0?void 0:k.call(B,pt,Yt);if(be){var nn=be[0],Ee=be[1],le=be[2];se=pt.x-nn,ie=pt.y-Ee,Be=le}else se=pt.x-mt[0],ie=pt.y-mt[1];if(Be&&(M[ot]-=Be*se/Gt,M[ot+1]-=Be*ie/Gt),dt){var Le=dt.leaf,Ze=dt.single,fe=dt.others,Re=dt.center,He=(Re==null?void 0:Re(pt,R,K,_,ft))||{x:0,y:0,centerStrength:0},pe=He.x,Ge=He.y,te=He.centerStrength;if(!(0,W.isNumber)(pe)||!(0,W.isNumber)(Ge))continue;var Me=(pt.x-pe)/Gt,We=(pt.y-Ge)/Gt;if(te&&(M[ot]-=te*Me,M[ot+1]-=te*We),Yt===0){var ee=Ze(pt);if(!ee)continue;M[ot]-=ee*Me,M[ot+1]-=ee*We;continue}if(we===0||At===0){var Pt=Le(pt,R,K);if(!Pt)continue;M[ot]-=Pt*Me,M[ot+1]-=Pt*We;continue}var yt=fe(pt);if(!yt)continue;M[ot]-=yt*Me,M[ot+1]-=yt*We}}},C.prototype.attractToSide=function(M){var k=this,B=k.defSideCoe,R=k.height,F=k.nodes,K=k.relatedEdges,O=k.currentMinY,_=O===void 0?0:O,ft=k.currentMaxY,mt=ft===void 0?this.height:ft;!B||typeof B!="function"||!(F==null?void 0:F.length)||F.forEach(function(st,ut){var dt=B(st,K[st.id]||[]);if(dt!==0){var gt=dt<0?_:mt,wt=Math.abs(dt);M[2*ut+1]-=wt*(st.y-gt)}})},C.prototype.updateVelocity=function(M,k,B){var R=this,F=R.nodes,K=R.damping,O=R.maxSpeed;!(F==null?void 0:F.length)||F.forEach(function(_,ft){var mt=(k[2*ft]+M[2*ft]*B)*K||.01,st=(k[2*ft+1]+M[2*ft+1]*B)*K||.01,ut=Math.sqrt(mt*mt+st*st);if(ut>O){var dt=O/ut;mt=dt*mt,st=dt*st}k[2*ft]=mt,k[2*ft+1]=st})},C.prototype.updatePosition=function(M,k){var B=this,R=B.nodes,F=B.distanceThresholdMode,K=B.nodeMap;if(!(R==null?void 0:R.length)){this.judgingDistance=0;return}var O=0;F==="max"?B.judgingDistance=-Infinity:F==="min"&&(B.judgingDistance=Infinity);var _=Infinity,ft=-Infinity;R.forEach(function(mt,st){var ut=K[mt.id];if((0,W.isNumber)(mt.fx)&&(0,W.isNumber)(mt.fy)){mt.x=mt.fx,mt.y=mt.fy,ut.x=mt.x,ut.y=mt.y;return}var dt=M[2*st]*k,gt=M[2*st+1]*k;mt.x+=dt,mt.y+=gt,ut.x=mt.x,ut.y=mt.y,mt.y<_&&(_=mt.y),mt.y>ft&&(ft=mt.y);var wt=Math.sqrt(dt*dt+gt*gt);switch(F){case"max":B.judgingDistance<wt&&(B.judgingDistance=wt);break;case"min":B.judgingDistance>wt&&(B.judgingDistance=wt);break;default:O=O+wt;break}}),this.currentMinY=_,this.currentMaxY=ft,(!F||F==="mean")&&(B.judgingDistance=O/R.length)},C.prototype.stop=function(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)},C.prototype.destroy=function(){var M=this;M.stop(),M.tick=null,M.nodes=null,M.edges=null,M.destroyed=!0},C.prototype.getType=function(){return"force2"},C.prototype.getSameTypeLeafMap=function(){var M=this,k=M.nodeClusterBy,B=M.nodes,R=M.edges,F=M.nodeMap,K=M.degreesMap;if(!!(B==null?void 0:B.length)){var O={};return B.forEach(function(_,ft){var mt=K[_.id].all;mt===1&&(O[_.id]=(0,W.getCoreNodeAndRelativeLeafNodes)("leaf",_,R,k,K,F))}),O}},C}(j.Base);it.Force2Layout=L},19712:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=function(){function X(tt){this.id=tt.id||0,this.rx=tt.rx,this.ry=tt.ry,this.fx=0,this.fy=0,this.mass=tt.mass,this.degree=tt.degree,this.g=tt.g||0}return X.prototype.distanceTo=function(tt){var j=this.rx-tt.rx,W=this.ry-tt.ry;return Math.hypot(j,W)},X.prototype.setPos=function(tt,j){this.rx=tt,this.ry=j},X.prototype.resetForce=function(){this.fx=0,this.fy=0},X.prototype.addForce=function(tt){var j=tt.rx-this.rx,W=tt.ry-this.ry,Q=Math.hypot(j,W);Q=Q<1e-4?1e-4:Q;var Z=this.g*(this.degree+1)*(tt.degree+1)/Q;this.fx+=Z*j/Q,this.fy+=Z*W/Q},X.prototype.in=function(tt){return tt.contains(this.rx,this.ry)},X.prototype.add=function(tt){var j=this.mass+tt.mass,W=(this.rx*this.mass+tt.rx*tt.mass)/j,Q=(this.ry*this.mass+tt.ry*tt.mass)/j,Z=this.degree+tt.degree,L={rx:W,ry:Q,mass:j,degree:Z};return new X(L)},X}();it.default=$},48564:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var C=function(M,k){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,R){B.__proto__=R}||function(B,R){for(var F in R)Object.prototype.hasOwnProperty.call(R,F)&&(B[F]=R[F])},C(M,k)};return function(M,k){if(typeof k!="function"&&k!==null)throw new TypeError("Class extends value "+String(k)+" is not a constructor or null");C(M,k);function B(){this.constructor=M}M.prototype=k===null?Object.create(k):(B.prototype=k.prototype,new B)}}(),tt=this&&this.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(it,"__esModule",{value:!0}),it.ForceAtlas2Layout=void 0;var j=$(62329),W=$(49784),Q=tt($(19712)),Z=tt($(51638)),L=tt($(62732)),P=function(C){X(M,C);function M(k){var B=C.call(this)||this;return B.center=[0,0],B.width=300,B.height=300,B.nodes=[],B.edges=[],B.kr=5,B.kg=1,B.mode="normal",B.preventOverlap=!1,B.dissuadeHubs=!1,B.barnesHut=void 0,B.maxIteration=0,B.ks=.1,B.ksmax=10,B.tao=.1,B.onLayoutEnd=function(){},B.prune=void 0,B.updateCfg(k),B}return M.prototype.getDefaultCfg=function(){return{}},M.prototype.execute=function(){var k=this,B=k.nodes,R=k.onLayoutEnd,F=k.prune,K=k.maxIteration;!k.width&&typeof window!="undefined"&&(k.width=window.innerWidth),!k.height&&typeof window!="undefined"&&(k.height=window.innerHeight);for(var O=[],_=B.length,ft=0;ft<_;ft+=1){var mt=B[ft],st=10,ut=10;(0,W.isNumber)(mt.size)&&(st=mt.size,ut=mt.size),(0,W.isArray)(mt.size)?(isNaN(mt.size[0])||(st=mt.size[0]),isNaN(mt.size[1])||(ut=mt.size[1])):(0,W.isObject)(mt.size)&&(st=mt.size.width,ut=mt.size.height),k.getWidth&&!isNaN(k.getWidth(mt))&&(ut=k.getWidth(mt)),k.getHeight&&!isNaN(k.getHeight(mt))&&(st=k.getHeight(mt));var dt=Math.max(st,ut);O.push(dt)}k.barnesHut===void 0&&_>250&&(k.barnesHut=!0),k.prune===void 0&&_>100&&(k.prune=!0),this.maxIteration===0&&!k.prune?(K=250,_<=200&&_>100?K=1e3:_>200&&(K=1200),this.maxIteration=K):this.maxIteration===0&&F&&(K=100,_<=200&&_>100?K=500:_>200&&(K=950),this.maxIteration=K),k.kr||(k.kr=50,_>100&&_<=500?k.kr=20:_>500&&(k.kr=1)),k.kg||(k.kg=20,_>100&&_<=500?k.kg=10:_>500&&(k.kg=1)),this.nodes=k.updateNodesByForces(O),R()},M.prototype.updateNodesByForces=function(k){for(var B=this,R=B.edges,F=B.maxIteration,K=B.nodes,O=R.filter(function(ke){var we=(0,W.getEdgeTerminal)(ke,"source"),At=(0,W.getEdgeTerminal)(ke,"target");return we!==At}),_=K.length,ft=O.length,mt=[],st={},ut={},dt=[],gt=0;gt<_;gt+=1)st[K[gt].id]=gt,mt[gt]=0,(K[gt].x===void 0||isNaN(K[gt].x))&&(K[gt].x=Math.random()*1e3),(K[gt].y===void 0||isNaN(K[gt].y))&&(K[gt].y=Math.random()*1e3),dt.push({x:K[gt].x,y:K[gt].y});for(var gt=0;gt<ft;gt+=1){for(var wt=void 0,ot=void 0,pt=0,Nt=0,Gt=0;Gt<_;Gt+=1){var se=(0,W.getEdgeTerminal)(O[gt],"source"),ie=(0,W.getEdgeTerminal)(O[gt],"target");K[Gt].id===se?(wt=K[Gt],pt=Gt):K[Gt].id===ie&&(ot=K[Gt],Nt=Gt),ut[gt]={sourceIdx:pt,targetIdx:Nt}}wt&&(mt[st[wt.id]]+=1),ot&&(mt[st[ot.id]]+=1)}var Be=F;if(K=this.iterate(Be,st,ut,ft,mt,k),B.prune){for(var Gt=0;Gt<ft;Gt+=1)mt[ut[Gt].sourceIdx]<=1?(K[ut[Gt].sourceIdx].x=K[ut[Gt].targetIdx].x,K[ut[Gt].sourceIdx].y=K[ut[Gt].targetIdx].y):mt[ut[Gt].targetIdx]<=1&&(K[ut[Gt].targetIdx].x=K[ut[Gt].sourceIdx].x,K[ut[Gt].targetIdx].y=K[ut[Gt].sourceIdx].y);B.prune=!1,B.barnesHut=!1,Be=100,K=this.iterate(Be,st,ut,ft,mt,k)}return K},M.prototype.iterate=function(k,B,R,F,K,O){for(var _=this,ft=_.nodes,mt=_.kr,st=_.preventOverlap,ut=_.barnesHut,dt=ft.length,gt=0,wt=100,ot=k,pt=50,Nt=[],Gt=[],se=[],ie=0;ie<dt;ie+=1)if(Nt[2*ie]=0,Nt[2*ie+1]=0,ut){var Be={id:ie,rx:ft[ie].x,ry:ft[ie].y,mass:1,g:mt,degree:K[ie]};se[ie]=new Q.default(Be)}for(;ot>0;){for(var ie=0;ie<dt;ie+=1)Gt[2*ie]=Nt[2*ie],Gt[2*ie+1]=Nt[2*ie+1],Nt[2*ie]=0,Nt[2*ie+1]=0;Nt=this.getAttrForces(ot,pt,F,B,R,K,O,Nt),ut&&(st&&ot>pt||!st)?Nt=this.getOptRepGraForces(Nt,se,K):Nt=this.getRepGraForces(ot,pt,Nt,wt,O,K);var ke=this.updatePos(Nt,Gt,gt,K);ft=ke.nodes,gt=ke.sg,ot--,_.tick&&_.tick()}return ft},M.prototype.getAttrForces=function(k,B,R,F,K,O,_,ft){for(var mt=this,st=mt.nodes,ut=mt.preventOverlap,dt=mt.dissuadeHubs,gt=mt.mode,wt=mt.prune,ot=0;ot<R;ot+=1){var pt=st[K[ot].sourceIdx],Nt=K[ot].sourceIdx,Gt=st[K[ot].targetIdx],se=K[ot].targetIdx;if(!(wt&&(O[Nt]<=1||O[se]<=1))){var ie=[Gt.x-pt.x,Gt.y-pt.y],Be=Math.hypot(ie[0],ie[1]);Be=Be<1e-4?1e-4:Be,ie[0]=ie[0]/Be,ie[1]=ie[1]/Be,ut&&k<B&&(Be=Be-_[Nt]-_[se]);var ke=Be,we=ke;gt==="linlog"&&(ke=Math.log(1+Be),we=ke),dt&&(ke=Be/O[Nt],we=Be/O[se]),ut&&k<B&&Be<=0?(ke=0,we=0):ut&&k<B&&Be>0&&(ke=Be,we=Be),ft[2*F[pt.id]]+=ke*ie[0],ft[2*F[Gt.id]]-=we*ie[0],ft[2*F[pt.id]+1]+=ke*ie[1],ft[2*F[Gt.id]+1]-=we*ie[1]}}return ft},M.prototype.getRepGraForces=function(k,B,R,F,K,O){for(var _=this,ft=_.nodes,mt=_.preventOverlap,st=_.kr,ut=_.kg,dt=_.center,gt=_.prune,wt=ft.length,ot=0;ot<wt;ot+=1){for(var pt=ot+1;pt<wt;pt+=1)if(!(gt&&(O[ot]<=1||O[pt]<=1))){var Nt=[ft[pt].x-ft[ot].x,ft[pt].y-ft[ot].y],Gt=Math.hypot(Nt[0],Nt[1]);Gt=Gt<1e-4?1e-4:Gt,Nt[0]=Nt[0]/Gt,Nt[1]=Nt[1]/Gt,mt&&k<B&&(Gt=Gt-K[ot]-K[pt]);var se=st*(O[ot]+1)*(O[pt]+1)/Gt;mt&&k<B&&Gt<0?se=F*(O[ot]+1)*(O[pt]+1):mt&&k<B&&Gt===0?se=0:mt&&k<B&&Gt>0&&(se=st*(O[ot]+1)*(O[pt]+1)/Gt),R[2*ot]-=se*Nt[0],R[2*pt]+=se*Nt[0],R[2*ot+1]-=se*Nt[1],R[2*pt+1]+=se*Nt[1]}var ie=[ft[ot].x-dt[0],ft[ot].y-dt[1]],Be=Math.hypot(ie[0],ie[1]);ie[0]=ie[0]/Be,ie[1]=ie[1]/Be;var ke=ut*(O[ot]+1);R[2*ot]-=ke*ie[0],R[2*ot+1]-=ke*ie[1]}return R},M.prototype.getOptRepGraForces=function(k,B,R){for(var F=this,K=F.nodes,O=F.kg,_=F.center,ft=F.prune,mt=K.length,st=9e10,ut=-9e10,dt=9e10,gt=-9e10,wt=0;wt<mt;wt+=1)ft&&R[wt]<=1||(B[wt].setPos(K[wt].x,K[wt].y),K[wt].x>=ut&&(ut=K[wt].x),K[wt].x<=st&&(st=K[wt].x),K[wt].y>=gt&&(gt=K[wt].y),K[wt].y<=dt&&(dt=K[wt].y));for(var ot=Math.max(ut-st,gt-dt),pt={xmid:(ut+st)/2,ymid:(gt+dt)/2,length:ot,massCenter:_,mass:mt},Nt=new Z.default(pt),Gt=new L.default(Nt),wt=0;wt<mt;wt+=1)ft&&R[wt]<=1||B[wt].in(Nt)&&Gt.insert(B[wt]);for(var wt=0;wt<mt;wt+=1)if(!(ft&&R[wt]<=1)){B[wt].resetForce(),Gt.updateForce(B[wt]),k[2*wt]-=B[wt].fx,k[2*wt+1]-=B[wt].fy;var se=[K[wt].x-_[0],K[wt].y-_[1]],ie=Math.hypot(se[0],se[1]);ie=ie<1e-4?1e-4:ie,se[0]=se[0]/ie,se[1]=se[1]/ie;var Be=O*(R[wt]+1);k[2*wt]-=Be*se[0],k[2*wt+1]-=Be*se[1]}return k},M.prototype.updatePos=function(k,B,R,F){for(var K=this,O=K.nodes,_=K.ks,ft=K.tao,mt=K.prune,st=K.ksmax,ut=O.length,dt=[],gt=[],wt=0,ot=0,pt=0;pt<ut;pt+=1)if(!(mt&&F[pt]<=1)){var Nt=[k[2*pt]-B[2*pt],k[2*pt+1]-B[2*pt+1]],Gt=Math.hypot(Nt[0],Nt[1]),se=[k[2*pt]+B[2*pt],k[2*pt+1]+B[2*pt+1]],ie=Math.hypot(se[0],se[1]);dt[pt]=Gt,gt[pt]=ie/2,wt+=(F[pt]+1)*dt[pt],ot+=(F[pt]+1)*gt[pt]}var Be=R;R=ft*ot/wt,Be!==0&&(R=R>1.5*Be?1.5*Be:R);for(var pt=0;pt<ut;pt+=1)if(!(mt&&F[pt]<=1)&&!((0,W.isNumber)(O[pt].fx)&&(0,W.isNumber)(O[pt].fy))){var ke=_*R/(1+R*Math.sqrt(dt[pt])),we=Math.hypot(k[2*pt],k[2*pt+1]);we=we<1e-4?1e-4:we;var At=st/we;ke=ke>At?At:ke;var Yt=ke*k[2*pt],be=ke*k[2*pt+1];O[pt].x+=Yt,O[pt].y+=be}return{nodes:O,sg:R}},M}(j.Base);it.ForceAtlas2Layout=P},51638:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=function(){function X(tt){this.xmid=tt.xmid,this.ymid=tt.ymid,this.length=tt.length,this.massCenter=tt.massCenter||[0,0],this.mass=tt.mass||1}return X.prototype.getLength=function(){return this.length},X.prototype.contains=function(tt,j){var W=this.length/2;return tt<=this.xmid+W&&tt>=this.xmid-W&&j<=this.ymid+W&&j>=this.ymid-W},X.prototype.NW=function(){var tt=this.xmid-this.length/4,j=this.ymid+this.length/4,W=this.length/2,Q={xmid:tt,ymid:j,length:W},Z=new X(Q);return Z},X.prototype.NE=function(){var tt=this.xmid+this.length/4,j=this.ymid+this.length/4,W=this.length/2,Q={xmid:tt,ymid:j,length:W},Z=new X(Q);return Z},X.prototype.SW=function(){var tt=this.xmid-this.length/4,j=this.ymid-this.length/4,W=this.length/2,Q={xmid:tt,ymid:j,length:W},Z=new X(Q);return Z},X.prototype.SE=function(){var tt=this.xmid+this.length/4,j=this.ymid-this.length/4,W=this.length/2,Q={xmid:tt,ymid:j,length:W},Z=new X(Q);return Z},X}();it.default=$},62732:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=function(){function X(tt){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,tt!=null&&(this.quad=tt)}return X.prototype.insert=function(tt){if(this.body==null){this.body=tt;return}this._isExternal()?(this.quad&&(this.NW=new X(this.quad.NW()),this.NE=new X(this.quad.NE()),this.SW=new X(this.quad.SW()),this.SE=new X(this.quad.SE())),this._putBody(this.body),this._putBody(tt),this.body=this.body.add(tt)):(this.body=this.body.add(tt),this._putBody(tt))},X.prototype._putBody=function(tt){!this.quad||(tt.in(this.quad.NW())&&this.NW?this.NW.insert(tt):tt.in(this.quad.NE())&&this.NE?this.NE.insert(tt):tt.in(this.quad.SW())&&this.SW?this.SW.insert(tt):tt.in(this.quad.SE())&&this.SE&&this.SE.insert(tt))},X.prototype._isExternal=function(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null},X.prototype.updateForce=function(tt){if(!(this.body==null||tt===this.body))if(this._isExternal())tt.addForce(this.body);else{var j=this.quad?this.quad.getLength():0,W=this.body.distanceTo(tt);j/W<this.theta?tt.addForce(this.body):(this.NW&&this.NW.updateForce(tt),this.NE&&this.NE.updateForce(tt),this.SW&&this.SW.updateForce(tt),this.SE&&this.SE.updateForce(tt))}},X}();it.default=$},80374:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var Z=function(L,P){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,M){C.__proto__=M}||function(C,M){for(var k in M)Object.prototype.hasOwnProperty.call(M,k)&&(C[k]=M[k])},Z(L,P)};return function(L,P){if(typeof P!="function"&&P!==null)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");Z(L,P);function C(){this.constructor=L}L.prototype=P===null?Object.create(P):(C.prototype=P.prototype,new C)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.FruchtermanLayout=void 0;var tt=$(62329),j=$(49784),W=800,Q=function(Z){X(L,Z);function L(P){var C=Z.call(this)||this;return C.maxIteration=1e3,C.workerEnabled=!1,C.gravity=10,C.speed=5,C.clustering=!1,C.clusterGravity=10,C.nodes=[],C.edges=[],C.width=300,C.height=300,C.nodeMap={},C.nodeIdxMap={},C.onLayoutEnd=function(){},C.tick=function(){},C.animate=!0,C.updateCfg(P),C}return L.prototype.getDefaultCfg=function(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10,animate:!0}},L.prototype.execute=function(){var P=this,C,M,k=this,B=k.nodes;if(k.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(k.timeInterval),!B||B.length===0){(C=k.onLayoutEnd)===null||C===void 0||C.call(k);return}!k.width&&typeof window!="undefined"&&(k.width=window.innerWidth),!k.height&&typeof window!="undefined"&&(k.height=window.innerHeight),k.center||(k.center=[k.width/2,k.height/2]);var R=k.center;if(B.length===1){B[0].x=R[0],B[0].y=R[1],(M=k.onLayoutEnd)===null||M===void 0||M.call(k);return}var F={},K={};return B.forEach(function(O,_){(0,j.isNumber)(O.x)||(O.x=Math.random()*P.width),(0,j.isNumber)(O.y)||(O.y=Math.random()*P.height),F[O.id]=O,K[O.id]=_}),k.nodeMap=F,k.nodeIdxMap=K,k.run()},L.prototype.run=function(){var P,C=this,M=C.nodes;if(!!M){var k=C.edges,B=C.maxIteration,R=C.workerEnabled,F=C.clustering,K=C.animate,O={};if(F&&M.forEach(function(mt){O[mt.cluster]===void 0&&(O[mt.cluster]={name:mt.cluster,cx:0,cy:0,count:0})}),R||!K){for(var _=0;_<B;_++)C.runOneStep(O);(P=C.onLayoutEnd)===null||P===void 0||P.call(C)}else{if(typeof window=="undefined")return;var ft=0;this.timeInterval=window.setInterval(function(){var mt;C.runOneStep(O),ft++,ft>=B&&((mt=C.onLayoutEnd)===null||mt===void 0||mt.call(C),window.clearInterval(C.timeInterval))},0)}return{nodes:M,edges:k}}},L.prototype.runOneStep=function(P){var C,M=this,k=M.nodes;if(!!k){var B=M.edges,R=M.center,F=M.gravity,K=M.speed,O=M.clustering,_=M.height*M.width,ft=Math.sqrt(_)/10,mt=_/(k.length+1),st=Math.sqrt(mt),ut=[];if(k.forEach(function(wt,ot){ut[ot]={x:0,y:0}}),M.applyCalculate(k,B,ut,st,mt),O){for(var dt in P)P[dt].cx=0,P[dt].cy=0,P[dt].count=0;k.forEach(function(wt){var ot=P[wt.cluster];(0,j.isNumber)(wt.x)&&(ot.cx+=wt.x),(0,j.isNumber)(wt.y)&&(ot.cy+=wt.y),ot.count++});for(var dt in P)P[dt].cx/=P[dt].count,P[dt].cy/=P[dt].count;var gt=M.clusterGravity||F;k.forEach(function(wt,ot){if(!(!(0,j.isNumber)(wt.x)||!(0,j.isNumber)(wt.y))){var pt=P[wt.cluster],Nt=Math.sqrt((wt.x-pt.cx)*(wt.x-pt.cx)+(wt.y-pt.cy)*(wt.y-pt.cy)),Gt=st*gt;ut[ot].x-=Gt*(wt.x-pt.cx)/Nt,ut[ot].y-=Gt*(wt.y-pt.cy)/Nt}})}k.forEach(function(wt,ot){if(!(!(0,j.isNumber)(wt.x)||!(0,j.isNumber)(wt.y))){var pt=.01*st*F;ut[ot].x-=pt*(wt.x-R[0]),ut[ot].y-=pt*(wt.y-R[1])}}),k.forEach(function(wt,ot){if((0,j.isNumber)(wt.fx)&&(0,j.isNumber)(wt.fy)){wt.x=wt.fx,wt.y=wt.fy;return}if(!(!(0,j.isNumber)(wt.x)||!(0,j.isNumber)(wt.y))){var pt=Math.sqrt(ut[ot].x*ut[ot].x+ut[ot].y*ut[ot].y);if(pt>0){var Nt=Math.min(ft*(K/W),pt);wt.x+=ut[ot].x/pt*Nt,wt.y+=ut[ot].y/pt*Nt}}}),(C=M.tick)===null||C===void 0||C.call(M)}},L.prototype.applyCalculate=function(P,C,M,k,B){var R=this;R.calRepulsive(P,M,B),C&&R.calAttractive(C,M,k)},L.prototype.calRepulsive=function(P,C,M){P.forEach(function(k,B){C[B]={x:0,y:0},P.forEach(function(R,F){if(B!==F&&!(!(0,j.isNumber)(k.x)||!(0,j.isNumber)(R.x)||!(0,j.isNumber)(k.y)||!(0,j.isNumber)(R.y))){var K=k.x-R.x,O=k.y-R.y,_=K*K+O*O;if(_===0){_=1;var ft=B>F?1:-1;K=.01*ft,O=.01*ft}var mt=M/_;C[B].x+=K*mt,C[B].y+=O*mt}})})},L.prototype.calAttractive=function(P,C,M){var k=this;P.forEach(function(B){var R=(0,j.getEdgeTerminal)(B,"source"),F=(0,j.getEdgeTerminal)(B,"target");if(!(!R||!F)){var K=k.nodeIdxMap[R],O=k.nodeIdxMap[F];if(K!==O){var _=k.nodeMap[R],ft=k.nodeMap[F];if(!(!(0,j.isNumber)(ft.x)||!(0,j.isNumber)(_.x)||!(0,j.isNumber)(ft.y)||!(0,j.isNumber)(_.y))){var mt=ft.x-_.x,st=ft.y-_.y,ut=Math.sqrt(mt*mt+st*st),dt=ut*ut/M;C[O].x-=mt/ut*dt,C[O].y-=st/ut*dt,C[K].x+=mt/ut*dt,C[K].y+=st/ut*dt}}}})},L.prototype.stop=function(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)},L.prototype.destroy=function(){var P=this;P.stop(),P.tick=null,P.nodes=null,P.edges=null,P.destroyed=!0},L.prototype.getType=function(){return"fruchterman"},L}(tt.Base);it.FruchtermanLayout=Q},13653:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var Z=function(L,P){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,M){C.__proto__=M}||function(C,M){for(var k in M)Object.prototype.hasOwnProperty.call(M,k)&&(C[k]=M[k])},Z(L,P)};return function(L,P){if(typeof P!="function"&&P!==null)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");Z(L,P);function C(){this.constructor=L}L.prototype=P===null?Object.create(P):(C.prototype=P.prototype,new C)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.GForceLayout=void 0;var tt=$(62329),j=$(49784),W=function(Z,L){var P;return Z?(0,j.isNumber)(Z)?P=function(C){return Z}:P=Z:P=function(C){return L||1},P},Q=function(Z){X(L,Z);function L(P){var C=Z.call(this)||this;return C.maxIteration=500,C.workerEnabled=!1,C.edgeStrength=200,C.nodeStrength=1e3,C.coulombDisScale=.005,C.damping=.9,C.maxSpeed=1e3,C.minMovement=.5,C.interval=.02,C.factor=1,C.linkDistance=1,C.gravity=10,C.preventOverlap=!0,C.collideStrength=1,C.tick=function(){},C.nodes=[],C.edges=[],C.width=300,C.height=300,C.nodeMap={},C.nodeIdxMap={},C.animate=!0,C.updateCfg(P),C}return L.prototype.getDefaultCfg=function(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}},L.prototype.execute=function(){var P,C,M=this,k=M.nodes;if(M.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(M.timeInterval),!k||k.length===0){(P=M.onLayoutEnd)===null||P===void 0||P.call(M);return}!M.width&&typeof window!="undefined"&&(M.width=window.innerWidth),!M.height&&typeof window!="undefined"&&(M.height=window.innerHeight),M.center||(M.center=[M.width/2,M.height/2]);var B=M.center;if(k.length===1){k[0].x=B[0],k[0].y=B[1],(C=M.onLayoutEnd)===null||C===void 0||C.call(M);return}var R={},F={};k.forEach(function(st,ut){(0,j.isNumber)(st.x)||(st.x=Math.random()*M.width),(0,j.isNumber)(st.y)||(st.y=Math.random()*M.height),R[st.id]=st,F[st.id]=ut}),M.nodeMap=R,M.nodeIdxMap=F,M.linkDistance=W(M.linkDistance,1),M.nodeStrength=W(M.nodeStrength,1),M.edgeStrength=W(M.edgeStrength,1);var K=M.nodeSize,O;if(M.preventOverlap){var _=M.nodeSpacing,ft;(0,j.isNumber)(_)?ft=function(){return _}:(0,j.isFunction)(_)?ft=_:ft=function(){return 0},K?(0,j.isArray)(K)?O=function(st){return Math.max(K[0],K[1])+ft(st)}:O=function(st){return K+ft(st)}:O=function(st){return st.size?(0,j.isArray)(st.size)?Math.max(st.size[0],st.size[1])+ft(st):(0,j.isObject)(st.size)?Math.max(st.size.width,st.size.height)+ft(st):st.size+ft(st):10+ft(st)}}M.nodeSize=O;var mt=M.edges;M.degrees=(0,j.getDegree)(k.length,M.nodeIdxMap,mt),M.getMass||(M.getMass=function(st){var ut=st.mass||M.degrees[M.nodeIdxMap[st.id]].all||1;return ut}),M.run()},L.prototype.run=function(){var P,C=this,M=C.maxIteration,k=C.nodes,B=C.workerEnabled,R=C.minMovement,F=C.animate;if(!!k)if(B||!F){for(var K=0;K<M;K++){var O=C.runOneStep(K);if(C.reachMoveThreshold(k,O,R))break}(P=C.onLayoutEnd)===null||P===void 0||P.call(C)}else{if(typeof window=="undefined")return;var _=0;this.timeInterval=window.setInterval(function(){var ft,mt;if(!!k){var st=C.runOneStep(_)||[];C.reachMoveThreshold(k,st,R)&&((ft=C.onLayoutEnd)===null||ft===void 0||ft.call(C),window.clearInterval(C.timeInterval)),_++,_>=M&&((mt=C.onLayoutEnd)===null||mt===void 0||mt.call(C),window.clearInterval(C.timeInterval))}},0)}},L.prototype.reachMoveThreshold=function(P,C,M){var k=0;return P.forEach(function(B,R){var F=B.x-C[R].x,K=B.y-C[R].y;k+=Math.sqrt(F*F+K*K)}),k/=P.length,k<M},L.prototype.runOneStep=function(P){var C,M=this,k=M.nodes,B=M.edges,R=[],F=[];if(!!k){k.forEach(function(_,ft){R[2*ft]=0,R[2*ft+1]=0,F[2*ft]=0,F[2*ft+1]=0}),M.calRepulsive(R,k),B&&M.calAttractive(R,B),M.calGravity(R,k);var K=Math.max(.02,M.interval-P*.002);M.updateVelocity(R,F,K,k);var O=[];return k.forEach(function(_){O.push({x:_.x,y:_.y})}),M.updatePosition(F,K,k),(C=M.tick)===null||C===void 0||C.call(M),O}},L.prototype.calRepulsive=function(P,C){var M=this,k=M.getMass,B=M.factor,R=M.coulombDisScale,F=M.preventOverlap,K=M.collideStrength,O=K===void 0?1:K,_=M.nodeStrength,ft=M.nodeSize;C.forEach(function(mt,st){var ut=k?k(mt):1;C.forEach(function(dt,gt){if(!(st>=gt)){var wt=mt.x-dt.x,ot=mt.y-dt.y;wt===0&&ot===0&&(wt=Math.random()*.01,ot=Math.random()*.01);var pt=wt*wt+ot*ot,Nt=Math.sqrt(pt),Gt=(Nt+.1)*R,se=wt/Nt,ie=ot/Nt,Be=(_(mt)+_(dt))*.5*B/(Gt*Gt),ke=k?k(dt):1;if(P[2*st]+=se*Be,P[2*st+1]+=ie*Be,P[2*gt]-=se*Be,P[2*gt+1]-=ie*Be,F&&(ft(mt)+ft(dt))/2>Nt){var we=O*(_(mt)+_(dt))*.5/pt;P[2*st]+=se*we/ut,P[2*st+1]+=ie*we/ut,P[2*gt]-=se*we/ke,P[2*gt+1]-=ie*we/ke}}})})},L.prototype.calAttractive=function(P,C){var M=this,k=M.nodeMap,B=M.nodeIdxMap,R=M.linkDistance,F=M.edgeStrength,K=M.nodeSize,O=M.getMass;C.forEach(function(_,ft){var mt=(0,j.getEdgeTerminal)(_,"source"),st=(0,j.getEdgeTerminal)(_,"target"),ut=k[mt],dt=k[st],gt=dt.x-ut.x,wt=dt.y-ut.y;gt===0&&wt===0&&(gt=Math.random()*.01,wt=Math.random()*.01);var ot=Math.sqrt(gt*gt+wt*wt),pt=gt/ot,Nt=wt/ot,Gt=R(_,ut,dt)||1+(K(ut)+K(dt)||0)/2,se=Gt-ot,ie=se*F(_),Be=B[mt],ke=B[st],we=O?O(ut):1,At=O?O(dt):1;P[2*Be]-=pt*ie/we,P[2*Be+1]-=Nt*ie/we,P[2*ke]+=pt*ie/At,P[2*ke+1]+=Nt*ie/At})},L.prototype.calGravity=function(P,C){for(var M=this,k=M.center,B=M.gravity,R=M.degrees,F=C.length,K=0;K<F;K++){var O=C[K],_=O.x-k[0],ft=O.y-k[1],mt=B;if(M.getCenter){var st=M.getCenter(O,R[K].all);st&&(0,j.isNumber)(st[0])&&(0,j.isNumber)(st[1])&&(0,j.isNumber)(st[2])&&(_=O.x-st[0],ft=O.y-st[1],mt=st[2])}!mt||(P[2*K]-=mt*_,P[2*K+1]-=mt*ft)}},L.prototype.updateVelocity=function(P,C,M,k){var B=this,R=M*B.damping;k.forEach(function(F,K){var O=P[2*K]*R||.01,_=P[2*K+1]*R||.01,ft=Math.sqrt(O*O+_*_);if(ft>B.maxSpeed){var mt=B.maxSpeed/ft;O=mt*O,_=mt*_}C[2*K]=O,C[2*K+1]=_})},L.prototype.updatePosition=function(P,C,M){M.forEach(function(k,B){if((0,j.isNumber)(k.fx)&&(0,j.isNumber)(k.fy)){k.x=k.fx,k.y=k.fy;return}var R=P[2*B]*C,F=P[2*B+1]*C;k.x+=R,k.y+=F})},L.prototype.stop=function(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)},L.prototype.destroy=function(){var P=this;P.stop(),P.tick=null,P.nodes=null,P.edges=null,P.destroyed=!0},L.prototype.getType=function(){return"gForce"},L}(tt.Base);it.GForceLayout=Q},87745:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var k=function(B,R){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,K){F.__proto__=K}||function(F,K){for(var O in K)Object.prototype.hasOwnProperty.call(K,O)&&(F[O]=K[O])},k(B,R)};return function(B,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");k(B,R);function F(){this.constructor=B}B.prototype=R===null?Object.create(R):(F.prototype=R.prototype,new F)}}(),tt=this&&this.__awaiter||function(k,B,R,F){function K(O){return O instanceof R?O:new R(function(_){_(O)})}return new(R||(R=Promise))(function(O,_){function ft(ut){try{st(F.next(ut))}catch(dt){_(dt)}}function mt(ut){try{st(F.throw(ut))}catch(dt){_(dt)}}function st(ut){ut.done?O(ut.value):K(ut.value).then(ft,mt)}st((F=F.apply(k,B||[])).next())})},j=this&&this.__generator||function(k,B){var R={label:0,sent:function(){if(O[0]&1)throw O[1];return O[1]},trys:[],ops:[]},F,K,O,_;return _={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(_[Symbol.iterator]=function(){return this}),_;function ft(st){return function(ut){return mt([st,ut])}}function mt(st){if(F)throw new TypeError("Generator is already executing.");for(;_&&(_=0,st[0]&&(R=0)),R;)try{if(F=1,K&&(O=st[0]&2?K.return:st[0]?K.throw||((O=K.return)&&O.call(K),0):K.next)&&!(O=O.call(K,st[1])).done)return O;switch(K=0,O&&(st=[st[0]&2,O.value]),st[0]){case 0:case 1:O=st;break;case 4:return R.label++,{value:st[1],done:!1};case 5:R.label++,K=st[1],st=[0];continue;case 7:st=R.ops.pop(),R.trys.pop();continue;default:if(O=R.trys,!(O=O.length>0&&O[O.length-1])&&(st[0]===6||st[0]===2)){R=0;continue}if(st[0]===3&&(!O||st[1]>O[0]&&st[1]<O[3])){R.label=st[1];break}if(st[0]===6&&R.label<O[1]){R.label=O[1],O=st;break}if(O&&R.label<O[2]){R.label=O[2],R.ops.push(st);break}O[2]&&R.ops.pop(),R.trys.pop();continue}st=B.call(k,R)}catch(ut){st=[6,ut],K=0}finally{F=O=0}if(st[0]&5)throw st[1];return{value:st[0]?st[1]:void 0,done:!0}}};Object.defineProperty(it,"__esModule",{value:!0}),it.FruchtermanGPULayout=void 0;var W=$(62329),Q=$(49784),Z=$(79984),L=$(48835),P=$(8574),C=$(16470),M=function(k){X(B,k);function B(R){var F=k.call(this)||this;return F.maxIteration=1e3,F.gravity=10,F.speed=1,F.clustering=!1,F.clusterField="cluster",F.clusterGravity=10,F.workerEnabled=!1,F.nodes=[],F.edges=[],F.width=300,F.height=300,F.nodeMap={},F.nodeIdxMap={},F.updateCfg(R),F}return B.prototype.getDefaultCfg=function(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}},B.prototype.execute=function(){return tt(this,void 0,void 0,function(){var R,F,K,O,_,ft=this;return j(this,function(mt){switch(mt.label){case 0:return R=this,F=R.nodes,!F||F.length===0?(R.onLayoutEnd&&R.onLayoutEnd(),[2]):(!R.width&&typeof window!="undefined"&&(R.width=window.innerWidth),!R.height&&typeof window!="undefined"&&(R.height=window.innerHeight),R.center||(R.center=[R.width/2,R.height/2]),K=R.center,F.length===1?(F[0].x=K[0],F[0].y=K[1],R.onLayoutEnd&&R.onLayoutEnd(),[2]):(O={},_={},F.forEach(function(st,ut){(0,Q.isNumber)(st.x)||(st.x=Math.random()*ft.width),(0,Q.isNumber)(st.y)||(st.y=Math.random()*ft.height),O[st.id]=st,_[st.id]=ut}),R.nodeMap=O,R.nodeIdxMap=_,[4,R.run()]));case 1:return mt.sent(),[2]}})})},B.prototype.executeWithWorker=function(R,F){return tt(this,void 0,void 0,function(){var K,O,_,ft,mt,st=this;return j(this,function(ut){switch(ut.label){case 0:return K=this,O=K.nodes,_=K.center,!O||O.length===0?[2]:O.length===1?(O[0].x=_[0],O[0].y=_[1],[2]):(ft={},mt={},O.forEach(function(dt,gt){(0,Q.isNumber)(dt.x)||(dt.x=Math.random()*st.width),(0,Q.isNumber)(dt.y)||(dt.y=Math.random()*st.height),ft[dt.id]=dt,mt[dt.id]=gt}),K.nodeMap=ft,K.nodeIdxMap=mt,[4,K.run(R,F)]);case 1:return ut.sent(),[2]}})})},B.prototype.run=function(R,F){return tt(this,void 0,void 0,function(){var K,O,_,ft,mt,st,ut,dt,gt,wt,ot,pt,Nt,Gt,se,ie,Be,ke,we,At,Yt,be,nn,Ee,le,Le,Ze=this;return j(this,function(fe){switch(fe.label){case 0:for(K=this,O=K.nodes,_=K.edges,ft=K.maxIteration,mt=K.center,st=K.height*K.width,ut=Math.sqrt(st)/10,dt=st/(O.length+1),gt=Math.sqrt(dt),wt=K.speed,ot=K.clustering,pt=(0,L.attributesToTextureData)([K.clusterField],O),Nt=pt.array,Gt=pt.count,O.forEach(function(Re,He){var pe=0,Ge=0;(0,Q.isNumber)(Re.fx)&&(0,Q.isNumber)(Re.fy)&&(pe=Re.fx||.001,Ge=Re.fy||.001),Nt[4*He+1]=pe,Nt[4*He+2]=Ge}),se=O.length,ie=(0,L.buildTextureData)(O,_),Be=ie.maxEdgePerVetex,ke=ie.array,we=K.workerEnabled,we?At=Z.World.create({canvas:R,engineOptions:{supportCompute:!0}}):At=Z.World.create({engineOptions:{supportCompute:!0}}),Yt=K.onLayoutEnd,be=[],nn=0;nn<Gt;nn++)be.push(0,0,0,0);return Ee=At.createKernel(P.fruchtermanBundle).setDispatch([se,1,1]).setBinding({u_Data:ke,u_K:gt,u_K2:dt,u_Gravity:K.gravity,u_ClusterGravity:K.clusterGravity||K.gravity||1,u_Speed:wt,u_MaxDisplace:ut,u_Clustering:ot?1:0,u_Center:mt,u_AttributeArray:Nt,u_ClusterCenters:be,MAX_EDGE_PER_VERTEX:Be,VERTEX_COUNT:se}),ot&&(le=At.createKernel(P.clusterBundle).setDispatch([Gt,1,1]).setBinding({u_Data:ke,u_NodeAttributes:Nt,u_ClusterCenters:be,VERTEX_COUNT:se,CLUSTER_COUNT:Gt})),Le=function(){return tt(Ze,void 0,void 0,function(){var Re,He;return j(this,function(pe){switch(pe.label){case 0:Re=0,pe.label=1;case 1:return Re<ft?[4,Ee.execute()]:[3,6];case 2:return pe.sent(),ot?(le.setBinding({u_Data:Ee}),[4,le.execute()]):[3,4];case 3:pe.sent(),Ee.setBinding({u_ClusterCenters:le}),pe.label=4;case 4:Ee.setBinding({u_MaxDisplace:ut*=.99}),pe.label=5;case 5:return Re++,[3,1];case 6:return[4,Ee.getOutput()];case 7:return He=pe.sent(),R?F.postMessage({type:C.LAYOUT_MESSAGE.GPUEND,vertexEdgeData:He}):O.forEach(function(Ge,te){var Me=He[4*te],We=He[4*te+1];Ge.x=Me,Ge.y=We}),Yt&&Yt(),[2]}})})},[4,Le()];case 1:return fe.sent(),[2]}})})},B.prototype.getType=function(){return"fruchterman-gpu"},B}(W.Base);it.FruchtermanGPULayout=M},8574:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.clusterBundle=it.clusterCode=it.fruchtermanBundle=it.fruchtermanCode=void 0,it.fruchtermanCode=`
import { globalInvocationID } from 'g-webgpu';
const MAX_EDGE_PER_VERTEX;
const VERTEX_COUNT;
@numthreads(1, 1, 1)
class Fruchterman {
  @in @out
  u_Data: vec4[];
  @in
  u_K: float;
  @in
  u_K2: float;
  
  @in
  u_Center: vec2;
  @in
  u_Gravity: float;
  @in
  u_ClusterGravity: float;
  @in
  u_Speed: float;
  @in
  u_MaxDisplace: float;
  @in
  u_Clustering: float;
  @in
  u_AttributeArray: vec4[];
  @in
  u_ClusterCenters: vec4[];
  calcRepulsive(i: int, currentNode: vec4): vec2 {
    let dx = 0, dy = 0;
    for (let j = 0; j < VERTEX_COUNT; j++) {
      if (i != j) {
        const nextNode = this.u_Data[j];
        const xDist = currentNode[0] - nextNode[0];
        const yDist = currentNode[1] - nextNode[1];
        const dist = (xDist * xDist + yDist * yDist) + 0.01;
        let param = this.u_K2 / dist;
        
        if (dist > 0.0) {
          dx += param * xDist;
          dy += param * yDist;
          if (xDist == 0 && yDist == 0) {
            const sign = i < j ? 1 : -1;
            dx += param * sign;
            dy += param * sign;
          }
        }
      }
    }
    return [dx, dy];
  }
  calcGravity(currentNode: vec4, nodeAttributes: vec4): vec2 { // 
    let dx = 0, dy = 0;
    const vx = currentNode[0] - this.u_Center[0];
    const vy = currentNode[1] - this.u_Center[1];
    const gf = 0.01 * this.u_K * this.u_Gravity;
    dx = gf * vx;
    dy = gf * vy;
    if (this.u_Clustering == 1) {
      const clusterIdx = int(nodeAttributes[0]);
      const center = this.u_ClusterCenters[clusterIdx];
      const cvx = currentNode[0] - center[0];
      const cvy = currentNode[1] - center[1];
      const dist = sqrt(cvx * cvx + cvy * cvy) + 0.01;
      const parma = this.u_K * this.u_ClusterGravity / dist;
      dx += parma * cvx;
      dy += parma * cvy;
    }
    return [dx, dy];
  }
  calcAttractive(i: int, currentNode: vec4): vec2 {
    let dx = 0, dy = 0;
    const arr_offset = int(floor(currentNode[2] + 0.5));
    const length = int(floor(currentNode[3] + 0.5));
    const node_buffer: vec4;
    for (let p = 0; p < MAX_EDGE_PER_VERTEX; p++) {
      if (p >= length) break;
      const arr_idx = arr_offset + p;
      // when arr_idx % 4 == 0 update currentNodedx_buffer
      const buf_offset = arr_idx - arr_idx / 4 * 4;
      if (p == 0 || buf_offset == 0) {
        node_buffer = this.u_Data[int(arr_idx / 4)];
      }
      const float_j = buf_offset == 0 ? node_buffer[0] :
                      buf_offset == 1 ? node_buffer[1] :
                      buf_offset == 2 ? node_buffer[2] :
                                        node_buffer[3];
      const nextNode = this.u_Data[int(float_j)];
      const xDist = currentNode[0] - nextNode[0];
      const yDist = currentNode[1] - nextNode[1];
      const dist = sqrt(xDist * xDist + yDist * yDist) + 0.01;
      let attractiveF = dist / this.u_K;
    
      if (dist > 0.0) {
        dx -= xDist * attractiveF;
        dy -= yDist * attractiveF;
        if (xDist == 0 && yDist == 0) {
          const sign = i < int(float_j) ? 1 : -1;
          dx -= sign * attractiveF;
          dy -= sign * attractiveF;
        }
      }
    }
    return [dx, dy];
  }
  @main
  compute() {
    const i = globalInvocationID.x;
    const currentNode = this.u_Data[i];
    let dx = 0, dy = 0;
    if (i >= VERTEX_COUNT) {
      this.u_Data[i] = currentNode;
      return;
    }

    // [gravity, fx, fy, 0]
    const nodeAttributes = this.u_AttributeArray[i];

    if (nodeAttributes[1] != 0 && nodeAttributes[2] != 0) {
      // the node is fixed
      this.u_Data[i] = [
        nodeAttributes[1],
        nodeAttributes[2],
        currentNode[2],
        currentNode[3]
      ];
      return;
    }

    // repulsive
    const repulsive = this.calcRepulsive(i, currentNode);
    dx += repulsive[0];
    dy += repulsive[1];
    // attractive
    const attractive = this.calcAttractive(i, currentNode);
    dx += attractive[0];
    dy += attractive[1];
    // gravity
    const gravity = this.calcGravity(currentNode, nodeAttributes);
    dx -= gravity[0];
    dy -= gravity[1];
    // speed
    dx *= this.u_Speed;
    dy *= this.u_Speed;

    // move
    const distLength = sqrt(dx * dx + dy * dy);
    if (distLength > 0.0) {
      const limitedDist = min(this.u_MaxDisplace * this.u_Speed, distLength);
      this.u_Data[i] = [
        currentNode[0] + dx / distLength * limitedDist,
        currentNode[1] + dy / distLength * limitedDist,
        currentNode[2],
        currentNode[3]
      ];
    }
  }
}
`,it.fruchtermanBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',it.clusterCode=`
import { globalInvocationID } from 'g-webgpu';
const VERTEX_COUNT;
const CLUSTER_COUNT;
@numthreads(1, 1, 1)
class CalcCenter {
  @in
  u_Data: vec4[];
  @in
  u_NodeAttributes: vec4[]; // [[clusterIdx, 0, 0, 0], ...]
  @in @out
  u_ClusterCenters: vec4[]; // [[cx, cy, nodeCount, clusterIdx], ...]
  @main
  compute() {
    const i = globalInvocationID.x;
    const center = this.u_ClusterCenters[i];
    let sumx = 0;
    let sumy = 0;
    let count = 0;
    for (let j = 0; j < VERTEX_COUNT; j++) {
      const attributes = this.u_NodeAttributes[j];
      const clusterIdx = int(attributes[0]);
      const vertex = this.u_Data[j];
      if (clusterIdx == i) {
        sumx += vertex.x;
        sumy += vertex.y;
        count += 1;
      }
    }
    this.u_ClusterCenters[i] = [
      sumx / count,
      sumy / count,
      count,
      i
    ];
  }
}
`,it.clusterBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}'},85194:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var B=function(R,F){return B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(K,O){K.__proto__=O}||function(K,O){for(var _ in O)Object.prototype.hasOwnProperty.call(O,_)&&(K[_]=O[_])},B(R,F)};return function(R,F){if(typeof F!="function"&&F!==null)throw new TypeError("Class extends value "+String(F)+" is not a constructor or null");B(R,F);function K(){this.constructor=R}R.prototype=F===null?Object.create(F):(K.prototype=F.prototype,new K)}}(),tt=this&&this.__awaiter||function(B,R,F,K){function O(_){return _ instanceof F?_:new F(function(ft){ft(_)})}return new(F||(F=Promise))(function(_,ft){function mt(dt){try{ut(K.next(dt))}catch(gt){ft(gt)}}function st(dt){try{ut(K.throw(dt))}catch(gt){ft(gt)}}function ut(dt){dt.done?_(dt.value):O(dt.value).then(mt,st)}ut((K=K.apply(B,R||[])).next())})},j=this&&this.__generator||function(B,R){var F={label:0,sent:function(){if(_[0]&1)throw _[1];return _[1]},trys:[],ops:[]},K,O,_,ft;return ft={next:mt(0),throw:mt(1),return:mt(2)},typeof Symbol=="function"&&(ft[Symbol.iterator]=function(){return this}),ft;function mt(ut){return function(dt){return st([ut,dt])}}function st(ut){if(K)throw new TypeError("Generator is already executing.");for(;ft&&(ft=0,ut[0]&&(F=0)),F;)try{if(K=1,O&&(_=ut[0]&2?O.return:ut[0]?O.throw||((_=O.return)&&_.call(O),0):O.next)&&!(_=_.call(O,ut[1])).done)return _;switch(O=0,_&&(ut=[ut[0]&2,_.value]),ut[0]){case 0:case 1:_=ut;break;case 4:return F.label++,{value:ut[1],done:!1};case 5:F.label++,O=ut[1],ut=[0];continue;case 7:ut=F.ops.pop(),F.trys.pop();continue;default:if(_=F.trys,!(_=_.length>0&&_[_.length-1])&&(ut[0]===6||ut[0]===2)){F=0;continue}if(ut[0]===3&&(!_||ut[1]>_[0]&&ut[1]<_[3])){F.label=ut[1];break}if(ut[0]===6&&F.label<_[1]){F.label=_[1],_=ut;break}if(_&&F.label<_[2]){F.label=_[2],F.ops.push(ut);break}_[2]&&F.ops.pop(),F.trys.pop();continue}ut=R.call(B,F)}catch(dt){ut=[6,dt],O=0}finally{K=_=0}if(ut[0]&5)throw ut[1];return{value:ut[0]?ut[1]:void 0,done:!0}}};Object.defineProperty(it,"__esModule",{value:!0}),it.GForceGPULayout=void 0;var W=$(62329),Q=$(49784),Z=$(79984),L=$(48835),P=$(80628),C=$(49762),M=$(16470),k=function(B){X(R,B);function R(F){var K=B.call(this)||this;return K.maxIteration=1e3,K.edgeStrength=200,K.nodeStrength=1e3,K.coulombDisScale=.005,K.damping=.9,K.maxSpeed=1e3,K.minMovement=.5,K.interval=.02,K.factor=1,K.linkDistance=1,K.gravity=10,K.workerEnabled=!1,K.nodes=[],K.edges=[],K.width=300,K.height=300,K.nodeMap={},K.nodeIdxMap={},K.updateCfg(F),K}return R.prototype.getDefaultCfg=function(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}},R.prototype.execute=function(){return tt(this,void 0,void 0,function(){var F,K,O,_,ft;return j(this,function(mt){switch(mt.label){case 0:return F=this,K=F.nodes,!K||K.length===0?(F.onLayoutEnd&&F.onLayoutEnd(),[2]):(!F.width&&typeof window!="undefined"&&(F.width=window.innerWidth),!F.height&&typeof window!="undefined"&&(F.height=window.innerHeight),F.center||(F.center=[F.width/2,F.height/2]),O=F.center,K.length===1?(K[0].x=O[0],K[0].y=O[1],F.onLayoutEnd&&F.onLayoutEnd(),[2]):(_={},ft={},K.forEach(function(st,ut){(0,Q.isNumber)(st.x)||(st.x=Math.random()*F.width),(0,Q.isNumber)(st.y)||(st.y=Math.random()*F.height),_[st.id]=st,ft[st.id]=ut}),F.nodeMap=_,F.nodeIdxMap=ft,F.nodeStrength=(0,L.proccessToFunc)(F.nodeStrength,1),F.edgeStrength=(0,L.proccessToFunc)(F.edgeStrength,1),[4,F.run()]));case 1:return mt.sent(),[2]}})})},R.prototype.executeWithWorker=function(F,K){var O=this,_=O.nodes,ft=O.center;if(!(!_||_.length===0)){if(_.length===1){_[0].x=ft[0],_[0].y=ft[1];return}var mt={},st={};_.forEach(function(ut,dt){(0,Q.isNumber)(ut.x)||(ut.x=Math.random()*O.width),(0,Q.isNumber)(ut.y)||(ut.y=Math.random()*O.height),mt[ut.id]=ut,st[ut.id]=dt}),O.nodeMap=mt,O.nodeIdxMap=st,O.nodeStrength=(0,L.proccessToFunc)(O.nodeStrength,1),O.edgeStrength=(0,L.proccessToFunc)(O.edgeStrength,1),O.run(F,K)}},R.prototype.run=function(F,K){return tt(this,void 0,void 0,function(){var O,_,ft,mt,st,ut,dt,gt,wt,ot,pt,Nt,Gt,se,ie,Be,ke,we,At,Yt,be,nn,Ee,le,Le,Ze,fe,Re=this;return j(this,function(He){switch(He.label){case 0:for(O=this,_=O.nodes,ft=O.edges,mt=O.maxIteration,!O.width&&typeof window!="undefined"&&(O.width=window.innerWidth),!O.height&&typeof window!="undefined"&&(O.height=window.innerHeight),st=_.length,O.linkDistance=(0,L.proccessToFunc)(O.linkDistance),O.edgeStrength=(0,L.proccessToFunc)(O.edgeStrength),ut=(0,L.buildTextureDataWithTwoEdgeAttr)(_,ft,O.linkDistance,O.edgeStrength),dt=ut.maxEdgePerVetex,gt=ut.array,O.degrees=(0,P.getDegree)(_.length,O.nodeIdxMap,ft).map(function(pe){return pe.all}),wt=[],ot=[],pt=[],Nt=[],Gt=[],se=[],ie=[],O.getMass||(O.getMass=function(pe){return O.degrees[O.nodeIdxMap[pe.id]]||1}),Be=O.gravity,ke=O.center,_.forEach(function(pe,Ge){wt.push(O.getMass(pe)),ot.push(O.nodeStrength(pe)),O.degrees[Ge]||(O.degrees[Ge]=0);var te=[ke[0],ke[1],Be];if(O.getCenter){var Me=O.getCenter(pe,O.degrees[Ge]);Me&&(0,Q.isNumber)(Me[0])&&(0,Q.isNumber)(Me[1])&&(0,Q.isNumber)(Me[2])&&(te=Me)}pt.push(te[0]),Nt.push(te[1]),Gt.push(te[2]),(0,Q.isNumber)(pe.fx)&&(0,Q.isNumber)(pe.fy)?(se.push(pe.fx||.001),ie.push(pe.fy||.001)):(se.push(0),ie.push(0))}),we=(0,L.arrayToTextureData)([wt,O.degrees,ot,se]),At=(0,L.arrayToTextureData)([pt,Nt,Gt,ie]),Yt=O.workerEnabled,Yt?be=Z.World.create({canvas:F,engineOptions:{supportCompute:!0}}):be=Z.World.create({engineOptions:{supportCompute:!0}}),nn=O.onLayoutEnd,Ee=[],gt.forEach(function(pe){Ee.push(pe)}),le=0;le<4;le++)Ee.push(0);return Le=be.createKernel(C.gForceBundle).setDispatch([st,1,1]).setBinding({u_Data:gt,u_damping:O.damping,u_maxSpeed:O.maxSpeed,u_minMovement:O.minMovement,u_coulombDisScale:O.coulombDisScale,u_factor:O.factor,u_NodeAttributeArray1:we,u_NodeAttributeArray2:At,MAX_EDGE_PER_VERTEX:dt,VERTEX_COUNT:st,u_AveMovement:Ee,u_interval:O.interval}),Ze=be.createKernel(C.aveMovementBundle).setDispatch([1,1,1]).setBinding({u_Data:gt,VERTEX_COUNT:st,u_AveMovement:[0,0,0,0]}),fe=function(){return tt(Re,void 0,void 0,function(){var pe,Ge,te;return j(this,function(Me){switch(Me.label){case 0:pe=0,Me.label=1;case 1:return pe<mt?[4,Le.execute()]:[3,5];case 2:return Me.sent(),Ze.setBinding({u_Data:Le}),[4,Ze.execute()];case 3:Me.sent(),Ge=Math.max(.02,O.interval-pe*.002),Le.setBinding({u_interval:Ge,u_AveMovement:Ze}),Me.label=4;case 4:return pe++,[3,1];case 5:return[4,Le.getOutput()];case 6:return te=Me.sent(),F?K.postMessage({type:M.LAYOUT_MESSAGE.GPUEND,vertexEdgeData:te}):_.forEach(function(We,ee){var Pt=te[4*ee],yt=te[4*ee+1];We.x=Pt,We.y=yt}),nn&&nn(),[2]}})})},[4,fe()];case 1:return He.sent(),[2]}})})},R.prototype.getType=function(){return"gForce-gpu"},R}(W.Base);it.GForceGPULayout=k},49762:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.aveMovementBundle=it.aveMovementCode=it.gForceBundle=it.gForceCode=void 0,it.gForceCode=`
import { globalInvocationID } from 'g-webgpu';

const MAX_EDGE_PER_VERTEX;
const VERTEX_COUNT;
const SHIFT_20 = 1048576;

@numthreads(1, 1, 1)
class GGForce {
  @in @out
  u_Data: vec4[];

  @in
  u_damping: float;
  
  @in
  u_maxSpeed: float;

  @in
  u_minMovement: float;

  @in
  u_AveMovement: vec4[];

  @in
  u_coulombDisScale: float;

  @in
  u_factor: float;

  @in
  u_NodeAttributeArray1: vec4[];

  @in
  u_NodeAttributeArray2: vec4[];

  @in
  u_interval: float;

  unpack_float(packedValue: float): ivec2 {
    const packedIntValue = int(packedValue);
    const v0 = packedIntValue / SHIFT_20;
    return [v0, packedIntValue - v0 * SHIFT_20];
  }

  calcRepulsive(i: int, currentNode: vec4): vec2 {
    let ax = 0, ay = 0;
    for (let j: int = 0; j < VERTEX_COUNT; j++) {
      if (i != j) {
        const nextNode = this.u_Data[j];
        const vx = currentNode[0] - nextNode[0];
        const vy = currentNode[1] - nextNode[1];
        const dist = sqrt(vx * vx + vy * vy) + 0.01;
        const n_dist = (dist + 0.1) * this.u_coulombDisScale;
        const direx = vx / dist;
        const direy = vy / dist;
        const attributesi = this.u_NodeAttributeArray1[i];
        const attributesj = this.u_NodeAttributeArray1[j];
        const massi = attributesi[0];
        const nodeStrengthi = attributesi[2];
        const nodeStrengthj = attributesj[2];
        const nodeStrength = (nodeStrengthi + nodeStrengthj) / 2;
        // const param = nodeStrength * this.u_factor / (n_dist * n_dist * massi);
        const param = nodeStrength * this.u_factor / (n_dist * n_dist);
        ax += direx * param;
        ay += direy * param;
      }
    }
    return [ax, ay];
  }

  calcGravity(i: int, currentNode: vec4, attributes2: vec4): vec2 {
    // note: attributes2 = [centerX, centerY, gravity, 0]

    const vx = currentNode[0] - attributes2[0];
    const vy = currentNode[1] - attributes2[1];
    
    const ax = vx * attributes2[2];
    const ay = vy * attributes2[2];
    
    return [ax, ay];
  }

  calcAttractive(i: int, currentNode: vec4, attributes1: vec4): vec2 {
    // note: attributes1 = [mass, degree, nodeSterngth, 0]

    const mass = attributes1[0];
    let ax = 0, ay = 0;
    // const arr_offset = int(floor(currentNode[2] + 0.5));
    // const length = int(floor(currentNode[3] + 0.5));

    const compressed = this.unpack_float(currentNode[2]);
    const length = compressed[0];
    const arr_offset = compressed[1];

    const node_buffer: vec4;
    for (let p: int = 0; p < MAX_EDGE_PER_VERTEX; p++) {
      if (p >= length) break;
      const arr_idx = arr_offset + 4 * p; // i \u8282\u70B9\u7684\u7B2C p \u6761\u8FB9\u5F00\u59CB\u7684\u5C0F\u683C\u5B50\u4F4D\u7F6E
      const buf_offset = arr_idx - arr_idx / 4 * 4;
      if (p == 0 || buf_offset == 0) {
        node_buffer = this.u_Data[int(arr_idx / 4)]; // \u5927\u683C\u5B50\uFF0C\u5927\u683C\u5B50\u4F4D\u7F6E=\u5C0F\u4E2A\u5B50\u4F4D\u7F6E / 4\uFF0C
      }

      let float_j: float = node_buffer[0];

      const nextNode = this.u_Data[int(float_j)];
      const vx = nextNode[0] - currentNode[0];
      const vy = nextNode[1] - currentNode[1];
      const dist = sqrt(vx * vx + vy * vy) + 0.01;
      const direx = vx / dist;
      const direy = vy / dist;
      const edgeLength = node_buffer[1];
      const edgeStrength = node_buffer[2];
      const diff: float = edgeLength - dist;//edgeLength
      // const param = diff * this.u_stiffness / mass; //
      const param = diff * edgeStrength / mass; // 
      ax -= direx * param;
      ay -= direy * param;
    }
    return [ax, ay];
  }

  @main
  compute() {
    const i = globalInvocationID.x;
    const currentNode = this.u_Data[i];
    const movement = u_AveMovement[0];
    let ax = 0, ay = 0;

    if (i >= VERTEX_COUNT || movement.x < u_minMovement) {
      this.u_Data[i] = currentNode;
      return;
    }

    // \u6BCF\u4E2A\u8282\u70B9\u5C5E\u6027\u5360\u4E24\u4E2A\u6570\u7EC4\u4E2D\u5404\u4E00\u683C
    // [mass, degree, nodeStrength, fx]
    const nodeAttributes1 = this.u_NodeAttributeArray1[i];
    // [centerX, centerY, centerGravity, fy]
    const nodeAttributes2 = this.u_NodeAttributeArray2[i];

    // repulsive
    const repulsive = this.calcRepulsive(i, currentNode);
    ax += repulsive[0];
    ay += repulsive[1];

    // attractive
    const attractive = this.calcAttractive(i, currentNode, nodeAttributes1);
    ax += attractive[0];
    ay += attractive[1];

    // gravity
    const gravity = this.calcGravity(i, currentNode, nodeAttributes2);
    ax -= gravity[0];
    ay -= gravity[1];

    // speed
    const param = this.u_interval * this.u_damping;
    let vx = ax * param;
    let vy = ay * param;
    const vlength = sqrt(vx * vx + vy * vy) + 0.0001;
    if (vlength > this.u_maxSpeed) {
      const param2 = this.u_maxSpeed / vlength;
      vx = param2 * vx;
      vy = param2 * vy;
    }

    // move
    if (nodeAttributes1[3] != 0 && nodeAttributes2[3] != 0) {
      this.u_Data[i] = [
        nodeAttributes1[3],
        nodeAttributes2[3],
        currentNode[2],
        0
      ];
    } else {
      const distx = vx * this.u_interval;
      const disty = vy * this.u_interval;
      const distLength = sqrt(distx * distx + disty * disty);
      this.u_Data[i] = [
        currentNode[0] + distx,
        currentNode[1] + disty,
        currentNode[2],
        distLength
      ];
    }
    
    // the avarage move distance
    // need to share memory
    
  }
}
`,it.gForceBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {float distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\ngl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',it.aveMovementCode=`
const VERTEX_COUNT;
@numthreads(1, 1, 1)
class CalcAveMovement {
  @in
  u_Data: vec4[];
  @in
  u_iter: float;
  @in @out
  u_AveMovement: vec4[];
  @main
  compute() {
    let movement = 0;
    for (let j: int = 0; j < VERTEX_COUNT; j++) {
      const vertex = this.u_Data[j];
      movement += vertex[3];
    }
    movement = movement / float(VERTEX_COUNT);
    this.u_AveMovement[0] = [movement, 0, 0, 0];
  }
}
`,it.aveMovementBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}'},94414:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var Q=function(Z,L){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,C){P.__proto__=C}||function(P,C){for(var M in C)Object.prototype.hasOwnProperty.call(C,M)&&(P[M]=C[M])},Q(Z,L)};return function(Z,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");Q(Z,L);function P(){this.constructor=Z}Z.prototype=L===null?Object.create(L):(P.prototype=L.prototype,new P)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.GridLayout=void 0;var tt=$(49784),j=$(62329),W=function(Q){X(Z,Q);function Z(L){var P=Q.call(this)||this;return P.begin=[0,0],P.preventOverlap=!0,P.preventOverlapPadding=10,P.condense=!1,P.sortBy="degree",P.nodes=[],P.edges=[],P.width=300,P.height=300,P.row=0,P.col=0,P.cellWidth=0,P.cellHeight=0,P.cellUsed={},P.id2manPos={},P.onLayoutEnd=function(){},P.updateCfg(L),P}return Z.prototype.getDefaultCfg=function(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}},Z.prototype.execute=function(){var L=this,P=L.nodes,C=L.edges,M=L.begin,k=P.length;if(k===0)return L.onLayoutEnd&&L.onLayoutEnd(),{nodes:P,edges:C};if(k===1)return P[0].x=M[0],P[0].y=M[1],L.onLayoutEnd&&L.onLayoutEnd(),{nodes:P,edges:C};var B=L.sortBy,R=L.width,F=L.height,K=L.condense,O=L.preventOverlapPadding,_=L.preventOverlap,ft=L.nodeSpacing,mt=L.nodeSize,st=[];P.forEach(function(we){st.push(we)});var ut={};if(st.forEach(function(we,At){ut[we.id]=At}),(B==="degree"||!(0,tt.isString)(B)||st[0][B]===void 0)&&(B="degree",(0,tt.isNaN)(P[0].degree))){var dt=(0,tt.getDegree)(st.length,ut,C);st.forEach(function(we,At){we.degree=dt[At].all})}st.sort(function(we,At){return At[B]-we[B]}),!R&&typeof window!="undefined"&&(R=window.innerWidth),!F&&typeof window!="undefined"&&(F=window.innerHeight);var gt=L.rows,wt=L.cols!=null?L.cols:L.columns;if(L.cells=k,gt!=null&&wt!=null?(L.rows=gt,L.cols=wt):gt!=null&&wt==null?(L.rows=gt,L.cols=Math.ceil(L.cells/L.rows)):gt==null&&wt!=null?(L.cols=wt,L.rows=Math.ceil(L.cells/L.cols)):(L.splits=Math.sqrt(L.cells*L.height/L.width),L.rows=Math.round(L.splits),L.cols=Math.round(L.width/L.height*L.splits)),L.rows=Math.max(L.rows,1),L.cols=Math.max(L.cols,1),L.cols*L.rows>L.cells){var ot=L.small(),pt=L.large();(ot-1)*pt>=L.cells?L.small(ot-1):(pt-1)*ot>=L.cells&&L.large(pt-1)}else for(;L.cols*L.rows<L.cells;){var ot=L.small(),pt=L.large();(pt+1)*ot>=L.cells?L.large(pt+1):L.small(ot+1)}if(L.cellWidth=R/L.cols,L.cellHeight=F/L.rows,K&&(L.cellWidth=0,L.cellHeight=0),_||ft){var Nt=(0,tt.getFuncByUnknownType)(10,ft),Gt=(0,tt.getFuncByUnknownType)(30,mt,!1);st.forEach(function(we){(!we.x||!we.y)&&(we.x=0,we.y=0);var At=Gt(we)||30,Yt,be;(0,tt.isArray)(At)?(Yt=At[0],be=At[1]):(Yt=At,be=At);var nn=Nt!==void 0?Nt(we):O,Ee=Yt+nn,le=be+nn;L.cellWidth=Math.max(L.cellWidth,Ee),L.cellHeight=Math.max(L.cellHeight,le)})}L.cellUsed={},L.row=0,L.col=0,L.id2manPos={};for(var se=0;se<st.length;se++){var ie=st[se],Be=void 0;if(L.position&&(Be=L.position(ie)),Be&&(Be.row!==void 0||Be.col!==void 0)){var ke={row:Be.row,col:Be.col};if(ke.col===void 0)for(ke.col=0;L.used(ke.row,ke.col);)ke.col++;else if(ke.row===void 0)for(ke.row=0;L.used(ke.row,ke.col);)ke.row++;L.id2manPos[ie.id]=ke,L.use(ke.row,ke.col)}L.getPos(ie)}return L.onLayoutEnd&&L.onLayoutEnd(),{edges:C,nodes:st}},Z.prototype.small=function(L){var P=this,C,M=P.rows||5,k=P.cols||5;if(L==null)C=Math.min(M,k);else{var B=Math.min(M,k);B===P.rows?P.rows=L:P.cols=L}return C},Z.prototype.large=function(L){var P=this,C,M=P.rows||5,k=P.cols||5;if(L==null)C=Math.max(M,k);else{var B=Math.max(M,k);B===P.rows?P.rows=L:P.cols=L}return C},Z.prototype.used=function(L,P){var C=this;return C.cellUsed["c-".concat(L,"-").concat(P)]||!1},Z.prototype.use=function(L,P){var C=this;C.cellUsed["c-".concat(L,"-").concat(P)]=!0},Z.prototype.moveToNextCell=function(){var L=this,P=L.cols||5;L.col++,L.col>=P&&(L.col=0,L.row++)},Z.prototype.getPos=function(L){var P=this,C=P.begin,M=P.cellWidth,k=P.cellHeight,B,R,F=P.id2manPos[L.id];if(F)B=F.col*M+M/2+C[0],R=F.row*k+k/2+C[1];else{for(;P.used(P.row,P.col);)P.moveToNextCell();B=P.col*M+M/2+C[0],R=P.row*k+k/2+C[1],P.use(P.row,P.col),P.moveToNextCell()}L.x=B,L.y=R},Z.prototype.getType=function(){return"grid"},Z}(j.Base);it.GridLayout=W},2584:function(sr,it,$){"use strict";var X=this&&this.__createBinding||(Object.create?function(dt,gt,wt,ot){ot===void 0&&(ot=wt);var pt=Object.getOwnPropertyDescriptor(gt,wt);(!pt||("get"in pt?!gt.__esModule:pt.writable||pt.configurable))&&(pt={enumerable:!0,get:function(){return gt[wt]}}),Object.defineProperty(dt,ot,pt)}:function(dt,gt,wt,ot){ot===void 0&&(ot=wt),dt[ot]=gt[wt]}),tt=this&&this.__exportStar||function(dt,gt){for(var wt in dt)wt!=="default"&&!Object.prototype.hasOwnProperty.call(gt,wt)&&X(gt,dt,wt)};Object.defineProperty(it,"__esModule",{value:!0}),it.ERLayout=it.ForceAtlas2Layout=it.ComboCombinedLayout=it.ComboForceLayout=it.GForceGPULayout=it.FruchtermanGPULayout=it.FruchtermanLayout=it.MDSLayout=it.ConcentricLayout=it.RadialLayout=it.DagreCompoundLayout=it.DagreLayout=it.CircularLayout=it.ForceLayout=it.Force2Layout=it.GForceLayout=it.RandomLayout=it.GridLayout=it.Layouts=it.Layout=void 0;var j=$(94414);Object.defineProperty(it,"GridLayout",{enumerable:!0,get:function(){return j.GridLayout}});var W=$(39711);Object.defineProperty(it,"RandomLayout",{enumerable:!0,get:function(){return W.RandomLayout}});var Q=$(13653);Object.defineProperty(it,"GForceLayout",{enumerable:!0,get:function(){return Q.GForceLayout}});var Z=$(6740);Object.defineProperty(it,"Force2Layout",{enumerable:!0,get:function(){return Z.Force2Layout}});var L=$(85717);Object.defineProperty(it,"ForceLayout",{enumerable:!0,get:function(){return L.ForceLayout}});var P=$(64885);Object.defineProperty(it,"CircularLayout",{enumerable:!0,get:function(){return P.CircularLayout}});var C=$(20171);Object.defineProperty(it,"DagreLayout",{enumerable:!0,get:function(){return C.DagreLayout}});var M=$(77057);Object.defineProperty(it,"DagreCompoundLayout",{enumerable:!0,get:function(){return M.DagreCompoundLayout}});var k=$(47944);Object.defineProperty(it,"RadialLayout",{enumerable:!0,get:function(){return k.RadialLayout}});var B=$(43281);Object.defineProperty(it,"ConcentricLayout",{enumerable:!0,get:function(){return B.ConcentricLayout}});var R=$(52899);Object.defineProperty(it,"MDSLayout",{enumerable:!0,get:function(){return R.MDSLayout}});var F=$(80374);Object.defineProperty(it,"FruchtermanLayout",{enumerable:!0,get:function(){return F.FruchtermanLayout}});var K=$(87745);Object.defineProperty(it,"FruchtermanGPULayout",{enumerable:!0,get:function(){return K.FruchtermanGPULayout}});var O=$(85194);Object.defineProperty(it,"GForceGPULayout",{enumerable:!0,get:function(){return O.GForceGPULayout}});var _=$(66590);Object.defineProperty(it,"ComboForceLayout",{enumerable:!0,get:function(){return _.ComboForceLayout}});var ft=$(63861);Object.defineProperty(it,"ComboCombinedLayout",{enumerable:!0,get:function(){return ft.ComboCombinedLayout}});var mt=$(48564);Object.defineProperty(it,"ForceAtlas2Layout",{enumerable:!0,get:function(){return mt.ForceAtlas2Layout}});var st=$(90441);Object.defineProperty(it,"ERLayout",{enumerable:!0,get:function(){return st.ERLayout}});var ut=$(42875);Object.defineProperty(it,"Layout",{enumerable:!0,get:function(){return ut.Layout}}),Object.defineProperty(it,"Layouts",{enumerable:!0,get:function(){return ut.Layouts}}),tt($(32867),it)},42875:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.Layouts=it.Layout=void 0;var X=$(95326),tt=$(94414),j=$(39711),W=$(6740),Q=$(13653),Z=$(85717),L=$(64885),P=$(20171),C=$(47944),M=$(43281),k=$(52899),B=$(80374),R=$(87745),F=$(85194),K=$(66590),O=$(63861),_=$(48564),ft=$(90441),mt=$(77057),st=$(49784),ut=function(){function dt(gt){var wt=(0,X.getLayoutByName)(gt.type);this.layoutInstance=new wt(gt)}return dt.prototype.layout=function(gt){return this.layoutInstance.layout(gt)},dt.prototype.updateCfg=function(gt){this.layoutInstance.updateCfg(gt)},dt.prototype.init=function(gt){this.correctLayers(gt.nodes),this.layoutInstance.init(gt)},dt.prototype.correctLayers=function(gt){if(!!(gt==null?void 0:gt.length)){var wt=Infinity,ot=[];if(gt.forEach(function(Nt){(0,st.isString)(Nt.layer)&&(Nt.layer=parseInt(Nt.layer,10)),!(Nt.layer===void 0||isNaN(Nt.layer))&&(ot.push(Nt),Nt.layer<wt&&(wt=Nt.layer))}),wt<=0){var pt=Math.abs(wt)+1;ot.forEach(function(Nt){return Nt.layer+=pt})}}},dt.prototype.execute=function(){this.layoutInstance.execute()},dt.prototype.getDefaultCfg=function(){return this.layoutInstance.getDefaultCfg()},dt.prototype.destroy=function(){return this.layoutInstance.destroy()},dt}();it.Layout=ut,it.Layouts={force:Z.ForceLayout,fruchterman:B.FruchtermanLayout,forceAtlas2:_.ForceAtlas2Layout,gForce:Q.GForceLayout,force2:W.Force2Layout,dagre:P.DagreLayout,dagreCompound:mt.DagreCompoundLayout,circular:L.CircularLayout,radial:C.RadialLayout,concentric:M.ConcentricLayout,grid:tt.GridLayout,mds:k.MDSLayout,comboForce:K.ComboForceLayout,comboCombined:O.ComboCombinedLayout,random:j.RandomLayout,"gForce-gpu":F.GForceGPULayout,"fruchterman-gpu":R.FruchtermanGPULayout,er:ft.ERLayout}},52899:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var Z=function(L,P){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,M){C.__proto__=M}||function(C,M){for(var k in M)Object.prototype.hasOwnProperty.call(M,k)&&(C[k]=M[k])},Z(L,P)};return function(L,P){if(typeof P!="function"&&P!==null)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");Z(L,P);function C(){this.constructor=L}L.prototype=P===null?Object.create(P):(C.prototype=P.prototype,new C)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.MDSLayout=void 0;var tt=$(52710),j=$(49784),W=$(62329),Q=function(Z){X(L,Z);function L(P){var C=Z.call(this)||this;return C.center=[0,0],C.linkDistance=50,C.nodes=[],C.edges=[],C.onLayoutEnd=function(){},C.updateCfg(P),C}return L.prototype.getDefaultCfg=function(){return{center:[0,0],linkDistance:50}},L.prototype.execute=function(){var P=this,C=P.nodes,M=P.edges,k=M===void 0?[]:M,B=P.center;if(!C||C.length===0){P.onLayoutEnd&&P.onLayoutEnd();return}if(C.length===1){C[0].x=B[0],C[0].y=B[1],P.onLayoutEnd&&P.onLayoutEnd();return}var R=P.linkDistance,F=(0,j.getAdjMatrix)({nodes:C,edges:k},!1),K=(0,j.floydWarshall)(F);P.handleInfinity(K);var O=(0,j.scaleMatrix)(K,R);P.scaledDistances=O;var _=P.runMDS();return P.positions=_,_.forEach(function(ft,mt){C[mt].x=ft[0]+B[0],C[mt].y=ft[1]+B[1]}),P.onLayoutEnd&&P.onLayoutEnd(),{nodes:C,edges:k}},L.prototype.runMDS=function(){var P=this,C=2,M=P.scaledDistances,k=tt.Matrix.mul(tt.Matrix.pow(M,2),-.5),B=k.mean("row"),R=k.mean("column"),F=k.mean();k.add(F).subRowVector(B).subColumnVector(R);var K=new tt.SingularValueDecomposition(k),O=tt.Matrix.sqrt(K.diagonalMatrix).diagonal();return K.leftSingularVectors.toJSON().map(function(_){return tt.Matrix.mul([_],[O]).toJSON()[0].splice(0,C)})},L.prototype.handleInfinity=function(P){var C=-999999;P.forEach(function(M){M.forEach(function(k){k!==Infinity&&C<k&&(C=k)})}),P.forEach(function(M,k){M.forEach(function(B,R){B===Infinity&&(P[k][R]=C)})})},L.prototype.getType=function(){return"mds"},L}(W.Base);it.MDSLayout=Q},47944:function(sr,it,$){"use strict";var X=this&&this.__createBinding||(Object.create?function(j,W,Q,Z){Z===void 0&&(Z=Q);var L=Object.getOwnPropertyDescriptor(W,Q);(!L||("get"in L?!W.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return W[Q]}}),Object.defineProperty(j,Z,L)}:function(j,W,Q,Z){Z===void 0&&(Z=Q),j[Z]=W[Q]}),tt=this&&this.__exportStar||function(j,W){for(var Q in j)Q!=="default"&&!Object.prototype.hasOwnProperty.call(W,Q)&&X(W,j,Q)};Object.defineProperty(it,"__esModule",{value:!0}),tt($(55974),it)},66082:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var X=$(52710),tt=function(){function j(W){this.distances=W.distances,this.dimension=W.dimension||2,this.linkDistance=W.linkDistance}return j.prototype.layout=function(){var W=this,Q=W.dimension,Z=W.distances,L=W.linkDistance;try{var P=X.Matrix.mul(X.Matrix.pow(Z,2),-.5),C=P.mean("row"),M=P.mean("column"),k=P.mean();P.add(k).subRowVector(C).subColumnVector(M);var B=new X.SingularValueDecomposition(P),R=X.Matrix.sqrt(B.diagonalMatrix).diagonal();return B.leftSingularVectors.toJSON().map(function(ft){return X.Matrix.mul([ft],[R]).toJSON()[0].splice(0,Q)})}catch(ft){for(var F=[],K=0;K<Z.length;K++){var O=Math.random()*L,_=Math.random()*L;F.push([O,_])}return F}},j}();it.default=tt},55974:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var k=function(B,R){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,K){F.__proto__=K}||function(F,K){for(var O in K)Object.prototype.hasOwnProperty.call(K,O)&&(F[O]=K[O])},k(B,R)};return function(B,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");k(B,R);function F(){this.constructor=B}B.prototype=R===null?Object.create(R):(F.prototype=R.prototype,new F)}}(),tt=this&&this.__importDefault||function(k){return k&&k.__esModule?k:{default:k}};Object.defineProperty(it,"__esModule",{value:!0}),it.RadialLayout=void 0;var j=$(49784),W=$(62329),Q=tt($(66082)),Z=tt($(6290));function L(k){for(var B=k.length,R=k[0].length,F=[],K=0;K<B;K++){for(var O=[],_=0;_<R;_++)k[K][_]!==0?O.push(1/(k[K][_]*k[K][_])):O.push(0);F.push(O)}return F}function P(k,B){var R=-1;return k.forEach(function(F,K){F.id===B&&(R=K)}),R}function C(k,B){return Math.sqrt((k[0]-B[0])*(k[0]-B[0])+(k[1]-B[1])*(k[1]-B[1]))}var M=function(k){X(B,k);function B(R){var F=k.call(this)||this;return F.maxIteration=1e3,F.focusNode=null,F.unitRadius=null,F.linkDistance=50,F.preventOverlap=!1,F.strictRadial=!0,F.maxPreventOverlapIteration=200,F.sortStrength=10,F.nodes=[],F.edges=[],F.updateCfg(R),F}return B.prototype.getDefaultCfg=function(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}},B.prototype.execute=function(){var R=this,F=R.nodes,K=R.edges||[];if(!F||F.length===0){R.onLayoutEnd&&R.onLayoutEnd();return}!R.width&&typeof window!="undefined"&&(R.width=window.innerWidth),!R.height&&typeof window!="undefined"&&(R.height=window.innerHeight),R.center||(R.center=[R.width/2,R.height/2]);var O=R.center;if(F.length===1){F[0].x=O[0],F[0].y=O[1],R.onLayoutEnd&&R.onLayoutEnd();return}var _=R.linkDistance,ft=null;if((0,j.isString)(R.focusNode)){for(var mt=!1,st=0;st<F.length;st++)F[st].id===R.focusNode&&(ft=F[st],R.focusNode=ft,mt=!0,st=F.length);mt||(ft=null)}else ft=R.focusNode;ft||(ft=F[0],R.focusNode=ft);var ut=P(F,ft.id);ut<0&&(ut=0),R.focusIndex=ut;var dt=(0,j.getAdjMatrix)({nodes:F,edges:K},!1),gt=(0,j.floydWarshall)(dt),wt=R.maxToFocus(gt,ut);R.handleInfinity(gt,ut,wt+1),R.distances=gt;var ot=gt[ut],pt=R.width||500,Nt=R.height||500,Gt=pt-O[0]>O[0]?O[0]:pt-O[0],se=Nt-O[1]>O[1]?O[1]:Nt-O[1];Gt===0&&(Gt=pt/2),se===0&&(se=Nt/2);var ie=se>Gt?Gt:se,Be=Math.max.apply(Math,ot),ke=[];ot.forEach(function(pe,Ge){R.unitRadius||(R.unitRadius=ie/Be),ke[Ge]=pe*R.unitRadius}),R.radii=ke;var we=R.eIdealDisMatrix();R.eIdealDistances=we;var At=L(we);R.weights=At;var Yt=new Q.default({linkDistance:_,distances:we}),be=Yt.layout();be.forEach(function(pe){(0,j.isNaN)(pe[0])&&(pe[0]=Math.random()*_),(0,j.isNaN)(pe[1])&&(pe[1]=Math.random()*_)}),R.positions=be,be.forEach(function(pe,Ge){F[Ge].x=pe[0]+O[0],F[Ge].y=pe[1]+O[1]}),be.forEach(function(pe){pe[0]-=be[ut][0],pe[1]-=be[ut][1]}),R.run();var nn=R.preventOverlap,Ee=R.nodeSize,le,Le=R.strictRadial;if(nn){var Ze=R.nodeSpacing,fe;(0,j.isNumber)(Ze)?fe=function(){return Ze}:(0,j.isFunction)(Ze)?fe=Ze:fe=function(){return 0},Ee?(0,j.isArray)(Ee)?le=function(pe){var Ge=Ee[0]>Ee[1]?Ee[0]:Ee[1];return Ge+fe(pe)}:le=function(pe){return Ee+fe(pe)}:le=function(pe){if(pe.size){if((0,j.isArray)(pe.size)){var Ge=pe.size[0]>pe.size[1]?pe.size[0]:pe.size[1];return Ge+fe(pe)}if((0,j.isObject)(pe.size)){var Ge=pe.size.width>pe.size.height?pe.size.width:pe.size.height;return Ge+fe(pe)}return pe.size+fe(pe)}return 10+fe(pe)};var Re={nodes:F,nodeSizeFunc:le,adjMatrix:dt,positions:be,radii:ke,height:Nt,width:pt,strictRadial:Le,focusID:ut,iterations:R.maxPreventOverlapIteration||200,k:be.length/4.5},He=new Z.default(Re);be=He.layout()}return be.forEach(function(pe,Ge){F[Ge].x=pe[0]+O[0],F[Ge].y=pe[1]+O[1]}),R.onLayoutEnd&&R.onLayoutEnd(),{nodes:F,edges:K}},B.prototype.run=function(){for(var R=this,F=R.maxIteration,K=R.positions||[],O=R.weights||[],_=R.eIdealDistances||[],ft=R.radii||[],mt=0;mt<=F;mt++){var st=mt/F;R.oneIteration(st,K,ft,_,O)}},B.prototype.oneIteration=function(R,F,K,O,_){var ft=this,mt=1-R,st=ft.focusIndex;F.forEach(function(ut,dt){var gt=C(ut,[0,0]),wt=gt===0?0:1/gt;if(dt!==st){var ot=0,pt=0,Nt=0;F.forEach(function(se,ie){if(dt!==ie){var Be=C(ut,se),ke=Be===0?0:1/Be,we=O[ie][dt];Nt+=_[dt][ie],ot+=_[dt][ie]*(se[0]+we*(ut[0]-se[0])*ke),pt+=_[dt][ie]*(se[1]+we*(ut[1]-se[1])*ke)}});var Gt=K[dt]===0?0:1/K[dt];Nt*=mt,Nt+=R*Gt*Gt,ot*=mt,ot+=R*Gt*ut[0]*wt,ut[0]=ot/Nt,pt*=mt,pt+=R*Gt*ut[1]*wt,ut[1]=pt/Nt}})},B.prototype.eIdealDisMatrix=function(){var R=this,F=R.nodes;if(!F)return[];var K=R.distances,O=R.linkDistance,_=R.radii||[],ft=R.unitRadius||50,mt=[];return K&&K.forEach(function(st,ut){var dt=[];st.forEach(function(gt,wt){if(ut===wt)dt.push(0);else if(_[ut]===_[wt])if(R.sortBy==="data")dt.push(gt*(Math.abs(ut-wt)*R.sortStrength)/(_[ut]/ft));else if(R.sortBy){var ot=F[ut][R.sortBy]||0,pt=F[wt][R.sortBy]||0;(0,j.isString)(ot)&&(ot=ot.charCodeAt(0)),(0,j.isString)(pt)&&(pt=pt.charCodeAt(0)),dt.push(gt*(Math.abs(ot-pt)*R.sortStrength)/(_[ut]/ft))}else dt.push(gt*O/(_[ut]/ft));else{var Nt=(O+ft)/2;dt.push(gt*Nt)}}),mt.push(dt)}),mt},B.prototype.handleInfinity=function(R,F,K){for(var O=R.length,_=0;_<O;_++)if(R[F][_]===Infinity){R[F][_]=K,R[_][F]=K;for(var ft=0;ft<O;ft++)R[_][ft]!==Infinity&&R[F][ft]===Infinity&&(R[F][ft]=K+R[_][ft],R[ft][F]=K+R[_][ft])}for(var _=0;_<O;_++)if(_!==F){for(var ft=0;ft<O;ft++)if(R[_][ft]===Infinity){var mt=Math.abs(R[F][_]-R[F][ft]);mt=mt===0?1:mt,R[_][ft]=mt}}},B.prototype.maxToFocus=function(R,F){for(var K=0,O=0;O<R[F].length;O++)R[F][O]!==Infinity&&(K=R[F][O]>K?R[F][O]:K);return K},B.prototype.getType=function(){return"radial"},B}(W.Base);it.RadialLayout=M},6290:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0});var $=800,X=function(){function tt(j){this.disp=[],this.positions=j.positions,this.adjMatrix=j.adjMatrix,this.focusID=j.focusID,this.radii=j.radii,this.iterations=j.iterations||10,this.height=j.height||10,this.width=j.width||10,this.speed=j.speed||100,this.gravity=j.gravity||10,this.nodeSizeFunc=j.nodeSizeFunc,this.k=j.k||5,this.strictRadial=j.strictRadial,this.nodes=j.nodes}return tt.prototype.layout=function(){var j=this,W=j.positions,Q=[],Z=j.iterations,L=j.width/10;j.maxDisplace=L,j.disp=Q;for(var P=0;P<Z;P++)W.forEach(function(C,M){Q[M]={x:0,y:0}}),j.getRepulsion(),j.updatePositions();return W},tt.prototype.getRepulsion=function(){var j=this,W=j.positions,Q=j.nodes,Z=j.disp,L=j.k,P=j.radii||[];W.forEach(function(C,M){Z[M]={x:0,y:0},W.forEach(function(k,B){if(M!==B&&P[M]===P[B]){var R=C[0]-k[0],F=C[1]-k[1],K=Math.sqrt(R*R+F*F);if(K===0){K=1;var O=M>B?1:-1;R=.01*O,F=.01*O}if(K<j.nodeSizeFunc(Q[M])/2+j.nodeSizeFunc(Q[B])/2){var _=L*L/K;Z[M].x+=R/K*_,Z[M].y+=F/K*_}}})})},tt.prototype.updatePositions=function(){var j=this,W=j.positions,Q=j.disp,Z=j.speed,L=j.strictRadial,P=j.focusID,C=j.maxDisplace||j.width/10;L&&Q.forEach(function(k,B){var R=W[B][0]-W[P][0],F=W[B][1]-W[P][1],K=Math.sqrt(R*R+F*F),O=F/K,_=-R/K,ft=Math.sqrt(k.x*k.x+k.y*k.y),mt=Math.acos((O*k.x+_*k.y)/ft);mt>Math.PI/2&&(mt-=Math.PI/2,O*=-1,_*=-1);var st=Math.cos(mt)*ft;k.x=O*st,k.y=_*st});var M=j.radii;W.forEach(function(k,B){if(B!==P){var R=Math.sqrt(Q[B].x*Q[B].x+Q[B].y*Q[B].y);if(R>0&&B!==P){var F=Math.min(C*(Z/$),R);if(k[0]+=Q[B].x/R*F,k[1]+=Q[B].y/R*F,L){var K=k[0]-W[P][0],O=k[1]-W[P][1],_=Math.sqrt(K*K+O*O);K=K/_*M[B],O=O/_*M[B],k[0]=W[P][0]+K,k[1]=W[P][1]+O}}}})},tt}();it.default=X},39711:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var W=function(Q,Z){return W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,P){L.__proto__=P}||function(L,P){for(var C in P)Object.prototype.hasOwnProperty.call(P,C)&&(L[C]=P[C])},W(Q,Z)};return function(Q,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");W(Q,Z);function L(){this.constructor=Q}Q.prototype=Z===null?Object.create(Z):(L.prototype=Z.prototype,new L)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.RandomLayout=void 0;var tt=$(62329),j=function(W){X(Q,W);function Q(Z){var L=W.call(this)||this;return L.center=[0,0],L.width=300,L.height=300,L.nodes=[],L.edges=[],L.onLayoutEnd=function(){},L.updateCfg(Z),L}return Q.prototype.getDefaultCfg=function(){return{center:[0,0],width:300,height:300}},Q.prototype.execute=function(){var Z=this,L=Z.nodes,P=.9,C=Z.center;return!Z.width&&typeof window!="undefined"&&(Z.width=window.innerWidth),!Z.height&&typeof window!="undefined"&&(Z.height=window.innerHeight),L&&L.forEach(function(M){M.x=(Math.random()-.5)*P*Z.width+C[0],M.y=(Math.random()-.5)*P*Z.height+C[1]}),Z.onLayoutEnd&&Z.onLayoutEnd(),{nodes:L,edges:this.edges}},Q.prototype.getType=function(){return"random"},Q}(tt.Base);it.RandomLayout=j},32867:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0})},95326:function(sr,it,$){"use strict";var X=this&&this.__extends||function(){var P=function(C,M){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,B){k.__proto__=B}||function(k,B){for(var R in B)Object.prototype.hasOwnProperty.call(B,R)&&(k[R]=B[R])},P(C,M)};return function(C,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");P(C,M);function k(){this.constructor=C}C.prototype=M===null?Object.create(M):(k.prototype=M.prototype,new k)}}();Object.defineProperty(it,"__esModule",{value:!0}),it.getLayoutByName=it.unRegisterLayout=it.registerLayout=void 0;var tt=$(62329),j=$(49784),W=new Map,Q=function(P,C){if(W.get(P)&&console.warn("The layout with the name ".concat(P," exists already, it will be overridden")),(0,j.isObject)(C)){var M=function(k){X(B,k);function B(R){var F=this,K;F=k.call(this)||this;var O=F,_={},ft=Object.assign({},O.getDefaultCfg(),((K=C.getDefaultCfg)===null||K===void 0?void 0:K.call(C))||{});return Object.assign(_,ft,C,R),Object.keys(_).forEach(function(mt){var st=_[mt];O[mt]=st}),F}return B}(tt.Base);W.set(P,M)}else W.set(P,C);return W.get(P)};it.registerLayout=Q;var Z=function(P){W.has(P)&&W.delete(P)};it.unRegisterLayout=Z;var L=function(P){return W.has(P)?W.get(P):null};it.getLayoutByName=L},85087:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.isArray=void 0,it.isArray=Array.isArray},78732:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.getFuncByUnknownType=it.getFunc=it.isFunction=void 0;var X=$(49784),tt=$(30627),j=function(Z){return typeof Z=="function"};it.isFunction=j;var W=function(Z,L,P){var C;return P?C=P:(0,tt.isNumber)(Z)?C=function(){return Z}:C=function(){return L},C};it.getFunc=W;var Q=function(Z,L,P){return P===void 0&&(P=!0),!L&&L!==0?function(C){return C.size?(0,X.isArray)(C.size)?C.size[0]>C.size[1]?C.size[0]:C.size[1]:(0,X.isObject)(C.size)?C.size.width>C.size.height?C.size.width:C.size.height:C.size:Z}:(0,it.isFunction)(L)?L:(0,tt.isNumber)(L)?function(){return L}:(0,X.isArray)(L)?function(){if(P){var C=Math.max.apply(Math,L);return isNaN(C)?Z:C}return L}:(0,X.isObject)(L)?function(){if(P){var C=Math.max(L.width,L.height);return isNaN(C)?Z:C}return[L.width,L.height]}:function(){return Z}};it.getFuncByUnknownType=Q},48835:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.arrayToTextureData=it.attributesToTextureData=it.buildTextureDataWithTwoEdgeAttr=it.buildTextureData=it.proccessToFunc=void 0;var X=$(49784),tt=$(80628),j=function(P,C){var M;return P?(0,X.isNumber)(P)?M=function(){return P}:M=P:M=function(){return C||1},M};it.proccessToFunc=j;var W=function(P,C){var M=[],k=[],B={},R=0;for(R=0;R<P.length;R++){var F=P[R];B[F.id]=R,M.push(F.x),M.push(F.y),M.push(0),M.push(0),k.push([])}for(R=0;R<C.length;R++){var K=C[R],O=(0,tt.getEdgeTerminal)(K,"source"),_=(0,tt.getEdgeTerminal)(K,"target");!isNaN(B[O])&&!isNaN(B[_])&&(k[B[O]].push(B[_]),k[B[_]].push(B[O]))}var ft=0;for(R=0;R<P.length;R++){var mt=M.length,st=k[R],ut=st.length;M[R*4+2]=mt,M[R*4+3]=ut,ft=Math.max(ft,ut);for(var dt=0;dt<ut;++dt){var gt=st[dt];M.push(+gt)}}for(;M.length%4!=0;)M.push(0);return{maxEdgePerVetex:ft,array:new Float32Array(M)}};it.buildTextureData=W;var Q=function(P,C,M,k){var B=[],R=[],F={},K=0;for(K=0;K<P.length;K++){var O=P[K];F[O.id]=K,B.push(O.x),B.push(O.y),B.push(0),B.push(0),R.push([])}for(K=0;K<C.length;K++){var _=C[K],ft=(0,tt.getEdgeTerminal)(_,"source"),mt=(0,tt.getEdgeTerminal)(_,"target");R[F[ft]].push(F[mt]),R[F[ft]].push(M(_)),R[F[ft]].push(k(_)),R[F[ft]].push(0),R[F[mt]].push(F[ft]),R[F[mt]].push(M(_)),R[F[mt]].push(k(_)),R[F[mt]].push(0)}var st=0;for(K=0;K<P.length;K++){var ut=B.length,dt=R[K],gt=dt.length;B[K*4+2]=ut+1048576*gt/4,B[K*4+3]=0,st=Math.max(st,gt/4);for(var wt=0;wt<gt;++wt){var ot=dt[wt];B.push(+ot)}}for(;B.length%4!=0;)B.push(0);return{maxEdgePerVetex:st,array:new Float32Array(B)}};it.buildTextureDataWithTwoEdgeAttr=Q;var Z=function(P,C){var M=[],k=P.length,B={};return C.forEach(function(R){P.forEach(function(F,K){if(B[R[F]]===void 0&&(B[R[F]]=Object.keys(B).length),M.push(B[R[F]]),K===k-1)for(;M.length%4!=0;)M.push(0)})}),{array:new Float32Array(M),count:Object.keys(B).length}};it.attributesToTextureData=Z;var L=function(P){for(var C=[],M=P.length,k=P[0].length,B=function(F){P.forEach(function(K,O){if(C.push(K[F]),O===M-1)for(;C.length%4!=0;)C.push(0)})},R=0;R<k;R++)B(R);return new Float32Array(C)};it.arrayToTextureData=L},49784:function(sr,it,$){"use strict";var X=this&&this.__createBinding||(Object.create?function(j,W,Q,Z){Z===void 0&&(Z=Q);var L=Object.getOwnPropertyDescriptor(W,Q);(!L||("get"in L?!W.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return W[Q]}}),Object.defineProperty(j,Z,L)}:function(j,W,Q,Z){Z===void 0&&(Z=Q),j[Z]=W[Q]}),tt=this&&this.__exportStar||function(j,W){for(var Q in j)Q!=="default"&&!Object.prototype.hasOwnProperty.call(W,Q)&&X(W,j,Q)};Object.defineProperty(it,"__esModule",{value:!0}),tt($(8055),it),tt($(85087),it),tt($(30627),it),tt($(80628),it),tt($(98130),it),tt($(78732),it)},80628:function(sr,it,$){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.getCoreNodeAndRelativeLeafNodes=it.getAvgNodePosition=it.getLayoutBBox=it.traverseTreeUp=it.scaleMatrix=it.getAdjMatrix=it.floydWarshall=it.getDegreeMap=it.getDegree=it.getEdgeTerminal=void 0;var X=$(85087),tt=$(30627),j=$(98130),W=function(ft,mt){var st=ft[mt];return(0,j.isObject)(st)?st.cell:st};it.getEdgeTerminal=W;var Q=function(ft,mt,st){for(var ut=[],dt=0;dt<ft;dt++)ut[dt]={in:0,out:0,all:0};return st&&st.forEach(function(gt){var wt=(0,it.getEdgeTerminal)(gt,"source"),ot=(0,it.getEdgeTerminal)(gt,"target");wt&&ut[mt[wt]]&&(ut[mt[wt]].out+=1,ut[mt[wt]].all+=1),ot&&ut[mt[ot]]&&(ut[mt[ot]].in+=1,ut[mt[ot]].all+=1)}),ut};it.getDegree=Q;var Z=function(ft,mt){var st={};return ft.forEach(function(ut){st[ut.id]={in:0,out:0,all:0}}),mt&&mt.forEach(function(ut){var dt=(0,it.getEdgeTerminal)(ut,"source"),gt=(0,it.getEdgeTerminal)(ut,"target");dt&&(st[dt].out+=1,st[dt].all+=1),gt&&(st[gt].in+=1,st[gt].all+=1)}),st};it.getDegreeMap=Z;var L=function(ft){for(var mt=[],st=ft.length,ut=0;ut<st;ut+=1){mt[ut]=[];for(var dt=0;dt<st;dt+=1)ut===dt?mt[ut][dt]=0:ft[ut][dt]===0||!ft[ut][dt]?mt[ut][dt]=Infinity:mt[ut][dt]=ft[ut][dt]}for(var gt=0;gt<st;gt+=1)for(var ut=0;ut<st;ut+=1)for(var dt=0;dt<st;dt+=1)mt[ut][dt]>mt[ut][gt]+mt[gt][dt]&&(mt[ut][dt]=mt[ut][gt]+mt[gt][dt]);return mt};it.floydWarshall=L;var P=function(ft,mt){var st=ft.nodes,ut=ft.edges,dt=[],gt={};if(!st)throw new Error("invalid nodes data!");return st&&st.forEach(function(wt,ot){gt[wt.id]=ot;var pt=[];dt.push(pt)}),ut==null||ut.forEach(function(wt){var ot=(0,it.getEdgeTerminal)(wt,"source"),pt=(0,it.getEdgeTerminal)(wt,"target"),Nt=gt[ot],Gt=gt[pt];Nt===void 0||Gt===void 0||(dt[Nt][Gt]=1,mt||(dt[Gt][Nt]=1))}),dt};it.getAdjMatrix=P;var C=function(ft,mt){var st=[];return ft.forEach(function(ut){var dt=[];ut.forEach(function(gt){dt.push(gt*mt)}),st.push(dt)}),st};it.scaleMatrix=C;var M=function(ft,mt){if(ft&&ft.children){for(var st=ft.children.length-1;st>=0;st--)if(!M(ft.children[st],mt))return}return!!mt(ft)},k=function(ft,mt){typeof mt=="function"&&M(ft,mt)};it.traverseTreeUp=k;var B=function(ft){var mt=Infinity,st=Infinity,ut=-Infinity,dt=-Infinity;return ft.forEach(function(gt){var wt=gt.size;(0,X.isArray)(wt)?wt.length===1&&(wt=[wt[0],wt[0]]):(0,tt.isNumber)(wt)?wt=[wt,wt]:(wt===void 0||isNaN(wt))&&(wt=[30,30]);var ot=[wt[0]/2,wt[1]/2],pt=gt.x-ot[0],Nt=gt.x+ot[0],Gt=gt.y-ot[1],se=gt.y+ot[1];mt>pt&&(mt=pt),st>Gt&&(st=Gt),ut<Nt&&(ut=Nt),dt<se&&(dt=se)}),{minX:mt,minY:st,maxX:ut,maxY:dt}};it.getLayoutBBox=B;var R=function(ft){var mt={x:0,y:0};ft.forEach(function(ut){mt.x+=ut.x||0,mt.y+=ut.y||0});var st=ft.length||1;return{x:mt.x/st,y:mt.y/st}};it.getAvgNodePosition=R;var F=function(ft,mt,st){var ut,dt;return ft==="source"?((ut=st==null?void 0:st.find(function(gt){return gt.target===mt.id}))===null||ut===void 0?void 0:ut.source)||{}:((dt=st==null?void 0:st.find(function(gt){return gt.source===mt.id}))===null||dt===void 0?void 0:dt.target)||{}},K=function(ft,mt,st){var ut=[];switch(ft){case"source":ut=st==null?void 0:st.filter(function(gt){return gt.source===mt.id}).map(function(gt){return gt.target});break;case"target":ut=st==null?void 0:st.filter(function(gt){return gt.target===mt.id}).map(function(gt){return gt.source});break;case"both":ut=st==null?void 0:st.filter(function(gt){return gt.source===mt.id}).map(function(gt){return gt.target}).concat(st==null?void 0:st.filter(function(gt){return gt.target===mt.id}).map(function(gt){return gt.source}));break;default:break}var dt=new Set(ut);return Array.from(dt)},O=function(ft,mt,st,ut,dt){var gt=st[mt]||"",wt=(ut==null?void 0:ut.filter(function(ot){return ot[mt]===gt}))||[];return ft==="leaf"&&(wt=wt.filter(function(ot){var pt,Nt;return((pt=dt[ot.id])===null||pt===void 0?void 0:pt.in)===0||((Nt=dt[ot.id])===null||Nt===void 0?void 0:Nt.out)===0})),wt},_=function(ft,mt,st,ut,dt,gt){var wt=dt[mt.id],ot=wt.in,pt=wt.out,Nt=mt,Gt=[];ot===0?(Nt=F("source",mt,st),Gt=K("both",Nt,st).map(function(ie){return gt[ie]})):pt===0&&(Nt=F("target",mt,st),Gt=K("both",Nt,st).map(function(ie){return gt[ie]})),Gt=Gt.filter(function(ie){return dt[ie.id]&&(dt[ie.id].in===0||dt[ie.id].out===0)});var se=O(ft,ut,mt,Gt,dt);return{coreNode:Nt,relativeLeafNodes:Gt,sameTypeLeafNodes:se}};it.getCoreNodeAndRelativeLeafNodes=_},30627:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.toNumber=it.isNaN=it.isNumber=void 0;var $=function(j){return typeof j=="number"};it.isNumber=$;var X=function(j){return Number.isNaN(Number(j))};it.isNaN=X;var tt=function(j){var W=parseFloat(j);return(0,it.isNaN)(W)?j:W};it.toNumber=tt},98130:function(sr,it){"use strict";var $=this&&this.__assign||function(){return $=Object.assign||function(j){for(var W,Q=1,Z=arguments.length;Q<Z;Q++){W=arguments[Q];for(var L in W)Object.prototype.hasOwnProperty.call(W,L)&&(j[L]=W[L])}return j},$.apply(this,arguments)};Object.defineProperty(it,"__esModule",{value:!0}),it.clone=it.isObject=void 0;var X=function(j){return j!==null&&typeof j=="object"};it.isObject=X;var tt=function(j){if(j===null)return j;if(j instanceof Date)return new Date(j.getTime());if(j instanceof Array){var W=[];return j.forEach(function(Z){W.push(Z)}),W.map(function(Z){return(0,it.clone)(Z)})}if(typeof j=="object"&&Object.keys(j).length){var Q=$({},j);return Object.keys(Q).forEach(function(Z){Q[Z]=(0,it.clone)(Q[Z])}),Q}return j};it.clone=tt},8055:function(sr,it){"use strict";Object.defineProperty(it,"__esModule",{value:!0}),it.camelize=it.isString=void 0;var $=function(j){return typeof j=="string"};it.isString=$;var X=function(j){var W=Object.create(null);return function(Q){var Z=W[Q];return Z||(W[Q]=j(Q))}},tt=/-(\w)/g;it.camelize=X(function(j){return j.replace(tt,function(W,Q){return Q?Q.toUpperCase():""})})},45603:function(sr,it,$){"use strict";$.r(it),$.d(it,{Cache:function(){return Pi},angleTo:function(){return wt},arcToCubic:function(){return Ne},assign:function(){return wr},augment:function(){return Ar},clamp:function(){return ms},clearAnimationFrame:function(){return kn},clone:function(){return $a},clonePath:function(){return pt},contains:function(){return H},debounce:function(){return ba},deepMix:function(){return go},difference:function(){return jt},direction:function(){return gt},distanceSquareRoot:function(){return Rt},each:function(){return Qn},endsWith:function(){return Ys},equalizeSegments:function(){return an},every:function(){return Ku},extend:function(){return qu},filter:function(){return bt},find:function(){return Pa},findIndex:function(){return Oe},firstValue:function(){return Hn},fixedBase:function(){return dl},flatten:function(){return Jn},flattenDeep:function(){return ya},forIn:function(){return Zn},get:function(){return Wh},getDrawDirection:function(){return vr},getPathArea:function(){return Cr},getPathBBox:function(){return tr},getPathBBoxTotalLength:function(){return jr},getPointAtLength:function(){return Tr},getRange:function(){return oo},getRotatedCurve:function(){return Ea},getTotalLength:function(){return Gn},getType:function(){return js},getWrapBehavior:function(){return pa},gradient:function(){return M},group:function(){return bn},groupBy:function(){return eu},groupToMap:function(){return Zu},has:function(){return Kt},hasKey:function(){return ge},hasValue:function(){return xn},head:function(){return ls},identity:function(){return Gp},includes:function(){return H},indexOf:function(){return Uu},isArguments:function(){return ks},isArray:function(){return Ln},isArrayLike:function(){return kt},isBoolean:function(){return Mu},isDate:function(){return Cl},isDecimal:function(){return lu},isElement:function(){return rn},isEmpty:function(){return al},isEqual:function(){return ps},isEqualWith:function(){return ru},isError:function(){return sl},isEven:function(){return pl},isFinite:function(){return rl},isFunction:function(){return Ht},isInteger:function(){return _s},isMatch:function(){return ha},isNegative:function(){return Au},isNil:function(){return on},isNull:function(){return Dc},isNumber:function(){return Ks},isNumberEqual:function(){return nu},isObject:function(){return qr},isObjectLike:function(){return Ni},isOdd:function(){return xc},isPlainObject:function(){return si},isPointInPolygon:function(){return Gf},isPointInStroke:function(){return Zr},isPolygonsIntersect:function(){return oc},isPositive:function(){return ol},isPrototype:function(){return A},isRegExp:function(){return Zt},isString:function(){return ds},isType:function(){return qn},isUndefined:function(){return Pe},keys:function(){return ea},last:function(){return is},lowerCase:function(){return Aa},lowerFirst:function(){return Ba},map:function(){return Ec},mapValues:function(){return Uc},max:function(){return Fa},maxBy:function(){return ys},memoize:function(){return ki},min:function(){return ui},minBy:function(){return vl},mix:function(){return wr},mod:function(){return Dl},noop:function(){return eh},normalizePath:function(){return ee},number2color:function(){return xo},omit:function(){return kd},parseRadius:function(){return vo},path2Absolute:function(){return Me},path2Curve:function(){return cr},path2String:function(){return Gt},pick:function(){return sd},pull:function(){return Yi},pullAt:function(){return us},reduce:function(){return Io},remove:function(){return mu},requestAnimationFrame:function(){return wn},reverseCurve:function(){return Ur},rgb2arr:function(){return X},set:function(){return pp},size:function(){return Oc},some:function(){return Ro},sortBy:function(){return yu},startsWith:function(){return tl},substitute:function(){return ro},throttle:function(){return vp},toArray:function(){return $f},toCSSGradient:function(){return K},toDegree:function(){return ve},toInteger:function(){return Bt},toRGB:function(){return L},toRadian:function(){return En},toString:function(){return ir},transform:function(){return dt},union:function(){return qo},uniq:function(){return uu},uniqueId:function(){return Dd},upperCase:function(){return Si},upperFirst:function(){return To},values:function(){return sn},valuesOfKey:function(){return Wi},vertical:function(){return ot},wrapBehavior:function(){return Qi}});function X(Ot){return[parseInt(Ot.substr(1,2),16),parseInt(Ot.substr(3,2),16),parseInt(Ot.substr(5,2),16)]}function tt(Ot){var ne=Math.round(Ot).toString(16);return ne.length===1?"0"+ne:ne}function j(Ot){return"#"+tt(Ot[0])+tt(Ot[1])+tt(Ot[2])}var W=/rgba?\(([\s.,0-9]+)\)/;function Q(){var Ot=document.createElement("i");return Ot.title="Web Colour Picker",Ot.style.display="none",document.body.appendChild(Ot),Ot}var Z;function L(Ot){if(Ot[0]==="#"&&Ot.length===7)return Ot;Z||(Z=Q()),Z.style.color=Ot;var ne=document.defaultView.getComputedStyle(Z,"").getPropertyValue("color"),Se=W.exec(ne),Ke=Se[1].split(/\s*,\s*/).map(function(yn){return Number(yn)});return ne=j(Ke),ne}function P(Ot,ne,Se,Ke){return Ot[Ke]+(ne[Ke]-Ot[Ke])*Se}function C(Ot,ne){var Se=isNaN(Number(ne))||ne<0?0:ne>1?1:Number(ne),Ke=Ot.length-1,yn=Math.floor(Ke*Se),yr=Ke*Se-yn,Ir=Ot[yn],la=yn===Ke?Ir:Ot[yn+1];return j([P(Ir,la,yr,0),P(Ir,la,yr,1),P(Ir,la,yr,2)])}function M(Ot){var ne=typeof Ot=="string"?Ot.split("-"):Ot,Se=ne.map(function(Ke){return X(Ke.indexOf("#")===-1?L(Ke):Ke)});return function(Ke){return C(Se,Ke)}}var k=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,B=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,R=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function F(Ot){return/^[r,R,L,l]{1}[\s]*\(/.test(Ot)}function K(Ot){if(F(Ot)){var ne,Se=void 0;if(Ot[0]==="l"){var Ke=k.exec(Ot),yn=+Ke[1]+90;Se=Ke[2],ne="linear-gradient("+yn+"deg, "}else if(Ot[0]==="r"){ne="radial-gradient(";var Ke=B.exec(Ot);Se=Ke[4]}var yr=Se.match(R);return yr.forEach(function(Ir,la){var Dn=Ir.split(":");ne+=Dn[1]+" "+Number(Dn[0])*100+"%",la!==yr.length-1&&(ne+=", ")}),ne+=")",ne}return Ot}var O=$(35600),_=$(31437);function ft(Ot,ne,Se){var Ke=[0,0,0,0,0,0,0,0,0];return O.fromTranslation(Ke,Se),O.multiply(Ot,Ke,ne)}function mt(Ot,ne,Se){var Ke=[0,0,0,0,0,0,0,0,0];return O.fromRotation(Ke,Se),O.multiply(Ot,Ke,ne)}function st(Ot,ne,Se){var Ke=[0,0,0,0,0,0,0,0,0];return O.fromScaling(Ke,Se),O.multiply(Ot,Ke,ne)}function ut(Ot,ne,Se){return O.multiply(Ot,Se,ne)}function dt(Ot,ne){for(var Se=Ot?[].concat(Ot):[1,0,0,0,1,0,0,0,1],Ke=0,yn=ne.length;Ke<yn;Ke++){var yr=ne[Ke];switch(yr[0]){case"t":ft(Se,Se,[yr[1],yr[2]]);break;case"s":st(Se,Se,[yr[1],yr[2]]);break;case"r":mt(Se,Se,yr[1]);break;case"m":ut(Se,Se,yr[1]);break;default:break}}return Se}function gt(Ot,ne){return Ot[0]*ne[1]-ne[0]*Ot[1]}function wt(Ot,ne,Se){var Ke=_.angle(Ot,ne),yn=gt(Ot,ne)>=0;return Se?yn?Math.PI*2-Ke:Ke:yn?Ke:Math.PI*2-Ke}function ot(Ot,ne,Se){return Se?(Ot[0]=ne[1],Ot[1]=-1*ne[0]):(Ot[0]=-1*ne[1],Ot[1]=ne[0]),Ot}function pt(Ot){return Ot.map(function(ne){return Array.isArray(ne)?[].concat(ne):ne})}function Nt(Ot,ne){if(ne==="off")return pt(Ot);var Se=typeof ne=="number"&&ne>=1?Math.pow(10,ne):1;return Ot.map(function(Ke){var yn=Ke.slice(1).map(Number).map(function(yr){return ne?Math.round(yr*Se)/Se:Math.round(yr)});return[Ke[0]].concat(yn)})}function Gt(Ot,ne){return ne===void 0&&(ne="off"),Nt(Ot,ne).map(function(Se){return Se[0]+Se.slice(1).join(" ")}).join("")}var se=$(65353),ie={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Be(Ot,ne,Se){if(Ot[Se].length>7){Ot[Se].shift();for(var Ke=Ot[Se],yn=Se;Ke.length;)ne[Se]="A",Ot.splice(yn+=1,0,["C"].concat(Ke.splice(0,6)));Ot.splice(Se,1)}}var ke={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function we(Ot){return Array.isArray(Ot)&&Ot.every(function(ne){var Se=ne[0].toLowerCase();return ke[Se]===ne.length-1&&"achlmqstvz".includes(Se)})}function At(Ot){return we(Ot)&&Ot.every(function(ne){var Se=ne[0];return Se===Se.toUpperCase()})}function Yt(Ot){return At(Ot)&&Ot.every(function(ne){var Se=ne[0];return"ACLMQZ".includes(Se)})}function be(Ot){for(var ne=Ot.pathValue[Ot.segmentStart],Se=ne.toLowerCase(),Ke=Ot.data;Ke.length>=ke[Se]&&(Se==="m"&&Ke.length>2?(Ot.segments.push([ne].concat(Ke.splice(0,2))),Se="l",ne=ne==="m"?"l":"L"):Ot.segments.push([ne].concat(Ke.splice(0,ke[Se]))),!!ke[Se]););}function nn(Ot){var ne=Ot.index,Se=Ot.pathValue,Ke=Se.charCodeAt(ne);if(Ke===48){Ot.param=0,Ot.index+=1;return}if(Ke===49){Ot.param=1,Ot.index+=1;return}Ot.err='[path-util]: invalid Arc flag "'+Se[ne]+'", expecting 0 or 1 at index '+ne}function Ee(Ot){return Ot>=48&&Ot<=57||Ot===43||Ot===45||Ot===46}function le(Ot){return Ot>=48&&Ot<=57}function Le(Ot){var ne=Ot.max,Se=Ot.pathValue,Ke=Ot.index,yn=Ke,yr=!1,Ir=!1,la=!1,Dn=!1,Ga;if(yn>=ne){Ot.err="[path-util]: Invalid path value at index "+yn+', "pathValue" is missing param';return}if(Ga=Se.charCodeAt(yn),(Ga===43||Ga===45)&&(yn+=1,Ga=Se.charCodeAt(yn)),!le(Ga)&&Ga!==46){Ot.err="[path-util]: Invalid path value at index "+yn+', "'+Se[yn]+'" is not a number';return}if(Ga!==46){if(yr=Ga===48,yn+=1,Ga=Se.charCodeAt(yn),yr&&yn<ne&&Ga&&le(Ga)){Ot.err="[path-util]: Invalid path value at index "+Ke+', "'+Se[Ke]+'" illegal number';return}for(;yn<ne&&le(Se.charCodeAt(yn));)yn+=1,Ir=!0;Ga=Se.charCodeAt(yn)}if(Ga===46){for(Dn=!0,yn+=1;le(Se.charCodeAt(yn));)yn+=1,la=!0;Ga=Se.charCodeAt(yn)}if(Ga===101||Ga===69){if(Dn&&!Ir&&!la){Ot.err="[path-util]: Invalid path value at index "+yn+', "'+Se[yn]+'" invalid float exponent';return}if(yn+=1,Ga=Se.charCodeAt(yn),(Ga===43||Ga===45)&&(yn+=1),yn<ne&&le(Se.charCodeAt(yn)))for(;yn<ne&&le(Se.charCodeAt(yn));)yn+=1;else{Ot.err="[path-util]: Invalid path value at index "+yn+', "'+Se[yn]+'" invalid integer exponent';return}}Ot.index=yn,Ot.param=+Ot.pathValue.slice(Ke,yn)}function Ze(Ot){var ne=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return Ot===10||Ot===13||Ot===8232||Ot===8233||Ot===32||Ot===9||Ot===11||Ot===12||Ot===160||Ot>=5760&&ne.includes(Ot)}function fe(Ot){for(var ne=Ot.pathValue,Se=Ot.max;Ot.index<Se&&Ze(ne.charCodeAt(Ot.index));)Ot.index+=1}function Re(Ot){switch(Ot|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function He(Ot){return(Ot|32)==97}function pe(Ot){var ne=Ot.max,Se=Ot.pathValue,Ke=Ot.index,yn=Se.charCodeAt(Ke),yr=ke[Se[Ke].toLowerCase()];if(Ot.segmentStart=Ke,!Re(yn)){Ot.err='[path-util]: Invalid path value "'+Se[Ke]+'" is not a path command';return}if(Ot.index+=1,fe(Ot),Ot.data=[],!yr){be(Ot);return}for(;;){for(var Ir=yr;Ir>0;Ir-=1){if(He(yn)&&(Ir===3||Ir===4)?nn(Ot):Le(Ot),Ot.err.length)return;Ot.data.push(Ot.param),fe(Ot),Ot.index<ne&&Se.charCodeAt(Ot.index)===44&&(Ot.index+=1,fe(Ot))}if(Ot.index>=Ot.max||!Ee(Se.charCodeAt(Ot.index)))break}be(Ot)}var Ge=function(){function Ot(ne){this.pathValue=ne,this.segments=[],this.max=ne.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return Ot}();function te(Ot){if(we(Ot))return pt(Ot);var ne=new Ge(Ot);for(fe(ne);ne.index<ne.max&&!ne.err.length;)pe(ne);return ne.err?ne.err:ne.segments}function Me(Ot){if(At(Ot))return pt(Ot);var ne=te(Ot),Se=0,Ke=0,yn=0,yr=0;return ne.map(function(Ir){var la=Ir.slice(1).map(Number),Dn=Ir[0],Ga=Dn.toUpperCase();if(Dn==="M")return Se=la[0],Ke=la[1],yn=Se,yr=Ke,["M",Se,Ke];var xi;if(Dn!==Ga)switch(Ga){case"A":xi=[Ga,la[0],la[1],la[2],la[3],la[4],la[5]+Se,la[6]+Ke];break;case"V":xi=[Ga,la[0]+Ke];break;case"H":xi=[Ga,la[0]+Se];break;default:{var Ui=la.map(function(Mo,rs){return Mo+(rs%2?Ke:Se)});xi=[Ga].concat(Ui)}}else xi=[Ga].concat(la);var Ii=xi.length;switch(Ga){case"Z":Se=yn,Ke=yr;break;case"H":Se=xi[1];break;case"V":Ke=xi[1];break;default:Se=xi[Ii-2],Ke=xi[Ii-1],Ga==="M"&&(yn=Se,yr=Ke)}return xi})}function We(Ot,ne){var Se=Ot[0],Ke=ne.x1,yn=ne.y1,yr=ne.x2,Ir=ne.y2,la=Ot.slice(1).map(Number),Dn=Ot;if("TQ".includes(Se)||(ne.qx=null,ne.qy=null),Se==="H")Dn=["L",Ot[1],yn];else if(Se==="V")Dn=["L",Ke,Ot[1]];else if(Se==="S"){var Ga=Ke*2-yr,xi=yn*2-Ir;ne.x1=Ga,ne.y1=xi,Dn=["C",Ga,xi].concat(la)}else if(Se==="T"){var Ui=Ke*2-ne.qx,Ii=yn*2-ne.qy;ne.qx=Ui,ne.qy=Ii,Dn=["Q",Ui,Ii].concat(la)}else if(Se==="Q"){var Mo=la[0],rs=la[1];ne.qx=Mo,ne.qy=rs}return Dn}function ee(Ot){if(Yt(Ot))return pt(Ot);for(var ne=Me(Ot),Se=(0,se.__assign)({},ie),Ke=0;Ke<ne.length;Ke+=1){ne[Ke]=We(ne[Ke],Se);var yn=ne[Ke],yr=yn.length;Se.x1=+yn[yr-2],Se.y1=+yn[yr-1],Se.x2=+yn[yr-4]||Se.x1,Se.y2=+yn[yr-3]||Se.y1}return ne}function Pt(Ot){return Yt(Ot)&&Ot.every(function(ne){var Se=ne[0];return"MC".includes(Se)})}function yt(Ot,ne,Se){var Ke=Ot*Math.cos(Se)-ne*Math.sin(Se),yn=Ot*Math.sin(Se)+ne*Math.cos(Se);return{x:Ke,y:yn}}function Ne(Ot,ne,Se,Ke,yn,yr,Ir,la,Dn,Ga){var xi=Ot,Ui=ne,Ii=Se,Mo=Ke,rs=la,Xo=Dn,so=Math.PI*120/180,jo=Math.PI/180*(+yn||0),Ci=[],os,zo,Xi,Qo,Is;if(Ga)zo=Ga[0],Xi=Ga[1],Qo=Ga[2],Is=Ga[3];else{os=yt(xi,Ui,-jo),xi=os.x,Ui=os.y,os=yt(rs,Xo,-jo),rs=os.x,Xo=os.y;var $s=(xi-rs)/2,Ts=(Ui-Xo)/2,Ds=$s*$s/(Ii*Ii)+Ts*Ts/(Mo*Mo);Ds>1&&(Ds=Math.sqrt(Ds),Ii*=Ds,Mo*=Ds);var Gs=Ii*Ii,dr=Mo*Mo,Vi=(yr===Ir?-1:1)*Math.sqrt(Math.abs((Gs*dr-Gs*Ts*Ts-dr*$s*$s)/(Gs*Ts*Ts+dr*$s*$s)));Qo=Vi*Ii*Ts/Mo+(xi+rs)/2,Is=Vi*-Mo*$s/Ii+(Ui+Xo)/2,zo=Math.asin(((Ui-Is)/Mo*Math.pow(10,9)>>0)/Math.pow(10,9)),Xi=Math.asin(((Xo-Is)/Mo*Math.pow(10,9)>>0)/Math.pow(10,9)),zo=xi<Qo?Math.PI-zo:zo,Xi=rs<Qo?Math.PI-Xi:Xi,zo<0&&(zo=Math.PI*2+zo),Xi<0&&(Xi=Math.PI*2+Xi),Ir&&zo>Xi&&(zo-=Math.PI*2),!Ir&&Xi>zo&&(Xi-=Math.PI*2)}var af=Xi-zo;if(Math.abs(af)>so){var Tf=Xi,sc=rs,Af=Xo;Xi=zo+so*(Ir&&Xi>zo?1:-1),rs=Qo+Ii*Math.cos(Xi),Xo=Is+Mo*Math.sin(Xi),Ci=Ne(rs,Xo,Ii,Mo,yn,0,Ir,sc,Af,[Xi,Tf,Qo,Is])}af=Xi-zo;var Sc=Math.cos(zo),_l=Math.sin(zo),Rd=Math.cos(Xi),ud=Math.sin(Xi),pn=Math.tan(af/4),nh=4/3*Ii*pn,ld=4/3*Mo*pn,br=[xi,Ui],Vh=[xi+nh*_l,Ui-ld*Sc],Rc=[rs+nh*ud,Xo-ld*Rd],Lc=[rs,Xo];if(Vh[0]=2*br[0]-Vh[0],Vh[1]=2*br[1]-Vh[1],Ga)return Vh.concat(Rc,Lc,Ci);Ci=Vh.concat(Rc,Lc,Ci);for(var Vc=[],Pc=0,Ru=Ci.length;Pc<Ru;Pc+=1)Vc[Pc]=Pc%2?yt(Ci[Pc-1],Ci[Pc],jo).y:yt(Ci[Pc],Ci[Pc+1],jo).x;return Vc}function tn(Ot,ne,Se,Ke,yn,yr){var Ir=1/3,la=2/3;return[Ir*Ot+la*Se,Ir*ne+la*Ke,Ir*yn+la*Se,Ir*yr+la*Ke,yn,yr]}function fn(Ot,ne,Se){var Ke=Ot[0],yn=Ot[1],yr=ne[0],Ir=ne[1];return[Ke+(yr-Ke)*Se,yn+(Ir-yn)*Se]}function Rt(Ot,ne){return Math.sqrt((Ot[0]-ne[0])*(Ot[0]-ne[0])+(Ot[1]-ne[1])*(Ot[1]-ne[1]))}function Yn(Ot,ne,Se,Ke,yn){var yr=Rt([Ot,ne],[Se,Ke]),Ir={x:0,y:0};if(typeof yn=="number")if(yn<=0)Ir={x:Ot,y:ne};else if(yn>=yr)Ir={x:Se,y:Ke};else{var la=fn([Ot,ne],[Se,Ke],yn/yr),Dn=la[0],Ga=la[1];Ir={x:Dn,y:Ga}}return{length:yr,point:Ir,min:{x:Math.min(Ot,Se),y:Math.min(ne,Ke)},max:{x:Math.max(Ot,Se),y:Math.max(ne,Ke)}}}function Un(Ot,ne,Se,Ke){var yn=.5,yr=[Ot,ne],Ir=[Se,Ke],la=fn(yr,Ir,yn),Dn=fn(Ir,la,yn),Ga=fn(la,Dn,yn),xi=fn(Dn,Ga,yn),Ui=fn(Ga,xi,yn),Ii=Yn(yr[0],yr[1],la[0],la[1],Ga[0]).point,Mo=Yn(Ui[0],Ui[1],xi[0],xi[1],Dn[0]).point;return[Ii.x,Ii.y,Mo.x,Mo.y,Se,Ke]}function xr(Ot,ne){var Se=Ot[0],Ke=Ot.slice(1).map(Number),yn=Ke[0],yr=Ke[1],Ir,la=ne.x1,Dn=ne.y1,Ga=ne.x,xi=ne.y;switch("TQ".includes(Se)||(ne.qx=null,ne.qy=null),Se){case"M":return ne.x=yn,ne.y=yr,Ot;case"A":return Ir=[la,Dn].concat(Ke),["C"].concat(Ne(Ir[0],Ir[1],Ir[2],Ir[3],Ir[4],Ir[5],Ir[6],Ir[7],Ir[8],Ir[9]));case"Q":return ne.qx=yn,ne.qy=yr,Ir=[la,Dn].concat(Ke),["C"].concat(tn(Ir[0],Ir[1],Ir[2],Ir[3],Ir[4],Ir[5]));case"L":return["C"].concat(Un(la,Dn,yn,yr));case"Z":return la===Ga&&Dn===xi?["C",la,Dn,Ga,xi,Ga,xi]:["C"].concat(Un(la,Dn,Ga,xi));default:}return Ot}function cr(Ot,ne){if(ne===void 0&&(ne=!1),Pt(Ot)){var Se=pt(Ot);return ne?[Se,[]]:Se}for(var Ke=ee(Ot),yn=(0,se.__assign)({},ie),yr=[],Ir="",la=Ke.length,Dn,Ga,xi=[],Ui=0;Ui<la;Ui+=1){Ke[Ui]&&(Ir=Ke[Ui][0]),yr[Ui]=Ir;var Ii=xr(Ke[Ui],yn);Ke[Ui]=Ii,Be(Ke,yr,Ui),la=Ke.length,Ir==="Z"&&xi.push(Ui),Dn=Ke[Ui],Ga=Dn.length,yn.x1=+Dn[Ga-2],yn.y1=+Dn[Ga-1],yn.x2=+Dn[Ga-4]||yn.x1,yn.y2=+Dn[Ga-3]||yn.y1}return ne?[Ke,xi]:Ke}function Ur(Ot){var ne=Ot.slice(1).map(function(Se,Ke,yn){return Ke?yn[Ke-1].slice(-2).concat(Se.slice(1)):Ot[0].slice(1).concat(Se.slice(1))}).map(function(Se){return Se.map(function(Ke,yn){return Se[Se.length-yn-2*(1-yn%2)]})}).reverse();return[["M"].concat(ne[0].slice(0,2))].concat(ne.map(function(Se){return["C"].concat(Se.slice(2))}))}function fa(Ot,ne){var Se=Ot.x,Ke=Ot.y,yn=ne.x,yr=ne.y,Ir=Se*yn+Ke*yr,la=Math.sqrt((Math.pow(Se,2)+Math.pow(Ke,2))*(Math.pow(yn,2)+Math.pow(yr,2))),Dn=Se*yr-Ke*yn<0?-1:1,Ga=Dn*Math.acos(Ir/la);return Ga}function Sa(Ot,ne,Se,Ke,yn,yr,Ir,la,Dn,Ga){var xi=Math.abs,Ui=Math.sin,Ii=Math.cos,Mo=Math.sqrt,rs=Math.PI,Xo=xi(Se),so=xi(Ke),jo=(yn%360+360)%360,Ci=jo*(rs/180);if(Ot===la&&ne===Dn)return{x:Ot,y:ne};if(Xo===0||so===0)return Yn(Ot,ne,la,Dn,Ga).point;var os=(Ot-la)/2,zo=(ne-Dn)/2,Xi={x:Ii(Ci)*os+Ui(Ci)*zo,y:-Ui(Ci)*os+Ii(Ci)*zo},Qo=Math.pow(Xi.x,2)/Math.pow(Xo,2)+Math.pow(Xi.y,2)/Math.pow(so,2);Qo>1&&(Xo*=Mo(Qo),so*=Mo(Qo));var Is=Math.pow(Xo,2)*Math.pow(so,2)-Math.pow(Xo,2)*Math.pow(Xi.y,2)-Math.pow(so,2)*Math.pow(Xi.x,2),$s=Math.pow(Xo,2)*Math.pow(Xi.y,2)+Math.pow(so,2)*Math.pow(Xi.x,2),Ts=Is/$s;Ts=Ts<0?0:Ts;var Ds=(yr!==Ir?1:-1)*Mo(Ts),Gs={x:Ds*(Xo*Xi.y/so),y:Ds*(-(so*Xi.x)/Xo)},dr={x:Ii(Ci)*Gs.x-Ui(Ci)*Gs.y+(Ot+la)/2,y:Ui(Ci)*Gs.x+Ii(Ci)*Gs.y+(ne+Dn)/2},Vi={x:(Xi.x-Gs.x)/Xo,y:(Xi.y-Gs.y)/so},af=fa({x:1,y:0},Vi),Tf={x:(-Xi.x-Gs.x)/Xo,y:(-Xi.y-Gs.y)/so},sc=fa(Vi,Tf);!Ir&&sc>0?sc-=2*rs:Ir&&sc<0&&(sc+=2*rs),sc%=2*rs;var Af=af+sc*Ga,Sc=Xo*Ii(Af),_l=so*Ui(Af),Rd={x:Ii(Ci)*Sc-Ui(Ci)*_l+dr.x,y:Ui(Ci)*Sc+Ii(Ci)*_l+dr.y};return Rd}function sa(Ot,ne,Se,Ke,yn,yr,Ir,la,Dn,Ga,xi){var Ui,Ii=xi.bbox,Mo=Ii===void 0?!0:Ii,rs=xi.length,Xo=rs===void 0?!0:rs,so=xi.sampleSize,jo=so===void 0?30:so,Ci=typeof Ga=="number",os=Ot,zo=ne,Xi=0,Qo=[os,zo,Xi],Is=[os,zo],$s=0,Ts={x:0,y:0},Ds=[{x:os,y:zo}];Ci&&Ga<=0&&(Ts={x:os,y:zo});for(var Gs=0;Gs<=jo;Gs+=1){if($s=Gs/jo,Ui=Sa(Ot,ne,Se,Ke,yn,yr,Ir,la,Dn,$s),os=Ui.x,zo=Ui.y,Mo&&Ds.push({x:os,y:zo}),Xo&&(Xi+=Rt(Is,[os,zo])),Is=[os,zo],Ci&&Xi>=Ga&&Ga>Qo[2]){var dr=(Xi-Ga)/(Xi-Qo[2]);Ts={x:Is[0]*(1-dr)+Qo[0]*dr,y:Is[1]*(1-dr)+Qo[1]*dr}}Qo=[os,zo,Xi]}return Ci&&Ga>=Xi&&(Ts={x:la,y:Dn}),{length:Xi,point:Ts,min:{x:Math.min.apply(null,Ds.map(function(Vi){return Vi.x})),y:Math.min.apply(null,Ds.map(function(Vi){return Vi.y}))},max:{x:Math.max.apply(null,Ds.map(function(Vi){return Vi.x})),y:Math.max.apply(null,Ds.map(function(Vi){return Vi.y}))}}}function Da(Ot,ne,Se,Ke,yn,yr,Ir,la,Dn){var Ga=1-Dn;return{x:Math.pow(Ga,3)*Ot+3*Math.pow(Ga,2)*Dn*Se+3*Ga*Math.pow(Dn,2)*yn+Math.pow(Dn,3)*Ir,y:Math.pow(Ga,3)*ne+3*Math.pow(Ga,2)*Dn*Ke+3*Ga*Math.pow(Dn,2)*yr+Math.pow(Dn,3)*la}}function Rr(Ot,ne,Se,Ke,yn,yr,Ir,la,Dn,Ga){var xi,Ui=Ga.bbox,Ii=Ui===void 0?!0:Ui,Mo=Ga.length,rs=Mo===void 0?!0:Mo,Xo=Ga.sampleSize,so=Xo===void 0?10:Xo,jo=typeof Dn=="number",Ci=Ot,os=ne,zo=0,Xi=[Ci,os,zo],Qo=[Ci,os],Is=0,$s={x:0,y:0},Ts=[{x:Ci,y:os}];jo&&Dn<=0&&($s={x:Ci,y:os});for(var Ds=0;Ds<=so;Ds+=1){if(Is=Ds/so,xi=Da(Ot,ne,Se,Ke,yn,yr,Ir,la,Is),Ci=xi.x,os=xi.y,Ii&&Ts.push({x:Ci,y:os}),rs&&(zo+=Rt(Qo,[Ci,os])),Qo=[Ci,os],jo&&zo>=Dn&&Dn>Xi[2]){var Gs=(zo-Dn)/(zo-Xi[2]);$s={x:Qo[0]*(1-Gs)+Xi[0]*Gs,y:Qo[1]*(1-Gs)+Xi[1]*Gs}}Xi=[Ci,os,zo]}return jo&&Dn>=zo&&($s={x:Ir,y:la}),{length:zo,point:$s,min:{x:Math.min.apply(null,Ts.map(function(dr){return dr.x})),y:Math.min.apply(null,Ts.map(function(dr){return dr.y}))},max:{x:Math.max.apply(null,Ts.map(function(dr){return dr.x})),y:Math.max.apply(null,Ts.map(function(dr){return dr.y}))}}}function Mn(Ot,ne,Se,Ke,yn,yr,Ir){var la=1-Ir;return{x:Math.pow(la,2)*Ot+2*la*Ir*Se+Math.pow(Ir,2)*yn,y:Math.pow(la,2)*ne+2*la*Ir*Ke+Math.pow(Ir,2)*yr}}function ar(Ot,ne,Se,Ke,yn,yr,Ir,la){var Dn,Ga=la.bbox,xi=Ga===void 0?!0:Ga,Ui=la.length,Ii=Ui===void 0?!0:Ui,Mo=la.sampleSize,rs=Mo===void 0?10:Mo,Xo=typeof Ir=="number",so=Ot,jo=ne,Ci=0,os=[so,jo,Ci],zo=[so,jo],Xi=0,Qo={x:0,y:0},Is=[{x:so,y:jo}];Xo&&Ir<=0&&(Qo={x:so,y:jo});for(var $s=0;$s<=rs;$s+=1){if(Xi=$s/rs,Dn=Mn(Ot,ne,Se,Ke,yn,yr,Xi),so=Dn.x,jo=Dn.y,xi&&Is.push({x:so,y:jo}),Ii&&(Ci+=Rt(zo,[so,jo])),zo=[so,jo],Xo&&Ci>=Ir&&Ir>os[2]){var Ts=(Ci-Ir)/(Ci-os[2]);Qo={x:zo[0]*(1-Ts)+os[0]*Ts,y:zo[1]*(1-Ts)+os[1]*Ts}}os=[so,jo,Ci]}return Xo&&Ir>=Ci&&(Qo={x:yn,y:yr}),{length:Ci,point:Qo,min:{x:Math.min.apply(null,Is.map(function(Ds){return Ds.x})),y:Math.min.apply(null,Is.map(function(Ds){return Ds.y}))},max:{x:Math.max.apply(null,Is.map(function(Ds){return Ds.x})),y:Math.max.apply(null,Is.map(function(Ds){return Ds.y}))}}}function Fn(Ot,ne,Se){for(var Ke,yn,yr,Ir,la,Dn,Ga=ee(Ot),xi=typeof ne=="number",Ui,Ii=[],Mo,rs=0,Xo=0,so=0,jo=0,Ci,os=[],zo=[],Xi=0,Qo={x:0,y:0},Is=Qo,$s=Qo,Ts=Qo,Ds=0,Gs=0,dr=Ga.length;Gs<dr;Gs+=1)Ci=Ga[Gs],Mo=Ci[0],Ui=Mo==="M",Ii=Ui?Ii:[rs,Xo].concat(Ci.slice(1)),Ui?(so=Ci[1],jo=Ci[2],Qo={x:so,y:jo},Is=Qo,Xi=0,xi&&ne<.001&&(Ts=Qo)):Mo==="L"?(Ke=Yn(Ii[0],Ii[1],Ii[2],Ii[3],(ne||0)-Ds),Xi=Ke.length,Qo=Ke.min,Is=Ke.max,$s=Ke.point):Mo==="A"?(yn=sa(Ii[0],Ii[1],Ii[2],Ii[3],Ii[4],Ii[5],Ii[6],Ii[7],Ii[8],(ne||0)-Ds,Se||{}),Xi=yn.length,Qo=yn.min,Is=yn.max,$s=yn.point):Mo==="C"?(yr=Rr(Ii[0],Ii[1],Ii[2],Ii[3],Ii[4],Ii[5],Ii[6],Ii[7],(ne||0)-Ds,Se||{}),Xi=yr.length,Qo=yr.min,Is=yr.max,$s=yr.point):Mo==="Q"?(Ir=ar(Ii[0],Ii[1],Ii[2],Ii[3],Ii[4],Ii[5],(ne||0)-Ds,Se||{}),Xi=Ir.length,Qo=Ir.min,Is=Ir.max,$s=Ir.point):Mo==="Z"&&(Ii=[rs,Xo,so,jo],la=Yn(Ii[0],Ii[1],Ii[2],Ii[3],(ne||0)-Ds),Xi=la.length,Qo=la.min,Is=la.max,$s=la.point),xi&&Ds<ne&&Ds+Xi>=ne&&(Ts=$s),zo.push(Is),os.push(Qo),Ds+=Xi,Dn=Mo!=="Z"?Ci.slice(-2):[so,jo],rs=Dn[0],Xo=Dn[1];return xi&&ne>=Ds&&(Ts={x:rs,y:Xo}),{length:Ds,point:Ts,min:{x:Math.min.apply(null,os.map(function(Vi){return Vi.x})),y:Math.min.apply(null,os.map(function(Vi){return Vi.y}))},max:{x:Math.max.apply(null,zo.map(function(Vi){return Vi.x})),y:Math.max.apply(null,zo.map(function(Vi){return Vi.y}))}}}function tr(Ot,ne){if(!Ot)return{x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};var Se=Fn(Ot,void 0,(0,se.__assign)((0,se.__assign)({},ne),{length:!1})),Ke=Se.min,yn=Ke.x,yr=Ke.y,Ir=Se.max,la=Ir.x,Dn=Ir.y,Ga=la-yn,xi=Dn-yr;return{width:Ga,height:xi,x:yn,y:yr,x2:la,y2:Dn,cx:yn+Ga/2,cy:yr+xi/2,cz:Math.max(Ga,xi)+Math.min(Ga,xi)/2}}function Gn(Ot,ne){return Fn(Ot,void 0,(0,se.__assign)((0,se.__assign)({},ne),{bbox:!1,length:!0})).length}function jr(Ot,ne){if(!Ot)return{length:0,x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};var Se=Fn(Ot,void 0,(0,se.__assign)((0,se.__assign)({},ne),{bbox:!0,length:!0})),Ke=Se.length,yn=Se.min,yr=yn.x,Ir=yn.y,la=Se.max,Dn=la.x,Ga=la.y,xi=Dn-yr,Ui=Ga-Ir;return{length:Ke,width:xi,height:Ui,x:yr,y:Ir,x2:Dn,y2:Ga,cx:yr+xi/2,cy:Ir+Ui/2,cz:Math.max(xi,Ui)+Math.min(xi,Ui)/2}}function Hr(Ot){var ne=Ot.length,Se=ne-1;return Ot.map(function(Ke,yn){return Ot.map(function(yr,Ir){var la=yn+Ir,Dn;return Ir===0||Ot[la]&&Ot[la][0]==="M"?(Dn=Ot[la],["M"].concat(Dn.slice(-2))):(la>=ne&&(la-=Se),Ot[la])})})}function Ea(Ot,ne){var Se=Ot.length-1,Ke=[],yn=0,yr=0,Ir=Hr(Ot);return Ir.forEach(function(la,Dn){Ot.slice(1).forEach(function(Ga,xi){yr+=Rt(Ot[(Dn+xi)%Se].slice(-2),ne[xi%Se].slice(-2))}),Ke[Dn]=yr,yr=0}),yn=Ke.indexOf(Math.min.apply(null,Ke)),Ir[yn]}function lr(Ot,ne,Se,Ke,yn,yr,Ir,la){return 3*((la-ne)*(Se+yn)-(Ir-Ot)*(Ke+yr)+Ke*(Ot-yn)-Se*(ne-yr)+la*(yn+Ot/3)-Ir*(yr+ne/3))/20}function Cr(Ot){var ne=0,Se=0,Ke=0;return cr(Ot).map(function(yn){var yr;switch(yn[0]){case"M":return ne=yn[1],Se=yn[2],0;default:var Ir=yn.slice(1),la=Ir[0],Dn=Ir[1],Ga=Ir[2],xi=Ir[3],Ui=Ir[4],Ii=Ir[5];return Ke=lr(ne,Se,la,Dn,Ga,xi,Ui,Ii),yr=yn.slice(-2),ne=yr[0],Se=yr[1],Ke}}).reduce(function(yn,yr){return yn+yr},0)}function vr(Ot){return Cr(Ot)>=0}function Tr(Ot,ne,Se){return Fn(Ot,ne,(0,se.__assign)((0,se.__assign)({},Se),{bbox:!1,length:!0})).point}function ta(Ot,ne){var Se=te(Ot);if(typeof Se=="string")throw TypeError(Se);var Ke=Se.slice(),yn=Gn(Ke),yr=Ke.length-1,Ir=0,la=0,Dn=Se[0],Ga=Dn.slice(-2),xi=Ga[0],Ui=Ga[1],Ii={x:xi,y:Ui};if(yr<=0||!ne||!Number.isFinite(ne))return{segment:Dn,index:0,length:la,point:Ii,lengthAtSegment:Ir};if(ne>=yn)return Ke=Se.slice(0,-1),Ir=Gn(Ke),la=yn-Ir,{segment:Se[yr],index:yr,length:la,lengthAtSegment:Ir};for(var Mo=[];yr>0;)Dn=Ke[yr],Ke=Ke.slice(0,-1),Ir=Gn(Ke),la=yn-Ir,yn=Ir,Mo.push({segment:Dn,index:yr,length:la,lengthAtSegment:Ir}),yr-=1;return Mo.find(function(rs){var Xo=rs.lengthAtSegment;return Xo<=ne})}function ra(Ot,ne){for(var Se=te(Ot),Ke=ee(Se),yn=Gn(Se),yr=function(Xi){var Qo=Xi.x-ne.x,Is=Xi.y-ne.y;return Qo*Qo+Is*Is},Ir=8,la,Dn=0,Ga,xi=0,Ui=Infinity,Ii=0;Ii<=yn;Ii+=Ir)la=Tr(Ke,Ii),Dn=yr(la),Dn<Ui&&(Ga=la,xi=Ii,Ui=Dn);Ir/=2;for(var Mo,rs,Xo=0,so=0,jo=0,Ci=0;Ir>.5;)Xo=xi-Ir,Mo=Tr(Ke,Xo),jo=yr(Mo),so=xi+Ir,rs=Tr(Ke,so),Ci=yr(rs),Xo>=0&&jo<Ui?(Ga=Mo,xi=Xo,Ui=jo):so<=yn&&Ci<Ui?(Ga=rs,xi=so,Ui=Ci):Ir/=2;var os=ta(Se,xi),zo=Math.sqrt(Ui);return{closest:Ga,distance:zo,segment:os}}function Zr(Ot,ne){var Se=ra(Ot,ne).distance;return Math.abs(Se)<.001}function vt(Ot,ne){ne===void 0&&(ne=.5);var Se=Ot.slice(0,2),Ke=Ot.slice(2,4),yn=Ot.slice(4,6),yr=Ot.slice(6,8),Ir=fn(Se,Ke,ne),la=fn(Ke,yn,ne),Dn=fn(yn,yr,ne),Ga=fn(Ir,la,ne),xi=fn(la,Dn,ne),Ui=fn(Ga,xi,ne);return[["C"].concat(Ir,Ga,Ui),["C"].concat(xi,Dn,yr)]}function _n(Ot){return Ot.map(function(ne,Se,Ke){var yn=Se&&Ke[Se-1].slice(-2).concat(ne.slice(1)),yr=Se?Rr(yn[0],yn[1],yn[2],yn[3],yn[4],yn[5],yn[6],yn[7],yn[8],{bbox:!1}).length:0,Ir;return Se?Ir=yr?vt(yn):[ne,ne]:Ir=[ne],{s:ne,ss:Ir,l:yr}})}function an(Ot,ne,Se){var Ke=_n(Ot),yn=_n(ne),yr=Ke.length,Ir=yn.length,la=Ke.filter(function(so){return so.l}).length,Dn=yn.filter(function(so){return so.l}).length,Ga=Ke.filter(function(so){return so.l}).reduce(function(so,jo){var Ci=jo.l;return so+Ci},0)/la||0,xi=yn.filter(function(so){return so.l}).reduce(function(so,jo){var Ci=jo.l;return so+Ci},0)/Dn||0,Ui=Se||Math.max(yr,Ir),Ii=[Ga,xi],Mo=[Ui-yr,Ui-Ir],rs=0,Xo=[Ke,yn].map(function(so,jo){return so.l===Ui?so.map(function(Ci){return Ci.s}):so.map(function(Ci,os){return rs=os&&Mo[jo]&&Ci.l>=Ii[jo],Mo[jo]-=rs?1:0,rs?Ci.ss:[Ci.s]}).flat()});return Xo[0].length===Xo[1].length?Xo:an(Xo[0],Xo[1],Ui)}var Lt=function(Ot){return Ot!==null&&typeof Ot!="function"&&isFinite(Ot.length)},kt=Lt,at=function(Ot,ne){return kt(Ot)?Ot.indexOf(ne)>-1:!1},H=at,Y=function(Ot,ne){if(!kt(Ot))return Ot;for(var Se=[],Ke=0;Ke<Ot.length;Ke++){var yn=Ot[Ke];ne(yn,Ke)&&Se.push(yn)}return Se},bt=Y,$t=function(Ot,ne){return ne===void 0&&(ne=[]),bt(Ot,function(Se){return!H(ne,Se)})},jt=$t,Ht=function(Ot){return typeof Ot=="function"},re=function(Ot){return Ot==null},on=re,Je={}.toString,Ve=function(Ot,ne){return Je.call(Ot)==="[object "+ne+"]"},qn=Ve,Ln=function(Ot){return Array.isArray?Array.isArray(Ot):qn(Ot,"Array")},qr=function(Ot){var ne=typeof Ot;return Ot!==null&&ne==="object"||ne==="function"};function Ca(Ot,ne){if(!!Ot){var Se;if(Ln(Ot))for(var Ke=0,yn=Ot.length;Ke<yn&&(Se=ne(Ot[Ke],Ke),Se!==!1);Ke++);else if(qr(Ot)){for(var yr in Ot)if(Ot.hasOwnProperty(yr)&&(Se=ne(Ot[yr],yr),Se===!1))break}}}var Qn=Ca,_r=Object.keys?function(Ot){return Object.keys(Ot)}:function(Ot){var ne=[];return Qn(Ot,function(Se,Ke){Ht(Ot)&&Ke==="prototype"||ne.push(Ke)}),ne},ea=_r;function La(Ot,ne){var Se=ea(ne),Ke=Se.length;if(on(Ot))return!Ke;for(var yn=0;yn<Ke;yn+=1){var yr=Se[yn];if(ne[yr]!==Ot[yr]||!(yr in Ot))return!1}return!0}var ha=La,_i=function(Ot){return typeof Ot=="object"&&Ot!==null},Ni=_i,vi=function(Ot){if(!Ni(Ot)||!qn(Ot,"Object"))return!1;if(Object.getPrototypeOf(Ot)===null)return!0;for(var ne=Ot;Object.getPrototypeOf(ne)!==null;)ne=Object.getPrototypeOf(ne);return Object.getPrototypeOf(Ot)===ne},si=vi;function Mi(Ot,ne){if(!Ln(Ot))return null;var Se;if(Ht(ne)&&(Se=ne),si(ne)&&(Se=function(yn){return ha(yn,ne)}),Se){for(var Ke=0;Ke<Ot.length;Ke+=1)if(Se(Ot[Ke]))return Ot[Ke]}return null}var Pa=Mi;function un(Ot,ne,Se){Se===void 0&&(Se=0);for(var Ke=Se;Ke<Ot.length;Ke++)if(ne(Ot[Ke],Ke))return Ke;return-1}var Oe=un,hn=function(Ot,ne){for(var Se=null,Ke=0;Ke<Ot.length;Ke++){var yn=Ot[Ke],yr=yn[ne];if(!on(yr)){Ln(yr)?Se=yr[0]:Se=yr;break}}return Se},Hn=hn,Bn=function(Ot){if(!Ln(Ot))return[];for(var ne=[],Se=0;Se<Ot.length;Se++)ne=ne.concat(Ot[Se]);return ne},Jn=Bn,Lr=function(Ot,ne){if(ne===void 0&&(ne=[]),!Ln(Ot))ne.push(Ot);else for(var Se=0;Se<Ot.length;Se+=1)Lr(Ot[Se],ne);return ne},ya=Lr,Fa=function(Ot){if(!!Ln(Ot))return Ot.reduce(function(ne,Se){return Math.max(ne,Se)},Ot[0])},ui=function(Ot){if(!!Ln(Ot))return Ot.reduce(function(ne,Se){return Math.min(ne,Se)},Ot[0])},Ei=function(Ot){var ne=Ot.filter(function(Ir){return!isNaN(Ir)});if(!ne.length)return{min:0,max:0};if(Ln(Ot[0])){for(var Se=[],Ke=0;Ke<Ot.length;Ke++)Se=Se.concat(Ot[Ke]);ne=Se}var yn=Fa(ne),yr=ui(ne);return{min:yr,max:yn}},oo=Ei,po=Array.prototype,bo=po.splice,ts=po.indexOf,Wo=function(Ot){for(var ne=[],Se=1;Se<arguments.length;Se++)ne[Se-1]=arguments[Se];for(var Ke=0;Ke<ne.length;Ke++)for(var yn=ne[Ke],yr=-1;(yr=ts.call(Ot,yn))>-1;)bo.call(Ot,yr,1);return Ot},Yi=Wo,wi=Array.prototype.splice,gi=function(ne,Se){if(!kt(ne))return[];for(var Ke=ne?Se.length:0,yn=Ke-1;Ke--;){var yr=void 0,Ir=Se[Ke];(Ke===yn||Ir!==yr)&&(yr=Ir,wi.call(ne,Ir,1))}return ne},us=gi,Do=function(Ot,ne,Se){if(!Ln(Ot)&&!si(Ot))return Ot;var Ke=Se;return Qn(Ot,function(yn,yr){Ke=ne(Ke,yn,yr)}),Ke},Io=Do,zs=function(Ot,ne){var Se=[];if(!kt(Ot))return Se;for(var Ke=-1,yn=[],yr=Ot.length;++Ke<yr;){var Ir=Ot[Ke];ne(Ir,Ke,Ot)&&(Se.push(Ir),yn.push(Ke))}return us(Ot,yn),Se},mu=zs,ds=function(Ot){return qn(Ot,"String")};function Ms(Ot,ne){var Se;if(Ht(ne))Se=function(yn,yr){return ne(yn)-ne(yr)};else{var Ke=[];ds(ne)?Ke.push(ne):Ln(ne)&&(Ke=ne),Se=function(yn,yr){for(var Ir=0;Ir<Ke.length;Ir+=1){var la=Ke[Ir];if(yn[la]>yr[la])return 1;if(yn[la]<yr[la])return-1}return 0}}return Ot.sort(Se),Ot}var yu=Ms;function uu(Ot,ne){ne===void 0&&(ne=new Map);var Se=[];if(Array.isArray(Ot))for(var Ke=0,yn=Ot.length;Ke<yn;Ke++){var yr=Ot[Ke];ne.has(yr)||(Se.push(yr),ne.set(yr,!0))}return Se}var Cs=function(){for(var Ot=[],ne=0;ne<arguments.length;ne++)Ot[ne]=arguments[ne];return uu([].concat.apply([],Ot))},qo=Cs,Wi=function(Ot,ne){for(var Se=[],Ke={},yn=0;yn<Ot.length;yn++){var yr=Ot[yn],Ir=yr[ne];if(!on(Ir)){Ln(Ir)||(Ir=[Ir]);for(var la=0;la<Ir.length;la++){var Dn=Ir[la];Ke[Dn]||(Se.push(Dn),Ke[Dn]=!0)}}}return Se};function ls(Ot){if(kt(Ot))return Ot[0]}function is(Ot){if(kt(Ot)){var ne=Ot;return ne[ne.length-1]}}function Es(Ot,ne){return Ln(Ot)||ds(Ot)?Ot[0]===ne:!1}var tl=Es;function bu(Ot,ne){return Ln(Ot)||ds(Ot)?Ot[Ot.length-1]===ne:!1}var Ys=bu,ka=function(Ot,ne){for(var Se=0;Se<Ot.length;Se++)if(!ne(Ot[Se],Se))return!1;return!0},Ku=ka,Vs=function(Ot,ne){for(var Se=0;Se<Ot.length;Se++)if(ne(Ot[Se],Se))return!0;return!1},Ro=Vs,Ns=Object.prototype.hasOwnProperty;function tu(Ot,ne){if(!ne||!Ln(Ot))return{};for(var Se={},Ke=Ht(ne)?ne:function(la){return la[ne]},yn,yr=0;yr<Ot.length;yr++){var Ir=Ot[yr];yn=Ke(Ir),Ns.call(Se,yn)?Se[yn].push(Ir):Se[yn]=[Ir]}return Se}var eu=tu;function Zu(Ot,ne){if(!ne)return{0:Ot};if(!Ht(ne)){var Se=Ln(ne)?ne:ne.replace(/\s+/g,"").split("*");ne=function(Ke){for(var yn="_",yr=0,Ir=Se.length;yr<Ir;yr++)yn+=Ke[Se[yr]]&&Ke[Se[yr]].toString();return yn}}return eu(Ot,ne)}var bn=function(Ot,ne){if(!ne)return[Ot];var Se=Zu(Ot,ne),Ke=[];for(var yn in Se)Ke.push(Se[yn]);return Ke};function Xr(Ot,ne){return Ot["_wrap_"+ne]}var pa=Xr;function Ra(Ot,ne){if(Ot["_wrap_"+ne])return Ot["_wrap_"+ne];var Se=function(Ke){Ot[ne](Ke)};return Ot["_wrap_"+ne]=Se,Se}var Qi=Ra,Co={};function to(Ot){var ne=Co[Ot];if(!ne){for(var Se=Ot.toString(16),Ke=Se.length;Ke<6;Ke++)Se="0"+Se;ne="#"+Se,Co[Ot]=ne}return ne}var xo=to;function gs(Ot){var ne=0,Se=0,Ke=0,yn=0;return Ln(Ot)?Ot.length===1?ne=Se=Ke=yn=Ot[0]:Ot.length===2?(ne=Ke=Ot[0],Se=yn=Ot[1]):Ot.length===3?(ne=Ot[0],Se=yn=Ot[1],Ke=Ot[2]):(ne=Ot[0],Se=Ot[1],Ke=Ot[2],yn=Ot[3]):ne=Se=Ke=yn=Ot,{r1:ne,r2:Se,r3:Ke,r4:yn}}var vo=gs,ou=function(Ot,ne,Se){return Ot<ne?ne:Ot>Se?Se:Ot},ms=ou,xu=function(Ot,ne){var Se=ne.toString(),Ke=Se.indexOf(".");if(Ke===-1)return Math.round(Ot);var yn=Se.substr(Ke+1).length;return yn>20&&(yn=20),parseFloat(Ot.toFixed(yn))},dl=xu,kl=function(Ot){return qn(Ot,"Number")},Ks=kl,el=function(Ot){return Ks(Ot)&&Ot%1!=0},lu=el,Du=function(Ot){return Ks(Ot)&&Ot%2==0},pl=Du,ns=Number.isInteger?Number.isInteger:function(Ot){return Ks(Ot)&&Ot%1==0},_s=ns,Bu=function(Ot){return Ks(Ot)&&Ot<0},Au=Bu,wu=1e-5;function nu(Ot,ne,Se){return Se===void 0&&(Se=wu),Math.abs(Ot-ne)<Se}var Tl=function(Ot){return Ks(Ot)&&Ot%2!=0},xc=Tl,Sl=function(Ot){return Ks(Ot)&&Ot>0},ol=Sl,ys=function(Ot,ne){if(!!Ln(Ot)){for(var Se,Ke=-Infinity,yn=0;yn<Ot.length;yn++){var yr=Ot[yn],Ir=Ht(ne)?ne(yr):yr[ne];Ir>Ke&&(Se=yr,Ke=Ir)}return Se}},vl=function(Ot,ne){if(!!Ln(Ot)){for(var Se,Ke=Infinity,yn=0;yn<Ot.length;yn++){var yr=Ot[yn],Ir=Ht(ne)?ne(yr):yr[ne];Ir<Ke&&(Se=yr,Ke=Ir)}return Se}},kc=function(Ot,ne){return(Ot%ne+ne)%ne},Dl=kc,Ol=180/Math.PI,_e=function(Ot){return Ol*Ot},ve=_e,Bt=parseInt,ae=Math.PI/180,me=function(Ot){return ae*Ot},En=me,Zn=Qn,Kt=function(Ot,ne){return Ot.hasOwnProperty(ne)},ge=Kt,Ae=Object.values?function(Ot){return Object.values(Ot)}:function(Ot){var ne=[];return Qn(Ot,function(Se,Ke){Ht(Ot)&&Ke==="prototype"||ne.push(Se)}),ne},sn=Ae,xn=function(Ot,ne){return H(sn(Ot),ne)},ir=function(Ot){return on(Ot)?"":Ot.toString()},$r=function(Ot){return ir(Ot).toLowerCase()},Aa=$r,Va=function(Ot){var ne=ir(Ot);return ne.charAt(0).toLowerCase()+ne.substring(1)},Ba=Va;function oi(Ot,ne){return!Ot||!ne?Ot:Ot.replace(/\\?\{([^{}]+)\}/g,function(Se,Ke){return Se.charAt(0)==="\\"?Se.slice(1):ne[Ke]===void 0?"":ne[Ke]})}var ro=oi,Di=function(Ot){return ir(Ot).toUpperCase()},Si=Di,_o=function(Ot){var ne=ir(Ot);return ne.charAt(0).toUpperCase()+ne.substring(1)},To=_o,wo={}.toString,Vo=function(Ot){return wo.call(Ot).replace(/^\[object /,"").replace(/]$/,"")},js=Vo,ws=function(Ot){return qn(Ot,"Arguments")},ks=ws,Hs=function(Ot){return qn(Ot,"Boolean")},Mu=Hs,nl=function(Ot){return qn(Ot,"Date")},Cl=nl,Yl=function(Ot){return qn(Ot,"Error")},sl=Yl;function rl(Ot){return Ks(Ot)&&isFinite(Ot)}var _f=function(Ot){return Ot===null},Dc=_f,wc=Object.prototype,ef=function(Ot){var ne=Ot&&Ot.constructor,Se=typeof ne=="function"&&ne.prototype||wc;return Ot===Se},A=ef,nt=function(Ot){return qn(Ot,"RegExp")},Zt=nt,de=function(Ot){return Ot===void 0},Pe=de,Qe=function(Ot){return Ot instanceof Element||Ot instanceof HTMLDocument},rn=Qe;function wn(Ot){var ne=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(Se){return setTimeout(Se,16)};return ne(Ot)}function kn(Ot){var ne=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;ne(Ot)}function De(Ot,ne){for(var Se in ne)ne.hasOwnProperty(Se)&&Se!=="constructor"&&ne[Se]!==void 0&&(Ot[Se]=ne[Se])}function wr(Ot,ne,Se,Ke){return ne&&De(Ot,ne),Se&&De(Ot,Se),Ke&&De(Ot,Ke),Ot}var ca=function(){for(var Ot=[],ne=0;ne<arguments.length;ne++)Ot[ne]=arguments[ne];for(var Se=Ot[0],Ke=1;Ke<Ot.length;Ke++){var yn=Ot[Ke];Ht(yn)&&(yn=yn.prototype),wr(Se.prototype,yn)}},Ar=ca,ua=function(Ot){if(typeof Ot!="object"||Ot===null)return Ot;var ne;if(Ln(Ot)){ne=[];for(var Se=0,Ke=Ot.length;Se<Ke;Se++)typeof Ot[Se]=="object"&&Ot[Se]!=null?ne[Se]=ua(Ot[Se]):ne[Se]=Ot[Se]}else{ne={};for(var yn in Ot)typeof Ot[yn]=="object"&&Ot[yn]!=null?ne[yn]=ua(Ot[yn]):ne[yn]=Ot[yn]}return ne},$a=ua;function ri(Ot,ne,Se){var Ke;return function(){var yn=this,yr=arguments,Ir=function(){Ke=null,Se||Ot.apply(yn,yr)},la=Se&&!Ke;clearTimeout(Ke),Ke=setTimeout(Ir,ne),la&&Ot.apply(yn,yr)}}var ba=ri,ki=function(Ot,ne){if(!Ht(Ot))throw new TypeError("Expected a function");var Se=function(){for(var Ke=[],yn=0;yn<arguments.length;yn++)Ke[yn]=arguments[yn];var yr=ne?ne.apply(this,Ke):Ke[0],Ir=Se.cache;if(Ir.has(yr))return Ir.get(yr);var la=Ot.apply(this,Ke);return Ir.set(yr,la),la};return Se.cache=new Map,Se},Eo=5;function Lo(Ot,ne,Se,Ke){Se=Se||0,Ke=Ke||Eo;for(var yn in ne)if(ne.hasOwnProperty(yn)){var yr=ne[yn];yr!==null&&si(yr)?(si(Ot[yn])||(Ot[yn]={}),Se<Ke?Lo(Ot[yn],yr,Se+1,Ke):Ot[yn]=ne[yn]):Ln(yr)?(Ot[yn]=[],Ot[yn]=Ot[yn].concat(yr)):yr!==void 0&&(Ot[yn]=yr)}}var Bo=function(Ot){for(var ne=[],Se=1;Se<arguments.length;Se++)ne[Se-1]=arguments[Se];for(var Ke=0;Ke<ne.length;Ke+=1)Lo(Ot,ne[Ke]);return Ot},go=Bo,Ao=function(Ot,ne,Se,Ke){Ht(ne)||(Se=ne,ne=Ot,Ot=function(){});var yn=Object.create?function(Ir,la){return Object.create(Ir,{constructor:{value:la}})}:function(Ir,la){function Dn(){}Dn.prototype=Ir;var Ga=new Dn;return Ga.constructor=la,Ga},yr=yn(ne.prototype,Ot);return Ot.prototype=wr(yr,Ot.prototype),Ot.superclass=yn(ne.prototype,ne),wr(yr,Se),wr(Ot,Ke),Ot},qu=Ao,zu=function(Ot,ne){if(!kt(Ot))return-1;var Se=Array.prototype.indexOf;if(Se)return Se.call(Ot,ne);for(var Ke=-1,yn=0;yn<Ot.length;yn++)if(Ot[yn]===ne){Ke=yn;break}return Ke},Uu=zu,Qu=Object.prototype.hasOwnProperty;function Wu(Ot){if(on(Ot))return!0;if(kt(Ot))return!Ot.length;var ne=js(Ot);if(ne==="Map"||ne==="Set")return!Ot.size;if(A(Ot))return!Object.keys(Ot).length;for(var Se in Ot)if(Qu.call(Ot,Se))return!1;return!0}var al=Wu,Vu=function(Ot,ne){if(Ot===ne)return!0;if(!Ot||!ne||ds(Ot)||ds(ne))return!1;if(kt(Ot)||kt(ne)){if(Ot.length!==ne.length)return!1;for(var Se=!0,Ke=0;Ke<Ot.length&&(Se=Vu(Ot[Ke],ne[Ke]),!!Se);Ke++);return Se}if(Ni(Ot)||Ni(ne)){var yn=Object.keys(Ot),yr=Object.keys(ne);if(yn.length!==yr.length)return!1;for(var Se=!0,Ke=0;Ke<yn.length&&(Se=Vu(Ot[yn[Ke]],ne[yn[Ke]]),!!Se);Ke++);return Se}return!1},ps=Vu,ru=function(Ot,ne,Se){return Ht(Se)?!!Se(Ot,ne):ps(Ot,ne)},pf=function(Ot,ne){if(!kt(Ot))return Ot;for(var Se=[],Ke=0;Ke<Ot.length;Ke++){var yn=Ot[Ke];Se.push(ne(yn,Ke))}return Se},Ec=pf,Ou=function(Ot){return Ot},Uc=function(Ot,ne){ne===void 0&&(ne=Ou);var Se={};return qr(Ot)&&!on(Ot)&&Object.keys(Ot).forEach(function(Ke){Se[Ke]=ne(Ot[Ke],Ke)}),Se},Wh=function(Ot,ne,Se){for(var Ke=0,yn=ds(ne)?ne.split("."):ne;Ot&&Ke<yn.length;)Ot=Ot[yn[Ke++]];return Ot===void 0||Ke<yn.length?Se:Ot},pp=function(Ot,ne,Se){var Ke=Ot,yn=ds(ne)?ne.split("."):ne;return yn.forEach(function(yr,Ir){Ir<yn.length-1?(qr(Ke[yr])||(Ke[yr]=Ks(yn[Ir+1])?[]:{}),Ke=Ke[yr]):Ke[yr]=Se}),Ot},$p=Object.prototype.hasOwnProperty,sd=function(Ot,ne){if(Ot===null||!si(Ot))return{};var Se={};return Qn(ne,function(Ke){$p.call(Ot,Ke)&&(Se[Ke]=Ot[Ke])}),Se},kd=function(Ot,ne){return Io(Ot,function(Se,Ke,yn){return ne.includes(yn)||(Se[yn]=Ke),Se},{})},vp=function(Ot,ne,Se){var Ke,yn,yr,Ir,la=0;Se||(Se={});var Dn=function(){la=Se.leading===!1?0:Date.now(),Ke=null,Ir=Ot.apply(yn,yr),Ke||(yn=yr=null)},Ga=function(){var xi=Date.now();!la&&Se.leading===!1&&(la=xi);var Ui=ne-(xi-la);return yn=this,yr=arguments,Ui<=0||Ui>ne?(Ke&&(clearTimeout(Ke),Ke=null),la=xi,Ir=Ot.apply(yn,yr),Ke||(yn=yr=null)):!Ke&&Se.trailing!==!1&&(Ke=setTimeout(Dn,Ui)),Ir};return Ga.cancel=function(){clearTimeout(Ke),la=0,Ke=yn=yr=null},Ga},$f=function(Ot){return kt(Ot)?Array.prototype.slice.call(Ot):[]},If={},Dd=function(Ot){return Ot=Ot||"g",If[Ot]?If[Ot]+=1:If[Ot]=1,Ot+If[Ot]},eh=function(){},Gp=function(Ot){return Ot};function Oc(Ot){return on(Ot)?0:kt(Ot)?Ot.length:Object.keys(Ot).length}var vh=function(){function Ot(){this.map={}}return Ot.prototype.has=function(ne){return this.map[ne]!==void 0},Ot.prototype.get=function(ne,Se){var Ke=this.map[ne];return Ke===void 0?Se:Ke},Ot.prototype.set=function(ne,Se){this.map[ne]=Se},Ot.prototype.clear=function(){this.map={}},Ot.prototype.delete=function(ne){delete this.map[ne]},Ot.prototype.size=function(){return Object.keys(this.map).length},Ot}(),Pi=vh,gh=1e-6;function cs(Ot){return Math.abs(Ot)<gh?0:Ot<0?-1:1}function Wc(Ot,ne,Se){return(Se[0]-Ot[0])*(ne[1]-Ot[1])==(ne[0]-Ot[0])*(Se[1]-Ot[1])&&Math.min(Ot[0],ne[0])<=Se[0]&&Se[0]<=Math.max(Ot[0],ne[0])&&Math.min(Ot[1],ne[1])<=Se[1]&&Se[1]<=Math.max(Ot[1],ne[1])}function Gf(Ot,ne,Se){var Ke=!1,yn=Ot.length;if(yn<=2)return!1;for(var yr=0;yr<yn;yr++){var Ir=Ot[yr],la=Ot[(yr+1)%yn];if(Wc(Ir,la,[ne,Se]))return!0;cs(Ir[1]-Se)>0!=cs(la[1]-Se)>0&&cs(ne-(Se-Ir[1])*(Ir[0]-la[0])/(Ir[1]-la[1])-Ir[0])<0&&(Ke=!Ke)}return Ke}var nf=function(Ot,ne,Se){return Ot>=ne&&Ot<=Se};function rf(Ot,ne,Se,Ke){var yn=.001,yr={x:Se.x-Ot.x,y:Se.y-Ot.y},Ir={x:ne.x-Ot.x,y:ne.y-Ot.y},la={x:Ke.x-Se.x,y:Ke.y-Se.y},Dn=Ir.x*la.y-Ir.y*la.x,Ga=Dn*Dn,xi=Ir.x*Ir.x+Ir.y*Ir.y,Ui=la.x*la.x+la.y*la.y,Ii=null;if(Ga>yn*xi*Ui){var Mo=(yr.x*la.y-yr.y*la.x)/Dn,rs=(yr.x*Ir.y-yr.y*Ir.x)/Dn;nf(Mo,0,1)&&nf(rs,0,1)&&(Ii={x:Ot.x+Mo*Ir.x,y:Ot.y+Mo*Ir.y})}return Ii}function Od(Ot){for(var ne=[],Se=Ot.length,Ke=0;Ke<Se-1;Ke++){var yn=Ot[Ke],yr=Ot[Ke+1];ne.push({from:{x:yn[0],y:yn[1]},to:{x:yr[0],y:yr[1]}})}if(ne.length>1){var Ir=Ot[0],la=Ot[Se-1];ne.push({from:{x:la[0],y:la[1]},to:{x:Ir[0],y:Ir[1]}})}return ne}function Nu(Ot,ne){var Se=!1;return Ot.forEach(function(Ke){if(rf(Ke.from,Ke.to,ne.from,ne.to))return Se=!0,!1}),Se}function ic(Ot){var ne=Ot.map(function(Ke){return Ke[0]}),Se=Ot.map(function(Ke){return Ke[1]});return{minX:Math.min.apply(null,ne),maxX:Math.max.apply(null,ne),minY:Math.min.apply(null,Se),maxY:Math.max.apply(null,Se)}}function mh(Ot,ne){return!(ne.minX>Ot.maxX||ne.maxX<Ot.minX||ne.minY>Ot.maxY||ne.maxY<Ot.minY)}function oc(Ot,ne){if(Ot.length<2||ne.length<2)return!1;var Se=ic(Ot),Ke=ic(ne);if(!mh(Se,Ke))return!1;var yn=!1;if(ne.forEach(function(Dn){if(Gf(Ot,Dn[0],Dn[1]))return yn=!0,!1}),yn||(Ot.forEach(function(Dn){if(Gf(ne,Dn[0],Dn[1]))return yn=!0,!1}),yn))return!0;var yr=Od(Ot),Ir=Od(ne),la=!1;return Ir.forEach(function(Dn){if(Nu(yr,Dn))return la=!0,!1}),la}},76749:function(sr,it,$){"use strict";$.r(it),$.d(it,{quadtree:function(){return X.Z}});var X=$(88863)},88863:function(sr,it,$){"use strict";$.d(it,{Z:function(){return mt}});function X(gt){const wt=+this._x.call(null,gt),ot=+this._y.call(null,gt);return tt(this.cover(wt,ot),wt,ot,gt)}function tt(gt,wt,ot,pt){if(isNaN(wt)||isNaN(ot))return gt;var Nt,Gt=gt._root,se={data:pt},ie=gt._x0,Be=gt._y0,ke=gt._x1,we=gt._y1,At,Yt,be,nn,Ee,le,Le,Ze;if(!Gt)return gt._root=se,gt;for(;Gt.length;)if((Ee=wt>=(At=(ie+ke)/2))?ie=At:ke=At,(le=ot>=(Yt=(Be+we)/2))?Be=Yt:we=Yt,Nt=Gt,!(Gt=Gt[Le=le<<1|Ee]))return Nt[Le]=se,gt;if(be=+gt._x.call(null,Gt.data),nn=+gt._y.call(null,Gt.data),wt===be&&ot===nn)return se.next=Gt,Nt?Nt[Le]=se:gt._root=se,gt;do Nt=Nt?Nt[Le]=new Array(4):gt._root=new Array(4),(Ee=wt>=(At=(ie+ke)/2))?ie=At:ke=At,(le=ot>=(Yt=(Be+we)/2))?Be=Yt:we=Yt;while((Le=le<<1|Ee)==(Ze=(nn>=Yt)<<1|be>=At));return Nt[Ze]=Gt,Nt[Le]=se,gt}function j(gt){var wt,ot,pt=gt.length,Nt,Gt,se=new Array(pt),ie=new Array(pt),Be=Infinity,ke=Infinity,we=-Infinity,At=-Infinity;for(ot=0;ot<pt;++ot)isNaN(Nt=+this._x.call(null,wt=gt[ot]))||isNaN(Gt=+this._y.call(null,wt))||(se[ot]=Nt,ie[ot]=Gt,Nt<Be&&(Be=Nt),Nt>we&&(we=Nt),Gt<ke&&(ke=Gt),Gt>At&&(At=Gt));if(Be>we||ke>At)return this;for(this.cover(Be,ke).cover(we,At),ot=0;ot<pt;++ot)tt(this,se[ot],ie[ot],gt[ot]);return this}function W(gt,wt){if(isNaN(gt=+gt)||isNaN(wt=+wt))return this;var ot=this._x0,pt=this._y0,Nt=this._x1,Gt=this._y1;if(isNaN(ot))Nt=(ot=Math.floor(gt))+1,Gt=(pt=Math.floor(wt))+1;else{for(var se=Nt-ot||1,ie=this._root,Be,ke;ot>gt||gt>=Nt||pt>wt||wt>=Gt;)switch(ke=(wt<pt)<<1|gt<ot,Be=new Array(4),Be[ke]=ie,ie=Be,se*=2,ke){case 0:Nt=ot+se,Gt=pt+se;break;case 1:ot=Nt-se,Gt=pt+se;break;case 2:Nt=ot+se,pt=Gt-se;break;case 3:ot=Nt-se,pt=Gt-se;break}this._root&&this._root.length&&(this._root=ie)}return this._x0=ot,this._y0=pt,this._x1=Nt,this._y1=Gt,this}function Q(){var gt=[];return this.visit(function(wt){if(!wt.length)do gt.push(wt.data);while(wt=wt.next)}),gt}function Z(gt){return arguments.length?this.cover(+gt[0][0],+gt[0][1]).cover(+gt[1][0],+gt[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function L(gt,wt,ot,pt,Nt){this.node=gt,this.x0=wt,this.y0=ot,this.x1=pt,this.y1=Nt}function P(gt,wt,ot){var pt,Nt=this._x0,Gt=this._y0,se,ie,Be,ke,we=this._x1,At=this._y1,Yt=[],be=this._root,nn,Ee;for(be&&Yt.push(new L(be,Nt,Gt,we,At)),ot==null?ot=Infinity:(Nt=gt-ot,Gt=wt-ot,we=gt+ot,At=wt+ot,ot*=ot);nn=Yt.pop();)if(!(!(be=nn.node)||(se=nn.x0)>we||(ie=nn.y0)>At||(Be=nn.x1)<Nt||(ke=nn.y1)<Gt))if(be.length){var le=(se+Be)/2,Le=(ie+ke)/2;Yt.push(new L(be[3],le,Le,Be,ke),new L(be[2],se,Le,le,ke),new L(be[1],le,ie,Be,Le),new L(be[0],se,ie,le,Le)),(Ee=(wt>=Le)<<1|gt>=le)&&(nn=Yt[Yt.length-1],Yt[Yt.length-1]=Yt[Yt.length-1-Ee],Yt[Yt.length-1-Ee]=nn)}else{var Ze=gt-+this._x.call(null,be.data),fe=wt-+this._y.call(null,be.data),Re=Ze*Ze+fe*fe;if(Re<ot){var He=Math.sqrt(ot=Re);Nt=gt-He,Gt=wt-He,we=gt+He,At=wt+He,pt=be.data}}return pt}function C(gt){if(isNaN(we=+this._x.call(null,gt))||isNaN(At=+this._y.call(null,gt)))return this;var wt,ot=this._root,pt,Nt,Gt,se=this._x0,ie=this._y0,Be=this._x1,ke=this._y1,we,At,Yt,be,nn,Ee,le,Le;if(!ot)return this;if(ot.length)for(;;){if((nn=we>=(Yt=(se+Be)/2))?se=Yt:Be=Yt,(Ee=At>=(be=(ie+ke)/2))?ie=be:ke=be,wt=ot,!(ot=ot[le=Ee<<1|nn]))return this;if(!ot.length)break;(wt[le+1&3]||wt[le+2&3]||wt[le+3&3])&&(pt=wt,Le=le)}for(;ot.data!==gt;)if(Nt=ot,!(ot=ot.next))return this;return(Gt=ot.next)&&delete ot.next,Nt?(Gt?Nt.next=Gt:delete Nt.next,this):wt?(Gt?wt[le]=Gt:delete wt[le],(ot=wt[0]||wt[1]||wt[2]||wt[3])&&ot===(wt[3]||wt[2]||wt[1]||wt[0])&&!ot.length&&(pt?pt[Le]=ot:this._root=ot),this):(this._root=Gt,this)}function M(gt){for(var wt=0,ot=gt.length;wt<ot;++wt)this.remove(gt[wt]);return this}function k(){return this._root}function B(){var gt=0;return this.visit(function(wt){if(!wt.length)do++gt;while(wt=wt.next)}),gt}function R(gt){var wt=[],ot,pt=this._root,Nt,Gt,se,ie,Be;for(pt&&wt.push(new L(pt,this._x0,this._y0,this._x1,this._y1));ot=wt.pop();)if(!gt(pt=ot.node,Gt=ot.x0,se=ot.y0,ie=ot.x1,Be=ot.y1)&&pt.length){var ke=(Gt+ie)/2,we=(se+Be)/2;(Nt=pt[3])&&wt.push(new L(Nt,ke,we,ie,Be)),(Nt=pt[2])&&wt.push(new L(Nt,Gt,we,ke,Be)),(Nt=pt[1])&&wt.push(new L(Nt,ke,se,ie,we)),(Nt=pt[0])&&wt.push(new L(Nt,Gt,se,ke,we))}return this}function F(gt){var wt=[],ot=[],pt;for(this._root&&wt.push(new L(this._root,this._x0,this._y0,this._x1,this._y1));pt=wt.pop();){var Nt=pt.node;if(Nt.length){var Gt,se=pt.x0,ie=pt.y0,Be=pt.x1,ke=pt.y1,we=(se+Be)/2,At=(ie+ke)/2;(Gt=Nt[0])&&wt.push(new L(Gt,se,ie,we,At)),(Gt=Nt[1])&&wt.push(new L(Gt,we,ie,Be,At)),(Gt=Nt[2])&&wt.push(new L(Gt,se,At,we,ke)),(Gt=Nt[3])&&wt.push(new L(Gt,we,At,Be,ke))}ot.push(pt)}for(;pt=ot.pop();)gt(pt.node,pt.x0,pt.y0,pt.x1,pt.y1);return this}function K(gt){return gt[0]}function O(gt){return arguments.length?(this._x=gt,this):this._x}function _(gt){return gt[1]}function ft(gt){return arguments.length?(this._y=gt,this):this._y}function mt(gt,wt,ot){var pt=new st(wt==null?K:wt,ot==null?_:ot,NaN,NaN,NaN,NaN);return gt==null?pt:pt.addAll(gt)}function st(gt,wt,ot,pt,Nt,Gt){this._x=gt,this._y=wt,this._x0=ot,this._y0=pt,this._x1=Nt,this._y1=Gt,this._root=void 0}function ut(gt){for(var wt={data:gt.data},ot=wt;gt=gt.next;)ot=ot.next={data:gt.data};return wt}var dt=mt.prototype=st.prototype;dt.copy=function(){var gt=new st(this._x,this._y,this._x0,this._y0,this._x1,this._y1),wt=this._root,ot,pt;if(!wt)return gt;if(!wt.length)return gt._root=ut(wt),gt;for(ot=[{source:wt,target:gt._root=new Array(4)}];wt=ot.pop();)for(var Nt=0;Nt<4;++Nt)(pt=wt.source[Nt])&&(pt.length?ot.push({source:pt,target:wt.target[Nt]=new Array(4)}):wt.target[Nt]=ut(pt));return gt},dt.add=X,dt.addAll=j,dt.cover=W,dt.data=Q,dt.extent=Z,dt.find=P,dt.remove=C,dt.removeAll=M,dt.root=k,dt.size=B,dt.visit=R,dt.visitAfter=F,dt.x=O,dt.y=ft},31278:function(sr,it,$){"use strict";var X;X={value:!0};var tt=$(64530);function j(k,B,R){var F=[0,0,0,0,0,0,0,0,0];return tt.mat3.fromTranslation(F,R),tt.mat3.multiply(k,F,B)}X=j;function W(k,B,R){var F=[0,0,0,0,0,0,0,0,0];return tt.mat3.fromRotation(F,R),tt.mat3.multiply(k,F,B)}X=W;function Q(k,B,R){var F=[0,0,0,0,0,0,0,0,0];return tt.mat3.fromScaling(F,R),tt.mat3.multiply(k,F,B)}X=Q;function Z(k,B,R){return tt.mat3.multiply(k,R,B)}function L(k,B){for(var R=k?[].concat(k):[1,0,0,0,1,0,0,0,1],F=0,K=B.length;F<K;F++){var O=B[F];switch(O[0]){case"t":j(R,R,[O[1],O[2]]);break;case"s":Q(R,R,[O[1],O[2]]);break;case"r":W(R,R,O[1]);break;case"m":Z(R,R,O[1]);break;default:break}}return R}it.vs=L;function P(k,B){return k[0]*B[1]-B[0]*k[1]}X=P;function C(k,B,R){var F=tt.vec2.angle(k,B),K=P(k,B)>=0;return R?K?Math.PI*2-F:F:K?F:Math.PI*2-F}X=C;function M(k,B,R){return R?(k[0]=B[1],k[1]=-1*B[0]):(k[0]=-1*B[1],k[1]=B[0]),k}X=M},23044:function(sr,it,$){"use strict";$.r(it),$.d(it,{Cache:function(){return Zn},assign:function(){return eu},augment:function(){return bn},clamp:function(){return _n},clearAnimationFrame:function(){return Ns},clone:function(){return pa},contains:function(){return W},debounce:function(){return Qi},deepMix:function(){return vo},difference:function(){return P},each:function(){return O},endsWith:function(){return Sa},every:function(){return Da},extend:function(){return ms},filter:function(){return Z},find:function(){return pt},findIndex:function(){return Gt},firstValue:function(){return ie},fixedBase:function(){return Lt},flatten:function(){return ke},flattenDeep:function(){return At},forIn:function(){return un},get:function(){return wu},getEllipsisText:function(){return me},getRange:function(){return Ee},getType:function(){return us},getWrapBehavior:function(){return Ea},group:function(){return jr},groupBy:function(){return tr},groupToMap:function(){return Gn},has:function(){return Oe},hasKey:function(){return hn},hasValue:function(){return Jn},head:function(){return Un},identity:function(){return Ol},includes:function(){return W},indexOf:function(){return dl},isArguments:function(){return Io},isArray:function(){return R.Z},isArrayLike:function(){return tt},isBoolean:function(){return mu},isDate:function(){return Ms},isDecimal:function(){return Y},isElement:function(){return Vs},isEmpty:function(){return el},isEqual:function(){return Du},isEqualWith:function(){return pl},isError:function(){return uu},isEven:function(){return $t},isFinite:function(){return Cs},isFunction:function(){return M},isInteger:function(){return Ht},isMatch:function(){return st},isNegative:function(){return on},isNil:function(){return B},isNull:function(){return Wi},isNumber:function(){return at},isNumberEqual:function(){return Ve},isObject:function(){return F},isObjectLike:function(){return dt},isOdd:function(){return Ln},isPlainObject:function(){return wt},isPositive:function(){return Ca},isPrototype:function(){return Es},isRegExp:function(){return bu},isString:function(){return Pt},isType:function(){return C.Z},isUndefined:function(){return ka},keys:function(){return ft},last:function(){return xr},lowerCase:function(){return Fa},lowerFirst:function(){return Ei},map:function(){return _s},mapValues:function(){return Au},max:function(){return Yt},maxBy:function(){return Qn},measureTextWidth:function(){return ae},memoize:function(){return Co},min:function(){return be},minBy:function(){return _r},mix:function(){return eu},mod:function(){return La},noop:function(){return Dl},number2color:function(){return ta},omit:function(){return Sl},parseRadius:function(){return Zr},pick:function(){return xc},pull:function(){return Re},pullAt:function(){return Ge},reduce:function(){return Me},remove:function(){return ee},requestAnimationFrame:function(){return Ro},set:function(){return nu},size:function(){return _e},some:function(){return Mn},sortBy:function(){return Ne},startsWith:function(){return Ur},substitute:function(){return po},throttle:function(){return ol},toArray:function(){return ys},toDegree:function(){return Ni},toInteger:function(){return vi},toRadian:function(){return Pa},toString:function(){return Lr},union:function(){return Rt},uniq:function(){return tn},uniqueId:function(){return kc},upperCase:function(){return ts},upperFirst:function(){return Yi},values:function(){return Bn},valuesOfKey:function(){return Yn},wrapBehavior:function(){return Cr}});var X=function(Kt){return Kt!==null&&typeof Kt!="function"&&isFinite(Kt.length)},tt=X,j=function(Kt,ge){return tt(Kt)?Kt.indexOf(ge)>-1:!1},W=j,Q=function(Kt,ge){if(!tt(Kt))return Kt;for(var Ae=[],sn=0;sn<Kt.length;sn++){var xn=Kt[sn];ge(xn,sn)&&Ae.push(xn)}return Ae},Z=Q,L=function(Kt,ge){return ge===void 0&&(ge=[]),Z(Kt,function(Ae){return!W(ge,Ae)})},P=L,C=$(57371),M=function(Kt){return(0,C.Z)(Kt,"Function")},k=function(Kt){return Kt==null},B=k,R=$(75345),F=function(Kt){var ge=typeof Kt;return Kt!==null&&ge==="object"||ge==="function"};function K(Kt,ge){if(!!Kt){var Ae;if((0,R.Z)(Kt))for(var sn=0,xn=Kt.length;sn<xn&&(Ae=ge(Kt[sn],sn),Ae!==!1);sn++);else if(F(Kt)){for(var ir in Kt)if(Kt.hasOwnProperty(ir)&&(Ae=ge(Kt[ir],ir),Ae===!1))break}}}var O=K,_=Object.keys?function(Kt){return Object.keys(Kt)}:function(Kt){var ge=[];return O(Kt,function(Ae,sn){M(Kt)&&sn==="prototype"||ge.push(sn)}),ge},ft=_;function mt(Kt,ge){var Ae=ft(ge),sn=Ae.length;if(B(Kt))return!sn;for(var xn=0;xn<sn;xn+=1){var ir=Ae[xn];if(ge[ir]!==Kt[ir]||!(ir in Kt))return!1}return!0}var st=mt,ut=function(Kt){return typeof Kt=="object"&&Kt!==null},dt=ut,gt=function(Kt){if(!dt(Kt)||!(0,C.Z)(Kt,"Object"))return!1;if(Object.getPrototypeOf(Kt)===null)return!0;for(var ge=Kt;Object.getPrototypeOf(ge)!==null;)ge=Object.getPrototypeOf(ge);return Object.getPrototypeOf(Kt)===ge},wt=gt;function ot(Kt,ge){if(!(0,R.Z)(Kt))return null;var Ae;if(M(ge)&&(Ae=ge),wt(ge)&&(Ae=function(xn){return st(xn,ge)}),Ae){for(var sn=0;sn<Kt.length;sn+=1)if(Ae(Kt[sn]))return Kt[sn]}return null}var pt=ot;function Nt(Kt,ge,Ae){Ae===void 0&&(Ae=0);for(var sn=Ae;sn<Kt.length;sn++)if(ge(Kt[sn],sn))return sn;return-1}var Gt=Nt,se=function(Kt,ge){for(var Ae=null,sn=0;sn<Kt.length;sn++){var xn=Kt[sn],ir=xn[ge];if(!B(ir)){(0,R.Z)(ir)?Ae=ir[0]:Ae=ir;break}}return Ae},ie=se,Be=function(Kt){if(!(0,R.Z)(Kt))return[];for(var ge=[],Ae=0;Ae<Kt.length;Ae++)ge=ge.concat(Kt[Ae]);return ge},ke=Be,we=function(Kt,ge){if(ge===void 0&&(ge=[]),!(0,R.Z)(Kt))ge.push(Kt);else for(var Ae=0;Ae<Kt.length;Ae+=1)we(Kt[Ae],ge);return ge},At=we,Yt=function(Kt){if(!!(0,R.Z)(Kt))return Kt.reduce(function(ge,Ae){return Math.max(ge,Ae)},Kt[0])},be=function(Kt){if(!!(0,R.Z)(Kt))return Kt.reduce(function(ge,Ae){return Math.min(ge,Ae)},Kt[0])},nn=function(Kt){var ge=Kt.filter(function($r){return!isNaN($r)});if(!ge.length)return{min:0,max:0};if((0,R.Z)(Kt[0])){for(var Ae=[],sn=0;sn<Kt.length;sn++)Ae=Ae.concat(Kt[sn]);ge=Ae}var xn=Yt(ge),ir=be(ge);return{min:ir,max:xn}},Ee=nn,le=Array.prototype,Le=le.splice,Ze=le.indexOf,fe=function(Kt){for(var ge=[],Ae=1;Ae<arguments.length;Ae++)ge[Ae-1]=arguments[Ae];for(var sn=0;sn<ge.length;sn++)for(var xn=ge[sn],ir=-1;(ir=Ze.call(Kt,xn))>-1;)Le.call(Kt,ir,1);return Kt},Re=fe,He=Array.prototype.splice,pe=function(ge,Ae){if(!tt(ge))return[];for(var sn=ge?Ae.length:0,xn=sn-1;sn--;){var ir=void 0,$r=Ae[sn];(sn===xn||$r!==ir)&&(ir=$r,He.call(ge,$r,1))}return ge},Ge=pe,te=function(Kt,ge,Ae){if(!(0,R.Z)(Kt)&&!wt(Kt))return Kt;var sn=Ae;return O(Kt,function(xn,ir){sn=ge(sn,xn,ir)}),sn},Me=te,We=function(Kt,ge){var Ae=[];if(!tt(Kt))return Ae;for(var sn=-1,xn=[],ir=Kt.length;++sn<ir;){var $r=Kt[sn];ge($r,sn,Kt)&&(Ae.push($r),xn.push(sn))}return Ge(Kt,xn),Ae},ee=We,Pt=function(Kt){return(0,C.Z)(Kt,"String")};function yt(Kt,ge){var Ae;if(M(ge))Ae=function(xn,ir){return ge(xn)-ge(ir)};else{var sn=[];Pt(ge)?sn.push(ge):(0,R.Z)(ge)&&(sn=ge),Ae=function(xn,ir){for(var $r=0;$r<sn.length;$r+=1){var Aa=sn[$r];if(xn[Aa]>ir[Aa])return 1;if(xn[Aa]<ir[Aa])return-1}return 0}}return Kt.sort(Ae),Kt}var Ne=yt;function tn(Kt,ge){ge===void 0&&(ge=new Map);var Ae=[];if(Array.isArray(Kt))for(var sn=0,xn=Kt.length;sn<xn;sn++){var ir=Kt[sn];ge.has(ir)||(Ae.push(ir),ge.set(ir,!0))}return Ae}var fn=function(){for(var Kt=[],ge=0;ge<arguments.length;ge++)Kt[ge]=arguments[ge];return tn([].concat.apply([],Kt))},Rt=fn,Yn=function(Kt,ge){for(var Ae=[],sn={},xn=0;xn<Kt.length;xn++){var ir=Kt[xn],$r=ir[ge];if(!B($r)){(0,R.Z)($r)||($r=[$r]);for(var Aa=0;Aa<$r.length;Aa++){var Va=$r[Aa];sn[Va]||(Ae.push(Va),sn[Va]=!0)}}}return Ae};function Un(Kt){if(tt(Kt))return Kt[0]}function xr(Kt){if(tt(Kt)){var ge=Kt;return ge[ge.length-1]}}function cr(Kt,ge){return(0,R.Z)(Kt)||Pt(Kt)?Kt[0]===ge:!1}var Ur=cr;function fa(Kt,ge){return(0,R.Z)(Kt)||Pt(Kt)?Kt[Kt.length-1]===ge:!1}var Sa=fa,sa=function(Kt,ge){for(var Ae=0;Ae<Kt.length;Ae++)if(!ge(Kt[Ae],Ae))return!1;return!0},Da=sa,Rr=function(Kt,ge){for(var Ae=0;Ae<Kt.length;Ae++)if(ge(Kt[Ae],Ae))return!0;return!1},Mn=Rr,ar=Object.prototype.hasOwnProperty;function Fn(Kt,ge){if(!ge||!(0,R.Z)(Kt))return{};for(var Ae={},sn=M(ge)?ge:function(Aa){return Aa[ge]},xn,ir=0;ir<Kt.length;ir++){var $r=Kt[ir];xn=sn($r),ar.call(Ae,xn)?Ae[xn].push($r):Ae[xn]=[$r]}return Ae}var tr=Fn;function Gn(Kt,ge){if(!ge)return{0:Kt};if(!M(ge)){var Ae=(0,R.Z)(ge)?ge:ge.replace(/\s+/g,"").split("*");ge=function(sn){for(var xn="_",ir=0,$r=Ae.length;ir<$r;ir++)xn+=sn[Ae[ir]]&&sn[Ae[ir]].toString();return xn}}return tr(Kt,ge)}var jr=function(Kt,ge){if(!ge)return[Kt];var Ae=Gn(Kt,ge),sn=[];for(var xn in Ae)sn.push(Ae[xn]);return sn};function Hr(Kt,ge){return Kt["_wrap_"+ge]}var Ea=Hr;function lr(Kt,ge){if(Kt["_wrap_"+ge])return Kt["_wrap_"+ge];var Ae=function(sn){Kt[ge](sn)};return Kt["_wrap_"+ge]=Ae,Ae}var Cr=lr,vr={};function Tr(Kt){var ge=vr[Kt];if(!ge){for(var Ae=Kt.toString(16),sn=Ae.length;sn<6;sn++)Ae="0"+Ae;ge="#"+Ae,vr[Kt]=ge}return ge}var ta=Tr;function ra(Kt){var ge=0,Ae=0,sn=0,xn=0;return(0,R.Z)(Kt)?Kt.length===1?ge=Ae=sn=xn=Kt[0]:Kt.length===2?(ge=sn=Kt[0],Ae=xn=Kt[1]):Kt.length===3?(ge=Kt[0],Ae=xn=Kt[1],sn=Kt[2]):(ge=Kt[0],Ae=Kt[1],sn=Kt[2],xn=Kt[3]):ge=Ae=sn=xn=Kt,{r1:ge,r2:Ae,r3:sn,r4:xn}}var Zr=ra,vt=function(Kt,ge,Ae){return Kt<ge?ge:Kt>Ae?Ae:Kt},_n=vt,an=function(Kt,ge){var Ae=ge.toString(),sn=Ae.indexOf(".");if(sn===-1)return Math.round(Kt);var xn=Ae.substr(sn+1).length;return xn>20&&(xn=20),parseFloat(Kt.toFixed(xn))},Lt=an,kt=function(Kt){return(0,C.Z)(Kt,"Number")},at=kt,H=function(Kt){return at(Kt)&&Kt%1!=0},Y=H,bt=function(Kt){return at(Kt)&&Kt%2==0},$t=bt,jt=Number.isInteger?Number.isInteger:function(Kt){return at(Kt)&&Kt%1==0},Ht=jt,re=function(Kt){return at(Kt)&&Kt<0},on=re,Je=1e-5;function Ve(Kt,ge,Ae){return Ae===void 0&&(Ae=Je),Math.abs(Kt-ge)<Ae}var qn=function(Kt){return at(Kt)&&Kt%2!=0},Ln=qn,qr=function(Kt){return at(Kt)&&Kt>0},Ca=qr,Qn=function(Kt,ge){if(!!(0,R.Z)(Kt)){for(var Ae,sn=-Infinity,xn=0;xn<Kt.length;xn++){var ir=Kt[xn],$r=M(ge)?ge(ir):ir[ge];$r>sn&&(Ae=ir,sn=$r)}return Ae}},_r=function(Kt,ge){if(!!(0,R.Z)(Kt)){for(var Ae,sn=Infinity,xn=0;xn<Kt.length;xn++){var ir=Kt[xn],$r=M(ge)?ge(ir):ir[ge];$r<sn&&(Ae=ir,sn=$r)}return Ae}},ea=function(Kt,ge){return(Kt%ge+ge)%ge},La=ea,ha=180/Math.PI,_i=function(Kt){return ha*Kt},Ni=_i,vi=parseInt,si=Math.PI/180,Mi=function(Kt){return si*Kt},Pa=Mi,un=O,Oe=function(Kt,ge){return Kt.hasOwnProperty(ge)},hn=Oe,Hn=Object.values?function(Kt){return Object.values(Kt)}:function(Kt){var ge=[];return O(Kt,function(Ae,sn){M(Kt)&&sn==="prototype"||ge.push(Ae)}),ge},Bn=Hn,Jn=function(Kt,ge){return W(Bn(Kt),ge)},Lr=function(Kt){return B(Kt)?"":Kt.toString()},ya=function(Kt){return Lr(Kt).toLowerCase()},Fa=ya,ui=function(Kt){var ge=Lr(Kt);return ge.charAt(0).toLowerCase()+ge.substring(1)},Ei=ui;function oo(Kt,ge){return!Kt||!ge?Kt:Kt.replace(/\\?\{([^{}]+)\}/g,function(Ae,sn){return Ae.charAt(0)==="\\"?Ae.slice(1):ge[sn]===void 0?"":ge[sn]})}var po=oo,bo=function(Kt){return Lr(Kt).toUpperCase()},ts=bo,Wo=function(Kt){var ge=Lr(Kt);return ge.charAt(0).toUpperCase()+ge.substring(1)},Yi=Wo,wi={}.toString,gi=function(Kt){return wi.call(Kt).replace(/^\[object /,"").replace(/]$/,"")},us=gi,Do=function(Kt){return(0,C.Z)(Kt,"Arguments")},Io=Do,zs=function(Kt){return(0,C.Z)(Kt,"Boolean")},mu=zs,ds=function(Kt){return(0,C.Z)(Kt,"Date")},Ms=ds,yu=function(Kt){return(0,C.Z)(Kt,"Error")},uu=yu;function Cs(Kt){return at(Kt)&&isFinite(Kt)}var qo=function(Kt){return Kt===null},Wi=qo,ls=Object.prototype,is=function(Kt){var ge=Kt&&Kt.constructor,Ae=typeof ge=="function"&&ge.prototype||ls;return Kt===Ae},Es=is,tl=function(Kt){return(0,C.Z)(Kt,"RegExp")},bu=tl,Ys=function(Kt){return Kt===void 0},ka=Ys,Ku=function(Kt){return Kt instanceof Element||Kt instanceof HTMLDocument},Vs=Ku;function Ro(Kt){var ge=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(Ae){return setTimeout(Ae,16)};return ge(Kt)}function Ns(Kt){var ge=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;ge(Kt)}function tu(Kt,ge){for(var Ae in ge)ge.hasOwnProperty(Ae)&&Ae!=="constructor"&&ge[Ae]!==void 0&&(Kt[Ae]=ge[Ae])}function eu(Kt,ge,Ae,sn){return ge&&tu(Kt,ge),Ae&&tu(Kt,Ae),sn&&tu(Kt,sn),Kt}var Zu=function(){for(var Kt=[],ge=0;ge<arguments.length;ge++)Kt[ge]=arguments[ge];for(var Ae=Kt[0],sn=1;sn<Kt.length;sn++){var xn=Kt[sn];M(xn)&&(xn=xn.prototype),eu(Ae.prototype,xn)}},bn=Zu,Xr=function(Kt){if(typeof Kt!="object"||Kt===null)return Kt;var ge;if((0,R.Z)(Kt)){ge=[];for(var Ae=0,sn=Kt.length;Ae<sn;Ae++)typeof Kt[Ae]=="object"&&Kt[Ae]!=null?ge[Ae]=Xr(Kt[Ae]):ge[Ae]=Kt[Ae]}else{ge={};for(var xn in Kt)typeof Kt[xn]=="object"&&Kt[xn]!=null?ge[xn]=Xr(Kt[xn]):ge[xn]=Kt[xn]}return ge},pa=Xr;function Ra(Kt,ge,Ae){var sn;return function(){var xn=this,ir=arguments,$r=function(){sn=null,Ae||Kt.apply(xn,ir)},Aa=Ae&&!sn;clearTimeout(sn),sn=setTimeout($r,ge),Aa&&Kt.apply(xn,ir)}}var Qi=Ra,Co=function(Kt,ge){if(!M(Kt))throw new TypeError("Expected a function");var Ae=function(){for(var sn=[],xn=0;xn<arguments.length;xn++)sn[xn]=arguments[xn];var ir=ge?ge.apply(this,sn):sn[0],$r=Ae.cache;if($r.has(ir))return $r.get(ir);var Aa=Kt.apply(this,sn);return $r.set(ir,Aa),Aa};return Ae.cache=new Map,Ae},to=5;function xo(Kt,ge,Ae,sn){Ae=Ae||0,sn=sn||to;for(var xn in ge)if(ge.hasOwnProperty(xn)){var ir=ge[xn];ir!==null&&wt(ir)?(wt(Kt[xn])||(Kt[xn]={}),Ae<sn?xo(Kt[xn],ir,Ae+1,sn):Kt[xn]=ge[xn]):(0,R.Z)(ir)?(Kt[xn]=[],Kt[xn]=Kt[xn].concat(ir)):ir!==void 0&&(Kt[xn]=ir)}}var gs=function(Kt){for(var ge=[],Ae=1;Ae<arguments.length;Ae++)ge[Ae-1]=arguments[Ae];for(var sn=0;sn<ge.length;sn+=1)xo(Kt,ge[sn]);return Kt},vo=gs,ou=function(Kt,ge,Ae,sn){M(ge)||(Ae=ge,ge=Kt,Kt=function(){});var xn=Object.create?function($r,Aa){return Object.create($r,{constructor:{value:Aa}})}:function($r,Aa){function Va(){}Va.prototype=$r;var Ba=new Va;return Ba.constructor=Aa,Ba},ir=xn(ge.prototype,Kt);return Kt.prototype=eu(ir,Kt.prototype),Kt.superclass=xn(ge.prototype,ge),eu(ir,Ae),eu(Kt,sn),Kt},ms=ou,xu=function(Kt,ge){if(!tt(Kt))return-1;var Ae=Array.prototype.indexOf;if(Ae)return Ae.call(Kt,ge);for(var sn=-1,xn=0;xn<Kt.length;xn++)if(Kt[xn]===ge){sn=xn;break}return sn},dl=xu,kl=Object.prototype.hasOwnProperty;function Ks(Kt){if(B(Kt))return!0;if(tt(Kt))return!Kt.length;var ge=us(Kt);if(ge==="Map"||ge==="Set")return!Kt.size;if(Es(Kt))return!Object.keys(Kt).length;for(var Ae in Kt)if(kl.call(Kt,Ae))return!1;return!0}var el=Ks,lu=function(Kt,ge){if(Kt===ge)return!0;if(!Kt||!ge||Pt(Kt)||Pt(ge))return!1;if(tt(Kt)||tt(ge)){if(Kt.length!==ge.length)return!1;for(var Ae=!0,sn=0;sn<Kt.length&&(Ae=lu(Kt[sn],ge[sn]),!!Ae);sn++);return Ae}if(dt(Kt)||dt(ge)){var xn=Object.keys(Kt),ir=Object.keys(ge);if(xn.length!==ir.length)return!1;for(var Ae=!0,sn=0;sn<xn.length&&(Ae=lu(Kt[xn[sn]],ge[xn[sn]]),!!Ae);sn++);return Ae}return!1},Du=lu,pl=function(Kt,ge,Ae){return M(Ae)?!!Ae(Kt,ge):Du(Kt,ge)},ns=function(Kt,ge){if(!tt(Kt))return Kt;for(var Ae=[],sn=0;sn<Kt.length;sn++){var xn=Kt[sn];Ae.push(ge(xn,sn))}return Ae},_s=ns,Bu=function(Kt){return Kt},Au=function(Kt,ge){ge===void 0&&(ge=Bu);var Ae={};return F(Kt)&&!B(Kt)&&Object.keys(Kt).forEach(function(sn){Ae[sn]=ge(Kt[sn],sn)}),Ae},wu=function(Kt,ge,Ae){for(var sn=0,xn=Pt(ge)?ge.split("."):ge;Kt&&sn<xn.length;)Kt=Kt[xn[sn++]];return Kt===void 0||sn<xn.length?Ae:Kt},nu=function(Kt,ge,Ae){var sn=Kt,xn=Pt(ge)?ge.split("."):ge;return xn.forEach(function(ir,$r){$r<xn.length-1?(F(sn[ir])||(sn[ir]=at(xn[$r+1])?[]:{}),sn=sn[ir]):sn[ir]=Ae}),Kt},Tl=Object.prototype.hasOwnProperty,xc=function(Kt,ge){if(Kt===null||!wt(Kt))return{};var Ae={};return O(ge,function(sn){Tl.call(Kt,sn)&&(Ae[sn]=Kt[sn])}),Ae},Sl=function(Kt,ge){return Me(Kt,function(Ae,sn,xn){return ge.includes(xn)||(Ae[xn]=sn),Ae},{})},ol=function(Kt,ge,Ae){var sn,xn,ir,$r,Aa=0;Ae||(Ae={});var Va=function(){Aa=Ae.leading===!1?0:Date.now(),sn=null,$r=Kt.apply(xn,ir),sn||(xn=ir=null)},Ba=function(){var oi=Date.now();!Aa&&Ae.leading===!1&&(Aa=oi);var ro=ge-(oi-Aa);return xn=this,ir=arguments,ro<=0||ro>ge?(sn&&(clearTimeout(sn),sn=null),Aa=oi,$r=Kt.apply(xn,ir),sn||(xn=ir=null)):!sn&&Ae.trailing!==!1&&(sn=setTimeout(Va,ro)),$r};return Ba.cancel=function(){clearTimeout(sn),Aa=0,sn=xn=ir=null},Ba},ys=function(Kt){return tt(Kt)?Array.prototype.slice.call(Kt):[]},vl={},kc=function(Kt){return Kt=Kt||"g",vl[Kt]?vl[Kt]+=1:vl[Kt]=1,Kt+vl[Kt]},Dl=function(){},Ol=function(Kt){return Kt};function _e(Kt){return B(Kt)?0:tt(Kt)?Kt.length:Object.keys(Kt).length}var ve=$(65353),Bt,ae=Co(function(Kt,ge){ge===void 0&&(ge={});var Ae=ge.fontSize,sn=ge.fontFamily,xn=ge.fontWeight,ir=ge.fontStyle,$r=ge.fontVariant;return Bt||(Bt=document.createElement("canvas").getContext("2d")),Bt.font=[ir,$r,xn,Ae+"px",sn].join(" "),Bt.measureText(Pt(Kt)?Kt:"").width},function(Kt,ge){return ge===void 0&&(ge={}),(0,ve.__spreadArrays)([Kt],Bn(ge)).join("")}),me=function(Kt,ge,Ae,sn){sn===void 0&&(sn="...");var xn=16,ir=ae(sn,Ae),$r=Pt(Kt)?Kt:Lr(Kt),Aa=ge,Va=[],Ba,oi;if(ae(Kt,Ae)<=ge)return Kt;for(;Ba=$r.substr(0,xn),oi=ae(Ba,Ae),!(oi+ir>Aa&&oi>Aa);)if(Va.push(Ba),Aa-=oi,$r=$r.substr(xn),!$r)return Va.join("");for(;Ba=$r.substr(0,1),oi=ae(Ba,Ae),!(oi+ir>Aa);)if(Va.push(Ba),Aa-=oi,$r=$r.substr(1),!$r)return Va.join("");return""+Va.join("")+sn},En=function(){function Kt(){this.map={}}return Kt.prototype.has=function(ge){return this.map[ge]!==void 0},Kt.prototype.get=function(ge,Ae){var sn=this.map[ge];return sn===void 0?Ae:sn},Kt.prototype.set=function(ge,Ae){this.map[ge]=Ae},Kt.prototype.clear=function(){this.map={}},Kt.prototype.delete=function(ge){delete this.map[ge]},Kt.prototype.size=function(){return Object.keys(this.map).length},Kt}(),Zn=En},75345:function(sr,it,$){"use strict";var X=$(57371);it.Z=function(tt){return Array.isArray?Array.isArray(tt):(0,X.Z)(tt,"Array")}},57371:function(sr,it){"use strict";var $={}.toString,X=function(tt,j){return $.call(tt)==="[object "+j+"]"};it.Z=X},18045:function(sr,it,$){"use strict";var X;X={value:!0};var tt=$(42563);function j(le){if(le&&le.__esModule)return le;var Le=Object.create(null);return le&&Object.keys(le).forEach(function(Ze){if(Ze!=="default"){var fe=Object.getOwnPropertyDescriptor(le,Ze);Object.defineProperty(Le,Ze,fe.get?fe:{enumerable:!0,get:function(){return le[Ze]}})}}),Le.default=le,Object.freeze(Le)}var W=j(tt);function Q(le,Le){var Ze=Object.keys(le);if(Object.getOwnPropertySymbols){var fe=Object.getOwnPropertySymbols(le);Le&&(fe=fe.filter(function(Re){return Object.getOwnPropertyDescriptor(le,Re).enumerable})),Ze.push.apply(Ze,fe)}return Ze}function Z(le){for(var Le=1;Le<arguments.length;Le++){var Ze=arguments[Le]!=null?arguments[Le]:{};Le%2?Q(Object(Ze),!0).forEach(function(fe){B(le,fe,Ze[fe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(le,Object.getOwnPropertyDescriptors(Ze)):Q(Object(Ze)).forEach(function(fe){Object.defineProperty(le,fe,Object.getOwnPropertyDescriptor(Ze,fe))})}return le}function L(le,Le,Ze,fe,Re,He,pe){try{var Ge=le[He](pe),te=Ge.value}catch(Me){Ze(Me);return}Ge.done?Le(te):Promise.resolve(te).then(fe,Re)}function P(le){return function(){var Le=this,Ze=arguments;return new Promise(function(fe,Re){var He=le.apply(Le,Ze);function pe(te){L(He,fe,Re,pe,Ge,"next",te)}function Ge(te){L(He,fe,Re,pe,Ge,"throw",te)}pe(void 0)})}}function C(le,Le){if(!(le instanceof Le))throw new TypeError("Cannot call a class as a function")}function M(le,Le){for(var Ze=0;Ze<Le.length;Ze++){var fe=Le[Ze];fe.enumerable=fe.enumerable||!1,fe.configurable=!0,"value"in fe&&(fe.writable=!0),Object.defineProperty(le,fe.key,fe)}}function k(le,Le,Ze){return Le&&M(le.prototype,Le),Ze&&M(le,Ze),le}function B(le,Le,Ze){return Le in le?Object.defineProperty(le,Le,{value:Ze,enumerable:!0,configurable:!0,writable:!0}):le[Le]=Ze,le}function R(le,Le){if(typeof Le!="function"&&Le!==null)throw new TypeError("Super expression must either be null or a function");le.prototype=Object.create(Le&&Le.prototype,{constructor:{value:le,writable:!0,configurable:!0}}),Le&&K(le,Le)}function F(le){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(Ze){return Ze.__proto__||Object.getPrototypeOf(Ze)},F(le)}function K(le,Le){return K=Object.setPrototypeOf||function(fe,Re){return fe.__proto__=Re,fe},K(le,Le)}function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(le){return!1}}function _(le){if(le===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return le}function ft(le,Le){return Le&&(typeof Le=="object"||typeof Le=="function")?Le:_(le)}function mt(le){var Le=O();return function(){var fe=F(le),Re;if(Le){var He=F(this).constructor;Re=Reflect.construct(fe,arguments,He)}else Re=fe.apply(this,arguments);return ft(this,Re)}}function st(le,Le){for(;!Object.prototype.hasOwnProperty.call(le,Le)&&(le=F(le),le!==null););return le}function ut(le,Le,Ze){return typeof Reflect!="undefined"&&Reflect.get?ut=Reflect.get:ut=function(Re,He,pe){var Ge=st(Re,He);if(!!Ge){var te=Object.getOwnPropertyDescriptor(Ge,He);return te.get?te.get.call(pe):te.value}},ut(le,Le,Ze||le)}function dt(le){return gt(le)||wt(le)||ot(le)||Nt()}function gt(le){if(Array.isArray(le))return pt(le)}function wt(le){if(typeof Symbol!="undefined"&&le[Symbol.iterator]!=null||le["@@iterator"]!=null)return Array.from(le)}function ot(le,Le){if(!!le){if(typeof le=="string")return pt(le,Le);var Ze=Object.prototype.toString.call(le).slice(8,-1);if(Ze==="Object"&&le.constructor&&(Ze=le.constructor.name),Ze==="Map"||Ze==="Set")return Array.from(le);if(Ze==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ze))return pt(le,Le)}}function pt(le,Le){(Le==null||Le>le.length)&&(Le=le.length);for(var Ze=0,fe=new Array(Le);Ze<Le;Ze++)fe[Ze]=le[Ze];return fe}function Nt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Gt=function(le){R(Ze,le);var Le=mt(Ze);function Ze(fe){var Re;return C(this,Ze),Re=Le.call(this,fe),Object.keys(fe).forEach(function(He){Re[He]=fe[He]}),Re.useBias=!0,Re.biasInitializer=tt.initializers.zeros(),Re.biasRegularizer=null,Re}return k(Ze,[{key:"computeOutputShape",value:function(){return[null,this.units]}},{key:"build",value:function(){ut(F(Ze.prototype),"build",this).call(this),this.kernel=this.addWeight("kernel",[this.inputDim,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0):this.bias=null,this.built=!0}},{key:"call",value:function(Re){var He=this;return tt.tidy(function(){var pe=Re[0].shape,Ge=pe[0]===1&&Re[0].squeeze([0])||Re[0],te=Re[1].squeeze([0]),Me=tt.dot(te,Ge);if(Me=tt.dot(Me,He.kernel.read()),He.bias&&(Me=Me.add(He.bias.read())),typeof He.activation=="string"){var We=W[He.activation];return He.activation==="primary"&&(We=function(Pt){return Pt}),We(Me)}return He.activation(Me)})}},{key:"getConfig",value:function(){var Re=ut(F(Ze.prototype),"getConfig",this).call(this),He={units:this.units,support:this.support,activation:this.activation,useBias:this.useBias,inputDim:this.inputDim,kernelInitializer:this.kernelInitializer,biasInitializer:this.biasInitializer,kernelRegularizer:this.kernelRegularizer,biasRegularizer:this.biasRegularizer,activityRegularizer:this.activityRegularizer,kernelConstraint:this.kernelConstraint,biasConstraint:this.biasConstraint};return Z(Z({},Re),He)}}]),Ze}(tt.layers.Layer);Gt.className="GraphConvLayer",tt.serialization.registerClass(Gt);var se=function(le){R(Ze,le);var Le=mt(Ze);function Ze(){return C(this,Ze),Le.apply(this,arguments)}return k(Ze,[{key:"computeOutputShape",value:function(Re){return[1,4]}},{key:"call",value:function(Re){return tt.tidy(function(){for(var He=Re[0].shape[0],pe=[],Ge=0;Ge<He;Ge++)pe.push(1/He);var te=tt.tensor2d([pe]),Me=tt.dot(te,Re[0]);return tt.softmax(Me)})}}]),Ze}(tt.layers.Layer);se.className="GraphPoolingLayer",tt.serialization.registerClass(se);var ie=function(Le,Ze,fe){for(var Re={},He=Le.length,pe=new Array(He),Ge=new Array(He),te=0;te<pe.length;te++)pe[te]=new Array(He).fill(0);for(var Me=0;Me<Ge.length;Me++)Ge[Me]=new Array(fe).fill(0);for(var We=0;We<pe.length;We++)for(var ee=0;ee<pe.length;ee++)We===ee&&(pe[We][ee]=1);Le.forEach(function(Rt,Yn){Re[Rt.id]=Yn;for(var Un=Ze.filter(function(Ur){return Ur.from===Rt.id}).length,xr=Ze.filter(function(Ur){return Ur.to===Rt.id}).length,cr=0;cr<fe;cr++)Ge[Yn][cr]=(Un+xr)/fe}),Ze.forEach(function(Rt){var Yn=Rt.to,Un=Rt.from,xr=Re[Yn],cr=Re[Un];xr===void 0||cr===void 0||(pe[cr][xr]=1,pe[xr][cr]=1)});var Pt=tt.tensor2d(pe),yt=tt.tensor2d(Ge),Ne=tt.diag(tt.pow(Pt.sum(1),tt.tensor(-.5)).flatten(),0),tn=Pt.dot(Ne).transpose().dot(Ne),fn=yt.div(yt.sum(1).reshape([-1,1]).clipByValue(1e-8,Infinity));return[fn.expandDims(0),tn.expandDims(0)]},Be=function(Le){var Ze=Le.nodes,fe=Ze===void 0?[]:Ze,Re=Le.edges,He=Re===void 0?[]:Re,pe=[],Ge=[];return fe.forEach(function(te){pe.push({id:String(te.id)})}),He.forEach(function(te){Ge.push({from:String(te.source||te.from),to:String(te.target||te.to)})}),{nodes:pe,edges:Ge}},ke=function(Le,Ze,fe){console.log("%c@antv/vis-predict-engine\u56FE\u5E03\u5C40\u9884\u6D4B","color: #99CCCC;font-size: 16px;"),fe&&console.log("%c\u671F\u671B\u5E03\u5C40","background: #FFCC99;color:#fff;padding:5px;border-radius:5px;",fe),console.log("%c\u9884\u6D4B\u5E03\u5C40","background: #CCCCFF;color: #fff;padding:5px;border-radius:5px;",Le),console.log("%c\u7F6E\u4FE1\u5EA6","background: #FF9966;color: #fff;padding:5px;border-radius:5px;",Ze)},we=["force","radial","concentric","circular"],At=null,Yt=function(){var le=P(regeneratorRuntime.mark(function Le(){return regeneratorRuntime.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:if(At){fe.next=3;break}return fe.next=3,tt.loadLayersModel("https://gw.alipayobjects.com/os/bmw-prod/c86b2dbb-ed03-421d-b080-2aad75cf4d47.json").then(function(Re){At=Re});case 3:return fe.abrupt("return",At);case 4:case"end":return fe.stop()}},Le)}));return function(){return le.apply(this,arguments)}}(),be=function(){var le=P(regeneratorRuntime.mark(function Le(){var Ze;return regeneratorRuntime.wrap(function(Re){for(;;)switch(Re.prev=Re.next){case 0:return Re.next=2,Yt();case 2:return Ze=Re.sent,Re.abrupt("return",Ze);case 4:case"end":return Re.stop()}},Le)}));return function(){return le.apply(this,arguments)}}(),nn=function(){var le=P(regeneratorRuntime.mark(function Le(Ze){var fe;return regeneratorRuntime.wrap(function(He){for(;;)switch(He.prev=He.next){case 0:if(Ze.nodes.length!==1){He.next=2;break}return He.abrupt("return",[0,0,0,1]);case 2:return fe=ie(Ze.nodes,Ze.edges,32),He.next=5,At.predict(fe).data();case 5:return He.abrupt("return",He.sent);case 6:case"end":return He.stop()}},Le)}));return function(Ze){return le.apply(this,arguments)}}(),Ee={predict:function(Le,Ze,fe){return P(regeneratorRuntime.mark(function Re(){var He,pe,Ge,te;return regeneratorRuntime.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return He=Be(Le),We.next=3,be();case 3:if(!(Array.isArray(Le==null?void 0:Le.nodes)&&(Le==null?void 0:Le.nodes.length)>0)){We.next=11;break}return We.next=6,nn(He);case 6:return pe=We.sent,Ge=we[pe.indexOf(Math.max.apply(Math,dt(pe)))],te="".concat((Math.max.apply(Math,dt(pe))*100).toFixed(2),"%"),fe&&ke(Ge,te,Ze),We.abrupt("return",{predictLayout:Ge,confidence:te});case 11:return We.abrupt("return",{});case 12:case"end":return We.stop()}},Re)}))()}};it.n=Ee},87757:function(sr,it,$){var X=$(59591)();sr.exports=X;try{regeneratorRuntime=X}catch(tt){typeof globalThis=="object"?globalThis.regeneratorRuntime=X:Function("r","regeneratorRuntime = r")(X)}},42563:function(sr,it,$){"use strict";$.r(it),$.d(it,{Abs:function(){return La},Acos:function(){return ha},Acosh:function(){return _i},AdadeltaOptimizer:function(){return ml},AdagradOptimizer:function(){return Vl},AdamOptimizer:function(){return ll},AdamaxOptimizer:function(){return Nn},Add:function(){return Ni},AddN:function(){return vi},All:function(){return si},Any:function(){return Mi},ArgMax:function(){return Pa},ArgMin:function(){return un},Asin:function(){return Oe},Asinh:function(){return hn},Atan:function(){return Hn},Atan2:function(){return Jn},Atanh:function(){return Bn},AvgPool:function(){return Lr},AvgPool3D:function(){return Fa},AvgPool3DGrad:function(){return ui},AvgPoolGrad:function(){return ya},BatchMatMul:function(){return Ei},BatchToSpaceND:function(){return oo},Bincount:function(){return po},BroadcastTo:function(){return bo},Callback:function(){return UM},CallbackList:function(){return Dt},Cast:function(){return ts},Ceil:function(){return Wo},ClipByValue:function(){return Yi},Complex:function(){return wi},ComplexAbs:function(){return gi},Concat:function(){return us},Conv2D:function(){return Do},Conv2DBackpropFilter:function(){return Io},Conv2DBackpropInput:function(){return zs},Conv3D:function(){return mu},Conv3DBackpropFilterV2:function(){return ds},Conv3DBackpropInputV2:function(){return Ms},Cos:function(){return yu},Cosh:function(){return uu},CropAndResize:function(){return qo},Cumsum:function(){return Cs},CustomCallback:function(){return Ie},DataStorage:function(){return Re},DenseBincount:function(){return Wi},DepthToSpace:function(){return ls},DepthwiseConv2dNative:function(){return is},DepthwiseConv2dNativeBackpropFilter:function(){return Es},DepthwiseConv2dNativeBackpropInput:function(){return tl},Diag:function(){return bu},Dilation2D:function(){return Ys},Dilation2DBackpropFilter:function(){return Ku},Dilation2DBackpropInput:function(){return ka},ENV:function(){return qn},EarlyStopping:function(){return VM},Elu:function(){return Ro},EluGrad:function(){return Ns},Environment:function(){return Ht},Equal:function(){return eu},Erf:function(){return tu},Exp:function(){return Zu},ExpandDims:function(){return bn},Expm1:function(){return Xr},FFT:function(){return pa},Fill:function(){return Ra},FlipLeftRight:function(){return Qi},Floor:function(){return Co},FloorDiv:function(){return to},FromPixels:function(){return Uu},FusedBatchNorm:function(){return xo},FusedConv2D:function(){return al},FusedDepthwiseConv2D:function(){return Vu},GatherNd:function(){return vo},GatherV2:function(){return gs},GraphModel:function(){return rN},Greater:function(){return ou},GreaterEqual:function(){return ms},History:function(){return Qt},IFFT:function(){return dl},Identity:function(){return xu},Imag:function(){return kl},InputSpec:function(){return e},IsFinite:function(){return Ks},IsInf:function(){return el},IsNan:function(){return lu},KernelBackend:function(){return He},LRN:function(){return Sl},LRNGrad:function(){return ol},LayerVariable:function(){return mv},LayersModel:function(){return Jg},LeakyRelu:function(){return Du},Less:function(){return pl},LessEqual:function(){return ns},LinSpace:function(){return _s},Log:function(){return Bu},Log1p:function(){return Au},LogSoftmax:function(){return xc},LogicalAnd:function(){return wu},LogicalNot:function(){return nu},LogicalOr:function(){return Tl},Max:function(){return ys},MaxPool:function(){return kc},MaxPool3D:function(){return Ol},MaxPool3DGrad:function(){return _e},MaxPoolGrad:function(){return Dl},MaxPoolWithArgmax:function(){return ve},Maximum:function(){return vl},Mean:function(){return Bt},Min:function(){return ae},Minimum:function(){return me},MirrorPad:function(){return En},Mod:function(){return Zn},MomentumOptimizer:function(){return fr},Multinomial:function(){return Kt},Multiply:function(){return ge},Neg:function(){return Ae},NonMaxSuppressionV3:function(){return xn},NonMaxSuppressionV4:function(){return ir},NonMaxSuppressionV5:function(){return $r},NotEqual:function(){return sn},OP_SCOPE_SUFFIX:function(){return ld},OneHot:function(){return Va},OnesLike:function(){return Aa},Optimizer:function(){return ul},Pack:function(){return Ba},PadV2:function(){return oi},Pool:function(){return ro},Pow:function(){return Di},Prelu:function(){return Si},Prod:function(){return _o},RMSPropOptimizer:function(){return Pr},RNN:function(){return Jv},Range:function(){return To},Rank:function(){return xi},Real:function(){return wo},RealDiv:function(){return Vs},Reciprocal:function(){return Vo},Reduction:function(){return qf},Relu:function(){return js},Relu6:function(){return Cl},Reshape:function(){return ws},ResizeBilinear:function(){return Mu},ResizeBilinearGrad:function(){return nl},ResizeNearestNeighbor:function(){return ks},ResizeNearestNeighborGrad:function(){return Hs},Reverse:function(){return Yl},RotateWithOffset:function(){return Qu},Round:function(){return sl},Rsqrt:function(){return rl},SGDOptimizer:function(){return ln},ScatterNd:function(){return _f},Select:function(){return Dc},Selu:function(){return wc},Sequential:function(){return z0},Sigmoid:function(){return de},Sign:function(){return Zt},Sin:function(){return A},Sinh:function(){return nt},Slice:function(){return ef},Softmax:function(){return De},Softplus:function(){return Pe},SpaceToBatchND:function(){return wn},SparseToDense:function(){return ua},SplitV:function(){return kn},Sqrt:function(){return Qe},Square:function(){return ca},SquaredDifference:function(){return wr},Step:function(){return zu},StridedSlice:function(){return $a},Sub:function(){return Ar},Sum:function(){return rn},SymbolicTensor:function(){return i},Tan:function(){return ri},Tanh:function(){return ba},Tensor:function(){return Dn},TensorBuffer:function(){return ne},Tile:function(){return ki},TopK:function(){return Eo},Transpose:function(){return Lo},Unique:function(){return Bo},Unpack:function(){return go},UnsortedSegmentSum:function(){return Ao},Variable:function(){return Ga},ZerosLike:function(){return qu},_FusedMatMul:function(){return Wu},abs:function(){return bl},acos:function(){return mr},acosh:function(){return Mr},add:function(){return An},addN:function(){return ur},addStrict:function(){return hg},all:function(){return Dr},any:function(){return _a},argMax:function(){return ga},argMin:function(){return uo},asin:function(){return Hi},asinh:function(){return No},atan:function(){return xl},atan2:function(){return Rv},atanh:function(){return Tg},avgPool:function(){return D},avgPool3d:function(){return lt},backend:function(){return gn},backend_util:function(){return F},basicLSTMCell:function(){return en},batchNorm:function(){return Sr},batchNorm2d:function(){return pr},batchNorm3d:function(){return Er},batchNorm4d:function(){return Gr},batchToSpaceND:function(){return Rn},bincount:function(){return va},booleanMaskAsync:function(){return CA},broadcastTo:function(){return Ja},browser:function(){return Z},buffer:function(){return vs},callbacks:function(){return KR},cast:function(){return eo},ceil:function(){return Zi},clipByValue:function(){return li},clone:function(){return _h},complex:function(){return Rc},concat:function(){return _t},concat1d:function(){return ao},concat2d:function(){return Oo},concat3d:function(){return mo},concat4d:function(){return fs},constraints:function(){return O},conv1d:function(){return Ho},conv2d:function(){return qs},conv2dTranspose:function(){return _u},conv3d:function(){return yl},conv3dTranspose:function(){return fh},copyRegisteredKernels:function(){return sd},cos:function(){return lc},cosh:function(){return Jh},cosineWindow:function(){return sb},cumsum:function(){return Mg},customGrad:function(){return Eu},data:function(){return le},denseBincount:function(){return um},deprecationWarn:function(){return na},depthToSpace:function(){return ig},depthwiseConv2d:function(){return Qd},deregisterOp:function(){return qR},device_util:function(){return j},diag:function(){return N1},dilation2d:function(){return cm},disableDeprecationWarnings:function(){return aa},dispose:function(){return N},disposeVariables:function(){return Xa},div:function(){return rr},divNoNan:function(){return Xm},divStrict:function(){return p0},dot:function(){return Dx},dropout:function(){return mw},elu:function(){return fm},enableDebugMode:function(){return da},enableProdMode:function(){return ia},enclosingPowerOfTwo:function(){return yw},engine:function(){return Oa},env:function(){return Ve},equal:function(){return Hu},equalStrict:function(){return O2},erf:function(){return k1},exp:function(){return Kf},expandDims:function(){return wd},expm1:function(){return Km},eye:function(){return dm},fft:function(){return l0},fill:function(){return Jo},findBackend:function(){return he},findBackendFactory:function(){return Te},floor:function(){return pm},floorDiv:function(){return Or},fused:function(){return B},gather:function(){return Fv},gatherND:function(){return gw},gather_util:function(){return L},getBackend:function(){return Xt},getGradient:function(){return Ec},getKernel:function(){return pf},getKernelsForBackend:function(){return Ou},grad:function(){return Lu},grads:function(){return as},greater:function(){return Ed},greaterEqual:function(){return Jd},greaterEqualStrict:function(){return R2},greaterStrict:function(){return L2},ifft:function(){return Og},imag:function(){return Q0},image:function(){return ep},inTopKAsync:function(){return Cm},initializers:function(){return _},input:function(){return uM},io:function(){return W},irfft:function(){return vy},isFinite:function(){return Fx},isInf:function(){return R1},isNaN:function(){return Bv},keep:function(){return q},kernel_impls:function(){return K},layers:function(){return ft},leakyRelu:function(){return vm},less:function(){return Zm},lessEqual:function(){return og},lessEqualStrict:function(){return P2},lessStrict:function(){return F2},linalg:function(){return Rw},linspace:function(){return L1},loadGraphModel:function(){return qL},loadLayersModel:function(){return uO},localResponseNormalization:function(){return J0},log:function(){return Oh},log1p:function(){return qm},logSigmoid:function(){return sg},logSoftmax:function(){return ty},logSumExp:function(){return ny},logicalAnd:function(){return Rh},logicalNot:function(){return kg},logicalOr:function(){return Jm},logicalXor:function(){return ug},losses:function(){return OC},matMul:function(){return Zs},math:function(){return Q},max:function(){return Sd},maxPool:function(){return Dg},maxPool3d:function(){return lg},maxPoolWithArgmax:function(){return Vx},maximum:function(){return Po},maximumStrict:function(){return sw},mean:function(){return cc},memory:function(){return Qa},metrics:function(){return mt},min:function(){return ym},minimum:function(){return cg},minimumStrict:function(){return uw},mirrorPad:function(){return U1},mod:function(){return iy},modStrict:function(){return lw},model:function(){return oO},models:function(){return st},moments:function(){return oy},movingAverage:function(){return j2},mul:function(){return Xn},mulStrict:function(){return cw},multiRNNCell:function(){return RS},multinomial:function(){return t0},neg:function(){return Ic},nextFrame:function(){return x0},norm:function(){return xy},notEqual:function(){return fg},notEqualStrict:function(){return B2},oneHot:function(){return Df},ones:function(){return sv},onesLike:function(){return Zc},op:function(){return br},outerProduct:function(){return zS},pad:function(){return $v},pad1d:function(){return Xx},pad2d:function(){return W1},pad3d:function(){return Yx},pad4d:function(){return VS},pool:function(){return Zx},pow:function(){return co},powStrict:function(){return pu},prelu:function(){return bm},print:function(){return dd},prod:function(){return uy},profile:function(){return Ka},rand:function(){return KS},randomGamma:function(){return Gv},randomNormal:function(){return ly},randomUniform:function(){return r0},range:function(){return Lh},ready:function(){return Ft},real:function(){return wm},reciprocal:function(){return X1},registerBackend:function(){return Ye},registerCallbackConstructor:function(){return lO},registerGradient:function(){return Wh},registerKernel:function(){return Uc},registerOp:function(){return ZR},regularizers:function(){return ut},relu:function(){return td},relu6:function(){return i0},removeBackend:function(){return oe},reshape:function(){return b},reverse:function(){return Ph},reverse1d:function(){return tp},reverse2d:function(){return r2},reverse3d:function(){return i2},reverse4d:function(){return s2},rfft:function(){return c0},round:function(){return Y1},rsqrt:function(){return cy},scalar:function(){return zi},scatterND:function(){return pw},scatter_util:function(){return P},selu:function(){return o0},separableConv2d:function(){return K1},sequential:function(){return sO},serialization:function(){return M},setBackend:function(){return It},setPlatform:function(){return cn},setdiff1dAsync:function(){return nw},sigmoid:function(){return qt},sign:function(){return Z1},signal:function(){return qc},sin:function(){return hy},sinh:function(){return dy},slice:function(){return Ut},slice1d:function(){return q1},slice2d:function(){return Q1},slice3d:function(){return py},slice4d:function(){return s0},slice_util:function(){return C},softmax:function(){return u0},softplus:function(){return gm},spaceToBatchND:function(){return n0},sparseToDense:function(){return ob},spectral:function(){return DC},split:function(){return ed},sqrt:function(){return Ti},square:function(){return Ai},squaredDifference:function(){return f0},squaredDifferenceStrict:function(){return fw},squeeze:function(){return Uv},stack:function(){return nd},step:function(){return Em},stridedSlice:function(){return J1},sub:function(){return pi},subStrict:function(){return v0},sum:function(){return ss},sumOutType:function(){return jo},tan:function(){return tb},tanh:function(){return Ce},tensor:function(){return Vc},tensor1d:function(){return Ff},tensor2d:function(){return Sm},tensor3d:function(){return qp},tensor4d:function(){return N2},tensor5d:function(){return h0},tensor6d:function(){return gy},tensor_util:function(){return tt},test_util:function(){return k},tidy:function(){return zn},tile:function(){return Pv},time:function(){return ht},topk:function(){return yy},train:function(){return zg},transpose:function(){return cu},truncatedNormal:function(){return by},unique:function(){return d0},unregisterGradient:function(){return $p},unregisterKernel:function(){return pp},unsortedSegmentSum:function(){return eb},unstack:function(){return Cd},upcastType:function(){return so},util:function(){return X},valueAndGrad:function(){return gl},valueAndGrads:function(){return fu},variable:function(){return nb},variableGrads:function(){return Rs},version:function(){return H9},version_converter:function(){return aN},version_core:function(){return er},version_layers:function(){return Qg},where:function(){return Lf},whereAsync:function(){return Bf},zeros:function(){return Tc},zerosLike:function(){return bi}});var X={};$.r(X),$.d(X,{arraysEqual:function(){return Un},assert:function(){return yt},assertNonNegativeIntegerDimensions:function(){return H},assertNonNull:function(){return tn},assertShapesMatch:function(){return Ne},bytesFromStringArray:function(){return lr},bytesPerElement:function(){return Ea},checkConversionForErrors:function(){return tr},clamp:function(){return te},computeStrides:function(){return vt},createScalarValue:function(){return rf},createShuffledIndices:function(){return fa},decodeString:function(){return Ot},distSquared:function(){return Pt},encodeString:function(){return oc},fetch:function(){return mh},flatten:function(){return fn},getArrayFromDType:function(){return Fn},getTypedArrayFromDType:function(){return ar},hasEncodingLoss:function(){return jr},indexToLoc:function(){return bt},inferDtype:function(){return ta},inferFromImplicitShape:function(){return Da},isBoolean:function(){return vr},isFunction:function(){return ra},isInt:function(){return xr},isNumber:function(){return Tr},isPromise:function(){return $t},isScalarShape:function(){return Yn},isString:function(){return Cr},isTypedArray:function(){return Hr},isValidDtype:function(){return Gn},locToIndex:function(){return Y},makeOnesTypedArray:function(){return Lt},makeZerosNestedTypedArray:function(){return at},makeZerosTypedArray:function(){return kt},nearestDivisor:function(){return Zr},nearestLargerEven:function(){return Me},now:function(){return ic},parseAxisParam:function(){return Rr},randUniform:function(){return ee},repeatedTry:function(){return sa},rightPad:function(){return Sa},shuffle:function(){return Ge},sizeFromShape:function(){return Rt},sizeToSquarishShape:function(){return Ur},squeezeShape:function(){return Mn},sum:function(){return We},tanh:function(){return cr},toNestedArray:function(){return an},toTypedArray:function(){return Nu}});var tt={};$.r(tt),$.d(tt,{assertTypesMatch:function(){return os},getTensorsInContainer:function(){return Xi},isTensorInList:function(){return zo},makeTypesMatch:function(){return Ci}});var j={};$.r(j),$.d(j,{isBrowser:function(){return sc},isMobile:function(){return Tf}});var W={};$.r(W),$.d(W,{browserFiles:function(){return Zp},browserHTTPRequest:function(){return Mh},concatenateArrayBuffers:function(){return vf},copyModel:function(){return hd},decodeWeights:function(){return yh},encodeWeights:function(){return Rl},fromMemory:function(){return Nh},getLoadHandlers:function(){return Fd},getModelArtifactsInfoForJSON:function(){return gf},getSaveHandlers:function(){return Xh},http:function(){return Xd},isHTTPScheme:function(){return Hd},listModels:function(){return fd},loadWeights:function(){return Vd},moveModel:function(){return jp},registerLoadRouter:function(){return Up},registerSaveRouter:function(){return rh},removeModel:function(){return Vp},weightsLoaderFactory:function(){return pd},withSaveHandler:function(){return Sp}});var Q={};$.r(Q),$.d(Q,{confusionMatrix:function(){return Tv}});var Z={};$.r(Z),$.d(Z,{fromPixels:function(){return qh},toPixels:function(){return Av}});var L={};$.r(L),$.d(L,{prepareAndValidate:function(){return Jp}});var P={};$.r(P),$.d(P,{calculateShapes:function(){return Bl},validateInput:function(){return Nv},validateUpdateShape:function(){return Mv}});var C={};$.r(C),$.d(C,{assertParamsValid:function(){return gd},computeFlatOffset:function(){return ev},computeOutShape:function(){return kh},getNormalizedAxes:function(){return tv},isSliceContinous:function(){return Dv},maskToAxes:function(){return Of},parseSliceParams:function(){return Zd},sliceInfo:function(){return nv},startForAxis:function(){return vc},startIndicesWithElidedDims:function(){return Bc},stopForAxis:function(){return yd},stopIndicesWithElidedDims:function(){return Vf},stridesForAxis:function(){return zl},stridesWithElidedDims:function(){return kv}});var M={};$.r(M),$.d(M,{Serializable:function(){return Dh},SerializationMap:function(){return lf},registerClass:function(){return ci}});var k={};$.r(k),$.d(k,{TEST_EPSILON_FLOAT16:function(){return av},encodeStrings:function(){return vn},expectArrayBuffersEqual:function(){return ce},expectArraysClose:function(){return rg},expectArraysEqual:function(){return ag},expectNumbersClose:function(){return Ov},expectPromiseToFail:function(){return jf},expectValuesInRange:function(){return Zl},testEpsilon:function(){return qd}});var B={};$.r(B),$.d(B,{conv2d:function(){return lb},depthwiseConv2d:function(){return fb},matMul:function(){return _m}});var R={};$.r(R),$.d(R,{collectGatherOpShapeInfo:function(){return Oy},computeOutShape:function(){return Ib},segOpComputeOptimalWindowSize:function(){return Kv}});var F={};$.r(F),$.d(F,{ERF_A1:function(){return ky},ERF_A2:function(){return wb},ERF_A3:function(){return rp},ERF_A4:function(){return Eb},ERF_A5:function(){return S0},ERF_P:function(){return xb},PARALLELIZE_THRESHOLD:function(){return w0},SELU_SCALE:function(){return Ny},SELU_SCALEALPHA:function(){return My},applyActivation:function(){return Ey},assertAndGetBroadcastShape:function(){return Nr},assertAxesAreInnerMostDims:function(){return Pf},assertParamsConsistent:function(){return Ay},assignToTypedArray:function(){return Am},axesAreInnerMostDims:function(){return ey},calculateShapes:function(){return Bl},castTensor:function(){return LC},combineLocations:function(){return P1},complexWithEvenIndex:function(){return Yv},complexWithOddIndex:function(){return Lw},computeConv2DInfo:function(){return ql},computeConv3DInfo:function(){return _p},computeDefaultPad:function(){return Ag},computeDilation2DInfo:function(){return Kc},computeOptimalWindowSize:function(){return Ap},computeOutAndReduceShapes:function(){return yf},computeOutShape:function(){return jv},computePool2DInfo:function(){return Rf},computePool3DInfo:function(){return bd},convertConv2DDataFormat:function(){return m},eitherStridesOrDilationsAreOne:function(){return _c},expandShapeToKeepDim:function(){return zc},exponent:function(){return _b},exponents:function(){return Cb},fromStringArrayToUint8:function(){return I0},fromUint8ToStringArray:function(){return _0},getAxesPermutation:function(){return $c},getBroadcastDims:function(){return Wn},getComplexWithIndex:function(){return Sb},getFusedBiasGradient:function(){return Lg},getFusedDyActivation:function(){return g0},getImageCenter:function(){return np},getInnerMostAxes:function(){return gc},getPermuted:function(){return Im},getReductionAxes:function(){return Jr},getReshaped:function(){return E0},getReshapedPermuted:function(){return Hv},getSliceBeginCoords:function(){return yb},getSliceSize:function(){return bb},getUndoAxesPermutation:function(){return mm},log:function(){return C0},mergeRealAndImagArrays:function(){return cv},prepareAndValidate:function(){return Jp},prepareSplitSize:function(){return Dy},reshapeTensor:function(){return PC},segment_util:function(){return R},shouldFuse:function(){return Sy},slice_util:function(){return C},splitRealAndImagArrays:function(){return Xv},tupleValuesAreOne:function(){return iv},upcastType:function(){return so},validateInput:function(){return Nv},validateUpdateShape:function(){return Mv},warn:function(){return Tm}});var K={};$.r(K),$.d(K,{nonMaxSuppressionV3Impl:function(){return Cy},nonMaxSuppressionV4Impl:function(){return Pg},nonMaxSuppressionV5Impl:function(){return _y},whereImpl:function(){return Rg}});var O={};$.r(O),$.d(O,{maxNorm:function(){return pE},minMaxNorm:function(){return Y_},nonNeg:function(){return X_},unitNorm:function(){return vE}});var _={};$.r(_),$.d(_,{constant:function(){return TE},glorotNormal:function(){return mI},glorotUniform:function(){return gI},heNormal:function(){return yI},heUniform:function(){return ME},identity:function(){return vI},leCunNormal:function(){return bI},leCunUniform:function(){return NE},ones:function(){return fI},orthogonal:function(){return xI},randomNormal:function(){return dI},randomUniform:function(){return hI},truncatedNormal:function(){return pI},varianceScaling:function(){return AE},zeros:function(){return cI}});var ft={};$.r(ft),$.d(ft,{Layer:function(){return d},RNN:function(){return Jv},RNNCell:function(){return lx},activation:function(){return PO},add:function(){return jO},alphaDropout:function(){return AR},average:function(){return HO},averagePooling1d:function(){return IT},averagePooling2d:function(){return TT},averagePooling3d:function(){return AT},avgPool1d:function(){return eR},avgPool2d:function(){return rR},avgPool3d:function(){return iR},avgPooling1d:function(){return nR},avgPooling2d:function(){return aR},avgPooling3d:function(){return oR},batchNormalization:function(){return QO},bidirectional:function(){return xR},concatenate:function(){return XO},conv1d:function(){return AO},conv2d:function(){return MO},conv2dTranspose:function(){return NO},conv3d:function(){return kO},convLstm2d:function(){return gR},convLstm2dCell:function(){return mR},cropping2D:function(){return OO},dense:function(){return FO},depthwiseConv2d:function(){return LO},dot:function(){return qO},dropout:function(){return BO},elu:function(){return EO},embedding:function(){return VO},flatten:function(){return $O},gaussianDropout:function(){return TR},gaussianNoise:function(){return IR},globalAveragePooling1d:function(){return sR},globalAveragePooling2d:function(){return uR},globalMaxPool1d:function(){return ER},globalMaxPool2d:function(){return SR},globalMaxPooling1d:function(){return BM},globalMaxPooling2d:function(){return zM},gru:function(){return cR},gruCell:function(){return fR},input:function(){return uM},inputLayer:function(){return wO},layerNormalization:function(){return JO},leakyReLU:function(){return CO},lstm:function(){return hR},lstmCell:function(){return dR},masking:function(){return MR},maxPool1d:function(){return CR},maxPool2d:function(){return _R},maxPooling1d:function(){return $M},maxPooling2d:function(){return GM},maxPooling3d:function(){return lR},maximum:function(){return YO},minimum:function(){return KO},multiply:function(){return ZO},permute:function(){return WO},prelu:function(){return _O},reLU:function(){return SO},repeatVector:function(){return GO},reshape:function(){return UO},rnn:function(){return yR},separableConv2d:function(){return DO},simpleRNN:function(){return pR},simpleRNNCell:function(){return vR},softmax:function(){return IO},spatialDropout1d:function(){return zO},stackedRNNCells:function(){return bR},thresholdedReLU:function(){return TO},timeDistributed:function(){return wR},upSampling2d:function(){return RO},zeroPadding2d:function(){return tR}});var mt={};$.r(mt),$.d(mt,{MAPE:function(){return $R},MSE:function(){return WR},binaryAccuracy:function(){return NR},binaryCrossentropy:function(){return kR},categoricalAccuracy:function(){return OR},categoricalCrossentropy:function(){return RR},cosineProximity:function(){return FR},mape:function(){return GR},meanAbsoluteError:function(){return BR},meanAbsolutePercentageError:function(){return zR},meanSquaredError:function(){return UR},mse:function(){return VR},precision:function(){return LR},recall:function(){return PR},sparseCategoricalAccuracy:function(){return DR}});var st={};$.r(st),$.d(st,{modelFromJSON:function(){return nO}});var ut={};$.r(ut),$.d(ut,{l1:function(){return HR},l1l2:function(){return jR},l2:function(){return XR}});var dt={};$.r(dt),$.d(dt,{json:function(){return JR}});var gt={};$.r(gt),$.d(gt,{json:function(){return tL}});var wt={};$.r(wt),$.d(wt,{json:function(){return eL}});var ot={};$.r(ot),$.d(ot,{json:function(){return nL}});var pt={};$.r(pt),$.d(pt,{json:function(){return rL}});var Nt={};$.r(Nt),$.d(Nt,{json:function(){return aL}});var Gt={};$.r(Gt),$.d(Gt,{json:function(){return iL}});var se={};$.r(se),$.d(se,{json:function(){return oL}});var ie={};$.r(ie),$.d(ie,{json:function(){return sL}});var Be={};$.r(Be),$.d(Be,{json:function(){return uL}});var ke={};$.r(ke),$.d(ke,{json:function(){return lL}});var we={};$.r(we),$.d(we,{json:function(){return cL}});var At={};$.r(At),$.d(At,{json:function(){return fL}});var Yt={};$.r(Yt),$.d(Yt,{json:function(){return hL}});var be={};$.r(be),$.d(be,{json:function(){return dL}});var nn={};$.r(nn),$.d(nn,{json:function(){return pL}});var Ee={};$.r(Ee),$.d(Ee,{json:function(){return vL}});var le={};$.r(le),$.d(le,{CSVDataset:function(){return mN},Dataset:function(){return d1},FileDataSource:function(){return EN},TextLineDataset:function(){return pN},URLDataSource:function(){return SN},array:function(){return mP},csv:function(){return MP},func:function(){return NP},generator:function(){return kP},microphone:function(){return OP},version_data:function(){return CN},webcam:function(){return DP},zip:function(){return yP}});var Le={};$.r(Le),$.d(Le,{addImpl:function(){return NN},bincountImpl:function(){return ZT},bincountReduceImpl:function(){return PN},ceilImpl:function(){return FN},concatImpl:function(){return BN},expImpl:function(){return UN},expm1Impl:function(){return VN},floorImpl:function(){return XN},gatherV2Impl:function(){return YN},greaterImpl:function(){return KN},lessImpl:function(){return ZN},linSpaceImpl:function(){return qN},logImpl:function(){return QN},maxImpl:function(){return JN},maximumImpl:function(){return ek},minimumImpl:function(){return nk},multiplyImpl:function(){return qT},negImpl:function(){return ak},notEqualImpl:function(){return ik},prodImpl:function(){return lk},rangeImpl:function(){return ck},rsqrtImpl:function(){return fk},simpleAbsImpl:function(){return DN},sliceImpl:function(){return LN},squaredDifferenceImpl:function(){return pk},stridedSliceImpl:function(){return vk},subImpl:function(){return jN},tileImpl:function(){return gk},topKImpl:function(){return mk},transposeImpl:function(){return YT},uniqueImpl:function(){return yk}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ze=1e-7,fe=1e-4;class Re{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class He{decComplexRef(t){}time(t){return pe("time")}read(t){return pe("read")}readSync(t){return pe("readSync")}numDataIds(){return pe("numDataIds")}disposeData(t){return pe("disposeData")}write(t,n,o){return pe("write")}move(t,n,o,u){return pe("move")}memory(){return pe("memory")}floatPrecision(){return pe("floatPrecision")}epsilon(){return this.floatPrecision()===32?Ze:fe}batchMatMul(t,n,o,u){return pe("batchMatMul")}fusedBatchMatMul({a:t,b:n,transposeA:o,transposeB:u,bias:h,activation:p,preluActivationWeights:g}){return pe("fusedBatchMatMul")}slice(t,n,o){return pe("slice")}stridedSlice(t,n,o,u){return pe("stridedSlice")}unstack(t,n){return pe("unstack")}reverse(t,n){return pe("reverse")}concat(t,n){return pe("concat")}neg(t){return pe("neg")}add(t,n){return pe("add")}addN(t){return pe("addN")}subtract(t,n){return pe("subtract")}multiply(t,n){return pe("multiply")}realDivide(t,n){return pe("realDivide")}floorDiv(t,n){return pe("floorDiv")}sum(t,n){return pe("sum")}prod(t,n){return pe("prod")}unsortedSegmentSum(t,n,o){return pe("unsortedSegmentSum")}argMin(t,n){return pe("argMin")}argMax(t,n){return pe("argMax")}equal(t,n){return pe("equal")}notEqual(t,n){return pe("notEqual")}less(t,n){return pe("less")}lessEqual(t,n){return pe("lessEqual")}greater(t,n){return pe("greater")}greaterEqual(t,n){return pe("greaterEqual")}logicalNot(t){return pe("logicalNot")}logicalAnd(t,n){return pe("logicalAnd")}logicalOr(t,n){return pe("logicalOr")}where(t){return pe("where")}select(t,n,o){return pe("select")}topk(t,n,o){return pe("topk")}min(t,n){return pe("min")}minimum(t,n){return pe("minimum")}mod(t,n){return pe("mod")}max(t,n){return pe("max")}maximum(t,n){return pe("maximum")}all(t,n){return pe("all")}any(t,n){return pe("any")}squaredDifference(t,n){return pe("squaredDifference")}ceil(t){return pe("ceil")}floor(t){return pe("floor")}round(t){return pe("round")}sign(t){return pe("sign")}isNaN(t){return pe("isNaN")}isInf(t){return pe("isInf")}isFinite(t){return pe("isFinite")}pow(t,n){return pe("pow")}exp(t){return pe("exp")}expm1(t){return pe("expm1")}softmax(t,n){return pe("softmax")}log(t){return pe("log")}log1p(t){return pe("log1p")}sqrt(t){return pe("sqrt")}rsqrt(t){return pe("rsqrt")}square(t){return pe("square")}reciprocal(t){return pe("reciprocal")}relu(t){return pe("relu")}relu6(t){return pe("relu6")}prelu(t,n){return pe("prelu")}elu(t){return pe("elu")}eluDer(t,n){return pe("eluDer")}selu(t){return pe("selu")}int(t){return pe("int")}clip(t,n,o){return pe("clip")}abs(t){return pe("abs")}complexAbs(t){return pe("complexAbs")}sigmoid(t){return pe("sigmoid")}softplus(t){return pe("softplus")}sin(t){return pe("sin")}cos(t){return pe("cos")}tan(t){return pe("tan")}asin(t){return pe("asin")}acos(t){return pe("acos")}atan(t){return pe("atan")}atan2(t,n){return pe("atan2")}sinh(t){return pe("sinh")}cosh(t){return pe("cosh")}tanh(t){return pe("tanh")}asinh(t){return pe("asinh")}acosh(t){return pe("acosh")}atanh(t){return pe("atanh")}erf(t){return pe("erf")}step(t,n){return pe("step")}fusedConv2d({input:t,filter:n,convInfo:o,bias:u,activation:h,preluActivationWeights:p}){return pe("fusedConv2d")}conv2d(t,n,o){return pe("conv2d")}conv2dDerInput(t,n,o){return pe("conv2dDerInput")}conv2dDerFilter(t,n,o){return pe("conv2dDerFilter")}fusedDepthwiseConv2D({input:t,filter:n,convInfo:o,bias:u,activation:h,preluActivationWeights:p}){return pe("fusedDepthwiseConv2D")}depthwiseConv2D(t,n,o){return pe("depthwiseConv2D")}depthwiseConv2DDerInput(t,n,o){return pe("depthwiseConv2DDerInput")}depthwiseConv2DDerFilter(t,n,o){return pe("depthwiseConv2DDerFilter")}conv3d(t,n,o){return pe("conv3d")}conv3dDerInput(t,n,o){return pe("conv3dDerInput")}conv3dDerFilter(t,n,o){return pe("conv3dDerFilter")}maxPool(t,n){return pe("maxPool")}maxPoolBackprop(t,n,o,u){return pe("maxPoolBackprop")}avgPool(t,n){return pe("avgPool")}avgPoolBackprop(t,n,o){return pe("avgPoolBackprop")}avgPool3d(t,n){return pe("avgPool3d")}avgPool3dBackprop(t,n,o){return pe("avgPool3dBackprop")}maxPool3d(t,n){return pe("maxPool3d")}maxPool3dBackprop(t,n,o,u){return pe("maxPool3dBackprop")}reshape(t,n){return pe("reshape")}cast(t,n){return pe("cast")}tile(t,n){return pe("tile")}pad(t,n,o){return pe("pad")}transpose(t,n){return pe("transpose")}gather(t,n,o,u=0){return pe("gather")}gatherND(t,n){return pe("gatherND")}scatterND(t,n,o){return pe("scatterND")}batchToSpaceND(t,n,o){return pe("batchToSpaceND")}spaceToBatchND(t,n,o){return pe("spaceToBatchND")}resizeBilinear(t,n,o,u,h){return pe("resizeBilinear")}resizeBilinearBackprop(t,n,o){return pe("resizeBilinearBackprop")}resizeNearestNeighbor(t,n,o,u,h){return pe("resizeNearestNeighbor")}resizeNearestNeighborBackprop(t,n,o){return pe("resizeNearestNeighborBackprop")}batchNorm(t,n,o,u,h,p){return pe("batchNorm")}localResponseNormalization4D(t,n,o,u,h){return pe("localResponseNormalization4D")}LRNGrad(t,n,o,u,h,p,g){return pe("LRNGrad")}multinomial(t,n,o,u){return pe("multinomial")}oneHot(t,n,o,u){return pe("oneHot")}cumsum(t,n,o,u){return pe("cumsum")}nonMaxSuppression(t,n,o,u,h){return pe("nonMaxSuppression")}fft(t){return pe("fft")}ifft(t){return pe("ifft")}complex(t,n){return pe("complex")}real(t){return pe("real")}imag(t){return pe("imag")}cropAndResize(t,n,o,u,h,p){return pe("cropAndResize")}depthToSpace(t,n,o){return pe("depthToSpace")}split(t,n,o){return pe("split")}sparseToDense(t,n,o,u){return pe("sparseToDense")}diag(t){return pe("diag")}fill(t,n,o){return pe("fill")}onesLike(t){return pe("onesLike")}zerosLike(t){return pe("zerosLike")}linspace(t,n,o){return pe("linspace")}dispose(){return pe("dispose")}}function pe(r){throw new Error(`'${r}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ge(r){let t=r.length,n=0,o=0;for(;t>0;)o=Math.random()*t|0,t--,n=r[t],r[t]=r[o],r[o]=n}function te(r,t,n){return Math.max(r,Math.min(t,n))}function Me(r){return r%2==0?r:r+1}function We(r){let t=0;for(let n=0;n<r.length;n++)t+=r[n];return t}function ee(r,t){const n=Math.random();return t*n+(1-n)*r}function Pt(r,t){let n=0;for(let o=0;o<r.length;o++){const u=Number(r[o])-Number(t[o]);n+=u*u}return n}function yt(r,t){if(!r)throw new Error(typeof t=="string"?t:t())}function Ne(r,t,n=""){yt(Un(r,t),()=>n+` Shapes ${r} and ${t} must match`)}function tn(r){yt(r!=null,()=>"The input to the tensor constructor must be a non-null value.")}function fn(r,t=[],n=!1){if(t==null&&(t=[]),Array.isArray(r)||Hr(r)&&!n)for(let o=0;o<r.length;++o)fn(r[o],t,n);else t.push(r);return t}function Rt(r){if(r.length===0)return 1;let t=r[0];for(let n=1;n<r.length;n++)t*=r[n];return t}function Yn(r){return r.length===0}function Un(r,t){if(r===t)return!0;if(r==null||t==null||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(r[n]!==t[n])return!1;return!0}function xr(r){return r%1==0}function cr(r){if(Math.tanh!=null)return Math.tanh(r);if(r===Infinity)return 1;if(r===-Infinity)return-1;{const t=Math.exp(2*r);return(t-1)/(t+1)}}function Ur(r){const t=Math.ceil(Math.sqrt(r));return[t,Math.ceil(r/t)]}function fa(r){const t=new Uint32Array(r);for(let n=0;n<r;++n)t[n]=n;return Ge(t),t}function Sa(r,t){return t<=r.length?r:r+" ".repeat(t-r.length)}function sa(r,t=o=>0,n){return new Promise((o,u)=>{let h=0;const p=()=>{if(r()){o();return}h++;const g=t(h);if(n!=null&&h>=n){u();return}setTimeout(p,g)};p()})}function Da(r,t){let n=1,o=-1;for(let h=0;h<r.length;++h)if(r[h]>=0)n*=r[h];else if(r[h]===-1){if(o!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${o} and dim ${h}`);o=h}else if(r[h]<0)throw Error(`Shapes can not be < 0. Found ${r[h]} at dim ${h}`);if(o===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${r}`);return r}if(n===0)throw Error(`Cannot infer the missing size in [${r}] when there are 0 elements`);if(t%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const u=r.slice();return u[o]=t/n,u}function Rr(r,t){const n=t.length;return r=r==null?t.map((o,u)=>u):[].concat(r),yt(r.every(o=>o>=-n&&o<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${r}`),yt(r.every(o=>xr(o)),()=>`All values in axis param must be integers but got axis ${r}`),r.map(o=>o<0?n+o:o)}function Mn(r,t){const n=[],o=[],u=t!=null&&Array.isArray(t)&&t.length===0,h=t==null||u?null:Rr(t,r).sort();let p=0;for(let g=0;g<r.length;++g){if(h!=null){if(h[p]===g&&r[g]!==1)throw new Error(`Can't squeeze axis ${g} since its dim '${r[g]}' is not 1`);(h[p]==null||h[p]>g)&&r[g]===1&&(n.push(r[g]),o.push(g)),h[p]<=g&&p++}r[g]!==1&&(n.push(r[g]),o.push(g))}return{newShape:n,keptDims:o}}function ar(r,t){let n=null;if(r==null||r==="float32")n=new Float32Array(t);else if(r==="int32")n=new Int32Array(t);else if(r==="bool")n=new Uint8Array(t);else throw new Error(`Unknown data type ${r}`);return n}function Fn(r,t){let n=null;if(r==null||r==="float32")n=new Float32Array(t);else if(r==="int32")n=new Int32Array(t);else if(r==="bool")n=new Uint8Array(t);else if(r==="string")n=new Array(t);else throw new Error(`Unknown data type ${r}`);return n}function tr(r,t){for(let n=0;n<r.length;n++){const o=r[n];if(isNaN(o)||!isFinite(o))throw Error(`A tensor of type ${t} being uploaded contains ${o}.`)}}function Gn(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function jr(r,t){return!(t==="complex64"||t==="float32"&&r!=="complex64"||t==="int32"&&r!=="float32"&&r!=="complex64"||t==="bool"&&r==="bool")}function Hr(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array}function Ea(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error(`Unknown dtype ${r}`)}function lr(r){if(r==null)return 0;let t=0;return r.forEach(n=>t+=n.length),t}function Cr(r){return typeof r=="string"||r instanceof String}function vr(r){return typeof r=="boolean"}function Tr(r){return typeof r=="number"}function ta(r){return Array.isArray(r)?ta(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array?"int32":Tr(r)?"float32":Cr(r)?"string":vr(r)?"bool":"float32"}function ra(r){return!!(r&&r.constructor&&r.call&&r.apply)}function Zr(r,t){for(let n=t;n<r;++n)if(r%n==0)return n;return r}function vt(r){const t=r.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=r[t-1];for(let o=t-3;o>=0;--o)n[o]=n[o+1]*r[o+1];return n}function _n(r,t,n){const o=new Array;if(t.length===1){const u=t[0];for(let h=0;h<u;h++)o[h]=n[r+h]}else{const u=t[0],h=t.slice(1),p=h.reduce((g,x)=>g*x);for(let g=0;g<u;g++)o[g]=_n(r+g*p,h,n)}return o}function an(r,t){if(r.length===0)return t[0];const n=r.reduce((o,u)=>o*u);if(n===0)return[];if(n!==t.length)throw new Error(`[${r}] does not match the input size ${t.length}.`);return _n(0,r,t)}function Lt(r,t){const n=kt(r,t);for(let o=0;o<n.length;o++)n[o]=1;return n}function kt(r,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool")return new Uint8Array(r);throw new Error(`Unknown data type ${t}`)}function at(r,t){const n=r.reduce((o,u)=>o*u,1);if(t==null||t==="float32")return an(r,new Float32Array(n));if(t==="int32")return an(r,new Int32Array(n));if(t==="bool")return an(r,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function H(r){r.forEach(t=>{yt(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${r}].`)})}function Y(r,t,n){if(t===0)return 0;if(t===1)return r[0];let o=r[r.length-1];for(let u=0;u<r.length-1;++u)o+=n[u]*r[u];return o}function bt(r,t,n){if(t===0)return[];if(t===1)return[r];const o=new Array(t);for(let u=0;u<o.length-1;++u)o[u]=Math.floor(r/n[u]),r-=o[u]*n[u];return o[o.length-1]=r,o}function $t(r){return r&&r.then&&typeof r.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jt="tfjsflags";class Ht{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${n}.`),this.platformName=t,this.platform=n}registerFlag(t,n,o){if(this.flagRegistry[t]={evaluationFn:n,setHook:o},this.urlFlags[t]!=null){const u=this.urlFlags[t];console.warn(`Setting feature override from URL ${t}: ${u}.`),this.set(t,u)}}getAsync(t){return Wr(this,null,function*(){return t in this.flags?this.flags[t]:(this.flags[t]=yield this.evaluateFlag(t),this.flags[t])})}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if($t(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")return;const t=re(this.global.location.search);jt in t&&t[jt].split(",").forEach(o=>{const[u,h]=o.split(":");this.urlFlags[u]=Je(u,h)})}}function re(r){const t={};return r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...o)=>(on(t,o[0],o[1]),o.join("="))),t}function on(r,t,n){r[decodeURIComponent(t)]=decodeURIComponent(n||"")}function Je(r,t){if(t=t.toLowerCase(),t==="true"||t==="false")return t==="true";if(`${+t}`===t)return+t;throw new Error(`Could not parse value flag value ${t} for flag ${r}.`)}function Ve(){return qn}let qn=null;function Ln(r){qn=r}var qr=$(34155);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ca;function Qn(){if(Ca==null){let r;if(typeof window!="undefined")r=window;else if(typeof $.g!="undefined")r=$.g;else if(typeof qr!="undefined")r=qr;else if(typeof self!="undefined")r=self;else throw new Error("Could not find a global object");Ca=r}return Ca}function _r(){const r=Qn();return r._tfGlobals==null&&(r._tfGlobals=new Map),r._tfGlobals}function ea(r,t){const n=_r();if(n.has(r))return n.get(r);{const o=t();return n.set(r,o),n.get(r)}}const La="Abs",ha="Acos",_i="Acosh",Ni="Add",vi="AddN",si="All",Mi="Any",Pa="ArgMax",un="ArgMin",Oe="Asin",hn="Asinh",Hn="Atan",Bn="Atanh",Jn="Atan2",Lr="AvgPool",ya="AvgPoolGrad",Fa="AvgPool3D",ui="AvgPool3DGrad",Ei="BatchMatMul",oo="BatchToSpaceND",po="Bincount",bo="BroadcastTo",ts="Cast",Wo="Ceil",Yi="ClipByValue",wi="Complex",gi="ComplexAbs",us="Concat",Do="Conv2D",Io="Conv2DBackpropFilter",zs="Conv2DBackpropInput",mu="Conv3D",ds="Conv3DBackpropFilterV2",Ms="Conv3DBackpropInputV2",yu="Cos",uu="Cosh",Cs="Cumsum",qo="CropAndResize",Wi="DenseBincount",ls="DepthToSpace",is="DepthwiseConv2dNative",Es="DepthwiseConv2dNativeBackpropFilter",tl="DepthwiseConv2dNativeBackpropInput",bu="Diag",Ys="Dilation2D",ka="Dilation2DBackpropInput",Ku="Dilation2DBackpropFilter",Vs="RealDiv",Ro="Elu",Ns="EluGrad",tu="Erf",eu="Equal",Zu="Exp",bn="ExpandDims",Xr="Expm1",pa="FFT",Ra="Fill",Qi="FlipLeftRight",Co="Floor",to="FloorDiv",xo="FusedBatchNorm",gs="GatherV2",vo="GatherNd",ou="Greater",ms="GreaterEqual",xu="Identity",dl="IFFT",kl="Imag",Ks="IsFinite",el="IsInf",lu="IsNan",Du="LeakyRelu",pl="Less",ns="LessEqual",_s="LinSpace",Bu="Log",Au="Log1p",wu="LogicalAnd",nu="LogicalNot",Tl="LogicalOr",xc="LogSoftmax",Sl="LRN",ol="LRNGrad",ys="Max",vl="Maximum",kc="MaxPool",Dl="MaxPoolGrad",Ol="MaxPool3D",_e="MaxPool3DGrad",ve="MaxPoolWithArgmax",Bt="Mean",ae="Min",me="Minimum",En="MirrorPad",Zn="Mod",Kt="Multinomial",ge="Multiply",Ae="Neg",sn="NotEqual",xn="NonMaxSuppressionV3",ir="NonMaxSuppressionV4",$r="NonMaxSuppressionV5",Aa="OnesLike",Va="OneHot",Ba="Pack",oi="PadV2",ro="Pool",Di="Pow",Si="Prelu",_o="Prod",To="Range",wo="Real",Vo="Reciprocal",js="Relu",ws="Reshape",ks="ResizeNearestNeighbor",Hs="ResizeNearestNeighborGrad",Mu="ResizeBilinear",nl="ResizeBilinearGrad",Cl="Relu6",Yl="Reverse",sl="Round",rl="Rsqrt",_f="ScatterNd",Dc="Select",wc="Selu",ef="Slice",A="Sin",nt="Sinh",Zt="Sign",de="Sigmoid",Pe="Softplus",Qe="Sqrt",rn="Sum",wn="SpaceToBatchND",kn="SplitV",De="Softmax",wr="SquaredDifference",ca="Square",Ar="Sub",ua="SparseToDense",$a="StridedSlice",ri="Tan",ba="Tanh",ki="Tile",Eo="TopK",Lo="Transpose",Bo="Unique",go="Unpack",Ao="UnsortedSegmentSum",qu="ZerosLike",zu="Step",Uu="FromPixels",Qu="RotateWithOffset",Wu="_FusedMatMul",al="FusedConv2D",Vu="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ps=ea("kernelRegistry",()=>new Map),ru=ea("gradRegistry",()=>new Map);function pf(r,t){const n=kd(r,t);return ps.get(n)}function Ec(r){return ru.get(r)}function Ou(r){const t=ps.entries(),n=[];for(;;){const{done:o,value:u}=t.next();if(o)break;const[h,p]=u,[g]=h.split("_");g===r&&n.push(p)}return n}function Uc(r){const{kernelName:t,backendName:n}=r,o=kd(t,n);ps.has(o)&&console.warn(`The kernel '${t}' for backend '${n}' is already registered`),ps.set(o,r)}function Wh(r){const{kernelName:t}=r;ru.has(t)&&Ve().getBool("DEBUG")&&console.warn(`Overriding the gradient for '${t}'`),ru.set(t,r)}function pp(r,t){const n=kd(r,t);if(!ps.has(n))throw new Error(`The kernel '${r}' for backend '${t}' is not registered`);ps.delete(n)}function $p(r){if(!ru.has(r))throw new Error(`The gradient '${r}' for backend is not registered`);ru.delete(r)}function sd(r,t){Ou(r).forEach(o=>{const u=Object.assign({},o,{backendName:t});Uc(u)})}function kd(r,t){return`${t}_${r}`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vp{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new If)}profileKernel(t,n,o){let u;const h=()=>{u=o()},p=this.backendTimer.time(h);if(Ve().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let x=0;x<u.length;x++){const I=u[x];I.data().then(z=>{$f(z,I.dtype,t)})}return{kernelName:t,outputs:u,inputs:n,timeMs:p.then(x=>x.kernelMs),extraInfo:p.then(x=>x.getExtraProfileInfo!=null?x.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:o,timeMs:u,inputs:h,extraInfo:p}=t;o.forEach(g=>{Promise.all([g.data(),u,p]).then(x=>{this.logger.logKernelProfile(n,g,x[0],x[1],h,x[2])})})}}function $f(r,t,n){if(t!=="float32")return!1;for(let o=0;o<r.length;o++){const u=r[o];if(isNaN(u)||!isFinite(u))return console.warn(`Found ${u} in the result of '${n}'`),!0}return!1}class If{logKernelProfile(t,n,o,u,h,p){const g=typeof u=="number"?Sa(`${u}ms`,9):u.error,x=Sa(t,25),I=n.rank,z=n.size,V=Sa(n.shape.toString(),14);let rt="";for(const Et in h){const St=h[Et];if(St!=null){const Tt=St.shape||n.shape,Vt=Tt.length;rt+=`${Et}: ${Vt}D ${Vt>0?Tt:""} `}}console.log(`%c${x}	%c${g}	%c${I}D ${V}	%c${z}	%c${rt}	%c${p}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dd(r,t,n){const o={},u={};for(let x=0;x<t.length;x++)o[t[x].id]=!0;for(let x=0;x<r.length;x++){const I=r[x],z=I.inputs;for(const V in z){const rt=z[V];let Et=!1;for(let St=0;St<t.length;St++)if(o[rt.id]){I.outputs.forEach(Tt=>o[Tt.id]=!0),Et=!0,u[I.id]=!0;break}if(Et)break}}const h={};h[n.id]=!0;const p={};for(let x=r.length-1;x>=0;x--){const I=r[x],z=I.inputs;for(let V=0;V<I.outputs.length;V++)if(h[I.outputs[V].id]){for(const rt in z)h[z[rt].id]=!0,p[I.id]=!0;break}}const g=[];for(let x=0;x<r.length;x++){const I=r[x];if(u[I.id]&&p[I.id]){const z={};for(const rt in I.inputs){const Et=I.inputs[rt];o[Et.id]&&(z[rt]=Et)}const V=Object.assign({},I);V.inputs=z,V.outputs=I.outputs,g.push(V)}}return g}function eh(r,t,n,o){for(let u=t.length-1;u>=0;u--){const h=t[u],p=[];if(h.outputs.forEach(x=>{const I=r[x.id];I!=null?p.push(I):p.push(null)}),h.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${h.kernelName}.`);const g=h.gradient(p);for(const x in h.inputs){if(!(x in g))throw new Error(`Cannot backprop through input ${x}. Available gradients found: ${Object.keys(g)}.`);const I=n(()=>g[x]());if(I.dtype!=="float32")throw new Error(`Error in gradient for op ${h.kernelName}. The gradient of input ${x} must have 'float32' dtype, but has '${I.dtype}'`);const z=h.inputs[x];if(!Un(I.shape,z.shape))throw new Error(`Error in gradient for op ${h.kernelName}. The gradient of input '${x}' has shape '${I.shape}', which does not match the shape of the input '${z.shape}'`);if(r[z.id]==null)r[z.id]=I;else{const V=r[z.id];r[z.id]=o(V,I),V.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gp=20,Oc=3,vh=7;function Pi(r,t,n,o){const u=vt(t),h=gh(r,t,n,u),p=t.length,g=Gf(r,t,n,u,h),x=["Tensor"];return o&&(x.push(`  dtype: ${n}`),x.push(`  rank: ${p}`),x.push(`  shape: [${t}]`),x.push("  values:")),x.push(g.map(I=>"    "+I).join(`
`)),x.join(`
`)}function gh(r,t,n,o){const u=Rt(t),h=o[o.length-1],p=new Array(h).fill(0),g=t.length,x=n==="complex64"?nf(r):r;if(g>1)for(let I=0;I<u/h;I++){const z=I*h;for(let V=0;V<h;V++)p[V]=Math.max(p[V],cs(x[z+V],0,n).length)}return p}function cs(r,t,n){let o;return Array.isArray(r)?o=`${parseFloat(r[0].toFixed(vh))} + ${parseFloat(r[1].toFixed(vh))}j`:Cr(r)?o=`'${r}'`:n==="bool"?o=Wc(r):o=parseFloat(r.toFixed(vh)).toString(),Sa(o,t)}function Wc(r){return r===0?"false":"true"}function Gf(r,t,n,o,u,h=!0){const p=n==="complex64"?2:1,g=t[0],x=t.length;if(x===0){if(n==="complex64"){const Tt=nf(r);return[cs(Tt[0],0,n)]}return n==="bool"?[Wc(r[0])]:[r[0].toString()]}if(x===1){if(g>Gp){const Vt=Oc*p;let ue=Array.from(r.slice(0,Vt)),ye=Array.from(r.slice((g-Oc)*p,g*p));return n==="complex64"&&(ue=nf(ue),ye=nf(ye)),["["+ue.map((qe,$e)=>cs(qe,u[$e],n)).join(", ")+", ..., "+ye.map((qe,$e)=>cs(qe,u[g-Oc+$e],n)).join(", ")+"]"]}const Tt=n==="complex64"?nf(r):Array.from(r);return["["+Tt.map((Vt,ue)=>cs(Vt,u[ue],n)).join(", ")+"]"]}const I=t.slice(1),z=o.slice(1),V=o[0]*p,rt=[];if(g>Gp){for(let Tt=0;Tt<Oc;Tt++){const Vt=Tt*V,ue=Vt+V;rt.push(...Gf(r.slice(Vt,ue),I,n,z,u,!1))}rt.push("...");for(let Tt=g-Oc;Tt<g;Tt++){const Vt=Tt*V,ue=Vt+V;rt.push(...Gf(r.slice(Vt,ue),I,n,z,u,Tt===g-1))}}else for(let Tt=0;Tt<g;Tt++){const Vt=Tt*V,ue=Vt+V;rt.push(...Gf(r.slice(Vt,ue),I,n,z,u,Tt===g-1))}const Et=x===2?",":"";rt[0]="["+rt[0]+Et;for(let Tt=1;Tt<rt.length-1;Tt++)rt[Tt]=" "+rt[Tt]+Et;let St=`,
`;for(let Tt=2;Tt<x;Tt++)St+=`
`;return rt[rt.length-1]=" "+rt[rt.length-1]+"]"+(h?"":St),rt}function nf(r){const t=[];for(let n=0;n<r.length;n+=2)t.push([r[n],r[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rf(r,t){return t==="string"?oc(r):Nu([r],t)}function Od(r,t){return r instanceof Float32Array&&t==="float32"||r instanceof Int32Array&&t==="int32"||r instanceof Uint8Array&&t==="bool"}function Nu(r,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=fn(r)),Ve().getBool("DEBUG")&&tr(r,t),Od(r,t))return r;if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool"){const n=new Uint8Array(r.length);for(let o=0;o<n.length;++o)Math.round(r[o])!==0&&(n[o]=1);return n}else throw new Error(`Unknown data type ${t}`)}function ic(){return Ve().platform.now()}function mh(r,t){return Ve().platform.fetch(r,t)}function oc(r,t="utf-8"){return t=t||"utf-8",Ve().platform.encode(r,t)}function Ot(r,t="utf-8"){return t=t||"utf-8",Ve().platform.decode(r,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ne{constructor(t,n,o){if(this.dtype=n,this.shape=t.slice(),this.size=Rt(t),o!=null){const u=o.length;yt(u===this.size,()=>`Length of values '${u}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=o||Fn(n,this.size),this.strides=vt(t)}set(t,...n){n.length===0&&(n=[0]),yt(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const o=this.locToIndex(n);this.values[o]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const u of t){if(u<0||u>=this.shape[n]){const h=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(h)}n++}let o=t[t.length-1];for(let u=0;u<t.length-1;++u)o+=this.strides[u]*t[u];return this.values[o]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let o=0;o<t.length-1;++o)n+=this.strides[o]*t[o];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let o=0;o<n.length-1;++o)n[o]=Math.floor(t/this.strides[o]),t-=n[o]*this.strides[o];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return Se().makeTensor(this.values,this.shape,this.dtype)}}let Se=null,Ke=null,yn=null;function yr(r){Se=r}function Ir(r){Ke=r}function la(r){yn=r}class Dn{constructor(t,n,o,u){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Rt(t),this.strides=vt(t),this.dataId=o,this.id=u,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){return Wr(this,null,function*(){const t=yield this.data();return Ke.buffer(this.shape,this.dtype,t)})}bufferSync(){return Ke.buffer(this.shape,this.dtype,this.dataSync())}array(){return Wr(this,null,function*(){const t=yield this.data();return an(this.shape,t)})}arraySync(){return an(this.shape,this.dataSync())}data(){return Wr(this,null,function*(){this.throwIfDisposed();const t=Se().read(this.dataId);if(this.dtype==="string"){const n=yield t;try{return n.map(o=>Ot(o))}catch(o){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t})}dataSync(){this.throwIfDisposed();const t=Se().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>Ot(n))}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}bytes(){return Wr(this,null,function*(){this.throwIfDisposed();const t=yield Se().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)})}dispose(){this.isDisposed||(Se().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Ke.print(this,t)}clone(){return this.throwIfDisposed(),Ke.clone(this)}toString(t=!1){const n=this.dataSync();return Pi(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Ke.cast(this,t)}variable(t=!0,n,o){return this.throwIfDisposed(),Se().makeVariable(this,t,n,o)}}Object.defineProperty(Dn,Symbol.hasInstance,{value:r=>!!r&&r.data!=null&&r.dataSync!=null&&r.throwIfDisposed!=null});class Ga extends Dn{constructor(t,n,o,u){super(t.shape,t.dtype,t.dataId,u);this.trainable=n,this.name=o}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!Un(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Se().disposeTensor(this),this.dataId=t.dataId,Se().incRef(this,null)}dispose(){Se().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Ga,Symbol.hasInstance,{value:r=>r instanceof Dn&&r.assign!=null&&r.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var xi;(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(xi||(xi={}));var Ui;(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})(Ui||(Ui={}));var Ii;(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(Ii||(Ii={}));var Mo;(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(Mo||(Mo={}));var rs;(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(rs||(rs={}));const Xo={float32:Mo,int32:Ui,bool:Ii,complex64:rs};function so(r,t){if(r==="string"||t==="string"){if(r==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${r} with ${t}`)}return Xo[r][t]}function jo(r){return so(r,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ci(r,t){if(r.dtype===t.dtype)return[r,t];const n=so(r.dtype,t.dtype);return[r.cast(n),t.cast(n)]}function os(r,t){yt(r.dtype===t.dtype,()=>`The dtypes of the first(${r.dtype}) and second(${t.dtype}) input must match`)}function zo(r,t){return t.some(n=>n.id===r.id)}function Xi(r){const t=[],n=new Set;return Qo(r,t,n),t}function Qo(r,t,n){if(r==null)return;if(r instanceof Dn){t.push(r);return}if(!Is(r))return;const o=r;for(const u in o){const h=o[u];n.has(h)||(n.add(h),Qo(h,t,n))}}function Is(r){return Array.isArray(r)||typeof r=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $s{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Ts{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new $s}ready(){return Wr(this,null,function*(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const o=t[n];if(yield this.initializeBackend(o).success){yield this.setBackend(o);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")})}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,o=1){return t in this.registryFactory?(console.warn(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:o},!0)}setBackend(t){return Wr(this,null,function*(){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:o}=this.initializeBackend(t);if(!(o?yield n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new vp(this.backendInstance),!0})}setupRegisteredKernels(){Ou(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){Ou(t).forEach(o=>{o.disposeFunc!=null&&o.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const o=n.factory();if(o&&!(o instanceof He)&&typeof o.then=="function"){const u=++this.pendingBackendInitId,h=o.then(p=>u<this.pendingBackendInitId?!1:(this.registry[t]=p,this.pendingBackendInit=null,!0)).catch(p=>(u<this.pendingBackendInitId||(this.pendingBackendInit=null,console.warn(`Initialization of backend ${t} failed`),console.warn(p.stack||p.message)),!1));return this.pendingBackendInit=h,{success:h,asyncInit:!0}}else return this.registry[t]=o,{success:!0,asyncInit:!1}}catch(o){return console.warn(`Initialization of backend ${t} failed`),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const o=t[n],{success:u,asyncInit:h}=this.initializeBackend(o);if(h||u)return{name:o,asyncInit:h}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const o=this.state.tensorInfo.get(n),u=o.backend,h=this.readSync(n);u.disposeData(n),o.backend=t,t.move(n,h,o.shape,o.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let o=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=t}let u;return this.scopedRun(()=>this.startScope(o),()=>this.endScope(u),()=>(u=n(),u instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),u))}scopedRun(t,n,o){t();try{const u=o();return n(),u}catch(u){throw n(),u}}nextTensorId(){return Ts.nextTensorId++}nextVariableId(){return Ts.nextVariableId++}clone(t){const n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),o={x:t},u=p=>({x:()=>{const g="float32",x={x:p},I={dtype:g};return dr.runKernelFunc(z=>z.cast(p,g),x,null,ts,I)}}),h=[];return this.addTapeNode(this.state.activeScope.name,o,[n],u,h,{}),n}runKernel(t,n,o,u,h){const p=null,g=null;return this.runKernelFunc(p,n,g,t,o,u,h)}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,o){const u=this.backend.numDataIds();let h=0;o.forEach(x=>{h+=x.dtype==="complex64"?3:1});const p=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],g=u-n-h-p;if(g>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${g} data ids) after running '${t}'`)}runKernelFunc(t,n,o,u,h,p,g){let x,I=[];const z=this.isTapeOn();u==null&&(u=this.state.activeScope!=null?this.state.activeScope.name:"");const V=this.state.numBytes,rt=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let Et;this.backendName==null&&this.backend;const St=pf(u,this.backendName);let Tt;if(St!=null)Et=()=>{const ue=this.backend.numDataIds();Tt=St.kernelFunc({inputs:n,attrs:h,backend:this.backend});const ye=Array.isArray(Tt)?Tt:[Tt];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,ue,ye);const qe=ye.map($e=>{if($e.rank!=null)return $e;const{dataId:Xe,shape:Pn,dtype:In}=$e;return this.makeTensorFromDataId(Xe,Pn,In)});if(z){let $e=this.getTensorsForGradient(u,n,qe);if($e==null){g==null&&(g=[]);const Xe=qe.filter((Pn,In)=>g[In]);$e=(p||[]).slice().concat(Xe)}I=this.saveTensorsForBackwardMode($e)}return qe};else{if(t==null)throw new Error(`Error running ${u}: Neither modular kernel nor forward func passed`);const ue=ye=>{!z||(I=ye.map(qe=>this.keep(this.clone(qe))))};Et=()=>{const ye=this.backend.numDataIds();Tt=this.tidy(()=>t(this.backend,ue));const qe=Array.isArray(Tt)?Tt:[Tt];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,ye,qe),qe}}let Vt;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?x=Et():(Vt=this.profiler.profileKernel(u,n,()=>Et()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(Vt),x=Vt.outputs)}),z&&this.addTapeNode(u,n,x,o,I,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-V,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-rt,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(ue=>n[ue]!=null?n[ue].shape:null),outputShapes:x.map(ue=>ue.shape),kernelTimeMs:Vt.timeMs,extraInfo:Vt.extraInfo}),Array.isArray(Tt)?x:x[0]}saveTensorsForBackwardMode(t){return t.map(o=>this.keep(this.clone(o)))}getTensorsForGradient(t,n,o){const u=Ec(t);if(u!=null){const h=u.inputsToSave||[],p=u.outputsToSave||[];let g;u.saveAllInputs?(yt(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),g=Object.keys(n).map(I=>n[I])):g=h.map(I=>n[I]);const x=o.filter((I,z)=>p[z]);return g.concat(x)}return null}makeTensor(t,n,o,u){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");o=o||"float32",u=u||this.backend;let h=t;o==="string"&&Cr(t[0])&&(h=t.map(x=>oc(x)));const p=u.write(h,n,o),g=new Dn(n,o,p,this.nextTensorId());if(this.incRef(g,u),o==="string"){const x=this.state.tensorInfo.get(p),I=lr(h);this.state.numBytes+=I-x.bytes,x.bytes=I}return g}makeTensorFromDataId(t,n,o,u){o=o||"float32";const h=new Dn(n,o,t,this.nextTensorId());return this.incRef(h,u),h}makeVariable(t,n=!0,o,u){o=o||this.nextVariableId().toString(),u!=null&&u!==t.dtype&&(t=t.cast(u));const h=new Ga(t,n,o,this.nextTensorId());if(this.state.registeredVariables[h.name]!=null)throw new Error(`Variable with name ${h.name} was already registered`);return this.state.registeredVariables[h.name]=h,this.incRef(h,this.backend),h}incRef(t,n){const o=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,o===0){this.state.numDataBuffers++;let u=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(u=t.size*Ea(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:u,refCount:0}),this.state.numBytes+=u}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Ga||this.track(t)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;const n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):(n.backend.decComplexRef(t.dataId),this.state.tensorInfo.get(t.dataId).refCount--)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}profile(t){return Wr(this,null,function*(){this.state.profiling=!0;const n=this.state.numBytes,o=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=yield t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(u=>u.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-o;for(const u of this.state.activeProfile.kernels)u.kernelTimeMs=yield u.kernelTimeMs,u.extraInfo=yield u.extraInfo;return this.state.activeProfile})}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,o,u,h,p){const g={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:o,saved:h},x=Ec(t);x!=null&&(u=x.gradFunc),u!=null&&(g.gradient=I=>(I=I.map((z,V)=>{if(z==null){const rt=o[V],Et=kt(rt.size,rt.dtype);return this.makeTensor(Et,rt.shape,rt.dtype)}return z}),u(I.length>1?I:I[0],h,p))),this.state.activeTape.push(g)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=Xi(t),o=new Set(n.map(h=>h.id));for(let h=0;h<this.state.activeScope.track.length;h++){const p=this.state.activeScope.track[h];!p.kept&&!o.has(p.id)&&p.dispose()}const u=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(h=>{!h.kept&&h.scopeId===u.id&&this.track(h)})}gradients(t,n,o,u=!1){if(yt(n.length>0,()=>"gradients() received an empty list of xs."),o!=null&&o.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${o.dtype}'`);const h=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));yt(h instanceof Dn,()=>"The result y returned by f() must be a tensor.");const p=Dd(this.state.activeTape,n,h);if(!u&&p.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const g={};g[h.id]=o==null?Ds(h.shape):o,eh(g,p,I=>this.tidy(I),Vi);const x=n.map(I=>g[I.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(I=>{for(const z of I.saved)z.dispose()}),this.state.activeTape=null),{value:h,grads:x}})}customGrad(t){return yt(ra(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{yt(n.every(h=>h instanceof Dn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let o;const u={};return n.forEach((h,p)=>{u[p]=h}),this.runKernelFunc((h,p)=>(o=t(...n,p),yt(o.value instanceof Dn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),yt(ra(o.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),o.value),u,(h,p)=>{const g=o.gradFunc(h,p),x=Array.isArray(g)?g:[g];yt(x.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),yt(x.every(z=>z instanceof Dn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const I={};return x.forEach((z,V)=>{I[V]=()=>z}),I})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}time(t){return Wr(this,null,function*(){const n=ic(),o=yield this.backend.time(t);return o.wallMs=ic()-n,o})}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new $s;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Ts.nextTensorId=0,Ts.nextVariableId=0;function Ds(r){const t=Lt(Rt(r),"float32");return dr.makeTensor(t,r,"float32")}function Gs(){const r=Qn();if(r._tfengine==null){const t=new Ht(r);r._tfengine=new Ts(t)}return Ln(r._tfengine.ENV),yr(()=>r._tfengine),r._tfengine}const dr=Gs();function Vi(r,t){const n={a:r,b:t};return dr.runKernel(Ni,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function af(){return typeof navigator!="undefined"&&navigator!=null}function Tf(){if(af()){const r=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(r)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(r.substr(0,4))}return!1}function sc(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}var Af=$(34155);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sc=Ve();Sc.registerFlag("DEBUG",()=>!1,r=>{r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Sc.registerFlag("IS_BROWSER",()=>sc()),Sc.registerFlag("IS_NODE",()=>typeof Af!="undefined"&&typeof Af.versions!="undefined"&&typeof Af.versions.node!="undefined"),Sc.registerFlag("IS_CHROME",()=>typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),Sc.registerFlag("PROD",()=>!1),Sc.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Sc.getBool("DEBUG")),Sc.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),Sc.registerFlag("IS_TEST",()=>!1),Sc.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _l(r,t){let n=r;if(Hr(r))return t==="string"?[]:[r.length];if(!Array.isArray(r))return[];const o=[];for(;Array.isArray(n)||Hr(n)&&t!=="string";)o.push(n.length),n=n[0];return Array.isArray(r)&&Ve().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Rd(r,o,[]),o}function Rd(r,t,n){if(n=n||[],!Array.isArray(r)&&!Hr(r)){yt(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}yt(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${r.length} elements`),yt(r.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${r.length} elements`);const o=t.slice(1);for(let u=0;u<r.length;++u)Rd(r[u],o,n.concat(u))}function ud(r,t,n,o){if(r!=="string_or_numeric"){if(r==null)throw new Error("Expected dtype cannot be null.");if(r!=="numeric"&&r!==t||r==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${o}' must be ${r} tensor, but got ${t} tensor`)}}function pn(r,t,n,o="numeric"){if(r instanceof Dn)return ud(o,r.dtype,t,n),r;let u=ta(r);if(u!=="string"&&["bool","int32","float32"].indexOf(o)>=0&&(u=o),ud(o,u,t,n),r==null||!Hr(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){const x=r==null?"null":r.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${x}'`)}const h=_l(r,u);!Hr(r)&&!Array.isArray(r)&&(r=[r]);const g=u!=="string"?Nu(r,u):fn(r,[],!0);return dr.makeTensor(g,h,u)}function nh(r,t,n,o="numeric"){if(!Array.isArray(r))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return r.map((h,p)=>pn(h,`${t}[${p}]`,n,o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ld="__op";function br(r){const t=Object.keys(r);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const o=r[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+ld;const u=(...h)=>{dr.startScope(n);try{const p=o(...h);return $t(p)&&console.error("Cannot return a Promise inside of tidy."),dr.endScope(p),p}catch(p){throw dr.endScope(null),p}};return Object.defineProperty(u,"name",{value:n,configurable:!0}),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vh(r,t){const n=pn(r,"real","complex"),o=pn(t,"imag","complex");Ne(n.shape,o.shape,`real and imag shapes, ${n.shape} and ${o.shape}, must match in call to tf.complex().`);const u={real:n,imag:o};return dr.runKernel(wi,u)}const Rc=br({complex_:Vh});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lc(r,t,n,o){if(o==null&&(o=ta(r)),o==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Hr(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){H(t);const u=Rt(t),h=Rt(n);yt(u===h,()=>`Based on the provided shape, [${t}], the tensor should have ${u} values but has ${h}`);for(let p=0;p<n.length;++p){const g=n[p],x=p===n.length-1?g!==Rt(t.slice(p)):!0;yt(n[p]===t[p]||!x,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Hr(r)&&!Array.isArray(r)&&(r=[r]),t=t||n,r=o!=="string"?Nu(r,o):fn(r,[],!0),dr.makeTensor(r,t,o)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vc(r,t,n){const o=_l(r,n);return Lc(r,t,o,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pc={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};var Ru=$(48764).Buffer;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fc=4;function Rl(r,t){return Wr(this,null,function*(){const n=[],o=[],u=Array.isArray(r)?r.map(p=>p.name):Object.keys(r);for(let p=0;p<u.length;++p){const g=u[p],x=Array.isArray(r)?r[p].tensor:r[g];if(x.dtype!=="float32"&&x.dtype!=="int32"&&x.dtype!=="bool"&&x.dtype!=="string"&&x.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${g}': ${x.dtype}`);const I={name:g,shape:x.shape,dtype:x.dtype};if(x.dtype==="string"){const z=new Promise(V=>Wr(this,null,function*(){const rt=yield x.bytes(),Et=rt.reduce((Vt,ue)=>Vt+ue.length,0)+Fc*rt.length,St=new Uint8Array(Et);let Tt=0;for(let Vt=0;Vt<rt.length;Vt++){const ue=rt[Vt],ye=new Uint8Array(new Uint32Array([ue.length]).buffer);St.set(ye,Tt),Tt+=Fc,St.set(ue,Tt),Tt+=ue.length}V(St)}));o.push(z)}else o.push(x.data());t!=null&&(I.group=t),n.push(I)}const h=yield Promise.all(o);return{data:jc(h),specs:n}})}function yh(r,t){const n={};let o,u=0;for(const h of t){const p=h.name,g=h.dtype,x=h.shape,I=Rt(x);let z;if("quantization"in h){const V=h.quantization;if(V.dtype==="uint8"||V.dtype==="uint16"){if(!("min"in V&&"scale"in V))throw new Error(`Weight ${h.name} with quantization ${V.dtype} doesn't have corresponding metadata min and scale.`)}else if(V.dtype==="float16"){if(g!=="float32")throw new Error(`Weight ${h.name} is quantized with ${V.dtype} which only supports weights of type float32 not ${g}.`)}else throw new Error(`Weight ${h.name} has unknown quantization dtype ${V.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const rt=Pc[V.dtype],Et=r.slice(u,u+I*rt),St=V.dtype==="uint8"?new Uint8Array(Et):new Uint16Array(Et);if(g==="float32")if(V.dtype==="uint8"||V.dtype==="uint16"){z=new Float32Array(St.length);for(let Tt=0;Tt<St.length;Tt++){const Vt=St[Tt];z[Tt]=Vt*V.scale+V.min}}else if(V.dtype==="float16")o===void 0&&(o=yp()),z=o(St);else throw new Error(`Unsupported quantization type ${V.dtype} for weight type float32.`);else if(g==="int32"){if(V.dtype!=="uint8"&&V.dtype!=="uint16")throw new Error(`Unsupported quantization type ${V.dtype} for weight type int32.`);z=new Int32Array(St.length);for(let Tt=0;Tt<St.length;Tt++){const Vt=St[Tt];z[Tt]=Math.round(Vt*V.scale+V.min)}}else throw new Error(`Unsupported dtype in weight '${p}': ${g}`);u+=I*rt}else if(g==="string"){const V=Rt(h.shape);z=[];for(let rt=0;rt<V;rt++){const Et=new Uint32Array(r.slice(u,u+Fc))[0];u+=Fc;const St=new Uint8Array(r.slice(u,u+Et));z.push(St),u+=Et}}else{const V=Pc[g],rt=r.slice(u,u+I*V);if(g==="float32")z=new Float32Array(rt);else if(g==="int32")z=new Int32Array(rt);else if(g==="bool")z=new Uint8Array(rt);else if(g==="complex64"){z=new Float32Array(rt);const Et=new Float32Array(z.length/2),St=new Float32Array(z.length/2);for(let ue=0;ue<Et.length;ue++)Et[ue]=z[ue*2],St[ue]=z[ue*2+1];const Tt=Vc(Et,x,"float32"),Vt=Vc(St,x,"float32");n[p]=Rc(Tt,Vt),Tt.dispose(),Vt.dispose()}else throw new Error(`Unsupported dtype in weight '${p}': ${g}`);u+=I*V}g!=="complex64"&&(n[p]=Vc(z,x,g))}return n}function jc(r){if(r===null)throw new Error(`Invalid input value: ${JSON.stringify(r)}`);let t=0;const n=[];r.forEach(h=>{if(t+=h.byteLength,n.push(h.byteLength===h.buffer.byteLength?h:new h.constructor(h)),!(h instanceof Float32Array||h instanceof Int32Array||h instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${h.constructor.name}`)});const o=new Uint8Array(t);let u=0;return n.forEach(h=>{o.set(new Uint8Array(h.buffer),u),u+=h.byteLength}),o.buffer}const jh=typeof Ru!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function Hh(r){return jh?Ru.byteLength(r):new Blob([r]).size}function Hc(r){if(jh)return Ru.from(r).toString("base64");const t=new Uint8Array(r);let n="";for(let o=0,u=t.length;o<u;o++)n+=String.fromCharCode(t[o]);return btoa(n)}function Sv(r){if(jh){const o=Ru.from(r,"base64");return o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength)}const t=atob(r),n=new Uint8Array(t.length);for(let o=0;o<t.length;++o)n.set([t.charCodeAt(o)],o);return n.buffer}function vf(r){if(r.length===1)return r[0];let t=0;r.forEach(u=>{t+=u.byteLength});const n=new Uint8Array(t);let o=0;return r.forEach(u=>{n.set(new Uint8Array(u),o),o+=u.byteLength}),n.buffer}function Ld(r){const t="/";for(r=r.trim();r.endsWith(t);)r=r.slice(0,r.length-1);const n=r.split(t);return n[n.length-1]}function gf(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:Hh(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:Hh(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}function gp(){const r=n=>{let o=n<<13,u=0;for(;(o&8388608)==0;)u-=8388608,o<<=1;return o&=~8388608,u+=947912704,o|u},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=r(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function mp(){const r=new Uint32Array(64);r[0]=0,r[31]=1199570944,r[32]=2147483648,r[63]=3347054592;for(let t=1;t<31;t++)r[t]=t<<23;for(let t=33;t<63;t++)r[t]=2147483648+(t-32<<23);return r}function Pd(){const r=new Uint32Array(64);for(let t=0;t<64;t++)r[t]=1024;return r[0]=r[32]=0,r}function yp(){const r=gp(),t=mp(),n=Pd();return o=>{const u=new ArrayBuffer(4*o.length),h=new Uint32Array(u);for(let p=0;p<o.length;p++){const g=o[p],x=r[n[g>>10]+(g&1023)]+t[g>>10];h[p]=x}return new Float32Array(u)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class il{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return il.instance==null&&(il.instance=new il),il.instance}static registerSaveRouter(t){il.getInstance().saveRouters.push(t)}static registerLoadRouter(t){il.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return il.getHandlers(t,"save")}static getLoadHandlers(t,n){return il.getHandlers(t,"load",n)}static getHandlers(t,n,o){const u=[];return(n==="load"?il.getInstance().loadRouters:il.getInstance().saveRouters).forEach(p=>{const g=p(t,o);g!==null&&u.push(g)}),u}}const rh=r=>il.registerSaveRouter(r),Up=r=>il.registerLoadRouter(r),Xh=r=>il.getSaveHandlers(r),Fd=(r,t)=>il.getLoadHandlers(r,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kl="tensorflowjs",Al=1,Ml="models_store",ah="model_info_store";function Os(){return Wr(this,null,function*(){const r=Ll();return new Promise((t,n)=>{const o=r.deleteDatabase(Kl);o.onsuccess=()=>t(),o.onerror=u=>n(u)})})}function Ll(){if(!Ve().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const r=typeof window=="undefined"?self:window,t=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function of(r){const t=r.result;t.createObjectStore(Ml,{keyPath:"modelPath"}),t.createObjectStore(ah,{keyPath:"modelPath"})}class Sn{constructor(t){if(this.indexedDB=Ll(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}save(t){return Wr(this,null,function*(){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)})}load(){return Wr(this,null,function*(){return this.databaseAction(this.modelPath)})}databaseAction(t,n){return new Promise((o,u)=>{const h=this.indexedDB.open(Kl,Al);h.onupgradeneeded=()=>of(h),h.onsuccess=()=>{const p=h.result;if(n==null){const g=p.transaction(Ml,"readonly"),I=g.objectStore(Ml).get(this.modelPath);I.onsuccess=()=>{if(I.result==null)return p.close(),u(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));o(I.result.modelArtifacts)},I.onerror=z=>(p.close(),u(I.error)),g.oncomplete=()=>p.close()}else{const g=gf(n),x=p.transaction(ah,"readwrite");let I=x.objectStore(ah);const z=I.put({modelPath:this.modelPath,modelArtifactsInfo:g});let V;z.onsuccess=()=>{V=p.transaction(Ml,"readwrite");const Et=V.objectStore(Ml).put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:g});Et.onsuccess=()=>o({modelArtifactsInfo:g}),Et.onerror=St=>{I=x.objectStore(ah);const Tt=I.delete(this.modelPath);Tt.onsuccess=()=>(p.close(),u(Et.error)),Tt.onerror=Vt=>(p.close(),u(Et.error))}},z.onerror=rt=>(p.close(),u(z.error)),x.oncomplete=()=>{V==null?p.close():V.oncomplete=()=>p.close()}}},h.onerror=p=>u(h.error)})}}Sn.URL_SCHEME="indexeddb://";const Bd=r=>Ve().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Sn.URL_SCHEME)?ih(r.slice(Sn.URL_SCHEME.length)):null;il.registerSaveRouter(Bd),il.registerLoadRouter(Bd);function ih(r){return new Sn(r)}function zd(r){return r.startsWith(Sn.URL_SCHEME)?r.slice(Sn.URL_SCHEME.length):r}class Mf{constructor(){this.indexedDB=Ll()}listModels(){return Wr(this,null,function*(){return new Promise((t,n)=>{const o=this.indexedDB.open(Kl,Al);o.onupgradeneeded=()=>of(o),o.onsuccess=()=>{const u=o.result,h=u.transaction(ah,"readonly"),g=h.objectStore(ah).getAll();g.onsuccess=()=>{const x={};for(const I of g.result)x[I.modelPath]=I.modelArtifactsInfo;t(x)},g.onerror=x=>(u.close(),n(g.error)),h.oncomplete=()=>u.close()},o.onerror=u=>n(o.error)})})}removeModel(t){return Wr(this,null,function*(){return t=zd(t),new Promise((n,o)=>{const u=this.indexedDB.open(Kl,Al);u.onupgradeneeded=()=>of(u),u.onsuccess=()=>{const h=u.result,p=h.transaction(ah,"readwrite"),g=p.objectStore(ah),x=g.get(t);let I;x.onsuccess=()=>{if(x.result==null)return h.close(),o(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const z=g.delete(t),V=()=>{I=h.transaction(Ml,"readwrite");const Et=I.objectStore(Ml).delete(t);Et.onsuccess=()=>n(x.result.modelArtifactsInfo),Et.onerror=St=>o(x.error)};z.onsuccess=V,z.onerror=rt=>(V(),h.close(),o(x.error))}},x.onerror=z=>(h.close(),o(x.error)),p.oncomplete=()=>{I==null?h.close():I.oncomplete=()=>h.close()}},u.onerror=h=>o(u.error)})})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sf="/",Uf="tensorflowjs_models",$d="info",Wf="model_topology",bh="weight_specs",Wp="weight_data",xh="model_metadata";function ju(){if(!env().getBool("IS_BROWSER")||typeof window=="undefined"||typeof window.localStorage=="undefined")throw new Error("purgeLocalStorageModels() cannot proceed because local storage is unavailable in the current environment.");const r=window.localStorage,t=[];for(let n=0;n<r.length;++n){const o=r.key(n),u=Uf+sf;if(o.startsWith(u)&&o.length>u.length){r.removeItem(o);const h=bp(o);t.indexOf(h)===-1&&t.push(h)}}return t}function oh(r){return{info:[Uf,r,$d].join(sf),topology:[Uf,r,Wf].join(sf),weightSpecs:[Uf,r,bh].join(sf),weightData:[Uf,r,Wp].join(sf),modelMetadata:[Uf,r,xh].join(sf)}}function bp(r){const t=r.split(sf);if(t.length<3)throw new Error(`Invalid key format: ${r}`);return t.slice(1,t.length-1).join(sf)}function cd(r){return r.startsWith(Cc.URL_SCHEME)?r.slice(Cc.URL_SCHEME.length):r}class Cc{constructor(t){if(!Ve().getBool("IS_BROWSER")||typeof window=="undefined"||typeof window.localStorage=="undefined")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=oh(this.modelPath)}save(t){return Wr(this,null,function*(){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),o=JSON.stringify(t.weightSpecs),u=gf(t);try{this.LS.setItem(this.keys.info,JSON.stringify(u)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,o),this.LS.setItem(this.keys.weightData,Hc(t.weightData));const h={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};return t.signature!=null&&(h.signature=t.signature),t.userDefinedMetadata!=null&&(h.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(h.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(h)),{modelArtifactsInfo:u}}catch(h){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${u.modelTopologyBytes}, weightSpecsBytes=${u.weightSpecsBytes}, weightDataBytes=${u.weightDataBytes}.`)}}})}load(){return Wr(this,null,function*(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},o=JSON.parse(this.LS.getItem(this.keys.topology));if(o==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=o;const u=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(u==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=u;const h=this.LS.getItem(this.keys.modelMetadata);if(h!=null){const g=JSON.parse(h);n.format=g.format,n.generatedBy=g.generatedBy,n.convertedBy=g.convertedBy,g.signature!=null&&(n.signature=g.signature),g.userDefinedMetadata!=null&&(n.userDefinedMetadata=g.userDefinedMetadata),g.modelInitializer!=null&&(n.modelInitializer=g.modelInitializer)}const p=this.LS.getItem(this.keys.weightData);if(p==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=Sv(p),n})}}Cc.URL_SCHEME="localstorage://";const Yh=r=>Ve().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Cc.URL_SCHEME)?uf(r.slice(Cc.URL_SCHEME.length)):null;il.registerSaveRouter(Yh),il.registerLoadRouter(Yh);function uf(r){return new Cc(r)}class wh{constructor(){yt(Ve().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),yt(typeof window=="undefined"||typeof window.localStorage!="undefined",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){return Wr(this,null,function*(){const t={},n=Uf+sf,o=sf+$d;for(let u=0;u<this.LS.length;++u){const h=this.LS.key(u);if(h.startsWith(n)&&h.endsWith(o)){const p=bp(h);t[p]=JSON.parse(this.LS.getItem(h))}}return t})}removeModel(t){return Wr(this,null,function*(){t=cd(t);const n=oh(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const o=JSON.parse(this.LS.getItem(n.info));return this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),o})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sh="://";class Pl{constructor(){this.managers={}}static getInstance(){return Pl.instance==null&&(Pl.instance=new Pl),Pl.instance}static registerManager(t,n){yt(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(sh)&&(t=t.slice(0,t.indexOf(sh))),yt(t.length>0,()=>"scheme must not be an empty string.");const o=Pl.getInstance();yt(o.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),o.managers[t]=n}static getManager(t){const n=this.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(this.getInstance().managers)}}function Nf(r){if(r.indexOf(sh)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${Pl.getSchemes().join(",")}`);return{scheme:r.split(sh)[0],path:r.split(sh)[1]}}function Eh(r,t,n=!1){return Wr(this,null,function*(){yt(r!==t,()=>`Old path and new path are the same: '${r}'`);const o=il.getLoadHandlers(r);yt(o.length>0,()=>`Copying failed because no load handler is found for source URL ${r}.`),yt(o.length<2,()=>`Copying failed because more than one (${o.length}) load handlers for source URL ${r}.`);const u=o[0],h=il.getSaveHandlers(t);yt(h.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),yt(h.length<2,()=>`Copying failed because more than one (${o.length}) save handlers for destination URL ${t}.`);const p=h[0],g=Nf(r).scheme,x=Nf(r).path,I=g===Nf(r).scheme,z=yield u.load();n&&I&&(yield Pl.getManager(g).removeModel(x));const V=yield p.save(z);return n&&!I&&(yield Pl.getManager(g).removeModel(x)),V.modelArtifactsInfo})}function fd(){return Wr(this,null,function*(){const r=Pl.getSchemes(),t={};for(const n of r){const o=yield Pl.getManager(n).listModels();for(const u in o){const h=n+sh+u;t[h]=o[u]}}return t})}function Vp(r){return Wr(this,null,function*(){const t=Nf(r);return Pl.getManager(t.scheme).removeModel(t.path)})}function hd(r,t){return Wr(this,null,function*(){return Eh(r,t,!1)})}function jp(r,t){return Wr(this,null,function*(){return Eh(r,t,!0)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gd{fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}}if(Ve().get("IS_BROWSER")){Ve().setPlatform("browser",new Gd);try{Pl.registerManager(Cc.URL_SCHEME,new wh)}catch(r){}try{Pl.registerManager(Sn.URL_SCHEME,new Mf)}catch(r){}}var Kh=$(34155);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fl={importFetch:()=>$(75410)};let uh;function Sh(){uh=null}function Ch(r){uh=r}function ng(){return uh}class Cv{constructor(){this.util=$(48628),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return Ve().global.fetch!=null?Ve().global.fetch(t,n):(uh==null&&(uh=Fl.importFetch()),uh(t,n))}now(){const t=Kh.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}}Ve().get("IS_NODE")&&Ve().setPlatform("node",new Cv);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vs(r,t="float32",n){return t=t||"float32",H(r),new ne(r,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xc(r,t){const n=pn(r,"x","cast");if(!Gn(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const o={x:n},u={dtype:t};return dr.runKernel(ts,o,u)}const eo=br({cast_:Xc});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hp(r){const n={x:pn(r,"x","clone","string_or_numeric")};return dr.runKernel(xu,n)}const _h=br({clone_:Hp});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dd(r,t=!1){console.log(r.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Gs(),Ir({buffer:vs,cast:eo,clone:_h,print:dd});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ig="model",Ud=".json",Xp=".weights.bin";function _v(r){return new Promise(t=>setTimeout(t)).then(r)}class Ih{constructor(t){if(!Ve().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Ih.URL_SCHEME)&&(t=t.slice(Ih.URL_SCHEME.length)),(t==null||t.length===0)&&(t=Ig),this.modelTopologyFileName=t+Ud,this.weightDataFileName=t+Xp}save(t){return Wr(this,null,function*(){if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const o=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],u={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:o};t.signature!=null&&(u.signature=t.signature),t.userDefinedMetadata!=null&&(u.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(u.modelInitializer=t.modelInitializer);const h=window.URL.createObjectURL(new Blob([JSON.stringify(u)],{type:"application/json"})),p=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor;if(p.download=this.modelTopologyFileName,p.href=h,yield _v(()=>p.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){const g=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;g.download=this.weightDataFileName,g.href=n,yield _v(()=>g.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:gf(t)}}})}}Ih.URL_SCHEME="downloads://";class Yp{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.files=t}load(){return Wr(this,null,function*(){const t=this.files[0],n=this.files.slice(1);return new Promise((o,u)=>{const h=new FileReader;h.onload=p=>{const g=JSON.parse(p.target.result),x=g.modelTopology;if(x==null){u(new Error(`modelTopology field is missing from file ${t.name}`));return}n.length===0&&o({modelTopology:x});const I=g.weightsManifest;if(I==null){u(new Error(`weightManifest field is missing from file ${t.name}`));return}let z;try{z=this.checkManifestAndWeightFiles(I,n)}catch(St){u(St);return}const V=[],rt=[],Et=[];I.forEach(St=>{St.paths.forEach(Tt=>{rt.push(Tt),Et.push(null)}),V.push(...St.weights)}),I.forEach(St=>{St.paths.forEach(Tt=>{const Vt=new FileReader;Vt.onload=ue=>{const ye=ue.target.result,qe=rt.indexOf(Tt);if(Et[qe]=ye,Et.indexOf(null)===-1){const $e={modelTopology:x,weightSpecs:V,weightData:vf(Et),format:g.format,generatedBy:g.generatedBy,convertedBy:g.convertedBy};g.signature!=null&&($e.signature=g.signature),g.userDefinedMetadata!=null&&($e.userDefinedMetadata=g.userDefinedMetadata),g.modelInitializer!=null&&($e.modelInitializer=g.modelInitializer),o($e)}},Vt.onerror=ue=>u(`Failed to weights data from file of path '${Tt}'.`),Vt.readAsArrayBuffer(z[Tt])})})},h.onerror=p=>u(`Failed to read model topology and weights manifest JSON from file '${t.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),h.readAsText(t)})})}checkManifestAndWeightFiles(t,n){const o=[],u=n.map(p=>Ld(p.name)),h={};for(const p of t)p.paths.forEach(g=>{const x=Ld(g);if(o.indexOf(x)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${x}'`);if(o.push(x),u.indexOf(x)===-1)throw new Error(`Weight file with basename '${x}' is not provided.`);h[g]=n[u.indexOf(x)]});if(o.length!==n.length)throw new Error(`Mismatch in the number of files in weights manifest (${o.length}) and the number of weight files provided (${n.length}).`);return h}}const Kp=r=>Ve().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(Ih.URL_SCHEME)?Th(r.slice(Ih.URL_SCHEME.length)):null;il.registerSaveRouter(Kp);function Th(r="model"){return new Ih(r)}function Zp(r){return new Yp(r)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ah(r,t,n,o){p(r),n=n==null?0:n,o=o==null?1:o,g(n,o);let u=0;const h=x=>(x.then(I=>{const z=n+ ++u/r.length*(o-n);return t(z),I}),x);function p(x){yt(x!=null&&Array.isArray(x)&&x.length>0,()=>"promises must be a none empty array")}function g(x,I){yt(x>=0&&x<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${x}`),yt(I>=0&&I<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${I}`),yt(I>=x,()=>`startFraction must be no more than endFraction, but got startFraction ${x} and endFraction ${I}`)}return Promise.all(r.map(h))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wd(r,t){return Wr(this,null,function*(){t==null&&(t={});const n=t.fetchFunc==null?Ve().platform.fetch:t.fetchFunc,o=r.map(V=>n(V,t.requestInit,{isBinary:!0})),u=0,h=.5,g=(t.onProgress==null?yield Promise.all(o):yield Ah(o,t.onProgress,u,h)).map(V=>V.arrayBuffer()),x=.5,I=1;return t.onProgress==null?yield Promise.all(g):yield Ah(g,t.onProgress,x,I)})}function Vd(r,t="",n,o){return Wr(this,null,function*(){return pd(p=>Wd(p,{requestInit:o}))(r,t,n)})}function pd(r){return(t,n="",o)=>Wr(this,null,function*(){const u=t.map(()=>!1),h={},p=o!=null?o.map(()=>!1):[],g=[];if(t.forEach((Et,St)=>{let Tt=0;Et.weights.forEach(Vt=>{const ue="quantization"in Vt?Vt.quantization.dtype:Vt.dtype,ye=Pc[ue]*Rt(Vt.shape),qe=()=>{u[St]=!0,h[St]==null&&(h[St]=[]),h[St].push({manifestEntry:Vt,groupOffset:Tt,sizeBytes:ye})};o!=null?o.forEach(($e,Xe)=>{$e===Vt.name&&(qe(),p[Xe]=!0)}):qe(),g.push(Vt.name),Tt+=ye})}),!p.every(Et=>Et)){const Et=o.filter((St,Tt)=>!p[Tt]);throw new Error(`Could not find weights in manifest with names: ${Et.join(", ")}. 
Manifest JSON has weights with names: ${g.join(", ")}.`)}const x=u.reduce((Et,St,Tt)=>(St&&Et.push(Tt),Et),[]),I=[];x.forEach(Et=>{t[Et].paths.forEach(St=>{const Tt=n+(n.endsWith("/")?"":"/")+St;I.push(Tt)})});const z=yield r(I),V={};let rt=0;return x.forEach(Et=>{const St=t[Et].paths.length;let Tt=0;for(let $e=0;$e<St;$e++)Tt+=z[rt+$e].byteLength;const Vt=new ArrayBuffer(Tt),ue=new Uint8Array(Vt);let ye=0;for(let $e=0;$e<St;$e++){const Xe=new Uint8Array(z[rt+$e]);ue.set(Xe,ye),ye+=Xe.byteLength}h[Et].forEach($e=>{const Xe=Vt.slice($e.groupOffset,$e.groupOffset+$e.sizeBytes),Pn=yh(Xe,[$e.manifestEntry]);for(const In in Pn)V[In]=Pn[In]}),rt+=St}),V})}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xp="application/octet-stream",vd="application/json";class jd{constructor(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(yt(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=Ve().platform.fetch,yt(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&yt(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}save(t){return Wr(this,null,function*(){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const o=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],u={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:o};t.signature!=null&&(u.signature=t.signature),t.userDefinedMetadata!=null&&(u.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(u.modelInitializer=t.modelInitializer),n.body.append("model.json",new Blob([JSON.stringify(u)],{type:vd}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:xp}),"model.weights.bin");const h=yield this.fetch(this.path,n);if(h.ok)return{modelArtifactsInfo:gf(t),responses:[h]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${h.status}.`)})}load(){return Wr(this,null,function*(){const t=yield this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=yield t.json()}catch(St){let Tt=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?Tt+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":Tt+=" Please make sure the server is serving valid JSON for this request.",new Error(Tt)}const o=n.modelTopology,u=n.weightsManifest,h=n.generatedBy,p=n.convertedBy,g=n.format,x=n.signature,I=n.userDefinedMetadata;if(o==null&&u==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);let z,V;u!=null&&([z,V]=yield this.loadWeights(u));const rt={modelTopology:o,weightSpecs:z,weightData:V,generatedBy:h,convertedBy:p,format:g};x!=null&&(rt.signature=x),I!=null&&(rt.userDefinedMetadata=I);const Et=n.modelInitializer;return Et&&(rt.modelInitializer=Et),rt})}loadWeights(t){return Wr(this,null,function*(){const n=Array.isArray(this.path)?this.path[1]:this.path,[o,u]=kf(n),h=this.weightPathPrefix||o,p=[];for(const z of t)p.push(...z.weights);const g=[],x=[];for(const z of t)for(const V of z.paths)this.weightUrlConverter!=null?x.push(this.weightUrlConverter(V)):g.push(h+V+u);this.weightUrlConverter&&g.push(...yield Promise.all(x));const I=yield Wd(g,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[p,vf(I)]})}}jd.URL_SCHEME_REGEX=/^https?:\/\//;function kf(r){const t=r.lastIndexOf("/"),n=r.lastIndexOf("?"),o=r.substring(0,t),u=n>t?r.substring(n):"";return[o+"/",u]}function Hd(r){return r.match(jd.URL_SCHEME_REGEX)!=null}const wp=(r,t)=>{if(typeof fetch=="undefined"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(r)?n=r.every(o=>Hd(o)):n=Hd(r),n)return Xd(r,t)}return null};il.registerSaveRouter(wp),il.registerLoadRouter(wp);function Xd(r,t){return new jd(r,t)}function Mh(r,t){return Xd(r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zh{constructor(t){this.modelArtifacts=t}load(){return Wr(this,null,function*(){return this.modelArtifacts})}}class Ep{constructor(t){this.saveHandler=t}save(t){return Wr(this,null,function*(){return this.saveHandler(t)})}}function Nh(r,t,n,o){return arguments.length===1?r.modelTopology!=null||r.weightSpecs!=null?new Zh(r):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Zh({modelTopology:r})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Zh({modelTopology:r,weightSpecs:t,weightData:n,trainingConfig:o}))}function Sp(r){return new Ep(r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lh(r,t,n=!1,o=!1){let u=pn(r,"a","matMul"),h=pn(t,"b","matMul");[u,h]=Ci(u,h);const p={a:u,b:h},g={transposeA:n,transposeB:o};return dr.runKernel(Ei,p,g)}const Zs=br({matMul_:lh});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ch(r,t,n=1,o=0){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const h={indices:pn(r,"indices","oneHot","int32")},p={depth:t,onValue:n,offValue:o};return dr.runKernel(Va,h,p)}const Df=br({oneHot_:ch});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iv(r,t){const n=pn(r,"x","transpose");if(t==null&&(t=n.shape.map((h,p)=>p).reverse()),yt(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of perm ${t}.`),t.forEach(h=>{yt(h>=0&&h<n.rank,()=>`All entries in 'perm' must be between 0 and ${n.rank-1} but got ${t}`)}),n.rank<=1)return n.clone();const o={x:n},u={perm:t};return dr.runKernel(Lo,o,u)}const cu=br({transpose_:Iv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yd(r,t,n){const o=pn(r,"labels","confusionMatrix"),u=pn(t,"predictions","confusionMatrix");yt(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),yt(o.rank===1,()=>`Expected the rank of labels to be 1, but got ${o.rank}`),yt(u.rank===1,()=>`Expected the rank of predictions to be 1, but got ${u.rank}`),yt(o.shape[0]===u.shape[0],()=>`Mismatch in the number of examples: ${o.shape[0]} vs. ${u.shape[0]}. Labels and predictions should have the same number of elements.`),yt(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const h=Df(eo(o,"int32"),n),p=Df(eo(u,"int32"),n),g=cu(h),x=Zs(g,p);return eo(x,"int32")}const Tv=br({confusionMatrix_:Yd});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qp(r,t,n){if(tn(r),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const o=_l(r,n);if(o.length!==3&&o.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(o.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Lc(r,t,o,n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Yc;function Qp(r,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(r==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,o=!1,u=!1,h=!1,p=!1,g=!1;if(r.data instanceof Uint8Array)n=!0;else if(typeof ImageData!="undefined"&&r instanceof ImageData)o=!0;else if(typeof HTMLVideoElement!="undefined"&&r instanceof HTMLVideoElement)u=!0;else if(typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement)h=!0;else if(r.getContext!=null)p=!0;else if(typeof ImageBitmap!="undefined"&&r instanceof ImageBitmap)g=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${r.constructor.name}`);if(u){const St=2;if(u&&r.readyState<St)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(pf(Uu,dr.backendName)!=null){const St={pixels:r},Tt={numChannels:t};return dr.runKernel(Uu,St,Tt)}const[I,z]=u?[r.videoWidth,r.videoHeight]:[r.width,r.height];let V;p?V=r.getContext("2d").getImageData(0,0,I,z).data:o||n?V=r.data:(h||u||g)&&(Yc==null&&(Yc=document.createElement("canvas").getContext("2d")),Yc.canvas.width=I,Yc.canvas.height=z,Yc.drawImage(r,0,0,I,z),V=Yc.getImageData(0,0,I,z).data);let rt;if(t===4)rt=new Int32Array(V);else{const St=I*z;rt=new Int32Array(St*t);for(let Tt=0;Tt<St;Tt++)for(let Vt=0;Vt<t;++Vt)rt[Tt*t+Vt]=V[Tt*4+Vt]}return qp(rt,[z,I,t],"int32")}function Av(r,t){return Wr(this,null,function*(){let n=pn(r,"img","toPixels");if(!(r instanceof Dn)){const I=n;n=eo(I,"int32"),I.dispose()}if(n.rank!==2&&n.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const[o,u]=n.shape.slice(0,2),h=n.rank===2?1:n.shape[2];if(h>4||h===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${h}`);if(n.dtype!=="float32"&&n.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`);const p=yield n.data(),g=n.dtype==="float32"?255:1,x=new Uint8ClampedArray(u*o*4);for(let I=0;I<o*u;++I){const z=[0,0,0,255];for(let rt=0;rt<h;rt++){const Et=p[I*h+rt];if(n.dtype==="float32"){if(Et<0||Et>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${Et}.`)}else if(n.dtype==="int32"&&(Et<0||Et>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${Et}.`);h===1?(z[0]=Et*g,z[1]=Et*g,z[2]=Et*g):z[rt]=Et*g}const V=I*4;x[V+0]=Math.round(z[0]),x[V+1]=Math.round(z[1]),x[V+2]=Math.round(z[2]),x[V+3]=Math.round(z[3])}if(t!=null){t.width=u,t.height=o;const I=t.getContext("2d"),z=new ImageData(x,u,o);I.putImageData(z,0,0)}return n!==r&&n.dispose(),x})}const qh=br({fromPixels_:Qp});function Jp(r,t){const n=r.shape.length,o=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(o<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${o}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[o-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[o-1]} vs. ${n}`);if(Rt(r.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${r.shape}.`);const u=t.shape,h=u[u.length-1];let p=1;for(let V=0;V<u.length-1;++V)p*=u[V];const g=r.shape,x=u.slice();x.pop();let I=1;for(let V=h;V<n;++V)I*=g[V],x.push(g[V]);const z=[...vt(r.shape).map(V=>V/I),1].slice(0,h);return[x,p,I,z]}function Mv(r,t,n){const o=t.rank>1?t.shape[t.rank-1]:1,u=t.rank>1?t.rank-1:1,h=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${r}, sliceDim: ${o}, and batchDim: ${u}.`;if(n.rank<u)throw new Error(h+` update.rank < ${u}. `);if(r.length<o+(n.rank-u))throw new Error(h+` Output shape length < ${o+(n.rank-u)}`);if(n.rank!==u+r.length-o)throw new Error(h+` update.rank != ${u+r.length-o}`);for(let p=0;p<u;++p)if(n.shape[p]!==t.shape[p])throw new Error(h+` updates.shape[${p}] (${n.shape[p]}) != indices.shape[${p}] (${t.shape[p]}).`);for(let p=0;p<n.rank-u;++p)if(n.shape[p+u]!==r[p+o])throw new Error(h+` updates.shape[${p+u}] (${n.shape[p+u]}) != shape[${p+u}] (${r[p+u]})`)}function Nv(r,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(r.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${r.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(r.size===0)throw new Error(`Updates specified for empty output. updates shape: ${r.shape}`)}Mv(n,t,r)}function Bl(r,t,n){const o=t.shape.length,u=o>1?t.shape[o-1]:1,h=n.length;let p=1;for(let V=u;V<h;++V)p*=n[V];const g=u<1?1:u,x=Rt(t.shape)/g,I=[...vt(n.slice(0,u)),1],z=Rt(n);return{sliceRank:u,numUpdates:x,sliceSize:p,strides:I,outputSize:z}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gd(r,t,n){const o=r.shape.length;yt(o===t.length,()=>`Error in slice${o}D: Length of begin ${t} must match the rank of the array (${o}).`),yt(o===n.length,()=>`Error in slice${o}D: Length of size ${n} must match the rank of the array (${o}).`);for(let u=0;u<o;++u)yt(t[u]+n[u]<=r.shape[u],()=>`Error in slice${o}D: begin[${u}] + size[${u}] (${t[u]+n[u]}) would overflow input.shape[${u}] (${r.shape[u]})`)}function Of(r){const t=[];let n=0;for(;r>0;)r&1&&t.push(n),r/=2,n++;return t}function kh(r,t,n){const o=[];for(let u=0;u<r.length;u++)o[u]=Math.ceil((t[u]-r[u])/n[u]);return o}function kv(r,t,n,o){const u=[...r];for(let h=u.length;h<o.length;h++)u.push(1);for(let h=0;h<n;h++)h===0?u[t]=1:(u.splice(t,0,1),u.pop());return u}function md(r,t,n){return n<=r?n:n-(t-1)}function Kd(r,t){const n=[];for(let o=0;o<r;o++)n.push(t+o);return n}function tv(r,t,n,o,u,h,p,g,x){const I=r.length;let z=new Array(I),V=new Array(I),rt=new Array(I);if(t.length&&n>0){const Et=t[0],St=n+1;z=Bc(p,Et,St,o,r),V=Vf(g,Et,St,u,r),rt=kv(h,Et,St,r)}else for(let Et=0;Et<I;Et++)z[Et]=vc(p,o,h,r,Et,x),V[Et]=yd(g,u,h,r,Et,x),rt[Et]=zl(h,Et,x);return{begin:z,end:V,strides:rt}}function Bc(r,t,n,o,u){const h=[...u],p=Kd(n,t);for(let g=0;g<h.length;g++)if(p.indexOf(g)>-1)h[g]=0;else{const x=md(t,n,g);let I=o[x];r&1<<x&&(I=0),h[g]=I}return h}function Vf(r,t,n,o,u){const h=[...u],p=Kd(n,t);for(let g=0;g<h.length;g++)if(p.indexOf(g)>-1)h[g]=Number.MAX_SAFE_INTEGER;else{const x=md(t,n,g);let I=o[x];r&1<<x&&(I=Number.MAX_SAFE_INTEGER),h[g]=I}for(let g=0;g<h.length;g++){const x=u[g];h[g]<0&&(h[g]+=x),h[g]=te(0,h[g],u[g])}return h}function zl(r,t,n){let o=r[t];return(n&1<<t||o==null)&&(o=1),o}function vc(r,t,n,o,u,h){let p=t[u];const g=n[u]||1;(r&1<<u||h&1<<u||p==null)&&(g>0?p=Number.MIN_SAFE_INTEGER:p=Number.MAX_SAFE_INTEGER);const x=o[u];return p<0&&(p+=x),p=te(0,p,x-1),p}function yd(r,t,n,o,u,h){let p=t[u];const g=n[u]||1;(r&1<<u||h&1<<u||p==null)&&(g>0?p=Number.MAX_SAFE_INTEGER:p=Number.MIN_SAFE_INTEGER);const x=o[u];return p<0&&(p+=x),g>0?p=te(0,p,x):p=te(-1,p,x-1),p}function Dv(r,t,n){let o=n.length;for(let u=0;u<n.length;u++)if(n[u]>1){o=u;break}for(let u=o+1;u<n.length;u++)if(t[u]>0||n[u]!==r[u])return!1;return!0}function ev(r,t){let n=r.length>0?r[r.length-1]:1;for(let o=0;o<r.length-1;o++)n+=r[o]*t[o];return n}function Zd(r,t,n){let o;const u=r.shape.length;typeof t=="number"?o=[t,...new Array(u-1).fill(0)]:t.length<u?o=t.concat(new Array(u-t.length).fill(0)):o=t.slice(),o.forEach(p=>{yt(p!==-1,()=>"slice() does not support negative begin indexing.")});let h;return n==null?h=new Array(u).fill(-1):typeof n=="number"?h=[n,...new Array(u-1).fill(-1)]:n.length<u?h=n.concat(new Array(u-n.length).fill(-1)):h=n,h=h.map((p,g)=>p>=0?p:(yt(p===-1,()=>`Negative size values should be exactly -1 but got ${p} for the slice() size at index ${g}.`),r.shape[g]-o[g])),[o,h]}function nv(r,t,n,o,u,h,p,g,x){let I=t.slice(),z=n.slice(),V=o;o==null&&(V=new Array(I.length));const rt=Of(p);if(rt.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(p!==0&&g!==0)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(p!==0&&x!==0)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");const Et=r.length-I.length,St=Of(g),Tt=r.slice();St.forEach(In=>{I[In]=0,z[In]=1,Tt.splice(In,0,1)});const{begin:Vt,end:ue,strides:ye}=tv(Tt,rt,Et,I,z,V,u,h,p);I=Vt,z=ue,V=ye;const qe=Of(x);qe.forEach(In=>{z[In]=I[In]+1,V[In]=1});const $e=kh(I,z,V),Xe=$e.filter((In,gr)=>qe.indexOf(gr)===-1);return{nonStrided:V.every(In=>In===1),$begin:I,$end:z,$strides:V,size:$e,newShape:Tt,outShape:Xe}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dh{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class lf{constructor(){this.classNameMap={}}static getMap(){return lf.instance==null&&(lf.instance=new lf),lf.instance}static register(t){lf.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function ci(r){yt(r.className!=null,()=>"Class being registered does not have the static className property defined."),yt(typeof r.className=="string",()=>"className is required to be a string, but got type "+typeof r.className),yt(r.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),lf.register(r)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rv=.001,av=.1;function rg(r,t,n){return n==null&&(n=qd()),Qh(r,t,(o,u)=>Cp(o,u,n))}function qd(){return dr.backend.floatPrecision()===32?rv:av}function Qh(r,t,n){let o=!0;if((Hr(r)||Hr(t))&&(o=!1),Hr(r)&&Hr(t)&&(o=!0),o){const p=r.constructor.name,g=t.constructor.name;if(p!==g)throw new Error(`Arrays are of different type. Actual: ${p}. Expected: ${g}`)}if(Array.isArray(r)&&Array.isArray(t)){const p=_l(r),g=_l(t);if(!Un(p,g))throw new Error(`Arrays have different shapes. Actual: [${p}]. Expected: [${g}]`)}const u=Hr(r)?r:fn(r),h=Hr(t)?t:fn(t);if(u.length!==h.length)throw new Error(`Arrays have different lengths actual: ${u.length} vs expected: ${h.length}.
Actual:   ${u}.
Expected: ${h}.`);for(let p=0;p<h.length;++p){const g=u[p],x=h[p];if(!n(g,x))throw new Error(`Arrays differ: actual[${p}] = ${g}, expected[${p}] = ${x}.
Actual:   ${u}.
Expected: ${h}.`)}}function jf(r,t){r().then(()=>t.fail(),()=>t())}function ag(r,t){const n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return Cr(r)||Cr(r[0])||Cr(t)||Cr(t[0])?Qh(r,n,(o,u)=>o==u):Qh(r,t,(o,u)=>Cp(o,u,0))}function Ov(r,t,n){if(n==null&&(n=qd()),!Cp(r,t,n))throw new Error(`Numbers differ: actual === ${r}, expected === ${t}`)}function Cp(r,t,n){return!isFinite(r)&&!isFinite(t)?!0:!(isNaN(r)||isNaN(t)||Math.abs(r-t)>n)}function Zl(r,t,n){for(let o=0;o<r.length;o++)if(r[o]<t||r[o]>n)throw new Error(`Value out of range:${r[o]} low: ${t}, high: ${n}`)}function ce(r,t){expect(new Float32Array(r)).toEqual(new Float32Array(t))}function vn(r){for(let t=0;t<r.length;t++){const n=r[t];Array.isArray(n)?vn(n):r[t]=oc(n)}return r}/** @license See the LICENSE file. */const er="2.8.6";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ia(){Ve().set("PROD",!0)}function da(){Ve().set("DEBUG",!0)}function aa(){Ve().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function na(r){Ve().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}la(na);function Xa(){dr.disposeVariables()}function Oa(){return dr}function Qa(){return dr.memory()}function Ka(r){return dr.profile(r)}function zn(r,t){return dr.tidy(r,t)}function N(r){Xi(r).forEach(n=>n.dispose())}function q(r){return dr.keep(r)}function ht(r){return dr.time(r)}function It(r){return dr.setBackend(r)}function Ft(){return dr.ready()}function Xt(){return dr.backendName}function oe(r){dr.removeBackend(r)}function he(r){return dr.findBackend(r)}function Te(r){return dr.findBackendFactory(r)}function Ye(r,t,n=1){return dr.registerBackend(r,t,n)}function gn(){return dr.backend}function cn(r,t){Ve().setPlatform(r,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vn(r,t){let n=pn(r,"a","add"),o=pn(t,"b","add");[n,o]=Ci(n,o);const u={a:n,b:o};return dr.runKernel(Ni,u)}const An=br({add_:Vn});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ma(r,t){let n=pn(r,"a","floorDiv"),o=pn(t,"b","floorDiv");[n,o]=Ci(n,o);const u={a:n,b:o};return dr.runKernel(to,u)}const Or=br({floorDiv_:ma});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fr(r,t){let n=pn(r,"a","div"),o=pn(t,"b","div");if([n,o]=Ci(n,o),n.dtype==="int32"&&o.dtype==="int32")return Or(n,o);const u={a:n,b:o},h={};return dr.runKernel(Vs,u,h)}const rr=br({div_:Fr});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Za(r,t){let n=pn(r,"a","mul"),o=pn(t,"b","mul");[n,o]=Ci(n,o);const u={a:n,b:o};return dr.runKernel(ge,u)}const Xn=br({mul_:Za});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ii(r){const n={x:pn(r,"x","sqrt")};return dr.runKernel(Qe,n)}const Ti=br({sqrt_:ii});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ki(r){const t=pn(r,"x","square"),n={};return dr.runKernel("Square",{x:t},n)}const Ai=br({square_:Ki});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yo(r){const n={x:pn(r,"x","zerosLike")};return dr.runKernel(qu,n)}const bi=br({zerosLike_:Yo});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lu(r){return yt(ra(r),()=>"The f passed in grad(f) must be a function"),(t,n)=>{const o=pn(t,"x","tf.grad","string_or_numeric"),u=n!=null?pn(n,"dy","tf.grad"):null;return dr.tidy(()=>{const{value:h,grads:p}=dr.gradients(()=>r(o),[o],u);return u!=null&&Ne(h.shape,u.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),gu(p),p[0]})}}function as(r){return yt(ra(r),()=>"The f passed in grads(f) must be a function"),(t,n)=>{yt(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const o=nh(t,"args","tf.grads","string_or_numeric"),u=n!=null?pn(n,"dy","tf.grads"):null;return dr.tidy(()=>{const{value:h,grads:p}=dr.gradients(()=>r(...o),o,u);return u!=null&&Ne(h.shape,u.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),gu(p),p})}}function gl(r){return yt(ra(r),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{yt(t instanceof Dn,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),yt(n==null||n instanceof Dn,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:o,value:u}=dr.gradients(()=>r(t),[t],n);return gu(o),{grad:o[0],value:u}}}function fu(r){return yt(ra(r),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{yt(Array.isArray(t)&&t.every(u=>u instanceof Dn),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),yt(n==null||n instanceof Dn,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const o=dr.gradients(()=>r(...t),t,n);return n!=null&&Ne(o.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),gu(o.grads),o}}function Rs(r,t){yt(ra(r),()=>"The f passed in variableGrads(f) must be a function"),yt(t==null||Array.isArray(t)&&t.every(I=>I instanceof Ga),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const I in dr.registeredVariables)t.push(dr.registeredVariables[I])}const o=n?t.filter(I=>!I.trainable):null,u=t.length;t=t.filter(I=>I.trainable),yt(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${u} variables is trainable.`);const h=!0,{value:p,grads:g}=dr.gradients(r,t,null,h);yt(g.some(I=>I!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),yt(p.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${p.rank} tensor`);const x={};return t.forEach((I,z)=>{g[z]!=null&&(x[I.name]=g[z])}),o!=null&&o.forEach(I=>x[I.name]=null),{value:p,grads:x}}function Eu(r){return dr.customGrad(r)}function gu(r){if(r.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zi(r,t){if((Hr(r)&&t!=="string"||Array.isArray(r))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Hr(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Lc(r,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ul extends Dh{minimize(t,n=!1,o){const{value:u,grads:h}=this.computeGradients(t,o);if(o!=null){const p=o.map(g=>({name:g.name,tensor:h[g.name]}));this.applyGradients(p)}else this.applyGradients(h);return N(h),n?u:(u.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return Rs(t,n)}dispose(){this.iterations_!=null&&N(this.iterations_)}saveIterations(){return Wr(this,null,function*(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:zi(this.iterations_,"int32")}})}getWeights(){return Wr(this,null,function*(){throw new Error("getWeights() is not implemented for this optimizer yet.")})}setWeights(t){return Wr(this,null,function*(){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)})}extractIterations(t){return Wr(this,null,function*(){return this.iterations_=(yield t[0].tensor.data())[0],t.slice(1)})}}Object.defineProperty(ul,Symbol.hasInstance,{value:r=>r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ml extends ul{constructor(t,n,o=null){super();this.learningRate=t,this.rho=n,this.epsilon=o,this.accumulatedGrads=[],this.accumulatedUpdates=[],o==null&&(this.epsilon=dr.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(o=>o.name):Object.keys(t)).forEach((o,u)=>{const h=dr.registeredVariables[o],p=!1;this.accumulatedGrads[u]==null&&(this.accumulatedGrads[u]={originalName:`${o}/accum_grad`,variable:zn(()=>bi(h).variable(p))}),this.accumulatedUpdates[u]==null&&(this.accumulatedUpdates[u]={originalName:`${o}/accum_var`,variable:zn(()=>bi(h).variable(p))});const g=Array.isArray(t)?t[u].tensor:t[o];if(g==null)return;const x=this.accumulatedGrads[u].variable,I=this.accumulatedUpdates[u].variable;zn(()=>{const z=An(Xn(x,this.rho),Xn(Ai(g),1-this.rho)),V=Xn(rr(Ti(An(I,this.epsilon)),Ti(An(x,this.epsilon))),g),rt=An(Xn(I,this.rho),Xn(Ai(V),1-this.rho));x.assign(z),I.assign(rt);const Et=An(Xn(V,-this.learningRate),h);h.assign(Et)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(N(this.accumulatedGrads.map(t=>t.variable)),N(this.accumulatedUpdates.map(t=>t.variable)))}getWeights(){return Wr(this,null,function*(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[yield this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(t){return Wr(this,null,function*(){t=yield this.extractIterations(t);const n=t.length/2,o=!1;this.accumulatedGrads=t.slice(0,n).map(u=>({originalName:u.name,variable:u.tensor.variable(o)})),this.accumulatedUpdates=t.slice(n,n*2).map(u=>({originalName:u.name,variable:u.tensor.variable(o)}))})}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}ml.className="Adadelta",ci(ml);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jo(r,t,n){const o={shape:r,value:t,dtype:n};return dr.runKernel(Ra,{},o)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vl extends ul{constructor(t,n=.1){super();this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(o=>o.name):Object.keys(t)).forEach((o,u)=>{const h=dr.registeredVariables[o];if(this.accumulatedGrads[u]==null){const x=!1;this.accumulatedGrads[u]={originalName:`${o}/accumulator`,variable:zn(()=>Jo(h.shape,this.initialAccumulatorValue).variable(x))}}const p=Array.isArray(t)?t[u].tensor:t[o];if(p==null)return;const g=this.accumulatedGrads[u].variable;zn(()=>{const x=An(g,Ai(p));g.assign(x);const I=An(Xn(rr(p,Ti(An(x,dr.backend.epsilon()))),-this.learningRate),h);h.assign(I)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&N(this.accumulatedGrads.map(t=>t.variable))}getWeights(){return Wr(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))})}setWeights(t){return Wr(this,null,function*(){t=yield this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(o=>({originalName:o.name,variable:o.tensor.variable(n)}))})}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}Vl.className="Adagrad",ci(Vl);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Su(r,t){let n=pn(r,"base","pow"),o=pn(t,"exp","pow");[n,o]=Ci(n,o);const u={a:n,b:o};return dr.runKernel(Di,u)}const co=br({pow_:Su});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ls(r,t){let n=pn(r,"a","sub"),o=pn(t,"b","sub");[n,o]=Ci(n,o);const u={a:n,b:o};return dr.runKernel(Ar,u)}const pi=br({sub_:Ls});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ll extends ul{constructor(t,n,o,u=null){super();this.learningRate=t,this.beta1=n,this.beta2=o,this.epsilon=u,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],zn(()=>{this.accBeta1=zi(n).variable(),this.accBeta2=zi(o).variable()}),u==null&&(this.epsilon=dr.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);zn(()=>{const o=pi(1,this.accBeta1),u=pi(1,this.accBeta2);n.forEach((h,p)=>{const g=dr.registeredVariables[h],x=!1;this.accumulatedFirstMoment[p]==null&&(this.accumulatedFirstMoment[p]={originalName:`${h}/m`,variable:zn(()=>bi(g).variable(x))}),this.accumulatedSecondMoment[p]==null&&(this.accumulatedSecondMoment[p]={originalName:`${h}/v`,variable:zn(()=>bi(g).variable(x))});const I=Array.isArray(t)?t[p].tensor:t[h];if(I==null)return;const z=this.accumulatedFirstMoment[p].variable,V=this.accumulatedSecondMoment[p].variable,rt=An(Xn(z,this.beta1),Xn(I,1-this.beta1)),Et=An(Xn(V,this.beta2),Xn(Ai(I),1-this.beta2)),St=rr(rt,o),Tt=rr(Et,u);z.assign(rt),V.assign(Et);const Vt=An(Xn(rr(St,An(Ti(Tt),this.epsilon)),-this.learningRate),g);g.assign(Vt)}),this.accBeta1.assign(Xn(this.accBeta1,this.beta1)),this.accBeta2.assign(Xn(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&N(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&N(this.accumulatedSecondMoment.map(t=>t.variable))}getWeights(){return Wr(this,null,function*(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[yield this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(t){return Wr(this,null,function*(){t=yield this.extractIterations(t),zn(()=>{this.accBeta1.assign(co(this.beta1,this.iterations_+1)),this.accBeta2.assign(co(this.beta2,this.iterations_+1))});const n=t.length/2,o=!1;this.accumulatedFirstMoment=t.slice(0,n).map(u=>({originalName:u.name,variable:u.tensor.variable(o)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(u=>({originalName:u.name,variable:u.tensor.variable(o)}))})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}ll.className="Adam",ci(ll);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hf(r){const t=pn(r,"x","abs");if(t.dtype==="complex64"){const n={x:t};return dr.runKernel(gi,n)}else{const n={x:t};return dr.runKernel(La,n)}}const bl=br({abs_:Hf});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wn(r,t){const n=r.length,o=[];for(let u=0;u<n;u++){const h=n-1-u,p=r[h]||1;(t[t.length-1-u]||1)>1&&p===1&&o.unshift(h)}return o}function Jr(r,t){const n=[];for(let o=0;o<t.length;o++){const u=r[r.length-o-1],h=t.length-o-1,p=t[h];(u==null||u===1&&p>1)&&n.unshift(h)}return n}function Nr(r,t){const n=[],o=Math.max(r.length,t.length);for(let u=0;u<o;u++){let h=r[r.length-u-1];h==null&&(h=1);let p=t[t.length-u-1];if(p==null&&(p=1),h===1)n.unshift(p);else if(p===1)n.unshift(h);else if(h!==p){const g=`Operands could not be broadcast together with shapes ${r} and ${t}.`;throw Error(g)}else n.unshift(h)}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ji(r,t){let n=pn(r,"a","maximum"),o=pn(t,"b","maximum");[n,o]=Ci(n,o),n.dtype==="bool"&&(n=eo(n,"int32"),o=eo(o,"int32")),Nr(n.shape,o.shape);const u={a:n,b:o};return dr.runKernel(vl,u)}const Po=br({maximum_:ji});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nn extends ul{constructor(t,n,o,u=null,h=0){super();this.learningRate=t,this.beta1=n,this.beta2=o,this.epsilon=u,this.decay=h,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],zn(()=>{this.iteration=zi(0).variable(),this.accBeta1=zi(n).variable()}),u==null&&(this.epsilon=dr.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);zn(()=>{const o=pi(1,this.accBeta1),u=rr(-this.learningRate,An(Xn(this.iteration,this.decay),1));n.forEach((h,p)=>{const g=dr.registeredVariables[h],x=!1;this.accumulatedFirstMoment[p]==null&&(this.accumulatedFirstMoment[p]={originalName:`${h}/m`,variable:bi(g).variable(x)}),this.accumulatedWeightedInfNorm[p]==null&&(this.accumulatedWeightedInfNorm[p]={originalName:`${h}/v`,variable:bi(g).variable(x)});const I=Array.isArray(t)?t[p].tensor:t[h];if(I==null)return;const z=this.accumulatedFirstMoment[p].variable,V=this.accumulatedWeightedInfNorm[p].variable,rt=An(Xn(z,this.beta1),Xn(I,1-this.beta1)),Et=Xn(V,this.beta2),St=bl(I),Tt=Po(Et,St);z.assign(rt),V.assign(Tt);const Vt=An(Xn(rr(u,o),rr(rt,An(Tt,this.epsilon))),g);g.assign(Vt)}),this.iteration.assign(An(this.iteration,1)),this.accBeta1.assign(Xn(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&N(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&N(this.accumulatedWeightedInfNorm.map(t=>t.variable))}getWeights(){return Wr(this,null,function*(){throw new Error("getWeights() is not implemented for Adamax yet.")})}setWeights(t){return Wr(this,null,function*(){throw new Error("setWeights() is not implemented for Adamax yet.")})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}Nn.className="Adamax",ci(Nn);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ln extends ul{constructor(t){super();this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(o=>o.name):Object.keys(t)).forEach((o,u)=>{const h=Array.isArray(t)?t[u].tensor:t[o];if(h==null)return;const p=dr.registeredVariables[o];zn(()=>{const g=An(Xn(this.c,h),p);p.assign(g)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=q(zi(-t))}dispose(){this.c.dispose()}getWeights(){return Wr(this,null,function*(){return[yield this.saveIterations()]})}setWeights(t){return Wr(this,null,function*(){if(t=yield this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")})}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}ln.className="SGD",ci(ln);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fr extends ln{constructor(t,n,o=!1){super(t);this.learningRate=t,this.momentum=n,this.useNesterov=o,this.accumulations=[],this.m=zi(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(o=>o.name):Object.keys(t)).forEach((o,u)=>{const h=dr.registeredVariables[o];if(this.accumulations[u]==null){const x=!1;this.accumulations[u]={originalName:`${o}/momentum`,variable:zn(()=>bi(h).variable(x))}}const p=this.accumulations[u].variable,g=Array.isArray(t)?t[u].tensor:t[o];g!=null&&zn(()=>{let x;const I=An(Xn(this.m,p),g);this.useNesterov?x=An(Xn(this.c,An(g,Xn(I,this.m))),h):x=An(Xn(this.c,I),h),p.assign(I),h.assign(x)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&N(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}getWeights(){return Wr(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))})}setWeights(t){return Wr(this,null,function*(){t=yield this.extractIterations(t);const n=!1;this.accumulations=t.map(o=>({originalName:o.name,variable:o.tensor.variable(n)}))})}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}fr.className="Momentum",ci(fr);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pr extends ul{constructor(t,n=.9,o=0,u=null,h=!1){super();if(this.learningRate=t,this.decay=n,this.momentum=o,this.epsilon=u,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=h,u==null&&(this.epsilon=dr.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(o=>o.name):Object.keys(t)).forEach((o,u)=>{const h=dr.registeredVariables[o],p=!1;this.accumulatedMeanSquares[u]==null&&(this.accumulatedMeanSquares[u]={originalName:`${o}/rms`,variable:zn(()=>bi(h).variable(p))}),this.accumulatedMoments[u]==null&&(this.accumulatedMoments[u]={originalName:`${o}/momentum`,variable:zn(()=>bi(h).variable(p))}),this.accumulatedMeanGrads[u]==null&&this.centered&&(this.accumulatedMeanGrads[u]={originalName:`${o}/mg`,variable:zn(()=>bi(h).variable(p))});const g=Array.isArray(t)?t[u].tensor:t[o];if(g==null)return;const x=this.accumulatedMeanSquares[u].variable,I=this.accumulatedMoments[u].variable;zn(()=>{const z=An(Xn(x,this.decay),Xn(Ai(g),1-this.decay));if(this.centered){const V=this.accumulatedMeanGrads[u].variable,rt=An(Xn(V,this.decay),Xn(g,1-this.decay)),Et=rr(Xn(g,this.learningRate),Ti(pi(z,An(Ai(rt),this.epsilon)))),St=An(Xn(I,this.momentum),Et);x.assign(z),V.assign(rt),I.assign(St);const Tt=pi(h,St);h.assign(Tt)}else{const V=An(Xn(x,this.decay),Xn(Ai(g),1-this.decay)),rt=An(Xn(I,this.momentum),rr(Xn(g,this.learningRate),Ti(An(V,this.epsilon))));x.assign(V),I.assign(rt);const Et=pi(h,rt);h.assign(Et)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&N(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&N(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&N(this.accumulatedMoments.map(t=>t.variable))}getWeights(){return Wr(this,null,function*(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[yield this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(t){return Wr(this,null,function*(){t=yield this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,o=!1;this.accumulatedMeanSquares=t.slice(0,n).map(u=>({originalName:u.name,variable:u.tensor.variable(o)})),this.accumulatedMoments=t.slice(n,n*2).map(u=>({originalName:u.name,variable:u.tensor.variable(o)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(u=>({originalName:u.name,variable:u.tensor.variable(o)})))})}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}Pr.className="RMSProp",ci(Pr);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vr(r){const n={x:pn(r,"x","acos")};return dr.runKernel(ha,n)}const mr=br({acos_:Vr});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hr(r){const n={x:pn(r,"x","acosh")};return dr.runKernel(_i,n)}const Mr=br({acosh_:hr});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function On(r){yt(Array.isArray(r),()=>"The argument passed to tf.addN() must be a list of tensors"),yt(r.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${r.length}`);const t=r.map((u,h)=>pn(u,`tensors${h}`,"addN")),n=t[0];t.forEach(u=>{if(u.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(u=>{if(!Un(u.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const o=t;return dr.runKernel(vi,o)}const ur=br({addN_:On});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cn(r,t=null,n=!1){const u={x:pn(r,"x","all","bool")},h={axis:t,keepDims:n};return dr.runKernel(si,u,h)}const Dr=br({all_:Cn});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qr(r,t=null,n=!1){const u={x:pn(r,"x","any","bool")},h={axis:t,keepDims:n};return dr.runKernel(Mi,u,h)}const _a=br({any_:Qr});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ma(r,t=0){const o={x:pn(r,"x","argMax")},u={axis:t};return dr.runKernel(Pa,o,u)}const ga=br({argMax_:Ma});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ai(r,t=0){const o={x:pn(r,"x","argMin")},u={axis:t};return dr.runKernel(un,o,u)}const uo=br({argMin_:ai});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bs(r){const n={x:pn(r,"x","asin")};return dr.runKernel(Oe,n)}const Hi=br({asin_:bs});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ho(r){const n={x:pn(r,"x","asinh")};return dr.runKernel(hn,n)}const No=br({asinh_:ho});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function au(r){const n={x:pn(r,"x","atan")};return dr.runKernel(Hn,n)}const xl=br({atan_:au});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uc(r,t){let n=pn(r,"a","atan2"),o=pn(t,"b","atan2");[n,o]=Ci(n,o);const u={a:n,b:o};return dr.runKernel(Jn,u)}const Rv=br({atan2_:uc});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xf(r){const n={x:pn(r,"x","atanh")};return dr.runKernel(Bn,n)}const Tg=br({atanh_:Xf});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kc(r,t,n,o,u="NHWC",h){const p=r[3],g=[...t,p],x=m(u);return ql(r,g,n,h,o,null,null,x)}function Rf(r,t,n,o,u,h,p="channelsLast"){const[g,x]=im(t);let I;if(p==="channelsLast")I=[g,x,r[3],r[3]];else if(p==="channelsFirst")I=[g,x,r[1],r[1]];else throw new Error(`Unknown dataFormat ${p}`);return ql(r,I,n,o,u,h,!1,p)}function bd(r,t,n,o,u,h,p="NDHWC"){const[g,x,I]=om(t);let z,V;if(p==="NDHWC")V="channelsLast",z=[g,x,I,r[4],r[4]];else if(p==="NCDHW")V="channelsFirst",z=[g,x,I,r[1],r[1]];else throw new Error(`Unknown dataFormat ${p}`);return _p(r,z,n,o,u,!1,V,h)}function ql(r,t,n,o,u,h,p=!1,g="channelsLast"){let[x,I,z,V]=[-1,-1,-1,-1];if(g==="channelsLast")[x,I,z,V]=r;else if(g==="channelsFirst")[x,V,I,z]=r;else throw new Error(`Unknown dataFormat ${g}`);const[rt,Et,,St]=t,[Tt,Vt]=im(n),[ue,ye]=im(o),qe=Lv(rt,ue),$e=Lv(Et,ye),{padInfo:Xe,outHeight:Pn,outWidth:In}=M1(u,I,z,Tt,Vt,qe,$e,h,g),gr=p?St*V:St;let Br;return g==="channelsFirst"?Br=[x,gr,Pn,In]:g==="channelsLast"&&(Br=[x,Pn,In,gr]),{batchSize:x,dataFormat:g,inHeight:I,inWidth:z,inChannels:V,outHeight:Pn,outWidth:In,outChannels:gr,padInfo:Xe,strideHeight:Tt,strideWidth:Vt,filterHeight:rt,filterWidth:Et,effectiveFilterHeight:qe,effectiveFilterWidth:$e,dilationHeight:ue,dilationWidth:ye,inShape:r,outShape:Br,filterShape:t}}function _p(r,t,n,o,u,h=!1,p="channelsLast",g){let[x,I,z,V,rt]=[-1,-1,-1,-1,-1];if(p==="channelsLast")[x,I,z,V,rt]=r;else if(p==="channelsFirst")[x,rt,I,z,V]=r;else throw new Error(`Unknown dataFormat ${p}`);const[Et,St,Tt,,Vt]=t,[ue,ye,qe]=om(n),[$e,Xe,Pn]=om(o),In=Lv(Et,$e),gr=Lv(St,Xe),Br=Lv(Tt,Pn),{padInfo:Kr,outDepth:Na,outHeight:Ya,outWidth:Ha}=Y0(u,I,z,V,ue,ye,qe,In,gr,Br,g),ni=h?Vt*rt:Vt;let Wa;return p==="channelsFirst"?Wa=[x,ni,Na,Ya,Ha]:p==="channelsLast"&&(Wa=[x,Na,Ya,Ha,ni]),{batchSize:x,dataFormat:p,inDepth:I,inHeight:z,inWidth:V,inChannels:rt,outDepth:Na,outHeight:Ya,outWidth:Ha,outChannels:ni,padInfo:Kr,strideDepth:ue,strideHeight:ye,strideWidth:qe,filterDepth:Et,filterHeight:St,filterWidth:Tt,effectiveFilterDepth:In,effectiveFilterHeight:gr,effectiveFilterWidth:Br,dilationDepth:$e,dilationHeight:Xe,dilationWidth:Pn,inShape:r,outShape:Wa,filterShape:t}}function Vm(r,t,n,o,u){o==null&&(o=Ag(r,t,n));const h=r[0],p=r[1],g=xd((h-t+2*o)/n+1,u),x=xd((p-t+2*o)/n+1,u);return[g,x]}function X0(r,t,n,o,u,h){u==null&&(u=Ag(r,t,o));const p=r[0],g=r[1],x=r[2],I=xd((p-t+2*u)/o+1,h),z=xd((g-t+2*u)/o+1,h),V=xd((x-t+2*u)/o+1,h);return[I,z,V,n]}function Ag(r,t,n,o=1){const u=Lv(t,o);return Math.floor((r[0]*(n-1)-n+u)/2)}function im(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function om(r){return typeof r=="number"?[r,r,r]:r}function Lv(r,t){return t<=1?r:r+(r-1)*(t-1)}function M1(r,t,n,o,u,h,p,g,x){let I,z,V;if(typeof r=="number"){I={top:r,bottom:r,left:r,right:r,type:r===0?"VALID":"NUMBER"};const Et=Vm([t,n],h,o,r,g);z=Et[0],V=Et[1]}else if(r==="same"){z=Math.ceil(t/o),V=Math.ceil(n/u);const rt=Math.max(0,(z-1)*o+h-t),Et=Math.max(0,(V-1)*u+p-n),St=Math.floor(rt/2),Tt=rt-St,Vt=Math.floor(Et/2),ue=Et-Vt;I={top:St,bottom:Tt,left:Vt,right:ue,type:"SAME"}}else if(r==="valid")I={top:0,bottom:0,left:0,right:0,type:"VALID"},z=Math.ceil((t-h+1)/o),V=Math.ceil((n-p+1)/u);else if(typeof r=="object"){const rt=x==="channelsLast"?r[1][0]:r[2][0],Et=x==="channelsLast"?r[1][1]:r[2][1],St=x==="channelsLast"?r[2][0]:r[3][0],Tt=x==="channelsLast"?r[2][1]:r[3][1];I={top:rt,bottom:Et,left:St,right:Tt,type:rt===0&&Et===0&&St===0&&Tt===0?"VALID":"EXPLICIT"},z=xd((t-h+rt+Et)/o+1,g),V=xd((n-p+St+Tt)/u+1,g)}else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:I,outHeight:z,outWidth:V}}function Y0(r,t,n,o,u,h,p,g,x,I,z){let V,rt,Et,St;if(typeof r=="number"){V={top:r,bottom:r,left:r,right:r,front:r,back:r,type:r===0?"VALID":"NUMBER"};const Vt=X0([t,n,o,1],g,1,u,r,z);rt=Vt[0],Et=Vt[1],St=Vt[2]}else if(r==="same"){rt=Math.ceil(t/u),Et=Math.ceil(n/h),St=Math.ceil(o/p);const Tt=(rt-1)*u+g-t,Vt=(Et-1)*h+x-n,ue=(St-1)*p+I-o,ye=Math.floor(Tt/2),qe=Tt-ye,$e=Math.floor(Vt/2),Xe=Vt-$e,Pn=Math.floor(ue/2),In=ue-Pn;V={top:$e,bottom:Xe,left:Pn,right:In,front:ye,back:qe,type:"SAME"}}else if(r==="valid")V={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},rt=Math.ceil((t-g+1)/u),Et=Math.ceil((n-x+1)/h),St=Math.ceil((o-I+1)/p);else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:V,outDepth:rt,outHeight:Et,outWidth:St}}function xd(r,t){if(!t)return Math.trunc(r);switch(t){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error(`Unknown roundingMode ${t}`)}}function iv(r){const[t,n,o]=im(r);return t===1&&n===1&&o===1}function _c(r,t){return iv(r)||iv(t)}function m(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y(r,t){const o={x:pn(r,"x","reshape","string_or_numeric")},u={shape:t};return dr.runKernel(ws,o,u)}const b=br({reshape_:y});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S(r,t,n,o,u){const h=pn(r,"x","avgPool","float32"),p=1;yt(_c(n,p),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${p}'`);let g=h,x=!1;h.rank===3&&(x=!0,g=b(h,[1,h.shape[0],h.shape[1],h.shape[2]])),yt(g.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${g.rank}.`),u!=null&&yt(xr(o),()=>`Error in avgPool: pad must be an integer when using, dimRoundingMode ${u} but got pad ${o}.`);const I={x:g},z={filterSize:t,strides:n,pad:o,dimRoundingMode:u};let V=dr.runKernel(Lr,I,z);return V=eo(V,h.dtype),x?b(V,[V.shape[1],V.shape[2],V.shape[3]]):V}const D=br({avgPool_:S});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J(r,t,n,o,u,h="NDHWC",p){p==null?p=[1,1,1]:na("dilations is deprecated, this field will be gone in v3.0.0.");const g=pn(r,"x","avgPool3d","float32");let x=g,I=!1;g.rank===4&&(I=!0,x=b(g,[1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]])),yt(x.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${x.rank}.`),yt(h==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${h}`),yt(_c(n,p),()=>`Error in avgPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${p}'`),u!=null&&yt(xr(o),()=>`Error in avgPool3d: pad must be an integer when using, dimRoundingMode ${u} but got pad ${o}.`);const z={x},V={filterSize:t,strides:n,pad:o,dimRoundingMode:u,dataFormat:h,dilations:p};let rt=dr.runKernel(Fa,z,V);return rt=eo(rt,x.dtype),I?b(rt,[rt.shape[1],rt.shape[2],rt.shape[3],rt.shape[4]]):rt}const lt=br({avgPool3d_:J});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xt(r,t=0){yt(r.length>=1,()=>"Pass at least one tensor to concat");const n=nh(r,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(h=>{if(h.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${h.dtype}. `)}),n.length===1)return _h(n[0]);const o=n,u={axis:t};return dr.runKernel(us,o,u)}const _t=br({concat_:xt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wt(r){const n={x:pn(r,"x","sigmoid")};return dr.runKernel(de,n)}const qt=br({sigmoid_:Wt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jt(r,t,n){const o=pn(r,"x","slice","string_or_numeric");if(o.rank===0)throw new Error("Slicing scalar is not possible");const u={x:o},h={begin:t,size:n};return dr.runKernel(ef,u,h)}const Ut=br({slice_:Jt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xe(r){const n={x:pn(r,"x","tanh")};return dr.runKernel(ba,n)}const Ce=br({tanh_:xe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ue(r,t,n,o,u,h){const p=pn(r,"forgetBias","basicLSTMCell"),g=pn(t,"lstmKernel","basicLSTMCell"),x=pn(n,"lstmBias","basicLSTMCell"),I=pn(o,"data","basicLSTMCell"),z=pn(u,"c","basicLSTMCell"),V=pn(h,"h","basicLSTMCell"),rt=_t([I,V],1),Et=Zs(rt,g),St=An(Et,x),Tt=St.shape[0],Vt=St.shape[1]/4,ue=[Tt,Vt],ye=Ut(St,[0,0],ue),qe=Ut(St,[0,Vt],ue),$e=Ut(St,[0,Vt*2],ue),Xe=Ut(St,[0,Vt*3],ue),Pn=An(Xn(qt(ye),Ce(qe)),Xn(z,qt(An(p,$e)))),In=Xn(Ce(Pn),qt(Xe));return[Pn,In]}const en=br({basicLSTMCell_:Ue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dn(r,t,n){const o=pn(r,"x","batchToSpaceND"),u=t.reduce((g,x)=>g*x);yt(o.rank>=1+t.length,()=>`input rank is ${o.rank} but should be > than blockShape.length ${t.length}`),yt(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),yt(o.shape[0]%u==0,()=>`input tensor batch is ${o.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${u}`);const h={x:o},p={blockShape:t,crops:n};return dr.runKernel(oo,h,p)}const Rn=br({batchToSpaceND_:dn});function nr(r){let t;return r.rank===0||r.rank===1?t=b(r,[1,1,1,r.size]):r.rank===2?t=b(r,[1,1,r.shape[0],r.shape[1]]):r.rank===3?t=b(r,[1,r.shape[0],r.shape[1],r.shape[2]]):t=r,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kn(r,t,n,o,u,h){h==null&&(h=.001);const p=pn(r,"x","batchNorm"),g=pn(t,"mean","batchNorm"),x=pn(n,"variance","batchNorm");let I;u!=null&&(I=pn(u,"scale","batchNorm"));let z;o!=null&&(z=pn(o,"offset","batchNorm")),yt(g.rank===x.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),yt(z==null||g.rank===z.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),yt(I==null||g.rank===I.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const rt={x:nr(p),scale:I,offset:z,mean:g,variance:x},Et={varianceEpsilon:h},St=dr.runKernel(xo,rt,Et);return b(St,p.shape)}const Sr=br({batchNorm_:Kn});function jn(r,t,n,o,u,h){const p=pn(r,"x","batchNorm"),g=pn(t,"mean","batchNorm"),x=pn(n,"variance","batchNorm");let I;u!=null&&(I=pn(u,"scale","batchNorm"));let z;return o!=null&&(z=pn(o,"offset","batchNorm")),yt(p.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${p.rank}.`),yt(g.rank===2||g.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${g.rank}.`),yt(x.rank===2||x.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${x.rank}.`),I!=null&&yt(I.rank===2||I.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${I.rank}.`),z!=null&&yt(z.rank===2||z.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${z.rank}.`),Sr(p,g,x,z,I,h)}const pr=br({batchNorm2d_:jn});function zr(r,t,n,o,u,h){const p=pn(r,"x","batchNorm"),g=pn(t,"mean","batchNorm"),x=pn(n,"variance","batchNorm");let I;u!=null&&(I=pn(u,"scale","batchNorm"));let z;return o!=null&&(z=pn(o,"offset","batchNorm")),yt(p.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${p.rank}.`),yt(g.rank===3||g.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${g.rank}.`),yt(x.rank===3||x.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${x.rank}.`),I!=null&&yt(I.rank===3||I.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${I.rank}.`),z!=null&&yt(z.rank===3||z.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${z.rank}.`),Sr(p,g,x,z,I,h)}const Er=br({batchNorm3d_:zr});function oa(r,t,n,o,u,h){const p=pn(r,"x","batchNorm"),g=pn(t,"mean","batchNorm"),x=pn(n,"variance","batchNorm");let I;u!=null&&(I=pn(u,"scale","batchNorm"));let z;return o!=null&&(z=pn(o,"offset","batchNorm")),yt(p.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${p.rank}.`),yt(g.rank===4||g.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${g.rank}.`),yt(x.rank===4||x.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${x.rank}.`),I!=null&&yt(I.rank===4||I.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${I.rank}.`),z!=null&&yt(z.rank===4||z.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${z.rank}.`),Sr(p,g,x,z,I,h)}const Gr=br({batchNorm4d_:oa});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wa(r,t,n){const o=pn(r,"x","bincount"),u=pn(t,"weights","bincount");yt(o.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${o.dtype}`),yt(n>=0,()=>`size must be non-negative, but got ${n}.`),yt(u.size===o.size||u.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${o.shape}, weights shape: ${u.shape}.`);const h={x:o,weights:u},p={size:n};return dr.runKernel(po,h,p)}const va=br({bincount_:wa});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ua(r,t){let n=pn(r,"broadcastTo","x");const o=n.shape;if(t.some(I=>!(I>0)||I%1!=0))throw new Error(`broadcastTo(): Invalid broadcast shape [${t}].`);if(t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const I=n.shape.slice();for(;I.length<t.length;)I.unshift(1);n=b(n,I)}const u=n.shape,h=Array.from(t);for(let I=t.length-1;I>=0;I--)if(u[I]===t[I])h[I]=1;else if(n.shape[I]!==1)throw new Error(`broadcastTo(): [${o}] cannot be broadcast to [${t}].`);if(h.map((I,z)=>I>1?z:-1).filter(I=>I>=0).length===0)return _h(n);const g={x:n},x={reps:h};return dr.runKernel(ki,g,x)}const Ja=br({broadcastTo_:Ua});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Li(r){const n={x:pn(r,"x","ceil")};return dr.runKernel(Wo,n)}const Zi=br({ceil_:Li});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oi(r,t,n){const o=pn(r,"x","clipByValue");yt(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`);const u={x:o},h={clipValueMin:t,clipValueMax:n};return dr.runKernel(Yi,u,h)}const li=br({clipByValue_:Oi});function ti(r){return _t(r,0)}const ao=br({concat1d_:ti});function $o(r,t){return _t(r,t)}const Oo=br({concat2d_:$o});function Ss(r,t){return _t(r,t)}const mo=br({concat3d_:Ss});function So(r,t){return _t(r,t)}const fs=br({concat4d_:So});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function As(r,t,n,o,u="NHWC",h=[1,1],p){const g=pn(r,"x","conv2d"),x=pn(t,"filter","conv2d");let I=g,z=!1;g.rank===3&&(z=!0,I=b(g,[1,g.shape[0],g.shape[1],g.shape[2]])),yt(I.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${I.rank}.`),yt(x.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${x.rank}.`),p!=null&&yt(xr(o),()=>`Error in conv2d: pad must be an integer when using, dimRoundingMode ${p} but got pad ${o}.`);const V=u==="NHWC"?I.shape[3]:I.shape[1];yt(V===x.shape[2],()=>`Error in conv2d: depth of input (${V}) must match input depth for filter ${x.shape[2]}.`),yt(_c(n,h),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${h}'`);const rt={x:I,filter:x},Et={strides:n,pad:o,dataFormat:u,dilations:h,dimRoundingMode:p},St=dr.runKernel(Do,rt,Et);return z?b(St,[St.shape[1],St.shape[2],St.shape[3]]):St}const qs=br({conv2d_:As});function Ko(r,t,n,o,u="NWC",h=1,p){const g=pn(r,"x","conv1d"),x=pn(t,"filter","conv1d");let I=g,z=!1;g.rank===2&&(z=!0,I=b(g,[1,g.shape[0],g.shape[1]])),yt(I.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${I.rank}.`),yt(x.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${x.rank}.`),p!=null&&yt(xr(o),()=>`Error in conv1d: pad must be an integer when using, dimRoundingMode ${p} but got pad ${o}.`),yt(I.shape[2]===x.shape[1],()=>`Error in conv1d: depth of input (${I.shape[2]}) must match input depth for filter ${x.shape[1]}.`),yt(_c(n,h),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${h}'`),yt(u==="NWC",()=>`Error in conv1d: got dataFormat of ${u} but only NWC is currently supported.`);const V=b(x,[1,x.shape[0],x.shape[1],x.shape[2]]),rt=b(I,[I.shape[0],1,I.shape[1],I.shape[2]]),Vt=qs(rt,V,[1,n],o,"NHWC",[1,h],p);return z?b(Vt,[Vt.shape[2],Vt.shape[3]]):b(Vt,[Vt.shape[0],Vt.shape[2],Vt.shape[3]])}const Ho=br({conv1d_:Ko});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cu(r,t,n,o,u,h="NHWC",p){yt(r.length===t.rank,()=>`Length of inShape (${r.length}) and rank of dy (${t.rank}) must match`);let g=r,x=t,I=!1;t.rank===3&&(I=!0,x=b(t,[1,t.shape[0],t.shape[1],t.shape[2]]),g=[1,r[0],r[1],r[2]]),yt(g.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${g.length}.`),yt(x.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${x.rank}`),yt(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const z=h==="NHWC"?g[3]:g[1],V=h==="NHWC"?x.shape[3]:x.shape[1];yt(z===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${z}) must match input depth for filter ${n.shape[2]}.`),yt(V===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${V}) must match output depth for filter ${n.shape[3]}.`),p!=null&&yt(xr(u),()=>`Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode ${p} but got pad ${u}.`);const rt={dy:x,filter:n},Et={strides:o,pad:u,dataFormat:h,dimRoundingMode:p,inputShape:g},St=dr.runKernel(zs,rt,Et);return I?b(St,[St.shape[1],St.shape[2],St.shape[3]]):St}const Xs=br({conv2DBackpropInput_:Cu});function jl(r,t,n,o,u,h){const p=pn(r,"x","conv2dTranspose"),g=pn(t,"filter","conv2dTranspose");return Xs(n,p,g,o,u,"NHWC",h)}const _u=br({conv2dTranspose_:jl});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hu(r,t,n,o,u="NDHWC",h=[1,1,1]){const p=pn(r,"x","conv3d"),g=pn(t,"filter","conv3d");let x=p,I=!1;p.rank===4&&(I=!0,x=b(p,[1,p.shape[0],p.shape[1],p.shape[2],p.shape[3]])),yt(x.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${x.rank}.`),yt(g.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${g.rank}.`),yt(x.shape[4]===g.shape[3],()=>`Error in conv3d: depth of input (${x.shape[4]}) must match input depth for filter ${g.shape[3]}.`),yt(_c(n,h),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${h}'`),yt(u==="NDHWC",()=>`Error in conv3d: got dataFormat of ${u} but only NDHWC is currently supported.`);const z={x,filter:g},V={strides:n,pad:o,dataFormat:u,dilations:h},rt=dr.runKernel(mu,z,V);return I?b(rt,[rt.shape[1],rt.shape[2],rt.shape[3],rt.shape[4]]):rt}const yl=br({conv3d_:hu});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function du(r,t,n,o,u){yt(r.length===t.rank,()=>`Length of inShape (${r.length}) and rank of dy (${t.rank}) must match`);let h=r,p=t,g=!1;t.rank===4&&(g=!0,p=b(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),h=[1,r[0],r[1],r[2],r[3]]);const x=h[4],I=p.shape[4];yt(h.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${h.length}.`),yt(p.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${p.rank}`),yt(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),yt(x===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${x}) must match input depth for filter ${n.shape[3]}.`),yt(I===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${I}) must match output depth for filter ${n.shape[4]}.`);const z={dy:p,filter:n},V={pad:u,strides:o,inputShape:h},rt=dr.runKernel(Ms,z,V);return g?b(rt,[rt.shape[1],rt.shape[2],rt.shape[3],rt.shape[4]]):rt}const Us=br({conv3DBackpropInput_:du});function Pu(r,t,n,o,u){const h=pn(r,"x","conv3dTranspose"),p=pn(t,"filter","conv3dTranspose");return Us(n,h,p,o,u)}const fh=br({conv3dTranspose_:Pu});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ov(r){const n={x:pn(r,"x","cos")};return dr.runKernel(yu,n)}const lc=br({cos_:ov});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mf(r){const n={x:pn(r,"x","cosh")};return dr.runKernel(uu,n)}const Jh=br({cosh_:mf});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ip(r,t=0,n=!1,o=!1){const h={x:pn(r,"x","cumsum")},p={axis:t,exclusive:n,reverse:o};return dr.runKernel(Cs,h,p)}const Mg=br({cumsum_:Ip});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sm(r,t,n,o=!1){const u=pn(r,"x","denseBincount"),h=pn(t,"weights","denseBincount");yt(u.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${u.dtype}`),yt(u.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${u.rank}.`),yt(n>=0,()=>`size must be non-negative, but got ${n}.`),yt(h.size===u.size||h.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${u.shape}, weights shape: ${h.shape}.`);const p={x:u,weights:h},g={size:n,binaryOutput:o};return dr.runKernel(Wi,p,g)}const um=br({denseBincount_:sm});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ng(r,t,n="NHWC"){const o=pn(r,"x","depthToSpace"),u=n==="NHWC"?o.shape[1]:o.shape[2],h=n==="NHWC"?o.shape[2]:o.shape[3],p=n==="NHWC"?o.shape[3]:o.shape[1];yt(u*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${u} and ${t}  for depthToSpace with input shape
    ${o.shape}`),yt(h*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${h} and ${t} for depthToSpace with input shape
        ${o.shape}`),yt(p%(t*t)==0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${p} for depthToSpace with input shape ${o.shape}`);const g={x:o},x={blockSize:t,dataFormat:n};return dr.runKernel(ls,g,x)}const ig=br({depthToSpace_:Ng});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K0(r,t,n,o,u="NHWC",h=[1,1],p){const g=pn(r,"x","depthwiseConv2d"),x=pn(t,"filter","depthwiseConv2d");let I=g,z=!1;g.rank===3&&(z=!0,I=b(g,[1,g.shape[0],g.shape[1],g.shape[2]])),yt(I.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${I.rank}.`),yt(x.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${x.rank}.`),yt(I.shape[3]===x.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${I.shape[3]}) must match the inChannels dimension in filter ${x.shape[2]}.`),p!=null&&yt(xr(o),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${p} but got pad ${o}.`);const V={x:I,filter:x},rt={strides:n,pad:o,dataFormat:u,dilations:h,dimRoundingMode:p},Et=dr.runKernel(is,V,rt);return z?b(Et,[Et.shape[1],Et.shape[2],Et.shape[3]]):Et}const Qd=br({depthwiseConv2d_:K0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lm(r){const n={x:pn(r,"x","diag")};return dr.runKernel(bu,n)}const N1=br({diag_:lm});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z0(r,t,n,o,u=[1,1],h="NHWC"){const p=pn(r,"x","dilation2d"),g=pn(t,"filter","dilation2d");yt(p.rank===3||p.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${p.rank}.`),yt(g.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${g.rank}.`),yt(h==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${h}`);let x=p,I=!1;p.rank===3&&(x=b(p,[1,p.shape[0],p.shape[1],p.shape[2]]),I=!0);const z={x,filter:g},V={strides:n,pad:o,dilations:u},rt=dr.runKernel(Ys,z,V);return I?b(rt,[rt.shape[1],rt.shape[2],rt.shape[3]]):rt}const cm=br({dilation2d_:Z0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jm(r,t){let n=pn(r,"a","equal"),o=pn(t,"b","equal");[n,o]=Ci(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return dr.runKernel(eu,u)}const Hu=br({equal_:jm});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yf(r,t,n){const o=pn(t,"a","where"),u=pn(n,"b","where"),h=pn(r,"condition","where","bool"),p=Nr(o.shape,u.shape),g=Ja(o,p),x=Ja(u,p);h.rank===1&&yt(h.shape[0]===o.shape[0],()=>"The first dimension of `a` must match the size of `condition`."),h.rank!==1&&Ne(h.shape,x.shape,"Error in where: ");const I={condition:h,t:g,e:x};return dr.runKernel(Dc,I)}const Lf=br({where_:Yf});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hm(r,t){let n=pn(r,"a","div"),o=pn(t,"b","div");[n,o]=Ci(n,o);const u=rr(n,o),h=bi(u),p=Hu(o,h);return Lf(p,h,u)}const Xm=br({divNoNan_:Hm});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ym(r,t){const n=pn(r,"t1","dot"),o=pn(t,"t2","dot");yt((n.rank===1||n.rank===2)&&(o.rank===1||o.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${o.rank}.`);const u=n.rank===1?n.size:n.shape[1],h=o.rank===1?o.size:o.shape[0];if(yt(u===h,()=>`Error in dot: inner dimensions of inputs must match, but got ${u} and ${h}.`),n.rank===1&&o.rank===1){const p=b(n,[1,-1]),g=b(o,[-1,1]),x=Zs(p,g);return b(x,[])}else if(n.rank===1&&o.rank===2){const p=b(n,[1,-1]),g=b(o,[o.shape[0],o.shape[1]]),x=Zs(p,g);return b(x,[x.size])}else if(n.rank===2&&o.rank===1){const p=b(o,[-1,1]),g=Zs(n,p);return b(g,[g.size])}else{const p=b(o,[o.shape[0],o.shape[1]]);return Zs(n,p)}}const Dx=br({dot_:Ym});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xS(r){const n={x:pn(r,"x","elu")};return dr.runKernel(Ro,n)}const fm=br({elu_:xS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ox(r){let t=pn(r,"x","erf");yt(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=eo(t,"float32"));const n={x:t};return dr.runKernel(tu,n)}const k1=br({erf_:Ox});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rx(r){const n={x:pn(r,"x","exp")};return dr.runKernel(Zu,n)}const Kf=br({exp_:Rx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wS(r,t=0){const n=pn(r,"x","expandDims","string_or_numeric");yt(t<=n.rank,()=>"Axis must be <= rank of the tensor");const o={input:n},u={dim:t};return dr.runKernel(bn,o,u)}const wd=br({expandDims_:wS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lx(r){const n={x:pn(r,"x","expm1")};return dr.runKernel(Xr,n)}const Km=br({expm1_:Lx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hm(r,t){const n=pn(r,"x","tile","string_or_numeric");yt(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const o={x:n},u={reps:t};return dr.runKernel(ki,o,u)}const Pv=br({tile_:hm});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1(r,t,n,o="float32"){t==null&&(t=r);const u=vs([r,t],o),h=r<=t?r:t;for(let g=0;g<h;++g)u.set(1,g,g);const p=b(u.toTensor(),[r,t]);if(n==null)return p;if(n.length===1)return Pv(wd(p,0),[n[0],1,1]);if(n.length===2)return Pv(wd(wd(p,0),0),[n[0],n[1],1,1]);if(n.length===3)return Pv(wd(wd(wd(p,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const dm=br({eye_:D1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Px(r){const n={x:pn(r,"x","floor")};return dr.runKernel(Co,n)}const pm=br({floor_:Px});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q0(r,t,n=0,o=0){const u=pn(r,"x","gather"),h=pn(t,"indices","gather","int32"),p={x:u,indices:h},g={axis:n,batchDims:o};return dr.runKernel(gs,p,g)}const Fv=br({gather_:q0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O1(r,t){let n=pn(r,"a","greater"),o=pn(t,"b","greater");[n,o]=Ci(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return dr.runKernel(ou,u)}const Ed=br({greater_:O1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ES(r,t){let n=pn(r,"a","greaterEqual"),o=pn(t,"b","greaterEqual");[n,o]=Ci(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return dr.runKernel(ms,u)}const Jd=br({greaterEqual_:ES});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SS(r){const n={input:pn(r,"input","imag")};return dr.runKernel(kl,n)}const Q0=br({imag_:SS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CS(r){const n={x:pn(r,"x","isFinite")};return dr.runKernel(Ks,n)}const Fx=br({isFinite_:CS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _S(r){const n={x:pn(r,"x","isInf")};return dr.runKernel(el,n)}const R1=br({isInf_:_S});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bx(r){const n={x:pn(r,"x","isNaN")};return dr.runKernel(lu,n)}const Bv=br({isNaN_:Bx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IS(r,t=.2){const o={x:pn(r,"x","leakyRelu")},u={alpha:t};return dr.runKernel(Du,o,u)}const vm=br({leakyRelu_:IS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TS(r,t){let n=pn(r,"a","less"),o=pn(t,"b","less");[n,o]=Ci(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return dr.runKernel(pl,u)}const Zm=br({less_:TS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zf(r,t){let n=pn(r,"a","lessEqual"),o=pn(t,"b","lessEqual");[n,o]=Ci(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return dr.runKernel(ns,u)}const og=br({lessEqual_:Zf});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L1(r,t,n){if(n<=0)throw new Error("The number of values should be positive.");const o={start:r,stop:t,num:n};return dr.runKernel(_s,{},o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AS(r,t=5,n=1,o=1,u=.5){const h=pn(r,"x","localResponseNormalization");yt(h.rank===4||h.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${h.rank}.`),yt(xr(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let p=h,g=!1;h.rank===3&&(g=!0,p=b(h,[1,h.shape[0],h.shape[1],h.shape[2]]));const x={x:p},I={depthRadius:t,bias:n,alpha:o,beta:u},z=dr.runKernel(Sl,x,I);return g?b(z,[z.shape[1],z.shape[2],z.shape[3]]):z}const J0=br({localResponseNormalization_:AS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zv(r){const n={x:pn(r,"x","log")};return dr.runKernel(Bu,n)}const Oh=br({log_:zv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MS(r){const n={x:pn(r,"x","log1p")};return dr.runKernel(Au,n)}const qm=br({log1p_:MS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $i(r){const n={x:pn(r,"x","neg")};return dr.runKernel(Ae,n)}const Ic=br({neg_:$i});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NS(r){const n={x:pn(r,"x","softplus")};return dr.runKernel(Pe,n)}const gm=br({softplus_:NS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zx(r){const t=pn(r,"x","logSigmoid");return Eu(o=>({value:Ic(gm(Ic(o))),gradFunc:p=>Xn(p,qt(Ic(o)))}))(t)}const sg=br({logSigmoid_:zx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qm(r,t=null,n=!1){const u={x:pn(r,"x","max")},h={reductionIndices:t,keepDims:n};return dr.runKernel(ys,u,h)}const Sd=br({max_:Qm});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $x(r,t=null,n=!1){let o=pn(r,"x","sum");o.dtype==="bool"&&(o=eo(o,"int32"));const u={x:o},h={axis:t,keepDims:n};return dr.runKernel(rn,u,h)}const ss=br({sum_:$x});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kS(r,t=-1){const n=pn(r,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Eu((u,h)=>{const p=!0,g=Sd(u,t,!0),x=pi(u,g),I=pi(eo(x,"float32"),Oh(ss(Kf(x),t,p)));return h([I]),{value:I,gradFunc:(V,rt)=>{const[Et]=rt,St=!0,Tt=Kf(Et);return pi(V,Xn(ss(V,t,St),Tt))}}})(n)}const ty=br({logSoftmax_:kS});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ey(r,t){for(let n=0;n<r.length;++n)if(r[r.length-n-1]!==t-1-n)return!1;return!0}function P1(r,t,n){const o=r.length+t.length,u=[];let h=0,p=0;for(let g=0;g<o;g++)n.indexOf(g)===-1?u.push(r[h++]):u.push(t[p++]);return u}function yf(r,t){const n=[],o=r.length;for(let h=0;h<o;h++)t.indexOf(h)===-1&&n.push(r[h]);const u=t.map(h=>r[h]);return[n,u]}function zc(r,t){const n=t.map(o=>1);return P1(r,n,t)}function Pf(r,t,n){yt(ey(t,n),()=>`${r} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function $c(r,t){if(ey(r,t))return null;const n=[];for(let o=0;o<t;++o)r.indexOf(o)===-1&&n.push(o);return r.forEach(o=>n.push(o)),n}function mm(r){return r.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function gc(r,t){const n=[];for(let o=t-r;o<t;++o)n.push(o);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1(r,t=null,n=!1){const o=pn(r,"x","logSumExp"),u=Rr(t,o.shape),h=Sd(o,u,!0),p=pi(o,h),g=Kf(p),x=ss(g,u),I=Oh(x),z=An(b(h,I.shape),I);if(n){const V=zc(z.shape,u);return b(z,V)}return z}const ny=br({logSumExp_:F1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gx(r,t){const n=pn(r,"a","logicalAnd","bool"),o=pn(t,"b","logicalAnd","bool");Nr(n.shape,o.shape);const u={a:n,b:o};return dr.runKernel(wu,u)}const Rh=br({logicalAnd_:Gx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ry(r){const n={x:pn(r,"x","logicalNot","bool")};return dr.runKernel(nu,n)}const kg=br({logicalNot_:ry});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ay(r,t){const n=pn(r,"a","logicalOr","bool"),o=pn(t,"b","logicalOr","bool");Nr(n.shape,o.shape);const u={a:n,b:o};return dr.runKernel(Tl,u)}const Jm=br({logicalOr_:ay});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ux(r,t){const n=pn(r,"a","logicalXor","bool"),o=pn(t,"b","logicalXor","bool");return Nr(n.shape,o.shape),Rh(Jm(r,t),kg(Rh(r,t)))}const ug=br({logicalXor_:Ux});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B1(r,t,n,o,u){const h=pn(r,"x","maxPool"),p=1;let g=h,x=!1;h.rank===3&&(x=!0,g=b(h,[1,h.shape[0],h.shape[1],h.shape[2]])),yt(g.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${g.rank}.`),yt(_c(n,p),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${p}'`),u!=null&&yt(xr(o),()=>`Error in maxPool: pad must be an integer when using, dimRoundingMode ${u} but got pad ${o}.`);const I={x:g},z={filterSize:t,strides:n,pad:o,dimRoundingMode:u},V=dr.runKernel(kc,I,z);return x?b(V,[V.shape[1],V.shape[2],V.shape[3]]):V}const Dg=br({maxPool_:B1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wx(r,t=[1,1,1],n,o,u,h="NDHWC",p){p==null?p=[1,1,1]:na("dilations is deprecated, this field will be gone in v3.0.0.");const g=pn(r,"x","maxPool3d");let x=g,I=!1;g.rank===4&&(I=!0,x=b(g,[1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]])),yt(x.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${x.rank}.`),yt(h==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${h}`),yt(_c(n,p),()=>`Error in maxPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${p}'`),u!=null&&yt(xr(o),()=>`Error in maxPool3d: pad must be an integer when using, dimRoundingMode ${u} but got pad ${o}.`);const z={x},V={filterSize:t,strides:n,pad:o,dimRoundingMode:u,dataFormat:h,dilations:p},rt=dr.runKernel(Ol,z,V);return I?b(rt,[rt.shape[1],rt.shape[2],rt.shape[3],rt.shape[4]]):rt}const lg=br({maxPool3d_:Wx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z1(r,t,n,o,u=!1){const p={x:pn(r,"x","maxPoolWithArgmax")},g={filterSize:t,strides:n,pad:o,includeBatchInIndex:u},x=dr.runKernel(ve,p,g);return{result:x[0],indexes:x[1]}}const Vx=br({maxPoolWithArgmax_:z1});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $1(r,t=null,n=!1){const u={x:pn(r,"x","mean")},h={axis:t,keepDims:n};return dr.runKernel(Bt,u,h)}const cc=br({mean_:$1});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G1(r,t=null,n=!1){const u={x:pn(r,"x","min")},h={axis:t,keepDims:n};return dr.runKernel(ae,u,h)}const ym=br({min_:G1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jx(r,t){let n=pn(r,"a","minimum"),o=pn(t,"b","minimum");[n,o]=Ci(n,o),n.dtype==="bool"&&(n=eo(n,"int32"),o=eo(o,"int32")),Nr(n.shape,o.shape);const u={a:n,b:o};return dr.runKernel(me,u)}const cg=br({minimum_:jx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DS(r,t,n){yt(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const o=pn(r,"x","mirrorPad");if(o.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");yt(t.length===o.rank,()=>`Padding doesn't match input. Must be ${o.rank}. Got ${t.length}.`);const u=n==="reflect"?1:0;for(let g=0;g<o.rank;g++)yt(t[g].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),yt(t[g][0]>=0&&t[g][0]<=o.shape[g]-u&&t[g][1]>=0&&t[g][1]<=o.shape[g]-u,()=>`Padding in dimension ${g} cannot be greater than or equal to ${o.shape[g]-u} or less than 0 for input of shape ${o.shape}`);const h={paddings:t,mode:n},p={x:o};return dr.runKernel(En,p,h)}const U1=br({mirrorPad_:DS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OS(r,t){let n=pn(r,"a","mod"),o=pn(t,"b","mod");[n,o]=Ci(n,o);const u={a:n,b:o};return dr.runKernel(Zn,u)}const iy=br({mod_:OS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hx(r,t=null,n=!1){r=pn(r,"x","moments");const o=Rr(t,r.shape),u=cc(r,o,n);let h=u.shape;n||(h=zc(u.shape,o));const p=Ai(pi(eo(r,"float32"),b(u,h))),g=cc(p,o,n);return{mean:u,variance:g}}const oy=br({moments_:Hx});function Tp(r,t,n,o){const u=pn(t,"data","multiRNNCell"),h=nh(n,"c","multiRNNCell"),p=nh(o,"h","multiRNNCell");let g=u;const x=[];for(let V=0;V<r.length;V++){const rt=r[V](g,h[V],p[V]);x.push(rt[0]),x.push(rt[1]),g=rt[1]}const I=[],z=[];for(let V=0;V<x.length;V+=2)I.push(x[V]),z.push(x[V+1]);return[I,z]}const RS=br({multiRNNCell_:Tp});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LS(r,t,n,o=!1){const u=pn(r,"logits","multinomial"),h=u.size,p=u.rank;if(h<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${h}.`);if(p>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${p}`);n=n||Math.random();const x={logits:p===1?b(u,[1,-1]):u},I={numSamples:t,seed:n,normalized:o},z=dr.runKernel(Kt,x,I);return p===1?b(z,[z.size]):z}const t0=br({multinomial_:LS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PS(r,t){let n=pn(r,"a","notEqual"),o=pn(t,"b","notEqual");[n,o]=Ci(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return dr.runKernel(sn,u)}const fg=br({notEqual_:PS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tc(r,t="float32"){if(t==="complex64"){const o=Tc(r,"float32"),u=Tc(r,"float32");return Rc(o,u)}const n=kt(Rt(r),t);return dr.makeTensor(n,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sv(r,t="float32"){if(t==="complex64"){const o=sv(r,"float32"),u=Tc(r,"float32");return Rc(o,u)}const n=Lt(Rt(r),t);return dr.makeTensor(n,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FS(r){const n={x:pn(r,"x","onesLike")};return dr.runKernel(Aa,n)}const Zc=br({onesLike_:FS});function BS(r,t){const n=pn(r,"v1","outerProduct"),o=pn(t,"v2","outerProduct");yt(n.rank===1&&o.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${o.rank}.`);const u=b(n,[-1,1]),h=b(o,[1,-1]);return Zs(u,h)}const zS=br({outerProduct_:BS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $S(r,t,n=0){const o=pn(r,"x","pad");if(o.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const u={paddings:t,constantValue:n},h={x:o};return dr.runKernel(oi,h,u)}const $v=br({pad_:$S});function GS(r,t,n=0){return yt(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),$v(r,[t],n)}const Xx=br({pad1d_:GS});function US(r,t,n=0){return yt(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),$v(r,t,n)}const W1=br({pad2d_:US});function WS(r,t,n=0){return yt(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),$v(r,t,n)}const Yx=br({pad3d_:WS});function e0(r,t,n=0){return yt(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),$v(r,t,n)}const VS=br({pad4d_:e0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jS(r,t,n){const o=pn(r,"x","spaceToBatchND");yt(o.rank>=1+t.length,()=>`input rank ${o.rank} should be > than [blockShape] ${t.length}`),yt(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),yt(o.shape.reduce((p,g,x)=>x>0&&x<=t.length?p&&(g+n[x-1][0]+n[x-1][1])%t[x-1]==0:p,!0),()=>`input spatial dimensions ${o.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const u={x:o},h={blockShape:t,paddings:n};return dr.runKernel(wn,u,h)}const n0=br({spaceToBatchND_:jS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HS(r,t,n,o,u,h){u==null&&(u=[1,1]),h==null&&(h=1),o===0&&(o="valid");const p=pn(r,"x","maxPool");let g=p,x=!1;p.rank===3&&(x=!0,g=b(p,[1,p.shape[0],p.shape[1],p.shape[2]])),yt(_c(h,u),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${h} and dilations '${u}'`);const I=Rf(g.shape,t,h,u,o),z=[I.dilationHeight,I.dilationWidth];let V;o==="same"?V=Kx([I.filterHeight,I.filterWidth],z):V=[[0,0],[0,0]];const rt=z[0]===1&&z[1]===1,[Et,St]=sy([I.inHeight,I.inWidth],z,V),Tt=rt?o:"valid",Vt=rt?g:n0(g,z,Et),ye=(n==="avg"?()=>D(Vt,t,h,Tt):()=>Dg(Vt,t,h,Tt))(),qe=rt?ye:Rn(ye,z,St);return x?b(qe,[qe.shape[1],qe.shape[2],qe.shape[3]]):qe}function sy(r,t,n){const o=n.map(z=>z[0]),u=n.map(z=>z[1]),h=r.concat(o,u),p=t.map((z,V)=>(z-h[V]%z)%z),g=u.map((z,V)=>z+p[V]),x=t.map((z,V)=>[o[V],g[V]]),I=t.map((z,V)=>[0,p[V]]);return[x,I]}function Kx(r,t){const o=r.map((p,g)=>p+(p-1)*(t[g]-1)).map(p=>p-1),u=o.map(p=>Math.floor(p/2)),h=o.map((p,g)=>p-u[g]);return o.map((p,g)=>[u[g],h[g]])}const Zx=br({pool_:HS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1(r,t){const n=pn(r,"x","prelu"),o=pn(t,"alpha","prelu"),u={x:n,alpha:o};return dr.runKernel(Si,u)}const bm=br({prelu_:V1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XS(r,t=null,n=!1){let o=pn(r,"x","prod");o.dtype==="bool"&&(o=eo(o,"int32"));const u={x:o},h={axis:t,keepDims:n};return dr.runKernel(_o,u,h)}const uy=br({prod_:XS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YS(r,t,n){const o=Rt(r);let u=null;if(n==null||n==="float32")u=new Float32Array(o);else if(n==="int32")u=new Int32Array(o);else if(n==="bool")u=new Uint8Array(o);else throw new Error(`Unknown data type ${n}`);for(let h=0;h<o;h++)u[h]=t();return dr.makeTensor(u,r,n)}const KS=br({rand_:YS});var xm=$(36377);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j1{constructor(t,n,o,u,h){this.mean=t,this.stdDev=n,this.dtype=o,this.nextVal=NaN,this.truncated=u,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const p=h||Math.random();this.random=xm.alea(p.toString())}nextValue(){if(!isNaN(this.nextVal)){const u=this.nextVal;return this.nextVal=NaN,u}let t,n,o=!1;for(;!o;){let u,h,p;do u=2*this.random()-1,h=2*this.random()-1,p=u*u+h*h;while(p>=1||p===0);const g=Math.sqrt(-2*Math.log(p)/p);t=this.mean+this.stdDev*u*g,n=this.mean+this.stdDev*h*g,(!this.truncated||this.isValidTruncated(t))&&(o=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class ZS{constructor(t,n,o,u){this.alpha=t,this.beta=1/n,this.dtype=o;const h=u||Math.random();this.randu=xm.alea(h.toString()),this.randn=new j1(0,1,o,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,n,o,u,h,p;for(;;){do u=this.randn.nextValue(),p=1+this.c*u;while(p<=0);if(p*=p*p,t=u*u,n=1-.331*t*t,o=.5*t+this.d*(1-p+Math.log(p)),h=this.randu(),h<n||Math.log(h)<o)break}return p=1/this.beta*this.d*p,this.alpha<1&&(p*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(p)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}}class qS{constructor(t=0,n=1,o,u){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=o,u==null&&(u=Math.random()),typeof u=="number"&&(u=u.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=xm.alea(u)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}function wA(r){const t=r.length,n=Jx(r),o=Qx(r),u=t/6*(Math.pow(n,2)+.25*Math.pow(o-3,2));if(u>5.991)throw new Error(`Invalid p-value for JB: ${u}`)}function EA(r,t,n,o){o==null&&(o=testEpsilon());const u=H1(r);expectNumbersClose(u,t,o),expectNumbersClose(qx(r,u),n,o)}function H1(r){let t=0;for(let n=0;n<r.length;n++)t+=r[n];return t/r.length}function qx(r,t){let n=0;for(let o=0;o<r.length;o++){const u=r[o]-t;n+=u*u}return Math.sqrt(n/r.length)}function Qx(r){const t=H1(r),n=r.length;let o=0,u=0;for(let h=0;h<n;h++){const p=r[h]-t;o+=Math.pow(p,2),u+=Math.pow(p,4)}return 1/n*u/Math.pow(1/n*o,2)}function Jx(r){const t=H1(r),n=r.length;let o=0,u=0;for(let h=0;h<n;h++){const p=r[h]-t;o+=Math.pow(p,2),u+=Math.pow(p,3)}return 1/n*u/Math.pow(1/(n-1)*o,3/2)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QS(r,t,n=1,o="float32",u){if(n==null&&(n=1),o==null&&(o="float32"),o!=="float32"&&o!=="int32")throw new Error(`Unsupported data type ${o}`);const h=new ZS(t,n,o,u),p=vs(r,o);for(let g=0;g<p.values.length;g++)p.values[g]=h.nextValue();return p.toTensor()}const Gv=br({randomGamma_:QS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SA(r,t=0,n=1,o,u){if(o!=null&&o==="bool")throw new Error(`Unsupported data type ${o}`);const h=new j1(t,n,o,!1,u),p=vs(r,o);for(let g=0;g<p.values.length;g++)p.values[g]=h.nextValue();return p.toTensor()}const ly=br({randomNormal_:SA});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $u(r,t=0,n=1,o="float32",u){const h=vs(r,o),p=new qS(t,n,null,u);for(let g=0;g<h.values.length;g++)h.values[g]=p.nextValue();return h.toTensor()}const r0=br({randomUniform_:$u});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lh(r,t,n=1,o="float32"){if(n===0)throw new Error("Cannot have a step of zero");const u={start:r,stop:t,step:n,dtype:o};return dr.runKernel(To,{},u)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tw(r){const n={input:pn(r,"input","real")};return dr.runKernel(wo,n)}const wm=br({real_:tw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JS(r){const n={x:pn(r,"x","reciprocal")};return dr.runKernel(Vo,n)}const X1=br({reciprocal_:JS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a0(r){const n={x:pn(r,"x","relu")};return dr.runKernel(js,n)}const td=br({relu_:a0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ew(r){const n={x:pn(r,"x","relu6")};return dr.runKernel(Cl,n)}const i0=br({relu6_:ew});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t2(r,t){const o={x:pn(r,"x","reverse")},u={dims:t};return dr.runKernel(Yl,o,u)}const Ph=br({reverse_:t2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e2(r){const t=pn(r,"x","reverse");return yt(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),Ph(t,0)}const tp=br({reverse1d_:e2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n2(r,t){const n=pn(r,"x","reverse");return yt(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Ph(n,t)}const r2=br({reverse2d_:n2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a2(r,t){const n=pn(r,"x","reverse");return yt(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Ph(n,t)}const i2=br({reverse3d_:a2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o2(r,t){const n=pn(r,"x","reverse");return yt(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Ph(n,t)}const s2=br({reverse4d_:o2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u2(r){const n={x:pn(r,"x","round")};return dr.runKernel(sl,n)}const Y1=br({round_:u2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l2(r){const n={x:pn(r,"x","rsqrt")};return dr.runKernel(rl,n)}const cy=br({rsqrt_:l2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fy(r){const n={x:pn(r,"x","selu")};return dr.runKernel(wc,n)}const o0=br({selu_:fy});function c2(r,t,n,o,u,h=[1,1],p="NHWC"){const g=pn(r,"x","separableConv2d"),x=pn(t,"depthwiseFilter","separableConv2d"),I=pn(n,"pointwiseFilter","separableConv2d");let z=g,V=!1;if(g.rank===3&&(V=!0,z=b(g,[1,g.shape[0],g.shape[1],g.shape[2]])),p==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");yt(z.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${z.rank}.`),yt(x.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${x.rank}.`),yt(I.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${x.rank}.`),yt(I.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${I.shape[0]}.`),yt(I.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${I.shape[1]}.`);const rt=x.shape[2],Et=x.shape[3];yt(I.shape[2]===rt*Et,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${rt*Et}, but got ${I.shape[2]}.`);const St=Qd(z,x,o,u,p,h),Vt=qs(St,I,1,"valid",p);return V?b(Vt,[Vt.shape[1],Vt.shape[2],Vt.shape[3]]):Vt}const K1=br({separableConv2d_:c2});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f2(r,t){return Wr(this,null,function*(){const n=pn(r,"x","setdiff1d"),o=pn(t,"y","setdiff1d");yt(n.dtype===o.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${o.dtype}).`),yt(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),yt(o.rank===1,()=>`y should be 1D tensor, but got y (${o.shape}).`);const u=yield n.data(),h=yield o.data(),p=new Set(h);let g=0;for(let z=0;z<u.length;z++)p.has(u[z])||g++;const x=new ne([g],n.dtype),I=new ne([g],"int32");for(let z=0,V=0;z<u.length;z++)p.has(u[z])||(x.values[V]=u[z],I.values[V]=z,V++);return[x.toTensor(),I.toTensor()]})}const nw=f2;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h2(r){const n={x:pn(r,"x","sign")};return dr.runKernel(Zt,n)}const Z1=br({sign_:h2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d2(r){const n={x:pn(r,"x","sin")};return dr.runKernel(A,n)}const hy=br({sin_:d2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p2(r){const n={x:pn(r,"x","sinh")};return dr.runKernel(nt,n)}const dy=br({sinh_:p2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v2(r,t,n){const o=pn(r,"x","slice1d");return yt(o.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${o.rank} tensor`),Ut(o,[t],[n])}const q1=br({slice1d_:v2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g2(r,t,n){const o=pn(r,"x","slice2d");return yt(o.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${o.rank} tensor`),Ut(o,t,n)}const Q1=br({slice2d_:g2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rw(r,t,n){const o=pn(r,"x","slice3d");return yt(o.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${o.rank} tensor`),Ut(o,t,n)}const py=br({slice3d_:rw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m2(r,t,n){const o=pn(r,"x","slice4d");return yt(o.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${o.rank} tensor`),Ut(o,t,n)}const s0=br({slice4d_:m2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y2(r,t=-1){const n=pn(r,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const o={logits:n},u={dim:t};return dr.runKernel(De,o,u)}const u0=br({softmax_:y2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b2(r){yt(r.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${r.dtype}.`);const t={input:r};return dr.runKernel(pa,t)}const l0=br({fft_:b2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x2(r){yt(r.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${r.dtype}.`);const t={input:r};return dr.runKernel(dl,t)}const Og=br({ifft_:x2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w2(r){const t=r.shape[r.shape.length-1],n=r.size/t;let o;if(t<=2){const u=b(r,[n,t]);o=Og(u)}else{const u=[n,2*(t-1)],h=b(wm(r),[n,t]),p=b(Q0(r),[n,t]),g=Ph(Ut(h,[0,1],[n,t-2]),1),x=Xn(Ph(Ut(p,[0,1],[n,t-2]),1),zi(-1)),I=_t([h,g],1),z=_t([p,x],1),V=b(Rc(I,z),[u[0],u[1]]);o=Og(V)}if(o=wm(o),r.rank===3&&r.shape[0]!==0){const u=o,h=r.shape[0];o=b(o,[h,o.shape[0]/h,o.shape[1]]),u.dispose()}return o}const vy=br({irfft_:w2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E2(r,t,n=0){const u={x:pn(r,"x","split")},h={numOrSizeSplits:t,axis:n};return dr.runKernel(kn,u,h)}const ed=br({split_:E2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S2(r,t){yt(r.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${r.dtype}`);let n=r.shape[r.shape.length-1];const o=r.size/n;let u;if(t!=null&&t<n){const St=r.shape.map(Vt=>0),Tt=r.shape.map(Vt=>Vt);Tt[r.shape.length-1]=t,u=Ut(r,St,Tt),n=t}else if(t!=null&&t>n){const St=r.shape.map(Tt=>Tt);St[r.shape.length-1]=t-n,u=_t([r,Tc(St)],r.shape.length-1),n=t}else u=r;const h=bi(u),p=b(Rc(u,h),[o,n]),g=l0(p),x=Math.floor(n/2)+1,I=wm(g),z=Q0(g),V=ed(I,[x,n-x],I.shape.length-1),rt=ed(z,[x,n-x],z.shape.length-1),Et=u.shape.slice();return Et[u.shape.length-1]=x,b(Rc(V[0],rt[0]),Et)}const c0=br({rfft_:S2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C2(r,t){let n=pn(r,"a","squaredDifference"),o=pn(t,"b","squaredDifference");[n,o]=Ci(n,o),Nr(n.shape,o.shape);const u={a:n,b:o},h={};return dr.runKernel(wr,u,h)}const f0=br({squaredDifference_:C2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _2(r,t){const n=pn(r,"x","squeeze");return b(n,Mn(n.shape,t).newShape)}const Uv=br({squeeze_:_2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2(r,t=0){const n=nh(r,"tensors","stack","string_or_numeric");yt(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&yt(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const o=n,u={axis:t};return dr.runKernel(Ba,o,u)}const nd=br({stack_:I2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T2(r,t=0){const o={x:pn(r,"x","step")},u={alpha:t};return dr.runKernel(zu,o,u)}const Em=br({step_:T2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A2(r,t,n,o,u=0,h=0,p=0,g=0,x=0){const z={x:pn(r,"x","stridedSlice")},V={begin:t,end:n,strides:o,beginMask:u,endMask:h,ellipsisMask:p,newAxisMask:g,shrinkAxisMask:x};return dr.runKernel($a,z,V)}const J1=br({stridedSlice_:A2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2(r){const n={x:pn(r,"x","tan")};return dr.runKernel(ri,n)}const tb=br({tan_:M2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ff(r,t){tn(r);const n=_l(r,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Lc(r,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sm(r,t,n){if(tn(r),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const o=_l(r,n);if(o.length!==2&&o.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(o.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Lc(r,t,o,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N2(r,t,n){if(tn(r),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const o=_l(r,n);if(o.length!==4&&o.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(o.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Lc(r,t,o,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h0(r,t,n){if(tn(r),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const o=_l(r,n);if(o.length!==5&&o.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(o.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Lc(r,t,o,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gy(r,t,n){if(tn(r),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const o=_l(r,n);if(o.length!==6&&o.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(o.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||o,Lc(r,t,o,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function my(r,t=1,n=!0){const o=pn(r,"x","topk");if(o.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const u=o.shape[o.shape.length-1];if(t>u)throw new Error(`'k' passed to topk() must be <= the last dimension (${u}) but got ${t}`);const h={x:o},p={k:t,sorted:n},[g,x]=dr.runKernel(Eo,h,p);return{values:g,indices:x}}const yy=br({topk_:my});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2(r,t=0,n=1,o,u){if(o!=null&&o==="bool")throw new Error("Unsupported data type $ { dtype }");const h=new j1(t,n,o,!0,u),p=vs(r,o);for(let g=0;g<p.values.length;g++)p.values[g]=h.nextValue();return p.toTensor()}const by=br({truncatedNormal_:k2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D2(r,t=0){const n=pn(r,"x","unique","string_or_numeric");yt(n.rank>0,()=>"The input tensor must be at least 1D");const o={x:n},u={axis:t},[h,p]=dr.runKernel(Bo,o,u);return{values:h,indices:p}}const d0=br({unique_:D2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aw(r,t,n){const o=pn(r,"x","unsortedSegmentSum"),u=pn(t,"segmentIds","unsortedSegmentSum","int32");yt(xr(n),()=>"numSegments must be of dtype int");const h={x:o,segmentIds:u},p={numSegments:n};return dr.runKernel(Ao,h,p)}const eb=br({unsortedSegmentSum_:aw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iw(r,t=0){const n=pn(r,"x","unstack","string_or_numeric");yt(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const o={value:n},u={axis:t};return dr.runKernel(go,o,u)}const Cd=br({unstack_:iw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nb(r,t=!0,n,o){return dr.makeVariable(r,t,n,o)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rg(r,t){const n=[];for(let h=0;h<t.length;h++)t[h]&&n.push(h);const o=vs(r,"int32"),u=vs([n.length,r.length],"int32");for(let h=0;h<n.length;h++){const p=o.indexToLoc(n[h]),g=h*r.length;u.values.set(p,g)}return u.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rb(r){return Wr(this,null,function*(){const t=pn(r,"condition","whereAsync","bool"),n=yield t.data(),o=Rg(t.shape,n);return r!==t&&t.dispose(),o})}const Bf=rb;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ab(r,t,n){return Wr(this,null,function*(){const o=pn(r,"tensor","boolMask"),u=pn(t,"mask","boolMask","bool"),h=n==null?0:n,p=u.rank,g=o.shape;yt(p>0,()=>"mask cannot be scalar"),Ne(g.slice(h,h+p),u.shape,"mask's shape must match the first K dimensions of tensor's shape,");let x=1;for(let Tt=h;Tt<h+p;Tt++)x*=g[Tt];const I=g.slice(0,h).concat([x],g.slice(h+p)),z=b(o,I),V=b(u,[-1]),rt=yield Bf(V),Et=Uv(rt,[1]),St=Fv(z,Et,h);return r!==o&&o.dispose(),t!==u&&u.dispose(),Et.dispose(),z.dispose(),V.dispose(),rt.dispose(),St})}const CA=ab;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _A(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","notEqualStrict"),o=pn(t,"b","notEqualStrict");return Ne(n.shape,o.shape,"Error in notEqualStrict: "),fg(n,o)}function IA(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","lessStrict"),o=pn(t,"b","lessStrict");return Ne(n.shape,o.shape,"Error in lessStrict: "),Zm(n,o)}function TA(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","equalStrict"),o=pn(t,"b","equalStrict");return Ne(n.shape,o.shape,"Error in equalStrict: "),Hu(n,o)}function AA(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","lessEqualStrict"),o=pn(t,"b","lessEqualStrict");return Ne(n.shape,o.shape,"Error in lessEqualStrict: "),og(n,o)}function MA(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","greaterStrict"),o=pn(t,"b","greaterStrict");return Ne(n.shape,o.shape,"Error in greaterStrict: "),Ed(n,o)}function NA(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","greaterEqualStrict"),o=pn(t,"b","greaterEqualStrict");return Ne(n.shape,o.shape,"Error in greaterEqualStrict: "),Jd(n,o)}const O2=br({equalStrict_:TA}),R2=br({greaterEqualStrict_:NA}),L2=br({greaterStrict_:MA}),P2=br({lessEqualStrict_:AA}),F2=br({lessStrict_:IA}),B2=br({notEqualStrict_:_A});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bf(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","addStrict"),o=pn(t,"b","addStrict");return Ne(n.shape,o.shape,"Error in addStrict: "),An(n,o)}function z2(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","subStrict"),o=pn(t,"b","subStrict");return Ne(n.shape,o.shape,"Error in subStrict: "),pi(n,o)}function $2(r,t){return na("strict variants of ops have been deprecated and will be removed in future"),Ne(r.shape,t.shape,"Error in powStrict: "),co(r,t)}function ib(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","mul"),o=pn(t,"b","mul");return Ne(n.shape,o.shape,"Error in multiplyStrict: "),Xn(n,o)}function G2(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","div"),o=pn(t,"b","div");return Ne(n.shape,o.shape,"Error in divideStrict: "),rr(n,o)}function U2(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","modStrict"),o=pn(t,"b","modStrict");return Ne(n.shape,o.shape,"Error in modStrict: "),iy(n,o)}function W2(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","minimumStrict"),o=pn(t,"b","minimumStrict");return Ne(n.shape,o.shape,"Error in minimumStrict: "),cg(n,o)}function ow(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","maximumStrict"),o=pn(t,"b","maximumStrict");return Ne(n.shape,o.shape,"Error in maximumStrict: "),Po(n,o)}function ku(r,t){na("strict variants of ops have been deprecated and will be removed in future");const n=pn(r,"a","squaredDifferenceStrict"),o=pn(t,"b","squaredDifferenceStrict");return Ne(n.shape,o.shape,"Error in squaredDifferenceStrict: "),f0(n,o)}const hg=br({addStrict_:bf}),p0=br({divStrict_:G2}),sw=br({maximumStrict_:ow}),uw=br({minimumStrict_:W2}),lw=br({modStrict_:U2}),cw=br({mulStrict_:ib}),pu=br({powStrict_:$2}),fw=br({squaredDifferenceStrict_:ku}),v0=br({subStrict_:z2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hw(r,t="euclidean",n=null,o=!1){r=pn(r,"x","norm");const u=dw(r,t,n);let h=u.shape;if(o){const p=Rr(n,r.shape);h=zc(u.shape,p)}return b(u,h)}function dw(r,t,n=null){if(r.rank===0)return bl(r);if(r.rank!==1&&n===null)return dw(b(r,[-1]),t,n);if(r.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return ss(bl(r),n);if(t===Infinity)return Sd(bl(r),n);if(t===-Infinity)return ym(bl(r),n);if(t==="euclidean"||t===2)return Ti(ss(co(bl(r),zi(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return Sd(ss(bl(r),n[0]),n[1]-1);if(t===Infinity)return Sd(ss(bl(r),n[1]),n[0]);if(t===-Infinity)return ym(ss(bl(r),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Ti(ss(Ai(r),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const xy=br({norm_:hw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V2(r,t,n,o,u=!0){const h=pn(r,"v","movingAverage"),p=pn(t,"x","movingAverage"),g=pn(n,"decay","movingAverage");os(h,p),yt(Un(h.shape,p.shape),()=>"Shape mismatch in v and x");const x=zi(1),I=pi(x,g);let z=Xn(pi(p,h),I);if(u){yt(o!=null,()=>"When using zeroDebias: true, step is required.");const V=pn(o,"step","movingAverage");z=rr(z,pi(x,co(g,V)))}return An(h,z)}const j2=br({movingAverage_:V2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H2(r,t,n){const o=pn(r,"indices","scatterND","int32"),u=pn(t,"updates","scatterND");Nv(u,o,n);const h={indices:o,updates:u},p={shape:n};return dr.runKernel(_f,h,p)}const pw=br({scatterND_:H2});function X2(r,t,n,o){if(r.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${r.dtype}.`);if(r.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${r.shape}.`);const u=r.rank>0?r.shape[0]:1,h=r.rank>1?r.shape[1]:1;if(n.length!==h)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${h}.`);const p=t.size;if(!(t.rank===0||t.rank===1&&p===u))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${u}]`);if(t.dtype!==o.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vw(r,t,n,o=0){const u=pn(r,"sparseIndices","sparseToDense","int32"),h=pn(t,"sparseValues","sparseToDense"),p=pn(o,"defaultValue","sparseToDense",h.dtype);X2(u,h,n,p);const g={sparseIndices:u,sparseValues:h,defaultValue:p},x={outputShape:n};return dr.runKernel(ua,g,x)}const ob=br({sparseToDense_:vw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wv(r,t){const n=pn(t,"indices","gatherND","int32"),u={params:pn(r,"x","gatherND"),indices:n};return dr.runKernel(vo,u)}const gw=br({gatherND_:Wv});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y2(r,t){if(t==null)return r.shape.slice();if(Un(r.shape,t))return t;if(r.shape.length===t.length){const n=[];for(let o=0;o<r.shape.length;o++)t[o]==null&&r.shape[o]!=null?n.push(r.shape[o]):n.push(t[o]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2(r,t,n,o){const u=pn(r,"x","dropout");if(yt(u.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${u.dtype} tensor instead.`),yt(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return r instanceof Dn?u.clone():u;const h=Y2(u,n),p=1-t,g=rr(pm(An(r0(h,0,1,"float32",o),p)),p);return Xn(u,g)}const mw=br({dropout_:K2});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yw(r){return Math.floor(Math.pow(2,Math.ceil(Math.log(r)/Math.log(2))))}function sb(r,t,n){const o=1-r%2,u=new Float32Array(r);for(let h=0;h<r;++h){const p=2*Math.PI*h/(r+o-1);u[h]=t-n*Math.cos(p)}return Ff(u,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z2(r,t,n=1){return Wr(this,null,function*(){const o=pn(r,"predictions","inTopK"),u=pn(t,"targets","inTopK");yt(o.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${o.rank}`),yt(o.rank-1===u.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${o.rank} and targets rank ${u.rank}`),Ne(o.shape.slice(0,o.shape.length-1),u.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const h=o.shape[o.shape.length-1];yt(n>0&&n<=h,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${h}), but got ${n}`);const p=yield o.data(),g=yield u.data(),[x,I]=[p.length/h,h],z=ar("bool",x);for(let V=0;V<x;V++){const rt=V*I,Et=p.subarray(rt,rt+I),St=[];for(let Tt=0;Tt<Et.length;Tt++)St.push({value:Et[Tt],index:Tt});St.sort((Tt,Vt)=>Vt.value-Tt.value),z[V]=0;for(let Tt=0;Tt<n;Tt++)if(St[Tt].index===g[V]){z[V]=1;break}}return r!==o&&o.dispose(),t!==u&&u.dispose(),Vc(z,u.shape,"bool")})}const Cm=Z2;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ub(r,t,n,o,u,h="NHWC",p){let g=r;r.rank===3&&(g=b(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let x=t;x.rank===3&&(x=b(t,[1,t.shape[0],t.shape[1],t.shape[2]])),yt(g.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${g.shape}.`),yt(x.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${x.shape}.`),yt(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const I=h==="NHWC"?g.shape[3]:g.shape[1],z=h==="NHWC"?x.shape[3]:x.shape[1];yt(I===n[2],()=>`Error in conv2dDerFilter: depth of input ${I}) must match input depth in filter (${n[2]}.`),yt(z===n[3],()=>`Error in conv2dDerFilter: depth of dy (${z}) must match output depth for filter (${n[3]}).`),p!=null&&yt(xr(u),()=>`Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode ${p} but got pad ${u}.`);const V={x:g,dy:x},rt={strides:o,pad:u,dataFormat:h,dimRoundingMode:p,filterShape:n};return dr.runKernel(Io,V,rt)}const wy=br({conv2DBackpropFilter_:ub});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0(r,t,n){if(n==null||n==="linear")return r;if(n==="relu")return Xn(r,Em(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Lg(r,t){let n=t;const o=Jr(r.shape,t.shape);return o.length>0&&(n=ss(n,o)),b(n,r.shape)}function Ey(r,t,n,o){if(t==="linear")return r;if(t==="relu")return td(r);if(t==="elu")return fm(r);if(t==="relu6")return i0(r);if(t==="prelu")return bm(r,n);if(t==="leakyrelu")return vm(r,o);throw new Error(`Unknown fused activation ${t}.`)}const Sy=(r,t)=>!(r>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q2({x:r,filter:t,strides:n,pad:o,dataFormat:u="NHWC",dilations:h=[1,1],dimRoundingMode:p,bias:g,activation:x="linear",preluActivationWeights:I,leakyreluAlpha:z}){if(x=x||"linear",Sy(dr.state.gradientDepth,x)===!1){let Xe=qs(r,t,n,o,u,h,p);return g!=null&&(Xe=An(Xe,g)),Ey(Xe,x,I,z)}const V=pn(r,"x","conv2d"),rt=pn(t,"filter","conv2d");let Et=V,St=!1;V.rank===3&&(St=!0,Et=b(V,[1,V.shape[0],V.shape[1],V.shape[2]])),yt(Et.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${Et.rank}.`),yt(rt.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${rt.rank}.`),p!=null&&yt(xr(o),()=>`Error in fused conv2d: pad must be an integer when using, dimRoundingMode ${p} but got pad ${o}.`),yt(Et.shape[3]===rt.shape[2],()=>`Error in conv2d: depth of input (${Et.shape[3]}) must match input depth for filter ${rt.shape[2]}.`),yt(_c(n,h),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${h}'`),yt(u==="NHWC",()=>`Error in conv2d: got dataFormat of ${u} but only NHWC is currently supported.`);const Tt=ql(Et.shape,rt.shape,n,h,o,p);let Vt;g!=null&&(Vt=pn(g,"bias","fused conv2d"),[Vt]=Ci(Vt,V),Nr(Tt.outShape,Vt.shape));let ue;I!=null&&(ue=pn(I,"prelu weights","fused conv2d"));const ye=(Xe,Pn)=>{const[In,gr,Br,Kr]=Pn,Na=g0(Xe,Br,x);yt(iv(h),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${h}'`);const Ya=Xs(gr.shape,Na,In,n,o),Ha=wy(gr,Na,In.shape,n,o),ni=[Ya,Ha];if(Kr!=null){const Wa=Lg(Kr,Na);ni.push(Wa)}return ni},qe={x:Et,filter:rt,bias:Vt,preluActivationWeights:ue},$e={strides:n,pad:o,dataFormat:u,dilations:h,dimRoundingMode:p,activation:x,leakyreluAlpha:z};return g==null?Eu((Pn,In,gr)=>{let Br=dr.runKernel(al,qe,$e);return gr([In,Pn,Br]),St&&(Br=b(Br,[Br.shape[1],Br.shape[2],Br.shape[3]])),{value:Br,gradFunc:ye}})(Et,rt):Eu((Pn,In,gr,Br)=>{let Kr=dr.runKernel(al,qe,$e);return Br([In,Pn,Kr,gr]),St&&(Kr=b(Kr,[Kr.shape[1],Kr.shape[2],Kr.shape[3]])),{value:Kr,gradFunc:ye}})(Et,rt,Vt)}const lb=br({fusedConv2d_:q2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cb(r,t,n,o,u,h=[1,1],p){let g=r;r.rank===3&&(g=b(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let x=t;x.rank===3&&(x=b(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const I={x:g,dy:x},z={strides:o,pad:u,dimRoundingMode:p,dilations:h,filterShape:n};return dr.runKernel(Es,I,z)}const bw=br({depthwiseConv2dNativeBackpropFilter_:cb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2(r,t,n,o,u,h=[1,1],p){let g=t,x=!1;t.rank===3&&(x=!0,g=b(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const I={dy:g,filter:n},z={strides:o,pad:u,dimRoundingMode:p,dilations:h,inputShape:r},V=dr.runKernel(tl,I,z);return x?b(V,[V.shape[1],V.shape[2],V.shape[3]]):V}const xw=br({depthwiseConv2dNativeBackpropInput_:Q2});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ww({x:r,filter:t,strides:n,pad:o,dataFormat:u="NHWC",dilations:h=[1,1],dimRoundingMode:p,bias:g,activation:x="linear",preluActivationWeights:I,leakyreluAlpha:z}){if(Sy(dr.state.gradientDepth,x)===!1){let Xe=Qd(r,t,n,o,u,h,p);return g!=null&&(Xe=An(Xe,g)),Ey(Xe,x,I,z)}const V=pn(r,"x","depthwiseConv2d"),rt=pn(t,"filter","depthwiseConv2d");let Et=V,St=!1;V.rank===3&&(St=!0,Et=b(V,[1,V.shape[0],V.shape[1],V.shape[2]])),yt(Et.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${Et.rank}.`),yt(rt.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${rt.rank}.`),yt(Et.shape[3]===rt.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${Et.shape[3]}) must match the inChannels dimension in filter ${rt.shape[2]}.`),h==null&&(h=[1,1]),yt(_c(n,h),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${h}'`),p!=null&&yt(xr(o),()=>`Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode ${p} but got pad ${o}.`);const Tt=ql(Et.shape,rt.shape,n,h,o,p,!0);let Vt;g!=null&&(Vt=pn(g,"bias","fused conv2d"),[Vt]=Ci(Vt,V),Nr(Tt.outShape,Vt.shape));let ue;I!=null&&(ue=pn(I,"prelu weights","fused depthwiseConv2d"));const ye=(Xe,Pn)=>{yt(iv(h),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${h}'`);const[In,gr,Br,Kr]=Pn,Na=g0(Xe,Br,x),Ya=xw(gr.shape,Na,In,n,o,h,p),Ha=bw(gr,Na,In.shape,n,o,h,p);if(Kr!=null){const ni=Lg(Vt,Na);return[Ya,Ha,ni]}return[Ya,Ha]},qe={x:Et,filter:rt,bias:Vt,preluActivationWeights:ue},$e={strides:n,pad:o,dataFormat:u,dilations:h,dimRoundingMode:p,activation:x,leakyreluAlpha:z};return g==null?Eu((Pn,In,gr)=>{let Br=dr.runKernel(Vu,qe,$e);return gr([In,Pn,Br]),St&&(Br=b(Br,[Br.shape[1],Br.shape[2],Br.shape[3]])),{value:Br,gradFunc:ye}})(Et,rt):Eu((Pn,In,gr,Br)=>{let Kr=dr.runKernel(Vu,qe,$e);return Br([In,Pn,Kr,gr]),St&&(Kr=b(Kr,[Kr.shape[1],Kr.shape[2],Kr.shape[3]])),{value:Kr,gradFunc:ye}})(Et,rt,Vt)}const fb=br({fusedDepthwiseConv2d_:ww});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m0({a:r,b:t,transposeA:n=!1,transposeB:o=!1,bias:u,activation:h="linear",preluActivationWeights:p,leakyreluAlpha:g}){if(Sy(dr.state.gradientDepth,h)===!1){let Kr=Zs(r,t,n,o);return u!=null&&(Kr=An(Kr,u)),Ey(Kr,h,p,g)}let x=pn(r,"a","fused matMul"),I=pn(t,"b","fused matMul");[x,I]=Ci(x,I);const z=n?x.shape[x.rank-2]:x.shape[x.rank-1],V=o?I.shape[I.rank-1]:I.shape[I.rank-2],rt=n?x.shape[x.rank-1]:x.shape[x.rank-2],Et=o?I.shape[I.rank-2]:I.shape[I.rank-1],St=x.shape.slice(0,-2),Tt=I.shape.slice(0,-2),Vt=Rt(St),ue=Rt(Tt);yt(x.rank>=2&&I.rank>=2&&x.rank===I.rank,()=>`Error in fused matMul: inputs must have the same rank of at least 2, got ranks ${x.rank} and ${I.rank}.`),yt(Un(St,Tt),()=>`Error in fused matMul: outer dimensions (${St}) and (${Tt}) of Tensors with shapes ${x.shape} and ${I.shape} must match.`),yt(z===V,()=>`Error in fused matMul: inner shapes (${z}) and (${V}) of Tensors with shapes ${x.shape} and ${I.shape} and transposeA=${n} and transposeB=${o} must match.`);const ye=x.shape.slice(0,-2).concat([rt,Et]),qe=n?b(x,[Vt,z,rt]):b(x,[Vt,rt,z]),$e=o?b(I,[ue,Et,V]):b(I,[ue,V,Et]);let Xe;u!=null&&(Xe=pn(u,"bias","fused matMul"),[Xe]=Ci(Xe,x),Nr(ye,Xe.shape));let Pn;p!=null&&(Pn=pn(p,"prelu weights","fused matMul"));const In=(Kr,Na)=>{const[Ya,Ha,ni,Wa]=Na,za=g0(b(Kr,ni.shape),ni,h);let mi,qa;if(!n&&!o?(mi=Zs(za,Ha,!1,!0),qa=Zs(Ya,za,!0,!1)):!n&&o?(mi=Zs(za,Ha,!1,!1),qa=Zs(za,Ya,!0,!1)):n&&!o?(mi=Zs(Ha,za,!1,!0),qa=Zs(Ya,za,!1,!1)):(mi=Zs(Ha,za,!0,!0),qa=Zs(za,Ya,!0,!0)),u!=null){const yi=Lg(Wa,za);return[mi,qa,yi]}else return[mi,qa]},gr={a:qe,b:$e,bias:Xe,preluActivationWeights:Pn},Br={transposeA:n,transposeB:o,activation:h,leakyreluAlpha:g};return u==null?Eu((Na,Ya,Ha)=>{const ni=dr.runKernel(Wu,gr,Br);return Ha([Na,Ya,ni]),{value:b(ni,ye),gradFunc:In}})(qe,$e):Eu((Na,Ya,Ha,ni)=>{const Wa=dr.runKernel(Wu,gr,Br);return ni([Na,Ya,Wa,Ha]),{value:b(Wa,ye),gradFunc:In}})(qe,$e,Xe)}const _m=br({fusedMatMul_:m0});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ew(r){return sb(r,.54,.46)}const hb=br({hammingWindow_:Ew});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J2(r){return sb(r,.5,.5)}const Hl=br({hannWindow_:J2});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tC(r,t,n,o=!1,u=0){let h=0;const p=[];for(;h+t<=r.size;)p.push(Ut(r,h,t)),h+=n;if(o)for(;h<r.size;){const g=h+t-r.size,x=_t([Ut(r,h,t-g),Jo([g],u)]);p.push(x),h+=n}return p.length===0?Sm([],[0,t]):b(_t(p),[p.length,t])}const Sw=br({frame_:tC});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cw(r,t,n,o,u=Hl){o==null&&(o=yw(t));const h=Sw(r,t,n),p=Xn(h,u(t)),g=[];for(let x=0;x<h.shape[0];x++)g.push(c0(Ut(p,[x,0],[1,t]),o));return _t(g)}const eC=br({stft_:Cw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nC(r,t,n,o,u="bilinear",h=0){const p=pn(r,"image","cropAndResize"),g=pn(t,"boxes","cropAndResize","float32"),x=pn(n,"boxInd","cropAndResize","int32"),I=g.shape[0];yt(p.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${p.rank}.`),yt(g.rank===2&&g.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${I},4] but had shape ${g.shape}.`),yt(x.rank===1&&x.shape[0]===I,()=>`Error in cropAndResize: boxInd must be have size [${I}] but had shape ${g.shape}.`),yt(o.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${o.length}.`),yt(o[0]>=1&&o[1]>=1,()=>`cropSize must be atleast [1,1], but was ${o}`),yt(u==="bilinear"||u==="nearest",()=>`method must be bilinear or nearest, but was ${u}`);const z={image:p,boxes:g,boxInd:x},V={method:u,extrapolationValue:h,cropSize:o};return dr.runKernel(qo,z,V)}const _w=br({cropAndResize_:nC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rC(r){const t=pn(r,"image","flipLeftRight","float32");yt(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return dr.runKernel(Qi,n,{})}const db=br({flipLeftRight_:rC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aC(r,t,n=0,o=.5){const u=pn(r,"image","rotateWithOffset","float32");yt(u.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${u.rank}.`);const h={image:u},p={radians:t,fillValue:n,center:o};return dr.runKernel(Qu,h,p)}const iC=br({rotateWithOffset_:aC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ps(r,t,n,o,u,h){o==null&&(o=.5),u==null&&(u=Number.NEGATIVE_INFINITY),h==null&&(h=0);const p=r.shape[0];return n=Math.min(n,p),yt(0<=o&&o<=1,()=>`iouThreshold must be in [0, 1], but was '${o}'`),yt(r.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${r.rank}'`),yt(r.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${r.shape[1]}`),yt(t.rank===1,()=>"scores must be a 1D tensor"),yt(t.shape[0]===p,()=>`scores has incompatible shape with boxes. Expected ${p}, but was ${t.shape[0]}`),yt(0<=h&&h<=1,()=>`softNmsSigma must be in [0, 1], but was '${h}'`),{maxOutputSize:n,iouThreshold:o,scoreThreshold:u,softNmsSigma:h}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oC(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY){const h=pn(r,"boxes","nonMaxSuppression"),p=pn(t,"scores","nonMaxSuppression"),g=Ps(h,p,n,o,u);n=g.maxOutputSize,o=g.iouThreshold,u=g.scoreThreshold;const x={maxOutputSize:n,iouThreshold:o,scoreThreshold:u};return dr.runKernel(xn,{boxes:h,scores:p},x)}const rd=br({nonMaxSuppression_:oC});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sC(r,t,n){const o=Iw(r,t,n),u=o<0?-(o+1):o;r.splice(u,0,t)}function Iw(r,t,n){return lC(r,t,n||uC)}function uC(r,t){return r>t?1:r<t?-1:0}function lC(r,t,n){let o=0,u=r.length,h=0,p=!1;for(;o<u;){h=o+(u-o>>>1);const g=n(t,r[h]);g>0?o=h+1:(u=h,p=!g)}return p?o:-o-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cy(r,t,n,o,u){return pb(r,t,n,o,u,0)}function Pg(r,t,n,o,u,h){return pb(r,t,n,o,u,0,!1,h,!0)}function _y(r,t,n,o,u,h){return pb(r,t,n,o,u,h,!0)}function pb(r,t,n,o,u,h,p=!1,g=!1,x=!1){const I=[];for(let Vt=0;Vt<t.length;Vt++)t[Vt]>u&&I.push({score:t[Vt],boxIndex:Vt,suppressBeginIndex:0});I.sort(Iy);const z=h>0?-.5/h:0,V=[],rt=[];for(;V.length<n&&I.length>0;){const Vt=I.pop(),{score:ue,boxIndex:ye,suppressBeginIndex:qe}=Vt;if(ue<u)break;let $e=!1;for(let Xe=V.length-1;Xe>=qe;--Xe){const Pn=cC(r,ye,V[Xe]);if(Pn>=o){$e=!0;break}if(Vt.score=Vt.score*fC(o,z,Pn),Vt.score<=u)break}Vt.suppressBeginIndex=V.length,$e||(Vt.score===ue?(V.push(ye),rt.push(Vt.score)):Vt.score>u&&sC(I,Vt,Iy))}const Et=V.length,St=n-Et;g&&St>0&&(V.push(...new Array(St).fill(0)),rt.push(...new Array(St).fill(0)));const Tt={selectedIndices:V};return p&&(Tt.selectedScores=rt),x&&(Tt.validOutputs=Et),Tt}function cC(r,t,n){const o=r.subarray(t*4,t*4+4),u=r.subarray(n*4,n*4+4),h=Math.min(o[0],o[2]),p=Math.min(o[1],o[3]),g=Math.max(o[0],o[2]),x=Math.max(o[1],o[3]),I=Math.min(u[0],u[2]),z=Math.min(u[1],u[3]),V=Math.max(u[0],u[2]),rt=Math.max(u[1],u[3]),Et=(g-h)*(x-p),St=(V-I)*(rt-z);if(Et<=0||St<=0)return 0;const Tt=Math.max(h,I),Vt=Math.max(p,z),ue=Math.min(g,V),ye=Math.min(x,rt),qe=Math.max(ue-Tt,0)*Math.max(ye-Vt,0);return qe/(Et+St-qe)}function fC(r,t,n){const o=Math.exp(t*n*n);return n<=r?o:0}function Iy(r,t){return r.score-t.score||r.score===t.score&&t.boxIndex-r.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tw(h,p,g){return Wr(this,arguments,function*(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY){const x=pn(r,"boxes","nonMaxSuppressionAsync"),I=pn(t,"scores","nonMaxSuppressionAsync"),z=Ps(x,I,n,o,u);n=z.maxOutputSize,o=z.iouThreshold,u=z.scoreThreshold;const V=yield Promise.all([x.data(),I.data()]),rt=V[0],Et=V[1],{selectedIndices:St}=Cy(rt,Et,n,o,u);return x!==r&&x.dispose(),I!==t&&I.dispose(),Ff(St,"int32")})}const hC=Tw;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dC(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY,h=0){const p=pn(r,"boxes","nonMaxSuppression"),g=pn(t,"scores","nonMaxSuppression"),x=Ps(p,g,n,o,u,h);n=x.maxOutputSize,o=x.iouThreshold,u=x.scoreThreshold,h=x.softNmsSigma;const I={boxes:p,scores:g},z={maxOutputSize:n,iouThreshold:o,scoreThreshold:u,softNmsSigma:h},V=dr.runKernel($r,I,z);return{selectedIndices:V[0],selectedScores:V[1]}}const pC=br({nonMaxSuppressionWithScore_:dC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vC(p,g,x){return Wr(this,arguments,function*(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY,h=0){const I=pn(r,"boxes","nonMaxSuppressionAsync"),z=pn(t,"scores","nonMaxSuppressionAsync"),V=Ps(I,z,n,o,u,h);n=V.maxOutputSize,o=V.iouThreshold,u=V.scoreThreshold,h=V.softNmsSigma;const rt=yield Promise.all([I.data(),z.data()]),Et=rt[0],St=rt[1],{selectedIndices:Tt,selectedScores:Vt}=_y(Et,St,n,o,u,h);return I!==r&&I.dispose(),z!==t&&z.dispose(),{selectedIndices:Ff(Tt,"int32"),selectedScores:Ff(Vt)}})}const Aw=vC;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gC(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY,h=!1){const p=pn(r,"boxes","nonMaxSuppression"),g=pn(t,"scores","nonMaxSuppression"),x=Ps(p,g,n,o,u,null),I=x.maxOutputSize,z=x.iouThreshold,V=x.scoreThreshold,rt={boxes:p,scores:g},Et={maxOutputSize:I,iouThreshold:z,scoreThreshold:V,padToMaxOutputSize:h},St=dr.runKernel(ir,rt,Et);return{selectedIndices:St[0],validOutputs:St[1]}}const mC=br({nonMaxSuppressionPadded_:gC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yC(p,g,x){return Wr(this,arguments,function*(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY,h=!1){const I=pn(r,"boxes","nonMaxSuppressionAsync"),z=pn(t,"scores","nonMaxSuppressionAsync"),V=Ps(I,z,n,o,u,null),rt=V.maxOutputSize,Et=V.iouThreshold,St=V.scoreThreshold,[Tt,Vt]=yield Promise.all([I.data(),z.data()]),{selectedIndices:ue,validOutputs:ye}=Pg(Tt,Vt,rt,Et,St,h);return I!==r&&I.dispose(),z!==t&&z.dispose(),{selectedIndices:Ff(ue,"int32"),validOutputs:zi(ye,"int32")}})}const uv=yC;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bC(r,t,n=!1,o=!1){const u=pn(r,"images","resizeBilinear");yt(u.rank===3||u.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${u.rank}.`),yt(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),yt(o===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let h=u,p=!1;u.rank===3&&(p=!0,h=b(u,[1,u.shape[0],u.shape[1],u.shape[2]]));const[]=t,g={images:h},x={alignCorners:n,halfPixelCenters:o,size:t},I=dr.runKernel(Mu,g,x);return p?b(I,[I.shape[1],I.shape[2],I.shape[3]]):I}const vb=br({resizeBilinear_:bC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xC(r,t,n=!1,o=!1){const u=pn(r,"images","resizeNearestNeighbor");yt(u.rank===3||u.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${u.rank}.`),yt(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),yt(u.dtype==="float32"||u.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),yt(o===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let h=u,p=!1;u.rank===3&&(p=!0,h=b(u,[1,u.shape[0],u.shape[1],u.shape[2]]));const[]=t,g={images:h},x={alignCorners:n,halfPixelCenters:o,size:t},I=dr.runKernel(ks,g,x);return p?b(I,[I.shape[1],I.shape[2],I.shape[3]]):I}const Mw=br({resizeNearestNeighbor_:xC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wC(r,t,n){yt(t%1==0,()=>`bandPart(): numLower must be an integer, got ${t}.`),yt(n%1==0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const o=pn(r,"a","bandPart");yt(o.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${o.rank}.`);const u=o.shape,[h,p]=o.shape.slice(-2);if(!(t<=h))throw new Error(`bandPart(): numLower (${t}) must not be greater than the number of rows (${h}).`);if(!(n<=p))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${p}).`);t<0&&(t=h),n<0&&(n=p);const g=b(Lh(0,h,1,"int32"),[-1,1]),x=Lh(0,p,1,"int32"),I=pi(g,x),z=Rh(og(I,zi(+t,"int32")),Jd(I,zi(-n,"int32"))),V=Tc([h,p],o.dtype);return b(nd(Cd(b(o,[-1,h,p])).map(rt=>Lf(z,rt,V))),u)}const gb=br({bandPart_:wC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ty(r){let t;if(Array.isArray(r)){t=!1,yt(r!=null&&r.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const u=r[0].shape[0];for(let h=1;h<r.length;++h)yt(r[h].shape[0]===u,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${r[h].shape[0]} vs. ${u})`)}else t=!0,r=ed(r,r.shape[0],0).map(u=>Uv(u,[0]));yt(r.length<=r[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${r.length}) exceeds number of dimensions (${r[0].shape[0]}).`);const n=[],o=r;for(let u=0;u<r.length;++u)n.push(dr.tidy(()=>{let h=o[u];if(u>0)for(let p=0;p<u;++p){const g=Xn(ss(Xn(n[p],h)),n[p]);h=pi(h,g)}return rr(h,xy(h,"euclidean"))}));return t?nd(n,0):n}const Nw=br({gramSchmidt_:Ty});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EC(r,t=!1){if(yt(r.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${r.rank}`),r.rank===2)return kw(r,t);{const n=r.shape.slice(0,r.shape.length-2).reduce((x,I)=>x*I),o=Cd(b(r,[n,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),u=[],h=[];o.forEach(x=>{const[I,z]=kw(x,t);u.push(I),h.push(z)});const p=b(nd(u,0),r.shape),g=b(nd(h,0),r.shape);return[p,g]}}function kw(r,t=!1){return dr.tidy(()=>{yt(r.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${r.shape.length}D Tensor.`);const n=r.shape[0],o=r.shape[1];let u=dm(n),h=_h(r);const p=Sm([[1]],[1,1]);let g=_h(p);const x=n>=o?o:n;for(let I=0;I<x;++I){const z=h,V=g,rt=u;[g,h,u]=dr.tidy(()=>{const Et=Ut(h,[I,I],[n-I,1]),St=xy(Et),Tt=Ut(h,[I,I],[1,1]),Vt=Lf(Ed(Tt,0),Sm([[-1]]),Sm([[1]])),ue=pi(Tt,Xn(Vt,St)),ye=rr(Et,ue);ye.shape[0]===1?g=_h(p):g=_t([p,Ut(ye,[1,0],[ye.shape[0]-1,ye.shape[1]])],0);const qe=Ic(rr(Zs(Vt,ue),St)),$e=Ut(h,[I,0],[n-I,o]),Xe=Xn(qe,g),Pn=cu(g);if(I===0)h=pi($e,Zs(Xe,Zs(Pn,$e)));else{const Br=pi($e,Zs(Xe,Zs(Pn,$e)));h=_t([Ut(h,[0,0],[I,o]),Br],0)}const In=cu(Xe),gr=Ut(u,[0,I],[n,u.shape[1]-I]);if(I===0)u=pi(gr,Zs(Zs(gr,g),In));else{const Br=pi(gr,Zs(Zs(gr,g),In));u=_t([Ut(u,[0,0],[n,I]),Br],1)}return[g,h,u]}),N([z,V,rt])}return!t&&n>o&&(u=Ut(u,[0,0],[n,o]),h=Ut(h,[0,0],[o,o])),[u,h]})}const SC=br({qr_:EC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var qf;(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(qf||(qf={}));function CC(r,t,n=qf.SUM_BY_NONZERO_WEIGHTS){const o=pn(r,"losses","computeWeightedLoss");let u=null;t!=null&&(u=pn(t,"weights","computeWeightedLoss"));const h=u==null?o:Xn(o,u);if(n===qf.NONE)return h;if(n===qf.SUM)return ss(h);if(n===qf.MEAN){if(u==null)return cc(h);{const p=o.size/u.size,g=rr(ss(h),ss(u));return p>1?rr(g,zi(p)):g}}if(n===qf.SUM_BY_NONZERO_WEIGHTS){if(u==null)return rr(ss(h),zi(o.size));{const p=Xn(u,sv(o.shape)),g=eo(ss(fg(p,zi(0))),"float32");return rr(ss(h),g)}}throw Error(`Unknown reduction: ${n}`)}const Vv=br({computeWeightedLoss_:CC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _C(r,t,n,o=qf.SUM_BY_NONZERO_WEIGHTS){const u=pn(r,"labels","absoluteDifference"),h=pn(t,"predictions","absoluteDifference");let p=null;n!=null&&(p=pn(n,"weights","absoluteDifference")),Ne(u.shape,h.shape,"Error in absoluteDifference: ");const g=bl(pi(u,h));return Vv(g,p,o)}const IC=br({absoluteDifference_:_C});function TC(r,t,n,o,u=qf.SUM_BY_NONZERO_WEIGHTS){const h=pn(r,"labels","cosineDistance"),p=pn(t,"predictions","cosineDistance");let g=null;o!=null&&(g=pn(o,"weights","cosineDistance")),Ne(h.shape,p.shape,"Error in cosineDistance: ");const x=zi(1),I=pi(x,ss(Xn(h,p),n,!0));return Vv(I,g,u)}const AC=br({cosineDistance_:TC});function Dw(r,t,n,o=qf.SUM_BY_NONZERO_WEIGHTS){let u=pn(r,"labels","hingeLoss");const h=pn(t,"predictions","hingeLoss");let p=null;n!=null&&(p=pn(n,"weights","hingeLoss")),Ne(u.shape,h.shape,"Error in hingeLoss: ");const g=zi(1);u=pi(Xn(zi(2),u),g);const x=td(pi(g,Xn(u,h)));return Vv(x,p,o)}const Ow=br({hingeLoss_:Dw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lv(r,t,n,o=1,u=qf.SUM_BY_NONZERO_WEIGHTS){const h=pn(r,"labels","huberLoss"),p=pn(t,"predictions","huberLoss");let g=null;n!=null&&(g=pn(n,"weights","huberLoss")),Ne(h.shape,p.shape,"Error in huberLoss: ");const x=zi(o),I=bl(pi(p,h)),z=cg(I,x),V=pi(I,z),rt=An(Xn(zi(.5),Ai(z)),Xn(x,V));return Vv(rt,g,u)}const Fg=br({huberLoss_:lv});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dg(r,t,n,o=1e-7,u=qf.SUM_BY_NONZERO_WEIGHTS){const h=pn(r,"labels","logLoss"),p=pn(t,"predictions","logLoss");let g=null;n!=null&&(g=pn(n,"weights","logLoss")),Ne(h.shape,p.shape,"Error in logLoss: ");const x=zi(1),I=zi(o),z=Ic(Xn(h,Oh(An(p,I)))),V=Xn(pi(x,h),Oh(An(pi(x,p),I))),rt=pi(z,V);return Vv(rt,g,u)}const y0=br({logLoss_:dg});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b0(r,t,n,o=qf.SUM_BY_NONZERO_WEIGHTS){const u=pn(r,"labels","meanSquaredError"),h=pn(t,"predictions","meanSquaredError");let p=null;n!=null&&(p=pn(n,"weights","meanSquaredError")),Ne(u.shape,h.shape,"Error in meanSquaredError: ");const g=f0(u,h);return Vv(g,p,o)}const kA=br({meanSquaredError_:b0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DA(r,t){const n=pn(r,"labels","sigmoidCrossEntropyWithLogits"),o=pn(t,"logits","sigmoidCrossEntropyWithLogits");Ne(n.shape,o.shape,"Error in sigmoidCrossEntropyWithLogits: ");const u=td(o),h=Xn(o,n),p=qm(Kf(Ic(bl(o))));return An(pi(u,h),p)}function OA(r,t,n,o=0,u=qf.SUM_BY_NONZERO_WEIGHTS){let h=pn(r,"multiClassLabels","sigmoidCrossEntropy");const p=pn(t,"logits","sigmoidCrossEntropy");let g=null;if(n!=null&&(g=pn(n,"weights","sigmoidCrossEntropy")),Ne(h.shape,p.shape,"Error in sigmoidCrossEntropy: "),o>0){const I=zi(o),z=zi(1),V=zi(.5);h=An(Xn(h,pi(z,I)),Xn(V,I))}const x=DA(h,p);return Vv(x,g,u)}const MC=br({sigmoidCrossEntropy_:OA});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NC(r,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return Eu((u,h,p)=>{const x=ny(h,[n],!0),I=pi(eo(h,"float32"),x);p([u,I]);const z=Ic(Xn(I,u));return{value:ss(z,[n]),gradFunc:(Et,St)=>{const[Tt,Vt]=St,ue=zc(Et.shape,[n]);return[Xn(b(Et,ue),pi(eo(Tt,"float32"),Kf(Vt))),Xn(b(Et,ue),pi(Kf(Vt),eo(Tt,"float32")))]}}})(r,t)}function mb(r,t,n,o=0,u=qf.SUM_BY_NONZERO_WEIGHTS){let h=pn(r,"onehotLabels","softmaxCrossEntropy");const p=pn(t,"logits","softmaxCrossEntropy");let g=null;if(n!=null&&(g=pn(n,"weights","softmaxCrossEntropy")),Ne(h.shape,p.shape,"Error in softmaxCrossEntropy: "),o>0){const I=zi(o),z=zi(1),V=zi(h.shape[1]);h=An(Xn(h,pi(z,I)),rr(I,V))}const x=NC(h,p);return Vv(x,g,u)}const kC=br({softmaxCrossEntropy_:mb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DC={fft:l0,ifft:Og,rfft:c0,irfft:vy},qc={hammingWindow:hb,hannWindow:Hl,frame:Sw,stft:eC},ep={flipLeftRight:db,resizeNearestNeighbor:Mw,resizeBilinear:vb,rotateWithOffset:iC,cropAndResize:_w,nonMaxSuppression:rd,nonMaxSuppressionAsync:hC,nonMaxSuppressionWithScore:pC,nonMaxSuppressionWithScoreAsync:Aw,nonMaxSuppressionPadded:mC,nonMaxSuppressionPaddedAsync:uv},Rw={bandPart:gb,gramSchmidt:Nw,qr:SC},OC={absoluteDifference:IC,computeWeightedLoss:Vv,cosineDistance:AC,hingeLoss:Ow,huberLoss:Fg,logLoss:y0,meanSquaredError:kA,sigmoidCrossEntropy:MC,softmaxCrossEntropy:kC};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bg{static sgd(t){return new ln(t)}static momentum(t,n,o=!1){return new fr(t,n,o)}static rmsprop(t,n=.9,o=0,u=null,h=!1){return new Pr(t,n,o,u,h)}static adam(t=.001,n=.9,o=.999,u=null){return new ll(t,n,o,u)}static adadelta(t=.001,n=.95,o=null){return new ml(t,n,o)}static adamax(t=.002,n=.9,o=.999,u=null,h=0){return new Nn(t,n,o,u,h)}static adagrad(t,n=.1){return new Vl(t,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zg={sgd:Bg.sgd,momentum:Bg.momentum,adadelta:Bg.adadelta,adagrad:Bg.adagrad,rmsprop:Bg.rmsprop,adamax:Bg.adamax,adam:Bg.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RC=(()=>typeof requestAnimationFrame!="undefined"?requestAnimationFrame:typeof setImmediate!="undefined"?setImmediate:r=>r())();function x0(){return new Promise(r=>RC(()=>r()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ay(r,t){const n=r[0].length;r.forEach((u,h)=>{yt(u.length===n,()=>`Error in concat${n}D: rank of tensors[${h}] must be the same as the rank of the rest (${n})`)}),yt(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const o=r[0];r.forEach((u,h)=>{for(let p=0;p<n;p++)yt(p===t||u[p]===o[p],()=>`Error in concat${n}D: Shape of tensors[${h}] (${u}) does not match the shape of the rest (${o}) along the non-concatenated axis ${h}.`)})}function jv(r,t){const n=r[0].slice();for(let o=1;o<r.length;o++)n[t]+=r[o][t];return n}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w0=30;function Ap(r){return r<=w0?r:Zr(r,Math.floor(Math.sqrt(r)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function np(r,t,n){const o=n*(typeof r=="number"?r:r[0]),u=t*(typeof r=="number"?r:r[1]);return[o,u]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E0(r,t,n,o=!0){let u=[];if(o)u=u.concat(t.slice(0)),u.push(r[0]/n),u=u.concat(r.slice(1));else{u=u.concat(r[0]);const h=t.length;for(let p=0;p<h;++p)u=u.concat([r[p+1]/t[p],t[p]]);u=u.concat(r.slice(h+1))}return u}function Im(r,t,n=!0){const o=[];if(n){o.push(t);for(let u=t+1;u<r;++u)u<=2*t?(o.push(u),o.push(u-(t+1))):o.push(u)}else{const u=[],h=[];for(let p=1;p<r;++p)p>=t*2+1||p%2==1?h.push(p):u.push(p);o.push(...u),o.push(0),o.push(...h)}return o}function Hv(r,t,n,o=!0){const u=[];o?u.push(r[0]/n):u.push(r[0]*n);for(let h=1;h<r.length;++h)h<=t.length?o?u.push(t[h-1]*r[h]):u.push(r[h]/t[h-1]):u.push(r[h]);return u}function yb(r,t){const n=[0];for(let o=0;o<t;++o)n.push(r[o][0]);return n}function bb(r,t,n){const o=r.slice(0,1);for(let u=0;u<n;++u)o.push(r[u+1]-t[u][0]-t[u][1]);return o}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const My=1.7580993408473768,Ny=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xb=.3275911,ky=.254829592,wb=-.284496736,rp=1.421413741,Eb=-1.453152027,S0=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tm(...r){Ve().getBool("IS_TEST")||console.warn(...r)}function C0(...r){Ve().getBool("IS_TEST")||console.log(...r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cv(r,t){if(r.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${r.length}, imag: ${t.length}.`);const n=new Float32Array(r.length*2);for(let o=0;o<n.length;o+=2)n[o]=r[o/2],n[o+1]=t[o/2];return n}function Xv(r){const t=new Float32Array(r.length/2),n=new Float32Array(r.length/2);for(let o=0;o<r.length;o+=2)t[o/2]=r[o],n[o/2]=r[o+1];return{real:t,imag:n}}function Yv(r){const t=Math.ceil(r.length/4),n=new Float32Array(t),o=new Float32Array(t);for(let u=0;u<r.length;u+=4)n[Math.floor(u/4)]=r[u],o[Math.floor(u/4)]=r[u+1];return{real:n,imag:o}}function Lw(r){const t=Math.floor(r.length/4),n=new Float32Array(t),o=new Float32Array(t);for(let u=2;u<r.length;u+=4)n[Math.floor(u/4)]=r[u],o[Math.floor(u/4)]=r[u+1];return{real:n,imag:o}}function Sb(r,t){const n=r[t*2],o=r[t*2+1];return{real:n,imag:o}}function Am(r,t,n,o){r[o*2]=t,r[o*2+1]=n}function Cb(r,t){const n=new Float32Array(r/2),o=new Float32Array(r/2);for(let u=0;u<Math.ceil(r/2);u++){const h=(t?2:-2)*Math.PI*(u/r);n[u]=Math.cos(h),o[u]=Math.sin(h)}return{real:n,imag:o}}function _b(r,t,n){const o=(n?2:-2)*Math.PI*(r/t),u=Math.cos(o),h=Math.sin(o);return{real:u,imag:h}}function Dy(r,t,n=0){let o=[];if(typeof t=="number")yt(r.shape[n]%t==0,()=>"Number of splits must evenly divide the axis."),o=new Array(t).fill(r.shape[n]/t);else{const u=t.reduce((p,g)=>(g===-1&&(p+=1),p),0);yt(u<=1,()=>"There should be only one negative value in split array.");const h=t.indexOf(-1);if(h!==-1){const p=t.reduce((g,x)=>x>0?g+x:g);t[h]=r.shape[n]-p}yt(r.shape[n]===t.reduce((p,g)=>p+g),()=>"The sum of sizes must match the size of the axis dimension."),o=t}return o}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kv(r,t){let n=!1,o;for(r<=w0?(o=r,n=!0):o=Zr(r,Math.floor(Math.sqrt(r)));!n;)o>t||o===r?n=!0:o=Zr(r,o+1);return o}function Ib(r,t,n){const o=[],u=r.length;for(let h=0;h<u;h++)h!==t?o.push(r[h]):o.push(n);return o}function Oy(r,t,n,o){const u=t.shape.length,h=r.shape.length;if(o!==0&&(o<-u||o>u))throw new Error(`Expect batchDims in the range of [-${u}, ${u}], but got ${o}`);if(o<0&&(o+=u),o>h)throw new Error(`batchDims (${o}) must be less than rank(x) (
    ${h}).`);if(n<o)throw new Error(`batchDims (${o}) must be less than or equal to axis (${n}).`);for(let V=0;V<o;++V)if(r.shape[V]!==t.shape[V])throw new Error(`x.shape[${V}]: ${r.shape[V]} should be equal to indices.shape[${V}]: ${t.shape[V]}.`);const p=r.shape[n],g=[];let x=1,I=1,z=1;for(let V=0;V<o;++V)g.push(r.shape[V]),x*=r.shape[V];for(let V=o;V<n;V++)g.push(r.shape[V]),I*=r.shape[V];for(let V=o;V<u;V++)g.push(t.shape[V]);for(let V=n+1;V<h;V++)g.push(r.shape[V]),z*=r.shape[V];return{batchSize:x,sliceSize:z,outerSize:I,dimSize:p,outputShape:g}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LC(r,t,n){if(t==="complex64"){if(r.dtype==="complex64")return r.clone();const o=Tc(r.shape),u=eo(r,"float32"),h=n.complex(u,o);return o.dispose(),u.dispose(),h}if(!jr(r.dtype,t))return dr.makeTensorFromDataId(r.dataId,r.shape,t);if(r.dtype==="complex64"){const o=n.real(r),u=eo(o,t);return o.dispose(),u}if(t==="int32")return n.int(r);if(t==="bool"){const o=zi(0,r.dtype),u=n.notEqual(r,o);return o.dispose(),u}else throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${t}`)}function PC(r,t){return dr.makeTensorFromDataId(r.dataId,t,r.dtype)}function _0(r){try{return r.map(t=>Ot(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function I0(r){return r.map(t=>oc(t))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tb={kernelName:La,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(r,Em(eo(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pw={kernelName:ha,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const o=Ai(eo(n,"float32")),u=Ti(pi(zi(1),o));return Ic(rr(r,u))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ad={kernelName:_i,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const o=Ti(pi(Ai(eo(n,"float32")),1));return rr(r,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FC={kernelName:Ni,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{let g=r;const x=Jr(n.shape,u);return x.length>0&&(g=ss(g,x)),b(g,n.shape)},b:()=>{let g=r;const x=Jr(o.shape,u);return x.length>0&&(g=ss(g,x)),b(g,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fw={kernelName:vi,saveAllInputs:!0,gradFunc:(r,t)=>{const n={};return t.forEach((o,u)=>{n[u]=()=>r.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bw={kernelName:Pa,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>bi(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zw={kernelName:un,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>bi(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $w={kernelName:Oe,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>rr(r,Ti(pi(zi(1),Ai(eo(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gw={kernelName:hn,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const o=Ti(An(zi(1),Ai(eo(n,"float32"))));return rr(r,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BC={kernelName:Jn,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{const g=An(Ai(n),Ai(o));let x=Xn(r,rr(o,g));const I=Jr(n.shape,u);return I.length>0&&(x=ss(x,I)),b(x,n.shape)},b:()=>{const g=An(Ai(n),Ai(o));let x=Ic(Xn(r,rr(n,g)));const I=Jr(o.shape,u);return I.length>0&&(x=ss(x,I)),b(x,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ry={kernelName:Hn,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>rr(r,An(Ai(eo(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uw={kernelName:Bn,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>rr(r,pi(zi(1),Ai(eo(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ww(r,t,n,o,u=[1,1,1],h,p){const g=pn(r,"dy","avgPool3dGrad"),x=pn(t,"input","avgPool3dGrad");let I=g,z=x,V=!1;x.rank===4&&(V=!0,I=b(g,[1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]]),z=b(x,[1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]])),yt(I.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${I.rank}.`),yt(z.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${z.rank}.`),yt(_c(o,u),()=>`Error in avgPool3dGrad: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`),p!=null&&yt(xr(h),()=>`Error in avgPool3dGrad: pad must be an integer when using, dimRoundingMode ${p} but got pad ${h}.`);const rt={dy:I,input:z},Et={filterSize:n,strides:o,dilations:u,pad:h,dimRoundingMode:p},St=dr.runKernel(ui,rt,Et);return V?b(St,[St.shape[1],St.shape[2],St.shape[3],St.shape[4]]):St}const Vw=br({avgPool3dGrad_:Ww});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zC={kernelName:Fa,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{filterSize:u,strides:h,dilations:p,pad:g,dimRoundingMode:x}=n,I=p==null?[1,1,1]:p;return{x:()=>Vw(r,o,u,h,I,g,x)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jw(r,t,n,o,u){const h=pn(r,"dy","avgPoolGrad"),p=pn(t,"input","avgPoolGrad");yt(p.rank===h.rank,()=>`Rank of input (${p.rank}) does not match rank of dy (${h.rank})`);let g=p,x=h,I=!1;p.rank===3&&(I=!0,g=b(p,[1,p.shape[0],p.shape[1],p.shape[2]]),x=b(h,[1,h.shape[0],h.shape[1],h.shape[2]])),yt(x.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${x.rank}.`),yt(g.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${g.rank}.`);const z={dy:x,input:g},V={filterSize:n,strides:o,pad:u},rt=dr.runKernel(ya,z,V);return I?b(rt,[rt.shape[1],rt.shape[2],rt.shape[3]]):rt}const $C=br({avgPoolGrad_:jw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hw={kernelName:Lr,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{filterSize:u,strides:h,pad:p}=n;return{x:()=>$C(r,o,u,h,p)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xw={kernelName:Ei,inputsToSave:["a","b"],gradFunc:(r,t,n)=>{const[o,u]=t,{transposeA:h,transposeB:p}=n;return!h&&!p?{a:()=>Zs(r,u,!1,!0),b:()=>Zs(o,r,!0,!1)}:!h&&p?{a:()=>Zs(r,u,!1,!1),b:()=>Zs(r,o,!0,!1)}:h&&!p?{a:()=>Zs(u,r,!1,!0),b:()=>Zs(o,r,!1,!1)}:{a:()=>Zs(u,r,!0,!0),b:()=>Zs(r,o,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ly={kernelName:oo,gradFunc:(r,t,n)=>{const{blockShape:o,crops:u}=n;return{x:()=>n0(r,o,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mp={kernelName:bo,gradFunc:(r,t,n)=>{const o=n,u=o.inputShape,h=o.shape,p=Array.from(h);for(let x=u.length-1;x>=0;x--)if(u[x]===h[x])p[x]=1;else if(u[x]!==1)throw new Error(`broadcastTo(): [${u}] cannot be broadcast to [${h}].`);const g=[];for(let x=0;x<p.length;x++)p[x]>1&&g.push(x);return{x:()=>ss(r,g,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $g={kernelName:ts,gradFunc:r=>({x:()=>r.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gg={kernelName:Wo,gradFunc:r=>({x:()=>bi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zv={kernelName:Yi,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{clipValueMin:u,clipValueMax:h}=n;return{x:()=>Lf(Rh(Jd(o,u),og(o,h)),r,bi(r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T0={kernelName:gi,inputsToSave:["x"],gradFunc:Tb.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yw={kernelName:us,saveAllInputs:!0,gradFunc:(r,t,n)=>{const o=t.map(x=>x.shape),{axis:u}=n,h=Rr(u,t[0].shape)[0],p=o.map(x=>x[h]);return ed(r,p,h).map(x=>()=>x)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A0={kernelName:Do,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const[o,u]=t,{dilations:h,strides:p,pad:g,dataFormat:x}=n;return yt(iv(h),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${h}'`),{x:()=>Xs(o.shape,r,u,p,g,x),filter:()=>wy(o,r,u.shape,p,g,x)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GC={kernelName:zs,inputsToSave:["dy","filter"],gradFunc:(r,t,n)=>{const[o,u]=t,{strides:h,pad:p,dataFormat:g,dimRoundingMode:x}=n;return{dy:()=>qs(r,u,h,p,g,1,x),filter:()=>wy(r,o,u.shape,h,p,g,x)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UC(r,t,n,o,u){let h=r;r.rank===4&&(h=b(r,[1,r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));let p=t;p.rank===4&&(p=b(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),yt(h.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${h.shape}.`),yt(p.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${p.shape}.`),yt(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),yt(h.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${h.shape[4]}) must match input depth in filter (${n[3]}.`),yt(p.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${p.shape[4]}) must match output depth for filter (${n[4]}).`);const g={x:h,dy:p},x={strides:o,pad:u,filterShape:n};return dr.runKernel(ds,g,x)}const WC=br({conv3DBackpropFilter_:UC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VC={kernelName:mu,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const{dilations:o,strides:u,pad:h}=n;yt(iv(o),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const[p,g]=t;return{x:()=>Us(p.shape,r,g,u,h),filter:()=>WC(p,r,g.shape,u,h)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Py={kernelName:yu,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(Ic(hy(eo(n,"float32"))),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jC={kernelName:uu,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(dy(eo(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M0={kernelName:Cs,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{axis:u,exclusive:h,reverse:p}=n;return{x:()=>{const g=$c([u],o.rank);let x=Mg(r,u,h,!p);return g!=null&&(x=cu(x,g)),x}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pg={kernelName:is,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const{dilations:o,strides:u,pad:h,dimRoundingMode:p}=n,g=o==null?[1,1]:o;yt(iv(g),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${g}'`);const[x,I]=t;return yt(x.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${x.rank}.`),yt(I.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${I.rank}.`),yt(x.shape[3]===I.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${x.shape[3]}) must match the inChannels dimension in filter ${I.shape[2]}.`),yt(_c(u,g),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${u} and dilations '${g}'.`),p!=null&&yt(xr(h),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${p} but got pad ${h}.`),{x:()=>xw(x.shape,r,I,u,h,o,p),filter:()=>bw(x,r,I.shape,u,h,o,p)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ap={kernelName:Ys,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const[o,u]=t,h={x:o,filter:u,dy:r},p={x:o,filter:u,dy:r};return{x:()=>dr.runKernel(ka,h,n),filter:()=>dr.runKernel(Ku,p,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kw={kernelName:Ro,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t,o={dy:r,y:n};return{x:()=>dr.runKernel(Ns,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zw={kernelName:tu,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t,o=Xn(Kf(Ic(Ai(n))),2/Math.sqrt(Math.PI));return{x:()=>Xn(r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RA={kernelName:Zu,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HC={kernelName:bn,inputsToSave:["input"],gradFunc:(r,t)=>{const[n]=t;return{input:()=>b(r,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XC={kernelName:Xr,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(r,Kf(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YC={kernelName:Co,gradFunc:r=>({x:()=>bi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KC={kernelName:to,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{const g=rr(r,eo(o,"float32")),x=Jr(n.shape,u);return x.length>0?b(ss(g,x),n.shape):g},b:()=>{let g=Xn(r,eo(n,"float32"));const x=Jr(o.shape,u);x.length>0&&(g=b(ss(g,x),o.shape));const I=Ai(o);return Ic(rr(g,eo(I,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZC={kernelName:xo,inputsToSave:["x","mean","variance","scale"],gradFunc:(r,t,n)=>{const{varianceEpsilon:o}=n,[u,h,p,g]=t,x=g==null?zi(1):g,I=Jr(h.shape,u.shape),z=[];if(h.rank===1){for(let $e=0;$e<u.shape.length-1;++$e)z.push(u.shape[$e]);z.push(1)}const V=pi(u,h),rt=Xn(r,x),Et=cy(An(p,zi(o))),St=Xn(Xn(Xn(Et,Et),Et),zi(-.5));return{x:()=>h.rank===1?b(Xn(Xn(r,Pv(b(Et,[1,1,1,h.shape[0]]),z)),x),u.shape):b(Xn(Xn(r,Et),x),u.shape),mean:()=>{let $e=Xn(Xn(Et,zi(-1)),rt);return h.rank===1&&($e=ss($e,I)),b($e,h.shape)},variance:()=>{let $e=Xn(Xn(St,V),rt);return h.rank===1&&($e=ss($e,I)),b($e,h.shape)},scale:()=>{const $e=Xn(V,Et);let Xe=Xn(r,$e);return h.rank===1&&(Xe=ss(Xe,I)),b(Xe,h.shape)},offset:()=>{let $e=r;return h.rank===1&&($e=ss($e,I)),b($e,h.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qC={kernelName:gs,inputsToSave:["x","indices"],gradFunc:(r,t,n)=>{const[o,u]=t,{axis:h}=n,p=Rr(h,o.shape)[0];return{x:()=>{const x=o.shape,I=u.size,z=x.slice(0,p),V=z.length,rt=x.slice(h,x.length).slice(1),Et=rt.length,St=qw(0,V),Tt=qw(V+1,V+1+Et),Vt=Ab([z,[I],rt]),ue=b(r,Vt),ye=b(u,[I]),qe=Ab([[V],St,Tt]),$e=cu(ue,qe);let Xe=eb($e,ye,o.shape[p]);const Pn=mm(qe);return Xe=cu(Xe,Pn),Xe},indices:()=>u}}};function qw(r,t){const n=[];for(let o=r;o<t;++o)n.push(o);return n}function Ab(r){const t=[];for(let n=0;n<r.length;++n)for(let o=0;o<r[n].length;++o)t.push(r[n][o]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QC={kernelName:ms,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t;return{a:()=>bi(n),b:()=>bi(o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JC={kernelName:xu,gradFunc:r=>({x:()=>eo(r,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qw={kernelName:Ks,gradFunc:r=>({x:()=>bi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t_={kernelName:el,gradFunc:r=>({x:()=>bi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fv={kernelName:lu,gradFunc:r=>({x:()=>bi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e_={kernelName:Du,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{alpha:u}=n,h=Ed(o,0);return{x:()=>Lf(h,r,Xn(r,u))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n_={kernelName:Au,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>rr(r,An(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jw={kernelName:Bu,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>rr(r,eo(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r_={kernelName:xc,inputsToSave:[],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[o]=t,{axis:u}=n;return{logits:()=>{const h=!0,p=Kf(o);return pi(r,Xn(ss(r,u,h),p))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mb(r,t,n,o=5,u=1,h=1,p=.5){const g={x:r,y:t,dy:n},x={depthRadius:o,bias:u,alpha:h,beta:p};return dr.runKernel(ol,g,x)}const tE=br({localResponseNormalizationBackprop_:Mb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eE={kernelName:Sl,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[o,u]=t,{depthRadius:h,bias:p,alpha:g,beta:x}=n;return{x:()=>tE(o,u,r,h,p,g,x)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nb(r,t,n,o){return t.rank<n.rank&&(t=b(t,zc(t.shape,o))),r.rank<n.rank&&(r=b(r,zc(r.shape,o))),{x:()=>Xn(r,eo(Hu(n,t),r.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nE={kernelName:ys,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const o=n,{reductionIndices:u}=o,h=t[0],p=t[1],g=Rr(u,h.shape),x=Nb(r,p,h,g);return{x:()=>x.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a_={kernelName:vl,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t;return{a:()=>Xn(r,eo(Jd(n,o),"float32")),b:()=>Xn(r,eo(Zm(n,o),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fy(r,t,n,o,u,h=[1,1,1],p,g){const x=pn(r,"dy","maxPool3dGrad"),I=pn(t,"input","maxPool3dGrad"),z=pn(n,"output","maxPool3dGrad");let V=x,rt=I,Et=z,St=!1;I.rank===4&&(St=!0,V=b(x,[1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]]),rt=b(I,[1,I.shape[0],I.shape[1],I.shape[2],I.shape[3]]),Et=b(z,[1,z.shape[0],z.shape[1],z.shape[2],z.shape[3]])),yt(V.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${V.rank}.`),yt(rt.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${rt.rank}.`),yt(Et.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${Et.rank}.`),yt(_c(u,h),()=>`Error in maxPool3dGrad: Either strides or dilations must be 1. Got strides ${u} and dilations '${h}'`),g!=null&&yt(xr(p),()=>`Error in maxPool3dGrad: pad must be an integer when using, dimRoundingMode ${g} but got pad ${p}.`);const Tt={dy:V,input:rt,output:Et},Vt={filterSize:o,strides:u,dilations:h,pad:p,dimRoundingMode:g},ue=dr.runKernel(_e,Tt,Vt);return St?b(ue,[ue.shape[1],ue.shape[2],ue.shape[3],ue.shape[4]]):ue}const rE=br({maxPool3dGrad_:Fy});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kb={kernelName:Ol,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[o,u]=t,{filterSize:h,strides:p,dilations:g,pad:x,dimRoundingMode:I}=n,z=g==null?[1,1,1]:g;return{x:()=>rE(r,o,u,h,p,z,x,I)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Db(r,t,n,o,u,h,p){const g=pn(r,"dy","maxPoolGrad"),x=pn(t,"input","maxPoolGrad"),I=pn(n,"output","maxPoolGrad");yt(x.rank===g.rank,()=>`Rank of input (${x.rank}) does not match rank of dy (${g.rank})`),yt(g.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${g.rank}.`),yt(x.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${x.rank}.`),p!=null&&yt(xr(h),()=>`Error in maxPoolGrad: pad must be an integer when using, dimRoundingMode ${p} but got pad ${h}.`);const z={dy:g,input:x,output:I},V={filterSize:o,strides:u,pad:h,dimRoundingMode:p};return dr.runKernel(Dl,z,V)}const i_=br({maxPoolGrad_:Db});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ug={kernelName:kc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[o,u]=t,{filterSize:h,strides:p,pad:g}=n;return{x:()=>i_(r,o,u,h,p,g)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o_={kernelName:Bt,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{axis:u}=n,h=Rr(u,o.shape),g=yf(o.shape,h)[1],x=Rt(g);return{x:()=>{const z=o.shape.slice();h.forEach(Et=>{z[Et]=1});const V=b(r,z);return rr(Xn(V,sv(o.shape,"float32")),x)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LA={kernelName:ae,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const o=n,{axis:u}=o,[h,p]=t,g=Rr(u,h.shape),x=Nb(r,p,h,g);return{x:()=>x.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aE={kernelName:me,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t;return{a:()=>Xn(r,eo(og(n,o),"float32")),b:()=>Xn(r,eo(Ed(n,o),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s_={kernelName:En,inputsToSave:["x"],gradFunc:(r,t,n)=>{const o=t[0],{paddings:u}=n,h=u.map(p=>p[0]);return{x:()=>Ut(r,h,o.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u_={kernelName:Zn,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{const g=Jr(n.shape,u);return g.length>0?b(ss(r,g),n.shape):r},b:()=>{const g=Xn(r,Ic(pm(rr(n,o)))),x=Jr(o.shape,u);return x.length>0?b(ss(g,x),o.shape):g}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l_={kernelName:ge,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{const g=Xn(r,eo(o,"float32")),x=Jr(n.shape,u);return x.length>0?b(ss(g,x),n.shape):g},b:()=>{const g=Xn(r,eo(n,"float32")),x=Jr(o.shape,u);return x.length>0?b(ss(g,x),o.shape):g}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c_={kernelName:Ae,gradFunc:r=>({x:()=>Ic(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f_={kernelName:Va,inputsToSave:["indices"],gradFunc:(r,t)=>{const n=t[0];return{indices:()=>Tc(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h_={kernelName:Aa,gradFunc:r=>({x:()=>bi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d_={kernelName:Ba,saveAllInputs:!0,gradFunc:(r,t,n)=>{const{axis:o}=n;return Cd(r,o).map(h=>()=>h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iE={kernelName:oi,inputsToSave:["x"],gradFunc:(r,t,n)=>{const o=t[0],{paddings:u}=n,h=u.map(p=>p[0]);return{x:()=>Ut(r,h,o.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p_={kernelName:Di,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(r,t)=>{const[n,o,u]=t,h=n,p=o,g=Nr(h.shape,p.shape);return{a:()=>{const z=eo(p,"float32");let V=Xn(r,Xn(z,co(h,pi(z,zi(1)))));const rt=Jr(h.shape,g);return rt.length>0&&(V=ss(V,rt)),b(V,h.shape)},b:()=>{const z=Ed(h,0),V=Lf(z,Oh(h),bi(h));let rt=Xn(r,Xn(u,V));const Et=Jr(p.shape,g);return Et.length>0&&(rt=ss(rt,Et)),b(rt,p.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v_={kernelName:Si,inputsToSave:["x","alpha"],gradFunc:(r,t)=>{const[n,o]=t,u=Ed(n,0);return{x:()=>Lf(u,r,Xn(r,o)),alpha:()=>{let h=Lf(u,bi(r),Xn(r,n));const p=Jr(o.shape,r.shape);return p.length>0&&(h=ss(h,p)),b(h,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g_={kernelName:Vs,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{const g=rr(r,eo(o,"float32")),x=Jr(n.shape,u);return x.length>0?b(ss(g,x),n.shape):g},b:()=>{let g=Xn(r,eo(n,"float32"));const x=Jr(o.shape,u);x.length>0&&(g=b(ss(g,x),o.shape));const I=Ai(o);return Ic(rr(g,eo(I,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m_={kernelName:Vo,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>rr(r,Ic(Ai(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oE={kernelName:Cl,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t,o=Xn(og(n,6),Em(n));return{x:()=>Xn(r,eo(o,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y_={kernelName:js,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(r,eo(Em(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b_={kernelName:ws,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>b(r,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x_={kernelName:Mu,inputsToSave:["images"],gradFunc:(r,t,n)=>{const[o]=t,u={dy:r,images:o};return{images:()=>dr.runKernel(nl,u,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w_={kernelName:ks,inputsToSave:["images"],gradFunc:(r,t,n)=>{const[o]=t,u={dy:r,images:o};return{images:()=>dr.runKernel(Hs,u,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E_={kernelName:Yl,gradFunc:(r,t,n)=>{const{dims:o}=n,u=Rr(o,r.shape);return{x:()=>Ph(r,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S_={kernelName:sl,gradFunc:r=>({x:()=>bi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const By={kernelName:rl,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Ic(rr(r,Xn(co(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C_={kernelName:Dc,inputsToSave:["condition"],gradFunc:(r,t)=>{const[n]=t;return{condition:()=>eo(bi(n),"float32"),t:()=>Xn(r,eo(n,r.dtype)),e:()=>Xn(r,eo(kg(n),r.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ob={kernelName:wc,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const o=Ed(n,zi(0)),u=zi(My),h=zi(Ny),p=Xn(r,h),g=Xn(Xn(r,u),Kf(eo(n,"float32")));return Lf(o,p,g)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const __={kernelName:de,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(r,Xn(n,pi(zi(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I_={kernelName:Zt,gradFunc:r=>({x:()=>bi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T_={kernelName:A,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(lc(eo(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A_={kernelName:nt,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(Jh(eo(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M_={kernelName:ef,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{begin:u,size:h}=n,p=o.shape,[g,x]=Zd(o,u,h),I=[];for(let z=0;z<r.rank;z++)I.push([g[z],p[z]-g[z]-x[z]]);return{x:()=>$v(r,I)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N_={kernelName:De,outputsToSave:[!0],gradFunc:(r,t,n)=>{const[o]=t,{dim:u}=n,h=!0,p=Xn(r,o);return{logits:()=>pi(p,Xn(ss(p,[u],h),o))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k_={kernelName:Pe,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(r,qt(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sE={kernelName:wn,gradFunc:(r,t,n)=>{const{blockShape:o,paddings:u}=n;return{x:()=>Rn(r,o,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rb={kernelName:kn,gradFunc:(r,t,n)=>{const{axis:o}=n;return{x:()=>_t(r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D_={kernelName:Qe,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>rr(r,Xn(Ti(eo(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O_={kernelName:ca,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(r,Xn(eo(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R_={kernelName:wr,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=zi(2);return{a:()=>Xn(r,Xn(u,pi(n,o))),b:()=>Xn(r,Xn(u,pi(o,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L_={kernelName:zu,gradFunc:r=>({x:()=>bi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P_={kernelName:Ar,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{let g=r;const x=Jr(n.shape,u);return x.length>0&&(g=ss(g,x)),b(g,n.shape)},b:()=>{let g=r;const x=Jr(o.shape,u);return x.length>0&&(g=ss(g,x)),b(Ic(g),o.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F_={kernelName:rn,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,u=o.shape.slice(),{axis:h}=n;Rr(h,o.shape).forEach(I=>{u[I]=1});const g=b(r,u),x=Xn(g,sv(o.shape,"float32"));return{x:()=>x}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B_={kernelName:ri,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>rr(r,Ai(lc(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N0={kernelName:ba,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Xn(pi(zi(1),Ai(n)),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z_={kernelName:ki,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{reps:u}=n;return{x:()=>{let p=bi(o);if(o.rank===1)for(let g=0;g<u[0];++g)p=An(p,Ut(r,[g*o.shape[0]],[o.shape[0]]));else if(o.rank===2)for(let g=0;g<u[0];++g)for(let x=0;x<u[1];++x)p=An(p,Ut(r,[g*o.shape[0],x*o.shape[1]],[o.shape[0],o.shape[1]]));else if(o.rank===3)for(let g=0;g<u[0];++g)for(let x=0;x<u[1];++x)for(let I=0;I<u[2];++I)p=An(p,Ut(r,[g*o.shape[0],x*o.shape[1],I*o.shape[2]],[o.shape[0],o.shape[1],o.shape[2]]));else if(o.rank===4)for(let g=0;g<u[0];++g)for(let x=0;x<u[1];++x)for(let I=0;I<u[2];++I)for(let z=0;z<u[3];++z)p=An(p,Ut(r,[g*o.shape[0],x*o.shape[1],I*o.shape[2],z*o.shape[3]],[o.shape[0],o.shape[1],o.shape[2],o.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${o.rank} tensors yet.`);return p}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $_={kernelName:Lo,gradFunc:(r,t,n)=>{const o=n,{perm:u}=o,h=mm(u);return{x:()=>cu(r,h)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G_={kernelName:go,gradFunc:(r,t,n)=>{const o=n,{axis:u}=o;return{value:()=>nd(r,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U_={kernelName:Ao,inputsToSave:["segmentIds"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Mm(r,n)}}};function Mm(r,t){const n=Po(t,bi(t)),o=Fv(r,n);let u=Jd(t,zi(0,"int32"));const h=o.rank-u.rank;for(let g=0;g<h;++g)u=wd(u,g+1);u=Rh(u,sv(o.shape,"bool"));const p=bi(o);return Lf(u,o,p)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W_={kernelName:qu,gradFunc:r=>({x:()=>bi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V_=[Tb,Pw,ad,FC,Fw,Bw,zw,$w,Gw,BC,Ry,Uw,zC,Hw,Xw,Ly,Mp,$g,Gg,Zv,T0,Yw,GC,A0,VC,Py,jC,M0,pg,ap,g_,Kw,Zw,RA,HC,XC,KC,YC,ZC,qC,QC,JC,Qw,t_,fv,e_,n_,Jw,r_,eE,nE,nE,a_,kb,Ug,o_,LA,aE,s_,u_,l_,c_,f_,h_,d_,iE,iE,p_,v_,m_,oE,y_,b_,x_,w_,E_,S_,By,C_,Ob,__,I_,T_,A_,M_,N_,k_,sE,sE,Rb,Rb,D_,R_,O_,L_,P_,F_,B_,N0,z_,$_,G_,U_,W_];for(const r of V_)Wh(r);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.abs=function(){return this.throwIfDisposed(),bl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.acos=function(){return this.throwIfDisposed(),mr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.acosh=function(){return this.throwIfDisposed(),Mr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.addStrict=function(r){return this.throwIfDisposed(),hg(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.add=function(r){return this.throwIfDisposed(),An(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.all=function(r,t){return this.throwIfDisposed(),Dr(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.any=function(r,t){return this.throwIfDisposed(),_a(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.argMax=function(r){return this.throwIfDisposed(),ga(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.argMin=function(r){return this.throwIfDisposed(),uo(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.asScalar=function(){return this.throwIfDisposed(),yt(this.size===1,()=>"The array must have only 1 element."),b(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.asType=function(r){return this.throwIfDisposed(),eo(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.as1D=function(){return this.throwIfDisposed(),b(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.as2D=function(r,t){return this.throwIfDisposed(),b(this,[r,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.as3D=function(r,t,n){return this.throwIfDisposed(),b(this,[r,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.as4D=function(r,t,n,o){return this.throwIfDisposed(),b(this,[r,t,n,o])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.as5D=function(r,t,n,o,u){return this.throwIfDisposed(),b(this,[r,t,n,o,u])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.asin=function(){return this.throwIfDisposed(),Hi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.asinh=function(){return this.throwIfDisposed(),No(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.atan=function(){return this.throwIfDisposed(),xl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.atan2=function(r){return this.throwIfDisposed(),Rv(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.atanh=function(){return this.throwIfDisposed(),Tg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.avgPool=function(r,t,n,o){return this.throwIfDisposed(),D(this,r,t,n,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.batchToSpaceND=function(r,t){return this.throwIfDisposed(),Rn(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.batchNorm=function(r,t,n,o,u){return this.throwIfDisposed(),Sr(this,r,t,n,o,u)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.broadcastTo=function(r){return this.throwIfDisposed(),Ja(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.cast=function(r){return this.throwIfDisposed(),eo(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.ceil=function(){return this.throwIfDisposed(),Zi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.clipByValue=function(r,t){return this.throwIfDisposed(),li(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.concat=function(r,t){return this.throwIfDisposed(),r instanceof Dn&&(r=[r]),_t([this,...r],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.conv1d=function(r,t,n,o,u,h){return this.throwIfDisposed(),Ho(this,r,t,n,o,u,h)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.conv2dTranspose=function(r,t,n,o,u){return this.throwIfDisposed(),_u(this,r,t,n,o,u)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.conv2d=function(r,t,n,o,u,h){return this.throwIfDisposed(),qs(this,r,t,n,o,u,h)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.cos=function(){return this.throwIfDisposed(),lc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.cosh=function(){return this.throwIfDisposed(),Jh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.cumsum=function(r,t,n){return this.throwIfDisposed(),Mg(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.depthToSpace=function(r,t){return this.throwIfDisposed(),ig(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.depthwiseConv2D=function(r,t,n,o,u,h){return na("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),Qd(this,r,t,n,o,u,h)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.depthwiseConv2d=function(r,t,n,o,u,h){return this.throwIfDisposed(),Qd(this,r,t,n,o,u,h)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.dilation2d=function(r,t,n,o,u){return this.throwIfDisposed(),cm(this,r,t,n,o,u)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.divNoNan=function(r){return this.throwIfDisposed(),Xm(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.divStrict=function(r){return this.throwIfDisposed(),p0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.div=function(r){return this.throwIfDisposed(),rr(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.dot=function(r){return this.throwIfDisposed(),Dx(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.elu=function(){return this.throwIfDisposed(),fm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.equalStrict=function(r){return this.throwIfDisposed(),O2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.equal=function(r){return this.throwIfDisposed(),Hu(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.erf=function(){return this.throwIfDisposed(),k1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.exp=function(){return this.throwIfDisposed(),Kf(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.expandDims=function(r){return this.throwIfDisposed(),wd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.expm1=function(){return this.throwIfDisposed(),Km(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.fft=function(){return this.throwIfDisposed(),l0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.flatten=function(){return this.throwIfDisposed(),b(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.floor=function(){return this.throwIfDisposed(),pm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.floorDiv=function(r){return this.throwIfDisposed(),Or(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.gather=function(r,t){return this.throwIfDisposed(),Fv(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.greaterEqualStrict=function(r){return this.throwIfDisposed(),R2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.greaterEqual=function(r){return this.throwIfDisposed(),Jd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.greaterStrict=function(r){return this.throwIfDisposed(),L2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.greater=function(r){return this.throwIfDisposed(),Ed(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.ifft=function(){return this.throwIfDisposed(),Og(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.irfft=function(){return this.throwIfDisposed(),vy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.isFinite=function(){return this.throwIfDisposed(),Fx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.isInf=function(){return this.throwIfDisposed(),R1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.isNaN=function(){return this.throwIfDisposed(),Bv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.leakyRelu=function(r){return this.throwIfDisposed(),vm(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.lessEqualStrict=function(r){return this.throwIfDisposed(),P2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.lessEqual=function(r){return this.throwIfDisposed(),og(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.lessStrict=function(r){return this.throwIfDisposed(),F2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.less=function(r){return this.throwIfDisposed(),Zm(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.localResponseNormalization=function(r,t,n,o){return this.throwIfDisposed(),J0(this,r,t,n,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.logSigmoid=function(){return this.throwIfDisposed(),sg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.logSoftmax=function(r){return this.throwIfDisposed(),ty(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.logSumExp=function(r,t){return this.throwIfDisposed(),ny(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.log=function(){return this.throwIfDisposed(),Oh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.log1p=function(){return this.throwIfDisposed(),qm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.logicalAnd=function(r){return this.throwIfDisposed(),Rh(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.logicalNot=function(){return this.throwIfDisposed(),kg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.logicalOr=function(r){return this.throwIfDisposed(),Jm(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.logicalXor=function(r){return this.throwIfDisposed(),ug(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.matMul=function(r,t,n){return this.throwIfDisposed(),Zs(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.maxPool=function(r,t,n,o){return this.throwIfDisposed(),Dg(this,r,t,n,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.max=function(r,t){return this.throwIfDisposed(),Sd(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.maximumStrict=function(r){return this.throwIfDisposed(),sw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.maximum=function(r){return this.throwIfDisposed(),Po(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.mean=function(r,t){return this.throwIfDisposed(),cc(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.min=function(r,t){return this.throwIfDisposed(),ym(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.minimumStrict=function(r){return this.throwIfDisposed(),uw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.minimum=function(r){return this.throwIfDisposed(),cg(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.mirrorPad=function(r,t){return this.throwIfDisposed(),U1(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.modStrict=function(r){return this.throwIfDisposed(),lw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.mod=function(r){return this.throwIfDisposed(),iy(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.mulStrict=function(r){return this.throwIfDisposed(),cw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.mul=function(r){return this.throwIfDisposed(),Xn(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.neg=function(){return this.throwIfDisposed(),Ic(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.norm=function(r,t,n){return this.throwIfDisposed(),xy(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.notEqualStrict=function(r){return this.throwIfDisposed(),B2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.notEqual=function(r){return this.throwIfDisposed(),fg(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.oneHot=function(r,t=1,n=0){return this.throwIfDisposed(),Df(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.onesLike=function(){return this.throwIfDisposed(),Zc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.pad=function(r,t){return this.throwIfDisposed(),$v(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.pool=function(r,t,n,o,u){return this.throwIfDisposed(),Zx(this,r,t,n,o,u)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.powStrict=function(r){return this.throwIfDisposed(),pu(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.pow=function(r){return this.throwIfDisposed(),co(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.prelu=function(r){return this.throwIfDisposed(),bm(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.prod=function(r,t){return this.throwIfDisposed(),uy(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.reciprocal=function(){return this.throwIfDisposed(),X1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.relu=function(){return this.throwIfDisposed(),td(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.relu6=function(){return this.throwIfDisposed(),i0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.reshapeAs=function(r){return this.throwIfDisposed(),b(this,r.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.reshape=function(r){return this.throwIfDisposed(),b(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.resizeBilinear=function(r,t,n){return this.throwIfDisposed(),vb(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.resizeNearestNeighbor=function(r,t,n){return this.throwIfDisposed(),Mw(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.reverse=function(r){return this.throwIfDisposed(),Ph(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.rfft=function(){return this.throwIfDisposed(),c0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.round=function(){return this.throwIfDisposed(),Y1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.rsqrt=function(){return this.throwIfDisposed(),cy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.selu=function(){return this.throwIfDisposed(),o0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.separableConv2d=function(r,t,n,o,u,h){return this.throwIfDisposed(),K1(this,r,t,n,o,u,h)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.sigmoid=function(){return this.throwIfDisposed(),qt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.sign=function(){return this.throwIfDisposed(),Z1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.sin=function(){return this.throwIfDisposed(),hy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.sinh=function(){return this.throwIfDisposed(),dy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.slice=function(r,t){return this.throwIfDisposed(),Ut(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.softmax=function(r){return this.throwIfDisposed(),u0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.softplus=function(){return this.throwIfDisposed(),gm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.spaceToBatchND=function(r,t){return this.throwIfDisposed(),n0(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.split=function(r,t){return this.throwIfDisposed(),ed(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.sqrt=function(){return this.throwIfDisposed(),Ti(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.square=function(){return this.throwIfDisposed(),Ai(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.squaredDifference=function(r){return this.throwIfDisposed(),f0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.squaredDifferenceStrict=function(r){return this.throwIfDisposed(),fw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.squeeze=function(r){return this.throwIfDisposed(),Uv(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.stack=function(r,t){this.throwIfDisposed();const n=r instanceof Dn?[this,r]:[this,...r];return nd(n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.step=function(r){return this.throwIfDisposed(),Em(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.stridedSlice=function(r,t,n,o,u,h,p,g){return this.throwIfDisposed(),J1(this,r,t,n,o,u,h,p,g)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.subStrict=function(r){return this.throwIfDisposed(),v0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.sub=function(r){return this.throwIfDisposed(),pi(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.sum=function(r,t){return this.throwIfDisposed(),ss(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.tan=function(){return this.throwIfDisposed(),tb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.tanh=function(){return this.throwIfDisposed(),Ce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.tile=function(r){return this.throwIfDisposed(),Pv(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.toBool=function(){return this.throwIfDisposed(),eo(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.toFloat=function(){return this.throwIfDisposed(),eo(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.toInt=function(){return this.throwIfDisposed(),eo(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.topk=function(r,t){return this.throwIfDisposed(),yy(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.transpose=function(r){return this.throwIfDisposed(),cu(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.unique=function(r){return this.throwIfDisposed(),d0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.unsortedSegmentSum=function(r,t){return this.throwIfDisposed(),eb(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.unstack=function(r){return this.throwIfDisposed(),Cd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.where=function(r,t){return this.throwIfDisposed(),Lf(r,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dn.prototype.zerosLike=function(){return this.throwIfDisposed(),bi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let zy;function Qc(){return zy==null&&(zy=gn().epsilon()),zy}function Ql(r){zy=r}function Np(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class hv extends Error{constructor(t){super(t);Object.setPrototypeOf(this,hv.prototype)}}class ip extends Error{constructor(t){super(t);Object.setPrototypeOf(this,ip.prototype)}}class Yr extends Error{constructor(t){super(t);Object.setPrototypeOf(this,Yr.prototype)}}class Fs extends Error{constructor(t){super(t);Object.setPrototypeOf(this,Fs.prototype)}}class Lb extends Error{constructor(t){super(t);Object.setPrototypeOf(this,Lb.prototype)}}class uE extends Error{constructor(t){super(t);Object.setPrototypeOf(this,uE.prototype)}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Wg(r,t){if(Array.isArray(r)){let n=[];for(let o=0;o<t;o++)n=n.concat(r);return n}else{const n=new Array(t);return n.fill(r),n}}function _d(r,t){if(!r)throw new Lb(t)}function lE(r,t){let n=0;for(const o of r)o===t&&n++;return n}function Fh(r){return r.length===1?r[0]:r}function Xl(r){return Array.isArray(r)?r:[r]}function vg(r){const t=Xl(r);let n="";for(const o of t){if(o.id==null)throw new ValueError(`Object ${o} passed to objectListUid without an id`);n!==""&&(n=n+", "),n=`${n}${Math.abs(o.id)}`}return n}function qv(r){const n=r.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Vg(r){return r.length<=1||r.indexOf("_")===-1?r:r.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}let op={};function Pb(r){if(r==null)return null;const t={};return t.className=r.getClassName(),t.config=r.getConfig(),t}function Fb(r){if(!(r==null||typeof r!="object"))if(Array.isArray(r))r.forEach(t=>Fb(t));else{const t=Object.keys(r);for(const n of t){const o=r[n];o!=null&&typeof o=="object"&&(!Array.isArray(o)&&o.type==="ndarray"&&typeof o.value=="number"?r[n]=o.value:Fb(o))}}}function k0(r,t={},n={},o="object",u=!1){if(typeof r=="string"){const h=r;let p;if(h in n)p=n[h];else if(h in op)p=op[h];else if(p=t[h],p==null)throw new Yr(`Unknown ${o}: ${r}. This may be due to one of the following reasons:
1. The ${o} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${o} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return p}else{const h=r;if(h.className==null||h.config==null)throw new Yr(`${o}: Improper config format: ${JSON.stringify(h)}.
'className' and 'config' must set.`);const p=h.className;let g,x;if(p in n?[g,x]=n[p]:p in op?[g,x]=op.className:p in t&&([g,x]=t[p]),g==null)throw new Yr(`Unknown ${o}: ${p}. This may be due to one of the following reasons:
1. The ${o} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${o} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(x!=null){const I={};for(const Et of Object.keys(op))I[Et]=op[Et];for(const Et of Object.keys(n))I[Et]=n[Et];const z=h.config;z.customObjects=I;const V=Object.assign({},op);for(const Et of Object.keys(n))op[Et]=n[Et];Fb(h.config);const rt=x(g,h.config,n,u);return op=Object.assign({},V),rt}else{const I=Object.assign({},op);for(const V of Object.keys(n))op[V]=n[V];const z=new g(h.config);return op=Object.assign({},I),z}}}function j_(r,t){return r<t?-1:r>t?1:0}function $y(r,t){return-1*j_(r,t)}function PA(r){switch(r){case"float32":return"float32";default:throw new ValueError(`Invalid dtype: ${r}`)}}function FA(r,t){if(r==null||t==null)return r===t;if(r.length!==t.length)return!1;for(let n=0;n<r.length;++n)if(r[n]!==t[n])return!1;return!0}function gg(r){if(r==null)return r;const t=[];for(const n of r)t.indexOf(n)===-1&&t.push(n);return t}function Bb(r){if(r==null)throw new Yr(`Invalid value in obj: ${JSON.stringify(r)}`);for(const t in r)if(r.hasOwnProperty(t))return!1;return!0}function jg(r,t,n){if(n!=null&&r.indexOf(n)<0)throw new Yr(`${n} is not a valid ${t}.  Valid values are ${r} or null/undefined.`)}function Gy(r,t,n=0,o=Infinity){return _d(n>=0),_d(o>=n),Array.isArray(r)&&r.length>=n&&r.length<=o&&r.every(u=>typeof u===t)}function cf(r,t){Array.isArray(r)?(yt(r.length>0,()=>`${t} is unexpectedly an empty array.`),r.forEach((n,o)=>cf(n,`element ${o+1} of ${t}`))):yt(Number.isInteger(r)&&r>0,()=>`Expected ${t} to be a positive integer, but got ${cE(r)}.`)}function cE(r){return r===null?"null":Array.isArray(r)?"["+r.map(t=>cE(t)).join(",")+"]":typeof r=="string"?`"${r}"`:`${r}`}function H_(r,t){let n=ic(),o;return(...h)=>{const p=ic();return p-n<t||(n=p,o=r(...h)),o}}function fE(r){return r==="relu"?"relu":r==="linear"?"linear":r==="elu"?"elu":null}function BA(...r){_d(r.length>0,"arrayOfValues is empty");for(const t of r)_d(Array.isArray(t),"one of the values is not an array"),_d(t.length>0,"one of the values is empty");return r.reduce((t,n)=>t.length===0?n.map(o=>[o]):n.map(o=>t.map(u=>[...u,o])).reduce((o,u)=>o.concat(u),[]),[])}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zb(r,t){return zn(()=>Ti(ss(Xn(r,r),t,!0)))}class D0 extends Dh{getConfig(){return{}}}class $b extends D0{constructor(t){super();this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return zn(()=>{const n=zb(t,this.axis),o=li(n,0,this.maxValue);return Xn(t,rr(o,An(Qc(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}$b.className="MaxNorm",ci($b);class Gb extends D0{constructor(t){super();this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return zn(()=>rr(t,An(Qc(),zb(t,this.axis))))}getConfig(){return{axis:this.axis}}}Gb.className="UnitNorm",ci(Gb);class Jl extends D0{apply(t){return td(t)}}Jl.className="NonNeg",ci(Jl);class Ub extends D0{constructor(t){super();this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return zn(()=>{const n=zb(t,this.axis),o=An(Xn(this.rate,li(n,this.minValue,this.maxValue)),Xn(1-this.rate,n));return Xn(t,rr(o,An(Qc(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}Ub.className="MinMaxNorm",ci(Ub);const hE={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function ff(r){return Pb(r)}function dE(r,t={}){return k0(r,lf.getMap().classNameMap,t,"constraint")}function wl(r){if(r==null)return null;if(typeof r=="string"){const n={className:r in hE?hE[r]:r,config:{}};return dE(n)}else return r instanceof D0?r:dE(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pE(r){return new $b(r)}function vE(r){return new Gb(r)}function X_(){return new Jl}function Y_(r){return new Ub(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const K_=["channelsFirst","channelsLast"],Wb=["nearest","bilinear"],Hg=["valid","same","causal"],Z_=["max","avg"],q_=["sum","mul","concat","ave"],xf=null;/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Xg=new Map;function tc(r){jg(K_,"DataFormat",r)}function Q_(r){jg(Wb,"InterpolationFormat",r)}function Bh(r){jg(Hg,"PaddingMode",r)}function gE(r){jg(Z_,"PoolMode",r)}const Nm=[],Vb="/";function dv(r,t){Nm.push(r);try{const n=t();return Nm.pop(),n}catch(n){throw Nm.pop(),n}}function J_(){return Nm.length===0?"":Nm.join(Vb)+Vb}function tI(r){if(!eI(r))throw new Error("Not a valid tensor name: '"+r+"'");return J_()+r}function Uy(r){if(!eI(r))throw new Error("Not a valid tensor name: '"+r+"'");Xg.has(r)||Xg.set(r,0);const t=Xg.get(r);if(Xg.set(r,Xg.get(r)+1),t>0){const n=`${r}_${t}`;return Xg.set(n,1),n}else return r}const mE=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function eI(r){return!!r.match(mE)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Wy(r){return r===parseInt(r.toString(),10)}function mg(r,t,n){t==null&&(t=0),n==null&&(n=r.length);let o=1;for(let u=t;u<n;++u)o*=r[u];return o}function km(r){return r=Array.isArray(r)?new Float32Array(r):r,Ff(r)}function Yg(r){return ym(km(r)).dataSync()[0]}function pv(r){return Sd(km(r)).dataSync()[0]}function Vy(r){return tfc.sum(km(r)).dataSync()[0]}function nI(r){return Vy(r)/r.length}function zA(r){const t=tfc.sub(km(r),scalar(nI(r)));return tfc.sum(tfc.mul(t,t)).dataSync()[0]/r.length}function $A(r){const t=r.slice().sort((u,h)=>u-h),n=Math.floor((t.length-1)/2),o=Math.ceil((t.length-1)/2);return n===o?t[n]:(t[n]+t[o])/2}function zh(r,t){if(t<r)throw new Yr(`end (${t}) < begin (${r}) is forbidden.`);const n=[];for(let o=r;o<t;++o)n.push(o);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let yE="webgl";function rI(r){tfc.setBackend(r),yE=r}function GA(){return yE}function PD(){return!1}function jb(r){const t=r.shape;return t.length>0?t.reduce((n,o)=>n*o):1}function Kg(r,t){return r.asType(t)}function O0(r,t=-1){const n=r.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),r.reshape(n)}function aI(r,t){return zn(()=>{if(r.shape.length!==2)throw new Yr(`repeat() expects a rank-2 tensor, but received a rank-${r.shape.length} tensor.`);const n=O0(r,1);return Hb(n,[1,t,1])})}function iI(r){const t=[mg(r.shape)];return r.reshape(t)}function oI(r){if(r.rank<=1)throw new Yr(`batchFlatten requires a minimum rank of 2. Got rank: ${r.rank}.`);const t=[r.shape[0],mg(r.shape,1)];return r.reshape(t)}function yg(r,t,n){return zn(()=>{switch(r.rank){case 1:return q1(r,t,n);case 2:return Q1(r,[t,0],[n,r.shape[1]]);case 3:return py(r,[t,0,0],[n,r.shape[1],r.shape[2]]);case 4:return s0(r,[t,0,0,0],[n,r.shape[1],r.shape[2],r.shape[3]]);case 5:return Ut(r,[t,0,0,0,0],[n,r.shape[1],r.shape[2],r.shape[3],r.shape[4]]);case 6:return Ut(r,[t,0,0,0,0,0],[n,r.shape[1],r.shape[2],r.shape[3],r.shape[4],r.shape[5]]);default:throw new Yr(`sliceAlongFirstAxis() received an unsupported tensor rank: ${r.rank}`)}})}function jy(r,t,n){return zn(()=>{switch(r.rank){case 1:return q1(r,t,n);case 2:return Q1(r,[0,t],[r.shape[0],n]);case 3:return py(r,[0,0,t],[r.shape[0],r.shape[1],n]);case 4:return s0(r,[0,0,0,t],[r.shape[0],r.shape[1],r.shape[2],n]);default:throw new Yr(`sliceAlongLastAxis() received an unsupported tensor rank: ${r.rank}`)}})}function Hy(r,t,n,o){return zn(()=>{switch(r.rank){case 1:return q1(r,t,n);case 2:switch(o){case 1:return yg(r,t,n);case 2:return jy(r,t,n);default:throw new Yr(`The axis is not within the rank of the tensor ${o}`)}case 3:switch(o){case 1:return yg(r,t,n);case 2:return py(r,[0,t,0],[r.shape[0],n,r.shape[2]]);case 3:return jy(r,t,n);default:throw new Yr(`The axis is not within the rank of the tensor ${o}`)}case 4:switch(o){case 1:return yg(r,t,n);case 2:return s0(r,[0,t,0,0],[r.shape[0],n,r.shape[2],r.shape[3]]);case 3:return s0(r,[0,0,t,0],[r.shape[0],r.shape[1],n,r.shape[3]]);case 4:return jy(r,t,n);default:throw new Yr(`The axis is not within the rank of the tensor ${o}`)}default:throw new Yr(`sliceAlongLastAxis() received an unsupported tensor rank: ${r.rank}`)}})}function Xy(r,t=-1){let n;return t<0&&(n=r[0].rank,n!==0?t=n:t=0),t===r[0].rank&&(t=-1),_t(r,t)}function bE(r,t){switch(r.rank){case 1:return ao([r,t]);case 2:return Oo([r,t],0);case 3:return mo([r,t],0);case 4:return fs([r,t],0);default:throw new Yr(`concatAlongFirstAxis() received an unsupported tensor rank: ${r.rank}`)}}function Hb(r,t){if(Array.isArray(t)||(t=[t]),r.rank!==t.length)throw new Yr(`The length of input n (${t.length}) does not match the number of dimensions in input x (${r.rank})`);return Pv(r,t)}function Yy(r,t=0,n=1,o,u){return ly(r,t,n,o,u)}function vv(r,t,n,o){if(r.rank<2||t.rank<2)throw new Fs(`dot requires both inputs to be rank >= 2 but got x shape = ${r.shape} and y shape = ${t.shape}`);if(t.rank>=3){const u=r.shape.slice(-1)[0],h=t.shape.slice(-2)[0];if(u!==h)throw new Fs(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${r.shape} and  y shape = ${t.shape}`)}if(r.rank===2&&t.rank===2)return _m({a:r,b:t,transposeA:!1,transposeB:!1,bias:o?Ky(r.rank,o,Np()):null,activation:n});{const u=r.shape.slice(),h=u.pop();r=r.reshape([-1,h]);const p=t.shape.slice(),g=p.pop(),x=p.pop(),I=[...p,g],z=Array.from({length:t.rank},(St,Tt)=>Tt===0?t.rank-2:Tt<=t.rank-2?Tt-1:Tt);t=t.transpose(z).reshape([x,-1]);const V=[...u,...I];return _m({a:r,b:t,transposeA:!1,transposeB:!1,bias:o?Ky(r.rank,o,Np()):null,activation:n}).reshape(V)}}function UA(r){return tidy(()=>{const t=coreZerosLike(r),n=coreOnesLike(r);return where(tfc.equal(r,t),t,where(tfc.greater(r,coreZerosLike(r)),n,tfc.mul(-1,n)))})}function FD(r,t){return tidy(()=>{if(r.rank!==1)throw new Error("Only 1D one-hot tensors are supported in the deeplearn backend, at present.");return r=r.toInt(),tfc.oneHot(r,t).toFloat()})}function gv(r,t,n){return zn(()=>(Array.isArray(t)?t=Ff(t,"int32"):t=t.toInt(),Fv(r,t,n)))}function R0(r){return Xn(r,r)}function xE(r,t){return tidy(()=>{if(typeof t=="number"&&(t=scalar(Math.round(t),"int32")),t.dtype!=="int32")throw new NotImplementedError(`Non-int32 dtype (${t.dtype}) is not supported by pow() yet`);return tfc.pow(r,t)})}function Ky(r,t,n){const o=t.shape;if(t.rank!==1&&t.rank!==r)throw new Yr(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${r}`);if(r===5){if(n==="channelsFirst")return o.length===1?t.reshape([1,o[0],1,1,1]):t.reshape([1,o[3],o[0],o[1],o[2]]);if(n==="channelsLast")return o.length===1?t.reshape([1,1,1,1,o[0]]):t.reshape([1].concat(o))}else if(r===4){if(n==="channelsFirst")return o.length===1?t.reshape([1,o[0],1,1]):t.reshape([1,o[2],o[0],o[1]]);if(n==="channelsLast")return o.length===1?t.reshape([1,1,1,o[0]]):t.reshape([1].concat(o))}else if(r===3){if(n==="channelsFirst")return o.length===1?t.reshape([1,o[0],1]):t.reshape([1,o[1],o[0]]);if(n==="channelsLast")return o.length===1?t.reshape([1,1,o[0]]):t.reshape([1].concat(o))}else if(r<3)return t;throw new Yr(`Unsupported input rank by biasAdd: ${t.rank}`)}function kp(r,t,n){return zn(()=>(n==null&&(n=Np()),tc(n),r.add(Ky(r.rank,t,n))))}function wE(r,t=1){if(t!==1)throw new Fs(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return fm(r)}function Xb(r){return zn(()=>rr(r,bl(r).add(1)))}function EE(r,t,n,o){return zn(()=>mw(r,t,n,o))}function sI(r){return zn(()=>{const t=An(.5,Xn(.2,r));return li(t,0,1)})}function Dm(r,t,n=!1){return n?r():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const SE=["fanIn","fanOut","fanAvg"],CE=["normal","uniform","truncatedNormal"],WA=null;/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function uI(r){jg(SE,"FanMode",r)}function lI(r){jg(CE,"Distribution",r)}class sp extends Dh{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class Yb extends sp{apply(t,n){return Tc(t,n)}}Yb.className="Zeros",ci(Yb);class Zg extends sp{apply(t,n){return sv(t,n)}}Zg.className="Ones",ci(Zg);class Zy extends sp{constructor(t){super();if(typeof t!="object")throw new Yr(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new Yr(`config must have value set but got ${t}`);this.value=t.value}apply(t,n){return zn(()=>Xn(zi(this.value),sv(t,n)))}getConfig(){return{value:this.value}}}Zy.className="Constant",ci(Zy);class qy extends sp{constructor(t){super();this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,n){return r0(t,this.minval,this.maxval,n)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}qy.className="RandomUniform",ci(qy);class Qy extends sp{constructor(t){super();this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Fs(`randomNormal does not support dType ${n}.`);return Yy(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Qy.className="RandomNormal",ci(Qy);class Kb extends sp{constructor(t){super();this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Fs(`truncatedNormal does not support dType ${n}.`);return by(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Kb.className="TruncatedNormal",ci(Kb);class Zb extends sp{constructor(t){super();this.gain=t.gain!=null?t.gain:1}apply(t,n){return zn(()=>{if(t.length!==2||t[0]!==t[1])throw new Yr("Identity matrix initializer can only be used for 2D square matrices.");return Xn(this.gain,dm(t[0]))})}getConfig(){return{gain:this.gain}}}Zb.className="Identity",ci(Zb);function _E(r,t="channelsLast"){let n,o;if(tc(t),r.length===2)n=r[0],o=r[1];else if([3,4,5].indexOf(r.length)!==-1){if(t==="channelsFirst"){const u=mg(r,2);n=r[1]*u,o=r[0]*u}else if(t==="channelsLast"){const u=mg(r,0,r.length-2);n=r[r.length-2]*u,o=r[r.length-1]*u}}else{const u=mg(r);n=Math.sqrt(u),o=Math.sqrt(u)}return[n,o]}class $h extends sp{constructor(t){super();if(t.scale<0)throw new Yr(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,uI(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,lI(this.distribution),this.seed=t.seed}apply(t,n){const o=_E(t),u=o[0],h=o[1];let p=this.scale;if(this.mode==="fanIn"?p/=Math.max(1,u):this.mode==="fanOut"?p/=Math.max(1,h):p/=Math.max(1,(u+h)/2),this.distribution==="normal"){const g=Math.sqrt(p);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Fs(`${this.getClassName()} does not support dType ${n}.`);return by(t,0,g,n,this.seed)}else{const g=Math.sqrt(3*p);return r0(t,-g,g,n)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}$h.className="VarianceScaling",ci($h);class Jy extends $h{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return $h.className}}Jy.className="GlorotUniform",ci(Jy);class t1 extends $h{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return $h.className}}t1.className="GlorotNormal",ci(t1);class L0 extends $h{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return $h.className}}L0.className="HeNormal",ci(L0);class e1 extends $h{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return $h.className}}e1.className="HeUniform",ci(e1);class P0 extends $h{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return $h.className}}P0.className="LeCunNormal",ci(P0);class n1 extends $h{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return $h.className}}n1.className="LeCunNormal",ci(n1);class qb extends sp{constructor(t){super();if(this.DEFAULT_GAIN=1,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,this.seed!=null)throw new Fs("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,n){return zn(()=>{if(t.length<2)throw new Fs("Shape must be at least 2D.");t[0]*t[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${t[0]*t[1]}) elements: Slowness may result.`);const o=t[0]>t[1]?[t[1],t[0]]:t,u=Yy(o,0,1,"float32");let h=Rw.gramSchmidt(u);return t[0]>t[1]&&(h=h.transpose()),Xn(this.gain,h)})}getConfig(){return{gain:this.gain,seed:this.seed}}}qb.className="Orthogonal",ci(qb);const Qb={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function IE(r,t={}){return k0(r,lf.getMap().classNameMap,t,"initializer")}function mc(r){return Pb(r)}function fc(r){if(typeof r=="string"){const t=r in Qb?Qb[r]:r;if(t==="GlorotNormal")return new t1;if(t==="GlorotUniform")return new Jy;if(t==="HeNormal")return new L0;if(t==="HeUniform")return new e1;if(t==="LeCunNormal")return new P0;if(t==="LeCunUniform")return new n1;{const n={};return n.className=t,n.config={},IE(n)}}else return r instanceof sp?r:IE(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cI(){return new Yb}function fI(){return new Zg}function TE(r){return new Zy(r)}function hI(r){return new qy(r)}function dI(r){return new Qy(r)}function pI(r){return new Kb(r)}function vI(r){return new Zb(r)}function AE(r){return new $h(r)}function gI(r){return new Jy(r)}function mI(r){return new t1(r)}function yI(r){return new L0(r)}function ME(r){return new e1(r)}function bI(r){return new P0(r)}function NE(r){return new n1(r)}function xI(r){return new qb(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let wI=0;function Jb(){return wI++}const r1={};function a1(r=""){return r in r1||(r1[r]=0),r1[r]+=1,r+r1[r].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tx(r){return Array.isArray(r)&&Array.isArray(r[0])}function i1(r){return r.length===0?[]:Array.isArray(r[0])?r:[r]}function vu(r){let t;if(Array.isArray(r)){if(r.length!==1)throw new Yr(`Expected Tensor length to be 1; got ${r.length}`);t=r[0]}else t=r;return t}function $l(r){if(Array.isArray(r)&&Array.isArray(r[0])){if(r.length===1)return r=r,r[0];throw new Yr(`Expected exactly 1 Shape; got ${r.length}`)}else return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function o1(r){let t=0;for(const n of r)n.shape.length===0?t+=1:t+=n.shape.reduce((o,u)=>o*u);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const EI="Variable";class mv{constructor(t,n="float32",o=EI,u=!0,h=null){this.dtype=n==null?"float32":n,this.shape=t.shape,this.id=Jb(),o=o==null?EI:o,this.originalName=tI(o),this.name=Uy(this.originalName),this.trainable_=u,this.constraint=h,this.val=nb(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),VA(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function VA(r,t){if(r.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(r.shape)+" vs. "+JSON.stringify(t.shape))}function BD(r,t,n,o){return new mv(r,t,n,!0,o)}function jA(r,t,n){return new mv(tfc.zeros(r),t,n)}function zD(r,t,n){return new mv(tfc.zerosLike(r),t,n)}function $D(r,t,n){const o=tfc.ones(r);return new mv(o,t,n)}function HA(r,t,n){const o=tfc.onesLike(r);return new mv(o,t,n)}function XA(r,t,n){return new mv(tfc.eye(r),t,n)}function YA(r,t,n,o,u,h="randomUniform"){return new mv(tfc.randomUniform(r,t,n,o),o,h)}function KA(r,t=0,n=1,o,u,h="truncatedNormal"){if(o=o||"float32",o!=="float32"&&o!=="int32")throw new NotImplementedError(`randomNormal does not support dType ${o}.`);return new mv(tfc.truncatedNormal(r,t,n,o,u),o,h)}function GD(r,t=0,n=1,o,u,h="randomNormal"){if(o=o||"float32",o!=="float32"&&o!=="int32")throw new NotImplementedError(`randomNormalVariable does not support dType ${o}.`);return new mv(tfc.randomNormal(r,t,n,o,u),o,h)}function ZA(r,t){return r.write(t)}function SI(r,t){return r.write(tfc.add(r.read(),t))}function qA(r,t){return r.write(tfc.sub(r.read(),t))}function kE(r){return r.map(t=>t.read())}function c(r){r.forEach(t=>{t[0].write(t[1])})}function a(r,t){const n=t.map(u=>u.read()),o=variableGrads(r,n);return t.map(u=>o.grads[u.name])}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class e{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class i{constructor(t,n,o,u,h,p,g){this.dtype=t,this.shape=n,this.sourceLayer=o,this.inputs=u,this.callArgs=h,this.outputTensorIndex=g,this.id=Jb(),p!=null&&(this.originalName=tI(p),this.name=Uy(this.originalName)),this.rank=n.length}}let s=0;class l{constructor(t,n){this.callArgs=n,this.id=s++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const o of t.inboundLayers)o!=null&&o.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const n of this.inboundLayers)n!=null?t.push(n.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let f=0;class d extends Dh{constructor(t={}){super();this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=f++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=t.name;if(!n){const o=this.getClassName();n=qv(o)+"_"+a1(o)}if(this.name=n,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let o;if(t.batchInputShape!=null)o=t.batchInputShape;else if(t.inputShape!=null){let h=null;t.batchSize!=null&&(h=t.batchSize),o=[h].concat(t.inputShape)}this.batchInputShape=o;let u=t.dtype;u==null&&(u=t.inputDType),u==null&&(u="float32"),this.dtype=u}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,n){return t.name+"_ib-"+n.toString()}getNodeAtIndex(t,n){if(this.inboundNodes.length===0)throw new ip(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=t)throw new Yr(`Asked to get ${n} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return Fh(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return Fh(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new hv(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new hv(`Layer ${this.name} is not connected, no input to return.`);return Fh(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new hv(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new hv(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Fh(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(n=>n.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=Xl(t),this.inputSpec==null||this.inputSpec.length===0)return;const n=Xl(this.inputSpec);if(t.length!==n.length)throw new Yr(`Layer ${this.name} expects ${n.length} inputs, but it received ${t.length} input tensors. Input received: ${t}`);for(let o=0;o<t.length;o++){const u=t[o],h=n[o];if(h==null)continue;const p=u.rank;if(h.ndim!=null&&p!==h.ndim)throw new Yr(`Input ${o} is incompatible with layer ${this.name}: expected ndim=${h.ndim}, found ndim=${p}`);if(h.maxNDim!=null&&p>h.maxNDim)throw new Yr(`Input ${o} is incompatible with layer ${this.name}: expected max_ndim=${h.maxNDim}, found ndim=${p}`);if(h.minNDim!=null&&p<h.minNDim)throw new Yr(`Input ${o} is incompatible with layer ${this.name}: expected min_ndim=${h.minNDim}, found ndim=${p}.`);if(h.dtype!=null&&u.dtype!==h.dtype)throw new Yr(`Input ${o} is incompatible with layer ${this.name} : expected dtype=${h.dtype}, found dtype=${u.dtype}.`);if(h.axes){const g=u.shape;for(const x in h.axes){const I=Number(x),z=h.axes[x],V=I>=0?g[I]:g[g.length+I];if(z!=null&&[z,null].indexOf(V)===-1)throw new Yr(`Input ${o} is incompatible with layer ${this.name}: expected axis ${I} of input shape to have value ${z} but got shape ${g}.`)}}if(h.shape!=null)for(let g=0;g<h.shape.length;++g){const x=h.shape[g],I=u.shape[g];if(x!=null&&I!=null&&x!==I)throw new Yr(`Input ${o} is incompatible with layer ${this.name}: expected shape=${h.shape}, found shape=${u.shape}.`)}}}call(t,n){return t}invokeCallHook(t,n){this._callHook!=null&&this._callHook(t,n)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,n){n=n||{},this.assertNotDisposed();const o=Xl(t);let u=!0;for(const p of o)if(!(p instanceof i)){u=!1;break}let h=!0;for(const p of o)if(p instanceof i){h=!1;break}if(u===h)throw new Yr("Arguments to apply() must be all SymbolicTensors or all Tensors");return dv(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const p=[];for(const g of Xl(t))p.push(g.shape);this.build(Fh(p)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&h&&(this._refCount=1)}if(this.assertInputCompatibility(t),h){let p=this.call(t,n);const g=Xl(p),x=[];for(let I of g)o.indexOf(I)!==-1&&(I=I.clone()),x.push(I);if(p=Fh(x),this.activityRegularizer!=null)throw new Fs("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return p}else{const p=v(t),g=this.computeOutputShape(p);let x;const I=w(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?p[0]:p),g!=null&&g.length>0&&Array.isArray(g[0])?x=g.map((z,V)=>new i(I,z,this,Xl(t),n,this.name,V)):x=new i(I,g,this,Xl(t),n,this.name),this.addInboundNode(t,x,null,null,p,g,n),this._refCount++,this.activityRegularizer!=null)throw new Fs("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return x}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((o,u)=>{o!=null&&t[u]!=null&&t[u]!==o&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new hv(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const n of this.inboundNodes){const o=JSON.stringify(n.outputShapes);t.indexOf(o)===-1&&t.push(o)}if(t.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new hv(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new ip(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return o1(this.weights)}build(t){this.built=!0}getWeights(t=!1){return kE(t?this.trainableWeights:this.weights)}setWeights(t){zn(()=>{const n=this.weights;if(n.length!==t.length)throw new Yr(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${n.length} weights. Provided weights: ${t}...`);if(n.length===0)return;const o=[],u=kE(n);for(let h=0;h<u.length;++h){const p=u[h],g=n[h],x=t[h];if(!Un(p.shape,x.shape))throw new Yr(`Layer weight shape ${p.shape} not compatible with provided weight shape ${x.shape}`);o.push([g,x])}c(o)})}addWeight(t,n,o,u,h,p,g){if(this._addedWeightNames.indexOf(t)!==-1)throw new Yr(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),o==null&&(o="float32"),this.fastWeightInitDuringBuild&&(u=fc("zeros"));const x=u.apply(n,o),I=new mv(x,o,t,p,g);return x.dispose(),h!=null&&this.addLoss(()=>h.apply(I.read())),p==null&&(p=!0),p?this._trainableWeights.push(I):this._nonTrainableWeights.push(I),I}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=Xl(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(o=>{if(o!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}addInboundNode(t,n,o,u,h,p,g=null){const x=Xl(t);n=Xl(n),o=Xl(o),u=Xl(u),h=i1(h),p=i1(p);const I=[],z=[],V=[];for(const rt of x)I.push(rt.sourceLayer),z.push(rt.nodeIndex),V.push(rt.tensorIndex);new l({outboundLayer:this,inboundLayers:I,nodeIndices:z,tensorIndices:V,inputTensors:x,outputTensors:n,inputMasks:o,outputMasks:u,inputShapes:h,outputShapes:p},g);for(let rt=0;rt<n.length;rt++)n[rt].sourceLayer=this,n[rt].nodeIndex=this.inboundNodes.length-1,n[rt].tensorIndex=rt}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount==0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function v(r){r=Xl(r);const t=[];for(const n of r)t.push(n.shape);return Fh(t)}function w(r){return"float32"}function E(r,t,n){if((t==null||n!=null&&n>0)&&(t=r.sourceLayer,n=r.nodeIndex),t.inboundNodes.length===0)return[r];{const o=t.inboundNodes[n];if(o.inboundLayers.length===0)return o.inputTensors;{const u=[];for(let h=0;h<o.inboundLayers.length;h++){const p=o.inputTensors[h],g=o.inboundLayers[h],x=o.nodeIndices[h],I=E(p,g,x);for(const z of I)u.indexOf(z)===-1&&u.push(z)}return u}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class T extends d{constructor(t){super({dtype:t.dtype,name:t.name!=null?t.name:a1("input").toString()});if(t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new Yr("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=t.batchInputShape;if(n==null){if(t.inputShape==null)throw new Yr("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new Yr("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const o=t.dtype||"float32";this.batchInputShape=n,this.dtype=o,this.inputSpec=[{shape:n}];const u=new i(this.dtype,this.batchInputShape,this,[],{},this.name);u.nodeIndex=0,u.tensorIndex=0,new l({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[u],outputTensors:[u],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(t,n){throw new Yr(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}T.className="InputLayer",ci(T);function G(r){if(r.batchShape==null&&r.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(r.batchShape!=null&&r.shape!=null)throw new Yr("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=r.batchShape;r.shape!=null&&t==null&&(t=[null].concat(r.shape));let n=r.dtype;return n==null&&(n="float32"),new T({batchInputShape:t,name:r.name,dtype:n,sparse:r.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function U(r){return Wr(this,null,function*(){if(r==null)return;const t=[],n=[],o=[];for(const u in r){const h=r[u];if(typeof h!="number"){const p=h;t.push(p.data()),n.push(u),o.push(p)}}if(t.length>0){const u=yield Promise.all(t);for(let h=0;h<u.length;++h)r[n[h]]=u[h][0];N(o)}})}function et(r){if(r!=null)for(const t in r){const n=r[t];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var ct;(function(r){r[r.SILENT=0]="SILENT",r[r.VERBOSE=1]="VERBOSE"})(ct||(ct={}));const Ct=125;class Mt{constructor(){this.validationData=null}setParams(t){this.params=t}onEpochBegin(t,n){return Wr(this,null,function*(){})}onEpochEnd(t,n){return Wr(this,null,function*(){})}onBatchBegin(t,n){return Wr(this,null,function*(){})}onBatchEnd(t,n){return Wr(this,null,function*(){})}onTrainBegin(t){return Wr(this,null,function*(){})}onTrainEnd(t){return Wr(this,null,function*(){})}setModel(t){}}class Dt{constructor(t,n=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=n}append(t){this.callbacks.push(t)}setParams(t){for(const n of this.callbacks)n.setParams(t)}setModel(t){for(const n of this.callbacks)n.setModel(t)}onEpochBegin(t,n){return Wr(this,null,function*(){n==null&&(n={});for(const o of this.callbacks)yield o.onEpochBegin(t,n)})}onEpochEnd(t,n){return Wr(this,null,function*(){n==null&&(n={});for(const o of this.callbacks)yield o.onEpochEnd(t,n)})}onBatchBegin(t,n){return Wr(this,null,function*(){n==null&&(n={});for(const o of this.callbacks)yield o.onBatchBegin(t,n)})}onBatchEnd(t,n){return Wr(this,null,function*(){n==null&&(n={});for(const o of this.callbacks)yield o.onBatchEnd(t,n)})}onTrainBegin(t){return Wr(this,null,function*(){t==null&&(t={});for(const n of this.callbacks)yield n.onTrainBegin(t)})}onTrainEnd(t){return Wr(this,null,function*(){t==null&&(t={});for(const n of this.callbacks)yield n.onTrainEnd(t)})}}class zt extends Mt{constructor(){super()}onEpochBegin(t){return Wr(this,null,function*(){this.seen=0,this.totals={}})}onBatchEnd(t,n){return Wr(this,null,function*(){n==null&&(n={});const o=n.size==null?0:n.size;this.seen+=o;for(const u in n){const h=n[u];if(typeof h=="number")this.totals.hasOwnProperty(u)||(this.totals[u]=0),this.totals[u]=this.totals[u]+h*o;else{let p;u in this.totals?p=this.totals[u]:this.totals[u]=0;const g=zn(()=>An(this.totals[u],Xn(h,o)));this.totals[u]=g,p!=null&&p.dispose()}}})}onEpochEnd(t,n){return Wr(this,null,function*(){if(n!=null)for(const o of this.params.metrics)this.totals[o]!=null&&(typeof this.totals[o]=="number"?n[o]=this.totals[o]/this.seen:zn(()=>{const u=Xn(rr(1,this.seen),this.totals[o]);n[o]=u,this.totals[o].dispose(),q(n[o])}))})}}class Qt extends Mt{onTrainBegin(t){return Wr(this,null,function*(){this.epoch=[],this.history={}})}onEpochEnd(t,n){return Wr(this,null,function*(){n==null&&(n={}),this.epoch.push(t);for(const o in n)this.history[o]==null&&(this.history[o]=[]),this.history[o].push(n[o])})}syncData(){return Wr(this,null,function*(){const t=[],n=[],o=[];for(const h in this.history){const p=this.history[h];for(let g=0;g<p.length;++g)if(typeof p[g]!="number"){const x=p[g];t.push(x.data()),n.push(h),o.push(g)}}const u=yield Promise.all(t);for(let h=0;h<u.length;++h)this.history[n[h]][o[h]].dispose(),this.history[n[h]][o[h]]=u[h][0]})}}class Ie extends Mt{constructor(t,n){super();if(this.currentEpoch=0,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Ct),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Tr(this.yieldEvery)&&(this.maybeWait=H_(this.maybeWait.bind(this),this.yieldEvery)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}maybeWait(t,n,o){return Wr(this,null,function*(){const u=[];this.yield!=null&&(yield U(o),u.push(this.yield(t,n,o))),u.push(x0()),yield Promise.all(u)})}onEpochBegin(t,n){return Wr(this,null,function*(){this.currentEpoch=t,this.epochBegin!=null&&(yield U(n),yield this.epochBegin(t,n))})}onEpochEnd(t,n){return Wr(this,null,function*(){const o=[];this.epochEnd!=null&&(yield U(n),o.push(this.epochEnd(t,n))),this.yieldEvery==="epoch"&&o.push(x0()),yield Promise.all(o)})}onBatchBegin(t,n){return Wr(this,null,function*(){this.batchBegin!=null&&(yield U(n),yield this.batchBegin(t,n))})}onBatchEnd(t,n){return Wr(this,null,function*(){const o=[];this.batchEnd!=null&&(yield U(n),o.push(this.batchEnd(t,n))),this.yieldEvery==="batch"?o.push(x0()):Tr(this.yieldEvery)&&o.push(this.maybeWait(this.currentEpoch,t,n)),yield Promise.all(o)})}onTrainBegin(t){return Wr(this,null,function*(){this.trainBegin!=null&&(yield U(t),yield this.trainBegin(t))})}onTrainEnd(t){return Wr(this,null,function*(){this.trainEnd!=null&&(yield U(t),yield this.trainEnd(t))})}}function je(r,t){return r==null&&(r={}),r instanceof Mt?[r]:Array.isArray(r)&&r[0]instanceof Mt?r:Xl(r).map(o=>new Ie(o,t))}class ze{constructor(){}static registerCallbackConstructor(t,n){yt(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),ze.checkForDuplicate(n),ze.constructors[t]==null&&(ze.constructors[t]=[]),ze.constructors[t].push(n)}static checkForDuplicate(t){for(const n in ze.constructors)ze.constructors[+n].forEach(u=>{if(u===t)throw new Yr("Duplicate callback constructor.")})}static clear(){ze.constructors={}}static createCallbacks(t){const n=[];for(const o in ze.constructors){const u=+o;t>=u&&n.push(...ze.constructors[u])}return n.map(o=>new o)}}ze.constructors={};function mn(r,t,n,o,u,h,p,g,x){const I=new Qt,z=[new zt,...ze.createCallbacks(t)];r!=null&&z.push(...r),z.push(I);const V=new Dt(z);return V.setParams({epochs:n,initialEpoch:o,samples:u,steps:h,batchSize:p,verbose:t,doValidation:g,metrics:x}),{callbackList:V,history:I}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $n(r,t={},n=!1){return k0(r,lf.getMap().classNameMap,t,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Tn(r,t){return zn(()=>{r.dtype!=="float32"&&(r=r.asType("float32"));const n=ss(R0(r),t,!0),o=Jo(n.shape,Qc()),u=Ti(Po(n,o));return rr(r,u)})}function or(r,t){return zn(()=>cc(R0(pi(t,r)),-1))}function kr(r,t){return zn(()=>cc(bl(pi(t,r)),-1))}function Ta(r,t){return zn(()=>{const n=pi(r,t),o=li(bl(r),Qc(),Number.MAX_VALUE),u=bl(rr(n,o));return Xn(100,cc(u,-1))})}function fi(r,t){return zn(()=>{const n=li(t,Qc(),Number.MAX_VALUE),o=Oh(An(1,n)),u=li(r,Qc(),Number.MAX_VALUE),h=Oh(An(1,u));return cc(R0(pi(o,h)),-1)})}function ei(r,t){return zn(()=>{const n=Po(0,pi(1,Xn(r,t)));return cc(R0(n),-1)})}function Ia(r,t){return zn(()=>{const n=Po(0,pi(1,Xn(r,t)));return cc(n,-1)})}function Gi(r,t){return zn(()=>{const n=ss(Xn(r,t),-1),o=Sd(Xn(pi(1,r),t),-1);return Po(0,An(1,pi(o,n)))})}function Ri(r,t){return zn(()=>{const n=Math.log(2),o=pi(t,r),u=pi(An(o,gm(Xn(-2,o))),n);return cc(u,-1)})}function xa(r,t,n=!1){return zn(()=>{if(n)t=u0(t);else{const o=ss(t,t.shape.length-1,!0);t=rr(t,o)}return t=li(t,Qc(),1-Qc()),Ic(ss(Xn(r.toFloat(),Oh(t)),t.shape.length-1))})}function ja(r,t,n=!1){return zn(()=>{const o=pm(iI(r)).toInt();t=li(t,Qc(),1-Qc());const u=t.shape,h=Df(o,u[u.length-1]).reshape(u);return xa(h,t,n)})}function di(r,t){if(!Un(r.shape,t.shape))throw new Yr(`logits and labels must have the same shape, but got shapes ${JSON.stringify(r.shape)} and ${JSON.stringify(t.shape)}`);return zn(()=>{const n=t.relu(),o=t.abs().neg();return n.sub(t.mul(r)).add(o.exp().log1p())})}function hi(r,t){return zn(()=>{let n;return n=li(t,Qc(),1-Qc()),n=Oh(rr(n,pi(1,n))),cc(di(r,n),-1)})}function qi(r,t){return zn(()=>{const n=li(r,Qc(),1),o=li(t,Qc(),1);return ss(Xn(r,Oh(rr(n,o))),-1)})}function fo(r,t){return zn(()=>{const n=Oh(An(Qc(),t));return cc(pi(t,Xn(r,n)),-1)})}function es(r,t){return zn(()=>{const n=Tn(r,-1),o=Tn(t,-1),u=Xn(n,o);return Ic(ss(u,-1))})}const Bs=null,cl=null,Fu=null,fl=null,El=null,ec=null,Gl=null,Dp=null,wf=null,Op=null,Ef=null,Ac={meanSquaredError:or,meanAbsoluteError:kr,meanAbsolutePercentageError:Ta,meanSquaredLogarithmicError:fi,squaredHinge:ei,hinge:Ia,categoricalHinge:Gi,logcosh:Ri,categoricalCrossentropy:xa,sparseCategoricalCrossentropy:ja,binaryCrossentropy:hi,kullbackLeiblerDivergence:qi,poisson:fo,cosineProximity:es};function Gh(r){if(typeof r=="string"){if(r in Ac)return Ac[r];let t=`Unknown loss ${r}`;throw r.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${r}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Yr(t)}else return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sf(r,t){return zn(()=>{const n=Xn(.5,Zc(t)),o=Kg(Ed(t,n),r.dtype);return cc(Hu(r,o),-1)})}function Qf(r,t){return zn(()=>Kg(Hu(ga(r,-1),ga(t,-1)),"float32"))}function Qs(r,t){return zn(()=>Rh(r.equal(1),t.equal(1)).sum().cast("float32"))}function Ju(r,t){return zn(()=>Rh(r.equal(1),t.equal(0)).sum().cast("float32"))}function Js(r,t){return zn(()=>Rh(r.equal(0),t.equal(1)).sum().cast("float32"))}function Xu(r,t){return zn(()=>{const n=Qs(r,t),o=Js(r,t),u=n.add(o);return Lf(Ed(u,0),n.div(u),0).cast("float32")})}function Il(r,t){return zn(()=>{const n=Qs(r,t),o=Ju(r,t),u=n.add(o);return Lf(Ed(u,0),n.div(u),0).cast("float32")})}function Fo(r,t){return hi(r,t)}function su(r,t){return r.rank===t.rank&&(r=r.squeeze([r.rank-1])),t=t.argMax(-1),t.dtype!==r.dtype&&(t=t.asType(r.dtype)),Hu(r,t).asType("float32")}function Iu(r,t){throw new NotImplementedError}function Nl(r,t){throw new NotImplementedError}const Tu=or,Gu=or,hc=kr,Id=kr,Jc=Ta,qg=Ta,bg=xa,Uh=es,Td=ja,Ad={binaryAccuracy:Sf,categoricalAccuracy:Qf,precision:Xu,categoricalCrossentropy:bg,sparseCategoricalCrossentropy:Td,mse:Tu,MSE:Gu,mae:hc,MAE:Id,mape:Jc,MAPE:qg,cosine:Uh};function xg(r){if(typeof r=="string"&&r in Ad)return Ad[r];if(typeof r!="string"&&r!=null)return r;throw new Yr(`Unknown metric ${r}`)}function zf(r){if(_d(r!==null,`Unknown LossOrMetricFn ${r}`),typeof r=="string")return r;{let t;for(const n of Object.keys(Ac))if(Ac[n]===r){t=n;break}if(t!==void 0)return t;for(const n of Object.keys(Ad))if(Ad[n]===r){t=n;break}return t!==void 0?t:r.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rp(r){const t={Adagrad:()=>zg.adagrad(.01),Adadelta:()=>zg.adadelta(1,.95,Qc()),Adam:()=>zg.adam(.001,.9,.999,Qc()),Adamax:()=>zg.adamax(.002,.9,.999,Qc(),0),RMSProp:()=>zg.rmsprop(.001,.9,0,Qc()),SGD:()=>zg.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,r in t)return t[r]();throw new Yr(`Unknown Optimizer ${r}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const yv=1*1024*1024;function ex(r,t,n=!1){if(r==null||typeof r!="object"||Object.getPrototypeOf(r)!==Object.prototype||!nx(r))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const o=JSON.stringify(r);o.length>yv&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${o.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${yv}.`)}}function nx(r){if(r===null)return!0;if(typeof r=="object")if(Object.getPrototypeOf(r)===Object.prototype){const t=Object.keys(r);for(const n of t)if(typeof n!="string"||!nx(r[n]))return!1;return!0}else if(Array.isArray(r)){for(const t of r)if(!nx(t))return!1;return!0}else return!1;else{const t=typeof r;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function CI(r,t,n,o=console.log){const u=rx(r),h=["Layer (type)","Output shape","Param #"];u?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(z=>Math.floor(t*z)));let p;if(!u){h.push("Receives inputs"),p=[];for(const z in r.nodesByDepth)p.push(...r.nodesByDepth[z])}o("_".repeat(t)),F0(h,n,o),o("=".repeat(t));const g=r.layers;for(let z=0;z<g.length;++z)u?II(g[z],n,o):TI(g[z],n,p,o),o((z===g.length-1?"=":"_").repeat(t));r.checkTrainableWeightsConsistency();const x=_I(r),I=o1(r.nonTrainableWeights);o(`Total params: ${x+I}`),o(`Trainable params: ${x}`),o(`Non-trainable params: ${I}`),o("_".repeat(t))}function _I(r){let t;return r.collectedTrainableWeights!=null?t=o1(r.collectedTrainableWeights):t=o1(r.trainableWeights),t}function rx(r){let t=!0;const n=[],o=[];for(const u in r.nodesByDepth)n.push(r.nodesByDepth[u]);for(const u of n){if(u.length>1||u.length===1&&u[0].inboundLayers.length>1){t=!1;break}o.push(...u)}if(t)for(const u of r.layers){let h=!1;for(const p of u.inboundNodes)if(o.indexOf(p)!==-1)if(h){t=!1;break}else h=!0;if(!t)break}return t}function F0(r,t,n=console.log){let o="";for(let u=0;u<r.length;++u)u>0&&(o=o.slice(0,o.length-1)+" "),o+=r[u],o=o.slice(0,t[u]),o+=" ".repeat(t[u]-o.length);n(o)}function II(r,t,n){let o;try{o=JSON.stringify(r.outputShape)}catch(g){o="multiple"}const u=r.name,h=r.getClassName(),p=[`${u} (${h})`,o,r.countParams().toString()];F0(p,t,n)}function TI(r,t,n,o){let u;try{u=JSON.stringify(r.outputShape)}catch(z){u="multiple"}const h=[];for(const z of r.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(z)===-1))for(let V=0;V<z.inboundLayers.length;++V){const rt=z.inboundLayers[V].name,Et=z.nodeIndices[V],St=z.tensorIndices[V];h.push(`${rt}[${Et}][${St}]`)}const p=r.name,g=r.getClassName(),x=h.length===0?"":h[0],I=[`${p} (${g})`,u,r.countParams().toString(),x];F0(I,t,o);for(let z=1;z<h.length;++z)F0(["","","",h[z]],t,o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DE(r,t,n){return(r==="inboundNodes"||r==="outputLayers"||r==="inputLayers")&&t===0&&typeof n=="string"}function wg(r,t){if(r===null)return null;if(typeof r=="string")return Vg(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){const n=[],o=r.length;for(let u=0;u<o;++u){const h=r[u];DE(t,u,h)?n.push(h):n.push(wg(h,t))}return n}else{const n={};for(const o of Object.keys(r)){const u=r[o];if(o==="name"&&typeof u=="string")n[o]=u;else{const h=Vg(o);n[h]=wg(u,h)}}return n}}function Lp(r,t){if(r==null)return null;if(typeof r=="string")return qv(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){const n=[],o=r.length;for(let u=0;u<o;++u){const h=r[u];DE(t,u,h)?n.push(h):n.push(Lp(h,t))}return n}else{const n={};for(const o of Object.keys(r)){const u=r[o],h=qv(o);(o==="name"||o==="className")&&typeof u=="string"?n[h]=u:n[h]=Lp(u,o)}return n}}/** @license See the LICENSE file. */const Qg="2.8.6";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nc(r,t){if(r.dtype==null||r.dtype===t.dtype)return t;try{return eo(t,r.dtype)}catch(n){throw new Yr(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${r.name}' (${r.dtype}).`)}}class hf{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof hf)for(const n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(const n of t)this.add(n.key,n.value)}}add(t,n,o){if(this.id2Value[t.id]==null)this.id2Value[t.id]=nc(t,n),this.name2Id[t.name]=t.id,o!=null&&(this.id2Mask[t.id]=o);else throw new Yr(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof i){if(this.id2Value[t.id]==null)throw new Yr(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const n=this.name2Id[t];if(n==null)throw new Yr(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof i){if(this.id2Value[t.id]==null)throw new Yr(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const n=this.name2Id[t];if(n==null)throw new Yr(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&N(this.id2Mask)}}const tf={},Pp={};function Fp(r,t,n,o){const u=n==null?!1:n.training,h=Array.isArray(r),p=h?r:[r],g=p.map(St=>St.name),x=[],I=t.names();for(const St of g)I.indexOf(St)!==-1?x.push(t.getValue(St)):x.push(null);o!=null&&(o.maxNumTensors=-Infinity,o.minNumTensors=Infinity);const z=g.join(",")+"|"+t.names().join(",");let V,rt;if(tf[z]==null){const St=OE(p,t);V=St.sorted,rt=St.recipientCounts,tf[z]=V,Pp[z]=rt}V=tf[z],rt={},u||Object.assign(rt,Pp[z]);const Et=new hf(t);for(let St=0;St<V.length;++St){if(o!=null){const Br=Qa().numTensors;Br>o.maxNumTensors&&(o.maxNumTensors=Br),Br<o.minNumTensors&&(o.minNumTensors=Br)}const Tt=V[St],Vt=Tt.sourceLayer;if(Vt instanceof T)continue;const ue=[],ye=[],qe=[];let $e=!1;for(const Br of Tt.inputs){const Kr=Et.getValue(Br),Na=Et.getMask(Br);ue.push(Kr),ye.push(Na),Na!=null&&($e=!0),u||(rt[Br.name]--,rt[Br.name]===0&&!t.hasKey(Br)&&g.indexOf(Br.name)===-1&&!Kr.isDisposed&&Br.sourceLayer.stateful!==!0&&qe.push(Kr))}$e&&(n=n||{},n.mask=ye[0]);const Xe=Xl(Vt.apply(ue,n));let Pn=null;Vt.supportsMasking&&(Pn=Vt.computeMask(ue,ye));const In=LE(Tt),gr=Array.isArray(In)?In:[In];for(let Br=0;Br<gr.length;++Br){Et.hasKey(gr[Br])||Et.add(gr[Br],Xe[Br],Array.isArray(Pn)?Pn[0]:Pn);const Kr=g.indexOf(gr[Br].name);Kr!==-1&&(x[Kr]=Xe[Br])}u||N(qe)}return Et.disposeMasks(),h?x:x[0]}function OE(r,t){yt(r!=null&&r.length>0,()=>"Expected at least one fetch, got none");let n=[],o={};if(r.length===1){const u=s1(r[0],t);n=u.sorted,o=u.recipientMap}else{const u=new Set;for(const h of r){const{sorted:p,recipientMap:g}=s1(h,t);for(const x of p)u.has(x.name)||(n.push(x),u.add(x.name));for(const x in g)o[x]==null&&(o[x]=new Set),g[x].forEach(I=>o[x].add(I))}}return{sorted:n,recipientCounts:RE(o)}}function RE(r){const t={};for(const n in r)t[n]=r[n].size;return t}function s1(r,t){const n=new Set,o=[],u={};for(const g of t.names())n.add(g);const h=[],p=[];for(h.push(r);h.length>0;){const g=h[h.length-1];if(n.has(g.name)){h.pop();continue}const x=p[p.length-1]===h.length-1;if(g.inputs.length===0||x)h.pop(),o.push(g),n.add(g.name),x&&p.pop();else{p.push(h.length-1);for(const I of g.inputs)u[I.name]==null&&(u[I.name]=new Set),u[I.name].add(g.name),!n.has(I.name)&&h.push(I)}}return{sorted:o,recipientMap:u}}function LE(r){let t;if(r.sourceLayer.inboundNodes.length===1)t=r.sourceLayer.output;else{let n=null;for(let o=0;o<r.sourceLayer.inboundNodes.length;++o)for(const u of r.sourceLayer.inboundNodes[o].outputTensors)if(u.id===r.id){n=o;break}t=r.sourceLayer.getOutputAt(n)}return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class up extends d{constructor(t){super({});if(this.containerNodes=new Set,this.name=t.name,this.name==null){const ye=this.getClassName().toLowerCase();this.name=a1(ye)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],gg(this.inputs).length!==this.inputs.length)throw new Yr(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(ye=>ye.name)}`);gg(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(ye=>ye.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const ye of this.outputs){const qe=ye.sourceLayer,$e=ye.nodeIndex,Xe=ye.tensorIndex;this.outputLayers.push(qe),this.outputLayersNodeIndices.push($e),this.outputLayersTensorIndices.push(Xe)}for(const ye of this.inputs){const qe=ye.sourceLayer,$e=ye.nodeIndex,Xe=ye.tensorIndex;_d($e===0,"input layer has >1 nodes"),_d(Xe===0,"input layer has >1 tensors"),this.inputLayers.push(qe),this.inputLayersNodeIndices.push($e),this.inputLayersTensorIndices.push(Xe)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let ye=0;ye<this.inputLayers.length;ye++){const qe=this.inputLayers[ye];if(!(qe instanceof T))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${ye} (0-based) originates from layer type ${qe.getClassName()}.`);this.inputNames.push(qe.name),this.feedInputShapes.push(qe.batchInputShape),this.feedInputNames.push(qe.name)}for(const ye of this.outputLayers)this.outputNames.push(ye.name);this.internalInputShapes=this.inputs.map(ye=>ye.shape),this.internalOutputShapes=this.outputs.map(ye=>ye.shape);const n={},o={},u={},h={},p={},g=[],x=(ye,qe,$e,Xe,Pn,In)=>{(Xe==null||Pn==null||In==null)&&(Xe=ye.sourceLayer,Pn=ye.nodeIndex,In=ye.tensorIndex);const gr=Xe.inboundNodes[Pn];if($e.indexOf(gr)!==-1)throw new ip(`The tensor ${ye.name} at layer "${Xe.name}" is part of a cycle.`);if(qe.indexOf(gr)!==-1)return;this.containerNodes.add(up.nodeKey(Xe,Pn)),Xe.id in p||(p[Xe.id]=Object.keys(p).length),$e.indexOf(gr)===-1&&$e.push(gr);const Br=gr.inboundLayers.length;for(let Kr=0;Kr<Br;Kr++){const Na=gr.inputTensors[Kr],Ya=gr.inboundLayers[Kr],Ha=gr.nodeIndices[Kr],ni=gr.tensorIndices[Kr];x(Na,qe,$e,Ya,Ha,ni)}for(qe.push(gr);$e.indexOf(gr)>=0;)$e.splice($e.indexOf(gr),1);g.push(gr)},I=[],z=[];for(const ye of this.outputs)x(ye,I,z);const V=g.slice().reverse();for(const ye of V){o[ye.id]=ye,ye.id in n||(n[ye.id]=0);let qe=n[ye.id];const $e=u[ye.outboundLayer.id]==null?0:u[ye.outboundLayer.id];qe=Math.max(qe,$e),u[ye.outboundLayer.id]=qe,h[ye.outboundLayer.id]=ye.outboundLayer,n[ye.id]=qe;for(let Xe=0;Xe<ye.inboundLayers.length;Xe++){const Pn=ye.inboundLayers[Xe],In=ye.nodeIndices[Xe],gr=Pn.inboundNodes[In],Br=n[gr.id]==null?0:n[gr.id];n[gr.id]=Math.max(qe+1,Br),o[gr.id]=gr}}const rt={};for(const ye in n){const qe=n[ye];qe in rt||(rt[qe]=[]),rt[qe].push(o[ye])}const Et={};for(const ye in u){const qe=u[ye];qe in Et||(Et[qe]=[]),Et[qe].push(h[ye])}let St=Object.keys(Et).map(ye=>parseInt(ye,10)).sort($y);this.layers=[];for(const ye of St){const qe=Et[ye];qe.sort(($e,Xe)=>{const Pn=p[$e.id],In=p[Xe.id];return Pn<In?-1:Pn>In?1:0});for(const $e of qe)$e instanceof up&&this.internalContainerRefs.push($e),this.layers.push($e)}this.layersByDepth=Et,St=Object.keys(rt).map(ye=>parseInt(ye,10)).sort($y);const Tt=this.inputs.slice(),Vt=[];for(const ye of St)for(const qe of rt[ye]){const $e=qe.outboundLayer;if($e!=null){for(const Xe of qe.inputTensors)if(Tt.indexOf(Xe)===-1)throw new ip(`Graph disconnected: cannot obtain value for tensor ${Xe} at layer "${$e.name}". The following previous layers were accessed without issue: ${Vt}`);for(const Xe of qe.outputTensors)Tt.push(Xe);Vt.push($e.name)}}this.nodesByDepth=rt;const ue=this.layers.map(ye=>ye.name);for(const ye of ue){const qe=ue.filter($e=>$e===ye).length;if(qe!==1)throw new ip(`The name "${ye}" is used ${qe} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(ue))}this.outboundNodes=[],this.inboundNodes=[],new l({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(ye=>null),outputMasks:this.outputs.map(ye=>null),inputShapes:this.inputs.map(ye=>ye.shape),outputShapes:this.outputs.map(ye=>ye.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(const n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(o=>o.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new Yr("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const o of this.layers)n.push(...o.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){const o={};let u=0;for(const p of this.layers)for(const g of p.weights){if(o[g.originalName]!=null)throw new Yr(`Duplicate weight name: ${g.originalName}`);o[g.originalName]=g,u++}const h=[];for(const p in t){let g=p;if(o[p]==null){const x=p.split("/");g=x.slice(0,-2).concat([x[x.length-1]]).join("/")}if(o[g]!=null)h.push([o[g],t[p]]);else if(n)throw new Yr(`Provided weight data has no target variable: ${p}`);delete o[g]}if(n){const p=[];for(const g in o)p.push(g);if(p.length>0)throw new Yr(`${p.length} of ${u} weights are not set: ${p}`)}c(h)}updatedConfig(){const t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${Qg}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){const o=Lp(this.updatedConfig());return n?JSON.stringify(o):o}call(t,n){return zn(()=>{t=Xl(t);const o=new hf;for(let u=0;u<this.inputs.length;++u)o.add(this.inputs[u],t[u]);return Fp(this.outputs,o,n)})}computeMask(t,n){return zn(()=>{t=Xl(t);let o;return n==null?o=Wg(null,t.length):o=Xl(n),this.runInternalGraph(t,o)[1]})}computeOutputShape(t){const n=i1(t);if(n.length!==this.inputLayers.length)throw new Yr(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const o={};for(let g=0;g<n.length;g++){const x=this.inputLayers[g],I=n[g],z=x.name+"_0_0";o[z]=I}const u=Object.keys(this.nodesByDepth).map(g=>parseInt(g,10)).sort($y);if(u.length>1)for(const g of u){const x=this.nodesByDepth[g];for(const I of x){const z=I.outboundLayer;if(this.inputLayers.map(Tt=>Tt.id).indexOf(z.id)!==-1)continue;const V=[];for(let Tt=0;Tt<I.inboundLayers.length;Tt++){const Vt=I.inboundLayers[Tt],ue=I.nodeIndices[Tt],ye=I.tensorIndices[Tt],qe=`${Vt.name}_${ue}_${ye}`,$e=o[qe];V.push($e)}const rt=z.computeOutputShape(Fh(V)),Et=i1(rt),St=z.inboundNodes.indexOf(I);for(let Tt=0;Tt<Et.length;Tt++){const Vt=`${z.name}_${St}_${Tt}`;o[Vt]=Et[Tt]}}}const h=[],p=[];for(let g=0;g<this.outputLayers.length;g++){const x=this.outputLayers[g],I=this.outputLayersNodeIndices[g],z=this.outputLayersTensorIndices[g],V=`${x.name}_${I}_${z}`;p.push(V)}for(let g=0;g<p.length;g++){const x=p[g];_d(x in o),h.push(o[x])}return Fh(h)}runInternalGraph(t,n){n==null&&(n=Wg(null,t.length));const o={};for(let x=0;x<this.inputs.length;++x){const I=this.inputs[x],z=t[x],V=n[x];o[I.id]=[z,V]}const u=Object.keys(this.nodesByDepth).map(x=>parseInt(x,10)).sort($y);for(const x of u){const I=this.nodesByDepth[x];for(const z of I){const V=z.outboundLayer,rt=z.inputTensors,Et=z.outputTensors,St=new Array;for(const Tt of rt)Tt.id in o&&St.push(o[Tt.id]);if(St.length===rt.length){let Tt={},Vt,ue,ye,qe;if(z.callArgs!=null&&(Tt=z.callArgs),St.length===1){const[$e,Xe]=St[0];Tt.mask==null&&(Tt.mask=Xe),ye=Xl(V.call($e,Tt)),qe=Xl(V.computeMask($e,Xe)),Vt=[$e],ue=[Xe]}else Vt=St.map($e=>$e[0]),ue=St.map($e=>$e[1]),Tt.mask==null&&(Tt.mask=ue),ye=Xl(V.call(Vt,Tt)),qe=Xl(V.computeMask(Vt,ue));if(V.activityRegularizer)throw new Fs("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let $e=0;$e<Et.length;++$e){const Xe=Et[$e],Pn=ye[$e],In=qe[$e];o[Xe.id]=[Pn,In]}}}}const h=[],p=[],g=[];for(const x of this.outputs){_d(x.id in o,`Could not compute output ${x.name} : ${x.id}`);const[I,z]=o[x.id];g.push(I.shape),h.push(I),p.push(z)}return[h,p,g]}buildNodeConversionMap(t){const n={};let o;for(const u of this.layers){o=u instanceof up?1:0;for(let h=0;h<u.inboundNodes.length;h++){const p=up.nodeKey(u,h);this.containerNodes.has(p)&&(n[p]=o,o+=1)}}return n}getLayer(t,n){if(n!=null){if(this.layers.length<=n)throw new Yr(`Was asked to retrieve layer at index ${n}, but model only has ${this.layers.length} layer(s).`);return this.layers[n]}else if(t==null)throw new Yr("Provide either a layer name or layer index");for(const o of this.layers)if(o.name===t)return o;throw new Yr(`No such layer: ${t}`)}calculateLosses(){return zn(()=>{const t=[];for(const n of this.layers)for(let o=0;o<n.inboundNodes.length;++o){const u=up.nodeKey(n,o);this.containerNodes.has(u)&&t.push(...n.calculateLosses())}return t})}getConfig(){const t={name:this.name},n=this.buildNodeConversionMap(this.layers),o=[];for(const p of this.layers){const g=p.getClassName(),x=p.getConfig(),I=[];for(let V=0;V<p.inboundNodes.length;V++){const rt=p.inboundNodes[V],Et=up.nodeKey(p,V);let St={};if(this.containerNodes.has(Et)){if(rt.callArgs)try{JSON.stringify(rt.callArgs),St=rt.callArgs}catch(Tt){console.warn(`Layer ${p.name} was passed non-serializable keyword arguments: ${rt.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),St={}}if(rt.inboundLayers.length>0){const Tt=[];for(let Vt=0;Vt<rt.inboundLayers.length;Vt++){const ue=rt.inboundLayers[Vt],ye=rt.nodeIndices[Vt],qe=rt.tensorIndices[Vt],$e=up.nodeKey(ue,ye);let Xe=n[$e];Xe==null&&(Xe=0),Tt.push([ue.name,Xe,qe,St])}I.push(Tt)}}}const z={};z.name=p.name,z.className=g,z.config=x,z.inboundNodes=I,o.push(z)}t.layers=o;const u=[];for(let p=0;p<this.inputLayers.length;p++){const g=this.inputLayers[p],x=this.inputLayersNodeIndices[p],I=up.nodeKey(g,x);if(!this.containerNodes.has(I))continue;let z=n[I];z==null&&(z=0);const V=this.inputLayersTensorIndices[p];u.push([g.name,z,V])}t.inputLayers=u;const h=[];for(let p=0;p<this.outputLayers.length;p++){const g=this.outputLayers[p],x=this.outputLayersNodeIndices[p],I=up.nodeKey(g,x);if(!this.containerNodes.has(I))continue;let z=n[I];z==null&&(z=0);const V=this.outputLayersTensorIndices[p];h.push([g.name,z,V])}return t.outputLayers=h,t}static fromConfig(t,n,o={},u=!1){const h={},p={};function g(Vt,ue){Vt.name in p?p[Vt.name].push(ue):p[Vt.name]=[ue]}function x(Vt,ue){const ye=[];let qe;for(const $e of ue){const Xe=$e[0],Pn=$e[1],In=$e[2];if(qe=$e[3]==null?{}:$e[3],!(Xe in h)){g(Vt,ue);return}const gr=h[Xe];if(gr.inboundNodes.length<=Pn){g(Vt,ue);return}const Br=gr.inboundNodes[Pn];ye.push(Br.outputTensors[In])}ye.length>0&&Vt.apply(Fh(ye),qe)}function I(Vt){const ue=Vt.name,ye=$n(Vt,n.customObjects!=null?n.customObjects:{});ye.setFastWeightInitDuringBuild(u),h[ue]=ye,Vt.inboundNodes.forEach($e=>{if(!($e instanceof Array))throw new Yr(`Corrupted configuration, expected array for nodeData: ${$e}`);g(ye,$e)})}const z=n.name,V=n.layers;for(const Vt of V)I(Vt);for(;!Bb(p);)for(const Vt of V){const ue=h[Vt.name];if(ue.name in p){const ye=p[ue.name];delete p[ue.name];for(const qe of ye)x(ue,qe)}}const rt=[],Et=[],St=n.inputLayers;for(const Vt of St){const ue=Vt[0],ye=Vt[1],qe=Vt[2];_d(ue in h);const Xe=h[ue].inboundNodes[ye].outputTensors;rt.push(Xe[qe])}const Tt=n.outputLayers;for(const Vt of Tt){const ue=Vt[0],ye=Vt[1],qe=Vt[2];_d(ue in h);const Xe=h[ue].inboundNodes[ye].outputTensors;Et.push(Xe[qe])}return new t({inputs:rt,outputs:Et,name:z})}get stateful(){if(this._stateful)throw new Yr("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){zn(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ax(r,t,n){const o=t.length;if(r==null||Array.isArray(r)&&r.length===0)return t.map(u=>null);if(o===1)return Array.isArray(r)&&r.length===1?r:typeof r=="object"&&t[0]in r?[r[t[0]]]:[r];if(Array.isArray(r)){if(r.length!==o)throw new Error(`Provided ${n} is an array of ${r.length} element(s), but the model has ${o} outputs. Make sure a set of weights is provided for each model output.`);return r}else if(typeof r=="object"&&Object.keys(r).length>0&&typeof r[Object.keys(r)[0]]=="object"){const u=[];return t.forEach(h=>{h in r?u.push(r[h]):u.push(null)}),u}else throw new Error(`The model has multiple (${o}) outputs, so ${n} must be either an array with ${o} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(r)}`)}function QA(r,t){return ax(r,t,"classWeight")}function Z9(r,t){return ax(r,t,"sampleWeight")}function JA(r,t,n,o){return Wr(this,null,function*(){if(t!=null||o!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const u=zn(()=>{if(r.shape.length===1)return r.clone();if(r.shape.length===2)if(r.shape[1]>1){const g=1;return r.argMax(g)}else{if(r.shape[1]===1)return r.reshape([r.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${r.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${r.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),h=Array.from(yield u.data());N(u);const p=[];return h.forEach(g=>{if(n[g]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${g} exists in the data but not in classWeight`);p.push(n[g])}),Ff(p,"float32")}else return null})}function UD(r,t){return Xn(r,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const WD=32;function tM(r,t){let n,o;const u=t;n=u.xs,o=u.ys,yt(n!=null&&o!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const h=eM("input",r.inputNames,n),p=eM("output",r.outputNames,o),g=h[0].shape[0];yt(h.length===r.inputs.length,()=>`LayersModel has ${r.inputs.length} inputs, but the dataset provides ${h.length} inputs.  (Expected input keys: ${JSON.stringify(r.inputNames)})`),yt(p.length===r.outputs.length,()=>`LayersModel has ${r.outputs.length} outputs, but the dataset provides ${p.length} outputs.  (Expected output keys: ${JSON.stringify(r.outputNames)})`);for(let x=0;x<h.length;x++)yt(h[x].shape[0]===g,()=>`Batch size mismatch: input ${r.inputNames[x]} has ${h[x].shape[0]}; expected  ${g} based on input ${r.inputNames[0]}.`);for(let x=0;x<p.length;x++)yt(p[x].shape[0]===g,()=>`Batch size mismatch: output ${r.outputNames[x]} has ${p[x].shape[0]}; expected  ${g} based on input ${r.inputNames[0]}.`);return{xs:h,ys:p}}function eM(r,t,n){if(n instanceof Dn)return[n];if(Array.isArray(n))return yt(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${r} keys ${t}.`),n;{const o=[];for(const u of t){if(n[u]==null)throw new Yr(`The feature data generated by the dataset lacks the required ${r} key '${u}'.`);o.push(n[u])}return o}}function VD(r){if(r.length===3)throw new Fs("Validation with sample weights is not implemented yet.");return{xs:r[0],ys:r[1]}}function jD(r,t,n){return Wr(this,null,function*(){const o=n.batchesPerEpoch!=null;if(yt(r.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),yt(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),yt(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),yt(!o||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),yt(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0;try{const u=n.validationData!=null;let h,p;if(u)if(nM(n.validationData))yt(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const Vt=VD(n.validationData);h=Vt.xs,p=Vt.ys}const g=r.makeTrainFunction(),x=r.getDedupedMetricsNames();let I;u?I=x.slice().concat(x.map(Vt=>"val_"+Vt)):I=x.slice();const z=je(n.callbacks,n.yieldEvery),V=n.verbose==null?1:n.verbose,{callbackList:rt,history:Et}=mn(z,V,n.epochs,null,null,HD(t,n),null,u,I);rt.setModel(r),r.history=Et,yield rt.onTrainBegin(),r.stopTraining_=!1;let St=n.initialEpoch==null?0:n.initialEpoch,Tt=yield t.iterator();for(;St<n.epochs;){const Vt={};yield rt.onEpochBegin(St);let ue=0,ye=0;for(o||(Tt=yield t.iterator());o?ue<n.batchesPerEpoch:!0;){const qe=yield Tt.next();if(o&&qe.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${ue} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(qe.value!=null){const{xs:$e,ys:Xe}=tM(r,qe.value),Pn={};Pn.batch=ye,Pn.size=$e[0].shape[0],yield rt.onBatchBegin(ye,Pn);const In=[];if(n.classWeight!=null){const Kr=QA(n.classWeight,r.outputNames);for(let Na=0;Na<Kr.length;++Na)In.push(yield JA(Xe[Na],null,Kr[Na]))}const gr=$e.concat(Xe).concat(In),Br=g(gr);N(gr);for(let Kr=0;Kr<x.length;++Kr){const Na=x[Kr],Ya=Br[Kr];Pn[Na]=Ya,q(Ya)}yield rt.onBatchEnd(ye,Pn),et(Pn),ye++,ue++}if(o?ue>=n.batchesPerEpoch:qe.done){if(u){let $e;nM(n.validationData)?$e=Xl(yield r.evaluateDataset(n.validationData,{batches:n.validationBatches})):$e=Xl(r.evaluate(h,p,{batchSize:n.validationBatchSize==null?WD:n.validationBatchSize,verbose:0}));for(let Xe=0;Xe<r.metricsNames.length;++Xe)Vt[`val_${r.metricsNames[Xe]}`]=$e[Xe]}break}if(r.stopTraining_)break}if(yield rt.onEpochEnd(St,Vt),St++,r.stopTraining_)break}return yield rt.onTrainEnd(),yield r.history.syncData(),r.history}finally{r.isTraining=!1}})}function HD(r,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(r.size)&&(n=r.size),n}function nM(r){return typeof r.iterator=="function"}function XD(r){return typeof r.next=="function"}function YD(r,t,n){return Wr(this,null,function*(){n=n||{};const o=n.batches!=null,u=r.testFunction;let h=[];if(n.verbose>0)throw new Fs("Verbose mode is not implemented yet.");yt(!o||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const p=XD(t)?t:yield t.iterator();let g=0,x=0;for(;o?x<n.batches:!0;){const I=yield p.next();if(h=zn(()=>{if(I.value){const{xs:z,ys:V}=tM(r,I.value),rt=z.concat(V),Et=zn(()=>u(rt));if(N(rt),x===0)for(let Tt=0;Tt<Et.length;++Tt)h.push(zi(0));const St=rt[0].shape[0];for(let Tt=0;Tt<Et.length;++Tt){const Vt=Et[Tt],ue=h[Tt];h[Tt]=zn(()=>An(h[Tt],Xn(St,Vt))),x>0&&N(ue)}N(Et),g+=St,++x}return h}),I.done){o&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let I=0;I<h.length;++I){const z=h[I];h[I]=rr(h[I],g),N(z)}return Fh(h)})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function AI(r){yt(r>0&&Number.isInteger(r),()=>`batchSize is required to be a positive integer, but got ${r}`)}function ix(r,t,n){return r==null?[null]:Array.isArray(r)?r.map(o=>yg(o,t,n-t)):yg(r,t,n-t)}function MI(r,t){return zn(()=>r==null?null:Array.isArray(r)?r.map(n=>MI(n,t)):gv(r,t.dtype==="int32"?t:t.toInt()))}function NI(r,t){const n=[];let o=0,u=null;for(;o<r;)u=o+t,u>=r&&(u=r),n.push([o,u]),o=u;return n}function KD(r,t,n,o,u,h,p,g,x,I,z,V,rt,Et,St){return Wr(this,null,function*(){u==null&&(u=32),h==null&&(h=1),z==null&&(z=!0),rt==null&&(rt=0);let Tt=!1;if(x!=null&&I!=null&&(Tt=!0),St!=null&&(Tt=!0,Et==null))throw new Yr("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const Vt=r.checkNumSamples(n,u,Et,"steps_per_epoch");let ue;Vt!=null&&(ue=zh(0,Vt)),p==null&&(p=1);const{callbackList:ye,history:qe}=mn(g,p,h,rt,Vt,Et,u,Tt,V);ye.setModel(r),r.history=qe,yield ye.onTrainBegin(),r.stopTraining_=!1;for(let $e=rt;$e<h;++$e){yield ye.onEpochBegin($e);const Xe={};if(Et!=null)throw new Fs("stepsPerEpoch mode is not implemented yet.");{if(z==="batch")throw new Fs("batch shuffling is not implemneted yet");z&&Ge(ue);const Pn=Ff(ue),In=NI(Vt,u);for(let gr=0;gr<In.length;++gr){const Br={};if(yield ye.onBatchBegin(gr,Br),zn(()=>{const Kr=In[gr][0],Na=In[gr][1],Ya=yg(Pn,Kr,Na-Kr);Br.batch=gr,Br.size=Na-Kr;const Ha=MI(n,Ya),ni=t(Ha);for(let Wa=0;Wa<o.length;++Wa){const za=o[Wa],mi=ni[Wa];Br[za]=mi,q(mi)}if(gr===In.length-1&&Tt){const Wa=r.testLoop(x,I,u);for(let za=0;za<o.length;++za){const mi=o[za],qa=Wa[za];q(qa),Xe["val_"+mi]=qa}}}),yield ye.onBatchEnd(gr,Br),et(Br),r.stopTraining_)break}Pn.dispose()}if(yield ye.onEpochEnd($e,Xe),r.stopTraining_)break}return yield ye.onTrainEnd(),yield r.history.syncData(),r.history})}function ZD(u,h,p){return Wr(this,arguments,function*(r,t,n,o={}){if(r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0;let g,x,I,z,V,rt,Et;try{const St=o.batchSize==null?32:o.batchSize;AI(St);const Tt=!1,Vt=yield r.standardizeUserData(t,n,o.sampleWeight,o.classWeight,Tt,St);g=Vt[0],x=Vt[1],Et=Vt[2];let ue=!1,ye;if(o.validationData!=null&&o.validationData.length>0){if(ue=!0,o.validationData.length===2)I=o.validationData[0],z=o.validationData[1];else throw o.validationData.length===3?new Fs("validationData including sample weights is not supported yet."):new Yr(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${o.validationData} is invalid.`);const Kr=!0,Na=yield r.standardizeUserData(I,z,null,null,Kr,St);V=Na[0],rt=Na[1],ye=V.concat(rt)}else if(o.validationSplit!=null&&o.validationSplit>0&&o.validationSplit<1){ue=!0;const Kr=Math.floor(g[0].shape[0]*(1-o.validationSplit)),Na=g[0].shape[0];V=ix(g,Kr,Na),g=ix(g,0,Kr),rt=ix(x,Kr,Na),x=ix(x,0,Kr),ye=V.concat(rt)}else o.validationSteps!=null&&(ue=!0);const qe=g.concat(x).concat(Et);r.checkTrainableWeightsConsistency();const $e=r.makeTrainFunction(),Xe=r.getDedupedMetricsNames();let Pn,In;ue?(r.makeTestFunction(),Pn=r.testFunction,In=Xe.slice().concat(Xe.map(Kr=>"val_"+Kr))):(Pn=null,ye=[],In=Xe.slice());const gr=je(o.callbacks,o.yieldEvery);return yield KD(r,$e,qe,Xe,St,o.epochs,o.verbose,gr,Pn,ye,o.shuffle,In,o.initialEpoch,null,null)}finally{r.isTraining=!1,B0(g,t),B0(x,n),B0(V,I),B0(rt,z),Et!=null&&N(Et)}})}function rM(r){const t=[];r instanceof Dn&&(r=[r]);for(let n=0;n<r.length;++n){const o=r[n];if(o.rank===1)t.push(O0(o,1));else{if(o.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(o)}}return t}function B0(r,t){if(r==null)return;const n=[];if(t instanceof Dn)n.push(t.id);else if(Array.isArray(t))t.forEach(u=>n.push(u.id));else if(t!=null)for(const u in t){const h=t[u];n.push(h.id)}const o=[];if(r instanceof Dn)n.indexOf(r.id)===-1&&o.push(r);else if(Array.isArray(r))r.forEach(u=>{n.indexOf(u.id)===-1&&o.push(u)});else if(r!=null)for(const u in r){const h=r[u];n.indexOf(h.id)===-1&&o.push(h)}o.forEach(u=>{u.isDisposed||u.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qD(r){return r instanceof Dn}function kI(r){return Array.isArray(r)}function aM(r){return!qD(r)&&!kI(r)}function iM(r,t,n,o=!0,u=""){if(t==null||t.length===0){if(r!=null){let p=!1;if(kI(r)&&r.length>0)p=!0;else if(aM(r)){for(const g in r)if(r.hasOwnProperty(g)){p=!0;break}}else p=!0;if(p)throw new Yr(`Error when checking model ${u} expected no data, but got ${r}`)}return[]}if(r==null)return t.map(p=>null);let h;if(aM(r)){r=r,h=[];for(const p of t){if(r[p]==null)throw new Yr(`No data provided for "${p}". Need data for each key in: ${t}`);h.push(r[p])}}else if(kI(r)){if(r=r,r.length!==t.length)throw new Yr(`Error when checking model ${u}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${r}`);h=r}else{if(r=r,t.length>1)throw new Yr(`The model ${u} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${r.shape}`);h=[r]}if(h=rM(h),n!=null)for(let p=0;p<t.length;++p){if(n[p]==null)continue;const g=h[p];if(g.shape.length!==n[p].length)throw new Yr(`Error when checking ${u}: expected ${t[p]} to have ${n[p].length} dimension(s). but got array with shape ${g.shape}`);for(let x=0;x<n[p].length;++x){if(x===0&&!o)continue;const I=g.shape[x],z=n[p][x];if(z!=null&&z>=0&&I!==z)throw new Yr(`Error when checking ${u}: expected ${t[p]} to have shape [${n[p]}], but got array with shape [${g.shape}].`)}}return h}function QD(r,t,n){const o=gg(r.map(h=>h.shape[0]));o.sort();const u=gg(t.map(h=>h.shape[0]));if(u.sort(),o.length>1)throw new Yr(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(r.map(h=>h.shape))}`);if(u.length>1)throw new Yr(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(h=>h.shape))}`);if(o.length>0&&u.length>0&&!Un(o,u))throw new Yr(`Input Tensors should have the same number of samples as target Tensors. Found ${o[0]} input sample(s) and ${u[0]} target sample(s).`)}function JD(r,t,n){const o=[or,hi,xa];for(let u=0;u<r.length;++u){const h=r[u],p=t[u],g=n[u];if(p!=null){if(p===xa&&h.shape[h.shape.length-1]===1)throw new Yr(`You are passing a target array of shape ${h.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(o.indexOf(p)!==-1){const x=h.shape.slice(1),I=g.slice(1);for(let z=0;z<x.length;++z){const V=x[z],rt=I[z];if(rt!=null&&V!==rt)throw new Yr(`A target Tensor with shape ${h.shape} was passed for an output of shape ${g}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function oM(r,t,n,o=!0,u=""){let h;if(Array.isArray(r)){if(r.length!==t.length)throw new Yr(`Error when checking model ${u}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${r.length} Tensors(s).`);h=r}else{if(t.length>1)throw new Yr(`The model expects ${t.length} ${u} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(r.shape)}.`);h=[r]}if(n!=null)for(let p=0;p<t.length;++p){if(n[p]==null)continue;const g=h[p];if(g.shape.length!==n[p].length)throw new Yr(`Error when checking ${u}: expected ${t[p]} to have ${n[p].length} dimension(s), but got array with shape ${JSON.stringify(g.shape)}`);for(let x=0;x<n[p].length;++x){if(x===0&&!o)continue;const I=g.shape[x],z=n[p][x];if(z!=null&&z!==I)throw new Yr(`Error when checking ${u}: expected ${t[p]} to have shape ${JSON.stringify(n[p])} but got array with shape ${JSON.stringify(g.shape)}.`)}}}function tO(r,t){if(r==null||Array.isArray(r)&&r.length===0)return t.map(o=>[]);let n;if(typeof r=="string"||typeof r=="function")n=[r];else if(Array.isArray(r)||typeof r=="object")n=r;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${r}`);if(Array.isArray(n))return t.map(o=>n);{const o=[];for(const u of t){let h=n.hasOwnProperty(u)?n[u]:[];Array.isArray(h)||(h=[h]),o.push(h)}return o}}const eO="layers-model";class Jg extends up{constructor(t){super(t);this.isTraining=!1}summary(t,n,o=console.log){if(!this.built)throw new Yr("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");CI(this,t,n,o)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=Rp(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof ul))throw new Yr("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const p in t.loss)if(this.outputNames.indexOf(p)===-1)throw new Yr(`Unknown entry in loss dictionary: "${p}". Only expected the following keys: ${this.outputNames}`);for(const p of this.outputNames)t.loss[p]==null&&console.warn(`Output "${p}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${p} during training`),n.push(Gh(t.loss[p]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new Yr(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);n=t.loss.map(g=>Gh(g))}else{const p=Gh(t.loss);this.outputs.forEach(g=>{n.push(p)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let p=0;p<this.outputs.length;++p){const g=this.internalOutputShapes[p],x=this.outputNames[p];this.feedOutputNames.push(x),this.feedOutputShapes.push(g),this.feedLossFns.push(this.lossFunctions[p])}const o=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],dv("loss",()=>{for(let p=0;p<this.outputs.length;++p){if(o.indexOf(p)!==-1)continue;const g=this.lossFunctions[p];this.outputs.length>1&&(this.metricsTensors.push([g,p]),this.metricsNames.push(this.outputNames[p]+"_loss"))}});const u=tO(t.metrics,this.outputNames),h=(p,g,x)=>{this.outputNames.length>1&&(g=this.outputNames[p]+"_"+g),this.metricsNames.push(g),this.metricsTensors.push([x,p])};dv("metric",()=>{for(let p=0;p<this.outputs.length;++p){if(o.indexOf(p)!==-1)continue;const g=u[p];(I=>{const z="";let V,rt,Et;for(const St of I){if(typeof St=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(St)!==-1){const Vt=this.internalOutputShapes[p];Vt[Vt.length-1]===1||this.lossFunctions[p]===hi?["accuracy","acc"].indexOf(St)!==-1?rt=Sf:["crossentropy","ce"].indexOf(St)!==-1&&(rt=Fo):this.lossFunctions[p]===ja?["accuracy","acc"].indexOf(St)!==-1?rt=su:["crossentropy","ce"].indexOf(St)!==-1&&(rt=Td):["accuracy","acc"].indexOf(St)!==-1?rt=Qf:["crossentropy","ce"].indexOf(St)!==-1&&(rt=bg);let ue;["accuracy","acc"].indexOf(St)!==-1?ue="acc":["crossentropy","ce"].indexOf(St)!==-1&&(ue="ce"),Et=rt,V=z+ue}else Et=xg(St),V=z+zf(St);let Tt;dv(V,()=>{Tt=Et}),h(p,V,Tt)}})(g)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,n,o={}){const u=o.batchSize==null?32:o.batchSize;AI(u);const h=!0,p=this.standardizeUserDataXY(t,n,h,u);try{const g=p[0].concat(p[1]);this.makeTestFunction();const x=this.testFunction,I=this.testLoop(x,g,u,o.verbose,o.steps);return Fh(I)}finally{B0(p[0],t),B0(p[1],n)}}evaluateDataset(t,n){return Wr(this,null,function*(){return this.makeTestFunction(),YD(this,t,n)})}checkNumSamples(t,n,o,u="steps"){let h;if(o!=null){if(h=null,n!=null)throw new Yr(`If ${u} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(t!=null)Array.isArray(t)?h=t[0].shape[0]:h=t.shape[0];else throw new Yr(`Either the input data should have a defined shape, or ${u} shoud be specified.`);return h}execute(t,n){if(Array.isArray(n)&&n.length===0)throw new Yr("`outputs` is an empty Array, which is not allowed.");const o=Array.isArray(n),u=o?n:[n],h=this.retrieveSymbolicTensors(u),p=new hf;if(t instanceof Dn&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new Yr(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let x=0;x<this.inputs.length;++x)p.add(this.inputs[x],t[x])}else for(const x of this.inputs){const I=t[x.name];if(I==null)throw new Yr(`No value is provided for the model's input ${x.name}`);p.add(x,I)}const g=Fp(h,p);return o?g:g[0]}retrieveSymbolicTensors(t){const n=Wg(null,t.length);let o=t.length;for(const u of this.layers){const h=Array.isArray(u.output)?u.output:[u.output],p=h.map(g=>g.name);for(let g=0;g<t.length;++g){const x=p.indexOf(t[g]);if(x!==-1&&(n[g]=h[x],o--),o===0)break}if(o===0)break}if(o>0){const u=[];throw n.forEach((h,p)=>{h==null&&u.push(t[p])}),new Yr(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(u)}`)}return n}predictLoop(t,n=32,o=!1){return zn(()=>{const u=this.checkNumSamples(t);if(o)throw new Fs("Verbose predictLoop() is not implemented yet.");const h=NI(u,n),p=this.outputs.map(g=>[]);for(let g=0;g<h.length;++g)zn(()=>{const I=h[g][0],z=h[g][1],V=ix(t,I,z),rt=[];if(Array.isArray(V))for(let St=0;St<V.length;++St)rt.push({key:this.inputs[St],value:V[St]});else rt.push({key:this.inputs[0],value:V});const Et=new hf(rt);return Fp(this.outputs,Et)}).forEach((I,z)=>p[z].push(I));return Fh(p.map(g=>_t(g,0)))})}predict(t,n={}){const o=rM(t);oM(o,this.inputNames,this.feedInputShapes,!1);try{const u=n.batchSize==null?32:n.batchSize;return AI(u),this.predictLoop(o,u)}finally{B0(o,t)}}predictOnBatch(t){oM(t,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,n)}standardizeUserDataXY(t,n,o=!0,u){if(this.optimizer_==null)throw new ip("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const h=[];for(let p=0;p<this.feedOutputShapes.length;++p){const g=this.feedOutputShapes[p];this.feedLossFns[p]===ja?h.push(g.slice(0,g.length-1).concat([1])):h.push(g)}if(t=iM(t,this.feedInputNames,this.feedInputShapes,!1,"input"),n=iM(n,this.feedOutputNames,h,!1,"target"),QD(t,n,null),JD(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&u!=null&&u>0&&t[0].shape[0]%u!=0)throw new Yr(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${u}. Found: ${t[0].shape[0]} sample(s).`);return[t,n]}standardizeUserData(t,n,o,u,h=!0,p){return Wr(this,null,function*(){const[g,x]=this.standardizeUserDataXY(t,n,h,p);if(o!=null)throw new Error("sample weight is not supported yet.");let I=null;if(u!=null){const z=QA(u,this.outputNames);I=[];for(let V=0;V<z.length;++V)I.push(yield JA(x[V],null,z[V]))}return[g,x,I]})}testLoop(t,n,o,u=0,h){return zn(()=>{const p=this.checkNumSamples(n,o,h,"steps"),g=[];if(u>0)throw new Fs("Verbose mode is not implemented yet.");if(h!=null)throw new Fs("steps mode in testLoop() is not implemented yet");{const x=NI(p,o),I=Ff(zh(0,p));for(let z=0;z<x.length;++z){const V=x[z][0],rt=x[z][1],Et=yg(I,V,rt-V),St=MI(n,Et),Tt=t(St);if(z===0)for(let Vt=0;Vt<Tt.length;++Vt)g.push(zi(0));for(let Vt=0;Vt<Tt.length;++Vt){const ue=Tt[Vt];g[Vt]=An(g[Vt],Xn(rt-V,ue))}}for(let z=0;z<g.length;++z)g[z]=rr(g[z],p)}return g})}getDedupedMetricsNames(){const t=this.metricsNames,n=[];for(let o=0;o<t.length;++o){const u=t[o];let h=u;lE(t,u)>1&&(h+=`_${lE(t.slice(0,o),u)}`),n.push(h)}return n}makeTrainFunction(){return t=>{const n=[],o=t.slice(0,this.inputs.length),u=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),h=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),p=[],g=()=>{const V=[];for(let Tt=0;Tt<this.inputs.length;++Tt)V.push({key:this.inputs[Tt],value:o[Tt]});const rt=new hf(V),Et=Fp(this.outputs,rt,{training:!0});let St;for(let Tt=0;Tt<this.lossFunctions.length;++Tt){let ue=this.lossFunctions[Tt](u[Tt],Et[Tt]);h[Tt]!=null&&(ue=UD(ue,h[Tt]));const ye=cc(ue);n.push(ye),Tt===0?St=ue:St=An(St,ue)}for(let Tt=0;Tt<this.metricsTensors.length;++Tt){let Vt;if(this.outputs.length>1&&Tt<this.outputs.length)Vt=n[Tt];else{const ue=this.metricsTensors[Tt][0],ye=this.metricsTensors[Tt][1];Vt=cc(ue(u[ye],Et[ye]))}q(Vt),p.push(Vt)}return St=cc(St),this.calculateLosses().forEach(Tt=>{St=An(St,Tt)}),St},x=this.collectedTrainableWeights.map(V=>V.read()),I=!0;return[this.optimizer_.minimize(g,I,x)].concat(p)}}makeTestFunction(){this.testFunction=t=>zn(()=>{const n=[];let o;const u=t.slice(0,this.inputs.length),h=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),p=[];for(let I=0;I<this.inputs.length;++I)p.push({key:this.inputs[I],value:u[I]});const g=new hf(p),x=Fp(this.outputs,g);for(let I=0;I<this.lossFunctions.length;++I){const z=this.lossFunctions[I],V=cc(z(h[I],x[I]));I===0?o=V:o=An(o,V),n.push(o)}for(let I=0;I<this.metricsTensors.length;++I){const z=this.metricsTensors[I][0],V=this.metricsTensors[I][1],rt=cc(z(h[V],x[V]));n.push(rt)}return n})}fit(u,h){return Wr(this,arguments,function*(t,n,o={}){return ZD(this,t,n,o)})}fitDataset(t,n){return Wr(this,null,function*(){return jD(this,t,n)})}trainOnBatch(t,n){return Wr(this,null,function*(){const o=yield this.standardizeUserData(t,n),u=o[0],h=o[1],g=this.makeTrainFunction()(u.concat(h)),x=[];for(const I of g){const z=yield I.data();x.push(z[0])}return N(g),Fh(x)})}getNamedWeights(t){const n=[],o=t!=null&&t.trainableOnly,u=o?this.trainableWeights:this.weights,h=this.getWeights(o);for(let p=0;p<u.length;++p)o&&!u[p].trainable||n.push({name:u[p].originalName,tensor:h[p]});return n}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=Qa().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=n-Qa().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=qv(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(n=>qv(n))}else{const n=Object.keys(this.loss);t={};const o=this.loss;for(const u of n)if(typeof o[u]=="string")t[u]=qv(o[u]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[qv(zf(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>qv(zf(t)));{const t={};for(const n in this.metrics)t[n]=qv(zf(this.metrics[n]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=wg(t.optimizer_config),o=$n(n);let u;if(typeof t.loss=="string")u=Vg(t.loss);else if(Array.isArray(t.loss))u=t.loss.map(p=>Vg(p));else if(t.loss!=null){u={};for(const p in t.loss)u[p]=Vg(t.loss[p])}let h;if(Array.isArray(t.metrics))h=t.metrics.map(p=>Vg(p));else if(t.metrics!=null){h={};for(const p in t.metrics)h[p]=Vg(t.metrics[p])}this.compile({loss:u,metrics:h,optimizer:o})}save(t,n){return Wr(this,null,function*(){if(typeof t=="string"){const I=Xh(t);if(I.length===0)throw new Yr(`Cannot find any save handlers for URL '${t}'`);if(I.length>1)throw new Yr(`Found more than one (${I.length}) save handlers for URL '${t}'`);t=I[0]}if(t.save==null)throw new Yr("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const o=yield Rl(this.getNamedWeights(n)),u=!1,h=null,g={modelTopology:this.toJSON(h,u),format:eO,generatedBy:`TensorFlow.js tfjs-layers v${Qg}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){g.trainingConfig=this.getTrainingConfig();const I="optimizer",{data:z,specs:V}=yield Rl(yield this.optimizer.getWeights(),I);o.specs.push(...V),o.data=vf([o.data,z])}if(this.userDefinedMetadata!=null){const I=!0;ex(this.userDefinedMetadata,this.name,I),g.userDefinedMetadata=this.userDefinedMetadata}return g.weightData=o.data,g.weightSpecs=o.specs,t.save(g)})}setUserDefinedMetadata(t){ex(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}Jg.className="Model",ci(Jg);class sM extends Jg{}sM.className="Functional",ci(sM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nO(r,t){return Wr(this,null,function*(){"modelTopology"in r||(r={modelTopology:r}),r=r;let n=r.modelTopology;n.model_config!=null&&(n=n.model_config);const o=wg(n),u=$n(o,t);if(r.weightsManifest!=null){const h=yield Vd(r.weightsManifest,r.pathPrefix,u.weights.map(g=>g.originalName)),p={};for(const g of u.weights)p[g.originalName]=h[g.originalName];u.loadWeights(p),N(h)}return u})}function rO(r,t){return Wr(this,null,function*(){if(t==null&&(t={}),typeof r=="string"){const n=Fd(r,t);if(n.length===0)n.push(Mh(r,t));else if(n.length>1)throw new Yr(`Found more than one (${n.length}) load handlers for URL '${r}'`);r=n[0]}return aO(r,void 0,t)})}function aO(r,t,n){return Wr(this,null,function*(){if(n==null&&(n={}),r.load==null)throw new Yr("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const o=yield r.load();let u=o.modelTopology;u.model_config!=null&&(u=u.model_config);const h=n.strict==null?!0:n.strict,p=o.weightData!=null&&o.weightSpecs!=null&&h,g=$n(wg(u),t,p),x=o.trainingConfig;if(x!=null&&g.loadTrainingConfig(x),o.userDefinedMetadata!=null&&g.setUserDefinedMetadata(o.userDefinedMetadata),o.weightData!=null){if(o.weightSpecs==null)throw new Yr("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:I,optimizerWeights:z}=iO(o.weightData,o.weightSpecs);g.loadWeights(I,h),g.optimizer!=null&&z.length>0&&(yield g.optimizer.setWeights(z)),N(I),N(z.map(V=>V.tensor))}return g})}function iO(r,t){const n=yh(r,t),o={},u=[];return t.forEach(h=>{h.group==="optimizer"?u.push({name:h.name,tensor:n[h.name]}):o[h.name]=n[h.name]}),{modelWeights:o,optimizerWeights:u}}class z0 extends Jg{constructor(t){super({inputs:[],outputs:[]});if(t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:a1("sequential_"),t.layers!=null)for(const n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(o=>o<0))throw new Yr(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const n=t instanceof z0||t instanceof Jg;let o;if(n){if(o=t,o.outputs.length!==1)throw new Yr("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(o.inputs.length!==1)throw new Yr("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new Yr("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const u=G({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(u)}if(n)this.outputs=o.outputs,this.inputs=o.inputs;else{if(t.inboundNodes.length!==1)throw new Yr(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new Yr("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=E(this.outputs[0])}this.inboundNodes=[],new l({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Wg(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(u=>u.shape),outputShapes:this.outputs[0].shape})}else{const u=t.apply(this.outputs[0]);if(Array.isArray(u))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[u],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if($l(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Jg({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,o=console.log){this.built||this.build(),super.summary(t,n,o)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,o={}){if(!this.built)throw new ip("The model needs to be compiled before being used.");return this.model.evaluate(t,n,o)}evaluateDataset(t,n){return Wr(this,null,function*(){if(!this.built)throw new ip("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)})}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}fit(u,h){return Wr(this,arguments,function*(t,n,o={}){if(!this.built)throw new ip("The model needs to be compiled before being used.");return this.model.fit(t,n,o)})}fitDataset(t,n){return Wr(this,null,function*(){if(!this.built)throw new ip("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)})}trainOnBatch(t,n){return Wr(this,null,function*(){return this.model.trainOnBatch(t,n)})}static fromConfig(t,n,o={},u=!1){let h,p={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new Yr("Legacy serialization format not supported yet.");h=n}else yt(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),h=n.layers,delete n.layers,p=n;const g=new t(p);if(!(g instanceof z0))throw new Fs(`Sequential.fromConfig called on non-Sequential input: ${g}`);for(const x of h){const z=$n(x,void 0,u);u&&z.setFastWeightInitDuringBuild(!0),g.add(z)}return g}set stopTraining(t){if(this.model==null)throw new Yr("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new Yr("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const n of this.layers){const o={};o.className=n.getClassName(),o.config=n.getConfig(),t.push(o)}return{name:this.name,layers:t}}}z0.className="Sequential",ci(z0);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oO(r){return new Jg(r)}function sO(r){return new z0(r)}function uO(r,t){return t==null&&(t={}),rO(r,t)}function uM(r){return G(r)}function lO(r,t){ze.registerCallbackConstructor(r,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lp extends Dh{getConfig(){return{}}}class lM extends lp{apply(t,n=1){return wE(t,n)}}lM.className="elu",ci(lM);class cM extends lp{apply(t){return o0(t)}}cM.className="selu",ci(cM);class fM extends lp{apply(t){return td(t)}}fM.className="relu",ci(fM);class hM extends lp{apply(t){return zn(()=>cg(6,td(t)))}}hM.className="relu6",ci(hM);class dM extends lp{apply(t){return t}}dM.className="linear",ci(dM);class pM extends lp{apply(t){return qt(t)}}pM.className="sigmoid",ci(pM);class vM extends lp{apply(t){return sI(t)}}vM.className="hardSigmoid",ci(vM);class gM extends lp{apply(t){return gm(t)}}gM.className="softplus",ci(gM);class mM extends lp{apply(t){return Xb(t)}}mM.className="softsign",ci(mM);class yM extends lp{apply(t){return Ce(t)}}yM.className="tanh",ci(yM);class DI extends lp{apply(t,n=-1){return u0(t,n)}}DI.className="softmax",ci(DI);class bM extends lp{apply(t,n=-1){return ty(t,n)}}bM.className="logSoftmax",ci(bM);class xM extends lp{apply(t,n=1){return zn(()=>qt(t.mul(n)).mul(t))}}xM.className="swish",ci(xM);function Om(r){return r.getClassName()}function OI(r,t={}){return k0(r,lf.getMap().classNameMap,t,"activation")}function Rm(r){if(r==null){const t={};return t.className="linear",t.config={},OI(t)}if(typeof r=="string"){const t={};return t.className=r,t.config={},OI(t)}else return r instanceof lp?r:OI(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function RI(r){if(r!=null&&typeof r!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${r}`)}class wM extends Dh{}class ox extends wM{constructor(t){super();RI(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return zn(()=>{let n=Tc([1]);return this.hasL1&&(n=An(n,ss(Xn(this.l1,bl(t))))),this.hasL2&&(n=An(n,ss(Xn(this.l2,R0(t))))),n.asScalar()})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,n){return new t({l1:n.l1,l2:n.l2})}}ox.className="L1L2",ci(ox);function cO(r){return RI(r),new ox({l1:r!=null?r.l1:null,l2:0})}function fO(r){return RI(r),new ox({l2:r!=null?r.l2:null,l1:0})}const EM={l1l2:"L1L2"};function rc(r){return Pb(r)}function SM(r,t={}){return k0(r,lf.getMap().classNameMap,t,"regularizer")}function Mc(r){if(r==null)return null;if(typeof r=="string"){const n={className:r in EM?EM[r]:r,config:{}};return SM(n)}else return r instanceof wM?r:SM(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class LI extends d{constructor(t){super(t==null?{}:t);this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,n){t=vu(t);let o=td(t);return this.maxValue!=null&&(o=li(o,0,this.maxValue)),o}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},n=super.getConfig();return Object.assign(t,n),t}}LI.className="ReLU",ci(LI);class PI extends d{constructor(t){super(t==null?{}:t);this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const o=vu(t);return vm(o,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}PI.className="LeakyReLU",ci(PI);class FI extends d{constructor(t){super(t==null?{}:t);if(this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=fc(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Mc(t.alphaRegularizer),this.alphaConstraint=wl(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new Yr(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=$l(t);const n=t.slice(1);if(this.sharedAxes!=null)for(const u of this.sharedAxes)n[u-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const o={};if(this.sharedAxes!=null)for(let u=1;u<t.length;++u)o[u]=t[u];this.inputSpec=[new e({ndim:t.length,axes:o})],this.built=!0}call(t,n){return t=vu(t),bm(t,this.alpha.read())}getConfig(){const t={alphaInitializer:mc(this.alphaInitializer),alphaRegularizer:rc(this.alphaRegularizer),alphaConstraint:ff(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(t,n),t}}FI.className="PReLU",ci(FI);class BI extends d{constructor(t){super(t==null?{}:t);if(this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new Fs(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const o=vu(t);return fm(o)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}BI.className="ELU",ci(BI);class zI extends d{constructor(t){super(t==null?{}:t);this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,n){const o=vu(t);return o.mul(Kg(o.greater(this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},n=super.getConfig();return Object.assign(t,n),t}}zI.className="ThresholdedReLU",ci(zI);class $I extends d{constructor(t){super(t==null?{}:t);this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new DI().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,n){const o=vu(t);return this.softmax(o,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}$I.className="Softmax",ci($I);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function u1(r,t,n){if(typeof r=="number")return Wg(r,t);if(r.length!==t)throw new Yr(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${r.length} elements.`);for(let o=0;o<t;++o){const u=r[o];if(!Wy(u))throw new Yr(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(r)} including a non-integer number ${u}`)}return r}function Qv(r,t,n,o,u=1){if(r==null)return r;const h=t+(t-1)*(u-1);let p;return n==="same"?p=r:p=r-h+1,Math.floor((p+o-1)/o)}function PE(r,t,n,o){if(r==null)return null;if(o==="valid")r=r*t+pv([n-t,0]);else if(o==="same")r=r*t;else throw new Yr(`Unsupport padding mode: ${o}.`);return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function GI(r,t){return zn(()=>(tc(t),t==="channelsFirst"?cu(r,[0,2,3,1]):r))}function CM(r,t){return zn(()=>(tc(t),t==="channelsFirst"?cu(r,[0,2,3,4,1]):r))}function _M(r,t,n,o=1,u="valid",h,p=1){return zn(()=>{if(h==null&&(h=Np()),tc(h),r.shape.length!==3)throw new Yr(`The input of a conv1dWithBias operation should be 3, but is ${r.shape.length} instead.`);if(t.shape.length!==3)throw new Yr(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new Yr(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(h==="channelsFirst"&&(r=cu(r,[0,2,1])),u==="causal")throw new Fs("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let g=Ho(r,t,o,u==="same"?"same":"valid","NWC",p);return n!=null&&(g=kp(g,n)),g})}function q9(r,t,n=1,o="valid",u,h=1){return tidy(()=>(checkDataFormat(u),_M(r,t,null,n,o,u,h)))}function Q9(r,t,n=[1,1],o="valid",u,h){return tidy(()=>(checkDataFormat(u),UI(r,t,null,n,o,u,h)))}function UI(r,t,n,o=[1,1],u="valid",h,p,g=null){return zn(()=>{if(h==null&&(h=Np()),tc(h),r.rank!==3&&r.rank!==4)throw new Yr(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${r.rank}.`);if(t.rank!==3&&t.rank!==4)throw new Yr(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${r.rank}.`);let x=GI(r,h);if(u==="causal")throw new Fs("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return x=lb({x,filter:t,strides:o,pad:u==="same"?"same":"valid",dilations:p,dataFormat:"NHWC",bias:n,activation:g}),h==="channelsFirst"&&(x=cu(x,[0,3,1,2])),x})}function J9(r,t,n=[1,1,1],o="valid",u,h){return tidy(()=>(checkDataFormat(u),IM(r,t,null,n,o,u,h)))}function IM(r,t,n,o=[1,1,1],u="valid",h,p){return zn(()=>{if(h==null&&(h=Np()),tc(h),r.rank!==4&&r.rank!==5)throw new Yr(`conv3dWithBias expects input to be of rank 4 or 5, but received ${r.rank}.`);if(t.rank!==4&&t.rank!==5)throw new Yr(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${r.rank}.`);let g=CM(r,h);if(u==="causal")throw new Fs("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return g=yl(g,t,o,u==="same"?"same":"valid","NDHWC",p),n!=null&&(g=kp(g,n)),h==="channelsFirst"&&(g=cu(g,[0,4,1,2,3])),g})}class FE extends d{constructor(t,n){super(n);if(this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",FE.verifyArgs(n),this.rank=t,cf(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Fs(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=u1(n.kernelSize,t,"kernelSize"),this.strides=u1(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,Bh(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,tc(this.dataFormat),this.activation=Rm(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=fc(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=wl(n.biasConstraint),this.biasRegularizer=Mc(n.biasRegularizer),this.activityRegularizer=Mc(n.activityRegularizer),this.dilationRate=u1(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new Yr(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new Yr(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new Yr(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(_d("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!Gy(t.kernelSize,"number",1,3))throw new Yr(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Om(this.activation),useBias:this.useBias,biasInitializer:mc(this.biasInitializer),biasRegularizer:rc(this.biasRegularizer),activityRegularizer:rc(this.activityRegularizer),biasConstraint:ff(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}class l1 extends FE{constructor(t,n){super(t,n);this.kernel=null,l1.verifyArgs(n),this.filters=n.filters,cf(this.filters,"filters"),this.kernelInitializer=fc(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=wl(n.kernelConstraint),this.kernelRegularizer=Mc(n.kernelRegularizer)}build(t){t=$l(t);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new Yr(`The channel dimension of the input should be defined. Found ${t[n]}`);const o=t[n],u=this.kernelSize.concat([o,this.filters]);this.kernel=this.addWeight("kernel",u,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:o}}],this.built=!0}call(t,n){return zn(()=>{t=vu(t);let o;const u=this.bias==null?null:this.bias.read(),h=fE(this.activation.getClassName());if(h!=null&&this.rank===2)o=UI(t,this.kernel.read(),u,this.strides,this.padding,this.dataFormat,this.dilationRate,h);else{if(this.rank===1)o=_M(t,this.kernel.read(),u,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)o=UI(t,this.kernel.read(),u,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)o=IM(t,this.kernel.read(),u,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Fs("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(o=this.activation.apply(o))}return o})}computeOutputShape(t){t=$l(t);const n=[],o=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let h=0;h<o.length;++h){const p=Qv(o[h],this.kernelSize[h],this.padding,this.strides[h],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[h]);n.push(p)}let u=[t[0]];return this.dataFormat==="channelsLast"?(u=u.concat(n),u.push(this.filters)):(u.push(this.filters),u=u.concat(n)),u}getConfig(){const t={filters:this.filters,kernelInitializer:mc(this.kernelInitializer),kernelRegularizer:rc(this.kernelRegularizer),kernelConstraint:ff(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new Yr(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class c1 extends l1{constructor(t){super(2,t);c1.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!Gy(t.kernelSize,"number",1,2))throw new Yr(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}c1.className="Conv2D",ci(c1);class sx extends l1{constructor(t){super(3,t);sx.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new Yr(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}sx.className="Conv3D",ci(sx);class WI extends c1{constructor(t){super(t);if(this.inputSpec=[new e({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new Yr(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=$l(t),t.length!==4)throw new Yr("Input should have rank 4; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new Yr("The channel dimension of the inputs should be defined. Found `None`.");const o=t[n],u=this.kernelSize.concat([this.filters,o]);this.kernel=this.addWeight("kernel",u,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new e({ndim:4,axes:{[n]:o}})],this.built=!0}call(t,n){return zn(()=>{let o=vu(t);if(o.shape.length!==4)throw new Yr(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${o.shape.length}`);const u=o.shape,h=u[0];let p,g;this.dataFormat==="channelsFirst"?(p=2,g=3):(p=1,g=2);const x=u[p],I=u[g],z=this.kernelSize[0],V=this.kernelSize[1],rt=this.strides[0],Et=this.strides[1],St=PE(x,rt,z,this.padding),Tt=PE(I,Et,V,this.padding),Vt=[h,St,Tt,this.filters];this.dataFormat!=="channelsLast"&&(o=cu(o,[0,2,3,1]));let ue=_u(o,this.kernel.read(),Vt,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(ue=cu(ue,[0,3,1,2])),this.bias!=null&&(ue=kp(ue,this.bias.read(),this.dataFormat)),this.activation!=null&&(ue=this.activation.apply(ue)),ue})}computeOutputShape(t){t=$l(t);const n=t.slice();let o,u,h;this.dataFormat==="channelsFirst"?(o=1,u=2,h=3):(o=3,u=1,h=2);const p=this.kernelSize[0],g=this.kernelSize[1],x=this.strides[0],I=this.strides[1];return n[o]=this.filters,n[u]=PE(n[u],x,p,this.padding),n[h]=PE(n[h],I,g,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}WI.className="Conv2DTranspose",ci(WI);class TM extends l1{constructor(t,n){super(t,n);if(this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new Yr("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new Yr("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new Yr(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=fc(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Mc(n.depthwiseRegularizer),this.depthwiseConstraint=wl(n.depthwiseConstraint),this.pointwiseInitializer=fc(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Mc(n.pointwiseRegularizer),this.pointwiseConstraint=wl(n.pointwiseConstraint)}build(t){if(t=$l(t),t.length<this.rank+2)throw new Yr(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null||t[n]<0)throw new Yr(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[n])}`);const o=t[n],u=this.kernelSize.concat([o,this.depthMultiplier]),h=[];for(let g=0;g<this.rank;++g)h.push(1);h.push(o*this.depthMultiplier,this.filters);const p=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",u,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,p,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",h,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,p,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,p,this.biasConstraint):this.bias=null,this.inputSpec=[new e({ndim:this.rank+2,axes:{[n]:o}})],this.built=!0}call(t,n){return zn(()=>{t=vu(t);let o;if(this.rank===1)throw new Fs("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=cu(t,[0,2,3,1])),o=K1(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(o=kp(o,this.bias.read(),this.dataFormat)),this.activation!=null&&(o=this.activation.apply(o)),this.dataFormat==="channelsFirst"&&(o=cu(o,[0,3,1,2])),o})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=mc(this.depthwiseInitializer),t.pointwiseInitializer=mc(this.pointwiseInitializer),t.depthwiseRegularizer=rc(this.depthwiseRegularizer),t.pointwiseRegularizer=rc(this.pointwiseRegularizer),t.depthwiseConstraint=ff(this.depthwiseConstraint),t.pointwiseConstraint=ff(this.pointwiseConstraint),t}}TM.className="SeparableConv";class VI extends TM{constructor(t){super(2,t)}}VI.className="SeparableConv2D",ci(VI);class ux extends l1{constructor(t){super(1,t);ux.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!Gy(t.kernelSize,"number",1,1))throw new Yr(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}ux.className="Conv1D",ci(ux);class jI extends d{constructor(t){super(t);typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,n){return zn(()=>{if(t=vu(t),this.dataFormat==="channelsLast"){const o=Hy(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Hy(o,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const o=Hy(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Hy(o,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}jI.className="Cropping2D",ci(jI);class HI extends d{constructor(t){super(t);this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,tc(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,Q_(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const n=t[2]==null?null:this.size[0]*t[2],o=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],n,o]}else{const n=t[1]==null?null:this.size[0]*t[1],o=t[2]==null?null:this.size[1]*t[2];return[t[0],n,o,t[3]]}}call(t,n){return zn(()=>{let o=vu(t);const u=o.shape;if(this.dataFormat==="channelsFirst"){o=cu(o,[0,2,3,1]);const h=this.size[0]*u[2],p=this.size[1]*u[3],g=this.interpolation==="nearest"?o.resizeNearestNeighbor([h,p]):o.resizeBilinear([h,p]);return cu(g,[0,3,1,2])}else{const h=this.size[0]*u[1],p=this.size[1]*u[2];return this.interpolation==="nearest"?o.resizeNearestNeighbor([h,p]):o.resizeBilinear([h,p])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}HI.className="UpSampling2D",ci(HI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hO(r,t,n=[1,1],o="valid",u,h){return zn(()=>{u==null&&(u=Np()),tc(u);let p=GI(r,u);if(r.rank!==4)throw new Yr(`Input for depthwiseConv2d is required to be 4-D, but is instead ${r.rank}-D`);if(t.rank!==4)throw new Yr(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return p=Qd(p,t,n,o==="same"?"same":"valid","NHWC",h),u==="channelsFirst"&&(p=cu(p,[0,3,1,2])),p})}class XI extends FE{constructor(t){super(2,t);this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=fc(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=wl(t.depthwiseConstraint),this.depthwiseRegularizer=Mc(t.depthwiseRegularizer)}build(t){if(t=$l(t),t.length<4)throw new Yr(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(t[n]==null||t[n]<0)throw new Yr(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[n]}).`);const o=t[n],u=[this.kernelSize[0],this.kernelSize[1],o,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",u,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[o*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return zn(()=>{t=vu(t);let o=hO(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(o=kp(o,this.bias.read(),this.dataFormat)),this.activation!=null&&(o=this.activation.apply(o)),o})}computeOutputShape(t){t=$l(t);const n=this.dataFormat==="channelsFirst"?t[2]:t[1],o=this.dataFormat==="channelsFirst"?t[3]:t[2],u=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,h=Qv(n,this.kernelSize[0],this.padding,this.strides[0]),p=Qv(o,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],u,h,p]:[t[0],h,p,u]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=mc(this.depthwiseInitializer),t.depthwiseRegularizer=rc(this.depthwiseRegularizer),t.depthwiseConstraint=ff(this.depthwiseRegularizer),t}}XI.className="DepthwiseConv2D",ci(XI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function AM(r,t,n,o){if(Array.isArray(r)){if(t!=null||n!=null)throw new Yr("When inputs is an array, neither initialState or constants should be provided");o!=null&&(n=r.slice(r.length-o,r.length),r=r.slice(0,r.length-o)),r.length>1&&(t=r.slice(1,r.length)),r=r[0]}function u(h){return h==null||Array.isArray(h)?h:[h]}return t=u(t),n=u(n),{inputs:r,initialState:t,constants:n}}function MM(r,t,n,o=!1,u,h,p=!1,g=!1){return zn(()=>{const x=t.shape.length;if(x<3)throw new Yr(`Input should be at least 3D, but is ${x}D.`);const I=[1,0].concat(zh(2,x));if(t=cu(t,I),h!=null)throw new Fs("The rnn() functoin of the deeplearn.js backend does not support constants yet.");p&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),u!=null&&(u=u.asType("bool").asType("float32"),u.rank===x-1&&(u=wd(u,-1)),u=cu(u,I)),o&&(t=Ph(t,0),u!=null&&(u=Ph(u,0)));const z=[];let V,rt=n;const Et=t.shape[0],St=Cd(t);let Tt;u!=null&&(Tt=Cd(u));for(let ue=0;ue<Et;++ue){const ye=St[ue],qe=zn(()=>r(ye,rt));if(u==null)V=qe[0],rt=qe[1];else{const $e=zn(()=>{const Xe=Tt[ue],Pn=Zc(Xe).sub(Xe),In=qe[0].mul(Xe).add(rt[0].mul(Pn)),gr=rt.map((Br,Kr)=>qe[1][Kr].mul(Xe).add(Br.mul(Pn)));return{output:In,newStates:gr}});V=$e.output,rt=$e.newStates}g&&z.push(V)}let Vt;return g&&(Vt=nd(z,1)),[V,Vt,rt]})}class Jv extends d{constructor(t){super(t);let n;if(t.cell==null)throw new Yr("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new $E({cells:t.cell}):n=t.cell,n.stateSize==null)throw new Yr("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new e({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return zh(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){tx(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const o=n[0];let u;if(this.returnSequences?u=[t[0],t[1],o]:u=[t[0],o],this.returnState){const h=[];for(const p of n)h.push([t[0],p]);return[u].concat(h)}else return u}computeMask(t,n){return zn(()=>{Array.isArray(n)&&(n=n[0]);const o=this.returnSequences?n:null;if(this.returnState){const u=this.states.map(h=>null);return[o].concat(u)}else return o})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let o=0;o<t;++o)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){const n=null;if(this.numConstants!=null)throw new Fs("Constants support is not implemented in RNN yet.");tx(t)&&(t=t[0]),t=t;const o=this.stateful?t[0]:null,u=t.slice(2);this.inputSpec[0]=new e({shape:[o,null,...u]});const h=[t[0]].concat(t.slice(2));if(n!=null)throw new Fs("Constants support is not implemented in RNN yet.");this.cell.build(h);let p;if(Array.isArray(this.cell.stateSize)?p=this.cell.stateSize:p=[this.cell.stateSize],this.stateSpec!=null){if(!Un(this.stateSpec.map(g=>g.shape[g.shape.length-1]),p))throw new Yr(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=p.map(g=>new e({shape:[null,g]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){zn(()=>{if(!this.stateful)throw new hv("Cannot call resetStates() on an RNN Layer that is not stateful.");const o=this.inputSpec[0].shape[0];if(o==null)throw new Yr("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(u=>Tc([o,u])):this.states_=[Tc([o,this.cell.stateSize])];else if(t==null)N(this.states_),this.keptStates!=null&&(N(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(u=>Tc([o,u])):this.states_[0]=Tc([o,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Yr(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):N(this.states_);for(let u=0;u<this.states_.length;++u){const h=t[u],p=Array.isArray(this.cell.stateSize)?this.cell.stateSize[u]:this.cell.stateSize,g=[o,p];if(!Un(h.shape,g))throw new Yr(`State ${u} is incompatible with layer ${this.name}: expected shape=${g}, received shape=${h.shape}`);this.states_[u]=h}}this.states_=this.states_.map(u=>q(u.clone()))})}apply(t,n){let o=n==null?null:n.initialState,u=n==null?null:n.constants;n==null&&(n={});const h=AM(t,o,u,this.numConstants);t=h.inputs,o=h.initialState,u=h.constants;let p=[],g=[];if(o!=null){n.initialState=o,p=p.concat(o),this.stateSpec=[];for(const I of o)this.stateSpec.push(new e({shape:I.shape}));g=g.concat(this.stateSpec)}if(u!=null&&(n.constants=u,p=p.concat(u),this.numConstants=u.length),p[0]instanceof i){const I=[t].concat(p),z=this.inputSpec.concat(g),V=this.inputSpec;this.inputSpec=z;const rt=super.apply(I,n);return this.inputSpec=V,rt}else return super.apply(t,n)}call(t,n){return zn(()=>{const o=n==null?null:n.mask,u=n==null?null:n.training;let h=n==null?null:n.initialState;t=vu(t),h==null&&(this.stateful?h=this.states_:h=this.getInitialState(t));const p=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(h.length!==p)throw new Yr(`RNN Layer has ${p} state(s) but was passed ${h.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const g={training:u},I=MM((St,Tt)=>{const Vt=this.cell.call([St].concat(Tt),g);return[Vt[0],Vt.slice(1)]},t,h,this.goBackwards,o,null,this.unroll,this.returnSequences),z=I[0],V=I[1],rt=I[2];this.stateful&&this.resetStates(rt,u);const Et=this.returnSequences?V:z;return this.returnState?[Et].concat(rt):Et})}getInitialState(t){return zn(()=>{let n=Tc(t.shape);return n=ss(n,[1,2]),n=O0(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(o=>o>1?Hb(n,[1,o]):n):this.cell.stateSize>1?[Hb(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const o=this.cell.getConfig();return this.getClassName()===Jv.className&&(n.cell={className:this.cell.getClassName(),config:o}),Object.assign({},o,t,n)}static fromConfig(t,n,o={}){const u=n.cell,h=$n(u,o);return new t(Object.assign(n,{cell:h}))}}Jv.className="RNN",ci(Jv);class lx extends d{}class BE extends lx{constructor(t){super(t);this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,cf(this.units,"units"),this.activation=Rm(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=fc(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=fc(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=fc(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Mc(t.kernelRegularizer),this.recurrentRegularizer=Mc(t.recurrentRegularizer),this.biasRegularizer=Mc(t.biasRegularizer),this.kernelConstraint=wl(t.kernelConstraint),this.recurrentConstraint=wl(t.recurrentConstraint),this.biasConstraint=wl(t.biasConstraint),this.dropout=Yg([1,pv([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Yg([1,pv([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=$l(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return zn(()=>{if(t=t,t.length!==2)throw new Yr(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let o=t[1];t=t[0];const u=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Lm({ones:()=>Zc(t),rate:this.dropout,training:u})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Lm({ones:()=>Zc(o),rate:this.recurrentDropout,training:u}));let h;const p=this.dropoutMask,g=this.recurrentDropoutMask;p!=null?h=vv(Xn(t,p),this.kernel.read()):h=vv(t,this.kernel.read()),this.bias!=null&&(h=kp(h,this.bias.read())),g!=null&&(o=Xn(o,g));let x=An(h,vv(o,this.recurrentKernel.read()));return this.activation!=null&&(x=this.activation.apply(x)),[x,x]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Om(this.activation),useBias:this.useBias,kernelInitializer:mc(this.kernelInitializer),recurrentInitializer:mc(this.recurrentInitializer),biasInitializer:mc(this.biasInitializer),kernelRegularizer:rc(this.kernelRegularizer),recurrentRegularizer:rc(this.recurrentRegularizer),biasRegularizer:rc(this.biasRegularizer),activityRegularizer:rc(this.activityRegularizer),kernelConstraint:ff(this.kernelConstraint),recurrentConstraint:ff(this.recurrentConstraint),biasConstraint:ff(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},t,n)}}BE.className="SimpleRNNCell",ci(BE);class YI extends Jv{constructor(t){t.cell=new BE(t),super(t)}call(t,n){return zn(()=>{this.cell.dropoutMask!=null&&(N(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(N(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const o=n==null?null:n.mask,u=n==null?null:n.training,h=n==null?null:n.initialState;return super.call(t,{mask:o,training:u,initialState:h})})}static fromConfig(t,n){return new t(n)}}YI.className="SimpleRNN",ci(YI);class zE extends lx{constructor(t){super(t);if(this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new Yr("GRUCell does not support reset_after parameter set to true.");this.units=t.units,cf(this.units,"units"),this.activation=Rm(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=Rm(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=fc(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=fc(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=fc(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Mc(t.kernelRegularizer),this.recurrentRegularizer=Mc(t.recurrentRegularizer),this.biasRegularizer=Mc(t.biasRegularizer),this.kernelConstraint=wl(t.kernelConstraint),this.recurrentConstraint=wl(t.recurrentConstraint),this.biasConstraint=wl(t.biasConstraint),this.dropout=Yg([1,pv([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Yg([1,pv([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=$l(t);const n=t[t.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return zn(()=>{if(t=t,t.length!==2)throw new Yr(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const o=n.training==null?!1:n.training;let u=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Lm({ones:()=>Zc(t),rate:this.dropout,training:o,count:3})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Lm({ones:()=>Zc(u),rate:this.recurrentDropout,training:o,count:3}));const h=this.dropoutMask,p=this.recurrentDropoutMask;let g,x,I;0<this.dropout&&this.dropout<1&&(t=Xn(t,h[0]));let z=vv(t,this.kernel.read());this.useBias&&(z=kp(z,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(u=Xn(u,p[0]));const V=this.recurrentKernel.read(),[rt,Et]=ed(V,[2*this.units,this.units],V.rank-1),St=vv(u,rt),[Tt,Vt,ue]=ed(z,3,z.rank-1),[ye,qe]=ed(St,2,St.rank-1);g=this.recurrentActivation.apply(An(Tt,ye)),x=this.recurrentActivation.apply(An(Vt,qe));const $e=vv(Xn(x,u),Et);I=this.activation.apply(An(ue,$e));const Xe=An(Xn(g,u),Xn(An(1,Ic(g)),I));return[Xe,Xe]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Om(this.activation),recurrentActivation:Om(this.recurrentActivation),useBias:this.useBias,kernelInitializer:mc(this.kernelInitializer),recurrentInitializer:mc(this.recurrentInitializer),biasInitializer:mc(this.biasInitializer),kernelRegularizer:rc(this.kernelRegularizer),recurrentRegularizer:rc(this.recurrentRegularizer),biasRegularizer:rc(this.biasRegularizer),activityRegularizer:rc(this.activityRegularizer),kernelConstraint:ff(this.kernelConstraint),recurrentConstraint:ff(this.recurrentConstraint),biasConstraint:ff(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},t,n)}}zE.className="GRUCell",ci(zE);class KI extends Jv{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new zE(t),super(t)}call(t,n){return zn(()=>{this.cell.dropoutMask!=null&&(N(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(N(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const o=n==null?null:n.mask,u=n==null?null:n.training,h=n==null?null:n.initialState;return super.call(t,{mask:o,training:u,initialState:h})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}KI.className="GRU",ci(KI);class cx extends lx{constructor(t){super(t);this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,cf(this.units,"units"),this.activation=Rm(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=Rm(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=fc(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=fc(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=fc(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=Mc(t.kernelRegularizer),this.recurrentRegularizer=Mc(t.recurrentRegularizer),this.biasRegularizer=Mc(t.biasRegularizer),this.kernelConstraint=wl(t.kernelConstraint),this.recurrentConstraint=wl(t.recurrentConstraint),this.biasConstraint=wl(t.biasConstraint),this.dropout=Yg([1,pv([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Yg([1,pv([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var n;t=$l(t);const o=t[t.length-1];this.kernel=this.addWeight("kernel",[o,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let u;if(this.useBias){if(this.unitForgetBias){const h=this.biasInitializer,p=this.units;u=new(n=class extends sp{apply(x,I){const z=h.apply([p]),V=new Zg().apply([p]),rt=h.apply([p*2]);return bE(bE(z,V),rt)}},n.className="CustomInit",n)}else u=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,u,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,n){return zn(()=>{const o=n.training==null?!1:n.training;if(t=t,t.length!==3)throw new Yr(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let u=t[1];const h=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Lm({ones:()=>Zc(t),rate:this.dropout,training:o,count:4})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Lm({ones:()=>Zc(u),rate:this.recurrentDropout,training:o,count:4}));const p=this.dropoutMask,g=this.recurrentDropoutMask;let x,I,z,V;0<this.dropout&&this.dropout<1&&(t=Xn(t,p[0]));let rt=vv(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(u=Xn(u,g[0])),rt=An(rt,vv(u,this.recurrentKernel.read())),this.useBias&&(rt=kp(rt,this.bias.read()));const[Et,St,Tt,Vt]=ed(rt,4,rt.rank-1);x=this.recurrentActivation.apply(Et),I=this.recurrentActivation.apply(St),z=An(Xn(I,h),Xn(x,this.activation.apply(Tt))),V=this.recurrentActivation.apply(Vt);const ue=Xn(V,this.activation.apply(z));return[ue,ue,z]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Om(this.activation),recurrentActivation:Om(this.recurrentActivation),useBias:this.useBias,kernelInitializer:mc(this.kernelInitializer),recurrentInitializer:mc(this.recurrentInitializer),biasInitializer:mc(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:rc(this.kernelRegularizer),recurrentRegularizer:rc(this.recurrentRegularizer),biasRegularizer:rc(this.biasRegularizer),activityRegularizer:rc(this.activityRegularizer),kernelConstraint:ff(this.kernelConstraint),recurrentConstraint:ff(this.recurrentConstraint),biasConstraint:ff(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},t,n)}}cx.className="LSTMCell",ci(cx);class ZI extends Jv{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new cx(t),super(t)}call(t,n){return zn(()=>{this.cell.dropoutMask!=null&&(N(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(N(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const o=n==null?null:n.mask,u=n==null?null:n.training,h=n==null?null:n.initialState;return super.call(t,{mask:o,training:u,initialState:h})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}ZI.className="LSTM",ci(ZI);class $E extends lx{constructor(t){super(t);this.cells=t.cells}get stateSize(){const t=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?t.push(...n.stateSize):t.push(n.stateSize);return t}call(t,n){return zn(()=>{t=t;let o=t.slice(1);const u=[];for(const g of this.cells.slice().reverse())Array.isArray(g.stateSize)?u.push(o.splice(0,g.stateSize.length)):u.push(o.splice(0,1));u.reverse();const h=[];let p;for(let g=0;g<this.cells.length;++g){const x=this.cells[g];o=u[g],g===0?p=[t[0]].concat(o):p=[p[0]].concat(o),p=x.call(p,n),h.push(p.slice(1))}o=[];for(const g of h.slice().reverse())o.push(...g);return[p[0]].concat(o)})}build(t){tx(t)&&(t=t[0]),t=t;let n;this.cells.forEach((o,u)=>{dv(`RNNCell_${u}`,()=>{o.build(t),Array.isArray(o.stateSize)?n=o.stateSize[0]:n=o.stateSize,t=[t[0],n]})}),this.built=!0}getConfig(){const t=super.getConfig(),n=h=>({className:h.getClassName(),config:h.getConfig()}),u={cells:this.cells.map(n)};return Object.assign({},t,u)}static fromConfig(t,n,o={}){const u=[];for(const h of n.cells)u.push($n(h,o));return new t({cells:u})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.cells)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const o of this.cells)n.push(...o.trainableWeights);return n.concat(t)}return t}getWeights(){const t=[];for(const n of this.cells)t.push(...n.weights);return kE(t)}setWeights(t){const n=[];for(const o of this.cells){const u=o.weights.length,h=t.splice(u);for(let p=0;p<o.weights.length;++p)n.push([o.weights[p],h[p]])}c(n)}}$E.className="StackedRNNCells",ci($E);function Lm(r){const{ones:t,rate:n,training:o=!1,count:u=1}=r,h=()=>EE(t(),n),p=()=>Dm(h,t,o);return!u||u<=1?q(p().clone()):Array(u).fill(void 0).map(p).map(x=>q(x.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var dO=function(r,t){var n={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&t.indexOf(o)<0&&(n[o]=r[o]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,o=Object.getOwnPropertySymbols(r);u<o.length;u++)t.indexOf(o[u])<0&&Object.prototype.propertyIsEnumerable.call(r,o[u])&&(n[o[u]]=r[o[u]]);return n};class tj extends null{}class NM extends Jv{constructor(t){if(t.unroll)throw new Fs("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new Fs("It is not possible at the moment to stack convolutional cells.");super(t);this.inputSpec=[new e({ndim:5})]}call(t,n){return zn(()=>{if(this.cell.dropoutMask!=null&&(N(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(N(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new Yr("ConvRNN2D cell does not support constants");const o=n==null?null:n.mask,u=n==null?null:n.training,h=n==null?null:n.initialState;return super.call(t,{mask:o,training:u,initialState:h})})}computeOutputShape(t){let n=this.computeSingleOutputShape(t);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([t[0],...n.slice(-3)])]),n}getInitialState(t){return zn(()=>{const{stateSize:n}=this.cell,o=t.shape,u=this.computeSingleOutputShape(o),h=[u[0],...u.slice(2)],p=Tc(h);return Array.isArray(n)?Array(n.length).fill(p):[p]})}resetStates(t,n=!1){zn(()=>{if(!this.stateful)throw new hv("Cannot call resetStates() on an RNN Layer that is not stateful.");const o=this.inputSpec[0].shape,u=this.computeSingleOutputShape(o),h=[u[0],...u.slice(2)];if(o[0]==null)throw new Yr("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Tc(h)):this.states_=[Tc(h)];else if(t==null)N(this.states_),this.keptStates!=null&&(N(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Tc(h)):this.states_[0]=Tc(h);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Yr(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n?this.keptStates.push(this.states_.slice()):N(this.states_);for(let g=0;g<this.states_.length;++g){const x=t[g],I=h;if(!Un(x.shape,I))throw new Yr(`State ${g} is incompatible with layer ${this.name}: expected shape=${I}, received shape=${x.shape}`);this.states_[g]=x}}this.states_=this.states_.map(g=>q(g.clone()))})}computeSingleOutputShape(t){const{dataFormat:n,filters:o,kernelSize:u,padding:h,strides:p,dilationRate:g}=this.cell,x=n==="channelsFirst",I=t[x?3:2],z=t[x?4:3],V=Qv(I,u[0],h,p[0],g[0]),rt=Qv(z,u[1],h,p[1],g[1]);return[...t.slice(0,2),...x?[o,V,rt]:[V,rt,o]]}}NM.className="ConvRNN2D";class GE extends cx{constructor(t){const{filters:n,kernelSize:o,strides:u,padding:h,dataFormat:p,dilationRate:g}=t;super(Object.assign({},t,{units:n}));this.filters=n,cf(this.filters,"filters"),this.kernelSize=u1(o,2,"kernelSize"),this.kernelSize.forEach(x=>cf(x,"kernelSize")),this.strides=u1(u||1,2,"strides"),this.strides.forEach(x=>cf(x,"strides")),this.padding=h||"valid",Bh(this.padding),this.dataFormat=p||"channelsLast",tc(this.dataFormat),this.dilationRate=u1(g||1,2,"dilationRate"),this.dilationRate.forEach(x=>cf(x,"dilationRate"))}build(t){var n;t=$l(t);const o=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[o]==null)throw new Yr(`The channel dimension of the input should be defined. Found ${t[o]}`);const u=t[o],h=4,p=this.kernelSize.concat([u,this.filters*h]);this.kernel=this.addWeight("kernel",p,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const g=this.kernelSize.concat([this.filters,this.filters*h]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",g,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let x;if(this.unitForgetBias){const I=this.biasInitializer,z=this.filters;x=new(n=class extends sp{apply(rt,Et){const St=I.apply([z]),Tt=sv([z]),Vt=I.apply([z*2]);return Xy([St,Tt,Vt])}},n.className="CustomInit",n)}else x=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*h],null,x,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,n){return zn(()=>{if(t.length!==3)throw new Yr(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const o=n.training||!1,u=t[0],h=t[1],p=t[2],g=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Lm({ones:()=>Zc(u),rate:this.dropout,training:o,count:g}));const x=this.dropoutMask,I=(Fi,Bi,Ji)=>!Bi||!Bi[Ji]?Fi:Xn(Bi[Ji],Fi);let z=I(u,x,0),V=I(u,x,1),rt=I(u,x,2),Et=I(u,x,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Lm({ones:()=>Zc(h),rate:this.recurrentDropout,training:o,count:g}));const St=this.recurrentDropoutMask;let Tt=I(h,St,0),Vt=I(h,St,1),ue=I(h,St,2),ye=I(h,St,3);const qe=3,[$e,Xe,Pn,In]=ed(this.kernel.read(),g,qe),[gr,Br,Kr,Na]=this.useBias?ed(this.bias.read(),g):[null,null,null,null];z=this.inputConv(z,$e,gr,this.padding),V=this.inputConv(V,Xe,Br,this.padding),rt=this.inputConv(rt,Pn,Kr,this.padding),Et=this.inputConv(Et,In,Na,this.padding);const[Ya,Ha,ni,Wa]=ed(this.recurrentKernel.read(),g,qe);Tt=this.recurrentConv(Tt,Ya),Vt=this.recurrentConv(Vt,Ha),ue=this.recurrentConv(ue,ni),ye=this.recurrentConv(ye,Wa);const za=this.recurrentActivation.apply(An(z,Tt)),mi=this.recurrentActivation.apply(An(V,Vt)),qa=An(Xn(mi,p),Xn(za,this.activation.apply(An(rt,ue)))),yi=Xn(this.recurrentActivation.apply(An(Et,ye)),this.activation.apply(qa));return[yi,yi,qa]})}getConfig(){const t=super.getConfig(),{units:n}=t,o=dO(t,["units"]),u={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},o,u)}inputConv(t,n,o,u){const h=qs(t,n,this.strides,u||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return o?kp(h,o,this.dataFormat):h}recurrentConv(t,n){return qs(t,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}GE.className="ConvLSTM2DCell",ci(GE);class qI extends NM{constructor(t){const n=new GE(t);super(Object.assign({},t,{cell:n}))}static fromConfig(t,n){return new t(n)}}qI.className="ConvLSTM2D",ci(qI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class UE extends d{constructor(t){super(t);this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const n=t.shape,o=[];for(let u=0;u<this.noiseShape.length;++u)o.push(this.noiseShape[u]==null?n[u]:this.noiseShape[u]);return o}call(t,n){return zn(()=>{this.invokeCallHook(t,n);const o=vu(t);if(0<this.rate&&this.rate<1){const u=n.training==null?!1:n.training,h=this.getNoiseShape(o);return Dm(()=>EE(o,this.rate,h,this.seed),()=>o,u)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(t,n),t}dispose(){return super.dispose()}}UE.className="Dropout",ci(UE);class QI extends UE{constructor(t){super(t);this.inputSpec=[{ndim:3}]}getNoiseShape(t){const n=t.shape;return[n[0],1,n[2]]}}QI.className="SpatialDropout1D",ci(QI);class JI extends d{constructor(t){super(t);if(this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let n=null;t.batchSize!=null&&(n=t.batchSize),this.batchInputShape=[n,t.inputDim]}this.units=t.units,cf(this.units,"units"),this.activation=Rm(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=fc(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=fc(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=wl(t.kernelConstraint),this.biasConstraint=wl(t.biasConstraint),this.kernelRegularizer=Mc(t.kernelRegularizer),this.biasRegularizer=Mc(t.biasRegularizer),this.activityRegularizer=Mc(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=$l(t);const n=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(t){t=$l(t);const n=t.slice();return n[n.length-1]=this.units,n}call(t,n){return zn(()=>{this.invokeCallHook(t,n);const o=vu(t),u=fE(this.activation.getClassName());let h;return u!=null?h=vv(o,this.kernel.read(),u,this.bias?this.bias.read():null):(h=vv(o,this.kernel.read()),this.bias!=null&&(h=kp(h,this.bias.read())),this.activation!=null&&(h=this.activation.apply(h))),h})}getConfig(){const t={units:this.units,activation:Om(this.activation),useBias:this.useBias,kernelInitializer:mc(this.kernelInitializer),biasInitializer:mc(this.biasInitializer),kernelRegularizer:rc(this.kernelRegularizer),biasRegularizer:rc(this.biasRegularizer),activityRegularizer:rc(this.activityRegularizer),kernelConstraint:ff(this.kernelConstraint),biasConstraint:ff(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}JI.className="Dense",ci(JI);class tT extends d{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=$l(t);for(const n of t.slice(1))if(n==null)throw new Yr(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],mg(t,1)]}call(t,n){return zn(()=>{this.invokeCallHook(t,n);let o=vu(t);if(this.dataFormat==="channelsFirst"&&o.rank>1){const u=[0];for(let h=2;h<o.rank;++h)u.push(h);u.push(1),o=o.transpose(u)}return oI(o)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(t,n),t}}tT.className="Flatten",ci(tT);class eT extends d{constructor(t){super(t);this.supportsMasking=!0,this.activation=Rm(t.activation)}call(t,n){return zn(()=>{this.invokeCallHook(t,n);const o=vu(t);return this.activation.apply(o)})}getConfig(){const t={activation:Om(this.activation)},n=super.getConfig();return Object.assign(t,n),t}}eT.className="Activation",ci(eT);class nT extends d{constructor(t){super(t);this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,n){return zn(()=>(t=vu(t),aI(t,this.n)))}getConfig(){const t={n:this.n},n=super.getConfig();return Object.assign(t,n),t}}nT.className="RepeatVector",ci(nT);class rT extends d{constructor(t){super(t);this.targetShape=t.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,n){const o="Total size of new array must be unchanged.",u=n.slice();let h=1,p=null;for(let x=0;x<u.length;++x){const I=u[x];if(this.isUnknown(I))if(p===null)p=x;else throw new Yr("Can only specifiy one unknown dimension.");else h*=I}const g=mg(t);if(p!==null){if(h===0||g%h!=0)throw new Yr(o);u[p]=g/h}else if(g!==h)throw new Yr(o);return u}computeOutputShape(t){let n=!1;for(let o=0;o<t.length;++o)if(this.isUnknown(t[o])){n=!0;break}return n?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,n){return zn(()=>{this.invokeCallHook(t,n);const o=vu(t),u=o.shape,h=u.slice(0,1).concat(this.fixUnknownDimension(u.slice(1),this.targetShape));return o.reshape(h)})}getConfig(){const t={targetShape:this.targetShape},n=super.getConfig();return Object.assign(t,n),t}}rT.className="Reshape",ci(rT);class aT extends d{constructor(t){super(t);if(t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const n=zh(1,t.dims.length+1);if(!Un(t.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new e({ndim:this.dims.length+1})]}computeOutputShape(t){t=$l(t);const n=t.slice();return this.dims.forEach((o,u)=>{n[u+1]=t[o]}),n}call(t,n){return cu(vu(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},n=super.getConfig();return Object.assign(t,n),t}}aT.className="Permute",ci(aT);class iT extends d{constructor(t){super(t==null?{}:t);this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,t),n}computeMask(t,n){const o=vu(t),u=-1;return _a(fg(o,this.maskValue),u)}call(t,n){return zn(()=>{this.invokeCallHook(t,n);const o=vu(t),u=-1,h=!0,p=_a(fg(o,this.maskValue),u,h);return o.mul(p.asType(o.dtype))})}}iT.className="Masking",ci(iT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class oT extends d{constructor(t){super(t);if(this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let n=null;t.batchSize!=null&&(n=t.batchSize),t.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Xl(t.inputLength))}this.inputDim=t.inputDim,cf(this.inputDim,"inputDim"),this.outputDim=t.outputDim,cf(this.outputDim,"outputDim"),this.embeddingsInitializer=fc(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Mc(t.embeddingsRegularizer),this.activityRegularizer=Mc(t.activityRegularizer),this.embeddingsConstraint=wl(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,n){return zn(()=>this.maskZero?(t=vu(t),fg(t,bi(t))):null)}computeOutputShape(t){if(t=$l(t),this.inputLength==null)return[...t,this.outputDim];const n=Xl(this.inputLength);if(n.length!==t.length-1)throw new Yr(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let o=0;for(let u=0;u<n.length;++u){const h=n[u],p=t[u+1];if(h!=null&&p!=null&&h!==p)throw new Yr(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);h==null&&(n[o]=p),o++}}return[t[0],...n,this.outputDim]}call(t,n){return zn(()=>{this.invokeCallHook(t,n);let o=vu(t);return o.dtype!=="int32"&&(o=Kg(o,"int32")),gv(this.embeddings.read(),o.as1D()).reshape($l(this.computeOutputShape(o.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:mc(this.embeddingsInitializer),embeddingsRegularizer:rc(this.embeddingsRegularizer),activityRegularizer:rc(this.activityRegularizer),embeddingsConstraint:ff(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(t,n),t}}oT.className="Embedding",ci(oT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $0 extends d{constructor(t){super(t||{});this.supportsMasking=!0}mergeFunction(t){throw new Fs}computeElementwiseOpOutputShape(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;const o=t.slice(0,t.length-n.length);for(let u=0;u<n.length;++u){const h=t[t.length-n.length+u],p=n[u];if(h==null||p==null||h<0||p<0)o.push(null);else if(h===1)o.push(p);else if(p===1)o.push(h);else{if(h!==p)throw new Yr("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));o.push(h)}}return o}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[$l(t)]),t=t,t.length<2)throw new Yr(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let n=[];for(const h of t)h!=null&&h[0]!==null&&n.push(h[0]);if(n=gg(n),n.length>1)throw new Yr(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let o=t[0]==null?null:t[0].slice(1);for(let h=1;h<t.length;++h){const p=t[h]==null?null:t[h].slice(1);o=this.computeElementwiseOpOutputShape(o,p)}const u=t.map(h=>h.length);t.indexOf(null)===-1&&gg(u).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,n){return zn(()=>{if(t=t,this.reshapeRequired){const o=[],u=t.map(h=>h.rank);if(u.indexOf(null)===-1){const h=pv(u);for(let p of t){const g=p.rank;for(let x=0;x<h-g;++x)p=O0(p,1);o.push(p)}return this.mergeFunction(o)}else{let h=!1;for(const x of t){const I=x.rank;if(I==null){const z=x.shape,V=z[0],rt=z.slice(1).concat([V]);let Et=x.reshape([V].concat(mg(z.slice(1))));Et=cu(Et,[1,0]),Et=Et.reshape(rt),o.push(Et),h=!0}else if(I>1){const z=zh(1,I).concat([0]);o.push(cu(x,z)),h=!0}else o.push(x)}let p=this.mergeFunction(o);const g=p.rank;if(h){if(g==null){const x=p.shape,I=x.length,z=x[I-1],V=[z].concat(x.slice(0,x.length-1));p=cu(p.reshape([-1,z]),[1,0]).reshape(V)}else if(g>1){const x=[g-1].concat(zh(0,g-1));p=cu(p,x)}}return p}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let n;t[0]==null?n=null:n=t[0].slice(1);for(let u=1;u<t.length;++u){const h=t[u]==null?null:t[u].slice(1);n=this.computeElementwiseOpOutputShape(n,h)}let o=[];for(const u of t)u!=null&&u[0]!==null&&o.push(u[0]);return o=gg(o),o.length===1?n=o.concat(n):n=[null].concat(n),n}computeMask(t,n){return zn(()=>{if(n==null)return null;if(!Array.isArray(n))throw new Yr("`mask` should be an Array");if(!Array.isArray(t))throw new Yr("`inputs` should be an Array");if(n.length!==t.length)throw new Yr(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${n.length})`);if(n.every(u=>u==null))return null;n=n.map(u=>u==null?u:wd(u,0));let o=n[0];for(let u=1;u<n.length-1;++u)o=Rh(o,n[u]);return o})}}class fx extends $0{constructor(t){super(t)}mergeFunction(t){return zn(()=>{let n=t[0].clone();for(let o=1;o<t.length;++o)n=An(n,t[o]);return n})}}fx.className="Add",ci(fx);function ej(r){return Array.isArray(r)?new fx({}).apply(r):new fx(r)}class hx extends $0{constructor(t){super(t)}mergeFunction(t){return zn(()=>{let n=t[0].clone();for(let o=1;o<t.length;++o)n=Xn(n,t[o]);return n})}}hx.className="Multiply",ci(hx);function nj(r){return Array.isArray(r)?new hx({}).apply(r):new hx(r)}class dx extends $0{constructor(t){super(t)}mergeFunction(t){return zn(()=>{let n=t[0].clone();for(let o=1;o<t.length;++o)n=An(n,t[o]);return Xn(1/t.length,n)})}}dx.className="Average",ci(dx);function rj(r){return Array.isArray(r)?new dx({}).apply(r):new dx(r)}class px extends $0{constructor(t){super(t)}mergeFunction(t){return zn(()=>{let n=t[0];for(let o=1;o<t.length;++o)n=Po(n,t[o]);return n})}}px.className="Maximum",ci(px);function aj(r){return Array.isArray(r)?new px({}).apply(r):new px(r)}class vx extends $0{constructor(t){super(t)}mergeFunction(t){return zn(()=>{let n=t[0];for(let o=1;o<t.length;++o)n=cg(n,t[o]);return n})}}vx.className="Minimum",ci(vx);function ij(r){return Array.isArray(r)?new vx({}).apply(r):new vx(r)}class gx extends $0{constructor(t){super(t);this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new Yr("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let n=!0;for(const u of t)if(u!=null){n=!1;break}if(n)return;const o=[];for(let u=0;u<t.length;++u){const h=t[u].slice();h.splice(this.axis,1);let p=!1;for(const g of o)if(Un(g,h)){p=!0;break}p||o.push(h)}if(o.length>1)throw new Yr("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return zn(()=>Xy(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new Yr("A `Concatenate` layer should be called on a list of inputs.");const n=t,o=n[0].slice(),u=this.axis<0?o.length+this.axis:this.axis;for(const h of n.slice(1)){if(o[u]==null||h[u]==null){o[u]=null;break}o[u]+=h[u]}return o}computeMask(t,n){if(n==null)return null;if(!Array.isArray(n))throw new Yr("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new Yr("`inputs` should be an array for Concatenate");if(n.length!==t.length)throw new Yr(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${t.length})`);return zn(()=>{let o=!0;if(n.forEach(p=>{if(p!=null){o=!1;return}}),o)return null;const u=[];for(let p=0;p<t.length;++p)n[p]==null?u.push(Zc(t[p]).asType("bool")):n[p].rank<t[p].rank?u.push(wd(n[p],-1)):u.push(n[p]);const h=_t(u,this.axis);return Dr(h,-1,!1)})}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}gx.className="Concatenate",ci(gx);function oj(r){return Array.isArray(r)?new gx({}).apply(r):new gx(r)}function mx(r,t){for(;r<0;)r+=t;return r}function pO(r,t,n){if(r.shape.length>3||t.shape.length>3)throw new Fs("batchDot is not implemented for tensors of 4D or higher rank yet");if(yt(r.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${r.shape.length}`),yt(r.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),r.dtype==="complex64"||t.dtype==="complex64")throw new Fs("batchDot is not implemented for complex64-type Tensors yet.");const o=r.shape.length,u=t.shape.length;n==null&&(n=[o-1,u-2]);const h=n;return zn(()=>{let p;if(o>u){p=o-u;const x=[];for(let I=0;I<p;++I)x.push(1);t=t.reshape(t.shape.concat(x))}else if(u>o){p=u-o;const x=[];for(let I=0;I<p;++I)x.push(1);r=r.reshape(r.shape.concat(x))}else p=0;let g;if(r.shape.length===2&&t.shape.length===2)h[0]===h[1]?g=r.mul(t).sum(h[0]):g=r.transpose([1,0]).mul(t).sum(h[1]);else{const x=h[0]!==r.shape.length-1,I=h[1]===t.shape.length-1;g=r.matMul(t,x,I)}if(p>0){let x;o>u?x=o+u-3:x=o-1;const I=[];for(let z=x;z<x+p;++z)I.push(z);g=g.squeeze(I)}return g.shape.length===1&&(g=g.expandDims(1)),g})}class sT extends $0{constructor(t){super(t);this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){yt(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0],o=t[1];if(n.length>3||o.length>3)throw new Fs("Dot layer does not support tensors of 4D or higher rank yet.");const u=this.interpretAxes(n,o);if(n[u[0]]!==o[u[1]])throw new Yr(`Dimension incompatibility: ${n[u[0]]} !== ${o[u[1]]}`)}mergeFunction(t){if(t.length!==2)throw new Yr(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let n=t[0],o=t[1],u;return Array.isArray(this.axes)?u=this.axes.map((h,p)=>mx(h,t[p].shape.length)):u=[mx(this.axes,n.shape.length),mx(this.axes,o.shape.length)],this.normalize&&(n=Tn(n,u[0]),o=Tn(o,u[1])),pO(n,o,u)}interpretAxes(t,n){let o;return Array.isArray(this.axes)?o=this.axes:o=[mx(this.axes,t.length),mx(this.axes,n.length)],o}computeOutputShape(t){yt(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0].slice(),o=t[1].slice();if(n.length>3||o.length>3)throw new Fs("Dot layer does not support tensors of 4D or higher rank yet.");const u=this.interpretAxes(n,o);n.splice(u[0],1),o.splice(u[1],1),o.splice(0,1);const h=n.concat(o);return h.length===1&&h.push(1),h}computeMask(t,n){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(t,n),t}}sT.className="Dot",ci(sT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class uT extends d{constructor(t){super(t);this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,t),n}call(t,n){return zn(()=>{this.invokeCallHook(t,n);const o=vu(t);return Dm(()=>Yy(o.shape,0,this.stddev).add(o),()=>o,n.training||!1)})}}uT.className="GaussianNoise",ci(uT);class lT extends d{constructor(t){super(t);this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return zn(()=>{this.invokeCallHook(t,n);const o=vu(t);return this.rate>0&&this.rate<1?Dm(()=>{const h=Math.sqrt(this.rate/(1-this.rate));return o.mul(Yy(o.shape,1,h))},()=>o,n.training||!1):o})}}lT.className="GaussianDropout",ci(lT);class cT extends d{constructor(t){super(t);this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||vu(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return zn(()=>{if(this.rate<1&&this.rate>0){const o=this._getNoiseShape(t);return Dm(()=>{const h=vu(t),p=1.6732632423543772,g=1.0507009873554805,x=-p*g;let I=Jd(r0(o),this.rate);I=Kg(I,"float32");const z=xA((1-this.rate)*(1+this.rate*xA(x,2)),-.5),V=-z*x*this.rate;return h.mul(I).add(I.add(-1).mul(x)).mul(z).add(V)},()=>vu(t),n.training||!1)}return t})}}cT.className="AlphaDropout",ci(cT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yx(r,t,n,o,u,h=.001){let p;if(r.rank===2)p=pr(r,t,n,o,u,h);else if(r.rank===3)p=Er(r,t,n,o,u,h);else if(r.rank===4)p=Gr(r,t,n,o,u,h);else throw new Fs(`batchNormalization is not implemented for array of rank ${r.rank} yet`);return p}function vO(r,t,n,o,u=.001){return zn(()=>{const h=oy(r,o),p=h.mean,g=h.variance;return[yx(r,p,g,n,t,u),p,g]})}function gO(r,t,n,o,u=.001){return zn(()=>{const h=oy(r,o),p=h.mean,g=h.variance,x=[];for(const St of zh(0,r.rank))o.indexOf(St)!==-1?x.push(1):x.push(r.shape[St]);const I=p.reshape(x),z=g.reshape(x),V=t==null?null:t.reshape(x),rt=n==null?null:n.reshape(x);return[yx(r,I,z,rt,V,u),p,g]})}function mO(r,t,n,o,u=.001){return Un(o.slice().sort(),zh(0,r.rank-1))?vO(r,t,n,o,u):gO(r,t,n,o,u)}class fT extends d{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=fc(t.betaInitializer||"zeros"),this.gammaInitializer=fc(t.gammaInitializer||"ones"),this.movingMeanInitializer=fc(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=fc(t.movingVarianceInitializer||"ones"),this.betaConstraint=wl(t.betaConstraint),this.gammaConstraint=wl(t.gammaConstraint),this.betaRegularizer=Mc(t.betaRegularizer),this.gammaRegularizer=Mc(t.gammaRegularizer)}build(t){t=$l(t);const n=this.axis>=0?this.axis:this.axis+t.length,o=t[n];if(o==null)throw new Yr(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new e({ndim:t.length,axes:{[n]:o}})];const u=[o];this.scale&&(this.gamma=this.addWeight("gamma",u,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",u,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",u,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",u,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,n){return zn(()=>{const o=n.training==null?!1:n.training,u=vu(t),h=u.shape,p=h.length,g=zh(0,p),x=this.axis>=0?this.axis:this.axis+p;g.splice(x,1);const I=Wg(1,p);I[x]=h[x];const z=g.slice();z.sort();const V=!Un(z,zh(0,p).slice(0,p-1)),rt=()=>{if(V){const ye=this.movingMean.read().reshape(I),qe=this.movingVariance.read().reshape(I),$e=this.center?this.beta.read().reshape(I):null,Xe=this.scale?this.gamma.read().reshape(I):null;return yx(u,ye,qe,$e,Xe,this.epsilon)}else return yx(u,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!o)return rt();const[Et,St,Tt]=mO(u,this.gamma.read(),this.beta.read(),g,this.epsilon),Vt=(ye,qe,$e)=>{zn(()=>{const Xe=1-$e,Pn=ye.read(),In=Pn.sub(qe).mul(Xe);ye.write(Pn.sub(In))})};return(()=>{Vt(this.movingMean,St,this.momentum),Vt(this.movingVariance,Tt,this.momentum)})(),Et})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:mc(this.betaInitializer),gammaInitializer:mc(this.gammaInitializer),movingMeanInitializer:mc(this.movingMeanInitializer),movingVarianceInitializer:mc(this.movingVarianceInitializer),betaRegularizer:rc(this.betaRegularizer),gammaRegularizer:rc(this.gammaRegularizer),betaConstraint:ff(this.betaConstraint),gammaConstraint:ff(this.gammaConstraint)},n=super.getConfig();return Object.assign(t,n),t}}fT.className="BatchNormalization",ci(fT);class hT extends d{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=fc(t.betaInitializer||"zeros"),this.gammaInitializer=fc(t.gammaInitializer||"ones"),this.betaRegularizer=Mc(t.betaRegularizer),this.gammaRegularizer=Mc(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=$l(t);const n=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let h=0;h<this.axis.length;++h)this.axis[h]<0&&(this.axis[h]+=n);for(const h of this.axis)if(h<0||h>=n)throw new Error(`Invalid axis: ${h}`);if(this.axis.length!==gg(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const o=this.axis.map(h=>t[h]),u=!0;this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,u):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,u):this.beta=null,this.built=!0}call(t,n){const o=vu(t),u=o.shape,h=u.length;return zn(()=>{const p=!0;let{mean:g,variance:x}=oy(o,this.axis,p);const I=Wg(1,h);for(const Tt of this.axis)I[Tt]=u[Tt];const z=Tt=>Tt!=null&&Tt.shape.length!==h&&this.axis!==[h-1]?Tt.reshape(I):Tt;let V=z(this.gamma.read()),rt=z(this.beta.read());const Et=[],St=[];for(let Tt=0;Tt<h;++Tt)this.axis.indexOf(Tt)!==-1?(Et.push(u[Tt]),St.push(1)):(Et.push(1),St.push(u[Tt]));return g=g.tile(Et),x=x.tile(Et),V=V.tile(St),rt=rt.tile(St),yx(o,g,x,rt,V,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:mc(this.betaInitializer),gammaInitializer:mc(this.gammaInitializer),betaRegularizer:rc(this.betaRegularizer),gammaRegularizer:rc(this.gammaRegularizer)},n=super.getConfig();return Object.assign(t,n),t}}hT.className="LayerNormalization",ci(hT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sj(r,t){return tidy(()=>{if(r.rank!==3)throw new ValueError(`temporalPadding expects input tensor to be 3-D, but received a ${r.rank}-D tensor.`);if(t==null&&(t=[1,1]),t.length!==2)throw new ValueError(`temporalPadding expects input padding pattern to be a length-2 array, but received a length-${t.length} array.`);const n=[[0,0],t,[0,0]];return tfc.pad(r,n)})}function yO(r,t,n){return zn(()=>{if(r.rank!==4)throw new Yr(`temporalPadding expects input tensor to be 4-D, but received a ${r.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new Yr("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Np()),n!=="channelsLast"&&n!=="channelsFirst")throw new Yr(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let o;return n==="channelsFirst"?o=[[0,0],[0,0],t[0],t[1]]:o=[[0,0],t[0],t[1],[0,0]],$v(r,o)})}class dT extends d{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?Np():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new Yr(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let n,o;if(typeof t.padding[0]=="number")n=[t.padding[0],t.padding[0]],o=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new Yr(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(n=t.padding[0],t.padding[1].length!==2)throw new Yr(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);o=t.padding[1]}this.padding=[n,o]}this.inputSpec=[new e({ndim:4})]}computeOutputShape(t){t=$l(t);let n,o;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?n=t[2]+this.padding[0][0]+this.padding[0][1]:n=null,t[3]!=null&&t[3]>=0?o=t[3]+this.padding[1][0]+this.padding[1][1]:o=null,[t[0],t[1],n,o]):(t[1]!=null&&t[1]>=0?n=t[1]+this.padding[0][0]+this.padding[0][1]:n=null,t[2]!=null&&t[2]>=0?o=t[2]+this.padding[1][0]+this.padding[1][1]:o=null,[t[0],n,o,t[3]])}call(t,n){return zn(()=>yO(vu(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}dT.className="ZeroPadding2D",ci(dT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function WE(r,t,n,o,u,h){return zn(()=>{tc(u),gE(h),Bh(o),n==null&&(n=[1,1]),o==null&&(o="valid"),u==null&&(u=Np()),h==null&&(h="max"),r=GI(r,u);let p;const g=o==="same"?"same":"valid";return h==="max"?p=Dg(r,t,n,g):p=D(r,t,n,g),u==="channelsFirst"&&(p=cu(p,[0,3,1,2])),p})}function kM(r,t,n,o,u,h){return zn(()=>{tc(u),gE(h),Bh(o),n==null&&(n=[1,1,1]),o==null&&(o="valid"),u==null&&(u=Np()),h==null&&(h="max"),r=CM(r,u);let p;const g=o==="same"?"same":"valid";return h==="max"?p=lg(r,t,n,g):p=lt(r,t,n,g),u==="channelsFirst"&&(p=cu(p,[0,4,1,2,3])),p})}class DM extends d{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new Yr(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(cf(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new Yr(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);cf(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,Bh(this.padding),this.inputSpec=[new e({ndim:3})]}computeOutputShape(t){t=$l(t);const n=Qv(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]}call(t,n){return zn(()=>{this.invokeCallHook(t,n),t=O0(vu(t),2);const o=this.poolingFunction(vu(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Uv(o,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(t,n),t}}class pT extends DM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return tc(h),Bh(u),WE(t,n,o,u,h,"max")}}pT.className="MaxPooling1D",ci(pT);class vT extends DM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return tc(h),Bh(u),WE(t,n,o,u,h,"avg")}}vT.className="AveragePooling1D",ci(vT);class OM extends d{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new Yr(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];cf(this.poolSize,"poolSize"),cf(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,tc(this.dataFormat),Bh(this.padding),this.inputSpec=[new e({ndim:4})]}computeOutputShape(t){t=$l(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],o=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=Qv(n,this.poolSize[0],this.padding,this.strides[0]),o=Qv(o,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,o]:[t[0],n,o,t[3]]}call(t,n){return zn(()=>(this.invokeCallHook(t,n),this.poolingFunction(vu(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class gT extends OM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return tc(h),Bh(u),WE(t,n,o,u,h,"max")}}gT.className="MaxPooling2D",ci(gT);class mT extends OM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return tc(h),Bh(u),WE(t,n,o,u,h,"avg")}}mT.className="AveragePooling2D",ci(mT);class RM extends d{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new Yr(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];cf(this.poolSize,"poolSize"),cf(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,tc(this.dataFormat),Bh(this.padding),this.inputSpec=[new e({ndim:5})]}computeOutputShape(t){t=$l(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],o=this.dataFormat==="channelsFirst"?t[3]:t[2],u=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=Qv(n,this.poolSize[0],this.padding,this.strides[0]),o=Qv(o,this.poolSize[1],this.padding,this.strides[1]),u=Qv(u,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,o,u]:[t[0],n,o,u,t[4]]}call(t,n){return zn(()=>(this.invokeCallHook(t,n),this.poolingFunction(vu(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class yT extends RM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return tc(h),Bh(u),kM(t,n,o,u,h,"max")}}yT.className="MaxPooling3D",ci(yT);class bT extends RM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return tc(h),Bh(u),kM(t,n,o,u,h,"avg")}}bT.className="AveragePooling3D",ci(bT);class LM extends d{constructor(t){super(t);this.inputSpec=[new e({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,n){throw new Fs}}class xT extends LM{constructor(t){super(t||{})}call(t,n){return zn(()=>{const o=vu(t);return cc(o,1)})}}xT.className="GlobalAveragePooling1D",ci(xT);class wT extends LM{constructor(t){super(t||{})}call(t,n){return zn(()=>{const o=vu(t);return Sd(o,1)})}}wT.className="GlobalMaxPooling1D",ci(wT);class PM extends d{constructor(t){super(t);this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,tc(this.dataFormat),this.inputSpec=[new e({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,n){throw new Fs}getConfig(){const t={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class ET extends PM{call(t,n){return zn(()=>{const o=vu(t);return this.dataFormat==="channelsLast"?cc(o,[1,2]):cc(o,[2,3])})}}ET.className="GlobalAveragePooling2D",ci(ET);class ST extends PM{call(t,n){return zn(()=>{const o=vu(t);return this.dataFormat==="channelsLast"?Sd(o,[1,2]):Sd(o,[2,3])})}}ST.className="GlobalMaxPooling2D",ci(ST);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class FM extends d{constructor(t){super(t);this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(t,n),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,n,o={}){const u=n.layer,h=$n(u,o);delete n.layer;const p={layer:h};return Object.assign(p,n),new t(p)}}class CT extends FM{constructor(t){super(t);this.supportsMasking=!0}build(t){if(t=$l(t),t.length<3)throw new Yr(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=$l(t);const n=[t[0]].concat(t.slice(2)),o=this.layer.computeOutputShape(n),u=t[1];return[o[0],u].concat(o.slice(1))}call(t,n){return zn(()=>(t=vu(t),MM((p,g)=>[vu(this.layer.call(p,n)),[]],t,[],!1,null,null,!1,!0)[1]))}}CT.className="TimeDistributed",ci(CT);function bO(r){jg(q_,"BidirectionalMergeMode",r)}const xO="concat";class _T extends FM{constructor(t){super(t);const n=t.layer.getConfig(),o={};o.className=t.layer.getClassName(),o.config=n,this.forwardLayer=$n(o),n.goBackwards=n.goBackwards!==!0;const u={};if(u.className=t.layer.getClassName(),u.config=n,this.backwardLayer=$n(u),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?xO:t.mergeMode,bO(this.mergeMode),t.weights)throw new Fs("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const n=t.length,o=Math.floor(n/2);this.forwardLayer.setWeights(t.slice(0,o)),this.backwardLayer.setWeights(t.slice(o))}computeOutputShape(t){let n=this.forwardLayer.computeOutputShape(t);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let o,u,h;return this.returnState&&(h=n.slice(1)),o=n[0],o=o,this.mergeMode==="concat"?(o[o.length-1]*=2,u=[o]):this.mergeMode==null?u=[o,o.slice()]:u=[o],this.returnState?this.mergeMode==null?u.concat(h).concat(h.slice()):[o].concat(h).concat(h.slice()):Fh(u)}apply(t,n){let o=n==null?null:n.initialState,u=n==null?null:n.constants;n==null&&(n={});const h=AM(t,o,u,this.numConstants);if(t=h.inputs,o=h.initialState,u=h.constants,Array.isArray(t)&&(o=t.slice(1),t=t[0]),(o==null||o.length===0)&&u==null)return super.apply(t,n);const p=[],g=[];if(o!=null){const I=o.length;if(I%2>0)throw new Yr("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=o,p.push(...o);const z=o.map(V=>new e({shape:V.shape}));this.forwardLayer.stateSpec=z.slice(0,I/2),this.backwardLayer.stateSpec=z.slice(I/2),g.push(...z)}if(u!=null)throw new Fs("Support for constants in Bidirectional layers is not implemented yet.");const x=p[0]instanceof i;for(const I of p)if(I instanceof i!==x)throw new Yr("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(x){const I=[t].concat(p),z=this.inputSpec.concat(g),V=this.inputSpec;this.inputSpec=z;const rt=super.apply(I,n);return this.inputSpec=V,rt}else return super.apply(t,n)}call(t,n){return zn(()=>{const o=n.initialState;let u,h;if(o==null)u=this.forwardLayer.call(t,n),h=this.backwardLayer.call(t,n);else{const x=o.slice(0,o.length/2),I=o.slice(o.length/2);u=this.forwardLayer.call(t,Object.assign(n,{initialState:x})),h=this.backwardLayer.call(t,Object.assign(n,{initialState:I}))}let p;this.returnState&&(Array.isArray(u)&&(p=u.slice(1).concat(h.slice(1))),u=u[0],h=h[0]),this.returnSequences&&(h=Ph(h,1));let g;return this.mergeMode==="concat"?g=Xy([u,h]):this.mergeMode==="sum"?g=An(u,h):this.mergeMode==="ave"?g=Xn(.5,An(u,h)):this.mergeMode==="mul"?g=Xn(u,h):this.mergeMode==null&&(g=[u,h]),this.returnState?this.mergeMode==null?g.concat(p):[g].concat(p):g})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){dv(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),dv(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,n){Array.isArray(n)&&(n=n[0]);let o;if(this.returnSequences?this.mergeMode==null?o=[n,n]:o=n:this.mergeMode==null?o=[null,null]:o=null,this.returnState){const h=this.forwardLayer.states.map(p=>null);return Array.isArray(o)?o.concat(h).concat(h):[o].concat(h).concat(h)}else return o}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,n){const o=$n(n.layer);if(delete n.layer,n.numConstants!=null)throw new Fs("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const u=n;return u.layer=o,new t(u)}}_T.className="Bidirectional",ci(_T);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wO(r){return new T(r)}function EO(r){return new BI(r)}function SO(r){return new LI(r)}function CO(r){return new PI(r)}function _O(r){return new FI(r)}function IO(r){return new $I(r)}function TO(r){return new zI(r)}function AO(r){return new ux(r)}function MO(r){return new c1(r)}function NO(r){return new WI(r)}function kO(r){return new sx(r)}function DO(r){return new VI(r)}function OO(r){return new jI(r)}function RO(r){return new HI(r)}function LO(r){return new XI(r)}function PO(r){return new eT(r)}function FO(r){return new JI(r)}function BO(r){return new UE(r)}function zO(r){return new QI(r)}function $O(r){return new tT(r)}function GO(r){return new nT(r)}function UO(r){return new rT(r)}function WO(r){return new aT(r)}function VO(r){return new oT(r)}function jO(r){return new fx(r)}function HO(r){return new dx(r)}function XO(r){return new gx(r)}function YO(r){return new px(r)}function KO(r){return new vx(r)}function ZO(r){return new hx(r)}function qO(r){return new sT(r)}function QO(r){return new fT(r)}function JO(r){return new hT(r)}function tR(r){return new dT(r)}function IT(r){return new vT(r)}function eR(r){return IT(r)}function nR(r){return IT(r)}function TT(r){return new mT(r)}function rR(r){return TT(r)}function aR(r){return TT(r)}function AT(r){return new bT(r)}function iR(r){return AT(r)}function oR(r){return AT(r)}function sR(r){return new xT(r)}function uR(r){return new ET(r)}function BM(r){return new wT(r)}function zM(r){return new ST(r)}function $M(r){return new pT(r)}function GM(r){return new gT(r)}function lR(r){return new yT(r)}function cR(r){return new KI(r)}function fR(r){return new zE(r)}function hR(r){return new ZI(r)}function dR(r){return new cx(r)}function pR(r){return new YI(r)}function vR(r){return new BE(r)}function gR(r){return new qI(r)}function mR(r){return new GE(r)}function yR(r){return new Jv(r)}function bR(r){return new $E(r)}function xR(r){return new _T(r)}function wR(r){return new CT(r)}const ER=BM,SR=zM,CR=$M,_R=GM;function IR(r){return new uT(r)}function TR(r){return new lT(r)}function AR(r){return new cT(r)}function MR(r){return new iT(r)}function NR(r,t){return Sf(r,t)}function kR(r,t){return Fo(r,t)}function DR(r,t){return su(r,t)}function OR(r,t){return Qf(r,t)}function RR(r,t){return bg(r,t)}function LR(r,t){return Xu(r,t)}function PR(r,t){return Il(r,t)}function FR(r,t){return es(r,t)}function BR(r,t){return kr(r,t)}function zR(r,t){return Ta(r,t)}function $R(r,t){return Ta(r,t)}function GR(r,t){return Ta(r,t)}function UR(r,t){return or(r,t)}function WR(r,t){return or(r,t)}function VR(r,t){return or(r,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 *//**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jR(r){return new ox(r)}function HR(r){return cO(r)}function XR(r){return fO(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class UM extends Mt{constructor(){super(...arguments);this.model=null}setModel(t){if(!(t instanceof Jg))throw new Error("model must be a LayersModel, not some other Container");this.model=t}}function VE(r,t){return r<t}function WM(r,t){return r>t}class VM extends UM{constructor(t){super();if(t==null&&(t={}),t.restoreBestWeights)throw new Fs("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=t.monitor||"val_loss",this.minDelta=Math.abs(t.minDelta||0),this.patience=t.patience||0,this.verbose=t.verbose||0,this.mode=t.mode||"auto",this.baseline=t.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=VE:this.mode==="max"?this.monitorFunc=WM:this.monitor.indexOf("acc")!==-1?this.monitorFunc=WM:this.monitorFunc=VE,this.monitorFunc===VE&&(this.minDelta*=-1)}onTrainBegin(t){return Wr(this,null,function*(){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===VE?Infinity:-Infinity})}onEpochEnd(t,n){return Wr(this,null,function*(){yield U(n);const o=this.getMonitorValue(n);o!=null&&(this.monitorFunc(o-this.minDelta,this.best)?(this.best=o,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)))})}onTrainEnd(t){return Wr(this,null,function*(){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)})}getMonitorValue(t){t==null&&(t={});const n=t[this.monitor];return n==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(t)}`),n}}function YR(r){return new VM(r)}const KR={earlyStopping:YR};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var tg;(function(r){r[r.DT_INVALID=0]="DT_INVALID",r[r.DT_FLOAT=1]="DT_FLOAT",r[r.DT_DOUBLE=2]="DT_DOUBLE",r[r.DT_INT32=3]="DT_INT32",r[r.DT_UINT8=4]="DT_UINT8",r[r.DT_INT16=5]="DT_INT16",r[r.DT_INT8=6]="DT_INT8",r[r.DT_STRING=7]="DT_STRING",r[r.DT_COMPLEX64=8]="DT_COMPLEX64",r[r.DT_INT64=9]="DT_INT64",r[r.DT_BOOL=10]="DT_BOOL",r[r.DT_QINT8=11]="DT_QINT8",r[r.DT_QUINT8=12]="DT_QUINT8",r[r.DT_QINT32=13]="DT_QINT32",r[r.DT_BFLOAT16=14]="DT_BFLOAT16",r[r.DT_FLOAT_REF=101]="DT_FLOAT_REF",r[r.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",r[r.DT_INT32_REF=103]="DT_INT32_REF",r[r.DT_UINT8_REF=104]="DT_UINT8_REF",r[r.DT_INT16_REF=105]="DT_INT16_REF",r[r.DT_INT8_REF=106]="DT_INT8_REF",r[r.DT_STRING_REF=107]="DT_STRING_REF",r[r.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",r[r.DT_INT64_REF=109]="DT_INT64_REF",r[r.DT_BOOL_REF=110]="DT_BOOL_REF",r[r.DT_QINT8_REF=111]="DT_QINT8_REF",r[r.DT_QUINT8_REF=112]="DT_QUINT8_REF",r[r.DT_QINT32_REF=113]="DT_QINT32_REF",r[r.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(tg||(tg={}));var jM;(function(r){let t;(function(n){n[n.LEGACY=0]="LEGACY",n[n.V1=1]="V1",n[n.V2=2]="V2"})(t=r.CheckpointFormatVersion||(r.CheckpointFormatVersion={}))})(jM||(jM={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MT={};function ZR(r,t){const n={tfOpName:r,category:"custom",inputs:[],attrs:[],customExecutor:t};MT[r]=n}function HM(r){return MT[r]}function qR(r){delete MT[r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fe(r,t,n,o,u){const h=t.inputParams[r];if(h&&h.inputIndexStart!==void 0){const g=h.inputIndexStart,x=h.inputIndexEnd===0?void 0:h.inputIndexEnd===void 0?g+1:h.inputIndexEnd;if(h.type==="tensor")return Md(t.inputNames[h.inputIndexStart],n,o,u);if(h.type==="tensors")return t.inputNames.slice(g,x).map(rt=>Md(rt,n,o,u));const I=Md(t.inputNames.slice(g)[0],n,o,u),z=I.dataSync();return h.type==="number"?z[0]:an(I.shape,z)}const p=t.attrParams[r];return p&&p.value}function Md(r,t,n,o){const[u,h]=cp(r);if(o!=null){const g=o.getHashTableHandleByName(u);if(g!=null)return g}const p=n.currentContextIds.find(g=>!!t[jE(u,g)]);return p!==void 0?t[jE(u,p)][h]:void 0}function QR(r,t,n){return t[jE(r,n.currentContextId)]}function tm(r,t){const[n,o]=cp(r);return[jE(n,t&&t.currentContextId),o]}function jE(r,t){return t?`${r}-${t}`:r}function cp(r){const t=r.split(":");return t.length===1?[r,0]:[t[0],Number(t[t.length-1])]}function uj(r,t){const n=[];for(let o=0;o<r.length;o+=t)n.push(r.slice(o,o+t));return n}function HE(r,t,n){let o=Fe("pad",r,t,n);if(o==="explicit"){o=Fe("explicitPaddings",r,t,n);const u=[[0,0],[0,0],[0,0],[0,0]];for(let h=0;h<4;h++)u[h][0]=o[h*2],u[h][1]=o[h*2+1];return u}return o}function em(r){return r.kept?r:_h(r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JR=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tL=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],eL=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}];/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nL=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rL=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aL=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iL=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oL=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],sL=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uL=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lL=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cL=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fL=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hL=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dL=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pL=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vL=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}];var XM=$(48764).Buffer;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YM{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[dt,gt,wt,ot,pt,Nt,Gt,ke,Be,se,we,At,Yt,be,nn,Ee,ie],n=[].concat(...t.map(o=>o.json));this.opMappers=n.reduce((o,u)=>(o[u.tfOpName]=u,o),{})}transformGraph(t,n={}){const o=t.node,u=[],h=[],p=[],g=o.reduce((Tt,Vt)=>(Tt[Vt.name]=this.mapNode(Vt),Vt.op.startsWith("Placeholder")?u.push(Tt[Vt.name]):Vt.op==="Const"?h.push(Tt[Vt.name]):(Vt.input==null||Vt.input.length===0)&&p.push(Tt[Vt.name]),Tt),{});let x=[];const I=[];let z={},V={};n!=null&&(z=this.mapSignatureEntries(n.inputs),V=this.mapSignatureEntries(n.outputs));const rt=Object.keys(g);rt.forEach(Tt=>{const Vt=g[Tt];Vt.inputNames.forEach(ue=>{const[ye]=tm(ue);Vt.inputs.push(g[ye]),g[ye].children.push(Vt)})}),Object.keys(V).length===0?rt.forEach(Tt=>{const Vt=g[Tt];Vt.children.length===0&&I.push(Vt)}):Object.keys(V).forEach(Tt=>{const[Vt]=tm(Tt),ue=g[Vt];ue!=null&&(ue.signatureKey=V[Tt],I.push(ue))}),Object.keys(z).length>0?Object.keys(z).forEach(Tt=>{const[Vt]=tm(Tt),ue=g[Vt];ue&&(ue.signatureKey=z[Tt],x.push(ue))}):x=u;let Et={};t.library!=null&&t.library.function!=null&&(Et=t.library.function.reduce((Tt,Vt)=>(Tt[Vt.signature.name]=this.mapFunction(Vt),Tt),{}));const St={nodes:g,inputs:x,outputs:I,weights:h,placeholders:u,signature:n,functions:Et};return p.length>0&&(St.initNodes=p),St}mapSignatureEntries(t){return Object.keys(t||{}).reduce((n,o)=>(n[t[o].name]=o,n),{})}mapNode(t){const n=HM(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});const o={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(u=>u.startsWith("^")?u.substr(1):u),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return n.inputs!=null&&(o.inputParams=n.inputs.reduce((u,h)=>(u[h.name]={type:h.type,inputIndexStart:h.start,inputIndexEnd:h.end},u),{})),n.attrs!=null&&(o.attrParams=n.attrs.reduce((u,h)=>{const p=h.type;let g;switch(h.type){case"string":g=NT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=NT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"string[]":g=BT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=BT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"number":g=DT(t.attr,h.tfName,h.defaultValue||0),g===void 0&&!!h.tfDeprecatedName&&(g=DT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"number[]":g=FT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=FT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"bool":g=kT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=kT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"bool[]":g=$T(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=$T(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"shape":g=PT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=PT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"shape[]":g=zT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=zT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"dtype":g=RT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=RT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"dtype[]":g=LT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=LT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"func":g=ZM(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=ZM(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${h.type} for op: ${t.op}`)}return u[h.name]={value:g,type:p},u},{})),o}mapFunction(t){const n=t.nodeDef,o=[],u=[];let h={};n!=null&&(h=n.reduce((V,rt)=>(V[rt.name]=this.mapNode(rt),rt.op==="Const"&&u.push(V[rt.name]),V),{}));const p=[],g=[];t.signature.inputArg.forEach(V=>{const[rt]=tm(V.name),Et={name:rt,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:OT(V.type),type:"dtype"}},children:[]};Et.signatureKey=V.name,p.push(Et),h[rt]=Et}),Object.keys(h).forEach(V=>{const rt=h[V];rt.inputNames.forEach(Et=>{const[St]=tm(Et);rt.inputs.push(h[St]),h[St].children.push(rt)})});const I=t.ret;t.signature.outputArg.forEach(V=>{const[rt,Et]=tm(I[V.name]),St=h[rt];St!=null&&(St.defaultOutput=Et,g.push(St))});const z=this.mapArgsToSignature(t);return{nodes:h,inputs:p,outputs:g,weights:u,placeholders:o,signature:z}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((n,o)=>(n[o.name]=this.mapArgToTensorInfo(o),n),{}),outputs:t.signature.outputArg.reduce((n,o)=>(n[o.name]=this.mapArgToTensorInfo(o,t.ret),n),{})}}mapArgToTensorInfo(t,n){let o=t.name;return n!=null&&(o=n[o]),{name:o,dtype:t.type}}}function gL(r){const t=Ve().global;if(typeof t.atob!="undefined")return t.atob(r);if(typeof XM!="undefined")return new XM(r,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function KM(r,t){const n=Array.isArray(r)?String.fromCharCode.apply(null,r):gL(r);return t?n:n.toLowerCase()}function NT(r,t,n,o=!1){const u=r[t];return u!=null?KM(u.s,o):n}function kT(r,t,n){const o=r[t];return o?o.b:n}function DT(r,t,n){const o=r[t]||{},u=o.i!=null?o.i:o.f!=null?o.f:n;return typeof u=="number"?u:parseInt(u,10)}function OT(r){switch(typeof r=="string"&&(r=tg[r]),r){case tg.DT_FLOAT:return"float32";case tg.DT_INT32:case tg.DT_INT64:case tg.DT_INT8:case tg.DT_UINT8:return"int32";case tg.DT_BOOL:return"bool";case tg.DT_DOUBLE:return"float32";case tg.DT_STRING:return"string";default:return null}}function ZM(r,t,n){const o=r[t];return o&&o.func?o.func.name:n}function RT(r,t,n){const o=r[t];return o&&o.type?OT(o.type):n}function LT(r,t,n){const o=r[t];return o&&o.list&&o.list.type?o.list.type.map(u=>OT(u)):n}function qM(r){if(!r.unknownRank)return r.dim!=null?r.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function PT(r,t,n){const o=r[t];return o&&o.shape?qM(o.shape):n}function FT(r,t,n){const o=r[t];return o?((o.list.f&&o.list.f.length?o.list.f:o.list.i)||[]).map(u=>typeof u=="number"?u:parseInt(u,10)):n}function BT(r,t,n,o=!1){const u=r[t];return u&&u.list&&u.list.s?u.list.s.map(h=>KM(h,o)):n}function zT(r,t,n){const o=r[t];return o&&o.list&&o.list.shape?o.list.shape.map(u=>qM(u)):n}function $T(r,t,n){const o=r[t];return o&&o.list&&o.list.b?o.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mL{constructor(t,n,o){this.node=t,this.tensorMap=n,this.context=o,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(u=>this.getInput(u)),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce((u,h)=>(u[h]=this.getAttr(h),u),{}))}getInput(t){return Md(t,this.tensorMap,this.context)}getAttr(t,n){const o=this.node.rawAttrs[t];if(o.tensor!=null)return Md(t,this.tensorMap,this.context);if(o.i!=null||o.f!=null)return DT(this.node.rawAttrs,t,n);if(o.s!=null)return NT(this.node.rawAttrs,t,n);if(o.b!=null)return kT(this.node.rawAttrs,t,n);if(o.shape!=null)return PT(this.node.rawAttrs,t,n);if(o.type!=null)return RT(this.node.rawAttrs,t,n);if(o.list!=null){if(o.list.i!=null||o.list.f!=null)return FT(this.node.rawAttrs,t,n);if(o.list.s!=null)return BT(this.node.rawAttrs,t,n);if(o.list.shape!=null)return zT(this.node.rawAttrs,t,n);if(o.list.b!=null)return $T(this.node.rawAttrs,t,n);if(o.list.type!=null)return LT(this.node.rawAttrs,t,n)}return n}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yL=(r,t,n)=>{switch(r.op){case"BiasAdd":case"AddV2":case"Add":return[An(Fe("a",r,t,n),Fe("b",r,t,n))];case"AddN":return[ur(Fe("tensors",r,t,n))];case"FloorMod":case"Mod":return[iy(Fe("a",r,t,n),Fe("b",r,t,n))];case"Mul":return[Xn(Fe("a",r,t,n),Fe("b",r,t,n))];case"RealDiv":case"Div":return[rr(Fe("a",r,t,n),Fe("b",r,t,n))];case"DivNoNan":return[Xm(Fe("a",r,t,n),Fe("b",r,t,n))];case"FloorDiv":return[Or(Fe("a",r,t,n),Fe("b",r,t,n))];case"Sub":return[pi(Fe("a",r,t,n),Fe("b",r,t,n))];case"Minimum":return[cg(Fe("a",r,t,n),Fe("b",r,t,n))];case"Maximum":return[Po(Fe("a",r,t,n),Fe("b",r,t,n))];case"Pow":return[co(Fe("a",r,t,n),Fe("b",r,t,n))];case"SquaredDifference":return[f0(Fe("a",r,t,n),Fe("b",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},lj="arithmetic";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bL=(r,t,n)=>{switch(r.op){case"Abs":case"ComplexAbs":return[bl(Fe("x",r,t,n))];case"Acos":return[mr(Fe("x",r,t,n))];case"Acosh":return[Mr(Fe("x",r,t,n))];case"Asin":return[Hi(Fe("x",r,t,n))];case"Asinh":return[No(Fe("x",r,t,n))];case"Atan":return[xl(Fe("x",r,t,n))];case"Atan2":return[Rv(Fe("x",r,t,n),Fe("y",r,t,n))];case"Atanh":return[Tg(Fe("x",r,t,n))];case"Ceil":return[Zi(Fe("x",r,t,n))];case"Complex":return[Rc(Fe("real",r,t,n),Fe("imag",r,t,n))];case"Cos":return[lc(Fe("x",r,t,n))];case"Cosh":return[Jh(Fe("x",r,t,n))];case"Elu":return[fm(Fe("x",r,t,n))];case"Erf":return[k1(Fe("x",r,t,n))];case"Exp":return[Kf(Fe("x",r,t,n))];case"Expm1":return[Km(Fe("x",r,t,n))];case"Floor":return[pm(Fe("x",r,t,n))];case"Log":return[Oh(Fe("x",r,t,n))];case"Log1p":return[qm(Fe("x",r,t,n))];case"Imag":return[Q0(Fe("x",r,t,n))];case"Neg":return[Ic(Fe("x",r,t,n))];case"Reciprocal":return[X1(Fe("x",r,t,n))];case"Real":return[wm(Fe("x",r,t,n))];case"Relu":return[td(Fe("x",r,t,n))];case"Round":return[Y1(Fe("x",r,t,n))];case"Selu":return[o0(Fe("x",r,t,n))];case"Sigmoid":return[qt(Fe("x",r,t,n))];case"Sin":return[hy(Fe("x",r,t,n))];case"Sign":return[Z1(Fe("x",r,t,n))];case"Sinh":return[dy(Fe("x",r,t,n))];case"Softplus":return[gm(Fe("x",r,t,n))];case"Sqrt":return[Ti(Fe("x",r,t,n))];case"Square":return[Ai(Fe("x",r,t,n))];case"Tanh":return[Ce(Fe("x",r,t,n))];case"Tan":return[tb(Fe("x",r,t,n))];case"ClipByValue":return[li(Fe("x",r,t,n),Fe("clipValueMin",r,t,n),Fe("clipValueMax",r,t,n))];case"Relu6":return[i0(Fe("x",r,t,n))];case"Rsqrt":return[cy(Md(r.inputNames[0],t,n))];case"Prod":return[uy(Fe("x",r,t,n),Fe("axes",r,t,n))];case"LeakyRelu":return[vm(Fe("x",r,t,n),Fe("alpha",r,t,n))];case"Prelu":return[bm(Fe("x",r,t,n),Fe("alpha",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},cj="basic_math";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bv(r,t,n=""){yt(xL(r,t),()=>n+` Shapes ${r} and ${t} must match`)}function xL(r,t){if(r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(r[n]!==-1&&t[n]!==-1&&r[n]!==t[n])return!1;return!0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wL{constructor(t,n,o,u,h,p,g){this.name=t,this.dtype=n,this.maxSize=o,this.elementShape=u,this.identicalElementShapes=h,this.dynamicSize=p,this.clearAfterRead=g,this.tensors=[],this.closed_=!1,this.idTensor=zi(0),q(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const n=this.tensors[t];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(t){return t.map(n=>this.read(n))}write(t,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const o=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),bv(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),o.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(o.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);o.tensor=n,q(n),o.written=!0,this.tensors[t]=o}writeMany(t,n){if(t.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${n.length}.`);t.forEach((o,u)=>this.write(o,n[u]))}gather(t,n){if(!!n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(t)t=t.slice(0,this.size());else{t=[];for(let u=0;u<this.size();u++)t.push(u)}if(t.length===0)return Vc([],[0].concat(this.elementShape));const o=this.readMany(t);return bv(this.elementShape,o[0].shape,"TensorArray shape mismatch: "),nd(o,0)}concat(t){if(!!t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(this.size()===0)return Vc([],[0].concat(this.elementShape));const n=[];for(let u=0;u<this.size();u++)n.push(u);const o=this.readMany(n);return bv(this.elementShape,o[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${o[0].shape})`),_t(o,0)}scatter(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);const o=Math.max(...t);if(!this.dynamicSize&&o>=this.maxSize)throw new Error(`Max index must be < array size (${o}  vs. ${this.maxSize})`);this.writeMany(t,Cd(n,0))}split(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let o=0;const u=t.map(x=>(o+=x,o));if(o!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${o}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const h=o===0?0:n.size/o,p=[];zn(()=>{n=b(n,[1,o,h]);for(let x=0;x<t.length;++x){const I=x===0?0:u[x-1],z=[0,I,0],V=[1,t[x],h];p[x]=b(Ut(n,z,V),this.elementShape)}return p});const g=[];for(let x=0;x<t.length;x++)g[x]=x;this.writeMany(g,p)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f1{constructor(t,n,o,u=-1){this.tensors=t,this.elementShape=n,this.elementDtype=o,t!=null&&t.forEach(h=>{if(o!==h.dtype)throw new Error(`Invalid data types; op elements ${o}, but list elements ${h.dtype}`);bv(n,h.shape,"TensorList shape mismatch: "),q(h)}),this.idTensor=zi(0),this.maxNumElements=u,q(this.idTensor)}get id(){return this.idTensor.id}copy(){return new f1([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,n,o=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(o!==-1&&this.tensors.length!==o)throw new Error(`Operation expected a list with ${o} elements but got a list with ${this.tensors.length} elements.`);return bv(t,this.elementShape,"TensorList shape mismatch: "),zn(()=>{const u=this.tensors.map(h=>b(h,t));return nd(u,0)})}popBack(t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const o=this.tensors.pop();return bv(o.shape,t,"TensorList shape mismatch: "),b(o,t)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(bv(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");q(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);this.tensors.length=t}getItem(t,n,o){if(o!==this.elementDtype)throw new Error(`Invalid data types; op elements ${o}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);return bv(this.tensors[t].shape,n,"TensorList shape mismatch: "),this.tensors[t]}setItem(t,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);bv(this.elementShape,n.shape,"TensorList shape mismatch: "),q(n),this.tensors[t]=n}gather(t,n,o){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);return bv(this.elementShape,o,"TensorList shape mismatch: "),t=t.slice(0,this.size()),t.length===0?Vc([],[0].concat(this.elementShape)):zn(()=>{const u=t.map(h=>b(this.tensors[h],o));return nd(u,0)})}concat(t,n){if(!!t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);return bv(this.elementShape,n,"TensorList shape mismatch: "),this.size()===0?Vc([],[0].concat(this.elementShape)):zn(()=>{const o=this.tensors.map(u=>b(u,n));return _t(o,0)})}}function EL(r,t,n){const o=r.dtype;if(r.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${r.shape}`);if(r.dtype!==n)throw new Error(`Invalid data types; op elements ${r.dtype}, but list elements ${n}`);const u=r.shape.slice(1);bv(u,t,"TensorList shape mismatch: ");const h=Cd(r);return new f1(h,t,o)}function SL(r,t,n){return new f1([],r,t,n)}function CL(r,t,n,o){if(t.length!==r.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${r.shape[0]}`);const u=Math.max(...t);if(o!=null&&o!==-1&&u>=o)throw new Error(`Max index must be < array size (${u}  vs. ${o})`);const h=new f1([],n,r.dtype,o),p=Cd(r,0);return t.forEach((g,x)=>{h.setItem(g,p[x])}),h}function _L(r,t,n){let o=0;const u=t.map(x=>(o+=x,o));if(o!==r.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${o}, and tensor's shape is: ${r.shape}`);const h=o===0?0:r.size/o,p=zn(()=>{const x=[];r=b(r,[1,o,h]);for(let I=0;I<t.length;++I){const z=I===0?0:u[I-1],V=[0,z,0],rt=[1,t[I],h];x[I]=b(Ut(r,V,rt),n)}return r.dispose(),x}),g=new f1([],n,r.dtype,t.length);for(let x=0;x<p.length;x++)g.setItem(x,p[x]);return g}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IL=(r,t,n)=>Wr(this,null,function*(){switch(r.op){case"If":case"StatelessIf":{const o=Fe("thenBranch",r,t,n),u=Fe("elseBranch",r,t,n),h=Fe("cond",r,t,n),p=Fe("args",r,t,n);return(yield h.data())[0]?n.functionMap[o].executeFunctionAsync(p,n.tensorArrayMap,n.tensorListMap):n.functionMap[u].executeFunctionAsync(p,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const o=Fe("body",r,t,n),u=Fe("cond",r,t,n),h=Fe("args",r,t,n),p=yield n.functionMap[u].executeFunctionAsync(h,n.tensorArrayMap,n.tensorListMap),g=h.map(z=>z.id);let x=yield p[0].data();p.forEach(z=>{!z.kept&&g.indexOf(z.id)===-1&&z.dispose()});let I=h;for(;x[0];){const z=I;I=yield n.functionMap[o].executeFunctionAsync(I,n.tensorArrayMap,n.tensorListMap);const V=I.map(Et=>Et.id);z.forEach(Et=>{!Et.kept&&g.indexOf(Et.id)===-1&&V.indexOf(Et.id)===-1&&Et.dispose()});const rt=yield n.functionMap[u].executeFunctionAsync(I,n.tensorArrayMap,n.tensorListMap);x=yield rt[0].data(),rt.forEach(Et=>{!Et.kept&&g.indexOf(Et.id)===-1&&V.indexOf(Et.id)===-1&&Et.dispose()})}return I}case"LoopCond":{const o=Fe("pred",r,t,n);return[em(o)]}case"Switch":{const o=Fe("pred",r,t,n);let u=Fe("data",r,t,n);return u.kept||(u=em(u)),(yield o.data())[0]?[void 0,u]:[u,void 0]}case"Merge":{const o=r.inputNames.find(u=>Md(u,t,n)!==void 0);if(o){const u=Md(o,t,n);return[em(u)]}return}case"Enter":{const o=Fe("frameName",r,t,n),u=Fe("tensor",r,t,n);return n.enterFrame(o),[em(u)]}case"Exit":{const o=Fe("tensor",r,t,n);return n.exitFrame(),[em(o)]}case"NextIteration":{const o=Fe("tensor",r,t,n);return n.nextIteration(),[em(o)]}case"TensorArrayV3":{const o=Fe("size",r,t,n),u=Fe("dtype",r,t,n),h=Fe("elementShape",r,t,n),p=Fe("dynamicSize",r,t,n),g=Fe("clearAfterRead",r,t,n),x=Fe("identicalElementShapes",r,t,n),I=Fe("name",r,t,n),z=new wL(I,u,o,h,x,p,g);return n.addTensorArray(z),[z.idTensor,zi(1)]}case"TensorArrayWriteV3":{const o=Fe("tensorArrayId",r,t,n),u=Fe("index",r,t,n),h=Fe("tensor",r,t,n),p=n.getTensorArray(o.id);return p.write(u,h),[p.idTensor]}case"TensorArrayReadV3":{const o=Fe("tensorArrayId",r,t,n),u=Fe("index",r,t,n);return[n.getTensorArray(o.id).read(u)]}case"TensorArrayGatherV3":{const o=Fe("tensorArrayId",r,t,n),u=Fe("indices",r,t,n),h=Fe("dtype",r,t,n);return[n.getTensorArray(o.id).gather(u,h)]}case"TensorArrayScatterV3":{const o=Fe("tensorArrayId",r,t,n),u=Fe("indices",r,t,n),h=Fe("tensor",r,t,n),p=n.getTensorArray(o.id);return p.scatter(u,h),[p.idTensor]}case"TensorArrayConcatV3":{const o=Fe("tensorArrayId",r,t,n),u=n.getTensorArray(o.id),h=Fe("dtype",r,t,n);return[u.concat(h)]}case"TensorArraySplitV3":{const o=Fe("tensorArrayId",r,t,n),u=Fe("tensor",r,t,n),h=Fe("lengths",r,t,n),p=n.getTensorArray(o.id);return p.split(h,u),[p.idTensor]}case"TensorArraySizeV3":{const o=Fe("tensorArrayId",r,t,n),u=n.getTensorArray(o.id);return[zi(u.size(),"int32")]}case"TensorArrayCloseV3":{const o=Fe("tensorArrayId",r,t,n),u=n.getTensorArray(o.id);return u.clearAndClose(),[u.idTensor]}case"TensorListSetItem":{const o=Fe("tensorListId",r,t,n),u=Fe("index",r,t,n),h=Fe("tensor",r,t,n),p=n.getTensorList(o.id);return p.setItem(u,h),[p.idTensor]}case"TensorListGetItem":{const o=Fe("tensorListId",r,t,n),u=Fe("index",r,t,n),h=Fe("elementShape",r,t,n),p=Fe("elementDType",r,t,n);return[n.getTensorList(o.id).getItem(u,h,p)]}case"TensorListScatterV2":case"TensorListScatter":{const o=Fe("indices",r,t,n),u=Fe("tensor",r,t,n),h=Fe("elementShape",r,t,n),p=Fe("numElements",r,t,n),g=CL(u,o,h,p);return n.addTensorList(g),[g.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const o=Fe("elementShape",r,t,n),u=Fe("elementDType",r,t,n);let h;r.op==="TensorListReserve"?h="numElements":h="maxNumElements";const p=Fe(h,r,t,n),g=SL(o,u,p);return n.addTensorList(g),[g.idTensor]}case"TensorListGather":{const o=Fe("tensorListId",r,t,n),u=Fe("indices",r,t,n),h=Fe("elementShape",r,t,n),p=Fe("elementDType",r,t,n);return[n.getTensorList(o.id).gather(u,p,h)]}case"TensorListStack":{const o=Fe("tensorListId",r,t,n),u=Fe("elementShape",r,t,n),h=Fe("elementDType",r,t,n),p=Fe("numElements",r,t,n);return[n.getTensorList(o.id).stack(u,h,p)]}case"TensorListFromTensor":{const o=Fe("tensor",r,t,n),u=Fe("elementShape",r,t,n),h=Fe("elementDType",r,t,n),p=EL(o,u,h);return n.addTensorList(p),[p.idTensor]}case"TensorListConcat":{const o=Fe("tensorListId",r,t,n),u=n.getTensorList(o.id),h=Fe("dtype",r,t,n),p=Fe("elementShape",r,t,n);return[u.concat(h,p)]}case"TensorListPushBack":{const o=Fe("tensorListId",r,t,n),u=Fe("tensor",r,t,n),h=n.getTensorList(o.id);return h.pushBack(u),[h.idTensor]}case"TensorListPopBack":{const o=Fe("tensorListId",r,t,n),u=Fe("elementShape",r,t,n),h=Fe("elementDType",r,t,n);return[n.getTensorList(o.id).popBack(u,h)]}case"TensorListSplit":{const o=Fe("tensor",r,t,n),u=Fe("elementShape",r,t,n),h=Fe("lengths",r,t,n),p=_L(o,h,u);return n.addTensorList(p),[p.idTensor]}default:throw TypeError(`Node type ${r.op} is not implemented`)}}),fj="control";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QM(r,t,n){const[o,u]=Fe("fusedOps",r,t,n),h=o==="biasadd",p=u==="prelu",g=o==="fusedbatchnorm",x=Fe("numArgs",r,t,n);if(h){if(p&&x!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!p&&x!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(g)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");const I=Fe("strides",r,t,n),z=HE(r,t,n),V=Fe("dataFormat",r,t,n).toUpperCase(),rt=Fe("dilations",r,t,n),[Et,St]=Fe("args",r,t,n),Tt=Fe("leakyreluAlpha",r,t,n);return{stride:I,pad:z,dataFormat:V,dilations:rt,biasArg:Et,preluArg:St,activationFunc:u,leakyreluAlpha:Tt}}const TL=(r,t,n)=>{switch(r.op){case"Conv1D":{const o=Fe("stride",r,t,n),u=Fe("pad",r,t,n),h=Fe("dataFormat",r,t,n).toUpperCase(),p=Fe("dilation",r,t,n);return[Ho(Fe("x",r,t,n),Fe("filter",r,t,n),o,u,h,p)]}case"Conv2D":{const o=Fe("strides",r,t,n),u=HE(r,t,n),h=Fe("dataFormat",r,t,n).toUpperCase(),p=Fe("dilations",r,t,n);return[qs(Fe("x",r,t,n),Fe("filter",r,t,n),[o[1],o[2]],u,h,[p[1],p[2]])]}case"_FusedConv2D":{const{stride:o,pad:u,dataFormat:h,dilations:p,biasArg:g,preluArg:x,activationFunc:I,leakyreluAlpha:z}=QM(r,t,n);return[lb({x:Fe("x",r,t,n),filter:Fe("filter",r,t,n),strides:[o[1],o[2]],pad:u,dataFormat:h,dilations:[p[1],p[2]],bias:g,activation:I,preluActivationWeights:x,leakyreluAlpha:z})]}case"FusedDepthwiseConv2dNative":{const{stride:o,pad:u,dataFormat:h,dilations:p,biasArg:g,preluArg:x,activationFunc:I,leakyreluAlpha:z}=QM(r,t,n);return[fb({x:Fe("x",r,t,n),filter:Fe("filter",r,t,n),strides:[o[1],o[2]],pad:u,dataFormat:h,dilations:[p[1],p[2]],bias:g,activation:I,preluActivationWeights:x,leakyreluAlpha:z})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const o=Fe("outputShape",r,t,n),u=Fe("strides",r,t,n),h=HE(r,t,n);return[_u(Fe("x",r,t,n),Fe("filter",r,t,n),o,[u[1],u[2]],h)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const o=Fe("strides",r,t,n),u=HE(r,t,n),h=Fe("dilations",r,t,n),p=Fe("dataFormat",r,t,n).toUpperCase();return[Qd(Fe("input",r,t,n),Fe("filter",r,t,n),[o[1],o[2]],u,p,[h[1],h[2]])]}case"Conv3D":{const o=Fe("strides",r,t,n),u=Fe("pad",r,t,n),h=Fe("dataFormat",r,t,n).toUpperCase(),p=Fe("dilations",r,t,n);return[yl(Fe("x",r,t,n),Fe("filter",r,t,n),[o[1],o[2],o[3]],u,h,[p[1],p[2],p[3]])]}case"AvgPool":{const o=Fe("strides",r,t,n),u=Fe("pad",r,t,n),h=Fe("kernelSize",r,t,n);return[D(Fe("x",r,t,n),[h[1],h[2]],[o[1],o[2]],u)]}case"MaxPool":{const o=Fe("strides",r,t,n),u=Fe("pad",r,t,n),h=Fe("kernelSize",r,t,n);return[Dg(Fe("x",r,t,n),[h[1],h[2]],[o[1],o[2]],u)]}case"MaxPoolWithArgmax":{const o=Fe("strides",r,t,n),u=Fe("pad",r,t,n),h=Fe("kernelSize",r,t,n),p=Fe("includeBatchInIndex",r,t,n),{result:g,indexes:x}=Vx(Fe("x",r,t,n),[h[1],h[2]],[o[1],o[2]],u,p);return[g,x]}case"AvgPool3D":{const o=Fe("strides",r,t,n),u=Fe("pad",r,t,n),h=Fe("kernelSize",r,t,n);return[lt(Fe("x",r,t,n),[h[1],h[2],h[3]],[o[1],o[2],o[3]],u)]}case"MaxPool3D":{const o=Fe("strides",r,t,n),u=Fe("pad",r,t,n),h=Fe("kernelSize",r,t,n);return[lg(Fe("x",r,t,n),[h[1],h[2],h[3]],[o[1],o[2],o[3]],u)]}case"Dilation2D":{const o=Fe("strides",r,t,n),u=Fe("pad",r,t,n),h=Fe("dilations",r,t,n),p=o[1],g=o[2],x=h[1],I=h[2];return[cm(Fe("x",r,t,n),Fe("filter",r,t,n),[p,g],u,[x,I],"NHWC")]}default:throw TypeError(`Node type ${r.op} is not implemented`)}},hj="convolution";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AL=(r,t,n)=>{switch(r.op){case"Fill":{const o=Fe("shape",r,t,n),u=Fe("dtype",r,t,n),h=Fe("value",r,t,n);return[Jo(o,h,u)]}case"LinSpace":{const o=Fe("start",r,t,n),u=Fe("stop",r,t,n),h=Fe("num",r,t,n);return[L1(o,u,h)]}case"Multinomial":{const o=Fe("logits",r,t,n),u=Fe("numSamples",r,t,n),h=Fe("seed",r,t,n);return[t0(o,u,h)]}case"OneHot":{const o=Fe("indices",r,t,n),u=Fe("depth",r,t,n),h=Fe("onValue",r,t,n),p=Fe("offValue",r,t,n);return[Df(o,u,h,p)]}case"Ones":return[sv(Fe("shape",r,t,n),Fe("dtype",r,t,n))];case"OnesLike":return[Zc(Fe("x",r,t,n))];case"RandomUniform":return[r0(Fe("shape",r,t,n),Fe("minval",r,t,n),Fe("maxval",r,t,n),Fe("dtype",r,t,n))];case"Range":{const o=Fe("start",r,t,n),u=Fe("stop",r,t,n),h=Fe("step",r,t,n);return[Lh(o,u,h,Fe("dtype",r,t,n))]}case"TruncatedNormal":{const o=Fe("shape",r,t,n),u=Fe("mean",r,t,n),h=Fe("stdDev",r,t,n),p=Fe("seed",r,t,n);return[by(o,u,h,Fe("dtype",r,t,n),p)]}case"Zeros":return[Tc(Fe("shape",r,t,n),Fe("dtype",r,t,n))];case"ZerosLike":return[bi(Fe("x",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},dj="creation";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GT(r,t,n){const o=Fe("boxes",r,t,n),u=Fe("scores",r,t,n),h=Fe("maxOutputSize",r,t,n),p=Fe("iouThreshold",r,t,n),g=Fe("scoreThreshold",r,t,n),x=Fe("softNmsSigma",r,t,n);return{boxes:o,scores:u,maxOutputSize:h,iouThreshold:p,scoreThreshold:g,softNmsSigma:x}}const ML=(r,t,n)=>Wr(this,null,function*(){switch(r.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:u,maxOutputSize:h,iouThreshold:p,scoreThreshold:g,softNmsSigma:x}=GT(r,t,n),I=yield ep.nonMaxSuppressionWithScoreAsync(o,u,h,p,g,x);return[I.selectedIndices,I.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:u,maxOutputSize:h,iouThreshold:p,scoreThreshold:g}=GT(r,t,n),x=Fe("padToMaxOutputSize",r,t,n),I=yield ep.nonMaxSuppressionPaddedAsync(o,u,h,p,g,x);return[I.selectedIndices,I.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:u,maxOutputSize:h,iouThreshold:p,scoreThreshold:g}=GT(r,t,n);return[yield ep.nonMaxSuppressionAsync(o,u,h,p,g)]}case"Where":{const o=eo(Fe("condition",r,t,n),"bool"),u=[yield Bf(o)];return o.dispose(),u}case"ListDiff":return nw(Fe("x",r,t,n),Fe("y",r,t,n));default:throw TypeError(`Node type ${r.op} is not implemented`)}}),pj="dynamic";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NL=(r,t,n)=>{switch(r.op){case"TopKV2":{const o=Fe("x",r,t,n),u=Fe("k",r,t,n),h=Fe("sorted",r,t,n),p=yy(o,u,h);return[p.values,p.indices]}case"Unique":{const o=Fe("x",r,t,n),u=d0(o);return[u.values,u.indices]}case"UniqueV2":{const o=Fe("x",r,t,n),u=Fe("axis",r,t,n),h=d0(o,u);return[h.values,h.indices]}default:throw TypeError(`Node type ${r.op} is not implemented`)}},vj="evaluation";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kL=(r,t,n)=>{switch(r.op){case"Const":return t[r.name];case"PlaceholderWithDefault":const o=Fe("default",r,t,n);return[Md(r.name,t,n)||o];case"Placeholder":return[Md(r.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const I=Fe("x",r,t,n);return[em(I)]}case"IdentityN":return Fe("x",r,t,n).map(I=>em(I));case"Snapshot":const u=Fe("x",r,t,n);return[em(u)];case"Shape":return[Ff(Fe("x",r,t,n).shape,"int32")];case"ShapeN":return Fe("x",r,t,n).map(I=>Ff(I.shape));case"Size":return[zi(Fe("x",r,t,n).size,"int32")];case"Rank":return[zi(Fe("x",r,t,n).rank,"int32")];case"NoOp":return[zi(1)];case"Print":const h=Fe("x",r,t,n),p=Fe("data",r,t,n),g=Fe("message",r,t,n),x=Fe("summarize",r,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(g);for(let I=0;I<p.length;I++)console.log(Array.prototype.slice.call(p[I].dataSync()).slice(0,x));return[h];default:throw TypeError(`Node type ${r.op} is not implemented`)}},gj="graph";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DL{constructor(t,n){this.keyDType=t,this.valueDType=n,this.handle=zi(0),this.tensorMap=new Map,q(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}import(t,n){return Wr(this,null,function*(){this.checkKeyAndValueTensor(t,n);const o=yield t.data();return this.tensorMap.forEach(u=>u.dispose()),this.tensorMap.clear(),zn(()=>{const u=Cd(n),h=o.length,p=u.length;yt(h===p,()=>`The number of elements doesn't match, keys has ${h} elements, the values has ${p} elements.`);for(let g=0;g<h;g++){const x=o[g],I=u[g];q(I),this.tensorMap.set(x,I)}return this.handle})})}find(t,n){return Wr(this,null,function*(){this.checkKeyAndValueTensor(t,n);const o=yield t.data();return zn(()=>{const u=[];for(let h=0;h<o.length;h++){const p=o[h],g=this.findWithDefault(p,n);u.push(g)}return nd(u)})})}findWithDefault(t,n){const o=this.tensorMap.get(t);return o!=null?o:n}checkKeyAndValueTensor(t,n){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OL=(r,t,n,o)=>Wr(this,null,function*(){switch(r.op){case"HashTable":case"HashTableV2":{const u=Fe("keyDType",r,t,n),h=Fe("valueDType",r,t,n),p=new DL(u,h);return o.addHashTable(r.name,p),[p.handle]}case"LookupTableImport":case"LookupTableImportV2":{const u=Fe("tableHandle",r,t,n,o),h=Fe("keys",r,t,n),p=Fe("values",r,t,n);return[yield o.getHashTableById(u.id).import(h,p)]}case"LookupTableFind":case"LookupTableFindV2":{const u=Fe("tableHandle",r,t,n,o),h=Fe("keys",r,t,n),p=Fe("defaultValue",r,t,n);return[yield o.getHashTableById(u.id).find(h,p)]}default:throw TypeError(`Node type ${r.op} is not implemented`)}}),mj="hash_table";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RL=(r,t,n)=>{switch(r.op){case"ResizeBilinear":{const o=Fe("images",r,t,n),u=Fe("size",r,t,n),h=Fe("alignCorners",r,t,n),p=Fe("halfPixelCenters",r,t,n);return[ep.resizeBilinear(o,[u[0],u[1]],h,p)]}case"ResizeNearestNeighbor":{const o=Fe("images",r,t,n),u=Fe("size",r,t,n),h=Fe("alignCorners",r,t,n),p=Fe("halfPixelCenters",r,t,n);return[ep.resizeNearestNeighbor(o,[u[0],u[1]],h,p)]}case"CropAndResize":{const o=Fe("image",r,t,n),u=Fe("boxes",r,t,n),h=Fe("boxInd",r,t,n),p=Fe("cropSize",r,t,n),g=Fe("method",r,t,n),x=Fe("extrapolationValue",r,t,n);return[ep.cropAndResize(o,u,h,p,g,x)]}default:throw TypeError(`Node type ${r.op} is not implemented`)}},yj="image";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LL=(r,t,n)=>{switch(r.op){case"Equal":return[Hu(Fe("a",r,t,n),Fe("b",r,t,n))];case"NotEqual":return[fg(Fe("a",r,t,n),Fe("b",r,t,n))];case"Greater":return[Ed(Fe("a",r,t,n),Fe("b",r,t,n))];case"GreaterEqual":return[Jd(Fe("a",r,t,n),Fe("b",r,t,n))];case"Less":return[Zm(Fe("a",r,t,n),Fe("b",r,t,n))];case"LessEqual":return[og(Fe("a",r,t,n),Fe("b",r,t,n))];case"LogicalAnd":return[Rh(Fe("a",r,t,n),Fe("b",r,t,n))];case"LogicalNot":return[kg(Fe("a",r,t,n))];case"LogicalOr":return[Jm(Fe("a",r,t,n),Fe("b",r,t,n))];case"Select":case"SelectV2":return[Lf(Fe("condition",r,t,n),Fe("a",r,t,n),Fe("b",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},bj="logical";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PL=(r,t,n)=>{switch(r.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[Zs(Fe("a",r,t,n),Fe("b",r,t,n),Fe("transposeA",r,t,n),Fe("transposeB",r,t,n))];case"Transpose":return[cu(Fe("x",r,t,n),Fe("perm",r,t,n))];case"_FusedMatMul":const[o,u]=Fe("fusedOps",r,t,n),h=o==="biasadd",p=u==="prelu",g=Fe("numArgs",r,t,n),x=Fe("leakyreluAlpha",r,t,n);if(h){if(p&&g!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!p&&g!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[I,z]=Fe("args",r,t,n);return[_m({a:Fe("a",r,t,n),b:Fe("b",r,t,n),transposeA:Fe("transposeA",r,t,n),transposeB:Fe("transposeB",r,t,n),bias:I,activation:u,preluActivationWeights:z,leakyreluAlpha:x})];default:throw TypeError(`Node type ${r.op} is not implemented`)}},xj="matrices";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FL=(r,t,n)=>{switch(r.op){case"FusedBatchNorm":case"FusedBatchNormV2":return[Sr(Fe("x",r,t,n),Fe("mean",r,t,n),Fe("variance",r,t,n),Fe("offset",r,t,n),Fe("scale",r,t,n),Fe("epsilon",r,t,n))];case"FusedBatchNormV3":return[Sr(Fe("x",r,t,n),Fe("mean",r,t,n),Fe("variance",r,t,n),Fe("offset",r,t,n),Fe("scale",r,t,n),Fe("epsilon",r,t,n))];case"LRN":return[J0(Fe("x",r,t,n),Fe("radius",r,t,n),Fe("bias",r,t,n),Fe("alpha",r,t,n),Fe("beta",r,t,n))];case"Softmax":return[u0(Fe("x",r,t,n))];case"LogSoftmax":return[ty(Fe("x",r,t,n))];case"SparseToDense":return[ob(Fe("sparseIndices",r,t,n),Fe("outputShape",r,t,n),Fe("sparseValues",r,t,n),Fe("defaultValue",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},wj="normalization";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BL=(r,t,n)=>{switch(r.op){case"Max":{const p=Fe("axis",r,t,n),g=Fe("keepDims",r,t,n);return[Sd(Fe("x",r,t,n),p,g)]}case"Mean":{const p=Fe("axis",r,t,n),g=Fe("keepDims",r,t,n);return[cc(Fe("x",r,t,n),p,g)]}case"Min":{const p=Fe("axis",r,t,n),g=Fe("keepDims",r,t,n);return[ym(Fe("x",r,t,n),p,g)]}case"Sum":{const p=Fe("axis",r,t,n),g=Fe("keepDims",r,t,n);return[ss(Fe("x",r,t,n),p,g)]}case"All":{const p=Fe("axis",r,t,n),g=Fe("keepDims",r,t,n);return[Dr(Fe("x",r,t,n),p,g)]}case"Any":{const p=Fe("axis",r,t,n),g=Fe("keepDims",r,t,n);return[_a(Fe("x",r,t,n),p,g)]}case"ArgMax":{const p=Fe("axis",r,t,n);return[ga(Fe("x",r,t,n),p)]}case"ArgMin":{const p=Fe("axis",r,t,n);return[uo(Fe("x",r,t,n),p)]}case"Prod":{const p=Fe("axis",r,t,n),g=Fe("keepDims",r,t,n);return[uy(Fe("x",r,t,n),p,g)]}case"Cumsum":{const p=Fe("axis",r,t,n),g=Fe("exclusive",r,t,n),x=Fe("reverse",r,t,n);return[Mg(Fe("x",r,t,n),p,g,x)]}case"Bincount":const o=Fe("x",r,t,n),u=Fe("weights",r,t,n),h=Fe("size",r,t,n);return[va(o,u,h)];case"DenseBincount":{const p=Fe("x",r,t,n),g=Fe("weights",r,t,n),x=Fe("size",r,t,n),I=Fe("binaryOutput",r,t,n);return[um(p,g,x,I)]}default:throw TypeError(`Node type ${r.op} is not implemented`)}},Ej="reduction";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zL=(r,t,n)=>{switch(r.op){case"ConcatV2":case"Concat":{const o=Fe("n",r,t,n),u=Fe("axis",r,t,n);let h=Fe("tensors",r,t,n);return h=h.slice(0,o),[_t(h,u)]}case"Gather":{const o=Fe("x",r,t,n),u=Fe("indices",r,t,n);return[Fv(o,eo(u,"int32"),0)]}case"GatherV2":{const o=Fe("axis",r,t,n),u=Fe("batchDims",r,t,n),h=Fe("x",r,t,n),p=Fe("indices",r,t,n);return[Fv(h,eo(p,"int32"),o,u)]}case"Reverse":{const o=Fe("dims",r,t,n),u=[];for(let p=0;p<o.length;p++)o[p]&&u.push(p);const h=Fe("x",r,t,n);return[Ph(h,u)]}case"ReverseV2":{const o=Fe("axis",r,t,n),u=Fe("x",r,t,n);return[Ph(u,o)]}case"Slice":{const o=Fe("begin",r,t,n),u=Fe("size",r,t,n);return[Ut(Fe("x",r,t,n),o,u)]}case"StridedSlice":{const o=Fe("begin",r,t,n),u=Fe("end",r,t,n),h=Fe("strides",r,t,n),p=Fe("beginMask",r,t,n),g=Fe("endMask",r,t,n),x=Fe("ellipsisMask",r,t,n),I=Fe("newAxisMask",r,t,n),z=Fe("shrinkAxisMask",r,t,n),V=Fe("x",r,t,n);return[J1(V,o,u,h,p,g,x,I,z)]}case"Pack":return zn(()=>{const o=Fe("axis",r,t,n),u=Fe("tensors",r,t,n),h=u[0].shape,p=Uv(u[0]).shape,g=u.map(x=>{const I=Un(x.shape,h);if(!I&&!Un(Uv(x).shape,p))throw new Error("the input tensors shape does not match");return I?x:b(x,h)});return[nd(g,o)]});case"Unpack":{const o=Fe("axis",r,t,n),u=Fe("tensor",r,t,n);return Cd(u,o)}case"Tile":{const o=Fe("reps",r,t,n);return[Pv(Fe("x",r,t,n),o)]}case"Split":case"SplitV":{const o=Fe("axis",r,t,n),u=Fe("numOrSizeSplits",r,t,n),h=Fe("x",r,t,n);return ed(h,u,o)}case"ScatterNd":{const o=Fe("indices",r,t,n),u=Fe("values",r,t,n),h=Fe("shape",r,t,n);return[pw(o,u,h)]}case"GatherNd":{const o=Fe("x",r,t,n),u=Fe("indices",r,t,n);return[gw(o,u)]}case"SparseToDense":{const o=Fe("sparseIndices",r,t,n),u=Fe("outputShape",r,t,n),h=Fe("sparseValues",r,t,n),p=Fe("defaultValue",r,t,n);return[ob(o,h,u,h.dtype===p.dtype?p:eo(p,h.dtype))]}default:throw TypeError(`Node type ${r.op} is not implemented`)}},Sj="slice_join";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $L=(r,t,n)=>{switch(r.op){case"FFT":return[l0(Fe("x",r,t,n))];case"IFFT":return[Og(Fe("x",r,t,n))];case"RFFT":return[c0(Fe("x",r,t,n))];case"IRFFT":return[vy(Fe("x",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},Cj="spectral";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GL=(r,t,n)=>{switch(r.op){case"Cast":return[eo(Fe("x",r,t,n),Fe("dtype",r,t,n))];case"ExpandDims":{const o=Fe("axis",r,t,n);return[wd(Fe("x",r,t,n),o)]}case"Squeeze":{const o=Fe("axis",r,t,n);return[Uv(Fe("x",r,t,n),o)]}case"Reshape":return[b(Fe("x",r,t,n),Fe("shape",r,t,n))];case"MirrorPad":return[U1(Fe("x",r,t,n),Fe("padding",r,t,n),Fe("mode",r,t,n))];case"PadV2":case"Pad":return[$v(Fe("x",r,t,n),Fe("padding",r,t,n),Fe("constantValue",r,t,n))];case"SpaceToBatchND":{const o=Fe("blockShape",r,t,n),u=Fe("paddings",r,t,n);return[n0(Fe("x",r,t,n),o,u)]}case"BatchToSpaceND":{const o=Fe("blockShape",r,t,n),u=Fe("crops",r,t,n);return[Rn(Fe("x",r,t,n),o,u)]}case"DepthToSpace":{const o=Fe("blockSize",r,t,n),u=Fe("dataFormat",r,t,n).toUpperCase();return[ig(Fe("x",r,t,n),o,u)]}case"BroadcastTo":return[Ja(Fe("x",r,t,n),Fe("shape",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},_j="transformation";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JM(r,t,n,o){const u=((h,p,g)=>{switch(h.category){case"arithmetic":return zn(()=>yL(h,p,g));case"basic_math":return zn(()=>bL(h,p,g));case"control":return IL(h,p,g);case"convolution":return zn(()=>TL(h,p,g));case"creation":return zn(()=>AL(h,p,g));case"dynamic":return ML(h,p,g);case"evaluation":return zn(()=>NL(h,p,g));case"image":return zn(()=>RL(h,p,g));case"graph":return zn(()=>kL(h,p,g));case"logical":return zn(()=>LL(h,p,g));case"matrices":return zn(()=>PL(h,p,g));case"normalization":return zn(()=>FL(h,p,g));case"reduction":return zn(()=>BL(h,p,g));case"slice_join":return zn(()=>zL(h,p,g));case"spectral":return zn(()=>$L(h,p,g));case"transformation":return zn(()=>GL(h,p,g));case"hash_table":return OL(h,p,g,o);case"custom":const x=HM(h.op);if(x&&x.customExecutor)return x.customExecutor(new mL(h,p,g));throw TypeError(`Custom op ${h.op} is not registered.`);default:throw TypeError(`Unknown op '${h.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(r,t,n);return $t(u)?u.then(h=>[].concat(h)):[].concat(u)}class tN{constructor(t={},n={},o={},u={}){this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=o,this.functionMap=u,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,n){return{id:t,frameName:n,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let n=0;n<this.contexts.length-1;n++){const o=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(o))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(t);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(t)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eN(r,t,n,o){const u=new Set,h=[];let p=null,g=null;const x=new Set,I=Object.keys(r).map(rt=>cp(rt)[0]);let z=[];o!=null&&(z=o.map(rt=>cp(rt.name)[0]));const V=[...t];for(;V.length>0;){const rt=V.pop();if((nN(rt)||HL(rt)||XL(rt))&&p==null&&(p=rt,g=p.children.map(Et=>Et.name).filter(Et=>u.has(Et))),u.add(rt.name),n[rt.name]==null&&I.indexOf(rt.name)===-1&&z.indexOf(rt.name)===-1){if(rt.inputs.length===0){h.push(rt.name);continue}rt.inputs.forEach(Et=>{x.has(Et.name)||(x.add(Et.name),V.push(Et))})}}return{inputs:r,outputs:t,usedNodes:u,missingInputs:h,dynamicNode:p,syncInputs:g}}function UL(r,t,n){const{usedNodes:o,inputs:u}=n,h=[],p=Object.keys(u).map(z=>cp(z)[0]).map(z=>r.nodes[z]),g=r.initNodes;p.forEach(z=>{o.has(z.name)&&h.push(z)}),r.weights.forEach(z=>{o.has(z.name)&&h.push(z)}),g!=null&&g.forEach(z=>{o.has(z.name)&&h.push(z)});const x=new Set,I=[];for(;h.length>0;){const z=h.pop();x.add(z.name),t[z.name]||I.push(z),z.children.forEach(V=>{!x.has(V.name)&&o.has(V.name)&&V.inputs.every(rt=>x.has(rt.name))&&h.push(V)})}return I}const WL=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],VL=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],jL=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2"];function nN(r){return WL.indexOf(r.op)>=0}function HL(r){return VL.indexOf(r.op)>=0}function XL(r){return jL.indexOf(r.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XE{constructor(t,n){this.graph=t,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(o=>{this._functionExecutorMap[o]=new XE(t.functions[o],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const n=Object.keys(t).map(o=>t[o].map(u=>u.id));this._weightIds=[].concat(...n),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const n=t.signatureKey||t.name;return t.defaultOutput?`${n}:${t.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((t,n)=>(t[n]=this._functions[n].signature,t),{})}getCompilationKey(t,n){const o=t.map(h=>h.name).sort(),u=n.map(h=>h.name).sort();return o.join(this.SEPERATOR)+"--"+u.join(this.SEPERATOR)}compile(t,n){const o=eN(t,n,this.weightMap,this._initNodes),{missingInputs:u,dynamicNode:h,syncInputs:p}=o;if(h!=null)throw new Error(`This execution contains the node '${h.name}', which has the dynamic op '${h.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${p}]`);if(u.length>0){const g=n.map(I=>I.name),x=Object.keys(t);throw new Error(`Cannot compute the outputs [${g}] from the provided inputs [${x}]. Missing the following inputs: [${u}]`)}return UL(this.graph,this.weightMap,o)}execute(t,n){t=this.mapInputs(t);const o=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);const u=o.map(V=>this.graph.nodes[cp(V)[0]]),h=n.map(V=>cp(V)[0]);let p=h.map(V=>this.graph.nodes[V]);p.length===0&&(p=this._outputs);const g=this.getCompilationKey(u,p);let x=this.compiledMap.get(g);x==null&&(x=this.compile(t,p),this.compiledMap.set(g,x));const I={},z={};return zn(()=>{const V=new tN(this.weightMap,I,z,this.functionExecutorMap),rt=Object.assign({},this.weightMap);Object.keys(t).forEach(Tt=>{const[Vt,ue]=cp(Tt),ye=[];ye[ue]=t[Tt],rt[Vt]=ye});const Et=this.getFrozenTensorIds(rt),St={};for(let Tt=0;Tt<x.length;Tt++){const Vt=x[Tt];if(!rt[Vt.name]){const ue=JM(Vt,rt,V,this._resourceManager);if($t(ue))throw new Error(`The execution of the op '${Vt.op}' returned a promise. Please use model.executeAsync() instead.`);rt[Vt.name]=ue,this.checkTensorForDisposal(Vt.name,Vt,rt,V,Et,h,St)}}return this.parent==null&&V.dispose(Et),n.map(Tt=>Md(Tt,rt,V))})}getFrozenTensorIds(t){const n=[].concat.apply([],Object.keys(t).map(o=>t[o]).map(o=>o.map(u=>u.id)));return new Set(n)}checkTensorForDisposal(t,n,o,u,h,p,g){n.category==="control"||p.indexOf(t)!==-1||(o[t].forEach(x=>{x!=null&&(g[x.id]=(g[x.id]||0)+n.children.length)}),n.inputs.forEach(x=>{if(x.category!=="control"){const I=QR(x.name,o,u);I!=null&&I.forEach(z=>{if(z&&!h.has(z.id)){const V=g[z.id];V===1?(z.dispose(),delete g[z.id]):V!=null&&g[z.id]--}})}}))}executeAsync(t,n){return Wr(this,null,function*(){return this._executeAsync(t,n)})}_executeAsync(p,g){return Wr(this,arguments,function*(t,n,o=!1,u={},h={}){o||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));const x=new tN(this.weightMap,u,h,this.functionExecutorMap),I=yield this.executeWithControlFlow(t,x,n,o),z=n.map(St=>Md(St,I,x)),V=z.map(St=>St.id),rt=Object.keys(t).map(St=>t[St].id),Et=new Set([...V,...rt,...this.weightIds]);return Object.keys(I).forEach(St=>{I[St].forEach(Vt=>{Vt&&!Vt.isDisposed&&!Et.has(Vt.id)&&Vt.dispose()})}),this.parent==null&&x.dispose(Et),z})}executeFunctionAsync(t,n,o){return Wr(this,null,function*(){const u=t.reduce((h,p,g)=>(h[this.inputs[g].name]=p,h),{});return this._executeAsync(u,this.outputNodes,!0,n,o)})}executeWithControlFlow(t,n,o,u){return Wr(this,null,function*(){const h=Object.keys(t),p=h.map(qe=>this.graph.nodes[cp(qe)[0]]),g=o.map(qe=>cp(qe)[0]);let x=g.map(qe=>this.graph.nodes[qe]);x.length===0&&(x=this._outputs);const{usedNodes:I,missingInputs:z,dynamicNode:V,syncInputs:rt}=eN(t,x,this.weightMap,this._initNodes),Et=[...p,...this.graph.weights,...this._initNodes||[]].map(qe=>({node:qe,contexts:n.currentContext})),St=Object.assign({},this.weightMap);Object.keys(t).forEach(qe=>{const[$e,Xe]=cp(qe),Pn=[];Pn[Xe]=t[qe],St[$e]=Pn});const Tt={},Vt=this.getFrozenTensorIds(St),ue={};for(;Et.length>0;){const qe=this.processStack(p,Et,n,St,ue,Vt,g,Tt,I);yield Promise.all(qe)}V==null&&!u&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const ye=x.filter(qe=>!nN(qe)&&!Md(qe.name,St,n)).map(qe=>qe.name);if(ye.length>0){let qe="";throw V!=null&&(qe=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${rt}]`),new Error(`Cannot compute the outputs [${ye}] from the provided inputs [${h}]. Consider providing the following inputs: [${z}]. ${qe}`)}return St})}processStack(t,n,o,u,h,p,g,x,I){const z=[];for(;n.length>0;){const V=n.pop();o.currentContext=V.contexts;let rt="";if(V.node.op==="Enter"&&Fe("isConstant",V.node,u,o)&&([rt]=tm(V.node.name,o)),u[V.node.name]==null){const Et=JM(V.node,u,o,this._resourceManager);rt||([rt]=tm(V.node.name,o));const St=o.currentContext;$t(Et)?z.push(Et.then(Tt=>(u[rt]=Tt,o.currentContext=St,this.checkTensorForDisposal(rt,V.node,u,o,p,g,x),this.processChildNodes(V.node,n,o,u,h,I),Tt))):(u[rt]=Et,this.checkTensorForDisposal(rt,V.node,u,o,p,g,x),this.processChildNodes(V.node,n,o,u,h,I))}else this.processChildNodes(V.node,n,o,u,h,I)}return z}processChildNodes(t,n,o,u,h,p){t.children.forEach(g=>{const[x]=tm(g.name,o);h[x]||!p.has(g.name)||(g.op==="Merge"?g.inputNames.some(I=>!!Md(I,u,o))&&(h[x]=!0,n.push({contexts:o.currentContext,node:g})):g.inputNames.every(I=>!!Md(I,u,o))&&(h[x]=!0,n.push({contexts:o.currentContext,node:g})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(n=>n.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(n=>{const o=t[n],[u]=cp(n),h=this.graph.nodes[u];if(h.attrParams.shape&&h.attrParams.shape.value){const p=h.attrParams.shape.value,g=p.length===o.shape.length&&o.shape.every((x,I)=>p[I]===-1||p[I]===x);yt(g,()=>`The shape of dict['${h.name}'] provided in model.execute(dict) must be [${p}], but was [${o.shape}]`)}h.attrParams.dtype&&h.attrParams.dtype.value&&yt(o.dtype===h.attrParams.dtype.value,()=>`The dtype of dict['${h.name}'] provided in model.execute(dict) must be ${h.attrParams.dtype.value}, but was ${o.dtype}`)})}mapInputs(t){const n={};for(const o in t)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[o]!=null){const u=this._signature.inputs[o];n[u.name]=t[o]}else n[o]=t[o];return n}checkInputs(t){const n=Object.keys(t).filter(o=>{const[u]=cp(o);return this.graph.nodes[u]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(t){return t.map(n=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[n]!=null?this._signature.outputs[n].name:n,{})}checkOutputs(t){t.forEach(n=>{const[o]=cp(n);if(!this.graph.nodes[o])throw new Error(`The output '${n}' is not found in the graph`)})}}class YL{constructor(t={},n={}){this.hashTableNameToHandle=t,this.hashTableMap=n}addHashTable(t,n){this.hashTableNameToHandle[t]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KL="?tfjs-format=file",ZL="model.json";class rN{constructor(t,n={}){this.modelUrl=t,this.loadOptions=n,this.version="n/a",n==null&&(this.loadOptions={}),this.resourceManager=new YL}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}findIOHandler(){const t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=Mh(t,this.loadOptions);else{const n=Fd(t,this.loadOptions);if(n.length===0)n.push(Mh(t,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[t]}'`);this.handler=n[0]}}load(){return Wr(this,null,function*(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=yield this.handler.load();return this.loadSync(t)})}loadSync(t){this.artifacts=t;const n=this.artifacts.modelTopology;let o;this.artifacts.userDefinedMetadata!=null&&this.artifacts.userDefinedMetadata.signature!=null?o=this.artifacts.userDefinedMetadata.signature:o=this.artifacts.signature,this.signature=o,this.version=`${n.versions.producer}.${n.versions.minConsumer}`;const u=yh(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new XE(YM.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(u),this.executor.resourceManager=this.resourceManager,t.modelInitializer!=null&&t.modelInitializer.node!=null){const h=YM.Instance.transformGraph(t.modelInitializer);this.initializer=new XE(h),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}save(t,n){return Wr(this,null,function*(){if(typeof t=="string"){const o=Xh(t);if(o.length===0)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(o.length>1)throw new Error(`Found more than one (${o.length}) save handlers for URL '${t}'`);t=o[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)})}predict(t,n){return this.execute(t,this.outputNodes)}normalizeInputs(t){if(!(t instanceof Dn)&&!Array.isArray(t))return t;if(t=Array.isArray(t)?t:[t],t.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${t.length} input tensors.`);return this.inputNodes.reduce((n,o,u)=>(n[o]=t[u],n),{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}execute(t,n){t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const o=this.executor.execute(t,n);return o.length>1?o:o[0]}executeAsync(t,n){return Wr(this,null,function*(){t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const o=yield this.executor.executeAsync(t,n);return o.length>1?o:o[0]})}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((n,o)=>(n[o]=[t[o]],n),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}function qL(n){return Wr(this,arguments,function*(r,t={}){if(r==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&r.load==null&&(r.endsWith("/")||(r=r+"/"),r=`${r}${ZL}${KL}`);const o=new rN(r,t);return yield o.load(),o})}/** @license See the LICENSE file. */const aN="2.8.6";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function QL(r,t){return YE(r,t)}function YE(r,t,n=new Map,o=new Set){if(r==null)return null;if(o.has(r))throw new Error("Circular references are not supported.");if(n.has(r))return n.get(r);const u=t(r);if(u.recurse&&u.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(u.recurse)if(h1(r)){const h=Array.isArray(r)?[]:{};o.add(r);for(const p in r){const g=r[p],x=YE(g,t,n,o);h[p]=x}return o.delete(r),h}else throw new Error(`Can't recurse into non-iterable type: ${r}`);else return n.set(r,u.value),u.value}function JL(r,t=oN){return iN(r,t)}function iN(r,t,n=new Set){const o=r[0];if(n.has(o))throw new Error("Circular references are not supported.");const u=t(r);if(u.recurse&&u.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(u.recurse)if(h1(o)){const h=Array.isArray(o)?[]:{};n.add(o);for(const p in o){const g=r.map(I=>I[p]),x=iN(g,t,n);h[p]=x}return n.delete(o),h}else throw new Error(`Can't recurse into non-iterable type: ${o}`);else return u.value}function oN(r){return r===null?null:h1(r[0])?{value:null,recurse:!0}:{value:r,recurse:!1}}function sN(r,t){return Wr(this,null,function*(){const n=new Map;YE(r,t,n);for(const u of Array.from(n.keys())){const h=n.get(u);if($t(h)){const p=yield h;n.set(u,p)}}return YE(r,t,n)})}function h1(r){return r!=null&&!ArrayBuffer.isView(r)&&(Array.isArray(r)||typeof r=="object"&&!(r instanceof Dn))}function tP(r){return r==null||eP(r)||Array.isArray(r)||typeof r=="object"&&r instanceof Dn||Hr(r)}function eP(r){return r===null||typeof r!="object"&&typeof r!="function"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function nP(r){return QL(r,rP)}function rP(r){return r instanceof Dn?{value:r.clone(),recurse:!1}:h1(r)?{value:null,recurse:!0}:{value:r,recurse:!1}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class uN{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,n){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=n}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const n of t)this.push(n)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const n=this.wrap(this.begin+t),o=this.get(n);return this.set(n,this.pop()),o}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class KE extends uN{constructor(){super(KE.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=this.capacity*2,n=new Array(t),o=this.length();for(let u=0;u<o;u++)n[u]=this.get(this.wrap(this.begin+u));this.data=n,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=o}}KE.INITIAL_CAPACITY=32;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function lN(r){return new iP(r)}function Ij(r){let t=r;return bx(()=>({value:t++,done:!1}))}function bx(r){return new oP(r)}function cN(r,t){return new hN(r,t)}function Tj(r,t,n){return cN(bx(r).take(t),n)}function aP(r,t=Pm.FAIL){return new vP(r,t)}class Jf{toArray(){return Wr(this,null,function*(){const t=[];let n=yield this.next();for(;!n.done;)t.push(n.value),n=yield this.next();return t})}toArrayForTest(){return Wr(this,null,function*(){const t=this.prefetch(100),n=[];let o=yield t.next();for(;!o.done;)n.push(o.value),o=yield t.next();return n})}resolveFully(){return Wr(this,null,function*(){let t=yield this.next();for(;!t.done;)t=yield this.next()})}resolveWhile(t){return Wr(this,null,function*(){let n=yield this.next(),o=t(n.value);for(;!n.done&&o;)n=yield this.next(),o=t(n.value)})}handleErrors(t){return new dP(this,t)}filter(t){return new fP(this,t)}map(t){return new hP(this,t)}mapAsync(t){return new fN(this,t)}serialMapAsync(t){return new fN(this,t).serial()}flatmap(t){return new pP(this,t)}forEachAsync(t){return Wr(this,null,function*(){return this.map(t).resolveFully()})}serialForEach(t){return Wr(this,null,function*(){return this.serialMapAsync(t).resolveWhile(n=>n===!0)})}rowMajorBatch(t,n=!0){return new cP(this,t,n)}columnMajorBatch(t,n=!0,o=oN){return this.rowMajorBatch(t,n).map(h=>JL(h,o))}concatenate(t,n){return new hN(lN([this,t]),n)}take(t){return t<0||t==null?this:new lP(this,t)}skip(t){return t<0||t==null?this:new uP(this,t)}prefetch(t){return new dN(this,t)}shuffle(t,n){return new gP(this,t,n)}serial(){return new sP(this)}}class iP extends Jf{constructor(t){super();this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}next(){return Wr(this,null,function*(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:nP(t),done:!1}})}}class oP extends Jf{constructor(t){super();this.nextFn=t}summary(){return"Function call"}next(){return Wr(this,null,function*(){try{return this.nextFn()}catch(t){throw t.message=`Error thrown while iterating through a dataset: ${t.message}`,t}})}}class sP extends Jf{constructor(t){super();this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}next(){return Wr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Wr(this,null,function*(){return this.upstream.next()})}}class uP extends Jf{constructor(t,n){super();this.upstream=t,this.maxCount=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}next(){return Wr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Wr(this,null,function*(){for(;this.count++<this.maxCount;){const t=yield this.upstream.next();if(t.done)return t;N(t.value)}return this.upstream.next()})}}class lP extends Jf{constructor(t,n){super();this.upstream=t,this.maxCount=n,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}next(){return Wr(this,null,function*(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()})}}class cP extends Jf{constructor(t,n,o=!0){super();this.upstream=t,this.batchSize=n,this.enableSmallLastBatch=o,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}next(){return Wr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Wr(this,null,function*(){const t=[];for(;t.length<this.batchSize;){const n=yield this.upstream.next();if(n.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(n.value)}return{value:t,done:!1}})}}class fP extends Jf{constructor(t,n){super();this.upstream=t,this.predicate=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}next(){return Wr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Wr(this,null,function*(){for(;;){const t=yield this.upstream.next();if(t.done||this.predicate(t.value))return t;N(t.value)}})}}class hP extends Jf{constructor(t,n){super();this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> Map`}next(){return Wr(this,null,function*(){const t=yield this.upstream.next();if(t.done)return{value:null,done:!0};const n=Xi(t.value),o=this.transform(t.value),u=Xi(o);for(const h of n)zo(h,u)||h.dispose();return{value:o,done:!1}})}}class dP extends Jf{constructor(t,n){super();this.upstream=t,this.handler=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}next(){return Wr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Wr(this,null,function*(){for(;;)try{return yield this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}})}}class fN extends Jf{constructor(t,n){super();this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> AsyncMap`}next(){return Wr(this,null,function*(){const t=yield this.upstream.next();if(t.done)return{value:null,done:!0};const n=Xi(t.value),o=yield this.transform(t.value),u=Xi(o);for(const h of n)zo(h,u)||h.dispose();return{value:o,done:!1}})}}class UT extends Jf{constructor(){super();this.outputQueue=new KE,this.lastRead=Promise.resolve({value:null,done:!1})}next(){return Wr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return Wr(this,null,function*(){for(;this.outputQueue.length()===0;)if(!(yield this.pump()))return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}})}}class pP extends UT{constructor(t,n){super();this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> Flatmap`}pump(){return Wr(this,null,function*(){const t=yield this.upstream.next();if(t.done)return!1;const n=Xi(t.value),o=this.transform(t.value),u=Xi(o);this.outputQueue.pushAll(o);for(const h of n)zo(h,u)||h.dispose();return!0})}}class hN extends Jf{constructor(t,n){super();this.baseErrorHandler=n,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}next(){return Wr(this,null,function*(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead})}readFromChain(t){return Wr(this,null,function*(){if(yield t,this.iterator==null){const o=yield this.moreIterators.next();if(o.done)return{value:null,done:!0};this.iterator=o.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const n=yield this.iterator.next();return n.done?(this.iterator=null,this.readFromChain(t)):n})}}var Pm;(function(r){r[r.FAIL=0]="FAIL",r[r.SHORTEST=1]="SHORTEST",r[r.LONGEST=2]="LONGEST"})(Pm||(Pm={}));class vP extends Jf{constructor(t,n=Pm.FAIL){super();this.iterators=t,this.mismatchMode=n,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}nextState(t){return Wr(this,null,function*(){yield t;let n=0,o=0;function u(p){return p instanceof Jf?{value:p.next().then(x=>(n++,x.done&&o++,x.value)),recurse:!1}:{value:null,recurse:!0}}const h=yield sN(this.iterators,u);if(n===o)return{value:null,done:!0};if(o>0)switch(this.mismatchMode){case Pm.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case Pm.SHORTEST:return{value:null,done:!0};case Pm.LONGEST:default:}return this.count++,{value:h,done:!1}})}next(){return Wr(this,null,function*(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise})}}class dN extends Jf{constructor(t,n){super();this.upstream=t,this.bufferSize=n,this.buffer=new uN(n)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class gP extends dN{constructor(t,n,o){super(t,n);this.upstream=t,this.windowSize=n,this.upstreamExhausted=!1,this.random=xm.alea(o||ic().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}next(){return Wr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}serialNext(){return Wr(this,null,function*(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),n=yield this.buffer.shuffleExcise(t);if(n.done)this.upstreamExhausted=!0;else return this.refill(),n}return{value:null,done:!0}})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class d1{constructor(){this.size=null}batch(t,n=!0){const o=this;yt(t>0,()=>`batchSize needs to be positive, but it is
      ${t}`);let u;return this.size===Infinity||this.size==null?u=this.size:n?u=Math.ceil(this.size/t):u=Math.floor(this.size/t),fp(()=>Wr(this,null,function*(){return(yield o.iterator()).columnMajorBatch(t,n,bP)}),u)}concatenate(t){const n=this;let o;return this.size===Infinity||t.size===Infinity?o=Infinity:this.size!=null&&t.size!=null?o=this.size+t.size:o=null,fp(()=>Wr(this,null,function*(){return(yield n.iterator()).concatenate(yield t.iterator())}),o)}filter(t){const n=this;let o;return this.size===Infinity?o=Infinity:o=null,fp(()=>Wr(this,null,function*(){return(yield n.iterator()).filter(u=>zn(()=>t(u)))}),o)}forEachAsync(t){return Wr(this,null,function*(){return(yield this.iterator()).forEachAsync(t)})}map(t){const n=this;return fp(()=>Wr(this,null,function*(){return(yield n.iterator()).map(o=>zn(()=>t(o)))}),this.size)}mapAsync(t){const n=this;return fp(()=>Wr(this,null,function*(){return(yield n.iterator()).mapAsync(t)}),this.size)}prefetch(t){if(t==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const n=this;return fp(()=>Wr(this,null,function*(){return(yield n.iterator()).prefetch(t)}),this.size)}repeat(t){const n=this;let o;return this.size!=null&&t>0?o=this.size*t:t===0?o=0:this.size!=null&&(t===void 0||t<0)?o=Infinity:o=null,fp(()=>Wr(this,null,function*(){const u=bx(()=>Wr(this,null,function*(){return{value:yield n.iterator(),done:!1}}));return cN(u.take(t))}),o)}skip(t){const n=this;let o;return this.size!=null&&t>=0&&this.size>=t?o=this.size-t:this.size!=null&&(this.size<t||t===void 0||t<0)?o=0:o=null,fp(()=>Wr(this,null,function*(){return(yield n.iterator()).skip(t)}),o)}shuffle(t,n,o=!0){if(t==null||t<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const u=this,h=xm.alea(n||ic().toString());return fp(()=>Wr(this,null,function*(){let p=h.int32();return o&&(p+=h.int32()),(yield u.iterator()).shuffle(t,p.toString())}),this.size)}take(t){const n=this;let o;return this.size!=null&&this.size>t?o=t:this.size!=null&&this.size<=t?o=this.size:o=null,fp(()=>Wr(this,null,function*(){return(yield n.iterator()).take(t)}),o)}toArray(){return Wr(this,null,function*(){if(this.size===Infinity)throw new Error("Can not convert infinite data stream to array.");return(yield this.iterator()).toArray()})}toArrayForTest(){return Wr(this,null,function*(){if(this.size===Infinity)throw new Error("Can not convert infinite data stream to array.");return(yield this.iterator()).toArrayForTest()})}}d1.MAX_BUFFER_SIZE=1e4;function fp(r,t=null){return new class extends d1{constructor(){super(...arguments);this.size=t}iterator(){return Wr(this,null,function*(){return r()})}}}function mP(r){return fp(()=>Wr(this,null,function*(){return lN(r)}),r.length)}function yP(r){if(!h1(r))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(r))for(let n=0;n<r.length;n++)t=t==null?r[n].size:Math.min(t,r[n].size);else if(r instanceof Object)for(const n in r)t=t==null?r[n].size:Math.min(t,r[n].size);return fp(()=>Wr(this,null,function*(){const n=yield sN(r,o=>{if(o instanceof d1)return{value:o.iterator(),recurse:!1};if(h1(o))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return aP(n,Pm.SHORTEST)}),t)}function bP(r){if(r===null)return null;const t=r[0];return tP(t)?{value:xP(r),recurse:!1}:{value:null,recurse:!0}}function xP(r){if(r.length===0)throw new Error("Can't make a batch of zero elements.");return r[0]instanceof Dn?nd(r):Vc(r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class pN extends d1{constructor(t){super();this.input=t}iterator(){return Wr(this,null,function*(){return(yield this.input.iterator()).decodeUTF8().split(`
`).map(u=>(u.endsWith("\r")&&(u=u.slice(0,-1)),u))})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const ZE='"',xx=Symbol("out"),vN=Symbol("field"),qE=Symbol("quote"),WT=Symbol("quoteafterquote"),gN=Symbol("quoteinquote");class mN extends d1{constructor(t,n){super();this.input=t,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new pN(t),n||(n={}),this.hasHeader=n.hasHeader!==!1,this.fullColumnNames=n.columnNames,this.columnConfigs=n.columnConfigs,this.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(yt(n.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=n.delimiter?n.delimiter:","}columnNames(){return Wr(this,null,function*(){return this.columnNamesValidated||(yield this.setColumnNames()),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames})}setColumnNames(){return Wr(this,null,function*(){const t=yield this.maybeReadHeaderLine();if(!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&t&&yt(t.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=t);const n=this.fullColumnNames.reduce((u,h)=>(u[h]=u[h]+1||1,u),{}),o=Object.keys(n).filter(u=>n[u]>1);if(yt(o.length===0,()=>"Duplicate column names found: "+o.toString()),this.columnConfigs){for(const u of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(u)===-1)throw new Error('The key "'+u+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0})}maybeReadHeaderLine(){return Wr(this,null,function*(){if(this.hasHeader){const n=yield(yield this.base.iterator()).next();if(n.done)throw new Error("No data was found for CSV parsing.");const o=n.value;return this.parseRow(o,!1)}else return null})}iterator(){return Wr(this,null,function*(){this.columnNamesValidated||(yield this.setColumnNames());let t=yield this.base.iterator();return this.hasHeader&&(t=t.skip(1)),t.map(n=>this.makeDataElement(n))})}makeDataElement(t){const n=this.parseRow(t),o={},u={};for(let h=0;h<this.fullColumnNames.length;h++){const p=this.fullColumnNames[h],g=this.columnConfigs?this.columnConfigs[p]:null;if(!(this.configuredColumnsOnly&&!g)){const x=n[h];let I=null;if(x==="")if(g&&g.default!==void 0)I=g.default;else{if(g&&(g.required||g.isLabel))throw new Error(`Required column ${p} is empty in this line: ${t}`);I=void 0}else{const z=Number(x);if(isNaN(z))g&&g.dtype==="bool"?I=this.getBoolean(x):I=x;else if(!g||!g.dtype)I=z;else switch(g.dtype){case"float32":I=z;break;case"int32":I=Math.floor(z);break;case"bool":I=this.getBoolean(x);break;default:I=z}}g&&g.isLabel?u[p]=I:o[p]=I}}return Object.keys(u).length===0?o:{xs:o,ys:u}}getBoolean(t){return t==="1"||t.toLowerCase()==="true"?1:0}parseRow(t,n=!0){const o=[];let u=0;const h=t.length;let p=xx;for(let g=0;g<h;g++)switch(p){case xx:switch(t.charAt(g)){case ZE:u=g+1,p=qE;break;case this.delimiter:if(u=g+1,this.delimiter===" "&&this.delimWhitespace)break;o.push(""),p=xx;break;default:p=vN,u=g;break}break;case vN:switch(t.charAt(g)){case this.delimiter:o.push(t.substring(u,g)),p=xx,u=g+1;break;default:}break;case qE:switch(t.charAt(g)){case ZE:p=WT;break;default:}break;case WT:switch(t.charAt(g)){case this.delimiter:o.push(t.substring(u,g-1)),p=xx,u=g+1;break;case ZE:p=qE;break;default:p=gN;break}break;case gN:switch(t.charAt(g)){case ZE:p=qE;break;default:}break;default:}if(p===WT?o.push(t.substring(u,h-1)):o.push(t.substring(u)),n&&o.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${o}`);return o}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class VT extends Jf{constructor(t){super();this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;const n=Math.log2(this.fftSize);if(this.fftSize<0||n<4||n>14||!Number.isInteger(n))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=t.includeSpectrogram!==!1,this.includeWaveform=t.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static create(){return Wr(this,arguments,function*(t={}){if(Ve().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");const n=new VT(t);return yield n.start(),n})}start(){return Wr(this,null,function*(){try{this.stream=yield navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(o){throw new Error(`Error thrown while initializing video stream: ${o.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);const n=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,n.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)})}next(){return Wr(this,null,function*(){if(this.isClosed)return{value:null,done:!0};let t,n;const o=yield this.getAudioData();if(this.includeSpectrogram){const u=this.flattenQueue(o.freqDataQueue);t=this.getTensorFromAudioDataArray(u,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const u=this.flattenQueue(o.timeDataQueue);n=this.getTensorFromAudioDataArray(u,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:n},done:!1}})}capture(){return Wr(this,null,function*(){return(yield this.next()).value})}getAudioData(){return Wr(this,null,function*(){const t=[],n=[];let o=0;return new Promise(u=>{const h=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-Infinity&&u({freqDataQueue:t,timeDataQueue:n}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),n.push(this.timeData.slice())),++o===this.numFrames&&(clearInterval(h),u({freqDataQueue:t,timeDataQueue:n}))},this.fftSize/this.sampleRateHz*1e3)})})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){const n=t[0].length,o=new Float32Array(t.length*n);return t.forEach((u,h)=>o.set(u,h*n)),o}getTensorFromAudioDataArray(t,n){const o=new Float32Array(Rt(n));return o.set(t,o.length-t.length),Vc(o,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class jT extends Jf{constructor(t,n){super();if(this.webcamVideoElement=t,this.webcamConfig=n,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=Ff([0],"int32"),this.webcamConfig.centerCrop){const o=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,u=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,h=(1-o)/2,p=(1-u)/2,g=h+o,x=u+p;this.cropBox=Sm([p,h,x,g],[1,4])}else this.cropBox=Sm([0,0,1,1],[1,4])}summary(){return"webcam"}static create(o){return Wr(this,arguments,function*(t,n={}){if(Ve().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}const u=new jT(t,n);return yield u.start(),u})}start(){return Wr(this,null,function*(){this.webcamConfig.facingMode&&yt(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=yield navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message=`Error thrown while initializing video stream: ${t.message}`,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})})}next(){return Wr(this,null,function*(){if(this.isClosed)return{value:null,done:!0};let t;try{t=qh(this.webcamVideoElement)}catch(n){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(n)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(n){throw new Error(`Error thrown cropping the video: ${n.message}`)}finally{t.dispose()}else return{value:t,done:!1}})}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(t){return zn(()=>{const n=t.toFloat().expandDims(0);let o;o=ep.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const u=o.shape;return o.reshape(u.slice(1))})}capture(){return Wr(this,null,function*(){return(yield this.next()).value})}stop(){this.stream.getTracks().forEach(n=>n.stop());try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class yN{}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class bN extends Jf{split(t){return new wP(this,t)}}class wP extends bN{constructor(t,n){super();this.upstream=t,this.impl=new EP(t,n)}summary(){return this.impl.summary()}next(){return Wr(this,null,function*(){return this.impl.next()})}}class EP extends UT{constructor(t,n){super();this.upstream=t,this.separator=n,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}pump(){return Wr(this,null,function*(){const t=yield this.upstream.next();if(t.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);const n=t.value.split(this.separator);n[0]=this.carryover+n[0];for(const o of n.slice(0,-1))this.outputQueue.push(o);return this.carryover=n[n.length-1],!0})}}var SP=$(48764).Buffer;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class CP extends Jf{decodeUTF8(){return new _P(this)}}class _P extends bN{constructor(t){super();this.upstream=t,this.impl=new IP(t)}summary(){return this.impl.summary()}next(){return Wr(this,null,function*(){return this.impl.next()})}}class IP extends UT{constructor(t){super();if(this.upstream=t,Ve().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:n}=$(31601);this.decoder=new n("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}pump(){return Wr(this,null,function*(){const t=yield this.upstream.next();let n;if(t.done)return!1;n=t.value;let o;return Ve().get("IS_BROWSER")?o=this.decoder.decode(n,{stream:!0}):o=this.decoder.write(SP.from(n.buffer)),this.outputQueue.push(o),!0})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class xN extends CP{constructor(t,n={}){super();this.file=t,this.options=n,yt(t instanceof Uint8Array||(Ve().get("IS_BROWSER")?t instanceof File||t instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=n.offset||0,this.chunkSize=n.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}next(){return Wr(this,null,function*(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:yield new Promise((n,o)=>{const u=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)n(new Uint8Array(this.file.slice(this.offset,u)));else{const h=new FileReader;h.onload=g=>{let x=h.result;if(x instanceof ArrayBuffer&&(x=new Uint8Array(x)),!(x instanceof Uint8Array))return o(new TypeError("FileReader returned unknown type."));n(x)},h.onabort=g=>o(new Error("Aborted")),h.onerror=g=>o(new Error(g.type));const p=this.file.slice(this.offset,u);h.readAsArrayBuffer(p)}this.offset=u}),done:!1}})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function TP(n){return Wr(this,arguments,function*(r,t={}){let o,u;typeof r=="string"?o=r:(o=r.url,u=AP(r));const h=yield mh(o,u);if(h.ok){const p=new Uint8Array(yield h.arrayBuffer());return new xN(p,t)}else throw new Error(h.statusText)})}const AP=r=>({method:r.method,headers:r.headers,body:r.body,mode:r.mode,credentials:r.credentials,cache:r.cache,redirect:r.redirect,referrer:r.referrer,integrity:r.integrity});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function wN(r){return typeof r=="string"&&r.substr(0,7)==="file://"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class EN extends yN{constructor(t,n={}){super();this.input=t,this.options=n}iterator(){return Wr(this,null,function*(){if(wN(this.input)&&Ve().get("IS_NODE")){const t=$(67792);this.input=t.readFileSync(this.input.substr(7))}return new xN(this.input,this.options)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class SN extends yN{constructor(t,n={}){super();this.url=t,this.fileOptions=n}iterator(){return Wr(this,null,function*(){return wN(this.url)?new EN(this.url,this.fileOptions).iterator():TP(this.url,this.fileOptions)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function MP(r,t={}){return new mN(new SN(r),t)}function NP(r){const t=bx(r);return fp(()=>Wr(this,null,function*(){return t}))}function kP(r){return fp(()=>Wr(this,null,function*(){const t=yield r();return bx(()=>t.next())}))}function DP(r,t){return Wr(this,null,function*(){return jT.create(r,t)})}function OP(r){return Wr(this,null,function*(){return VT.create(r)})}/** @license See the LICENSE file. */const CN="2.8.6";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Go(r,t){Array.isArray(r)||(r=[r]),r.forEach(n=>{n!=null&&yt(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RP=Rg;class LP extends He{constructor(){super();this.blockSize=48,this.firstUse=!0,this.data=new Re(this,Oa())}write(t,n,o){this.firstUse&&(this.firstUse=!1,Ve().get("IS_NODE")&&Tm(`
============================
Hi there \u{1F44B}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));const u={};return this.data.set(u,{values:t,dtype:o,refCount:1}),u}makeTensorInfo(t,n,o){let u;if(n==="string"&&o!=null&&o.length>0&&Cr(o[0])){const h=o.map(p=>oc(p));u=this.write(h,t,n)}else u=this.write(o,t,n);return{dataId:u,shape:t,dtype:n}}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,o,u){this.data.set(t,{values:n,dtype:u,refCount:1})}numDataIds(){return this.data.numDataIds()}read(t){return Wr(this,null,function*(){return this.readSync(t)})}readSync(t){const{dtype:n,complexTensorInfos:o}=this.data.get(t);if(n==="complex64"){const u=this.readSync(o.real.dataId),h=this.readSync(o.imag.dataId);return cv(u,h)}return this.data.get(t).values}bufferSync(t){const n=this.readSync(t.dataId);let o=n;if(t.dtype==="string")try{o=n.map(u=>Ot(u))}catch(u){throw new Error("Failed to decode encoded string bytes into utf-8")}return vs(t.shape,t.dtype,o)}makeOutput(t,n,o){const u=this.write(t,n,o);return Oa().makeTensorFromDataId(u,n,o,this)}disposeData(t){if(this.data.has(t)){const{complexTensorInfos:n}=this.data.get(t);n!=null&&(this.disposeData(n.real.dataId),this.disposeData(n.imag.dataId)),this.data.delete(t)}}disposeIntermediateTensorInfo(t){const n=t.dataId;if(this.data.has(n)){const o=this.data.get(n);o.refCount--,o.refCount<1&&this.disposeData(n)}}time(t){return Wr(this,null,function*(){const n=ic();return t(),{kernelMs:ic()-n}})}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Go([t],"where");const n=this.readSync(t.dataId);return RP(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}/** @license See the LICENSE file. */const PP="2.8.6";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye("cpu",()=>new LP,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ul(r,t,n){return({inputs:o,attrs:u,backend:h})=>{const{x:p}=o;if(Go(p,r),p.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const g=h,x=g.data.get(p.dataId).values,I=Rt(p.shape),z=n||p.dtype,V=Fn(z,I);for(let rt=0;rt<I;++rt)V[rt]=t(x[rt],u);return g.makeTensorInfo(p.shape,z,V)}}function p1(r,t,n){return({inputs:o,attrs:u,backend:h})=>{const{x:p}=o;if(Go(p,r),p.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const g=h,x=g.data.get(p.dataId).values,I=n||p.dtype,z=t(x,I,u);return g.makeTensorInfo(p.shape,I,z)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _N=Ul(Ro,r=>r>=0?r:Math.exp(r)-1),FP={kernelName:Ro,backendName:"cpu",kernelFunc:_N};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eg(r){const{inputs:t,backend:n}=r,{x:o}=t;return n.incRef(o.dataId),{dataId:o.dataId,shape:o.shape,dtype:o.dtype}}const BP={kernelName:xu,backendName:"cpu",kernelFunc:Eg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IN(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{alpha:h}=o;Go([u],"leakyRelu");const p=Rt(u.shape),g=n.data.get(u.dataId).values,x=ar("float32",p);for(let I=0;I<g.length;I++)x[I]=g[I]<0?h*g[I]:g[I];return n.makeTensorInfo(u.shape,"float32",x)}const zP={kernelName:Du,backendName:"cpu",kernelFunc:IN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cf(r){return(t,n,o,u,h)=>{const p=Nr(t,n),g=p.length,x=vt(p),I=Rt(p),z=ar(h,I),V=t.length,rt=n.length,Et=vt(t),St=vt(n),Tt=Wn(t,p),Vt=Wn(n,p);if(Tt.length+Vt.length===0)for(let ue=0;ue<z.length;++ue)z[ue]=r(o[ue%o.length],u[ue%u.length]);else for(let ue=0;ue<z.length;++ue){const ye=bt(ue,g,x),qe=ye.slice(-V);Tt.forEach(In=>qe[In]=0);const $e=Y(qe,V,Et),Xe=ye.slice(-rt);Vt.forEach(In=>Xe[In]=0);const Pn=Y(Xe,rt,St);z[ue]=r(o[$e],u[Pn])}return[z,p]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $P=Cf((r,t)=>r<0?t*r:r);function TN(r){const{inputs:t,backend:n}=r,{x:o,alpha:u}=t;Go([o,u],"prelu");const h=n.data.get(o.dataId).values,p=n.data.get(u.dataId).values,[g,x]=$P(o.shape,u.shape,h,p,o.dtype);return n.makeTensorInfo(x,o.dtype,g)}const GP={kernelName:Si,backendName:"cpu",kernelFunc:TN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AN=Ul(js,r=>Math.max(0,r)),UP={kernelName:js,backendName:"cpu",kernelFunc:AN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MN=Ul(Cl,r=>Math.min(Math.max(0,r),6)),WP={kernelName:Cl,backendName:"cpu",kernelFunc:MN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HT(r,t,n,o,u){if(n==="linear")return Eg({inputs:{x:t},backend:r});if(n==="relu")return AN({inputs:{x:t},backend:r});if(n==="elu")return _N({inputs:{x:t},backend:r});if(n==="relu6")return MN({inputs:{x:t},backend:r});if(n==="prelu")return TN({inputs:{x:t,alpha:o},backend:r});if(n==="leakyrelu")return IN({inputs:{x:t},backend:r,attrs:{alpha:u}});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hp(r){const{inputs:t,backend:n}=r,{real:o,imag:u}=t,h=n.data.get(o.dataId).values,p=n.data.get(u.dataId).values,g=n.makeTensorInfo(o.shape,"complex64"),x=n.data.get(g.dataId);return x.complexTensorInfos={real:n.makeTensorInfo(o.shape,"float32",h),imag:n.makeTensorInfo(u.shape,"float32",p)},g}const VP={kernelName:wi,backendName:"cpu",kernelFunc:hp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QE(r,t,n="float32"){if(n==="complex64"){const u=QE(r,t,"float32"),h=QE(r,t,"float32");return hp({inputs:{real:u,imag:h},backend:r})}const o=kt(Rt(t),n);return r.makeTensorInfo(t,n,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G0(r){const{inputs:t,backend:n}=r,{input:o}=t,u=n.data.get(o.dataId).complexTensorInfos.real,h=n.data.get(u.dataId).values;return n.makeTensorInfo(u.shape,u.dtype,h)}const jP={kernelName:wo,backendName:"cpu",kernelFunc:G0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fm(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{dtype:h}=o;if(h==="complex64"){if(u.dtype==="complex64")return Eg({inputs:{x:u},backend:n});const p=QE(n,u.shape,u.dtype),g=Fm({inputs:{x:u},backend:n,attrs:{dtype:"float32"}}),x=hp({inputs:{real:g,imag:p},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),x}if(u.dtype==="complex64"){const p=G0({inputs:{input:u},backend:n}),g=Fm({inputs:{x:p},backend:n,attrs:{dtype:h}});return n.disposeIntermediateTensorInfo(p),g}if(!jr(u.dtype,h)){const p=Eg({inputs:{x:u},backend:n});return{dataId:p.dataId,shape:p.shape,dtype:h}}if(h==="int32"){const p=n.data.get(u.dataId).values,g=Int32Array.from(p);return n.makeTensorInfo(u.shape,"int32",g)}if(h==="bool"){const p=n.data.get(u.dataId).values,g=Nu([0],u.dtype),[x,I]=Cf((z,V)=>z!==V?1:0)(u.shape,[],p,g,"bool");return n.makeTensorInfo(I,"bool",x)}throw new Error(`Error in Cast: failed to cast ${u.dtype} to ${h}`)}const HP={kernelName:ts,backendName:"cpu",kernelFunc:Fm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function th(r,t,n,o){return n==null?({inputs:u,backend:h})=>{const{a:p,b:g}=u,x=h;Go([p,g],r);const I=x.data.get(p.dataId).values,z=x.data.get(g.dataId).values,V=o||p.dtype,[rt,Et]=t(p.shape,g.shape,I,z,V);return x.makeTensorInfo(Et,V,rt)}:({inputs:u,backend:h})=>{const{a:p,b:g}=u,x=h;if(p.dtype==="complex64"||g.dtype==="complex64"){const I=Fm({inputs:{x:p},backend:x,attrs:{dtype:"complex64"}}),z=x.data.get(I.dataId),V=z.complexTensorInfos.real,rt=z.complexTensorInfos.imag,Et=x.data.get(V.dataId).values,St=x.data.get(rt.dataId).values,Tt=Fm({inputs:{x:g},backend:x,attrs:{dtype:"complex64"}}),Vt=x.data.get(Tt.dataId),ue=Vt.complexTensorInfos.real,ye=Vt.complexTensorInfos.imag,qe=x.data.get(ue.dataId).values,$e=x.data.get(ye.dataId).values,[Xe,Pn,In]=n(p.shape,g.shape,Et,St,qe,$e),gr=x.makeTensorInfo(In,"float32",Xe),Br=x.makeTensorInfo(In,"float32",Pn),Kr=hp({inputs:{real:gr,imag:Br},backend:x});return x.disposeIntermediateTensorInfo(I),x.disposeIntermediateTensorInfo(Tt),x.disposeIntermediateTensorInfo(gr),x.disposeIntermediateTensorInfo(Br),Kr}else{const I=x.data.get(p.dataId).values,z=x.data.get(g.dataId).values,V=o||p.dtype,[rt,Et]=t(p.shape,g.shape,I,z,V);return x.makeTensorInfo(Et,V,rt)}}}function XT(r){return(t,n,o,u,h,p)=>{const g=Nr(t,n),x=Rt(g),I=g.length,z=vt(g),V=ar("float32",x),rt=ar("float32",x),Et=Wn(t,g),St=Wn(n,g),Tt=cv(o,u),Vt=cv(h,p),ue=t.length,ye=vt(t),qe=n.length,$e=vt(n);if(Et.length+St.length===0)for(let Xe=0;Xe<V.length;Xe++){const Pn=Xe%Tt.length,In=Xe%Vt.length,gr=r(Tt[Pn*2],Tt[Pn*2+1],Vt[In*2],Vt[In*2+1]);V[Xe]=gr.real,rt[Xe]=gr.imag}else for(let Xe=0;Xe<V.length;Xe++){const Pn=bt(Xe,I,z),In=Pn.slice(-ue);Et.forEach(Ya=>In[Ya]=0);const gr=Y(In,ue,ye),Br=Pn.slice(-qe);St.forEach(Ya=>Br[Ya]=0);const Kr=Y(Br,qe,$e),Na=r(Tt[gr*2],Tt[gr*2+1],Vt[Kr*2],Vt[Kr*2+1]);V[Xe]=Na.real,rt[Xe]=Na.imag}return[V,rt,g]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NN=Cf((r,t)=>r+t),XP=XT((r,t,n,o)=>({real:r+n,imag:t+o})),wx=th(Ni,NN,XP),YP={kernelName:Ni,backendName:"cpu",kernelFunc:wx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nc(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{shape:h}=o,p=Rt(u.shape),g=Da(h,p),x=Rt(g);yt(p===x,()=>`The new shape (${g}) has ${x} elements and the old shape (${u.shape}) has ${p} elements. The new shape and old shape must have the same number of elements.`),n.incRef(u.dataId);const I=n.data.get(u.dataId);if(I.complexTensorInfos!=null){const z=I.complexTensorInfos.real,V=I.complexTensorInfos.imag;z.shape=g,V.shape=g}return{dataId:u.dataId,shape:g,dtype:u.dtype}}const KP={kernelName:ws,backendName:"cpu",kernelFunc:Nc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kN(r){const{inputs:t,backend:n,attrs:o}=r,{a:u,b:h}=t,{transposeA:p,transposeB:g}=o;Go([u,h],"matMul");const x=u.shape.length,I=h.shape.length,z=p?u.shape[x-2]:u.shape[x-1],V=g?h.shape[I-1]:h.shape[I-2],rt=p?u.shape[x-1]:u.shape[x-2],Et=g?h.shape[I-2]:h.shape[I-1],St=u.shape.slice(0,-2),Tt=h.shape.slice(0,-2),Vt=Rt(St),ue=Rt(Tt),ye=Vt===ue||Vt===1||ue===1;yt(x>=2&&I>=2&&ye,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${St}) and (${Tt}).`);const $e=(Vt>ue?u.shape.slice(0,-2):h.shape.slice(0,-2)).concat([rt,Et]);yt(z===V,()=>`Error in matMul: inner shapes (${z}) and (${V}) of Tensors with shapes ${u.shape} and ${h.shape} and transposeA=${p} and transposeB=${g} must match.`);const Xe=p?[Vt,z,rt]:[Vt,rt,z],Pn=g?[ue,Et,V]:[ue,V,Et],In=Nc({inputs:{x:u},backend:n,attrs:{shape:Xe}}),gr=Nc({inputs:{x:h},backend:n,attrs:{shape:Pn}}),Br=p?In.shape[1]:In.shape[2],Kr=p?In.shape[2]:In.shape[1],Na=g?gr.shape[1]:gr.shape[2],Ya=Math.max(Vt,ue),Ha=n.data.get(In.dataId).values,ni=n.data.get(gr.dataId).values,Wa=vt(In.shape),za=vt(gr.shape),[mi,qa,yi]=p?[Wa[0],1,Wa[1]]:[Wa[0],Wa[1],1],[Fi,Bi,Ji]=g?[1,za[1],za[0]]:[za[1],1,za[0]],no=Kr*Na,io=vs([Ya,Kr,Na],In.dtype),yo=io.values,lo=n.blockSize;for(let Zo=0;Zo<Ya;Zo++)for(let hs=0;hs<Kr;hs+=lo)for(let xs=0;xs<Na;xs+=lo)for(let iu=0;iu<Br;iu+=lo){const Yu=Math.min(hs+lo,Kr),Wl=Math.min(xs+lo,Na),Gc=Math.min(iu+lo,Br);for(let yc=hs;yc<Yu;yc++)for(let dc=xs;dc<Wl;dc++){let pc=0;for(let bc=iu;bc<Gc;bc++){const df=Math.min(Zo,Vt-1)*mi,rm=Math.min(Zo,ue-1)*Ji,ph=Ha[df+yc*qa+bc*yi],Cg=ni[bc*Fi+dc*Bi+rm];pc+=ph*Cg}yo[Zo*no+(yc*Na+dc)]+=pc}}return n.disposeIntermediateTensorInfo(In),n.disposeIntermediateTensorInfo(gr),n.makeTensorInfo($e,io.dtype,io.values)}const ZP={kernelName:Ei,backendName:"cpu",kernelFunc:kN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qP(r){const{inputs:t,backend:n,attrs:o}=r,{a:u,b:h,bias:p,preluActivationWeights:g}=t,{transposeA:x,transposeB:I,activation:z,leakyreluAlpha:V}=o;let rt,Et,St;const Tt=[];rt=kN({inputs:{a:u,b:h},attrs:{transposeA:x,transposeB:I},backend:n}),p&&(Et=wx({inputs:{a:rt,b:p},backend:n}),Tt.push(rt),rt=Et),z&&(St=HT(n,rt,z,g,V),Tt.push(rt),rt=St);for(const ue of Tt)n.disposeIntermediateTensorInfo(ue);return rt}const QP={kernelName:Wu,backendName:"cpu",kernelFunc:qP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DN(r){const t=new Float32Array(r.length);for(let n=0;n<r.length;++n)t[n]=Math.abs(r[n]);return t}const JP={kernelName:La,backendName:"cpu",kernelFunc:r=>{const{x:t}=r.inputs,n=r.backend;Go(t,"abs");let o=new Float32Array(Rt(t.shape));const u=n.data.get(t.dataId).values;return o=DN(u),n.makeOutput(o,t.shape,"float32")}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t3=Ul(ha,r=>Math.acos(r)),e3={kernelName:ha,backendName:"cpu",kernelFunc:t3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n3=Ul(_i,r=>Math.acosh(r)),r3={kernelName:_i,backendName:"cpu",kernelFunc:n3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3(r){const{inputs:t,backend:n}=r,o=t;Go(t,"addN");const u=o.map(g=>n.data.get(g.dataId).values),h=vs(o[0].shape,o[0].dtype),p=h.values;for(let g=0;g<o.length;g++){const x=u[g];for(let I=0;I<p.length;I++)p[I]+=x[I]}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const i3={kernelName:vi,backendName:"cpu",kernelFunc:a3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YT(r,t,n,o,u){const h=t.length,p=Rt(t),g=vt(t),x=vt(u),I=ar(n,Rt(u));for(let z=0;z<p;++z){const V=bt(z,h,g),rt=new Array(V.length);for(let St=0;St<rt.length;St++)rt[St]=V[o[St]];const Et=Y(rt,h,x);I[Et]=r[z]}return I}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xv(r){const{inputs:t,attrs:n,backend:o}=r,{x:u}=t,{perm:h}=n;Go(u,"transpose");const p=u.shape.length,g=new Array(p);for(let V=0;V<g.length;V++)g[V]=u.shape[h[V]];const x=o.data.get(u.dataId).values,I=YT(x,u.shape,u.dtype,h,g);return{dataId:o.write(I,g,u.dtype),shape:g,dtype:u.dtype}}const o3={kernelName:Lo,backendName:"cpu",kernelFunc:xv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;Go(u,"all");const g=Rr(h,u.shape);let x=g;const I=$c(x,u.shape.length);let z=u;I!=null&&(z=xv({inputs:{x:u},backend:n,attrs:{perm:I}}),x=gc(x.length,u.shape.length)),Pf("all",x,z.shape.length);const[V,rt]=yf(z.shape,x),Et=Rt(rt),St=kt(Rt(V),z.dtype),Tt=n.data.get(z.dataId).values;for(let ue=0;ue<St.length;++ue){const ye=ue*Et;let qe=Tt[ye];for(let $e=0;$e<Et;++$e){const Xe=Tt[ye+$e];qe=qe&&Xe}St[ue]=qe}I!=null&&n.disposeIntermediateTensorInfo(z);const Vt=n.makeTensorInfo(V,z.dtype,St);if(p){const ue=zc(V,g),ye=Nc({inputs:{x:Vt},backend:n,attrs:{shape:ue}});return n.disposeIntermediateTensorInfo(Vt),ye}return Vt}const u3={kernelName:si,backendName:"cpu",kernelFunc:s3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;Go(u,"any");const g=Rr(h,u.shape);let x=g;const I=$c(x,u.shape.length);let z=u;I!=null&&(z=xv({inputs:{x:u},backend:n,attrs:{perm:I}}),x=gc(x.length,u.shape.length)),Pf("any",x,z.shape.length);const[V,rt]=yf(z.shape,x),Et=Rt(rt),St=kt(Rt(V),z.dtype),Tt=n.data.get(z.dataId).values;for(let ue=0;ue<St.length;++ue){const ye=ue*Et;let qe=Tt[ye];for(let $e=0;$e<Et;++$e){const Xe=Tt[ye+$e];qe=qe||Xe}St[ue]=qe}I!=null&&n.disposeIntermediateTensorInfo(z);const Vt=n.makeTensorInfo(V,z.dtype,St);if(p){const ue=zc(V,g),ye=Nc({inputs:{x:Vt},backend:n,attrs:{shape:ue}});return n.disposeIntermediateTensorInfo(Vt),ye}return Vt}const c3={kernelName:Mi,backendName:"cpu",kernelFunc:l3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h}=o;Go(u,"argMax");let p=Rr(h,u.shape);const g=$c(p,u.shape.length);let x=u;const I=[];g!=null&&(x=xv({inputs:{x:u},backend:n,attrs:{perm:g}}),I.push(x),p=gc(p.length,x.shape.length)),p=[p[0]],Pf("argMax",p,x.shape.length);const[z,V]=yf(x.shape,p),rt=Rt(z),Et=kt(rt,"int32"),St=Rt(V),Tt=n.data.get(x.dataId).values;for(let Vt=0;Vt<Et.length;++Vt){const ue=Vt*St;let ye=Tt[ue],qe=0;for(let $e=0;$e<St;++$e){const Xe=Tt[ue+$e];Xe>ye&&(ye=Xe,qe=$e)}Et[Vt]=qe}return I.forEach(Vt=>n.disposeIntermediateTensorInfo(Vt)),n.makeTensorInfo(z,"int32",Et)}const h3={kernelName:Pa,backendName:"cpu",kernelFunc:f3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h}=o;Go(u,"argMin");let p=Rr(h,u.shape);const g=$c(p,u.shape.length);let x=u;const I=[];g!=null&&(x=xv({inputs:{x:u},backend:n,attrs:{perm:g}}),I.push(x),p=gc(p.length,x.shape.length)),p=[p[0]],Pf("argMin",p,x.shape.length);const[z,V]=yf(x.shape,p),rt=Rt(z),Et=kt(rt,"int32"),St=Rt(V),Tt=n.data.get(x.dataId).values;for(let Vt=0;Vt<Et.length;++Vt){const ue=Vt*St;let ye=Tt[ue],qe=0;for(let $e=0;$e<St;++$e){const Xe=Tt[ue+$e];Xe<ye&&(ye=Xe,qe=$e)}Et[Vt]=qe}return I.forEach(Vt=>n.disposeIntermediateTensorInfo(Vt)),n.makeTensorInfo(z,"int32",Et)}const p3={kernelName:un,backendName:"cpu",kernelFunc:d3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v3=Ul(Oe,r=>Math.asin(r)),g3={kernelName:Oe,backendName:"cpu",kernelFunc:v3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m3=Ul(hn,r=>Math.asinh(r)),y3={kernelName:hn,backendName:"cpu",kernelFunc:m3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b3=Ul(Hn,r=>Math.atan(r)),x3={kernelName:Hn,backendName:"cpu",kernelFunc:b3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w3=Cf((r,t)=>Math.atan2(r,t)),E3=th(Jn,w3),S3={kernelName:Jn,backendName:"cpu",kernelFunc:E3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C3=Ul(Bn,r=>Math.atanh(r)),_3={kernelName:Bn,backendName:"cpu",kernelFunc:C3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KT(r,t,n,o,u,h){const p=u.strideHeight,g=u.strideWidth,x=u.dilationHeight,I=u.dilationWidth,z=u.effectiveFilterHeight,V=u.effectiveFilterWidth,rt=u.padInfo.top,Et=u.padInfo.left,St=h==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,Tt=vs(u.outShape,n),Vt=Tt.values,ue=u.outShape[1]*u.outShape[2]*u.outShape[3],ye=u.outShape[2]*u.outShape[3],qe=u.outShape[3];for(let $e=0;$e<u.batchSize;++$e){const Xe=$e*ue,Pn=$e*o[0];for(let In=0;In<u.inChannels;++In)for(let gr=0;gr<u.outHeight;++gr){const Br=gr*p-rt,Kr=Math.max(0,Br),Na=Math.min(u.inHeight,z+Br),Ya=Xe+gr*ye;for(let Ha=0;Ha<u.outWidth;++Ha){const ni=Ha*g-Et,Wa=Math.max(0,ni),za=Math.min(u.inWidth,V+ni);let mi=St,qa=0,yi=0;for(let Bi=Kr;Bi<Na;Bi+=x){const Ji=Pn+Bi*o[1];for(let no=Wa;no<za;no+=I){const io=Ji+no*o[2],yo=r[io+In];h==="max"&&yo>mi?mi=yo:h==="avg"&&(qa+=yo,yi++)}if(isNaN(mi))break}const Fi=Ya+Ha*qe+In;Vt[Fi]=h==="avg"?qa/yi:mi}}}return Tt}function ON(r,t,n,o,u=!1,h=!1){const p=vs(o.outShape,"int32"),g=o.strideHeight,x=o.strideWidth,I=o.dilationHeight,z=o.dilationWidth,V=o.effectiveFilterHeight,rt=o.effectiveFilterWidth,Et=o.padInfo.top,St=o.padInfo.left,Tt=vs(t,n,r);for(let Vt=0;Vt<o.batchSize;++Vt)for(let ue=0;ue<o.inChannels;++ue)for(let ye=0;ye<o.outHeight;++ye){const qe=ye*g-Et;let $e=qe;for(;$e<0;)$e+=I;const Xe=Math.min(o.inHeight,V+qe);for(let Pn=0;Pn<o.outWidth;++Pn){const In=Pn*x-St;let gr=In;for(;gr<0;)gr+=z;const Br=Math.min(o.inWidth,rt+In);let Kr=Number.NEGATIVE_INFINITY,Na=-1;for(let Ya=$e;Ya<Xe;Ya+=I){const Ha=Ya-qe;for(let ni=gr;ni<Br;ni+=z){const Wa=ni-In,za=Tt.get(Vt,Ya,ni,ue);za>Kr&&(Kr=za,u?Na=h?((Vt*o.inHeight+Ya)*o.inWidth+ni)*o.inChannels+ue:(Ya*o.inWidth+ni)*o.inChannels+ue:Na=Ha*rt+Wa)}}p.set(Na,Vt,ye,Pn,ue)}}return p}function RN(r,t,n,o,u,h){const p=u.strideDepth,g=u.strideHeight,x=u.strideWidth,I=u.dilationDepth,z=u.dilationHeight,V=u.dilationWidth,rt=u.effectiveFilterDepth,Et=u.effectiveFilterHeight,St=u.effectiveFilterWidth,Tt=u.padInfo.front,Vt=u.padInfo.top,ue=u.padInfo.left,ye=h==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,qe=vs(u.outShape,n),$e=qe.values,Xe=u.outShape[1]*u.outShape[2]*u.outShape[3]*u.outShape[4],Pn=u.outShape[2]*u.outShape[3]*u.outShape[4],In=u.outShape[3]*u.outShape[4],gr=u.outShape[4];for(let Br=0;Br<u.batchSize;++Br){const Kr=Br*Xe,Na=Br*o[0];for(let Ya=0;Ya<u.inChannels;++Ya)for(let Ha=0;Ha<u.outDepth;++Ha){const ni=Ha*p-Tt;let Wa=ni;for(;Wa<0;)Wa+=I;const za=Math.min(u.inDepth,rt+ni),mi=Kr+Ha*Pn;for(let qa=0;qa<u.outHeight;++qa){const yi=qa*g-Vt;let Fi=yi;for(;Fi<0;)Fi+=z;const Bi=Math.min(u.inHeight,Et+yi),Ji=mi+qa*In;for(let no=0;no<u.outWidth;++no){const io=no*x-ue;let yo=io;for(;yo<0;)yo+=V;const lo=Math.min(u.inWidth,St+io),Zo=Ji+no*gr;let hs=ye,xs=0,iu=0;for(let Wl=Wa;Wl<za;Wl+=I){const Gc=Na+Wl*o[1];for(let yc=Fi;yc<Bi;yc+=z){const dc=Gc+yc*o[2];for(let pc=yo;pc<lo;pc+=V){const bc=dc+pc*o[3],df=r[bc+Ya];if(h==="max"&&df>hs?hs=df:h==="avg"&&(xs+=df,iu++),isNaN(hs))break}if(isNaN(hs))break}if(isNaN(hs))break}const Yu=Zo+Ya;$e[Yu]=h==="avg"?xs/iu:hs}}}}return qe}function I3(r,t){const n=vs(t.outShape,"int32"),o=t.strideDepth,u=t.strideHeight,h=t.strideWidth,p=t.dilationDepth,g=t.dilationHeight,x=t.dilationWidth,I=t.effectiveFilterDepth,z=t.effectiveFilterHeight,V=t.effectiveFilterWidth,rt=t.padInfo.front,Et=t.padInfo.top,St=t.padInfo.left;for(let Tt=0;Tt<t.batchSize;++Tt)for(let Vt=0;Vt<t.inChannels;++Vt)for(let ue=0;ue<t.outDepth;++ue){const ye=ue*o-rt;let qe=ye;for(;qe<0;)qe+=p;const $e=Math.min(t.inDepth,I+ye);for(let Xe=0;Xe<t.outHeight;++Xe){const Pn=Xe*u-Et;let In=Pn;for(;In<0;)In+=g;const gr=Math.min(t.inHeight,z+Pn);for(let Br=0;Br<t.outWidth;++Br){const Kr=Br*h-St;let Na=Kr;for(;Na<0;)Na+=x;const Ya=Math.min(t.inWidth,V+Kr);let Ha=Number.NEGATIVE_INFINITY,ni=-1;for(let Wa=qe;Wa<$e;Wa+=p){const za=Wa-ye;for(let mi=In;mi<gr;mi+=g){const qa=mi-Pn;for(let yi=Na;yi<Ya;yi+=x){const Fi=yi-Kr,Bi=r.get(Tt,Wa,mi,yi,Vt);Bi>=Ha&&(Ha=Bi,ni=za*z*V+qa*z+Fi)}}}n.set(ni,Tt,ue,Xe,Br,Vt)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t;Go(u,"avgPool");const{filterSize:h,strides:p,pad:g,dimRoundingMode:x}=o,I=1;yt(_c(p,I),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${p} and dilations '${I}'`);const z=Rf(u.shape,h,p,I,g,x);let V;if(z.filterWidth===1&&z.filterHeight===1&&Un(z.inShape,z.outShape))V=Eg({inputs:{x:u},backend:n});else{const rt=n.data.get(u.dataId).values,Et=vt(u.shape),St=KT(rt,u.shape,u.dtype,Et,z,"avg");V=n.makeTensorInfo(z.outShape,u.dtype,St.values)}return V}const A3={kernelName:Lr,backendName:"cpu",kernelFunc:T3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{filterSize:h,strides:p,pad:g,dimRoundingMode:x,dataFormat:I,dilations:z}=o;Go(u,"avgPool3d");let V=z;V==null&&(V=[1,1,1]);const rt=bd(u.shape,h,p,V,g,x,I),Et=n.data.get(u.dataId).values,St=RN(Et,u.shape,u.dtype,vt(u.shape),rt,"avg");return n.makeTensorInfo(St.shape,"float32",St.values)}const N3={kernelName:Fa,backendName:"cpu",kernelFunc:M3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k3(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,{filterSize:p,strides:g,pad:x,dilations:I,dimRoundingMode:z}=o;Go([u,h],"avgPool3DGrad");const V=bd(h.shape,p,g,I,x,z),rt=V.strideDepth,Et=V.strideHeight,St=V.strideWidth,Tt=V.filterDepth,Vt=V.filterHeight,ue=V.filterWidth,ye=V.dilationDepth,qe=V.dilationHeight,$e=V.dilationWidth,Xe=V.effectiveFilterDepth,Pn=V.effectiveFilterHeight,In=V.effectiveFilterWidth,gr=Xe-1-V.padInfo.front,Br=In-1-V.padInfo.left,Kr=Pn-1-V.padInfo.top,Na=vs(h.shape,"float32"),Ya=1/(Tt*Vt*ue),Ha=n.bufferSync(u);for(let ni=0;ni<V.batchSize;++ni)for(let Wa=0;Wa<V.inChannels;++Wa)for(let za=0;za<V.inDepth;++za)for(let mi=0;mi<V.inHeight;++mi)for(let qa=0;qa<V.inWidth;++qa){const yi=za-gr,Fi=mi-Kr,Bi=qa-Br;let Ji=0;for(let no=0;no<Xe;no+=ye){const io=(yi+no)/rt;if(!(io<0||io>=V.outDepth||Math.floor(io)!==io))for(let yo=0;yo<Pn;yo+=qe){const lo=(Fi+yo)/Et;if(!(lo<0||lo>=V.outHeight||Math.floor(lo)!==lo))for(let Zo=0;Zo<In;Zo+=$e){const hs=(Bi+Zo)/St;if(hs<0||hs>=V.outWidth||Math.floor(hs)!==hs)continue;Ji+=Ha.get(ni,io,lo,hs,Wa)}}}Na.set(Ji*Ya,ni,za,mi,qa,Wa)}return n.makeTensorInfo(Na.shape,Na.dtype,Na.values)}const D3={kernelName:ui,backendName:"cpu",kernelFunc:k3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O3(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,p=h;Go([u,h],"avgPoolGrad");const{filterSize:g,strides:x,pad:I}=o,z=Rf(p.shape,g,x,1,I),V=z.strideHeight,rt=z.strideWidth,Et=z.filterHeight,St=z.filterWidth,Tt=z.dilationHeight,Vt=z.dilationWidth,ue=z.effectiveFilterHeight,ye=z.effectiveFilterWidth,qe=ye-1-z.padInfo.left,$e=ue-1-z.padInfo.top,Xe=vs(p.shape,"float32"),Pn=1/(Et*St),In=n.data.get(u.dataId).values,gr=vs(u.shape,"float32",In);for(let Br=0;Br<z.batchSize;++Br)for(let Kr=0;Kr<z.inChannels;++Kr)for(let Na=0;Na<z.inHeight;++Na)for(let Ya=0;Ya<z.inWidth;++Ya){const Ha=Na-$e,ni=Ya-qe;let Wa=0;for(let za=0;za<ue;za+=Tt){const mi=(Ha+za)/V;if(!(mi<0||mi>=z.outHeight||Math.floor(mi)!==mi))for(let qa=0;qa<ye;qa+=Vt){const yi=(ni+qa)/rt;if(yi<0||yi>=z.outWidth||Math.floor(yi)!==yi)continue;Wa+=gr.get(Br,mi,yi,Kr)}}Xe.set(Wa*Pn,Br,Na,Ya,Kr)}return n.makeTensorInfo(Xe.shape,Xe.dtype,Xe.values)}const R3={kernelName:ya,backendName:"cpu",kernelFunc:O3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,scale:h,offset:p,mean:g,variance:x}=t;yt(g.shape.length===x.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),yt(p==null||g.shape.length===p.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),yt(h==null||g.shape.length===h.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Go([u,g,x,h,p],"batchNorm");let{varianceEpsilon:I}=o;I==null&&(I=.001);const z=n.data.get(u.dataId).values,V=n.data.get(g.dataId).values,rt=n.data.get(x.dataId).values,Et=h?n.data.get(h.dataId).values:new Float32Array([1]),St=p?n.data.get(p.dataId).values:new Float32Array([0]),Tt=new Float32Array(z.length),Vt=St.length,ue=Et.length,ye=rt.length,qe=V.length;let $e=0,Xe=0,Pn=0,In=0;for(let gr=0;gr<z.length;++gr)Tt[gr]=St[$e++]+(z[gr]-V[Xe++])*Et[Pn++]/Math.sqrt(rt[In++]+I),$e>=Vt&&($e=0),Xe>=qe&&(Xe=0),Pn>=ue&&(Pn=0),In>=ye&&(In=0);return n.makeTensorInfo(u.shape,u.dtype,Tt)}const P3={kernelName:xo,backendName:"cpu",kernelFunc:L3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LN(r,t,n,o,u){const h=Dv(o,t,n),p=Rt(n),g=vt(o);if(h){const V=ev(t,g);return u==="string"?r.slice(V,V+p):r.subarray(V,V+p)}const x=u==="string"?_0(r):r,I=vs(o,u,x),z=vs(n,u);for(let V=0;V<z.size;++V){const rt=z.indexToLoc(V),Et=rt.map((St,Tt)=>St+t[Tt]);z.set(I.get(...Et),...rt)}return u==="string"?I0(z.values):z.values}function U0(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{begin:h,size:p}=o;Go(u,"slice");const[g,x]=Zd(u,h,p);gd(u,g,x);const I=n.data.get(u.dataId).values,z=LN(I,g,x,u.shape,u.dtype);return n.makeTensorInfo(x,u.dtype,z)}const F3={kernelName:ef,backendName:"cpu",kernelFunc:U0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockShape:h,crops:p}=o;Go([u],"batchToSpaceND");const g=h.reduce((ue,ye)=>ue*ye),x=E0(u.shape,h,g),I=Im(x.length,h.length),z=Hv(u.shape,h,g),V=yb(p,h.length),rt=bb(z,p,h.length),Et=Nc({inputs:{x:u},backend:n,attrs:{shape:x}}),St=xv({inputs:{x:Et},backend:n,attrs:{perm:I}}),Tt=Nc({inputs:{x:St},backend:n,attrs:{shape:z}}),Vt=U0({inputs:{x:Tt},backend:n,attrs:{begin:V,size:rt}});return n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(St),n.disposeIntermediateTensorInfo(Tt),Vt}const z3={kernelName:oo,backendName:"cpu",kernelFunc:B3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZT(r,t,n,o,u){const h=Rt(o),p=kt(u,n);for(let g=0;g<r.length;g++){const x=r[g];if(x<0)throw new Error("Input x must be non-negative!");x>=u||(h>0?p[x]+=t[g]:p[x]+=1)}return p}function PN(r,t,n,o=!1){const u=r.shape[0],h=r.shape[1],p=vs([u,n],t.dtype);for(let g=0;g<u;g++)for(let x=0;x<h;x++){const I=r.get(g,x);if(I<0)throw new Error("Input x must be non-negative!");I>=n||(o?p.set(1,g,I):t.size>0?p.set(p.get(g,I)+t.get(g,x),g,I):p.set(p.get(g,I)+1,g,I))}return p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,weights:h}=t,{size:p}=o,g=n.data.get(u.dataId).values,x=n.data.get(h.dataId).values,I=ZT(g,x,h.dtype,h.shape,p);return n.makeTensorInfo([p],h.dtype,I)}const G3={kernelName:po,backendName:"cpu",kernelFunc:$3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v1(r){return(t,n,o)=>{const u=ar(n,t.length);for(let h=0;h<t.length;++h)u[h]=r(t[h],o);return u}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FN=v1(r=>Math.ceil(r)),U3=p1(Wo,FN),W3={kernelName:Wo,backendName:"cpu",kernelFunc:U3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V3=Ul(Yi,(r,t)=>{const n=t;return r>n.clipValueMax?n.clipValueMax:r<n.clipValueMin?n.clipValueMin:r}),j3={kernelName:Yi,backendName:"cpu",kernelFunc:V3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H3={kernelName:gi,backendName:"cpu",kernelFunc:r=>{const{x:t}=r.inputs,n=r.backend,o=new Float32Array(Rt(t.shape)),u=n.data.get(t.dataId),h=u.complexTensorInfos.real,p=u.complexTensorInfos.imag,g=n.data.get(h.dataId).values,x=n.data.get(p.dataId).values;for(let I=0;I<g.length;I++){const z=g[I],V=x[I];o[I]=Math.hypot(z,V)}return n.makeOutput(o,t.shape,"float32")}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BN(r,t,n,o){const u=Fn(n,Rt(t));if(o&&n!=="string"){let h=0;r.forEach(p=>{const g=Rt(p.shape);u.set(p.vals,h),h+=g})}else{let h=0;r.forEach(p=>{const g=n==="string"?_0(p.vals):p.vals;let x=0;for(let I=0;I<p.shape[0];++I){const z=I*t[1]+h;for(let V=0;V<p.shape[1];++V)u[z+V]=g[x++]}h+=p.shape[1]})}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1(r){const{inputs:t,backend:n}=r,{input:o}=t,u=n.data.get(o.dataId).complexTensorInfos.imag,h=n.data.get(u.dataId).values;return n.makeTensorInfo(u.shape,u.dtype,h)}const X3={kernelName:kl,backendName:"cpu",kernelFunc:g1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m1(r){const{inputs:t,backend:n,attrs:o}=r,{axis:u}=o,h=Rr(u,t[0].shape)[0];let p=jv(t.map(Tt=>Tt.shape),h);if(Rt(p)===0)return n.makeTensorInfo(p,t[0].dtype,[]);const g=t.filter(Tt=>Rt(Tt.shape)>0);if(g.length===1)return Eg({inputs:{x:g[0]},backend:n});const x=g.map(Tt=>Tt.shape);if(Ay(x,h),g[0].dtype==="complex64"){const Tt=g.map($e=>G0({inputs:{input:$e},backend:n})),Vt=g.map($e=>g1({inputs:{input:$e},backend:n})),ue=m1({inputs:Tt,backend:n,attrs:{axis:h}}),ye=m1({inputs:Vt,backend:n,attrs:{axis:h}}),qe=hp({inputs:{real:ue,imag:ye},backend:n});return Tt.forEach($e=>n.disposeIntermediateTensorInfo($e)),Vt.forEach($e=>n.disposeIntermediateTensorInfo($e)),n.disposeIntermediateTensorInfo(ue),n.disposeIntermediateTensorInfo(ye),qe}const I=g.map(Tt=>{const Vt=Rt(Tt.shape.slice(h));return Nc({inputs:{x:Tt},backend:n,attrs:{shape:[-1,Vt]}})}),z=I.map(Tt=>({vals:n.data.get(Tt.dataId).values,shape:Tt.shape}));p=jv(I.map(Tt=>Tt.shape),1);const V=I[0].shape[0]===1,rt=BN(z,p,t[0].dtype,V),Et=jv(g.map(Tt=>Tt.shape),h),St=n.makeTensorInfo(Et,t[0].dtype,rt);return I.forEach(Tt=>n.disposeIntermediateTensorInfo(Tt)),St}const Y3={kernelName:us,backendName:"cpu",kernelFunc:m1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zN(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dataFormat:x,dilations:I,dimRoundingMode:z}=o;Go([u,h],"conv2d");const V=m(x),rt=ql(u.shape,h.shape,p,I,g,z,!1,V),Et=rt.filterHeight,St=rt.filterWidth,Tt=rt.dilationHeight,Vt=rt.dilationWidth,ue=rt.padInfo.left,ye=rt.padInfo.top,qe=rt.dataFormat==="channelsLast",$e=new ne(rt.outShape,u.dtype),Xe=vt(u.shape),Pn=vt(h.shape),In=Xe[0],gr=qe?Xe[1]:Xe[2],Br=qe?Xe[2]:1,Kr=qe?1:Xe[1],Na=$e.strides[0],Ya=qe?$e.strides[1]:$e.strides[2],Ha=qe?$e.strides[2]:1,ni=qe?1:$e.strides[1],Wa=n.data.get(u.dataId).values,za=n.data.get(h.dataId).values,mi=$e.values;for(let qa=0;qa<rt.batchSize;++qa){const yi=qa*In,Fi=qa*Na;for(let Bi=0;Bi<rt.outHeight;++Bi){const Ji=Fi+Bi*Ya,no=Bi*rt.strideHeight-ye;for(let io=0;io<Et;++io){const yo=no+io*Tt;if(yo<0||yo>=rt.inHeight)continue;const lo=io*Pn[0],Zo=yi+yo*gr;for(let hs=0;hs<rt.outWidth;++hs){const xs=Ji+hs*Ha,iu=hs*rt.strideWidth-ue;for(let Yu=0;Yu<St;++Yu){const Wl=iu+Yu*Vt;if(Wl<0||Wl>=rt.inWidth)continue;const Gc=lo+Yu*Pn[1],yc=Zo+Wl*Br;let dc=Gc;for(let pc=0;pc<rt.inChannels;++pc){const bc=Wa[yc+pc*Kr];for(let df=0;df<rt.outChannels;++df)mi[xs+df*ni]+=bc*za[dc+df];dc+=rt.outChannels}}}}}}return n.makeTensorInfo($e.shape,$e.dtype,mi)}const K3={kernelName:Do,backendName:"cpu",kernelFunc:zN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,pad:g,dataFormat:x,dimRoundingMode:I,filterShape:z}=o;Go([u,h],"conv2dBackpropFilter");const V=m(x),rt=ql(u.shape,z,p,1,g,I,!1,V),{strideHeight:Et,strideWidth:St,filterHeight:Tt,filterWidth:Vt}=rt,ue=rt.dataFormat==="channelsLast",ye=new ne(rt.filterShape,"float32"),qe=rt.padInfo.left,$e=rt.padInfo.top,Xe=n.data.get(u.dataId).values,Pn=n.data.get(h.dataId).values,In=new ne(u.shape,u.dtype,Xe),gr=new ne(h.shape,h.dtype,Pn);for(let Br=0;Br<Tt;++Br){const Kr=Math.max(0,Math.ceil(($e-Br)/Et)),Na=Math.min(rt.outHeight,(rt.inHeight+$e-Br)/Et);for(let Ya=0;Ya<Vt;++Ya){const Ha=Math.max(0,Math.ceil((qe-Ya)/St)),ni=Math.min(rt.outWidth,(rt.inWidth+qe-Ya)/St);for(let Wa=0;Wa<rt.inChannels;++Wa)for(let za=0;za<rt.outChannels;++za){let mi=0;for(let qa=0;qa<rt.batchSize;++qa)for(let yi=Kr;yi<Na;++yi){const Fi=Br+yi*Et-$e;for(let Bi=Ha;Bi<ni;++Bi){const Ji=Ya+Bi*St-qe;ue?mi+=In.get(qa,Fi,Ji,Wa)*gr.get(qa,yi,Bi,za):mi+=In.get(qa,Wa,Fi,Ji)*gr.get(qa,za,yi,Bi)}}ye.set(mi,Br,Ya,Wa,za)}}}return n.makeTensorInfo(ye.shape,ye.dtype,ye.values)}const q3={kernelName:Io,backendName:"cpu",kernelFunc:Z3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q3(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{inputShape:p,strides:g,pad:x,dataFormat:I,dimRoundingMode:z}=o;Go([u,h],"conv2dBackpropInput");const V=vt(h.shape),rt=vt(u.shape);let Et=m(I);const St=ql(p,h.shape,g,1,x,z,!1,Et),Tt=new ne(St.inShape,"float32"),Vt=Tt.values,ue=n.data.get(u.dataId).values,ye=n.data.get(h.dataId).values,[qe,$e,Xe]=V,{batchSize:Pn,filterHeight:In,filterWidth:gr,inChannels:Br,inHeight:Kr,inWidth:Na,outChannels:Ya,outHeight:Ha,outWidth:ni,strideHeight:Wa,strideWidth:za}=St;Et=St.dataFormat;const mi=In-1-St.padInfo.top,qa=gr-1-St.padInfo.left,yi=Et==="channelsLast",Fi=Tt.strides[0],Bi=yi?Tt.strides[1]:Tt.strides[2],Ji=yi?Tt.strides[2]:1,no=yi?1:Tt.strides[1],io=rt[0],yo=yi?rt[1]:rt[2],lo=yi?rt[2]:1,Zo=yi?1:rt[1];for(let hs=0;hs<Pn;++hs)for(let xs=0;xs<Br;++xs)for(let iu=0;iu<Kr;++iu){const Yu=iu-mi,Wl=Math.max(0,Math.ceil(Yu/Wa)),Gc=Math.min(Ha,(In+Yu)/Wa);for(let yc=0;yc<Na;++yc){const dc=yc-qa,pc=Math.max(0,Math.ceil(dc/za)),bc=Math.min(ni,(gr+dc)/za);let df=0;for(let ph=Wl;ph<Gc;++ph){const Cg=ph*Wa-Yu;for(let zp=pc;zp<bc;++zp){const H0=zp*za-dc,eg=io*hs+yo*ph+lo*zp,am=qe*(In-1-Cg)+$e*(gr-1-H0)+Xe*xs;for(let Gm=0;Gm<Ya;++Gm){const Um=ue[eg+Zo*Gm],Wm=ye[am+Gm];df+=Um*Wm}}}const rm=Fi*hs+Bi*iu+Ji*yc+no*xs;Vt[rm]=df}}return n.makeTensorInfo(Tt.shape,Tt.dtype,Tt.values)}const J3={kernelName:zs,backendName:"cpu",kernelFunc:Q3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dilations:x}=o;Go([u,h],"conv3d");const I=_p(u.shape,h.shape,p,x,g),{filterDepth:z,filterHeight:V,filterWidth:rt,dilationDepth:Et,dilationHeight:St,dilationWidth:Tt,padInfo:Vt}=I,ue=Vt.front,ye=Vt.left,qe=Vt.top,$e=new ne(I.outShape,u.dtype),Xe=n.data.get(u.dataId).values,Pn=n.data.get(h.dataId).values,In=$e.values,gr=vt(u.shape),Br=vt(h.shape);for(let Kr=0;Kr<I.batchSize;++Kr){const Na=Kr*gr[0],Ya=Kr*$e.strides[0];for(let Ha=0;Ha<I.outDepth;++Ha){const ni=Ya+Ha*$e.strides[1],Wa=Ha*I.strideDepth-ue;for(let za=0;za<z;++za){const mi=Wa+za*Et;if(mi<0||mi>=I.inDepth)continue;const qa=za*Br[0],yi=Na+mi*gr[1];for(let Fi=0;Fi<I.outHeight;++Fi){const Bi=ni+Fi*$e.strides[2],Ji=Fi*I.strideHeight-qe;for(let no=0;no<V;++no){const io=Ji+no*St;if(io<0||io>=I.inHeight)continue;const yo=qa+no*Br[1],lo=yi+io*gr[2];for(let Zo=0;Zo<I.outWidth;++Zo){const hs=Bi+Zo*I.outChannels,xs=Zo*I.strideWidth-ye;for(let iu=0;iu<rt;++iu){const Yu=xs+iu*Tt;if(Yu<0||Yu>=I.inWidth)continue;const Wl=yo+iu*Br[2],Gc=lo+Yu*I.inChannels;let yc=Wl;for(let dc=0;dc<I.inChannels;++dc){const pc=Xe[Gc+dc];for(let bc=0;bc<I.outChannels;++bc)In[hs+bc]+=pc*Pn[yc+bc];yc+=I.outChannels}}}}}}}}return n.makeTensorInfo($e.shape,$e.dtype,$e.values)}const eF={kernelName:mu,backendName:"cpu",kernelFunc:tF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,pad:g,filterShape:x}=o;Go([u,h],"conv3dBackpropFilterV2");const I=vt(u.shape),z=vt(h.shape),V=_p(u.shape,x,p,1,g),rt=V.strideDepth,Et=V.strideHeight,St=V.strideWidth,Tt=V.filterDepth,Vt=V.filterHeight,ue=V.filterWidth,ye=new ne(V.filterShape,"float32"),qe=ye.values,[$e,Xe,Pn,In]=ye.strides,gr=n.data.get(h.dataId).values,[Br,Kr,Na,Ya]=z,Ha=n.data.get(u.dataId).values,[ni,Wa,za,mi]=I,qa=V.padInfo.front,yi=V.padInfo.left,Fi=V.padInfo.top;for(let Bi=0;Bi<Tt;++Bi){const Ji=Math.max(0,Math.ceil((qa-Bi)/rt)),no=Math.min(V.outDepth,(V.inDepth+qa-Bi)/rt),io=Bi*$e;for(let yo=0;yo<Vt;++yo){const lo=Math.max(0,Math.ceil((Fi-yo)/Et)),Zo=Math.min(V.outHeight,(V.inHeight+Fi-yo)/Et),hs=yo*Xe+io;for(let xs=0;xs<ue;++xs){const iu=Math.max(0,Math.ceil((yi-xs)/St)),Yu=Math.min(V.outWidth,(V.inWidth+yi-xs)/St),Wl=xs*Pn+hs;for(let Gc=0;Gc<V.inChannels;++Gc){const yc=Gc*In+Wl;for(let dc=0;dc<V.outChannels;++dc){let pc=0;for(let bc=0;bc<V.batchSize;++bc){const df=bc*ni,rm=bc*Br;for(let ph=Ji;ph<no;++ph){const zp=(Bi+ph*rt-qa)*Wa+df,H0=ph*Kr+rm;for(let eg=lo;eg<Zo;++eg){const Gm=(yo+eg*Et-Fi)*za+zp,Um=eg*Na+H0;for(let Wm=iu;Wm<Yu;++Wm){const yA=(xs+Wm*St-yi)*mi+Gm,bA=Wm*Ya+Um;pc+=Ha[yA+Gc]*gr[bA+dc]}}}}qe[yc+dc]=pc}}}}}return n.makeTensorInfo(ye.shape,ye.dtype,ye.values)}const rF={kernelName:ds,backendName:"cpu",kernelFunc:nF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aF(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{pad:p,strides:g,inputShape:x}=o;Go([u],"conv3dBackpropInputV2");const I=vt(u.shape),z=vt(h.shape),V=_p(x,h.shape,g,1,p),rt=new ne(V.inShape,"float32"),Et=rt.values,[St,Tt,Vt,ue]=rt.strides,ye=n.data.get(u.dataId).values,[qe,$e,Xe,Pn]=I,In=n.data.get(h.dataId).values,[gr,Br,Kr,Na]=z,{batchSize:Ya,filterDepth:Ha,filterHeight:ni,filterWidth:Wa,inChannels:za,inDepth:mi,inHeight:qa,inWidth:yi,outChannels:Fi,outDepth:Bi,outHeight:Ji,outWidth:no,strideDepth:io,strideHeight:yo,strideWidth:lo}=V,Zo=Ha-1-V.padInfo.front,hs=ni-1-V.padInfo.top,xs=Wa-1-V.padInfo.left;for(let iu=0;iu<Ya;++iu)for(let Yu=0;Yu<za;++Yu)for(let Wl=0;Wl<mi;++Wl){const Gc=Wl-Zo,yc=Math.max(0,Math.ceil(Gc/io)),dc=Math.min(Bi,(Ha+Gc)/io);for(let pc=0;pc<qa;++pc){const bc=pc-hs,df=Math.max(0,Math.ceil(bc/yo)),rm=Math.min(Ji,(ni+bc)/yo);for(let ph=0;ph<yi;++ph){const Cg=ph-xs,zp=Math.max(0,Math.ceil(Cg/lo)),H0=Math.min(no,(Wa+Cg)/lo);let eg=0;for(let am=yc;am<dc;++am){const Gm=am*io-Gc;for(let Um=df;Um<rm;++Um){const Wm=Um*yo-bc;for(let kx=zp;kx<H0;++kx){const yA=kx*lo-Cg,bA=qe*iu+$e*am+Xe*Um+Pn*kx,X9=gr*(Ha-1-Gm)+Br*(ni-1-Wm)+Kr*(Wa-1-yA)+Na*Yu;for(let bS=0;bS<Fi;++bS){const Y9=ye[bA+bS],K9=In[X9+bS];eg+=Y9*K9}}}}Et[St*iu+Tt*Wl+Vt*pc+ue*ph+Yu]=eg}}}return n.makeTensorInfo(rt.shape,rt.dtype,rt.values)}const iF={kernelName:Ms,backendName:"cpu",kernelFunc:aF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oF=Ul(yu,r=>Math.cos(r)),sF={kernelName:yu,backendName:"cpu",kernelFunc:oF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uF=Ul(uu,r=>Math.cosh(r)),lF={kernelName:uu,backendName:"cpu",kernelFunc:uF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cF(r){const{inputs:t,backend:n,attrs:o}=r,{image:u,boxes:h,boxInd:p}=t,{cropSize:g,method:x,extrapolationValue:I}=o,[z,V,rt,Et]=u.shape,St=h.shape[0],[Tt,Vt]=g,ue=vs([St,Tt,Vt,Et],"float32"),ye=n.data.get(h.dataId).values,qe=n.data.get(p.dataId).values,$e=n.data.get(u.dataId).values,Xe=vt(u.shape),Pn=vt(ue.shape);for(let In=0;In<St;In++){const gr=In*4,Br=ye[gr],Kr=ye[gr+1],Na=ye[gr+2],Ya=ye[gr+3],Ha=qe[In];if(Ha>=z)continue;const ni=Tt>1?(Na-Br)*(V-1)/(Tt-1):0,Wa=Vt>1?(Ya-Kr)*(rt-1)/(Vt-1):0;for(let za=0;za<Tt;za++){const mi=Tt>1?Br*(V-1)+za*ni:.5*(Br+Na)*(V-1);if(mi<0||mi>V-1){for(let qa=0;qa<Vt;qa++)for(let yi=0;yi<Et;yi++){const Fi=yi+qa*Pn[2]+za*Pn[1]+In*Pn[0];ue.values[Fi]=I}continue}if(x==="bilinear"){const qa=Math.floor(mi),yi=Math.ceil(mi),Fi=mi-qa;for(let Bi=0;Bi<Vt;Bi++){const Ji=Vt>1?Kr*(rt-1)+Bi*Wa:.5*(Kr+Ya)*(rt-1);if(Ji<0||Ji>rt-1){for(let lo=0;lo<Et;lo++){const Zo=lo+Bi*Pn[2]+za*Pn[1]+In*Pn[0];ue.values[Zo]=I}continue}const no=Math.floor(Ji),io=Math.ceil(Ji),yo=Ji-no;for(let lo=0;lo<Et;lo++){let Zo=lo+no*Xe[2]+qa*Xe[1]+Ha*Xe[0];const hs=$e[Zo];Zo=lo+io*Xe[2]+qa*Xe[1]+Ha*Xe[0];const xs=$e[Zo];Zo=lo+no*Xe[2]+yi*Xe[1]+Ha*Xe[0];const iu=$e[Zo];Zo=lo+io*Xe[2]+yi*Xe[1]+Ha*Xe[0];const Yu=$e[Zo],Wl=hs+(xs-hs)*yo,Gc=iu+(Yu-iu)*yo;Zo=lo+Bi*Pn[2]+za*Pn[1]+In*Pn[0],ue.values[Zo]=Wl+(Gc-Wl)*Fi}}}else for(let qa=0;qa<Vt;++qa){const yi=Vt>1?Kr*(rt-1)+qa*Wa:.5*(Kr+Ya)*(rt-1);if(yi<0||yi>rt-1){for(let Ji=0;Ji<Et;Ji++){const no=Ji+qa*Pn[2]+za*Pn[1]+In*Pn[0];ue.values[no]=I}continue}const Fi=Math.round(yi),Bi=Math.round(mi);for(let Ji=0;Ji<Et;Ji++){const no=Ji+Fi*Xe[2]+Bi*Xe[1]+Ha*Xe[0],io=Ji+qa*Pn[2]+za*Pn[1]+In*Pn[0];ue.values[io]=$e[no]}}}}return n.makeTensorInfo(ue.shape,ue.dtype,ue.values)}const fF={kernelName:qo,backendName:"cpu",kernelFunc:cF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,exclusive:p,reverse:g}=o;Go(u,"cumsum");const x=$c([h],u.shape.length);let I=u;x!=null&&(I=xv({inputs:{x:u},backend:n,attrs:{perm:x}}));const z=gc(1,u.shape.length)[0];if(z!==I.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${I.shape.length-1} but got axis=${z}`);const V=so(I.dtype,"int32"),rt=kt(Rt(I.shape),V),Et=n.data.get(I.dataId).values,St=I.shape[I.shape.length-1],Tt=g?(ue,ye)=>ue+St-ye-1:(ue,ye)=>ue+ye;for(let ue=0;ue<Et.length;ue+=St)for(let ye=0;ye<St;ye++){const qe=Tt(ue,ye);if(ye===0)rt[qe]=p?0:Et[qe];else{const $e=Tt(ue,ye-1);rt[qe]=p?Et[$e]+rt[$e]:Et[qe]+rt[$e]}}const Vt=n.makeTensorInfo(I.shape,V,rt);if(x!=null){const ue=mm(x),ye=xv({inputs:{x:Vt},backend:n,attrs:{perm:ue}});return n.disposeIntermediateTensorInfo(Vt),n.disposeIntermediateTensorInfo(I),ye}return Vt}const dF={kernelName:Cs,backendName:"cpu",kernelFunc:hF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,weights:h}=t,{size:p,binaryOutput:g}=o;if(u.shape.length===1){const x=n.data.get(u.dataId).values,I=n.data.get(h.dataId).values,z=ZT(x,I,h.dtype,h.shape,p);return n.makeTensorInfo([p],h.dtype,z)}else if(u.shape.length===2){const x=n.bufferSync(u),I=n.bufferSync(h),z=PN(x,I,p,g);return n.makeTensorInfo(z.shape,h.dtype,z.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${u.shape.length}.`)}const vF={kernelName:Wi,backendName:"cpu",kernelFunc:pF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockSize:h,dataFormat:p}=o;yt(p==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${p}`),yt(h>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${h}`);const g=u.shape[0],x=u.shape[1],I=u.shape[2],z=u.shape[3],V=x*h,rt=I*h,Et=z/(h*h),St=n.data.get(u.dataId).values,Tt=new Float32Array(g*V*rt*Et);let Vt=0;for(let ue=0;ue<g;++ue)for(let ye=0;ye<V;++ye){const qe=Math.floor(ye/h),$e=ye%h;for(let Xe=0;Xe<rt;++Xe){const Pn=Math.floor(Xe/h),In=Xe%h,gr=($e*h+In)*Et;for(let Br=0;Br<Et;++Br){const Na=Br+gr+z*(Pn+I*(qe+x*ue));Tt[Vt++]=St[Na]}}}return n.makeTensorInfo([g,V,rt,Et],u.dtype,Tt)}const mF={kernelName:ls,backendName:"cpu",kernelFunc:gF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $N(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dilations:x,dimRoundingMode:I}=o;Go([u,h],"depthwiseConv2DNative");const z=vt(u.shape),V=vt(h.shape);let rt=x;rt==null&&(rt=[1,1]),yt(_c(p,rt),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${p} and dilations '${rt}'`);const Et=ql(u.shape,h.shape,p,rt,g,I,!0),{filterHeight:St,filterWidth:Tt,dilationHeight:Vt,dilationWidth:ue,padInfo:ye}=Et,qe=ye.left,$e=ye.top,Xe=Et.outChannels/Et.inChannels,Pn=new ne(Et.outShape,u.dtype),In=n.data.get(u.dataId).values,gr=n.data.get(h.dataId).values,Br=Pn.values;for(let Kr=0;Kr<Et.batchSize;++Kr){const Na=Kr*z[0],Ya=Kr*Pn.strides[0];for(let Ha=0;Ha<Et.outHeight;++Ha){const ni=Ya+Ha*Pn.strides[1],Wa=Ha*Et.strideHeight-qe;for(let za=0;za<St;++za){const mi=Wa+za*Vt;if(mi<0||mi>=Et.inHeight)continue;const qa=za*V[0],yi=Na+mi*z[1];for(let Fi=0;Fi<Et.outWidth;++Fi){const Bi=ni+Fi*Pn.strides[2],Ji=Fi*Et.strideWidth-$e;for(let no=0;no<Tt;++no){const io=Ji+no*ue;if(io<0||io>=Et.inWidth)continue;const yo=qa+no*V[1],lo=yi+io*Et.inChannels;let Zo=Bi,hs=yo;for(let xs=0;xs<Et.inChannels;++xs){const iu=In[lo+xs];for(let Yu=0;Yu<Xe;++Yu)Br[Zo+Yu]+=iu*gr[hs+Yu];Zo+=Xe,hs+=Xe}}}}}}return n.makeTensorInfo(Pn.shape,Pn.dtype,Pn.values)}const yF={kernelName:is,backendName:"cpu",kernelFunc:$N};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,dilations:g,pad:x,dimRoundingMode:I,filterShape:z}=o;Go([u,h],"depthwiseConv2dNativeBackpropFilter");const V=ql(u.shape,z,p,g,x,I,!0),{strideHeight:rt,strideWidth:Et,filterHeight:St,filterWidth:Tt}=V,Vt=new ne(V.filterShape,"float32"),ue=V.padInfo.left,ye=V.padInfo.top,qe=V.outChannels/V.inChannels,$e=n.data.get(u.dataId).values,Xe=new ne(u.shape,u.dtype,$e),Pn=n.data.get(h.dataId).values,In=new ne(h.shape,h.dtype,Pn);for(let gr=0;gr<St;++gr){const Br=Math.max(0,Math.ceil((ye-gr)/rt)),Kr=Math.min(V.outHeight,(V.inHeight+ye-gr)/rt);for(let Na=0;Na<Tt;++Na){const Ya=Math.max(0,Math.ceil((ue-Na)/Et)),Ha=Math.min(V.outWidth,(V.inWidth+ue-Na)/Et);for(let ni=0;ni<V.outChannels;++ni){const Wa=Math.trunc(ni/qe),za=ni%qe;let mi=0;for(let qa=0;qa<V.batchSize;++qa)for(let yi=Br;yi<Kr;++yi){const Fi=gr+yi*rt-ye;for(let Bi=Ya;Bi<Ha;++Bi){const Ji=Na+Bi*Et-ue;mi+=Xe.get(qa,Fi,Ji,Wa)*In.get(qa,yi,Bi,ni)}}Vt.set(mi,gr,Na,Wa,za)}}}return n.makeTensorInfo(Vt.shape,Vt.dtype,Vt.values)}const xF={kernelName:Es,backendName:"cpu",kernelFunc:bF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wF(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{strides:p,dilations:g,pad:x,dimRoundingMode:I,inputShape:z}=o;Go([u,h],"depthwiseConv2DNativeBackpropInput");const V=vt(u.shape),rt=vt(h.shape),Et=ql(z,h.shape,p,g,x,I,!0),St=new ne(Et.inShape,"float32"),Tt=St.values,[Vt,ue,ye]=St.strides,qe=n.data.get(u.dataId).values,[$e,Xe,Pn]=V,In=n.data.get(h.dataId).values,[gr,Br,Kr]=rt,{batchSize:Na,filterHeight:Ya,filterWidth:Ha,inChannels:ni,inHeight:Wa,inWidth:za,outChannels:mi,outHeight:qa,outWidth:yi,strideHeight:Fi,strideWidth:Bi}=Et,Ji=Ya-1-Et.padInfo.top,no=Ha-1-Et.padInfo.left,io=mi/ni;for(let yo=0;yo<Na;++yo)for(let lo=0;lo<ni;++lo)for(let Zo=0;Zo<Wa;++Zo){const hs=Zo-Ji,xs=Math.max(0,Math.ceil(hs/Fi)),iu=Math.min(qa,(Ya+hs)/Fi);for(let Yu=0;Yu<za;++Yu){const Wl=Yu-no,Gc=Math.max(0,Math.ceil(Wl/Bi)),yc=Math.min(yi,(Ha+Wl)/Bi);let dc=0;for(let pc=xs;pc<iu;++pc){const bc=pc*Fi-hs;for(let df=Gc;df<yc;++df){const rm=df*Bi-Wl,ph=$e*yo+Xe*pc+Pn*df,Cg=gr*(Ya-1-bc)+Br*(Ha-1-rm)+Kr*lo;for(let zp=0;zp<io;++zp){const H0=lo*io+zp,eg=qe[ph+H0],am=In[Cg+zp];dc+=eg*am}}}Tt[Vt*yo+ue*Zo+ye*Yu+lo]=dc}}return n.makeTensorInfo(St.shape,St.dtype,St.values)}const EF={kernelName:tl,backendName:"cpu",kernelFunc:wF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SF(r){const{inputs:t,backend:n}=r,{x:o}=t,u=Rt(o.shape),h=n.data.get(o.dataId).values,p=vs([u,u],o.dtype),g=p.values;for(let I=0;I<h.length;I++)g[I*u+I]=h[I];const x=[...o.shape,...o.shape];return n.makeTensorInfo(x,p.dtype,p.values)}const CF={kernelName:bu,backendName:"cpu",kernelFunc:SF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _F={kernelName:Ys,backendName:"cpu",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:o,filter:u}=r,{strides:h,pad:p,dilations:g}=n,x=t,I=x.data.get(o.dataId).values,z=o.shape.length,V=x.data.get(u.dataId).values,rt=u.shape.length,{batchSize:Et,inHeight:St,inWidth:Tt,inChannels:Vt,outHeight:ue,outWidth:ye,padInfo:qe,strideHeight:$e,strideWidth:Xe,filterHeight:Pn,filterWidth:In,dilationHeight:gr,dilationWidth:Br,outShape:Kr}=Kc(o.shape,u.shape,h,p,"NHWC",g),Na=Rt(Kr),Ya=Kr.length,Ha=Fn(o.dtype,Na);for(let Wa=0;Wa<Et;++Wa)for(let za=0;za<ue;++za){const mi=za*$e-qe.top;for(let qa=0;qa<ye;++qa){const yi=qa*Xe-qe.left;for(let Fi=0;Fi<Vt;++Fi){let Bi=Number.MIN_SAFE_INTEGER;for(let no=0;no<Pn;++no){const io=mi+no*gr;if(io>=0&&io<St)for(let yo=0;yo<In;++yo){const lo=yi+yo*Br;if(lo>=0&&lo<Tt){const Zo=Y([Wa,io,lo,Fi],z,vt(o.shape)),hs=Y([no,yo,Fi],rt,vt(u.shape)),xs=I[Zo]+V[hs];xs>Bi&&(Bi=xs)}}}const Ji=Y([Wa,za,qa,Fi],Ya,vt(Kr));Ha[Ji]=Bi}}}return{dataId:x.write(Nu(Ha,o.dtype),Kr,o.dtype),shape:Kr,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IF={kernelName:Ku,backendName:"cpu",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:o,filter:u,dy:h}=r,{strides:p,pad:g,dilations:x}=n,I=t,z=an(o.shape,I.data.get(o.dataId).values),V=an(u.shape,I.data.get(u.dataId).values),{batchSize:rt,inHeight:Et,inWidth:St,inChannels:Tt,outHeight:Vt,outWidth:ue,padInfo:ye,strideHeight:qe,strideWidth:$e,filterHeight:Xe,filterWidth:Pn,dilationHeight:In,dilationWidth:gr,outShape:Br}=Kc(o.shape,u.shape,p,g,"NHWC",x);yt(h.rank===Br.length,()=>`Error in ${Ku}, dy must have the same rank as output ${Br.length}, but got ${h.rank}`);const Kr=an(Br,I.data.get(h.dataId).values),Na=at(u.shape,u.dtype);for(let Ha=0;Ha<rt;++Ha)for(let ni=0;ni<Vt;++ni){const Wa=ni*qe-ye.top;for(let za=0;za<ue;++za){const mi=za*$e-ye.left;for(let qa=0;qa<Tt;++qa){let yi=Number.MIN_SAFE_INTEGER,Fi=0,Bi=0;for(let Ji=0;Ji<Xe;++Ji){const no=Wa+Ji*In;if(no>=0&&no<Et)for(let io=0;io<Pn;++io){const yo=mi+io*gr;if(yo>=0&&yo<St){const lo=z[Ha][no][yo][qa]+V[Ji][io][qa];lo>yi&&(yi=lo,Fi=Ji,Bi=io)}}}Na[Fi][Bi][qa]+=Kr[Ha][ni][za][qa]}}}return{dataId:I.write(Nu(Na,o.dtype),u.shape,u.dtype),shape:u.shape,dtype:u.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TF={kernelName:ka,backendName:"cpu",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:o,filter:u,dy:h}=r,{strides:p,pad:g,dilations:x}=n,I=t,z=an(o.shape,I.data.get(o.dataId).values),V=an(u.shape,I.data.get(u.dataId).values),{batchSize:rt,inHeight:Et,inWidth:St,inChannels:Tt,outHeight:Vt,outWidth:ue,padInfo:ye,strideHeight:qe,strideWidth:$e,filterHeight:Xe,filterWidth:Pn,dilationHeight:In,dilationWidth:gr,outShape:Br}=Kc(o.shape,u.shape,p,g,"NHWC",x);yt(h.rank===Br.length,()=>`Error in ${ka}, dy must have the same rank as output ${Br.length}, but got ${h.rank}`);const Kr=an(Br,I.data.get(h.dataId).values),Na=at(o.shape,o.dtype);for(let Ha=0;Ha<rt;++Ha)for(let ni=0;ni<Vt;++ni){const Wa=ni*qe-ye.top;for(let za=0;za<ue;++za){const mi=za*$e-ye.left;for(let qa=0;qa<Tt;++qa){let yi=Number.MIN_SAFE_INTEGER,Fi=Wa<0?0:Wa,Bi=mi<0?0:mi;for(let Ji=0;Ji<Xe;++Ji){const no=Wa+Ji*In;if(no>=0&&no<Et)for(let io=0;io<Pn;++io){const yo=mi+io*gr;if(yo>=0&&yo<St){const lo=z[Ha][no][yo][qa]+V[Ji][io][qa];lo>yi&&(yi=lo,Fi=no,Bi=yo)}}}Na[Ha][Fi][Bi][qa]+=Kr[Ha][ni][za][qa]}}}return{dataId:I.write(Nu(Na,o.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AF(r){const{inputs:t,backend:n}=r,{dy:o,y:u}=t;Go([o,u],"eluGrad");const h=new Float32Array(Rt(u.shape)),p=n.data.get(u.dataId).values,g=n.data.get(o.dataId).values;for(let x=0;x<p.length;++x){const I=p[x];I>=1?h[x]=g[x]:h[x]=g[x]*(I+1)}return n.makeTensorInfo(u.shape,"float32",h)}const MF={kernelName:Ns,backendName:"cpu",kernelFunc:AF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NF=Cf((r,t)=>r===t?1:0),GN=th(eu,NF,null,"bool"),kF={kernelName:eu,backendName:"cpu",kernelFunc:GN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DF=xb,OF=ky,RF=wb,LF=rp,PF=Eb,FF=S0,BF=Ul(tu,r=>{const t=Math.sign(r),n=Math.abs(r),o=1/(1+DF*n);return t*(1-((((FF*o+PF)*o+LF)*o+RF)*o+OF)*o*Math.exp(-n*n))}),zF={kernelName:tu,backendName:"cpu",kernelFunc:BF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UN=v1(r=>Math.exp(r)),WN=p1(Zu,UN),$F={kernelName:Zu,backendName:"cpu",kernelFunc:WN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JE(r){const{inputs:t,backend:n,attrs:o}=r,{input:u}=t,{dim:h}=o,p=u.shape.length,g=u.shape.slice();let x=h;return h<0&&(yt(-(p+1)<=h,()=>`Axis must be in the interval [${-(p+1)}, ${p}]`),x=p+h+1),g.splice(x,0,1),Nc({inputs:{x:u},backend:n,attrs:{shape:g}})}const GF={kernelName:bn,backendName:"cpu",kernelFunc:JE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VN=v1(r=>Math.expm1(r)),UF=p1(Xr,VN),WF={kernelName:Xr,backendName:"cpu",kernelFunc:UF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qT=Cf((r,t)=>r*t),VF=XT((r,t,n,o)=>({real:r*n-t*o,imag:r*o+t*n})),QT=th(ge,qT,VF),jF={kernelName:ge,backendName:"cpu",kernelFunc:QT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HF=Cf((r,t)=>r/t),JT=th(Vs,HF),tA={kernelName:Vs,backendName:"cpu",kernelFunc:JT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jN=Cf((r,t)=>r-t),XF=XT((r,t,n,o)=>({real:r-n,imag:t-o})),eA=th(Ar,jN,XF),YF={kernelName:Ar,backendName:"cpu",kernelFunc:eA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HN(r,t,n){const o=r.shape,u=o[0],h=o[1],p=n.data.get(r.dataId),g=p.complexTensorInfos.real,x=p.complexTensorInfos.imag,I=[u,h],z=Rt(I),V=ar("float32",z),rt=ar("float32",z);for(let Vt=0;Vt<u;Vt++){const ue=U0({inputs:{x:g},backend:n,attrs:{begin:[Vt,0],size:[1,h]}}),ye=U0({inputs:{x},backend:n,attrs:{begin:[Vt,0],size:[1,h]}}),qe=hp({inputs:{real:ue,imag:ye},backend:n}),{real:$e,imag:Xe}=KF(qe,t,n),Pn=cv($e,Xe);for(let In=0;In<h;In++){const gr=Sb(Pn,In);V[Vt*h+In]=gr.real,rt[Vt*h+In]=gr.imag}n.disposeIntermediateTensorInfo(ue),n.disposeIntermediateTensorInfo(ye),n.disposeIntermediateTensorInfo(qe)}const Et=n.makeTensorInfo(I,"float32",V),St=n.makeTensorInfo(I,"float32",rt),Tt=hp({inputs:{real:Et,imag:St},backend:n});return n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(St),Tt}function KF(r,t,n){const o=Rt(r.shape),u=n.data.get(r.dataId),h=n.data.get(u.complexTensorInfos.real.dataId).values,p=n.data.get(u.complexTensorInfos.imag.dataId).values;if(ZF(o)){const g=nA(h,p,o,t,n),x=[r.shape[0],r.shape[1]];if(t){const I=n.makeTensorInfo(x,"float32",g.real),z=n.makeTensorInfo(x,"float32",g.imag),V=n.makeTensorInfo([],"float32",rf(o,"float32")),rt=Eg({inputs:{x:V},backend:n}),Et=tA.kernelFunc({inputs:{a:I,b:V},backend:n}),St=tA.kernelFunc({inputs:{a:z,b:rt},backend:n}),Tt=n.data.get(Et.dataId).values,Vt=n.data.get(St.dataId).values;return n.disposeIntermediateTensorInfo(I),n.disposeIntermediateTensorInfo(z),n.disposeIntermediateTensorInfo(V),n.disposeIntermediateTensorInfo(rt),n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(St),{real:Tt,imag:Vt}}return g}else{const g=cv(h,p),x=qF(g,o,t);return Xv(x)}}function ZF(r){return(r&r-1)==0}function nA(r,t,n,o,u){if(n===1)return{real:r,imag:t};const h=cv(r,t),p=n/2,g=Yv(h),x=g.real,I=g.imag,z=[x.length],V=u.makeTensorInfo(z,"float32",x),rt=u.makeTensorInfo(z,"float32",I),Et=hp({inputs:{real:V,imag:rt},backend:u}),St=Lw(h),Tt=St.real,Vt=St.imag,ue=[Tt.length],ye=u.makeTensorInfo(ue,"float32",Tt),qe=u.makeTensorInfo(ue,"float32",Vt),$e=hp({inputs:{real:ye,imag:qe},backend:u}),Xe=nA(x,I,p,o,u),Pn=Xe.real,In=Xe.imag,gr=[Pn.length],Br=u.makeTensorInfo(gr,"float32",Pn),Kr=u.makeTensorInfo(gr,"float32",In),Na=hp({inputs:{real:Br,imag:Kr},backend:u}),Ya=nA(Tt,Vt,p,o,u),Ha=Ya.real,ni=Ya.imag,Wa=[Ha.length],za=u.makeTensorInfo(Wa,"float32",Ha),mi=u.makeTensorInfo(Wa,"float32",ni),qa=hp({inputs:{real:za,imag:mi},backend:u}),yi=Cb(n,o),Fi=[yi.real.length],Bi=u.makeTensorInfo(Fi,"float32",yi.real),Ji=u.makeTensorInfo(Fi,"float32",yi.imag),no=hp({inputs:{real:Bi,imag:Ji},backend:u}),io=QT({inputs:{a:no,b:qa},backend:u}),yo=wx({inputs:{a:Na,b:io},backend:u}),lo=eA({inputs:{a:Na,b:io},backend:u}),Zo=G0({inputs:{input:yo},backend:u}),hs=G0({inputs:{input:lo},backend:u}),xs=g1({inputs:{input:yo},backend:u}),iu=g1({inputs:{input:lo},backend:u}),Yu=m1({inputs:[Zo,hs],backend:u,attrs:{axis:0}}),Wl=m1({inputs:[xs,iu],backend:u,attrs:{axis:0}}),Gc=u.data.get(Yu.dataId).values,yc=u.data.get(Wl.dataId).values;return u.disposeIntermediateTensorInfo(V),u.disposeIntermediateTensorInfo(rt),u.disposeIntermediateTensorInfo(Et),u.disposeIntermediateTensorInfo(ye),u.disposeIntermediateTensorInfo(qe),u.disposeIntermediateTensorInfo($e),u.disposeIntermediateTensorInfo(Br),u.disposeIntermediateTensorInfo(Kr),u.disposeIntermediateTensorInfo(Na),u.disposeIntermediateTensorInfo(za),u.disposeIntermediateTensorInfo(mi),u.disposeIntermediateTensorInfo(qa),u.disposeIntermediateTensorInfo(Bi),u.disposeIntermediateTensorInfo(Ji),u.disposeIntermediateTensorInfo(no),u.disposeIntermediateTensorInfo(io),u.disposeIntermediateTensorInfo(yo),u.disposeIntermediateTensorInfo(lo),u.disposeIntermediateTensorInfo(Zo),u.disposeIntermediateTensorInfo(xs),u.disposeIntermediateTensorInfo(hs),u.disposeIntermediateTensorInfo(iu),u.disposeIntermediateTensorInfo(Yu),u.disposeIntermediateTensorInfo(Wl),{real:Gc,imag:yc}}function qF(r,t,n){const o=new Float32Array(t*2);for(let u=0;u<t;u++){let h=0,p=0;for(let g=0;g<t;g++){const x=_b(u*g,t,n),I=Sb(r,g);h+=I.real*x.real-I.imag*x.imag,p+=I.real*x.imag+I.imag*x.real}n&&(h/=t,p/=t),Am(o,h,p,u)}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QF(r){const{inputs:t,backend:n}=r,{input:o}=t,u=Rt(o.shape),h=o.shape[o.shape.length-1],p=u/h,g=Nc({inputs:{x:o},backend:n,attrs:{shape:[p,h]}}),x=HN(g,!1,n),I=Nc({inputs:{x},backend:n,attrs:{shape:o.shape}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),I}const JF={kernelName:pa,backendName:"cpu",kernelFunc:QF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rA(r){const{backend:t,attrs:n}=r,{shape:o,value:u,dtype:h}=n,p=h||ta(u),g=Fn(p,Rt(o));return eB(g,u,p),t.makeTensorInfo(o,p,g)}const tB={kernelName:Ra,backendName:"cpu",kernelFunc:rA};function eB(r,t,n){r.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nB={kernelName:Qi,backendName:"cpu",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{image:o}=r,u=n,h=ar(o.dtype,Rt(o.shape)),[p,g,x,I]=o.shape,z=u.data.get(o.dataId).values;for(let rt=0;rt<p;rt++){const Et=rt*x*g*I;for(let St=0;St<g;St++){const Tt=St*(x*I);for(let Vt=0;Vt<x;Vt++){const ue=Vt*I;for(let ye=0;ye<I;ye++){const $e=[p,St,Vt,ye][2],Xe=Math.round(x-$e),Pn=Et+Tt+ue+ye;let In=z[Pn];if(Xe>=0&&Xe<x){const gr=Xe*I,Br=Et+Tt+gr+ye;In=z[Br]}h[Pn]=In}}}}return{dataId:u.write(h,o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XN=v1(r=>Math.floor(r)),rB=p1(Co,XN),aB={kernelName:Co,backendName:"cpu",kernelFunc:rB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iB=Cf((r,t)=>Math.floor(r/t)),oB=th(to,iB,null,"int32"),sB={kernelName:to,backendName:"cpu",kernelFunc:oB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uB(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h,bias:p,preluActivationWeights:g}=t,{strides:x,pad:I,dataFormat:z,dilations:V,dimRoundingMode:rt,activation:Et,leakyreluAlpha:St}=o;let Tt=zN({inputs:{x:u,filter:h},backend:n,attrs:{strides:x,pad:I,dataFormat:z,dilations:V,dimRoundingMode:rt}});if(p){const Vt=Tt;Tt=wx({inputs:{a:Tt,b:p},backend:n}),n.disposeIntermediateTensorInfo(Vt)}if(Et){const Vt=Tt;Tt=HT(n,Tt,Et,g,St),n.disposeIntermediateTensorInfo(Vt)}return Tt}const lB={kernelName:al,backendName:"cpu",kernelFunc:uB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cB(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h,bias:p,preluActivationWeights:g}=t,{strides:x,pad:I,dataFormat:z,dilations:V,dimRoundingMode:rt,activation:Et,leakyreluAlpha:St}=o;let Tt=$N({inputs:{x:u,filter:h},backend:n,attrs:{strides:x,pad:I,dataFormat:z,dilations:V,dimRoundingMode:rt}});if(p){const Vt=Tt;Tt=wx({inputs:{a:Tt,b:p},backend:n}),n.disposeIntermediateTensorInfo(Vt)}if(Et){const Vt=Tt;Tt=HT(n,Tt,Et,g,St),n.disposeIntermediateTensorInfo(Vt)}return Tt}const fB={kernelName:Vu,backendName:"cpu",kernelFunc:cB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hB(r){const{inputs:t,backend:n}=r,{params:o,indices:u}=t,h=Rt(o.shape),p=u.shape,g=p[p.length-1],[x,I,z,V]=Jp(o,u);if(I===0)return n.makeTensorInfo(x,o.dtype,[]);const rt=vs([I,z],o.dtype),Et=n.data.get(u.dataId).values,St=n.data.get(o.dataId).values;for(let Tt=0;Tt<I;Tt++){const Vt=[];let ue=0;for(let ye=0;ye<g;ye++){const qe=Et[Tt*g+ye];ue+=qe*V[ye],Vt.push(qe)}if(ue<0||ue>=h/z)throw new Error(`Invalid indices: ${Vt} does not index into ${o.shape}`);for(let ye=0;ye<z;ye++)rt.values[Tt*z+ye]=St[ue*z+ye]}return n.makeTensorInfo(x,rt.dtype,rt.values)}const dB={kernelName:vo,backendName:"cpu",kernelFunc:hB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YN(r,t,n){const o=vs(n,r.dtype);for(let u=0;u<o.size;++u){const p=o.indexToLoc(u).slice(),g=p[0],x=p[2],I=t.locToIndex([g,x]);p[2]=t.values[I];const z=r.locToIndex(p);o.values[u]=r.values[z]}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,indices:h}=t,{axis:p,batchDims:g}=o;Go([u,h],"gatherV2");let x=g;g==null&&(x=0);const I=Rt(h.shape),z=Rr(p,u.shape)[0],V=Oy(u,h,z,x),rt=Nc({inputs:{x:u},backend:n,attrs:{shape:[V.batchSize,V.outerSize,V.dimSize,V.sliceSize]}}),Et=Nc({inputs:{x:h},backend:n,attrs:{shape:[V.batchSize,I/V.batchSize]}}),St=[V.batchSize,V.outerSize,I/V.batchSize,V.sliceSize],Tt=n.bufferSync(Et),Vt=n.bufferSync(rt),ue=YN(Vt,Tt,St);return n.disposeIntermediateTensorInfo(rt),n.disposeIntermediateTensorInfo(Et),n.makeTensorInfo(V.outputShape,ue.dtype,ue.values)}const vB={kernelName:gs,backendName:"cpu",kernelFunc:pB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KN=Cf((r,t)=>r>t?1:0),gB=th(ou,KN,null,"bool"),mB={kernelName:ou,backendName:"cpu",kernelFunc:gB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yB=Cf((r,t)=>r>=t?1:0),bB=th(ms,yB,null,"bool"),xB={kernelName:ms,backendName:"cpu",kernelFunc:bB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wB(r){const{inputs:t,backend:n}=r,{input:o}=t,u=Rt(o.shape),h=o.shape[o.shape.length-1],p=u/h,g=Nc({inputs:{x:o},backend:n,attrs:{shape:[p,h]}}),x=HN(g,!0,n),I=Nc({inputs:{x},backend:n,attrs:{shape:o.shape}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),I}const EB={kernelName:dl,backendName:"cpu",kernelFunc:wB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SB=Ul(Ks,r=>Number.isFinite(r)?1:0,"bool"),CB={kernelName:Ks,backendName:"cpu",kernelFunc:SB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _B=Ul(el,r=>Math.abs(r)===Infinity?1:0,"bool"),IB={kernelName:el,backendName:"cpu",kernelFunc:_B};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TB=Ul(lu,r=>Number.isNaN(r)?1:0,"bool"),AB={kernelName:lu,backendName:"cpu",kernelFunc:TB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZN=Cf((r,t)=>r<t?1:0),MB=th(pl,ZN,null,"bool"),NB={kernelName:pl,backendName:"cpu",kernelFunc:MB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kB=Cf((r,t)=>r<=t?1:0),DB=th(ns,kB,null,"bool"),OB={kernelName:ns,backendName:"cpu",kernelFunc:DB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qN(r,t,n){const o=(t-r)/(n-1),u=kt(n,"float32");u[0]=r;for(let h=1;h<u.length;h++)u[h]=u[h-1]+o;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RB(r){const{backend:t,attrs:n}=r,{start:o,stop:u,num:h}=n,p=qN(o,u,h);return t.makeTensorInfo([p.length],"float32",p)}const LB={kernelName:_s,backendName:"cpu",kernelFunc:RB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QN=v1(r=>Math.log(r)),PB=p1(Bu,QN),FB={kernelName:Bu,backendName:"cpu",kernelFunc:PB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BB=Ul(Au,r=>Math.log1p(r)),zB={kernelName:Au,backendName:"cpu",kernelFunc:BB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $B=Cf((r,t)=>r&&t),GB=th(wu,$B,null,"bool"),UB={kernelName:wu,backendName:"cpu",kernelFunc:GB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WB=Ul(nu,r=>r?0:1,"bool"),VB={kernelName:nu,backendName:"cpu",kernelFunc:WB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jB=Cf((r,t)=>r||t),HB=th(Tl,jB,null,"bool"),XB={kernelName:Tl,backendName:"cpu",kernelFunc:HB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YB(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{depthRadius:h,bias:p,alpha:g,beta:x}=o;Go(u,"LRN");const I=u.shape[3],z=I-1,V=n.data.get(u.dataId).values,rt=Rt(u.shape),Et=new Float32Array(rt);function St(Tt){const Vt=Tt%I;let ue=Tt-Vt+Math.max(0,Vt-h);const ye=Tt-Vt+Math.min(Vt+h,z);let qe=0;for(;ue<=ye;ue++){const $e=V[ue];qe+=$e*$e}return qe}for(let Tt=0;Tt<rt;Tt++){const Vt=St(Tt),ue=V[Tt]*Math.pow(p+g*Vt,-x);Et[Tt]=ue}return n.makeTensorInfo(u.shape,u.dtype,Et)}const KB={kernelName:Sl,backendName:"cpu",kernelFunc:YB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,y:h,dy:p}=t,{depthRadius:g,bias:x,alpha:I,beta:z}=o;Go(p,"LRNGrad");const V=Rt(p.shape),rt=p.shape[3],Et=n.data.get(p.dataId).values,St=n.data.get(u.dataId).values,Tt=n.data.get(h.dataId).values,Vt=new Float32Array(V),ue=V;for(let ye=0;ye<ue;ye++){const qe=ye%rt,$e=ye-qe+Math.max(0,qe-g),Xe=ye-qe+Math.min(rt,qe+g+1);let Pn=0;for(let In=$e;In<Xe;In++)Pn+=Math.pow(St[In],2);Pn=I*Pn+x;for(let In=$e;In<Xe;In++){let gr=-2*I*z*St[In]*Tt[ye]/Pn;ye===In&&(gr+=Math.pow(Pn,-z)),gr*=Et[ye],Vt[In]+=gr}}return n.makeTensorInfo(p.shape,u.dtype,Vt)}const qB={kernelName:ol,backendName:"cpu",kernelFunc:ZB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JN(r,t,n,o){const u=ar(o,Rt(n));for(let h=0;h<u.length;++h){const p=h*t;let g=r[p];for(let x=0;x<t;++x){const I=r[p+x];I>g&&(g=I)}u[h]=g}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tk(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{reductionIndices:h,keepDims:p}=o,g=n;let x=u.shape;const I=x.length,z=Rr(h,x);let V=z;const rt=$c(V,I);let Et=g.data.get(u.dataId).values;if(rt!=null){const $e=new Array(I);for(let Xe=0;Xe<$e.length;Xe++)$e[Xe]=x[rt[Xe]];Et=YT(Et,x,u.dtype,rt,$e),V=gc(V.length,I),x=$e}Go(u,"max"),Pf("max",V,I);const[St,Tt]=yf(x,V),Vt=Rt(Tt),ue=JN(Et,Vt,St,u.dtype),ye=g.write(ue,St,u.dtype);let qe=St;return p&&(qe=zc(St,z)),{dataId:ye,shape:qe,dtype:u.dtype}}const QB={kernelName:ys,backendName:"cpu",kernelFunc:tk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ek=Cf((r,t)=>Math.max(r,t)),JB=th(vl,ek),t4={kernelName:vl,backendName:"cpu",kernelFunc:JB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t;Go(u,"maxPool");const{filterSize:h,strides:p,pad:g,dimRoundingMode:x}=o,I=1;yt(_c(p,I),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${p} and dilations '${I}'`);const z=Rf(u.shape,h,p,I,g,x);let V;if(z.filterWidth===1&&z.filterHeight===1&&Un(z.inShape,z.outShape))V=Eg({inputs:{x:u},backend:n});else{const rt=n.data.get(u.dataId).values,Et=vt(u.shape),St=KT(rt,u.shape,u.dtype,Et,z,"max");V=n.makeTensorInfo(z.outShape,u.dtype,St.values)}return V}const n4={kernelName:kc,backendName:"cpu",kernelFunc:e4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{filterSize:h,strides:p,pad:g,dimRoundingMode:x,dataFormat:I,dilations:z}=o;Go(u,"maxPool3d");let V=z;V==null&&(V=[1,1,1]);const rt=bd(u.shape,h,p,V,g,x,I),Et=n.data.get(u.dataId).values,St=RN(Et,u.shape,u.dtype,vt(u.shape),rt,"max");return n.makeTensorInfo(St.shape,"float32",St.values)}const a4={kernelName:Ol,backendName:"cpu",kernelFunc:r4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i4(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,{filterSize:p,strides:g,pad:x,dilations:I,dimRoundingMode:z}=o;Go([u,h],"maxPool3DGrad");const V=bd(h.shape,p,g,I,x,z),rt=n.bufferSync(h),Et=I3(rt,V),St=V.strideDepth,Tt=V.strideHeight,Vt=V.strideWidth,ue=V.dilationDepth,ye=V.dilationHeight,qe=V.dilationWidth,$e=V.effectiveFilterDepth,Xe=V.effectiveFilterHeight,Pn=V.effectiveFilterWidth,In=$e-1-V.padInfo.front,gr=Pn-1-V.padInfo.left,Br=Xe-1-V.padInfo.top,Kr=vs(h.shape,"float32"),Na=n.bufferSync(u);for(let Ya=0;Ya<V.batchSize;++Ya)for(let Ha=0;Ha<V.inChannels;++Ha)for(let ni=0;ni<V.inDepth;++ni)for(let Wa=0;Wa<V.inHeight;++Wa)for(let za=0;za<V.inWidth;++za){const mi=ni-In,qa=Wa-Br,yi=za-gr;let Fi=0;for(let Bi=0;Bi<$e;Bi+=ue){const Ji=(mi+Bi)/St;if(!(Ji<0||Ji>=V.outDepth||Math.floor(Ji)!==Ji))for(let no=0;no<Xe;no+=ye){const io=(qa+no)/Tt;if(!(io<0||io>=V.outHeight||Math.floor(io)!==io))for(let yo=0;yo<Pn;yo+=qe){const lo=(yi+yo)/Vt;if(lo<0||lo>=V.outWidth||Math.floor(lo)!==lo)continue;const Zo=$e*Xe*Pn-1-Et.get(Ya,Ji,io,lo,Ha),hs=Bi*Xe*Pn+no*Pn+yo,xs=Zo===hs?1:0;if(xs===0)continue;Fi+=Na.get(Ya,Ji,io,lo,Ha)*xs}}}Kr.set(Fi,Ya,ni,Wa,za,Ha)}return n.makeTensorInfo(Kr.shape,Kr.dtype,Kr.values)}const o4={kernelName:_e,backendName:"cpu",kernelFunc:i4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s4(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h,output:p}=t,g=h;Go([h,p],"maxPoolGrad");const{filterSize:x,strides:I,pad:z,dimRoundingMode:V}=o,rt=Rf(g.shape,x,I,1,z,V),Et=n.data.get(g.dataId).values,St=vs(rt.outShape,g.dtype,ON(Et,g.shape,g.dtype,rt).values),Tt=rt.strideHeight,Vt=rt.strideWidth,ue=rt.dilationHeight,ye=rt.dilationWidth,qe=rt.effectiveFilterHeight,$e=rt.effectiveFilterWidth,Xe=$e-1-rt.padInfo.left,Pn=qe-1-rt.padInfo.top,In=vs(g.shape,"float32"),gr=n.data.get(u.dataId).values,Br=vs(u.shape,"float32",gr);for(let Kr=0;Kr<rt.batchSize;++Kr)for(let Na=0;Na<rt.inChannels;++Na)for(let Ya=0;Ya<rt.inHeight;++Ya)for(let Ha=0;Ha<rt.inWidth;++Ha){const ni=Ya-Pn,Wa=Ha-Xe;let za=0;for(let mi=0;mi<qe;mi+=ue){const qa=(ni+mi)/Tt;if(!(qa<0||qa>=rt.outHeight||Math.floor(qa)!==qa))for(let yi=0;yi<$e;yi+=ye){const Fi=(Wa+yi)/Vt;if(Fi<0||Fi>=rt.outWidth||Math.floor(Fi)!==Fi)continue;const Bi=qe*$e-1-St.get(Kr,qa,Fi,Na),Ji=mi*$e+yi,no=Bi===Ji?1:0;if(no===0)continue;za+=Br.get(Kr,qa,Fi,Na)*no}}In.set(za,Kr,Ya,Ha,Na)}return n.makeTensorInfo(In.shape,In.dtype,In.values)}const u4={kernelName:Dl,backendName:"cpu",kernelFunc:s4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4(r,t,n,o,u){const h=vt(t),p=KT(r,t,n,h,u,"max"),g=ON(r,t,n,u,!0,o);return[p.values,g.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c4={kernelName:ve,backendName:"cpu",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{x:o}=r,{filterSize:u,strides:h,pad:p,includeBatchInIndex:g}=t,x=n;Go(o,"MaxPoolWithArgmax");const I=x.data.get(o.dataId).values,z=Rf(o.shape,u,h,[1,1],p),[V,rt]=l4(I,o.shape,o.dtype,g,z),Et=x.write(V,z.outShape,o.dtype),St=x.write(rt,z.outShape,o.dtype);return[{dataId:Et,shape:z.outShape,dtype:o.dtype},{dataId:St,shape:z.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tS(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;Go(u,"sum");let g;u.dtype==="bool"?g=Fm({inputs:{x:u},backend:n,attrs:{dtype:"int32"}}):g=Eg({inputs:{x:u},backend:n});const x=g.shape.length,I=Rr(h,g.shape),z=$c(I,x);let V=I,rt=g;z!=null&&(rt=xv({inputs:{x:g},backend:n,attrs:{perm:z}}),V=gc(V.length,x)),Pf("sum",V,rt.shape.length);const[Et,St]=yf(rt.shape,V),Tt=so(rt.dtype,"int32");let Vt=QE(n,Et,Tt);const ue=Rt(St),ye=n.data.get(Vt.dataId).values,qe=n.data.get(rt.dataId).values;for(let $e=0;$e<ye.length;++$e){const Xe=$e*ue;let Pn=0;for(let In=0;In<ue;++In)Pn+=qe[Xe+In];ye[$e]=Pn}if(p){const $e=zc(Vt.shape,I),Xe=Vt;Vt=Nc({inputs:{x:Vt},backend:n,attrs:{shape:$e}}),n.disposeIntermediateTensorInfo(Xe)}return n.disposeIntermediateTensorInfo(g),z!=null&&n.disposeIntermediateTensorInfo(rt),Vt}const f4={kernelName:rn,backendName:"cpu",kernelFunc:tS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o,g=Rr(h,u.shape),I=yf(u.shape,g)[1],z=Rt(I),V=[],rt=n.makeTensorInfo([],"float32",new Float32Array([z]));V.push(rt);const Et=Fm({inputs:{x:u},backend:n,attrs:{dtype:"float32"}});V.push(Et);const St=JT({inputs:{a:Et,b:rt},backend:n});V.push(St);const Tt=tS({inputs:{x:St},backend:n,attrs:{axis:h,keepDims:p}});return V.forEach(Vt=>n.disposeIntermediateTensorInfo(Vt)),Tt}const d4={kernelName:Bt,backendName:"cpu",kernelFunc:h4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;Go(u,"min");const g=Rr(h,u.shape);let x=g;const I=$c(x,u.shape.length);let z=u;I!=null&&(z=xv({inputs:{x:u},backend:n,attrs:{perm:I}}),x=gc(x.length,u.shape.length)),Pf("min",x,z.shape.length);const[V,rt]=yf(z.shape,x),Et=Rt(rt),St=kt(Rt(V),z.dtype),Tt=n.data.get(z.dataId).values;for(let ue=0;ue<St.length;++ue){const ye=ue*Et;let qe=Tt[ye];for(let $e=0;$e<Et;++$e){const Xe=Tt[ye+$e];Xe<qe&&(qe=Xe)}St[ue]=qe}I!=null&&n.disposeIntermediateTensorInfo(z);const Vt=n.makeTensorInfo(V,z.dtype,St);if(p){const ue=zc(V,g),ye=Nc({inputs:{x:Vt},backend:n,attrs:{shape:ue}});return n.disposeIntermediateTensorInfo(Vt),ye}return Vt}const v4={kernelName:ae,backendName:"cpu",kernelFunc:p4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nk=Cf((r,t)=>Math.min(r,t)),g4=th(me,nk),m4={kernelName:me,backendName:"cpu",kernelFunc:g4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{paddings:h,mode:p}=o;Go(u,"mirrorPad");const g=h.map((qe,$e)=>qe[0]+u.shape[$e]+qe[1]),x=h.map(qe=>qe[0]),I=h.map((qe,$e)=>qe[0]+u.shape[$e]),z=p==="reflect"?0:1,V=n.data.get(u.dataId).values,rt=u.shape.length,Et=vt(u.shape),St=Rt(g),Tt=g.length,Vt=vt(g),ue=ar(u.dtype,St);for(let qe=0;qe<St;qe++){let $e=bt(qe,Tt,Vt);for(let Pn=0;Pn<Tt;Pn++)$e[Pn]<x[Pn]?$e[Pn]=x[Pn]*2-$e[Pn]-z:$e[Pn]>=I[Pn]&&($e[Pn]=(I[Pn]-1)*2-$e[Pn]+z);$e=$e.map((Pn,In)=>Pn-x[In]);const Xe=Y($e,rt,Et);ue[qe]=V[Xe]}return{dataId:n.write(ue,g,u.dtype),shape:g,dtype:u.dtype}}const b4={kernelName:En,backendName:"cpu",kernelFunc:y4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x4=Cf((r,t)=>{const n=r%t;return r<0&&t<0||r>=0&&t>=0?n:(n+t)%t}),w4=th(Zn,x4),E4={kernelName:Zn,backendName:"cpu",kernelFunc:w4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rk(r){const{inputs:t,backend:n,attrs:o}=r,{logits:u}=t,{dim:h}=o,p=u.shape.length;let g=h;if(g===-1&&(g=p-1),g!==p-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${p} and dim was ${g}`);const x=Rr([g],u.shape),I=tk({inputs:{x:u},backend:n,attrs:{reductionIndices:x,keepDims:!1}}),z=zc(I.shape,x),V=Nc({inputs:{x:I},backend:n,attrs:{shape:z}}),rt=eA({inputs:{a:u,b:V},backend:n}),Et=WN({inputs:{x:rt},backend:n}),St=tS({inputs:{x:Et},backend:n,attrs:{axis:x,keepDims:!1}}),Tt=Nc({inputs:{x:St},backend:n,attrs:{shape:z}}),Vt=JT({inputs:{a:Et,b:Tt},backend:n});return n.disposeIntermediateTensorInfo(I),n.disposeIntermediateTensorInfo(V),n.disposeIntermediateTensorInfo(rt),n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(St),n.disposeIntermediateTensorInfo(Tt),Vt}const S4={kernelName:De,backendName:"cpu",kernelFunc:rk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4(r){const{inputs:t,backend:n,attrs:o}=r,{logits:u}=t,{numSamples:h,seed:p,normalized:g}=o;Go(u,"multinomial");const x=g?u:rk({inputs:{logits:u},backend:n,attrs:{dim:-1}}),I=x.shape[0],z=x.shape[1],V=n.data.get(x.dataId).values,rt=[I,h],Et=kt(Rt(rt),"int32");for(let St=0;St<I;++St){const Tt=St*z,Vt=new Float32Array(z-1);Vt[0]=V[Tt];for(let qe=1;qe<Vt.length;++qe)Vt[qe]=Vt[qe-1]+V[Tt+qe];const ue=xm.alea(p.toString()),ye=St*h;for(let qe=0;qe<h;++qe){const $e=ue();Et[ye+qe]=Vt.length;for(let Xe=0;Xe<Vt.length;Xe++)if($e<Vt[Xe]){Et[ye+qe]=Xe;break}}}return g||n.disposeIntermediateTensorInfo(x),n.makeTensorInfo(rt,"int32",Et)}const _4={kernelName:Kt,backendName:"cpu",kernelFunc:C4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ak(r,t,n){const o=rf(-1,n);return qT([],t,o,r,n)}function I4(r){const{inputs:t,backend:n}=r,{x:o}=t;Go(o,"neg");const u=n.data.get(o.dataId).values,[h,p]=ak(u,o.shape,o.dtype);return n.makeTensorInfo(p,o.dtype,h)}const T4={kernelName:Ae,backendName:"cpu",kernelFunc:I4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A4=Cy;function M4(r){const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:x}=o;Go(u,"NonMaxSuppression");const I=n.data.get(u.dataId).values,z=n.data.get(h.dataId).values,{selectedIndices:V}=A4(I,z,p,g,x);return n.makeTensorInfo([V.length],"int32",new Int32Array(V))}const N4={kernelName:xn,backendName:"cpu",kernelFunc:M4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k4=Pg;function D4(r){const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:x,padToMaxOutputSize:I}=o;Go(u,"NonMaxSuppressionPadded");const z=n.data.get(u.dataId).values,V=n.data.get(h.dataId).values,{selectedIndices:rt,validOutputs:Et}=k4(z,V,p,g,x,I);return[n.makeTensorInfo([rt.length],"int32",new Int32Array(rt)),n.makeTensorInfo([],"int32",new Int32Array([Et]))]}const O4={kernelName:ir,backendName:"cpu",kernelFunc:D4};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R4=_y;function L4(r){const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:x,softNmsSigma:I}=o;Go(u,"NonMaxSuppressionWithScore");const z=n.data.get(u.dataId).values,V=n.data.get(h.dataId).values,rt=p,Et=g,St=x,Tt=I,{selectedIndices:Vt,selectedScores:ue}=R4(z,V,rt,Et,St,Tt);return[n.makeTensorInfo([Vt.length],"int32",new Int32Array(Vt)),n.makeTensorInfo([ue.length],"float32",new Float32Array(ue))]}const P4={kernelName:$r,backendName:"cpu",kernelFunc:L4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ik=Cf((r,t)=>r!==t?1:0),F4=th(sn,ik,null,"bool"),B4={kernelName:sn,backendName:"cpu",kernelFunc:F4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z4(r){const{inputs:t,backend:n,attrs:o}=r,{indices:u}=t,{depth:h,onValue:p,offValue:g}=o;Go(u,"oneHot");const x=Rt(u.shape),I=new Float32Array(x*h);I.fill(g);const z=n.data.get(u.dataId).values;for(let V=0;V<x;++V)z[V]>=0&&z[V]<h&&(I[V*h+z[V]]=p);return n.makeTensorInfo([...u.shape,h],"int32",I)}const $4={kernelName:Va,backendName:"cpu",kernelFunc:z4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eS(r){const{inputs:t,backend:n}=r,{x:o}=t;if(o.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(o.dtype==="complex64"){const u=G0({inputs:{input:o},backend:n}),h=eS({inputs:{x:u},backend:n}),p=g1({inputs:{input:o},backend:n}),g=eS({inputs:{x:p},backend:n}),x=hp({inputs:{real:h,imag:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),x}else return rA({backend:n,attrs:{shape:o.shape,value:0,dtype:o.dtype}})}const G4={kernelName:qu,backendName:"cpu",kernelFunc:eS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ok(r){const{inputs:t,backend:n}=r,{x:o}=t;if(o.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(o.dtype==="complex64"){const u=G0({inputs:{input:o},backend:n}),h=ok({inputs:{x:u},backend:n}),p=g1({inputs:{input:o},backend:n}),g=eS({inputs:{x:p},backend:n}),x=hp({inputs:{real:h,imag:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),x}else return rA({backend:n,attrs:{shape:o.shape,value:1,dtype:o.dtype}})}const U4={kernelName:Aa,backendName:"cpu",kernelFunc:ok};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sk(r){const{inputs:t,backend:n,attrs:o}=r,{axis:u}=o;if(t.length===1)return JE({inputs:{input:t[0]},backend:n,attrs:{dim:u}});const h=t[0].shape,p=t[0].dtype;t.forEach(z=>{Ne(h,z.shape,"All tensors passed to stack must have matching shapes"),yt(p===z.dtype,()=>"All tensors passed to stack must have matching dtypes")});const g=[],x=t.map(z=>{const V=JE({inputs:{input:z},backend:n,attrs:{dim:u}});return g.push(V),V}),I=m1({inputs:x,backend:n,attrs:{axis:u}});return g.forEach(z=>n.disposeIntermediateTensorInfo(z)),I}const W4={kernelName:Ba,backendName:"cpu",kernelFunc:sk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{paddings:h,constantValue:p}=o;Go(u,"pad");const g=h.map((ye,qe)=>ye[0]+u.shape[qe]+ye[1]),x=h.map(ye=>ye[0]),I=n.data.get(u.dataId).values,z=Rt(u.shape),V=u.shape.length,rt=vt(u.shape),Et=Rt(g),St=g.length,Tt=vt(g),Vt=ar(u.dtype,Et);p!==0&&Vt.fill(p);for(let ye=0;ye<z;ye++){const $e=bt(ye,V,rt).map((Pn,In)=>Pn+x[In]),Xe=Y($e,St,Tt);Vt[Xe]=I[ye]}return{dataId:n.write(Vt,g,u.dtype),shape:g,dtype:u.dtype}}const uk={kernelName:oi,backendName:"cpu",kernelFunc:V4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j4=Cf((r,t)=>Math.pow(r,t)),H4=th(Di,j4),X4={kernelName:Di,backendName:"cpu",kernelFunc:H4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lk(r,t,n,o){const[u,h]=yf(r,o),p=so(t,"int32"),g=kt(Rt(u),p),x=Rt(h);for(let I=0;I<g.length;++I){const z=I*x;let V=1;for(let rt=0;rt<x;++rt)V*=n[z+rt];g[I]=V}return{outVals:g,outShape:u,outDtype:p}}function Y4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;Go(u,"prod");const g=u.shape.length,x=Rr(h,u.shape),I=$c(x,g);let z=x,V=u;const rt=[];I!=null&&(V=xv({inputs:{x:u},backend:n,attrs:{perm:I}}),rt.push(V),z=gc(z.length,g));const Et=n.data.get(V.dataId).values,{outVals:St,outShape:Tt,outDtype:Vt}=lk(V.shape,V.dtype,Et,z);let ue=Tt;return p&&(ue=zc(Tt,x)),rt.forEach(ye=>n.disposeIntermediateTensorInfo(ye)),n.makeTensorInfo(ue,Vt,St)}const K4={kernelName:_o,backendName:"cpu",kernelFunc:Y4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ck(r,t,n,o){const u=r===t,h=r<t&&n<0,p=t<r&&n>1;if(u||h||p)return kt(0,o);const g=Math.abs(Math.ceil((t-r)/n)),x=kt(g,o);t<r&&n===1&&(n=-1),x[0]=r;for(let I=1;I<x.length;I++)x[I]=x[I-1]+n;return x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z4(r){const{backend:t,attrs:n}=r,{start:o,stop:u,dtype:h,step:p}=n,g=ck(o,u,p,h);return t.makeTensorInfo([g.length],h,g)}const q4={kernelName:To,backendName:"cpu",kernelFunc:Z4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q4=Ul(Vo,r=>1/r),J4={kernelName:Vo,backendName:"cpu",kernelFunc:Q4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(r){const{inputs:t,backend:n,attrs:o}=r,{images:u}=t,{alignCorners:h,halfPixelCenters:p,size:g}=o;Go(u,"resizeBilinear");const x=vt(u.shape),[I,z]=g,[V,rt,Et,St]=u.shape,Tt=n.data.get(u.dataId).values,Vt=new Float32Array(Rt([V,I,z,St])),ue=[h&&I>1?rt-1:rt,h&&z>1?Et-1:Et],ye=[h&&I>1?I-1:I,h&&z>1?z-1:z];let qe=0;const $e=ue[0]/ye[0],Xe=ue[1]/ye[1];for(let Pn=0;Pn<V;Pn++)for(let In=0;In<I;In++){let gr;p?gr=$e*(In+.5)-.5:gr=$e*In;const Br=Math.max(0,Math.floor(gr)),Kr=gr-Br,Na=Math.min(rt-1,Math.ceil(gr)),Ya=Pn*x[0]+Br*x[1],Ha=Pn*x[0]+Na*x[1];for(let ni=0;ni<z;ni++){let Wa;p?Wa=Xe*(ni+.5)-.5:Wa=Xe*ni;const za=Math.max(0,Math.floor(Wa)),mi=Wa-za,qa=Math.min(Et-1,Math.ceil(Wa)),yi=Ya+za*x[2],Fi=Ha+za*x[2],Bi=Ya+qa*x[2],Ji=Ha+qa*x[2];for(let no=0;no<St;no++){const io=Tt[yi+no],yo=Tt[Fi+no],lo=Tt[Bi+no],Zo=Tt[Ji+no],hs=io+(lo-io)*mi,xs=yo+(Zo-yo)*mi,iu=hs+(xs-hs)*Kr;Vt[qe++]=iu}}}return n.makeTensorInfo([V,I,z,St],"float32",Vt)}const ez={kernelName:Mu,backendName:"cpu",kernelFunc:tz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nz(r){const{inputs:t,backend:n,attrs:o}=r,{images:u,dy:h}=t,{alignCorners:p}=o;Go([h,u],"resizeBilinearGrad");const g=vt(u.shape),[x,I,z,V]=u.shape,[,rt,Et]=h.shape,St=new Float32Array(x*I*z*V),Tt=[p&&rt>1?I-1:I,p&&Et>1?z-1:z],Vt=[p&&rt>1?rt-1:rt,p&&Et>1?Et-1:Et],ue=Tt[0]/Vt[0],ye=Tt[1]/Vt[1],qe=n.data.get(h.dataId).values;let $e=0;for(let Xe=0;Xe<x;Xe++){const Pn=Xe*g[0];for(let In=0;In<rt;In++){const gr=In*ue,Br=Math.floor(gr),Kr=Math.min(Math.ceil(gr),I-1),Na=Pn+Br*g[1],Ya=Pn+Kr*g[1],Ha=gr-Br,ni=1-Ha;for(let Wa=0;Wa<Et;Wa++){const za=Wa*ye,mi=Math.floor(za),qa=Math.min(Math.ceil(za),z-1),yi=za-mi,Fi=1-yi,Bi=Na+mi*g[2],Ji=Na+qa*g[2],no=Ya+mi*g[2],io=Ya+qa*g[2],yo=ni*Fi,lo=ni*yi,Zo=Ha*Fi,hs=Ha*yi;for(let xs=0;xs<V;xs++){const iu=qe[$e++];St[Bi+xs]+=iu*yo,St[Ji+xs]+=iu*lo,St[no+xs]+=iu*Zo,St[io+xs]+=iu*hs}}}}return n.makeTensorInfo([x,z,I,V],"float32",St)}const rz={kernelName:nl,backendName:"cpu",kernelFunc:nz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function az(r){const{inputs:t,backend:n,attrs:o}=r,{images:u}=t,{alignCorners:h,halfPixelCenters:p,size:g}=o;Go(u,"resizeNearestNeighbor");const x=vt(u.shape),[I,z]=g,[V,rt,Et,St]=u.shape,Tt=n.data.get(u.dataId).values,Vt=new Float32Array(V*I*z*St),ue=[h&&I>1?rt-1:rt,h&&z>1?Et-1:Et],ye=[h&&I>1?I-1:I,h&&z>1?z-1:z],qe=ue[0]/ye[0],$e=ue[1]/ye[1];let Xe=0;for(let Pn=0;Pn<V;Pn++){const In=Pn*x[0];for(let gr=0;gr<I;gr++){const Br=p?qe*(gr+.5):qe*gr;let Kr=Math.min(rt-1,h?Math.round(Br):Math.floor(Br));p&&(Kr=Math.max(0,Kr));const Na=In+Kr*x[1];for(let Ya=0;Ya<z;Ya++){const Ha=p?$e*(Ya+.5):$e*Ya;let ni=Math.min(Et-1,h?Math.round(Ha):Math.floor(Ha));p&&(ni=Math.max(0,ni));const Wa=Na+ni*x[2];for(let za=0;za<St;za++){const mi=Tt[Wa+za];Vt[Xe++]=mi}}}}return n.makeTensorInfo([V,I,z,St],u.dtype,Vt)}const iz={kernelName:ks,backendName:"cpu",kernelFunc:az};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oz(r){const{inputs:t,backend:n,attrs:o}=r,{images:u,dy:h}=t,{alignCorners:p}=o;Go([h,u],"resizeNearestNeighborGrad");const g=vt(u.shape),x=vt(h.shape),[I,z,V,rt]=u.shape,[,Et,St]=h.shape,Tt=new Float32Array(I*z*V*rt),Vt=n.data.get(h.dataId).values,ue=[p&&Et>1?z-1:z,p&&St>1?V-1:V],ye=[p&&Et>1?Et-1:Et,p&&St>1?St-1:St],qe=ue[0]/ye[0],$e=ue[1]/ye[1],Xe=1/qe,Pn=1/$e,In=Math.ceil(Xe)*2+2,gr=Math.ceil(Pn)*2+2;for(let Br=0;Br<I;Br++){const Kr=Br*g[0];for(let Na=0;Na<z;Na++){const Ya=Kr+Na*g[1],Ha=Math.floor(Na*Xe),ni=Math.floor(Ha-In/2);for(let Wa=0;Wa<V;Wa++){const za=Ya+Wa*g[2],mi=Math.floor(Wa*Pn),qa=Math.floor(mi-gr/2);for(let yi=0;yi<rt;yi++){let Fi=0;for(let Bi=0;Bi<In;Bi++){const Ji=Bi+ni;if(Ji<0||Ji>=Et)continue;const no=Kr+Ji*x[1],io=Ji*qe,yo=Math.min(z-1,p?Math.round(io):Math.floor(io));if(Na===yo)for(let lo=0;lo<gr;lo++){const Zo=lo+qa;if(Zo<0||Zo>=St)continue;const hs=no+Zo*x[2],xs=Zo*$e,iu=Math.min(V-1,p?Math.round(xs):Math.floor(xs));Wa===iu&&(Fi+=Vt[hs+yi])}}Tt[za+yi]=Fi}}}}return n.makeTensorInfo(u.shape,u.dtype,Tt)}const sz={kernelName:Hs,backendName:"cpu",kernelFunc:oz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uz(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{dims:h}=o;Go(u,"reverse");const p=u.shape.length,g=Rr(h,u.shape);if(p===0)return Eg({inputs:{x:u},backend:n});const x=new ne(u.shape,u.dtype),I=n.bufferSync(u);for(let z=0;z<x.size;z++){const V=x.indexToLoc(z),rt=V.slice();g.forEach(Et=>rt[Et]=u.shape[Et]-1-rt[Et]),x.set(I.get(...rt),...V)}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const lz={kernelName:Yl,backendName:"cpu",kernelFunc:uz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cz={kernelName:Qu,backendName:"cpu",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{image:o}=r,{radians:u,fillValue:h,center:p}=t,g=n,x=ar(o.dtype,Rt(o.shape)),[I,z,V,rt]=o.shape,[Et,St]=np(p,z,V),Tt=255,Vt=Math.sin(u),ue=Math.cos(u),ye=g.data.get(o.dataId).values;for(let $e=0;$e<I;$e++){const Xe=$e*V*z*rt;for(let Pn=0;Pn<z;Pn++){const In=Pn*(V*rt);for(let gr=0;gr<V;gr++){const Br=gr*rt;for(let Kr=0;Kr<rt;Kr++){const Na=[I,Pn,gr,Kr],Ya=Na[2],Ha=Na[1];let ni=(Ya-Et)*ue-(Ha-St)*Vt,Wa=(Ya-Et)*Vt+(Ha-St)*ue;ni=Math.round(ni+Et),Wa=Math.round(Wa+St);let za=h;if(typeof h!="number"&&(Kr===3?za=Tt:za=h[Kr]),ni>=0&&ni<V&&Wa>=0&&Wa<z){const qa=Wa*(V*rt),yi=ni*rt,Fi=Xe+qa+yi+Kr;za=ye[Fi]}const mi=Xe+In+Br+Kr;x[mi]=za}}}}return{dataId:g.write(x,o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fz=Ul(sl,r=>{const t=Math.floor(r);return r-t<.5?Math.floor(r):r-t>.5?Math.ceil(r):t%2==0?t:t+1}),hz={kernelName:sl,backendName:"cpu",kernelFunc:fz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fk=v1(r=>1/Math.sqrt(r)),dz=p1(rl,fk),pz={kernelName:rl,backendName:"cpu",kernelFunc:dz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hk(r,t,n,o,u,h,p,g,x,I){const z=[o/u,u],V=r.values,rt=t.values;if(o===0)return vs(n,t.dtype);const Et=vs(z,t.dtype);Et.values.fill(x);for(let St=0;St<h;St++){const Tt=[];let Vt=0;for(let ue=0;ue<p;ue++){const ye=V[St*p+ue];Tt.push(ye),Vt+=ye*g[ue]}if(Vt<0||Vt>=o/u)throw new Error(`Invalid indices: ${Tt} does not index into ${n}`);for(let ue=0;ue<u;ue++)I?Et.values[Vt*u+ue]+=rt[St*u+ue]:Et.values[Vt*u+ue]=t.rank===0?rt[0]:rt[St*u+ue]}return Et}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vz(r){const{inputs:t,backend:n,attrs:o}=r,{indices:u,updates:h}=t,{shape:p}=o,{sliceRank:g,numUpdates:x,sliceSize:I,strides:z,outputSize:V}=Bl(h,u,p),rt=!0,Et=n.bufferSync(u),St=n.bufferSync(h),Tt=hk(Et,St,p,V,I,x,g,z,0,rt);return n.makeTensorInfo(p,Tt.dtype,Tt.values)}const gz={kernelName:_f,backendName:"cpu",kernelFunc:vz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mz(r){const{inputs:t,backend:n}=r,{condition:o,t:u,e:h}=t;Go([o,u,h],"select");const p=o.shape.length,g=n.data.get(o.dataId).values,x=n.data.get(u.dataId).values,I=n.data.get(h.dataId).values,z=so(u.dtype,h.dtype),V=kt(Rt(u.shape),z);let rt=0;const Et=p===0||p>1||u.shape.length===1?1:Rt(u.shape.slice(1));for(let St=0;St<g.length;St++)for(let Tt=0;Tt<Et;Tt++)g[St]===1?V[rt++]=x[St]:V[rt++]=I[St];return n.makeTensorInfo(u.shape,z,V)}const yz={kernelName:Dc,backendName:"cpu",kernelFunc:mz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bz=My,xz=Ny,wz=Ul(wc,r=>r>=0?xz*r:bz*(Math.exp(r)-1)),Ez={kernelName:wc,backendName:"cpu",kernelFunc:wz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sz=Ul(de,r=>1/(1+Math.exp(-r))),Cz={kernelName:de,backendName:"cpu",kernelFunc:Sz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _z=Ul(Zt,r=>r<0?-1:r>0?1:0),Iz={kernelName:Zt,backendName:"cpu",kernelFunc:_z};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tz=Ul(A,r=>Math.sin(r)),Az={kernelName:A,backendName:"cpu",kernelFunc:Tz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mz=Ul(nt,r=>Math.sinh(r)),Nz={kernelName:nt,backendName:"cpu",kernelFunc:Mz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dk=Math.log(11920928955078125e-23)+2,kz=Ul(Pe,r=>{const t=r>-dk,n=r<dk,o=Math.exp(r);let u;return n?u=o:t?u=r:u=Math.log(1+o),u}),Dz={kernelName:Pe,backendName:"cpu",kernelFunc:kz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oz(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockShape:h,paddings:p}=o;Go([u],"spaceToBatchND");const g=Rt(h),x=[[0,0]];x.push(...p);for(let Pn=1+h.length;Pn<u.shape.length;++Pn)x.push([0,0]);const I=uk.kernelFunc({inputs:{x:u},backend:n,attrs:{paddings:x,constantValue:0}}),z=E0(I.shape,h,g,!1),V=Im(z.length,h.length,!1),rt=Hv(I.shape,h,g,!1),Tt=Nc({inputs:{x:I},backend:n,attrs:{shape:z}}),ye=xv({inputs:{x:Tt},backend:n,attrs:{perm:V}}),Xe=Nc({inputs:{x:ye},backend:n,attrs:{shape:rt}});return n.disposeIntermediateTensorInfo(I),n.disposeIntermediateTensorInfo(Tt),n.disposeIntermediateTensorInfo(ye),Xe}const Rz={kernelName:wn,backendName:"cpu",kernelFunc:Oz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lz(r){const{inputs:t,backend:n,attrs:o}=r,{sparseIndices:u,sparseValues:h,defaultValue:p}=t,{outputShape:g}=o,{sliceRank:x,numUpdates:I,sliceSize:z,strides:V,outputSize:rt}=Bl(h,u,g),Et=!1,St=n.bufferSync(u),Tt=n.bufferSync(h),Vt=n.data.get(p.dataId).values[0],ue=hk(St,Tt,g,rt,z,I,x,V,Vt,Et);return n.makeTensorInfo(g,ue.dtype,ue.values)}const Pz={kernelName:ua,backendName:"cpu",kernelFunc:Lz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fz(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{numOrSizeSplits:h,axis:p}=o,g=Rr(p,u.shape)[0],x=Dy(u,h,g),I=new Array(u.shape.length).fill(0),z=u.shape.slice();return x.map(V=>{const rt=[...z];rt[g]=V;const Et=U0({inputs:{x:u},backend:n,attrs:{begin:I,size:rt}});return I[g]+=V,Et})}const Bz={kernelName:kn,backendName:"cpu",kernelFunc:Fz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zz=Ul(Qe,r=>Math.sqrt(r)),$z={kernelName:Qe,backendName:"cpu",kernelFunc:zz};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gz={kernelName:ca,backendName:"cpu",kernelFunc:({inputs:r,backend:t})=>{const{x:n}=r,o=t;Go(n,"square");const u=o.data.get(n.dataId).values,h=new Float32Array(u.length);for(let g=0;g<u.length;++g){const x=u[g];h[g]=x*x}return{dataId:o.write(h,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pk=Cf((r,t)=>{const n=r-t;return n*n}),Uz=th(wr,pk),Wz={kernelName:wr,backendName:"cpu",kernelFunc:Uz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vz=Ul(zu,(r,t)=>{const n=t;return isNaN(r)?NaN:r>0?1:n.alpha}),jz={kernelName:zu,backendName:"cpu",kernelFunc:Vz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vk(r,t,n,o){const u=vs(r,t.dtype);for(let h=0;h<u.size;h++){const p=u.indexToLoc(h),g=new Array(p.length);for(let x=0;x<g.length;x++)g[x]=p[x]*n[x]+o[x];u.set(t.get(...g),...p)}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hz(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{begin:h,end:p,strides:g,beginMask:x,endMask:I,ellipsisMask:z,newAxisMask:V,shrinkAxisMask:rt}=o;Go(u,"stridedSlice");const{nonStrided:Et,$begin:St,$strides:Tt,size:Vt,newShape:ue,outShape:ye}=nv(u.shape,h,p,g,x,I,z,V,rt),qe=Nc({inputs:{x:u},backend:n,attrs:{shape:ue}});let $e;if(Et){const Pn=U0({inputs:{x:qe},backend:n,attrs:{begin:St,size:Vt}});$e=Nc({inputs:{x:Pn},backend:n,attrs:{shape:ye}}),n.disposeIntermediateTensorInfo(Pn)}else if(ye.some(Pn=>Pn===0))$e=n.makeTensorInfo(ye,u.dtype,[]);else{const Pn=n.bufferSync(qe),In=vk(ye,Pn,Tt,St);$e=n.makeTensorInfo(In.shape,In.dtype,In.values)}const Xe=Nc({inputs:{x:$e},backend:n,attrs:{shape:ye}});return n.disposeIntermediateTensorInfo(qe),n.disposeIntermediateTensorInfo($e),Xe}const Xz={kernelName:$a,backendName:"cpu",kernelFunc:Hz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yz=Ul(ri,r=>Math.tan(r)),Kz={kernelName:ri,backendName:"cpu",kernelFunc:Yz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zz=Ul(ba,r=>Math.tanh(r)),qz={kernelName:ba,backendName:"cpu",kernelFunc:Zz};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gk(r,t){const n=new Array(r.rank);for(let u=0;u<n.length;u++)n[u]=r.shape[u]*t[u];const o=vs(n,r.dtype);for(let u=0;u<o.values.length;++u){const h=o.indexToLoc(u),p=new Array(r.rank);for(let x=0;x<p.length;x++)p[x]=h[x]%r.shape[x];const g=r.locToIndex(p);o.values[u]=r.values[g]}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qz(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{reps:h}=o;Go(u,"tile");const p=gk(n.bufferSync(u),h);return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Jz={kernelName:ki,backendName:"cpu",kernelFunc:Qz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mk(r,t,n,o,u){const h=t[t.length-1],[p,g]=[r.length/h,h],x=ar(n,p*o),I=ar("int32",p*o);for(let V=0;V<p;V++){const rt=V*g,Et=r.subarray(rt,rt+g),St=[];for(let ye=0;ye<Et.length;ye++)St.push({value:Et[ye],index:ye});St.sort((ye,qe)=>qe.value-ye.value);const Tt=V*o,Vt=x.subarray(Tt,Tt+o),ue=I.subarray(Tt,Tt+o);for(let ye=0;ye<o;ye++)Vt[ye]=St[ye].value,ue[ye]=St[ye].index}const z=t.slice();return z[z.length-1]=o,[vs(z,n,x),vs(z,"int32",I)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t$(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{k:h,sorted:p}=o;Go(u,"topk");const g=n.data.get(u.dataId).values,[x,I]=mk(g,u.shape,u.dtype,h,p);return[n.makeTensorInfo(x.shape,x.dtype,x.values),n.makeTensorInfo(I.shape,I.dtype,I.values)]}const e$={kernelName:Eo,backendName:"cpu",kernelFunc:t$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yk(r,t,n,o){const u=Rr(t,n)[0],h=[1,n[0],1];for(let St=0;St<u;St++)h[0]*=n[St];h[1]=n[u];for(let St=u+1;St<n.length;St++)h[2]*=n[St];const p={},g=new Int32Array(n[u]),x=new ne(h,o,r),I=[],z=h[0]===1&&h[2]===1;for(let St=0;St<n[u];St++){let Tt;if(z)Tt=r[St].toString();else{const Vt=[];for(let ue=0;ue<h[0];ue++)for(let ye=0;ye<h[2];ye++)Vt.push(x.get(ue,St,ye));Tt=Vt.join(",")}if(p[Tt]!==void 0)g[St]=p[Tt];else{const Vt=Object.keys(p).length;p[Tt]=Vt,g[St]=Vt,I.push(St)}}const V=h.slice();V[1]=Object.keys(p).length;const rt=new ne(V,o);I.forEach((St,Tt)=>{for(let Vt=0;Vt<h[0];Vt++)for(let ue=0;ue<h[2];ue++)rt.set(x.get(Vt,St,ue),Vt,Tt,ue)});const Et=n.slice();return Et[u]=V[1],{outputValues:rt.values,outputShape:Et,indices:g}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n$(r){const{inputs:t,attrs:n,backend:o}=r,{axis:u}=n,{x:h}=t;Go(h,"unique");const p=o.data.get(h.dataId).values,{outputValues:g,outputShape:x,indices:I}=yk(p,u,h.shape,h.dtype);return[o.makeTensorInfo(x,h.dtype,g),o.makeTensorInfo([I.length],"int32",I)]}const r$={kernelName:Bo,backendName:"cpu",kernelFunc:n$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a$(r){const{inputs:t,backend:n,attrs:o}=r,{value:u}=t;let{axis:h}=o;h<0&&(h+=u.shape.length);const p=u.shape.length,g=u.shape[h],x=new Array(p-1);let I=0;for(let Et=0;Et<p;Et++)Et!==h&&(x[I++]=u.shape[Et]);const z=new Array(p).fill(0),V=u.shape.slice();V[h]=1;const rt=new Array(g);for(let Et=0;Et<rt.length;Et++){z[h]=Et;const St=U0({inputs:{x:u},backend:n,attrs:{begin:z,size:V}});rt[Et]=Nc({inputs:{x:St},backend:n,attrs:{shape:x}}),n.disposeIntermediateTensorInfo(St)}return rt}const i$={kernelName:go,backendName:"cpu",kernelFunc:a$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o$(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,segmentIds:h}=t,{numSegments:p}=o;Go(u,"unsortedSegmentSum");const g=u.shape.length,x=h.shape.length,I=[],z=[],V=g-x;let rt=h;for(let St=0;St<V;++St){const Tt=JE({inputs:{input:rt},backend:n,attrs:{dim:St+1}});rt=Tt,z.push(Tt)}for(let St=0;St<p;++St){const Tt=rf(St,"int32"),Vt=n.makeTensorInfo([],"int32",Tt),ue=GN({inputs:{a:Vt,b:rt},backend:n}),ye=Fm({inputs:{x:ue},backend:n,attrs:{dtype:"float32"}}),qe=QT({inputs:{a:ye,b:u},backend:n}),$e=tS({inputs:{x:qe},backend:n,attrs:{axis:0,keepDims:!1}});I.push($e),z.push(Vt),z.push(ue),z.push(ye),z.push(qe),z.push($e)}const Et=sk({inputs:I,backend:n,attrs:{axis:0}});return z.forEach(St=>n.disposeIntermediateTensorInfo(St)),Et}const s$={kernelName:Ao,backendName:"cpu",kernelFunc:o$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u$=[QP,JP,e3,r3,YP,i3,u3,c3,h3,p3,g3,y3,x3,S3,_3,A3,N3,D3,R3,ZP,P3,z3,G3,HP,W3,j3,VP,H3,Y3,q3,J3,K3,rF,iF,eF,sF,lF,fF,dF,vF,mF,yF,xF,EF,CF,_F,TF,IF,tA,FP,MF,kF,zF,$F,GF,WF,JF,tB,nB,aB,sB,lB,fB,dB,vB,mB,xB,BP,EB,X3,CB,IB,AB,zP,NB,OB,LB,FB,zB,UB,VB,XB,KB,qB,t4,n4,a4,o4,u4,c4,QB,d4,v4,m4,b4,E4,_4,jF,T4,N4,O4,P4,B4,$4,U4,W4,uk,X4,GP,K4,q4,jP,J4,UP,WP,KP,ez,rz,iz,sz,lz,cz,hz,pz,gz,yz,Ez,Cz,Iz,Az,Nz,F3,S4,Dz,Rz,Pz,Bz,$z,Gz,Wz,jz,Xz,YF,f4,Kz,qz,Jz,e$,o3,r$,i$,s$,G4];for(const r of u$)Uc(r);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bm={},aA={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function kj(r){delete Bm[r]}function l$(r,t){Bm[r]=t}function Sg(r){if(!(r in Bm)){const n=f$(r);if(n!==null)Bm[r]=n;else return console.log("Could not get context for WebGL version",r),null}const t=Bm[r];return t.isContextLost()?(delete Bm[r],Sg(r)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Bm[r])}function c$(r){if(typeof OffscreenCanvas!="undefined"&&r===2)return new OffscreenCanvas(300,150);if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function f$(r){if(r!==1&&r!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=c$(r);return t.addEventListener("webglcontextlost",n=>{n.preventDefault(),delete Bm[r]},!1),r===1?t.getContext("webgl",aA)||t.getContext("experimental-webgl",aA):t.getContext("webgl2",aA)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ex;(function(r){r[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH"})(Ex||(Ex={}));var Bp;(function(r){r[r.RENDER=0]="RENDER",r[r.UPLOAD=1]="UPLOAD",r[r.PIXELS=2]="PIXELS",r[r.DOWNLOAD=3]="DOWNLOAD"})(Bp||(Bp={}));var hh;(function(r){r[r.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",r[r.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",r[r.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",r[r.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",r[r.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(hh||(hh={}));function Sx(r,t){return[t,r]}function h$(r,t){return r*t}function Dj(r,t){return[t*4,r]}function Cx(r){const t=Rt(r),n=Math.ceil(t/4);return Ur(n)}function Oj(r,t){if(r%t!=0)throw new Error(`unpackedSize (${r}) must be a multiple of ${t}`);return r/t}function Rj(r,t,n){const o=r.length*n/4;if(t.length<o)throw new Error(`matrix length (${t.length}) must be >= ${o}`);let u=0;for(let h=0;h<r.length;h+=4)for(let p=0;p<n;p++)t[u++]=r[h+p]}function y1(r,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(r/2))]}function d$(r,t){const[n,o]=y1(r,t);return n*o*4}function iA(r,t){const n=r;let o,u,h,p,g,x,I,z,V,rt;return Ve().getNumber("WEBGL_VERSION")===2?(o=n.R32F,u=n.R16F,h=n.RGBA16F,p=n.RGBA32F,g=n.RED,I=4,z=1,V=n.HALF_FLOAT,rt=n.FLOAT):(o=r.RGBA,u=r.RGBA,h=r.RGBA,p=n.RGBA,g=r.RGBA,I=4,z=4,V=t!=null?t.HALF_FLOAT_OES:null,rt=r.FLOAT),x=r.RGBA,{internalFormatFloat:o,internalFormatHalfFloat:u,internalFormatPackedHalfFloat:h,internalFormatPackedFloat:p,textureFormatFloat:g,downloadTextureFormat:x,downloadUnpackNumChannels:I,defaultNumChannels:z,textureTypeHalfFloat:V,textureTypeFloat:rt}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uo(r,t){const n=t();return Ve().getBool("DEBUG")&&p$(r),n}function p$(r){const t=r.getError();if(t!==r.NO_ERROR)throw new Error("WebGL Error: "+y$(r,t))}const v$=596e-10,g$=65504;function m$(r){return!!(Ve().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||r===0||v$<Math.abs(r)&&Math.abs(r)<g$)}function y$(r,t){switch(t){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function nS(r,t){return nm(r,()=>r.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function b$(r,t){const n=nm(r,()=>r.createShader(r.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Uo(r,()=>r.shaderSource(n,t)),Uo(r,()=>r.compileShader(n)),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw console.log(r.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function x$(r,t){const n=nm(r,()=>r.createShader(r.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Uo(r,()=>r.shaderSource(n,t)),Uo(r,()=>r.compileShader(n)),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw E$(t,r.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const w$=/ERROR: [0-9]+:([0-9]+):/g;function E$(r,t){const n=w$.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(r);return}const o=+n[1],u=r.split(`
`),h=u.length.toString().length+2,p=u.map((V,rt)=>Sa((rt+1).toString(),h)+V);let g=0;for(let V=0;V<p.length;V++)g=Math.max(p[V].length,g);const x=p.slice(0,o-1),I=p.slice(o-1,o),z=p.slice(o);console.log(x.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${Sa(I[0],g)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(z.join(`
`))}function S$(r){return nm(r,()=>r.createProgram(),"Unable to create WebGLProgram.")}function C$(r,t){if(Uo(r,()=>r.linkProgram(t)),r.getProgramParameter(t,r.LINK_STATUS)===!1)throw console.log(r.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function oA(r,t){if(Uo(r,()=>r.validateProgram(t)),r.getProgramParameter(t,r.VALIDATE_STATUS)===!1)throw console.log(r.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function _$(r,t){const n=nm(r,()=>r.createBuffer(),"Unable to create WebGLBuffer");return Uo(r,()=>r.bindBuffer(r.ARRAY_BUFFER,n)),Uo(r,()=>r.bufferData(r.ARRAY_BUFFER,t,r.STATIC_DRAW)),n}function I$(r,t){const n=nm(r,()=>r.createBuffer(),"Unable to create WebGLBuffer");return Uo(r,()=>r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n)),Uo(r,()=>r.bufferData(r.ELEMENT_ARRAY_BUFFER,t,r.STATIC_DRAW)),n}function Lj(){return env().getNumber("WEBGL_VERSION")===2?1:4}function T$(r){return nm(r,()=>r.createTexture(),"Unable to create WebGLTexture.")}function A$(r,t){const n=Ve().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(r<=0||t<=0){const o=`[${r}x${t}]`;throw new Error("Requested texture size "+o+" is invalid.")}if(r>n||t>n){const o=`[${r}x${t}]`,u=`[${n}x${n}]`;throw new Error("Requested texture size "+o+" greater than WebGL maximum on this browser / GPU "+u+".")}}function M$(r){return nm(r,()=>r.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function bk(r,t,n,o,u,h,p){const g=r.getAttribLocation(t,n);return g===-1?!1:(Uo(r,()=>r.bindBuffer(r.ARRAY_BUFFER,o)),Uo(r,()=>r.vertexAttribPointer(g,u,r.FLOAT,!1,h,p)),Uo(r,()=>r.enableVertexAttribArray(g)),!0)}function N$(r,t,n){wk(r,n),Uo(r,()=>r.activeTexture(r.TEXTURE0+n)),Uo(r,()=>r.bindTexture(r.TEXTURE_2D,t))}function Pj(r,t){wk(r,t),Uo(r,()=>r.activeTexture(r.TEXTURE0+t)),Uo(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function k$(r,t,n){return nm(r,()=>r.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function D$(r,t,n){return r.getUniformLocation(t,n)}function O$(r,t,n,o){Uo(r,()=>N$(r,t,o)),Uo(r,()=>r.uniform1i(n,o))}function Fj(r){Uo(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,null)),Uo(r,()=>r.viewport(0,0,r.canvas.width,r.canvas.height)),Uo(r,()=>r.scissor(0,0,r.canvas.width,r.canvas.height))}function sA(r,t,n){Uo(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,n)),Uo(r,()=>r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0))}function xk(r,t){Uo(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,t)),Uo(r,()=>r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0))}function rS(r){const t=r.checkFramebufferStatus(r.FRAMEBUFFER);if(t!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+R$(r,t))}function R$(r,t){switch(t){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function nm(r,t,n){const o=Uo(r,()=>t());if(o==null)throw new Error(n);return o}function wk(r,t){const n=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,o=t+r.TEXTURE0;if(o<r.TEXTURE0||o>n){const u=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${u}.`)}}function b1(r,t=2){return Rt(r.slice(0,r.length-t))}function x1(r){if(r.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[r.length>1?r[r.length-2]:1,r[r.length-1]]}function uA(r){let t=[1,1,1];return r.length===0||r.length===1&&r[0]===1||(t=[b1(r),...x1(r)]),t}function L$(r,t=!1){let n=Ve().getNumber("WEBGL_MAX_TEXTURE_SIZE");t&&(n=n*2,r=r.map((u,h)=>h>=r.length-2?Me(r[h]):r[h]),r.length===1&&(r=[2,r[0]])),r.length!==2&&(r=Mn(r).newShape);let o=Rt(r);if(r.length<=1&&o<=n)return[1,o];if(r.length===2&&r[0]<=n&&r[1]<=n)return r;if(r.length===3&&r[0]*r[1]<=n&&r[2]<=n)return[r[0]*r[1],r[2]];if(r.length===3&&r[0]<=n&&r[1]*r[2]<=n)return[r[0],r[1]*r[2]];if(r.length===4&&r[0]*r[1]*r[2]<=n&&r[3]<=n)return[r[0]*r[1]*r[2],r[3]];if(r.length===4&&r[0]<=n&&r[1]*r[2]*r[3]<=n)return[r[0],r[1]*r[2]*r[3]];if(t){const u=b1(r);let h=2,p=2;return r.length&&([h,p]=x1(r)),o=u*(h/2)*(p/2),Ur(o).map(g=>g*2)}return Ur(o)}function aS(r){return r%2==0}function iS(r,t){if(r=r.slice(-2),t=t.slice(-2),Un(r,t)||!r.length||!t.length||r[0]===0||r[1]===0||t[0]===0||t[1]===0)return!0;if(r.length!==t.length){const n=r.slice(-1)[0],o=t.slice(-1)[0];if(n===o||aS(n)&&aS(o)&&(r[0]===1||t[0]===1))return!0}return r[1]===t[1]&&aS(r[0])&&aS(t[0])}let oS,sS;function P$(r){if(oS==null){const t=Sg(r);oS=t.getParameter(t.MAX_TEXTURE_SIZE)}return oS}function Bj(){oS=null}function zj(){sS=null}function F$(r){if(sS==null){const t=Sg(r);sS=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,sS)}function B$(r){if(r===0)return 0;let t;const n=Sg(r);return wv(n,"EXT_disjoint_timer_query_webgl2")&&r===2?t=2:wv(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function wv(r,t){return r.getExtension(t)!=null}function Ek(r){try{if(Sg(r)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function z$(r){if(r===0)return!1;const t=Sg(r);if(r===1){if(!wv(t,"OES_texture_float"))return!1}else if(!wv(t,"EXT_color_buffer_float"))return!1;return lA(t)}function $$(r){if(r===0)return!1;const t=Sg(r);if(r===1){if(!wv(t,"OES_texture_float")||!wv(t,"WEBGL_color_buffer_float"))return!1}else{if(wv(t,"EXT_color_buffer_float"))return lA(t);const o="EXT_color_buffer_half_float";if(wv(t,o)){const u=t.getExtension(o);return G$(t,u)}return!1}return lA(t)}function lA(r){const t=iA(r),n=r.createTexture();r.bindTexture(r.TEXTURE_2D,n);const o=1,u=1;r.texImage2D(r.TEXTURE_2D,0,t.internalFormatFloat,o,u,0,t.textureFormatFloat,t.textureTypeFloat,null);const h=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,h),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0);const p=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(n),r.deleteFramebuffer(h),p}function G$(r,t){const n=iA(r,t),o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o);const u=1,h=1;r.texImage2D(r.TEXTURE_2D,0,n.internalFormatHalfFloat,u,h,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const p=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,p),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0);const g=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(o),r.deleteFramebuffer(p),g}function U$(r){return r!==2?!1:Sg(r).fenceSync!=null}function _x(r,t){Array.isArray(r)||(r=[r]),r.forEach(n=>{n!=null&&yt(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ws=Ve();Ws.registerFlag("HAS_WEBGL",()=>Ws.getNumber("WEBGL_VERSION")>0),Ws.registerFlag("WEBGL_VERSION",()=>Ek(2)?2:Ek(1)?1:0),Ws.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),Ws.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ws.get("WEBGL_VERSION")===2),Ws.registerFlag("WEBGL_CPU_FORWARD",()=>!0),Ws.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),Ws.registerFlag("WEBGL_PACK",()=>Ws.getBool("HAS_WEBGL")),Ws.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ws.getBool("WEBGL_PACK")),Ws.registerFlag("WEBGL_PACK_CLIP",()=>Ws.getBool("WEBGL_PACK")),Ws.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>!1),Ws.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ws.getBool("WEBGL_PACK")),Ws.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ws.getBool("WEBGL_PACK")),Ws.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ws.getBool("WEBGL_PACK")),Ws.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ws.getBool("WEBGL_PACK")),Ws.registerFlag("WEBGL_PACK_REDUCE",()=>Ws.getBool("WEBGL_PACK")),Ws.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ws.getBool("WEBGL_PACK")),Ws.registerFlag("WEBGL_CONV_IM2COL",()=>Ws.getBool("WEBGL_PACK")),Ws.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>P$(Ws.getNumber("WEBGL_VERSION"))),Ws.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>F$(Ws.getNumber("WEBGL_VERSION"))),Ws.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const r=Ws.getNumber("WEBGL_VERSION");return r===0?0:B$(r)}),Ws.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ws.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Tf()),Ws.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>z$(Ws.getNumber("WEBGL_VERSION"))),Ws.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ws.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ws.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),Ws.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>$$(Ws.getNumber("WEBGL_VERSION"))),Ws.registerFlag("WEBGL_FENCE_API_ENABLED",()=>U$(Ws.getNumber("WEBGL_VERSION"))),Ws.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ws.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),Ws.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,r=>{if(r<0&&r!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${r}.`)});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function id(){let r,t,n,o,u,h,p,g,x,I;return Ve().getNumber("WEBGL_VERSION")===2?(r="#version 300 es",t="in",n="out",o="in",u="texture",h="outputColor",p="out vec4 outputColor;",g=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,x="",I=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(r="",t="attribute",n="varying",o="varying",u="texture2D",h="gl_FragColor",p="",g=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,x=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,I=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:r,attribute:t,varyingVs:n,varyingFs:o,texture2D:u,output:h,defineOutput:p,defineSpecialNaN:g,defineSpecialInf:x,defineRound:I}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0(r,t,n="index"){const o=vt(t);return o.map((u,h)=>{const p=`int ${r[h]} = ${n} / ${u}`,g=h===o.length-1?`int ${r[h+1]} = ${n} - ${r[h]} * ${u}`:`index -= ${r[h]} * ${u}`;return`${p}; ${g};`}).join("")}function uS(r){return r.length===1?`${r[0]}`:`vec${r.length}(${r.join(",")})`}function $j(r,t){if(r.length!==t.length)throw new Error(`Vectors to be dotted must be of the same length -got ${r.length} and ${t.length}`);const n=[],o=Math.floor(r.length/4),u=r.length%4;for(let h=0;h<o;h++){const p=r.slice(h*4,h*4+4),g=t.slice(h*4,h*4+4);n.push(`${uS(p)}, ${uS(g)}`)}if(u!==0){let h=r.slice(o*4),p=t.slice(o*4);h.length===1&&(h=h.map(g=>`float(${g})`),p=p.map(g=>`float(${g})`)),n.push(`${uS(h)}, ${uS(p)}`)}return n.map((h,p)=>`dot(${h})`).join("+")}function cA(r){const t=vt(r).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}const Sk=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W${constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ex.DENSE;const n=Cx(t),o=id();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${W0(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(${n[0]}, ${n[1]}));
        int index = 4 * (resTexRC.x * ${n[1]} + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${o.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V${constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ex.DENSE;const n=Cx(t),o=id();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${W0(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(${n[0]}, ${n[1]}));
        int index = 4 * (resTexRC.x * ${n[1]} + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${o.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j${constructor(t){this.variableNames=["A"],this.outTexUsage=Bp.DOWNLOAD;const n=id();this.outputShape=t,this.userCode=`
      ${Sk}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H${constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Bp.DOWNLOAD;const n=id();this.outputShape=t,this.userCode=`
      ${Sk}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X${constructor(t,n,o=!1){this.variableNames=["A"];const u=id(),[h,p]=n;this.outputShape=t;let g="result";o&&(g="floor(result * 255. + 0.5)"),this.userCode=`
      ${cA(t)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / ${p};
        int c = imod(flatIndex, ${p});
        vec2 uv = (vec2(c, r) + halfCR) / vec2(${p}.0, ${h}.0);
        vec4 values = ${u.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${u.output} = vec4(${g}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y${constructor(t,n,o=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const u=id(),[h,p]=n;this.outputShape=t;let g="",x="result";o&&(x="floor(result * 255. + 0.5)");for(let I=0;I<=1;I++)for(let z=0;z<=1;z++){const V=I*2+z;g+=`
          localCoords = coords;
          if(localCoords[2] + ${z} < ${t[2]}) {
            localCoords[2] += ${z};
            if(localCoords[1] + ${I} < ${t[1]}) {
              localCoords[1] += ${I};

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / ${p};
              c = imod(flatIndex, ${p});
              uv = (vec2(c, r) + halfCR) / vec2(${p}.0, ${h}.0);
              values = ${u.texture2D}(A, uv);

              if(offset == 0) {
                result[${V}] = values[0];
              } else if(offset == 1) {
                result[${V}] = values[1];
              } else if(offset == 2) {
                result[${V}] = values[2];
              } else {
                result[${V}] = values[3];
              }
            }
          }
        `}this.userCode=`
      ${cA(t)}

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        ${g}

        ${u.output} = ${x};
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K$(r){const t=id(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return b$(r,n)}function Z$(r){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return _$(r,t)}function q$(r){const t=new Uint16Array([0,1,2,2,1,3]);return I$(r,t)}function Ix(r,t,n,o,u,h){A$(t,n);const p=T$(r),g=r.TEXTURE_2D;return Uo(r,()=>r.bindTexture(g,p)),Uo(r,()=>r.texParameteri(g,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE)),Uo(r,()=>r.texParameteri(g,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)),Uo(r,()=>r.texParameteri(g,r.TEXTURE_MIN_FILTER,r.NEAREST)),Uo(r,()=>r.texParameteri(g,r.TEXTURE_MAG_FILTER,r.NEAREST)),Uo(r,()=>r.texImage2D(g,0,o,t,n,0,u,h,null)),Uo(r,()=>r.bindTexture(r.TEXTURE_2D,null)),p}function Ck(r){return r.internalFormatFloat}function Q$(r,t,n,o){const[u,h]=Sx(t,n);return Ix(r,u,h,Ck(o),o.textureFormatFloat,r.FLOAT)}function _k(r){return r.internalFormatHalfFloat}function J$(r,t,n,o){const[u,h]=Sx(t,n);return Ix(r,u,h,_k(o),o.textureFormatFloat,o.textureTypeHalfFloat)}function Ik(r){return r.downloadTextureFormat}function t5(r,t,n,o){const[u,h]=Sx(t,n);return Ix(r,u,h,Ik(o),r.RGBA,r.UNSIGNED_BYTE)}function Tk(r){return r.internalFormatPackedFloat}function e5(r,t,n,o){const[u,h]=y1(t,n);return Ix(r,u,h,Tk(o),r.RGBA,r.FLOAT)}function Ak(r){return r.internalFormatPackedHalfFloat}function n5(r,t,n,o){const[u,h]=y1(t,n);return Ix(r,u,h,Ak(o),r.RGBA,o.textureTypeHalfFloat)}function r5(r,t,n){const o=0,u=3*4,h=3*4+2*4;return Uo(r,()=>r.bindBuffer(r.ARRAY_BUFFER,n)),bk(r,t,"clipSpacePos",n,3,h,o)&&bk(r,t,"uv",n,2,h,u)}function a5(r,t,n,o,u,h){Uo(r,()=>r.bindTexture(r.TEXTURE_2D,t));let p,g,x;u instanceof Uint8Array?(p=new Uint8Array(n*o*4),g=r.UNSIGNED_BYTE,x=r.RGBA):(p=new Float32Array(n*o*4),g=r.FLOAT,x=h.internalFormatPackedFloat),p.set(u),Uo(r,()=>r.texImage2D(r.TEXTURE_2D,0,x,n,o,0,r.RGBA,g,p)),Uo(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function i5(r,t,n){Uo(r,()=>r.bindTexture(r.TEXTURE_2D,t)),n.data instanceof Uint8Array?Uo(r,()=>r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n.width,n.height,0,r.RGBA,r.UNSIGNED_BYTE,n.data)):Uo(r,()=>r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)),Uo(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function o5(r,t,n,o){const u=r.createBuffer();Uo(r,()=>r.bindBuffer(r.PIXEL_PACK_BUFFER,u));const g=4*4*t*n;return Uo(r,()=>r.bufferData(r.PIXEL_PACK_BUFFER,g,r.STREAM_READ)),Uo(r,()=>r.readPixels(0,0,n,t,r.RGBA,r.FLOAT,0)),Uo(r,()=>r.bindBuffer(r.PIXEL_PACK_BUFFER,null)),u}function s5(r,t,n){const o=r,u=new Float32Array(n);return o.bindBuffer(o.PIXEL_PACK_BUFFER,t),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,u),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),u}function u5(r,t,n,o){const[u,h]=Sx(t,n),p=4,g=new Uint8Array(h$(t*n,p));return Uo(r,()=>r.readPixels(0,0,u,h,o.downloadTextureFormat,r.UNSIGNED_BYTE,g)),new Float32Array(g.buffer)}function l5(r,t,n,o,u,h,p,g){const x=r,I=new Float32Array(d$(h,p));return x.bindBuffer(x.PIXEL_PACK_BUFFER,t),x.getBufferSubData(x.PIXEL_PACK_BUFFER,0,I),x.bindBuffer(x.PIXEL_PACK_BUFFER,null),I}function c5(r,t,n){const o=new Float32Array(t*n*4);return Uo(r,()=>r.readPixels(0,0,n,t,r.RGBA,r.FLOAT,o)),o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f5{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const n=Ve().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,l$(n,t)):this.gl=Sg(n);let o="WEBGL_color_buffer_float";const u="EXT_color_buffer_half_float";if(Ve().getNumber("WEBGL_VERSION")===1){const h="OES_texture_float",p="OES_texture_half_float";if(this.textureFloatExtension=nS(this.gl,h),wv(this.gl,p))this.textureHalfFloatExtension=nS(this.gl,p);else if(Ve().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(o),wv(this.gl,u))this.colorBufferHalfFloatExtension=nS(this.gl,u);else if(Ve().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(o="EXT_color_buffer_float",wv(this.gl,o))this.colorBufferFloatExtension=this.gl.getExtension(o);else if(wv(this.gl,u))this.colorBufferHalfFloatExtension=this.gl.getExtension(u);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Z$(this.gl),this.indexBuffer=q$(this.gl),this.framebuffer=M$(this.gl),this.textureConfig=iA(this.gl,this.textureHalfFloatExtension)}get debug(){return Ve().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;Uo(t,()=>t.finish()),Uo(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Uo(t,()=>t.deleteFramebuffer(this.framebuffer)),Uo(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),Uo(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),Uo(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,n){return this.throwIfDisposed(),Q$(this.gl,t,n,this.textureConfig)}createFloat16MatrixTexture(t,n){return this.throwIfDisposed(),J$(this.gl,t,n,this.textureConfig)}createUnsignedBytesMatrixTexture(t,n){return this.throwIfDisposed(),t5(this.gl,t,n,this.textureConfig)}uploadPixelDataToTexture(t,n){this.throwIfDisposed(),i5(this.gl,t,n)}uploadDenseMatrixToTexture(t,n,o,u){this.throwIfDisposed(),a5(this.gl,t,n,o,u,this.textureConfig)}createFloat16PackedMatrixTexture(t,n){return this.throwIfDisposed(),n5(this.gl,t,n,this.textureConfig)}createPackedMatrixTexture(t,n){return this.throwIfDisposed(),e5(this.gl,t,n,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(xk(this.gl,this.framebuffer),this.outputTexture=null),Uo(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,n,o){return this.downloadMatrixDriver(t,()=>u5(this.gl,n,o,this.textureConfig))}downloadPackedMatrixFromBuffer(t,n,o,u,h,p){return l5(this.gl,t,n,o,u,h,p,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,n){return s5(this.gl,t,n)}createBufferFromTexture(t,n,o){this.bindTextureToFrameBuffer(t);const u=o5(this.gl,n,o,this.textureConfig);return this.unbindTextureToFrameBuffer(),u}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let n,o;if(Ve().getBool("WEBGL_FENCE_API_ENABLED")){const u=t,h=u.fenceSync(u.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),o=()=>{const p=u.clientWaitSync(h,0,0);return p===u.ALREADY_SIGNALED||p===u.CONDITION_SATISFIED},n=h}else Ve().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),o=()=>this.isQueryAvailable(n,Ve().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):o=()=>!0;return{query:n,isFencePassed:o}}downloadMatrixFromPackedTexture(t,n,o){return this.downloadMatrixDriver(t,()=>c5(this.gl,n,o))}createProgram(t){this.throwIfDisposed();const n=this.gl,o=x$(n,t),u=K$(n),h=S$(n);return Uo(n,()=>n.attachShader(h,u)),Uo(n,()=>n.attachShader(h,o)),C$(n,h),this.debug&&oA(n,h),this.vertexAttrsAreBound||(this.setProgram(h),this.vertexAttrsAreBound=r5(n,this.program,this.vertexBuffer)),h}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Uo(this.gl,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&oA(this.gl,this.program),Uo(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,n,o=!0){return this.throwIfDisposed(),o?k$(this.gl,t,n):D$(this.gl,t,n)}getAttributeLocation(t,n){return this.throwIfDisposed(),Uo(this.gl,()=>this.gl.getAttribLocation(t,n))}getUniformLocationNoThrow(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)}setInputMatrixTexture(t,n,o){this.throwIfDisposed(),this.throwIfNoProgram(),O$(this.gl,t,n,o)}setOutputMatrixTexture(t,n,o){this.setOutputMatrixTextureDriver(t,o,n)}setOutputPackedMatrixTexture(t,n,o){this.throwIfDisposed();const[u,h]=y1(n,o);this.setOutputMatrixTextureDriver(t,u,h)}setOutputMatrixWriteRegion(t,n,o,u){this.setOutputMatrixWriteRegionDriver(o,t,u,n)}setOutputPackedMatrixWriteRegion(t,n,o,u){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&oA(this.gl,this.program),rS(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),Uo(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Uo(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=nS(this.gl,Ve().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Ve().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const o=this.gl,u=this.getQueryTimerExtensionWebGL2(),h=o.createQuery();return o.beginQuery(u.TIME_ELAPSED_EXT,h),h}const t=this.getQueryTimerExtensionWebGL1(),n=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n}endQuery(){if(Ve().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,o=this.getQueryTimerExtensionWebGL2();n.endQuery(o.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(t){return Wr(this,null,function*(){return yield sa(()=>this.disposed||this.isQueryAvailable(t,Ve().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,Ve().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})}getQueryTime(t,n){if(n===0)return null;if(n===2){const o=this.gl;return o.getQueryParameter(t,o.QUERY_RESULT)/1e6}else{const o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,n){if(n===0)return!0;if(n===2){const o=this.gl,u=this.getQueryTimerExtensionWebGL2(),h=o.getQueryParameter(t,o.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(u.GPU_DISJOINT_EXT)),h&&!this.disjoint}else{const o=this.getQueryTimerExtensionWebGL1(),u=o.getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),u&&!this.disjoint}}pollFence(t){return new Promise(n=>{this.addItemToPoll(()=>t.isFencePassed(),()=>n())})}pollItems(){const t=h5(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=t;++n){const{resolveFn:o}=this.itemsToPoll[n];o()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,n){this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),!(this.itemsToPoll.length>1)&&sa(()=>(this.pollItems(),this.itemsToPoll.length===0))}bindTextureToFrameBuffer(t){this.throwIfDisposed(),sA(this.gl,t,this.framebuffer),this.debug&&rS(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(sA(this.gl,this.outputTexture,this.framebuffer),this.debug&&rS(this.gl)):xk(this.gl,this.framebuffer)}downloadMatrixDriver(t,n){this.bindTextureToFrameBuffer(t);const o=n();return this.unbindTextureToFrameBuffer(),o}setOutputMatrixTextureDriver(t,n,o){this.throwIfDisposed();const u=this.gl;sA(u,t,this.framebuffer),this.debug&&rS(u),this.outputTexture=t,Uo(u,()=>u.viewport(0,0,n,o)),Uo(u,()=>u.scissor(0,0,n,o))}setOutputMatrixWriteRegionDriver(t,n,o,u){this.throwIfDisposed(),Uo(this.gl,()=>this.gl.scissor(t,n,o,u))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function h5(r){let t=0;for(;t<r.length&&r[t]();++t);return t-1}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:Mk}=F;function d5(r,t,n,o){const u=[];r.forEach(St=>{const Tt=Rt(St.shapeInfo.logicalShape);St.shapeInfo.isUniform?u.push(`uniform float ${St.name}${Tt>1?`[${Tt}]`:""};`):(u.push(`uniform sampler2D ${St.name};`),u.push(`uniform int offset${St.name};`))});const h=u.join(`
`),p=r.map(St=>p5(St,t,o)).join(`
`),g=t.texShape,x=id(),I=m5(x);let z,V,rt=x5(x);return t.isPacked?(z=v5(t.logicalShape,g),V=b5(x)):(z=g5(t.logicalShape,g),V=y5(x)),o&&(rt+=C5),[rt,I,V,h,z,p,n].join(`
`)}function w1(r){const t=r.shapeInfo.logicalShape;switch(t.length){case 0:return P5(r);case 1:return B5(r);case 2:return $5(r);case 3:return U5(r);case 4:return V5(r);case 5:return j5(r);case 6:return H5(r);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function Nk(r){switch(r.shapeInfo.logicalShape.length){case 0:return L5(r);case 1:return F5(r);case 2:return z5(r);case 3:return G5(r);default:return W5(r)}}function p5(r,t,n=!1){let o="";n?o+=Nk(r):o+=w1(r);const u=r.shapeInfo.logicalShape,h=t.logicalShape;return u.length<=h.length&&(n?o+=X5(r,t):o+=Y5(r,t)),o}function v5(r,t){switch(r.length){case 0:return kk();case 1:return _5(r,t);case 2:return O5(r,t);case 3:return T5(r,t);default:return M5(r,t)}}function g5(r,t){switch(r.length){case 0:return kk();case 1:return I5(r,t);case 2:return R5(r,t);case 3:return A5(r,t);case 4:return N5(r,t);case 5:return k5(r,t);case 6:return D5(r,t);default:throw new Error(`${r.length}-D output sampling is not yet supported`)}}function m5(r){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${r.texture2D}(textureSampler, uv).r;
    }
  `}function y5(r){return`
    void setOutput(float val) {
      ${r.output} = vec4(val, 0, 0, 0);
    }
  `}function b5(r){return`
    void setOutput(vec4 val) {
      ${r.output} = val;
    }
  `}function x5(r){return`${r.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${r.varyingFs} vec2 resultUV;
    ${r.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${r.defineSpecialNaN}
    ${r.defineSpecialInf}
    ${r.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${w5}
    ${E5}
    ${S5}
  `}const w5=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,E5=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,S5=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,C5=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function kk(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function _5(r,t){const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return n[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${n[1]}.0);
      }
    `:n[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${n[0]}.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      return 2 * (resTexRC.x * ${n[1]} + resTexRC.y);
    }
  `}function I5(r,t){return t[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function T5(r,t){const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],o=Math.ceil(r[2]/2),u=o*Math.ceil(r[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      int b = index / ${u};
      index -= b * ${u};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec3(b, r, c);
    }
  `}function A5(r,t){const n=W0(["r","c","d"],r);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${n}
      return ivec3(r, c, d);
    }
  `}function M5(r,t){const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],o=Math.ceil(r[r.length-1]/2),u=o*Math.ceil(r[r.length-2]/2);let h=u,p="",g="b, r, c";for(let x=2;x<r.length-1;x++)h*=r[r.length-x-1],p=`
      int b${x} = index / ${h};
      index -= b${x} * ${h};
    `+p,g=`b${x}, `+g;return`
    ivec${r.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      ${p}

      int b = index / ${u};
      index -= b * ${u};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec${r.length}(${g});
    }
  `}function N5(r,t){const n=W0(["r","c","d","d2"],r);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${n}
      return ivec4(r, c, d, d2);
    }
  `}function k5(r,t){const n=W0(["r","c","d","d2","d3"],r);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function D5(r,t){const n=W0(["r","c","d","d2","d3","d4"],r);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function O5(r,t){const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Un(r,t))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));
      }
    `;const o=Math.ceil(r[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));

      int index = resTexRC.x * ${n[1]} + resTexRC.y;
      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec2(r, c);
    }
  `}function R5(r,t){return Un(r,t)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:r[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:r[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${r[1]};
      int c = index - r * ${r[1]};
      return ivec2(r, c);
    }
  `}function V0(r){return`offset${r}`}function L5(r){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),o=id();return`
    vec4 ${n}() {
      return ${o.texture2D}(${t}, halfCR);
    }
  `}function P5(r){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(r.shapeInfo.isUniform)return`float ${n}() {return ${t};}`;const[o,u]=r.shapeInfo.texShape;if(o===1&&u===1)return`
      float ${n}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const[h,p]=r.shapeInfo.texShape,g=V0(t);return`
    float ${n}() {
      vec2 uv = uvFromFlat(${h}, ${p}, ${g});
      return sampleTexture(${t}, uv);
    }
  `}function F5(r){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),o=r.shapeInfo.texShape,u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],h=id();return`
    vec4 ${n}(int index) {
      vec2 uv = packedUVfrom1D(
        ${u[0]}, ${u[1]}, index);
      return ${h.texture2D}(${t}, uv);
    }
  `}function B5(r){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(r.shapeInfo.isUniform)return`
      float ${n}(int index) {
        ${E1(r)}
      }
    `;const o=r.shapeInfo.texShape,u=o[0],h=o[1];if(h===1&&u===1)return`
      float ${n}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const p=V0(t);return h===1?`
      float ${n}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${p}) + 0.5) / ${u}.0);
        return sampleTexture(${t}, uv);
      }
    `:u===1?`
      float ${n}(int index) {
        vec2 uv = vec2((float(index + ${p}) + 0.5) / ${h}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
    float ${n}(int index) {
      vec2 uv = uvFromFlat(${u}, ${h}, index + ${p});
      return sampleTexture(${t}, uv);
    }
  `}function z5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=r.shapeInfo.texShape,h=u[0],p=u[1],g=id();if(u!=null&&Un(t,u))return`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${p}.0, ${h}.0);

        return ${g.texture2D}(${n}, uv);
      }
    `;const x=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],I=Math.ceil(t[1]/2);return`
    vec4 ${o}(int row, int col) {
      vec2 uv = packedUVfrom2D(${I}, ${x[0]}, ${x[1]}, row, col);
      return ${g.texture2D}(${n}, uv);
    }
  `}function $5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=r.shapeInfo.texShape;if(u!=null&&Un(t,u)){const V=u[0],rt=u[1];return`
    float ${o}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${rt}.0, ${V}.0);
      return sampleTexture(${n}, uv);
    }
  `}const{newShape:h,keptDims:p}=Mn(t),g=h;if(g.length<t.length){const V=S1(r,g),rt=["row","col"];return`
      ${w1(V)}
      float ${o}(int row, int col) {
        return ${o}(${C1(rt,p)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${E1(r)}
      }
    `;const x=u[0],I=u[1],z=V0(n);return I===1?`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${z}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${x}.0);
      return sampleTexture(${n}, uv);
    }
  `:x===1?`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${z}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${I}.0, 0.5);
      return sampleTexture(${n}, uv);
    }
  `:`
  float ${o}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${z};
    vec2 uv = uvFromFlat(${x}, ${I}, index);
    return sampleTexture(${n}, uv);
  }
`}function G5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=r.shapeInfo.texShape,h=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(t[0]===1){const V=t.slice(1),rt=[1,2],Et=S1(r,V),St=["b","row","col"];return`
        ${Nk(Et)}
        vec4 ${o}(int b, int row, int col) {
          return ${o}(${C1(St,rt)});
        }
      `}const p=h[0],g=h[1],x=Math.ceil(t[2]/2),I=x*Math.ceil(t[1]/2),z=id();return`
    vec4 ${o}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${p}, ${g}, ${I}, ${x}, b, row, col);
      return ${z.texture2D}(${n}, uv);
    }
  `}function U5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=t[1]*t[2],h=t[2],{newShape:p,keptDims:g}=Mn(t),x=p;if(x.length<t.length){const St=S1(r,x),Tt=["row","col","depth"];return`
        ${w1(St)}
        float ${o}(int row, int col, int depth) {
          return ${o}(${C1(Tt,g)});
        }
      `}if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${u}, ${h}, 1)));
        ${E1(r)}
      }
    `;const I=r.shapeInfo.texShape,z=I[0],V=I[1],rt=r.shapeInfo.flatOffset;if(V===u&&rt==null)return`
        float ${o}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${h}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${V}.0, ${z}.0);
          return sampleTexture(${n}, uv);
        }
      `;if(V===h&&rt==null)return`
    float ${o}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${V}.0, ${z}.0);
      return sampleTexture(${n}, uv);
    }
  `;const Et=V0(n);return`
      float ${o}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${u} + col * ${h} + depth + ${Et};
        vec2 uv = uvFromFlat(${z}, ${V}, index);
        return sampleTexture(${n}, uv);
      }
  `}function W5(r){const t=r.shapeInfo.logicalShape,n=t.length,o=r.name,u="get"+o.charAt(0).toUpperCase()+o.slice(1),h=r.shapeInfo.texShape,p=[Math.ceil(h[0]/2),Math.ceil(h[1]/2)],g=p[0],x=p[1],I=Math.ceil(t[n-1]/2);let z=I*Math.ceil(t[n-2]/2),V="int b, int row, int col",rt=`b * ${z} + (row / 2) * ${I} + (col / 2)`;for(let St=2;St<n-1;St++)V=`int b${St}, `+V,z*=t[n-St-1],rt=`b${St} * ${z} + `+rt;const Et=id();return`
    vec4 ${u}(${V}) {
      int index = ${rt};
      int texR = index / ${x};
      int texC = index - texR * ${x};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${x}, ${g});
      return ${Et.texture2D}(${o}, uv);
    }
  `}function V5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=t[3],h=t[2]*u,p=t[1]*h,{newShape:g,keptDims:x}=Mn(t);if(g.length<t.length){const St=S1(r,g),Tt=["row","col","depth","depth2"];return`
      ${w1(St)}
      float ${o}(int row, int col, int depth, int depth2) {
        return ${o}(${C1(Tt,x)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${p}, ${h}, ${u}, 1)));
        ${E1(r)}
      }
    `;const I=r.shapeInfo.flatOffset,z=r.shapeInfo.texShape,V=z[0],rt=z[1];if(rt===p&&I==null)return`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${h}, ${u}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${rt}.0, ${V}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(rt===u&&I==null)return`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${rt}.0, ${V}.0);
        return sampleTexture(${n}, uv);
      }
    `;const Et=V0(n);return`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${p} + col * ${h} +
          depth * ${u} + depth2;
      vec2 uv = uvFromFlat(${V}, ${rt}, index + ${Et});
      return sampleTexture(${n}, uv);
    }
  `}function j5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=t[4],h=t[3]*u,p=t[2]*h,g=t[1]*p,{newShape:x,keptDims:I}=Mn(t);if(x.length<t.length){const Tt=S1(r,x),Vt=["row","col","depth","depth2","depth3"];return`
      ${w1(Tt)}
      float ${o}(int row, int col, int depth, int depth2, int depth3) {
        return ${o}(${C1(Vt,I)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${g}, ${p}, ${h}, ${u})) +
          depth3;
        ${E1(r)}
      }
    `;const z=r.shapeInfo.flatOffset,V=r.shapeInfo.texShape,rt=V[0],Et=V[1];if(Et===g&&z==null)return`
      float ${o}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${p}, ${h}, ${u}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${Et}.0, ${rt}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(Et===u&&z==null)return`
      float ${o}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${Et}.0, ${rt}.0);
        return sampleTexture(${n}, uv);
      }
    `;const St=V0(n);return`
    float ${o}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${g} + col * ${p} + depth * ${h} +
          depth2 * ${u} + depth3 + ${St};
      vec2 uv = uvFromFlat(${rt}, ${Et}, index);
      return sampleTexture(${n}, uv);
    }
  `}function H5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:u,keptDims:h}=Mn(t);if(u.length<t.length){const Vt=S1(r,u),ue=["row","col","depth","depth2","depth3","depth4"];return`
      ${w1(Vt)}
      float ${o}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${o}(${C1(ue,h)});
      }
    `}const p=t[5],g=t[4]*p,x=t[3]*g,I=t[2]*x,z=t[1]*I;if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${z}, ${I}, ${x}, ${g})) +
          dot(
            vec2(depth3, depth4),
            vec2(${p}, 1)));
        ${E1(r)}
      }
    `;const V=r.shapeInfo.flatOffset,rt=r.shapeInfo.texShape,Et=rt[0],St=rt[1];if(St===z&&V==null)return`
      float ${o}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${I}, ${x}, ${g}, ${p})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${St}.0, ${Et}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(St===p&&V==null)return`
      float ${o}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${St}.0, ${Et}.0);
        return sampleTexture(${n}, uv);
      }
    `;const Tt=V0(n);return`
    float ${o}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${z} + col * ${I} + depth * ${x} +
          depth2 * ${g} + depth3 * ${p} + depth4 + ${Tt};
      vec2 uv = uvFromFlat(${Et}, ${St}, index);
      return sampleTexture(${n}, uv);
    }
  `}function E1(r){const t=r.name,n=Rt(r.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function X5(r,t){const n=r.name,o=n.charAt(0).toUpperCase()+n.slice(1),u="get"+o+"AtOutCoords",h=r.shapeInfo.logicalShape.length,p=t.logicalShape.length,g=Mk(r.shapeInfo.logicalShape,t.logicalShape),x=ac(p),I=p-h;let z;const V=["x","y","z","w","u","v"];h===0?z="":p<2&&g.length>=1?z="coords = 0;":z=g.map(ye=>`coords.${V[ye+I]} = 0;`).join(`
`);let rt="";p<2&&h>0?rt="coords":rt=r.shapeInfo.logicalShape.map((ye,qe)=>`coords.${V[qe+I]}`).join(", ");let Et="return outputValue;";const Tt=Rt(r.shapeInfo.logicalShape)===1,ue=Rt(t.logicalShape)===1;if(h===1&&!Tt&&!ue)Et=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(Tt&&!ue)p===1?Et=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:Et=`
        return vec4(outputValue.x);
      `;else if(g.length){const ye=h-2,qe=h-1;g.indexOf(ye)>-1&&g.indexOf(qe)>-1?Et="return vec4(outputValue.x);":g.indexOf(ye)>-1?Et="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":g.indexOf(qe)>-1&&(Et="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${u}() {
      ${x} coords = getOutputCoords();
      ${z}
      vec4 outputValue = get${o}(${rt});
      ${Et}
    }
  `}function Y5(r,t){const n=r.name,o=n.charAt(0).toUpperCase()+n.slice(1),u="get"+o+"AtOutCoords",h=t.texShape,p=r.shapeInfo.texShape,g=r.shapeInfo.logicalShape.length,x=t.logicalShape.length;if(!r.shapeInfo.isUniform&&g===x&&r.shapeInfo.flatOffset==null&&Un(p,h))return`
      float ${u}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const I=ac(x),z=Mk(r.shapeInfo.logicalShape,t.logicalShape),V=x-g;let rt;const Et=["x","y","z","w","u","v"];g===0?rt="":x<2&&z.length>=1?rt="coords = 0;":rt=z.map(Tt=>`coords.${Et[Tt+V]} = 0;`).join(`
`);let St="";return x<2&&g>0?St="coords":St=r.shapeInfo.logicalShape.map((Tt,Vt)=>`coords.${Et[Vt+V]}`).join(", "),`
    float ${u}() {
      ${I} coords = getOutputCoords();
      ${rt}
      return get${o}(${St});
    }
  `}function ac(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error(`GPU for rank ${r} is not yet supported`)}function S1(r,t){const n=JSON.parse(JSON.stringify(r));return n.shapeInfo.logicalShape=t,n}function C1(r,t){return t.map(n=>r[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K5(r,t,n,o){const u=t.userCode,h=n.map((Et,St)=>{const Tt={logicalShape:Et.shape,texShape:Et.isUniform?null:Et.texData.texShape,isUniform:Et.isUniform,isPacked:Et.isUniform?!1:Et.texData.isPacked,flatOffset:null};return Et.texData!=null&&Et.texData.slice!=null&&Et.texData.slice.flatOffset>0&&(Tt.flatOffset=Et.texData.slice.flatOffset),{name:t.variableNames[St],shapeInfo:Tt}}),p=h.map(Et=>Et.shapeInfo),g={logicalShape:o.shape,texShape:o.texData.texShape,isUniform:!1,isPacked:o.texData.isPacked,flatOffset:null},x=d5(h,g,u,t.packedInputs),I=r.createProgram(x);let z=null;const V=r.getUniformLocation(I,"NAN",!1);Ve().getNumber("WEBGL_VERSION")===1&&(z=r.getUniformLocation(I,"INFINITY",!1));const rt={};for(let Et=0;Et<t.variableNames.length;Et++){const St=t.variableNames[Et],Tt=!1;rt[St]=r.getUniformLocation(I,St,Tt),rt[`offset${St}`]=r.getUniformLocation(I,`offset${St}`,Tt)}return{program:t,source:x,webGLProgram:I,uniformLocations:rt,inShapeInfos:p,outShapeInfo:g,infLoc:z,nanLoc:V}}function Dk(r,t){if(r.length!==t.length)throw Error(`Binary was compiled with ${r.length} inputs, but was executed with ${t.length} inputs`);r.forEach((n,o)=>{const u=n.logicalShape,h=t[o],p=h.shape;if(!Un(u,p))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${u} and ${p} must match`);if(n.isUniform&&h.isUniform)return;const g=n.texShape,x=h.isUniform?null:h.texData.texShape;if(!Un(g,x))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${g} and ${x} must match`)})}function Z5(r,t,n,o,u){Dk(t.inShapeInfos,n),Dk([t.outShapeInfo],[o]);const h=o.texData.texture,p=o.texData.texShape;o.texData.isPacked?r.setOutputPackedMatrixTexture(h,p[0],p[1]):r.setOutputMatrixTexture(h,p[0],p[1]),r.setProgram(t.webGLProgram),Ve().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&r.gl.uniform1f(t.infLoc,Infinity),t.nanLoc!==null&&r.gl.uniform1f(t.nanLoc,NaN),n.forEach((g,x)=>{const I=t.program.variableNames[x],z=t.uniformLocations[I],V=t.uniformLocations[`offset${I}`];if(z!=null){if(g.isUniform){if(Rt(g.shape)<2)r.gl.uniform1f(z,g.uniformValues[0]);else{let rt=g.uniformValues;rt instanceof Float32Array||(rt=new Float32Array(rt)),r.gl.uniform1fv(z,rt)}return}g.texData.slice!=null&&V!=null&&r.gl.uniform1i(V,g.texData.slice.flatOffset),r.setInputMatrixTexture(g.texData.texture,z,x)}}),u!=null&&u(r,t.webGLProgram),r.executeProgram()}function q5(r,t,n){let o="";t.concat(n).forEach(p=>{const g=p.texData!=null&&p.texData.slice!=null&&p.texData.slice.flatOffset>0,x=p.isUniform?"uniform":p.texData.texShape;o+=`${p.shape}_${x}_${g}`});const u=r.userCode;let h=r.constructor.name;return h+="_"+o+"_"+u,h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Q5,bincountImpl:Ok,bincountReduceImpl:J5,ceilImpl:t6,concatImpl:e6,expImpl:n6,expm1Impl:r6,floorImpl:a6,gatherV2Impl:i6,greaterImpl:o6,lessImpl:s6,linSpaceImpl:u6,logImpl:l6,maxImpl:c6,maximumImpl:f6,minimumImpl:h6,multiplyImpl:d6,negImpl:p6,prodImpl:v6,rangeImpl:g6,rsqrtImpl:m6,simpleAbsImpl:Rk,sliceImpl:y6,stridedSliceImpl:b6,subImpl:x6,tileImpl:w6,topKImpl:E6,transposeImpl:fA,uniqueImpl:S6}=Le;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lk(r,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${r}.${n}`)}function od(r,t){return t===1?[r]:Lk(r,t)}function C6(r,t){if(r===1)return"rc";let n="";for(let o=0;o<r;o++)n+=t[o],o<r-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _6{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;const n=t.length;if(n===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const o=od("rc",n),u=ac(n),h=T6(n,t,o),p=A6(n,t[t.length-1],t[t.length-2],o),g=M6(t,o);this.userCode=`
        void main() {
          ${u} rc = getOutputCoords();

          if(${h}) {
            setOutput(vec4(0));
          } else {
            ${p}

            setOutput(vec4(${g}));
          }
        }
      `}}}function I6(r,t){const n=[];for(let o=0;o<=1;o++)for(let u=0;u<=1;u++){let h=`${o===0?"r":"rp1"}, ${u===0?"c":"cp1"}`;for(let p=2;p<r;p++)h=`${t[t.length-1-p]},`+h;n.push(h)}return n}function T6(r,t,n){if(r===1)return`rc > ${t[0]}`;let o="";for(let u=r-2;u<r;u++)o+=`${n[u]} >= ${t[u]}`,u<r-1&&(o+="||");return o}function A6(r,t,n,o){if(r===1)return"";const u=o.slice(-2);return`
    int r = ${u[0]};
    int c = ${u[1]};
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= ${t};
    bool rEdge = rp1 >= ${n};
  `}function M6(r,t){const n=r.length,o=I6(n,t);return n===1?`getA(rc),
            rc + 1 >= ${r[0]} ? 0. : getA(rc + 1),
            0, 0`:`getA(${o[0]}),
          cEdge ? 0. : getA(${o[1]}),
          rEdge ? 0. : getA(${o[2]}),
          rEdge || cEdge ? 0. : getA(${o[3]})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pk{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let o="";for(let u=0;u<4;u++){let h="thisRC = rc;";u%2==1&&(h+="thisRC.z += 1;"),u>1&&(h+="thisRC.y += 1;"),o+=`
        ${h}
        ${u>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${u}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${u>0?"}":""}
      `}this.userCode=`
      ${N6(n)}
      ${cA(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${t[1]};
        int cols = ${t[2]};

        ${o}

        setOutput(result);
      }
    `}}function N6(r){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${W0(["r","c","d"],r)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k6{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,n,o){const u=Bk(n,o),h=zk(t,u,o);h in this.freeTextures||(this.freeTextures[h]=[]),h in this.usedTextures||(this.usedTextures[h]=[]);const p=Fk(t,u,this.gpgpu.gl,this.gpgpu.textureConfig,o);if(this.freeTextures[h].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=p,this.log();const x=this.freeTextures[h].shift();return this.usedTextures[h].push(x),x}let g;return u===hh.PACKED_2X2_FLOAT32?g=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):u===hh.PACKED_2X2_FLOAT16?g=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):u===hh.UNPACKED_FLOAT32?g=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):u===hh.UNPACKED_FLOAT16?g=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):u===hh.PACKED_4X1_UNSIGNED_BYTE&&(g=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[h].push(g),this.numUsedTextures++,this._numBytesAllocated+=p,this.log(),g}releaseTexture(t,n,o,u){if(this.freeTextures==null)return;const h=Bk(o,u),p=zk(n,h,u);p in this.freeTextures||(this.freeTextures[p]=[]);const g=Fk(n,h,this.gpgpu.gl,this.gpgpu.textureConfig,u),x=Ve().get("WEBGL_DELETE_TEXTURE_THRESHOLD");x!==-1&&this._numBytesAllocated>x?(this.gpgpu.deleteMatrixTexture(t),this._numBytesAllocated-=g):(this.freeTextures[p].push(t),this.numFreeTextures++,this._numBytesFree+=g),this.numUsedTextures--;const I=this.usedTextures[p],z=I.indexOf(t);if(z<0)throw new Error("Cannot release a texture that was never provided by this texture manager");I.splice(z,1),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n)});for(const t in this.usedTextures)this.usedTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function D6(r,t){const n=r;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===r.RGBA)return 16;if(t===n.RGBA16F)return 8;throw new Error(`Unknown internal format ${t}`)}function Fk(r,t,n,o,u){const h=O6(t,o);let p;if(u){const[x,I]=y1(r[0],r[1]);p=x*I}else{const[x,I]=Sx(r[0],r[1]);p=x*I}const g=D6(n,h);return p*g}function O6(r,t){switch(r){case hh.PACKED_2X2_FLOAT32:return Tk(t);case hh.PACKED_2X2_FLOAT16:return Ak(t);case hh.UNPACKED_FLOAT32:return Ck(t);case hh.UNPACKED_FLOAT16:return _k(t);case hh.PACKED_4X1_UNSIGNED_BYTE:return Ik(t);default:throw new Error(`Unknown physical texture type ${r}`)}}function R6(r){return Ve().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?r?hh.PACKED_2X2_FLOAT32:hh.UNPACKED_FLOAT32:r?hh.PACKED_2X2_FLOAT16:hh.UNPACKED_FLOAT16}function Bk(r,t){if(r===Bp.UPLOAD)return hh.PACKED_2X2_FLOAT32;if(r===Bp.RENDER||r==null)return R6(t);if(r===Bp.DOWNLOAD||r===Bp.PIXELS)return hh.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${r}`)}function zk(r,t,n){return`${r[0]}_${r[1]}_${t}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zm{constructor(t,n){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ev="if (isnan(x)) return x;",L6="return x;",$k="return abs(x);";function Gj(r=0){return Ev+`
    return x > 0.0 ? 1.0 : float(${r});
  `}const P6="return (x >= 0.0) ? x : (exp(x) - 1.0);",F6=Ev+`
  return (x < 0.0) ? 0.0 : x;
`,B6=Ev+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,lS="return x;";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z6="return x;",$6=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,G6=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,U6=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;class _1{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W6{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;const n=t.length,o=od("rc",n),u=ac(n),h=C6(n,o),p=o.slice(-2),g=n<=1?"rc":`vec2(${p.join(",")})`;this.userCode=`
      void main() {
        ${u} rc = getOutputCoords();
        vec4 packedInput = getA(${h});

        setOutput(getChannel(packedInput, ${g}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V6=Rg,j6=1e-7,H6=1e-4,cS={};function X6(r){return r in cS||(cS[r]={}),cS[r]}const Y6=128,K6=600;function Z6(){return Ve().global.screen==null?1024:Ve().global.screen.height*Ve().global.screen.width*window.devicePixelRatio*K6/1024/1024}class q6 extends He{constructor(t){super();if(this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.warnedAboutCPUBackend=!1,this.pendingDeletes=0,this.disposed=!1,!Ve().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(t==null){const n=Sg(Ve().getNumber("WEBGL_VERSION"));this.binaryCache=X6(Ve().getNumber("WEBGL_VERSION")),this.gpgpu=new f5(n),this.canvas=n.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=t,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;this.textureManager=new k6(this.gpgpu),this.numMBBeforeWarning=Z6(),this.texData=new Re(this,Oa())}numDataIds(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}write(t,n,o){if((Ve().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Ve().getBool("DEBUG"))&&this.checkNumericalProblems(t),o==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const u={};return this.texData.set(u,{shape:n,dtype:o,values:t,usage:Bp.UPLOAD,refCount:1,complexParentRefCount:0}),u}incRef(t){const n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.refCount--}}decComplexRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.complexParentRefCount>0&&n.refCount--}}move(t,n,o,u){if(Ve().getBool("DEBUG")&&this.checkNumericalProblems(n),u==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:o,dtype:u,values:n,usage:Bp.UPLOAD,refCount:1,complexParentRefCount:0})}disposeIntermediateTensorInfo(t){const n=t.dataId;if(this.texData.has(n)){const o=this.texData.get(n);o.refCount--,o.refCount<1&&this.disposeData(n)}}readSync(t){const n=this.texData.get(t),{values:o,dtype:u,complexTensorInfos:h,slice:p,shape:g,isPacked:x}=n;if(p!=null){let rt;x?rt=new _1(g,lS):rt=new zm(g,lS);const Et=this.runWebGLProgram(rt,[{dataId:t,shape:g,dtype:u}],u),St=this.readSync(Et.dataId);return this.disposeIntermediateTensorInfo(Et),St}if(o!=null)return this.convertAndCacheOnCPU(t);if(u==="string")return o;const I=this.activeTimers!=null;let z;I&&(z=ic());let V;if(u==="complex64"){const rt=this.readSync(h.real.dataId),Et=this.readSync(h.imag.dataId);V=cv(rt,Et)}else V=this.getValuesFromTexture(t);return I&&(this.downloadWaitMs+=ic()-z),this.convertAndCacheOnCPU(t,V)}read(t){return Wr(this,null,function*(){if(this.pendingRead.has(t)){const St=this.pendingRead.get(t);return new Promise(Tt=>St.push(Tt))}const n=this.texData.get(t),{values:o,shape:u,slice:h,dtype:p,complexTensorInfos:g,isPacked:x}=n;if(h!=null){let St;x?St=new _1(u,lS):St=new zm(u,lS);const Tt=this.runWebGLProgram(St,[{dataId:t,shape:u,dtype:p}],p),Vt=this.read(Tt.dataId);return this.disposeIntermediateTensorInfo(Tt),Vt}if(o!=null)return this.convertAndCacheOnCPU(t);if(!Ve().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Ve().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let I=null,z;if(p!=="complex64"&&Ve().get("WEBGL_BUFFER_SUPPORTED")){z=this.decode(t);const St=this.texData.get(z.dataId);I=this.gpgpu.createBufferFromTexture(St.texture,...Cx(u))}this.pendingRead.set(t,[]),p!=="complex64"&&(yield this.gpgpu.createAndWaitForFence());let V;if(p==="complex64"){const St=yield Promise.all([this.read(g.real.dataId),this.read(g.imag.dataId)]),Tt=St[0],Vt=St[1];V=cv(Tt,Vt)}else if(I==null)V=this.getValuesFromTexture(t);else{const St=Rt(u);V=this.gpgpu.downloadFloat32MatrixFromBuffer(I,St)}z!=null&&this.disposeIntermediateTensorInfo(z);const rt=this.convertAndCacheOnCPU(t,V),Et=this.pendingRead.get(t);return this.pendingRead.delete(t),Et.forEach(St=>St(rt)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),rt})}bufferSync(t){const n=this.readSync(t.dataId);let o=n;if(t.dtype==="string")try{o=n.map(u=>Ot(u))}catch(u){throw new Error("Failed to decode encoded string bytes into utf-8")}return vs(t.shape,t.dtype,o)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){const o=t[n];if(!m$(o))throw Ve().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${o} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${o} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:n,dtype:o,isPacked:u}=this.texData.get(t),h=Rt(n);if(Ve().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const rt=this.decode(t),Et=this.texData.get(rt.dataId),St=this.gpgpu.downloadMatrixFromPackedTexture(Et.texture,...Cx(n)).subarray(0,h);return this.disposeIntermediateTensorInfo(rt),St}const p=Ve().getBool("WEBGL_PACK")&&u===!0,g=p?uA(n):n,x=p?new H$(g):new j$(g),I=this.runWebGLProgram(x,[{shape:g,dtype:o,dataId:t}],"float32"),z=this.texData.get(I.dataId),V=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(z.texture,z.texShape[0],z.texShape[1]).subarray(0,h);return this.disposeIntermediateTensorInfo(I),V}time(t){return Wr(this,null,function*(){const n=this.activeTimers,o=[];let u=!1;this.programTimersStack==null?(this.programTimersStack=o,u=!0):this.activeTimers.push(o),this.activeTimers=o,t();const h=fn(this.activeTimers.map(x=>x.query)).filter(x=>x!=null),p=fn(this.activeTimers.map(x=>x.name)).filter(x=>x!=null);this.activeTimers=n,u&&(this.programTimersStack=null);const g={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(Ve().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const x=yield Promise.all(h);g.kernelMs=We(x),g.getExtraProfileInfo=()=>x.map((I,z)=>({name:p[z],ms:I})).map(I=>`${I.name}: ${I.ms}`).join(", ")}else g.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,g})}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Ve().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ic(),endMs:null}}endTimer(t){return Ve().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=ic(),t)}getQueryTime(t){return Wr(this,null,function*(){if(Ve().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const n=t;return n.endMs-n.startMs})}disposeData(t){if(this.pendingDisposal.has(t))return;if(this.pendingRead.has(t)){this.pendingDisposal.add(t),this.pendingDeletes++;return}if(!this.texData.has(t))return;if(this.texData.get(t).complexParentRefCount>0){this.texData.get(t).refCount--;return}this.releaseGPUData(t);const{complexTensorInfos:n}=this.texData.get(t);n!=null&&(this.texData.get(n.real.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(n.real),this.texData.get(n.imag.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(n.imag)),this.texData.delete(t)}releaseGPUData(t){const{texture:n,dtype:o,texShape:u,usage:h,isPacked:p,slice:g}=this.texData.get(t),x=g&&g.origDataId||t,I=this.dataRefCount.get(x);I>1?this.dataRefCount.set(x,I-1):(this.dataRefCount.delete(x),n!=null&&(this.numBytesInGPU-=this.computeBytes(u,o),this.textureManager.releaseTexture(n,u,h,p)));const z=this.texData.get(t);z.texture=null,z.texShape=null,z.isPacked=!1,z.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture}getDataInfo(t){return this.texData.get(t)}getCPUBackend(){return Ve().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=Oa().findBackend("cpu")),this.cpuBackend):null}shouldExecuteOnCPU(t,n=Y6){const o=this.getCPUBackend();return!Ve().getBool("IS_TEST")&&!this.warnedAboutCPUBackend&&o==null&&(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),o!=null&&t.every(u=>this.texData.get(u.dataId).texture==null&&Rt(u.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){Tm("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=t.dataSync();return V6(t.shape,n)}packedUnaryOp(t,n,o){const u=new _1(t.shape,n);return this.compileAndRun(u,[t],o)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const o=Rk(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,o)}if(Ve().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,$k,t.dtype);const n=new zm(t.shape,$k);return this.compileAndRun(n,[t])}makeTensorInfo(t,n,o){let u;if(n==="string"&&o!=null&&o.length>0&&Cr(o[0])){const h=o.map(p=>oc(p));u=this.write(h,t,n)}else u=this.write(o,t,n);return this.texData.get(u).usage=null,{dataId:u,shape:t,dtype:n}}makeOutput(t,n,o){const{dataId:u}=this.makeTensorInfo(t,n,o);return Oa().makeTensorFromDataId(u,t,n,this)}unpackTensor(t){const n=new W6(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){const n=new _6(t.shape),o=!0;return this.runWebGLProgram(n,[t],t.dtype,null,o)}packedReshape(t,n){const o=[b1(t.shape),...x1(t.shape)],u={dtype:t.dtype,shape:o,dataId:t.dataId},h=[b1(n),...x1(n)],p=new Pk(h,o),g=!0,x=this.runWebGLProgram(p,[u],t.dtype,null,g);return{dataId:x.dataId,shape:n,dtype:x.dtype}}decode(t){const n=this.texData.get(t),{isPacked:o,shape:u,dtype:h}=n,p=uA(u);let g;o?g=new V$(p):g=new W$(p);const x=!0,I=this.runWebGLProgram(g,[{shape:p,dtype:h,dataId:t}],h,null,x);return{dtype:h,shape:u,dataId:I.dataId}}runWebGLProgram(t,n,o,u,h=!1){const p=this.makeTensorInfo(t.outputShape,o),g=this.texData.get(p.dataId);if(t.packedOutput&&(g.isPacked=!0),t.outPackingScheme===Ex.DENSE){const Tt=Cx(t.outputShape);g.texShape=Tt.map(Vt=>Vt*2)}if(t.outTexUsage!=null&&(g.usage=t.outTexUsage),Rt(p.shape)===0)return g.values=ar(p.dtype,0),p;const x=[],I=n.map(Tt=>{if(Tt.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let Vt=this.texData.get(Tt.dataId);if(Vt.texture==null){if(!t.packedInputs&&Rt(Tt.shape)<=Ve().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:Tt.shape,texData:null,isUniform:!0,uniformValues:Vt.values};t.packedInputs&&(Vt.isPacked=!0,Vt.shape=Tt.shape)}else if(!!Vt.isPacked!=!!t.packedInputs)Tt=Vt.isPacked?this.unpackTensor(Tt):this.packTensor(Tt),x.push(Tt),Vt=this.texData.get(Tt.dataId);else if(Vt.isPacked&&!iS(Vt.shape,Tt.shape)){const ue=Tt,ye=Tt.shape;Tt.shape=Vt.shape,Tt=this.packedReshape(Tt,ye),x.push(Tt),Vt=this.texData.get(Tt.dataId),ue.shape=ye}return this.uploadToGPU(Tt.dataId),{shape:Tt.shape,texData:Vt,isUniform:!1}});this.uploadToGPU(p.dataId);const z={shape:p.shape,texData:g,isUniform:!1},V=q5(t,I,z),rt=this.getAndSaveBinary(V,()=>K5(this.gpgpu,t,I,z)),Et=this.activeTimers!=null;let St;if(Et&&(St=this.startTimer()),Z5(this.gpgpu,rt,I,z,u),x.forEach(Tt=>this.disposeIntermediateTensorInfo(Tt)),Et&&(St=this.endTimer(St),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(St)})),!Ve().getBool("WEBGL_LAZILY_UNPACK")&&g.isPacked&&h===!1){const Tt=this.unpackTensor(p);return this.disposeIntermediateTensorInfo(p),Tt}return p}compileAndRun(t,n,o,u,h=!1){o=o||n[0].dtype;const p=this.runWebGLProgram(t,n,o,u,h);return Oa().makeTensorFromDataId(p.dataId,p.shape,p.dtype)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Ve().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement!="undefined"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=zn(()=>{if(!Ve().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=Ve().getBool("DEBUG");Ve().set("DEBUG",!1);const n=this.abs(zi(1e-8)).dataSync()[0];if(Ve().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?j6:H6}uploadToGPU(t){const n=this.texData.get(t),{shape:o,dtype:u,values:h,texture:p,usage:g,isPacked:x}=n;if(p!=null)return;const I=this.activeTimers!=null;let z;I&&(z=ic());let V=n.texShape;if(V==null&&(V=L$(o,x),n.texShape=V),h!=null){const rt=uA(o);let Et,St=V[1],Tt=V[0];const Vt=h instanceof Uint8Array;x?([St,Tt]=y1(V[0],V[1]),Et=new Y$(rt,[Tt,St],Vt)):Et=new X$(rt,[Tt,St],Vt);const ue=this.makeTensorInfo([Tt,St],u);Vt?this.texData.get(ue.dataId).usage=Bp.PIXELS:this.texData.get(ue.dataId).usage=Bp.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(ue.dataId),St,Tt,h);const ye=!0,qe=this.runWebGLProgram(Et,[ue],u,null,ye),$e=this.texData.get(qe.dataId);n.texture=$e.texture,n.texShape=$e.texShape,n.isPacked=$e.isPacked,n.usage=$e.usage,this.disposeIntermediateTensorInfo(ue),this.texData.delete(qe.dataId),n.values=null,I&&(this.uploadWaitMs+=ic()-z)}else{const rt=this.acquireTexture(V,g,u,x);n.texture=rt}}convertAndCacheOnCPU(t,n){const o=this.texData.get(t),{dtype:u}=o;return this.releaseGPUData(t),n!=null&&(o.values=Q6(n,u)),o.values}acquireTexture(t,n,o,u){if(this.numBytesInGPU+=this.computeBytes(t,o),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const h=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${h} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,u)}computeBytes(t,n){return t[0]*t[1]*Ea(n)}}function Q6(r,t){if(t==="float32"||t==="complex64")return r;if(t==="int32"||t==="bool"){const n=t==="int32"?new Int32Array(r.length):new Uint8Array(r.length);for(let o=0;o<n.length;++o)n[o]=Math.round(r[o]);return n}else throw new Error(`Unknown dtype ${t}`)}/** @license See the LICENSE file. */const J6="2.8.6";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tG(){Ve().set("WEBGL_FORCE_F16_TEXTURES",!0)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */sc()&&Ye("webgl",()=>new q6,2);const Uj={forceHalfFloat:tG};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gk=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,Wj="return (a - b) * (a - b);";class I1{constructor(t,n,o){this.variableNames=["A","B"],this.outputShape=Nr(n,o),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fS=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`,Vj=null,jj=null;class Tx{constructor(t,n,o,u=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Nr(n,o);const h=this.outputShape.length;let p="";if(u)if(h===0||Rt(this.outputShape)===1)p=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(p=`
          ${ac(h)} coords = getOutputCoords();
        `,h===1)p+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const x=od("coords",h);p+=`
            bool nextRowOutOfBounds =
              (${x[h-2]} + 1) >= ${this.outputShape[h-2]};
            bool nextColOutOfBounds =
              (${x[h-1]} + 1) >= ${this.outputShape[h-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${p}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dp(r){const{inputs:t,backend:n}=r,{x:o}=t;return n.incRef(o.dataId),{dataId:o.dataId,shape:o.shape,dtype:o.dtype}}const eG={kernelName:xu,backendName:"webgl",kernelFunc:dp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $m(r){const{inputs:t,backend:n}=r,{real:o,imag:u}=t,h=n.makeTensorInfo(o.shape,"complex64"),p=n.texData.get(h.dataId),g=dp({inputs:{x:o},backend:n}),x=n.texData.get(g.dataId);x.complexParentRefCount++;const I=dp({inputs:{x:u},backend:n}),z=n.texData.get(I.dataId);return z.complexParentRefCount++,p.complexTensorInfos={real:g,imag:I},h}const nG={kernelName:wi,backendName:"webgl",kernelFunc:$m};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uk="return (a < 0.) ? b * a : a;",Wk=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function rG(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{alpha:h}=o,p=n.makeTensorInfo([],"float32",rf(h,"float32")),g=Ve().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Tx(Wk,u.shape,p.shape):new I1(Uk,u.shape,p.shape),x=n.runWebGLProgram(g,[u,p],u.dtype);return n.disposeIntermediateTensorInfo(p),x}const aG={kernelName:Du,backendName:"webgl",kernelFunc:rG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vk="return (a < 0.) ? b * a : a;",jk=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function iG(r){const{inputs:t,backend:n}=r,{x:o,alpha:u}=t,h=Ve().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Tx(jk,o.shape,u.shape):new I1(Vk,o.shape,u.shape);return n.runWebGLProgram(h,[o,u],o.dtype)}const oG={kernelName:Si,backendName:"webgl",kernelFunc:iG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hk="if (isnan(x)) return x;",sG=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,uG=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`;function hl({opSnippet:r,packedOpSnippet:t,cpuKernelImpl:n,dtype:o}){return({inputs:u,backend:h})=>{const{x:p}=u,g=h,x=o||p.dtype;if(g.shouldExecuteOnCPU([p])&&n!=null){const V=g.texData.get(p.dataId),rt=n(V.values,x);return g.makeTensorInfo(p.shape,x,rt)}const I=Ve().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let z;return I?z=new _1(p.shape,t):z=new zm(p.shape,r),g.runWebGLProgram(z,[p],x)}}function dh({opSnippet:r,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:o=!1,cpuKernelImpl:u,dtype:h}){return({inputs:p,backend:g})=>{const{a:x,b:I}=p,z=g;if(o&&x.dtype==="complex64"){const St=z.texData.get(x.dataId),Tt=z.texData.get(I.dataId),[Vt,ue]=[[St.complexTensorInfos.real,Tt.complexTensorInfos.real],[St.complexTensorInfos.imag,Tt.complexTensorInfos.imag]].map(qe=>{const[$e,Xe]=qe,Pn={dataId:$e.dataId,dtype:$e.dtype,shape:x.shape},In={dataId:Xe.dataId,dtype:Xe.dtype,shape:I.shape},gr=new I1(r,x.shape,I.shape);return z.runWebGLProgram(gr,[Pn,In],so($e.dtype,Xe.dtype))}),ye=$m({inputs:{real:Vt,imag:ue},backend:z});return z.disposeIntermediateTensorInfo(Vt),z.disposeIntermediateTensorInfo(ue),ye}const V=h||so(x.dtype,I.dtype);if(z.shouldExecuteOnCPU([x,I])&&u!=null){const St=z.texData.get(x.dataId),Tt=z.texData.get(I.dataId),[Vt,ue]=u(x.shape,I.shape,St.values,Tt.values,V),ye=z.makeTensorInfo(ue,V),qe=z.texData.get(ye.dataId);return qe.values=Vt,ye}const rt=Ve().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let Et;return rt?Et=new Tx(t,x.shape,I.shape,n):Et=new I1(r,x.shape,I.shape),z.runWebGLProgram(Et,[x,I],V)}}function hS(r,t=!1){if(r==="linear")return t?z6:L6;if(r==="relu")return t?G6:F6;if(r==="elu")return t?$6:P6;if(r==="relu6")return t?U6:B6;if(r==="prelu")return t?jk:Vk;if(r==="leakyrelu")return t?Wk:Uk;throw new Error(`Activation ${r} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xk{constructor(t,n,o,u=!1,h=!1,p=!1,g=null,x=!1,I=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const z=u?t[1]:t[2],V=Math.ceil(z/2),rt=u?"i * 2, rc.y":"rc.y, i * 2",Et=h?"rc.z, i * 2":"i * 2, rc.z",St=u?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],Tt=h?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let Vt="",ue="";g&&(x?Vt=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${g}
        }`:I?Vt=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${g}
        }`:Vt=`vec4 activation(vec4 x) {
          ${g}
        }`,ue="result = activation(result);");const ye=p?"result += getBiasAtOutCoords();":"";p&&this.variableNames.push("bias"),x&&this.variableNames.push("preluActivationWeights"),I&&this.variableNames.push("leakyreluAlpha");let qe="rc.x",$e="rc.x";t[0]<n[0]?qe=`int(min(float(rc.x), ${t[0]-1}.))`:n[0]<t[0]&&($e=`int(min(float(rc.x), ${n[0]-1}.))`),this.userCode=`
      ${Vt}

      const float sharedDimension = ${V}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${V}; i++) {
          int batchA = ${qe};
          int batchB = ${$e};
          vec4 a = getMatrixA(batchA, ${rt});
          vec4 b = getMatrixB(batchB, ${Et});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${St[0]} * ${Tt[0]});
          result += (${St[1]} * ${Tt[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${ye}

        ${ue}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yk={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class Kk{constructor(t,n,o){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Nr(n,o),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zk="return a * b;";function qk(r){const{inputs:t,backend:n}=r,{a:o,b:u}=t,h=so(o.dtype,u.dtype);if(o.dtype==="complex64"){const g=n.texData.get(o.dataId),x=n.texData.get(u.dataId),I=new Kk(Yk.REAL,o.shape,u.shape),z=new Kk(Yk.IMAG,o.shape,u.shape),V=[{dataId:g.complexTensorInfos.real.dataId,dtype:g.complexTensorInfos.real.dtype,shape:o.shape},{dataId:g.complexTensorInfos.imag.dataId,dtype:g.complexTensorInfos.imag.dtype,shape:o.shape},{dataId:x.complexTensorInfos.real.dataId,dtype:x.complexTensorInfos.real.dtype,shape:u.shape},{dataId:x.complexTensorInfos.imag.dataId,dtype:x.complexTensorInfos.imag.dtype,shape:u.shape}],rt=n.runWebGLProgram(I,V,"float32"),Et=n.runWebGLProgram(z,V,"float32"),St=$m({inputs:{real:rt,imag:Et},backend:n});return n.disposeIntermediateTensorInfo(rt),n.disposeIntermediateTensorInfo(Et),St}if(n.shouldExecuteOnCPU([o,u])){const g=n.texData.get(o.dataId),x=n.texData.get(u.dataId),[I,z]=d6(o.shape,u.shape,g.values,x.values,h),V=n.makeTensorInfo(z,h),rt=n.texData.get(V.dataId);return rt.values=I,V}let p;return Ve().getBool("WEBGL_PACK_BINARY_OPERATIONS")?p=new Tx(Zk,o.shape,u.shape):p=new I1(Zk,o.shape,u.shape),n.runWebGLProgram(p,[o,u],h)}const lG={kernelName:ge,backendName:"webgl",kernelFunc:qk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cG(r,t,n){const o=[b1(r.shape),...x1(r.shape)],u={dtype:r.dtype,shape:o,dataId:r.dataId},h=[b1(t),...x1(t)],p=new Pk(h,o),g=!0,x=n.runWebGLProgram(p,[u],r.dtype,null,g);return{dataId:x.dataId,shape:t,dtype:x.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ko(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{shape:h}=o,p=n,g=Rt(u.shape),x=Da(h,g),I=Rt(x);yt(g===I,()=>`The new shape (${x}) has ${I} elements and the old shape (${u.shape}) has ${g} elements. The new shape and old shape must have the same number of elements.`);const z=p.texData.get(u.dataId);return z.isPacked&&!iS(u.shape,x)&&!(z.texture!==null&&iS(z.shape,x))?cG(u,x,p):(p.incRef(u.dataId),{dataId:u.dataId,shape:x,dtype:u.dtype})}const fG={kernelName:ws,backendName:"webgl",kernelFunc:ko};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qk{constructor(t,n){this.variableNames=["x"];const{windowSize:o,batchSize:u,inSize:h,outSize:p}=t;this.outputShape=[u,p];const g=Math.floor(o/4)*4,x=o%4;let I="sumValue += dot(values, ones);";if(n!=null){const V=1/n;I=`sumValue += dot(values * ${xr(V)?V.toPrecision(2):V}, ones);`}let z="";h%o>0&&(z=`
        if (inIdx < 0 || inIdx >= ${h}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${z}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        float sumValue = 0.0;

        for (int i = 0; i < ${g}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${I}
        }

        int inIdx = inOffset + ${g};
        if (${x===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${I}
        } else if (${x===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${I}
        } else if (${x===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${I}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hG{constructor(t,n){this.variableNames=["x"];const{windowSize:o,batchSize:u,inSize:h,outSize:p}=t;this.outputShape=[u,p];let g="0.0",x="";n==="prod"?g="1.0":n==="min"?(g="1.0 / 1e-20",x="min"):n==="max"&&(g="-1.0 / 1e-20",x="max");let I=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?I="sumValue":n==="prod"?I="prodValue":n==="all"?I="allValue":n==="any"&&(I="anyValue");const z=Math.floor(o/4)*4,V=o%4;let rt=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${x}(values, minMaxValue);
      }
    `,Et="vec4";n==="all"?(g="1.0",rt=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,Et="bvec4"):n==="any"&&(g="0.0",rt=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,Et="bvec4");let St="";h%o>0&&(St=`
        if (inIdx < 0 || inIdx >= ${h}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${g};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${St}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        vec4 minMaxValue = vec4(${g});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${z}; i += 4) {
          int inIdx = inOffset + i;
          ${Et} values = ${Et}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${rt}
        }

        int inIdx = inOffset + ${z};
        if (${V===1}) {
          ${Et} values = ${Et}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${rt}
        } else if (${V===2}) {
          ${Et} values = ${Et}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${rt}
        } else if (${V===3}) {
          ${Et} values = ${Et}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${rt}
        }
        setOutput(${I});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dG(r){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const n=t.length?t[t.length-1].outSize:r[1],o=Ap(n);t.push({inSize:n,windowSize:o,outSize:Math.ceil(n/o)})}return t}function j0(r,t,n,o){const u=dG(r.shape);let h=r;for(let p=0;p<u.length;p++){const{inSize:g,windowSize:x,outSize:I}=u[p];let z,V;n==="mean"?z=p===0?new Qk({windowSize:x,inSize:g,batchSize:r.shape[0],outSize:I},g):new Qk({windowSize:x,inSize:g,batchSize:r.shape[0],outSize:I}):z=new hG({windowSize:x,inSize:g,batchSize:r.shape[0],outSize:I},n),V=h,h=o.runWebGLProgram(z,[h],t),V.dataId!==r.dataId&&o.disposeIntermediateTensorInfo(V)}return h}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pG{constructor(t,n){this.variableNames=["A"];const o=new Array(t.length);for(let p=0;p<o.length;p++)o[p]=t[n[p]];this.outputShape=o,this.rank=o.length;const u=ac(this.rank),h=vG(n);this.userCode=`
    void main() {
      ${u} resRC = getOutputCoords();
      setOutput(getA(${h}));
    }
    `}}function vG(r){const t=r.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],o=new Array(t);for(let u=0;u<r.length;u++)o[r[u]]=n[u];return o.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gG{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const o=new Array(t.length);for(let z=0;z<o.length;z++)o[z]=t[n[z]];if(this.outputShape=o,this.rank=o.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const u=ac(this.rank),h=Lk("rc",this.rank),p=new Array(this.rank);for(let z=0;z<n.length;z++)p[n[z]]=h[z];const g=`vec2(${p.slice(-2).join()})`,x=`++${h[this.rank-1]} < ${o[this.rank-1]}`,I=`getChannel(getA(${p.join()}), ${g})`;this.userCode=`
    void main() {
      ${u} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${I};
      if(${x}) {
        result[1] = ${I};
      }
      --${h[this.rank-1]};
      if(++${h[this.rank-2]} < ${o[this.rank-2]}) {
        result[2] = ${I};
        if(${x}) {
          result[3] = ${I};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dS(r,t,n){const o=Ve().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new gG(r.shape,t):new pG(r.shape,t);return n.runWebGLProgram(o,[r],r.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mG(r,t,n,o){const u=t,h=r.shape.length,p=Rr(u,r.shape);let g=p;const x=$c(g,h),I=x!=null;let z=r;I&&(z=dS(r,x,o),g=gc(g.length,h)),Pf("sum",g,h);const[V,rt]=yf(z.shape,g);let Et=V;n&&(Et=zc(V,p));const St=Rt(rt),Vt=Rt(r.shape)/St,ue=ko({inputs:{x:z},attrs:{shape:[Vt,St]},backend:o}),ye=jo(r.dtype),qe=j0(ue,ye,"sum",o),$e=ko({inputs:{x:qe},attrs:{shape:Et},backend:o});return o.disposeIntermediateTensorInfo(ue),o.disposeIntermediateTensorInfo(qe),I&&o.disposeIntermediateTensorInfo(z),$e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hA(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;return mG(u,h,p,n)}const yG={kernelName:rn,backendName:"webgl",kernelFunc:hA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nd(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{perm:h}=o,p=n,g=u.shape.length,x=new Array(g);for(let z=0;z<x.length;z++)x[z]=u.shape[h[z]];let I;if(p.shouldExecuteOnCPU([u])){const V=p.texData.get(u.dataId).values,rt=fA(V,u.shape,u.dtype,h,x);I=p.makeTensorInfo(x,u.dtype);const Et=p.texData.get(I.dataId);Et.values=rt}else I=dS(u,h,p);return I}const bG={kernelName:Lo,backendName:"webgl",kernelFunc:Nd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jk=1e3;function pS({a:r,b:t,transposeA:n,transposeB:o,backend:u,bias:h=null,preluActivationWeights:p=null,leakyreluAlpha:g=0,activation:x=null}){const I=r.shape.length,z=t.shape.length,V=n?r.shape[I-2]:r.shape[I-1],rt=o?t.shape[z-1]:t.shape[z-2],Et=n?r.shape[I-1]:r.shape[I-2],St=o?t.shape[z-2]:t.shape[z-1],Tt=r.shape.slice(0,-2),Vt=t.shape.slice(0,-2),ue=Rt(Tt),ye=Rt(Vt),qe=ue===ye||ue===1||ye===1;yt(I>=2&&z>=2&&qe,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${Tt}) and (${Vt}).`);const Xe=(ue>ye?r.shape.slice(0,-2):t.shape.slice(0,-2)).concat([Et,St]);yt(V===rt,()=>`Error in matMul: inner shapes (${V}) and (${rt}) of Tensors with shapes ${r.shape} and ${t.shape} and transposeA=${n} and transposeB=${o} must match.`);const Pn=n?[ue,V,Et]:[ue,Et,V],In=o?[ye,St,rt]:[ye,rt,St],gr=ko({inputs:{x:r},backend:u,attrs:{shape:Pn}}),Br=ko({inputs:{x:t},backend:u,attrs:{shape:In}}),Kr=[gr,Br],Na=Math.max(ue,ye),Ya=n?gr.shape[1]:gr.shape[2],Ha=h!=null,ni=p!=null,Wa=x==="leakyrelu",za=x!=null?hS(x,!0):null,mi=Ha||ni||Wa||za!=null;let qa;if((Et===1||St===1)&&Ya>Jk&&mi===!1){let Fi=gr,Bi=Br;n&&(Fi=Nd({inputs:{x:gr},backend:u,attrs:{perm:[0,2,1]}}),Kr.push(Fi)),o&&(Bi=Nd({inputs:{x:Br},backend:u,attrs:{perm:[0,2,1]}}),Kr.push(Bi));const Ji=St!==1,no=St===1;let io=Fi;Ji&&(io=ko({inputs:{x:Fi},backend:u,attrs:{shape:[Na,Ya,1]}}),Kr.push(io));const yo=St===1?2:1;let lo=Bi;no&&(lo=ko({inputs:{x:Bi},backend:u,attrs:{shape:[Na,1,Ya]}}),Kr.push(lo));const Zo=qk({inputs:{a:io,b:lo},backend:u});qa=hA({inputs:{x:Zo},backend:u,attrs:{axis:yo,keepDims:!0}}),Kr.push(Zo)}else{const Fi=so(r.dtype,t.dtype),Bi=new Xk(Pn,In,[Na,Et,St],n,o,Ha,za,ni,Wa),Ji=[gr,Br];if(h!=null&&Ji.push(h),ni&&Ji.push(p),Wa){const no=u.makeTensorInfo([],"float32",rf(g,"float32"));Ji.push(no),Kr.push(no)}qa=u.runWebGLProgram(Bi,Ji,Fi)}const yi=ko({inputs:{x:qa},backend:u,attrs:{shape:Xe}});Kr.push(qa);for(const Fi of Kr)u.disposeIntermediateTensorInfo(Fi);return yi}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(r){const{inputs:t,backend:n,attrs:o}=r,{a:u,b:h,bias:p,preluActivationWeights:g}=t,{transposeA:x,transposeB:I,activation:z,leakyreluAlpha:V}=o;return pS({a:u,b:h,transposeA:x,transposeB:I,backend:n,bias:p,preluActivationWeights:g,leakyreluAlpha:V,activation:z})}const wG={kernelName:Wu,backendName:"webgl",kernelFunc:xG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tD="return abs(x);";function EG(r){const{inputs:t,backend:n}=r,{x:o}=t;if(n.shouldExecuteOnCPU([o])&&o.dtype!=="complex64"){const h=n.texData.get(o.dataId),p=Rk(h.values);return n.makeTensorInfo(o.shape,o.dtype,p)}let u;return Ve().getBool("WEBGL_PACK_UNARY_OPERATIONS")?u=new _1(o.shape,tD):u=new zm(o.shape,tD),n.runWebGLProgram(u,[o],o.dtype)}const SG={kernelName:La,backendName:"webgl",kernelFunc:EG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CG=Ev+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,_G=hl({opSnippet:CG}),IG={kernelName:ha,backendName:"webgl",kernelFunc:_G};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TG=Ev+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,AG=hl({opSnippet:TG}),MG={kernelName:_i,backendName:"webgl",kernelFunc:AG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eD="return a + b;",NG=dh({opSnippet:eD,packedOpSnippet:eD,supportsComplex:!0,cpuKernelImpl:Q5}),kG={kernelName:Ni,backendName:"webgl",kernelFunc:NG};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DG{constructor(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map((h,p)=>`T${p}`);const o=[];this.variableNames.forEach(h=>{o.push(`float v${h} = get${h}AtOutCoords();`)});const u=this.variableNames.map(h=>`v${h}`).join(" + ");this.userCode=`
      void main() {
        ${o.join(`
        `)}

        float result = ${u};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OG{constructor(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((h,p)=>`T${p}`);const o=[];this.variableNames.forEach(h=>{o.push(`vec4 v${h} = get${h}AtOutCoords();`)});const u=this.variableNames.map(h=>`v${h}`).join(" + ");this.userCode=`
      void main() {
        ${o.join(`
        `)}

        vec4 result = ${u};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vS(r){const{inputs:t,backend:n}=r,o=t;if(o.length===1)return dp({inputs:{x:o[0]},backend:n});if(o.length>Ve().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const x=Math.floor(o.length/2),I=vS({inputs:o.slice(0,x),backend:n}),z=vS({inputs:o.slice(x),backend:n});return vS({inputs:[I,z],backend:n})}const u=o.map(x=>x.dtype).reduce((x,I)=>so(x,I)),h=o.map(x=>x.shape),g=Ve().getBool("WEBGL_PACK")?new OG(o[0].shape,h):new DG(o[0].shape,h);return n.runWebGLProgram(g,o,u)}const RG={kernelName:vi,backendName:"webgl",kernelFunc:vS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LG(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o,g=u.shape.length,x=Rr(h,u.shape);let I=x;const z=$c(I,g);let V=u;z!=null&&(V=Nd({inputs:{x:u},backend:n,attrs:{perm:z}}),I=gc(I.length,g)),Pf("all",I,g);const[rt,Et]=yf(V.shape,I),St=Rt(Et),Tt=ko({inputs:{x:V},backend:n,attrs:{shape:[-1,St]}}),Vt=j0(Tt,Tt.dtype,"all",n);let ue;if(p){const ye=zc(rt,x);ue=ko({inputs:{x:Vt},backend:n,attrs:{shape:ye}})}else ue=ko({inputs:{x:Vt},backend:n,attrs:{shape:rt}});return n.disposeIntermediateTensorInfo(Tt),n.disposeIntermediateTensorInfo(Vt),z!=null&&n.disposeIntermediateTensorInfo(V),ue}const PG={kernelName:si,backendName:"webgl",kernelFunc:LG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FG(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o,g=u.shape.length,x=Rr(h,u.shape);let I=x;const z=$c(I,g);let V=u;z!=null&&(V=Nd({inputs:{x:u},backend:n,attrs:{perm:z}}),I=gc(I.length,g)),Pf("any",I,g);const[rt,Et]=yf(V.shape,I),St=Rt(Et),Tt=ko({inputs:{x:V},backend:n,attrs:{shape:[-1,St]}}),Vt=j0(Tt,Tt.dtype,"any",n);let ue;if(p){const ye=zc(rt,x);ue=ko({inputs:{x:Vt},backend:n,attrs:{shape:ye}})}else ue=ko({inputs:{x:Vt},backend:n,attrs:{shape:rt}});return n.disposeIntermediateTensorInfo(Tt),n.disposeIntermediateTensorInfo(Vt),z!=null&&n.disposeIntermediateTensorInfo(V),ue}const BG={kernelName:Mi,backendName:"webgl",kernelFunc:FG};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zG{constructor(t,n,o){this.variableNames=["A"];const{windowSize:u,batchSize:h,outSize:p}=t;o||this.variableNames.push("bestIndicesA"),this.outputShape=[h,p];const g=n==="max"?">":"<",x=o?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${u};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${u}; i++) {
          int inIdx = ${x};
          float candidate = getA(batch, inIdx);
          if (candidate ${g} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $G{constructor(t,n,o,u){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,yt(t.length>2,()=>`Packed arg${o.charAt(0).toUpperCase()+o.slice(1)} supports only inputs with rank above 2.`);const h=t[t.length-1],p=Math.ceil(h/n);this.outputShape=t.slice(0,-1),p>1&&this.outputShape.push(p),u||this.variableNames.push("bestIndicesA");const g=this.outputShape,x=g.length,I=ac(x),z=od("coords",x);let V,rt;if(p===1){rt=x+1;const gr=ac(rt);V=`
        ${gr} sourceLocR = ${gr}(${z.join()}, 0);
        ++${z[x-1]};
        ${gr} sourceLocG = ${gr}(${z.join()}, 0);
        ++${z[x-2]};
        ${gr} sourceLocA = ${gr}(${z.join()}, 0);
        --${z[x-1]};
        ${gr} sourceLocB = ${gr}(${z.join()}, 0);
        --${z[x-2]};`}else rt=x,V=`
        ${I} sourceLocR = coords;
        ++${z[x-1]};
        ${I} sourceLocG = coords;
        ++${z[x-2]};
        ${I} sourceLocA = coords;
        --${z[x-1]};
        ${I} sourceLocB = coords;
        --${z[x-2]};`;const Et=["x","y","z","w","u","v"].slice(0,rt),St="."+Et[rt-1],Tt=Et.map(gr=>"int "+gr),Vt=od("sourceLocR",rt-1).concat("inIdx.r"),ue=od("sourceLocG",rt-1).concat("inIdx.g"),ye=od("sourceLocB",rt-1).concat("inIdx.b"),qe=od("sourceLocA",rt-1).concat("inIdx.a"),$e=o==="max"?"greaterThan":"lessThan",Xe=u?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${Vt.join()}),
                             getBestIndicesAChannel(${ue.join()}),
                             getBestIndicesAChannel(${ye.join()}),
                             getBestIndicesAChannel(${qe.join()})));`,Pn=`vec4(
            getAChannel(${Vt.join()}),
            hasNextCol ? getAChannel(${ue.join()}) : 0.,
            hasNextRow ? getAChannel(${ye.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${qe.join()}) : 0.)`,In=u?"":`
      float getBestIndicesAChannel(${Tt.join()}) {
        return getChannel(getBestIndicesA(${Et.join()}),
                                          vec2(${Et.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${Tt.join()}) {
        return getChannel(getA(${Et.join()}),
                               vec2(${Et.slice(-2).join()}));
      }
      ${In}
      void main() {
        ${I} coords = getOutputCoords();
        bool hasNextCol = ${z[x-1]} < ${g[x-1]-1};
        bool hasNextRow = ${z[x-2]} < ${g[x-2]-1};
        ${V}
        ivec4 srcIdx = ivec4(sourceLocR${St}, sourceLocG${St},
          sourceLocB${St}, sourceLocA${St}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${Pn};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${Xe}
          vec4 candidate = ${Pn};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${$e}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nD(r,t,n,o=null){let u=t.shape[0],h=t.shape[1];o!=null&&(u=o.shape[0],h=o.shape[1]);const p=Ap(h),g={windowSize:p,inSize:h,batchSize:u,outSize:Math.ceil(h/p)},x=new zG(g,n,o==null),I=[t];o!=null&&I.push(o);const z=r.runWebGLProgram(x,I,"int32");if(z.shape[1]===1)return z;const V=nD(r,t,n,z);return r.disposeIntermediateTensorInfo(z),V}function rD(r,t,n,o=null){const u=o!=null?o.shape:t.shape,h=u[u.length-1],p=Ap(h),g=new $G(u,p,n,o==null),x=o==null?[t]:[t,o],I=r.runWebGLProgram(g,x,"int32");if(I.shape.length===t.shape.length){const z=rD(r,t,n,I);return r.disposeIntermediateTensorInfo(I),z}return I}function aD(r,t,n,o){const u=[n];if(Pf("arg"+o.charAt(0).toUpperCase()+o.slice(1),u,t.shape.length),!Ve().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const h=[],[p,g]=yf(t.shape,u),x=Rt(g),I=ko({inputs:{x:t},backend:r,attrs:{shape:[-1,x]}});h.push(I);const z=nD(r,I,o);h.push(z);const V=ko({inputs:{x:z},backend:r,attrs:{shape:p}});return h.forEach(rt=>r.disposeIntermediateTensorInfo(rt)),V}return rD(r,t,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h}=o;let p=Rr(h,u.shape);const g=$c(p,u.shape.length);let x=u;const I=[];g!=null&&(x=Nd({inputs:{x:u},backend:n,attrs:{perm:g}}),I.push(x),p=gc(p.length,x.shape.length)),Pf("argMax",[p[0]],x.shape.length);const z=aD(n,x,p[0],"max");return I.forEach(V=>n.disposeIntermediateTensorInfo(V)),z}const UG={kernelName:Pa,backendName:"webgl",kernelFunc:GG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WG(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h}=o;let p=Rr(h,u.shape);const g=$c(p,u.shape.length);let x=u;const I=[];g!=null&&(x=Nd({inputs:{x:u},backend:n,attrs:{perm:g}}),I.push(x),p=gc(p.length,x.shape.length)),Pf("argMin",[p[0]],x.shape.length);const z=aD(n,x,p[0],"min");return I.forEach(V=>n.disposeIntermediateTensorInfo(V)),z}const VG={kernelName:un,backendName:"webgl",kernelFunc:WG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jG=Ev+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,HG=hl({opSnippet:jG}),XG={kernelName:Oe,backendName:"webgl",kernelFunc:HG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YG=Ev+"return log(x + sqrt(x * x + 1.0));",KG=hl({opSnippet:YG}),ZG={kernelName:hn,backendName:"webgl",kernelFunc:KG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qG=Ev+`
  return atan(x);
`,QG=hl({opSnippet:qG}),JG={kernelName:Hn,backendName:"webgl",kernelFunc:QG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t8=sG+`
  return atan(a, b);
`,e8=`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+uG+`
  return result;
`,n8=dh({opSnippet:t8,packedOpSnippet:e8}),r8={kernelName:Jn,backendName:"webgl",kernelFunc:n8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a8=Ev+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,i8=hl({opSnippet:a8}),o8={kernelName:Bn,backendName:"webgl",kernelFunc:i8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ax{constructor(t,n,o,u=!1,h=!1){if(this.variableNames=["x"],n==="avg"&&o)throw new Error("Cannot compute positions for average pool.");const p=t.filterWidth,g=t.strideHeight,x=t.strideWidth,I=t.dilationHeight,z=t.dilationWidth,V=t.effectiveFilterHeight,rt=t.effectiveFilterWidth,Et=t.padInfo.top,St=t.padInfo.left;this.outputShape=t.outShape;const Tt=n==="avg",Vt=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,ue=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let ye="0.0";if(Tt||(ye="-1.0 / 1e-20"),o){const gr=">=";this.userCode=`
        const ivec2 strides = ivec2(${g}, ${x});
        const ivec2 pads = ivec2(${Et}, ${St});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${V};
              wR += ${I}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${rt};
                wC += ${z}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${gr} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${u?h?Vt:ue:`wR * ${rt} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const qe="max";let $e=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&($e="avgValue / count");const Xe=Math.floor(p/4)*4,Pn=p%4,In=`
      if (${Tt}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${qe}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${g}, ${x});
      const ivec2 pads = ivec2(${Et}, ${St});
      const float initializationValue = ${ye};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${ye});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${V};
            wR += ${I}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${Xe}; wC += 4) {
            int xC = xCCorner + wC * ${z};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${z}, d),
              getValue(batch, xR, xC + 2 * ${z}, d),
              getValue(batch, xR, xC + 3 * ${z}, d)
            );

            ${In}
          }

          int xC = xCCorner + ${Xe};
          if (${Pn===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${In}
          } else if (${Pn===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${z}, d),
              initializationValue,
              initializationValue
            );

            ${In}
          } else if (${Pn===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${z}, d),
              getValue(batch, xR, xC + 2 * ${z}, d),
              initializationValue
            );

            ${In}
          }
        }
        setOutput(${$e});
      }
    `}}class dA{constructor(t,n,o,u=!1,h=!1){if(this.variableNames=["x"],n==="avg"&&o)throw new Error("Cannot compute positions for average pool.");const p=t.filterWidth,g=t.strideDepth,x=t.strideHeight,I=t.strideWidth,z=t.dilationDepth,V=t.dilationHeight,rt=t.dilationWidth,Et=t.effectiveFilterDepth,St=t.effectiveFilterHeight,Tt=t.effectiveFilterWidth,Vt=t.padInfo.front,ue=t.padInfo.top,ye=t.padInfo.left;this.outputShape=t.outShape;const qe=n==="avg";let $e="0.0";if(qe||($e="-1.0 / 1e-20"),o){const Kr=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${g}, ${x}, ${I});
        const ivec3 pads = ivec3(${Vt}, ${ue}, ${ye});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${Et};
              wD += ${z}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${St};
                wR += ${V}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${Tt};
                  wC += ${rt}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${Kr} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${u?h?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${St} * ${Tt} +
                      wR * ${Tt} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const Xe="max";let Pn=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(Pn="avgValue / count");const In=Math.floor(p/4)*4,gr=p%4,Br=`
      if (${qe}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${Xe}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${g}, ${x}, ${I});
      const ivec3 pads = ivec3(${Vt}, ${ue}, ${ye});
      const float initializationValue = ${$e};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${$e});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${Et};
            wD += ${z}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${St};
            wR += ${V}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${In}; wC += 4) {
              int xC = xCCorner + wC * ${rt};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${rt}, ch),
                getValue(batch, xD, xR, xC + 2 * ${rt}, ch),
                getValue(batch, xD, xR, xC + 3 * ${rt}, ch)
              );

              ${Br}
            }

            int xC = xCCorner + ${In};
            if (${gr===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${Br}
            } else if (${gr===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${rt}, ch),
                initializationValue,
                initializationValue
              );

              ${Br}
            } else if (${gr===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${rt}, ch),
                getValue(batch, xD, xR, xC + 2 * ${rt}, ch),
                initializationValue
              );

              ${Br}
            }
          }
          setOutput(${Pn});
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s8(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t;_x(u,"avgPool");const{filterSize:h,strides:p,pad:g,dimRoundingMode:x}=o,I=1;yt(_c(p,I),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${p} and dilations '${I}'`);const z=Rf(u.shape,h,p,I,g,x);if(z.filterWidth===1&&z.filterHeight===1&&Un(z.inShape,z.outShape))return dp({inputs:{x:u},backend:n});const V=new Ax(z,"avg",!1);return n.runWebGLProgram(V,[u],"float32")}const u8={kernelName:Lr,backendName:"webgl",kernelFunc:s8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l8(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{filterSize:h,strides:p,pad:g,dimRoundingMode:x,dataFormat:I}=o,z=[1,1,1],V=bd(u.shape,h,p,z,g,x,I),rt=new dA(V,"avg",!1);return n.runWebGLProgram(rt,[u],"float32")}const c8={kernelName:Fa,backendName:"webgl",kernelFunc:l8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f8{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterHeight,o=t.filterWidth,u=t.strideHeight,h=t.strideWidth,p=t.dilationHeight,g=t.dilationWidth,x=t.effectiveFilterHeight,I=t.effectiveFilterWidth,z=x-1-t.padInfo.top,V=I-1-t.padInfo.left,rt=1/(n*o);this.userCode=`
      const ivec2 pads = ivec2(${z}, ${V});
      const float avgMultiplier = float(${rt});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${x};
            wR += ${p}) {
          float dyR = float(dyRCorner + wR) / ${u}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${I};
            wC+= ${g}) {
            float dyC = float(dyCCorner + wC) / ${h}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class h8{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterDepth,o=t.filterHeight,u=t.filterWidth,h=t.strideDepth,p=t.strideHeight,g=t.strideWidth,x=t.dilationDepth,I=t.dilationHeight,z=t.dilationWidth,V=t.effectiveFilterDepth,rt=t.effectiveFilterHeight,Et=t.effectiveFilterWidth,St=V-1-t.padInfo.front,Tt=rt-1-t.padInfo.top,Vt=Et-1-t.padInfo.left,ue=1/(n*o*u);this.userCode=`
      const ivec3 pads = ivec3(${St}, ${Tt}, ${Vt});
      const float avgMultiplier = float(${ue});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${V};
            wD += ${x}) {
          float dyD = float(dyDCorner + wD) / ${h}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${rt};
              wR += ${I}) {
            float dyR = float(dyRCorner + wR) / ${p}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${Et};
                wC += ${z}) {
              float dyC = float(dyCCorner + wC) / ${g}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,p=h,{filterSize:g,strides:x,pad:I,dimRoundingMode:z}=o,V=[1,1,1],rt=bd(p.shape,g,x,V,I,z),Et=new h8(rt);return n.runWebGLProgram(Et,[u],p.dtype)}const p8={kernelName:ui,backendName:"webgl",kernelFunc:d8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v8(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,p=h;_x([u,h],"avgPoolGrad");const{filterSize:g,strides:x,pad:I}=o,z=Rf(p.shape,g,x,1,I),V=new f8(z);return n.runWebGLProgram(V,[u],p.dtype)}const g8={kernelName:ya,backendName:"webgl",kernelFunc:v8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(r){const{inputs:t,backend:n,attrs:o}=r,{a:u,b:h}=t,{transposeA:p,transposeB:g}=o;return pS({a:u,b:h,transposeA:p,transposeB:g,backend:n})}const y8={kernelName:Ei,backendName:"webgl",kernelFunc:m8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b8{constructor(t,n,o,u,h,p){this.outputShape=[],this.variableNames=["x","mean","variance"],Nr(t,n),Nr(t,o);let g="0.0";u!=null&&(Nr(t,u),this.variableNames.push("offset"),g="getOffsetAtOutCoords()");let x="1.0";h!=null&&(Nr(t,h),this.variableNames.push("scale"),x="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${g};
        float scale = ${x};
        float inv = scale * inversesqrt(variance + float(${p}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x8{constructor(t,n,o,u,h,p){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Nr(t,n),Nr(t,o);let g="vec4(0.0)";u!=null&&(Nr(t,u),this.variableNames.push("offset"),g="getOffsetAtOutCoords()");let x="vec4(1.0)";h!=null&&(Nr(t,h),this.variableNames.push("scale"),x="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${g};
        vec4 scale = ${x};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${p}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w8={kernelName:xo,backendName:"webgl",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:o,mean:u,variance:h,offset:p,scale:g}=r;yt(u.shape.length===h.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),yt(p==null||u.shape.length===p.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),yt(g==null||u.shape.length===g.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:x}=n;x==null&&(x=.001);const I=[o,u,h];let z=null;p!=null&&(z=p.shape,I.push(p));let V=null;g!=null&&(V=g.shape,I.push(g));const rt=Ve().getBool("WEBGL_PACK_NORMALIZATION")?new x8(o.shape,u.shape,h.shape,z,V,x):new b8(o.shape,u.shape,h.shape,z,V,x);return t.runWebGLProgram(rt,I,I[0].dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E8{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const n=ac(this.rank),o=`uniform int start[${this.rank}];`,u=S8(this.rank);let h;const p=t.map((g,x)=>`sourceLoc.${pA[x]} = start[${x}] + coords.${pA[x]};`);h=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${p.join(`
`)}
      `,this.userCode=`
      ${o}
      void main() {
        ${h}
        setOutput(getSource(${u}));
      }
    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(n,o)=>{this.startLoc==null&&(this.startLoc=n.getUniformLocationNoThrow(o,"start"),this.startLoc==null)||n.gl.uniform1iv(this.startLoc,t)}}}const pA=["x","y","z","w","u","v"];function S8(r){if(r===1)return"sourceLoc";if(r<=6)return pA.slice(0,r).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${r} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C8{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;const n=ac(this.rank),o=od("coords",this.rank),u=od("sourceLoc",this.rank),h=this.rank===1?"sourceLoc":`vec2(${u.slice(-2).join()})`,p=`getChannel(getSource(${u.join()}), ${h})`,g=`
      result.x = ${p};
      if (++${o[this.rank-1]} < ${t[this.rank-1]}) {
        ++${u[this.rank-1]};
        result.y = ${p};
        --${u[this.rank-1]};
      }
    `,x=this.rank===1?"":`
      --${o[this.rank-1]};
      if (++${o[this.rank-2]} < ${t[this.rank-2]}) {
        ++${u[this.rank-2]};
        result.z = ${p};
        if (++${o[this.rank-1]} < ${t[this.rank-1]}) {
          ++${u[this.rank-1]};
          result.w = ${p};
        }
      }
    `,I=this.rank<=4?`sourceLoc = coords +
            ${n}(${t.map((z,V)=>`start[${V}]`).join()});`:t.map((z,V)=>`${u[V]} = ${o[V]} + start[${V}];`).join(`
`);this.userCode=`
      uniform int start[${this.rank}];
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${I}
        vec4 result = vec4(0.);
        ${g}
        ${x}
        setOutput(result);
      }
    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(n,o)=>{this.startLoc==null&&(this.startLoc=n.getUniformLocationNoThrow(o,"start"),this.startLoc==null)||n.gl.uniform1iv(this.startLoc,t)}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _8(r,t,n,o){const u=o.texData.get(r.dataId),h=o.makeTensorInfo(n,r.dtype),p=o.texData.get(h.dataId);Object.assign(p,u),p.complexParentRefCount=0,p.refCount=1,p.shape=n,p.dtype=r.dtype;let g=ev(t,vt(r.shape));u.slice&&(g+=u.slice.flatOffset),p.slice={flatOffset:g,origDataId:u.slice&&u.slice.origDataId||r.dataId};const x=o.dataRefCount.get(p.slice.origDataId)||1;return o.dataRefCount.set(p.slice.origDataId,x+1),h}function Mx(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{begin:h,size:p}=o,[g,x]=Zd(u,h,p);if(gd(u,g,x),Rt(x)===0)return n.makeTensorInfo(x,u.dtype,[]);if(n.shouldExecuteOnCPU([u])||u.dtype==="string"){const V=n.texData.get(u.dataId),rt=y6(V.values,g,x,u.shape,u.dtype);return n.makeTensorInfo(x,u.dtype,rt)}const{isPacked:I}=n.texData.get(u.dataId),z=Dv(u.shape,g,x);if(I||!z){const V=Ve().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new C8(x):new E8(x),rt=V.getCustomSetupFunc(g);return n.runWebGLProgram(V,[u],u.dtype,rt)}return n.uploadToGPU(u.dataId),_8(u,g,x,n)}const I8={kernelName:ef,backendName:"webgl",kernelFunc:Mx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T8={kernelName:oo,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockShape:h,crops:p}=o;yt(u.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const g=h.reduce((ye,qe)=>ye*qe),x=E0(u.shape,h,g),I=Im(x.length,h.length),z=Hv(u.shape,h,g),V=yb(p,h.length),rt=bb(z,p,h.length),Et=[],St=ko({inputs:{x:u},backend:n,attrs:{shape:x}}),Tt=Nd({inputs:{x:St},backend:n,attrs:{perm:I}}),Vt=ko({inputs:{x:Tt},backend:n,attrs:{shape:z}}),ue=Mx({inputs:{x:Vt},backend:n,attrs:{begin:V,size:rt}});return Et.push(St),Et.push(Tt),Et.push(Vt),Et.forEach(ye=>n.disposeIntermediateTensorInfo(ye)),ue}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A8(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,weights:h}=t,{size:p}=o,g=n.readSync(u.dataId),x=n.readSync(h.dataId),I=Ok(g,x,h.dtype,h.shape,p);return n.makeTensorInfo([p],h.dtype,I)}const M8={kernelName:po,backendName:"webgl",kernelFunc:A8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iD=dh({opSnippet:"return float(a != b);",dtype:"bool"}),N8={kernelName:sn,backendName:"webgl",kernelFunc:iD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nx(r){const{inputs:t,backend:n}=r,{input:o}=t,u=n.texData.get(o.dataId);return dp({inputs:{x:u.complexTensorInfos.real},backend:n})}const k8={kernelName:wo,backendName:"webgl",kernelFunc:Nx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D8="return float(int(x));";function O8(r,t){const n=new zm(r.shape,D8),o=t.runWebGLProgram(n,[r],"int32");return{dataId:o.dataId,shape:o.shape,dtype:o.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vA(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{dtype:h}=o;if(h==="complex64"){if(u.dtype==="complex64")return dp({inputs:{x:u},backend:n});const p=Tc(u.shape),g=vA({inputs:{x:u},backend:n,attrs:{dtype:"float32"}}),x=$m({inputs:{real:g,imag:p},backend:n});return p.dispose(),n.disposeIntermediateTensorInfo(g),x}if(u.dtype==="complex64"){const p=Nx({inputs:{input:u},backend:n}),g=vA({inputs:{x:p},backend:n,attrs:{dtype:h}});return n.disposeIntermediateTensorInfo(p),g}if(!jr(u.dtype,h)){const p=dp({inputs:{x:u},backend:n});return{dataId:p.dataId,shape:p.shape,dtype:h}}if(h==="int32")return O8(u,n);if(h==="bool"){const p=n.makeTensorInfo([],"bool",ar("bool",1)),x=iD({inputs:{a:u,b:p},backend:n});return n.disposeIntermediateTensorInfo(p),x}throw new Error(`Error in Cast: failed to cast ${u.dtype} to ${h}`)}const R8={kernelName:ts,backendName:"webgl",kernelFunc:vA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oD="return ceil(x);",L8=hl({opSnippet:oD,packedOpSnippet:oD,cpuKernelImpl:t6}),P8={kernelName:Wo,backendName:"webgl",kernelFunc:L8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F8{constructor(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}getCustomSetupFunc(t,n){return(o,u)=>{this.minLoc==null&&(this.minLoc=o.getUniformLocationNoThrow(u,"minVal"),this.maxLoc=o.getUniformLocationNoThrow(u,"maxVal")),o.gl.uniform1f(this.minLoc,t),o.gl.uniform1f(this.maxLoc,n)}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B8{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}getCustomSetupFunc(t,n){return(o,u)=>{this.minLoc==null&&(this.minLoc=o.getUniformLocationNoThrow(u,"minVal"),this.maxLoc=o.getUniformLocationNoThrow(u,"maxVal")),o.gl.uniform1f(this.minLoc,t),o.gl.uniform1f(this.maxLoc,n)}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z8(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{clipValueMin:h,clipValueMax:p}=o;let g;Ve().getBool("WEBGL_PACK_CLIP")?g=new B8(u.shape):g=new F8(u.shape);const x=g.getCustomSetupFunc(h,p);return n.runWebGLProgram(g,[u],u.dtype,x)}const $8={kernelName:Yi,backendName:"webgl",kernelFunc:z8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G8{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sD(r,t){return{dataId:t.dataId,dtype:t.dtype,shape:r.shape}}function U8(r){const{inputs:t,backend:n}=r,{x:o}=t,u=n.texData.get(o.dataId),h=new G8(o.shape),p=[sD(o,u.complexTensorInfos.real),sD(o,u.complexTensorInfos.imag)];return n.runWebGLProgram(h,p,p[0].dtype)}const W8={kernelName:gi,backendName:"webgl",kernelFunc:U8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V8{constructor(t){this.outputShape=[],this.outputShape=jv(t,1),this.variableNames=t.map((p,g)=>`T${g}`);const n=new Array(t.length-1);n[0]=t[0][1];for(let p=1;p<n.length;p++)n[p]=n[p-1]+t[p][1];const o=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let p=1;p<n.length;p++){const g=n[p-1];o.push(`else if (yC < ${n[p]}) setOutput(getT${p}(yR, yC-${g}));`)}const u=n.length,h=n[n.length-1];o.push(`else setOutput(getT${u}(yR, yC-${h}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${o.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j8{constructor(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=jv(t,n);const o=this.outputShape,u=o.length,h=ac(u),p=od("coords",u),g=["x","y","z","w","u","v"].slice(0,u);this.variableNames=t.map((Tt,Vt)=>`T${Vt}`);const x=new Array(t.length-1);x[0]=t[0][n];for(let Tt=1;Tt<x.length;Tt++)x[Tt]=x[Tt-1]+t[Tt][n];const I=g[n],z=g.slice(-2),V=g.join();let rt=`if (${I} < ${x[0]}) {
        return getChannel(
            getT0(${V}), vec2(${z.join()}));
        }`;for(let Tt=1;Tt<x.length;Tt++){const Vt=x[Tt-1];rt+=`
        if (${I} < ${x[Tt]}  && ${I} >= ${x[Tt-1]}) {
          return getChannel(
            getT${Tt}(${gS(g,I,Vt)}),
            vec2(${gS(z,I,Vt)}));
        }`}const Et=x.length,St=x[x.length-1];rt+=`
        return getChannel(
          getT${Et}(${gS(g,I,St)}),
          vec2(${gS(z,I,St)}));`,this.userCode=`
      float getValue(${g.map(Tt=>"int "+Tt)}) {
        ${rt}
      }

      void main() {
        ${h} coords = getOutputCoords();
        vec4 result = vec4(getValue(${p}), 0., 0., 0.);

        ${p[u-1]} = ${p[u-1]} + 1;
        if (${p[u-1]} < ${o[u-1]}) {
          result.g = getValue(${p});
        }

        ${p[u-2]} = ${p[u-2]} + 1;
        if (${p[u-2]} < ${o[u-2]}) {
          result.a = getValue(${p});
        }

        ${p[u-1]} = ${p[u-1]} - 1;
        if (${p[u-2]} < ${o[u-2]} &&
            ${p[u-1]} < ${o[u-1]}) {
          result.b = getValue(${p});
        }
        setOutput(result);
      }
    `}}function gS(r,t,n){const o=r.indexOf(t);return r.map((h,p)=>p===o?`${h} - ${n}`:h).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mS(r){const{inputs:t,backend:n}=r,{input:o}=t,u=n.texData.get(o.dataId);return dp({inputs:{x:u.complexTensorInfos.imag},backend:n})}const H8={kernelName:kl,backendName:"webgl",kernelFunc:mS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1(r,t,n){const o=r[0].dtype;if(o==="complex64"){const I=r.map(St=>Nx({inputs:{input:St},backend:n})),z=r.map(St=>mS({inputs:{input:St},backend:n})),V=T1(I,t,n),rt=T1(z,t,n),Et=$m({inputs:{real:V,imag:rt},backend:n});return I.forEach(St=>n.disposeIntermediateTensorInfo(St)),z.forEach(St=>n.disposeIntermediateTensorInfo(St)),n.disposeIntermediateTensorInfo(V),n.disposeIntermediateTensorInfo(rt),Et}if(o==="string"){const{tensors2D:I,outShape:z}=uD(r,t,n),V=I.map(Vt=>({vals:n.readSync(Vt.dataId),shape:Vt.shape})),rt=I[0].shape[0]===1,Et=e6(V,z,o,rt),St=jv(r.map(Vt=>Vt.shape),t),Tt=n.makeTensorInfo(St,o,Et);return I.forEach(Vt=>n.disposeIntermediateTensorInfo(Vt)),Tt}if(r.length>Ve().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const I=Math.floor(r.length/2),z=T1(r.slice(0,I),t,n),V=T1(r.slice(I),t,n),rt=T1([z,V],t,n);return n.disposeIntermediateTensorInfo(z),n.disposeIntermediateTensorInfo(V),rt}if(Ve().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].shape.length>1){const I=new j8(r.map(z=>z.shape),t);return n.runWebGLProgram(I,r,o)}const{tensors2D:u,outShape:h}=uD(r,t,n),p=new V8(u.map(I=>I.shape)),g=n.runWebGLProgram(p,u,o);u.forEach(I=>n.disposeIntermediateTensorInfo(I));const x=ko({inputs:{x:g},attrs:{shape:h},backend:n});return n.disposeIntermediateTensorInfo(g),x}function uD(r,t,n){const o=jv(r.map(h=>h.shape),t);return{tensors2D:r.map(h=>ko({inputs:{x:h},attrs:{shape:[-1,Rt(h.shape.slice(t))]},backend:n})),outShape:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lD(r){const{inputs:t,backend:n,attrs:o}=r,{axis:u}=o,h=Rr(u,t[0].shape)[0],p=jv(t.map(I=>I.shape),h);if(Rt(p)===0)return n.makeTensorInfo(p,t[0].dtype,[]);const g=t.filter(I=>Rt(I.shape)>0);if(g.length===1)return dp({inputs:{x:g[0]},backend:n});const x=g.map(I=>I.shape);return Ay(x,h),T1(g,h,n)}const X8={kernelName:us,backendName:"webgl",kernelFunc:lD};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cD{constructor(t,n=!1,o=null,u=!1,h=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const p=t.padInfo.top,g=t.padInfo.left,x=t.strideHeight,I=t.strideWidth,z=t.dilationHeight,V=t.dilationWidth,rt=t.filterHeight,Et=t.filterWidth,St=Math.floor(t.inChannels/4)*4,Tt=t.inChannels%4,Vt=t.dataFormat==="channelsLast",ue=Vt?1:2,ye=Vt?2:3,qe=Vt?3:1;let $e="",Xe="";o&&(u?$e=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:h?$e=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:$e=`
          float activation(float x) {
            ${o}
          }
        `,Xe="result = activation(result);");const Pn=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),h&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${$e}

      const ivec2 strides = ivec2(${x}, ${I});
      const ivec2 pads = ivec2(${p}, ${g});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${qe}];

        ivec2 xRCCorner =
            ivec2(coords[${ue}], coords[${ye}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${rt}; wR++) {
          int xR = xRCorner + wR * ${z};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${Et}; wC++) {
            int xC = xCCorner + wC * ${V};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${St}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${Vt}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${Tt===1}) {

              if (${Vt}) {
                dotProd +=
                    getX(batch, xR, xC, ${St}) *
                    getW(wR, wC, ${St}, d2);
              } else {
                dotProd +=
                    getX(batch, ${St}, xR, xC) *
                    getW(wR, wC, ${St}, d2);
              }

            } else if (${Tt===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${St}, d2),
                getW(wR, wC, ${St} + 1, d2)
              );

              if (${Vt}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${St}),
                  getX(batch, xR, xC, ${St} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${St}, xR, xC),
                  getX(batch, ${St} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${Tt===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${St}, d2),
                getW(wR, wC, ${St} + 1, d2),
                getW(wR, wC, ${St} + 2, d2)
              );

              if (${Vt}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${St}),
                  getX(batch, xR, xC, ${St} + 1),
                  getX(batch, xR, xC, ${St} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${St}, xR, xC),
                  getX(batch, ${St} + 1, xR, xC),
                  getX(batch, ${St} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${Pn}
        ${Xe}
        setOutput(result);
      }
    `}}class Y8{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.padInfo.front,o=t.padInfo.top,u=t.padInfo.left,h=t.strideDepth,p=t.strideHeight,g=t.strideWidth,x=t.dilationDepth,I=t.dilationHeight,z=t.dilationWidth,V=t.filterDepth,rt=t.filterHeight,Et=t.filterWidth,St=Math.floor(t.inChannels/4)*4,Tt=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${h}, ${p}, ${g});
      const ivec3 pads = ivec3(${n}, ${o}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${V}; wF++) {
          int xF = xFCorner + wF * ${x};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${rt}; wR++) {
            int xR = xRCorner + wR * ${I};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${Et}; wC++) {
              int xC = xCCorner + wC * ${z};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${St}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${Tt===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${St}) *
                  getW(wF, wR, wC, ${St}, d2);
              } else if (${Tt===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${St}),
                  getX(batch, xF, xR, xC, ${St} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${St}, d2),
                  getW(wF, wR, wC, ${St} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${Tt===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${St}),
                  getX(batch, xF, xR, xC, ${St} + 1),
                  getX(batch, xF, xR, xC, ${St} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${St}, d2),
                  getW(wF, wR, wC, ${St} + 1, d2),
                  getW(wF, wR, wC, ${St} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K8{constructor(t,n,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;const{filterWidth:u,inChannels:h,strideWidth:p,strideHeight:g,padInfo:x,outWidth:I,dilationWidth:z,dilationHeight:V,dataFormat:rt}=o,{left:Et,top:St}=x,Tt=h*u,Vt=id(),ue=rt==="channelsLast",ye=ue?0:1,qe=ue?1:2;let $e="";for(let Xe=0;Xe<=1;Xe++)for(let Pn=0;Pn<=1;Pn++)$e+=`
          blockIndex = rc.y + ${Pn};
          pos = rc.x + ${Xe};

          if(blockIndex < ${t[1]} && pos < ${t[0]}) {
            offsetY = int(blockIndex / (${I})) * ${g} - ${St};
            d0 = offsetY + ${V} * (pos / ${Tt});

            if(d0 < ${n[ye]} && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), ${I}.) * ${p}. - ${Et}.);
              d1 = offsetX + ${z} * (int(mod(float(pos), ${Tt}.) / ${h}.));

              if(d1 < ${n[qe]} && d1 >= 0) {

                ch = int(mod(float(pos), ${h}.));

                if (${ue}) {
                  innerDims = vec2(d1, ch);
                  result[${Xe*2+Pn}] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${Xe*2+Pn}] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${$e}

        ${Vt.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fD({x:r,filter:t,convInfo:n,backend:o,bias:u=null,preluActivationWeights:h=null,leakyreluAlpha:p=0,activation:g=null}){const x=r.shape,I=o.texData.get(r.dataId),z=n.inChannels,V=x[0]*x[1]*x[2],rt=n.outChannels,Et=n.dataFormat==="channelsLast",St=!1,Tt=!1;let Vt;const ue=[],ye=(V===1||rt===1)&&z>Jk,qe=x[2]%2!=0&&!!I.isPacked;if(ye||!Ve().getBool("WEBGL_LAZILY_UNPACK")||!Ve().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!qe){const $e=Et?x[0]*x[1]*x[2]:x[0]*x[2]*x[3],Xe=ko({inputs:{x:r},backend:o,attrs:{shape:[1,$e,n.inChannels]}}),Pn=ko({inputs:{x:t},backend:o,attrs:{shape:[1,n.inChannels,n.outChannels]}}),In=pS({a:Xe,b:Pn,transposeA:St,transposeB:Tt,backend:o,bias:u,activation:g,preluActivationWeights:h,leakyreluAlpha:p});Vt=ko({inputs:{x:In},backend:o,attrs:{shape:n.outShape}}),ue.push(Xe),ue.push(Pn),ue.push(In)}else{const $e=Et?x[0]*x[1]*(x[2]+1):x[0]*x[2]*(x[3]+1),Xe={dataId:r.dataId,shape:[1,$e,n.inChannels],dtype:r.dtype},Pn=I.shape;I.shape=I.shape.slice(),I.shape[I.shape.length-2]++,yt(iS(I.shape,Xe.shape),()=>`packed reshape ${I.shape} to ${Xe.shape} isn't free`);const In=ko({inputs:{x:t},backend:o,attrs:{shape:[1,n.inChannels,n.outChannels]}});ue.push(In);const gr=pS({a:Xe,b:In,backend:o,transposeA:St,transposeB:Tt,bias:u,activation:g,preluActivationWeights:h,leakyreluAlpha:p}),Br=o.texData.get(gr.dataId);yt(Br.isPacked,()=>"batchMatMul result is expected to be packed"),I.shape=Pn,Br.shape=n.outShape,Vt=dp({inputs:{x:gr},backend:o}),Vt.shape=n.outShape,ue.push(gr)}for(const $e of ue)o.disposeIntermediateTensorInfo($e);return Vt}function hD({x:r,filter:t,convInfo:n,backend:o,bias:u=null,preluActivationWeights:h=null,leakyreluAlpha:p=0,activation:g=null}){const{filterWidth:x,filterHeight:I,inChannels:z,outWidth:V,outHeight:rt,dataFormat:Et}=n,St=Et==="channelsLast",Tt=x*I*z,Vt=rt*V,ue=[Tt,Vt],ye=!0,qe=!1,$e=[],Xe=ko({inputs:{x:r},backend:o,attrs:{shape:r.shape.slice(1)}}),Pn=ko({inputs:{x:t},backend:o,attrs:{shape:[1,Tt,Rt(t.shape)/Tt]}});$e.push(Xe),$e.push(Pn);const In=new K8(ue,Xe.shape,n),gr=o.runWebGLProgram(In,[Xe],"float32"),Br=ko({inputs:{x:gr},backend:o,attrs:{shape:[1,ue[0],ue[1]]}});$e.push(gr),$e.push(Br);const Kr=u!=null,Na=h!=null,Ya=g==="leakyrelu",Ha=g?hS(g,!0):null,ni=new Xk(Br.shape,Pn.shape,[1,Vt,n.outChannels],ye,qe,Kr,Ha,Na,Ya),Wa=[Br,Pn];if(u&&Wa.push(u),Na&&Wa.push(h),Ya){const yi=o.makeTensorInfo([],"float32",rf(p,"float32"));Wa.push(yi),$e.push(yi)}const za=o.runWebGLProgram(ni,Wa,"float32"),mi=St?[1,rt,V,n.outChannels]:[1,n.outChannels,rt,V],qa=ko({inputs:{x:za},backend:o,attrs:{shape:mi}});$e.push(za);for(const yi of $e)o.disposeIntermediateTensorInfo(yi);return qa}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dataFormat:x,dilations:I,dimRoundingMode:z}=o,V=m(x),rt=ql(u.shape,h.shape,p,I,g,z,!1,V);let Et;if(rt.filterHeight===1&&rt.filterWidth===1&&rt.dilationHeight===1&&rt.dilationWidth===1&&rt.strideHeight===1&&rt.strideWidth===1&&(rt.padInfo.type==="SAME"||rt.padInfo.type==="VALID"))Et=fD({x:u,filter:h,convInfo:rt,backend:n});else if(Ve().getBool("WEBGL_CONV_IM2COL")&&u.shape[0]===1)Et=hD({x:u,filter:h,convInfo:rt,backend:n});else{const Tt=new cD(rt);Et=n.runWebGLProgram(Tt,[u,h],"float32")}const St=ko({inputs:{x:Et},backend:n,attrs:{shape:rt.outShape}});return n.disposeIntermediateTensorInfo(Et),St}const q8={kernelName:Do,backendName:"webgl",kernelFunc:Z8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q8{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,o=t.strideWidth,u=t.padInfo.top,h=t.padInfo.left,p=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${u};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${o} - ${h};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              if (${p}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class J8{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,o=t.filterWidth,u=t.strideHeight,h=t.strideWidth,p=t.dataFormat==="channelsLast",g=n-1-t.padInfo.top,x=o-1-t.padInfo.left,I=p?1:2,z=p?2:3,V=p?3:1;this.userCode=`
      const ivec2 pads = ivec2(${g}, ${x});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${V}];

        ivec2 dyCorner = ivec2(coords[${I}], coords[${z}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${u}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${h}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${o} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${p}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class tU{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideDepth,o=t.strideHeight,u=t.strideWidth,h=t.padInfo.front,p=t.padInfo.top,g=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${h};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${o} - ${p};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${u} - ${g};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class eU{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterDepth,o=t.filterHeight,u=t.filterWidth,h=t.strideDepth,p=t.strideHeight,g=t.strideWidth,x=n-1-t.padInfo.front,I=o-1-t.padInfo.top,z=u-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${x}, ${I}, ${z});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${h}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${o}; wR++) {
            float dyR = float(dyRCorner + wR) / ${p}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${o} - 1 - wR;

            for (int wC = 0; wC < ${u}; wC++) {
              float dyC = float(dyCCorner + wC) / ${g}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${u} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,pad:g,dataFormat:x,dimRoundingMode:I,filterShape:z}=o,V=m(x),rt=ql(u.shape,z,p,1,g,I,!1,V),Et=new Q8(rt);return n.runWebGLProgram(Et,[u,h],"float32")}const rU={kernelName:Io,backendName:"webgl",kernelFunc:nU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aU(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{inputShape:p,strides:g,pad:x,dataFormat:I,dimRoundingMode:z}=o,V=m(I),rt=ql(p,h.shape,g,1,x,z,!1,V),Et=new J8(rt);return n.runWebGLProgram(Et,[u,h],"float32")}const iU={kernelName:zs,backendName:"webgl",kernelFunc:aU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dilations:x}=o,I=_p(u.shape,h.shape,p,x,g),z=new Y8(I);return n.runWebGLProgram(z,[u,h],"float32")}const sU={kernelName:mu,backendName:"webgl",kernelFunc:oU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,pad:g,filterShape:x}=o,I=_p(u.shape,x,p,1,g),z=new tU(I);return n.runWebGLProgram(z,[u,h],"float32")}const lU={kernelName:ds,backendName:"webgl",kernelFunc:uU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cU(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{pad:p,strides:g,inputShape:x}=o,I=_p(x,h.shape,g,1,p),z=new eU(I);return n.runWebGLProgram(z,[u,h],"float32")}const fU={kernelName:Ms,backendName:"webgl",kernelFunc:cU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hU=Hk+`
  return cos(x);
`,dU=hl({opSnippet:hU}),pU={kernelName:yu,backendName:"webgl",kernelFunc:dU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vU=hl({opSnippet:`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`}),gU={kernelName:uu,backendName:"webgl",kernelFunc:vU};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mU{constructor(t,n,o,u,h){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[p,g,x,I]=t,[z]=n,[V,rt]=o;this.outputShape=[z,V,rt,I];const Et=u==="bilinear"?1:0,[St,Tt]=[`${g-1}.0`,`${x-1}.0`],[Vt,ue,ye]=V>1?[`${(g-1)/(V-1)}`,"(y2-y1) * height_ratio",`y1*${St} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${St}`],[qe,$e,Xe]=rt>1?[`${(x-1)/(rt-1)}`,"(x2-x1) * width_ratio",`x1*${Tt} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${Tt}`];this.userCode=`
      const float height_ratio = float(${Vt});
      const float width_ratio = float(${qe});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${p}) {
          return;
        }

        float height_scale = ${ue};
        float width_scale = ${$e};

        float in_y = ${ye};
        if( in_y < 0.0 || in_y > ${St} ) {
          setOutput(float(${h}));
          return;
        }
        float in_x = ${Xe};
        if( in_x < 0.0 || in_x > ${Tt} ) {
          setOutput(float(${h}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${Et} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yU={kernelName:qo,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{image:u,boxes:h,boxInd:p}=t,{cropSize:g,method:x,extrapolationValue:I}=o,z=new mU(u.shape,h.shape,g,x,I);return n.runWebGLProgram(z,[u,h,p],"float32")}};class dD{constructor(t,n,o){this.variableNames=["x"],this.outputShape=t;const u=t.length,h=n?"0.0":`getX(${pD(u,"coords")})`,p=t[t.length-1];let g="",x="";n?(g=o?`end != ${p-1}`:"end != 0",x=o?"end + 1":"end - 1"):(g=o?`end + pow2 < ${p}`:"end >= pow2",x=o?"end + pow2":"end - pow2"),this.userCode=`
      uniform float index;
      void main() {
        ${ac(u)} coords = getOutputCoords();
        int end = ${vD(u,"coords")};
        float val = ${h};
        int pow2 = int(pow(2.0, index));
        if (${g}) {
          int idx = ${x};
          ${vD(u,"coords")} = idx;
          val += getX(${pD(u,"coords")});
        }
        setOutput(val);
      }
    `}getCustomSetupFunc(t){return(n,o)=>{this.index==null&&(this.index=n.getUniformLocation(o,"index")),n.gl.uniform1f(this.index,t)}}}function pD(r,t){if(r===1)return`${t}`;if(r===2)return`${t}.x, ${t}.y`;if(r===3)return`${t}.x, ${t}.y, ${t}.z`;if(r===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw Error(`Cumulative sum for rank ${r} is not yet supported`)}function vD(r,t){if(r===1)return`${t}`;if(r===2)return`${t}.y`;if(r===3)return`${t}.z`;if(r===4)return`${t}.w`;throw Error(`Cumulative sum for rank ${r} is not yet supported`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,exclusive:p,reverse:g}=o,x=u.shape.length,I=$c([h],x);let z=u;I!=null&&(z=Nd({inputs:{x:u},backend:n,attrs:{perm:I}}));const V=gc(1,x)[0];if(V!==x-1)throw new Error(`WebGL cumsum shader expects an inner-most axis=${u.shape.length-1} but got axis=${h}`);const rt=z.shape[V];let Et=dp({inputs:{x:z},backend:n});for(let St=0;St<=Math.ceil(Math.log2(rt))-1;St++){const Tt=new dD(z.shape,!1,g),Vt=Tt.getCustomSetupFunc(St),ue=Et;Et=n.runWebGLProgram(Tt,[Et],Et.dtype,Vt),n.disposeIntermediateTensorInfo(ue)}if(p){const St=new dD(z.shape,p,g),Tt=Et;Et=n.runWebGLProgram(St,[Et],Et.dtype),n.disposeIntermediateTensorInfo(Tt)}if(I!=null){const St=mm(I),Tt=Nd({inputs:{x:Et},backend:n,attrs:{perm:St}});return n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(z),Tt}return Et}const xU={kernelName:Cs,backendName:"webgl",kernelFunc:bU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,weights:h}=t,{size:p,binaryOutput:g}=o;if(u.shape.length===1){const x=n.readSync(u.dataId),I=n.readSync(h.dataId),z=Ok(x,I,h.dtype,h.shape,p);return n.makeTensorInfo([p],h.dtype,z)}else if(u.shape.length===2){const x=n.bufferSync(u),I=n.bufferSync(h),z=J5(x,I,p,g);return n.makeTensorInfo(z.shape,h.dtype,z.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${u.shape.length}.`)}const EU={kernelName:Wi,backendName:"webgl",kernelFunc:wU};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SU{constructor(t,n,o){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=o,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockSize:h,dataFormat:p}=o;yt(h>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${h}`);const g=u.shape[0],x=p==="NHWC"?u.shape[1]:u.shape[2],I=p==="NHWC"?u.shape[2]:u.shape[3],z=p==="NHWC"?u.shape[3]:u.shape[1],V=x*h,rt=I*h,Et=z/(h*h),St=p==="NHWC"?[g,V,rt,Et]:[g,Et,V,rt],Tt=new SU(St,h,p);return n.runWebGLProgram(Tt,[u],u.dtype)}const _U={kernelName:ls,backendName:"webgl",kernelFunc:CU};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gD{constructor(t,n=!1,o=null,u=!1,h=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const p=t.inHeight,g=t.inWidth,x=t.padInfo.top,I=t.padInfo.left,z=t.strideHeight,V=t.strideWidth,rt=t.dilationHeight,Et=t.dilationWidth,St=t.filterHeight,Tt=t.filterWidth,Vt=t.outChannels/t.inChannels;let ue="",ye="";o&&(u?ue=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:h?ue=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:ue=`
          float activation(float x) {
            ${o}
          }
        `,ye="result = activation(result);");const qe=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),h&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${ue}

      const ivec2 strides = ivec2(${z}, ${V});
      const ivec2 pads = ivec2(${x}, ${I});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${Vt};
        int q = d2 - d1 * ${Vt};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${St}; wR++) {
          int xR = xRCorner + wR * ${rt};

          if (xR < 0 || xR >= ${p}) {
            continue;
          }

          for (int wC = 0; wC < ${Tt}; wC++) {
            int xC = xCCorner + wC * ${Et};

            if (xC < 0 || xC >= ${g}) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${qe}
        ${ye}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mD{constructor(t,n=!1,o=null,u=!1,h=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;const p=t.inHeight,g=t.inWidth,x=t.padInfo.top,I=t.padInfo.left,z=t.strideHeight,V=t.strideWidth,rt=t.dilationHeight,Et=t.dilationWidth,St=t.filterHeight,Tt=t.filterWidth,Vt=Tt;let ue="int xR; int xC; int xCOffset;";for(let Xe=0;Xe<St;Xe++)for(let Pn=0;Pn<Tt;Pn++)ue+=`
          vec4 xTexelR${Xe}C${Pn*2} = vec4(0.);
          vec4 wR${Xe}C${Pn} = vec4(0.);
          vec4 xR${Xe}C${Pn} = vec4(0.);`;for(let Xe=0;Xe<St;Xe++)for(let Pn=0;Pn<Vt;Pn++){const In=Pn*2;if(ue+=`
          xR = xRCorner + ${Xe*rt};
          xC = xCCorner + ${In*Et};
        `,V===1){if(In<Tt&&(I%2==1?ue+=`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < ${p} && xCOffset >= 0 && xCOffset < ${g}) {
                  xTexelR${Xe}C${In} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= ${g}) {
                    xTexelR${Xe}C${In}.zw = vec2(0.);
                  }
                } else {
                  xTexelR${Xe}C${In} = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < ${p} && xCOffset >= 0 && xCOffset < ${g}) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= ${g}) {
                    previous.zw = vec2(0.);
                  }

                  xR${Xe}C${In} = vec4(previous.zw, xTexelR${Xe}C${In}.xy);
                } else {
                  xR${Xe}C${In} = vec4(0, 0, xTexelR${Xe}C${In}.xy);
                }
              `:ue+=`
                if(xR >= 0 && xR < ${p} && xC >= 0 && xC < ${g}) {
                  xTexelR${Xe}C${In} = getX(batch, xR, xC, d1);
                } else {
                  xTexelR${Xe}C${In} = vec4(0.);
                }

                xR${Xe}C${In} = xTexelR${Xe}C${In};
              `,In+1<Tt)){const gr=I%2==0?Me(Et):Et;Et%2==0&&I%2==1||Et%2!=0&&I%2!=1?(ue+=`
                  xCOffset = xC + ${I%2} + ${gr};

                  if(xR >= 0 && xR < ${p} &&
                    xCOffset >= 0 && xCOffset < ${g}) {
                    xTexelR${Xe}C${In+2} = getX(batch, xR, xCOffset, d1);
                  }
                `,Et>1&&(ue+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < ${p} &&
                      xCOffset >= 0 && xCOffset < ${g}) {
                      xTexelR${Xe}C${In} = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR${Xe}C${In} = vec4(0.);
                    }
                  `),ue+=`
                  xR${Xe}C${In+1} = vec4(
                    xTexelR${Xe}C${In}.zw, xTexelR${Xe}C${In+2}.xy);
                `):ue+=`
                  xCOffset = xC + ${gr};

                  if(xR >= 0 && xR < ${p} &&
                    xCOffset >= 0 && xCOffset < ${g}) {
                    xTexelR${Xe}C${In+2} = getX(batch, xR, xCOffset, d1);
                  }

                  xR${Xe}C${In+1} = xTexelR${Xe}C${In+2};
                `}}else In<Tt&&(ue+=`
              if(xR >= 0 && xR < ${p}) {
            `,I%2==1?(ue+=`
                xCOffset = xC + 1 - ${V};
                if(xCOffset >= 0 && xCOffset < ${g}) {
                  xTexelR${Xe}C${In} = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR${Xe}C${In} = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < ${g}) {
                  xTexelR${Xe}C${In+2} = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR${Xe}C${In+2} = vec4(0.);
                }

                xR${Xe}C${In} = vec4(
                  xTexelR${Xe}C${In}.zw, xTexelR${Xe}C${In+2}.zw);
              `,In+1<Tt&&(ue+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + ${V};
                  if(xCOffset >= 0 && xCOffset < ${g}) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR${Xe}C${In+1} = vec4(xTexelR${Xe}C${In+2}.xy, final.xy);
                `)):(ue+=`
                if(xC >= 0 && xC < ${g}) {
                  xTexelR${Xe}C${In} = getX(batch, xR, xC, d1);
                } else {
                  xTexelR${Xe}C${In} = vec4(0.);
                }

                xCOffset = xC + ${V};
                if(xCOffset >= 0 && xCOffset < ${g}) {
                  xTexelR${Xe}C${In+2} = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR${Xe}C${In+2} = vec4(0.);
                }

                xR${Xe}C${In} = vec4(
                  xTexelR${Xe}C${In}.xy, xTexelR${Xe}C${In+2}.xy);
              `,In+1<Tt&&(ue+=`
                  xR${Xe}C${In+1} = vec4(
                    xTexelR${Xe}C${In}.zw, xTexelR${Xe}C${In+2}.zw);
                `)),ue+="}");In<Tt&&(ue+=`
            vec4 wTexelR${Xe}C${In} = getW(${Xe}, ${In}, d1, q);
            wR${Xe}C${In} = vec4(wTexelR${Xe}C${In}.xz, wTexelR${Xe}C${In}.xz);
          `,In+1<Tt&&(ue+=`
              vec4 wTexelR${Xe}C${In+1} = getW(${Xe}, ${In+1}, d1, q);
              wR${Xe}C${In+1} =
                vec4(wTexelR${Xe}C${In+1}.xz, wTexelR${Xe}C${In+1}.xz);`))}for(let Xe=0;Xe<St;Xe++)for(let Pn=0;Pn<Tt;Pn++)ue+=`dotProd += xR${Xe}C${Pn} * wR${Xe}C${Pn};`;let ye="",qe="";o&&(u?ye=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:h?ye=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:ye=`vec4 activation(vec4 x) {
          ${o}
        }`,qe="result = activation(result);");const $e=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),h&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${ye}

      const ivec2 strides = ivec2(${z}, ${V});
      const ivec2 pads = ivec2(${x}, ${I});

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        ${ue}

        vec4 result = dotProd;
        ${$e}
        ${qe}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dilations:x,dimRoundingMode:I}=o;let z=x;z==null&&(z=[1,1]),yt(_c(p,z),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${p} and dilations '${z}'`);const V=ql(u.shape,h.shape,p,z,g,I,!0);let rt;return Ve().getBool("WEBGL_PACK_DEPTHWISECONV")&&V.strideWidth<=2&&V.outChannels/V.inChannels==1?rt=new mD(V):rt=new gD(V),n.runWebGLProgram(rt,[u,h],"float32")}const TU={kernelName:is,backendName:"webgl",kernelFunc:IU};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AU{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,o=t.strideWidth,u=t.padInfo.top,h=t.padInfo.left,p=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${p} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${u};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${o} - ${h};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class MU{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,o=t.filterWidth,u=t.strideHeight,h=t.strideWidth,p=n-1-t.padInfo.top,g=o-1-t.padInfo.left,x=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${p}, ${g});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${u}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${h}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${o} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${x}; dm++) {
              int d2 = d1 * ${x} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,dilations:g,pad:x,dimRoundingMode:I,filterShape:z}=o,V=ql(u.shape,z,p,g,x,I,!0),rt=new AU(V);return n.runWebGLProgram(rt,[u,h],"float32")}const kU={kernelName:Es,backendName:"webgl",kernelFunc:NU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DU(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{strides:p,dilations:g,pad:x,dimRoundingMode:I,inputShape:z}=o,V=ql(z,h.shape,p,g,x,I,!0),rt=new MU(V);return n.runWebGLProgram(rt,[u,h],"float32")}const OU={kernelName:tl,backendName:"webgl",kernelFunc:DU};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RU{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LU(r){const{inputs:t,backend:n}=r,{x:o}=t,u=[...o.shape,...o.shape],h=Rt(o.shape),p=ko({inputs:{x:o},backend:n,attrs:{shape:[h]}}),g=new RU(h),x=n.runWebGLProgram(g,[p],p.dtype),I=ko({inputs:{x},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),I}const PU={kernelName:bu,backendName:"webgl",kernelFunc:LU};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FU{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:n,inWidth:o,padInfo:u,strideHeight:h,strideWidth:p,filterHeight:g,filterWidth:x,dilationHeight:I,dilationWidth:z}=t,{top:V,left:rt}=u;this.userCode=`
      const ivec2 strides = ivec2(${h}, ${p});
      const ivec2 pads = ivec2(${V}, ${rt});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${g}; h++) {
          int hIn = hBeg + h * ${I};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${x}; w++) {
              int wIn = wBeg + w * ${z};

              if (wIn >= 0 && wIn < ${o}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dilations:x}=o,I=Kc(u.shape,h.shape,p,g,"NHWC",x);let z;const V=new FU(I);z=n.runWebGLProgram(V,[u,h],"float32");const rt=ko({inputs:{x:z},backend:n,attrs:{shape:I.outShape}});return n.disposeIntermediateTensorInfo(z),rt}const zU={kernelName:Ys,backendName:"webgl",kernelFunc:BU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $U=hl({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`}),GU={kernelName:Ro,backendName:"webgl",kernelFunc:$U};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UU="return (b >= 1.0) ? a : a * (b + 1.0);",WU=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,VU={kernelName:Ns,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n}=r,{dy:o,y:u}=t,h=Ve().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Tx(WU,o.shape,u.shape):new I1(UU,o.shape,u.shape);return n.runWebGLProgram(h,[o,u],o.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jU=dh({opSnippet:"return float(a == b);",packedOpSnippet:`
  return vec4(equal(a, b));
`,dtype:"bool"}),HU={kernelName:eu,backendName:"webgl",kernelFunc:jU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XU=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${xb};
  float a1 = ${ky};
  float a2 = ${wb};
  float a3 = ${rp};
  float a4 = ${Eb};
  float a5 = ${S0};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,YU=hl({opSnippet:XU}),KU={kernelName:tu,backendName:"webgl",kernelFunc:YU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yD="return exp(x);",bD=hl({opSnippet:yD,packedOpSnippet:yD,cpuKernelImpl:n6}),ZU={kernelName:Zu,backendName:"webgl",kernelFunc:bD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gA(r){const{inputs:t,attrs:n,backend:o}=r,{dim:u}=n,{input:h}=t,p=h.shape.length,g=h.shape.slice();let x=u;return u<0&&(yt(-(p+1)<=u,()=>`Axis must be in the interval [${-(p+1)}, ${p}]`),x=p+u+1),g.splice(x,0,1),ko({inputs:{x:h},backend:o,attrs:{shape:g}})}const qU={kernelName:bn,backendName:"webgl",kernelFunc:gA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xD="return exp(x) - 1.0;",QU=hl({opSnippet:xD,packedOpSnippet:xD,cpuKernelImpl:r6}),JU={kernelName:Xr,backendName:"webgl",kernelFunc:QU};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wD{constructor(t,n,o){this.variableNames=["real","imag"];const u=n[1];this.outputShape=n;const h=o?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,p=o?`${u}.0`:"1.0";let g;if(t==="real")g="return real * expR - imag * expI;";else if(t==="imag")g="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${h};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${g}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${u});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${u}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${p};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ED(r,t,n){const o=n.texData.get(r.dataId),u=Rt(r.shape),h=r.shape[r.shape.length-1],p=u/h,g=ko({inputs:{x:r},backend:n,attrs:{shape:[p,h]}}),x=g.shape,I=new wD("real",x,t),z=new wD("imag",x,t),V=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:x},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:x}],rt=n.runWebGLProgram(I,V,"float32"),Et=n.runWebGLProgram(z,V,"float32"),St=$m({inputs:{real:rt,imag:Et},backend:n});n.disposeIntermediateTensorInfo(rt),n.disposeIntermediateTensorInfo(Et);const Tt=ko({inputs:{x:St},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(St),Tt}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tW(r){const{inputs:t,backend:n}=r,{input:o}=t;return ED(o,!1,n)}const eW={kernelName:pa,backendName:"webgl",kernelFunc:tW};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nW{constructor(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}getCustomSetupFunc(t){return(n,o)=>{this.valueLoc==null&&(this.valueLoc=n.getUniformLocationNoThrow(o,"value")),n.gl.uniform1f(this.valueLoc,t)}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mA(r){const{backend:t,attrs:n}=r,{shape:o,value:u}=n;let{dtype:h}=n;if(h=h||ta(u),h==="string"){const p=Fn(h,Rt(o));return p.fill(u),t.makeTensorInfo(o,h,p)}else{const p=new nW(o,u),g=p.getCustomSetupFunc(u);return t.runWebGLProgram(p,[],h,g)}}const rW={kernelName:Ra,backendName:"webgl",kernelFunc:mA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aW{constructor(t){this.variableNames=["Image"],this.outputShape=[];const n=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iW={kernelName:Qi,backendName:"webgl",kernelFunc:({inputs:r,backend:t})=>{const{image:n}=r,o=t,u=new aW(n.shape);return o.runWebGLProgram(u,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SD="return floor(x);",oW=hl({opSnippet:SD,packedOpSnippet:SD,cpuKernelImpl:a6}),sW={kernelName:Co,backendName:"webgl",kernelFunc:oW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uW=dh({opSnippet:`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,packedOpSnippet:`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,dtype:"int32"}),lW={kernelName:to,backendName:"webgl",kernelFunc:uW};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cW{constructor(t){this.variableNames=["A"];const n=id(),[o,u]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}.0, ${o}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fW{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=id(),[o,u]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${u}.0, ${o}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hW={kernelName:Uu,backendName:"webgl",kernelFunc:dW};let A1;function dW(r){const{inputs:t,backend:n,attrs:o}=r;let{pixels:u}=t;const{numChannels:h}=o,p=typeof HTMLVideoElement!="undefined"&&u instanceof HTMLVideoElement,g=typeof HTMLImageElement!="undefined"&&u instanceof HTMLImageElement,x=typeof ImageBitmap!="undefined"&&u instanceof ImageBitmap,[I,z]=p?[u.videoWidth,u.videoHeight]:[u.width,u.height],V=[z,I],rt=[z,I,h];(g||p||x)&&(A1==null&&(A1=document.createElement("canvas").getContext("2d")),A1.canvas.width=I,A1.canvas.height=z,A1.drawImage(u,0,0,I,z),u=A1.canvas);const Et=n.makeTensorInfo(V,"int32");n.texData.get(Et.dataId).usage=Bp.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(Et.dataId),u);const St=Ve().getBool("WEBGL_PACK")?new fW(rt):new cW(rt),Tt=n.runWebGLProgram(St,[Et],"int32");return n.disposeData(Et.dataId),Tt}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pW(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h,bias:p,preluActivationWeights:g}=t,{strides:x,pad:I,dataFormat:z,dilations:V,dimRoundingMode:rt,activation:Et,leakyreluAlpha:St}=o,Tt=m(z),Vt=ql(u.shape,h.shape,x,V,I,rt,!1,Tt);let ue;const ye=[];if(Vt.filterHeight===1&&Vt.filterWidth===1&&Vt.dilationHeight===1&&Vt.dilationWidth===1&&Vt.strideHeight===1&&Vt.strideWidth===1&&(Vt.padInfo.type==="SAME"||Vt.padInfo.type==="VALID"))ue=fD({x:u,filter:h,convInfo:Vt,backend:n,bias:p,activation:Et,preluActivationWeights:g,leakyreluAlpha:St});else if(Ve().getBool("WEBGL_CONV_IM2COL")&&u.shape[0]===1)ue=hD({x:u,filter:h,convInfo:Vt,backend:n,bias:p,activation:Et,preluActivationWeights:g,leakyreluAlpha:St});else{const $e=p!=null,Xe=g!=null,Pn=Et==="leakyrelu",In=Et?hS(Et,!1):null,gr=new cD(Vt,$e,In,Xe,Pn),Br=[u,h];if(p&&Br.push(p),g&&Br.push(g),Pn){const Kr=n.makeTensorInfo([],"float32",rf(St,"float32"));Br.push(Kr),ye.push(Kr)}ue=n.runWebGLProgram(gr,Br,"float32")}const qe=ko({inputs:{x:ue},backend:n,attrs:{shape:Vt.outShape}});return ye.push(ue),ye.forEach($e=>n.disposeIntermediateTensorInfo($e)),qe}const vW={kernelName:al,backendName:"webgl",kernelFunc:pW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gW(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h,bias:p,preluActivationWeights:g}=t,{strides:x,pad:I,dilations:z,dimRoundingMode:V,activation:rt,leakyreluAlpha:Et}=o,St=[];let Tt=z;Tt==null&&(Tt=[1,1]),yt(_c(x,Tt),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${x} and dilations '${Tt}'`);const Vt=ql(u.shape,h.shape,x,Tt,I,V,!0),ue=Ve().getBool("WEBGL_PACK_DEPTHWISECONV")&&Vt.strideWidth<=2&&Vt.outChannels/Vt.inChannels==1,ye=rt?hS(rt,ue):null,qe=[u,h],$e=p!=null,Xe=g!=null,Pn=rt==="leakyrelu";if($e&&qe.push(p),Xe&&qe.push(g),Pn){const Br=n.makeTensorInfo([],"float32",rf(Et,"float32"));qe.push(Br),St.push(Br)}let In;ue?In=new mD(Vt,$e,ye,Xe,Pn):In=new gD(Vt,$e,ye,Xe,Pn);const gr=n.runWebGLProgram(In,qe,"float32");return St.forEach(Br=>n.disposeIntermediateTensorInfo(Br)),gr}const mW={kernelName:Vu,backendName:"webgl",kernelFunc:gW};class yW{constructor(t,n,o){this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=o;const u=ac(n.length),h=ac(o.length),p=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${this.strides});
         void main() {
          ${h} coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < ${this.sliceDim}; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * ${p};
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bW(r){const{inputs:t,backend:n}=r,{params:o,indices:u}=t,h=u.shape,p=h[h.length-1],[g,x,I,z]=Jp(o,u),V=ko({inputs:{x:u},backend:n,attrs:{shape:[x,p]}}),rt=ko({inputs:{x:o},backend:n,attrs:{shape:[Rt(o.shape)/I,I]}}),Et=new yW(p,z,[x,I]),St=n.runWebGLProgram(Et,[rt,V],rt.dtype),Tt=ko({inputs:{x:St},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(V),n.disposeIntermediateTensorInfo(rt),n.disposeIntermediateTensorInfo(St),Tt}const xW={kernelName:vo,backendName:"webgl",kernelFunc:bW};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wW{constructor(t,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const o=ac(this.rank),u=EW(t,2);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        setOutput(getA(${u}));
      }
    `}}function EW(r,t){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[];for(let u=0;u<r.length;u++)u===2?o.push("int(getIndices(resRC.x, resRC.z))"):o.push(`${n[u]}`);return o.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SW(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,indices:h}=t,{axis:p,batchDims:g}=o,x=Rr(p,u.shape)[0],I=Oy(u,h,x,g),z=Rt(h.shape),V=[],rt=ko({inputs:{x:u},backend:n,attrs:{shape:[I.batchSize,I.outerSize,I.dimSize,I.sliceSize]}}),Et=ko({inputs:{x:h},backend:n,attrs:{shape:[I.batchSize,z/I.batchSize]}});V.push(rt),V.push(Et);const St=[I.batchSize,I.outerSize,z/I.batchSize,I.sliceSize];if(n.shouldExecuteOnCPU([u,h])||u.dtype==="string"){const ye=n.bufferSync(Et),qe=n.bufferSync(rt),$e=i6(qe,ye,St);return V.forEach(Xe=>n.disposeIntermediateTensorInfo(Xe)),n.makeTensorInfo(I.outputShape,$e.dtype,$e.values)}const Tt=new wW(rt.shape,St),Vt=n.runWebGLProgram(Tt,[rt,Et],rt.dtype);V.push(Vt);const ue=ko({inputs:{x:Vt},backend:n,attrs:{shape:I.outputShape}});return V.forEach(ye=>n.disposeIntermediateTensorInfo(ye)),ue}const CW={kernelName:gs,backendName:"webgl",kernelFunc:SW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _W=dh({opSnippet:"return float(a > b);",packedOpSnippet:`
  return vec4(greaterThan(a, b));
`,cpuKernelImpl:o6,dtype:"bool"}),IW={kernelName:ou,backendName:"webgl",kernelFunc:_W};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TW=dh({opSnippet:"return float(a >= b);",packedOpSnippet:`
  return vec4(greaterThanEqual(a, b));
`,dtype:"bool"}),AW={kernelName:ms,backendName:"webgl",kernelFunc:TW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MW(r){const{inputs:t,backend:n}=r,{input:o}=t;return ED(o,!0,n)}const NW={kernelName:dl,backendName:"webgl",kernelFunc:MW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kW=hl({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),DW={kernelName:Ks,backendName:"webgl",kernelFunc:kW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OW=hl({opSnippet:"return float(isinf(x));",dtype:"bool"}),RW={kernelName:el,backendName:"webgl",kernelFunc:OW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LW=hl({opSnippet:"return float(isnan(x));",dtype:"bool"}),PW={kernelName:lu,backendName:"webgl",kernelFunc:LW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FW=dh({opSnippet:"return float(a < b);",packedOpSnippet:`
  return vec4(lessThan(a, b));
`,cpuKernelImpl:s6,dtype:"bool"}),BW={kernelName:pl,backendName:"webgl",kernelFunc:FW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zW=dh({opSnippet:"return float(a <= b);",packedOpSnippet:`
  return vec4(lessThanEqual(a, b));
`,dtype:"bool"}),$W={kernelName:ns,backendName:"webgl",kernelFunc:zW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GW(r){const{backend:t,attrs:n}=r,{start:o,stop:u,num:h}=n,p=u6(o,u,h);return t.makeTensorInfo([p.length],"float32",p)}const UW={kernelName:_s,backendName:"webgl",kernelFunc:GW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WW=hl({opSnippet:`if (x < 0.0) return NAN;
  return log(x);`,packedOpSnippet:`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,cpuKernelImpl:l6}),VW={kernelName:Bu,backendName:"webgl",kernelFunc:WW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jW=hl({opSnippet:"return log(1.0 + x);"}),HW={kernelName:Au,backendName:"webgl",kernelFunc:jW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XW=dh({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,dtype:"bool"}),YW={kernelName:wu,backendName:"webgl",kernelFunc:XW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KW=hl({opSnippet:"return float(!(x >= 1.0));"}),ZW={kernelName:nu,backendName:"webgl",kernelFunc:KW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qW=dh({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,dtype:"bool"}),QW={kernelName:Tl,backendName:"webgl",kernelFunc:qW};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JW{constructor(t,n,o,u,h){this.variableNames=["x"],this.outputShape=[];const p=n,g=t[3]-1;this.outputShape=t;let x;const I=`float(${o}) + float(${u}) * sum`;h===.5?x=`inversesqrt(${I})`:h===1?x=`1.0/(${I})`:x=`exp(log(${I}) * float(-${h}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${p}; j <= ${p}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${g}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${x};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tV{constructor(t,n,o,u,h){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const p=n,g=t[3]-1;this.outputShape=t;let x;const I=`float(${o}) + float(${u}) * sum`;h===.5?x=`inversesqrt(${I})`:h===1?x=`1.0/(${I})`:x=`exp(log(${I}) * float(-${h}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${p};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${p}; j <= ${p}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${g}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${x};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eV={kernelName:Sl,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{depthRadius:h,bias:p,alpha:g,beta:x}=o,I=Ve().getBool("WEBGL_PACK_NORMALIZATION")?new tV(u.shape,h,p,g,x):new JW(u.shape,h,p,g,x);return n.runWebGLProgram(I,[u],u.dtype)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nV{constructor(t,n,o,u,h){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=o,this.alpha=u,this.beta=h,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${u}) * norm + float(${o});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${u})
                * float(${h})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${h});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rV={kernelName:ol,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{x:u,y:h,dy:p}=t,{depthRadius:g,bias:x,alpha:I,beta:z}=o,V=new nV(u.shape,g,x,I,z);return n.runWebGLProgram(V,[u,h,p],u.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aV(r,t,n,o){const u=Rt(t),p=Rt(r.shape)/u,g=ko({inputs:{x:r},attrs:{shape:[p,u]},backend:o}),x=j0(g,r.dtype,"max",o),I=ko({inputs:{x},attrs:{shape:n},backend:o});return o.disposeIntermediateTensorInfo(g),o.disposeIntermediateTensorInfo(x),I}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CD(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{reductionIndices:h,keepDims:p}=o,g=u.shape.length,x=Rr(h,u.shape);let I=x;const z=$c(I,g),V=z!=null,rt=n.shouldExecuteOnCPU([u]);let Et=u;if(V){if(rt){const qe=n.texData.get(Et.dataId).values,$e=new Array(g);for(let In=0;In<$e.length;In++)$e[In]=u.shape[z[In]];const Xe=fA(qe,u.shape,u.dtype,z,$e);Et=n.makeTensorInfo($e,u.dtype);const Pn=n.texData.get(Et.dataId);Pn.values=Xe}else Et=dS(u,z,n);I=gc(I.length,g)}Pf("max",I,g);const[St,Tt]=yf(Et.shape,I);let Vt=St;p&&(Vt=zc(St,x));let ue;if(rt){const qe=n.texData.get(Et.dataId).values,$e=c6(qe,Rt(Tt),Vt,u.dtype);ue=n.makeTensorInfo(Vt,u.dtype);const Xe=n.texData.get(ue.dataId);Xe.values=$e}else ue=aV(Et,Tt,Vt,n);return V&&n.disposeIntermediateTensorInfo(Et),ue}const iV={kernelName:ys,backendName:"webgl",kernelFunc:CD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oV=Gk+`
  return max(a, b);
`,sV=`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+fS+`
  return result;
`,uV=dh({opSnippet:oV,packedOpSnippet:sV,cpuKernelImpl:f6}),lV={kernelName:vl,backendName:"webgl",kernelFunc:uV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cV(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t;_x(u,"maxPool");const{filterSize:h,strides:p,pad:g,dimRoundingMode:x}=o,I=1;yt(_c(p,I),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${p} and dilations '${I}'`);const z=Rf(u.shape,h,p,I,g,x);if(z.filterWidth===1&&z.filterHeight===1&&Un(z.inShape,z.outShape))return dp({inputs:{x:u},backend:n});const V=new Ax(z,"max",!1);return n.runWebGLProgram(V,[u],u.dtype)}const fV={kernelName:kc,backendName:"webgl",kernelFunc:cV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{filterSize:h,strides:p,pad:g,dataFormat:x,dimRoundingMode:I}=o,z=[1,1,1],V=bd(u.shape,h,p,z,g,I,x),rt=new dA(V,"max",!1);return n.runWebGLProgram(rt,[u],u.dtype)}const dV={kernelName:Ol,backendName:"webgl",kernelFunc:hV};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pV{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideHeight,o=t.strideWidth,u=t.dilationHeight,h=t.effectiveFilterHeight,p=t.effectiveFilterWidth,g=h-1-t.padInfo.top,x=p-1-t.padInfo.left,I=h*p-1;this.userCode=`
      const ivec2 pads = ivec2(${g}, ${x});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h};
          wR += ${u}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${p}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${I} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${p} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class vV{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideDepth,o=t.strideHeight,u=t.strideWidth,h=t.dilationDepth,p=t.dilationHeight,g=t.dilationWidth,x=t.effectiveFilterDepth,I=t.effectiveFilterHeight,z=t.effectiveFilterWidth,V=x-1-t.padInfo.front,rt=I-1-t.padInfo.top,Et=z-1-t.padInfo.left,St=x*I*z-1;this.userCode=`
      const ivec3 pads = ivec3(${V}, ${rt}, ${Et});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${x};
           wD += ${h}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${I};
              wR += ${p}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${z};
                wC += ${g}) {
              float dyC = float(dyCCorner + wC) / ${u}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${St} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${I} * ${z} +
                  wR * ${z} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gV(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,p=h,{filterSize:g,strides:x,pad:I,dimRoundingMode:z}=o,V=[1,1,1],rt=bd(p.shape,g,x,V,I,z),Et=new dA(rt,"max",!0),St=n.runWebGLProgram(Et,[p],p.dtype),Tt=new vV(rt),Vt=n.runWebGLProgram(Tt,[u,St],p.dtype);return n.disposeIntermediateTensorInfo(St),Vt}const mV={kernelName:_e,backendName:"webgl",kernelFunc:gV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yV(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h,output:p}=t,g=h;_x([h,p],"maxPoolGrad");const{filterSize:x,strides:I,pad:z,dimRoundingMode:V}=o,rt=Rf(g.shape,x,I,1,z,V),Et=!0,St=new Ax(rt,"max",Et),Tt=n.runWebGLProgram(St,[g],g.dtype),Vt=new pV(rt),ue=n.runWebGLProgram(Vt,[u,Tt],g.dtype);return n.disposeIntermediateTensorInfo(Tt),ue}const bV={kernelName:Dl,backendName:"webgl",kernelFunc:yV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xV(r,t,n,o){let u=new Ax(n,"max",!1);const h=o.runWebGLProgram(u,[r],"float32");u=new Ax(n,"max",!0,!0,t);const p=o.runWebGLProgram(u,[r],"float32");return[h,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wV={kernelName:ve,backendName:"webgl",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{x:o}=r,{filterSize:u,strides:h,pad:p,includeBatchInIndex:g}=t,x=n;yt(o.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.shape.length}.`);const I=[1,1];yt(_c(h,I),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${h} and dilations '${I}'`);const z=Rf(o.shape,u,h,I,p),[V,rt]=xV(o,g,z,x);return[V,rt]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EV(r,t,n,o){const u=Rt(t),p=Rt(r.shape)/u,g=ko({inputs:{x:r},attrs:{shape:[p,u]},backend:o}),x=j0(g,"float32","mean",o),I=ko({inputs:{x},attrs:{shape:n},backend:o});return o.disposeIntermediateTensorInfo(g),o.disposeIntermediateTensorInfo(x),I}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SV={kernelName:Bt,backendName:"webgl",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{x:o}=r,{keepDims:u,axis:h}=t,p=n,g=o.shape.length,x=Rr(h,o.shape);let I=x;const z=$c(I,g),V=z!=null,rt=p.shouldExecuteOnCPU([o]),Et=[];let St=o;if(V){if(rt){const $e=p.texData.get(St.dataId).values,Xe=new Array(g);for(let gr=0;gr<Xe.length;gr++)Xe[gr]=o.shape[z[gr]];const Pn=fA($e,o.shape,o.dtype,z,Xe);St=p.makeTensorInfo(Xe,o.dtype);const In=p.texData.get(St.dataId);In.values=Pn}else St=dS(o,z,p);Et.push(St),I=gc(I.length,g)}Pf("sum",I,g);const[Tt,Vt]=yf(St.shape,I);let ue=Tt;u&&(ue=zc(Tt,x));const ye=EV(St,Vt,ue,p);for(const qe of Et)p.disposeIntermediateTensorInfo(qe);return ye}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CV(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o,g=u.shape.length,x=Rr(h,u.shape);let I=x;const z=$c(I,g);let V=u;z!=null&&(V=Nd({inputs:{x:u},backend:n,attrs:{perm:z}}),I=gc(I.length,u.shape.length)),Pf("min",I,g);const[rt,Et]=yf(V.shape,I),St=Rt(Et),Tt=ko({inputs:{x:V},backend:n,attrs:{shape:[-1,St]}}),Vt=j0(Tt,Tt.dtype,"min",n);let ue;if(p){const ye=zc(rt,x);ue=ko({inputs:{x:Vt},backend:n,attrs:{shape:ye}})}else ue=ko({inputs:{x:Vt},backend:n,attrs:{shape:rt}});return n.disposeIntermediateTensorInfo(Tt),n.disposeIntermediateTensorInfo(Vt),z!=null&&n.disposeIntermediateTensorInfo(V),ue}const _V={kernelName:ae,backendName:"webgl",kernelFunc:CV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IV=Gk+`
  return min(a, b);
`,TV=`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+fS+`
  return result;
`,AV=dh({opSnippet:IV,packedOpSnippet:TV,cpuKernelImpl:h6}),MV={kernelName:me,backendName:"webgl",kernelFunc:AV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NV{constructor(t,n,o){this.variableNames=["x"],this.outputShape=n.map((z,V)=>z[0]+t[V]+z[1]);const u=t.length,h=ac(u),p=n.map(z=>z[0]).join(","),g=n.map((z,V)=>z[0]+t[V]).join(","),x=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,u),I=o==="reflect"?0:1;if(u===1){this.userCode=`
        int start = ${p};
        int end = ${g};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${I};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${I};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${h} start = ${h}(${p});
      ${h} end = ${h}(${g});

      void main() {
        ${h} outC = getOutputCoords();
        for (int i = 0; i < ${u}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${I};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${I};
          }
        }
        ${h} coords = outC - start;
        setOutput(getX(${x}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kV{constructor(t,n,o){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((St,Tt)=>St[0]+t[Tt]+St[1]);const u=t.length,h=ac(u),p=n.map(St=>St[0]).join(","),g=n.map((St,Tt)=>St[0]+t[Tt]).join(","),x=od("rc",u),I=od("source",u),z=`${x[u-1]} < ${this.outputShape[u-1]}`,V=u===1?"source":`vec2(${I.slice(-2).join()})`,rt=o==="reflect"?0:1;let Et="";if(u===1){const St=`
        ${h} source = rc;
        if (source < start) {
          source = start * 2 - source - ${rt};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${rt};
        }
        source -= start;
      `;Et=`
        ${h} rc = outputLoc;
        ${St}
        result[0] = getChannel(getX(${I.join()}), ${V});
        ${x[u-1]} += 1;
        if(${z}) {
          ${St}
          result[1] = getChannel(getX(${I.join()}), ${V});
        }
      `}else{const St=`
        ${h} source = rc;
        ${h} lt = ${h}(lessThan(source, start));
        ${h} gte = ${h}(greaterThanEqual(source, end));
        ${h} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${rt}) +
                gte * ((end - 1) * 2 - source + ${rt});
        source -= start;
      `;Et=`
        ${h} rc = outputLoc;
        ${St}
        result[0] = getChannel(getX(${I.join()}), ${V});
        ${x[u-1]} += 1;
        if(${z}) {
          ${St}
          result[1] = getChannel(getX(${I.join()}), ${V});
        }
        rc = outputLoc;
        ${x[u-2]} += 1;
        if(${x[u-2]} < ${this.outputShape[u-2]}) {
          ${St}
          result[2] = getChannel(getX(${I.join()}), ${V});
          ${x[u-1]} += 1;
          if(${z}) {
            ${St}
            result[3] = getChannel(getX(${I.join()}), ${V});
          }
        }
      `}this.userCode=`
      const ${h} start = ${h}(${p});
      const ${h} end = ${h}(${g});

      void main() {
        ${h} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${Et}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DV={kernelName:En,backendName:"webgl",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:o}=r,{paddings:u,mode:h}=n,p=Ve().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new kV(o.shape,u,h):new NV(o.shape,u,h);return t.runWebGLProgram(p,[o],o.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OV=`if (b == 0.0) return NAN;
  return mod(a, b);`,RV=`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  `+fS+`
  return result;
`,LV=dh({opSnippet:OV,packedOpSnippet:RV}),PV={kernelName:Zn,backendName:"webgl",kernelFunc:LV};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FV{constructor(t,n,o){this.variableNames=["probs"],this.outputShape=[t,o],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}getCustomSetupFunc(t){return(n,o)=>{this.seedLoc==null&&(this.seedLoc=n.getUniformLocation(o,"seed")),n.gl.uniform1f(this.seedLoc,t)}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _D=dh({opSnippet:`
if (a == b) {
  return 1.0;
};
return a / b;`,packedOpSnippet:`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,checkOutOfBounds:!0}),BV={kernelName:Vs,backendName:"webgl",kernelFunc:_D};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ID="return a - b;",TD=dh({opSnippet:ID,packedOpSnippet:ID,supportsComplex:!0,cpuKernelImpl:x6}),zV={kernelName:Ar,backendName:"webgl",kernelFunc:TD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AD(r){const{inputs:t,backend:n,attrs:o}=r,{logits:u}=t,{dim:h}=o,p=Rr([h],u.shape),g=CD({inputs:{x:u},backend:n,attrs:{reductionIndices:p,keepDims:!1}}),x=zc(g.shape,p),I=ko({inputs:{x:g},backend:n,attrs:{shape:x}}),z=TD({inputs:{a:u,b:I},backend:n}),V=bD({inputs:{x:z},backend:n}),rt=hA({inputs:{x:V},backend:n,attrs:{axis:p,keepDims:!1}}),Et=ko({inputs:{x:rt},backend:n,attrs:{shape:x}}),St=_D({inputs:{a:V,b:Et},backend:n});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(I),n.disposeIntermediateTensorInfo(z),n.disposeIntermediateTensorInfo(V),n.disposeIntermediateTensorInfo(rt),n.disposeIntermediateTensorInfo(Et),St}const $V={kernelName:De,backendName:"webgl",kernelFunc:AD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GV(r){const{inputs:t,backend:n,attrs:o}=r,{logits:u}=t,{numSamples:h,seed:p,normalized:g}=o,x=g?u:AD({inputs:{logits:u},backend:n,attrs:{dim:u.shape.length-1}}),I=x.shape[0],z=x.shape[1],V=new FV(I,z,h),rt=V.getCustomSetupFunc(p),Et=n.runWebGLProgram(V,[x],"int32",rt);return g||n.disposeIntermediateTensorInfo(x),Et}const UV={kernelName:Kt,backendName:"webgl",kernelFunc:GV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MD="return -x;";function WV(r){const{inputs:t,backend:n}=r,{x:o}=t;if(n.shouldExecuteOnCPU([o])){const h=n.texData.get(o.dataId),[p,g]=p6(h.values,o.shape,o.dtype);return n.makeTensorInfo(g,o.dtype,p)}let u;return Ve().getBool("WEBGL_PACK_UNARY_OPERATIONS")?u=new _1(o.shape,MD):u=new zm(o.shape,MD),n.runWebGLProgram(u,[o],o.dtype)}const VV={kernelName:Ae,backendName:"webgl",kernelFunc:WV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jV=Cy;function HV(r){Tm("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:x}=o,I=n.readSync(u.dataId),z=n.readSync(h.dataId),{selectedIndices:V}=jV(I,z,p,g,x);return n.makeTensorInfo([V.length],"int32",new Int32Array(V))}const XV={kernelName:xn,backendName:"webgl",kernelFunc:HV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YV=Pg;function KV(r){Tm("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:x,padToMaxOutputSize:I}=o,z=n.readSync(u.dataId),V=n.readSync(h.dataId),{selectedIndices:rt,validOutputs:Et}=YV(z,V,p,g,x,I);return[n.makeTensorInfo([rt.length],"int32",new Int32Array(rt)),n.makeTensorInfo([],"int32",new Int32Array([Et]))]}const ZV={kernelName:ir,backendName:"webgl",kernelFunc:KV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qV=_y;function QV(r){Tm("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:x,softNmsSigma:I}=o,z=n.readSync(u.dataId),V=n.readSync(h.dataId),rt=p,Et=g,St=x,Tt=I,{selectedIndices:Vt,selectedScores:ue}=qV(z,V,rt,Et,St,Tt);return[n.makeTensorInfo([Vt.length],"int32",new Int32Array(Vt)),n.makeTensorInfo([ue.length],"float32",new Float32Array(ue))]}const JV={kernelName:$r,backendName:"webgl",kernelFunc:QV};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t7{constructor(t,n,o,u){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${u}), float(${o}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e7={kernelName:Va,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{indices:u}=t,{depth:h,onValue:p,offValue:g}=o,x=Rt(u.shape),I=new t7(x,h,p,g),z=ko({inputs:{x:u},backend:n,attrs:{shape:[x]}}),V=n.runWebGLProgram(I,[z],u.dtype);n.disposeIntermediateTensorInfo(z);const rt=[...u.shape,h],Et=ko({inputs:{x:V},backend:n,attrs:{shape:rt}});return n.disposeIntermediateTensorInfo(V),Et}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yS(r){const{inputs:t,backend:n}=r,{x:o}=t;if(o.dtype==="complex64"){const u=Nx({inputs:{input:o},backend:n}),h=yS({inputs:{x:u},backend:n}),p=mS({inputs:{input:o},backend:n}),g=yS({inputs:{x:p},backend:n}),x=$m({inputs:{real:h,imag:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),x}else return mA({attrs:{shape:o.shape,dtype:o.dtype,value:o.dtype==="string"?"":0},backend:n})}const n7={kernelName:qu,backendName:"webgl",kernelFunc:yS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ND(r){const{inputs:t,backend:n}=r,{x:o}=t;if(o.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(o.dtype==="complex64"){const u=Nx({inputs:{input:o},backend:n}),h=ND({inputs:{x:u},backend:n}),p=mS({inputs:{input:o},backend:n}),g=yS({inputs:{x:p},backend:n}),x=$m({inputs:{real:h,imag:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),x}else return mA({attrs:{shape:o.shape,dtype:o.dtype,value:1},backend:n})}const r7={kernelName:Aa,backendName:"webgl",kernelFunc:ND};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a7(r){const{inputs:t,backend:n,attrs:o}=r,{axis:u}=o;if(t.length===1)return gA({inputs:{input:t[0]},backend:n,attrs:{dim:u}});const h=t[0].shape,p=t[0].dtype;t.forEach(z=>{Ne(h,z.shape,"All tensors passed to stack must have matching shapes"),yt(p===z.dtype,()=>"All tensors passed to stack must have matching dtypes")});const g=[],x=t.map(z=>{const V=gA({inputs:{input:z},backend:n,attrs:{dim:u}});return g.push(V),V}),I=lD({inputs:x,backend:n,attrs:{axis:u}});return g.forEach(z=>n.disposeIntermediateTensorInfo(z)),I}const i7={kernelName:Ba,backendName:"webgl",kernelFunc:a7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o7{constructor(t,n,o){this.variableNames=["x"],this.outputShape=n.map((I,z)=>I[0]+t[z]+I[1]);const u=t.length,h=ac(u),p=n.map(I=>I[0]).join(","),g=n.map((I,z)=>I[0]+t[z]).join(","),x=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,u);if(u===1){this.userCode=`
        int start = ${p};
        int end = ${g};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(${o}));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${h} start = ${h}(${p});
      ${h} end = ${h}(${g});

      void main() {
        ${h} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(${o}));
        } else {
          ${h} coords = outC - start;
          setOutput(getX(${x}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s7{constructor(t,n,o){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((Tt,Vt)=>Tt[0]+t[Vt]+Tt[1]);const u=t.length,h=ac(u),p=n.map(Tt=>Tt[0]).join(","),g=n.map((Tt,Vt)=>Tt[0]+t[Vt]).join(","),x=od("rc",u),I=od("source",u),z=`${x[u-1]} < ${this.outputShape[u-1]}`,V=u===1?"source":`vec2(${I.slice(-2).join()})`,rt=[`${h} rc = outputLoc;`,`${x[u-1]} += 1;
       if(${z}) {
      `,u===1?"":`}
       rc = outputLoc;
       ${x[u-2]} += 1;
       if(${x[u-2]} < ${this.outputShape[u-2]}) {`,u===1?"":`  ${x[u-1]} += 1;
         if(${z}) {`],Et=u===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let St="";for(let Tt=0,Vt=u===1?2:4;Tt<Vt;Tt++)St+=`
        ${rt[Tt]}
        if (${Et}) {
          result[${Tt}] = float(${o});
        } else {
          ${h} source = rc - start;
          result[${Tt}] = getChannel(getX(${I.join()}), ${V});
        }
      `;St+=u===1?"} ":"}}",this.userCode=`
      const ${h} start = ${h}(${p});
      const ${h} end = ${h}(${g});

      void main() {
        ${h} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${St}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kD=r=>{const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{paddings:h,constantValue:p}=o,g=Ve().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new s7(u.shape,h,p):new o7(u.shape,h,p);return n.runWebGLProgram(g,[u],u.dtype)},u7={kernelName:oi,backendName:"webgl",kernelFunc:kD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l7=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,c7=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  `+fS+`
  return result;
`,f7=dh({opSnippet:l7,packedOpSnippet:c7}),h7={kernelName:Di,backendName:"webgl",kernelFunc:f7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d7(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o,g=u.shape.length,x=[],I=Rr(h,u.shape);let z=I;const V=$c(z,g);let rt=u;V!=null&&(rt=Nd({inputs:{x:u},backend:n,attrs:{perm:V}}),z=gc(z.length,g),x.push(rt)),Pf("prod",z,g);let Et;if(n.shouldExecuteOnCPU([rt])){const St=n.texData.get(rt.dataId).values,{outVals:Tt,outShape:Vt,outDtype:ue}=v6(rt.shape,rt.dtype,St,z);Et=n.makeTensorInfo(Vt,ue,Tt)}else{const[St,Tt]=yf(rt.shape,z),Vt=Rt(Tt),ue=ko({inputs:{x:rt},backend:n,attrs:{shape:[-1,Vt]}}),ye=jo(u.dtype),qe=j0(ue,ye,"prod",n);Et=ko({inputs:{x:qe},backend:n,attrs:{shape:St}}),x.push(ue),x.push(qe)}if(p){x.push(Et);const St=zc(Et.shape,I);Et=ko({inputs:{x:Et},backend:n,attrs:{shape:St}})}return x.forEach(St=>n.disposeIntermediateTensorInfo(St)),Et}const p7={kernelName:_o,backendName:"webgl",kernelFunc:d7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DD=r=>{const{backend:t,attrs:n}=r,{start:o,stop:u,step:h,dtype:p}=n,g=g6(o,u,h,p);return t.makeTensorInfo([g.length],p,g)},v7={kernelName:To,backendName:"webgl",kernelFunc:DD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g7=hl({opSnippet:"return 1.0 / x;"}),m7={kernelName:Vo,backendName:"webgl",kernelFunc:g7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y7=Ev+`
  return (x < 0.0) ? 0.0 : x;
`,b7=hl({opSnippet:y7,packedOpSnippet:`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),x7={kernelName:js,backendName:"webgl",kernelFunc:b7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w7=Ev+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,E7=hl({opSnippet:w7,packedOpSnippet:`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),S7={kernelName:Cl,backendName:"webgl",kernelFunc:E7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C7{constructor(t,n,o,u,h){this.variableNames=["A"],this.outputShape=[];const[p,g,x,I]=t;this.outputShape=[p,n,o,I];const z=[u&&n>1?g-1:g,u&&o>1?x-1:x],V=[u&&n>1?n-1:n,u&&o>1?o-1:o];let rt;h?rt="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":rt="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${z[0]/V[0]},
          ${z[1]/V[1]});
      const vec2 inputShapeRC = vec2(${g}.0, ${x}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${rt};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _7{constructor(t,n,o,u,h){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[p,g,x,I]=t;this.outputShape=[p,n,o,I];const z=[u&&n>1?g-1:g,u&&o>1?x-1:x],V=[u&&n>1?n-1:n,u&&o>1?o-1:o];let rt;h?rt="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":rt="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${z[0]/V[0]},
          ${z[1]/V[1]},
          ${z[1]/V[1]});
      const vec3 inputShapeRC = vec3(${g}.0, ${x}.0,
                                     ${x}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${rt};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${I-1};
        bool hasNextRow = coords.z < ${o-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I7(r){const{inputs:t,backend:n,attrs:o}=r,{images:u}=t,{alignCorners:h,halfPixelCenters:p,size:g}=o,[x,I]=g,z=Ve().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new _7(u.shape,x,I,h,p):new C7(u.shape,x,I,h,p);return n.runWebGLProgram(z,[u],"float32")}const T7={kernelName:Mu,backendName:"webgl",kernelFunc:I7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A7{constructor(t,n,o){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,u,h]=n,[,p,g]=t,x=[o&&p>1?u-1:u,o&&g>1?h-1:h],I=[o&&p>1?p-1:p,o&&g>1?g-1:g],z=x[0]/I[0],V=x[1]/I[1],rt=1/z,Et=1/V,St=Math.ceil(rt)*2+2,Tt=Math.ceil(Et)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${z});
        const float widthScale = float(${V});

        const float invHeightScale = float(${rt});
        const float invWidthScale = float(${Et});

        const int winHeight = int(${St});
        const int winWidth = int(${Tt});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${p}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${g}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${u-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${h-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M7(r){const{inputs:t,backend:n,attrs:o}=r,{images:u,dy:h}=t,{alignCorners:p}=o,g=new A7(h.shape,u.shape,p);return n.runWebGLProgram(g,[h],h.dtype)}const N7={kernelName:nl,backendName:"webgl",kernelFunc:M7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k7{constructor(t,n,o,u,h){this.variableNames=["A"],this.outputShape=[];const[p,g,x,I]=t;this.outputShape=[p,n,o,I];const z=[u&&n>1?g-1:g,u&&o>1?x-1:x],V=[u&&n>1?n-1:n,u&&o>1?o-1:o],rt=u?"0.5":"0.0";let Et;h?Et="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":Et="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${z[0]/V[0]},
          ${z[1]/V[1]});
      const vec2 inputShapeRC = vec2(${g}.0, ${x}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${Et};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${rt})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D7(r){const{inputs:t,backend:n,attrs:o}=r,{images:u}=t,{alignCorners:h,halfPixelCenters:p,size:g}=o,[x,I]=g,z=new k7(u.shape,x,I,h,p);return n.runWebGLProgram(z,[u],u.dtype)}const O7={kernelName:ks,backendName:"webgl",kernelFunc:D7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R7{constructor(t,n,o){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,u,h]=n,[,p,g]=t,x=[o&&p>1?u-1:u,o&&g>1?h-1:h],I=[o&&p>1?p-1:p,o&&g>1?g-1:g],z=x[0]/I[0],V=x[1]/I[1],rt=1/z,Et=1/V,St=Math.ceil(rt)*2+2,Tt=Math.ceil(Et)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${z});
        const float widthScale = float(${V});

        const float invHeightScale = float(${rt});
        const float invWidthScale = float(${Et});

        const int winHeight = int(${St});
        const int winWidth = int(${Tt});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${p}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${g}) {
              continue;
            }

            float sourceFracRow =
              float(${x[0]}) *
                (float(dyR) / float(${I[0]}));

            float sourceFracCol =
                float(${x[1]}) *
                  (float(dyC) / float(${I[1]}));

            int sourceNearestRow = int(min(
                float(int(${u}) - 1),
                ${o} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${h}) - 1),
                ${o} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7(r){const{inputs:t,backend:n,attrs:o}=r,{images:u,dy:h}=t,{alignCorners:p}=o,g=new R7(h.shape,u.shape,p);return n.runWebGLProgram(g,[h],h.dtype)}const P7={kernelName:Hs,backendName:"webgl",kernelFunc:L7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F7{constructor(t,n){this.variableNames=["x"];const o=t.length;if(o>4)throw new Error(`WebGL backend: Reverse of rank-${o} tensor is not yet supported`);if(this.outputShape=t,o===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const u=g=>n.indexOf(g)!==-1&&t[g]!==1?`${t[g]} - coords[${g}] - 1`:`coords[${g}]`,h=t.map((g,x)=>u(x)).join(","),p=ac(o);this.userCode=`
      void main() {
        ${p} coords = getOutputCoords();
        setOutput(getX(${h}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B7{constructor(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const o=t.length;if(o>4)throw new Error(`WebGL backend: Reverse of rank-${o} tensor is not yet supported`);this.outputShape=t;const u=od("rc",o),h=`${u[o-1]} + 1 < ${this.outputShape[o-1]}`,p=`${u[o-2]} + 1 < ${this.outputShape[o-2]}`,g=ac(o);o===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${h}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${g} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${x(u.slice())};
          if(${h}){
            result.g = ${I(u.slice())};
          }
          if(${p}) {
            result.b = ${z(u.slice())};
            if(${h}) {
              result.a = ${V(u.slice())};
            }
          }
          setOutput(result);
        }
    `;function x(St){return rt(St)}function I(St){return St[o-1]="("+St[o-1]+" + 1)",rt(St)}function z(St){return St[o-2]="("+St[o-2]+" + 1)",rt(St)}function V(St){return St[o-1]="("+St[o-1]+" + 1)",St[o-2]="("+St[o-2]+" + 1)",rt(St)}function rt(St){const Tt=t.map((ye,qe)=>Et(qe,St)),Vt=Tt.join(","),ue=Tt.slice(-2).join(",");return`getChannel(getX(${Vt}), vec2(${ue}))`}function Et(St,Tt){return n.indexOf(St)!==-1&&t[St]!==1?`${t[St]} - ${Tt[St]} - 1`:`${Tt[St]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z7(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{dims:h}=o,p=u.shape.length,g=Rr(h,u.shape);if(p===0)return dp({inputs:{x:u},backend:n});const x=Ve().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new B7(u.shape,g):new F7(u.shape,g);return n.runWebGLProgram(x,[u],u.dtype)}const $7={kernelName:Yl,backendName:"webgl",kernelFunc:z7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G7{constructor(t,n,o,u){this.variableNames=["Image"],this.outputShape=[];const h=t[1],p=t[2],g=Math.sin(n).toFixed(3),x=Math.cos(n).toFixed(3);this.outputShape=t;const[I,z]=np(u,h,p),V=I.toFixed(3),rt=z.toFixed(3);let Et="";typeof o=="number"?Et=`float outputValue = ${o.toFixed(2)};`:Et=`
        vec3 fill = vec3(${o.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - ${V}) * ${x} - (float(y) - ${rt}) * ${g};
          float coordYFloat = (float(x) - ${V}) * ${g} + (float(y) - ${rt}) * ${x};
          int coordX = int(round(coordXFloat + ${V}));
          int coordY = int(round(coordYFloat + ${rt}));
          ${Et}
          if(coordX >= 0 && coordX < ${p} && coordY >= 0 && coordY < ${h}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U7={kernelName:Qu,backendName:"webgl",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{image:o}=r,{radians:u,fillValue:h,center:p}=t,g=n,x=new G7(o.shape,u,h,p);return g.runWebGLProgram(x,[o],o.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W7=hl({opSnippet:`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`}),V7={kernelName:sl,backendName:"webgl",kernelFunc:W7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j7=hl({opSnippet:"return inversesqrt(x);",cpuKernelImpl:m6}),H7={kernelName:rl,backendName:"webgl",kernelFunc:j7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OD{constructor(t,n,o,u,h,p,g=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=p;const x=ac(h.length),I=ac(p.length);let z="";o===1?z="i":o===2&&(z="i, j");const V=`getIndices(${z})`;let rt="";u===1?rt="i":u===2&&(rt="i, coords[1]");const Et=`getUpdates(${rt})`,St=n>1?"strides[j]":"strides";this.userCode=`
        ${x} strides = ${x}(${h});

        void main() {
          ${I} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${V});
              flattenedIndex += index * ${St};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${Et};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7(r){const{inputs:t,backend:n,attrs:o}=r,{indices:u,updates:h}=t,{shape:p}=o,{sliceRank:g,numUpdates:x,sliceSize:I,strides:z,outputSize:V}=Bl(h,u,p),rt=[V/I,I];if(V===0)return n.makeTensorInfo(p,u.dtype);const Et=ko({inputs:{x:u},backend:n,attrs:{shape:[x,g]}}),St=ko({inputs:{x:h},backend:n,attrs:{shape:[x,I]}}),Tt=n.makeTensorInfo([],"float32",new Float32Array([0])),Vt=new OD(x,g,Et.shape.length,St.shape.length,z,rt),ue=n.runWebGLProgram(Vt,[St,Et,Tt],St.dtype),ye=ko({inputs:{x:ue},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(St),n.disposeIntermediateTensorInfo(ue),n.disposeIntermediateTensorInfo(Tt),ye}const Y7={kernelName:_f,backendName:"webgl",kernelFunc:X7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K7{constructor(t,n,o){this.variableNames=["c","a","b"],this.outputShape=n;let u,h;if(o>4)throw Error(`Where for rank ${o} is not yet supported`);if(o===1)h="resRC",u="resRC";else{const g=["resRC.x","resRC.y","resRC.z","resRC.w"],x=[],I=[];for(let z=0;z<n.length;z++)I.push(`${g[z]}`),z<t&&x.push(`${g[z]}`);u=x.join(),h=I.join()}const p=ac(o);this.userCode=`
      void main() {
        ${p} resRC = getOutputCoords();
        float cVal = getC(${u});
        if (cVal >= 1.0) {
          setOutput(getA(${h}));
        } else {
          setOutput(getB(${h}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z7(r){const{inputs:t,backend:n}=r,{condition:o,t:u,e:h}=t,p=new K7(o.shape.length,u.shape,u.shape.length);return n.runWebGLProgram(p,[o,u,h],so(u.dtype,h.dtype))}const q7={kernelName:Dc,backendName:"webgl",kernelFunc:Z7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q7=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${My};
  float scale = ${Ny};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,J7=hl({opSnippet:Q7}),t9={kernelName:wc,backendName:"webgl",kernelFunc:J7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e9=hl({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),n9={kernelName:de,backendName:"webgl",kernelFunc:e9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r9=hl({opSnippet:`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`}),a9={kernelName:Zt,backendName:"webgl",kernelFunc:r9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i9=Hk+`
  return sin(x);
`,o9=hl({opSnippet:i9}),s9={kernelName:A,backendName:"webgl",kernelFunc:o9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u9=hl({opSnippet:`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`}),l9={kernelName:nt,backendName:"webgl",kernelFunc:u9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c9=hl({opSnippet:`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`}),f9={kernelName:Pe,backendName:"webgl",kernelFunc:c9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h9={kernelName:wn,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockShape:h,paddings:p}=o;yt(u.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const g=h.reduce((ue,ye)=>ue*ye),x=[[0,0]];x.push(...p);for(let ue=1+h.length;ue<u.shape.length;++ue)x.push([0,0]);const I=[],z=kD({inputs:{x:u},backend:n,attrs:{paddings:x,constantValue:0}}),V=E0(z.shape,h,g,!1),rt=Im(V.length,h.length,!1),Et=Hv(z.shape,h,g,!1),St=ko({inputs:{x:z},backend:n,attrs:{shape:V}}),Tt=Nd({inputs:{x:St},backend:n,attrs:{perm:rt}}),Vt=ko({inputs:{x:Tt},backend:n,attrs:{shape:Et}});return I.push(z),I.push(St),I.push(Tt),I.forEach(ue=>n.disposeIntermediateTensorInfo(ue)),Vt}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d9(r){const{inputs:t,backend:n,attrs:o}=r,{sparseIndices:u,sparseValues:h,defaultValue:p}=t,{outputShape:g}=o,{sliceRank:x,numUpdates:I,strides:z,outputSize:V}=Bl(h,u,g),rt=!1,Et=new OD(I,x,u.shape.length,h.shape.length,z,[V,1],rt),St=n.runWebGLProgram(Et,[h,u,p],h.dtype),Tt=ko({inputs:{x:St},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(St),Tt}const p9={kernelName:ua,backendName:"webgl",kernelFunc:d9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v9(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{numOrSizeSplits:h,axis:p}=o,g=Rr(p,u.shape)[0],x=Dy(u,h,g),I=u.shape.length,z=new Array(I).fill(0),V=u.shape.slice();return x.map(rt=>{const Et=[...V];Et[g]=rt;const St=Mx({inputs:{x:u},backend:n,attrs:{begin:z,size:Et}});return z[g]+=rt,St})}const g9={kernelName:kn,backendName:"webgl",kernelFunc:v9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m9=hl({opSnippet:"return sqrt(x);"}),y9={kernelName:Qe,backendName:"webgl",kernelFunc:m9};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b9=hl({opSnippet:"return x * x;"}),x9={kernelName:ca,backendName:"webgl",kernelFunc:b9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RD="return (a - b) * (a - b);",w9=dh({opSnippet:RD,packedOpSnippet:RD}),E9={kernelName:wr,backendName:"webgl",kernelFunc:w9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S9({inputs:r,attrs:t,backend:n}){const{x:o}=r,u=Ev+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,h=new zm(o.shape,u);return n.runWebGLProgram(h,[o],o.dtype)}const C9={kernelName:zu,backendName:"webgl",kernelFunc:S9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _9{constructor(t,n,o){this.variableNames=["x"],this.outputShape=o;const u=o.length,h=ac(o.length),p=ac(o.length);let g="";if(u===1)g="coords * strides + begin";else{let x=0;g=o.map((I,z)=>(x++,o.length===1?`coords * strides[${z}] + begin[${z}]`:`coords[${x-1}] * strides[${z}] + begin[${z}]`)).join(",")}this.userCode=`
      ${h} begin = ${h}(${t});
      ${h} strides = ${h}(${n});

      void main() {
        ${p} coords = getOutputCoords();
        setOutput(getX(${g}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I9(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{begin:h,end:p,strides:g,beginMask:x,endMask:I,ellipsisMask:z,newAxisMask:V,shrinkAxisMask:rt}=o,{nonStrided:Et,$begin:St,$strides:Tt,size:Vt,newShape:ue,outShape:ye}=nv(u.shape,h,p,g,x,I,z,V,rt),qe=ko({inputs:{x:u},backend:n,attrs:{shape:ue}});let $e;if(Et){const Pn=Mx({inputs:{x:qe},backend:n,attrs:{begin:St,size:Vt}});$e=ko({inputs:{x:Pn},backend:n,attrs:{shape:ye}}),n.disposeIntermediateTensorInfo(Pn)}else if(ye.some(Pn=>Pn===0))$e=n.makeTensorInfo(ye,u.dtype,[]);else if(n.shouldExecuteOnCPU([qe])){const gr=n.texData.get(qe.dataId).values,Br=vs(qe.shape,qe.dtype,gr),Kr=b6(ye,Br,Tt,St);$e=n.makeTensorInfo(ye,qe.dtype,Kr.values)}else{const In=new _9(St,Tt,ye);$e=n.runWebGLProgram(In,[qe],qe.dtype)}const Xe=ko({inputs:{x:$e},backend:n,attrs:{shape:ye}});return n.disposeIntermediateTensorInfo(qe),n.disposeIntermediateTensorInfo($e),Xe}const T9={kernelName:$a,backendName:"webgl",kernelFunc:I9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A9=hl({opSnippet:"return tan(x);"}),M9={kernelName:ri,backendName:"webgl",kernelFunc:A9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N9=hl({opSnippet:`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`}),k9={kernelName:ba,backendName:"webgl",kernelFunc:N9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D9{constructor(t,n){this.variableNames=["A"];const o=new Array(t.length);for(let p=0;p<o.length;p++)o[p]=t[p]*n[p];this.outputShape=o,this.rank=o.length;const u=ac(this.rank),h=O9(t);this.userCode=`
      void main() {
        ${u} resRC = getOutputCoords();
        setOutput(getA(${h}));
      }
    `}}function O9(r){const t=r.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${r[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],o=[];for(let u=0;u<r.length;u++)o.push(`imod(${n[u]}, ${r[u]})`);return o.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LD(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{reps:h}=o;if(u.dtype==="string"){const I=n.readSync(u.dataId).map(rt=>Ot(rt)),z=vs(u.shape,u.dtype,I),V=w6(z,h);return n.makeTensorInfo(V.shape,V.dtype,V.values)}const p=new D9(u.shape,h);return n.runWebGLProgram(p,[u],u.dtype)}const R9={kernelName:ki,backendName:"webgl",kernelFunc:LD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L9(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{k:h,sorted:p}=o,g=n.readSync(u.dataId),[x,I]=E6(g,u.shape,u.dtype,h,p);return[n.makeTensorInfo(x.shape,x.dtype,x.values),n.makeTensorInfo(I.shape,I.dtype,I.values)]}const P9={kernelName:Eo,backendName:"webgl",kernelFunc:L9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F9(r){const{inputs:t,attrs:n,backend:o}=r,{axis:u}=n,{x:h}=t;_x(h,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const p=o.readSync(h.dataId),{outputValues:g,outputShape:x,indices:I}=S6(p,u,h.shape,h.dtype);return[o.makeTensorInfo(x,h.dtype,g),o.makeTensorInfo([I.length],"int32",I)]}const B9={kernelName:Bo,backendName:"webgl",kernelFunc:F9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9(r){const{inputs:t,backend:n,attrs:o}=r,{value:u}=t;let{axis:h}=o;h<0&&(h+=u.shape.length);const p=u,g=p.shape.length,x=u.shape[h],I=new Array(g-1);let z=0;for(let Tt=0;Tt<g;Tt++)Tt!==h&&(I[z++]=p.shape[Tt]);const V=[],rt=new Array(g).fill(0),Et=p.shape.slice();Et[h]=1;const St=new Array(x);for(let Tt=0;Tt<St.length;Tt++){rt[h]=Tt;const Vt=Mx({inputs:{x:p},backend:n,attrs:{begin:rt,size:Et}}),ue=ko({inputs:{x:Vt},backend:n,attrs:{shape:I}});St[Tt]=ue,V.push(Vt)}return V.forEach(Tt=>n.disposeIntermediateTensorInfo(Tt)),St}const $9={kernelName:go,backendName:"webgl",kernelFunc:z9};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G9{constructor(t,n){this.variableNames=["x","segmentIds"];const o=t.windowSize,u=t.batchSize,h=t.inSize,p=t.numSegments,g=p*Math.ceil(h/o);this.outputShape=[u,g];const x="0.0",I="sumValue",z=Math.floor(o/4)*4,V=o%4,rt=`
        sumValue += dot(values, segFilter);
    `;let Et="";h%o>0&&(Et=`
        if (inIdx < 0 || inIdx >= ${h}) {
          return initializationValue;
        }
      `);let St="";h%o>0&&(St=`
        if (inIdx < 0 || inIdx >= ${h}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${x};

      float getValue(int batch, int inIdx) {
        ${Et}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${St}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${p})) * float(${o}));
        int currentSeg = int(mod(float(outIdx), float(${p})));

        float sumValue = 0.0;

        for (int i = 0; i < ${z}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${rt}
        }

        int inIdx = inOffset + ${z};
        if (${V===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${rt}
        } else if (${V===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${rt}
        } else if (${V===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${rt}
        }
        setOutput(${I});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U9(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,segmentIds:h}=t,{numSegments:p}=o,g=u.shape.length,x=[];let I=0;const z=$c([I],g);let V=u;z!=null&&(V=Nd({inputs:{x:u},backend:n,attrs:{perm:z}}),x.push(V),I=gc(1,g)[0]);const rt=Ib(V.shape,I,p),Et=Rt([V.shape[I]]),St=ko({inputs:{x:V},backend:n,attrs:{shape:[-1,Et]}});x.push(St);const Tt=jo(u.dtype),Vt=($e,Xe,Pn,In,gr)=>{const Br=$e.shape[0],Kr=$e.shape[1],Na=Kv(Kr,gr),Ya={windowSize:Na,inSize:Kr,batchSize:Br,numSegments:gr},Ha=new G9(Ya,Xe),ni=n.compileAndRun(Ha,[$e,Pn],In);if(x.push(ni),ni.shape[1]===gr)return ni;const Wa=DD({backend:n,attrs:{start:0,stop:gr,step:1,dtype:"float32"}}),za=LD({inputs:{x:Wa},backend:n,attrs:{reps:[Kr/Na]}});return x.push(Wa),x.push(za),Vt(ni,Xe,za,In,gr)},ue=Vt(St,"unsortedSegmentSum",h,Tt,p),ye=ko({inputs:{x:ue},backend:n,attrs:{shape:rt}});let qe=ye;if(z!=null){x.push(ye);const $e=mm(z);qe=Nd({inputs:{x:qe},backend:n,attrs:{perm:$e}})}return x.forEach($e=>n.disposeIntermediateTensorInfo($e)),qe}const W9={kernelName:Ao,backendName:"webgl",kernelFunc:U9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V9=[eV,rV,wG,SG,IG,MG,kG,RG,PG,BG,UG,VG,XG,ZG,r8,JG,o8,c8,u8,p8,g8,y8,w8,T8,M8,R8,P8,$8,W8,nG,X8,rU,iU,q8,lU,fU,sU,pU,gU,yU,xU,EU,_U,kU,OU,TU,PU,zU,GU,VU,HU,KU,ZU,qU,JU,eW,rW,iW,sW,lW,hW,vW,mW,xW,CW,IW,AW,eG,NW,H8,DW,RW,PW,aG,BW,$W,UW,HW,VW,YW,ZW,QW,iV,dV,fV,mV,bV,wV,lV,SV,_V,MV,DV,PV,UV,lG,VV,XV,ZV,JV,N8,e7,r7,i7,u7,h7,oG,p7,v7,k8,BV,m7,S7,x7,fG,T7,N7,O7,P7,$7,U7,V7,H7,Y7,q7,t9,n9,a9,s9,l9,I8,$V,f9,h9,p9,g9,y9,x9,E9,C9,T9,zV,yG,M9,k9,R9,P9,bG,B9,$9,W9,n7];for(const r of V9)Uc(r);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//** @license See the LICENSE file. */const j9="2.8.6";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H9={"tfjs-core":er,"tfjs-backend-cpu":PP,"tfjs-backend-webgl":J6,"tfjs-data":CN,"tfjs-layers":Qg,"tfjs-converter":aN,tfjs:j9}},91220:function(sr,it,$){"use strict";$.d(it,{Z:function(){return tt}});var X=$(64254);function tt(j,W){var Q=typeof Symbol!="undefined"&&j[Symbol.iterator]||j["@@iterator"];if(!Q){if(Array.isArray(j)||(Q=(0,X.Z)(j))||W&&j&&typeof j.length=="number"){Q&&(j=Q);var Z=0,L=function(){};return{s:L,n:function(){return Z>=j.length?{done:!0}:{done:!1,value:j[Z++]}},e:function(B){throw B},f:L}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,C=!1,M;return{s:function(){Q=Q.call(j)},n:function(){var B=Q.next();return P=B.done,B},e:function(B){C=!0,M=B},f:function(){try{!P&&Q.return!=null&&Q.return()}finally{if(C)throw M}}}}},90314:function(){},10410:function(){},94635:function(){},81355:function(){},50596:function(){},66247:function(){},63252:function(){},37674:function(sr,it,$){"use strict";$.r(it),$.d(it,{forceCenter:function(){return X},forceCollide:function(){return L},forceLink:function(){return M},forceManyBody:function(){return te},forceRadial:function(){return Me},forceSimulation:function(){return Ge},forceX:function(){return We},forceY:function(){return ee}});function X(Pt,yt){var Ne,tn=1;Pt==null&&(Pt=0),yt==null&&(yt=0);function fn(){var Rt,Yn=Ne.length,Un,xr=0,cr=0;for(Rt=0;Rt<Yn;++Rt)Un=Ne[Rt],xr+=Un.x,cr+=Un.y;for(xr=(xr/Yn-Pt)*tn,cr=(cr/Yn-yt)*tn,Rt=0;Rt<Yn;++Rt)Un=Ne[Rt],Un.x-=xr,Un.y-=cr}return fn.initialize=function(Rt){Ne=Rt},fn.x=function(Rt){return arguments.length?(Pt=+Rt,fn):Pt},fn.y=function(Rt){return arguments.length?(yt=+Rt,fn):yt},fn.strength=function(Rt){return arguments.length?(tn=+Rt,fn):tn},fn}var tt=$(88863);function j(Pt){return function(){return Pt}}function W(Pt){return(Pt()-.5)*1e-6}function Q(Pt){return Pt.x+Pt.vx}function Z(Pt){return Pt.y+Pt.vy}function L(Pt){var yt,Ne,tn,fn=1,Rt=1;typeof Pt!="function"&&(Pt=j(Pt==null?1:+Pt));function Yn(){for(var cr,Ur=yt.length,fa,Sa,sa,Da,Rr,Mn,ar=0;ar<Rt;++ar)for(fa=(0,tt.Z)(yt,Q,Z).visitAfter(Un),cr=0;cr<Ur;++cr)Sa=yt[cr],Rr=Ne[Sa.index],Mn=Rr*Rr,sa=Sa.x+Sa.vx,Da=Sa.y+Sa.vy,fa.visit(Fn);function Fn(tr,Gn,jr,Hr,Ea){var lr=tr.data,Cr=tr.r,vr=Rr+Cr;if(lr){if(lr.index>Sa.index){var Tr=sa-lr.x-lr.vx,ta=Da-lr.y-lr.vy,ra=Tr*Tr+ta*ta;ra<vr*vr&&(Tr===0&&(Tr=W(tn),ra+=Tr*Tr),ta===0&&(ta=W(tn),ra+=ta*ta),ra=(vr-(ra=Math.sqrt(ra)))/ra*fn,Sa.vx+=(Tr*=ra)*(vr=(Cr*=Cr)/(Mn+Cr)),Sa.vy+=(ta*=ra)*vr,lr.vx-=Tr*(vr=1-vr),lr.vy-=ta*vr)}return}return Gn>sa+vr||Hr<sa-vr||jr>Da+vr||Ea<Da-vr}}function Un(cr){if(cr.data)return cr.r=Ne[cr.data.index];for(var Ur=cr.r=0;Ur<4;++Ur)cr[Ur]&&cr[Ur].r>cr.r&&(cr.r=cr[Ur].r)}function xr(){if(!!yt){var cr,Ur=yt.length,fa;for(Ne=new Array(Ur),cr=0;cr<Ur;++cr)fa=yt[cr],Ne[fa.index]=+Pt(fa,cr,yt)}}return Yn.initialize=function(cr,Ur){yt=cr,tn=Ur,xr()},Yn.iterations=function(cr){return arguments.length?(Rt=+cr,Yn):Rt},Yn.strength=function(cr){return arguments.length?(fn=+cr,Yn):fn},Yn.radius=function(cr){return arguments.length?(Pt=typeof cr=="function"?cr:j(+cr),xr(),Yn):Pt},Yn}function P(Pt){return Pt.index}function C(Pt,yt){var Ne=Pt.get(yt);if(!Ne)throw new Error("node not found: "+yt);return Ne}function M(Pt){var yt=P,Ne=fa,tn,fn=j(30),Rt,Yn,Un,xr,cr,Ur=1;Pt==null&&(Pt=[]);function fa(Mn){return 1/Math.min(Un[Mn.source.index],Un[Mn.target.index])}function Sa(Mn){for(var ar=0,Fn=Pt.length;ar<Ur;++ar)for(var tr=0,Gn,jr,Hr,Ea,lr,Cr,vr;tr<Fn;++tr)Gn=Pt[tr],jr=Gn.source,Hr=Gn.target,Ea=Hr.x+Hr.vx-jr.x-jr.vx||W(cr),lr=Hr.y+Hr.vy-jr.y-jr.vy||W(cr),Cr=Math.sqrt(Ea*Ea+lr*lr),Cr=(Cr-Rt[tr])/Cr*Mn*tn[tr],Ea*=Cr,lr*=Cr,Hr.vx-=Ea*(vr=xr[tr]),Hr.vy-=lr*vr,jr.vx+=Ea*(vr=1-vr),jr.vy+=lr*vr}function sa(){if(!!Yn){var Mn,ar=Yn.length,Fn=Pt.length,tr=new Map(Yn.map(function(jr,Hr){return[yt(jr,Hr,Yn),jr]})),Gn;for(Mn=0,Un=new Array(ar);Mn<Fn;++Mn)Gn=Pt[Mn],Gn.index=Mn,typeof Gn.source!="object"&&(Gn.source=C(tr,Gn.source)),typeof Gn.target!="object"&&(Gn.target=C(tr,Gn.target)),Un[Gn.source.index]=(Un[Gn.source.index]||0)+1,Un[Gn.target.index]=(Un[Gn.target.index]||0)+1;for(Mn=0,xr=new Array(Fn);Mn<Fn;++Mn)Gn=Pt[Mn],xr[Mn]=Un[Gn.source.index]/(Un[Gn.source.index]+Un[Gn.target.index]);tn=new Array(Fn),Da(),Rt=new Array(Fn),Rr()}}function Da(){if(!!Yn)for(var Mn=0,ar=Pt.length;Mn<ar;++Mn)tn[Mn]=+Ne(Pt[Mn],Mn,Pt)}function Rr(){if(!!Yn)for(var Mn=0,ar=Pt.length;Mn<ar;++Mn)Rt[Mn]=+fn(Pt[Mn],Mn,Pt)}return Sa.initialize=function(Mn,ar){Yn=Mn,cr=ar,sa()},Sa.links=function(Mn){return arguments.length?(Pt=Mn,sa(),Sa):Pt},Sa.id=function(Mn){return arguments.length?(yt=Mn,Sa):yt},Sa.iterations=function(Mn){return arguments.length?(Ur=+Mn,Sa):Ur},Sa.strength=function(Mn){return arguments.length?(Ne=typeof Mn=="function"?Mn:j(+Mn),Da(),Sa):Ne},Sa.distance=function(Mn){return arguments.length?(fn=typeof Mn=="function"?Mn:j(+Mn),Rr(),Sa):fn},Sa}var k={value:function(){}};function B(){for(var Pt=0,yt=arguments.length,Ne={},tn;Pt<yt;++Pt){if(!(tn=arguments[Pt]+"")||tn in Ne||/[\s.]/.test(tn))throw new Error("illegal type: "+tn);Ne[tn]=[]}return new R(Ne)}function R(Pt){this._=Pt}function F(Pt,yt){return Pt.trim().split(/^|\s+/).map(function(Ne){var tn="",fn=Ne.indexOf(".");if(fn>=0&&(tn=Ne.slice(fn+1),Ne=Ne.slice(0,fn)),Ne&&!yt.hasOwnProperty(Ne))throw new Error("unknown type: "+Ne);return{type:Ne,name:tn}})}R.prototype=B.prototype={constructor:R,on:function(yt,Ne){var tn=this._,fn=F(yt+"",tn),Rt,Yn=-1,Un=fn.length;if(arguments.length<2){for(;++Yn<Un;)if((Rt=(yt=fn[Yn]).type)&&(Rt=K(tn[Rt],yt.name)))return Rt;return}if(Ne!=null&&typeof Ne!="function")throw new Error("invalid callback: "+Ne);for(;++Yn<Un;)if(Rt=(yt=fn[Yn]).type)tn[Rt]=O(tn[Rt],yt.name,Ne);else if(Ne==null)for(Rt in tn)tn[Rt]=O(tn[Rt],yt.name,null);return this},copy:function(){var yt={},Ne=this._;for(var tn in Ne)yt[tn]=Ne[tn].slice();return new R(yt)},call:function(yt,Ne){if((Rt=arguments.length-2)>0)for(var tn=new Array(Rt),fn=0,Rt,Yn;fn<Rt;++fn)tn[fn]=arguments[fn+2];if(!this._.hasOwnProperty(yt))throw new Error("unknown type: "+yt);for(Yn=this._[yt],fn=0,Rt=Yn.length;fn<Rt;++fn)Yn[fn].value.apply(Ne,tn)},apply:function(yt,Ne,tn){if(!this._.hasOwnProperty(yt))throw new Error("unknown type: "+yt);for(var fn=this._[yt],Rt=0,Yn=fn.length;Rt<Yn;++Rt)fn[Rt].value.apply(Ne,tn)}};function K(Pt,yt){for(var Ne=0,tn=Pt.length,fn;Ne<tn;++Ne)if((fn=Pt[Ne]).name===yt)return fn.value}function O(Pt,yt,Ne){for(var tn=0,fn=Pt.length;tn<fn;++tn)if(Pt[tn].name===yt){Pt[tn]=k,Pt=Pt.slice(0,tn).concat(Pt.slice(tn+1));break}return Ne!=null&&Pt.push({name:yt,value:Ne}),Pt}var _=B,ft=0,mt=0,st=0,ut=1e3,dt,gt,wt=0,ot=0,pt=0,Nt=typeof performance=="object"&&performance.now?performance:Date,Gt=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(Pt){setTimeout(Pt,17)};function se(){return ot||(Gt(ie),ot=Nt.now()+pt)}function ie(){ot=0}function Be(){this._call=this._time=this._next=null}Be.prototype=ke.prototype={constructor:Be,restart:function(Pt,yt,Ne){if(typeof Pt!="function")throw new TypeError("callback is not a function");Ne=(Ne==null?se():+Ne)+(yt==null?0:+yt),!this._next&&gt!==this&&(gt?gt._next=this:dt=this,gt=this),this._call=Pt,this._time=Ne,nn()},stop:function(){this._call&&(this._call=null,this._time=Infinity,nn())}};function ke(Pt,yt,Ne){var tn=new Be;return tn.restart(Pt,yt,Ne),tn}function we(){se(),++ft;for(var Pt=dt,yt;Pt;)(yt=ot-Pt._time)>=0&&Pt._call.call(null,yt),Pt=Pt._next;--ft}function At(){ot=(wt=Nt.now())+pt,ft=mt=0;try{we()}finally{ft=0,be(),ot=0}}function Yt(){var Pt=Nt.now(),yt=Pt-wt;yt>ut&&(pt-=yt,wt=Pt)}function be(){for(var Pt,yt=dt,Ne,tn=Infinity;yt;)yt._call?(tn>yt._time&&(tn=yt._time),Pt=yt,yt=yt._next):(Ne=yt._next,yt._next=null,yt=Pt?Pt._next=Ne:dt=Ne);gt=Pt,nn(tn)}function nn(Pt){if(!ft){mt&&(mt=clearTimeout(mt));var yt=Pt-ot;yt>24?(Pt<Infinity&&(mt=setTimeout(At,Pt-Nt.now()-pt)),st&&(st=clearInterval(st))):(st||(wt=Nt.now(),st=setInterval(Yt,ut)),ft=1,Gt(At))}}var Ee=1664525,le=1013904223,Le=4294967296;function Ze(){var Pt=1;return function(){return(Pt=(Ee*Pt+le)%Le)/Le}}function fe(Pt){return Pt.x}function Re(Pt){return Pt.y}var He=10,pe=Math.PI*(3-Math.sqrt(5));function Ge(Pt){var yt,Ne=1,tn=.001,fn=1-Math.pow(tn,1/300),Rt=0,Yn=.6,Un=new Map,xr=ke(fa),cr=_("tick","end"),Ur=Ze();Pt==null&&(Pt=[]);function fa(){Sa(),cr.call("tick",yt),Ne<tn&&(xr.stop(),cr.call("end",yt))}function Sa(Rr){var Mn,ar=Pt.length,Fn;Rr===void 0&&(Rr=1);for(var tr=0;tr<Rr;++tr)for(Ne+=(Rt-Ne)*fn,Un.forEach(function(Gn){Gn(Ne)}),Mn=0;Mn<ar;++Mn)Fn=Pt[Mn],Fn.fx==null?Fn.x+=Fn.vx*=Yn:(Fn.x=Fn.fx,Fn.vx=0),Fn.fy==null?Fn.y+=Fn.vy*=Yn:(Fn.y=Fn.fy,Fn.vy=0);return yt}function sa(){for(var Rr=0,Mn=Pt.length,ar;Rr<Mn;++Rr){if(ar=Pt[Rr],ar.index=Rr,ar.fx!=null&&(ar.x=ar.fx),ar.fy!=null&&(ar.y=ar.fy),isNaN(ar.x)||isNaN(ar.y)){var Fn=He*Math.sqrt(.5+Rr),tr=Rr*pe;ar.x=Fn*Math.cos(tr),ar.y=Fn*Math.sin(tr)}(isNaN(ar.vx)||isNaN(ar.vy))&&(ar.vx=ar.vy=0)}}function Da(Rr){return Rr.initialize&&Rr.initialize(Pt,Ur),Rr}return sa(),yt={tick:Sa,restart:function(){return xr.restart(fa),yt},stop:function(){return xr.stop(),yt},nodes:function(Mn){return arguments.length?(Pt=Mn,sa(),Un.forEach(Da),yt):Pt},alpha:function(Mn){return arguments.length?(Ne=+Mn,yt):Ne},alphaMin:function(Mn){return arguments.length?(tn=+Mn,yt):tn},alphaDecay:function(Mn){return arguments.length?(fn=+Mn,yt):+fn},alphaTarget:function(Mn){return arguments.length?(Rt=+Mn,yt):Rt},velocityDecay:function(Mn){return arguments.length?(Yn=1-Mn,yt):1-Yn},randomSource:function(Mn){return arguments.length?(Ur=Mn,Un.forEach(Da),yt):Ur},force:function(Mn,ar){return arguments.length>1?(ar==null?Un.delete(Mn):Un.set(Mn,Da(ar)),yt):Un.get(Mn)},find:function(Mn,ar,Fn){var tr=0,Gn=Pt.length,jr,Hr,Ea,lr,Cr;for(Fn==null?Fn=Infinity:Fn*=Fn,tr=0;tr<Gn;++tr)lr=Pt[tr],jr=Mn-lr.x,Hr=ar-lr.y,Ea=jr*jr+Hr*Hr,Ea<Fn&&(Cr=lr,Fn=Ea);return Cr},on:function(Mn,ar){return arguments.length>1?(cr.on(Mn,ar),yt):cr.on(Mn)}}}function te(){var Pt,yt,Ne,tn,fn=j(-30),Rt,Yn=1,Un=Infinity,xr=.81;function cr(sa){var Da,Rr=Pt.length,Mn=(0,tt.Z)(Pt,fe,Re).visitAfter(fa);for(tn=sa,Da=0;Da<Rr;++Da)yt=Pt[Da],Mn.visit(Sa)}function Ur(){if(!!Pt){var sa,Da=Pt.length,Rr;for(Rt=new Array(Da),sa=0;sa<Da;++sa)Rr=Pt[sa],Rt[Rr.index]=+fn(Rr,sa,Pt)}}function fa(sa){var Da=0,Rr,Mn,ar=0,Fn,tr,Gn;if(sa.length){for(Fn=tr=Gn=0;Gn<4;++Gn)(Rr=sa[Gn])&&(Mn=Math.abs(Rr.value))&&(Da+=Rr.value,ar+=Mn,Fn+=Mn*Rr.x,tr+=Mn*Rr.y);sa.x=Fn/ar,sa.y=tr/ar}else{Rr=sa,Rr.x=Rr.data.x,Rr.y=Rr.data.y;do Da+=Rt[Rr.data.index];while(Rr=Rr.next)}sa.value=Da}function Sa(sa,Da,Rr,Mn){if(!sa.value)return!0;var ar=sa.x-yt.x,Fn=sa.y-yt.y,tr=Mn-Da,Gn=ar*ar+Fn*Fn;if(tr*tr/xr<Gn)return Gn<Un&&(ar===0&&(ar=W(Ne),Gn+=ar*ar),Fn===0&&(Fn=W(Ne),Gn+=Fn*Fn),Gn<Yn&&(Gn=Math.sqrt(Yn*Gn)),yt.vx+=ar*sa.value*tn/Gn,yt.vy+=Fn*sa.value*tn/Gn),!0;if(sa.length||Gn>=Un)return;(sa.data!==yt||sa.next)&&(ar===0&&(ar=W(Ne),Gn+=ar*ar),Fn===0&&(Fn=W(Ne),Gn+=Fn*Fn),Gn<Yn&&(Gn=Math.sqrt(Yn*Gn)));do sa.data!==yt&&(tr=Rt[sa.data.index]*tn/Gn,yt.vx+=ar*tr,yt.vy+=Fn*tr);while(sa=sa.next)}return cr.initialize=function(sa,Da){Pt=sa,Ne=Da,Ur()},cr.strength=function(sa){return arguments.length?(fn=typeof sa=="function"?sa:j(+sa),Ur(),cr):fn},cr.distanceMin=function(sa){return arguments.length?(Yn=sa*sa,cr):Math.sqrt(Yn)},cr.distanceMax=function(sa){return arguments.length?(Un=sa*sa,cr):Math.sqrt(Un)},cr.theta=function(sa){return arguments.length?(xr=sa*sa,cr):Math.sqrt(xr)},cr}function Me(Pt,yt,Ne){var tn,fn=j(.1),Rt,Yn;typeof Pt!="function"&&(Pt=j(+Pt)),yt==null&&(yt=0),Ne==null&&(Ne=0);function Un(cr){for(var Ur=0,fa=tn.length;Ur<fa;++Ur){var Sa=tn[Ur],sa=Sa.x-yt||1e-6,Da=Sa.y-Ne||1e-6,Rr=Math.sqrt(sa*sa+Da*Da),Mn=(Yn[Ur]-Rr)*Rt[Ur]*cr/Rr;Sa.vx+=sa*Mn,Sa.vy+=Da*Mn}}function xr(){if(!!tn){var cr,Ur=tn.length;for(Rt=new Array(Ur),Yn=new Array(Ur),cr=0;cr<Ur;++cr)Yn[cr]=+Pt(tn[cr],cr,tn),Rt[cr]=isNaN(Yn[cr])?0:+fn(tn[cr],cr,tn)}}return Un.initialize=function(cr){tn=cr,xr()},Un.strength=function(cr){return arguments.length?(fn=typeof cr=="function"?cr:j(+cr),xr(),Un):fn},Un.radius=function(cr){return arguments.length?(Pt=typeof cr=="function"?cr:j(+cr),xr(),Un):Pt},Un.x=function(cr){return arguments.length?(yt=+cr,Un):yt},Un.y=function(cr){return arguments.length?(Ne=+cr,Un):Ne},Un}function We(Pt){var yt=j(.1),Ne,tn,fn;typeof Pt!="function"&&(Pt=j(Pt==null?0:+Pt));function Rt(Un){for(var xr=0,cr=Ne.length,Ur;xr<cr;++xr)Ur=Ne[xr],Ur.vx+=(fn[xr]-Ur.x)*tn[xr]*Un}function Yn(){if(!!Ne){var Un,xr=Ne.length;for(tn=new Array(xr),fn=new Array(xr),Un=0;Un<xr;++Un)tn[Un]=isNaN(fn[Un]=+Pt(Ne[Un],Un,Ne))?0:+yt(Ne[Un],Un,Ne)}}return Rt.initialize=function(Un){Ne=Un,Yn()},Rt.strength=function(Un){return arguments.length?(yt=typeof Un=="function"?Un:j(+Un),Yn(),Rt):yt},Rt.x=function(Un){return arguments.length?(Pt=typeof Un=="function"?Un:j(+Un),Yn(),Rt):Pt},Rt}function ee(Pt){var yt=j(.1),Ne,tn,fn;typeof Pt!="function"&&(Pt=j(Pt==null?0:+Pt));function Rt(Un){for(var xr=0,cr=Ne.length,Ur;xr<cr;++xr)Ur=Ne[xr],Ur.vy+=(fn[xr]-Ur.y)*tn[xr]*Un}function Yn(){if(!!Ne){var Un,xr=Ne.length;for(tn=new Array(xr),fn=new Array(xr),Un=0;Un<xr;++Un)tn[Un]=isNaN(fn[Un]=+Pt(Ne[Un],Un,Ne))?0:+yt(Ne[Un],Un,Ne)}}return Rt.initialize=function(Un){Ne=Un,Yn()},Rt.strength=function(Un){return arguments.length?(yt=typeof Un=="function"?Un:j(+Un),Yn(),Rt):yt},Rt.y=function(Un){return arguments.length?(Pt=typeof Un=="function"?Un:j(+Un),Yn(),Rt):Pt},Rt}},52710:function(sr,it,$){"use strict";$.r(it),$.d(it,{AbstractMatrix:function(){return te},CHO:function(){return _n},CholeskyDecomposition:function(){return _n},EVD:function(){return vr},EigenvalueDecomposition:function(){return vr},LU:function(){return sa},LuDecomposition:function(){return sa},Matrix:function(){return ee},MatrixColumnSelectionView:function(){return Ne},MatrixColumnView:function(){return yt},MatrixFlipColumnView:function(){return tn},MatrixFlipRowView:function(){return fn},MatrixRowSelectionView:function(){return Yn},MatrixRowView:function(){return Rt},MatrixSelectionView:function(){return Un},MatrixSubView:function(){return xr},MatrixTransposeView:function(){return cr},NIPALS:function(){return an},Nipals:function(){return an},QR:function(){return Rr},QrDecomposition:function(){return Rr},SVD:function(){return Mn},SingularValueDecomposition:function(){return Mn},WrapperMatrix1D:function(){return Ur},WrapperMatrix2D:function(){return fa},correlation:function(){return Cr},covariance:function(){return lr},default:function(){return ee},determinant:function(){return tr},inverse:function(){return ar},linearDependencies:function(){return Hr},pseudoInverse:function(){return Ea},solve:function(){return Fn},wrap:function(){return Sa}});var X=$(32926),tt=$(81306),j=$(59206),W=$(69610),Q=$(54941);const Z=Object.prototype.toString;function L(Lt){const kt=Z.call(Lt);return kt.endsWith("Array]")&&!kt.includes("Big")}function P(Lt){var kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!L(Lt))throw new TypeError("input must be an array");if(Lt.length===0)throw new TypeError("input must not be empty");var at=kt.fromIndex,H=at===void 0?0:at,Y=kt.toIndex,bt=Y===void 0?Lt.length:Y;if(H<0||H>=Lt.length||!Number.isInteger(H))throw new Error("fromIndex must be a positive integer smaller than length");if(bt<=H||bt>Lt.length||!Number.isInteger(bt))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var $t=Lt[H],jt=H+1;jt<bt;jt++)Lt[jt]>$t&&($t=Lt[jt]);return $t}function C(Lt){var kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!L(Lt))throw new TypeError("input must be an array");if(Lt.length===0)throw new TypeError("input must not be empty");var at=kt.fromIndex,H=at===void 0?0:at,Y=kt.toIndex,bt=Y===void 0?Lt.length:Y;if(H<0||H>=Lt.length||!Number.isInteger(H))throw new Error("fromIndex must be a positive integer smaller than length");if(bt<=H||bt>Lt.length||!Number.isInteger(bt))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var $t=Lt[H],jt=H+1;jt<bt;jt++)Lt[jt]<$t&&($t=Lt[jt]);return $t}function M(Lt){var kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(L(Lt)){if(Lt.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var at;if(kt.output!==void 0){if(!L(kt.output))throw new TypeError("output option must be an array if specified");at=kt.output}else at=new Array(Lt.length);var H=C(Lt),Y=P(Lt);if(H===Y)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var bt=kt.min,$t=bt===void 0?kt.autoMinMax?H:0:bt,jt=kt.max,Ht=jt===void 0?kt.autoMinMax?Y:1:jt;if($t>=Ht)throw new RangeError("min option must be smaller than max option");for(var re=(Ht-$t)/(Y-H),on=0;on<Lt.length;on++)at[on]=(Lt[on]-H)*re+$t;return at}var k=" ".repeat(2),B=" ".repeat(4);function R(){return F(this)}function F(Lt){var kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},at=kt.maxRows,H=at===void 0?15:at,Y=kt.maxColumns,bt=Y===void 0?10:Y,$t=kt.maxNumSize,jt=$t===void 0?8:$t,Ht=kt.padMinus,re=Ht===void 0?"auto":Ht;return"".concat(Lt.constructor.name,` {
`).concat(k,`[
`).concat(B).concat(K(Lt,H,bt,jt,re),`
`).concat(k,`]
`).concat(k,"rows: ").concat(Lt.rows,`
`).concat(k,"columns: ").concat(Lt.columns,`
}`)}function K(Lt,kt,at,H,Y){var bt=Lt.rows,$t=Lt.columns,jt=Math.min(bt,kt),Ht=Math.min($t,at),re=[];if(Y==="auto"){Y=!1;t:for(var on=0;on<jt;on++)for(var Je=0;Je<Ht;Je++)if(Lt.get(on,Je)<0){Y=!0;break t}}for(var Ve=0;Ve<jt;Ve++){for(var qn=[],Ln=0;Ln<Ht;Ln++)qn.push(O(Lt.get(Ve,Ln),H,Y));re.push("".concat(qn.join(" ")))}return Ht!==$t&&(re[re.length-1]+=" ... ".concat($t-at," more columns")),jt!==bt&&re.push("... ".concat(bt-kt," more rows")),re.join(`
`.concat(B))}function O(Lt,kt,at){return(Lt>=0&&at?" ".concat(_(Lt,kt-1)):_(Lt,kt)).padEnd(kt)}function _(Lt,kt){var at=Lt.toString();if(at.length<=kt)return at;var H=Lt.toFixed(kt);if(H.length>kt&&(H=Lt.toFixed(Math.max(0,kt-(H.length-kt)))),H.length<=kt&&!H.startsWith("0.000")&&!H.startsWith("-0.000"))return H;var Y=Lt.toExponential(kt);return Y.length>kt&&(Y=Lt.toExponential(Math.max(0,kt-(Y.length-kt)))),Y.slice(0)}function ft(Lt,kt){Lt.prototype.add=function(H){return typeof H=="number"?this.addS(H):this.addM(H)},Lt.prototype.addS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)+H);return this},Lt.prototype.addM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)+H.get(Y,bt));return this},Lt.add=function(H,Y){var bt=new kt(H);return bt.add(Y)},Lt.prototype.sub=function(H){return typeof H=="number"?this.subS(H):this.subM(H)},Lt.prototype.subS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)-H);return this},Lt.prototype.subM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)-H.get(Y,bt));return this},Lt.sub=function(H,Y){var bt=new kt(H);return bt.sub(Y)},Lt.prototype.subtract=Lt.prototype.sub,Lt.prototype.subtractS=Lt.prototype.subS,Lt.prototype.subtractM=Lt.prototype.subM,Lt.subtract=Lt.sub,Lt.prototype.mul=function(H){return typeof H=="number"?this.mulS(H):this.mulM(H)},Lt.prototype.mulS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)*H);return this},Lt.prototype.mulM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)*H.get(Y,bt));return this},Lt.mul=function(H,Y){var bt=new kt(H);return bt.mul(Y)},Lt.prototype.multiply=Lt.prototype.mul,Lt.prototype.multiplyS=Lt.prototype.mulS,Lt.prototype.multiplyM=Lt.prototype.mulM,Lt.multiply=Lt.mul,Lt.prototype.div=function(H){return typeof H=="number"?this.divS(H):this.divM(H)},Lt.prototype.divS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)/H);return this},Lt.prototype.divM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)/H.get(Y,bt));return this},Lt.div=function(H,Y){var bt=new kt(H);return bt.div(Y)},Lt.prototype.divide=Lt.prototype.div,Lt.prototype.divideS=Lt.prototype.divS,Lt.prototype.divideM=Lt.prototype.divM,Lt.divide=Lt.div,Lt.prototype.mod=function(H){return typeof H=="number"?this.modS(H):this.modM(H)},Lt.prototype.modS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)%H);return this},Lt.prototype.modM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)%H.get(Y,bt));return this},Lt.mod=function(H,Y){var bt=new kt(H);return bt.mod(Y)},Lt.prototype.modulus=Lt.prototype.mod,Lt.prototype.modulusS=Lt.prototype.modS,Lt.prototype.modulusM=Lt.prototype.modM,Lt.modulus=Lt.mod,Lt.prototype.and=function(H){return typeof H=="number"?this.andS(H):this.andM(H)},Lt.prototype.andS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)&H);return this},Lt.prototype.andM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)&H.get(Y,bt));return this},Lt.and=function(H,Y){var bt=new kt(H);return bt.and(Y)},Lt.prototype.or=function(H){return typeof H=="number"?this.orS(H):this.orM(H)},Lt.prototype.orS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)|H);return this},Lt.prototype.orM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)|H.get(Y,bt));return this},Lt.or=function(H,Y){var bt=new kt(H);return bt.or(Y)},Lt.prototype.xor=function(H){return typeof H=="number"?this.xorS(H):this.xorM(H)},Lt.prototype.xorS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)^H);return this},Lt.prototype.xorM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)^H.get(Y,bt));return this},Lt.xor=function(H,Y){var bt=new kt(H);return bt.xor(Y)},Lt.prototype.leftShift=function(H){return typeof H=="number"?this.leftShiftS(H):this.leftShiftM(H)},Lt.prototype.leftShiftS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)<<H);return this},Lt.prototype.leftShiftM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)<<H.get(Y,bt));return this},Lt.leftShift=function(H,Y){var bt=new kt(H);return bt.leftShift(Y)},Lt.prototype.signPropagatingRightShift=function(H){return typeof H=="number"?this.signPropagatingRightShiftS(H):this.signPropagatingRightShiftM(H)},Lt.prototype.signPropagatingRightShiftS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)>>H);return this},Lt.prototype.signPropagatingRightShiftM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)>>H.get(Y,bt));return this},Lt.signPropagatingRightShift=function(H,Y){var bt=new kt(H);return bt.signPropagatingRightShift(Y)},Lt.prototype.rightShift=function(H){return typeof H=="number"?this.rightShiftS(H):this.rightShiftM(H)},Lt.prototype.rightShiftS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)>>>H);return this},Lt.prototype.rightShiftM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,this.get(Y,bt)>>>H.get(Y,bt));return this},Lt.rightShift=function(H,Y){var bt=new kt(H);return bt.rightShift(Y)},Lt.prototype.zeroFillRightShift=Lt.prototype.rightShift,Lt.prototype.zeroFillRightShiftS=Lt.prototype.rightShiftS,Lt.prototype.zeroFillRightShiftM=Lt.prototype.rightShiftM,Lt.zeroFillRightShift=Lt.rightShift,Lt.prototype.not=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,~this.get(H,Y));return this},Lt.not=function(H){var Y=new kt(H);return Y.not()},Lt.prototype.abs=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.abs(this.get(H,Y)));return this},Lt.abs=function(H){var Y=new kt(H);return Y.abs()},Lt.prototype.acos=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.acos(this.get(H,Y)));return this},Lt.acos=function(H){var Y=new kt(H);return Y.acos()},Lt.prototype.acosh=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.acosh(this.get(H,Y)));return this},Lt.acosh=function(H){var Y=new kt(H);return Y.acosh()},Lt.prototype.asin=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.asin(this.get(H,Y)));return this},Lt.asin=function(H){var Y=new kt(H);return Y.asin()},Lt.prototype.asinh=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.asinh(this.get(H,Y)));return this},Lt.asinh=function(H){var Y=new kt(H);return Y.asinh()},Lt.prototype.atan=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.atan(this.get(H,Y)));return this},Lt.atan=function(H){var Y=new kt(H);return Y.atan()},Lt.prototype.atanh=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.atanh(this.get(H,Y)));return this},Lt.atanh=function(H){var Y=new kt(H);return Y.atanh()},Lt.prototype.cbrt=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.cbrt(this.get(H,Y)));return this},Lt.cbrt=function(H){var Y=new kt(H);return Y.cbrt()},Lt.prototype.ceil=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.ceil(this.get(H,Y)));return this},Lt.ceil=function(H){var Y=new kt(H);return Y.ceil()},Lt.prototype.clz32=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.clz32(this.get(H,Y)));return this},Lt.clz32=function(H){var Y=new kt(H);return Y.clz32()},Lt.prototype.cos=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.cos(this.get(H,Y)));return this},Lt.cos=function(H){var Y=new kt(H);return Y.cos()},Lt.prototype.cosh=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.cosh(this.get(H,Y)));return this},Lt.cosh=function(H){var Y=new kt(H);return Y.cosh()},Lt.prototype.exp=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.exp(this.get(H,Y)));return this},Lt.exp=function(H){var Y=new kt(H);return Y.exp()},Lt.prototype.expm1=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.expm1(this.get(H,Y)));return this},Lt.expm1=function(H){var Y=new kt(H);return Y.expm1()},Lt.prototype.floor=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.floor(this.get(H,Y)));return this},Lt.floor=function(H){var Y=new kt(H);return Y.floor()},Lt.prototype.fround=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.fround(this.get(H,Y)));return this},Lt.fround=function(H){var Y=new kt(H);return Y.fround()},Lt.prototype.log=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.log(this.get(H,Y)));return this},Lt.log=function(H){var Y=new kt(H);return Y.log()},Lt.prototype.log1p=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.log1p(this.get(H,Y)));return this},Lt.log1p=function(H){var Y=new kt(H);return Y.log1p()},Lt.prototype.log10=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.log10(this.get(H,Y)));return this},Lt.log10=function(H){var Y=new kt(H);return Y.log10()},Lt.prototype.log2=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.log2(this.get(H,Y)));return this},Lt.log2=function(H){var Y=new kt(H);return Y.log2()},Lt.prototype.round=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.round(this.get(H,Y)));return this},Lt.round=function(H){var Y=new kt(H);return Y.round()},Lt.prototype.sign=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.sign(this.get(H,Y)));return this},Lt.sign=function(H){var Y=new kt(H);return Y.sign()},Lt.prototype.sin=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.sin(this.get(H,Y)));return this},Lt.sin=function(H){var Y=new kt(H);return Y.sin()},Lt.prototype.sinh=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.sinh(this.get(H,Y)));return this},Lt.sinh=function(H){var Y=new kt(H);return Y.sinh()},Lt.prototype.sqrt=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.sqrt(this.get(H,Y)));return this},Lt.sqrt=function(H){var Y=new kt(H);return Y.sqrt()},Lt.prototype.tan=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.tan(this.get(H,Y)));return this},Lt.tan=function(H){var Y=new kt(H);return Y.tan()},Lt.prototype.tanh=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.tanh(this.get(H,Y)));return this},Lt.tanh=function(H){var Y=new kt(H);return Y.tanh()},Lt.prototype.trunc=function(){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,Math.trunc(this.get(H,Y)));return this},Lt.trunc=function(H){var Y=new kt(H);return Y.trunc()},Lt.pow=function(H,Y){var bt=new kt(H);return bt.pow(Y)},Lt.prototype.pow=function(H){return typeof H=="number"?this.powS(H):this.powM(H)},Lt.prototype.powS=function(H){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,Math.pow(this.get(Y,bt),H));return this},Lt.prototype.powM=function(H){if(H=kt.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.set(Y,bt,Math.pow(this.get(Y,bt),H.get(Y,bt)));return this}}function mt(Lt,kt,at){var H=at?Lt.rows:Lt.rows-1;if(kt<0||kt>H)throw new RangeError("Row index out of range")}function st(Lt,kt,at){var H=at?Lt.columns:Lt.columns-1;if(kt<0||kt>H)throw new RangeError("Column index out of range")}function ut(Lt,kt){if(kt.to1DArray&&(kt=kt.to1DArray()),kt.length!==Lt.columns)throw new RangeError("vector size must be the same as the number of columns");return kt}function dt(Lt,kt){if(kt.to1DArray&&(kt=kt.to1DArray()),kt.length!==Lt.rows)throw new RangeError("vector size must be the same as the number of rows");return kt}function gt(Lt,kt){if(!L(kt))throw new TypeError("row indices must be an array");for(var at=0;at<kt.length;at++)if(kt[at]<0||kt[at]>=Lt.rows)throw new RangeError("row indices are out of range")}function wt(Lt,kt){if(!L(kt))throw new TypeError("column indices must be an array");for(var at=0;at<kt.length;at++)if(kt[at]<0||kt[at]>=Lt.columns)throw new RangeError("column indices are out of range")}function ot(Lt,kt,at,H,Y){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Nt("startRow",kt),Nt("endRow",at),Nt("startColumn",H),Nt("endColumn",Y),kt>at||H>Y||kt<0||kt>=Lt.rows||at<0||at>=Lt.rows||H<0||H>=Lt.columns||Y<0||Y>=Lt.columns)throw new RangeError("Submatrix indices are out of range")}function pt(Lt){for(var kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,at=[],H=0;H<Lt;H++)at.push(kt);return at}function Nt(Lt,kt){if(typeof kt!="number")throw new TypeError("".concat(Lt," must be a number"))}function Gt(Lt){if(Lt.isEmpty())throw new Error("Empty matrix has no elements to index")}function se(Lt){for(var kt=pt(Lt.rows),at=0;at<Lt.rows;++at)for(var H=0;H<Lt.columns;++H)kt[at]+=Lt.get(at,H);return kt}function ie(Lt){for(var kt=pt(Lt.columns),at=0;at<Lt.rows;++at)for(var H=0;H<Lt.columns;++H)kt[H]+=Lt.get(at,H);return kt}function Be(Lt){for(var kt=0,at=0;at<Lt.rows;at++)for(var H=0;H<Lt.columns;H++)kt+=Lt.get(at,H);return kt}function ke(Lt){for(var kt=pt(Lt.rows,1),at=0;at<Lt.rows;++at)for(var H=0;H<Lt.columns;++H)kt[at]*=Lt.get(at,H);return kt}function we(Lt){for(var kt=pt(Lt.columns,1),at=0;at<Lt.rows;++at)for(var H=0;H<Lt.columns;++H)kt[H]*=Lt.get(at,H);return kt}function At(Lt){for(var kt=1,at=0;at<Lt.rows;at++)for(var H=0;H<Lt.columns;H++)kt*=Lt.get(at,H);return kt}function Yt(Lt,kt,at){for(var H=Lt.rows,Y=Lt.columns,bt=[],$t=0;$t<H;$t++){for(var jt=0,Ht=0,re=0,on=0;on<Y;on++)re=Lt.get($t,on)-at[$t],jt+=re,Ht+=re*re;kt?bt.push((Ht-jt*jt/Y)/(Y-1)):bt.push((Ht-jt*jt/Y)/Y)}return bt}function be(Lt,kt,at){for(var H=Lt.rows,Y=Lt.columns,bt=[],$t=0;$t<Y;$t++){for(var jt=0,Ht=0,re=0,on=0;on<H;on++)re=Lt.get(on,$t)-at[$t],jt+=re,Ht+=re*re;kt?bt.push((Ht-jt*jt/H)/(H-1)):bt.push((Ht-jt*jt/H)/H)}return bt}function nn(Lt,kt,at){for(var H=Lt.rows,Y=Lt.columns,bt=H*Y,$t=0,jt=0,Ht=0,re=0;re<H;re++)for(var on=0;on<Y;on++)Ht=Lt.get(re,on)-at,$t+=Ht,jt+=Ht*Ht;return kt?(jt-$t*$t/bt)/(bt-1):(jt-$t*$t/bt)/bt}function Ee(Lt,kt){for(var at=0;at<Lt.rows;at++)for(var H=0;H<Lt.columns;H++)Lt.set(at,H,Lt.get(at,H)-kt[at])}function le(Lt,kt){for(var at=0;at<Lt.rows;at++)for(var H=0;H<Lt.columns;H++)Lt.set(at,H,Lt.get(at,H)-kt[H])}function Le(Lt,kt){for(var at=0;at<Lt.rows;at++)for(var H=0;H<Lt.columns;H++)Lt.set(at,H,Lt.get(at,H)-kt)}function Ze(Lt){for(var kt=[],at=0;at<Lt.rows;at++){for(var H=0,Y=0;Y<Lt.columns;Y++)H+=Math.pow(Lt.get(at,Y),2)/(Lt.columns-1);kt.push(Math.sqrt(H))}return kt}function fe(Lt,kt){for(var at=0;at<Lt.rows;at++)for(var H=0;H<Lt.columns;H++)Lt.set(at,H,Lt.get(at,H)/kt[at])}function Re(Lt){for(var kt=[],at=0;at<Lt.columns;at++){for(var H=0,Y=0;Y<Lt.rows;Y++)H+=Math.pow(Lt.get(Y,at),2)/(Lt.rows-1);kt.push(Math.sqrt(H))}return kt}function He(Lt,kt){for(var at=0;at<Lt.rows;at++)for(var H=0;H<Lt.columns;H++)Lt.set(at,H,Lt.get(at,H)/kt[H])}function pe(Lt){for(var kt=Lt.size-1,at=0,H=0;H<Lt.columns;H++)for(var Y=0;Y<Lt.rows;Y++)at+=Math.pow(Lt.get(Y,H),2)/kt;return Math.sqrt(at)}function Ge(Lt,kt){for(var at=0;at<Lt.rows;at++)for(var H=0;H<Lt.columns;H++)Lt.set(at,H,Lt.get(at,H)/kt)}var te=function(){function Lt(){(0,W.Z)(this,Lt)}return(0,Q.Z)(Lt,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(at){if(typeof at!="function")throw new TypeError("callback must be a function");for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)at.call(this,H,Y);return this}},{key:"to1DArray",value:function(){for(var at=[],H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)at.push(this.get(H,Y));return at}},{key:"to2DArray",value:function(){for(var at=[],H=0;H<this.rows;H++){at.push([]);for(var Y=0;Y<this.columns;Y++)at[H].push(this.get(H,Y))}return at}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return this.rows===1}},{key:"isColumnVector",value:function(){return this.columns===1}},{key:"isVector",value:function(){return this.rows===1||this.columns===1}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return this.rows===0||this.columns===0}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var at=0;at<this.rows;at++)for(var H=0;H<=at;H++)if(this.get(at,H)!==this.get(H,at))return!1;return!0}return!1}},{key:"isEchelonForm",value:function(){for(var at=0,H=0,Y=-1,bt=!0,$t=!1;at<this.rows&&bt;){for(H=0,$t=!1;H<this.columns&&$t===!1;)this.get(at,H)===0?H++:this.get(at,H)===1&&H>Y?($t=!0,Y=H):(bt=!1,$t=!0);at++}return bt}},{key:"isReducedEchelonForm",value:function(){for(var at=0,H=0,Y=-1,bt=!0,$t=!1;at<this.rows&&bt;){for(H=0,$t=!1;H<this.columns&&$t===!1;)this.get(at,H)===0?H++:this.get(at,H)===1&&H>Y?($t=!0,Y=H):(bt=!1,$t=!0);for(var jt=H+1;jt<this.rows;jt++)this.get(at,jt)!==0&&(bt=!1);at++}return bt}},{key:"echelonForm",value:function(){for(var at=this.clone(),H=0,Y=0;H<at.rows&&Y<at.columns;){for(var bt=H,$t=H;$t<at.rows;$t++)at.get($t,Y)>at.get(bt,Y)&&(bt=$t);if(at.get(bt,Y)===0)Y++;else{at.swapRows(H,bt);for(var jt=at.get(H,Y),Ht=Y;Ht<at.columns;Ht++)at.set(H,Ht,at.get(H,Ht)/jt);for(var re=H+1;re<at.rows;re++){var on=at.get(re,Y)/at.get(H,Y);at.set(re,Y,0);for(var Je=Y+1;Je<at.columns;Je++)at.set(re,Je,at.get(re,Je)-at.get(H,Je)*on)}H++,Y++}}return at}},{key:"reducedEchelonForm",value:function(){for(var at=this.echelonForm(),H=at.columns,Y=at.rows,bt=Y-1;bt>=0;)if(at.maxRow(bt)===0)bt--;else{for(var $t=0,jt=!1;$t<Y&&jt===!1;)at.get(bt,$t)===1?jt=!0:$t++;for(var Ht=0;Ht<bt;Ht++)for(var re=at.get(Ht,$t),on=$t;on<H;on++){var Je=at.get(Ht,on)-re*at.get(bt,on);at.set(Ht,on,Je)}bt--}return at}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof at!="object")throw new TypeError("options must be an object");var H=at.rows,Y=H===void 0?1:H,bt=at.columns,$t=bt===void 0?1:bt;if(!Number.isInteger(Y)||Y<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger($t)||$t<=0)throw new TypeError("columns must be a positive integer");for(var jt=new ee(this.rows*Y,this.columns*$t),Ht=0;Ht<Y;Ht++)for(var re=0;re<$t;re++)jt.setSubMatrix(this,this.rows*Ht,this.columns*re);return jt}},{key:"fill",value:function(at){for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,at);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(at){mt(this,at);for(var H=[],Y=0;Y<this.columns;Y++)H.push(this.get(at,Y));return H}},{key:"getRowVector",value:function(at){return ee.rowVector(this.getRow(at))}},{key:"setRow",value:function(at,H){mt(this,at),H=ut(this,H);for(var Y=0;Y<this.columns;Y++)this.set(at,Y,H[Y]);return this}},{key:"swapRows",value:function(at,H){mt(this,at),mt(this,H);for(var Y=0;Y<this.columns;Y++){var bt=this.get(at,Y);this.set(at,Y,this.get(H,Y)),this.set(H,Y,bt)}return this}},{key:"getColumn",value:function(at){st(this,at);for(var H=[],Y=0;Y<this.rows;Y++)H.push(this.get(Y,at));return H}},{key:"getColumnVector",value:function(at){return ee.columnVector(this.getColumn(at))}},{key:"setColumn",value:function(at,H){st(this,at),H=dt(this,H);for(var Y=0;Y<this.rows;Y++)this.set(Y,at,H[Y]);return this}},{key:"swapColumns",value:function(at,H){st(this,at),st(this,H);for(var Y=0;Y<this.rows;Y++){var bt=this.get(Y,at);this.set(Y,at,this.get(Y,H)),this.set(Y,H,bt)}return this}},{key:"addRowVector",value:function(at){at=ut(this,at);for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,this.get(H,Y)+at[Y]);return this}},{key:"subRowVector",value:function(at){at=ut(this,at);for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,this.get(H,Y)-at[Y]);return this}},{key:"mulRowVector",value:function(at){at=ut(this,at);for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,this.get(H,Y)*at[Y]);return this}},{key:"divRowVector",value:function(at){at=ut(this,at);for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,this.get(H,Y)/at[Y]);return this}},{key:"addColumnVector",value:function(at){at=dt(this,at);for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,this.get(H,Y)+at[H]);return this}},{key:"subColumnVector",value:function(at){at=dt(this,at);for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,this.get(H,Y)-at[H]);return this}},{key:"mulColumnVector",value:function(at){at=dt(this,at);for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,this.get(H,Y)*at[H]);return this}},{key:"divColumnVector",value:function(at){at=dt(this,at);for(var H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)this.set(H,Y,this.get(H,Y)/at[H]);return this}},{key:"mulRow",value:function(at,H){mt(this,at);for(var Y=0;Y<this.columns;Y++)this.set(at,Y,this.get(at,Y)*H);return this}},{key:"mulColumn",value:function(at,H){st(this,at);for(var Y=0;Y<this.rows;Y++)this.set(Y,at,this.get(Y,at)*H);return this}},{key:"max",value:function(at){if(this.isEmpty())return NaN;switch(at){case"row":{for(var H=new Array(this.rows).fill(Number.NEGATIVE_INFINITY),Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.get(Y,bt)>H[Y]&&(H[Y]=this.get(Y,bt));return H}case"column":{for(var $t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY),jt=0;jt<this.rows;jt++)for(var Ht=0;Ht<this.columns;Ht++)this.get(jt,Ht)>$t[Ht]&&($t[Ht]=this.get(jt,Ht));return $t}case void 0:{for(var re=this.get(0,0),on=0;on<this.rows;on++)for(var Je=0;Je<this.columns;Je++)this.get(on,Je)>re&&(re=this.get(on,Je));return re}default:throw new Error("invalid option: ".concat(at))}}},{key:"maxIndex",value:function(){Gt(this);for(var at=this.get(0,0),H=[0,0],Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.get(Y,bt)>at&&(at=this.get(Y,bt),H[0]=Y,H[1]=bt);return H}},{key:"min",value:function(at){if(this.isEmpty())return NaN;switch(at){case"row":{for(var H=new Array(this.rows).fill(Number.POSITIVE_INFINITY),Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.get(Y,bt)<H[Y]&&(H[Y]=this.get(Y,bt));return H}case"column":{for(var $t=new Array(this.columns).fill(Number.POSITIVE_INFINITY),jt=0;jt<this.rows;jt++)for(var Ht=0;Ht<this.columns;Ht++)this.get(jt,Ht)<$t[Ht]&&($t[Ht]=this.get(jt,Ht));return $t}case void 0:{for(var re=this.get(0,0),on=0;on<this.rows;on++)for(var Je=0;Je<this.columns;Je++)this.get(on,Je)<re&&(re=this.get(on,Je));return re}default:throw new Error("invalid option: ".concat(at))}}},{key:"minIndex",value:function(){Gt(this);for(var at=this.get(0,0),H=[0,0],Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)this.get(Y,bt)<at&&(at=this.get(Y,bt),H[0]=Y,H[1]=bt);return H}},{key:"maxRow",value:function(at){if(mt(this,at),this.isEmpty())return NaN;for(var H=this.get(at,0),Y=1;Y<this.columns;Y++)this.get(at,Y)>H&&(H=this.get(at,Y));return H}},{key:"maxRowIndex",value:function(at){mt(this,at),Gt(this);for(var H=this.get(at,0),Y=[at,0],bt=1;bt<this.columns;bt++)this.get(at,bt)>H&&(H=this.get(at,bt),Y[1]=bt);return Y}},{key:"minRow",value:function(at){if(mt(this,at),this.isEmpty())return NaN;for(var H=this.get(at,0),Y=1;Y<this.columns;Y++)this.get(at,Y)<H&&(H=this.get(at,Y));return H}},{key:"minRowIndex",value:function(at){mt(this,at),Gt(this);for(var H=this.get(at,0),Y=[at,0],bt=1;bt<this.columns;bt++)this.get(at,bt)<H&&(H=this.get(at,bt),Y[1]=bt);return Y}},{key:"maxColumn",value:function(at){if(st(this,at),this.isEmpty())return NaN;for(var H=this.get(0,at),Y=1;Y<this.rows;Y++)this.get(Y,at)>H&&(H=this.get(Y,at));return H}},{key:"maxColumnIndex",value:function(at){st(this,at),Gt(this);for(var H=this.get(0,at),Y=[0,at],bt=1;bt<this.rows;bt++)this.get(bt,at)>H&&(H=this.get(bt,at),Y[0]=bt);return Y}},{key:"minColumn",value:function(at){if(st(this,at),this.isEmpty())return NaN;for(var H=this.get(0,at),Y=1;Y<this.rows;Y++)this.get(Y,at)<H&&(H=this.get(Y,at));return H}},{key:"minColumnIndex",value:function(at){st(this,at),Gt(this);for(var H=this.get(0,at),Y=[0,at],bt=1;bt<this.rows;bt++)this.get(bt,at)<H&&(H=this.get(bt,at),Y[0]=bt);return Y}},{key:"diag",value:function(){for(var at=Math.min(this.rows,this.columns),H=[],Y=0;Y<at;Y++)H.push(this.get(Y,Y));return H}},{key:"norm",value:function(){var at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"frobenius",H=0;if(at==="max")return this.max();if(at==="frobenius"){for(var Y=0;Y<this.rows;Y++)for(var bt=0;bt<this.columns;bt++)H=H+this.get(Y,bt)*this.get(Y,bt);return Math.sqrt(H)}else throw new RangeError("unknown norm type: ".concat(at))}},{key:"cumulativeSum",value:function(){for(var at=0,H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)at+=this.get(H,Y),this.set(H,Y,at);return this}},{key:"dot",value:function(at){Lt.isMatrix(at)&&(at=at.to1DArray());var H=this.to1DArray();if(H.length!==at.length)throw new RangeError("vectors do not have the same size");for(var Y=0,bt=0;bt<H.length;bt++)Y+=H[bt]*at[bt];return Y}},{key:"mmul",value:function(at){at=ee.checkMatrix(at);for(var H=this.rows,Y=this.columns,bt=at.columns,$t=new ee(H,bt),jt=new Float64Array(Y),Ht=0;Ht<bt;Ht++){for(var re=0;re<Y;re++)jt[re]=at.get(re,Ht);for(var on=0;on<H;on++){for(var Je=0,Ve=0;Ve<Y;Ve++)Je+=this.get(on,Ve)*jt[Ve];$t.set(on,Ht,Je)}}return $t}},{key:"strassen2x2",value:function(at){at=ee.checkMatrix(at);var H=new ee(2,2),Y=this.get(0,0),bt=at.get(0,0),$t=this.get(0,1),jt=at.get(0,1),Ht=this.get(1,0),re=at.get(1,0),on=this.get(1,1),Je=at.get(1,1),Ve=(Y+on)*(bt+Je),qn=(Ht+on)*bt,Ln=Y*(jt-Je),qr=on*(re-bt),Ca=(Y+$t)*Je,Qn=(Ht-Y)*(bt+jt),_r=($t-on)*(re+Je),ea=Ve+qr-Ca+_r,La=Ln+Ca,ha=qn+qr,_i=Ve-qn+Ln+Qn;return H.set(0,0,ea),H.set(0,1,La),H.set(1,0,ha),H.set(1,1,_i),H}},{key:"strassen3x3",value:function(at){at=ee.checkMatrix(at);var H=new ee(3,3),Y=this.get(0,0),bt=this.get(0,1),$t=this.get(0,2),jt=this.get(1,0),Ht=this.get(1,1),re=this.get(1,2),on=this.get(2,0),Je=this.get(2,1),Ve=this.get(2,2),qn=at.get(0,0),Ln=at.get(0,1),qr=at.get(0,2),Ca=at.get(1,0),Qn=at.get(1,1),_r=at.get(1,2),ea=at.get(2,0),La=at.get(2,1),ha=at.get(2,2),_i=(Y+bt+$t-jt-Ht-Je-Ve)*Qn,Ni=(Y-jt)*(-Ln+Qn),vi=Ht*(-qn+Ln+Ca-Qn-_r-ea+ha),si=(-Y+jt+Ht)*(qn-Ln+Qn),Mi=(jt+Ht)*(-qn+Ln),Pa=Y*qn,un=(-Y+on+Je)*(qn-qr+_r),Oe=(-Y+on)*(qr-_r),hn=(on+Je)*(-qn+qr),Hn=(Y+bt+$t-Ht-re-on-Je)*_r,Bn=Je*(-qn+qr+Ca-Qn-_r-ea+La),Jn=(-$t+Je+Ve)*(Qn+ea-La),Lr=($t-Ve)*(Qn-La),ya=$t*ea,Fa=(Je+Ve)*(-ea+La),ui=(-$t+Ht+re)*(_r+ea-ha),Ei=($t-re)*(_r-ha),oo=(Ht+re)*(-ea+ha),po=bt*Ca,bo=re*La,ts=jt*qr,Wo=on*Ln,Yi=Ve*ha,wi=Pa+ya+po,gi=_i+si+Mi+Pa+Jn+ya+Fa,us=Pa+un+hn+Hn+ya+ui+oo,Do=Ni+vi+si+Pa+ya+ui+Ei,Io=Ni+si+Mi+Pa+bo,zs=ya+ui+Ei+oo+ts,mu=Pa+un+Oe+Bn+Jn+Lr+ya,ds=Jn+Lr+ya+Fa+Wo,Ms=Pa+un+Oe+hn+Yi;return H.set(0,0,wi),H.set(0,1,gi),H.set(0,2,us),H.set(1,0,Do),H.set(1,1,Io),H.set(1,2,zs),H.set(2,0,mu),H.set(2,1,ds),H.set(2,2,Ms),H}},{key:"mmulStrassen",value:function(at){at=ee.checkMatrix(at);var H=this.clone(),Y=H.rows,bt=H.columns,$t=at.rows,jt=at.columns;bt!==$t&&console.warn("Multiplying ".concat(Y," x ").concat(bt," and ").concat($t," x ").concat(jt," matrix: dimensions do not match."));function Ht(Ve,qn,Ln){var qr=Ve.rows,Ca=Ve.columns;if(qr===qn&&Ca===Ln)return Ve;var Qn=Lt.zeros(qn,Ln);return Qn=Qn.setSubMatrix(Ve,0,0),Qn}var re=Math.max(Y,$t),on=Math.max(bt,jt);H=Ht(H,re,on),at=Ht(at,re,on);function Je(Ve,qn,Ln,qr){if(Ln<=512||qr<=512)return Ve.mmul(qn);Ln%2==1&&qr%2==1?(Ve=Ht(Ve,Ln+1,qr+1),qn=Ht(qn,Ln+1,qr+1)):Ln%2==1?(Ve=Ht(Ve,Ln+1,qr),qn=Ht(qn,Ln+1,qr)):qr%2==1&&(Ve=Ht(Ve,Ln,qr+1),qn=Ht(qn,Ln,qr+1));var Ca=parseInt(Ve.rows/2,10),Qn=parseInt(Ve.columns/2,10),_r=Ve.subMatrix(0,Ca-1,0,Qn-1),ea=qn.subMatrix(0,Ca-1,0,Qn-1),La=Ve.subMatrix(0,Ca-1,Qn,Ve.columns-1),ha=qn.subMatrix(0,Ca-1,Qn,qn.columns-1),_i=Ve.subMatrix(Ca,Ve.rows-1,0,Qn-1),Ni=qn.subMatrix(Ca,qn.rows-1,0,Qn-1),vi=Ve.subMatrix(Ca,Ve.rows-1,Qn,Ve.columns-1),si=qn.subMatrix(Ca,qn.rows-1,Qn,qn.columns-1),Mi=Je(Lt.add(_r,vi),Lt.add(ea,si),Ca,Qn),Pa=Je(Lt.add(_i,vi),ea,Ca,Qn),un=Je(_r,Lt.sub(ha,si),Ca,Qn),Oe=Je(vi,Lt.sub(Ni,ea),Ca,Qn),hn=Je(Lt.add(_r,La),si,Ca,Qn),Hn=Je(Lt.sub(_i,_r),Lt.add(ea,ha),Ca,Qn),Bn=Je(Lt.sub(La,vi),Lt.add(Ni,si),Ca,Qn),Jn=Lt.add(Mi,Oe);Jn.sub(hn),Jn.add(Bn);var Lr=Lt.add(un,hn),ya=Lt.add(Pa,Oe),Fa=Lt.sub(Mi,Pa);Fa.add(un),Fa.add(Hn);var ui=Lt.zeros(2*Jn.rows,2*Jn.columns);return ui=ui.setSubMatrix(Jn,0,0),ui=ui.setSubMatrix(Lr,Jn.rows,0),ui=ui.setSubMatrix(ya,0,Jn.columns),ui=ui.setSubMatrix(Fa,Jn.rows,Jn.columns),ui.subMatrix(0,Ln-1,0,qr-1)}return Je(H,at,re,on)}},{key:"scaleRows",value:function(){var at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof at!="object")throw new TypeError("options must be an object");var H=at.min,Y=H===void 0?0:H,bt=at.max,$t=bt===void 0?1:bt;if(!Number.isFinite(Y))throw new TypeError("min must be a number");if(!Number.isFinite($t))throw new TypeError("max must be a number");if(Y>=$t)throw new RangeError("min must be smaller than max");for(var jt=new ee(this.rows,this.columns),Ht=0;Ht<this.rows;Ht++){var re=this.getRow(Ht);re.length>0&&M(re,{min:Y,max:$t,output:re}),jt.setRow(Ht,re)}return jt}},{key:"scaleColumns",value:function(){var at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof at!="object")throw new TypeError("options must be an object");var H=at.min,Y=H===void 0?0:H,bt=at.max,$t=bt===void 0?1:bt;if(!Number.isFinite(Y))throw new TypeError("min must be a number");if(!Number.isFinite($t))throw new TypeError("max must be a number");if(Y>=$t)throw new RangeError("min must be smaller than max");for(var jt=new ee(this.rows,this.columns),Ht=0;Ht<this.columns;Ht++){var re=this.getColumn(Ht);re.length&&M(re,{min:Y,max:$t,output:re}),jt.setColumn(Ht,re)}return jt}},{key:"flipRows",value:function(){for(var at=Math.ceil(this.columns/2),H=0;H<this.rows;H++)for(var Y=0;Y<at;Y++){var bt=this.get(H,Y),$t=this.get(H,this.columns-1-Y);this.set(H,Y,$t),this.set(H,this.columns-1-Y,bt)}return this}},{key:"flipColumns",value:function(){for(var at=Math.ceil(this.rows/2),H=0;H<this.columns;H++)for(var Y=0;Y<at;Y++){var bt=this.get(Y,H),$t=this.get(this.rows-1-Y,H);this.set(Y,H,$t),this.set(this.rows-1-Y,H,bt)}return this}},{key:"kroneckerProduct",value:function(at){at=ee.checkMatrix(at);for(var H=this.rows,Y=this.columns,bt=at.rows,$t=at.columns,jt=new ee(H*bt,Y*$t),Ht=0;Ht<H;Ht++)for(var re=0;re<Y;re++)for(var on=0;on<bt;on++)for(var Je=0;Je<$t;Je++)jt.set(bt*Ht+on,$t*re+Je,this.get(Ht,re)*at.get(on,Je));return jt}},{key:"kroneckerSum",value:function(at){if(at=ee.checkMatrix(at),!this.isSquare()||!at.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var H=this.rows,Y=at.rows,bt=this.kroneckerProduct(ee.eye(Y,Y)),$t=ee.eye(H,H).kroneckerProduct(at);return bt.add($t)}},{key:"transpose",value:function(){for(var at=new ee(this.columns,this.rows),H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)at.set(Y,H,this.get(H,Y));return at}},{key:"sortRows",value:function(){for(var at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Me,H=0;H<this.rows;H++)this.setRow(H,this.getRow(H).sort(at));return this}},{key:"sortColumns",value:function(){for(var at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Me,H=0;H<this.columns;H++)this.setColumn(H,this.getColumn(H).sort(at));return this}},{key:"subMatrix",value:function(at,H,Y,bt){ot(this,at,H,Y,bt);for(var $t=new ee(H-at+1,bt-Y+1),jt=at;jt<=H;jt++)for(var Ht=Y;Ht<=bt;Ht++)$t.set(jt-at,Ht-Y,this.get(jt,Ht));return $t}},{key:"subMatrixRow",value:function(at,H,Y){if(H===void 0&&(H=0),Y===void 0&&(Y=this.columns-1),H>Y||H<0||H>=this.columns||Y<0||Y>=this.columns)throw new RangeError("Argument out of range");for(var bt=new ee(at.length,Y-H+1),$t=0;$t<at.length;$t++)for(var jt=H;jt<=Y;jt++){if(at[$t]<0||at[$t]>=this.rows)throw new RangeError("Row index out of range: ".concat(at[$t]));bt.set($t,jt-H,this.get(at[$t],jt))}return bt}},{key:"subMatrixColumn",value:function(at,H,Y){if(H===void 0&&(H=0),Y===void 0&&(Y=this.rows-1),H>Y||H<0||H>=this.rows||Y<0||Y>=this.rows)throw new RangeError("Argument out of range");for(var bt=new ee(Y-H+1,at.length),$t=0;$t<at.length;$t++)for(var jt=H;jt<=Y;jt++){if(at[$t]<0||at[$t]>=this.columns)throw new RangeError("Column index out of range: ".concat(at[$t]));bt.set(jt-H,$t,this.get(jt,at[$t]))}return bt}},{key:"setSubMatrix",value:function(at,H,Y){if(at=ee.checkMatrix(at),at.isEmpty())return this;var bt=H+at.rows-1,$t=Y+at.columns-1;ot(this,H,bt,Y,$t);for(var jt=0;jt<at.rows;jt++)for(var Ht=0;Ht<at.columns;Ht++)this.set(H+jt,Y+Ht,at.get(jt,Ht));return this}},{key:"selection",value:function(at,H){gt(this,at),wt(this,H);for(var Y=new ee(at.length,H.length),bt=0;bt<at.length;bt++)for(var $t=at[bt],jt=0;jt<H.length;jt++){var Ht=H[jt];Y.set(bt,jt,this.get($t,Ht))}return Y}},{key:"trace",value:function(){for(var at=Math.min(this.rows,this.columns),H=0,Y=0;Y<at;Y++)H+=this.get(Y,Y);return H}},{key:"clone",value:function(){for(var at=new ee(this.rows,this.columns),H=0;H<this.rows;H++)for(var Y=0;Y<this.columns;Y++)at.set(H,Y,this.get(H,Y));return at}},{key:"sum",value:function(at){switch(at){case"row":return se(this);case"column":return ie(this);case void 0:return Be(this);default:throw new Error("invalid option: ".concat(at))}}},{key:"product",value:function(at){switch(at){case"row":return ke(this);case"column":return we(this);case void 0:return At(this);default:throw new Error("invalid option: ".concat(at))}}},{key:"mean",value:function(at){var H=this.sum(at);switch(at){case"row":{for(var Y=0;Y<this.rows;Y++)H[Y]/=this.columns;return H}case"column":{for(var bt=0;bt<this.columns;bt++)H[bt]/=this.rows;return H}case void 0:return H/this.size;default:throw new Error("invalid option: ".concat(at))}}},{key:"variance",value:function(at){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof at=="object"&&(H=at,at=void 0),typeof H!="object")throw new TypeError("options must be an object");var Y=H,bt=Y.unbiased,$t=bt===void 0?!0:bt,jt=Y.mean,Ht=jt===void 0?this.mean(at):jt;if(typeof $t!="boolean")throw new TypeError("unbiased must be a boolean");switch(at){case"row":{if(!L(Ht))throw new TypeError("mean must be an array");return Yt(this,$t,Ht)}case"column":{if(!L(Ht))throw new TypeError("mean must be an array");return be(this,$t,Ht)}case void 0:{if(typeof Ht!="number")throw new TypeError("mean must be a number");return nn(this,$t,Ht)}default:throw new Error("invalid option: ".concat(at))}}},{key:"standardDeviation",value:function(at,H){typeof at=="object"&&(H=at,at=void 0);var Y=this.variance(at,H);if(at===void 0)return Math.sqrt(Y);for(var bt=0;bt<Y.length;bt++)Y[bt]=Math.sqrt(Y[bt]);return Y}},{key:"center",value:function(at){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof at=="object"&&(H=at,at=void 0),typeof H!="object")throw new TypeError("options must be an object");var Y=H,bt=Y.center,$t=bt===void 0?this.mean(at):bt;switch(at){case"row":{if(!L($t))throw new TypeError("center must be an array");return Ee(this,$t),this}case"column":{if(!L($t))throw new TypeError("center must be an array");return le(this,$t),this}case void 0:{if(typeof $t!="number")throw new TypeError("center must be a number");return Le(this,$t),this}default:throw new Error("invalid option: ".concat(at))}}},{key:"scale",value:function(at){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof at=="object"&&(H=at,at=void 0),typeof H!="object")throw new TypeError("options must be an object");var Y=H.scale;switch(at){case"row":{if(Y===void 0)Y=Ze(this);else if(!L(Y))throw new TypeError("scale must be an array");return fe(this,Y),this}case"column":{if(Y===void 0)Y=Re(this);else if(!L(Y))throw new TypeError("scale must be an array");return He(this,Y),this}case void 0:{if(Y===void 0)Y=pe(this);else if(typeof Y!="number")throw new TypeError("scale must be a number");return Ge(this,Y),this}default:throw new Error("invalid option: ".concat(at))}}},{key:"toString",value:function(at){return F(this,at)}}],[{key:"from1DArray",value:function(at,H,Y){var bt=at*H;if(bt!==Y.length)throw new RangeError("data length does not match given dimensions");for(var $t=new ee(at,H),jt=0;jt<at;jt++)for(var Ht=0;Ht<H;Ht++)$t.set(jt,Ht,Y[jt*H+Ht]);return $t}},{key:"rowVector",value:function(at){for(var H=new ee(1,at.length),Y=0;Y<at.length;Y++)H.set(0,Y,at[Y]);return H}},{key:"columnVector",value:function(at){for(var H=new ee(at.length,1),Y=0;Y<at.length;Y++)H.set(Y,0,at[Y]);return H}},{key:"zeros",value:function(at,H){return new ee(at,H)}},{key:"ones",value:function(at,H){return new ee(at,H).fill(1)}},{key:"rand",value:function(at,H){var Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof Y!="object")throw new TypeError("options must be an object");for(var bt=Y.random,$t=bt===void 0?Math.random:bt,jt=new ee(at,H),Ht=0;Ht<at;Ht++)for(var re=0;re<H;re++)jt.set(Ht,re,$t());return jt}},{key:"randInt",value:function(at,H){var Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof Y!="object")throw new TypeError("options must be an object");var bt=Y.min,$t=bt===void 0?0:bt,jt=Y.max,Ht=jt===void 0?1e3:jt,re=Y.random,on=re===void 0?Math.random:re;if(!Number.isInteger($t))throw new TypeError("min must be an integer");if(!Number.isInteger(Ht))throw new TypeError("max must be an integer");if($t>=Ht)throw new RangeError("min must be smaller than max");for(var Je=Ht-$t,Ve=new ee(at,H),qn=0;qn<at;qn++)for(var Ln=0;Ln<H;Ln++){var qr=$t+Math.round(on()*Je);Ve.set(qn,Ln,qr)}return Ve}},{key:"eye",value:function(at,H,Y){H===void 0&&(H=at),Y===void 0&&(Y=1);for(var bt=Math.min(at,H),$t=this.zeros(at,H),jt=0;jt<bt;jt++)$t.set(jt,jt,Y);return $t}},{key:"diag",value:function(at,H,Y){var bt=at.length;H===void 0&&(H=bt),Y===void 0&&(Y=H);for(var $t=Math.min(bt,H,Y),jt=this.zeros(H,Y),Ht=0;Ht<$t;Ht++)jt.set(Ht,Ht,at[Ht]);return jt}},{key:"min",value:function(at,H){at=this.checkMatrix(at),H=this.checkMatrix(H);for(var Y=at.rows,bt=at.columns,$t=new ee(Y,bt),jt=0;jt<Y;jt++)for(var Ht=0;Ht<bt;Ht++)$t.set(jt,Ht,Math.min(at.get(jt,Ht),H.get(jt,Ht)));return $t}},{key:"max",value:function(at,H){at=this.checkMatrix(at),H=this.checkMatrix(H);for(var Y=at.rows,bt=at.columns,$t=new this(Y,bt),jt=0;jt<Y;jt++)for(var Ht=0;Ht<bt;Ht++)$t.set(jt,Ht,Math.max(at.get(jt,Ht),H.get(jt,Ht)));return $t}},{key:"checkMatrix",value:function(at){return Lt.isMatrix(at)?at:new ee(at)}},{key:"isMatrix",value:function(at){return at!=null&&at.klass==="Matrix"}}]),Lt}();te.prototype.klass="Matrix",typeof Symbol!="undefined"&&(te.prototype[Symbol.for("nodejs.util.inspect.custom")]=R);function Me(Lt,kt){return Lt-kt}function We(Lt){return Lt.every(function(kt){return typeof kt=="number"})}te.random=te.rand,te.randomInt=te.randInt,te.diagonal=te.diag,te.prototype.diagonal=te.prototype.diag,te.identity=te.eye,te.prototype.negate=te.prototype.neg,te.prototype.tensorProduct=te.prototype.kroneckerProduct;var ee=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H,Y){var bt;if((0,W.Z)(this,at),bt=kt.call(this),at.isMatrix(H))return(0,X.Z)(bt,H.clone());if(Number.isInteger(H)&&H>=0)if(bt.data=[],Number.isInteger(Y)&&Y>=0)for(var $t=0;$t<H;$t++)bt.data.push(new Float64Array(Y));else throw new TypeError("nColumns must be a positive integer");else if(L(H)){var jt=H;if(H=jt.length,Y=H?jt[0].length:0,typeof Y!="number")throw new TypeError("Data must be a 2D array with at least one element");bt.data=[];for(var Ht=0;Ht<H;Ht++){if(jt[Ht].length!==Y)throw new RangeError("Inconsistent array dimensions");if(!We(jt[Ht]))throw new TypeError("Input data contains non-numeric values");bt.data.push(Float64Array.from(jt[Ht]))}}else throw new TypeError("First argument must be a positive number or an array");return bt.rows=H,bt.columns=Y,bt}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){return this.data[Y][bt]=$t,this}},{key:"get",value:function(Y,bt){return this.data[Y][bt]}},{key:"removeRow",value:function(Y){return mt(this,Y),this.data.splice(Y,1),this.rows-=1,this}},{key:"addRow",value:function(Y,bt){return bt===void 0&&(bt=Y,Y=this.rows),mt(this,Y,!0),bt=Float64Array.from(ut(this,bt)),this.data.splice(Y,0,bt),this.rows+=1,this}},{key:"removeColumn",value:function(Y){st(this,Y);for(var bt=0;bt<this.rows;bt++){for(var $t=new Float64Array(this.columns-1),jt=0;jt<Y;jt++)$t[jt]=this.data[bt][jt];for(var Ht=Y+1;Ht<this.columns;Ht++)$t[Ht-1]=this.data[bt][Ht];this.data[bt]=$t}return this.columns-=1,this}},{key:"addColumn",value:function(Y,bt){typeof bt=="undefined"&&(bt=Y,Y=this.columns),st(this,Y,!0),bt=dt(this,bt);for(var $t=0;$t<this.rows;$t++){for(var jt=new Float64Array(this.columns+1),Ht=0;Ht<Y;Ht++)jt[Ht]=this.data[$t][Ht];for(jt[Ht++]=bt[$t];Ht<this.columns+1;Ht++)jt[Ht]=this.data[$t][Ht-1];this.data[$t]=jt}return this.columns+=1,this}}]),at}(te);ft(te,ee);var Pt=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H,Y,bt){var $t;return(0,W.Z)(this,at),$t=kt.call(this),$t.matrix=H,$t.rows=Y,$t.columns=bt,$t}return(0,Q.Z)(at)}(te),yt=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H,Y){var bt;return(0,W.Z)(this,at),st(H,Y),bt=kt.call(this,H,H.rows,1),bt.column=Y,bt}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){return this.matrix.set(Y,this.column,$t),this}},{key:"get",value:function(Y){return this.matrix.get(Y,this.column)}}]),at}(Pt),Ne=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H,Y){var bt;return(0,W.Z)(this,at),wt(H,Y),bt=kt.call(this,H,H.rows,Y.length),bt.columnIndices=Y,bt}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){return this.matrix.set(Y,this.columnIndices[bt],$t),this}},{key:"get",value:function(Y,bt){return this.matrix.get(Y,this.columnIndices[bt])}}]),at}(Pt),tn=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H){return(0,W.Z)(this,at),kt.call(this,H,H.rows,H.columns)}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){return this.matrix.set(Y,this.columns-bt-1,$t),this}},{key:"get",value:function(Y,bt){return this.matrix.get(Y,this.columns-bt-1)}}]),at}(Pt),fn=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H){return(0,W.Z)(this,at),kt.call(this,H,H.rows,H.columns)}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){return this.matrix.set(this.rows-Y-1,bt,$t),this}},{key:"get",value:function(Y,bt){return this.matrix.get(this.rows-Y-1,bt)}}]),at}(Pt),Rt=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H,Y){var bt;return(0,W.Z)(this,at),mt(H,Y),bt=kt.call(this,H,1,H.columns),bt.row=Y,bt}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){return this.matrix.set(this.row,bt,$t),this}},{key:"get",value:function(Y,bt){return this.matrix.get(this.row,bt)}}]),at}(Pt),Yn=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H,Y){var bt;return(0,W.Z)(this,at),gt(H,Y),bt=kt.call(this,H,Y.length,H.columns),bt.rowIndices=Y,bt}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){return this.matrix.set(this.rowIndices[Y],bt,$t),this}},{key:"get",value:function(Y,bt){return this.matrix.get(this.rowIndices[Y],bt)}}]),at}(Pt),Un=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H,Y,bt){var $t;return(0,W.Z)(this,at),gt(H,Y),wt(H,bt),$t=kt.call(this,H,Y.length,bt.length),$t.rowIndices=Y,$t.columnIndices=bt,$t}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){return this.matrix.set(this.rowIndices[Y],this.columnIndices[bt],$t),this}},{key:"get",value:function(Y,bt){return this.matrix.get(this.rowIndices[Y],this.columnIndices[bt])}}]),at}(Pt),xr=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H,Y,bt,$t,jt){var Ht;return(0,W.Z)(this,at),ot(H,Y,bt,$t,jt),Ht=kt.call(this,H,bt-Y+1,jt-$t+1),Ht.startRow=Y,Ht.startColumn=$t,Ht}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){return this.matrix.set(this.startRow+Y,this.startColumn+bt,$t),this}},{key:"get",value:function(Y,bt){return this.matrix.get(this.startRow+Y,this.startColumn+bt)}}]),at}(Pt),cr=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H){return(0,W.Z)(this,at),kt.call(this,H,H.columns,H.rows)}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){return this.matrix.set(bt,Y,$t),this}},{key:"get",value:function(Y,bt){return this.matrix.get(bt,Y)}}]),at}(Pt),Ur=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H){var Y,bt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,W.Z)(this,at);var $t=bt.rows,jt=$t===void 0?1:$t;if(H.length%jt!=0)throw new Error("the data length is not divisible by the number of rows");return Y=kt.call(this),Y.rows=jt,Y.columns=H.length/jt,Y.data=H,Y}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){var jt=this._calculateIndex(Y,bt);return this.data[jt]=$t,this}},{key:"get",value:function(Y,bt){var $t=this._calculateIndex(Y,bt);return this.data[$t]}},{key:"_calculateIndex",value:function(Y,bt){return Y*this.columns+bt}}]),at}(te),fa=function(Lt){(0,tt.Z)(at,Lt);var kt=(0,j.Z)(at);function at(H){var Y;return(0,W.Z)(this,at),Y=kt.call(this),Y.data=H,Y.rows=H.length,Y.columns=H[0].length,Y}return(0,Q.Z)(at,[{key:"set",value:function(Y,bt,$t){return this.data[Y][bt]=$t,this}},{key:"get",value:function(Y,bt){return this.data[Y][bt]}}]),at}(te);function Sa(Lt,kt){if(L(Lt))return Lt[0]&&L(Lt[0])?new fa(Lt):new Ur(Lt,kt);throw new Error("the argument is not an array")}var sa=function(){function Lt(kt){(0,W.Z)(this,Lt),kt=fa.checkMatrix(kt);var at=kt.clone(),H=at.rows,Y=at.columns,bt=new Float64Array(H),$t=1,jt,Ht,re,on,Je,Ve,qn,Ln,qr;for(jt=0;jt<H;jt++)bt[jt]=jt;for(Ln=new Float64Array(H),Ht=0;Ht<Y;Ht++){for(jt=0;jt<H;jt++)Ln[jt]=at.get(jt,Ht);for(jt=0;jt<H;jt++){for(qr=Math.min(jt,Ht),Je=0,re=0;re<qr;re++)Je+=at.get(jt,re)*Ln[re];Ln[jt]-=Je,at.set(jt,Ht,Ln[jt])}for(on=Ht,jt=Ht+1;jt<H;jt++)Math.abs(Ln[jt])>Math.abs(Ln[on])&&(on=jt);if(on!==Ht){for(re=0;re<Y;re++)Ve=at.get(on,re),at.set(on,re,at.get(Ht,re)),at.set(Ht,re,Ve);qn=bt[on],bt[on]=bt[Ht],bt[Ht]=qn,$t=-$t}if(Ht<H&&at.get(Ht,Ht)!==0)for(jt=Ht+1;jt<H;jt++)at.set(jt,Ht,at.get(jt,Ht)/at.get(Ht,Ht))}this.LU=at,this.pivotVector=bt,this.pivotSign=$t}return(0,Q.Z)(Lt,[{key:"isSingular",value:function(){for(var at=this.LU,H=at.columns,Y=0;Y<H;Y++)if(at.get(Y,Y)===0)return!0;return!1}},{key:"solve",value:function(at){at=ee.checkMatrix(at);var H=this.LU,Y=H.rows;if(Y!==at.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var bt=at.columns,$t=at.subMatrixRow(this.pivotVector,0,bt-1),jt=H.columns,Ht,re,on;for(on=0;on<jt;on++)for(Ht=on+1;Ht<jt;Ht++)for(re=0;re<bt;re++)$t.set(Ht,re,$t.get(Ht,re)-$t.get(on,re)*H.get(Ht,on));for(on=jt-1;on>=0;on--){for(re=0;re<bt;re++)$t.set(on,re,$t.get(on,re)/H.get(on,on));for(Ht=0;Ht<on;Ht++)for(re=0;re<bt;re++)$t.set(Ht,re,$t.get(Ht,re)-$t.get(on,re)*H.get(Ht,on))}return $t}},{key:"determinant",get:function(){var at=this.LU;if(!at.isSquare())throw new Error("Matrix must be square");for(var H=this.pivotSign,Y=at.columns,bt=0;bt<Y;bt++)H*=at.get(bt,bt);return H}},{key:"lowerTriangularMatrix",get:function(){for(var at=this.LU,H=at.rows,Y=at.columns,bt=new ee(H,Y),$t=0;$t<H;$t++)for(var jt=0;jt<Y;jt++)$t>jt?bt.set($t,jt,at.get($t,jt)):$t===jt?bt.set($t,jt,1):bt.set($t,jt,0);return bt}},{key:"upperTriangularMatrix",get:function(){for(var at=this.LU,H=at.rows,Y=at.columns,bt=new ee(H,Y),$t=0;$t<H;$t++)for(var jt=0;jt<Y;jt++)$t<=jt?bt.set($t,jt,at.get($t,jt)):bt.set($t,jt,0);return bt}},{key:"pivotPermutationVector",get:function(){return Array.from(this.pivotVector)}}]),Lt}();function Da(Lt,kt){var at=0;return Math.abs(Lt)>Math.abs(kt)?(at=kt/Lt,Math.abs(Lt)*Math.sqrt(1+at*at)):kt!==0?(at=Lt/kt,Math.abs(kt)*Math.sqrt(1+at*at)):0}var Rr=function(){function Lt(kt){(0,W.Z)(this,Lt),kt=fa.checkMatrix(kt);var at=kt.clone(),H=kt.rows,Y=kt.columns,bt=new Float64Array(Y),$t,jt,Ht,re;for(Ht=0;Ht<Y;Ht++){var on=0;for($t=Ht;$t<H;$t++)on=Da(on,at.get($t,Ht));if(on!==0){for(at.get(Ht,Ht)<0&&(on=-on),$t=Ht;$t<H;$t++)at.set($t,Ht,at.get($t,Ht)/on);for(at.set(Ht,Ht,at.get(Ht,Ht)+1),jt=Ht+1;jt<Y;jt++){for(re=0,$t=Ht;$t<H;$t++)re+=at.get($t,Ht)*at.get($t,jt);for(re=-re/at.get(Ht,Ht),$t=Ht;$t<H;$t++)at.set($t,jt,at.get($t,jt)+re*at.get($t,Ht))}}bt[Ht]=-on}this.QR=at,this.Rdiag=bt}return(0,Q.Z)(Lt,[{key:"solve",value:function(at){at=ee.checkMatrix(at);var H=this.QR,Y=H.rows;if(at.rows!==Y)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var bt=at.columns,$t=at.clone(),jt=H.columns,Ht,re,on,Je;for(on=0;on<jt;on++)for(re=0;re<bt;re++){for(Je=0,Ht=on;Ht<Y;Ht++)Je+=H.get(Ht,on)*$t.get(Ht,re);for(Je=-Je/H.get(on,on),Ht=on;Ht<Y;Ht++)$t.set(Ht,re,$t.get(Ht,re)+Je*H.get(Ht,on))}for(on=jt-1;on>=0;on--){for(re=0;re<bt;re++)$t.set(on,re,$t.get(on,re)/this.Rdiag[on]);for(Ht=0;Ht<on;Ht++)for(re=0;re<bt;re++)$t.set(Ht,re,$t.get(Ht,re)-$t.get(on,re)*H.get(Ht,on))}return $t.subMatrix(0,jt-1,0,bt-1)}},{key:"isFullRank",value:function(){for(var at=this.QR.columns,H=0;H<at;H++)if(this.Rdiag[H]===0)return!1;return!0}},{key:"upperTriangularMatrix",get:function(){var at=this.QR,H=at.columns,Y=new ee(H,H),bt,$t;for(bt=0;bt<H;bt++)for($t=0;$t<H;$t++)bt<$t?Y.set(bt,$t,at.get(bt,$t)):bt===$t?Y.set(bt,$t,this.Rdiag[bt]):Y.set(bt,$t,0);return Y}},{key:"orthogonalMatrix",get:function(){var at=this.QR,H=at.rows,Y=at.columns,bt=new ee(H,Y),$t,jt,Ht,re;for(Ht=Y-1;Ht>=0;Ht--){for($t=0;$t<H;$t++)bt.set($t,Ht,0);for(bt.set(Ht,Ht,1),jt=Ht;jt<Y;jt++)if(at.get(Ht,Ht)!==0){for(re=0,$t=Ht;$t<H;$t++)re+=at.get($t,Ht)*bt.get($t,jt);for(re=-re/at.get(Ht,Ht),$t=Ht;$t<H;$t++)bt.set($t,jt,bt.get($t,jt)+re*at.get($t,Ht))}}return bt}}]),Lt}(),Mn=function(){function Lt(kt){var at=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if((0,W.Z)(this,Lt),kt=fa.checkMatrix(kt),kt.isEmpty())throw new Error("Matrix must be non-empty");var H=kt.rows,Y=kt.columns,bt=at.computeLeftSingularVectors,$t=bt===void 0?!0:bt,jt=at.computeRightSingularVectors,Ht=jt===void 0?!0:jt,re=at.autoTranspose,on=re===void 0?!1:re,Je=Boolean($t),Ve=Boolean(Ht),qn=!1,Ln;if(H<Y)if(!on)Ln=kt.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{Ln=kt.transpose(),H=Ln.rows,Y=Ln.columns,qn=!0;var qr=Je;Je=Ve,Ve=qr}else Ln=kt.clone();for(var Ca=Math.min(H,Y),Qn=Math.min(H+1,Y),_r=new Float64Array(Qn),ea=new ee(H,Ca),La=new ee(Y,Y),ha=new Float64Array(Y),_i=new Float64Array(H),Ni=new Float64Array(Qn),vi=0;vi<Qn;vi++)Ni[vi]=vi;for(var si=Math.min(H-1,Y),Mi=Math.max(0,Math.min(Y-2,H)),Pa=Math.max(si,Mi),un=0;un<Pa;un++){if(un<si){_r[un]=0;for(var Oe=un;Oe<H;Oe++)_r[un]=Da(_r[un],Ln.get(Oe,un));if(_r[un]!==0){Ln.get(un,un)<0&&(_r[un]=-_r[un]);for(var hn=un;hn<H;hn++)Ln.set(hn,un,Ln.get(hn,un)/_r[un]);Ln.set(un,un,Ln.get(un,un)+1)}_r[un]=-_r[un]}for(var Hn=un+1;Hn<Y;Hn++){if(un<si&&_r[un]!==0){for(var Bn=0,Jn=un;Jn<H;Jn++)Bn+=Ln.get(Jn,un)*Ln.get(Jn,Hn);Bn=-Bn/Ln.get(un,un);for(var Lr=un;Lr<H;Lr++)Ln.set(Lr,Hn,Ln.get(Lr,Hn)+Bn*Ln.get(Lr,un))}ha[Hn]=Ln.get(un,Hn)}if(Je&&un<si)for(var ya=un;ya<H;ya++)ea.set(ya,un,Ln.get(ya,un));if(un<Mi){ha[un]=0;for(var Fa=un+1;Fa<Y;Fa++)ha[un]=Da(ha[un],ha[Fa]);if(ha[un]!==0){ha[un+1]<0&&(ha[un]=0-ha[un]);for(var ui=un+1;ui<Y;ui++)ha[ui]/=ha[un];ha[un+1]+=1}if(ha[un]=-ha[un],un+1<H&&ha[un]!==0){for(var Ei=un+1;Ei<H;Ei++)_i[Ei]=0;for(var oo=un+1;oo<H;oo++)for(var po=un+1;po<Y;po++)_i[oo]+=ha[po]*Ln.get(oo,po);for(var bo=un+1;bo<Y;bo++)for(var ts=-ha[bo]/ha[un+1],Wo=un+1;Wo<H;Wo++)Ln.set(Wo,bo,Ln.get(Wo,bo)+ts*_i[Wo])}if(Ve)for(var Yi=un+1;Yi<Y;Yi++)La.set(Yi,un,ha[Yi])}}var wi=Math.min(Y,H+1);if(si<Y&&(_r[si]=Ln.get(si,si)),H<wi&&(_r[wi-1]=0),Mi+1<wi&&(ha[Mi]=Ln.get(Mi,wi-1)),ha[wi-1]=0,Je){for(var gi=si;gi<Ca;gi++){for(var us=0;us<H;us++)ea.set(us,gi,0);ea.set(gi,gi,1)}for(var Do=si-1;Do>=0;Do--)if(_r[Do]!==0){for(var Io=Do+1;Io<Ca;Io++){for(var zs=0,mu=Do;mu<H;mu++)zs+=ea.get(mu,Do)*ea.get(mu,Io);zs=-zs/ea.get(Do,Do);for(var ds=Do;ds<H;ds++)ea.set(ds,Io,ea.get(ds,Io)+zs*ea.get(ds,Do))}for(var Ms=Do;Ms<H;Ms++)ea.set(Ms,Do,-ea.get(Ms,Do));ea.set(Do,Do,1+ea.get(Do,Do));for(var yu=0;yu<Do-1;yu++)ea.set(yu,Do,0)}else{for(var uu=0;uu<H;uu++)ea.set(uu,Do,0);ea.set(Do,Do,1)}}if(Ve)for(var Cs=Y-1;Cs>=0;Cs--){if(Cs<Mi&&ha[Cs]!==0)for(var qo=Cs+1;qo<Y;qo++){for(var Wi=0,ls=Cs+1;ls<Y;ls++)Wi+=La.get(ls,Cs)*La.get(ls,qo);Wi=-Wi/La.get(Cs+1,Cs);for(var is=Cs+1;is<Y;is++)La.set(is,qo,La.get(is,qo)+Wi*La.get(is,Cs))}for(var Es=0;Es<Y;Es++)La.set(Es,Cs,0);La.set(Cs,Cs,1)}for(var tl=wi-1,bu=0,Ys=Number.EPSILON;wi>0;){var ka=void 0,Ku=void 0;for(ka=wi-2;ka>=-1&&ka!==-1;ka--){var Vs=Number.MIN_VALUE+Ys*Math.abs(_r[ka]+Math.abs(_r[ka+1]));if(Math.abs(ha[ka])<=Vs||Number.isNaN(ha[ka])){ha[ka]=0;break}}if(ka===wi-2)Ku=4;else{var Ro=void 0;for(Ro=wi-1;Ro>=ka&&Ro!==ka;Ro--){var Ns=(Ro!==wi?Math.abs(ha[Ro]):0)+(Ro!==ka+1?Math.abs(ha[Ro-1]):0);if(Math.abs(_r[Ro])<=Ys*Ns){_r[Ro]=0;break}}Ro===ka?Ku=3:Ro===wi-1?Ku=1:(Ku=2,ka=Ro)}switch(ka++,Ku){case 1:{var tu=ha[wi-2];ha[wi-2]=0;for(var eu=wi-2;eu>=ka;eu--){var Zu=Da(_r[eu],tu),bn=_r[eu]/Zu,Xr=tu/Zu;if(_r[eu]=Zu,eu!==ka&&(tu=-Xr*ha[eu-1],ha[eu-1]=bn*ha[eu-1]),Ve)for(var pa=0;pa<Y;pa++)Zu=bn*La.get(pa,eu)+Xr*La.get(pa,wi-1),La.set(pa,wi-1,-Xr*La.get(pa,eu)+bn*La.get(pa,wi-1)),La.set(pa,eu,Zu)}break}case 2:{var Ra=ha[ka-1];ha[ka-1]=0;for(var Qi=ka;Qi<wi;Qi++){var Co=Da(_r[Qi],Ra),to=_r[Qi]/Co,xo=Ra/Co;if(_r[Qi]=Co,Ra=-xo*ha[Qi],ha[Qi]=to*ha[Qi],Je)for(var gs=0;gs<H;gs++)Co=to*ea.get(gs,Qi)+xo*ea.get(gs,ka-1),ea.set(gs,ka-1,-xo*ea.get(gs,Qi)+to*ea.get(gs,ka-1)),ea.set(gs,Qi,Co)}break}case 3:{var vo=Math.max(Math.abs(_r[wi-1]),Math.abs(_r[wi-2]),Math.abs(ha[wi-2]),Math.abs(_r[ka]),Math.abs(ha[ka])),ou=_r[wi-1]/vo,ms=_r[wi-2]/vo,xu=ha[wi-2]/vo,dl=_r[ka]/vo,kl=ha[ka]/vo,Ks=((ms+ou)*(ms-ou)+xu*xu)/2,el=ou*xu*(ou*xu),lu=0;(Ks!==0||el!==0)&&(Ks<0?lu=0-Math.sqrt(Ks*Ks+el):lu=Math.sqrt(Ks*Ks+el),lu=el/(Ks+lu));for(var Du=(dl+ou)*(dl-ou)+lu,pl=dl*kl,ns=ka;ns<wi-1;ns++){var _s=Da(Du,pl);_s===0&&(_s=Number.MIN_VALUE);var Bu=Du/_s,Au=pl/_s;if(ns!==ka&&(ha[ns-1]=_s),Du=Bu*_r[ns]+Au*ha[ns],ha[ns]=Bu*ha[ns]-Au*_r[ns],pl=Au*_r[ns+1],_r[ns+1]=Bu*_r[ns+1],Ve)for(var wu=0;wu<Y;wu++)_s=Bu*La.get(wu,ns)+Au*La.get(wu,ns+1),La.set(wu,ns+1,-Au*La.get(wu,ns)+Bu*La.get(wu,ns+1)),La.set(wu,ns,_s);if(_s=Da(Du,pl),_s===0&&(_s=Number.MIN_VALUE),Bu=Du/_s,Au=pl/_s,_r[ns]=_s,Du=Bu*ha[ns]+Au*_r[ns+1],_r[ns+1]=-Au*ha[ns]+Bu*_r[ns+1],pl=Au*ha[ns+1],ha[ns+1]=Bu*ha[ns+1],Je&&ns<H-1)for(var nu=0;nu<H;nu++)_s=Bu*ea.get(nu,ns)+Au*ea.get(nu,ns+1),ea.set(nu,ns+1,-Au*ea.get(nu,ns)+Bu*ea.get(nu,ns+1)),ea.set(nu,ns,_s)}ha[wi-2]=Du,bu=bu+1;break}case 4:{if(_r[ka]<=0&&(_r[ka]=_r[ka]<0?-_r[ka]:0,Ve))for(var Tl=0;Tl<=tl;Tl++)La.set(Tl,ka,-La.get(Tl,ka));for(;ka<tl&&!(_r[ka]>=_r[ka+1]);){var xc=_r[ka];if(_r[ka]=_r[ka+1],_r[ka+1]=xc,Ve&&ka<Y-1)for(var Sl=0;Sl<Y;Sl++)xc=La.get(Sl,ka+1),La.set(Sl,ka+1,La.get(Sl,ka)),La.set(Sl,ka,xc);if(Je&&ka<H-1)for(var ol=0;ol<H;ol++)xc=ea.get(ol,ka+1),ea.set(ol,ka+1,ea.get(ol,ka)),ea.set(ol,ka,xc);ka++}bu=0,wi--;break}}}if(qn){var ys=La;La=ea,ea=ys}this.m=H,this.n=Y,this.s=_r,this.U=ea,this.V=La}return(0,Q.Z)(Lt,[{key:"solve",value:function(at){for(var H=at,Y=this.threshold,bt=this.s.length,$t=ee.zeros(bt,bt),jt=0;jt<bt;jt++)Math.abs(this.s[jt])<=Y?$t.set(jt,jt,0):$t.set(jt,jt,1/this.s[jt]);for(var Ht=this.U,re=this.rightSingularVectors,on=re.mmul($t),Je=re.rows,Ve=Ht.rows,qn=ee.zeros(Je,Ve),Ln=0;Ln<Je;Ln++)for(var qr=0;qr<Ve;qr++){for(var Ca=0,Qn=0;Qn<bt;Qn++)Ca+=on.get(Ln,Qn)*Ht.get(qr,Qn);qn.set(Ln,qr,Ca)}return qn.mmul(H)}},{key:"solveForDiagonal",value:function(at){return this.solve(ee.diag(at))}},{key:"inverse",value:function(){for(var at=this.V,H=this.threshold,Y=at.rows,bt=at.columns,$t=new ee(Y,this.s.length),jt=0;jt<Y;jt++)for(var Ht=0;Ht<bt;Ht++)Math.abs(this.s[Ht])>H&&$t.set(jt,Ht,at.get(jt,Ht)/this.s[Ht]);for(var re=this.U,on=re.rows,Je=re.columns,Ve=new ee(Y,on),qn=0;qn<Y;qn++)for(var Ln=0;Ln<on;Ln++){for(var qr=0,Ca=0;Ca<Je;Ca++)qr+=$t.get(qn,Ca)*re.get(Ln,Ca);Ve.set(qn,Ln,qr)}return Ve}},{key:"condition",get:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}},{key:"norm2",get:function(){return this.s[0]}},{key:"rank",get:function(){for(var at=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,H=0,Y=this.s,bt=0,$t=Y.length;bt<$t;bt++)Y[bt]>at&&H++;return H}},{key:"diagonal",get:function(){return Array.from(this.s)}},{key:"threshold",get:function(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}},{key:"leftSingularVectors",get:function(){return this.U}},{key:"rightSingularVectors",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){return ee.diag(this.s)}}]),Lt}();function ar(Lt){var kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Lt=fa.checkMatrix(Lt),kt?new Mn(Lt).inverse():Fn(Lt,ee.eye(Lt.rows))}function Fn(Lt,kt){var at=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return Lt=fa.checkMatrix(Lt),kt=fa.checkMatrix(kt),at?new Mn(Lt).solve(kt):Lt.isSquare()?new sa(Lt).solve(kt):new Rr(Lt).solve(kt)}function tr(Lt){if(Lt=ee.checkMatrix(Lt),Lt.isSquare()){if(Lt.columns===0)return 1;var kt,at,H,Y;if(Lt.columns===2)return kt=Lt.get(0,0),at=Lt.get(0,1),H=Lt.get(1,0),Y=Lt.get(1,1),kt*Y-at*H;if(Lt.columns===3){var bt,$t,jt;return bt=new Un(Lt,[1,2],[1,2]),$t=new Un(Lt,[1,2],[0,2]),jt=new Un(Lt,[1,2],[0,1]),kt=Lt.get(0,0),at=Lt.get(0,1),H=Lt.get(0,2),kt*tr(bt)-at*tr($t)+H*tr(jt)}else return new sa(Lt).determinant}else throw Error("determinant can only be calculated for a square matrix")}function Gn(Lt,kt){for(var at=[],H=0;H<Lt;H++)H!==kt&&at.push(H);return at}function jr(Lt,kt,at){var H=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e-9,Y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e-9;if(Lt>Y)return new Array(kt.rows+1).fill(0);for(var bt=kt.addRow(at,[0]),$t=0;$t<bt.rows;$t++)Math.abs(bt.get($t,0))<H&&bt.set($t,0,0);return bt.to1DArray()}function Hr(Lt){var kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},at=kt.thresholdValue,H=at===void 0?1e-9:at,Y=kt.thresholdError,bt=Y===void 0?1e-9:Y;Lt=ee.checkMatrix(Lt);for(var $t=Lt.rows,jt=new ee($t,$t),Ht=0;Ht<$t;Ht++){var re=ee.columnVector(Lt.getRow(Ht)),on=Lt.subMatrixRow(Gn($t,Ht)).transpose(),Je=new Mn(on),Ve=Je.solve(re),qn=ee.sub(re,on.mmul(Ve)).abs().max();jt.setRow(Ht,jr(qn,Ve,Ht,H,bt))}return jt}function Ea(Lt){var kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.EPSILON;if(Lt=ee.checkMatrix(Lt),Lt.isEmpty())return Lt.transpose();for(var at=new Mn(Lt,{autoTranspose:!0}),H=at.leftSingularVectors,Y=at.rightSingularVectors,bt=at.diagonal,$t=0;$t<bt.length;$t++)Math.abs(bt[$t])>kt?bt[$t]=1/bt[$t]:bt[$t]=0;return Y.mmul(ee.diag(bt).mmul(H.transpose()))}function lr(Lt){var kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lt,at=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Lt=new ee(Lt);var H=!1;if(typeof kt=="object"&&!ee.isMatrix(kt)&&!L(kt)?(at=kt,kt=Lt,H=!0):kt=new ee(kt),Lt.rows!==kt.rows)throw new TypeError("Both matrices must have the same number of rows");var Y=at,bt=Y.center,$t=bt===void 0?!0:bt;$t&&(Lt=Lt.center("column"),H||(kt=kt.center("column")));for(var jt=Lt.transpose().mmul(kt),Ht=0;Ht<jt.rows;Ht++)for(var re=0;re<jt.columns;re++)jt.set(Ht,re,jt.get(Ht,re)*(1/(Lt.rows-1)));return jt}function Cr(Lt){var kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lt,at=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Lt=new ee(Lt);var H=!1;if(typeof kt=="object"&&!ee.isMatrix(kt)&&!L(kt)?(at=kt,kt=Lt,H=!0):kt=new ee(kt),Lt.rows!==kt.rows)throw new TypeError("Both matrices must have the same number of rows");var Y=at,bt=Y.center,$t=bt===void 0?!0:bt,jt=Y.scale,Ht=jt===void 0?!0:jt;$t&&(Lt.center("column"),H||kt.center("column")),Ht&&(Lt.scale("column"),H||kt.scale("column"));for(var re=Lt.standardDeviation("column",{unbiased:!0}),on=H?re:kt.standardDeviation("column",{unbiased:!0}),Je=Lt.transpose().mmul(kt),Ve=0;Ve<Je.rows;Ve++)for(var qn=0;qn<Je.columns;qn++)Je.set(Ve,qn,Je.get(Ve,qn)*(1/(re[Ve]*on[qn]))*(1/(Lt.rows-1)));return Je}var vr=function(){function Lt(kt){var at=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,W.Z)(this,Lt);var H=at.assumeSymmetric,Y=H===void 0?!1:H;if(kt=fa.checkMatrix(kt),!kt.isSquare())throw new Error("Matrix is not a square matrix");if(kt.isEmpty())throw new Error("Matrix must be non-empty");var bt=kt.columns,$t=new ee(bt,bt),jt=new Float64Array(bt),Ht=new Float64Array(bt),re=kt,on,Je,Ve=!1;if(Y?Ve=!0:Ve=kt.isSymmetric(),Ve){for(on=0;on<bt;on++)for(Je=0;Je<bt;Je++)$t.set(on,Je,re.get(on,Je));Tr(bt,Ht,jt,$t),ta(bt,Ht,jt,$t)}else{var qn=new ee(bt,bt),Ln=new Float64Array(bt);for(Je=0;Je<bt;Je++)for(on=0;on<bt;on++)qn.set(on,Je,re.get(on,Je));ra(bt,qn,Ln,$t),Zr(bt,Ht,jt,$t,qn)}this.n=bt,this.e=Ht,this.d=jt,this.V=$t}return(0,Q.Z)(Lt,[{key:"realEigenvalues",get:function(){return Array.from(this.d)}},{key:"imaginaryEigenvalues",get:function(){return Array.from(this.e)}},{key:"eigenvectorMatrix",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){var at=this.n,H=this.e,Y=this.d,bt=new ee(at,at),$t,jt;for($t=0;$t<at;$t++){for(jt=0;jt<at;jt++)bt.set($t,jt,0);bt.set($t,$t,Y[$t]),H[$t]>0?bt.set($t,$t+1,H[$t]):H[$t]<0&&bt.set($t,$t-1,H[$t])}return bt}}]),Lt}();function Tr(Lt,kt,at,H){var Y,bt,$t,jt,Ht,re,on,Je;for(Ht=0;Ht<Lt;Ht++)at[Ht]=H.get(Lt-1,Ht);for(jt=Lt-1;jt>0;jt--){for(Je=0,$t=0,re=0;re<jt;re++)Je=Je+Math.abs(at[re]);if(Je===0)for(kt[jt]=at[jt-1],Ht=0;Ht<jt;Ht++)at[Ht]=H.get(jt-1,Ht),H.set(jt,Ht,0),H.set(Ht,jt,0);else{for(re=0;re<jt;re++)at[re]/=Je,$t+=at[re]*at[re];for(Y=at[jt-1],bt=Math.sqrt($t),Y>0&&(bt=-bt),kt[jt]=Je*bt,$t=$t-Y*bt,at[jt-1]=Y-bt,Ht=0;Ht<jt;Ht++)kt[Ht]=0;for(Ht=0;Ht<jt;Ht++){for(Y=at[Ht],H.set(Ht,jt,Y),bt=kt[Ht]+H.get(Ht,Ht)*Y,re=Ht+1;re<=jt-1;re++)bt+=H.get(re,Ht)*at[re],kt[re]+=H.get(re,Ht)*Y;kt[Ht]=bt}for(Y=0,Ht=0;Ht<jt;Ht++)kt[Ht]/=$t,Y+=kt[Ht]*at[Ht];for(on=Y/($t+$t),Ht=0;Ht<jt;Ht++)kt[Ht]-=on*at[Ht];for(Ht=0;Ht<jt;Ht++){for(Y=at[Ht],bt=kt[Ht],re=Ht;re<=jt-1;re++)H.set(re,Ht,H.get(re,Ht)-(Y*kt[re]+bt*at[re]));at[Ht]=H.get(jt-1,Ht),H.set(jt,Ht,0)}}at[jt]=$t}for(jt=0;jt<Lt-1;jt++){if(H.set(Lt-1,jt,H.get(jt,jt)),H.set(jt,jt,1),$t=at[jt+1],$t!==0){for(re=0;re<=jt;re++)at[re]=H.get(re,jt+1)/$t;for(Ht=0;Ht<=jt;Ht++){for(bt=0,re=0;re<=jt;re++)bt+=H.get(re,jt+1)*H.get(re,Ht);for(re=0;re<=jt;re++)H.set(re,Ht,H.get(re,Ht)-bt*at[re])}}for(re=0;re<=jt;re++)H.set(re,jt+1,0)}for(Ht=0;Ht<Lt;Ht++)at[Ht]=H.get(Lt-1,Ht),H.set(Lt-1,Ht,0);H.set(Lt-1,Lt-1,1),kt[0]=0}function ta(Lt,kt,at,H){var Y,bt,$t,jt,Ht,re,on,Je,Ve,qn,Ln,qr,Ca,Qn,_r,ea,La;for($t=1;$t<Lt;$t++)kt[$t-1]=kt[$t];kt[Lt-1]=0;var ha=0,_i=0,Ni=Number.EPSILON;for(re=0;re<Lt;re++){for(_i=Math.max(_i,Math.abs(at[re])+Math.abs(kt[re])),on=re;on<Lt&&!(Math.abs(kt[on])<=Ni*_i);)on++;if(on>re){La=0;do{for(La=La+1,Y=at[re],Je=(at[re+1]-Y)/(2*kt[re]),Ve=Da(Je,1),Je<0&&(Ve=-Ve),at[re]=kt[re]/(Je+Ve),at[re+1]=kt[re]*(Je+Ve),qn=at[re+1],bt=Y-at[re],$t=re+2;$t<Lt;$t++)at[$t]-=bt;for(ha=ha+bt,Je=at[on],Ln=1,qr=Ln,Ca=Ln,Qn=kt[re+1],_r=0,ea=0,$t=on-1;$t>=re;$t--)for(Ca=qr,qr=Ln,ea=_r,Y=Ln*kt[$t],bt=Ln*Je,Ve=Da(Je,kt[$t]),kt[$t+1]=_r*Ve,_r=kt[$t]/Ve,Ln=Je/Ve,Je=Ln*at[$t]-_r*Y,at[$t+1]=bt+_r*(Ln*Y+_r*at[$t]),Ht=0;Ht<Lt;Ht++)bt=H.get(Ht,$t+1),H.set(Ht,$t+1,_r*H.get(Ht,$t)+Ln*bt),H.set(Ht,$t,Ln*H.get(Ht,$t)-_r*bt);Je=-_r*ea*Ca*Qn*kt[re]/qn,kt[re]=_r*Je,at[re]=Ln*Je}while(Math.abs(kt[re])>Ni*_i)}at[re]=at[re]+ha,kt[re]=0}for($t=0;$t<Lt-1;$t++){for(Ht=$t,Je=at[$t],jt=$t+1;jt<Lt;jt++)at[jt]<Je&&(Ht=jt,Je=at[jt]);if(Ht!==$t)for(at[Ht]=at[$t],at[$t]=Je,jt=0;jt<Lt;jt++)Je=H.get(jt,$t),H.set(jt,$t,H.get(jt,Ht)),H.set(jt,Ht,Je)}}function ra(Lt,kt,at,H){var Y=0,bt=Lt-1,$t,jt,Ht,re,on,Je,Ve;for(Je=Y+1;Je<=bt-1;Je++){for(Ve=0,re=Je;re<=bt;re++)Ve=Ve+Math.abs(kt.get(re,Je-1));if(Ve!==0){for(Ht=0,re=bt;re>=Je;re--)at[re]=kt.get(re,Je-1)/Ve,Ht+=at[re]*at[re];for(jt=Math.sqrt(Ht),at[Je]>0&&(jt=-jt),Ht=Ht-at[Je]*jt,at[Je]=at[Je]-jt,on=Je;on<Lt;on++){for($t=0,re=bt;re>=Je;re--)$t+=at[re]*kt.get(re,on);for($t=$t/Ht,re=Je;re<=bt;re++)kt.set(re,on,kt.get(re,on)-$t*at[re])}for(re=0;re<=bt;re++){for($t=0,on=bt;on>=Je;on--)$t+=at[on]*kt.get(re,on);for($t=$t/Ht,on=Je;on<=bt;on++)kt.set(re,on,kt.get(re,on)-$t*at[on])}at[Je]=Ve*at[Je],kt.set(Je,Je-1,Ve*jt)}}for(re=0;re<Lt;re++)for(on=0;on<Lt;on++)H.set(re,on,re===on?1:0);for(Je=bt-1;Je>=Y+1;Je--)if(kt.get(Je,Je-1)!==0){for(re=Je+1;re<=bt;re++)at[re]=kt.get(re,Je-1);for(on=Je;on<=bt;on++){for(jt=0,re=Je;re<=bt;re++)jt+=at[re]*H.get(re,on);for(jt=jt/at[Je]/kt.get(Je,Je-1),re=Je;re<=bt;re++)H.set(re,on,H.get(re,on)+jt*at[re])}}}function Zr(Lt,kt,at,H,Y){var bt=Lt-1,$t=0,jt=Lt-1,Ht=Number.EPSILON,re=0,on=0,Je=0,Ve=0,qn=0,Ln=0,qr=0,Ca=0,Qn,_r,ea,La,ha,_i,Ni,vi,si,Mi,Pa,un,Oe,hn,Hn;for(Qn=0;Qn<Lt;Qn++)for((Qn<$t||Qn>jt)&&(at[Qn]=Y.get(Qn,Qn),kt[Qn]=0),_r=Math.max(Qn-1,0);_r<Lt;_r++)on=on+Math.abs(Y.get(Qn,_r));for(;bt>=$t;){for(La=bt;La>$t&&(Ln=Math.abs(Y.get(La-1,La-1))+Math.abs(Y.get(La,La)),Ln===0&&(Ln=on),!(Math.abs(Y.get(La,La-1))<Ht*Ln));)La--;if(La===bt)Y.set(bt,bt,Y.get(bt,bt)+re),at[bt]=Y.get(bt,bt),kt[bt]=0,bt--,Ca=0;else if(La===bt-1){if(Ni=Y.get(bt,bt-1)*Y.get(bt-1,bt),Je=(Y.get(bt-1,bt-1)-Y.get(bt,bt))/2,Ve=Je*Je+Ni,qr=Math.sqrt(Math.abs(Ve)),Y.set(bt,bt,Y.get(bt,bt)+re),Y.set(bt-1,bt-1,Y.get(bt-1,bt-1)+re),vi=Y.get(bt,bt),Ve>=0){for(qr=Je>=0?Je+qr:Je-qr,at[bt-1]=vi+qr,at[bt]=at[bt-1],qr!==0&&(at[bt]=vi-Ni/qr),kt[bt-1]=0,kt[bt]=0,vi=Y.get(bt,bt-1),Ln=Math.abs(vi)+Math.abs(qr),Je=vi/Ln,Ve=qr/Ln,qn=Math.sqrt(Je*Je+Ve*Ve),Je=Je/qn,Ve=Ve/qn,_r=bt-1;_r<Lt;_r++)qr=Y.get(bt-1,_r),Y.set(bt-1,_r,Ve*qr+Je*Y.get(bt,_r)),Y.set(bt,_r,Ve*Y.get(bt,_r)-Je*qr);for(Qn=0;Qn<=bt;Qn++)qr=Y.get(Qn,bt-1),Y.set(Qn,bt-1,Ve*qr+Je*Y.get(Qn,bt)),Y.set(Qn,bt,Ve*Y.get(Qn,bt)-Je*qr);for(Qn=$t;Qn<=jt;Qn++)qr=H.get(Qn,bt-1),H.set(Qn,bt-1,Ve*qr+Je*H.get(Qn,bt)),H.set(Qn,bt,Ve*H.get(Qn,bt)-Je*qr)}else at[bt-1]=vi+Je,at[bt]=vi+Je,kt[bt-1]=qr,kt[bt]=-qr;bt=bt-2,Ca=0}else{if(vi=Y.get(bt,bt),si=0,Ni=0,La<bt&&(si=Y.get(bt-1,bt-1),Ni=Y.get(bt,bt-1)*Y.get(bt-1,bt)),Ca===10){for(re+=vi,Qn=$t;Qn<=bt;Qn++)Y.set(Qn,Qn,Y.get(Qn,Qn)-vi);Ln=Math.abs(Y.get(bt,bt-1))+Math.abs(Y.get(bt-1,bt-2)),vi=si=.75*Ln,Ni=-.4375*Ln*Ln}if(Ca===30&&(Ln=(si-vi)/2,Ln=Ln*Ln+Ni,Ln>0)){for(Ln=Math.sqrt(Ln),si<vi&&(Ln=-Ln),Ln=vi-Ni/((si-vi)/2+Ln),Qn=$t;Qn<=bt;Qn++)Y.set(Qn,Qn,Y.get(Qn,Qn)-Ln);re+=Ln,vi=si=Ni=.964}for(Ca=Ca+1,ha=bt-2;ha>=La&&(qr=Y.get(ha,ha),qn=vi-qr,Ln=si-qr,Je=(qn*Ln-Ni)/Y.get(ha+1,ha)+Y.get(ha,ha+1),Ve=Y.get(ha+1,ha+1)-qr-qn-Ln,qn=Y.get(ha+2,ha+1),Ln=Math.abs(Je)+Math.abs(Ve)+Math.abs(qn),Je=Je/Ln,Ve=Ve/Ln,qn=qn/Ln,!(ha===La||Math.abs(Y.get(ha,ha-1))*(Math.abs(Ve)+Math.abs(qn))<Ht*(Math.abs(Je)*(Math.abs(Y.get(ha-1,ha-1))+Math.abs(qr)+Math.abs(Y.get(ha+1,ha+1))))));)ha--;for(Qn=ha+2;Qn<=bt;Qn++)Y.set(Qn,Qn-2,0),Qn>ha+2&&Y.set(Qn,Qn-3,0);for(ea=ha;ea<=bt-1&&(hn=ea!==bt-1,ea!==ha&&(Je=Y.get(ea,ea-1),Ve=Y.get(ea+1,ea-1),qn=hn?Y.get(ea+2,ea-1):0,vi=Math.abs(Je)+Math.abs(Ve)+Math.abs(qn),vi!==0&&(Je=Je/vi,Ve=Ve/vi,qn=qn/vi)),vi!==0);ea++)if(Ln=Math.sqrt(Je*Je+Ve*Ve+qn*qn),Je<0&&(Ln=-Ln),Ln!==0){for(ea!==ha?Y.set(ea,ea-1,-Ln*vi):La!==ha&&Y.set(ea,ea-1,-Y.get(ea,ea-1)),Je=Je+Ln,vi=Je/Ln,si=Ve/Ln,qr=qn/Ln,Ve=Ve/Je,qn=qn/Je,_r=ea;_r<Lt;_r++)Je=Y.get(ea,_r)+Ve*Y.get(ea+1,_r),hn&&(Je=Je+qn*Y.get(ea+2,_r),Y.set(ea+2,_r,Y.get(ea+2,_r)-Je*qr)),Y.set(ea,_r,Y.get(ea,_r)-Je*vi),Y.set(ea+1,_r,Y.get(ea+1,_r)-Je*si);for(Qn=0;Qn<=Math.min(bt,ea+3);Qn++)Je=vi*Y.get(Qn,ea)+si*Y.get(Qn,ea+1),hn&&(Je=Je+qr*Y.get(Qn,ea+2),Y.set(Qn,ea+2,Y.get(Qn,ea+2)-Je*qn)),Y.set(Qn,ea,Y.get(Qn,ea)-Je),Y.set(Qn,ea+1,Y.get(Qn,ea+1)-Je*Ve);for(Qn=$t;Qn<=jt;Qn++)Je=vi*H.get(Qn,ea)+si*H.get(Qn,ea+1),hn&&(Je=Je+qr*H.get(Qn,ea+2),H.set(Qn,ea+2,H.get(Qn,ea+2)-Je*qn)),H.set(Qn,ea,H.get(Qn,ea)-Je),H.set(Qn,ea+1,H.get(Qn,ea+1)-Je*Ve)}}}if(on!==0){for(bt=Lt-1;bt>=0;bt--)if(Je=at[bt],Ve=kt[bt],Ve===0)for(La=bt,Y.set(bt,bt,1),Qn=bt-1;Qn>=0;Qn--){for(Ni=Y.get(Qn,Qn)-Je,qn=0,_r=La;_r<=bt;_r++)qn=qn+Y.get(Qn,_r)*Y.get(_r,bt);if(kt[Qn]<0)qr=Ni,Ln=qn;else if(La=Qn,kt[Qn]===0?Y.set(Qn,bt,Ni!==0?-qn/Ni:-qn/(Ht*on)):(vi=Y.get(Qn,Qn+1),si=Y.get(Qn+1,Qn),Ve=(at[Qn]-Je)*(at[Qn]-Je)+kt[Qn]*kt[Qn],_i=(vi*Ln-qr*qn)/Ve,Y.set(Qn,bt,_i),Y.set(Qn+1,bt,Math.abs(vi)>Math.abs(qr)?(-qn-Ni*_i)/vi:(-Ln-si*_i)/qr)),_i=Math.abs(Y.get(Qn,bt)),Ht*_i*_i>1)for(_r=Qn;_r<=bt;_r++)Y.set(_r,bt,Y.get(_r,bt)/_i)}else if(Ve<0)for(La=bt-1,Math.abs(Y.get(bt,bt-1))>Math.abs(Y.get(bt-1,bt))?(Y.set(bt-1,bt-1,Ve/Y.get(bt,bt-1)),Y.set(bt-1,bt,-(Y.get(bt,bt)-Je)/Y.get(bt,bt-1))):(Hn=vt(0,-Y.get(bt-1,bt),Y.get(bt-1,bt-1)-Je,Ve),Y.set(bt-1,bt-1,Hn[0]),Y.set(bt-1,bt,Hn[1])),Y.set(bt,bt-1,0),Y.set(bt,bt,1),Qn=bt-2;Qn>=0;Qn--){for(Mi=0,Pa=0,_r=La;_r<=bt;_r++)Mi=Mi+Y.get(Qn,_r)*Y.get(_r,bt-1),Pa=Pa+Y.get(Qn,_r)*Y.get(_r,bt);if(Ni=Y.get(Qn,Qn)-Je,kt[Qn]<0)qr=Ni,qn=Mi,Ln=Pa;else if(La=Qn,kt[Qn]===0?(Hn=vt(-Mi,-Pa,Ni,Ve),Y.set(Qn,bt-1,Hn[0]),Y.set(Qn,bt,Hn[1])):(vi=Y.get(Qn,Qn+1),si=Y.get(Qn+1,Qn),un=(at[Qn]-Je)*(at[Qn]-Je)+kt[Qn]*kt[Qn]-Ve*Ve,Oe=(at[Qn]-Je)*2*Ve,un===0&&Oe===0&&(un=Ht*on*(Math.abs(Ni)+Math.abs(Ve)+Math.abs(vi)+Math.abs(si)+Math.abs(qr))),Hn=vt(vi*qn-qr*Mi+Ve*Pa,vi*Ln-qr*Pa-Ve*Mi,un,Oe),Y.set(Qn,bt-1,Hn[0]),Y.set(Qn,bt,Hn[1]),Math.abs(vi)>Math.abs(qr)+Math.abs(Ve)?(Y.set(Qn+1,bt-1,(-Mi-Ni*Y.get(Qn,bt-1)+Ve*Y.get(Qn,bt))/vi),Y.set(Qn+1,bt,(-Pa-Ni*Y.get(Qn,bt)-Ve*Y.get(Qn,bt-1))/vi)):(Hn=vt(-qn-si*Y.get(Qn,bt-1),-Ln-si*Y.get(Qn,bt),qr,Ve),Y.set(Qn+1,bt-1,Hn[0]),Y.set(Qn+1,bt,Hn[1]))),_i=Math.max(Math.abs(Y.get(Qn,bt-1)),Math.abs(Y.get(Qn,bt))),Ht*_i*_i>1)for(_r=Qn;_r<=bt;_r++)Y.set(_r,bt-1,Y.get(_r,bt-1)/_i),Y.set(_r,bt,Y.get(_r,bt)/_i)}for(Qn=0;Qn<Lt;Qn++)if(Qn<$t||Qn>jt)for(_r=Qn;_r<Lt;_r++)H.set(Qn,_r,Y.get(Qn,_r));for(_r=Lt-1;_r>=$t;_r--)for(Qn=$t;Qn<=jt;Qn++){for(qr=0,ea=$t;ea<=Math.min(_r,jt);ea++)qr=qr+H.get(Qn,ea)*Y.get(ea,_r);H.set(Qn,_r,qr)}}}function vt(Lt,kt,at,H){var Y,bt;return Math.abs(at)>Math.abs(H)?(Y=H/at,bt=at+Y*H,[(Lt+Y*kt)/bt,(kt-Y*Lt)/bt]):(Y=at/H,bt=H+Y*at,[(Y*Lt+kt)/bt,(Y*kt-Lt)/bt])}var _n=function(){function Lt(kt){if((0,W.Z)(this,Lt),kt=fa.checkMatrix(kt),!kt.isSymmetric())throw new Error("Matrix is not symmetric");var at=kt,H=at.rows,Y=new ee(H,H),bt=!0,$t,jt,Ht;for(jt=0;jt<H;jt++){var re=0;for(Ht=0;Ht<jt;Ht++){var on=0;for($t=0;$t<Ht;$t++)on+=Y.get(Ht,$t)*Y.get(jt,$t);on=(at.get(jt,Ht)-on)/Y.get(Ht,Ht),Y.set(jt,Ht,on),re=re+on*on}for(re=at.get(jt,jt)-re,bt&=re>0,Y.set(jt,jt,Math.sqrt(Math.max(re,0))),Ht=jt+1;Ht<H;Ht++)Y.set(jt,Ht,0)}this.L=Y,this.positiveDefinite=Boolean(bt)}return(0,Q.Z)(Lt,[{key:"isPositiveDefinite",value:function(){return this.positiveDefinite}},{key:"solve",value:function(at){at=fa.checkMatrix(at);var H=this.L,Y=H.rows;if(at.rows!==Y)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");var bt=at.columns,$t=at.clone(),jt,Ht,re;for(re=0;re<Y;re++)for(Ht=0;Ht<bt;Ht++){for(jt=0;jt<re;jt++)$t.set(re,Ht,$t.get(re,Ht)-$t.get(jt,Ht)*H.get(re,jt));$t.set(re,Ht,$t.get(re,Ht)/H.get(re,re))}for(re=Y-1;re>=0;re--)for(Ht=0;Ht<bt;Ht++){for(jt=re+1;jt<Y;jt++)$t.set(re,Ht,$t.get(re,Ht)-$t.get(jt,Ht)*H.get(jt,re));$t.set(re,Ht,$t.get(re,Ht)/H.get(re,re))}return $t}},{key:"lowerTriangularMatrix",get:function(){return this.L}}]),Lt}(),an=(0,Q.Z)(function Lt(kt){var at=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,W.Z)(this,Lt),kt=fa.checkMatrix(kt);var H=at.Y,Y=at.scaleScores,bt=Y===void 0?!1:Y,$t=at.maxIterations,jt=$t===void 0?1e3:$t,Ht=at.terminationCriteria,re=Ht===void 0?1e-10:Ht,on;if(H){if(L(H)&&typeof H[0]=="number"?H=ee.columnVector(H):H=fa.checkMatrix(H),H.rows!==kt.rows)throw new Error("Y should have the same number of rows as X");on=H.getColumnVector(0)}else on=kt.getColumnVector(0);for(var Je=1,Ve,qn,Ln,qr,Ca=0;Ca<jt&&Je>re;Ca++)Ln=kt.transpose().mmul(on).div(on.transpose().mmul(on).get(0,0)),Ln=Ln.div(Ln.norm()),Ve=kt.mmul(Ln).div(Ln.transpose().mmul(Ln).get(0,0)),Ca>0&&(Je=Ve.clone().sub(qr).pow(2).sum()),qr=Ve.clone(),H?(qn=H.transpose().mmul(Ve).div(Ve.transpose().mmul(Ve).get(0,0)),qn=qn.div(qn.norm()),on=H.mmul(qn).div(qn.transpose().mmul(qn).get(0,0))):on=Ve;if(H){var Qn=kt.transpose().mmul(Ve).div(Ve.transpose().mmul(Ve).get(0,0));Qn=Qn.div(Qn.norm());var _r=kt.clone().sub(Ve.clone().mmul(Qn.transpose())),ea=on.transpose().mmul(Ve).div(Ve.transpose().mmul(Ve).get(0,0)),La=H.clone().sub(Ve.clone().mulS(ea.get(0,0)).mmul(qn.transpose()));this.t=Ve,this.p=Qn.transpose(),this.w=Ln.transpose(),this.q=qn,this.u=on,this.s=Ve.transpose().mmul(Ve),this.xResidual=_r,this.yResidual=La,this.betas=ea}else this.w=Ln.transpose(),this.s=Ve.transpose().mmul(Ve).sqrt(),bt?this.t=Ve.clone().div(this.s.get(0,0)):this.t=Ve,this.xResidual=kt.sub(Ve.mmul(Ln.transpose()))})},27279:function(sr,it,$){"use strict";$.d(it,{Z:function(){return nn}});var X=$(22122),tt=$(96156),j=$(8812),W=$(94184),Q=$.n(W),Z=$(85061),L=$(6610),P=$(5991),C=$(10379),M=$(54070),k=$(90484),B=$(50344),R=$(67294),F=$(96774),K=$.n(F),O=$(81253),_=$(5461),ft=$(28481),mt=R.forwardRef(function(Ee,le){var Le,Ze=Ee.prefixCls,fe=Ee.forceRender,Re=Ee.className,He=Ee.style,pe=Ee.children,Ge=Ee.isActive,te=Ee.role,Me=R.useState(Ge||fe),We=(0,ft.Z)(Me,2),ee=We[0],Pt=We[1];return R.useEffect(function(){(fe||Ge)&&Pt(!0)},[fe,Ge]),ee?R.createElement("div",{ref:le,className:Q()("".concat(Ze,"-content"),(Le={},(0,tt.Z)(Le,"".concat(Ze,"-content-active"),Ge),(0,tt.Z)(Le,"".concat(Ze,"-content-inactive"),!Ge),Le),Re),style:He,role:te},R.createElement("div",{className:"".concat(Ze,"-content-box")},pe)):null});mt.displayName="PanelContent";var st=mt,ut=["className","id","style","prefixCls","headerClass","children","isActive","destroyInactivePanel","accordion","forceRender","openMotion","extra","collapsible"],dt=function(Ee){(0,C.Z)(Le,Ee);var le=(0,M.Z)(Le);function Le(){var Ze;(0,L.Z)(this,Le);for(var fe=arguments.length,Re=new Array(fe),He=0;He<fe;He++)Re[He]=arguments[He];return Ze=le.call.apply(le,[this].concat(Re)),Ze.onItemClick=function(){var pe=Ze.props,Ge=pe.onItemClick,te=pe.panelKey;typeof Ge=="function"&&Ge(te)},Ze.handleKeyPress=function(pe){(pe.key==="Enter"||pe.keyCode===13||pe.which===13)&&Ze.onItemClick()},Ze.renderIcon=function(){var pe=Ze.props,Ge=pe.showArrow,te=pe.expandIcon,Me=pe.prefixCls,We=pe.collapsible;if(!Ge)return null;var ee=typeof te=="function"?te(Ze.props):R.createElement("i",{className:"arrow"});return ee&&R.createElement("div",{className:"".concat(Me,"-expand-icon"),onClick:We==="header"||We==="icon"?Ze.onItemClick:null},ee)},Ze.renderTitle=function(){var pe=Ze.props,Ge=pe.header,te=pe.prefixCls,Me=pe.collapsible;return R.createElement("span",{className:"".concat(te,"-header-text"),onClick:Me==="header"?Ze.onItemClick:null},Ge)},Ze}return(0,P.Z)(Le,[{key:"shouldComponentUpdate",value:function(fe){return!K()(this.props,fe)}},{key:"render",value:function(){var fe,Re,He=this.props,pe=He.className,Ge=He.id,te=He.style,Me=He.prefixCls,We=He.headerClass,ee=He.children,Pt=He.isActive,yt=He.destroyInactivePanel,Ne=He.accordion,tn=He.forceRender,fn=He.openMotion,Rt=He.extra,Yn=He.collapsible,Un=(0,O.Z)(He,ut),xr=Yn==="disabled",cr=Yn==="header",Ur=Yn==="icon",fa=Q()((fe={},(0,tt.Z)(fe,"".concat(Me,"-item"),!0),(0,tt.Z)(fe,"".concat(Me,"-item-active"),Pt),(0,tt.Z)(fe,"".concat(Me,"-item-disabled"),xr),fe),pe),Sa=Q()("".concat(Me,"-header"),(Re={},(0,tt.Z)(Re,We,We),(0,tt.Z)(Re,"".concat(Me,"-header-collapsible-only"),cr),(0,tt.Z)(Re,"".concat(Me,"-icon-collapsible-only"),Ur),Re)),sa={className:Sa,"aria-expanded":Pt,"aria-disabled":xr,onKeyPress:this.handleKeyPress};!cr&&!Ur&&(sa.onClick=this.onItemClick,sa.role=Ne?"tab":"button",sa.tabIndex=xr?-1:0);var Da=Rt!=null&&typeof Rt!="boolean";return delete Un.header,delete Un.panelKey,delete Un.onItemClick,delete Un.showArrow,delete Un.expandIcon,R.createElement("div",(0,X.Z)({},Un,{className:fa,style:te,id:Ge}),R.createElement("div",sa,this.renderIcon(),this.renderTitle(),Da&&R.createElement("div",{className:"".concat(Me,"-extra")},Rt)),R.createElement(_.default,(0,X.Z)({visible:Pt,leavedClassName:"".concat(Me,"-content-hidden")},fn,{forceRender:tn,removeOnLeave:yt}),function(Rr,Mn){var ar=Rr.className,Fn=Rr.style;return R.createElement(st,{ref:Mn,prefixCls:Me,className:ar,style:Fn,isActive:Pt,forceRender:tn,role:Ne?"tabpanel":null},ee)}))}}]),Le}(R.Component);dt.defaultProps={showArrow:!0,isActive:!1,onItemClick:function(){},headerClass:"",forceRender:!1};var gt=dt;function wt(Ee){var le=Ee;if(!Array.isArray(le)){var Le=(0,k.Z)(le);le=Le==="number"||Le==="string"?[le]:[]}return le.map(function(Ze){return String(Ze)})}var ot=function(Ee){(0,C.Z)(Le,Ee);var le=(0,M.Z)(Le);function Le(Ze){var fe;(0,L.Z)(this,Le),fe=le.call(this,Ze),fe.onClickItem=function(Ge){var te=fe.state.activeKey;if(fe.props.accordion)te=te[0]===Ge?[]:[Ge];else{te=(0,Z.Z)(te);var Me=te.indexOf(Ge),We=Me>-1;We?te.splice(Me,1):te.push(Ge)}fe.setActiveKey(te)},fe.getNewChild=function(Ge,te){if(!Ge)return null;var Me=fe.state.activeKey,We=fe.props,ee=We.prefixCls,Pt=We.openMotion,yt=We.accordion,Ne=We.destroyInactivePanel,tn=We.expandIcon,fn=We.collapsible,Rt=Ge.key||String(te),Yn=Ge.props,Un=Yn.header,xr=Yn.headerClass,cr=Yn.destroyInactivePanel,Ur=Yn.collapsible,fa=!1;yt?fa=Me[0]===Rt:fa=Me.indexOf(Rt)>-1;var Sa=Ur!=null?Ur:fn,sa={key:Rt,panelKey:Rt,header:Un,headerClass:xr,isActive:fa,prefixCls:ee,destroyInactivePanel:cr!=null?cr:Ne,openMotion:Pt,accordion:yt,children:Ge.props.children,onItemClick:Sa==="disabled"?null:fe.onClickItem,expandIcon:tn,collapsible:Sa};return typeof Ge.type=="string"?Ge:(Object.keys(sa).forEach(function(Da){typeof sa[Da]=="undefined"&&delete sa[Da]}),R.cloneElement(Ge,sa))},fe.getItems=function(){var Ge=fe.props.children;return(0,B.Z)(Ge).map(fe.getNewChild)},fe.setActiveKey=function(Ge){"activeKey"in fe.props||fe.setState({activeKey:Ge}),fe.props.onChange(fe.props.accordion?Ge[0]:Ge)};var Re=Ze.activeKey,He=Ze.defaultActiveKey,pe=He;return"activeKey"in Ze&&(pe=Re),fe.state={activeKey:wt(pe)},fe}return(0,P.Z)(Le,[{key:"shouldComponentUpdate",value:function(fe,Re){return!K()(this.props,fe)||!K()(this.state,Re)}},{key:"render",value:function(){var fe,Re=this.props,He=Re.prefixCls,pe=Re.className,Ge=Re.style,te=Re.accordion,Me=Q()((fe={},(0,tt.Z)(fe,He,!0),(0,tt.Z)(fe,pe,!!pe),fe));return R.createElement("div",{className:Me,style:Ge,role:te?"tablist":null},this.getItems())}}],[{key:"getDerivedStateFromProps",value:function(fe){var Re={};return"activeKey"in fe&&(Re.activeKey=wt(fe.activeKey)),Re}}]),Le}(R.Component);ot.defaultProps={prefixCls:"rc-collapse",onChange:function(){},accordion:!1,destroyInactivePanel:!1},ot.Panel=gt;var pt=ot,Nt=pt,Gt=pt.Panel,se=$(98423),ie=$(53124),Be=$(33603),ke=$(96159),we=function(le){var Le=R.useContext(ie.E_),Ze=Le.getPrefixCls,fe=le.prefixCls,Re=le.className,He=Re===void 0?"":Re,pe=le.showArrow,Ge=pe===void 0?!0:pe,te=Ze("collapse",fe),Me=Q()((0,tt.Z)({},"".concat(te,"-no-arrow"),!Ge),He);return R.createElement(Nt.Panel,(0,X.Z)({},le,{prefixCls:te,className:Me}))},At=we,Yt=function(le){var Le,Ze=R.useContext(ie.E_),fe=Ze.getPrefixCls,Re=Ze.direction,He=le.prefixCls,pe=le.className,Ge=pe===void 0?"":pe,te=le.bordered,Me=te===void 0?!0:te,We=le.ghost,ee=le.expandIconPosition,Pt=ee===void 0?"start":ee,yt=fe("collapse",He),Ne=R.useMemo(function(){return Pt==="left"?"start":Pt==="right"?"end":Pt},[Pt]),tn=function(){var xr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},cr=le.expandIcon,Ur=cr?cr(xr):R.createElement(j.Z,{rotate:xr.isActive?90:void 0});return(0,ke.Tm)(Ur,function(){return{className:Q()(Ur.props.className,"".concat(yt,"-arrow"))}})},fn=Q()("".concat(yt,"-icon-position-").concat(Ne),(Le={},(0,tt.Z)(Le,"".concat(yt,"-borderless"),!Me),(0,tt.Z)(Le,"".concat(yt,"-rtl"),Re==="rtl"),(0,tt.Z)(Le,"".concat(yt,"-ghost"),!!We),Le),Ge),Rt=(0,X.Z)((0,X.Z)({},Be.ZP),{motionAppear:!1,leavedClassName:"".concat(yt,"-content-hidden")}),Yn=function(){var xr=le.children;return(0,B.Z)(xr).map(function(cr,Ur){var fa;if((fa=cr.props)===null||fa===void 0?void 0:fa.disabled){var Sa=cr.key||String(Ur),sa=cr.props,Da=sa.disabled,Rr=sa.collapsible,Mn=(0,X.Z)((0,X.Z)({},(0,se.Z)(cr.props,["disabled"])),{key:Sa,collapsible:Rr!=null?Rr:Da?"disabled":void 0});return(0,ke.Tm)(cr,Mn)}return cr})};return R.createElement(Nt,(0,X.Z)({openMotion:Rt},le,{expandIcon:tn,prefixCls:yt,className:fn}),Yn())};Yt.Panel=At;var be=Yt,nn=be},7359:function(sr,it,$){"use strict";var X=$(38663),tt=$.n(X),j=$(50596),W=$.n(j)},77933:function(sr,it,$){"use strict";$.d(it,{Z:function(){return Ge}});var X=$(96156),tt=$(85061),j=$(22122),W=$(6610),Q=$(5991),Z=$(10379),L=$(54070),P=$(94184),C=$.n(P),M=$(67294),k=$(53124),B=$(88258),R=$(65223),F=$(42051),K=$(85636),O=$(9708),_=$(57254),ft=$(98423),mt=$(9676),st=$(13013),ut=$(96159),dt=$(90484),gt=$(23492),wt=$(93355),ot=$(73171),pt=$(34952),Nt=function(Me){var We,ee=Me.renderedText,Pt=Me.renderedEl,yt=Me.item,Ne=Me.checked,tn=Me.disabled,fn=Me.prefixCls,Rt=Me.onClick,Yn=Me.onRemove,Un=Me.showRemove,xr=C()((We={},(0,X.Z)(We,"".concat(fn,"-content-item"),!0),(0,X.Z)(We,"".concat(fn,"-content-item-disabled"),tn||yt.disabled),(0,X.Z)(We,"".concat(fn,"-content-item-checked"),Ne),We)),cr;return(typeof ee=="string"||typeof ee=="number")&&(cr=String(ee)),M.createElement(F.Z,{componentName:"Transfer",defaultLocale:K.Z.Transfer},function(Ur){var fa={className:xr,title:cr},Sa=M.createElement("span",{className:"".concat(fn,"-content-item-text")},Pt);return Un?M.createElement("li",(0,j.Z)({},fa),Sa,M.createElement(pt.Z,{disabled:tn||yt.disabled,className:"".concat(fn,"-content-item-remove"),"aria-label":Ur.remove,onClick:function(){Yn==null||Yn(yt)}},M.createElement(ot.Z,null))):(fa.onClick=tn||yt.disabled?void 0:function(){return Rt(yt)},M.createElement("li",(0,j.Z)({},fa),M.createElement(mt.Z,{className:"".concat(fn,"-checkbox"),checked:Ne,disabled:tn||yt.disabled}),Sa))})},Gt=M.memo(Nt),se=(0,wt.b)("handleFilter","handleClear","checkedKeys");function ie(te){if(!te)return null;var Me={pageSize:10,simple:!0,showSizeChanger:!1,showLessItems:!1};return(0,dt.Z)(te)==="object"?(0,j.Z)((0,j.Z)({},Me),te):Me}var Be=function(te){(0,Z.Z)(We,te);var Me=(0,L.Z)(We);function We(){var ee;return(0,W.Z)(this,We),ee=Me.apply(this,arguments),ee.state={current:1},ee.onItemSelect=function(Pt){var yt=ee.props,Ne=yt.onItemSelect,tn=yt.selectedKeys,fn=tn.includes(Pt.key);Ne(Pt.key,!fn)},ee.onItemRemove=function(Pt){var yt=ee.props.onItemRemove;yt==null||yt([Pt.key])},ee.onPageChange=function(Pt){ee.setState({current:Pt})},ee.getItems=function(){var Pt=ee.state.current,yt=ee.props,Ne=yt.pagination,tn=yt.filteredRenderItems,fn=ie(Ne),Rt=tn;return fn&&(Rt=tn.slice((Pt-1)*fn.pageSize,Pt*fn.pageSize)),Rt},ee}return(0,Q.Z)(We,[{key:"render",value:function(){var Pt=this,yt=this.state.current,Ne=this.props,tn=Ne.prefixCls,fn=Ne.onScroll,Rt=Ne.filteredRenderItems,Yn=Ne.selectedKeys,Un=Ne.disabled,xr=Ne.showRemove,cr=Ne.pagination,Ur=ie(cr),fa=null;return Ur&&(fa=M.createElement(gt.Z,{simple:Ur.simple,showSizeChanger:Ur.showSizeChanger,showLessItems:Ur.showLessItems,size:"small",disabled:Un,className:"".concat(tn,"-pagination"),total:Rt.length,pageSize:Ur.pageSize,current:yt,onChange:this.onPageChange})),M.createElement(M.Fragment,null,M.createElement("ul",{className:C()("".concat(tn,"-content"),(0,X.Z)({},"".concat(tn,"-content-show-remove"),xr)),onScroll:fn},this.getItems().map(function(Sa){var sa=Sa.renderedEl,Da=Sa.renderedText,Rr=Sa.item,Mn=Rr.disabled,ar=Yn.includes(Rr.key);return M.createElement(Gt,{disabled:Un||Mn,key:Rr.key,item:Rr,renderedText:Da,renderedEl:sa,checked:ar,prefixCls:tn,onClick:Pt.onItemSelect,onRemove:Pt.onItemRemove,showRemove:xr})})),fa)}}],[{key:"getDerivedStateFromProps",value:function(Pt,yt){var Ne=Pt.filteredRenderItems,tn=Pt.pagination,fn=yt.current,Rt=ie(tn);if(Rt){var Yn=Math.ceil(Ne.length/Rt.pageSize);if(fn>Yn)return{current:Yn}}return null}}]),We}(M.Component),ke=Be,we=$(76570),At=$(4107);function Yt(te){var Me=te.placeholder,We=Me===void 0?"":Me,ee=te.value,Pt=te.prefixCls,yt=te.disabled,Ne=te.onChange,tn=te.handleClear,fn=M.useCallback(function(Rt){Ne==null||Ne(Rt),Rt.target.value===""&&(tn==null||tn())},[Ne]);return M.createElement(At.Z,{placeholder:We,className:Pt,value:ee,onChange:fn,disabled:yt,allowClear:!0,prefix:M.createElement(we.Z,null)})}var be=function(){return null};function nn(te){return!!(te&&!(0,ut.l$)(te)&&Object.prototype.toString.call(te)==="[object Object]")}function Ee(te){return te.filter(function(Me){return!Me.disabled}).map(function(Me){return Me.key})}var le=function(te){(0,Z.Z)(We,te);var Me=(0,L.Z)(We);function We(ee){var Pt;return(0,W.Z)(this,We),Pt=Me.call(this,ee),Pt.defaultListBodyRef=M.createRef(),Pt.handleFilter=function(yt){var Ne=Pt.props.handleFilter,tn=yt.target.value;Pt.setState({filterValue:tn}),Ne(yt)},Pt.handleClear=function(){var yt=Pt.props.handleClear;Pt.setState({filterValue:""}),yt()},Pt.matchFilter=function(yt,Ne){var tn=Pt.state.filterValue,fn=Pt.props.filterOption;return fn?fn(tn,Ne):yt.includes(tn)},Pt.renderListBody=function(yt,Ne){var tn=yt?yt(Ne):null,fn=!!tn;return fn||(tn=M.createElement(ke,(0,j.Z)({ref:Pt.defaultListBodyRef},Ne))),{customize:fn,bodyContent:tn}},Pt.renderItem=function(yt){var Ne=Pt.props.render,tn=Ne===void 0?be:Ne,fn=tn(yt),Rt=nn(fn);return{renderedText:Rt?fn.value:fn,renderedEl:Rt?fn.label:fn,item:yt}},Pt.getSelectAllLabel=function(yt,Ne){var tn=Pt.props,fn=tn.itemsUnit,Rt=tn.itemUnit,Yn=tn.selectAllLabel;if(Yn)return typeof Yn=="function"?Yn({selectedCount:yt,totalCount:Ne}):Yn;var Un=Ne>1?fn:Rt;return M.createElement(M.Fragment,null,(yt>0?"".concat(yt,"/"):"")+Ne," ",Un)},Pt.state={filterValue:""},Pt}return(0,Q.Z)(We,[{key:"componentWillUnmount",value:function(){clearTimeout(this.triggerScrollTimer)}},{key:"getCheckStatus",value:function(Pt){var yt=this.props.checkedKeys;return yt.length===0?"none":Pt.every(function(Ne){return yt.includes(Ne.key)||!!Ne.disabled})?"all":"part"}},{key:"getFilteredItems",value:function(Pt,yt){var Ne=this,tn=[],fn=[];return Pt.forEach(function(Rt){var Yn=Ne.renderItem(Rt),Un=Yn.renderedText;if(yt&&!Ne.matchFilter(Un,Rt))return null;tn.push(Rt),fn.push(Yn)}),{filteredItems:tn,filteredRenderItems:fn}}},{key:"getListBody",value:function(Pt,yt,Ne,tn,fn,Rt,Yn,Un,xr,cr){var Ur=this,fa=xr?M.createElement("div",{className:"".concat(Pt,"-body-search-wrapper")},M.createElement(Yt,{prefixCls:"".concat(Pt,"-search"),onChange:this.handleFilter,handleClear:this.handleClear,placeholder:yt,value:Ne,disabled:cr})):null,Sa=this.renderListBody(Un,(0,j.Z)((0,j.Z)({},(0,ft.Z)(this.props,se)),{filteredItems:tn,filteredRenderItems:Rt,selectedKeys:Yn})),sa=Sa.bodyContent,Da=Sa.customize,Rr=function(){var Fn=Ur.props.direction==="left"?0:1;return Array.isArray(fn)?fn[Fn]:fn},Mn;return Da?Mn=M.createElement("div",{className:"".concat(Pt,"-body-customize-wrapper")},sa):Mn=tn.length?sa:M.createElement("div",{className:"".concat(Pt,"-body-not-found")},Rr()),M.createElement("div",{className:C()(xr?"".concat(Pt,"-body ").concat(Pt,"-body-with-search"):"".concat(Pt,"-body"))},fa,Mn)}},{key:"getCheckBox",value:function(Pt){var yt=Pt.filteredItems,Ne=Pt.onItemSelectAll,tn=Pt.disabled,fn=Pt.prefixCls,Rt=this.getCheckStatus(yt),Yn=Rt==="all",Un=M.createElement(mt.Z,{disabled:tn,checked:Yn,indeterminate:Rt==="part",className:"".concat(fn,"-checkbox"),onChange:function(){Ne(yt.filter(function(cr){return!cr.disabled}).map(function(cr){var Ur=cr.key;return Ur}),!Yn)}});return Un}},{key:"render",value:function(){var Pt,yt=this,Ne=this.state.filterValue,tn=this.props,fn=tn.prefixCls,Rt=tn.dataSource,Yn=Rt===void 0?[]:Rt,Un=tn.titleText,xr=Un===void 0?"":Un,cr=tn.checkedKeys,Ur=tn.disabled,fa=tn.footer,Sa=tn.showSearch,sa=Sa===void 0?!1:Sa,Da=tn.style,Rr=tn.searchPlaceholder,Mn=tn.notFoundContent,ar=tn.selectAll,Fn=tn.selectCurrent,tr=tn.selectInvert,Gn=tn.removeAll,jr=tn.removeCurrent,Hr=tn.renderList,Ea=tn.onItemSelectAll,lr=tn.onItemRemove,Cr=tn.showSelectAll,vr=Cr===void 0?!0:Cr,Tr=tn.showRemove,ta=tn.pagination,ra=tn.direction,Zr=fa&&(fa.length<2?fa(this.props):fa(this.props,{direction:ra})),vt=C()(fn,(Pt={},(0,X.Z)(Pt,"".concat(fn,"-with-pagination"),!!ta),(0,X.Z)(Pt,"".concat(fn,"-with-footer"),!!Zr),Pt)),_n=this.getFilteredItems(Yn,Ne),an=_n.filteredItems,Lt=_n.filteredRenderItems,kt=this.getListBody(fn,Rr,Ne,an,Mn,Lt,cr,Hr,sa,Ur),at=Zr?M.createElement("div",{className:"".concat(fn,"-footer")},Zr):null,H=!Tr&&!ta&&this.getCheckBox({filteredItems:an,onItemSelectAll:Ea,disabled:Ur,prefixCls:fn}),Y;Tr?Y=[ta?{key:"removeCurrent",onClick:function(){var jt,Ht=Ee((((jt=yt.defaultListBodyRef.current)===null||jt===void 0?void 0:jt.getItems())||[]).map(function(re){return re.item}));lr==null||lr(Ht)},label:jr}:null,{key:"removeAll",onClick:function(){lr==null||lr(Ee(an))},label:Gn}].filter(function($t){return $t}):Y=[{key:"selectAll",onClick:function(){var jt=Ee(an);Ea(jt,jt.length!==cr.length)},label:ar},ta?{key:"selectCurrent",onClick:function(){var jt,Ht=((jt=yt.defaultListBodyRef.current)===null||jt===void 0?void 0:jt.getItems())||[];Ea(Ee(Ht.map(function(re){return re.item})),!0)},label:Fn}:null,{key:"selectInvert",onClick:function(){var jt,Ht;ta?Ht=Ee((((jt=yt.defaultListBodyRef.current)===null||jt===void 0?void 0:jt.getItems())||[]).map(function(Ve){return Ve.item})):Ht=Ee(an);var re=new Set(cr),on=[],Je=[];Ht.forEach(function(Ve){re.has(Ve)?Je.push(Ve):on.push(Ve)}),Ea(on,!0),Ea(Je,!1)},label:tr}];var bt=M.createElement(st.Z,{className:"".concat(fn,"-header-dropdown"),menu:{items:Y},disabled:Ur},M.createElement(_.Z,null));return M.createElement("div",{className:vt,style:Da},M.createElement("div",{className:"".concat(fn,"-header")},vr?M.createElement(M.Fragment,null,H,bt):null,M.createElement("span",{className:"".concat(fn,"-header-selected")},this.getSelectAllLabel(cr.length,an.length)),M.createElement("span",{className:"".concat(fn,"-header-title")},xr)),kt,at)}}]),We}(M.PureComponent),Le=$(67724),Ze=$(8812),fe=$(71577),Re=function(Me){var We=Me.disabled,ee=Me.moveToLeft,Pt=Me.moveToRight,yt=Me.leftArrowText,Ne=yt===void 0?"":yt,tn=Me.rightArrowText,fn=tn===void 0?"":tn,Rt=Me.leftActive,Yn=Me.rightActive,Un=Me.className,xr=Me.style,cr=Me.direction,Ur=Me.oneWay;return M.createElement("div",{className:Un,style:xr},M.createElement(fe.Z,{type:"primary",size:"small",disabled:We||!Yn,onClick:Pt,icon:cr!=="rtl"?M.createElement(Ze.Z,null):M.createElement(Le.Z,null)},fn),!Ur&&M.createElement(fe.Z,{type:"primary",size:"small",disabled:We||!Rt,onClick:ee,icon:cr!=="rtl"?M.createElement(Le.Z,null):M.createElement(Ze.Z,null)},Ne))},He=Re,pe=function(te){(0,Z.Z)(We,te);var Me=(0,L.Z)(We);function We(ee){var Pt;(0,W.Z)(this,We),Pt=Me.call(this,ee),Pt.separatedDataSource=null,Pt.setStateKeys=function(Rt,Yn){Rt==="left"?Pt.setState(function(Un){var xr=Un.sourceSelectedKeys;return{sourceSelectedKeys:typeof Yn=="function"?Yn(xr||[]):Yn}}):Pt.setState(function(Un){var xr=Un.targetSelectedKeys;return{targetSelectedKeys:typeof Yn=="function"?Yn(xr||[]):Yn}})},Pt.getLocale=function(Rt,Yn){var Un=Pt.props.locale,xr=Un===void 0?{}:Un;return(0,j.Z)((0,j.Z)((0,j.Z)({},Rt),{notFoundContent:Yn("Transfer")}),xr)},Pt.moveTo=function(Rt){var Yn=Pt.props,Un=Yn.targetKeys,xr=Un===void 0?[]:Un,cr=Yn.dataSource,Ur=cr===void 0?[]:cr,fa=Yn.onChange,Sa=Pt.state,sa=Sa.sourceSelectedKeys,Da=Sa.targetSelectedKeys,Rr=Rt==="right"?sa:Da,Mn=Rr.filter(function(tr){return!Ur.some(function(Gn){return!!(tr===Gn.key&&Gn.disabled)})}),ar=Rt==="right"?Mn.concat(xr):xr.filter(function(tr){return!Mn.includes(tr)}),Fn=Rt==="right"?"left":"right";Pt.setStateKeys(Fn,[]),Pt.handleSelectChange(Fn,[]),fa==null||fa(ar,Rt,Mn)},Pt.moveToLeft=function(){return Pt.moveTo("left")},Pt.moveToRight=function(){return Pt.moveTo("right")},Pt.onItemSelectAll=function(Rt,Yn,Un){Pt.setStateKeys(Rt,function(xr){var cr=[];return Un?cr=Array.from(new Set([].concat((0,tt.Z)(xr),(0,tt.Z)(Yn)))):cr=xr.filter(function(Ur){return!Yn.includes(Ur)}),Pt.handleSelectChange(Rt,cr),cr})},Pt.onLeftItemSelectAll=function(Rt,Yn){return Pt.onItemSelectAll("left",Rt,Yn)},Pt.onRightItemSelectAll=function(Rt,Yn){return Pt.onItemSelectAll("right",Rt,Yn)},Pt.handleFilter=function(Rt,Yn){var Un=Pt.props.onSearch,xr=Yn.target.value;Un==null||Un(Rt,xr)},Pt.handleLeftFilter=function(Rt){return Pt.handleFilter("left",Rt)},Pt.handleRightFilter=function(Rt){return Pt.handleFilter("right",Rt)},Pt.handleClear=function(Rt){var Yn=Pt.props.onSearch;Yn==null||Yn(Rt,"")},Pt.handleLeftClear=function(){return Pt.handleClear("left")},Pt.handleRightClear=function(){return Pt.handleClear("right")},Pt.onItemSelect=function(Rt,Yn,Un){var xr=Pt.state,cr=xr.sourceSelectedKeys,Ur=xr.targetSelectedKeys,fa=Rt==="left"?(0,tt.Z)(cr):(0,tt.Z)(Ur),Sa=fa.indexOf(Yn);Sa>-1&&fa.splice(Sa,1),Un&&fa.push(Yn),Pt.handleSelectChange(Rt,fa),Pt.props.selectedKeys||Pt.setStateKeys(Rt,fa)},Pt.onLeftItemSelect=function(Rt,Yn){return Pt.onItemSelect("left",Rt,Yn)},Pt.onRightItemSelect=function(Rt,Yn){return Pt.onItemSelect("right",Rt,Yn)},Pt.onRightItemRemove=function(Rt){var Yn=Pt.props,Un=Yn.targetKeys,xr=Un===void 0?[]:Un,cr=Yn.onChange;Pt.setStateKeys("right",[]),cr==null||cr(xr.filter(function(Ur){return!Rt.includes(Ur)}),"left",(0,tt.Z)(Rt))},Pt.handleScroll=function(Rt,Yn){var Un=Pt.props.onScroll;Un==null||Un(Rt,Yn)},Pt.handleLeftScroll=function(Rt){return Pt.handleScroll("left",Rt)},Pt.handleRightScroll=function(Rt){return Pt.handleScroll("right",Rt)},Pt.handleListStyle=function(Rt,Yn){return typeof Rt=="function"?Rt({direction:Yn}):Rt};var yt=ee.selectedKeys,Ne=yt===void 0?[]:yt,tn=ee.targetKeys,fn=tn===void 0?[]:tn;return Pt.state={sourceSelectedKeys:Ne.filter(function(Rt){return!fn.includes(Rt)}),targetSelectedKeys:Ne.filter(function(Rt){return fn.includes(Rt)})},Pt}return(0,Q.Z)(We,[{key:"getTitles",value:function(Pt){var yt,Ne;return(Ne=(yt=this.props.titles)!==null&&yt!==void 0?yt:Pt.titles)!==null&&Ne!==void 0?Ne:[]}},{key:"handleSelectChange",value:function(Pt,yt){var Ne=this.state,tn=Ne.sourceSelectedKeys,fn=Ne.targetSelectedKeys,Rt=this.props.onSelectChange;!Rt||(Pt==="left"?Rt(yt,fn):Rt(tn,yt))}},{key:"separateDataSource",value:function(){var Pt=this.props,yt=Pt.dataSource,Ne=yt===void 0?[]:yt,tn=Pt.rowKey,fn=Pt.targetKeys,Rt=fn===void 0?[]:fn,Yn=[],Un=new Array(Rt.length);return Ne.forEach(function(xr){tn&&(xr=(0,j.Z)((0,j.Z)({},xr),{key:tn(xr)}));var cr=Rt.indexOf(xr.key);cr!==-1?Un[cr]=xr:Yn.push(xr)}),{leftDataSource:Yn,rightDataSource:Un}}},{key:"render",value:function(){var Pt=this;return M.createElement(F.Z,{componentName:"Transfer",defaultLocale:K.Z.Transfer},function(yt){return M.createElement(k.C,null,function(Ne){var tn=Ne.getPrefixCls,fn=Ne.renderEmpty,Rt=Ne.direction;return M.createElement(R.aM.Consumer,null,function(Yn){var Un,xr=Yn.hasFeedback,cr=Yn.status,Ur=Pt.props,fa=Ur.prefixCls,Sa=Ur.className,sa=Ur.disabled,Da=Ur.operations,Rr=Da===void 0?[]:Da,Mn=Ur.showSearch,ar=Mn===void 0?!1:Mn,Fn=Ur.footer,tr=Ur.style,Gn=Ur.listStyle,jr=Gn===void 0?{}:Gn,Hr=Ur.operationStyle,Ea=Ur.filterOption,lr=Ur.render,Cr=Ur.children,vr=Ur.showSelectAll,Tr=Ur.oneWay,ta=Ur.pagination,ra=Ur.status,Zr=tn("transfer",fa),vt=Pt.getLocale(yt,fn||B.Z),_n=Pt.state,an=_n.sourceSelectedKeys,Lt=_n.targetSelectedKeys,kt=(0,O.F)(cr,ra),at=!Cr&&ta,H=Pt.separateDataSource(),Y=H.leftDataSource,bt=H.rightDataSource,$t=Lt.length>0,jt=an.length>0,Ht=C()(Zr,(Un={},(0,X.Z)(Un,"".concat(Zr,"-disabled"),sa),(0,X.Z)(Un,"".concat(Zr,"-customize-list"),!!Cr),(0,X.Z)(Un,"".concat(Zr,"-rtl"),Rt==="rtl"),Un),(0,O.Z)(Zr,kt,xr),Sa),re=Pt.getTitles(vt),on=Pt.props.selectAllLabels||[];return M.createElement("div",{className:Ht,style:tr},M.createElement(le,(0,j.Z)({prefixCls:"".concat(Zr,"-list"),titleText:re==null?void 0:re[0],dataSource:Y,filterOption:Ea,style:Pt.handleListStyle(jr,"left"),checkedKeys:an,handleFilter:Pt.handleLeftFilter,handleClear:Pt.handleLeftClear,onItemSelect:Pt.onLeftItemSelect,onItemSelectAll:Pt.onLeftItemSelectAll,render:lr,showSearch:ar,renderList:Cr,footer:Fn,onScroll:Pt.handleLeftScroll,disabled:sa,direction:Rt==="rtl"?"right":"left",showSelectAll:vr,selectAllLabel:on[0],pagination:at},vt)),M.createElement(He,{className:"".concat(Zr,"-operation"),rightActive:jt,rightArrowText:Rr[0],moveToRight:Pt.moveToRight,leftActive:$t,leftArrowText:Rr[1],moveToLeft:Pt.moveToLeft,style:Hr,disabled:sa,direction:Rt,oneWay:Tr}),M.createElement(le,(0,j.Z)({prefixCls:"".concat(Zr,"-list"),titleText:re==null?void 0:re[1],dataSource:bt,filterOption:Ea,style:Pt.handleListStyle(jr,"right"),checkedKeys:Lt,handleFilter:Pt.handleRightFilter,handleClear:Pt.handleRightClear,onItemSelect:Pt.onRightItemSelect,onItemSelectAll:Pt.onRightItemSelectAll,onItemRemove:Pt.onRightItemRemove,render:lr,showSearch:ar,renderList:Cr,footer:Fn,onScroll:Pt.handleRightScroll,disabled:sa,direction:Rt==="rtl"?"left":"right",showSelectAll:vr,selectAllLabel:on[1],showRemove:Tr,pagination:at},vt)))})})})}}],[{key:"getDerivedStateFromProps",value:function(Pt){var yt=Pt.selectedKeys,Ne=Pt.targetKeys,tn=Pt.pagination,fn=Pt.children;if(yt){var Rt=Ne||[];return{sourceSelectedKeys:yt.filter(function(Yn){return!Rt.includes(Yn)}),targetSelectedKeys:yt.filter(function(Yn){return Rt.includes(Yn)})}}return null}}]),We}(M.Component);pe.List=le,pe.Operation=He,pe.Search=Yt;var Ge=pe},58996:function(sr,it,$){"use strict";var X=$(38663),tt=$.n(X),j=$(66247),W=$.n(j),Q=$(57663),Z=$(63185),L=$(59250),P=$(13254),C=$(47673),M=$(14781)},11324:function(sr,it,$){"use strict";$.d(it,{Z:function(){return bt}});var X=$(22122),tt=$(67294),j=$(96156),W=$(55507),Q=$(90484),Z=$(85061),L=$(28481),P=$(94184),C=$.n(P),M=$(6610),k=$(5991),B=$(10379),R=$(54070),F=$(81253),K=$(92137),O=$(64217);function _($t,jt){var Ht="cannot ".concat($t.method," ").concat($t.action," ").concat(jt.status,"'"),re=new Error(Ht);return re.status=jt.status,re.method=$t.method,re.url=$t.action,re}function ft($t){var jt=$t.responseText||$t.response;if(!jt)return jt;try{return JSON.parse(jt)}catch(Ht){return jt}}function mt($t){var jt=new XMLHttpRequest;$t.onProgress&&jt.upload&&(jt.upload.onprogress=function(Je){Je.total>0&&(Je.percent=Je.loaded/Je.total*100),$t.onProgress(Je)});var Ht=new FormData;$t.data&&Object.keys($t.data).forEach(function(on){var Je=$t.data[on];if(Array.isArray(Je)){Je.forEach(function(Ve){Ht.append("".concat(on,"[]"),Ve)});return}Ht.append(on,Je)}),$t.file instanceof Blob?Ht.append($t.filename,$t.file,$t.file.name):Ht.append($t.filename,$t.file),jt.onerror=function(Je){$t.onError(Je)},jt.onload=function(){return jt.status<200||jt.status>=300?$t.onError(_($t,jt),ft(jt)):$t.onSuccess(ft(jt),jt)},jt.open($t.method,$t.action,!0),$t.withCredentials&&"withCredentials"in jt&&(jt.withCredentials=!0);var re=$t.headers||{};return re["X-Requested-With"]!==null&&jt.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(re).forEach(function(on){re[on]!==null&&jt.setRequestHeader(on,re[on])}),jt.send(Ht),{abort:function(){jt.abort()}}}var st=+new Date,ut=0;function dt(){return"rc-upload-".concat(st,"-").concat(++ut)}var gt=$(80334),wt=function($t,jt){if($t&&jt){var Ht=Array.isArray(jt)?jt:jt.split(","),re=$t.name||"",on=$t.type||"",Je=on.replace(/\/.*$/,"");return Ht.some(function(Ve){var qn=Ve.trim();if(/^\*(\/\*)?$/.test(Ve))return!0;if(qn.charAt(0)==="."){var Ln=re.toLowerCase(),qr=qn.toLowerCase(),Ca=[qr];return(qr===".jpg"||qr===".jpeg")&&(Ca=[".jpg",".jpeg"]),Ca.some(function(Qn){return Ln.endsWith(Qn)})}return/\/\*$/.test(qn)?Je===qn.replace(/\/.*$/,""):on===qn?!0:/^\w+$/.test(qn)?((0,gt.ZP)(!1,"Upload takes an invalidate 'accept' type '".concat(qn,"'.Skip for check.")),!0):!1})}return!0};function ot($t,jt){var Ht=$t.createReader(),re=[];function on(){Ht.readEntries(function(Je){var Ve=Array.prototype.slice.apply(Je);re=re.concat(Ve);var qn=!Ve.length;qn?jt(re):on()})}on()}var pt=function(jt,Ht,re){var on=function Je(Ve,qn){Ve.path=qn||"",Ve.isFile?Ve.file(function(Ln){re(Ln)&&(Ve.fullPath&&!Ln.webkitRelativePath&&(Object.defineProperties(Ln,{webkitRelativePath:{writable:!0}}),Ln.webkitRelativePath=Ve.fullPath.replace(/^\//,""),Object.defineProperties(Ln,{webkitRelativePath:{writable:!1}})),Ht([Ln]))}):Ve.isDirectory&&ot(Ve,function(Ln){Ln.forEach(function(qr){Je(qr,"".concat(qn).concat(Ve.name,"/"))})})};jt.forEach(function(Je){on(Je.webkitGetAsEntry())})},Nt=pt,Gt=["component","prefixCls","className","disabled","id","style","multiple","accept","capture","children","directory","openFileDialogOnClick","onMouseEnter","onMouseLeave"],se=function($t){(0,B.Z)(Ht,$t);var jt=(0,R.Z)(Ht);function Ht(){var re;(0,M.Z)(this,Ht);for(var on=arguments.length,Je=new Array(on),Ve=0;Ve<on;Ve++)Je[Ve]=arguments[Ve];return re=jt.call.apply(jt,[this].concat(Je)),re.state={uid:dt()},re.reqs={},re.fileInput=void 0,re._isMounted=void 0,re.onChange=function(qn){var Ln=re.props,qr=Ln.accept,Ca=Ln.directory,Qn=qn.target.files,_r=(0,Z.Z)(Qn).filter(function(ea){return!Ca||wt(ea,qr)});re.uploadFiles(_r),re.reset()},re.onClick=function(qn){var Ln=re.fileInput;if(!!Ln){var qr=re.props,Ca=qr.children,Qn=qr.onClick;if(Ca&&Ca.type==="button"){var _r=Ln.parentNode;_r.focus(),_r.querySelector("button").blur()}Ln.click(),Qn&&Qn(qn)}},re.onKeyDown=function(qn){qn.key==="Enter"&&re.onClick(qn)},re.onFileDrop=function(qn){var Ln=re.props.multiple;if(qn.preventDefault(),qn.type!=="dragover")if(re.props.directory)Nt(Array.prototype.slice.call(qn.dataTransfer.items),re.uploadFiles,function(Ca){return wt(Ca,re.props.accept)});else{var qr=(0,Z.Z)(qn.dataTransfer.files).filter(function(Ca){return wt(Ca,re.props.accept)});Ln===!1&&(qr=qr.slice(0,1)),re.uploadFiles(qr)}},re.uploadFiles=function(qn){var Ln=(0,Z.Z)(qn),qr=Ln.map(function(Ca){return Ca.uid=dt(),re.processFile(Ca,Ln)});Promise.all(qr).then(function(Ca){var Qn=re.props.onBatchStart;Qn==null||Qn(Ca.map(function(_r){var ea=_r.origin,La=_r.parsedFile;return{file:ea,parsedFile:La}})),Ca.filter(function(_r){return _r.parsedFile!==null}).forEach(function(_r){re.post(_r)})})},re.processFile=function(){var qn=(0,K.Z)((0,W.Z)().mark(function Ln(qr,Ca){var Qn,_r,ea,La,ha,_i,Ni,vi,si;return(0,W.Z)().wrap(function(Pa){for(;;)switch(Pa.prev=Pa.next){case 0:if(Qn=re.props.beforeUpload,_r=qr,!Qn){Pa.next=14;break}return Pa.prev=3,Pa.next=6,Qn(qr,Ca);case 6:_r=Pa.sent,Pa.next=12;break;case 9:Pa.prev=9,Pa.t0=Pa.catch(3),_r=!1;case 12:if(_r!==!1){Pa.next=14;break}return Pa.abrupt("return",{origin:qr,parsedFile:null,action:null,data:null});case 14:if(ea=re.props.action,typeof ea!="function"){Pa.next=21;break}return Pa.next=18,ea(qr);case 18:La=Pa.sent,Pa.next=22;break;case 21:La=ea;case 22:if(ha=re.props.data,typeof ha!="function"){Pa.next=29;break}return Pa.next=26,ha(qr);case 26:_i=Pa.sent,Pa.next=30;break;case 29:_i=ha;case 30:return Ni=((0,Q.Z)(_r)==="object"||typeof _r=="string")&&_r?_r:qr,Ni instanceof File?vi=Ni:vi=new File([Ni],qr.name,{type:qr.type}),si=vi,si.uid=qr.uid,Pa.abrupt("return",{origin:qr,data:_i,parsedFile:si,action:La});case 35:case"end":return Pa.stop()}},Ln,null,[[3,9]])}));return function(Ln,qr){return qn.apply(this,arguments)}}(),re.saveFileInput=function(qn){re.fileInput=qn},re}return(0,k.Z)(Ht,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.abort()}},{key:"post",value:function(on){var Je=this,Ve=on.data,qn=on.origin,Ln=on.action,qr=on.parsedFile;if(!!this._isMounted){var Ca=this.props,Qn=Ca.onStart,_r=Ca.customRequest,ea=Ca.name,La=Ca.headers,ha=Ca.withCredentials,_i=Ca.method,Ni=qn.uid,vi=_r||mt,si={action:Ln,filename:ea,data:Ve,file:qr,headers:La,withCredentials:ha,method:_i||"post",onProgress:function(Pa){var un=Je.props.onProgress;un==null||un(Pa,qr)},onSuccess:function(Pa,un){var Oe=Je.props.onSuccess;Oe==null||Oe(Pa,qr,un),delete Je.reqs[Ni]},onError:function(Pa,un){var Oe=Je.props.onError;Oe==null||Oe(Pa,un,qr),delete Je.reqs[Ni]}};Qn(qn),this.reqs[Ni]=vi(si)}}},{key:"reset",value:function(){this.setState({uid:dt()})}},{key:"abort",value:function(on){var Je=this.reqs;if(on){var Ve=on.uid?on.uid:on;Je[Ve]&&Je[Ve].abort&&Je[Ve].abort(),delete Je[Ve]}else Object.keys(Je).forEach(function(qn){Je[qn]&&Je[qn].abort&&Je[qn].abort(),delete Je[qn]})}},{key:"render",value:function(){var on,Je=this.props,Ve=Je.component,qn=Je.prefixCls,Ln=Je.className,qr=Je.disabled,Ca=Je.id,Qn=Je.style,_r=Je.multiple,ea=Je.accept,La=Je.capture,ha=Je.children,_i=Je.directory,Ni=Je.openFileDialogOnClick,vi=Je.onMouseEnter,si=Je.onMouseLeave,Mi=(0,F.Z)(Je,Gt),Pa=C()((on={},(0,j.Z)(on,qn,!0),(0,j.Z)(on,"".concat(qn,"-disabled"),qr),(0,j.Z)(on,Ln,Ln),on)),un=_i?{directory:"directory",webkitdirectory:"webkitdirectory"}:{},Oe=qr?{}:{onClick:Ni?this.onClick:function(){},onKeyDown:Ni?this.onKeyDown:function(){},onMouseEnter:vi,onMouseLeave:si,onDrop:this.onFileDrop,onDragOver:this.onFileDrop,tabIndex:"0"};return tt.createElement(Ve,(0,X.Z)({},Oe,{className:Pa,role:"button",style:Qn}),tt.createElement("input",(0,X.Z)({},(0,O.Z)(Mi,{aria:!0,data:!0}),{id:Ca,type:"file",ref:this.saveFileInput,onClick:function(Hn){return Hn.stopPropagation()},key:this.state.uid,style:{display:"none"},accept:ea},un,{multiple:_r,onChange:this.onChange},La!=null?{capture:La}:{})),ha)}}]),Ht}(tt.Component),ie=se;function Be(){}var ke=function($t){(0,B.Z)(Ht,$t);var jt=(0,R.Z)(Ht);function Ht(){var re;(0,M.Z)(this,Ht);for(var on=arguments.length,Je=new Array(on),Ve=0;Ve<on;Ve++)Je[Ve]=arguments[Ve];return re=jt.call.apply(jt,[this].concat(Je)),re.uploader=void 0,re.saveUploader=function(qn){re.uploader=qn},re}return(0,k.Z)(Ht,[{key:"abort",value:function(on){this.uploader.abort(on)}},{key:"render",value:function(){return tt.createElement(ie,(0,X.Z)({},this.props,{ref:this.saveUploader}))}}]),Ht}(tt.Component);ke.defaultProps={component:"span",prefixCls:"rc-upload",data:{},headers:{},name:"file",multipart:!1,onStart:Be,onError:Be,onSuccess:Be,multiple:!1,beforeUpload:null,customRequest:null,withCredentials:!1,openFileDialogOnClick:!0};var we=ke,At=we,Yt=$(21770),be=$(73935),nn=$(53124),Ee=$(98866),le=$(42051),Le=$(85636),Ze=$(28991),fe={icon:function(jt,Ht){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M534 352V136H232v752h560V394H576a42 42 0 01-42-42z",fill:Ht}},{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM602 137.8L790.2 326H602V137.8zM792 888H232V136h302v216a42 42 0 0042 42h216v494z",fill:jt}}]}},name:"file",theme:"twotone"},Re=fe,He=$(27029),pe=function(jt,Ht){return tt.createElement(He.Z,(0,Ze.Z)((0,Ze.Z)({},jt),{},{ref:Ht,icon:Re}))};pe.displayName="FileTwoTone";var Ge=tt.forwardRef(pe),te=$(7085),Me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z"}}]},name:"paper-clip",theme:"outlined"},We=Me,ee=function(jt,Ht){return tt.createElement(He.Z,(0,Ze.Z)((0,Ze.Z)({},jt),{},{ref:Ht,icon:We}))};ee.displayName="PaperClipOutlined";var Pt=tt.forwardRef(ee),yt={icon:function(jt,Ht){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2z",fill:jt}},{tag:"path",attrs:{d:"M424.6 765.8l-150.1-178L136 752.1V792h752v-30.4L658.1 489z",fill:Ht}},{tag:"path",attrs:{d:"M136 652.7l132.4-157c3.2-3.8 9-3.8 12.2 0l144 170.7L652 396.8c3.2-3.8 9-3.8 12.2 0L888 662.2V232H136v420.7zM304 280a88 88 0 110 176 88 88 0 010-176z",fill:Ht}},{tag:"path",attrs:{d:"M276 368a28 28 0 1056 0 28 28 0 10-56 0z",fill:Ht}},{tag:"path",attrs:{d:"M304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z",fill:jt}}]}},name:"picture",theme:"twotone"},Ne=yt,tn=function(jt,Ht){return tt.createElement(He.Z,(0,Ze.Z)((0,Ze.Z)({},jt),{},{ref:Ht,icon:Ne}))};tn.displayName="PictureTwoTone";var fn=tt.forwardRef(tn),Rt=$(5461),Yn=$(71577),Un=$(57838),xr=$(33603),cr=$(96159);function Ur($t){return(0,X.Z)((0,X.Z)({},$t),{lastModified:$t.lastModified,lastModifiedDate:$t.lastModifiedDate,name:$t.name,size:$t.size,type:$t.type,uid:$t.uid,percent:0,originFileObj:$t})}function fa($t,jt){var Ht=(0,Z.Z)(jt),re=Ht.findIndex(function(on){var Je=on.uid;return Je===$t.uid});return re===-1?Ht.push($t):Ht[re]=$t,Ht}function Sa($t,jt){var Ht=$t.uid!==void 0?"uid":"name";return jt.filter(function(re){return re[Ht]===$t[Ht]})[0]}function sa($t,jt){var Ht=$t.uid!==void 0?"uid":"name",re=jt.filter(function(on){return on[Ht]!==$t[Ht]});return re.length===jt.length?null:re}var Da=function(){var jt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Ht=jt.split("/"),re=Ht[Ht.length-1],on=re.split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(on)||[""])[0]},Rr=function(jt){return jt.indexOf("image/")===0},Mn=function(jt){if(jt.type&&!jt.thumbUrl)return Rr(jt.type);var Ht=jt.thumbUrl||jt.url||"",re=Da(Ht);return/^data:image\//.test(Ht)||/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico|heic|heif)$/i.test(re)?!0:!(/^data:/.test(Ht)||re)},ar=200;function Fn($t){return new Promise(function(jt){if(!$t.type||!Rr($t.type)){jt("");return}var Ht=document.createElement("canvas");Ht.width=ar,Ht.height=ar,Ht.style.cssText="position: fixed; left: 0; top: 0; width: ".concat(ar,"px; height: ").concat(ar,"px; z-index: 9999; display: none;"),document.body.appendChild(Ht);var re=Ht.getContext("2d"),on=new Image;if(on.onload=function(){var Ve=on.width,qn=on.height,Ln=ar,qr=ar,Ca=0,Qn=0;Ve>qn?(qr=qn*(ar/Ve),Qn=-(qr-Ln)/2):(Ln=Ve*(ar/qn),Ca=-(Ln-qr)/2),re.drawImage(on,Ca,Qn,Ln,qr);var _r=Ht.toDataURL();document.body.removeChild(Ht),jt(_r)},on.crossOrigin="anonymous",$t.type.startsWith("image/svg+xml")){var Je=new FileReader;Je.addEventListener("load",function(){Je.result&&(on.src=Je.result)}),Je.readAsDataURL($t)}else on.src=window.URL.createObjectURL($t)})}var tr=$(73171),Gn=$(90631),jr=$(95357),Hr=$(54458),Ea=$(94199),lr=tt.forwardRef(function($t,jt){var Ht,re=$t.prefixCls,on=$t.className,Je=$t.style,Ve=$t.locale,qn=$t.listType,Ln=$t.file,qr=$t.items,Ca=$t.progress,Qn=$t.iconRender,_r=$t.actionIconRender,ea=$t.itemRender,La=$t.isImgUrl,ha=$t.showPreviewIcon,_i=$t.showRemoveIcon,Ni=$t.showDownloadIcon,vi=$t.previewIcon,si=$t.removeIcon,Mi=$t.downloadIcon,Pa=$t.onPreview,un=$t.onDownload,Oe=$t.onClose,hn,Hn,Bn=Ln.status,Jn=tt.useState(Bn),Lr=(0,L.Z)(Jn,2),ya=Lr[0],Fa=Lr[1];tt.useEffect(function(){Bn!=="removed"&&Fa(Bn)},[Bn]);var ui=tt.useState(!1),Ei=(0,L.Z)(ui,2),oo=Ei[0],po=Ei[1],bo=tt.useRef(null);tt.useEffect(function(){return bo.current=setTimeout(function(){po(!0)},300),function(){bo.current&&clearTimeout(bo.current)}},[]);var ts="".concat(re,"-span"),Wo=Qn(Ln),Yi=tt.createElement("div",{className:"".concat(re,"-text-icon")},Wo);if(qn==="picture"||qn==="picture-card")if(ya==="uploading"||!Ln.thumbUrl&&!Ln.url){var wi,gi=C()((wi={},(0,j.Z)(wi,"".concat(re,"-list-item-thumbnail"),!0),(0,j.Z)(wi,"".concat(re,"-list-item-file"),ya!=="uploading"),wi));Yi=tt.createElement("div",{className:gi},Wo)}else{var us,Do=(La==null?void 0:La(Ln))?tt.createElement("img",{src:Ln.thumbUrl||Ln.url,alt:Ln.name,className:"".concat(re,"-list-item-image"),crossOrigin:Ln.crossOrigin}):Wo,Io=C()((us={},(0,j.Z)(us,"".concat(re,"-list-item-thumbnail"),!0),(0,j.Z)(us,"".concat(re,"-list-item-file"),La&&!La(Ln)),us));Yi=tt.createElement("a",{className:Io,onClick:function(Ns){return Pa(Ln,Ns)},href:Ln.url||Ln.thumbUrl,target:"_blank",rel:"noopener noreferrer"},Do)}var zs=C()((Ht={},(0,j.Z)(Ht,"".concat(re,"-list-item"),!0),(0,j.Z)(Ht,"".concat(re,"-list-item-").concat(ya),!0),(0,j.Z)(Ht,"".concat(re,"-list-item-list-type-").concat(qn),!0),Ht)),mu=typeof Ln.linkProps=="string"?JSON.parse(Ln.linkProps):Ln.linkProps,ds=_i?_r((typeof si=="function"?si(Ln):si)||tt.createElement(tr.Z,null),function(){return Oe(Ln)},re,Ve.removeFile):null,Ms=Ni&&ya==="done"?_r((typeof Mi=="function"?Mi(Ln):Mi)||tt.createElement(Gn.Z,null),function(){return un(Ln)},re,Ve.downloadFile):null,yu=qn!=="picture-card"&&tt.createElement("span",{key:"download-delete",className:C()("".concat(re,"-list-item-card-actions"),{picture:qn==="picture"})},Ms,ds),uu=C()("".concat(re,"-list-item-name")),Cs=Ln.url?[tt.createElement("a",(0,X.Z)({key:"view",target:"_blank",rel:"noopener noreferrer",className:uu,title:Ln.name},mu,{href:Ln.url,onClick:function(Ns){return Pa(Ln,Ns)}}),Ln.name),yu]:[tt.createElement("span",{key:"view",className:uu,onClick:function(Ns){return Pa(Ln,Ns)},title:Ln.name},Ln.name),yu],qo={pointerEvents:"none",opacity:.5},Wi=ha?tt.createElement("a",{href:Ln.url||Ln.thumbUrl,target:"_blank",rel:"noopener noreferrer",style:Ln.url||Ln.thumbUrl?void 0:qo,onClick:function(Ns){return Pa(Ln,Ns)},title:Ve.previewFile},typeof vi=="function"?vi(Ln):vi||tt.createElement(jr.Z,null)):null,ls=qn==="picture-card"&&ya!=="uploading"&&tt.createElement("span",{className:"".concat(re,"-list-item-actions")},Wi,ya==="done"&&Ms,ds),is;Ln.response&&typeof Ln.response=="string"?is=Ln.response:is=((hn=Ln.error)===null||hn===void 0?void 0:hn.statusText)||((Hn=Ln.error)===null||Hn===void 0?void 0:Hn.message)||Ve.uploadError;var Es=tt.createElement("span",{className:ts},Yi,Cs),tl=tt.useContext(nn.E_),bu=tl.getPrefixCls,Ys=bu(),ka=tt.createElement("div",{className:zs},tt.createElement("div",{className:"".concat(re,"-list-item-info")},Es),ls,oo&&tt.createElement(Rt.default,{motionName:"".concat(Ys,"-fade"),visible:ya==="uploading",motionDeadline:2e3},function(Ro){var Ns=Ro.className,tu="percent"in Ln?tt.createElement(Hr.Z,(0,X.Z)({},Ca,{type:"line",percent:Ln.percent})):null;return tt.createElement("div",{className:C()("".concat(re,"-list-item-progress"),Ns)},tu)})),Ku=C()("".concat(re,"-list-").concat(qn,"-container"),on),Vs=ya==="error"?tt.createElement(Ea.Z,{title:is,getPopupContainer:function(Ns){return Ns.parentNode}},ka):ka;return tt.createElement("div",{className:Ku,style:Je,ref:jt},ea?ea(Vs,Ln,qr,{download:un.bind(null,Ln),preview:Pa.bind(null,Ln),remove:Oe.bind(null,Ln)}):Vs)}),Cr=lr,vr=(0,X.Z)({},xr.ZP);delete vr.onAppearEnd,delete vr.onEnterEnd,delete vr.onLeaveEnd;var Tr=function(jt,Ht){var re,on=jt.listType,Je=on===void 0?"text":on,Ve=jt.previewFile,qn=Ve===void 0?Fn:Ve,Ln=jt.onPreview,qr=jt.onDownload,Ca=jt.onRemove,Qn=jt.locale,_r=jt.iconRender,ea=jt.isImageUrl,La=ea===void 0?Mn:ea,ha=jt.prefixCls,_i=jt.items,Ni=_i===void 0?[]:_i,vi=jt.showPreviewIcon,si=vi===void 0?!0:vi,Mi=jt.showRemoveIcon,Pa=Mi===void 0?!0:Mi,un=jt.showDownloadIcon,Oe=un===void 0?!1:un,hn=jt.removeIcon,Hn=jt.previewIcon,Bn=jt.downloadIcon,Jn=jt.progress,Lr=Jn===void 0?{strokeWidth:2,showInfo:!1}:Jn,ya=jt.appendAction,Fa=jt.appendActionVisible,ui=Fa===void 0?!0:Fa,Ei=jt.itemRender,oo=(0,Un.Z)(),po=tt.useState(!1),bo=(0,L.Z)(po,2),ts=bo[0],Wo=bo[1];tt.useEffect(function(){Je!=="picture"&&Je!=="picture-card"||(Ni||[]).forEach(function(qo){typeof document=="undefined"||typeof window=="undefined"||!window.FileReader||!window.File||!(qo.originFileObj instanceof File||qo.originFileObj instanceof Blob)||qo.thumbUrl!==void 0||(qo.thumbUrl="",qn&&qn(qo.originFileObj).then(function(Wi){qo.thumbUrl=Wi||"",oo()}))})},[Je,Ni,qn]),tt.useEffect(function(){Wo(!0)},[]);var Yi=function(Wi,ls){if(!!Ln)return ls==null||ls.preventDefault(),Ln(Wi)},wi=function(Wi){typeof qr=="function"?qr(Wi):Wi.url&&window.open(Wi.url)},gi=function(Wi){Ca==null||Ca(Wi)},us=function(Wi){if(_r)return _r(Wi,Je);var ls=Wi.status==="uploading",is=La&&La(Wi)?tt.createElement(fn,null):tt.createElement(Ge,null),Es=ls?tt.createElement(te.Z,null):tt.createElement(Pt,null);return Je==="picture"?Es=ls?tt.createElement(te.Z,null):is:Je==="picture-card"&&(Es=ls?Qn.uploading:is),Es},Do=function(Wi,ls,is,Es){var tl={type:"text",size:"small",title:Es,onClick:function(ka){ls(),(0,cr.l$)(Wi)&&Wi.props.onClick&&Wi.props.onClick(ka)},className:"".concat(is,"-list-item-card-actions-btn")};if((0,cr.l$)(Wi)){var bu=(0,cr.Tm)(Wi,(0,X.Z)((0,X.Z)({},Wi.props),{onClick:function(){}}));return tt.createElement(Yn.Z,(0,X.Z)({},tl,{icon:bu}))}return tt.createElement(Yn.Z,(0,X.Z)({},tl),tt.createElement("span",null,Wi))};tt.useImperativeHandle(Ht,function(){return{handlePreview:Yi,handleDownload:wi}});var Io=tt.useContext(nn.E_),zs=Io.getPrefixCls,mu=Io.direction,ds=zs("upload",ha),Ms=C()((re={},(0,j.Z)(re,"".concat(ds,"-list"),!0),(0,j.Z)(re,"".concat(ds,"-list-").concat(Je),!0),(0,j.Z)(re,"".concat(ds,"-list-rtl"),mu==="rtl"),re)),yu=(0,Z.Z)(Ni.map(function(qo){return{key:qo.uid,file:qo}})),uu=Je==="picture-card"?"animate-inline":"animate",Cs={motionDeadline:2e3,motionName:"".concat(ds,"-").concat(uu),keys:yu,motionAppear:ts};return Je!=="picture-card"&&(Cs=(0,X.Z)((0,X.Z)({},vr),Cs)),tt.createElement("div",{className:Ms},tt.createElement(Rt.CSSMotionList,(0,X.Z)({},Cs,{component:!1}),function(qo){var Wi=qo.key,ls=qo.file,is=qo.className,Es=qo.style;return tt.createElement(Cr,{key:Wi,locale:Qn,prefixCls:ds,className:is,style:Es,file:ls,items:Ni,progress:Lr,listType:Je,isImgUrl:La,showPreviewIcon:si,showRemoveIcon:Pa,showDownloadIcon:Oe,removeIcon:hn,previewIcon:Hn,downloadIcon:Bn,iconRender:us,actionIconRender:Do,itemRender:Ei,onPreview:Yi,onDownload:wi,onClose:gi})}),ya&&tt.createElement(Rt.default,(0,X.Z)({},Cs,{visible:ui,forceRender:!0}),function(qo){var Wi=qo.className,ls=qo.style;return(0,cr.Tm)(ya,function(is){return{className:C()(is.className,Wi),style:(0,X.Z)((0,X.Z)((0,X.Z)({},ls),{pointerEvents:Wi?"none":void 0}),is.style)}})}))},ta=tt.forwardRef(Tr),ra=ta,Zr=function($t,jt,Ht,re){function on(Je){return Je instanceof Ht?Je:new Ht(function(Ve){Ve(Je)})}return new(Ht||(Ht=Promise))(function(Je,Ve){function qn(Ca){try{qr(re.next(Ca))}catch(Qn){Ve(Qn)}}function Ln(Ca){try{qr(re.throw(Ca))}catch(Qn){Ve(Qn)}}function qr(Ca){Ca.done?Je(Ca.value):on(Ca.value).then(qn,Ln)}qr((re=re.apply($t,jt||[])).next())})},vt="__LIST_IGNORE_".concat(Date.now(),"__"),_n=function(jt,Ht){var re,on=jt.fileList,Je=jt.defaultFileList,Ve=jt.onRemove,qn=jt.showUploadList,Ln=qn===void 0?!0:qn,qr=jt.listType,Ca=qr===void 0?"text":qr,Qn=jt.onPreview,_r=jt.onDownload,ea=jt.onChange,La=jt.onDrop,ha=jt.previewFile,_i=jt.disabled,Ni=jt.locale,vi=jt.iconRender,si=jt.isImageUrl,Mi=jt.progress,Pa=jt.prefixCls,un=jt.className,Oe=jt.type,hn=Oe===void 0?"select":Oe,Hn=jt.children,Bn=jt.style,Jn=jt.itemRender,Lr=jt.maxCount,ya=jt.data,Fa=ya===void 0?{}:ya,ui=jt.multiple,Ei=ui===void 0?!1:ui,oo=jt.action,po=oo===void 0?"":oo,bo=jt.accept,ts=bo===void 0?"":bo,Wo=jt.supportServerRender,Yi=Wo===void 0?!0:Wo,wi=tt.useContext(Ee.Z),gi=_i!=null?_i:wi,us=(0,Yt.Z)(Je||[],{value:on,postState:function(Ra){return Ra!=null?Ra:[]}}),Do=(0,L.Z)(us,2),Io=Do[0],zs=Do[1],mu=tt.useState("drop"),ds=(0,L.Z)(mu,2),Ms=ds[0],yu=ds[1],uu=tt.useRef(null);tt.useMemo(function(){var pa=Date.now();(on||[]).forEach(function(Ra,Qi){!Ra.uid&&!Object.isFrozen(Ra)&&(Ra.uid="__AUTO__".concat(pa,"_").concat(Qi,"__"))})},[on]);var Cs=function(Ra,Qi,Co){var to=(0,Z.Z)(Qi);Lr===1?to=to.slice(-1):Lr&&(to=to.slice(0,Lr)),(0,be.flushSync)(function(){zs(to)});var xo={file:Ra,fileList:to};Co&&(xo.event=Co),ea==null||ea(xo)},qo=function(Ra,Qi){return Zr(void 0,void 0,void 0,(0,W.Z)().mark(function Co(){var to,xo,gs,vo;return(0,W.Z)().wrap(function(ms){for(;;)switch(ms.prev=ms.next){case 0:if(to=jt.beforeUpload,xo=jt.transformFile,gs=Ra,!to){ms.next=13;break}return ms.next=5,to(Ra,Qi);case 5:if(vo=ms.sent,vo!==!1){ms.next=8;break}return ms.abrupt("return",!1);case 8:if(delete Ra[vt],vo!==vt){ms.next=12;break}return Object.defineProperty(Ra,vt,{value:!0,configurable:!0}),ms.abrupt("return",!1);case 12:(0,Q.Z)(vo)==="object"&&vo&&(gs=vo);case 13:if(!xo){ms.next=17;break}return ms.next=16,xo(gs);case 16:gs=ms.sent;case 17:return ms.abrupt("return",gs);case 18:case"end":return ms.stop()}},Co)}))},Wi=function(Ra){var Qi=Ra.filter(function(xo){return!xo.file[vt]});if(!!Qi.length){var Co=Qi.map(function(xo){return Ur(xo.file)}),to=(0,Z.Z)(Io);Co.forEach(function(xo){to=fa(xo,to)}),Co.forEach(function(xo,gs){var vo=xo;if(Qi[gs].parsedFile)xo.status="uploading";else{var ou=xo.originFileObj,ms;try{ms=new File([ou],ou.name,{type:ou.type})}catch(xu){ms=new Blob([ou],{type:ou.type}),ms.name=ou.name,ms.lastModifiedDate=new Date,ms.lastModified=new Date().getTime()}ms.uid=xo.uid,vo=ms}Cs(vo,to)})}},ls=function(Ra,Qi,Co){try{typeof Ra=="string"&&(Ra=JSON.parse(Ra))}catch(gs){}if(!!Sa(Qi,Io)){var to=Ur(Qi);to.status="done",to.percent=100,to.response=Ra,to.xhr=Co;var xo=fa(to,Io);Cs(to,xo)}},is=function(Ra,Qi){if(!!Sa(Qi,Io)){var Co=Ur(Qi);Co.status="uploading",Co.percent=Ra.percent;var to=fa(Co,Io);Cs(Co,to,Ra)}},Es=function(Ra,Qi,Co){if(!!Sa(Co,Io)){var to=Ur(Co);to.error=Ra,to.response=Qi,to.status="error";var xo=fa(to,Io);Cs(to,xo)}},tl=function(Ra){var Qi;Promise.resolve(typeof Ve=="function"?Ve(Ra):Ve).then(function(Co){var to;if(Co!==!1){var xo=sa(Ra,Io);xo&&(Qi=(0,X.Z)((0,X.Z)({},Ra),{status:"removed"}),Io==null||Io.forEach(function(gs){var vo=Qi.uid!==void 0?"uid":"name";gs[vo]===Qi[vo]&&!Object.isFrozen(gs)&&(gs.status="removed")}),(to=uu.current)===null||to===void 0||to.abort(Qi),Cs(Qi,xo))}})},bu=function(Ra){yu(Ra.type),Ra.type==="drop"&&(La==null||La(Ra))};tt.useImperativeHandle(Ht,function(){return{onBatchStart:Wi,onSuccess:ls,onProgress:is,onError:Es,fileList:Io,upload:uu.current}});var Ys=tt.useContext(nn.E_),ka=Ys.getPrefixCls,Ku=Ys.direction,Vs=ka("upload",Pa),Ro=(0,X.Z)((0,X.Z)({onBatchStart:Wi,onError:Es,onProgress:is,onSuccess:ls},jt),{data:Fa,multiple:Ei,action:po,accept:ts,supportServerRender:Yi,prefixCls:Vs,disabled:gi,beforeUpload:qo,onChange:void 0});delete Ro.className,delete Ro.style,(!Hn||gi)&&delete Ro.id;var Ns=function(Ra,Qi){return Ln?tt.createElement(le.Z,{componentName:"Upload",defaultLocale:Le.Z.Upload},function(Co){var to=typeof Ln=="boolean"?{}:Ln,xo=to.showRemoveIcon,gs=to.showPreviewIcon,vo=to.showDownloadIcon,ou=to.removeIcon,ms=to.previewIcon,xu=to.downloadIcon;return tt.createElement(ra,{prefixCls:Vs,listType:Ca,items:Io,previewFile:ha,onPreview:Qn,onDownload:_r,onRemove:tl,showRemoveIcon:!gi&&xo,showPreviewIcon:gs,showDownloadIcon:vo,removeIcon:ou,previewIcon:ms,downloadIcon:xu,iconRender:vi,locale:(0,X.Z)((0,X.Z)({},Co),Ni),isImageUrl:si,progress:Mi,appendAction:Ra,appendActionVisible:Qi,itemRender:Jn})}):Ra};if(hn==="drag"){var tu,eu=C()(Vs,(tu={},(0,j.Z)(tu,"".concat(Vs,"-drag"),!0),(0,j.Z)(tu,"".concat(Vs,"-drag-uploading"),Io.some(function(pa){return pa.status==="uploading"})),(0,j.Z)(tu,"".concat(Vs,"-drag-hover"),Ms==="dragover"),(0,j.Z)(tu,"".concat(Vs,"-disabled"),gi),(0,j.Z)(tu,"".concat(Vs,"-rtl"),Ku==="rtl"),tu),un);return tt.createElement("span",null,tt.createElement("div",{className:eu,onDrop:bu,onDragOver:bu,onDragLeave:bu,style:Bn},tt.createElement(At,(0,X.Z)({},Ro,{ref:uu,className:"".concat(Vs,"-btn")}),tt.createElement("div",{className:"".concat(Vs,"-drag-container")},Hn))),Ns())}var Zu=C()(Vs,(re={},(0,j.Z)(re,"".concat(Vs,"-select"),!0),(0,j.Z)(re,"".concat(Vs,"-select-").concat(Ca),!0),(0,j.Z)(re,"".concat(Vs,"-disabled"),gi),(0,j.Z)(re,"".concat(Vs,"-rtl"),Ku==="rtl"),re)),bn=function(Ra){return tt.createElement("div",{className:Zu,style:Ra},tt.createElement(At,(0,X.Z)({},Ro,{ref:uu})))},Xr=bn(Hn?void 0:{display:"none"});return Ca==="picture-card"?tt.createElement("span",{className:C()("".concat(Vs,"-picture-card-wrapper"),un)},Ns(Xr,!!Hn)):tt.createElement("span",{className:un},Xr,Ns())},an=tt.forwardRef(_n),Lt=an,kt=function($t,jt){var Ht={};for(var re in $t)Object.prototype.hasOwnProperty.call($t,re)&&jt.indexOf(re)<0&&(Ht[re]=$t[re]);if($t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var on=0,re=Object.getOwnPropertySymbols($t);on<re.length;on++)jt.indexOf(re[on])<0&&Object.prototype.propertyIsEnumerable.call($t,re[on])&&(Ht[re[on]]=$t[re[on]]);return Ht},at=tt.forwardRef(function($t,jt){var Ht=$t.style,re=$t.height,on=kt($t,["style","height"]);return tt.createElement(Lt,(0,X.Z)({ref:jt},on,{type:"drag",style:(0,X.Z)((0,X.Z)({},Ht),{height:re})}))}),H=at,Y=Lt;Y.Dragger=H,Y.LIST_IGNORE=vt;var bt=Y},43185:function(sr,it,$){"use strict";var X=$(38663),tt=$.n(X),j=$(63252),W=$.n(j),Q=$(57663),Z=$(34669),L=$(22385)},48168:function(sr,it,$){var X=$(39092),tt={};for(var j in X)X.hasOwnProperty(j)&&(tt[X[j]]=j);var W=sr.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var Q in W)if(W.hasOwnProperty(Q)){if(!("channels"in W[Q]))throw new Error("missing channels property: "+Q);if(!("labels"in W[Q]))throw new Error("missing channel labels property: "+Q);if(W[Q].labels.length!==W[Q].channels)throw new Error("channel and label counts mismatch: "+Q);var Z=W[Q].channels,L=W[Q].labels;delete W[Q].channels,delete W[Q].labels,Object.defineProperty(W[Q],"channels",{value:Z}),Object.defineProperty(W[Q],"labels",{value:L})}W.rgb.hsl=function(C){var M=C[0]/255,k=C[1]/255,B=C[2]/255,R=Math.min(M,k,B),F=Math.max(M,k,B),K=F-R,O,_,ft;return F===R?O=0:M===F?O=(k-B)/K:k===F?O=2+(B-M)/K:B===F&&(O=4+(M-k)/K),O=Math.min(O*60,360),O<0&&(O+=360),ft=(R+F)/2,F===R?_=0:ft<=.5?_=K/(F+R):_=K/(2-F-R),[O,_*100,ft*100]},W.rgb.hsv=function(C){var M,k,B,R,F,K=C[0]/255,O=C[1]/255,_=C[2]/255,ft=Math.max(K,O,_),mt=ft-Math.min(K,O,_),st=function(ut){return(ft-ut)/6/mt+1/2};return mt===0?R=F=0:(F=mt/ft,M=st(K),k=st(O),B=st(_),K===ft?R=B-k:O===ft?R=1/3+M-B:_===ft&&(R=2/3+k-M),R<0?R+=1:R>1&&(R-=1)),[R*360,F*100,ft*100]},W.rgb.hwb=function(C){var M=C[0],k=C[1],B=C[2],R=W.rgb.hsl(C)[0],F=1/255*Math.min(M,Math.min(k,B));return B=1-1/255*Math.max(M,Math.max(k,B)),[R,F*100,B*100]},W.rgb.cmyk=function(C){var M=C[0]/255,k=C[1]/255,B=C[2]/255,R,F,K,O;return O=Math.min(1-M,1-k,1-B),R=(1-M-O)/(1-O)||0,F=(1-k-O)/(1-O)||0,K=(1-B-O)/(1-O)||0,[R*100,F*100,K*100,O*100]};function P(C,M){return Math.pow(C[0]-M[0],2)+Math.pow(C[1]-M[1],2)+Math.pow(C[2]-M[2],2)}W.rgb.keyword=function(C){var M=tt[C];if(M)return M;var k=Infinity,B;for(var R in X)if(X.hasOwnProperty(R)){var F=X[R],K=P(C,F);K<k&&(k=K,B=R)}return B},W.keyword.rgb=function(C){return X[C]},W.rgb.xyz=function(C){var M=C[0]/255,k=C[1]/255,B=C[2]/255;M=M>.04045?Math.pow((M+.055)/1.055,2.4):M/12.92,k=k>.04045?Math.pow((k+.055)/1.055,2.4):k/12.92,B=B>.04045?Math.pow((B+.055)/1.055,2.4):B/12.92;var R=M*.4124+k*.3576+B*.1805,F=M*.2126+k*.7152+B*.0722,K=M*.0193+k*.1192+B*.9505;return[R*100,F*100,K*100]},W.rgb.lab=function(C){var M=W.rgb.xyz(C),k=M[0],B=M[1],R=M[2],F,K,O;return k/=95.047,B/=100,R/=108.883,k=k>.008856?Math.pow(k,1/3):7.787*k+16/116,B=B>.008856?Math.pow(B,1/3):7.787*B+16/116,R=R>.008856?Math.pow(R,1/3):7.787*R+16/116,F=116*B-16,K=500*(k-B),O=200*(B-R),[F,K,O]},W.hsl.rgb=function(C){var M=C[0]/360,k=C[1]/100,B=C[2]/100,R,F,K,O,_;if(k===0)return _=B*255,[_,_,_];B<.5?F=B*(1+k):F=B+k-B*k,R=2*B-F,O=[0,0,0];for(var ft=0;ft<3;ft++)K=M+1/3*-(ft-1),K<0&&K++,K>1&&K--,6*K<1?_=R+(F-R)*6*K:2*K<1?_=F:3*K<2?_=R+(F-R)*(2/3-K)*6:_=R,O[ft]=_*255;return O},W.hsl.hsv=function(C){var M=C[0],k=C[1]/100,B=C[2]/100,R=k,F=Math.max(B,.01),K,O;return B*=2,k*=B<=1?B:2-B,R*=F<=1?F:2-F,O=(B+k)/2,K=B===0?2*R/(F+R):2*k/(B+k),[M,K*100,O*100]},W.hsv.rgb=function(C){var M=C[0]/60,k=C[1]/100,B=C[2]/100,R=Math.floor(M)%6,F=M-Math.floor(M),K=255*B*(1-k),O=255*B*(1-k*F),_=255*B*(1-k*(1-F));switch(B*=255,R){case 0:return[B,_,K];case 1:return[O,B,K];case 2:return[K,B,_];case 3:return[K,O,B];case 4:return[_,K,B];case 5:return[B,K,O]}},W.hsv.hsl=function(C){var M=C[0],k=C[1]/100,B=C[2]/100,R=Math.max(B,.01),F,K,O;return O=(2-k)*B,F=(2-k)*R,K=k*R,K/=F<=1?F:2-F,K=K||0,O/=2,[M,K*100,O*100]},W.hwb.rgb=function(C){var M=C[0]/360,k=C[1]/100,B=C[2]/100,R=k+B,F,K,O,_;R>1&&(k/=R,B/=R),F=Math.floor(6*M),K=1-B,O=6*M-F,(F&1)!=0&&(O=1-O),_=k+O*(K-k);var ft,mt,st;switch(F){default:case 6:case 0:ft=K,mt=_,st=k;break;case 1:ft=_,mt=K,st=k;break;case 2:ft=k,mt=K,st=_;break;case 3:ft=k,mt=_,st=K;break;case 4:ft=_,mt=k,st=K;break;case 5:ft=K,mt=k,st=_;break}return[ft*255,mt*255,st*255]},W.cmyk.rgb=function(C){var M=C[0]/100,k=C[1]/100,B=C[2]/100,R=C[3]/100,F,K,O;return F=1-Math.min(1,M*(1-R)+R),K=1-Math.min(1,k*(1-R)+R),O=1-Math.min(1,B*(1-R)+R),[F*255,K*255,O*255]},W.xyz.rgb=function(C){var M=C[0]/100,k=C[1]/100,B=C[2]/100,R,F,K;return R=M*3.2406+k*-1.5372+B*-.4986,F=M*-.9689+k*1.8758+B*.0415,K=M*.0557+k*-.204+B*1.057,R=R>.0031308?1.055*Math.pow(R,1/2.4)-.055:R*12.92,F=F>.0031308?1.055*Math.pow(F,1/2.4)-.055:F*12.92,K=K>.0031308?1.055*Math.pow(K,1/2.4)-.055:K*12.92,R=Math.min(Math.max(0,R),1),F=Math.min(Math.max(0,F),1),K=Math.min(Math.max(0,K),1),[R*255,F*255,K*255]},W.xyz.lab=function(C){var M=C[0],k=C[1],B=C[2],R,F,K;return M/=95.047,k/=100,B/=108.883,M=M>.008856?Math.pow(M,1/3):7.787*M+16/116,k=k>.008856?Math.pow(k,1/3):7.787*k+16/116,B=B>.008856?Math.pow(B,1/3):7.787*B+16/116,R=116*k-16,F=500*(M-k),K=200*(k-B),[R,F,K]},W.lab.xyz=function(C){var M=C[0],k=C[1],B=C[2],R,F,K;F=(M+16)/116,R=k/500+F,K=F-B/200;var O=Math.pow(F,3),_=Math.pow(R,3),ft=Math.pow(K,3);return F=O>.008856?O:(F-16/116)/7.787,R=_>.008856?_:(R-16/116)/7.787,K=ft>.008856?ft:(K-16/116)/7.787,R*=95.047,F*=100,K*=108.883,[R,F,K]},W.lab.lch=function(C){var M=C[0],k=C[1],B=C[2],R,F,K;return R=Math.atan2(B,k),F=R*360/2/Math.PI,F<0&&(F+=360),K=Math.sqrt(k*k+B*B),[M,K,F]},W.lch.lab=function(C){var M=C[0],k=C[1],B=C[2],R,F,K;return K=B/360*2*Math.PI,R=k*Math.cos(K),F=k*Math.sin(K),[M,R,F]},W.rgb.ansi16=function(C){var M=C[0],k=C[1],B=C[2],R=1 in arguments?arguments[1]:W.rgb.hsv(C)[2];if(R=Math.round(R/50),R===0)return 30;var F=30+(Math.round(B/255)<<2|Math.round(k/255)<<1|Math.round(M/255));return R===2&&(F+=60),F},W.hsv.ansi16=function(C){return W.rgb.ansi16(W.hsv.rgb(C),C[2])},W.rgb.ansi256=function(C){var M=C[0],k=C[1],B=C[2];if(M===k&&k===B)return M<8?16:M>248?231:Math.round((M-8)/247*24)+232;var R=16+36*Math.round(M/255*5)+6*Math.round(k/255*5)+Math.round(B/255*5);return R},W.ansi16.rgb=function(C){var M=C%10;if(M===0||M===7)return C>50&&(M+=3.5),M=M/10.5*255,[M,M,M];var k=(~~(C>50)+1)*.5,B=(M&1)*k*255,R=(M>>1&1)*k*255,F=(M>>2&1)*k*255;return[B,R,F]},W.ansi256.rgb=function(C){if(C>=232){var M=(C-232)*10+8;return[M,M,M]}C-=16;var k,B=Math.floor(C/36)/5*255,R=Math.floor((k=C%36)/6)/5*255,F=k%6/5*255;return[B,R,F]},W.rgb.hex=function(C){var M=((Math.round(C[0])&255)<<16)+((Math.round(C[1])&255)<<8)+(Math.round(C[2])&255),k=M.toString(16).toUpperCase();return"000000".substring(k.length)+k},W.hex.rgb=function(C){var M=C.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!M)return[0,0,0];var k=M[0];M[0].length===3&&(k=k.split("").map(function(O){return O+O}).join(""));var B=parseInt(k,16),R=B>>16&255,F=B>>8&255,K=B&255;return[R,F,K]},W.rgb.hcg=function(C){var M=C[0]/255,k=C[1]/255,B=C[2]/255,R=Math.max(Math.max(M,k),B),F=Math.min(Math.min(M,k),B),K=R-F,O,_;return K<1?O=F/(1-K):O=0,K<=0?_=0:R===M?_=(k-B)/K%6:R===k?_=2+(B-M)/K:_=4+(M-k)/K+4,_/=6,_%=1,[_*360,K*100,O*100]},W.hsl.hcg=function(C){var M=C[1]/100,k=C[2]/100,B=1,R=0;return k<.5?B=2*M*k:B=2*M*(1-k),B<1&&(R=(k-.5*B)/(1-B)),[C[0],B*100,R*100]},W.hsv.hcg=function(C){var M=C[1]/100,k=C[2]/100,B=M*k,R=0;return B<1&&(R=(k-B)/(1-B)),[C[0],B*100,R*100]},W.hcg.rgb=function(C){var M=C[0]/360,k=C[1]/100,B=C[2]/100;if(k===0)return[B*255,B*255,B*255];var R=[0,0,0],F=M%1*6,K=F%1,O=1-K,_=0;switch(Math.floor(F)){case 0:R[0]=1,R[1]=K,R[2]=0;break;case 1:R[0]=O,R[1]=1,R[2]=0;break;case 2:R[0]=0,R[1]=1,R[2]=K;break;case 3:R[0]=0,R[1]=O,R[2]=1;break;case 4:R[0]=K,R[1]=0,R[2]=1;break;default:R[0]=1,R[1]=0,R[2]=O}return _=(1-k)*B,[(k*R[0]+_)*255,(k*R[1]+_)*255,(k*R[2]+_)*255]},W.hcg.hsv=function(C){var M=C[1]/100,k=C[2]/100,B=M+k*(1-M),R=0;return B>0&&(R=M/B),[C[0],R*100,B*100]},W.hcg.hsl=function(C){var M=C[1]/100,k=C[2]/100,B=k*(1-M)+.5*M,R=0;return B>0&&B<.5?R=M/(2*B):B>=.5&&B<1&&(R=M/(2*(1-B))),[C[0],R*100,B*100]},W.hcg.hwb=function(C){var M=C[1]/100,k=C[2]/100,B=M+k*(1-M);return[C[0],(B-M)*100,(1-B)*100]},W.hwb.hcg=function(C){var M=C[1]/100,k=C[2]/100,B=1-k,R=B-M,F=0;return R<1&&(F=(B-R)/(1-R)),[C[0],R*100,F*100]},W.apple.rgb=function(C){return[C[0]/65535*255,C[1]/65535*255,C[2]/65535*255]},W.rgb.apple=function(C){return[C[0]/255*65535,C[1]/255*65535,C[2]/255*65535]},W.gray.rgb=function(C){return[C[0]/100*255,C[0]/100*255,C[0]/100*255]},W.gray.hsl=W.gray.hsv=function(C){return[0,0,C[0]]},W.gray.hwb=function(C){return[0,100,C[0]]},W.gray.cmyk=function(C){return[0,0,0,C[0]]},W.gray.lab=function(C){return[C[0],0,0]},W.gray.hex=function(C){var M=Math.round(C[0]/100*255)&255,k=(M<<16)+(M<<8)+M,B=k.toString(16).toUpperCase();return"000000".substring(B.length)+B},W.rgb.gray=function(C){var M=(C[0]+C[1]+C[2])/3;return[M/255*100]}},12085:function(sr,it,$){var X=$(48168),tt=$(4111),j={},W=Object.keys(X);function Q(L){var P=function(C){return C==null?C:(arguments.length>1&&(C=Array.prototype.slice.call(arguments)),L(C))};return"conversion"in L&&(P.conversion=L.conversion),P}function Z(L){var P=function(C){if(C==null)return C;arguments.length>1&&(C=Array.prototype.slice.call(arguments));var M=L(C);if(typeof M=="object")for(var k=M.length,B=0;B<k;B++)M[B]=Math.round(M[B]);return M};return"conversion"in L&&(P.conversion=L.conversion),P}W.forEach(function(L){j[L]={},Object.defineProperty(j[L],"channels",{value:X[L].channels}),Object.defineProperty(j[L],"labels",{value:X[L].labels});var P=tt(L),C=Object.keys(P);C.forEach(function(M){var k=P[M];j[L][M]=Z(k),j[L][M].raw=Q(k)})}),sr.exports=j},39092:function(sr){"use strict";sr.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},4111:function(sr,it,$){var X=$(48168);function tt(){for(var Z={},L=Object.keys(X),P=L.length,C=0;C<P;C++)Z[L[C]]={distance:-1,parent:null};return Z}function j(Z){var L=tt(),P=[Z];for(L[Z].distance=0;P.length;)for(var C=P.pop(),M=Object.keys(X[C]),k=M.length,B=0;B<k;B++){var R=M[B],F=L[R];F.distance===-1&&(F.distance=L[C].distance+1,F.parent=C,P.unshift(R))}return L}function W(Z,L){return function(P){return L(Z(P))}}function Q(Z,L){for(var P=[L[Z].parent,Z],C=X[L[Z].parent][Z],M=L[Z].parent;L[M].parent;)P.unshift(L[M].parent),C=W(X[L[M].parent][M],C),M=L[M].parent;return C.conversion=P,C}sr.exports=function(Z){for(var L=j(Z),P={},C=Object.keys(L),M=C.length,k=0;k<M;k++){var B=C[k],R=L[B];R.parent!==null&&(P[B]=Q(B,L))}return P}},8874:function(sr){"use strict";sr.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},19818:function(sr,it,$){var X=$(8874),tt=$(86851),j=Object.hasOwnProperty,W=Object.create(null);for(var Q in X)j.call(X,Q)&&(W[X[Q]]=Q);var Z=sr.exports={to:{},get:{}};Z.get=function(C){var M=C.substring(0,3).toLowerCase(),k,B;switch(M){case"hsl":k=Z.get.hsl(C),B="hsl";break;case"hwb":k=Z.get.hwb(C),B="hwb";break;default:k=Z.get.rgb(C),B="rgb";break}return k?{model:B,value:k}:null},Z.get.rgb=function(C){if(!C)return null;var M=/^#([a-f0-9]{3,4})$/i,k=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,B=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,R=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,F=/^(\w+)$/,K=[0,0,0,1],O,_,ft;if(O=C.match(k)){for(ft=O[2],O=O[1],_=0;_<3;_++){var mt=_*2;K[_]=parseInt(O.slice(mt,mt+2),16)}ft&&(K[3]=parseInt(ft,16)/255)}else if(O=C.match(M)){for(O=O[1],ft=O[3],_=0;_<3;_++)K[_]=parseInt(O[_]+O[_],16);ft&&(K[3]=parseInt(ft+ft,16)/255)}else if(O=C.match(B)){for(_=0;_<3;_++)K[_]=parseInt(O[_+1],0);O[4]&&(O[5]?K[3]=parseFloat(O[4])*.01:K[3]=parseFloat(O[4]))}else if(O=C.match(R)){for(_=0;_<3;_++)K[_]=Math.round(parseFloat(O[_+1])*2.55);O[4]&&(O[5]?K[3]=parseFloat(O[4])*.01:K[3]=parseFloat(O[4]))}else return(O=C.match(F))?O[1]==="transparent"?[0,0,0,0]:j.call(X,O[1])?(K=X[O[1]],K[3]=1,K):null:null;for(_=0;_<3;_++)K[_]=L(K[_],0,255);return K[3]=L(K[3],0,1),K},Z.get.hsl=function(C){if(!C)return null;var M=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,k=C.match(M);if(k){var B=parseFloat(k[4]),R=(parseFloat(k[1])%360+360)%360,F=L(parseFloat(k[2]),0,100),K=L(parseFloat(k[3]),0,100),O=L(isNaN(B)?1:B,0,1);return[R,F,K,O]}return null},Z.get.hwb=function(C){if(!C)return null;var M=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,k=C.match(M);if(k){var B=parseFloat(k[4]),R=(parseFloat(k[1])%360+360)%360,F=L(parseFloat(k[2]),0,100),K=L(parseFloat(k[3]),0,100),O=L(isNaN(B)?1:B,0,1);return[R,F,K,O]}return null},Z.to.hex=function(){var C=tt(arguments);return"#"+P(C[0])+P(C[1])+P(C[2])+(C[3]<1?P(Math.round(C[3]*255)):"")},Z.to.rgb=function(){var C=tt(arguments);return C.length<4||C[3]===1?"rgb("+Math.round(C[0])+", "+Math.round(C[1])+", "+Math.round(C[2])+")":"rgba("+Math.round(C[0])+", "+Math.round(C[1])+", "+Math.round(C[2])+", "+C[3]+")"},Z.to.rgb.percent=function(){var C=tt(arguments),M=Math.round(C[0]/255*100),k=Math.round(C[1]/255*100),B=Math.round(C[2]/255*100);return C.length<4||C[3]===1?"rgb("+M+"%, "+k+"%, "+B+"%)":"rgba("+M+"%, "+k+"%, "+B+"%, "+C[3]+")"},Z.to.hsl=function(){var C=tt(arguments);return C.length<4||C[3]===1?"hsl("+C[0]+", "+C[1]+"%, "+C[2]+"%)":"hsla("+C[0]+", "+C[1]+"%, "+C[2]+"%, "+C[3]+")"},Z.to.hwb=function(){var C=tt(arguments),M="";return C.length>=4&&C[3]!==1&&(M=", "+C[3]),"hwb("+C[0]+", "+C[1]+"%, "+C[2]+"%"+M+")"},Z.to.keyword=function(C){return W[C.slice(0,3)]};function L(C,M,k){return Math.min(Math.max(M,C),k)}function P(C){var M=Math.round(C).toString(16).toUpperCase();return M.length<2?"0"+M:M}},6767:function(sr,it,$){"use strict";var X=$(19818),tt=$(12085),j=[].slice,W=["keyword","gray","hex"],Q={};Object.keys(tt).forEach(function(F){Q[j.call(tt[F].labels).sort().join("")]=F});var Z={};function L(F,K){if(!(this instanceof L))return new L(F,K);if(K&&K in W&&(K=null),K&&!(K in tt))throw new Error("Unknown model: "+K);var O,_;if(F==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(F instanceof L)this.model=F.model,this.color=F.color.slice(),this.valpha=F.valpha;else if(typeof F=="string"){var ft=X.get(F);if(ft===null)throw new Error("Unable to parse color from string: "+F);this.model=ft.model,_=tt[this.model].channels,this.color=ft.value.slice(0,_),this.valpha=typeof ft.value[_]=="number"?ft.value[_]:1}else if(F.length){this.model=K||"rgb",_=tt[this.model].channels;var mt=j.call(F,0,_);this.color=R(mt,_),this.valpha=typeof F[_]=="number"?F[_]:1}else if(typeof F=="number")F&=16777215,this.model="rgb",this.color=[F>>16&255,F>>8&255,F&255],this.valpha=1;else{this.valpha=1;var st=Object.keys(F);"alpha"in F&&(st.splice(st.indexOf("alpha"),1),this.valpha=typeof F.alpha=="number"?F.alpha:0);var ut=st.sort().join("");if(!(ut in Q))throw new Error("Unable to parse color from object: "+JSON.stringify(F));this.model=Q[ut];var dt=tt[this.model].labels,gt=[];for(O=0;O<dt.length;O++)gt.push(F[dt[O]]);this.color=R(gt)}if(Z[this.model])for(_=tt[this.model].channels,O=0;O<_;O++){var wt=Z[this.model][O];wt&&(this.color[O]=wt(this.color[O]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}L.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(F){var K=this.model in X.to?this:this.rgb();K=K.round(typeof F=="number"?F:1);var O=K.valpha===1?K.color:K.color.concat(this.valpha);return X.to[K.model](O)},percentString:function(F){var K=this.rgb().round(typeof F=="number"?F:1),O=K.valpha===1?K.color:K.color.concat(this.valpha);return X.to.rgb.percent(O)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var F={},K=tt[this.model].channels,O=tt[this.model].labels,_=0;_<K;_++)F[O[_]]=this.color[_];return this.valpha!==1&&(F.alpha=this.valpha),F},unitArray:function(){var F=this.rgb().color;return F[0]/=255,F[1]/=255,F[2]/=255,this.valpha!==1&&F.push(this.valpha),F},unitObject:function(){var F=this.rgb().object();return F.r/=255,F.g/=255,F.b/=255,this.valpha!==1&&(F.alpha=this.valpha),F},round:function(F){return F=Math.max(F||0,0),new L(this.color.map(C(F)).concat(this.valpha),this.model)},alpha:function(F){return arguments.length?new L(this.color.concat(Math.max(0,Math.min(1,F))),this.model):this.valpha},red:M("rgb",0,k(255)),green:M("rgb",1,k(255)),blue:M("rgb",2,k(255)),hue:M(["hsl","hsv","hsl","hwb","hcg"],0,function(F){return(F%360+360)%360}),saturationl:M("hsl",1,k(100)),lightness:M("hsl",2,k(100)),saturationv:M("hsv",1,k(100)),value:M("hsv",2,k(100)),chroma:M("hcg",1,k(100)),gray:M("hcg",2,k(100)),white:M("hwb",1,k(100)),wblack:M("hwb",2,k(100)),cyan:M("cmyk",0,k(100)),magenta:M("cmyk",1,k(100)),yellow:M("cmyk",2,k(100)),black:M("cmyk",3,k(100)),x:M("xyz",0,k(100)),y:M("xyz",1,k(100)),z:M("xyz",2,k(100)),l:M("lab",0,k(100)),a:M("lab",1),b:M("lab",2),keyword:function(F){return arguments.length?new L(F):tt[this.model].keyword(this.color)},hex:function(F){return arguments.length?new L(F):X.to.hex(this.rgb().round().color)},rgbNumber:function(){var F=this.rgb().color;return(F[0]&255)<<16|(F[1]&255)<<8|F[2]&255},luminosity:function(){for(var F=this.rgb().color,K=[],O=0;O<F.length;O++){var _=F[O]/255;K[O]=_<=.03928?_/12.92:Math.pow((_+.055)/1.055,2.4)}return .2126*K[0]+.7152*K[1]+.0722*K[2]},contrast:function(F){var K=this.luminosity(),O=F.luminosity();return K>O?(K+.05)/(O+.05):(O+.05)/(K+.05)},level:function(F){var K=this.contrast(F);return K>=7.1?"AAA":K>=4.5?"AA":""},isDark:function(){var F=this.rgb().color,K=(F[0]*299+F[1]*587+F[2]*114)/1e3;return K<128},isLight:function(){return!this.isDark()},negate:function(){for(var F=this.rgb(),K=0;K<3;K++)F.color[K]=255-F.color[K];return F},lighten:function(F){var K=this.hsl();return K.color[2]+=K.color[2]*F,K},darken:function(F){var K=this.hsl();return K.color[2]-=K.color[2]*F,K},saturate:function(F){var K=this.hsl();return K.color[1]+=K.color[1]*F,K},desaturate:function(F){var K=this.hsl();return K.color[1]-=K.color[1]*F,K},whiten:function(F){var K=this.hwb();return K.color[1]+=K.color[1]*F,K},blacken:function(F){var K=this.hwb();return K.color[2]+=K.color[2]*F,K},grayscale:function(){var F=this.rgb().color,K=F[0]*.3+F[1]*.59+F[2]*.11;return L.rgb(K,K,K)},fade:function(F){return this.alpha(this.valpha-this.valpha*F)},opaquer:function(F){return this.alpha(this.valpha+this.valpha*F)},rotate:function(F){var K=this.hsl(),O=K.color[0];return O=(O+F)%360,O=O<0?360+O:O,K.color[0]=O,K},mix:function(F,K){if(!F||!F.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof F);var O=F.rgb(),_=this.rgb(),ft=K===void 0?.5:K,mt=2*ft-1,st=O.alpha()-_.alpha(),ut=((mt*st==-1?mt:(mt+st)/(1+mt*st))+1)/2,dt=1-ut;return L.rgb(ut*O.red()+dt*_.red(),ut*O.green()+dt*_.green(),ut*O.blue()+dt*_.blue(),O.alpha()*ft+_.alpha()*(1-ft))}},Object.keys(tt).forEach(function(F){if(W.indexOf(F)===-1){var K=tt[F].channels;L.prototype[F]=function(){if(this.model===F)return new L(this);if(arguments.length)return new L(arguments,F);var O=typeof arguments[K]=="number"?K:this.valpha;return new L(B(tt[this.model][F].raw(this.color)).concat(O),F)},L[F]=function(O){return typeof O=="number"&&(O=R(j.call(arguments),K)),new L(O,F)}}});function P(F,K){return Number(F.toFixed(K))}function C(F){return function(K){return P(K,F)}}function M(F,K,O){return F=Array.isArray(F)?F:[F],F.forEach(function(_){(Z[_]||(Z[_]=[]))[K]=O}),F=F[0],function(_){var ft;return arguments.length?(O&&(_=O(_)),ft=this[F](),ft.color[K]=_,ft):(ft=this[F]().color[K],O&&(ft=O(ft)),ft)}}function k(F){return function(K){return Math.max(0,Math.min(F,K))}}function B(F){return Array.isArray(F)?F:[F]}function R(F,K){for(var O=0;O<K;O++)typeof F[O]!="number"&&(F[O]=0);return F}sr.exports=L},31969:function(sr,it,$){"use strict";$.r(it),$.d(it,{BRIDGE_GRAPH_NAME:function(){return Q},GraphType:function(){return P},HierarchyNodeType:function(){return C},InclusionType:function(){return L},LAYOUT_CONFIG:function(){return X},NodeType:function(){return Z},ROOT_NAME:function(){return W},buildGraph:function(){return na},flatGraph:function(){return Xa},getEdges:function(){return Oa},mergeConfig:function(){return tt}});const X={graph:{meta:{rankDir:"TB",nodeSep:50,rankSep:50,edgeSep:5,align:void 0}},subScene:{meta:{paddingTop:20,paddingBottom:20,paddingLeft:20,paddingRight:20,labelHeight:20}},nodeSize:{meta:{width:100,maxLabelWidth:0,height:20},node:{width:80,height:20,labelOffset:10,maxLabelWidth:40},bridge:{width:5,height:5,radius:2,labelOffset:0}}};function tt(N={},q=X){var ht,It,Ft,Xt;const oe=JSON.parse(JSON.stringify(q)),he=((ht=N==null?void 0:N.graph)===null||ht===void 0?void 0:ht.meta)||{},Te=((It=N==null?void 0:N.subScene)===null||It===void 0?void 0:It.meta)||{},Ye=((Ft=N==null?void 0:N.nodeSize)===null||Ft===void 0?void 0:Ft.meta)||{},gn=((Xt=N==null?void 0:N.nodeSize)===null||Xt===void 0?void 0:Xt.node)||{},cn=oe.nodeSize.bridge;return{graph:{meta:Object.assign(oe.graph.meta,he)},subScene:{meta:Object.assign(oe.subScene.meta,Te)},nodeSize:{meta:Object.assign(oe.nodeSize.meta,Ye),node:Object.assign(oe.nodeSize.node,gn),bridge:cn}}}function j(N){return`\u25EC${N}\u25EC`}const W=j("ROOT"),Q=j("BRIDGE_GRAPH");var Z,L,P,C;(function(N){N[N.META=0]="META",N[N.NODE=1]="NODE",N[N.BRIDGE=2]="BRIDGE"})(Z||(Z={})),function(N){N[N.INCLUDE=0]="INCLUDE",N[N.EXCLUDE=1]="EXCLUDE",N[N.UNSPECIFIED=2]="UNSPECIFIED"}(L||(L={})),function(N){N[N.META=0]="META",N[N.CORE=1]="CORE",N[N.BRIDGE=2]="BRIDGE"}(P||(P={})),function(N){N[N.META=0]="META",N[N.OP=1]="OP",N[N.SERIES=2]="SERIES"}(C||(C={}));var M=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof $.g!="undefined"?$.g:typeof self!="undefined"?self:{};function k(N,q){return N(q={exports:{}},q.exports),q.exports}var B=function(){this.__data__=[],this.size=0},R=function(N,q){return N===q||N!=N&&q!=q},F=function(N,q){for(var ht=N.length;ht--;)if(R(N[ht][0],q))return ht;return-1},K=Array.prototype.splice,O=function(N){var q=this.__data__,ht=F(q,N);return!(ht<0)&&(ht==q.length-1?q.pop():K.call(q,ht,1),--this.size,!0)},_=function(N){var q=this.__data__,ht=F(q,N);return ht<0?void 0:q[ht][1]},ft=function(N){return F(this.__data__,N)>-1},mt=function(N,q){var ht=this.__data__,It=F(ht,N);return It<0?(++this.size,ht.push([N,q])):ht[It][1]=q,this};function st(N){var q=-1,ht=N==null?0:N.length;for(this.clear();++q<ht;){var It=N[q];this.set(It[0],It[1])}}st.prototype.clear=B,st.prototype.delete=O,st.prototype.get=_,st.prototype.has=ft,st.prototype.set=mt;var ut=st,dt=function(){this.__data__=new ut,this.size=0},gt=function(N){var q=this.__data__,ht=q.delete(N);return this.size=q.size,ht},wt=function(N){return this.__data__.get(N)},ot=function(N){return this.__data__.has(N)},pt=typeof M=="object"&&M&&M.Object===Object&&M,Nt=typeof self=="object"&&self&&self.Object===Object&&self,Gt=pt||Nt||Function("return this")(),se=Gt.Symbol,ie=Object.prototype,Be=ie.hasOwnProperty,ke=ie.toString,we=se?se.toStringTag:void 0,At=function(N){var q=Be.call(N,we),ht=N[we];try{N[we]=void 0;var It=!0}catch(Xt){}var Ft=ke.call(N);return It&&(q?N[we]=ht:delete N[we]),Ft},Yt=Object.prototype.toString,be=function(N){return Yt.call(N)},nn=se?se.toStringTag:void 0,Ee=function(N){return N==null?N===void 0?"[object Undefined]":"[object Null]":nn&&nn in Object(N)?At(N):be(N)},le=function(N){var q=typeof N;return N!=null&&(q=="object"||q=="function")},Le,Ze=function(N){if(!le(N))return!1;var q=Ee(N);return q=="[object Function]"||q=="[object GeneratorFunction]"||q=="[object AsyncFunction]"||q=="[object Proxy]"},fe=Gt["__core-js_shared__"],Re=(Le=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||""))?"Symbol(src)_1."+Le:"",He=function(N){return!!Re&&Re in N},pe=Function.prototype.toString,Ge=function(N){if(N!=null){try{return pe.call(N)}catch(q){}try{return N+""}catch(q){}}return""},te=/^\[object .+?Constructor\]$/,Me=Function.prototype,We=Object.prototype,ee=Me.toString,Pt=We.hasOwnProperty,yt=RegExp("^"+ee.call(Pt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ne=function(N){return!(!le(N)||He(N))&&(Ze(N)?yt:te).test(Ge(N))},tn=function(N,q){return N==null?void 0:N[q]},fn=function(N,q){var ht=tn(N,q);return Ne(ht)?ht:void 0},Rt=fn(Gt,"Map"),Yn=fn(Object,"create"),Un=function(){this.__data__=Yn?Yn(null):{},this.size=0},xr=function(N){var q=this.has(N)&&delete this.__data__[N];return this.size-=q?1:0,q},cr=Object.prototype.hasOwnProperty,Ur=function(N){var q=this.__data__;if(Yn){var ht=q[N];return ht==="__lodash_hash_undefined__"?void 0:ht}return cr.call(q,N)?q[N]:void 0},fa=Object.prototype.hasOwnProperty,Sa=function(N){var q=this.__data__;return Yn?q[N]!==void 0:fa.call(q,N)},sa=function(N,q){var ht=this.__data__;return this.size+=this.has(N)?0:1,ht[N]=Yn&&q===void 0?"__lodash_hash_undefined__":q,this};function Da(N){var q=-1,ht=N==null?0:N.length;for(this.clear();++q<ht;){var It=N[q];this.set(It[0],It[1])}}Da.prototype.clear=Un,Da.prototype.delete=xr,Da.prototype.get=Ur,Da.prototype.has=Sa,Da.prototype.set=sa;var Rr=Da,Mn=function(){this.size=0,this.__data__={hash:new Rr,map:new(Rt||ut),string:new Rr}},ar=function(N){var q=typeof N;return q=="string"||q=="number"||q=="symbol"||q=="boolean"?N!=="__proto__":N===null},Fn=function(N,q){var ht=N.__data__;return ar(q)?ht[typeof q=="string"?"string":"hash"]:ht.map},tr=function(N){var q=Fn(this,N).delete(N);return this.size-=q?1:0,q},Gn=function(N){return Fn(this,N).get(N)},jr=function(N){return Fn(this,N).has(N)},Hr=function(N,q){var ht=Fn(this,N),It=ht.size;return ht.set(N,q),this.size+=ht.size==It?0:1,this};function Ea(N){var q=-1,ht=N==null?0:N.length;for(this.clear();++q<ht;){var It=N[q];this.set(It[0],It[1])}}Ea.prototype.clear=Mn,Ea.prototype.delete=tr,Ea.prototype.get=Gn,Ea.prototype.has=jr,Ea.prototype.set=Hr;var lr=Ea,Cr=function(N,q){var ht=this.__data__;if(ht instanceof ut){var It=ht.__data__;if(!Rt||It.length<199)return It.push([N,q]),this.size=++ht.size,this;ht=this.__data__=new lr(It)}return ht.set(N,q),this.size=ht.size,this};function vr(N){var q=this.__data__=new ut(N);this.size=q.size}vr.prototype.clear=dt,vr.prototype.delete=gt,vr.prototype.get=wt,vr.prototype.has=ot,vr.prototype.set=Cr;var Tr=vr,ta=function(N,q){for(var ht=-1,It=N==null?0:N.length;++ht<It&&q(N[ht],ht,N)!==!1;);return N},ra=function(){try{var N=fn(Object,"defineProperty");return N({},"",{}),N}catch(q){}}(),Zr=function(N,q,ht){q=="__proto__"&&ra?ra(N,q,{configurable:!0,enumerable:!0,value:ht,writable:!0}):N[q]=ht},vt=Object.prototype.hasOwnProperty,_n=function(N,q,ht){var It=N[q];vt.call(N,q)&&R(It,ht)&&(ht!==void 0||q in N)||Zr(N,q,ht)},an=function(N,q,ht,It){var Ft=!ht;ht||(ht={});for(var Xt=-1,oe=q.length;++Xt<oe;){var he=q[Xt],Te=It?It(ht[he],N[he],he,ht,N):void 0;Te===void 0&&(Te=N[he]),Ft?Zr(ht,he,Te):_n(ht,he,Te)}return ht},Lt=function(N,q){for(var ht=-1,It=Array(N);++ht<N;)It[ht]=q(ht);return It},kt=function(N){return N!=null&&typeof N=="object"},at=function(N){return kt(N)&&Ee(N)=="[object Arguments]"},H=Object.prototype,Y=H.hasOwnProperty,bt=H.propertyIsEnumerable,$t=at(function(){return arguments}())?at:function(N){return kt(N)&&Y.call(N,"callee")&&!bt.call(N,"callee")},jt=Array.isArray,Ht=function(){return!1},re=k(function(N,q){var ht=q&&!q.nodeType&&q,It=ht&&N&&!N.nodeType&&N,Ft=It&&It.exports===ht?Gt.Buffer:void 0,Xt=(Ft?Ft.isBuffer:void 0)||Ht;N.exports=Xt}),on=/^(?:0|[1-9]\d*)$/,Je=function(N,q){var ht=typeof N;return!!(q=q==null?9007199254740991:q)&&(ht=="number"||ht!="symbol"&&on.test(N))&&N>-1&&N%1==0&&N<q},Ve=function(N){return typeof N=="number"&&N>-1&&N%1==0&&N<=9007199254740991},qn={};qn["[object Float32Array]"]=qn["[object Float64Array]"]=qn["[object Int8Array]"]=qn["[object Int16Array]"]=qn["[object Int32Array]"]=qn["[object Uint8Array]"]=qn["[object Uint8ClampedArray]"]=qn["[object Uint16Array]"]=qn["[object Uint32Array]"]=!0,qn["[object Arguments]"]=qn["[object Array]"]=qn["[object ArrayBuffer]"]=qn["[object Boolean]"]=qn["[object DataView]"]=qn["[object Date]"]=qn["[object Error]"]=qn["[object Function]"]=qn["[object Map]"]=qn["[object Number]"]=qn["[object Object]"]=qn["[object RegExp]"]=qn["[object Set]"]=qn["[object String]"]=qn["[object WeakMap]"]=!1;var Ln=function(N){return kt(N)&&Ve(N.length)&&!!qn[Ee(N)]},qr=function(N){return function(q){return N(q)}},Ca=k(function(N,q){var ht=q&&!q.nodeType&&q,It=ht&&N&&!N.nodeType&&N,Ft=It&&It.exports===ht&&pt.process,Xt=function(){try{var oe=It&&It.require&&It.require("util").types;return oe||Ft&&Ft.binding&&Ft.binding("util")}catch(he){}}();N.exports=Xt}),Qn=Ca&&Ca.isTypedArray,_r=Qn?qr(Qn):Ln,ea=Object.prototype.hasOwnProperty,La=function(N,q){var ht=jt(N),It=!ht&&$t(N),Ft=!ht&&!It&&re(N),Xt=!ht&&!It&&!Ft&&_r(N),oe=ht||It||Ft||Xt,he=oe?Lt(N.length,String):[],Te=he.length;for(var Ye in N)!q&&!ea.call(N,Ye)||oe&&(Ye=="length"||Ft&&(Ye=="offset"||Ye=="parent")||Xt&&(Ye=="buffer"||Ye=="byteLength"||Ye=="byteOffset")||Je(Ye,Te))||he.push(Ye);return he},ha=Object.prototype,_i=function(N){var q=N&&N.constructor;return N===(typeof q=="function"&&q.prototype||ha)},Ni=function(N,q){return function(ht){return N(q(ht))}},vi=Ni(Object.keys,Object),si=Object.prototype.hasOwnProperty,Mi=function(N){if(!_i(N))return vi(N);var q=[];for(var ht in Object(N))si.call(N,ht)&&ht!="constructor"&&q.push(ht);return q},Pa=function(N){return N!=null&&Ve(N.length)&&!Ze(N)},un=function(N){return Pa(N)?La(N):Mi(N)},Oe=function(N,q){return N&&an(q,un(q),N)},hn=function(N){var q=[];if(N!=null)for(var ht in Object(N))q.push(ht);return q},Hn=Object.prototype.hasOwnProperty,Bn=function(N){if(!le(N))return hn(N);var q=_i(N),ht=[];for(var It in N)(It!="constructor"||!q&&Hn.call(N,It))&&ht.push(It);return ht},Jn=function(N){return Pa(N)?La(N,!0):Bn(N)},Lr=function(N,q){return N&&an(q,Jn(q),N)},ya=k(function(N,q){var ht=q&&!q.nodeType&&q,It=ht&&N&&!N.nodeType&&N,Ft=It&&It.exports===ht?Gt.Buffer:void 0,Xt=Ft?Ft.allocUnsafe:void 0;N.exports=function(oe,he){if(he)return oe.slice();var Te=oe.length,Ye=Xt?Xt(Te):new oe.constructor(Te);return oe.copy(Ye),Ye}}),Fa=function(N,q){var ht=-1,It=N.length;for(q||(q=Array(It));++ht<It;)q[ht]=N[ht];return q},ui=function(N,q){for(var ht=-1,It=N==null?0:N.length,Ft=0,Xt=[];++ht<It;){var oe=N[ht];q(oe,ht,N)&&(Xt[Ft++]=oe)}return Xt},Ei=function(){return[]},oo=Object.prototype.propertyIsEnumerable,po=Object.getOwnPropertySymbols,bo=po?function(N){return N==null?[]:(N=Object(N),ui(po(N),function(q){return oo.call(N,q)}))}:Ei,ts=function(N,q){return an(N,bo(N),q)},Wo=function(N,q){for(var ht=-1,It=q.length,Ft=N.length;++ht<It;)N[Ft+ht]=q[ht];return N},Yi=Ni(Object.getPrototypeOf,Object),wi=Object.getOwnPropertySymbols?function(N){for(var q=[];N;)Wo(q,bo(N)),N=Yi(N);return q}:Ei,gi=function(N,q){return an(N,wi(N),q)},us=function(N,q,ht){var It=q(N);return jt(N)?It:Wo(It,ht(N))},Do=function(N){return us(N,un,bo)},Io=function(N){return us(N,Jn,wi)},zs=fn(Gt,"DataView"),mu=fn(Gt,"Promise"),ds=fn(Gt,"Set"),Ms=fn(Gt,"WeakMap"),yu=Ge(zs),uu=Ge(Rt),Cs=Ge(mu),qo=Ge(ds),Wi=Ge(Ms),ls=Ee;(zs&&ls(new zs(new ArrayBuffer(1)))!="[object DataView]"||Rt&&ls(new Rt)!="[object Map]"||mu&&ls(mu.resolve())!="[object Promise]"||ds&&ls(new ds)!="[object Set]"||Ms&&ls(new Ms)!="[object WeakMap]")&&(ls=function(N){var q=Ee(N),ht=q=="[object Object]"?N.constructor:void 0,It=ht?Ge(ht):"";if(It)switch(It){case yu:return"[object DataView]";case uu:return"[object Map]";case Cs:return"[object Promise]";case qo:return"[object Set]";case Wi:return"[object WeakMap]"}return q});var is=ls,Es=Object.prototype.hasOwnProperty,tl=function(N){var q=N.length,ht=new N.constructor(q);return q&&typeof N[0]=="string"&&Es.call(N,"index")&&(ht.index=N.index,ht.input=N.input),ht},bu=Gt.Uint8Array,Ys=function(N){var q=new N.constructor(N.byteLength);return new bu(q).set(new bu(N)),q},ka=function(N,q){var ht=q?Ys(N.buffer):N.buffer;return new N.constructor(ht,N.byteOffset,N.byteLength)},Ku=/\w*$/,Vs=function(N){var q=new N.constructor(N.source,Ku.exec(N));return q.lastIndex=N.lastIndex,q},Ro=se?se.prototype:void 0,Ns=Ro?Ro.valueOf:void 0,tu=function(N){return Ns?Object(Ns.call(N)):{}},eu=function(N,q){var ht=q?Ys(N.buffer):N.buffer;return new N.constructor(ht,N.byteOffset,N.length)},Zu=function(N,q,ht){var It=N.constructor;switch(q){case"[object ArrayBuffer]":return Ys(N);case"[object Boolean]":case"[object Date]":return new It(+N);case"[object DataView]":return ka(N,ht);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return eu(N,ht);case"[object Map]":return new It;case"[object Number]":case"[object String]":return new It(N);case"[object RegExp]":return Vs(N);case"[object Set]":return new It;case"[object Symbol]":return tu(N)}},bn=Object.create,Xr=function(){function N(){}return function(q){if(!le(q))return{};if(bn)return bn(q);N.prototype=q;var ht=new N;return N.prototype=void 0,ht}}(),pa=function(N){return typeof N.constructor!="function"||_i(N)?{}:Xr(Yi(N))},Ra=function(N){return kt(N)&&is(N)=="[object Map]"},Qi=Ca&&Ca.isMap,Co=Qi?qr(Qi):Ra,to=function(N){return kt(N)&&is(N)=="[object Set]"},xo=Ca&&Ca.isSet,gs=xo?qr(xo):to,vo={};vo["[object Arguments]"]=vo["[object Array]"]=vo["[object ArrayBuffer]"]=vo["[object DataView]"]=vo["[object Boolean]"]=vo["[object Date]"]=vo["[object Float32Array]"]=vo["[object Float64Array]"]=vo["[object Int8Array]"]=vo["[object Int16Array]"]=vo["[object Int32Array]"]=vo["[object Map]"]=vo["[object Number]"]=vo["[object Object]"]=vo["[object RegExp]"]=vo["[object Set]"]=vo["[object String]"]=vo["[object Symbol]"]=vo["[object Uint8Array]"]=vo["[object Uint8ClampedArray]"]=vo["[object Uint16Array]"]=vo["[object Uint32Array]"]=!0,vo["[object Error]"]=vo["[object Function]"]=vo["[object WeakMap]"]=!1;var ou=function N(q,ht,It,Ft,Xt,oe){var he,Te=1&ht,Ye=2&ht,gn=4&ht;if(It&&(he=Xt?It(q,Ft,Xt,oe):It(q)),he!==void 0)return he;if(!le(q))return q;var cn=jt(q);if(cn){if(he=tl(q),!Te)return Fa(q,he)}else{var Vn=is(q),An=Vn=="[object Function]"||Vn=="[object GeneratorFunction]";if(re(q))return ya(q,Te);if(Vn=="[object Object]"||Vn=="[object Arguments]"||An&&!Xt){if(he=Ye||An?{}:pa(q),!Te)return Ye?gi(q,Lr(he,q)):ts(q,Oe(he,q))}else{if(!vo[Vn])return Xt?q:{};he=Zu(q,Vn,Te)}}oe||(oe=new Tr);var ma=oe.get(q);if(ma)return ma;oe.set(q,he),gs(q)?q.forEach(function(Fr){he.add(N(Fr,ht,It,Fr,q,oe))}):Co(q)&&q.forEach(function(Fr,rr){he.set(rr,N(Fr,ht,It,rr,q,oe))});var Or=cn?void 0:(gn?Ye?Io:Do:Ye?Jn:un)(q);return ta(Or||q,function(Fr,rr){Or&&(Fr=q[rr=Fr]),_n(he,rr,N(Fr,ht,It,rr,q,oe))}),he},ms=function(N){return ou(N,4)},xu=function(N){return function(){return N}},dl=function(N){return function(q,ht,It){for(var Ft=-1,Xt=Object(q),oe=It(q),he=oe.length;he--;){var Te=oe[N?he:++Ft];if(ht(Xt[Te],Te,Xt)===!1)break}return q}}(),kl=function(N,q){return N&&dl(N,q,un)},Ks=function(N,q){return function(ht,It){if(ht==null)return ht;if(!Pa(ht))return N(ht,It);for(var Ft=ht.length,Xt=q?Ft:-1,oe=Object(ht);(q?Xt--:++Xt<Ft)&&It(oe[Xt],Xt,oe)!==!1;);return ht}}(kl),el=function(N){return N},lu=function(N){return typeof N=="function"?N:el},Du=function(N,q){return(jt(N)?ta:Ks)(N,lu(q))},pl=Du,ns=function(N,q){var ht=[];return Ks(N,function(It,Ft,Xt){q(It,Ft,Xt)&&ht.push(It)}),ht},_s=function(N){return this.__data__.set(N,"__lodash_hash_undefined__"),this},Bu=function(N){return this.__data__.has(N)};function Au(N){var q=-1,ht=N==null?0:N.length;for(this.__data__=new lr;++q<ht;)this.add(N[q])}Au.prototype.add=Au.prototype.push=_s,Au.prototype.has=Bu;var wu=Au,nu=function(N,q){for(var ht=-1,It=N==null?0:N.length;++ht<It;)if(q(N[ht],ht,N))return!0;return!1},Tl=function(N,q){return N.has(q)},xc=function(N,q,ht,It,Ft,Xt){var oe=1&ht,he=N.length,Te=q.length;if(he!=Te&&!(oe&&Te>he))return!1;var Ye=Xt.get(N),gn=Xt.get(q);if(Ye&&gn)return Ye==q&&gn==N;var cn=-1,Vn=!0,An=2&ht?new wu:void 0;for(Xt.set(N,q),Xt.set(q,N);++cn<he;){var ma=N[cn],Or=q[cn];if(It)var Fr=oe?It(Or,ma,cn,q,N,Xt):It(ma,Or,cn,N,q,Xt);if(Fr!==void 0){if(Fr)continue;Vn=!1;break}if(An){if(!nu(q,function(rr,Za){if(!Tl(An,Za)&&(ma===rr||Ft(ma,rr,ht,It,Xt)))return An.push(Za)})){Vn=!1;break}}else if(ma!==Or&&!Ft(ma,Or,ht,It,Xt)){Vn=!1;break}}return Xt.delete(N),Xt.delete(q),Vn},Sl=function(N){var q=-1,ht=Array(N.size);return N.forEach(function(It,Ft){ht[++q]=[Ft,It]}),ht},ol=function(N){var q=-1,ht=Array(N.size);return N.forEach(function(It){ht[++q]=It}),ht},ys=se?se.prototype:void 0,vl=ys?ys.valueOf:void 0,kc=function(N,q,ht,It,Ft,Xt,oe){switch(ht){case"[object DataView]":if(N.byteLength!=q.byteLength||N.byteOffset!=q.byteOffset)return!1;N=N.buffer,q=q.buffer;case"[object ArrayBuffer]":return!(N.byteLength!=q.byteLength||!Xt(new bu(N),new bu(q)));case"[object Boolean]":case"[object Date]":case"[object Number]":return R(+N,+q);case"[object Error]":return N.name==q.name&&N.message==q.message;case"[object RegExp]":case"[object String]":return N==q+"";case"[object Map]":var he=Sl;case"[object Set]":var Te=1&It;if(he||(he=ol),N.size!=q.size&&!Te)return!1;var Ye=oe.get(N);if(Ye)return Ye==q;It|=2,oe.set(N,q);var gn=xc(he(N),he(q),It,Ft,Xt,oe);return oe.delete(N),gn;case"[object Symbol]":if(vl)return vl.call(N)==vl.call(q)}return!1},Dl=Object.prototype.hasOwnProperty,Ol=function(N,q,ht,It,Ft,Xt){var oe=1&ht,he=Do(N),Te=he.length;if(Te!=Do(q).length&&!oe)return!1;for(var Ye=Te;Ye--;){var gn=he[Ye];if(!(oe?gn in q:Dl.call(q,gn)))return!1}var cn=Xt.get(N),Vn=Xt.get(q);if(cn&&Vn)return cn==q&&Vn==N;var An=!0;Xt.set(N,q),Xt.set(q,N);for(var ma=oe;++Ye<Te;){var Or=N[gn=he[Ye]],Fr=q[gn];if(It)var rr=oe?It(Fr,Or,gn,q,N,Xt):It(Or,Fr,gn,N,q,Xt);if(!(rr===void 0?Or===Fr||Ft(Or,Fr,ht,It,Xt):rr)){An=!1;break}ma||(ma=gn=="constructor")}if(An&&!ma){var Za=N.constructor,Xn=q.constructor;Za==Xn||!("constructor"in N)||!("constructor"in q)||typeof Za=="function"&&Za instanceof Za&&typeof Xn=="function"&&Xn instanceof Xn||(An=!1)}return Xt.delete(N),Xt.delete(q),An},_e=Object.prototype.hasOwnProperty,ve=function(N,q,ht,It,Ft,Xt){var oe=jt(N),he=jt(q),Te=oe?"[object Array]":is(N),Ye=he?"[object Array]":is(q),gn=(Te=Te=="[object Arguments]"?"[object Object]":Te)=="[object Object]",cn=(Ye=Ye=="[object Arguments]"?"[object Object]":Ye)=="[object Object]",Vn=Te==Ye;if(Vn&&re(N)){if(!re(q))return!1;oe=!0,gn=!1}if(Vn&&!gn)return Xt||(Xt=new Tr),oe||_r(N)?xc(N,q,ht,It,Ft,Xt):kc(N,q,Te,ht,It,Ft,Xt);if(!(1&ht)){var An=gn&&_e.call(N,"__wrapped__"),ma=cn&&_e.call(q,"__wrapped__");if(An||ma){var Or=An?N.value():N,Fr=ma?q.value():q;return Xt||(Xt=new Tr),Ft(Or,Fr,ht,It,Xt)}}return!!Vn&&(Xt||(Xt=new Tr),Ol(N,q,ht,It,Ft,Xt))},Bt=function N(q,ht,It,Ft,Xt){return q===ht||(q==null||ht==null||!kt(q)&&!kt(ht)?q!=q&&ht!=ht:ve(q,ht,It,Ft,N,Xt))},ae=function(N,q,ht,It){var Ft=ht.length,Xt=Ft,oe=!It;if(N==null)return!Xt;for(N=Object(N);Ft--;){var he=ht[Ft];if(oe&&he[2]?he[1]!==N[he[0]]:!(he[0]in N))return!1}for(;++Ft<Xt;){var Te=(he=ht[Ft])[0],Ye=N[Te],gn=he[1];if(oe&&he[2]){if(Ye===void 0&&!(Te in N))return!1}else{var cn=new Tr;if(It)var Vn=It(Ye,gn,Te,N,q,cn);if(!(Vn===void 0?Bt(gn,Ye,3,It,cn):Vn))return!1}}return!0},me=function(N){return N==N&&!le(N)},En=function(N){for(var q=un(N),ht=q.length;ht--;){var It=q[ht],Ft=N[It];q[ht]=[It,Ft,me(Ft)]}return q},Zn=function(N,q){return function(ht){return ht!=null&&ht[N]===q&&(q!==void 0||N in Object(ht))}},Kt=function(N){var q=En(N);return q.length==1&&q[0][2]?Zn(q[0][0],q[0][1]):function(ht){return ht===N||ae(ht,N,q)}},ge=function(N){return typeof N=="symbol"||kt(N)&&Ee(N)=="[object Symbol]"},Ae=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,sn=/^\w*$/,xn=function(N,q){if(jt(N))return!1;var ht=typeof N;return!(ht!="number"&&ht!="symbol"&&ht!="boolean"&&N!=null&&!ge(N))||sn.test(N)||!Ae.test(N)||q!=null&&N in Object(q)};function ir(N,q){if(typeof N!="function"||q!=null&&typeof q!="function")throw new TypeError("Expected a function");var ht=function(){var It=arguments,Ft=q?q.apply(this,It):It[0],Xt=ht.cache;if(Xt.has(Ft))return Xt.get(Ft);var oe=N.apply(this,It);return ht.cache=Xt.set(Ft,oe)||Xt,oe};return ht.cache=new(ir.Cache||lr),ht}ir.Cache=lr;var $r=ir,Aa=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Va=/\\(\\)?/g,Ba=function(N){var q=$r(N,function(It){return ht.size===500&&ht.clear(),It}),ht=q.cache;return q}(function(N){var q=[];return N.charCodeAt(0)===46&&q.push(""),N.replace(Aa,function(ht,It,Ft,Xt){q.push(Ft?Xt.replace(Va,"$1"):It||ht)}),q}),oi=function(N,q){for(var ht=-1,It=N==null?0:N.length,Ft=Array(It);++ht<It;)Ft[ht]=q(N[ht],ht,N);return Ft},ro=se?se.prototype:void 0,Di=ro?ro.toString:void 0,Si=function N(q){if(typeof q=="string")return q;if(jt(q))return oi(q,N)+"";if(ge(q))return Di?Di.call(q):"";var ht=q+"";return ht=="0"&&1/q==-Infinity?"-0":ht},_o=function(N){return N==null?"":Si(N)},To=function(N,q){return jt(N)?N:xn(N,q)?[N]:Ba(_o(N))},wo=function(N){if(typeof N=="string"||ge(N))return N;var q=N+"";return q=="0"&&1/N==-Infinity?"-0":q},Vo=function(N,q){for(var ht=0,It=(q=To(q,N)).length;N!=null&&ht<It;)N=N[wo(q[ht++])];return ht&&ht==It?N:void 0},js=function(N,q,ht){var It=N==null?void 0:Vo(N,q);return It===void 0?ht:It},ws=function(N,q){return N!=null&&q in Object(N)},ks=function(N,q,ht){for(var It=-1,Ft=(q=To(q,N)).length,Xt=!1;++It<Ft;){var oe=wo(q[It]);if(!(Xt=N!=null&&ht(N,oe)))break;N=N[oe]}return Xt||++It!=Ft?Xt:!!(Ft=N==null?0:N.length)&&Ve(Ft)&&Je(oe,Ft)&&(jt(N)||$t(N))},Hs=function(N,q){return N!=null&&ks(N,q,ws)},Mu=function(N,q){return xn(N)&&me(q)?Zn(wo(N),q):function(ht){var It=js(ht,N);return It===void 0&&It===q?Hs(ht,N):Bt(q,It,3)}},nl=function(N){return function(q){return q==null?void 0:q[N]}},Cl=function(N){return function(q){return Vo(q,N)}},Yl=function(N){return xn(N)?nl(wo(N)):Cl(N)},sl=function(N){return typeof N=="function"?N:N==null?el:typeof N=="object"?jt(N)?Mu(N[0],N[1]):Kt(N):Yl(N)},rl=function(N,q){return(jt(N)?ui:ns)(N,sl(q))},_f=Object.prototype.hasOwnProperty,Dc=function(N,q){return N!=null&&_f.call(N,q)},wc=function(N,q){return N!=null&&ks(N,q,Dc)},ef=Object.prototype.hasOwnProperty,A=function(N){if(N==null)return!0;if(Pa(N)&&(jt(N)||typeof N=="string"||typeof N.splice=="function"||re(N)||_r(N)||$t(N)))return!N.length;var q=is(N);if(q=="[object Map]"||q=="[object Set]")return!N.size;if(_i(N))return!Mi(N).length;for(var ht in N)if(ef.call(N,ht))return!1;return!0},nt=function(N){return N===void 0},Zt=function(N,q){var ht=-1,It=Pa(N)?Array(N.length):[];return Ks(N,function(Ft,Xt,oe){It[++ht]=q(Ft,Xt,oe)}),It},de=function(N,q){return(jt(N)?oi:Zt)(N,sl(q))},Pe=function(N,q,ht,It){var Ft=-1,Xt=N==null?0:N.length;for(It&&Xt&&(ht=N[++Ft]);++Ft<Xt;)ht=q(ht,N[Ft],Ft,N);return ht},Qe=function(N,q,ht,It,Ft){return Ft(N,function(Xt,oe,he){ht=It?(It=!1,Xt):q(ht,Xt,oe,he)}),ht},rn=function(N,q,ht){var It=jt(N)?Pe:Qe,Ft=arguments.length<3;return It(N,sl(q),ht,Ft,Ks)},wn=function(N){return typeof N=="string"||!jt(N)&&kt(N)&&Ee(N)=="[object String]"},kn=nl("length"),De=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),wr=function(N){return De.test(N)},ca="[\\ud800-\\udfff]",Ar="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ua="\\ud83c[\\udffb-\\udfff]",$a="[^\\ud800-\\udfff]",ri="(?:\\ud83c[\\udde6-\\uddff]){2}",ba="[\\ud800-\\udbff][\\udc00-\\udfff]",ki="(?:"+Ar+"|"+ua+")?",Eo="[\\ufe0e\\ufe0f]?"+ki+("(?:\\u200d(?:"+[$a,ri,ba].join("|")+")[\\ufe0e\\ufe0f]?"+ki+")*"),Lo="(?:"+[$a+Ar+"?",Ar,ri,ba,ca].join("|")+")",Bo=RegExp(ua+"(?="+ua+")|"+Lo+Eo,"g"),go=function(N){for(var q=Bo.lastIndex=0;Bo.test(N);)++q;return q},Ao=function(N){return wr(N)?go(N):kn(N)},qu=function(N){if(N==null)return 0;if(Pa(N))return wn(N)?Ao(N):N.length;var q=is(N);return q=="[object Map]"||q=="[object Set]"?N.size:Mi(N).length},zu=function(N,q,ht){var It=jt(N),Ft=It||re(N)||_r(N);if(q=sl(q),ht==null){var Xt=N&&N.constructor;ht=Ft?It?new Xt:[]:le(N)&&Ze(Xt)?Xr(Yi(N)):{}}return(Ft?ta:kl)(N,function(oe,he,Te){return q(ht,oe,he,Te)}),ht},Uu=se?se.isConcatSpreadable:void 0,Qu=function(N){return jt(N)||$t(N)||!!(Uu&&N&&N[Uu])},Wu=function N(q,ht,It,Ft,Xt){var oe=-1,he=q.length;for(It||(It=Qu),Xt||(Xt=[]);++oe<he;){var Te=q[oe];ht>0&&It(Te)?ht>1?N(Te,ht-1,It,Ft,Xt):Wo(Xt,Te):Ft||(Xt[Xt.length]=Te)}return Xt},al=function(N,q,ht){switch(ht.length){case 0:return N.call(q);case 1:return N.call(q,ht[0]);case 2:return N.call(q,ht[0],ht[1]);case 3:return N.call(q,ht[0],ht[1],ht[2])}return N.apply(q,ht)},Vu=Math.max,ps=function(N,q,ht){return q=Vu(q===void 0?N.length-1:q,0),function(){for(var It=arguments,Ft=-1,Xt=Vu(It.length-q,0),oe=Array(Xt);++Ft<Xt;)oe[Ft]=It[q+Ft];Ft=-1;for(var he=Array(q+1);++Ft<q;)he[Ft]=It[Ft];return he[q]=ht(oe),al(N,this,he)}},ru=ra?function(N,q){return ra(N,"toString",{configurable:!0,enumerable:!1,value:xu(q),writable:!0})}:el,pf=Date.now,Ec=function(N){var q=0,ht=0;return function(){var It=pf(),Ft=16-(It-ht);if(ht=It,Ft>0){if(++q>=800)return arguments[0]}else q=0;return N.apply(void 0,arguments)}}(ru),Ou=function(N,q){return Ec(ps(N,q,el),N+"")},Uc=function(N,q,ht,It){for(var Ft=N.length,Xt=ht+(It?1:-1);It?Xt--:++Xt<Ft;)if(q(N[Xt],Xt,N))return Xt;return-1},Wh=function(N){return N!=N},pp=function(N,q,ht){for(var It=ht-1,Ft=N.length;++It<Ft;)if(N[It]===q)return It;return-1},$p=function(N,q,ht){return q==q?pp(N,q,ht):Uc(N,Wh,ht)},sd=function(N,q){return!!(N==null?0:N.length)&&$p(N,q,0)>-1},kd=function(N,q,ht){for(var It=-1,Ft=N==null?0:N.length;++It<Ft;)if(ht(q,N[It]))return!0;return!1},vp=function(){},$f=ds&&1/ol(new ds([,-0]))[1]==1/0?function(N){return new ds(N)}:vp,If=function(N,q,ht){var It=-1,Ft=sd,Xt=N.length,oe=!0,he=[],Te=he;if(ht)oe=!1,Ft=kd;else if(Xt>=200){var Ye=q?null:$f(N);if(Ye)return ol(Ye);oe=!1,Ft=Tl,Te=new wu}else Te=q?[]:he;t:for(;++It<Xt;){var gn=N[It],cn=q?q(gn):gn;if(gn=ht||gn!==0?gn:0,oe&&cn==cn){for(var Vn=Te.length;Vn--;)if(Te[Vn]===cn)continue t;q&&Te.push(cn),he.push(gn)}else Ft(Te,cn,ht)||(Te!==he&&Te.push(cn),he.push(gn))}return he},Dd=function(N){return kt(N)&&Pa(N)},eh=Ou(function(N){return If(Wu(N,1,Dd,!0))}),Gp=function(N,q){return oi(q,function(ht){return N[ht]})},Oc,vh=function(N){return N==null?[]:Gp(N,un(N))};try{Oc={clone:ms,constant:xu,each:pl,filter:rl,has:wc,isArray:jt,isEmpty:A,isFunction:Ze,isUndefined:nt,keys:un,map:de,reduce:rn,size:qu,transform:zu,union:eh,values:vh}}catch(N){}Oc||(Oc=window._);var Pi=Oc,gh=cs;function cs(N){this._isDirected=!Pi.has(N,"directed")||N.directed,this._isMultigraph=!!Pi.has(N,"multigraph")&&N.multigraph,this._isCompound=!!Pi.has(N,"compound")&&N.compound,this._label=void 0,this._defaultNodeLabelFn=Pi.constant(void 0),this._defaultEdgeLabelFn=Pi.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function Wc(N,q){N[q]?N[q]++:N[q]=1}function Gf(N,q){--N[q]||delete N[q]}function nf(N,q,ht,It){var Ft=""+q,Xt=""+ht;if(!N&&Ft>Xt){var oe=Ft;Ft=Xt,Xt=oe}return Ft+""+Xt+""+(Pi.isUndefined(It)?"\0":It)}function rf(N,q,ht,It){var Ft=""+q,Xt=""+ht;if(!N&&Ft>Xt){var oe=Ft;Ft=Xt,Xt=oe}var he={v:Ft,w:Xt};return It&&(he.name=It),he}function Od(N,q){return nf(N,q.v,q.w,q.name)}cs.prototype._nodeCount=0,cs.prototype._edgeCount=0,cs.prototype.isDirected=function(){return this._isDirected},cs.prototype.isMultigraph=function(){return this._isMultigraph},cs.prototype.isCompound=function(){return this._isCompound},cs.prototype.setGraph=function(N){return this._label=N,this},cs.prototype.graph=function(){return this._label},cs.prototype.setDefaultNodeLabel=function(N){return Pi.isFunction(N)||(N=Pi.constant(N)),this._defaultNodeLabelFn=N,this},cs.prototype.nodeCount=function(){return this._nodeCount},cs.prototype.nodes=function(){return Pi.keys(this._nodes)},cs.prototype.sources=function(){var N=this;return Pi.filter(this.nodes(),function(q){return Pi.isEmpty(N._in[q])})},cs.prototype.sinks=function(){var N=this;return Pi.filter(this.nodes(),function(q){return Pi.isEmpty(N._out[q])})},cs.prototype.setNodes=function(N,q){var ht=arguments,It=this;return Pi.each(N,function(Ft){ht.length>1?It.setNode(Ft,q):It.setNode(Ft)}),this},cs.prototype.setNode=function(N,q){return Pi.has(this._nodes,N)?(arguments.length>1&&(this._nodes[N]=q),this):(this._nodes[N]=arguments.length>1?q:this._defaultNodeLabelFn(N),this._isCompound&&(this._parent[N]="\0",this._children[N]={},this._children["\0"][N]=!0),this._in[N]={},this._preds[N]={},this._out[N]={},this._sucs[N]={},++this._nodeCount,this)},cs.prototype.node=function(N){return this._nodes[N]},cs.prototype.hasNode=function(N){return Pi.has(this._nodes,N)},cs.prototype.removeNode=function(N){var q=this;if(Pi.has(this._nodes,N)){var ht=function(It){q.removeEdge(q._edgeObjs[It])};delete this._nodes[N],this._isCompound&&(this._removeFromParentsChildList(N),delete this._parent[N],Pi.each(this.children(N),function(It){q.setParent(It)}),delete this._children[N]),Pi.each(Pi.keys(this._in[N]),ht),delete this._in[N],delete this._preds[N],Pi.each(Pi.keys(this._out[N]),ht),delete this._out[N],delete this._sucs[N],--this._nodeCount}return this},cs.prototype.setParent=function(N,q){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(Pi.isUndefined(q))q="\0";else{for(var ht=q+="";!Pi.isUndefined(ht);ht=this.parent(ht))if(ht===N)throw new Error("Setting "+q+" as parent of "+N+" would create a cycle");this.setNode(q)}return this.setNode(N),this._removeFromParentsChildList(N),this._parent[N]=q,this._children[q][N]=!0,this},cs.prototype._removeFromParentsChildList=function(N){delete this._children[this._parent[N]][N]},cs.prototype.parent=function(N){if(this._isCompound){var q=this._parent[N];if(q!=="\0")return q}},cs.prototype.children=function(N){if(Pi.isUndefined(N)&&(N="\0"),this._isCompound){var q=this._children[N];if(q)return Pi.keys(q)}else{if(N==="\0")return this.nodes();if(this.hasNode(N))return[]}},cs.prototype.predecessors=function(N){var q=this._preds[N];if(q)return Pi.keys(q)},cs.prototype.successors=function(N){var q=this._sucs[N];if(q)return Pi.keys(q)},cs.prototype.neighbors=function(N){var q=this.predecessors(N);if(q)return Pi.union(q,this.successors(N))},cs.prototype.isLeaf=function(N){return(this.isDirected()?this.successors(N):this.neighbors(N)).length===0},cs.prototype.filterNodes=function(N){var q=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});q.setGraph(this.graph());var ht=this;Pi.each(this._nodes,function(Xt,oe){N(oe)&&q.setNode(oe,Xt)}),Pi.each(this._edgeObjs,function(Xt){q.hasNode(Xt.v)&&q.hasNode(Xt.w)&&q.setEdge(Xt,ht.edge(Xt))});var It={};function Ft(Xt){var oe=ht.parent(Xt);return oe===void 0||q.hasNode(oe)?(It[Xt]=oe,oe):oe in It?It[oe]:Ft(oe)}return this._isCompound&&Pi.each(q.nodes(),function(Xt){q.setParent(Xt,Ft(Xt))}),q},cs.prototype.setDefaultEdgeLabel=function(N){return Pi.isFunction(N)||(N=Pi.constant(N)),this._defaultEdgeLabelFn=N,this},cs.prototype.edgeCount=function(){return this._edgeCount},cs.prototype.edges=function(){return Pi.values(this._edgeObjs)},cs.prototype.setPath=function(N,q){var ht=this,It=arguments;return Pi.reduce(N,function(Ft,Xt){return It.length>1?ht.setEdge(Ft,Xt,q):ht.setEdge(Ft,Xt),Xt}),this},cs.prototype.setEdge=function(){var N,q,ht,It,Ft=!1,Xt=arguments[0];typeof Xt=="object"&&Xt!==null&&"v"in Xt?(N=Xt.v,q=Xt.w,ht=Xt.name,arguments.length===2&&(It=arguments[1],Ft=!0)):(N=Xt,q=arguments[1],ht=arguments[3],arguments.length>2&&(It=arguments[2],Ft=!0)),N=""+N,q=""+q,Pi.isUndefined(ht)||(ht=""+ht);var oe=nf(this._isDirected,N,q,ht);if(Pi.has(this._edgeLabels,oe))return Ft&&(this._edgeLabels[oe]=It),this;if(!Pi.isUndefined(ht)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(N),this.setNode(q),this._edgeLabels[oe]=Ft?It:this._defaultEdgeLabelFn(N,q,ht);var he=rf(this._isDirected,N,q,ht);return N=he.v,q=he.w,Object.freeze(he),this._edgeObjs[oe]=he,Wc(this._preds[q],N),Wc(this._sucs[N],q),this._in[q][oe]=he,this._out[N][oe]=he,this._edgeCount++,this},cs.prototype.edge=function(N,q,ht){var It=arguments.length===1?Od(this._isDirected,arguments[0]):nf(this._isDirected,N,q,ht);return this._edgeLabels[It]},cs.prototype.hasEdge=function(N,q,ht){var It=arguments.length===1?Od(this._isDirected,arguments[0]):nf(this._isDirected,N,q,ht);return Pi.has(this._edgeLabels,It)},cs.prototype.removeEdge=function(N,q,ht){var It=arguments.length===1?Od(this._isDirected,arguments[0]):nf(this._isDirected,N,q,ht),Ft=this._edgeObjs[It];return Ft&&(N=Ft.v,q=Ft.w,delete this._edgeLabels[It],delete this._edgeObjs[It],Gf(this._preds[q],N),Gf(this._sucs[N],q),delete this._in[q][It],delete this._out[N][It],this._edgeCount--),this},cs.prototype.inEdges=function(N,q){var ht=this._in[N];if(ht){var It=Pi.values(ht);return q?Pi.filter(It,function(Ft){return Ft.v===q}):It}},cs.prototype.outEdges=function(N,q){var ht=this._out[N];if(ht){var It=Pi.values(ht);return q?Pi.filter(It,function(Ft){return Ft.w===q}):It}},cs.prototype.nodeEdges=function(N,q){var ht=this.inEdges(N,q);if(ht)return ht.concat(this.outEdges(N,q))};var Nu={Graph:gh,version:"2.1.8"},ic={write:function(N){var q={options:{directed:N.isDirected(),multigraph:N.isMultigraph(),compound:N.isCompound()},nodes:mh(N),edges:oc(N)};return Pi.isUndefined(N.graph())||(q.value=Pi.clone(N.graph())),q},read:function(N){var q=new gh(N.options).setGraph(N.value);return Pi.each(N.nodes,function(ht){q.setNode(ht.v,ht.value),ht.parent&&q.setParent(ht.v,ht.parent)}),Pi.each(N.edges,function(ht){q.setEdge({v:ht.v,w:ht.w,name:ht.name},ht.value)}),q}};function mh(N){return Pi.map(N.nodes(),function(q){var ht=N.node(q),It=N.parent(q),Ft={v:q};return Pi.isUndefined(ht)||(Ft.value=ht),Pi.isUndefined(It)||(Ft.parent=It),Ft})}function oc(N){return Pi.map(N.edges(),function(q){var ht=N.edge(q),It={v:q.v,w:q.w};return Pi.isUndefined(q.name)||(It.name=q.name),Pi.isUndefined(ht)||(It.value=ht),It})}var Ot=function(N){var q,ht={},It=[];function Ft(Xt){Pi.has(ht,Xt)||(ht[Xt]=!0,q.push(Xt),Pi.each(N.successors(Xt),Ft),Pi.each(N.predecessors(Xt),Ft))}return Pi.each(N.nodes(),function(Xt){q=[],Ft(Xt),q.length&&It.push(q)}),It},ne=Se;function Se(){this._arr=[],this._keyIndices={}}Se.prototype.size=function(){return this._arr.length},Se.prototype.keys=function(){return this._arr.map(function(N){return N.key})},Se.prototype.has=function(N){return Pi.has(this._keyIndices,N)},Se.prototype.priority=function(N){var q=this._keyIndices[N];if(q!==void 0)return this._arr[q].priority},Se.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},Se.prototype.add=function(N,q){var ht=this._keyIndices;if(N=String(N),!Pi.has(ht,N)){var It=this._arr,Ft=It.length;return ht[N]=Ft,It.push({key:N,priority:q}),this._decrease(Ft),!0}return!1},Se.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var N=this._arr.pop();return delete this._keyIndices[N.key],this._heapify(0),N.key},Se.prototype.decrease=function(N,q){var ht=this._keyIndices[N];if(q>this._arr[ht].priority)throw new Error("New priority is greater than current priority. Key: "+N+" Old: "+this._arr[ht].priority+" New: "+q);this._arr[ht].priority=q,this._decrease(ht)},Se.prototype._heapify=function(N){var q=this._arr,ht=2*N,It=ht+1,Ft=N;ht<q.length&&(Ft=q[ht].priority<q[Ft].priority?ht:Ft,It<q.length&&(Ft=q[It].priority<q[Ft].priority?It:Ft),Ft!==N&&(this._swap(N,Ft),this._heapify(Ft)))},Se.prototype._decrease=function(N){for(var q,ht=this._arr,It=ht[N].priority;N!==0&&!(ht[q=N>>1].priority<It);)this._swap(N,q),N=q},Se.prototype._swap=function(N,q){var ht=this._arr,It=this._keyIndices,Ft=ht[N],Xt=ht[q];ht[N]=Xt,ht[q]=Ft,It[Xt.key]=N,It[Ft.key]=q};var Ke=function(N,q,ht,It){return function(Ft,Xt,oe,he){var Te,Ye,gn={},cn=new ne,Vn=function(An){var ma=An.v!==Te?An.v:An.w,Or=gn[ma],Fr=oe(An),rr=Ye.distance+Fr;if(Fr<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+An+" Weight: "+Fr);rr<Or.distance&&(Or.distance=rr,Or.predecessor=Te,cn.decrease(ma,rr))};for(Ft.nodes().forEach(function(An){var ma=An===Xt?0:Number.POSITIVE_INFINITY;gn[An]={distance:ma},cn.add(An,ma)});cn.size()>0&&(Te=cn.removeMin(),(Ye=gn[Te]).distance!==Number.POSITIVE_INFINITY);)he(Te).forEach(Vn);return gn}(N,String(q),ht||yn,It||function(Ft){return N.outEdges(Ft)})},yn=Pi.constant(1),yr=function(N,q,ht){return Pi.transform(N.nodes(),function(It,Ft){It[Ft]=Ke(N,Ft,q,ht)},{})},Ir=function(N){var q=0,ht=[],It={},Ft=[];function Xt(oe){var he=It[oe]={onStack:!0,lowlink:q,index:q++};if(ht.push(oe),N.successors(oe).forEach(function(gn){Pi.has(It,gn)?It[gn].onStack&&(he.lowlink=Math.min(he.lowlink,It[gn].index)):(Xt(gn),he.lowlink=Math.min(he.lowlink,It[gn].lowlink))}),he.lowlink===he.index){var Te,Ye=[];do Te=ht.pop(),It[Te].onStack=!1,Ye.push(Te);while(oe!==Te);Ft.push(Ye)}}return N.nodes().forEach(function(oe){Pi.has(It,oe)||Xt(oe)}),Ft},la=function(N){return Pi.filter(Ir(N),function(q){return q.length>1||q.length===1&&N.hasEdge(q[0],q[0])})},Dn=function(N,q,ht){return function(It,Ft,Xt){var oe={},he=It.nodes();return he.forEach(function(Te){oe[Te]={},oe[Te][Te]={distance:0},he.forEach(function(Ye){Te!==Ye&&(oe[Te][Ye]={distance:Number.POSITIVE_INFINITY})}),Xt(Te).forEach(function(Ye){var gn=Ye.v===Te?Ye.w:Ye.v,cn=Ft(Ye);oe[Te][gn]={distance:cn,predecessor:Te}})}),he.forEach(function(Te){var Ye=oe[Te];he.forEach(function(gn){var cn=oe[gn];he.forEach(function(Vn){var An=cn[Te],ma=Ye[Vn],Or=cn[Vn],Fr=An.distance+ma.distance;Fr<Or.distance&&(Or.distance=Fr,Or.predecessor=ma.predecessor)})})}),oe}(N,q||Ga,ht||function(It){return N.outEdges(It)})},Ga=Pi.constant(1),xi=Ui;function Ui(N){var q={},ht={},It=[];if(Pi.each(N.sinks(),function Ft(Xt){if(Pi.has(ht,Xt))throw new Ii;Pi.has(q,Xt)||(ht[Xt]=!0,q[Xt]=!0,Pi.each(N.predecessors(Xt),Ft),delete ht[Xt],It.push(Xt))}),Pi.size(q)!==N.nodeCount())throw new Ii;return It}function Ii(){}Ui.CycleException=Ii,Ii.prototype=new Error;var Mo=function(N,q,ht){Pi.isArray(q)||(q=[q]);var It=(N.isDirected()?N.successors:N.neighbors).bind(N),Ft=[],Xt={};return Pi.each(q,function(oe){if(!N.hasNode(oe))throw new Error("Graph does not have node: "+oe);rs(N,oe,ht==="post",Xt,It,Ft)}),Ft};function rs(N,q,ht,It,Ft,Xt){Pi.has(It,q)||(It[q]=!0,ht||Xt.push(q),Pi.each(Ft(q),function(oe){rs(N,oe,ht,It,Ft,Xt)}),ht&&Xt.push(q))}var Xo,so={Graph:Nu.Graph,json:ic,alg:{components:Ot,dijkstra:Ke,dijkstraAll:yr,findCycles:la,floydWarshall:Dn,isAcyclic:function(N){try{xi(N)}catch(q){if(q instanceof xi.CycleException)return!1;throw q}return!0},postorder:function(N,q){return Mo(N,q,"post")},preorder:function(N,q){return Mo(N,q,"pre")},prim:function(N,q){var ht,It=new gh,Ft={},Xt=new ne;function oe(Te){var Ye=Te.v===ht?Te.w:Te.v,gn=Xt.priority(Ye);if(gn!==void 0){var cn=q(Te);cn<gn&&(Ft[Ye]=ht,Xt.decrease(Ye,cn))}}if(N.nodeCount()===0)return It;Pi.each(N.nodes(),function(Te){Xt.add(Te,Number.POSITIVE_INFINITY),It.setNode(Te)}),Xt.decrease(N.nodes()[0],0);for(var he=!1;Xt.size()>0;){if(ht=Xt.removeMin(),Pi.has(Ft,ht))It.setEdge(ht,Ft[ht]);else{if(he)throw new Error("Input graph is not connected: "+N);he=!0}N.nodeEdges(ht).forEach(oe)}return It},tarjan:Ir,topsort:xi},version:Nu.version};try{Xo=so}catch(N){}Xo||(Xo=window.graphlib);var jo=Xo,Ci=function(N){return ou(N,5)},os=function(N,q,ht){if(!le(ht))return!1;var It=typeof q;return!!(It=="number"?Pa(ht)&&Je(q,ht.length):It=="string"&&q in ht)&&R(ht[q],N)},zo=Object.prototype,Xi=zo.hasOwnProperty,Qo=Ou(function(N,q){N=Object(N);var ht=-1,It=q.length,Ft=It>2?q[2]:void 0;for(Ft&&os(q[0],q[1],Ft)&&(It=1);++ht<It;)for(var Xt=q[ht],oe=Jn(Xt),he=-1,Te=oe.length;++he<Te;){var Ye=oe[he],gn=N[Ye];(gn===void 0||R(gn,zo[Ye])&&!Xi.call(N,Ye))&&(N[Ye]=Xt[Ye])}return N}),Is=function(N){return function(q,ht,It){var Ft=Object(q);if(!Pa(q)){var Xt=sl(ht);q=un(q),ht=function(he){return Xt(Ft[he],he,Ft)}}var oe=N(q,ht,It);return oe>-1?Ft[Xt?q[oe]:oe]:void 0}},$s=/^\s+|\s+$/g,Ts=/^[-+]0x[0-9a-f]+$/i,Ds=/^0b[01]+$/i,Gs=/^0o[0-7]+$/i,dr=parseInt,Vi=function(N){if(typeof N=="number")return N;if(ge(N))return NaN;if(le(N)){var q=typeof N.valueOf=="function"?N.valueOf():N;N=le(q)?q+"":q}if(typeof N!="string")return N===0?N:+N;N=N.replace($s,"");var ht=Ds.test(N);return ht||Gs.test(N)?dr(N.slice(2),ht?2:8):Ts.test(N)?NaN:+N},af=function(N){return N?(N=Vi(N))===Infinity||N===-Infinity?17976931348623157e292*(N<0?-1:1):N==N?N:0:N===0?N:0},Tf=function(N){var q=af(N),ht=q%1;return q==q?ht?q-ht:q:0},sc=Math.max,Af=Is(function(N,q,ht){var It=N==null?0:N.length;if(!It)return-1;var Ft=ht==null?0:Tf(ht);return Ft<0&&(Ft=sc(It+Ft,0)),Uc(N,sl(q),Ft)}),Sc=function(N){return(N==null?0:N.length)?Wu(N,1):[]},_l=function(N,q){return N==null?N:dl(N,lu(q),Jn)},Rd=function(N){var q=N==null?0:N.length;return q?N[q-1]:void 0},ud=function(N,q){var ht={};return q=sl(q),kl(N,function(It,Ft,Xt){Zr(ht,Ft,q(It,Ft,Xt))}),ht},pn=function(N,q,ht){for(var It=-1,Ft=N.length;++It<Ft;){var Xt=N[It],oe=q(Xt);if(oe!=null&&(he===void 0?oe==oe&&!ge(oe):ht(oe,he)))var he=oe,Te=Xt}return Te},nh=function(N,q){return N>q},ld=function(N){return N&&N.length?pn(N,el,nh):void 0},br=function(N,q,ht){(ht!==void 0&&!R(N[q],ht)||ht===void 0&&!(q in N))&&Zr(N,q,ht)},Vh=Function.prototype,Rc=Object.prototype,Lc=Vh.toString,Vc=Rc.hasOwnProperty,Pc=Lc.call(Object),Ru=function(N){if(!kt(N)||Ee(N)!="[object Object]")return!1;var q=Yi(N);if(q===null)return!0;var ht=Vc.call(q,"constructor")&&q.constructor;return typeof ht=="function"&&ht instanceof ht&&Lc.call(ht)==Pc},Fc=function(N,q){if((q!=="constructor"||typeof N[q]!="function")&&q!="__proto__")return N[q]},Rl=function(N){return an(N,Jn(N))},yh=function(N,q,ht,It,Ft,Xt,oe){var he=Fc(N,ht),Te=Fc(q,ht),Ye=oe.get(Te);if(Ye)br(N,ht,Ye);else{var gn=Xt?Xt(he,Te,ht+"",N,q,oe):void 0,cn=gn===void 0;if(cn){var Vn=jt(Te),An=!Vn&&re(Te),ma=!Vn&&!An&&_r(Te);gn=Te,Vn||An||ma?jt(he)?gn=he:Dd(he)?gn=Fa(he):An?(cn=!1,gn=ya(Te,!0)):ma?(cn=!1,gn=eu(Te,!0)):gn=[]:Ru(Te)||$t(Te)?(gn=he,$t(he)?gn=Rl(he):le(he)&&!Ze(he)||(gn=pa(Te))):cn=!1}cn&&(oe.set(Te,gn),Ft(gn,Te,It,Xt,oe),oe.delete(Te)),br(N,ht,gn)}},jc=function N(q,ht,It,Ft,Xt){q!==ht&&dl(ht,function(oe,he){if(Xt||(Xt=new Tr),le(oe))yh(q,ht,he,It,N,Ft,Xt);else{var Te=Ft?Ft(Fc(q,he),oe,he+"",q,ht,Xt):void 0;Te===void 0&&(Te=oe),br(q,he,Te)}},Jn)},jh=function(N){return Ou(function(q,ht){var It=-1,Ft=ht.length,Xt=Ft>1?ht[Ft-1]:void 0,oe=Ft>2?ht[2]:void 0;for(Xt=N.length>3&&typeof Xt=="function"?(Ft--,Xt):void 0,oe&&os(ht[0],ht[1],oe)&&(Xt=Ft<3?void 0:Xt,Ft=1),q=Object(q);++It<Ft;){var he=ht[It];he&&N(q,he,It,Xt)}return q})}(function(N,q,ht){jc(N,q,ht)}),Hh=function(N,q){return N<q},Hc=function(N){return N&&N.length?pn(N,el,Hh):void 0},Sv=function(N,q){return N&&N.length?pn(N,sl(q),Hh):void 0},vf=function(){return Gt.Date.now()},Ld=function(N,q,ht,It){if(!le(N))return N;for(var Ft=-1,Xt=(q=To(q,N)).length,oe=Xt-1,he=N;he!=null&&++Ft<Xt;){var Te=wo(q[Ft]),Ye=ht;if(Te==="__proto__"||Te==="constructor"||Te==="prototype")return N;if(Ft!=oe){var gn=he[Te];(Ye=It?It(gn,Te,he):void 0)===void 0&&(Ye=le(gn)?gn:Je(q[Ft+1])?[]:{})}_n(he,Te,Ye),he=he[Te]}return N},gf=function(N,q,ht){for(var It=-1,Ft=q.length,Xt={};++It<Ft;){var oe=q[It],he=Vo(N,oe);ht(he,oe)&&Ld(Xt,To(oe,N),he)}return Xt},gp=function(N,q){return gf(N,q,function(ht,It){return Hs(N,It)})},mp=function(N){return Ec(ps(N,void 0,Sc),N+"")}(function(N,q){return N==null?{}:gp(N,q)}),Pd=Math.ceil,yp=Math.max,il=function(N,q,ht,It){for(var Ft=-1,Xt=yp(Pd((q-N)/(ht||1)),0),oe=Array(Xt);Xt--;)oe[It?Xt:++Ft]=N,N+=ht;return oe},rh=function(N){return function(q,ht,It){return It&&typeof It!="number"&&os(q,ht,It)&&(ht=It=void 0),q=af(q),ht===void 0?(ht=q,q=0):ht=af(ht),It=It===void 0?q<ht?1:-1:af(It),il(q,ht,It,N)}}(),Up=function(N,q){var ht=N.length;for(N.sort(q);ht--;)N[ht]=N[ht].value;return N},Xh=function(N,q){if(N!==q){var ht=N!==void 0,It=N===null,Ft=N==N,Xt=ge(N),oe=q!==void 0,he=q===null,Te=q==q,Ye=ge(q);if(!he&&!Ye&&!Xt&&N>q||Xt&&oe&&Te&&!he&&!Ye||It&&oe&&Te||!ht&&Te||!Ft)return 1;if(!It&&!Xt&&!Ye&&N<q||Ye&&ht&&Ft&&!It&&!Xt||he&&ht&&Ft||!oe&&Ft||!Te)return-1}return 0},Fd=function(N,q,ht){for(var It=-1,Ft=N.criteria,Xt=q.criteria,oe=Ft.length,he=ht.length;++It<oe;){var Te=Xh(Ft[It],Xt[It]);if(Te)return It>=he?Te:Te*(ht[It]=="desc"?-1:1)}return N.index-q.index},Kl=function(N,q,ht){q=q.length?oi(q,function(Xt){return jt(Xt)?function(oe){return Vo(oe,Xt.length===1?Xt[0]:Xt)}:Xt}):[el];var It=-1;q=oi(q,qr(sl));var Ft=Zt(N,function(Xt,oe,he){return{criteria:oi(q,function(Te){return Te(Xt)}),index:++It,value:Xt}});return Up(Ft,function(Xt,oe){return Fd(Xt,oe,ht)})},Al=Ou(function(N,q){if(N==null)return[];var ht=q.length;return ht>1&&os(N,q[0],q[1])?q=[]:ht>2&&os(q[0],q[1],q[2])&&(q=[q[0]]),Kl(N,Wu(q,1),[])}),Ml=0,ah=function(N){var q=++Ml;return _o(N)+q},Os=function(N,q,ht){for(var It=-1,Ft=N.length,Xt=q.length,oe={};++It<Ft;){var he=It<Xt?q[It]:void 0;ht(oe,N[It],he)}return oe},Ll,of=function(N,q){return Os(N||[],q||[],_n)};try{Ll={cloneDeep:Ci,constant:xu,defaults:Qo,each:pl,filter:rl,find:Af,flatten:Sc,forEach:Du,forIn:_l,has:wc,isUndefined:nt,last:Rd,map:de,mapValues:ud,max:ld,merge:jh,min:Hc,minBy:Sv,now:vf,pick:mp,range:rh,reduce:rn,sortBy:Al,uniqueId:ah,values:vh,zipObject:of}}catch(N){}Ll||(Ll=window._);var Sn=Ll,Bd=ih;function ih(){var N={};N._next=N._prev=N,this._sentinel=N}function zd(N){N._prev._next=N._next,N._next._prev=N._prev,delete N._next,delete N._prev}function Mf(N,q){if(N!=="_next"&&N!=="_prev")return q}ih.prototype.dequeue=function(){var N=this._sentinel,q=N._prev;if(q!==N)return zd(q),q},ih.prototype.enqueue=function(N){var q=this._sentinel;N._prev&&N._next&&zd(N),N._next=q._next,q._next._prev=N,q._next=N,N._prev=q},ih.prototype.toString=function(){for(var N=[],q=this._sentinel,ht=q._prev;ht!==q;)N.push(JSON.stringify(ht,Mf)),ht=ht._prev;return"["+N.join(", ")+"]"};var sf=jo.Graph,Uf=function(N,q){if(N.nodeCount()<=1)return[];var ht=function(Ft,Xt){var oe=new sf,he=0,Te=0;Sn.forEach(Ft.nodes(),function(cn){oe.setNode(cn,{v:cn,in:0,out:0})}),Sn.forEach(Ft.edges(),function(cn){var Vn=oe.edge(cn.v,cn.w)||0,An=Xt(cn),ma=Vn+An;oe.setEdge(cn.v,cn.w,ma),Te=Math.max(Te,oe.node(cn.v).out+=An),he=Math.max(he,oe.node(cn.w).in+=An)});var Ye=Sn.range(Te+he+3).map(function(){return new Bd}),gn=he+1;return Sn.forEach(oe.nodes(),function(cn){bh(Ye,gn,oe.node(cn))}),{graph:oe,buckets:Ye,zeroIdx:gn}}(N,q||$d),It=function(Ft,Xt,oe){for(var he,Te=[],Ye=Xt[Xt.length-1],gn=Xt[0];Ft.nodeCount();){for(;he=gn.dequeue();)Wf(Ft,Xt,oe,he);for(;he=Ye.dequeue();)Wf(Ft,Xt,oe,he);if(Ft.nodeCount()){for(var cn=Xt.length-2;cn>0;--cn)if(he=Xt[cn].dequeue()){Te=Te.concat(Wf(Ft,Xt,oe,he,!0));break}}}return Te}(ht.graph,ht.buckets,ht.zeroIdx);return Sn.flatten(Sn.map(It,function(Ft){return N.outEdges(Ft.v,Ft.w)}),!0)},$d=Sn.constant(1);function Wf(N,q,ht,It,Ft){var Xt=Ft?[]:void 0;return Sn.forEach(N.inEdges(It.v),function(oe){var he=N.edge(oe),Te=N.node(oe.v);Ft&&Xt.push({v:oe.v,w:oe.w}),Te.out-=he,bh(q,ht,Te)}),Sn.forEach(N.outEdges(It.v),function(oe){var he=N.edge(oe),Te=oe.w,Ye=N.node(Te);Ye.in-=he,bh(q,ht,Ye)}),N.removeNode(It.v),Xt}function bh(N,q,ht){ht.out?ht.in?N[ht.out-ht.in+q].enqueue(ht):N[N.length-1].enqueue(ht):N[0].enqueue(ht)}var Wp={run:function(N){var q=N.graph().acyclicer==="greedy"?Uf(N,function(ht){return function(It){return ht.edge(It).weight}}(N)):function(ht){var It=[],Ft={},Xt={};function oe(he){Sn.has(Xt,he)||(Xt[he]=!0,Ft[he]=!0,Sn.forEach(ht.outEdges(he),function(Te){Sn.has(Ft,Te.w)?It.push(Te):oe(Te.w)}),delete Ft[he])}return Sn.forEach(ht.nodes(),oe),It}(N);Sn.forEach(q,function(ht){var It=N.edge(ht);N.removeEdge(ht),It.forwardName=ht.name,It.reversed=!0,N.setEdge(ht.w,ht.v,It,Sn.uniqueId("rev"))})},undo:function(N){Sn.forEach(N.edges(),function(q){var ht=N.edge(q);if(ht.reversed){N.removeEdge(q);var It=ht.forwardName;delete ht.reversed,delete ht.forwardName,N.setEdge(q.w,q.v,ht,It)}})}},xh=jo.Graph,ju={addDummyNode:oh,simplify:function(N){var q=new xh().setGraph(N.graph());return Sn.forEach(N.nodes(),function(ht){q.setNode(ht,N.node(ht))}),Sn.forEach(N.edges(),function(ht){var It=q.edge(ht.v,ht.w)||{weight:0,minlen:1},Ft=N.edge(ht);q.setEdge(ht.v,ht.w,{weight:It.weight+Ft.weight,minlen:Math.max(It.minlen,Ft.minlen)})}),q},asNonCompoundGraph:function(N){var q=new xh({multigraph:N.isMultigraph()}).setGraph(N.graph());return Sn.forEach(N.nodes(),function(ht){N.children(ht).length||q.setNode(ht,N.node(ht))}),Sn.forEach(N.edges(),function(ht){q.setEdge(ht,N.edge(ht))}),q},successorWeights:function(N){var q=Sn.map(N.nodes(),function(ht){var It={};return Sn.forEach(N.outEdges(ht),function(Ft){It[Ft.w]=(It[Ft.w]||0)+N.edge(Ft).weight}),It});return Sn.zipObject(N.nodes(),q)},predecessorWeights:function(N){var q=Sn.map(N.nodes(),function(ht){var It={};return Sn.forEach(N.inEdges(ht),function(Ft){It[Ft.v]=(It[Ft.v]||0)+N.edge(Ft).weight}),It});return Sn.zipObject(N.nodes(),q)},intersectRect:function(N,q){var ht,It,Ft=N.x,Xt=N.y,oe=q.x-Ft,he=q.y-Xt,Te=N.width/2,Ye=N.height/2;if(!oe&&!he)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(he)*Te>Math.abs(oe)*Ye?(he<0&&(Ye=-Ye),ht=Ye*oe/he,It=Ye):(oe<0&&(Te=-Te),ht=Te,It=Te*he/oe),{x:Ft+ht,y:Xt+It}},buildLayerMatrix:function(N){var q=Sn.map(Sn.range(bp(N)+1),function(){return[]});return Sn.forEach(N.nodes(),function(ht){var It=N.node(ht),Ft=It.rank;Sn.isUndefined(Ft)||(q[Ft][It.order]=ht)}),q},normalizeRanks:function(N){var q=Sn.min(Sn.map(N.nodes(),function(ht){return N.node(ht).rank}));Sn.forEach(N.nodes(),function(ht){var It=N.node(ht);Sn.has(It,"rank")&&(It.rank-=q)})},removeEmptyRanks:function(N){var q=Sn.min(Sn.map(N.nodes(),function(Xt){return N.node(Xt).rank})),ht=[];Sn.forEach(N.nodes(),function(Xt){var oe=N.node(Xt).rank-q;ht[oe]||(ht[oe]=[]),ht[oe].push(Xt)});var It=0,Ft=N.graph().nodeRankFactor;Sn.forEach(ht,function(Xt,oe){Sn.isUndefined(Xt)&&oe%Ft!=0?--It:It&&Sn.forEach(Xt,function(he){N.node(he).rank+=It})})},addBorderNode:function(N,q,ht,It){var Ft={width:0,height:0};return arguments.length>=4&&(Ft.rank=ht,Ft.order=It),oh(N,"border",Ft,q)},maxRank:bp,partition:function(N,q){var ht={lhs:[],rhs:[]};return Sn.forEach(N,function(It){q(It)?ht.lhs.push(It):ht.rhs.push(It)}),ht},time:function(N,q){var ht=Sn.now();try{return q()}finally{console.log(N+" time: "+(Sn.now()-ht)+"ms")}},notime:function(N,q){return q()}};function oh(N,q,ht,It){var Ft;do Ft=Sn.uniqueId(It);while(N.hasNode(Ft));return ht.dummy=q,N.setNode(Ft,ht),Ft}function bp(N){return Sn.max(Sn.map(N.nodes(),function(q){var ht=N.node(q).rank;if(!Sn.isUndefined(ht))return ht}))}var cd={run:function(N){N.graph().dummyChains=[],Sn.forEach(N.edges(),function(q){(function(ht,It){var Ft,Xt,oe,he=It.v,Te=ht.node(he).rank,Ye=It.w,gn=ht.node(Ye).rank,cn=It.name,Vn=ht.edge(It),An=Vn.labelRank;if(gn!==Te+1){for(ht.removeEdge(It),oe=0,++Te;Te<gn;++oe,++Te)Vn.points=[],Xt={width:0,height:0,edgeLabel:Vn,edgeObj:It,rank:Te},Ft=ju.addDummyNode(ht,"edge",Xt,"_d"),Te===An&&(Xt.width=Vn.width,Xt.height=Vn.height,Xt.dummy="edge-label",Xt.labelpos=Vn.labelpos),ht.setEdge(he,Ft,{weight:Vn.weight},cn),oe===0&&ht.graph().dummyChains.push(Ft),he=Ft;ht.setEdge(he,Ye,{weight:Vn.weight},cn)}})(N,q)})},undo:function(N){Sn.forEach(N.graph().dummyChains,function(q){var ht,It=N.node(q),Ft=It.edgeLabel;for(N.setEdge(It.edgeObj,Ft);It.dummy;)ht=N.successors(q)[0],N.removeNode(q),Ft.points.push({x:It.x,y:It.y}),It.dummy==="edge-label"&&(Ft.x=It.x,Ft.y=It.y,Ft.width=It.width,Ft.height=It.height),q=ht,It=N.node(q)})}},Cc=function(N){var q={};Sn.forEach(N.sources(),function ht(It){var Ft=N.node(It);if(Sn.has(q,It))return Ft.rank;q[It]=!0;var Xt=Sn.min(Sn.map(N.outEdges(It),function(oe){return ht(oe.w)-N.edge(oe).minlen}));return Xt!==Number.POSITIVE_INFINITY&&Xt!=null||(Xt=0),Ft.rank=Xt})},Yh=function(N,q){return N.node(q.w).rank-N.node(q.v).rank-N.edge(q).minlen},uf=jo.Graph,wh=Yh,sh=function(N){var q,ht,It=new uf({directed:!1}),Ft=N.nodes()[0],Xt=N.nodeCount();for(It.setNode(Ft,{});Pl(It,N)<Xt;)q=Nf(It,N),ht=It.hasNode(q.v)?wh(N,q):-wh(N,q),Eh(It,N,ht);return It};function Pl(N,q){return Sn.forEach(N.nodes(),function ht(It){Sn.forEach(q.nodeEdges(It),function(Ft){var Xt=Ft.v,oe=It===Xt?Ft.w:Xt;N.hasNode(oe)||wh(q,Ft)||(N.setNode(oe,{}),N.setEdge(It,oe,{}),ht(oe))})}),N.nodeCount()}function Nf(N,q){return Sn.minBy(q.edges(),function(ht){if(N.hasNode(ht.v)!==N.hasNode(ht.w))return wh(q,ht)})}function Eh(N,q,ht){Sn.forEach(N.nodes(),function(It){q.node(It).rank+=ht})}var fd=Yh,Vp=Cc,hd=jo.alg.preorder,jp=jo.alg.postorder,Gd=ju.simplify,Kh=Fl;function Fl(N){N=Gd(N),Vp(N);var q,ht=sh(N);for(Ch(ht),uh(ht,N);q=Cv(ht);)Xc(ht,N,q,vs(ht,N,q))}function uh(N,q){var ht=jp(N,N.nodes());ht=ht.slice(0,ht.length-1),Sn.forEach(ht,function(It){(function(Ft,Xt,oe){var he=Ft.node(oe).parent;Ft.edge(oe,he).cutvalue=Sh(Ft,Xt,oe)})(N,q,It)})}function Sh(N,q,ht){var It=N.node(ht).parent,Ft=!0,Xt=q.edge(ht,It),oe=0;return Xt||(Ft=!1,Xt=q.edge(It,ht)),oe=Xt.weight,Sn.forEach(q.nodeEdges(ht),function(he){var Te,Ye,gn=he.v===ht,cn=gn?he.w:he.v;if(cn!==It){var Vn=gn===Ft,An=q.edge(he).weight;if(oe+=Vn?An:-An,Te=ht,Ye=cn,N.hasEdge(Te,Ye)){var ma=N.edge(ht,cn).cutvalue;oe+=Vn?-ma:ma}}}),oe}function Ch(N,q){arguments.length<2&&(q=N.nodes()[0]),ng(N,{},1,q)}function ng(N,q,ht,It,Ft){var Xt=ht,oe=N.node(It);return q[It]=!0,Sn.forEach(N.neighbors(It),function(he){Sn.has(q,he)||(ht=ng(N,q,ht,he,It))}),oe.low=Xt,oe.lim=ht++,Ft?oe.parent=Ft:delete oe.parent,ht}function Cv(N){return Sn.find(N.edges(),function(q){return N.edge(q).cutvalue<0})}function vs(N,q,ht){var It=ht.v,Ft=ht.w;q.hasEdge(It,Ft)||(It=ht.w,Ft=ht.v);var Xt=N.node(It),oe=N.node(Ft),he=Xt,Te=!1;Xt.lim>oe.lim&&(he=oe,Te=!0);var Ye=Sn.filter(q.edges(),function(gn){return Te===eo(N,N.node(gn.v),he)&&Te!==eo(N,N.node(gn.w),he)});return Sn.minBy(Ye,function(gn){return fd(q,gn)})}function Xc(N,q,ht,It){var Ft=ht.v,Xt=ht.w;N.removeEdge(Ft,Xt),N.setEdge(It.v,It.w,{}),Ch(N),uh(N,q),function(oe,he){var Te=Sn.find(oe.nodes(),function(gn){return!he.node(gn).parent}),Ye=hd(oe,Te);Ye=Ye.slice(1),Sn.forEach(Ye,function(gn){var cn=oe.node(gn).parent,Vn=he.edge(gn,cn),An=!1;Vn||(Vn=he.edge(cn,gn),An=!0),he.node(gn).rank=he.node(cn).rank+(An?Vn.minlen:-Vn.minlen)})}(N,q)}function eo(N,q,ht){return ht.low<=q.lim&&q.lim<=ht.lim}Fl.initLowLimValues=Ch,Fl.initCutValues=uh,Fl.calcCutValue=Sh,Fl.leaveEdge=Cv,Fl.enterEdge=vs,Fl.exchangeEdges=Xc;var Hp=Cc,_h=function(N){switch(N.graph().ranker){case"network-simplex":_g(N);break;case"tight-tree":(function(q){Hp(q),sh(q)})(N);break;case"longest-path":dd(N);break;default:_g(N)}},dd=Hp;function _g(N){Kh(N)}var Ig=function(N){var q=function(ht){var It={},Ft=0;function Xt(oe){var he=Ft;Sn.forEach(ht.children(oe),Xt),It[oe]={low:he,lim:Ft++}}return Sn.forEach(ht.children(),Xt),It}(N);Sn.forEach(N.graph().dummyChains,function(ht){for(var It=N.node(ht),Ft=It.edgeObj,Xt=function(cn,Vn,An,ma){var Or,Fr,rr=[],Za=[],Xn=Math.min(Vn[An].low,Vn[ma].low),ii=Math.max(Vn[An].lim,Vn[ma].lim);Or=An;do Or=cn.parent(Or),rr.push(Or);while(Or&&(Vn[Or].low>Xn||ii>Vn[Or].lim));for(Fr=Or,Or=ma;(Or=cn.parent(Or))!==Fr;)Za.push(Or);return{path:rr.concat(Za.reverse()),lca:Fr}}(N,q,Ft.v,Ft.w),oe=Xt.path,he=Xt.lca,Te=0,Ye=oe[Te],gn=!0;ht!==Ft.w;){if(It=N.node(ht),gn){for(;(Ye=oe[Te])!==he&&N.node(Ye).maxRank<It.rank;)Te++;Ye===he&&(gn=!1)}if(!gn){for(;Te<oe.length-1&&N.node(Ye=oe[Te+1]).minRank<=It.rank;)Te++;Ye=oe[Te]}N.setParent(ht,Ye),ht=N.successors(ht)[0]}})},Ud={run:function(N){var q=ju.addDummyNode(N,"root",{},"_root"),ht=function(oe){var he={};function Te(Ye,gn){var cn=oe.children(Ye);cn&&cn.length&&Sn.forEach(cn,function(Vn){Te(Vn,gn+1)}),he[Ye]=gn}return Sn.forEach(oe.children(),function(Ye){Te(Ye,1)}),he}(N),It=Sn.max(Sn.values(ht))-1,Ft=2*It+1;N.graph().nestingRoot=q,Sn.forEach(N.edges(),function(oe){N.edge(oe).minlen*=Ft});var Xt=function(oe){return Sn.reduce(oe.edges(),function(he,Te){return he+oe.edge(Te).weight},0)}(N)+1;Sn.forEach(N.children(),function(oe){Xp(N,q,Ft,Xt,It,ht,oe)}),N.graph().nodeRankFactor=Ft},cleanup:function(N){var q=N.graph();N.removeNode(q.nestingRoot),delete q.nestingRoot,Sn.forEach(N.edges(),function(ht){N.edge(ht).nestingEdge&&N.removeEdge(ht)})}};function Xp(N,q,ht,It,Ft,Xt,oe){var he=N.children(oe);if(he.length){var Te=ju.addBorderNode(N,"_bt"),Ye=ju.addBorderNode(N,"_bb"),gn=N.node(oe);N.setParent(Te,oe),gn.borderTop=Te,N.setParent(Ye,oe),gn.borderBottom=Ye,Sn.forEach(he,function(cn){Xp(N,q,ht,It,Ft,Xt,cn);var Vn=N.node(cn),An=Vn.borderTop?Vn.borderTop:cn,ma=Vn.borderBottom?Vn.borderBottom:cn,Or=Vn.borderTop?It:2*It,Fr=An!==ma?1:Ft-Xt[oe]+1;N.setEdge(Te,An,{weight:Or,minlen:Fr,nestingEdge:!0}),N.setEdge(ma,Ye,{weight:Or,minlen:Fr,nestingEdge:!0})}),N.parent(oe)||N.setEdge(q,Te,{weight:0,minlen:Ft+Xt[oe]})}else oe!==q&&N.setEdge(q,oe,{weight:0,minlen:ht})}var _v=function(N){Sn.forEach(N.children(),function q(ht){var It=N.children(ht),Ft=N.node(ht);if(It.length&&Sn.forEach(It,q),Sn.has(Ft,"minRank")){Ft.borderLeft=[],Ft.borderRight=[];for(var Xt=Ft.minRank,oe=Ft.maxRank+1;Xt<oe;++Xt)Ih(N,"borderLeft","_bl",ht,Ft,Xt),Ih(N,"borderRight","_br",ht,Ft,Xt)}})};function Ih(N,q,ht,It,Ft,Xt){var oe={width:0,height:0,rank:Xt,borderType:q},he=Ft[q][Xt-1],Te=ju.addDummyNode(N,"border",oe,ht);Ft[q][Xt]=Te,N.setParent(Te,It),he&&N.setEdge(he,Te,{weight:1})}var Yp={adjust:function(N){var q=N.graph().rankdir.toLowerCase();q!=="lr"&&q!=="rl"||Kp(N)},undo:function(N){var q=N.graph().rankdir.toLowerCase();q!=="bt"&&q!=="rl"||function(ht){Sn.forEach(ht.nodes(),function(It){Zp(ht.node(It))}),Sn.forEach(ht.edges(),function(It){var Ft=ht.edge(It);Sn.forEach(Ft.points,Zp),Sn.has(Ft,"y")&&Zp(Ft)})}(N),q!=="lr"&&q!=="rl"||(function(ht){Sn.forEach(ht.nodes(),function(It){Ah(ht.node(It))}),Sn.forEach(ht.edges(),function(It){var Ft=ht.edge(It);Sn.forEach(Ft.points,Ah),Sn.has(Ft,"x")&&Ah(Ft)})}(N),Kp(N))}};function Kp(N){Sn.forEach(N.nodes(),function(q){Th(N.node(q))}),Sn.forEach(N.edges(),function(q){Th(N.edge(q))})}function Th(N){var q=N.width;N.width=N.height,N.height=q}function Zp(N){N.y=-N.y}function Ah(N){var q=N.x;N.x=N.y,N.y=q}var Wd=function(N){var q={},ht=Sn.filter(N.nodes(),function(he){return!N.children(he).length}),It=Sn.max(Sn.map(ht,function(he){return N.node(he).rank})),Ft=Sn.map(Sn.range(It+1),function(){return[]});function Xt(he){if(!Sn.has(q,he)){q[he]=!0;var Te=N.node(he);Ft[Te.rank].push(he),Sn.forEach(N.successors(he),Xt)}}var oe=Sn.sortBy(ht,function(he){return N.node(he).rank});return Sn.forEach(oe,Xt),Ft},Vd=function(N,q){for(var ht=0,It=1;It<q.length;++It)ht+=pd(N,q[It-1],q[It]);return ht};function pd(N,q,ht){for(var It=Sn.zipObject(ht,Sn.map(ht,function(Ye,gn){return gn})),Ft=Sn.flatten(Sn.map(q,function(Ye){return Sn.sortBy(Sn.map(N.outEdges(Ye),function(gn){return{pos:It[gn.w],weight:N.edge(gn).weight}}),"pos")}),!0),Xt=1;Xt<ht.length;)Xt<<=1;var oe=2*Xt-1;Xt-=1;var he=Sn.map(new Array(oe),function(){return 0}),Te=0;return Sn.forEach(Ft.forEach(function(Ye){var gn=Ye.pos+Xt;he[gn]+=Ye.weight;for(var cn=0;gn>0;)gn%2&&(cn+=he[gn+1]),he[gn=gn-1>>1]+=Ye.weight;Te+=Ye.weight*cn})),Te}var xp=function(N,q){return Sn.map(q,function(ht){var It=N.inEdges(ht);if(It.length){var Ft=Sn.reduce(It,function(Xt,oe){var he=N.edge(oe),Te=N.node(oe.v);return{sum:Xt.sum+he.weight*Te.order,weight:Xt.weight+he.weight}},{sum:0,weight:0});return{v:ht,barycenter:Ft.sum/Ft.weight,weight:Ft.weight}}return{v:ht}})},vd=function(N,q){var ht={};return Sn.forEach(N,function(It,Ft){var Xt=ht[It.v]={indegree:0,in:[],out:[],vs:[It.v],i:Ft};Sn.isUndefined(It.barycenter)||(Xt.barycenter=It.barycenter,Xt.weight=It.weight)}),Sn.forEach(q.edges(),function(It){var Ft=ht[It.v],Xt=ht[It.w];Sn.isUndefined(Ft)||Sn.isUndefined(Xt)||(Xt.indegree++,Ft.out.push(ht[It.w]))}),function(It){var Ft=[];function Xt(Te){return function(Ye){Ye.merged||(Sn.isUndefined(Ye.barycenter)||Sn.isUndefined(Te.barycenter)||Ye.barycenter>=Te.barycenter)&&function(gn,cn){var Vn=0,An=0;gn.weight&&(Vn+=gn.barycenter*gn.weight,An+=gn.weight),cn.weight&&(Vn+=cn.barycenter*cn.weight,An+=cn.weight),gn.vs=cn.vs.concat(gn.vs),gn.barycenter=Vn/An,gn.weight=An,gn.i=Math.min(cn.i,gn.i),cn.merged=!0}(Te,Ye)}}function oe(Te){return function(Ye){Ye.in.push(Te),--Ye.indegree==0&&It.push(Ye)}}for(;It.length;){var he=It.pop();Ft.push(he),Sn.forEach(he.in.reverse(),Xt(he)),Sn.forEach(he.out,oe(he))}return Sn.map(Sn.filter(Ft,function(Te){return!Te.merged}),function(Te){return Sn.pick(Te,["vs","i","barycenter","weight"])})}(Sn.filter(ht,function(It){return!It.indegree}))},jd=function(N,q){var ht=ju.partition(N,function(cn){return Sn.has(cn,"barycenter")}),It=ht.lhs,Ft=Sn.sortBy(ht.rhs,function(cn){return-cn.i}),Xt=[],oe=0,he=0,Te=0;It.sort((Ye=!!q,function(cn,Vn){return cn.barycenter<Vn.barycenter?-1:cn.barycenter>Vn.barycenter?1:Ye?Vn.i-cn.i:cn.i-Vn.i})),Te=kf(Xt,Ft,Te),Sn.forEach(It,function(cn){Te+=cn.vs.length,Xt.push(cn.vs),oe+=cn.barycenter*cn.weight,he+=cn.weight,Te=kf(Xt,Ft,Te)});var Ye,gn={vs:Sn.flatten(Xt,!0)};return he&&(gn.barycenter=oe/he,gn.weight=he),gn};function kf(N,q,ht){for(var It;q.length&&(It=Sn.last(q)).i<=ht;)q.pop(),N.push(It.vs),ht++;return ht}var Hd=function N(q,ht,It,Ft){var Xt=q.children(ht),oe=q.node(ht),he=oe?oe.borderLeft:void 0,Te=oe?oe.borderRight:void 0,Ye={};he&&(Xt=Sn.filter(Xt,function(Or){return Or!==he&&Or!==Te}));var gn=xp(q,Xt);Sn.forEach(gn,function(Or){if(q.children(Or.v).length){var Fr=N(q,Or.v,It,Ft);Ye[Or.v]=Fr,Sn.has(Fr,"barycenter")&&(rr=Or,Za=Fr,Sn.isUndefined(rr.barycenter)?(rr.barycenter=Za.barycenter,rr.weight=Za.weight):(rr.barycenter=(rr.barycenter*rr.weight+Za.barycenter*Za.weight)/(rr.weight+Za.weight),rr.weight+=Za.weight))}var rr,Za});var cn=vd(gn,It);(function(Or,Fr){Sn.forEach(Or,function(rr){rr.vs=Sn.flatten(rr.vs.map(function(Za){return Fr[Za]?Fr[Za].vs:Za}),!0)})})(cn,Ye);var Vn=jd(cn,Ft);if(he&&(Vn.vs=Sn.flatten([he,Vn.vs,Te],!0),q.predecessors(he).length)){var An=q.node(q.predecessors(he)[0]),ma=q.node(q.predecessors(Te)[0]);Sn.has(Vn,"barycenter")||(Vn.barycenter=0,Vn.weight=0),Vn.barycenter=(Vn.barycenter*Vn.weight+An.order+ma.order)/(Vn.weight+2),Vn.weight+=2}return Vn},wp=jo.Graph,Xd=function(N,q,ht){var It=function(Xt){for(var oe;Xt.hasNode(oe=Sn.uniqueId("_root")););return oe}(N),Ft=new wp({compound:!0}).setGraph({root:It}).setDefaultNodeLabel(function(Xt){return N.node(Xt)});return Sn.forEach(N.nodes(),function(Xt){var oe=N.node(Xt),he=N.parent(Xt);(oe.rank===q||oe.minRank<=q&&q<=oe.maxRank)&&(Ft.setNode(Xt),Ft.setParent(Xt,he||It),Sn.forEach(N[ht](Xt),function(Te){var Ye=Te.v===Xt?Te.w:Te.v,gn=Ft.edge(Ye,Xt),cn=Sn.isUndefined(gn)?0:gn.weight;Ft.setEdge(Ye,Xt,{weight:N.edge(Te).weight+cn})}),Sn.has(oe,"minRank")&&Ft.setNode(Xt,{borderLeft:oe.borderLeft[q],borderRight:oe.borderRight[q]}))}),Ft},Mh=function(N,q,ht){var It,Ft={};Sn.forEach(ht,function(Xt){for(var oe,he,Te=N.parent(Xt);Te;){if((oe=N.parent(Te))?(he=Ft[oe],Ft[oe]=Te):(he=It,It=Te),he&&he!==Te)return void q.setEdge(he,Te);Te=oe}})},Zh=jo.Graph,Ep=function(N){var q=ju.maxRank(N),ht=Nh(N,Sn.range(1,q+1),"inEdges"),It=Nh(N,Sn.range(q-1,-1,-1),"outEdges"),Ft=Wd(N);lh(N,Ft);for(var Xt,oe=Number.POSITIVE_INFINITY,he=0,Te=0;Te<4;++he,++Te){Sp(he%2?ht:It,he%4>=2),Ft=ju.buildLayerMatrix(N);var Ye=Vd(N,Ft);Ye<oe&&(Te=0,Xt=Sn.cloneDeep(Ft),oe=Ye)}lh(N,Xt)};function Nh(N,q,ht){return Sn.map(q,function(It){return Xd(N,It,ht)})}function Sp(N,q){var ht=new Zh;Sn.forEach(N,function(It){var Ft=It.graph().root,Xt=Hd(It,Ft,ht,q);Sn.forEach(Xt.vs,function(oe,he){It.node(oe).order=he}),Mh(It,ht,Xt.vs)})}function lh(N,q){Sn.forEach(q,function(ht){Sn.forEach(ht,function(It,Ft){N.node(It).order=Ft})})}var Zs=jo.Graph,ch=function(N){var q,ht=ju.buildLayerMatrix(N),It=Sn.merge(Df(N,ht),Iv(N,ht)),Ft={};Sn.forEach(["u","d"],function(oe){q=oe==="u"?ht:Sn.values(ht).reverse(),Sn.forEach(["l","r"],function(he){he==="r"&&(q=Sn.map(q,function(cn){return Sn.values(cn).reverse()}));var Te=(oe==="u"?N.predecessors:N.successors).bind(N),Ye=Tv(N,q,It,Te),gn=qp(N,q,Ye.root,Ye.align,he==="r");he==="r"&&(gn=Sn.mapValues(gn,function(cn){return-cn})),Ft[oe+he]=gn})});var Xt=Yc(N,Ft);return Qp(Ft,Xt),Av(Ft,N.graph().align)};function Df(N,q){var ht={};return Sn.reduce(q,function(It,Ft){var Xt=0,oe=0,he=It.length,Te=Sn.last(Ft);return Sn.forEach(Ft,function(Ye,gn){var cn=function(An,ma){if(An.node(ma).dummy)return Sn.find(An.predecessors(ma),function(Or){return An.node(Or).dummy})}(N,Ye),Vn=cn?N.node(cn).order:he;(cn||Ye===Te)&&(Sn.forEach(Ft.slice(oe,gn+1),function(An){Sn.forEach(N.predecessors(An),function(ma){var Or=N.node(ma),Fr=Or.order;!(Fr<Xt||Vn<Fr)||Or.dummy&&N.node(An).dummy||cu(ht,ma,An)})}),oe=gn+1,Xt=Vn)}),Ft}),ht}function Iv(N,q){var ht={};function It(Ft,Xt,oe,he,Te){var Ye;Sn.forEach(Sn.range(Xt,oe),function(gn){Ye=Ft[gn],N.node(Ye).dummy&&Sn.forEach(N.predecessors(Ye),function(cn){var Vn=N.node(cn);Vn.dummy&&(Vn.order<he||Vn.order>Te)&&cu(ht,cn,Ye)})})}return Sn.reduce(q,function(Ft,Xt){var oe,he=-1,Te=0;return Sn.forEach(Xt,function(Ye,gn){if(N.node(Ye).dummy==="border"){var cn=N.predecessors(Ye);cn.length&&(oe=N.node(cn[0]).order,It(Xt,Te,gn,he,oe),Te=gn,he=oe)}It(Xt,Te,Xt.length,oe,Ft.length)}),Xt}),ht}function cu(N,q,ht){if(q>ht){var It=q;q=ht,ht=It}var Ft=N[q];Ft||(N[q]=Ft={}),Ft[ht]=!0}function Yd(N,q,ht){if(q>ht){var It=q;q=ht,ht=It}return Sn.has(N[q],ht)}function Tv(N,q,ht,It){var Ft={},Xt={},oe={};return Sn.forEach(q,function(he){Sn.forEach(he,function(Te,Ye){Ft[Te]=Te,Xt[Te]=Te,oe[Te]=Ye})}),Sn.forEach(q,function(he){var Te=-1;Sn.forEach(he,function(Ye){var gn=It(Ye);if(gn.length)for(var cn=((gn=Sn.sortBy(gn,function(Or){return oe[Or]})).length-1)/2,Vn=Math.floor(cn),An=Math.ceil(cn);Vn<=An;++Vn){var ma=gn[Vn];Xt[Ye]===Ye&&Te<oe[ma]&&!Yd(ht,Ye,ma)&&(Xt[ma]=Ye,Xt[Ye]=Ft[Ye]=Ft[ma],Te=oe[ma])}})}),{root:Ft,align:Xt}}function qp(N,q,ht,It,Ft){var Xt={},oe=function(Ye,gn,cn,Vn){var An=new Zs,ma=Ye.graph(),Or=function(Fr,rr,Za){return function(Xn,ii,Ti){var Ki,Ai=Xn.node(ii),Yo=Xn.node(Ti),bi=0;if(bi+=Ai.width/2,Sn.has(Ai,"labelpos"))switch(Ai.labelpos.toLowerCase()){case"l":Ki=-Ai.width/2;break;case"r":Ki=Ai.width/2}if(Ki&&(bi+=Za?Ki:-Ki),Ki=0,bi+=(Ai.dummy?rr:Fr)/2,bi+=(Yo.dummy?rr:Fr)/2,bi+=Yo.width/2,Sn.has(Yo,"labelpos"))switch(Yo.labelpos.toLowerCase()){case"l":Ki=Yo.width/2;break;case"r":Ki=-Yo.width/2}return Ki&&(bi+=Za?Ki:-Ki),Ki=0,bi}}(ma.nodesep,ma.edgesep,Vn);return Sn.forEach(gn,function(Fr){var rr;Sn.forEach(Fr,function(Za){var Xn=cn[Za];if(An.setNode(Xn),rr){var ii=cn[rr],Ti=An.edge(ii,Xn);An.setEdge(ii,Xn,Math.max(Or(Ye,Za,rr),Ti||0))}rr=Za})}),An}(N,q,ht,Ft),he=Ft?"borderLeft":"borderRight";function Te(Ye,gn){for(var cn=oe.nodes(),Vn=cn.pop(),An={};Vn;)An[Vn]?Ye(Vn):(An[Vn]=!0,cn.push(Vn),cn=cn.concat(gn(Vn))),Vn=cn.pop()}return Te(function(Ye){Xt[Ye]=oe.inEdges(Ye).reduce(function(gn,cn){return Math.max(gn,Xt[cn.v]+oe.edge(cn))},0)},oe.predecessors.bind(oe)),Te(function(Ye){var gn=oe.outEdges(Ye).reduce(function(Vn,An){return Math.min(Vn,Xt[An.w]-oe.edge(An))},Number.POSITIVE_INFINITY),cn=N.node(Ye);gn!==Number.POSITIVE_INFINITY&&cn.borderType!==he&&(Xt[Ye]=Math.max(Xt[Ye],gn))},oe.successors.bind(oe)),Sn.forEach(It,function(Ye){Xt[Ye]=Xt[ht[Ye]]}),Xt}function Yc(N,q){return Sn.minBy(Sn.values(q),function(ht){var It=Number.NEGATIVE_INFINITY,Ft=Number.POSITIVE_INFINITY;return Sn.forIn(ht,function(Xt,oe){var he=function(Te,Ye){return Te.node(Ye).width}(N,oe)/2;It=Math.max(Xt+he,It),Ft=Math.min(Xt-he,Ft)}),It-Ft})}function Qp(N,q){var ht=Sn.values(q),It=Sn.min(ht),Ft=Sn.max(ht);Sn.forEach(["u","d"],function(Xt){Sn.forEach(["l","r"],function(oe){var he,Te=Xt+oe,Ye=N[Te];if(Ye!==q){var gn=Sn.values(Ye);(he=oe==="l"?It-Sn.min(gn):Ft-Sn.max(gn))&&(N[Te]=Sn.mapValues(Ye,function(cn){return cn+he}))}})})}function Av(N,q){return Sn.mapValues(N.ul,function(ht,It){if(q)return N[q.toLowerCase()][It];var Ft=Sn.sortBy(Sn.map(N,It));return(Ft[1]+Ft[2])/2})}var qh=ch,Jp=function(N){(function(q){var ht=ju.buildLayerMatrix(q),It=q.graph().ranksep,Ft=0;Sn.forEach(ht,function(Xt){var oe=Sn.max(Sn.map(Xt,function(he){return q.node(he).height}));Sn.forEach(Xt,function(he){q.node(he).y=Ft+oe/2}),Ft+=oe+It})})(N=ju.asNonCompoundGraph(N)),Sn.forEach(qh(N),function(q,ht){N.node(ht).x=q})},Mv=ju.normalizeRanks,Nv=ju.removeEmptyRanks,Bl=ju,gd=jo.Graph,Of=function(N,q){var ht=q&&q.debugTiming?Bl.time:Bl.notime;ht("layout",function(){var It=ht("  buildLayoutGraph",function(){return function(Ft){var Xt=new gd({multigraph:!0,compound:!0}),oe=yd(Ft.graph());return Xt.setGraph(Sn.merge({},kv,vc(oe,kh),Sn.pick(oe,md))),Sn.forEach(Ft.nodes(),function(he){var Te=yd(Ft.node(he));Xt.setNode(he,Sn.defaults(vc(Te,Kd),tv)),Xt.setParent(he,Ft.parent(he))}),Sn.forEach(Ft.edges(),function(he){var Te=yd(Ft.edge(he));Xt.setEdge(he,Sn.merge({},Vf,vc(Te,Bc),Sn.pick(Te,zl)))}),Xt}(N)});ht("  runLayout",function(){(function(Ft,Xt){Xt("    makeSpaceForEdgeLabels",function(){(function(oe){var he=oe.graph();he.ranksep/=2,Sn.forEach(oe.edges(),function(Te){var Ye=oe.edge(Te);Ye.minlen*=2,Ye.labelpos.toLowerCase()!=="c"&&(he.rankdir==="TB"||he.rankdir==="BT"?Ye.width+=Ye.labeloffset:Ye.height+=Ye.labeloffset)})})(Ft)}),Xt("    removeSelfEdges",function(){(function(oe){Sn.forEach(oe.edges(),function(he){if(he.v===he.w){var Te=oe.node(he.v);Te.selfEdges||(Te.selfEdges=[]),Te.selfEdges.push({e:he,label:oe.edge(he)}),oe.removeEdge(he)}})})(Ft)}),Xt("    acyclic",function(){Wp.run(Ft)}),Xt("    nestingGraph.run",function(){Ud.run(Ft)}),Xt("    rank",function(){_h(Bl.asNonCompoundGraph(Ft))}),Xt("    injectEdgeLabelProxies",function(){(function(oe){Sn.forEach(oe.edges(),function(he){var Te=oe.edge(he);if(Te.width&&Te.height){var Ye=oe.node(he.v),gn={rank:(oe.node(he.w).rank-Ye.rank)/2+Ye.rank,e:he};Bl.addDummyNode(oe,"edge-proxy",gn,"_ep")}})})(Ft)}),Xt("    removeEmptyRanks",function(){Nv(Ft)}),Xt("    nestingGraph.cleanup",function(){Ud.cleanup(Ft)}),Xt("    normalizeRanks",function(){Mv(Ft)}),Xt("    assignRankMinMax",function(){(function(oe){var he=0;Sn.forEach(oe.nodes(),function(Te){var Ye=oe.node(Te);Ye.borderTop&&(Ye.minRank=oe.node(Ye.borderTop).rank,Ye.maxRank=oe.node(Ye.borderBottom).rank,he=Sn.max(he,Ye.maxRank))}),oe.graph().maxRank=he})(Ft)}),Xt("    removeEdgeLabelProxies",function(){(function(oe){Sn.forEach(oe.nodes(),function(he){var Te=oe.node(he);Te.dummy==="edge-proxy"&&(oe.edge(Te.e).labelRank=Te.rank,oe.removeNode(he))})})(Ft)}),Xt("    normalize.run",function(){cd.run(Ft)}),Xt("    parentDummyChains",function(){Ig(Ft)}),Xt("    addBorderSegments",function(){_v(Ft)}),Xt("    order",function(){Ep(Ft)}),Xt("    insertSelfEdges",function(){(function(oe){var he=Bl.buildLayerMatrix(oe);Sn.forEach(he,function(Te){var Ye=0;Sn.forEach(Te,function(gn,cn){var Vn=oe.node(gn);Vn.order=cn+Ye,Sn.forEach(Vn.selfEdges,function(An){Bl.addDummyNode(oe,"selfedge",{width:An.label.width,height:An.label.height,rank:Vn.rank,order:cn+ ++Ye,e:An.e,label:An.label},"_se")}),delete Vn.selfEdges})})})(Ft)}),Xt("    adjustCoordinateSystem",function(){Yp.adjust(Ft)}),Xt("    position",function(){Jp(Ft)}),Xt("    positionSelfEdges",function(){(function(oe){Sn.forEach(oe.nodes(),function(he){var Te=oe.node(he);if(Te.dummy==="selfedge"){var Ye=oe.node(Te.e.v),gn=Ye.x+Ye.width/2,cn=Ye.y,Vn=Te.x-gn,An=Ye.height/2;oe.setEdge(Te.e,Te.label),oe.removeNode(he),Te.label.points=[{x:gn+2*Vn/3,y:cn-An},{x:gn+5*Vn/6,y:cn-An},{x:gn+Vn,y:cn},{x:gn+5*Vn/6,y:cn+An},{x:gn+2*Vn/3,y:cn+An}],Te.label.x=Te.x,Te.label.y=Te.y}})})(Ft)}),Xt("    removeBorderNodes",function(){(function(oe){Sn.forEach(oe.nodes(),function(he){if(oe.children(he).length){var Te=oe.node(he),Ye=oe.node(Te.borderTop),gn=oe.node(Te.borderBottom),cn=oe.node(Sn.last(Te.borderLeft)),Vn=oe.node(Sn.last(Te.borderRight));Te.width=Math.abs(Vn.x-cn.x),Te.height=Math.abs(gn.y-Ye.y),Te.x=cn.x+Te.width/2,Te.y=Ye.y+Te.height/2}}),Sn.forEach(oe.nodes(),function(he){oe.node(he).dummy==="border"&&oe.removeNode(he)})})(Ft)}),Xt("    normalize.undo",function(){cd.undo(Ft)}),Xt("    fixupEdgeLabelCoords",function(){(function(oe){Sn.forEach(oe.edges(),function(he){var Te=oe.edge(he);if(Sn.has(Te,"x"))switch(Te.labelpos!=="l"&&Te.labelpos!=="r"||(Te.width-=Te.labeloffset),Te.labelpos){case"l":Te.x-=Te.width/2+Te.labeloffset;break;case"r":Te.x+=Te.width/2+Te.labeloffset}})})(Ft)}),Xt("    undoCoordinateSystem",function(){Yp.undo(Ft)}),Xt("    translateGraph",function(){(function(oe){var he=Number.POSITIVE_INFINITY,Te=0,Ye=Number.POSITIVE_INFINITY,gn=0,cn=oe.graph(),Vn=cn.marginx||0,An=cn.marginy||0;function ma(Or){var Fr=Or.x,rr=Or.y,Za=Or.width,Xn=Or.height;he=Math.min(he,Fr-Za/2),Te=Math.max(Te,Fr+Za/2),Ye=Math.min(Ye,rr-Xn/2),gn=Math.max(gn,rr+Xn/2)}Sn.forEach(oe.nodes(),function(Or){ma(oe.node(Or))}),Sn.forEach(oe.edges(),function(Or){var Fr=oe.edge(Or);Sn.has(Fr,"x")&&ma(Fr)}),he-=Vn,Ye-=An,Sn.forEach(oe.nodes(),function(Or){var Fr=oe.node(Or);Fr.x-=he,Fr.y-=Ye}),Sn.forEach(oe.edges(),function(Or){var Fr=oe.edge(Or);Sn.forEach(Fr.points,function(rr){rr.x-=he,rr.y-=Ye}),Sn.has(Fr,"x")&&(Fr.x-=he),Sn.has(Fr,"y")&&(Fr.y-=Ye)}),cn.width=Te-he+Vn,cn.height=gn-Ye+An})(Ft)}),Xt("    assignNodeIntersects",function(){(function(oe){Sn.forEach(oe.edges(),function(he){var Te,Ye,gn=oe.edge(he),cn=oe.node(he.v),Vn=oe.node(he.w);gn.points?(Te=gn.points[0],Ye=gn.points[gn.points.length-1]):(gn.points=[],Te=Vn,Ye=cn),gn.points.unshift(Bl.intersectRect(cn,Te)),gn.points.push(Bl.intersectRect(Vn,Ye))})})(Ft)}),Xt("    reversePoints",function(){(function(oe){Sn.forEach(oe.edges(),function(he){var Te=oe.edge(he);Te.reversed&&Te.points.reverse()})})(Ft)}),Xt("    acyclic.undo",function(){Wp.undo(Ft)})})(It,ht)}),ht("  updateInputGraph",function(){(function(Ft,Xt){Sn.forEach(Ft.nodes(),function(oe){var he=Ft.node(oe),Te=Xt.node(oe);he&&(he.x=Te.x,he.y=Te.y,Xt.children(oe).length&&(he.width=Te.width,he.height=Te.height))}),Sn.forEach(Ft.edges(),function(oe){var he=Ft.edge(oe),Te=Xt.edge(oe);he.points=Te.points,Sn.has(Te,"x")&&(he.x=Te.x,he.y=Te.y)}),Ft.graph().width=Xt.graph().width,Ft.graph().height=Xt.graph().height})(N,It)})})},kh=["nodesep","edgesep","ranksep","marginx","marginy"],kv={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},md=["acyclicer","ranker","rankdir","align"],Kd=["width","height"],tv={width:0,height:0},Bc=["minlen","weight","width","height","labeloffset"],Vf={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},zl=["labelpos"];function vc(N,q){return Sn.mapValues(Sn.pick(N,q),Number)}function yd(N){var q={};return Sn.forEach(N,function(ht,It){q[It.toLowerCase()]=ht}),q}var Dv=jo.Graph,ev={graphlib:jo,layout:Of,debug:{debugOrdering:function(N){var q=ju.buildLayerMatrix(N),ht=new Dv({compound:!0,multigraph:!0}).setGraph({});return Sn.forEach(N.nodes(),function(It){ht.setNode(It,{label:It}),ht.setParent(It,"layer"+N.node(It).rank)}),Sn.forEach(N.edges(),function(It){ht.setEdge(It.v,It.w,{},It.name)}),Sn.forEach(q,function(It,Ft){var Xt="layer"+Ft;ht.setNode(Xt,{rank:"same"}),Sn.reduce(It,function(oe,he){return ht.setEdge(oe,he,{style:"invis"}),he})}),ht}},util:{time:ju.time,notime:ju.notime},version:"0.8.5"},Zd=ev.graphlib,nv=ev.layout;class Dh{constructor(q){this.cardinality=1,this.include=L.UNSPECIFIED,this.isGroupNode=!1,this.parentNode=null,this.type=Z.NODE,this.name=q.name,this.attr=q.attr||{},this.inputs=q.inputs,this.path=q.path||[],this.width=q.width,this.height=q.height}}class lf{constructor(){this.nodes={},this.edges=[],this.nodes={},this.edges=[]}}function ci(N){const q=new lf;return N.nodes.map(ht=>new Dh(ht)).forEach(ht=>{q.nodes[ht.name]=ht,ht.inputs.forEach(It=>{(function(Ft,Xt,oe){oe.name!==Xt.name&&Ft.edges.push(Object.assign(Object.assign({},oe.attr),{v:oe.name,w:Xt.name}))})(q,ht,It)})}),q}class rv{constructor(q,ht={}){this.attr=null,this.bridgeGraph=null,this.cardinality=0,this.depth=1,this.include=L.UNSPECIFIED,this.isGroupNode=!0,this.parentNode=null,this.type=Z.META,this.path=[],this.name=q,this.metaGraph=Qh(q,P.META,ht)}getFirstChild(){return this.metaGraph.node(this.metaGraph.nodes()[0])}getChildren(){return this.metaGraph.nodes().map(q=>this.metaGraph.node(q))}leaves(){let q,ht=[],It=[this];for(;It.length;){let Ft=It.shift();Ft.isGroupNode?(q=Ft.metaGraph,q.nodes().forEach(Xt=>It.push(q.node(Xt)))):ht.push(Ft.name)}return ht}}class av{constructor(q,ht){this.v=q,this.w=ht,this.baseEdgeList=[],this.inbound=null,this.name=null}addBaseEdge(q,ht){this.baseEdgeList.push(q)}}function rg(N,q={}){return new rv(N,q)}function qd(N,q){return new av(N,q)}function Qh(N,q,ht){const It=ht||{},Ft=new Zd.Graph(It);return Ft.setGraph({name:N,rankdir:It.rankdir,type:q,align:It.align}),Ft}class jf{constructor(q={}){this.graphOptions=q,this.index={},this.graphOptions.compound=!0,this.root=rg(W,this.graphOptions),this.index[W]=this.root}getNodeMap(){return this.index}node(q){return this.index[q]}setNode(q,ht){this.index[q]=ht}getBridgeGraph(q){const ht=this.index[q];if(!ht)throw Error("Could not find node in hierarchy: "+q);if(!("metaGraph"in ht))return null;const It=ht;if(It.bridgeGraph)return It.bridgeGraph;const Ft=Qh(Q,P.BRIDGE,this.graphOptions);if(It.bridgeGraph=Ft,!ht.parentNode||!("metaGraph"in ht.parentNode))return Ft;const Xt=ht.parentNode;return[Xt.metaGraph,this.getBridgeGraph(Xt.name)].forEach(oe=>{oe.edges().filter(he=>he.v===q||he.w===q).forEach(he=>{const Te=he.w===q;oe.edge(he).baseEdgeList.forEach(Ye=>{const[gn,cn]=Te?[Ye.w,he.v]:[Ye.v,he.w],Vn=this.getChildName(q,gn),An={v:Te?cn:Vn,w:Te?Vn:cn};let ma=Ft.edge(An);ma||(ma=qd(An.v,An.w),ma.inbound=Te,Ft.setEdge(An.v,An.w,ma)),ma.addBaseEdge(Ye,this)})})}),Ft}getChildName(q,ht){let It=this.index[ht];for(;It;){if(It.parentNode&&It.parentNode.name===q)return It.name;It=It.parentNode}throw Error("Could not find immediate child for descendant: "+ht)}getPredecessors(q){const ht=this.index[q];if(!ht)throw Error("Could not find node with name: "+q);return this.getOneWayEdges(ht,!0)}getSuccessors(q){const ht=this.index[q];if(!ht)throw Error("Could not find node with name: "+q);return this.getOneWayEdges(ht,!1)}getOneWayEdges(q,ht){const It=[];if(!q.parentNode||!q.parentNode.isGroupNode)return It;const Ft=q.parentNode,Xt=Ft.metaGraph,oe=this.getBridgeGraph(Ft.name);return Ov(Xt,q,ht,It),Ov(oe,q,ht,It),It}}function ag(N,q){const{rankDirection:ht,align:It}=q,Ft=new jf({rankdir:ht,align:It});return function(Xt,oe){Object.keys(oe.nodes).forEach(he=>{const Te=oe.nodes[he],Ye=Te.path;let gn=Xt.root;gn.depth=Math.max(Ye.length,gn.depth);for(let cn=0;cn<Ye.length&&(gn.depth=Math.max(gn.depth,Ye.length-cn),gn.cardinality+=Te.cardinality,cn!==Ye.length-1);cn++){const Vn=Ye[cn];let An=Xt.node(Vn);An||(An=rg(Vn,Xt.graphOptions),An.path=Te.path.slice(0,cn+1),An.parentNode=gn,Xt.setNode(Vn,An),gn.metaGraph.setNode(Vn,An)),gn=An}Xt.setNode(Te.name,Te),Te.parentNode=gn,gn.metaGraph.setNode(Te.name,Te)})}(Ft,N),function(Xt,oe){const he=Xt.getNodeMap();let Te=[],Ye=[];const gn=(cn,Vn)=>{let An=0;for(;cn;)Vn[An++]=cn.name,cn=cn.parentNode;return An-1};oe.edges.forEach(cn=>{Te=[],Ye=[];let Vn=gn(oe.nodes[cn.v],Te),An=gn(oe.nodes[cn.w],Ye);for(;Te[Vn]===Ye[An];)if(Vn--,An--,Vn<0||An<0)throw Error("No difference found between ancestor paths.");const ma=he[Te[Vn+1]],Or=Te[Vn],Fr=Ye[An];let rr=ma.metaGraph.edge(Or,Fr);rr||(rr=qd(Or,Fr),ma.metaGraph.setEdge(Or,Fr,rr)),rr.addBaseEdge(cn,Xt)})}(Ft,N),Ft}function Ov(N,q,ht,It){(ht?N.inEdges(q.name):N.outEdges(q.name)).forEach(Ft=>{const Xt=N.edge(Ft);It.push(Xt)})}class Cp{constructor(q){this.hierarchy=q,this.index={},this.hasSubHierarchy={},this.root=new vn(this.hierarchy.root,this.hierarchy.graphOptions),this.index[q.root.name]=this.root,this.buildSubHierarchy(q.root.name),this.root.expanded=!0}getRenderInfoNodes(){return Object.values(this.index)}getSubHierarchy(){return this.hasSubHierarchy}buildSubHierarchy(q){if(q in this.hasSubHierarchy)return;this.hasSubHierarchy[q]=!0;const ht=this.index[q];if(ht.node.type!==Z.META)return;const It=ht,Ft=It.node.metaGraph,Xt=It.coreGraph;Ft.nodes().forEach(gn=>{const cn=this.getOrCreateRenderNodeByName(gn);Xt.setNode(gn,cn)}),Ft.edges().forEach(gn=>{const cn=Ft.edge(gn),Vn=new ce(cn);Xt.setEdge(gn.v,gn.w,Vn)});const oe=It.node.parentNode;if(!oe)return;const he=this.getRenderNodeByName(oe.name),Te=(gn,...cn)=>cn.concat([gn?"IN":"OUT"]).join("~~"),Ye=this.hierarchy.getBridgeGraph(q);Ye.edges().forEach(gn=>{const cn=Ye.edge(gn),Vn=!!Ft.node(gn.w),[An,ma]=Vn?[gn.w,gn.v]:[gn.v,gn.w],Or=Ti=>{const Ki=Vn?{v:Ti,w:q}:{v:q,w:Ti};return he.coreGraph.edge(Ki)};let Fr=Or(ma);Fr||(Fr=Or(Te(Vn,ma,oe.name)));const rr=Te(Vn,q),Za=Te(Vn,ma,q);let Xn=Xt.node(Za);if(!Xn){let Ti=Xt.node(rr);if(!Ti){const Ai={name:rr,type:Z.BRIDGE,isGroupNode:!1,cardinality:0,parentNode:null,include:L.UNSPECIFIED,inbound:Vn,attr:{}};Ti=new Zl(Ai),this.index[rr]=Ti,Xt.setNode(rr,Ti)}const Ki={name:Za,type:Z.BRIDGE,isGroupNode:!1,cardinality:1,parentNode:null,include:L.UNSPECIFIED,inbound:Vn,attr:{}};Xn=new Zl(Ki),this.index[Za]=Xn,Xt.setNode(Za,Xn),Xt.setParent(Za,rr),Ti.node.cardinality++}const ii=new ce(cn);ii.adjoiningMetaEdge=Fr,Vn?Xt.setEdge(Za,An,ii):Xt.setEdge(An,Za,ii)})}getOrCreateRenderNodeByName(q){if(!q)return null;if(q in this.index)return this.index[q];const ht=this.getNodeByName(q);return ht?(this.index[q]=ht.isGroupNode?new vn(ht,this.hierarchy.graphOptions):new Zl(ht),this.index[q]):null}getRenderNodeByName(q){return this.index[q]}getNodeByName(q){return this.hierarchy.node(q)}}class Zl{constructor(q){this.node=q,this.expanded=!1,this.x=0,this.y=0,this.coreBox={width:0,height:0},this.outboxWidth=0,this.labelOffset=0,this.radius=0,this.labelHeight=0,this.paddingTop=0,this.paddingLeft=0,this.paddingRight=0,this.paddingBottom=0,this.width=q.width||0,this.height=q.height||0,this.displayName=q.name,this.attr=q.attr}}class ce{constructor(q){this.metaEdge=q,this.adjoiningMetaEdge=null,this.weight=1,this.points=[]}}class vn extends Zl{constructor(q,ht){super(q);const It=q.metaGraph.graph();ht.compound=!0,this.coreGraph=Qh(It.name,P.CORE,ht)}}function er(N,q){N.node.isGroupNode&&function(ht,It){const Ft=tt(It);ht.coreGraph.nodes().map(Xt=>ht.coreGraph.node(Xt)).forEach(Xt=>{var oe,he,Te,Ye,gn,cn;const{height:Vn,width:An}=Xt;switch(Xt.node.type){case Z.NODE:Object.assign(Xt,Ft.nodeSize.node),Xt.height=Vn||Ft.nodeSize.node.height,Xt.width=An||Ft.nodeSize.node.width;break;case Z.BRIDGE:Object.assign(Xt,Ft.nodeSize.bridge);break;case Z.META:Xt.expanded?er(Xt,It):(Object.assign(Xt,Ft.nodeSize.meta),Xt.height=Ft.nodeSize.meta.height,Xt.width=Ft.nodeSize.meta.width);break;default:throw Error("Unrecognized node type: "+Xt.node.type)}if(!Xt.expanded){const ma=Xt.attr;(function(Or,Fr=!1){if(Or.coreBox.width=Or.width,Or.coreBox.height=Or.height,!Fr){const rr=`${Or.displayName}`.length,Za=3;Or.width=Math.max(Or.coreBox.width,rr*Za)}})(Xt,It&&(Xt.node.type===0&&!!((he=(oe=It==null?void 0:It.nodeSize)===null||oe===void 0?void 0:oe.meta)===null||he===void 0?void 0:he.width)||Xt.node.type===1&&(!!((Ye=(Te=It==null?void 0:It.nodeSize)===null||Te===void 0?void 0:Te.node)===null||Ye===void 0?void 0:Ye.width)||!!ma.width)||Xt.node.type===2&&!!((cn=(gn=It==null?void 0:It.nodeSize)===null||gn===void 0?void 0:gn.bridge)===null||cn===void 0?void 0:cn.width)))}})}(N,q),N.node.type===Z.META&&function(ht,It){const Ft=tt(It),Xt=Ft.subScene.meta;Object.assign(ht,Xt);const{nodeSep:oe,rankSep:he,edgeSep:Te,align:Ye}=Ft.graph.meta,gn={nodesep:oe,ranksep:he,edgesep:Te,align:Ye};Object.assign(ht.coreBox,function(An,ma){const{ranksep:Or,nodesep:Fr,edgesep:rr,align:Za}=ma;Object.assign(An.graph(),{ranksep:Or,nodesep:Fr,edgesep:rr,align:Za});const Xn=[];if(An.nodes().forEach(Yo=>{An.node(Yo).node.type!==Z.BRIDGE&&Xn.push(Yo)}),!Xn.length)return{width:0,height:0};nv(An);let ii=1/0,Ti=1/0,Ki=-1/0,Ai=-1/0;return Xn.forEach(Yo=>{const bi=An.node(Yo),Lu=.5*bi.width,as=bi.x-Lu,gl=bi.x+Lu;ii=as<ii?as:ii,Ki=gl>Ki?gl:Ki;const fu=.5*bi.height,Rs=bi.y-fu,Eu=bi.y+fu;Ti=Rs<Ti?Rs:Ti,Ai=Eu>Ai?Eu:Ai}),An.edges().forEach(Yo=>{const bi=An.edge(Yo),Lu=An.node(bi.metaEdge.v),as=An.node(bi.metaEdge.w);if(bi.points.length===3&&function(Rs){let Eu=ia(Rs[0],Rs[1]);for(let gu=1;gu<Rs.length-1;gu++){const zi=ia(Rs[gu],Rs[gu+1]);if(Math.abs(zi-Eu)>1)return!1;Eu=zi}return!0}(bi.points)){if(Lu!=null){const Rs=Lu.expanded?Lu.x:da(Lu);bi.points[0].x=Rs}if(as!=null){const Rs=as.expanded?as.x:da(as);bi.points[2].x=Rs}bi.points=[bi.points[0],bi.points[1]]}const gl=bi.points[bi.points.length-2];as!=null&&(bi.points[bi.points.length-1]=aa(gl,as));const fu=bi.points[1];Lu!=null&&(bi.points[0]=aa(fu,Lu)),bi.points.forEach(Rs=>{ii=Rs.x<ii?Rs.x:ii,Ki=Rs.x>Ki?Rs.x:Ki,Ti=Rs.y<Ti?Rs.y:Ti,Ai=Rs.y>Ai?Rs.y:Ai})}),An.nodes().forEach(Yo=>{const bi=An.node(Yo);bi.x-=ii,bi.y-=Ti}),An.edges().forEach(Yo=>{An.edge(Yo).points.forEach(bi=>{bi.x-=ii,bi.y-=Ti})}),{width:Ki-ii,height:Ai-Ti}}(ht.coreGraph,gn));let cn=0;ht.coreGraph.nodeCount()>0&&cn++;const Vn=cn<=1?0:cn;ht.coreBox.width+=Vn+Vn,ht.coreBox.height=Xt.labelHeight+ht.coreBox.height,ht.width=ht.coreBox.width+Xt.paddingLeft+Xt.paddingRight,ht.height=ht.paddingTop+ht.coreBox.height+ht.paddingBottom}(N,q)}function ia(N,q){const ht=q.x-N.x,It=q.y-N.y;return 180*Math.atan(It/ht)/Math.PI}function da(N){return N.expanded?N.x:N.x-N.width/2+0+N.coreBox.width/2}function aa(N,q){const ht=q.expanded?q.x:da(q),It=q.y,Ft=N.x-ht,Xt=N.y-It;let oe,he,Te=q.expanded?q.width:q.coreBox.width,Ye=q.expanded?q.height:q.coreBox.height;return Math.abs(Xt)*Te/2>Math.abs(Ft)*Ye/2?(Xt<0&&(Ye=-Ye),oe=Xt===0?0:Ye/2*Ft/Xt,he=Ye/2):(Ft<0&&(Te=-Te),oe=Te/2,he=Ft===0?0:Te/2*Xt/Ft),{x:ht+oe,y:It+he}}function na(N,q,ht){var It,Ft,Xt,oe;const he=N.nodes.filter((cn,Vn,An)=>An.findIndex(ma=>ma.id===cn.id)!==Vn).map(cn=>cn.id);if(he.length)throw new Error(`Duplicated ids found: ${he.join(", ")}`);const Te=function(cn){const Vn={nodes:[]},An=cn.compound,ma=Object.keys(An||{}),Or=new Map,Fr=(Za,Xn=[])=>{if(Or.has(Za))return Or.get(Za);for(let ii=0;ii<ma.length;ii++){let Ti=ma[ii];if(An&&An[Ti].indexOf(Za)!==-1)return Xn.unshift(Ti),Fr(Ti,Xn)}return Xn.length===0&&Or.set(Za,Xn),Xn},rr=Za=>cn.edges.filter(Xn=>Xn.w===Za).map(Xn=>({name:Xn.v}));return cn.nodes.forEach(Za=>{const Xn=Za.id,ii=[...Fr(Xn),Xn];let Ti=rr(Xn);Vn.nodes.push({name:Xn,path:ii,inputs:Ti,width:Za.width,height:Za.height,attr:Object.assign({},Za)})}),Vn}(N),Ye=function(cn,Vn){const An=(Or,Fr)=>{for(let rr of Fr.values())if(rr.includes(Or))return!0;return!1},ma=(Or,Fr=[])=>{if(Object.keys(Or).length===0)return[...new Set(Fr)];const rr=new Map(Object.keys(Or).map(Xn=>[Xn,Or[Xn]])),Za={};for(let[Xn,ii]of rr)An(Xn,rr)?Za[Xn]=ii:Fr=Fr.concat(Xn,ii);return ma(Za,Fr)};return ma(cn).filter(Or=>Vn.includes(Or))}(N.compound||{},(q==null?void 0:q.expanded)||[]),gn=function(cn,Vn){return function(An){return new Cp(An)}(ag(ci(cn),Vn))}(Te,{rankDirection:((Ft=(It=ht==null?void 0:ht.graph)===null||It===void 0?void 0:It.meta)===null||Ft===void 0?void 0:Ft.rankDir)||(q==null?void 0:q.rankDirection)||X.graph.meta.rankDir,align:((oe=(Xt=ht==null?void 0:ht.graph)===null||Xt===void 0?void 0:Xt.meta)===null||oe===void 0?void 0:oe.align)||X.graph.meta.align});return function(cn,Vn){Vn.forEach(An=>{const ma=cn.getRenderInfoNodes().find(rr=>rr.displayName===An);let Or=ma&&ma.node&&ma.node.name||"";const Fr=cn.getRenderNodeByName(Or);if(!Fr)throw new Error(`No nodes found: ${Or}`);Fr.expanded=!0,cn.buildSubHierarchy(Or)})}(gn,Ye),er(gn.root,ht),Qa(gn.root)}function Xa(N,q=!1){const ht=JSON.parse(JSON.stringify(N)),It={nodes:[ht],edges:[...ht.edges]};return ht.nodes.forEach(function Ft(Xt){(Xt.type===0||Xt.type===1)&&It.nodes.push(Xt),Xt.type===0&&(It.edges=It.edges.concat(Xt.edges)),Array.isArray(Xt.nodes)&&Xt.nodes.forEach(Ft)}),q&&It.nodes.forEach(Ft=>{const Xt=It.nodes.find(oe=>oe.id===Ft.parentNodeName);if(Xt){const oe=Xt.x-Xt.width/2+Xt.paddingLeft,he=Xt.y-Xt.height/2+Xt.labelHeight+Xt.paddingTop;Xt.id!==W&&(Ft.x+=oe,Ft.y+=he),Ft.type===0&&Ft.edges.forEach(Te=>{Te.points.forEach(Ye=>{Ye.x+=Ft.x-Ft.width/2+Ft.paddingLeft,Ye.y+=Ft.y-Ft.height/2+Ft.labelHeight+Ft.paddingTop})})}}),It}function Oa(N,q,ht,It){var Ft,Xt;let oe=[];const he=((Ft=ht.find(cn=>cn.id===N))===null||Ft===void 0?void 0:Ft.path)||[],Te=((Xt=ht.find(cn=>cn.id===q))===null||Xt===void 0?void 0:Xt.path)||[],Ye=[W,...he].slice(0,he.length).reverse(),gn=[W,...Te].slice(0,Te.length);return Ye.forEach(cn=>{const Vn=ht.find(An=>An.id===cn);oe=oe.concat(Vn.edges.filter(An=>An.baseEdgeList.some(ma=>ma.v===((It==null?void 0:It.v)||N)&&ma.w===((It==null?void 0:It.w)||q))))}),gn.filter(cn=>!Ye.includes(cn)).forEach(cn=>{const Vn=ht.find(An=>An.id===cn);oe=oe.concat(Vn.edges.filter(An=>An.baseEdgeList.some(ma=>ma.v===((It==null?void 0:It.v)||N)&&ma.w===((It==null?void 0:It.w)||q))))}),oe}function Qa(N){const q=N.coreGraph.nodes().map(It=>N.coreGraph.node(It));return Object.assign(Object.assign({},Ka(N)),{expanded:N.expanded,nodes:N.expanded?(ht=q,ht.map(It=>It.node.type===Z.META?Qa(It):Ka(It))):[],edges:N.expanded?zn(N):[]});var ht}function Ka(N){return{id:N.node.name,name:N.node.name,type:N.node.type,cardinality:N.node.cardinality,attr:N.attr,parentNodeName:N.node.parentNode?N.node.parentNode.name:null,coreBox:Object.assign({},N.coreBox),x:N.x,y:N.y,width:N.width,height:N.height,radius:N.radius,labelHeight:N.labelHeight,labelOffset:N.labelOffset,outboxWidth:N.outboxWidth,paddingLeft:N.paddingLeft,paddingTop:N.paddingTop,paddingRight:N.paddingRight,paddingBottom:N.paddingBottom,path:N.node.path}}function zn(N){return N.coreGraph.edges().map(q=>({renderInfoEdge:N.coreGraph.edge(q),edge:q})).filter(({renderInfoEdge:q})=>q.metaEdge).map(({edge:q,renderInfoEdge:ht})=>{const It=function(Ft,Xt){const oe=Xt.points.map(he=>Object.assign({},he));if(Xt.adjoiningMetaEdge){const he=Xt.adjoiningMetaEdge.points,Te=Xt.metaEdge.inbound,Ye=Te?he[he.length-1]:he[0],gn=oe[Te?0:oe.length-1],cn=Ft.x-Ft.width/2,Vn=Ft.y-Ft.height/2,An=Ye.x-cn,ma=Ye.y-Vn,Or=-Ft.paddingLeft,Fr=-(Ft.paddingTop+Ft.labelHeight);gn.x=An+Or,gn.y=ma+Fr}return oe}(N,ht);return{adjoiningEdge:ht.adjoiningMetaEdge?{w:ht.adjoiningMetaEdge.metaEdge.w,v:ht.adjoiningMetaEdge.metaEdge.v}:null,inbound:ht.metaEdge.inbound,w:q.w,v:q.v,points:It,weight:ht.weight,baseEdgeList:ht.metaEdge.baseEdgeList,parentNodeName:N.node.name}})}},49685:function(sr,it,$){"use strict";$.r(it),$.d(it,{EPSILON:function(){return X},ARRAY_TYPE:function(){return tt},RANDOM:function(){return j},setMatrixArrayType:function(){return W},toRadian:function(){return Z},equals:function(){return L}});var X=1e-6,tt=typeof Float32Array!="undefined"?Float32Array:Array,j=Math.random;function W(P){tt=P}var Q=Math.PI/180;function Z(P){return P*Q}function L(P,C){return Math.abs(P-C)<=X*Math.max(1,Math.abs(P),Math.abs(C))}Math.hypot||(Math.hypot=function(){for(var P=0,C=arguments.length;C--;)P+=arguments[C]*arguments[C];return Math.sqrt(P)})},64530:function(sr,it,$){"use strict";$.r(it),$.d(it,{glMatrix:function(){return L},mat2:function(){return X},mat2d:function(){return tt},mat3:function(){return xr},mat4:function(){return j},quat:function(){return Q},quat2:function(){return Z},vec2:function(){return ef},vec3:function(){return Mi},vec4:function(){return W}});var X={};$.r(X),$.d(X,{LDU:function(){return ot},add:function(){return pt},adjoint:function(){return O},clone:function(){return C},copy:function(){return M},create:function(){return P},determinant:function(){return _},equals:function(){return se},exactEquals:function(){return Gt},frob:function(){return wt},fromRotation:function(){return ut},fromScaling:function(){return dt},fromValues:function(){return B},identity:function(){return k},invert:function(){return K},mul:function(){return ke},multiply:function(){return ft},multiplyScalar:function(){return ie},multiplyScalarAndAdd:function(){return Be},rotate:function(){return mt},scale:function(){return st},set:function(){return R},str:function(){return gt},sub:function(){return we},subtract:function(){return Nt},transpose:function(){return F}});var tt={};$.r(tt),$.d(tt,{add:function(){return Pt},clone:function(){return Yt},copy:function(){return be},create:function(){return At},determinant:function(){return Ze},equals:function(){return Rt},exactEquals:function(){return fn},frob:function(){return ee},fromRotation:function(){return Ge},fromScaling:function(){return te},fromTranslation:function(){return Me},fromValues:function(){return Ee},identity:function(){return nn},invert:function(){return Le},mul:function(){return Yn},multiply:function(){return fe},multiplyScalar:function(){return Ne},multiplyScalarAndAdd:function(){return tn},rotate:function(){return Re},scale:function(){return He},set:function(){return le},str:function(){return We},sub:function(){return Un},subtract:function(){return yt},translate:function(){return pe}});var j={};$.r(j),$.d(j,{add:function(){return _r},adjoint:function(){return ar},clone:function(){return Ur},copy:function(){return fa},create:function(){return cr},determinant:function(){return Fn},equals:function(){return Ni},exactEquals:function(){return _i},frob:function(){return Qn},fromQuat:function(){return bt},fromQuat2:function(){return an},fromRotation:function(){return ta},fromRotationTranslation:function(){return _n},fromRotationTranslationScale:function(){return H},fromRotationTranslationScaleOrigin:function(){return Y},fromScaling:function(){return Tr},fromTranslation:function(){return vr},fromValues:function(){return Sa},fromXRotation:function(){return ra},fromYRotation:function(){return Zr},fromZRotation:function(){return vt},frustum:function(){return $t},getRotation:function(){return at},getScaling:function(){return kt},getTranslation:function(){return Lt},identity:function(){return Da},invert:function(){return Mn},lookAt:function(){return Ln},mul:function(){return vi},multiply:function(){return tr},multiplyScalar:function(){return La},multiplyScalarAndAdd:function(){return ha},ortho:function(){return Ve},orthoNO:function(){return Je},orthoZO:function(){return qn},perspective:function(){return Ht},perspectiveFromFieldOfView:function(){return on},perspectiveNO:function(){return jt},perspectiveZO:function(){return re},rotate:function(){return Hr},rotateX:function(){return Ea},rotateY:function(){return lr},rotateZ:function(){return Cr},scale:function(){return jr},set:function(){return sa},str:function(){return Ca},sub:function(){return si},subtract:function(){return ea},targetTo:function(){return qr},translate:function(){return Gn},transpose:function(){return Rr}});var W={};$.r(W),$.d(W,{add:function(){return Bn},ceil:function(){return Fa},clone:function(){return un},copy:function(){return hn},create:function(){return Pa},cross:function(){return mu},dist:function(){return bu},distance:function(){return Wo},div:function(){return tl},divide:function(){return ya},dot:function(){return zs},equals:function(){return ls},exactEquals:function(){return Wi},floor:function(){return ui},forEach:function(){return Vs},fromValues:function(){return Oe},inverse:function(){return Do},len:function(){return ka},length:function(){return wi},lerp:function(){return ds},max:function(){return oo},min:function(){return Ei},mul:function(){return Es},multiply:function(){return Lr},negate:function(){return us},normalize:function(){return Io},random:function(){return Ms},round:function(){return po},scale:function(){return bo},scaleAndAdd:function(){return ts},set:function(){return Hn},sqrDist:function(){return Ys},sqrLen:function(){return Ku},squaredDistance:function(){return Yi},squaredLength:function(){return gi},str:function(){return qo},sub:function(){return is},subtract:function(){return Jn},transformMat4:function(){return yu},transformQuat:function(){return uu},zero:function(){return Cs}});var Q={};$.r(Q),$.d(Q,{add:function(){return pl},calculateW:function(){return Qi},clone:function(){return Ks},conjugate:function(){return ms},copy:function(){return lu},create:function(){return Ro},dot:function(){return Bu},equals:function(){return ys},exactEquals:function(){return ol},exp:function(){return Co},fromEuler:function(){return dl},fromMat3:function(){return xu},fromValues:function(){return el},getAngle:function(){return Zu},getAxisAngle:function(){return eu},identity:function(){return Ns},invert:function(){return ou},len:function(){return nu},length:function(){return wu},lerp:function(){return Au},ln:function(){return to},mul:function(){return ns},multiply:function(){return bn},normalize:function(){return Sl},pow:function(){return xo},random:function(){return vo},rotateX:function(){return Xr},rotateY:function(){return pa},rotateZ:function(){return Ra},rotationTo:function(){return vl},scale:function(){return _s},set:function(){return Du},setAxes:function(){return Dl},setAxisAngle:function(){return tu},slerp:function(){return gs},sqlerp:function(){return kc},sqrLen:function(){return xc},squaredLength:function(){return Tl},str:function(){return kl}});var Z={};$.r(Z),$.d(Z,{add:function(){return To},clone:function(){return _e},conjugate:function(){return Mu},copy:function(){return Kt},create:function(){return Ol},dot:function(){return ws},equals:function(){return wc},exactEquals:function(){return Dc},fromMat4:function(){return Zn},fromRotation:function(){return En},fromRotationTranslation:function(){return ae},fromRotationTranslationValues:function(){return Bt},fromTranslation:function(){return me},fromValues:function(){return ve},getDual:function(){return xn},getReal:function(){return sn},getTranslation:function(){return Aa},identity:function(){return ge},invert:function(){return Hs},len:function(){return Cl},length:function(){return nl},lerp:function(){return ks},mul:function(){return Vo},multiply:function(){return wo},normalize:function(){return rl},rotateAroundAxis:function(){return _o},rotateByQuatAppend:function(){return Di},rotateByQuatPrepend:function(){return Si},rotateX:function(){return Ba},rotateY:function(){return oi},rotateZ:function(){return ro},scale:function(){return js},set:function(){return Ae},setDual:function(){return $r},setReal:function(){return ir},sqrLen:function(){return sl},squaredLength:function(){return Yl},str:function(){return _f},translate:function(){return Va}});var L=$(49685);function P(){var A=new L.ARRAY_TYPE(4);return L.ARRAY_TYPE!=Float32Array&&(A[1]=0,A[2]=0),A[0]=1,A[3]=1,A}function C(A){var nt=new L.ARRAY_TYPE(4);return nt[0]=A[0],nt[1]=A[1],nt[2]=A[2],nt[3]=A[3],nt}function M(A,nt){return A[0]=nt[0],A[1]=nt[1],A[2]=nt[2],A[3]=nt[3],A}function k(A){return A[0]=1,A[1]=0,A[2]=0,A[3]=1,A}function B(A,nt,Zt,de){var Pe=new L.ARRAY_TYPE(4);return Pe[0]=A,Pe[1]=nt,Pe[2]=Zt,Pe[3]=de,Pe}function R(A,nt,Zt,de,Pe){return A[0]=nt,A[1]=Zt,A[2]=de,A[3]=Pe,A}function F(A,nt){if(A===nt){var Zt=nt[1];A[1]=nt[2],A[2]=Zt}else A[0]=nt[0],A[1]=nt[2],A[2]=nt[1],A[3]=nt[3];return A}function K(A,nt){var Zt=nt[0],de=nt[1],Pe=nt[2],Qe=nt[3],rn=Zt*Qe-Pe*de;return rn?(rn=1/rn,A[0]=Qe*rn,A[1]=-de*rn,A[2]=-Pe*rn,A[3]=Zt*rn,A):null}function O(A,nt){var Zt=nt[0];return A[0]=nt[3],A[1]=-nt[1],A[2]=-nt[2],A[3]=Zt,A}function _(A){return A[0]*A[3]-A[2]*A[1]}function ft(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=Zt[0],kn=Zt[1],De=Zt[2],wr=Zt[3];return A[0]=de*wn+Qe*kn,A[1]=Pe*wn+rn*kn,A[2]=de*De+Qe*wr,A[3]=Pe*De+rn*wr,A}function mt(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=Math.sin(Zt),kn=Math.cos(Zt);return A[0]=de*kn+Qe*wn,A[1]=Pe*kn+rn*wn,A[2]=de*-wn+Qe*kn,A[3]=Pe*-wn+rn*kn,A}function st(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=Zt[0],kn=Zt[1];return A[0]=de*wn,A[1]=Pe*wn,A[2]=Qe*kn,A[3]=rn*kn,A}function ut(A,nt){var Zt=Math.sin(nt),de=Math.cos(nt);return A[0]=de,A[1]=Zt,A[2]=-Zt,A[3]=de,A}function dt(A,nt){return A[0]=nt[0],A[1]=0,A[2]=0,A[3]=nt[1],A}function gt(A){return"mat2("+A[0]+", "+A[1]+", "+A[2]+", "+A[3]+")"}function wt(A){return Math.hypot(A[0],A[1],A[2],A[3])}function ot(A,nt,Zt,de){return A[2]=de[2]/de[0],Zt[0]=de[0],Zt[1]=de[1],Zt[3]=de[3]-A[2]*Zt[1],[A,nt,Zt]}function pt(A,nt,Zt){return A[0]=nt[0]+Zt[0],A[1]=nt[1]+Zt[1],A[2]=nt[2]+Zt[2],A[3]=nt[3]+Zt[3],A}function Nt(A,nt,Zt){return A[0]=nt[0]-Zt[0],A[1]=nt[1]-Zt[1],A[2]=nt[2]-Zt[2],A[3]=nt[3]-Zt[3],A}function Gt(A,nt){return A[0]===nt[0]&&A[1]===nt[1]&&A[2]===nt[2]&&A[3]===nt[3]}function se(A,nt){var Zt=A[0],de=A[1],Pe=A[2],Qe=A[3],rn=nt[0],wn=nt[1],kn=nt[2],De=nt[3];return Math.abs(Zt-rn)<=L.EPSILON*Math.max(1,Math.abs(Zt),Math.abs(rn))&&Math.abs(de-wn)<=L.EPSILON*Math.max(1,Math.abs(de),Math.abs(wn))&&Math.abs(Pe-kn)<=L.EPSILON*Math.max(1,Math.abs(Pe),Math.abs(kn))&&Math.abs(Qe-De)<=L.EPSILON*Math.max(1,Math.abs(Qe),Math.abs(De))}function ie(A,nt,Zt){return A[0]=nt[0]*Zt,A[1]=nt[1]*Zt,A[2]=nt[2]*Zt,A[3]=nt[3]*Zt,A}function Be(A,nt,Zt,de){return A[0]=nt[0]+Zt[0]*de,A[1]=nt[1]+Zt[1]*de,A[2]=nt[2]+Zt[2]*de,A[3]=nt[3]+Zt[3]*de,A}var ke=ft,we=Nt;function At(){var A=new L.ARRAY_TYPE(6);return L.ARRAY_TYPE!=Float32Array&&(A[1]=0,A[2]=0,A[4]=0,A[5]=0),A[0]=1,A[3]=1,A}function Yt(A){var nt=new L.ARRAY_TYPE(6);return nt[0]=A[0],nt[1]=A[1],nt[2]=A[2],nt[3]=A[3],nt[4]=A[4],nt[5]=A[5],nt}function be(A,nt){return A[0]=nt[0],A[1]=nt[1],A[2]=nt[2],A[3]=nt[3],A[4]=nt[4],A[5]=nt[5],A}function nn(A){return A[0]=1,A[1]=0,A[2]=0,A[3]=1,A[4]=0,A[5]=0,A}function Ee(A,nt,Zt,de,Pe,Qe){var rn=new L.ARRAY_TYPE(6);return rn[0]=A,rn[1]=nt,rn[2]=Zt,rn[3]=de,rn[4]=Pe,rn[5]=Qe,rn}function le(A,nt,Zt,de,Pe,Qe,rn){return A[0]=nt,A[1]=Zt,A[2]=de,A[3]=Pe,A[4]=Qe,A[5]=rn,A}function Le(A,nt){var Zt=nt[0],de=nt[1],Pe=nt[2],Qe=nt[3],rn=nt[4],wn=nt[5],kn=Zt*Qe-de*Pe;return kn?(kn=1/kn,A[0]=Qe*kn,A[1]=-de*kn,A[2]=-Pe*kn,A[3]=Zt*kn,A[4]=(Pe*wn-Qe*rn)*kn,A[5]=(de*rn-Zt*wn)*kn,A):null}function Ze(A){return A[0]*A[3]-A[1]*A[2]}function fe(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=nt[4],kn=nt[5],De=Zt[0],wr=Zt[1],ca=Zt[2],Ar=Zt[3],ua=Zt[4],$a=Zt[5];return A[0]=de*De+Qe*wr,A[1]=Pe*De+rn*wr,A[2]=de*ca+Qe*Ar,A[3]=Pe*ca+rn*Ar,A[4]=de*ua+Qe*$a+wn,A[5]=Pe*ua+rn*$a+kn,A}function Re(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=nt[4],kn=nt[5],De=Math.sin(Zt),wr=Math.cos(Zt);return A[0]=de*wr+Qe*De,A[1]=Pe*wr+rn*De,A[2]=de*-De+Qe*wr,A[3]=Pe*-De+rn*wr,A[4]=wn,A[5]=kn,A}function He(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=nt[4],kn=nt[5],De=Zt[0],wr=Zt[1];return A[0]=de*De,A[1]=Pe*De,A[2]=Qe*wr,A[3]=rn*wr,A[4]=wn,A[5]=kn,A}function pe(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=nt[4],kn=nt[5],De=Zt[0],wr=Zt[1];return A[0]=de,A[1]=Pe,A[2]=Qe,A[3]=rn,A[4]=de*De+Qe*wr+wn,A[5]=Pe*De+rn*wr+kn,A}function Ge(A,nt){var Zt=Math.sin(nt),de=Math.cos(nt);return A[0]=de,A[1]=Zt,A[2]=-Zt,A[3]=de,A[4]=0,A[5]=0,A}function te(A,nt){return A[0]=nt[0],A[1]=0,A[2]=0,A[3]=nt[1],A[4]=0,A[5]=0,A}function Me(A,nt){return A[0]=1,A[1]=0,A[2]=0,A[3]=1,A[4]=nt[0],A[5]=nt[1],A}function We(A){return"mat2d("+A[0]+", "+A[1]+", "+A[2]+", "+A[3]+", "+A[4]+", "+A[5]+")"}function ee(A){return Math.hypot(A[0],A[1],A[2],A[3],A[4],A[5],1)}function Pt(A,nt,Zt){return A[0]=nt[0]+Zt[0],A[1]=nt[1]+Zt[1],A[2]=nt[2]+Zt[2],A[3]=nt[3]+Zt[3],A[4]=nt[4]+Zt[4],A[5]=nt[5]+Zt[5],A}function yt(A,nt,Zt){return A[0]=nt[0]-Zt[0],A[1]=nt[1]-Zt[1],A[2]=nt[2]-Zt[2],A[3]=nt[3]-Zt[3],A[4]=nt[4]-Zt[4],A[5]=nt[5]-Zt[5],A}function Ne(A,nt,Zt){return A[0]=nt[0]*Zt,A[1]=nt[1]*Zt,A[2]=nt[2]*Zt,A[3]=nt[3]*Zt,A[4]=nt[4]*Zt,A[5]=nt[5]*Zt,A}function tn(A,nt,Zt,de){return A[0]=nt[0]+Zt[0]*de,A[1]=nt[1]+Zt[1]*de,A[2]=nt[2]+Zt[2]*de,A[3]=nt[3]+Zt[3]*de,A[4]=nt[4]+Zt[4]*de,A[5]=nt[5]+Zt[5]*de,A}function fn(A,nt){return A[0]===nt[0]&&A[1]===nt[1]&&A[2]===nt[2]&&A[3]===nt[3]&&A[4]===nt[4]&&A[5]===nt[5]}function Rt(A,nt){var Zt=A[0],de=A[1],Pe=A[2],Qe=A[3],rn=A[4],wn=A[5],kn=nt[0],De=nt[1],wr=nt[2],ca=nt[3],Ar=nt[4],ua=nt[5];return Math.abs(Zt-kn)<=L.EPSILON*Math.max(1,Math.abs(Zt),Math.abs(kn))&&Math.abs(de-De)<=L.EPSILON*Math.max(1,Math.abs(de),Math.abs(De))&&Math.abs(Pe-wr)<=L.EPSILON*Math.max(1,Math.abs(Pe),Math.abs(wr))&&Math.abs(Qe-ca)<=L.EPSILON*Math.max(1,Math.abs(Qe),Math.abs(ca))&&Math.abs(rn-Ar)<=L.EPSILON*Math.max(1,Math.abs(rn),Math.abs(Ar))&&Math.abs(wn-ua)<=L.EPSILON*Math.max(1,Math.abs(wn),Math.abs(ua))}var Yn=fe,Un=yt,xr=$(35600);function cr(){var A=new L.ARRAY_TYPE(16);return L.ARRAY_TYPE!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[11]=0,A[12]=0,A[13]=0,A[14]=0),A[0]=1,A[5]=1,A[10]=1,A[15]=1,A}function Ur(A){var nt=new L.ARRAY_TYPE(16);return nt[0]=A[0],nt[1]=A[1],nt[2]=A[2],nt[3]=A[3],nt[4]=A[4],nt[5]=A[5],nt[6]=A[6],nt[7]=A[7],nt[8]=A[8],nt[9]=A[9],nt[10]=A[10],nt[11]=A[11],nt[12]=A[12],nt[13]=A[13],nt[14]=A[14],nt[15]=A[15],nt}function fa(A,nt){return A[0]=nt[0],A[1]=nt[1],A[2]=nt[2],A[3]=nt[3],A[4]=nt[4],A[5]=nt[5],A[6]=nt[6],A[7]=nt[7],A[8]=nt[8],A[9]=nt[9],A[10]=nt[10],A[11]=nt[11],A[12]=nt[12],A[13]=nt[13],A[14]=nt[14],A[15]=nt[15],A}function Sa(A,nt,Zt,de,Pe,Qe,rn,wn,kn,De,wr,ca,Ar,ua,$a,ri){var ba=new L.ARRAY_TYPE(16);return ba[0]=A,ba[1]=nt,ba[2]=Zt,ba[3]=de,ba[4]=Pe,ba[5]=Qe,ba[6]=rn,ba[7]=wn,ba[8]=kn,ba[9]=De,ba[10]=wr,ba[11]=ca,ba[12]=Ar,ba[13]=ua,ba[14]=$a,ba[15]=ri,ba}function sa(A,nt,Zt,de,Pe,Qe,rn,wn,kn,De,wr,ca,Ar,ua,$a,ri,ba){return A[0]=nt,A[1]=Zt,A[2]=de,A[3]=Pe,A[4]=Qe,A[5]=rn,A[6]=wn,A[7]=kn,A[8]=De,A[9]=wr,A[10]=ca,A[11]=Ar,A[12]=ua,A[13]=$a,A[14]=ri,A[15]=ba,A}function Da(A){return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function Rr(A,nt){if(A===nt){var Zt=nt[1],de=nt[2],Pe=nt[3],Qe=nt[6],rn=nt[7],wn=nt[11];A[1]=nt[4],A[2]=nt[8],A[3]=nt[12],A[4]=Zt,A[6]=nt[9],A[7]=nt[13],A[8]=de,A[9]=Qe,A[11]=nt[14],A[12]=Pe,A[13]=rn,A[14]=wn}else A[0]=nt[0],A[1]=nt[4],A[2]=nt[8],A[3]=nt[12],A[4]=nt[1],A[5]=nt[5],A[6]=nt[9],A[7]=nt[13],A[8]=nt[2],A[9]=nt[6],A[10]=nt[10],A[11]=nt[14],A[12]=nt[3],A[13]=nt[7],A[14]=nt[11],A[15]=nt[15];return A}function Mn(A,nt){var Zt=nt[0],de=nt[1],Pe=nt[2],Qe=nt[3],rn=nt[4],wn=nt[5],kn=nt[6],De=nt[7],wr=nt[8],ca=nt[9],Ar=nt[10],ua=nt[11],$a=nt[12],ri=nt[13],ba=nt[14],ki=nt[15],Eo=Zt*wn-de*rn,Lo=Zt*kn-Pe*rn,Bo=Zt*De-Qe*rn,go=de*kn-Pe*wn,Ao=de*De-Qe*wn,qu=Pe*De-Qe*kn,zu=wr*ri-ca*$a,Uu=wr*ba-Ar*$a,Qu=wr*ki-ua*$a,Wu=ca*ba-Ar*ri,al=ca*ki-ua*ri,Vu=Ar*ki-ua*ba,ps=Eo*Vu-Lo*al+Bo*Wu+go*Qu-Ao*Uu+qu*zu;return ps?(ps=1/ps,A[0]=(wn*Vu-kn*al+De*Wu)*ps,A[1]=(Pe*al-de*Vu-Qe*Wu)*ps,A[2]=(ri*qu-ba*Ao+ki*go)*ps,A[3]=(Ar*Ao-ca*qu-ua*go)*ps,A[4]=(kn*Qu-rn*Vu-De*Uu)*ps,A[5]=(Zt*Vu-Pe*Qu+Qe*Uu)*ps,A[6]=(ba*Bo-$a*qu-ki*Lo)*ps,A[7]=(wr*qu-Ar*Bo+ua*Lo)*ps,A[8]=(rn*al-wn*Qu+De*zu)*ps,A[9]=(de*Qu-Zt*al-Qe*zu)*ps,A[10]=($a*Ao-ri*Bo+ki*Eo)*ps,A[11]=(ca*Bo-wr*Ao-ua*Eo)*ps,A[12]=(wn*Uu-rn*Wu-kn*zu)*ps,A[13]=(Zt*Wu-de*Uu+Pe*zu)*ps,A[14]=(ri*Lo-$a*go-ba*Eo)*ps,A[15]=(wr*go-ca*Lo+Ar*Eo)*ps,A):null}function ar(A,nt){var Zt=nt[0],de=nt[1],Pe=nt[2],Qe=nt[3],rn=nt[4],wn=nt[5],kn=nt[6],De=nt[7],wr=nt[8],ca=nt[9],Ar=nt[10],ua=nt[11],$a=nt[12],ri=nt[13],ba=nt[14],ki=nt[15];return A[0]=wn*(Ar*ki-ua*ba)-ca*(kn*ki-De*ba)+ri*(kn*ua-De*Ar),A[1]=-(de*(Ar*ki-ua*ba)-ca*(Pe*ki-Qe*ba)+ri*(Pe*ua-Qe*Ar)),A[2]=de*(kn*ki-De*ba)-wn*(Pe*ki-Qe*ba)+ri*(Pe*De-Qe*kn),A[3]=-(de*(kn*ua-De*Ar)-wn*(Pe*ua-Qe*Ar)+ca*(Pe*De-Qe*kn)),A[4]=-(rn*(Ar*ki-ua*ba)-wr*(kn*ki-De*ba)+$a*(kn*ua-De*Ar)),A[5]=Zt*(Ar*ki-ua*ba)-wr*(Pe*ki-Qe*ba)+$a*(Pe*ua-Qe*Ar),A[6]=-(Zt*(kn*ki-De*ba)-rn*(Pe*ki-Qe*ba)+$a*(Pe*De-Qe*kn)),A[7]=Zt*(kn*ua-De*Ar)-rn*(Pe*ua-Qe*Ar)+wr*(Pe*De-Qe*kn),A[8]=rn*(ca*ki-ua*ri)-wr*(wn*ki-De*ri)+$a*(wn*ua-De*ca),A[9]=-(Zt*(ca*ki-ua*ri)-wr*(de*ki-Qe*ri)+$a*(de*ua-Qe*ca)),A[10]=Zt*(wn*ki-De*ri)-rn*(de*ki-Qe*ri)+$a*(de*De-Qe*wn),A[11]=-(Zt*(wn*ua-De*ca)-rn*(de*ua-Qe*ca)+wr*(de*De-Qe*wn)),A[12]=-(rn*(ca*ba-Ar*ri)-wr*(wn*ba-kn*ri)+$a*(wn*Ar-kn*ca)),A[13]=Zt*(ca*ba-Ar*ri)-wr*(de*ba-Pe*ri)+$a*(de*Ar-Pe*ca),A[14]=-(Zt*(wn*ba-kn*ri)-rn*(de*ba-Pe*ri)+$a*(de*kn-Pe*wn)),A[15]=Zt*(wn*Ar-kn*ca)-rn*(de*Ar-Pe*ca)+wr*(de*kn-Pe*wn),A}function Fn(A){var nt=A[0],Zt=A[1],de=A[2],Pe=A[3],Qe=A[4],rn=A[5],wn=A[6],kn=A[7],De=A[8],wr=A[9],ca=A[10],Ar=A[11],ua=A[12],$a=A[13],ri=A[14],ba=A[15],ki=nt*rn-Zt*Qe,Eo=nt*wn-de*Qe,Lo=nt*kn-Pe*Qe,Bo=Zt*wn-de*rn,go=Zt*kn-Pe*rn,Ao=de*kn-Pe*wn,qu=De*$a-wr*ua,zu=De*ri-ca*ua,Uu=De*ba-Ar*ua,Qu=wr*ri-ca*$a,Wu=wr*ba-Ar*$a,al=ca*ba-Ar*ri;return ki*al-Eo*Wu+Lo*Qu+Bo*Uu-go*zu+Ao*qu}function tr(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=nt[4],kn=nt[5],De=nt[6],wr=nt[7],ca=nt[8],Ar=nt[9],ua=nt[10],$a=nt[11],ri=nt[12],ba=nt[13],ki=nt[14],Eo=nt[15],Lo=Zt[0],Bo=Zt[1],go=Zt[2],Ao=Zt[3];return A[0]=Lo*de+Bo*wn+go*ca+Ao*ri,A[1]=Lo*Pe+Bo*kn+go*Ar+Ao*ba,A[2]=Lo*Qe+Bo*De+go*ua+Ao*ki,A[3]=Lo*rn+Bo*wr+go*$a+Ao*Eo,Lo=Zt[4],Bo=Zt[5],go=Zt[6],Ao=Zt[7],A[4]=Lo*de+Bo*wn+go*ca+Ao*ri,A[5]=Lo*Pe+Bo*kn+go*Ar+Ao*ba,A[6]=Lo*Qe+Bo*De+go*ua+Ao*ki,A[7]=Lo*rn+Bo*wr+go*$a+Ao*Eo,Lo=Zt[8],Bo=Zt[9],go=Zt[10],Ao=Zt[11],A[8]=Lo*de+Bo*wn+go*ca+Ao*ri,A[9]=Lo*Pe+Bo*kn+go*Ar+Ao*ba,A[10]=Lo*Qe+Bo*De+go*ua+Ao*ki,A[11]=Lo*rn+Bo*wr+go*$a+Ao*Eo,Lo=Zt[12],Bo=Zt[13],go=Zt[14],Ao=Zt[15],A[12]=Lo*de+Bo*wn+go*ca+Ao*ri,A[13]=Lo*Pe+Bo*kn+go*Ar+Ao*ba,A[14]=Lo*Qe+Bo*De+go*ua+Ao*ki,A[15]=Lo*rn+Bo*wr+go*$a+Ao*Eo,A}function Gn(A,nt,Zt){var de=Zt[0],Pe=Zt[1],Qe=Zt[2],rn,wn,kn,De,wr,ca,Ar,ua,$a,ri,ba,ki;return nt===A?(A[12]=nt[0]*de+nt[4]*Pe+nt[8]*Qe+nt[12],A[13]=nt[1]*de+nt[5]*Pe+nt[9]*Qe+nt[13],A[14]=nt[2]*de+nt[6]*Pe+nt[10]*Qe+nt[14],A[15]=nt[3]*de+nt[7]*Pe+nt[11]*Qe+nt[15]):(rn=nt[0],wn=nt[1],kn=nt[2],De=nt[3],wr=nt[4],ca=nt[5],Ar=nt[6],ua=nt[7],$a=nt[8],ri=nt[9],ba=nt[10],ki=nt[11],A[0]=rn,A[1]=wn,A[2]=kn,A[3]=De,A[4]=wr,A[5]=ca,A[6]=Ar,A[7]=ua,A[8]=$a,A[9]=ri,A[10]=ba,A[11]=ki,A[12]=rn*de+wr*Pe+$a*Qe+nt[12],A[13]=wn*de+ca*Pe+ri*Qe+nt[13],A[14]=kn*de+Ar*Pe+ba*Qe+nt[14],A[15]=De*de+ua*Pe+ki*Qe+nt[15]),A}function jr(A,nt,Zt){var de=Zt[0],Pe=Zt[1],Qe=Zt[2];return A[0]=nt[0]*de,A[1]=nt[1]*de,A[2]=nt[2]*de,A[3]=nt[3]*de,A[4]=nt[4]*Pe,A[5]=nt[5]*Pe,A[6]=nt[6]*Pe,A[7]=nt[7]*Pe,A[8]=nt[8]*Qe,A[9]=nt[9]*Qe,A[10]=nt[10]*Qe,A[11]=nt[11]*Qe,A[12]=nt[12],A[13]=nt[13],A[14]=nt[14],A[15]=nt[15],A}function Hr(A,nt,Zt,de){var Pe=de[0],Qe=de[1],rn=de[2],wn=Math.hypot(Pe,Qe,rn),kn,De,wr,ca,Ar,ua,$a,ri,ba,ki,Eo,Lo,Bo,go,Ao,qu,zu,Uu,Qu,Wu,al,Vu,ps,ru;return wn<L.EPSILON?null:(wn=1/wn,Pe*=wn,Qe*=wn,rn*=wn,kn=Math.sin(Zt),De=Math.cos(Zt),wr=1-De,ca=nt[0],Ar=nt[1],ua=nt[2],$a=nt[3],ri=nt[4],ba=nt[5],ki=nt[6],Eo=nt[7],Lo=nt[8],Bo=nt[9],go=nt[10],Ao=nt[11],qu=Pe*Pe*wr+De,zu=Qe*Pe*wr+rn*kn,Uu=rn*Pe*wr-Qe*kn,Qu=Pe*Qe*wr-rn*kn,Wu=Qe*Qe*wr+De,al=rn*Qe*wr+Pe*kn,Vu=Pe*rn*wr+Qe*kn,ps=Qe*rn*wr-Pe*kn,ru=rn*rn*wr+De,A[0]=ca*qu+ri*zu+Lo*Uu,A[1]=Ar*qu+ba*zu+Bo*Uu,A[2]=ua*qu+ki*zu+go*Uu,A[3]=$a*qu+Eo*zu+Ao*Uu,A[4]=ca*Qu+ri*Wu+Lo*al,A[5]=Ar*Qu+ba*Wu+Bo*al,A[6]=ua*Qu+ki*Wu+go*al,A[7]=$a*Qu+Eo*Wu+Ao*al,A[8]=ca*Vu+ri*ps+Lo*ru,A[9]=Ar*Vu+ba*ps+Bo*ru,A[10]=ua*Vu+ki*ps+go*ru,A[11]=$a*Vu+Eo*ps+Ao*ru,nt!==A&&(A[12]=nt[12],A[13]=nt[13],A[14]=nt[14],A[15]=nt[15]),A)}function Ea(A,nt,Zt){var de=Math.sin(Zt),Pe=Math.cos(Zt),Qe=nt[4],rn=nt[5],wn=nt[6],kn=nt[7],De=nt[8],wr=nt[9],ca=nt[10],Ar=nt[11];return nt!==A&&(A[0]=nt[0],A[1]=nt[1],A[2]=nt[2],A[3]=nt[3],A[12]=nt[12],A[13]=nt[13],A[14]=nt[14],A[15]=nt[15]),A[4]=Qe*Pe+De*de,A[5]=rn*Pe+wr*de,A[6]=wn*Pe+ca*de,A[7]=kn*Pe+Ar*de,A[8]=De*Pe-Qe*de,A[9]=wr*Pe-rn*de,A[10]=ca*Pe-wn*de,A[11]=Ar*Pe-kn*de,A}function lr(A,nt,Zt){var de=Math.sin(Zt),Pe=Math.cos(Zt),Qe=nt[0],rn=nt[1],wn=nt[2],kn=nt[3],De=nt[8],wr=nt[9],ca=nt[10],Ar=nt[11];return nt!==A&&(A[4]=nt[4],A[5]=nt[5],A[6]=nt[6],A[7]=nt[7],A[12]=nt[12],A[13]=nt[13],A[14]=nt[14],A[15]=nt[15]),A[0]=Qe*Pe-De*de,A[1]=rn*Pe-wr*de,A[2]=wn*Pe-ca*de,A[3]=kn*Pe-Ar*de,A[8]=Qe*de+De*Pe,A[9]=rn*de+wr*Pe,A[10]=wn*de+ca*Pe,A[11]=kn*de+Ar*Pe,A}function Cr(A,nt,Zt){var de=Math.sin(Zt),Pe=Math.cos(Zt),Qe=nt[0],rn=nt[1],wn=nt[2],kn=nt[3],De=nt[4],wr=nt[5],ca=nt[6],Ar=nt[7];return nt!==A&&(A[8]=nt[8],A[9]=nt[9],A[10]=nt[10],A[11]=nt[11],A[12]=nt[12],A[13]=nt[13],A[14]=nt[14],A[15]=nt[15]),A[0]=Qe*Pe+De*de,A[1]=rn*Pe+wr*de,A[2]=wn*Pe+ca*de,A[3]=kn*Pe+Ar*de,A[4]=De*Pe-Qe*de,A[5]=wr*Pe-rn*de,A[6]=ca*Pe-wn*de,A[7]=Ar*Pe-kn*de,A}function vr(A,nt){return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=nt[0],A[13]=nt[1],A[14]=nt[2],A[15]=1,A}function Tr(A,nt){return A[0]=nt[0],A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=nt[1],A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=nt[2],A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function ta(A,nt,Zt){var de=Zt[0],Pe=Zt[1],Qe=Zt[2],rn=Math.hypot(de,Pe,Qe),wn,kn,De;return rn<L.EPSILON?null:(rn=1/rn,de*=rn,Pe*=rn,Qe*=rn,wn=Math.sin(nt),kn=Math.cos(nt),De=1-kn,A[0]=de*de*De+kn,A[1]=Pe*de*De+Qe*wn,A[2]=Qe*de*De-Pe*wn,A[3]=0,A[4]=de*Pe*De-Qe*wn,A[5]=Pe*Pe*De+kn,A[6]=Qe*Pe*De+de*wn,A[7]=0,A[8]=de*Qe*De+Pe*wn,A[9]=Pe*Qe*De-de*wn,A[10]=Qe*Qe*De+kn,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A)}function ra(A,nt){var Zt=Math.sin(nt),de=Math.cos(nt);return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=de,A[6]=Zt,A[7]=0,A[8]=0,A[9]=-Zt,A[10]=de,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function Zr(A,nt){var Zt=Math.sin(nt),de=Math.cos(nt);return A[0]=de,A[1]=0,A[2]=-Zt,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=Zt,A[9]=0,A[10]=de,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function vt(A,nt){var Zt=Math.sin(nt),de=Math.cos(nt);return A[0]=de,A[1]=Zt,A[2]=0,A[3]=0,A[4]=-Zt,A[5]=de,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function _n(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=de+de,kn=Pe+Pe,De=Qe+Qe,wr=de*wn,ca=de*kn,Ar=de*De,ua=Pe*kn,$a=Pe*De,ri=Qe*De,ba=rn*wn,ki=rn*kn,Eo=rn*De;return A[0]=1-(ua+ri),A[1]=ca+Eo,A[2]=Ar-ki,A[3]=0,A[4]=ca-Eo,A[5]=1-(wr+ri),A[6]=$a+ba,A[7]=0,A[8]=Ar+ki,A[9]=$a-ba,A[10]=1-(wr+ua),A[11]=0,A[12]=Zt[0],A[13]=Zt[1],A[14]=Zt[2],A[15]=1,A}function an(A,nt){var Zt=new L.ARRAY_TYPE(3),de=-nt[0],Pe=-nt[1],Qe=-nt[2],rn=nt[3],wn=nt[4],kn=nt[5],De=nt[6],wr=nt[7],ca=de*de+Pe*Pe+Qe*Qe+rn*rn;return ca>0?(Zt[0]=(wn*rn+wr*de+kn*Qe-De*Pe)*2/ca,Zt[1]=(kn*rn+wr*Pe+De*de-wn*Qe)*2/ca,Zt[2]=(De*rn+wr*Qe+wn*Pe-kn*de)*2/ca):(Zt[0]=(wn*rn+wr*de+kn*Qe-De*Pe)*2,Zt[1]=(kn*rn+wr*Pe+De*de-wn*Qe)*2,Zt[2]=(De*rn+wr*Qe+wn*Pe-kn*de)*2),_n(A,nt,Zt),A}function Lt(A,nt){return A[0]=nt[12],A[1]=nt[13],A[2]=nt[14],A}function kt(A,nt){var Zt=nt[0],de=nt[1],Pe=nt[2],Qe=nt[4],rn=nt[5],wn=nt[6],kn=nt[8],De=nt[9],wr=nt[10];return A[0]=Math.hypot(Zt,de,Pe),A[1]=Math.hypot(Qe,rn,wn),A[2]=Math.hypot(kn,De,wr),A}function at(A,nt){var Zt=new L.ARRAY_TYPE(3);kt(Zt,nt);var de=1/Zt[0],Pe=1/Zt[1],Qe=1/Zt[2],rn=nt[0]*de,wn=nt[1]*Pe,kn=nt[2]*Qe,De=nt[4]*de,wr=nt[5]*Pe,ca=nt[6]*Qe,Ar=nt[8]*de,ua=nt[9]*Pe,$a=nt[10]*Qe,ri=rn+wr+$a,ba=0;return ri>0?(ba=Math.sqrt(ri+1)*2,A[3]=.25*ba,A[0]=(ca-ua)/ba,A[1]=(Ar-kn)/ba,A[2]=(wn-De)/ba):rn>wr&&rn>$a?(ba=Math.sqrt(1+rn-wr-$a)*2,A[3]=(ca-ua)/ba,A[0]=.25*ba,A[1]=(wn+De)/ba,A[2]=(Ar+kn)/ba):wr>$a?(ba=Math.sqrt(1+wr-rn-$a)*2,A[3]=(Ar-kn)/ba,A[0]=(wn+De)/ba,A[1]=.25*ba,A[2]=(ca+ua)/ba):(ba=Math.sqrt(1+$a-rn-wr)*2,A[3]=(wn-De)/ba,A[0]=(Ar+kn)/ba,A[1]=(ca+ua)/ba,A[2]=.25*ba),A}function H(A,nt,Zt,de){var Pe=nt[0],Qe=nt[1],rn=nt[2],wn=nt[3],kn=Pe+Pe,De=Qe+Qe,wr=rn+rn,ca=Pe*kn,Ar=Pe*De,ua=Pe*wr,$a=Qe*De,ri=Qe*wr,ba=rn*wr,ki=wn*kn,Eo=wn*De,Lo=wn*wr,Bo=de[0],go=de[1],Ao=de[2];return A[0]=(1-($a+ba))*Bo,A[1]=(Ar+Lo)*Bo,A[2]=(ua-Eo)*Bo,A[3]=0,A[4]=(Ar-Lo)*go,A[5]=(1-(ca+ba))*go,A[6]=(ri+ki)*go,A[7]=0,A[8]=(ua+Eo)*Ao,A[9]=(ri-ki)*Ao,A[10]=(1-(ca+$a))*Ao,A[11]=0,A[12]=Zt[0],A[13]=Zt[1],A[14]=Zt[2],A[15]=1,A}function Y(A,nt,Zt,de,Pe){var Qe=nt[0],rn=nt[1],wn=nt[2],kn=nt[3],De=Qe+Qe,wr=rn+rn,ca=wn+wn,Ar=Qe*De,ua=Qe*wr,$a=Qe*ca,ri=rn*wr,ba=rn*ca,ki=wn*ca,Eo=kn*De,Lo=kn*wr,Bo=kn*ca,go=de[0],Ao=de[1],qu=de[2],zu=Pe[0],Uu=Pe[1],Qu=Pe[2],Wu=(1-(ri+ki))*go,al=(ua+Bo)*go,Vu=($a-Lo)*go,ps=(ua-Bo)*Ao,ru=(1-(Ar+ki))*Ao,pf=(ba+Eo)*Ao,Ec=($a+Lo)*qu,Ou=(ba-Eo)*qu,Uc=(1-(Ar+ri))*qu;return A[0]=Wu,A[1]=al,A[2]=Vu,A[3]=0,A[4]=ps,A[5]=ru,A[6]=pf,A[7]=0,A[8]=Ec,A[9]=Ou,A[10]=Uc,A[11]=0,A[12]=Zt[0]+zu-(Wu*zu+ps*Uu+Ec*Qu),A[13]=Zt[1]+Uu-(al*zu+ru*Uu+Ou*Qu),A[14]=Zt[2]+Qu-(Vu*zu+pf*Uu+Uc*Qu),A[15]=1,A}function bt(A,nt){var Zt=nt[0],de=nt[1],Pe=nt[2],Qe=nt[3],rn=Zt+Zt,wn=de+de,kn=Pe+Pe,De=Zt*rn,wr=de*rn,ca=de*wn,Ar=Pe*rn,ua=Pe*wn,$a=Pe*kn,ri=Qe*rn,ba=Qe*wn,ki=Qe*kn;return A[0]=1-ca-$a,A[1]=wr+ki,A[2]=Ar-ba,A[3]=0,A[4]=wr-ki,A[5]=1-De-$a,A[6]=ua+ri,A[7]=0,A[8]=Ar+ba,A[9]=ua-ri,A[10]=1-De-ca,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function $t(A,nt,Zt,de,Pe,Qe,rn){var wn=1/(Zt-nt),kn=1/(Pe-de),De=1/(Qe-rn);return A[0]=Qe*2*wn,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=Qe*2*kn,A[6]=0,A[7]=0,A[8]=(Zt+nt)*wn,A[9]=(Pe+de)*kn,A[10]=(rn+Qe)*De,A[11]=-1,A[12]=0,A[13]=0,A[14]=rn*Qe*2*De,A[15]=0,A}function jt(A,nt,Zt,de,Pe){var Qe=1/Math.tan(nt/2),rn;return A[0]=Qe/Zt,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=Qe,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[11]=-1,A[12]=0,A[13]=0,A[15]=0,Pe!=null&&Pe!==Infinity?(rn=1/(de-Pe),A[10]=(Pe+de)*rn,A[14]=2*Pe*de*rn):(A[10]=-1,A[14]=-2*de),A}var Ht=jt;function re(A,nt,Zt,de,Pe){var Qe=1/Math.tan(nt/2),rn;return A[0]=Qe/Zt,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=Qe,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[11]=-1,A[12]=0,A[13]=0,A[15]=0,Pe!=null&&Pe!==Infinity?(rn=1/(de-Pe),A[10]=Pe*rn,A[14]=Pe*de*rn):(A[10]=-1,A[14]=-de),A}function on(A,nt,Zt,de){var Pe=Math.tan(nt.upDegrees*Math.PI/180),Qe=Math.tan(nt.downDegrees*Math.PI/180),rn=Math.tan(nt.leftDegrees*Math.PI/180),wn=Math.tan(nt.rightDegrees*Math.PI/180),kn=2/(rn+wn),De=2/(Pe+Qe);return A[0]=kn,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=De,A[6]=0,A[7]=0,A[8]=-((rn-wn)*kn*.5),A[9]=(Pe-Qe)*De*.5,A[10]=de/(Zt-de),A[11]=-1,A[12]=0,A[13]=0,A[14]=de*Zt/(Zt-de),A[15]=0,A}function Je(A,nt,Zt,de,Pe,Qe,rn){var wn=1/(nt-Zt),kn=1/(de-Pe),De=1/(Qe-rn);return A[0]=-2*wn,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=-2*kn,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=2*De,A[11]=0,A[12]=(nt+Zt)*wn,A[13]=(Pe+de)*kn,A[14]=(rn+Qe)*De,A[15]=1,A}var Ve=Je;function qn(A,nt,Zt,de,Pe,Qe,rn){var wn=1/(nt-Zt),kn=1/(de-Pe),De=1/(Qe-rn);return A[0]=-2*wn,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=-2*kn,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=De,A[11]=0,A[12]=(nt+Zt)*wn,A[13]=(Pe+de)*kn,A[14]=Qe*De,A[15]=1,A}function Ln(A,nt,Zt,de){var Pe,Qe,rn,wn,kn,De,wr,ca,Ar,ua,$a=nt[0],ri=nt[1],ba=nt[2],ki=de[0],Eo=de[1],Lo=de[2],Bo=Zt[0],go=Zt[1],Ao=Zt[2];return Math.abs($a-Bo)<L.EPSILON&&Math.abs(ri-go)<L.EPSILON&&Math.abs(ba-Ao)<L.EPSILON?Da(A):(wr=$a-Bo,ca=ri-go,Ar=ba-Ao,ua=1/Math.hypot(wr,ca,Ar),wr*=ua,ca*=ua,Ar*=ua,Pe=Eo*Ar-Lo*ca,Qe=Lo*wr-ki*Ar,rn=ki*ca-Eo*wr,ua=Math.hypot(Pe,Qe,rn),ua?(ua=1/ua,Pe*=ua,Qe*=ua,rn*=ua):(Pe=0,Qe=0,rn=0),wn=ca*rn-Ar*Qe,kn=Ar*Pe-wr*rn,De=wr*Qe-ca*Pe,ua=Math.hypot(wn,kn,De),ua?(ua=1/ua,wn*=ua,kn*=ua,De*=ua):(wn=0,kn=0,De=0),A[0]=Pe,A[1]=wn,A[2]=wr,A[3]=0,A[4]=Qe,A[5]=kn,A[6]=ca,A[7]=0,A[8]=rn,A[9]=De,A[10]=Ar,A[11]=0,A[12]=-(Pe*$a+Qe*ri+rn*ba),A[13]=-(wn*$a+kn*ri+De*ba),A[14]=-(wr*$a+ca*ri+Ar*ba),A[15]=1,A)}function qr(A,nt,Zt,de){var Pe=nt[0],Qe=nt[1],rn=nt[2],wn=de[0],kn=de[1],De=de[2],wr=Pe-Zt[0],ca=Qe-Zt[1],Ar=rn-Zt[2],ua=wr*wr+ca*ca+Ar*Ar;ua>0&&(ua=1/Math.sqrt(ua),wr*=ua,ca*=ua,Ar*=ua);var $a=kn*Ar-De*ca,ri=De*wr-wn*Ar,ba=wn*ca-kn*wr;return ua=$a*$a+ri*ri+ba*ba,ua>0&&(ua=1/Math.sqrt(ua),$a*=ua,ri*=ua,ba*=ua),A[0]=$a,A[1]=ri,A[2]=ba,A[3]=0,A[4]=ca*ba-Ar*ri,A[5]=Ar*$a-wr*ba,A[6]=wr*ri-ca*$a,A[7]=0,A[8]=wr,A[9]=ca,A[10]=Ar,A[11]=0,A[12]=Pe,A[13]=Qe,A[14]=rn,A[15]=1,A}function Ca(A){return"mat4("+A[0]+", "+A[1]+", "+A[2]+", "+A[3]+", "+A[4]+", "+A[5]+", "+A[6]+", "+A[7]+", "+A[8]+", "+A[9]+", "+A[10]+", "+A[11]+", "+A[12]+", "+A[13]+", "+A[14]+", "+A[15]+")"}function Qn(A){return Math.hypot(A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14],A[15])}function _r(A,nt,Zt){return A[0]=nt[0]+Zt[0],A[1]=nt[1]+Zt[1],A[2]=nt[2]+Zt[2],A[3]=nt[3]+Zt[3],A[4]=nt[4]+Zt[4],A[5]=nt[5]+Zt[5],A[6]=nt[6]+Zt[6],A[7]=nt[7]+Zt[7],A[8]=nt[8]+Zt[8],A[9]=nt[9]+Zt[9],A[10]=nt[10]+Zt[10],A[11]=nt[11]+Zt[11],A[12]=nt[12]+Zt[12],A[13]=nt[13]+Zt[13],A[14]=nt[14]+Zt[14],A[15]=nt[15]+Zt[15],A}function ea(A,nt,Zt){return A[0]=nt[0]-Zt[0],A[1]=nt[1]-Zt[1],A[2]=nt[2]-Zt[2],A[3]=nt[3]-Zt[3],A[4]=nt[4]-Zt[4],A[5]=nt[5]-Zt[5],A[6]=nt[6]-Zt[6],A[7]=nt[7]-Zt[7],A[8]=nt[8]-Zt[8],A[9]=nt[9]-Zt[9],A[10]=nt[10]-Zt[10],A[11]=nt[11]-Zt[11],A[12]=nt[12]-Zt[12],A[13]=nt[13]-Zt[13],A[14]=nt[14]-Zt[14],A[15]=nt[15]-Zt[15],A}function La(A,nt,Zt){return A[0]=nt[0]*Zt,A[1]=nt[1]*Zt,A[2]=nt[2]*Zt,A[3]=nt[3]*Zt,A[4]=nt[4]*Zt,A[5]=nt[5]*Zt,A[6]=nt[6]*Zt,A[7]=nt[7]*Zt,A[8]=nt[8]*Zt,A[9]=nt[9]*Zt,A[10]=nt[10]*Zt,A[11]=nt[11]*Zt,A[12]=nt[12]*Zt,A[13]=nt[13]*Zt,A[14]=nt[14]*Zt,A[15]=nt[15]*Zt,A}function ha(A,nt,Zt,de){return A[0]=nt[0]+Zt[0]*de,A[1]=nt[1]+Zt[1]*de,A[2]=nt[2]+Zt[2]*de,A[3]=nt[3]+Zt[3]*de,A[4]=nt[4]+Zt[4]*de,A[5]=nt[5]+Zt[5]*de,A[6]=nt[6]+Zt[6]*de,A[7]=nt[7]+Zt[7]*de,A[8]=nt[8]+Zt[8]*de,A[9]=nt[9]+Zt[9]*de,A[10]=nt[10]+Zt[10]*de,A[11]=nt[11]+Zt[11]*de,A[12]=nt[12]+Zt[12]*de,A[13]=nt[13]+Zt[13]*de,A[14]=nt[14]+Zt[14]*de,A[15]=nt[15]+Zt[15]*de,A}function _i(A,nt){return A[0]===nt[0]&&A[1]===nt[1]&&A[2]===nt[2]&&A[3]===nt[3]&&A[4]===nt[4]&&A[5]===nt[5]&&A[6]===nt[6]&&A[7]===nt[7]&&A[8]===nt[8]&&A[9]===nt[9]&&A[10]===nt[10]&&A[11]===nt[11]&&A[12]===nt[12]&&A[13]===nt[13]&&A[14]===nt[14]&&A[15]===nt[15]}function Ni(A,nt){var Zt=A[0],de=A[1],Pe=A[2],Qe=A[3],rn=A[4],wn=A[5],kn=A[6],De=A[7],wr=A[8],ca=A[9],Ar=A[10],ua=A[11],$a=A[12],ri=A[13],ba=A[14],ki=A[15],Eo=nt[0],Lo=nt[1],Bo=nt[2],go=nt[3],Ao=nt[4],qu=nt[5],zu=nt[6],Uu=nt[7],Qu=nt[8],Wu=nt[9],al=nt[10],Vu=nt[11],ps=nt[12],ru=nt[13],pf=nt[14],Ec=nt[15];return Math.abs(Zt-Eo)<=L.EPSILON*Math.max(1,Math.abs(Zt),Math.abs(Eo))&&Math.abs(de-Lo)<=L.EPSILON*Math.max(1,Math.abs(de),Math.abs(Lo))&&Math.abs(Pe-Bo)<=L.EPSILON*Math.max(1,Math.abs(Pe),Math.abs(Bo))&&Math.abs(Qe-go)<=L.EPSILON*Math.max(1,Math.abs(Qe),Math.abs(go))&&Math.abs(rn-Ao)<=L.EPSILON*Math.max(1,Math.abs(rn),Math.abs(Ao))&&Math.abs(wn-qu)<=L.EPSILON*Math.max(1,Math.abs(wn),Math.abs(qu))&&Math.abs(kn-zu)<=L.EPSILON*Math.max(1,Math.abs(kn),Math.abs(zu))&&Math.abs(De-Uu)<=L.EPSILON*Math.max(1,Math.abs(De),Math.abs(Uu))&&Math.abs(wr-Qu)<=L.EPSILON*Math.max(1,Math.abs(wr),Math.abs(Qu))&&Math.abs(ca-Wu)<=L.EPSILON*Math.max(1,Math.abs(ca),Math.abs(Wu))&&Math.abs(Ar-al)<=L.EPSILON*Math.max(1,Math.abs(Ar),Math.abs(al))&&Math.abs(ua-Vu)<=L.EPSILON*Math.max(1,Math.abs(ua),Math.abs(Vu))&&Math.abs($a-ps)<=L.EPSILON*Math.max(1,Math.abs($a),Math.abs(ps))&&Math.abs(ri-ru)<=L.EPSILON*Math.max(1,Math.abs(ri),Math.abs(ru))&&Math.abs(ba-pf)<=L.EPSILON*Math.max(1,Math.abs(ba),Math.abs(pf))&&Math.abs(ki-Ec)<=L.EPSILON*Math.max(1,Math.abs(ki),Math.abs(Ec))}var vi=tr,si=ea,Mi=$(77160);function Pa(){var A=new L.ARRAY_TYPE(4);return L.ARRAY_TYPE!=Float32Array&&(A[0]=0,A[1]=0,A[2]=0,A[3]=0),A}function un(A){var nt=new L.ARRAY_TYPE(4);return nt[0]=A[0],nt[1]=A[1],nt[2]=A[2],nt[3]=A[3],nt}function Oe(A,nt,Zt,de){var Pe=new L.ARRAY_TYPE(4);return Pe[0]=A,Pe[1]=nt,Pe[2]=Zt,Pe[3]=de,Pe}function hn(A,nt){return A[0]=nt[0],A[1]=nt[1],A[2]=nt[2],A[3]=nt[3],A}function Hn(A,nt,Zt,de,Pe){return A[0]=nt,A[1]=Zt,A[2]=de,A[3]=Pe,A}function Bn(A,nt,Zt){return A[0]=nt[0]+Zt[0],A[1]=nt[1]+Zt[1],A[2]=nt[2]+Zt[2],A[3]=nt[3]+Zt[3],A}function Jn(A,nt,Zt){return A[0]=nt[0]-Zt[0],A[1]=nt[1]-Zt[1],A[2]=nt[2]-Zt[2],A[3]=nt[3]-Zt[3],A}function Lr(A,nt,Zt){return A[0]=nt[0]*Zt[0],A[1]=nt[1]*Zt[1],A[2]=nt[2]*Zt[2],A[3]=nt[3]*Zt[3],A}function ya(A,nt,Zt){return A[0]=nt[0]/Zt[0],A[1]=nt[1]/Zt[1],A[2]=nt[2]/Zt[2],A[3]=nt[3]/Zt[3],A}function Fa(A,nt){return A[0]=Math.ceil(nt[0]),A[1]=Math.ceil(nt[1]),A[2]=Math.ceil(nt[2]),A[3]=Math.ceil(nt[3]),A}function ui(A,nt){return A[0]=Math.floor(nt[0]),A[1]=Math.floor(nt[1]),A[2]=Math.floor(nt[2]),A[3]=Math.floor(nt[3]),A}function Ei(A,nt,Zt){return A[0]=Math.min(nt[0],Zt[0]),A[1]=Math.min(nt[1],Zt[1]),A[2]=Math.min(nt[2],Zt[2]),A[3]=Math.min(nt[3],Zt[3]),A}function oo(A,nt,Zt){return A[0]=Math.max(nt[0],Zt[0]),A[1]=Math.max(nt[1],Zt[1]),A[2]=Math.max(nt[2],Zt[2]),A[3]=Math.max(nt[3],Zt[3]),A}function po(A,nt){return A[0]=Math.round(nt[0]),A[1]=Math.round(nt[1]),A[2]=Math.round(nt[2]),A[3]=Math.round(nt[3]),A}function bo(A,nt,Zt){return A[0]=nt[0]*Zt,A[1]=nt[1]*Zt,A[2]=nt[2]*Zt,A[3]=nt[3]*Zt,A}function ts(A,nt,Zt,de){return A[0]=nt[0]+Zt[0]*de,A[1]=nt[1]+Zt[1]*de,A[2]=nt[2]+Zt[2]*de,A[3]=nt[3]+Zt[3]*de,A}function Wo(A,nt){var Zt=nt[0]-A[0],de=nt[1]-A[1],Pe=nt[2]-A[2],Qe=nt[3]-A[3];return Math.hypot(Zt,de,Pe,Qe)}function Yi(A,nt){var Zt=nt[0]-A[0],de=nt[1]-A[1],Pe=nt[2]-A[2],Qe=nt[3]-A[3];return Zt*Zt+de*de+Pe*Pe+Qe*Qe}function wi(A){var nt=A[0],Zt=A[1],de=A[2],Pe=A[3];return Math.hypot(nt,Zt,de,Pe)}function gi(A){var nt=A[0],Zt=A[1],de=A[2],Pe=A[3];return nt*nt+Zt*Zt+de*de+Pe*Pe}function us(A,nt){return A[0]=-nt[0],A[1]=-nt[1],A[2]=-nt[2],A[3]=-nt[3],A}function Do(A,nt){return A[0]=1/nt[0],A[1]=1/nt[1],A[2]=1/nt[2],A[3]=1/nt[3],A}function Io(A,nt){var Zt=nt[0],de=nt[1],Pe=nt[2],Qe=nt[3],rn=Zt*Zt+de*de+Pe*Pe+Qe*Qe;return rn>0&&(rn=1/Math.sqrt(rn)),A[0]=Zt*rn,A[1]=de*rn,A[2]=Pe*rn,A[3]=Qe*rn,A}function zs(A,nt){return A[0]*nt[0]+A[1]*nt[1]+A[2]*nt[2]+A[3]*nt[3]}function mu(A,nt,Zt,de){var Pe=Zt[0]*de[1]-Zt[1]*de[0],Qe=Zt[0]*de[2]-Zt[2]*de[0],rn=Zt[0]*de[3]-Zt[3]*de[0],wn=Zt[1]*de[2]-Zt[2]*de[1],kn=Zt[1]*de[3]-Zt[3]*de[1],De=Zt[2]*de[3]-Zt[3]*de[2],wr=nt[0],ca=nt[1],Ar=nt[2],ua=nt[3];return A[0]=ca*De-Ar*kn+ua*wn,A[1]=-(wr*De)+Ar*rn-ua*Qe,A[2]=wr*kn-ca*rn+ua*Pe,A[3]=-(wr*wn)+ca*Qe-Ar*Pe,A}function ds(A,nt,Zt,de){var Pe=nt[0],Qe=nt[1],rn=nt[2],wn=nt[3];return A[0]=Pe+de*(Zt[0]-Pe),A[1]=Qe+de*(Zt[1]-Qe),A[2]=rn+de*(Zt[2]-rn),A[3]=wn+de*(Zt[3]-wn),A}function Ms(A,nt){nt=nt||1;var Zt,de,Pe,Qe,rn,wn;do Zt=L.RANDOM()*2-1,de=L.RANDOM()*2-1,rn=Zt*Zt+de*de;while(rn>=1);do Pe=L.RANDOM()*2-1,Qe=L.RANDOM()*2-1,wn=Pe*Pe+Qe*Qe;while(wn>=1);var kn=Math.sqrt((1-rn)/wn);return A[0]=nt*Zt,A[1]=nt*de,A[2]=nt*Pe*kn,A[3]=nt*Qe*kn,A}function yu(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3];return A[0]=Zt[0]*de+Zt[4]*Pe+Zt[8]*Qe+Zt[12]*rn,A[1]=Zt[1]*de+Zt[5]*Pe+Zt[9]*Qe+Zt[13]*rn,A[2]=Zt[2]*de+Zt[6]*Pe+Zt[10]*Qe+Zt[14]*rn,A[3]=Zt[3]*de+Zt[7]*Pe+Zt[11]*Qe+Zt[15]*rn,A}function uu(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=Zt[0],wn=Zt[1],kn=Zt[2],De=Zt[3],wr=De*de+wn*Qe-kn*Pe,ca=De*Pe+kn*de-rn*Qe,Ar=De*Qe+rn*Pe-wn*de,ua=-rn*de-wn*Pe-kn*Qe;return A[0]=wr*De+ua*-rn+ca*-kn-Ar*-wn,A[1]=ca*De+ua*-wn+Ar*-rn-wr*-kn,A[2]=Ar*De+ua*-kn+wr*-wn-ca*-rn,A[3]=nt[3],A}function Cs(A){return A[0]=0,A[1]=0,A[2]=0,A[3]=0,A}function qo(A){return"vec4("+A[0]+", "+A[1]+", "+A[2]+", "+A[3]+")"}function Wi(A,nt){return A[0]===nt[0]&&A[1]===nt[1]&&A[2]===nt[2]&&A[3]===nt[3]}function ls(A,nt){var Zt=A[0],de=A[1],Pe=A[2],Qe=A[3],rn=nt[0],wn=nt[1],kn=nt[2],De=nt[3];return Math.abs(Zt-rn)<=L.EPSILON*Math.max(1,Math.abs(Zt),Math.abs(rn))&&Math.abs(de-wn)<=L.EPSILON*Math.max(1,Math.abs(de),Math.abs(wn))&&Math.abs(Pe-kn)<=L.EPSILON*Math.max(1,Math.abs(Pe),Math.abs(kn))&&Math.abs(Qe-De)<=L.EPSILON*Math.max(1,Math.abs(Qe),Math.abs(De))}var is=Jn,Es=Lr,tl=ya,bu=Wo,Ys=Yi,ka=wi,Ku=gi,Vs=function(){var A=Pa();return function(nt,Zt,de,Pe,Qe,rn){var wn,kn;for(Zt||(Zt=4),de||(de=0),Pe?kn=Math.min(Pe*Zt+de,nt.length):kn=nt.length,wn=de;wn<kn;wn+=Zt)A[0]=nt[wn],A[1]=nt[wn+1],A[2]=nt[wn+2],A[3]=nt[wn+3],Qe(A,A,rn),nt[wn]=A[0],nt[wn+1]=A[1],nt[wn+2]=A[2],nt[wn+3]=A[3];return nt}}();function Ro(){var A=new L.ARRAY_TYPE(4);return L.ARRAY_TYPE!=Float32Array&&(A[0]=0,A[1]=0,A[2]=0),A[3]=1,A}function Ns(A){return A[0]=0,A[1]=0,A[2]=0,A[3]=1,A}function tu(A,nt,Zt){Zt=Zt*.5;var de=Math.sin(Zt);return A[0]=de*nt[0],A[1]=de*nt[1],A[2]=de*nt[2],A[3]=Math.cos(Zt),A}function eu(A,nt){var Zt=Math.acos(nt[3])*2,de=Math.sin(Zt/2);return de>L.EPSILON?(A[0]=nt[0]/de,A[1]=nt[1]/de,A[2]=nt[2]/de):(A[0]=1,A[1]=0,A[2]=0),Zt}function Zu(A,nt){var Zt=Bu(A,nt);return Math.acos(2*Zt*Zt-1)}function bn(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=Zt[0],kn=Zt[1],De=Zt[2],wr=Zt[3];return A[0]=de*wr+rn*wn+Pe*De-Qe*kn,A[1]=Pe*wr+rn*kn+Qe*wn-de*De,A[2]=Qe*wr+rn*De+de*kn-Pe*wn,A[3]=rn*wr-de*wn-Pe*kn-Qe*De,A}function Xr(A,nt,Zt){Zt*=.5;var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=Math.sin(Zt),kn=Math.cos(Zt);return A[0]=de*kn+rn*wn,A[1]=Pe*kn+Qe*wn,A[2]=Qe*kn-Pe*wn,A[3]=rn*kn-de*wn,A}function pa(A,nt,Zt){Zt*=.5;var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=Math.sin(Zt),kn=Math.cos(Zt);return A[0]=de*kn-Qe*wn,A[1]=Pe*kn+rn*wn,A[2]=Qe*kn+de*wn,A[3]=rn*kn-Pe*wn,A}function Ra(A,nt,Zt){Zt*=.5;var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=Math.sin(Zt),kn=Math.cos(Zt);return A[0]=de*kn+Pe*wn,A[1]=Pe*kn-de*wn,A[2]=Qe*kn+rn*wn,A[3]=rn*kn-Qe*wn,A}function Qi(A,nt){var Zt=nt[0],de=nt[1],Pe=nt[2];return A[0]=Zt,A[1]=de,A[2]=Pe,A[3]=Math.sqrt(Math.abs(1-Zt*Zt-de*de-Pe*Pe)),A}function Co(A,nt){var Zt=nt[0],de=nt[1],Pe=nt[2],Qe=nt[3],rn=Math.sqrt(Zt*Zt+de*de+Pe*Pe),wn=Math.exp(Qe),kn=rn>0?wn*Math.sin(rn)/rn:0;return A[0]=Zt*kn,A[1]=de*kn,A[2]=Pe*kn,A[3]=wn*Math.cos(rn),A}function to(A,nt){var Zt=nt[0],de=nt[1],Pe=nt[2],Qe=nt[3],rn=Math.sqrt(Zt*Zt+de*de+Pe*Pe),wn=rn>0?Math.atan2(rn,Qe)/rn:0;return A[0]=Zt*wn,A[1]=de*wn,A[2]=Pe*wn,A[3]=.5*Math.log(Zt*Zt+de*de+Pe*Pe+Qe*Qe),A}function xo(A,nt,Zt){return to(A,nt),_s(A,A,Zt),Co(A,A),A}function gs(A,nt,Zt,de){var Pe=nt[0],Qe=nt[1],rn=nt[2],wn=nt[3],kn=Zt[0],De=Zt[1],wr=Zt[2],ca=Zt[3],Ar,ua,$a,ri,ba;return ua=Pe*kn+Qe*De+rn*wr+wn*ca,ua<0&&(ua=-ua,kn=-kn,De=-De,wr=-wr,ca=-ca),1-ua>L.EPSILON?(Ar=Math.acos(ua),$a=Math.sin(Ar),ri=Math.sin((1-de)*Ar)/$a,ba=Math.sin(de*Ar)/$a):(ri=1-de,ba=de),A[0]=ri*Pe+ba*kn,A[1]=ri*Qe+ba*De,A[2]=ri*rn+ba*wr,A[3]=ri*wn+ba*ca,A}function vo(A){var nt=L.RANDOM(),Zt=L.RANDOM(),de=L.RANDOM(),Pe=Math.sqrt(1-nt),Qe=Math.sqrt(nt);return A[0]=Pe*Math.sin(2*Math.PI*Zt),A[1]=Pe*Math.cos(2*Math.PI*Zt),A[2]=Qe*Math.sin(2*Math.PI*de),A[3]=Qe*Math.cos(2*Math.PI*de),A}function ou(A,nt){var Zt=nt[0],de=nt[1],Pe=nt[2],Qe=nt[3],rn=Zt*Zt+de*de+Pe*Pe+Qe*Qe,wn=rn?1/rn:0;return A[0]=-Zt*wn,A[1]=-de*wn,A[2]=-Pe*wn,A[3]=Qe*wn,A}function ms(A,nt){return A[0]=-nt[0],A[1]=-nt[1],A[2]=-nt[2],A[3]=nt[3],A}function xu(A,nt){var Zt=nt[0]+nt[4]+nt[8],de;if(Zt>0)de=Math.sqrt(Zt+1),A[3]=.5*de,de=.5/de,A[0]=(nt[5]-nt[7])*de,A[1]=(nt[6]-nt[2])*de,A[2]=(nt[1]-nt[3])*de;else{var Pe=0;nt[4]>nt[0]&&(Pe=1),nt[8]>nt[Pe*3+Pe]&&(Pe=2);var Qe=(Pe+1)%3,rn=(Pe+2)%3;de=Math.sqrt(nt[Pe*3+Pe]-nt[Qe*3+Qe]-nt[rn*3+rn]+1),A[Pe]=.5*de,de=.5/de,A[3]=(nt[Qe*3+rn]-nt[rn*3+Qe])*de,A[Qe]=(nt[Qe*3+Pe]+nt[Pe*3+Qe])*de,A[rn]=(nt[rn*3+Pe]+nt[Pe*3+rn])*de}return A}function dl(A,nt,Zt,de){var Pe=.5*Math.PI/180;nt*=Pe,Zt*=Pe,de*=Pe;var Qe=Math.sin(nt),rn=Math.cos(nt),wn=Math.sin(Zt),kn=Math.cos(Zt),De=Math.sin(de),wr=Math.cos(de);return A[0]=Qe*kn*wr-rn*wn*De,A[1]=rn*wn*wr+Qe*kn*De,A[2]=rn*kn*De-Qe*wn*wr,A[3]=rn*kn*wr+Qe*wn*De,A}function kl(A){return"quat("+A[0]+", "+A[1]+", "+A[2]+", "+A[3]+")"}var Ks=un,el=Oe,lu=hn,Du=Hn,pl=Bn,ns=bn,_s=bo,Bu=zs,Au=ds,wu=wi,nu=wu,Tl=gi,xc=Tl,Sl=Io,ol=Wi,ys=ls,vl=function(){var A=Mi.create(),nt=Mi.fromValues(1,0,0),Zt=Mi.fromValues(0,1,0);return function(de,Pe,Qe){var rn=Mi.dot(Pe,Qe);return rn<-.999999?(Mi.cross(A,nt,Pe),Mi.len(A)<1e-6&&Mi.cross(A,Zt,Pe),Mi.normalize(A,A),tu(de,A,Math.PI),de):rn>.999999?(de[0]=0,de[1]=0,de[2]=0,de[3]=1,de):(Mi.cross(A,Pe,Qe),de[0]=A[0],de[1]=A[1],de[2]=A[2],de[3]=1+rn,Sl(de,de))}}(),kc=function(){var A=Ro(),nt=Ro();return function(Zt,de,Pe,Qe,rn,wn){return gs(A,de,rn,wn),gs(nt,Pe,Qe,wn),gs(Zt,A,nt,2*wn*(1-wn)),Zt}}(),Dl=function(){var A=xr.create();return function(nt,Zt,de,Pe){return A[0]=de[0],A[3]=de[1],A[6]=de[2],A[1]=Pe[0],A[4]=Pe[1],A[7]=Pe[2],A[2]=-Zt[0],A[5]=-Zt[1],A[8]=-Zt[2],Sl(nt,xu(nt,A))}}();function Ol(){var A=new L.ARRAY_TYPE(8);return L.ARRAY_TYPE!=Float32Array&&(A[0]=0,A[1]=0,A[2]=0,A[4]=0,A[5]=0,A[6]=0,A[7]=0),A[3]=1,A}function _e(A){var nt=new L.ARRAY_TYPE(8);return nt[0]=A[0],nt[1]=A[1],nt[2]=A[2],nt[3]=A[3],nt[4]=A[4],nt[5]=A[5],nt[6]=A[6],nt[7]=A[7],nt}function ve(A,nt,Zt,de,Pe,Qe,rn,wn){var kn=new L.ARRAY_TYPE(8);return kn[0]=A,kn[1]=nt,kn[2]=Zt,kn[3]=de,kn[4]=Pe,kn[5]=Qe,kn[6]=rn,kn[7]=wn,kn}function Bt(A,nt,Zt,de,Pe,Qe,rn){var wn=new L.ARRAY_TYPE(8);wn[0]=A,wn[1]=nt,wn[2]=Zt,wn[3]=de;var kn=Pe*.5,De=Qe*.5,wr=rn*.5;return wn[4]=kn*de+De*Zt-wr*nt,wn[5]=De*de+wr*A-kn*Zt,wn[6]=wr*de+kn*nt-De*A,wn[7]=-kn*A-De*nt-wr*Zt,wn}function ae(A,nt,Zt){var de=Zt[0]*.5,Pe=Zt[1]*.5,Qe=Zt[2]*.5,rn=nt[0],wn=nt[1],kn=nt[2],De=nt[3];return A[0]=rn,A[1]=wn,A[2]=kn,A[3]=De,A[4]=de*De+Pe*kn-Qe*wn,A[5]=Pe*De+Qe*rn-de*kn,A[6]=Qe*De+de*wn-Pe*rn,A[7]=-de*rn-Pe*wn-Qe*kn,A}function me(A,nt){return A[0]=0,A[1]=0,A[2]=0,A[3]=1,A[4]=nt[0]*.5,A[5]=nt[1]*.5,A[6]=nt[2]*.5,A[7]=0,A}function En(A,nt){return A[0]=nt[0],A[1]=nt[1],A[2]=nt[2],A[3]=nt[3],A[4]=0,A[5]=0,A[6]=0,A[7]=0,A}function Zn(A,nt){var Zt=Ro();at(Zt,nt);var de=new L.ARRAY_TYPE(3);return Lt(de,nt),ae(A,Zt,de),A}function Kt(A,nt){return A[0]=nt[0],A[1]=nt[1],A[2]=nt[2],A[3]=nt[3],A[4]=nt[4],A[5]=nt[5],A[6]=nt[6],A[7]=nt[7],A}function ge(A){return A[0]=0,A[1]=0,A[2]=0,A[3]=1,A[4]=0,A[5]=0,A[6]=0,A[7]=0,A}function Ae(A,nt,Zt,de,Pe,Qe,rn,wn,kn){return A[0]=nt,A[1]=Zt,A[2]=de,A[3]=Pe,A[4]=Qe,A[5]=rn,A[6]=wn,A[7]=kn,A}var sn=lu;function xn(A,nt){return A[0]=nt[4],A[1]=nt[5],A[2]=nt[6],A[3]=nt[7],A}var ir=lu;function $r(A,nt){return A[4]=nt[0],A[5]=nt[1],A[6]=nt[2],A[7]=nt[3],A}function Aa(A,nt){var Zt=nt[4],de=nt[5],Pe=nt[6],Qe=nt[7],rn=-nt[0],wn=-nt[1],kn=-nt[2],De=nt[3];return A[0]=(Zt*De+Qe*rn+de*kn-Pe*wn)*2,A[1]=(de*De+Qe*wn+Pe*rn-Zt*kn)*2,A[2]=(Pe*De+Qe*kn+Zt*wn-de*rn)*2,A}function Va(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=Zt[0]*.5,kn=Zt[1]*.5,De=Zt[2]*.5,wr=nt[4],ca=nt[5],Ar=nt[6],ua=nt[7];return A[0]=de,A[1]=Pe,A[2]=Qe,A[3]=rn,A[4]=rn*wn+Pe*De-Qe*kn+wr,A[5]=rn*kn+Qe*wn-de*De+ca,A[6]=rn*De+de*kn-Pe*wn+Ar,A[7]=-de*wn-Pe*kn-Qe*De+ua,A}function Ba(A,nt,Zt){var de=-nt[0],Pe=-nt[1],Qe=-nt[2],rn=nt[3],wn=nt[4],kn=nt[5],De=nt[6],wr=nt[7],ca=wn*rn+wr*de+kn*Qe-De*Pe,Ar=kn*rn+wr*Pe+De*de-wn*Qe,ua=De*rn+wr*Qe+wn*Pe-kn*de,$a=wr*rn-wn*de-kn*Pe-De*Qe;return Xr(A,nt,Zt),de=A[0],Pe=A[1],Qe=A[2],rn=A[3],A[4]=ca*rn+$a*de+Ar*Qe-ua*Pe,A[5]=Ar*rn+$a*Pe+ua*de-ca*Qe,A[6]=ua*rn+$a*Qe+ca*Pe-Ar*de,A[7]=$a*rn-ca*de-Ar*Pe-ua*Qe,A}function oi(A,nt,Zt){var de=-nt[0],Pe=-nt[1],Qe=-nt[2],rn=nt[3],wn=nt[4],kn=nt[5],De=nt[6],wr=nt[7],ca=wn*rn+wr*de+kn*Qe-De*Pe,Ar=kn*rn+wr*Pe+De*de-wn*Qe,ua=De*rn+wr*Qe+wn*Pe-kn*de,$a=wr*rn-wn*de-kn*Pe-De*Qe;return pa(A,nt,Zt),de=A[0],Pe=A[1],Qe=A[2],rn=A[3],A[4]=ca*rn+$a*de+Ar*Qe-ua*Pe,A[5]=Ar*rn+$a*Pe+ua*de-ca*Qe,A[6]=ua*rn+$a*Qe+ca*Pe-Ar*de,A[7]=$a*rn-ca*de-Ar*Pe-ua*Qe,A}function ro(A,nt,Zt){var de=-nt[0],Pe=-nt[1],Qe=-nt[2],rn=nt[3],wn=nt[4],kn=nt[5],De=nt[6],wr=nt[7],ca=wn*rn+wr*de+kn*Qe-De*Pe,Ar=kn*rn+wr*Pe+De*de-wn*Qe,ua=De*rn+wr*Qe+wn*Pe-kn*de,$a=wr*rn-wn*de-kn*Pe-De*Qe;return Ra(A,nt,Zt),de=A[0],Pe=A[1],Qe=A[2],rn=A[3],A[4]=ca*rn+$a*de+Ar*Qe-ua*Pe,A[5]=Ar*rn+$a*Pe+ua*de-ca*Qe,A[6]=ua*rn+$a*Qe+ca*Pe-Ar*de,A[7]=$a*rn-ca*de-Ar*Pe-ua*Qe,A}function Di(A,nt,Zt){var de=Zt[0],Pe=Zt[1],Qe=Zt[2],rn=Zt[3],wn=nt[0],kn=nt[1],De=nt[2],wr=nt[3];return A[0]=wn*rn+wr*de+kn*Qe-De*Pe,A[1]=kn*rn+wr*Pe+De*de-wn*Qe,A[2]=De*rn+wr*Qe+wn*Pe-kn*de,A[3]=wr*rn-wn*de-kn*Pe-De*Qe,wn=nt[4],kn=nt[5],De=nt[6],wr=nt[7],A[4]=wn*rn+wr*de+kn*Qe-De*Pe,A[5]=kn*rn+wr*Pe+De*de-wn*Qe,A[6]=De*rn+wr*Qe+wn*Pe-kn*de,A[7]=wr*rn-wn*de-kn*Pe-De*Qe,A}function Si(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=Zt[0],kn=Zt[1],De=Zt[2],wr=Zt[3];return A[0]=de*wr+rn*wn+Pe*De-Qe*kn,A[1]=Pe*wr+rn*kn+Qe*wn-de*De,A[2]=Qe*wr+rn*De+de*kn-Pe*wn,A[3]=rn*wr-de*wn-Pe*kn-Qe*De,wn=Zt[4],kn=Zt[5],De=Zt[6],wr=Zt[7],A[4]=de*wr+rn*wn+Pe*De-Qe*kn,A[5]=Pe*wr+rn*kn+Qe*wn-de*De,A[6]=Qe*wr+rn*De+de*kn-Pe*wn,A[7]=rn*wr-de*wn-Pe*kn-Qe*De,A}function _o(A,nt,Zt,de){if(Math.abs(de)<L.EPSILON)return Kt(A,nt);var Pe=Math.hypot(Zt[0],Zt[1],Zt[2]);de=de*.5;var Qe=Math.sin(de),rn=Qe*Zt[0]/Pe,wn=Qe*Zt[1]/Pe,kn=Qe*Zt[2]/Pe,De=Math.cos(de),wr=nt[0],ca=nt[1],Ar=nt[2],ua=nt[3];A[0]=wr*De+ua*rn+ca*kn-Ar*wn,A[1]=ca*De+ua*wn+Ar*rn-wr*kn,A[2]=Ar*De+ua*kn+wr*wn-ca*rn,A[3]=ua*De-wr*rn-ca*wn-Ar*kn;var $a=nt[4],ri=nt[5],ba=nt[6],ki=nt[7];return A[4]=$a*De+ki*rn+ri*kn-ba*wn,A[5]=ri*De+ki*wn+ba*rn-$a*kn,A[6]=ba*De+ki*kn+$a*wn-ri*rn,A[7]=ki*De-$a*rn-ri*wn-ba*kn,A}function To(A,nt,Zt){return A[0]=nt[0]+Zt[0],A[1]=nt[1]+Zt[1],A[2]=nt[2]+Zt[2],A[3]=nt[3]+Zt[3],A[4]=nt[4]+Zt[4],A[5]=nt[5]+Zt[5],A[6]=nt[6]+Zt[6],A[7]=nt[7]+Zt[7],A}function wo(A,nt,Zt){var de=nt[0],Pe=nt[1],Qe=nt[2],rn=nt[3],wn=Zt[4],kn=Zt[5],De=Zt[6],wr=Zt[7],ca=nt[4],Ar=nt[5],ua=nt[6],$a=nt[7],ri=Zt[0],ba=Zt[1],ki=Zt[2],Eo=Zt[3];return A[0]=de*Eo+rn*ri+Pe*ki-Qe*ba,A[1]=Pe*Eo+rn*ba+Qe*ri-de*ki,A[2]=Qe*Eo+rn*ki+de*ba-Pe*ri,A[3]=rn*Eo-de*ri-Pe*ba-Qe*ki,A[4]=de*wr+rn*wn+Pe*De-Qe*kn+ca*Eo+$a*ri+Ar*ki-ua*ba,A[5]=Pe*wr+rn*kn+Qe*wn-de*De+Ar*Eo+$a*ba+ua*ri-ca*ki,A[6]=Qe*wr+rn*De+de*kn-Pe*wn+ua*Eo+$a*ki+ca*ba-Ar*ri,A[7]=rn*wr-de*wn-Pe*kn-Qe*De+$a*Eo-ca*ri-Ar*ba-ua*ki,A}var Vo=wo;function js(A,nt,Zt){return A[0]=nt[0]*Zt,A[1]=nt[1]*Zt,A[2]=nt[2]*Zt,A[3]=nt[3]*Zt,A[4]=nt[4]*Zt,A[5]=nt[5]*Zt,A[6]=nt[6]*Zt,A[7]=nt[7]*Zt,A}var ws=Bu;function ks(A,nt,Zt,de){var Pe=1-de;return ws(nt,Zt)<0&&(de=-de),A[0]=nt[0]*Pe+Zt[0]*de,A[1]=nt[1]*Pe+Zt[1]*de,A[2]=nt[2]*Pe+Zt[2]*de,A[3]=nt[3]*Pe+Zt[3]*de,A[4]=nt[4]*Pe+Zt[4]*de,A[5]=nt[5]*Pe+Zt[5]*de,A[6]=nt[6]*Pe+Zt[6]*de,A[7]=nt[7]*Pe+Zt[7]*de,A}function Hs(A,nt){var Zt=Yl(nt);return A[0]=-nt[0]/Zt,A[1]=-nt[1]/Zt,A[2]=-nt[2]/Zt,A[3]=nt[3]/Zt,A[4]=-nt[4]/Zt,A[5]=-nt[5]/Zt,A[6]=-nt[6]/Zt,A[7]=nt[7]/Zt,A}function Mu(A,nt){return A[0]=-nt[0],A[1]=-nt[1],A[2]=-nt[2],A[3]=nt[3],A[4]=-nt[4],A[5]=-nt[5],A[6]=-nt[6],A[7]=nt[7],A}var nl=wu,Cl=nl,Yl=Tl,sl=Yl;function rl(A,nt){var Zt=Yl(nt);if(Zt>0){Zt=Math.sqrt(Zt);var de=nt[0]/Zt,Pe=nt[1]/Zt,Qe=nt[2]/Zt,rn=nt[3]/Zt,wn=nt[4],kn=nt[5],De=nt[6],wr=nt[7],ca=de*wn+Pe*kn+Qe*De+rn*wr;A[0]=de,A[1]=Pe,A[2]=Qe,A[3]=rn,A[4]=(wn-de*ca)/Zt,A[5]=(kn-Pe*ca)/Zt,A[6]=(De-Qe*ca)/Zt,A[7]=(wr-rn*ca)/Zt}return A}function _f(A){return"quat2("+A[0]+", "+A[1]+", "+A[2]+", "+A[3]+", "+A[4]+", "+A[5]+", "+A[6]+", "+A[7]+")"}function Dc(A,nt){return A[0]===nt[0]&&A[1]===nt[1]&&A[2]===nt[2]&&A[3]===nt[3]&&A[4]===nt[4]&&A[5]===nt[5]&&A[6]===nt[6]&&A[7]===nt[7]}function wc(A,nt){var Zt=A[0],de=A[1],Pe=A[2],Qe=A[3],rn=A[4],wn=A[5],kn=A[6],De=A[7],wr=nt[0],ca=nt[1],Ar=nt[2],ua=nt[3],$a=nt[4],ri=nt[5],ba=nt[6],ki=nt[7];return Math.abs(Zt-wr)<=L.EPSILON*Math.max(1,Math.abs(Zt),Math.abs(wr))&&Math.abs(de-ca)<=L.EPSILON*Math.max(1,Math.abs(de),Math.abs(ca))&&Math.abs(Pe-Ar)<=L.EPSILON*Math.max(1,Math.abs(Pe),Math.abs(Ar))&&Math.abs(Qe-ua)<=L.EPSILON*Math.max(1,Math.abs(Qe),Math.abs(ua))&&Math.abs(rn-$a)<=L.EPSILON*Math.max(1,Math.abs(rn),Math.abs($a))&&Math.abs(wn-ri)<=L.EPSILON*Math.max(1,Math.abs(wn),Math.abs(ri))&&Math.abs(kn-ba)<=L.EPSILON*Math.max(1,Math.abs(kn),Math.abs(ba))&&Math.abs(De-ki)<=L.EPSILON*Math.max(1,Math.abs(De),Math.abs(ki))}var ef=$(31437)},35600:function(sr,it,$){"use strict";$.r(it),$.d(it,{create:function(){return tt},fromMat4:function(){return j},clone:function(){return W},copy:function(){return Q},fromValues:function(){return Z},set:function(){return L},identity:function(){return P},transpose:function(){return C},invert:function(){return M},adjoint:function(){return k},determinant:function(){return B},multiply:function(){return R},translate:function(){return F},rotate:function(){return K},scale:function(){return O},fromTranslation:function(){return _},fromRotation:function(){return ft},fromScaling:function(){return mt},fromMat2d:function(){return st},fromQuat:function(){return ut},normalFromMat4:function(){return dt},projection:function(){return gt},str:function(){return wt},frob:function(){return ot},add:function(){return pt},subtract:function(){return Nt},multiplyScalar:function(){return Gt},multiplyScalarAndAdd:function(){return se},exactEquals:function(){return ie},equals:function(){return Be},mul:function(){return ke},sub:function(){return we}});var X=$(49685);function tt(){var At=new X.ARRAY_TYPE(9);return X.ARRAY_TYPE!=Float32Array&&(At[1]=0,At[2]=0,At[3]=0,At[5]=0,At[6]=0,At[7]=0),At[0]=1,At[4]=1,At[8]=1,At}function j(At,Yt){return At[0]=Yt[0],At[1]=Yt[1],At[2]=Yt[2],At[3]=Yt[4],At[4]=Yt[5],At[5]=Yt[6],At[6]=Yt[8],At[7]=Yt[9],At[8]=Yt[10],At}function W(At){var Yt=new X.ARRAY_TYPE(9);return Yt[0]=At[0],Yt[1]=At[1],Yt[2]=At[2],Yt[3]=At[3],Yt[4]=At[4],Yt[5]=At[5],Yt[6]=At[6],Yt[7]=At[7],Yt[8]=At[8],Yt}function Q(At,Yt){return At[0]=Yt[0],At[1]=Yt[1],At[2]=Yt[2],At[3]=Yt[3],At[4]=Yt[4],At[5]=Yt[5],At[6]=Yt[6],At[7]=Yt[7],At[8]=Yt[8],At}function Z(At,Yt,be,nn,Ee,le,Le,Ze,fe){var Re=new X.ARRAY_TYPE(9);return Re[0]=At,Re[1]=Yt,Re[2]=be,Re[3]=nn,Re[4]=Ee,Re[5]=le,Re[6]=Le,Re[7]=Ze,Re[8]=fe,Re}function L(At,Yt,be,nn,Ee,le,Le,Ze,fe,Re){return At[0]=Yt,At[1]=be,At[2]=nn,At[3]=Ee,At[4]=le,At[5]=Le,At[6]=Ze,At[7]=fe,At[8]=Re,At}function P(At){return At[0]=1,At[1]=0,At[2]=0,At[3]=0,At[4]=1,At[5]=0,At[6]=0,At[7]=0,At[8]=1,At}function C(At,Yt){if(At===Yt){var be=Yt[1],nn=Yt[2],Ee=Yt[5];At[1]=Yt[3],At[2]=Yt[6],At[3]=be,At[5]=Yt[7],At[6]=nn,At[7]=Ee}else At[0]=Yt[0],At[1]=Yt[3],At[2]=Yt[6],At[3]=Yt[1],At[4]=Yt[4],At[5]=Yt[7],At[6]=Yt[2],At[7]=Yt[5],At[8]=Yt[8];return At}function M(At,Yt){var be=Yt[0],nn=Yt[1],Ee=Yt[2],le=Yt[3],Le=Yt[4],Ze=Yt[5],fe=Yt[6],Re=Yt[7],He=Yt[8],pe=He*Le-Ze*Re,Ge=-He*le+Ze*fe,te=Re*le-Le*fe,Me=be*pe+nn*Ge+Ee*te;return Me?(Me=1/Me,At[0]=pe*Me,At[1]=(-He*nn+Ee*Re)*Me,At[2]=(Ze*nn-Ee*Le)*Me,At[3]=Ge*Me,At[4]=(He*be-Ee*fe)*Me,At[5]=(-Ze*be+Ee*le)*Me,At[6]=te*Me,At[7]=(-Re*be+nn*fe)*Me,At[8]=(Le*be-nn*le)*Me,At):null}function k(At,Yt){var be=Yt[0],nn=Yt[1],Ee=Yt[2],le=Yt[3],Le=Yt[4],Ze=Yt[5],fe=Yt[6],Re=Yt[7],He=Yt[8];return At[0]=Le*He-Ze*Re,At[1]=Ee*Re-nn*He,At[2]=nn*Ze-Ee*Le,At[3]=Ze*fe-le*He,At[4]=be*He-Ee*fe,At[5]=Ee*le-be*Ze,At[6]=le*Re-Le*fe,At[7]=nn*fe-be*Re,At[8]=be*Le-nn*le,At}function B(At){var Yt=At[0],be=At[1],nn=At[2],Ee=At[3],le=At[4],Le=At[5],Ze=At[6],fe=At[7],Re=At[8];return Yt*(Re*le-Le*fe)+be*(-Re*Ee+Le*Ze)+nn*(fe*Ee-le*Ze)}function R(At,Yt,be){var nn=Yt[0],Ee=Yt[1],le=Yt[2],Le=Yt[3],Ze=Yt[4],fe=Yt[5],Re=Yt[6],He=Yt[7],pe=Yt[8],Ge=be[0],te=be[1],Me=be[2],We=be[3],ee=be[4],Pt=be[5],yt=be[6],Ne=be[7],tn=be[8];return At[0]=Ge*nn+te*Le+Me*Re,At[1]=Ge*Ee+te*Ze+Me*He,At[2]=Ge*le+te*fe+Me*pe,At[3]=We*nn+ee*Le+Pt*Re,At[4]=We*Ee+ee*Ze+Pt*He,At[5]=We*le+ee*fe+Pt*pe,At[6]=yt*nn+Ne*Le+tn*Re,At[7]=yt*Ee+Ne*Ze+tn*He,At[8]=yt*le+Ne*fe+tn*pe,At}function F(At,Yt,be){var nn=Yt[0],Ee=Yt[1],le=Yt[2],Le=Yt[3],Ze=Yt[4],fe=Yt[5],Re=Yt[6],He=Yt[7],pe=Yt[8],Ge=be[0],te=be[1];return At[0]=nn,At[1]=Ee,At[2]=le,At[3]=Le,At[4]=Ze,At[5]=fe,At[6]=Ge*nn+te*Le+Re,At[7]=Ge*Ee+te*Ze+He,At[8]=Ge*le+te*fe+pe,At}function K(At,Yt,be){var nn=Yt[0],Ee=Yt[1],le=Yt[2],Le=Yt[3],Ze=Yt[4],fe=Yt[5],Re=Yt[6],He=Yt[7],pe=Yt[8],Ge=Math.sin(be),te=Math.cos(be);return At[0]=te*nn+Ge*Le,At[1]=te*Ee+Ge*Ze,At[2]=te*le+Ge*fe,At[3]=te*Le-Ge*nn,At[4]=te*Ze-Ge*Ee,At[5]=te*fe-Ge*le,At[6]=Re,At[7]=He,At[8]=pe,At}function O(At,Yt,be){var nn=be[0],Ee=be[1];return At[0]=nn*Yt[0],At[1]=nn*Yt[1],At[2]=nn*Yt[2],At[3]=Ee*Yt[3],At[4]=Ee*Yt[4],At[5]=Ee*Yt[5],At[6]=Yt[6],At[7]=Yt[7],At[8]=Yt[8],At}function _(At,Yt){return At[0]=1,At[1]=0,At[2]=0,At[3]=0,At[4]=1,At[5]=0,At[6]=Yt[0],At[7]=Yt[1],At[8]=1,At}function ft(At,Yt){var be=Math.sin(Yt),nn=Math.cos(Yt);return At[0]=nn,At[1]=be,At[2]=0,At[3]=-be,At[4]=nn,At[5]=0,At[6]=0,At[7]=0,At[8]=1,At}function mt(At,Yt){return At[0]=Yt[0],At[1]=0,At[2]=0,At[3]=0,At[4]=Yt[1],At[5]=0,At[6]=0,At[7]=0,At[8]=1,At}function st(At,Yt){return At[0]=Yt[0],At[1]=Yt[1],At[2]=0,At[3]=Yt[2],At[4]=Yt[3],At[5]=0,At[6]=Yt[4],At[7]=Yt[5],At[8]=1,At}function ut(At,Yt){var be=Yt[0],nn=Yt[1],Ee=Yt[2],le=Yt[3],Le=be+be,Ze=nn+nn,fe=Ee+Ee,Re=be*Le,He=nn*Le,pe=nn*Ze,Ge=Ee*Le,te=Ee*Ze,Me=Ee*fe,We=le*Le,ee=le*Ze,Pt=le*fe;return At[0]=1-pe-Me,At[3]=He-Pt,At[6]=Ge+ee,At[1]=He+Pt,At[4]=1-Re-Me,At[7]=te-We,At[2]=Ge-ee,At[5]=te+We,At[8]=1-Re-pe,At}function dt(At,Yt){var be=Yt[0],nn=Yt[1],Ee=Yt[2],le=Yt[3],Le=Yt[4],Ze=Yt[5],fe=Yt[6],Re=Yt[7],He=Yt[8],pe=Yt[9],Ge=Yt[10],te=Yt[11],Me=Yt[12],We=Yt[13],ee=Yt[14],Pt=Yt[15],yt=be*Ze-nn*Le,Ne=be*fe-Ee*Le,tn=be*Re-le*Le,fn=nn*fe-Ee*Ze,Rt=nn*Re-le*Ze,Yn=Ee*Re-le*fe,Un=He*We-pe*Me,xr=He*ee-Ge*Me,cr=He*Pt-te*Me,Ur=pe*ee-Ge*We,fa=pe*Pt-te*We,Sa=Ge*Pt-te*ee,sa=yt*Sa-Ne*fa+tn*Ur+fn*cr-Rt*xr+Yn*Un;return sa?(sa=1/sa,At[0]=(Ze*Sa-fe*fa+Re*Ur)*sa,At[1]=(fe*cr-Le*Sa-Re*xr)*sa,At[2]=(Le*fa-Ze*cr+Re*Un)*sa,At[3]=(Ee*fa-nn*Sa-le*Ur)*sa,At[4]=(be*Sa-Ee*cr+le*xr)*sa,At[5]=(nn*cr-be*fa-le*Un)*sa,At[6]=(We*Yn-ee*Rt+Pt*fn)*sa,At[7]=(ee*tn-Me*Yn-Pt*Ne)*sa,At[8]=(Me*Rt-We*tn+Pt*yt)*sa,At):null}function gt(At,Yt,be){return At[0]=2/Yt,At[1]=0,At[2]=0,At[3]=0,At[4]=-2/be,At[5]=0,At[6]=-1,At[7]=1,At[8]=1,At}function wt(At){return"mat3("+At[0]+", "+At[1]+", "+At[2]+", "+At[3]+", "+At[4]+", "+At[5]+", "+At[6]+", "+At[7]+", "+At[8]+")"}function ot(At){return Math.hypot(At[0],At[1],At[2],At[3],At[4],At[5],At[6],At[7],At[8])}function pt(At,Yt,be){return At[0]=Yt[0]+be[0],At[1]=Yt[1]+be[1],At[2]=Yt[2]+be[2],At[3]=Yt[3]+be[3],At[4]=Yt[4]+be[4],At[5]=Yt[5]+be[5],At[6]=Yt[6]+be[6],At[7]=Yt[7]+be[7],At[8]=Yt[8]+be[8],At}function Nt(At,Yt,be){return At[0]=Yt[0]-be[0],At[1]=Yt[1]-be[1],At[2]=Yt[2]-be[2],At[3]=Yt[3]-be[3],At[4]=Yt[4]-be[4],At[5]=Yt[5]-be[5],At[6]=Yt[6]-be[6],At[7]=Yt[7]-be[7],At[8]=Yt[8]-be[8],At}function Gt(At,Yt,be){return At[0]=Yt[0]*be,At[1]=Yt[1]*be,At[2]=Yt[2]*be,At[3]=Yt[3]*be,At[4]=Yt[4]*be,At[5]=Yt[5]*be,At[6]=Yt[6]*be,At[7]=Yt[7]*be,At[8]=Yt[8]*be,At}function se(At,Yt,be,nn){return At[0]=Yt[0]+be[0]*nn,At[1]=Yt[1]+be[1]*nn,At[2]=Yt[2]+be[2]*nn,At[3]=Yt[3]+be[3]*nn,At[4]=Yt[4]+be[4]*nn,At[5]=Yt[5]+be[5]*nn,At[6]=Yt[6]+be[6]*nn,At[7]=Yt[7]+be[7]*nn,At[8]=Yt[8]+be[8]*nn,At}function ie(At,Yt){return At[0]===Yt[0]&&At[1]===Yt[1]&&At[2]===Yt[2]&&At[3]===Yt[3]&&At[4]===Yt[4]&&At[5]===Yt[5]&&At[6]===Yt[6]&&At[7]===Yt[7]&&At[8]===Yt[8]}function Be(At,Yt){var be=At[0],nn=At[1],Ee=At[2],le=At[3],Le=At[4],Ze=At[5],fe=At[6],Re=At[7],He=At[8],pe=Yt[0],Ge=Yt[1],te=Yt[2],Me=Yt[3],We=Yt[4],ee=Yt[5],Pt=Yt[6],yt=Yt[7],Ne=Yt[8];return Math.abs(be-pe)<=X.EPSILON*Math.max(1,Math.abs(be),Math.abs(pe))&&Math.abs(nn-Ge)<=X.EPSILON*Math.max(1,Math.abs(nn),Math.abs(Ge))&&Math.abs(Ee-te)<=X.EPSILON*Math.max(1,Math.abs(Ee),Math.abs(te))&&Math.abs(le-Me)<=X.EPSILON*Math.max(1,Math.abs(le),Math.abs(Me))&&Math.abs(Le-We)<=X.EPSILON*Math.max(1,Math.abs(Le),Math.abs(We))&&Math.abs(Ze-ee)<=X.EPSILON*Math.max(1,Math.abs(Ze),Math.abs(ee))&&Math.abs(fe-Pt)<=X.EPSILON*Math.max(1,Math.abs(fe),Math.abs(Pt))&&Math.abs(Re-yt)<=X.EPSILON*Math.max(1,Math.abs(Re),Math.abs(yt))&&Math.abs(He-Ne)<=X.EPSILON*Math.max(1,Math.abs(He),Math.abs(Ne))}var ke=R,we=Nt},31437:function(sr,it,$){"use strict";$.r(it),$.d(it,{create:function(){return tt},clone:function(){return j},fromValues:function(){return W},copy:function(){return Q},set:function(){return Z},add:function(){return L},subtract:function(){return P},multiply:function(){return C},divide:function(){return M},ceil:function(){return k},floor:function(){return B},min:function(){return R},max:function(){return F},round:function(){return K},scale:function(){return O},scaleAndAdd:function(){return _},distance:function(){return ft},squaredDistance:function(){return mt},length:function(){return st},squaredLength:function(){return ut},negate:function(){return dt},inverse:function(){return gt},normalize:function(){return wt},dot:function(){return ot},cross:function(){return pt},lerp:function(){return Nt},random:function(){return Gt},transformMat2:function(){return se},transformMat2d:function(){return ie},transformMat3:function(){return Be},transformMat4:function(){return ke},rotate:function(){return we},angle:function(){return At},zero:function(){return Yt},str:function(){return be},exactEquals:function(){return nn},equals:function(){return Ee},len:function(){return le},sub:function(){return Le},mul:function(){return Ze},div:function(){return fe},dist:function(){return Re},sqrDist:function(){return He},sqrLen:function(){return pe},forEach:function(){return Ge}});var X=$(49685);function tt(){var te=new X.ARRAY_TYPE(2);return X.ARRAY_TYPE!=Float32Array&&(te[0]=0,te[1]=0),te}function j(te){var Me=new X.ARRAY_TYPE(2);return Me[0]=te[0],Me[1]=te[1],Me}function W(te,Me){var We=new X.ARRAY_TYPE(2);return We[0]=te,We[1]=Me,We}function Q(te,Me){return te[0]=Me[0],te[1]=Me[1],te}function Z(te,Me,We){return te[0]=Me,te[1]=We,te}function L(te,Me,We){return te[0]=Me[0]+We[0],te[1]=Me[1]+We[1],te}function P(te,Me,We){return te[0]=Me[0]-We[0],te[1]=Me[1]-We[1],te}function C(te,Me,We){return te[0]=Me[0]*We[0],te[1]=Me[1]*We[1],te}function M(te,Me,We){return te[0]=Me[0]/We[0],te[1]=Me[1]/We[1],te}function k(te,Me){return te[0]=Math.ceil(Me[0]),te[1]=Math.ceil(Me[1]),te}function B(te,Me){return te[0]=Math.floor(Me[0]),te[1]=Math.floor(Me[1]),te}function R(te,Me,We){return te[0]=Math.min(Me[0],We[0]),te[1]=Math.min(Me[1],We[1]),te}function F(te,Me,We){return te[0]=Math.max(Me[0],We[0]),te[1]=Math.max(Me[1],We[1]),te}function K(te,Me){return te[0]=Math.round(Me[0]),te[1]=Math.round(Me[1]),te}function O(te,Me,We){return te[0]=Me[0]*We,te[1]=Me[1]*We,te}function _(te,Me,We,ee){return te[0]=Me[0]+We[0]*ee,te[1]=Me[1]+We[1]*ee,te}function ft(te,Me){var We=Me[0]-te[0],ee=Me[1]-te[1];return Math.hypot(We,ee)}function mt(te,Me){var We=Me[0]-te[0],ee=Me[1]-te[1];return We*We+ee*ee}function st(te){var Me=te[0],We=te[1];return Math.hypot(Me,We)}function ut(te){var Me=te[0],We=te[1];return Me*Me+We*We}function dt(te,Me){return te[0]=-Me[0],te[1]=-Me[1],te}function gt(te,Me){return te[0]=1/Me[0],te[1]=1/Me[1],te}function wt(te,Me){var We=Me[0],ee=Me[1],Pt=We*We+ee*ee;return Pt>0&&(Pt=1/Math.sqrt(Pt)),te[0]=Me[0]*Pt,te[1]=Me[1]*Pt,te}function ot(te,Me){return te[0]*Me[0]+te[1]*Me[1]}function pt(te,Me,We){var ee=Me[0]*We[1]-Me[1]*We[0];return te[0]=te[1]=0,te[2]=ee,te}function Nt(te,Me,We,ee){var Pt=Me[0],yt=Me[1];return te[0]=Pt+ee*(We[0]-Pt),te[1]=yt+ee*(We[1]-yt),te}function Gt(te,Me){Me=Me||1;var We=X.RANDOM()*2*Math.PI;return te[0]=Math.cos(We)*Me,te[1]=Math.sin(We)*Me,te}function se(te,Me,We){var ee=Me[0],Pt=Me[1];return te[0]=We[0]*ee+We[2]*Pt,te[1]=We[1]*ee+We[3]*Pt,te}function ie(te,Me,We){var ee=Me[0],Pt=Me[1];return te[0]=We[0]*ee+We[2]*Pt+We[4],te[1]=We[1]*ee+We[3]*Pt+We[5],te}function Be(te,Me,We){var ee=Me[0],Pt=Me[1];return te[0]=We[0]*ee+We[3]*Pt+We[6],te[1]=We[1]*ee+We[4]*Pt+We[7],te}function ke(te,Me,We){var ee=Me[0],Pt=Me[1];return te[0]=We[0]*ee+We[4]*Pt+We[12],te[1]=We[1]*ee+We[5]*Pt+We[13],te}function we(te,Me,We,ee){var Pt=Me[0]-We[0],yt=Me[1]-We[1],Ne=Math.sin(ee),tn=Math.cos(ee);return te[0]=Pt*tn-yt*Ne+We[0],te[1]=Pt*Ne+yt*tn+We[1],te}function At(te,Me){var We=te[0],ee=te[1],Pt=Me[0],yt=Me[1],Ne=Math.sqrt(We*We+ee*ee)*Math.sqrt(Pt*Pt+yt*yt),tn=Ne&&(We*Pt+ee*yt)/Ne;return Math.acos(Math.min(Math.max(tn,-1),1))}function Yt(te){return te[0]=0,te[1]=0,te}function be(te){return"vec2("+te[0]+", "+te[1]+")"}function nn(te,Me){return te[0]===Me[0]&&te[1]===Me[1]}function Ee(te,Me){var We=te[0],ee=te[1],Pt=Me[0],yt=Me[1];return Math.abs(We-Pt)<=X.EPSILON*Math.max(1,Math.abs(We),Math.abs(Pt))&&Math.abs(ee-yt)<=X.EPSILON*Math.max(1,Math.abs(ee),Math.abs(yt))}var le=st,Le=P,Ze=C,fe=M,Re=ft,He=mt,pe=ut,Ge=function(){var te=tt();return function(Me,We,ee,Pt,yt,Ne){var tn,fn;for(We||(We=2),ee||(ee=0),Pt?fn=Math.min(Pt*We+ee,Me.length):fn=Me.length,tn=ee;tn<fn;tn+=We)te[0]=Me[tn],te[1]=Me[tn+1],yt(te,te,Ne),Me[tn]=te[0],Me[tn+1]=te[1];return Me}}()},77160:function(sr,it,$){"use strict";$.r(it),$.d(it,{create:function(){return tt},clone:function(){return j},length:function(){return W},fromValues:function(){return Q},copy:function(){return Z},set:function(){return L},add:function(){return P},subtract:function(){return C},multiply:function(){return M},divide:function(){return k},ceil:function(){return B},floor:function(){return R},min:function(){return F},max:function(){return K},round:function(){return O},scale:function(){return _},scaleAndAdd:function(){return ft},distance:function(){return mt},squaredDistance:function(){return st},squaredLength:function(){return ut},negate:function(){return dt},inverse:function(){return gt},normalize:function(){return wt},dot:function(){return ot},cross:function(){return pt},lerp:function(){return Nt},hermite:function(){return Gt},bezier:function(){return se},random:function(){return ie},transformMat4:function(){return Be},transformMat3:function(){return ke},transformQuat:function(){return we},rotateX:function(){return At},rotateY:function(){return Yt},rotateZ:function(){return be},angle:function(){return nn},zero:function(){return Ee},str:function(){return le},exactEquals:function(){return Le},equals:function(){return Ze},sub:function(){return fe},mul:function(){return Re},div:function(){return He},dist:function(){return pe},sqrDist:function(){return Ge},len:function(){return te},sqrLen:function(){return Me},forEach:function(){return We}});var X=$(49685);function tt(){var ee=new X.ARRAY_TYPE(3);return X.ARRAY_TYPE!=Float32Array&&(ee[0]=0,ee[1]=0,ee[2]=0),ee}function j(ee){var Pt=new X.ARRAY_TYPE(3);return Pt[0]=ee[0],Pt[1]=ee[1],Pt[2]=ee[2],Pt}function W(ee){var Pt=ee[0],yt=ee[1],Ne=ee[2];return Math.hypot(Pt,yt,Ne)}function Q(ee,Pt,yt){var Ne=new X.ARRAY_TYPE(3);return Ne[0]=ee,Ne[1]=Pt,Ne[2]=yt,Ne}function Z(ee,Pt){return ee[0]=Pt[0],ee[1]=Pt[1],ee[2]=Pt[2],ee}function L(ee,Pt,yt,Ne){return ee[0]=Pt,ee[1]=yt,ee[2]=Ne,ee}function P(ee,Pt,yt){return ee[0]=Pt[0]+yt[0],ee[1]=Pt[1]+yt[1],ee[2]=Pt[2]+yt[2],ee}function C(ee,Pt,yt){return ee[0]=Pt[0]-yt[0],ee[1]=Pt[1]-yt[1],ee[2]=Pt[2]-yt[2],ee}function M(ee,Pt,yt){return ee[0]=Pt[0]*yt[0],ee[1]=Pt[1]*yt[1],ee[2]=Pt[2]*yt[2],ee}function k(ee,Pt,yt){return ee[0]=Pt[0]/yt[0],ee[1]=Pt[1]/yt[1],ee[2]=Pt[2]/yt[2],ee}function B(ee,Pt){return ee[0]=Math.ceil(Pt[0]),ee[1]=Math.ceil(Pt[1]),ee[2]=Math.ceil(Pt[2]),ee}function R(ee,Pt){return ee[0]=Math.floor(Pt[0]),ee[1]=Math.floor(Pt[1]),ee[2]=Math.floor(Pt[2]),ee}function F(ee,Pt,yt){return ee[0]=Math.min(Pt[0],yt[0]),ee[1]=Math.min(Pt[1],yt[1]),ee[2]=Math.min(Pt[2],yt[2]),ee}function K(ee,Pt,yt){return ee[0]=Math.max(Pt[0],yt[0]),ee[1]=Math.max(Pt[1],yt[1]),ee[2]=Math.max(Pt[2],yt[2]),ee}function O(ee,Pt){return ee[0]=Math.round(Pt[0]),ee[1]=Math.round(Pt[1]),ee[2]=Math.round(Pt[2]),ee}function _(ee,Pt,yt){return ee[0]=Pt[0]*yt,ee[1]=Pt[1]*yt,ee[2]=Pt[2]*yt,ee}function ft(ee,Pt,yt,Ne){return ee[0]=Pt[0]+yt[0]*Ne,ee[1]=Pt[1]+yt[1]*Ne,ee[2]=Pt[2]+yt[2]*Ne,ee}function mt(ee,Pt){var yt=Pt[0]-ee[0],Ne=Pt[1]-ee[1],tn=Pt[2]-ee[2];return Math.hypot(yt,Ne,tn)}function st(ee,Pt){var yt=Pt[0]-ee[0],Ne=Pt[1]-ee[1],tn=Pt[2]-ee[2];return yt*yt+Ne*Ne+tn*tn}function ut(ee){var Pt=ee[0],yt=ee[1],Ne=ee[2];return Pt*Pt+yt*yt+Ne*Ne}function dt(ee,Pt){return ee[0]=-Pt[0],ee[1]=-Pt[1],ee[2]=-Pt[2],ee}function gt(ee,Pt){return ee[0]=1/Pt[0],ee[1]=1/Pt[1],ee[2]=1/Pt[2],ee}function wt(ee,Pt){var yt=Pt[0],Ne=Pt[1],tn=Pt[2],fn=yt*yt+Ne*Ne+tn*tn;return fn>0&&(fn=1/Math.sqrt(fn)),ee[0]=Pt[0]*fn,ee[1]=Pt[1]*fn,ee[2]=Pt[2]*fn,ee}function ot(ee,Pt){return ee[0]*Pt[0]+ee[1]*Pt[1]+ee[2]*Pt[2]}function pt(ee,Pt,yt){var Ne=Pt[0],tn=Pt[1],fn=Pt[2],Rt=yt[0],Yn=yt[1],Un=yt[2];return ee[0]=tn*Un-fn*Yn,ee[1]=fn*Rt-Ne*Un,ee[2]=Ne*Yn-tn*Rt,ee}function Nt(ee,Pt,yt,Ne){var tn=Pt[0],fn=Pt[1],Rt=Pt[2];return ee[0]=tn+Ne*(yt[0]-tn),ee[1]=fn+Ne*(yt[1]-fn),ee[2]=Rt+Ne*(yt[2]-Rt),ee}function Gt(ee,Pt,yt,Ne,tn,fn){var Rt=fn*fn,Yn=Rt*(2*fn-3)+1,Un=Rt*(fn-2)+fn,xr=Rt*(fn-1),cr=Rt*(3-2*fn);return ee[0]=Pt[0]*Yn+yt[0]*Un+Ne[0]*xr+tn[0]*cr,ee[1]=Pt[1]*Yn+yt[1]*Un+Ne[1]*xr+tn[1]*cr,ee[2]=Pt[2]*Yn+yt[2]*Un+Ne[2]*xr+tn[2]*cr,ee}function se(ee,Pt,yt,Ne,tn,fn){var Rt=1-fn,Yn=Rt*Rt,Un=fn*fn,xr=Yn*Rt,cr=3*fn*Yn,Ur=3*Un*Rt,fa=Un*fn;return ee[0]=Pt[0]*xr+yt[0]*cr+Ne[0]*Ur+tn[0]*fa,ee[1]=Pt[1]*xr+yt[1]*cr+Ne[1]*Ur+tn[1]*fa,ee[2]=Pt[2]*xr+yt[2]*cr+Ne[2]*Ur+tn[2]*fa,ee}function ie(ee,Pt){Pt=Pt||1;var yt=X.RANDOM()*2*Math.PI,Ne=X.RANDOM()*2-1,tn=Math.sqrt(1-Ne*Ne)*Pt;return ee[0]=Math.cos(yt)*tn,ee[1]=Math.sin(yt)*tn,ee[2]=Ne*Pt,ee}function Be(ee,Pt,yt){var Ne=Pt[0],tn=Pt[1],fn=Pt[2],Rt=yt[3]*Ne+yt[7]*tn+yt[11]*fn+yt[15];return Rt=Rt||1,ee[0]=(yt[0]*Ne+yt[4]*tn+yt[8]*fn+yt[12])/Rt,ee[1]=(yt[1]*Ne+yt[5]*tn+yt[9]*fn+yt[13])/Rt,ee[2]=(yt[2]*Ne+yt[6]*tn+yt[10]*fn+yt[14])/Rt,ee}function ke(ee,Pt,yt){var Ne=Pt[0],tn=Pt[1],fn=Pt[2];return ee[0]=Ne*yt[0]+tn*yt[3]+fn*yt[6],ee[1]=Ne*yt[1]+tn*yt[4]+fn*yt[7],ee[2]=Ne*yt[2]+tn*yt[5]+fn*yt[8],ee}function we(ee,Pt,yt){var Ne=yt[0],tn=yt[1],fn=yt[2],Rt=yt[3],Yn=Pt[0],Un=Pt[1],xr=Pt[2],cr=tn*xr-fn*Un,Ur=fn*Yn-Ne*xr,fa=Ne*Un-tn*Yn,Sa=tn*fa-fn*Ur,sa=fn*cr-Ne*fa,Da=Ne*Ur-tn*cr,Rr=Rt*2;return cr*=Rr,Ur*=Rr,fa*=Rr,Sa*=2,sa*=2,Da*=2,ee[0]=Yn+cr+Sa,ee[1]=Un+Ur+sa,ee[2]=xr+fa+Da,ee}function At(ee,Pt,yt,Ne){var tn=[],fn=[];return tn[0]=Pt[0]-yt[0],tn[1]=Pt[1]-yt[1],tn[2]=Pt[2]-yt[2],fn[0]=tn[0],fn[1]=tn[1]*Math.cos(Ne)-tn[2]*Math.sin(Ne),fn[2]=tn[1]*Math.sin(Ne)+tn[2]*Math.cos(Ne),ee[0]=fn[0]+yt[0],ee[1]=fn[1]+yt[1],ee[2]=fn[2]+yt[2],ee}function Yt(ee,Pt,yt,Ne){var tn=[],fn=[];return tn[0]=Pt[0]-yt[0],tn[1]=Pt[1]-yt[1],tn[2]=Pt[2]-yt[2],fn[0]=tn[2]*Math.sin(Ne)+tn[0]*Math.cos(Ne),fn[1]=tn[1],fn[2]=tn[2]*Math.cos(Ne)-tn[0]*Math.sin(Ne),ee[0]=fn[0]+yt[0],ee[1]=fn[1]+yt[1],ee[2]=fn[2]+yt[2],ee}function be(ee,Pt,yt,Ne){var tn=[],fn=[];return tn[0]=Pt[0]-yt[0],tn[1]=Pt[1]-yt[1],tn[2]=Pt[2]-yt[2],fn[0]=tn[0]*Math.cos(Ne)-tn[1]*Math.sin(Ne),fn[1]=tn[0]*Math.sin(Ne)+tn[1]*Math.cos(Ne),fn[2]=tn[2],ee[0]=fn[0]+yt[0],ee[1]=fn[1]+yt[1],ee[2]=fn[2]+yt[2],ee}function nn(ee,Pt){var yt=ee[0],Ne=ee[1],tn=ee[2],fn=Pt[0],Rt=Pt[1],Yn=Pt[2],Un=Math.sqrt(yt*yt+Ne*Ne+tn*tn),xr=Math.sqrt(fn*fn+Rt*Rt+Yn*Yn),cr=Un*xr,Ur=cr&&ot(ee,Pt)/cr;return Math.acos(Math.min(Math.max(Ur,-1),1))}function Ee(ee){return ee[0]=0,ee[1]=0,ee[2]=0,ee}function le(ee){return"vec3("+ee[0]+", "+ee[1]+", "+ee[2]+")"}function Le(ee,Pt){return ee[0]===Pt[0]&&ee[1]===Pt[1]&&ee[2]===Pt[2]}function Ze(ee,Pt){var yt=ee[0],Ne=ee[1],tn=ee[2],fn=Pt[0],Rt=Pt[1],Yn=Pt[2];return Math.abs(yt-fn)<=X.EPSILON*Math.max(1,Math.abs(yt),Math.abs(fn))&&Math.abs(Ne-Rt)<=X.EPSILON*Math.max(1,Math.abs(Ne),Math.abs(Rt))&&Math.abs(tn-Yn)<=X.EPSILON*Math.max(1,Math.abs(tn),Math.abs(Yn))}var fe=C,Re=M,He=k,pe=mt,Ge=st,te=W,Me=ut,We=function(){var ee=tt();return function(Pt,yt,Ne,tn,fn,Rt){var Yn,Un;for(yt||(yt=3),Ne||(Ne=0),tn?Un=Math.min(tn*yt+Ne,Pt.length):Un=Pt.length,Yn=Ne;Yn<Un;Yn+=yt)ee[0]=Pt[Yn],ee[1]=Pt[Yn+1],ee[2]=Pt[Yn+2],fn(ee,ee,Rt),Pt[Yn]=ee[0],Pt[Yn+1]=ee[1],Pt[Yn+2]=ee[2];return Pt}}()},38186:function(sr){var it=[],$=[],X="insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).";function tt(W,Q){if(Q=Q||{},W===void 0)throw new Error(X);var Z=Q.prepend===!0?"prepend":"append",L=Q.container!==void 0?Q.container:document.querySelector("head"),P=it.indexOf(L);P===-1&&(P=it.push(L)-1,$[P]={});var C;return $[P]!==void 0&&$[P][Z]!==void 0?C=$[P][Z]:(C=$[P][Z]=j(),Z==="prepend"?L.insertBefore(C,L.childNodes[0]):L.appendChild(C)),W.charCodeAt(0)===65279&&(W=W.substr(1,W.length)),C.styleSheet?C.styleSheet.cssText+=W:C.textContent+=W,C}function j(){var W=document.createElement("style");return W.setAttribute("type","text/css"),W}sr.exports=tt,sr.exports.insertCss=tt},47443:function(sr,it,$){var X=$(42118);function tt(j,W){var Q=j==null?0:j.length;return!!Q&&X(j,W,0)>-1}sr.exports=tt},1196:function(sr){function it($,X,tt){for(var j=-1,W=$==null?0:$.length;++j<W;)if(tt(X,$[j]))return!0;return!1}sr.exports=it},20731:function(sr,it,$){var X=$(88668),tt=$(47443),j=$(1196),W=$(29932),Q=$(7518),Z=$(74757),L=200;function P(C,M,k,B){var R=-1,F=tt,K=!0,O=C.length,_=[],ft=M.length;if(!O)return _;k&&(M=W(M,Q(k))),B?(F=j,K=!1):M.length>=L&&(F=Z,K=!1,M=new X(M));t:for(;++R<O;){var mt=C[R],st=k==null?mt:k(mt);if(mt=B||mt!==0?mt:0,K&&st===st){for(var ut=ft;ut--;)if(M[ut]===st)continue t;_.push(mt)}else F(M,st,B)||_.push(mt)}return _}sr.exports=P},41848:function(sr){function it($,X,tt,j){for(var W=$.length,Q=tt+(j?1:-1);j?Q--:++Q<W;)if(X($[Q],Q,$))return Q;return-1}sr.exports=it},21078:function(sr,it,$){var X=$(62488),tt=$(75708);function j(W,Q,Z,L,P){var C=-1,M=W.length;for(Z||(Z=tt),P||(P=[]);++C<M;){var k=W[C];Q>0&&Z(k)?Q>1?j(k,Q-1,Z,L,P):X(P,k):L||(P[P.length]=k)}return P}sr.exports=j},42118:function(sr,it,$){var X=$(41848),tt=$(62722),j=$(42351);function W(Q,Z,L){return Z===Z?j(Q,Z,L):X(Q,tt,L)}sr.exports=W},62722:function(sr){function it($){return $!==$}sr.exports=it},75708:function(sr,it,$){var X=$(62705),tt=$(35694),j=$(1469),W=X?X.isConcatSpreadable:void 0;function Q(Z){return j(Z)||tt(Z)||!!(W&&Z&&Z[W])}sr.exports=Q},42351:function(sr){function it($,X,tt){for(var j=tt-1,W=$.length;++j<W;)if($[j]===X)return j;return-1}sr.exports=it},91966:function(sr,it,$){var X=$(20731),tt=$(21078),j=$(5976),W=$(29246),Q=j(function(Z,L){return W(Z)?X(Z,tt(L,1,W,!0)):[]});sr.exports=Q},81763:function(sr,it,$){var X=$(44239),tt=$(37005),j="[object Number]";function W(Q){return typeof Q=="number"||tt(Q)&&X(Q)==j}sr.exports=W},57460:function(sr,it){var $,X,tt;/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(j,W){X=[],$=W,tt=typeof $=="function"?$.apply(it,X):$,tt!==void 0&&(sr.exports=tt)})(this,function j(){"use strict";var W=typeof self!="undefined"?self:typeof window!="undefined"?window:W!==void 0?W:{},Q=!W.document&&!!W.postMessage,Z=W.IS_PAPA_WORKER||!1,L={},P=0,C={parse:function(ot,pt){var Nt=(pt=pt||{}).dynamicTyping||!1;if(wt(Nt)&&(pt.dynamicTypingFunction=Nt,Nt={}),pt.dynamicTyping=Nt,pt.transform=!!wt(pt.transform)&&pt.transform,pt.worker&&C.WORKERS_SUPPORTED){var Gt=function(){if(!C.WORKERS_SUPPORTED)return!1;var ie=(ke=W.URL||W.webkitURL||null,we=j.toString(),C.BLOB_URL||(C.BLOB_URL=ke.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",we,")();"],{type:"text/javascript"})))),Be=new W.Worker(ie),ke,we;return Be.onmessage=mt,Be.id=P++,L[Be.id]=Be}();return Gt.userStep=pt.step,Gt.userChunk=pt.chunk,Gt.userComplete=pt.complete,Gt.userError=pt.error,pt.step=wt(pt.step),pt.chunk=wt(pt.chunk),pt.complete=wt(pt.complete),pt.error=wt(pt.error),delete pt.worker,void Gt.postMessage({input:ot,config:pt,workerId:Gt.id})}var se=null;return C.NODE_STREAM_INPUT,typeof ot=="string"?(ot=function(ie){return ie.charCodeAt(0)===65279?ie.slice(1):ie}(ot),se=pt.download?new B(pt):new F(pt)):ot.readable===!0&&wt(ot.read)&&wt(ot.on)?se=new K(pt):(W.File&&ot instanceof File||ot instanceof Object)&&(se=new R(pt)),se.stream(ot)},unparse:function(ot,pt){var Nt=!1,Gt=!0,se=",",ie=`\r
`,Be='"',ke=Be+Be,we=!1,At=null,Yt=!1;(function(){if(typeof pt=="object"){if(typeof pt.delimiter!="string"||C.BAD_DELIMITERS.filter(function(le){return pt.delimiter.indexOf(le)!==-1}).length||(se=pt.delimiter),(typeof pt.quotes=="boolean"||typeof pt.quotes=="function"||Array.isArray(pt.quotes))&&(Nt=pt.quotes),typeof pt.skipEmptyLines!="boolean"&&typeof pt.skipEmptyLines!="string"||(we=pt.skipEmptyLines),typeof pt.newline=="string"&&(ie=pt.newline),typeof pt.quoteChar=="string"&&(Be=pt.quoteChar),typeof pt.header=="boolean"&&(Gt=pt.header),Array.isArray(pt.columns)){if(pt.columns.length===0)throw new Error("Option columns is empty");At=pt.columns}pt.escapeChar!==void 0&&(ke=pt.escapeChar+Be),(typeof pt.escapeFormulae=="boolean"||pt.escapeFormulae instanceof RegExp)&&(Yt=pt.escapeFormulae instanceof RegExp?pt.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var be=new RegExp(_(Be),"g");if(typeof ot=="string"&&(ot=JSON.parse(ot)),Array.isArray(ot)){if(!ot.length||Array.isArray(ot[0]))return nn(null,ot,we);if(typeof ot[0]=="object")return nn(At||Object.keys(ot[0]),ot,we)}else if(typeof ot=="object")return typeof ot.data=="string"&&(ot.data=JSON.parse(ot.data)),Array.isArray(ot.data)&&(ot.fields||(ot.fields=ot.meta&&ot.meta.fields||At),ot.fields||(ot.fields=Array.isArray(ot.data[0])?ot.fields:typeof ot.data[0]=="object"?Object.keys(ot.data[0]):[]),Array.isArray(ot.data[0])||typeof ot.data[0]=="object"||(ot.data=[ot.data])),nn(ot.fields||[],ot.data||[],we);throw new Error("Unable to serialize unrecognized input");function nn(le,Le,Ze){var fe="";typeof le=="string"&&(le=JSON.parse(le)),typeof Le=="string"&&(Le=JSON.parse(Le));var Re=Array.isArray(le)&&0<le.length,He=!Array.isArray(Le[0]);if(Re&&Gt){for(var pe=0;pe<le.length;pe++)0<pe&&(fe+=se),fe+=Ee(le[pe],pe);0<Le.length&&(fe+=ie)}for(var Ge=0;Ge<Le.length;Ge++){var te=Re?le.length:Le[Ge].length,Me=!1,We=Re?Object.keys(Le[Ge]).length===0:Le[Ge].length===0;if(Ze&&!Re&&(Me=Ze==="greedy"?Le[Ge].join("").trim()==="":Le[Ge].length===1&&Le[Ge][0].length===0),Ze==="greedy"&&Re){for(var ee=[],Pt=0;Pt<te;Pt++){var yt=He?le[Pt]:Pt;ee.push(Le[Ge][yt])}Me=ee.join("").trim()===""}if(!Me){for(var Ne=0;Ne<te;Ne++){0<Ne&&!We&&(fe+=se);var tn=Re&&He?le[Ne]:Ne;fe+=Ee(Le[Ge][tn],Ne)}Ge<Le.length-1&&(!Ze||0<te&&!We)&&(fe+=ie)}}return fe}function Ee(le,Le){if(le==null)return"";if(le.constructor===Date)return JSON.stringify(le).slice(1,25);var Ze=!1;Yt&&typeof le=="string"&&Yt.test(le)&&(le="'"+le,Ze=!0);var fe=le.toString().replace(be,ke);return(Ze=Ze||Nt===!0||typeof Nt=="function"&&Nt(le,Le)||Array.isArray(Nt)&&Nt[Le]||function(Re,He){for(var pe=0;pe<He.length;pe++)if(-1<Re.indexOf(He[pe]))return!0;return!1}(fe,C.BAD_DELIMITERS)||-1<fe.indexOf(se)||fe.charAt(0)===" "||fe.charAt(fe.length-1)===" ")?Be+fe+Be:fe}}};if(C.RECORD_SEP=String.fromCharCode(30),C.UNIT_SEP=String.fromCharCode(31),C.BYTE_ORDER_MARK="\uFEFF",C.BAD_DELIMITERS=["\r",`
`,'"',C.BYTE_ORDER_MARK],C.WORKERS_SUPPORTED=!Q&&!!W.Worker,C.NODE_STREAM_INPUT=1,C.LocalChunkSize=10485760,C.RemoteChunkSize=5242880,C.DefaultDelimiter=",",C.Parser=ft,C.ParserHandle=O,C.NetworkStreamer=B,C.FileStreamer=R,C.StringStreamer=F,C.ReadableStreamStreamer=K,W.jQuery){var M=W.jQuery;M.fn.parse=function(ot){var pt=ot.config||{},Nt=[];return this.each(function(ie){if(!(M(this).prop("tagName").toUpperCase()==="INPUT"&&M(this).attr("type").toLowerCase()==="file"&&W.FileReader)||!this.files||this.files.length===0)return!0;for(var Be=0;Be<this.files.length;Be++)Nt.push({file:this.files[Be],inputElem:this,instanceConfig:M.extend({},pt)})}),Gt(),this;function Gt(){if(Nt.length!==0){var ie,Be,ke,we,At=Nt[0];if(wt(ot.before)){var Yt=ot.before(At.file,At.inputElem);if(typeof Yt=="object"){if(Yt.action==="abort")return ie="AbortError",Be=At.file,ke=At.inputElem,we=Yt.reason,void(wt(ot.error)&&ot.error({name:ie},Be,ke,we));if(Yt.action==="skip")return void se();typeof Yt.config=="object"&&(At.instanceConfig=M.extend(At.instanceConfig,Yt.config))}else if(Yt==="skip")return void se()}var be=At.instanceConfig.complete;At.instanceConfig.complete=function(nn){wt(be)&&be(nn,At.file,At.inputElem),se()},C.parse(At.file,At.instanceConfig)}else wt(ot.complete)&&ot.complete()}function se(){Nt.splice(0,1),Gt()}}}function k(ot){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(pt){var Nt=dt(pt);Nt.chunkSize=parseInt(Nt.chunkSize),pt.step||pt.chunk||(Nt.chunkSize=null),this._handle=new O(Nt),(this._handle.streamer=this)._config=Nt}.call(this,ot),this.parseChunk=function(pt,Nt){if(this.isFirstChunk&&wt(this._config.beforeFirstChunk)){var Gt=this._config.beforeFirstChunk(pt);Gt!==void 0&&(pt=Gt)}this.isFirstChunk=!1,this._halted=!1;var se=this._partialLine+pt;this._partialLine="";var ie=this._handle.parse(se,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var Be=ie.meta.cursor;this._finished||(this._partialLine=se.substring(Be-this._baseIndex),this._baseIndex=Be),ie&&ie.data&&(this._rowCount+=ie.data.length);var ke=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(Z)W.postMessage({results:ie,workerId:C.WORKER_ID,finished:ke});else if(wt(this._config.chunk)&&!Nt){if(this._config.chunk(ie,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);ie=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(ie.data),this._completeResults.errors=this._completeResults.errors.concat(ie.errors),this._completeResults.meta=ie.meta),this._completed||!ke||!wt(this._config.complete)||ie&&ie.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),ke||ie&&ie.meta.paused||this._nextChunk(),ie}this._halted=!0},this._sendError=function(pt){wt(this._config.error)?this._config.error(pt):Z&&this._config.error&&W.postMessage({workerId:C.WORKER_ID,error:pt,finished:!1})}}function B(ot){var pt;(ot=ot||{}).chunkSize||(ot.chunkSize=C.RemoteChunkSize),k.call(this,ot),this._nextChunk=Q?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(Nt){this._input=Nt,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(pt=new XMLHttpRequest,this._config.withCredentials&&(pt.withCredentials=this._config.withCredentials),Q||(pt.onload=gt(this._chunkLoaded,this),pt.onerror=gt(this._chunkError,this)),pt.open(this._config.downloadRequestBody?"POST":"GET",this._input,!Q),this._config.downloadRequestHeaders){var Nt=this._config.downloadRequestHeaders;for(var Gt in Nt)pt.setRequestHeader(Gt,Nt[Gt])}if(this._config.chunkSize){var se=this._start+this._config.chunkSize-1;pt.setRequestHeader("Range","bytes="+this._start+"-"+se)}try{pt.send(this._config.downloadRequestBody)}catch(ie){this._chunkError(ie.message)}Q&&pt.status===0&&this._chunkError()}},this._chunkLoaded=function(){pt.readyState===4&&(pt.status<200||400<=pt.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:pt.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(Nt){var Gt=Nt.getResponseHeader("Content-Range");return Gt===null?-1:parseInt(Gt.substring(Gt.lastIndexOf("/")+1))}(pt),this.parseChunk(pt.responseText)))},this._chunkError=function(Nt){var Gt=pt.statusText||Nt;this._sendError(new Error(Gt))}}function R(ot){var pt,Nt;(ot=ot||{}).chunkSize||(ot.chunkSize=C.LocalChunkSize),k.call(this,ot);var Gt=typeof FileReader!="undefined";this.stream=function(se){this._input=se,Nt=se.slice||se.webkitSlice||se.mozSlice,Gt?((pt=new FileReader).onload=gt(this._chunkLoaded,this),pt.onerror=gt(this._chunkError,this)):pt=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var se=this._input;if(this._config.chunkSize){var ie=Math.min(this._start+this._config.chunkSize,this._input.size);se=Nt.call(se,this._start,ie)}var Be=pt.readAsText(se,this._config.encoding);Gt||this._chunkLoaded({target:{result:Be}})},this._chunkLoaded=function(se){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(se.target.result)},this._chunkError=function(){this._sendError(pt.error)}}function F(ot){var pt;k.call(this,ot=ot||{}),this.stream=function(Nt){return pt=Nt,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var Nt,Gt=this._config.chunkSize;return Gt?(Nt=pt.substring(0,Gt),pt=pt.substring(Gt)):(Nt=pt,pt=""),this._finished=!pt,this.parseChunk(Nt)}}}function K(ot){k.call(this,ot=ot||{});var pt=[],Nt=!0,Gt=!1;this.pause=function(){k.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){k.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(se){this._input=se,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){Gt&&pt.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),pt.length?this.parseChunk(pt.shift()):Nt=!0},this._streamData=gt(function(se){try{pt.push(typeof se=="string"?se:se.toString(this._config.encoding)),Nt&&(Nt=!1,this._checkIsFinished(),this.parseChunk(pt.shift()))}catch(ie){this._streamError(ie)}},this),this._streamError=gt(function(se){this._streamCleanUp(),this._sendError(se)},this),this._streamEnd=gt(function(){this._streamCleanUp(),Gt=!0,this._streamData("")},this),this._streamCleanUp=gt(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function O(ot){var pt,Nt,Gt,se=Math.pow(2,53),ie=-se,Be=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ke=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,we=this,At=0,Yt=0,be=!1,nn=!1,Ee=[],le={data:[],errors:[],meta:{}};if(wt(ot.step)){var Le=ot.step;ot.step=function(Ge){if(le=Ge,Re())fe();else{if(fe(),le.data.length===0)return;At+=Ge.data.length,ot.preview&&At>ot.preview?Nt.abort():(le.data=le.data[0],Le(le,we))}}}function Ze(Ge){return ot.skipEmptyLines==="greedy"?Ge.join("").trim()==="":Ge.length===1&&Ge[0].length===0}function fe(){return le&&Gt&&(pe("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+C.DefaultDelimiter+"'"),Gt=!1),ot.skipEmptyLines&&(le.data=le.data.filter(function(Ge){return!Ze(Ge)})),Re()&&function(){if(!le)return;function Ge(Me,We){wt(ot.transformHeader)&&(Me=ot.transformHeader(Me,We)),Ee.push(Me)}if(Array.isArray(le.data[0])){for(var te=0;Re()&&te<le.data.length;te++)le.data[te].forEach(Ge);le.data.splice(0,1)}else le.data.forEach(Ge)}(),function(){if(!le||!ot.header&&!ot.dynamicTyping&&!ot.transform)return le;function Ge(Me,We){var ee,Pt=ot.header?{}:[];for(ee=0;ee<Me.length;ee++){var yt=ee,Ne=Me[ee];ot.header&&(yt=ee>=Ee.length?"__parsed_extra":Ee[ee]),ot.transform&&(Ne=ot.transform(Ne,yt)),Ne=He(yt,Ne),yt==="__parsed_extra"?(Pt[yt]=Pt[yt]||[],Pt[yt].push(Ne)):Pt[yt]=Ne}return ot.header&&(ee>Ee.length?pe("FieldMismatch","TooManyFields","Too many fields: expected "+Ee.length+" fields but parsed "+ee,Yt+We):ee<Ee.length&&pe("FieldMismatch","TooFewFields","Too few fields: expected "+Ee.length+" fields but parsed "+ee,Yt+We)),Pt}var te=1;return!le.data.length||Array.isArray(le.data[0])?(le.data=le.data.map(Ge),te=le.data.length):le.data=Ge(le.data,0),ot.header&&le.meta&&(le.meta.fields=Ee),Yt+=te,le}()}function Re(){return ot.header&&Ee.length===0}function He(Ge,te){return Me=Ge,ot.dynamicTypingFunction&&ot.dynamicTyping[Me]===void 0&&(ot.dynamicTyping[Me]=ot.dynamicTypingFunction(Me)),(ot.dynamicTyping[Me]||ot.dynamicTyping)===!0?te==="true"||te==="TRUE"||te!=="false"&&te!=="FALSE"&&(function(We){if(Be.test(We)){var ee=parseFloat(We);if(ie<ee&&ee<se)return!0}return!1}(te)?parseFloat(te):ke.test(te)?new Date(te):te===""?null:te):te;var Me}function pe(Ge,te,Me,We){var ee={type:Ge,code:te,message:Me};We!==void 0&&(ee.row=We),le.errors.push(ee)}this.parse=function(Ge,te,Me){var We=ot.quoteChar||'"';if(ot.newline||(ot.newline=function(yt,Ne){yt=yt.substring(0,1048576);var tn=new RegExp(_(Ne)+"([^]*?)"+_(Ne),"gm"),fn=(yt=yt.replace(tn,"")).split("\r"),Rt=yt.split(`
`),Yn=1<Rt.length&&Rt[0].length<fn[0].length;if(fn.length===1||Yn)return`
`;for(var Un=0,xr=0;xr<fn.length;xr++)fn[xr][0]===`
`&&Un++;return Un>=fn.length/2?`\r
`:"\r"}(Ge,We)),Gt=!1,ot.delimiter)wt(ot.delimiter)&&(ot.delimiter=ot.delimiter(Ge),le.meta.delimiter=ot.delimiter);else{var ee=function(yt,Ne,tn,fn,Rt){var Yn,Un,xr,cr;Rt=Rt||[",","	","|",";",C.RECORD_SEP,C.UNIT_SEP];for(var Ur=0;Ur<Rt.length;Ur++){var fa=Rt[Ur],Sa=0,sa=0,Da=0;xr=void 0;for(var Rr=new ft({comments:fn,delimiter:fa,newline:Ne,preview:10}).parse(yt),Mn=0;Mn<Rr.data.length;Mn++)if(tn&&Ze(Rr.data[Mn]))Da++;else{var ar=Rr.data[Mn].length;sa+=ar,xr!==void 0?0<ar&&(Sa+=Math.abs(ar-xr),xr=ar):xr=ar}0<Rr.data.length&&(sa/=Rr.data.length-Da),(Un===void 0||Sa<=Un)&&(cr===void 0||cr<sa)&&1.99<sa&&(Un=Sa,Yn=fa,cr=sa)}return{successful:!!(ot.delimiter=Yn),bestDelimiter:Yn}}(Ge,ot.newline,ot.skipEmptyLines,ot.comments,ot.delimitersToGuess);ee.successful?ot.delimiter=ee.bestDelimiter:(Gt=!0,ot.delimiter=C.DefaultDelimiter),le.meta.delimiter=ot.delimiter}var Pt=dt(ot);return ot.preview&&ot.header&&Pt.preview++,pt=Ge,Nt=new ft(Pt),le=Nt.parse(pt,te,Me),fe(),be?{meta:{paused:!0}}:le||{meta:{paused:!1}}},this.paused=function(){return be},this.pause=function(){be=!0,Nt.abort(),pt=wt(ot.chunk)?"":pt.substring(Nt.getCharIndex())},this.resume=function(){we.streamer._halted?(be=!1,we.streamer.parseChunk(pt,!0)):setTimeout(we.resume,3)},this.aborted=function(){return nn},this.abort=function(){nn=!0,Nt.abort(),le.meta.aborted=!0,wt(ot.complete)&&ot.complete(le),pt=""}}function _(ot){return ot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ft(ot){var pt,Nt=(ot=ot||{}).delimiter,Gt=ot.newline,se=ot.comments,ie=ot.step,Be=ot.preview,ke=ot.fastMode,we=pt=ot.quoteChar===void 0||ot.quoteChar===null?'"':ot.quoteChar;if(ot.escapeChar!==void 0&&(we=ot.escapeChar),(typeof Nt!="string"||-1<C.BAD_DELIMITERS.indexOf(Nt))&&(Nt=","),se===Nt)throw new Error("Comment character same as delimiter");se===!0?se="#":(typeof se!="string"||-1<C.BAD_DELIMITERS.indexOf(se))&&(se=!1),Gt!==`
`&&Gt!=="\r"&&Gt!==`\r
`&&(Gt=`
`);var At=0,Yt=!1;this.parse=function(be,nn,Ee){if(typeof be!="string")throw new Error("Input must be a string");var le=be.length,Le=Nt.length,Ze=Gt.length,fe=se.length,Re=wt(ie),He=[],pe=[],Ge=[],te=At=0;if(!be)return Fn();if(ot.header&&!nn){var Me=be.split(Gt)[0].split(Nt),We=[],ee={},Pt=!1;for(var yt in Me){var Ne=Me[yt];wt(ot.transformHeader)&&(Ne=ot.transformHeader(Ne,yt));var tn=Ne,fn=ee[Ne]||0;for(0<fn&&(Pt=!0,tn=Ne+"_"+fn),ee[Ne]=fn+1;We.includes(tn);)tn=tn+"_"+fn;We.push(tn)}if(Pt){var Rt=be.split(Gt);Rt[0]=We.join(Nt),be=Rt.join(Gt)}}if(ke||ke!==!1&&be.indexOf(pt)===-1){for(var Yn=be.split(Gt),Un=0;Un<Yn.length;Un++){if(Ge=Yn[Un],At+=Ge.length,Un!==Yn.length-1)At+=Gt.length;else if(Ee)return Fn();if(!se||Ge.substring(0,fe)!==se){if(Re){if(He=[],Da(Ge.split(Nt)),tr(),Yt)return Fn()}else Da(Ge.split(Nt));if(Be&&Be<=Un)return He=He.slice(0,Be),Fn(!0)}}return Fn()}for(var xr=be.indexOf(Nt,At),cr=be.indexOf(Gt,At),Ur=new RegExp(_(we)+_(pt),"g"),fa=be.indexOf(pt,At);;)if(be[At]!==pt)if(se&&Ge.length===0&&be.substring(At,At+fe)===se){if(cr===-1)return Fn();At=cr+Ze,cr=be.indexOf(Gt,At),xr=be.indexOf(Nt,At)}else if(xr!==-1&&(xr<cr||cr===-1))Ge.push(be.substring(At,xr)),At=xr+Le,xr=be.indexOf(Nt,At);else{if(cr===-1)break;if(Ge.push(be.substring(At,cr)),ar(cr+Ze),Re&&(tr(),Yt))return Fn();if(Be&&He.length>=Be)return Fn(!0)}else for(fa=At,At++;;){if((fa=be.indexOf(pt,fa+1))===-1)return Ee||pe.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:He.length,index:At}),Mn();if(fa===le-1)return Mn(be.substring(At,fa).replace(Ur,pt));if(pt!==we||be[fa+1]!==we){if(pt===we||fa===0||be[fa-1]!==we){xr!==-1&&xr<fa+1&&(xr=be.indexOf(Nt,fa+1)),cr!==-1&&cr<fa+1&&(cr=be.indexOf(Gt,fa+1));var Sa=Rr(cr===-1?xr:Math.min(xr,cr));if(be.substr(fa+1+Sa,Le)===Nt){Ge.push(be.substring(At,fa).replace(Ur,pt)),be[At=fa+1+Sa+Le]!==pt&&(fa=be.indexOf(pt,At)),xr=be.indexOf(Nt,At),cr=be.indexOf(Gt,At);break}var sa=Rr(cr);if(be.substring(fa+1+sa,fa+1+sa+Ze)===Gt){if(Ge.push(be.substring(At,fa).replace(Ur,pt)),ar(fa+1+sa+Ze),xr=be.indexOf(Nt,At),fa=be.indexOf(pt,At),Re&&(tr(),Yt))return Fn();if(Be&&He.length>=Be)return Fn(!0);break}pe.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:He.length,index:At}),fa++}}else fa++}return Mn();function Da(Gn){He.push(Gn),te=At}function Rr(Gn){var jr=0;if(Gn!==-1){var Hr=be.substring(fa+1,Gn);Hr&&Hr.trim()===""&&(jr=Hr.length)}return jr}function Mn(Gn){return Ee||(Gn===void 0&&(Gn=be.substring(At)),Ge.push(Gn),At=le,Da(Ge),Re&&tr()),Fn()}function ar(Gn){At=Gn,Da(Ge),Ge=[],cr=be.indexOf(Gt,At)}function Fn(Gn){return{data:He,errors:pe,meta:{delimiter:Nt,linebreak:Gt,aborted:Yt,truncated:!!Gn,cursor:te+(nn||0)}}}function tr(){ie(Fn()),He=[],pe=[]}},this.abort=function(){Yt=!0},this.getCharIndex=function(){return At}}function mt(ot){var pt=ot.data,Nt=L[pt.workerId],Gt=!1;if(pt.error)Nt.userError(pt.error,pt.file);else if(pt.results&&pt.results.data){var se={abort:function(){Gt=!0,st(pt.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:ut,resume:ut};if(wt(Nt.userStep)){for(var ie=0;ie<pt.results.data.length&&(Nt.userStep({data:pt.results.data[ie],errors:pt.results.errors,meta:pt.results.meta},se),!Gt);ie++);delete pt.results}else wt(Nt.userChunk)&&(Nt.userChunk(pt.results,se,pt.file),delete pt.results)}pt.finished&&!Gt&&st(pt.workerId,pt.results)}function st(ot,pt){var Nt=L[ot];wt(Nt.userComplete)&&Nt.userComplete(pt),Nt.terminate(),delete L[ot]}function ut(){throw new Error("Not implemented.")}function dt(ot){if(typeof ot!="object"||ot===null)return ot;var pt=Array.isArray(ot)?[]:{};for(var Nt in ot)pt[Nt]=dt(ot[Nt]);return pt}function gt(ot,pt){return function(){ot.apply(pt,arguments)}}function wt(ot){return typeof ot=="function"}return Z&&(W.onmessage=function(ot){var pt=ot.data;if(C.WORKER_ID===void 0&&pt&&(C.WORKER_ID=pt.workerId),typeof pt.input=="string")W.postMessage({workerId:C.WORKER_ID,results:C.parse(pt.input,pt.config),finished:!0});else if(W.File&&pt.input instanceof File||pt.input instanceof Object){var Nt=C.parse(pt.input,pt.config);Nt&&W.postMessage({workerId:C.WORKER_ID,results:Nt,finished:!0})}}),(B.prototype=Object.create(k.prototype)).constructor=B,(R.prototype=Object.create(k.prototype)).constructor=R,(F.prototype=Object.create(F.prototype)).constructor=F,(K.prototype=Object.create(k.prototype)).constructor=K,C})},53110:function(sr,it,$){"use strict";$.d(it,{I:function(){return k},r:function(){return M}});var X=$(67294),tt={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},j=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],W=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],Q=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],Z=typeof window!="undefined"&&typeof window.document!="undefined"?window.document:{},L="fullscreenEnabled"in Z&&Object.keys(tt)||j[0]in Z&&j||W[0]in Z&&W||Q[0]in Z&&Q||[],P={requestFullscreen:function(B){return B[L[tt.requestFullscreen]]()},requestFullscreenFunction:function(B){return B[L[tt.requestFullscreen]]},get exitFullscreen(){return Z[L[tt.exitFullscreen]].bind(Z)},get fullscreenPseudoClass(){return":"+L[tt.fullscreen]},addEventListener:function(B,R,F){return Z.addEventListener(L[tt[B]],R,F)},removeEventListener:function(B,R,F){return Z.removeEventListener(L[tt[B]],R,F)},get fullscreenEnabled(){return Boolean(Z[L[tt.fullscreenEnabled]])},set fullscreenEnabled(B){},get fullscreenElement(){return Z[L[tt.fullscreenElement]]},set fullscreenElement(B){},get onfullscreenchange(){return Z[("on"+L[tt.fullscreenchange]).toLowerCase()]},set onfullscreenchange(B){return Z[("on"+L[tt.fullscreenchange]).toLowerCase()]=B},get onfullscreenerror(){return Z[("on"+L[tt.fullscreenerror]).toLowerCase()]},set onfullscreenerror(B){return Z[("on"+L[tt.fullscreenerror]).toLowerCase()]=B}},C=P;function M(){var B=(0,X.useState)(!1),R=B[0],F=B[1],K=(0,X.useRef)(null);(0,X.useEffect)(function(){var ft=function(){F(C.fullscreenElement===K.current)};return C.addEventListener("fullscreenchange",ft),function(){return C.removeEventListener("fullscreenchange",ft)}},[]);var O=(0,X.useCallback)(function(){if(C.fullscreenElement)return C.exitFullscreen().then(function(){return C.requestFullscreen(K.current)});if(K.current)return C.requestFullscreen(K.current)},[]),_=(0,X.useCallback)(function(){return C.fullscreenElement===K.current?C.exitFullscreen():Promise.resolve()},[]);return(0,X.useMemo)(function(){return{active:R,enter:O,exit:_,node:K}},[R,O,_])}var k=function(R){var F=R.handle,K=R.onChange,O=R.children,_=R.className,ft=[];return _&&ft.push(_),ft.push("fullscreen"),F.active&&ft.push("fullscreen-enabled"),(0,X.useEffect)(function(){K&&K(F.active,F)},[F.active]),X.createElement("div",{className:ft.join(" "),ref:F.node,style:F.active?{height:"100%",width:"100%"}:void 0},O)}},37763:function(sr,it,$){sr.exports=function(X){var tt={};function j(W){if(tt[W])return tt[W].exports;var Q=tt[W]={exports:{},id:W,loaded:!1};return X[W].call(Q.exports,Q,Q.exports,j),Q.loaded=!0,Q.exports}return j.m=X,j.c=tt,j.p="",j(0)}([function(X,tt,j){X.exports=j(1)},function(X,tt,j){"use strict";Object.defineProperty(tt,"__esModule",{value:!0});function W(L){return L&&L.__esModule?L:{default:L}}var Q=j(2),Z=W(Q);tt.default=Z.default,X.exports=tt.default},function(X,tt,j){"use strict";Object.defineProperty(tt,"__esModule",{value:!0});var W=Object.assign||function(F){for(var K=1;K<arguments.length;K++){var O=arguments[K];for(var _ in O)Object.prototype.hasOwnProperty.call(O,_)&&(F[_]=O[_])}return F};tt.default=R;function Q(F){return F&&F.__esModule?F:{default:F}}function Z(F,K){var O={};for(var _ in F)K.indexOf(_)>=0||!Object.prototype.hasOwnProperty.call(F,_)||(O[_]=F[_]);return O}var L=j(3),P=j(4),C=Q(P),M=j(14),k=j(15),B=Q(k);R.propTypes={activeClassName:C.default.string,activeIndex:C.default.number,activeStyle:C.default.object,autoEscape:C.default.bool,className:C.default.string,findChunks:C.default.func,highlightClassName:C.default.oneOfType([C.default.object,C.default.string]),highlightStyle:C.default.object,highlightTag:C.default.oneOfType([C.default.node,C.default.func,C.default.string]),sanitize:C.default.func,searchWords:C.default.arrayOf(C.default.oneOfType([C.default.string,C.default.instanceOf(RegExp)])).isRequired,textToHighlight:C.default.string.isRequired,unhighlightTag:C.default.oneOfType([C.default.node,C.default.func,C.default.string]),unhighlightClassName:C.default.string,unhighlightStyle:C.default.object};function R(F){var K=F.activeClassName,O=K===void 0?"":K,_=F.activeIndex,ft=_===void 0?-1:_,mt=F.activeStyle,st=F.autoEscape,ut=F.caseSensitive,dt=ut===void 0?!1:ut,gt=F.className,wt=F.findChunks,ot=F.highlightClassName,pt=ot===void 0?"":ot,Nt=F.highlightStyle,Gt=Nt===void 0?{}:Nt,se=F.highlightTag,ie=se===void 0?"mark":se,Be=F.sanitize,ke=F.searchWords,we=F.textToHighlight,At=F.unhighlightTag,Yt=At===void 0?"span":At,be=F.unhighlightClassName,nn=be===void 0?"":be,Ee=F.unhighlightStyle,le=Z(F,["activeClassName","activeIndex","activeStyle","autoEscape","caseSensitive","className","findChunks","highlightClassName","highlightStyle","highlightTag","sanitize","searchWords","textToHighlight","unhighlightTag","unhighlightClassName","unhighlightStyle"]),Le=(0,L.findAll)({autoEscape:st,caseSensitive:dt,findChunks:wt,sanitize:Be,searchWords:ke,textToHighlight:we}),Ze=ie,fe=-1,Re="",He=void 0,pe=function(Me){var We={};for(var ee in Me)We[ee.toLowerCase()]=Me[ee];return We},Ge=(0,B.default)(pe);return(0,M.createElement)("span",W({className:gt},le,{children:Le.map(function(te,Me){var We=we.substr(te.start,te.end-te.start);if(te.highlight){fe++;var ee=void 0;typeof pt=="object"?dt?ee=pt[We]:(pt=Ge(pt),ee=pt[We.toLowerCase()]):ee=pt;var Pt=fe===+ft;Re=ee+" "+(Pt?O:""),He=Pt===!0&&mt!=null?Object.assign({},Gt,mt):Gt;var yt={children:We,className:Re,key:Me,style:He};return typeof Ze!="string"&&(yt.highlightIndex=fe),(0,M.createElement)(Ze,yt)}else return(0,M.createElement)(Yt,{children:We,className:nn,key:Me,style:Ee})})}))}X.exports=tt.default},function(X,tt){X.exports=function(j){var W={};function Q(Z){if(W[Z])return W[Z].exports;var L=W[Z]={exports:{},id:Z,loaded:!1};return j[Z].call(L.exports,L,L.exports,Q),L.loaded=!0,L.exports}return Q.m=j,Q.c=W,Q.p="",Q(0)}([function(j,W,Q){j.exports=Q(1)},function(j,W,Q){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var Z=Q(2);Object.defineProperty(W,"combineChunks",{enumerable:!0,get:function(){return Z.combineChunks}}),Object.defineProperty(W,"fillInChunks",{enumerable:!0,get:function(){return Z.fillInChunks}}),Object.defineProperty(W,"findAll",{enumerable:!0,get:function(){return Z.findAll}}),Object.defineProperty(W,"findChunks",{enumerable:!0,get:function(){return Z.findChunks}})},function(j,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var Q=W.findAll=function(B){var R=B.autoEscape,F=B.caseSensitive,K=F===void 0?!1:F,O=B.findChunks,_=O===void 0?L:O,ft=B.sanitize,mt=B.searchWords,st=B.textToHighlight;return P({chunksToHighlight:Z({chunks:_({autoEscape:R,caseSensitive:K,sanitize:ft,searchWords:mt,textToHighlight:st})}),totalLength:st?st.length:0})},Z=W.combineChunks=function(B){var R=B.chunks;return R=R.sort(function(F,K){return F.start-K.start}).reduce(function(F,K){if(F.length===0)return[K];var O=F.pop();if(K.start<=O.end){var _=Math.max(O.end,K.end);F.push({start:O.start,end:_})}else F.push(O,K);return F},[]),R},L=function(B){var R=B.autoEscape,F=B.caseSensitive,K=B.sanitize,O=K===void 0?C:K,_=B.searchWords,ft=B.textToHighlight;return ft=O(ft),_.filter(function(mt){return mt}).reduce(function(mt,st){st=O(st),R&&(st=M(st));for(var ut=new RegExp(st,F?"g":"gi"),dt=void 0;dt=ut.exec(ft);){var gt=dt.index,wt=ut.lastIndex;wt>gt&&mt.push({start:gt,end:wt}),dt.index==ut.lastIndex&&ut.lastIndex++}return mt},[])};W.findChunks=L;var P=W.fillInChunks=function(B){var R=B.chunksToHighlight,F=B.totalLength,K=[],O=function(mt,st,ut){st-mt>0&&K.push({start:mt,end:st,highlight:ut})};if(R.length===0)O(0,F,!1);else{var _=0;R.forEach(function(ft){O(_,ft.start,!1),O(ft.start,ft.end,!0),_=ft.end}),O(_,F,!1)}return K};function C(k){return k}function M(k){return k.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}}])},function(X,tt,j){(function(W){if(W.env.NODE_ENV!=="production"){var Q=typeof Symbol=="function"&&Symbol.for&&Symbol.for("react.element")||60103,Z=function(P){return typeof P=="object"&&P!==null&&P.$$typeof===Q},L=!0;X.exports=j(6)(Z,L)}else X.exports=j(13)()}).call(tt,j(5))},function(X,tt){var j=X.exports={},W,Q;function Z(){throw new Error("setTimeout has not been defined")}function L(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?W=setTimeout:W=Z}catch(ft){W=Z}try{typeof clearTimeout=="function"?Q=clearTimeout:Q=L}catch(ft){Q=L}})();function P(ft){if(W===setTimeout)return setTimeout(ft,0);if((W===Z||!W)&&setTimeout)return W=setTimeout,setTimeout(ft,0);try{return W(ft,0)}catch(mt){try{return W.call(null,ft,0)}catch(st){return W.call(this,ft,0)}}}function C(ft){if(Q===clearTimeout)return clearTimeout(ft);if((Q===L||!Q)&&clearTimeout)return Q=clearTimeout,clearTimeout(ft);try{return Q(ft)}catch(mt){try{return Q.call(null,ft)}catch(st){return Q.call(this,ft)}}}var M=[],k=!1,B,R=-1;function F(){!k||!B||(k=!1,B.length?M=B.concat(M):R=-1,M.length&&K())}function K(){if(!k){var ft=P(F);k=!0;for(var mt=M.length;mt;){for(B=M,M=[];++R<mt;)B&&B[R].run();R=-1,mt=M.length}B=null,k=!1,C(ft)}}j.nextTick=function(ft){var mt=new Array(arguments.length-1);if(arguments.length>1)for(var st=1;st<arguments.length;st++)mt[st-1]=arguments[st];M.push(new O(ft,mt)),M.length===1&&!k&&P(K)};function O(ft,mt){this.fun=ft,this.array=mt}O.prototype.run=function(){this.fun.apply(null,this.array)},j.title="browser",j.browser=!0,j.env={},j.argv=[],j.version="",j.versions={};function _(){}j.on=_,j.addListener=_,j.once=_,j.off=_,j.removeListener=_,j.removeAllListeners=_,j.emit=_,j.prependListener=_,j.prependOnceListener=_,j.listeners=function(ft){return[]},j.binding=function(ft){throw new Error("process.binding is not supported")},j.cwd=function(){return"/"},j.chdir=function(ft){throw new Error("process.chdir is not supported")},j.umask=function(){return 0}},function(X,tt,j){(function(W){"use strict";var Q=j(7),Z=j(8),L=j(9),P=j(10),C=j(11),M=j(12);X.exports=function(k,B){var R=typeof Symbol=="function"&&Symbol.iterator,F="@@iterator";function K(Ee){var le=Ee&&(R&&Ee[R]||Ee[F]);if(typeof le=="function")return le}var O="<<anonymous>>",_={array:ut("array"),bool:ut("boolean"),func:ut("function"),number:ut("number"),object:ut("object"),string:ut("string"),symbol:ut("symbol"),any:dt(),arrayOf:gt,element:wt(),instanceOf:ot,node:se(),objectOf:Nt,oneOf:pt,oneOfType:Gt,shape:ie,exact:Be};function ft(Ee,le){return Ee===le?Ee!==0||1/Ee==1/le:Ee!==Ee&&le!==le}function mt(Ee){this.message=Ee,this.stack=""}mt.prototype=Error.prototype;function st(Ee){if(W.env.NODE_ENV!=="production")var le={},Le=0;function Ze(Re,He,pe,Ge,te,Me,We){if(Ge=Ge||O,Me=Me||pe,We!==C){if(B)Z(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if(W.env.NODE_ENV!=="production"&&typeof console!="undefined"){var ee=Ge+":"+pe;!le[ee]&&Le<3&&(L(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",Me,Ge),le[ee]=!0,Le++)}}return He[pe]==null?Re?He[pe]===null?new mt("The "+te+" `"+Me+"` is marked as required "+("in `"+Ge+"`, but its value is `null`.")):new mt("The "+te+" `"+Me+"` is marked as required in "+("`"+Ge+"`, but its value is `undefined`.")):null:Ee(He,pe,Ge,te,Me)}var fe=Ze.bind(null,!1);return fe.isRequired=Ze.bind(null,!0),fe}function ut(Ee){function le(Le,Ze,fe,Re,He,pe){var Ge=Le[Ze],te=At(Ge);if(te!==Ee){var Me=Yt(Ge);return new mt("Invalid "+Re+" `"+He+"` of type "+("`"+Me+"` supplied to `"+fe+"`, expected ")+("`"+Ee+"`."))}return null}return st(le)}function dt(){return st(Q.thatReturnsNull)}function gt(Ee){function le(Le,Ze,fe,Re,He){if(typeof Ee!="function")return new mt("Property `"+He+"` of component `"+fe+"` has invalid PropType notation inside arrayOf.");var pe=Le[Ze];if(!Array.isArray(pe)){var Ge=At(pe);return new mt("Invalid "+Re+" `"+He+"` of type "+("`"+Ge+"` supplied to `"+fe+"`, expected an array."))}for(var te=0;te<pe.length;te++){var Me=Ee(pe,te,fe,Re,He+"["+te+"]",C);if(Me instanceof Error)return Me}return null}return st(le)}function wt(){function Ee(le,Le,Ze,fe,Re){var He=le[Le];if(!k(He)){var pe=At(He);return new mt("Invalid "+fe+" `"+Re+"` of type "+("`"+pe+"` supplied to `"+Ze+"`, expected a single ReactElement."))}return null}return st(Ee)}function ot(Ee){function le(Le,Ze,fe,Re,He){if(!(Le[Ze]instanceof Ee)){var pe=Ee.name||O,Ge=nn(Le[Ze]);return new mt("Invalid "+Re+" `"+He+"` of type "+("`"+Ge+"` supplied to `"+fe+"`, expected ")+("instance of `"+pe+"`."))}return null}return st(le)}function pt(Ee){if(!Array.isArray(Ee))return W.env.NODE_ENV!=="production"&&L(!1,"Invalid argument supplied to oneOf, expected an instance of array."),Q.thatReturnsNull;function le(Le,Ze,fe,Re,He){for(var pe=Le[Ze],Ge=0;Ge<Ee.length;Ge++)if(ft(pe,Ee[Ge]))return null;var te=JSON.stringify(Ee);return new mt("Invalid "+Re+" `"+He+"` of value `"+pe+"` "+("supplied to `"+fe+"`, expected one of "+te+"."))}return st(le)}function Nt(Ee){function le(Le,Ze,fe,Re,He){if(typeof Ee!="function")return new mt("Property `"+He+"` of component `"+fe+"` has invalid PropType notation inside objectOf.");var pe=Le[Ze],Ge=At(pe);if(Ge!=="object")return new mt("Invalid "+Re+" `"+He+"` of type "+("`"+Ge+"` supplied to `"+fe+"`, expected an object."));for(var te in pe)if(pe.hasOwnProperty(te)){var Me=Ee(pe,te,fe,Re,He+"."+te,C);if(Me instanceof Error)return Me}return null}return st(le)}function Gt(Ee){if(!Array.isArray(Ee))return W.env.NODE_ENV!=="production"&&L(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),Q.thatReturnsNull;for(var le=0;le<Ee.length;le++){var Le=Ee[le];if(typeof Le!="function")return L(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",be(Le),le),Q.thatReturnsNull}function Ze(fe,Re,He,pe,Ge){for(var te=0;te<Ee.length;te++){var Me=Ee[te];if(Me(fe,Re,He,pe,Ge,C)==null)return null}return new mt("Invalid "+pe+" `"+Ge+"` supplied to "+("`"+He+"`."))}return st(Ze)}function se(){function Ee(le,Le,Ze,fe,Re){return ke(le[Le])?null:new mt("Invalid "+fe+" `"+Re+"` supplied to "+("`"+Ze+"`, expected a ReactNode."))}return st(Ee)}function ie(Ee){function le(Le,Ze,fe,Re,He){var pe=Le[Ze],Ge=At(pe);if(Ge!=="object")return new mt("Invalid "+Re+" `"+He+"` of type `"+Ge+"` "+("supplied to `"+fe+"`, expected `object`."));for(var te in Ee){var Me=Ee[te];if(!!Me){var We=Me(pe,te,fe,Re,He+"."+te,C);if(We)return We}}return null}return st(le)}function Be(Ee){function le(Le,Ze,fe,Re,He){var pe=Le[Ze],Ge=At(pe);if(Ge!=="object")return new mt("Invalid "+Re+" `"+He+"` of type `"+Ge+"` "+("supplied to `"+fe+"`, expected `object`."));var te=P({},Le[Ze],Ee);for(var Me in te){var We=Ee[Me];if(!We)return new mt("Invalid "+Re+" `"+He+"` key `"+Me+"` supplied to `"+fe+"`.\nBad object: "+JSON.stringify(Le[Ze],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(Ee),null,"  "));var ee=We(pe,Me,fe,Re,He+"."+Me,C);if(ee)return ee}return null}return st(le)}function ke(Ee){switch(typeof Ee){case"number":case"string":case"undefined":return!0;case"boolean":return!Ee;case"object":if(Array.isArray(Ee))return Ee.every(ke);if(Ee===null||k(Ee))return!0;var le=K(Ee);if(le){var Le=le.call(Ee),Ze;if(le!==Ee.entries){for(;!(Ze=Le.next()).done;)if(!ke(Ze.value))return!1}else for(;!(Ze=Le.next()).done;){var fe=Ze.value;if(fe&&!ke(fe[1]))return!1}}else return!1;return!0;default:return!1}}function we(Ee,le){return Ee==="symbol"||le["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&le instanceof Symbol}function At(Ee){var le=typeof Ee;return Array.isArray(Ee)?"array":Ee instanceof RegExp?"object":we(le,Ee)?"symbol":le}function Yt(Ee){if(typeof Ee=="undefined"||Ee===null)return""+Ee;var le=At(Ee);if(le==="object"){if(Ee instanceof Date)return"date";if(Ee instanceof RegExp)return"regexp"}return le}function be(Ee){var le=Yt(Ee);switch(le){case"array":case"object":return"an "+le;case"boolean":case"date":case"regexp":return"a "+le;default:return le}}function nn(Ee){return!Ee.constructor||!Ee.constructor.name?O:Ee.constructor.name}return _.checkPropTypes=M,_.PropTypes=_,_}}).call(tt,j(5))},function(X,tt){"use strict";function j(Q){return function(){return Q}}var W=function(){};W.thatReturns=j,W.thatReturnsFalse=j(!1),W.thatReturnsTrue=j(!0),W.thatReturnsNull=j(null),W.thatReturnsThis=function(){return this},W.thatReturnsArgument=function(Q){return Q},X.exports=W},function(X,tt,j){(function(W){"use strict";var Q=function(P){};W.env.NODE_ENV!=="production"&&(Q=function(P){if(P===void 0)throw new Error("invariant requires an error message argument")});function Z(L,P,C,M,k,B,R,F){if(Q(P),!L){var K;if(P===void 0)K=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var O=[C,M,k,B,R,F],_=0;K=new Error(P.replace(/%s/g,function(){return O[_++]})),K.name="Invariant Violation"}throw K.framesToPop=1,K}}X.exports=Z}).call(tt,j(5))},function(X,tt,j){(function(W){"use strict";var Q=j(7),Z=Q;if(W.env.NODE_ENV!=="production"){var L=function(C){for(var M=arguments.length,k=Array(M>1?M-1:0),B=1;B<M;B++)k[B-1]=arguments[B];var R=0,F="Warning: "+C.replace(/%s/g,function(){return k[R++]});typeof console!="undefined"&&console.error(F);try{throw new Error(F)}catch(K){}};Z=function(C,M){if(M===void 0)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(M.indexOf("Failed Composite propType: ")!==0&&!C){for(var k=arguments.length,B=Array(k>2?k-2:0),R=2;R<k;R++)B[R-2]=arguments[R];L.apply(void 0,[M].concat(B))}}}X.exports=Z}).call(tt,j(5))},function(X,tt){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/"use strict";var j=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;function Z(P){if(P==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(P)}function L(){try{if(!Object.assign)return!1;var P=new String("abc");if(P[5]="de",Object.getOwnPropertyNames(P)[0]==="5")return!1;for(var C={},M=0;M<10;M++)C["_"+String.fromCharCode(M)]=M;var k=Object.getOwnPropertyNames(C).map(function(R){return C[R]});if(k.join("")!=="0123456789")return!1;var B={};return"abcdefghijklmnopqrst".split("").forEach(function(R){B[R]=R}),Object.keys(Object.assign({},B)).join("")==="abcdefghijklmnopqrst"}catch(R){return!1}}X.exports=L()?Object.assign:function(P,C){for(var M,k=Z(P),B,R=1;R<arguments.length;R++){M=Object(arguments[R]);for(var F in M)W.call(M,F)&&(k[F]=M[F]);if(j){B=j(M);for(var K=0;K<B.length;K++)Q.call(M,B[K])&&(k[B[K]]=M[B[K]])}}return k}},function(X,tt){"use strict";var j="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";X.exports=j},function(X,tt,j){(function(W){"use strict";if(W.env.NODE_ENV!=="production")var Q=j(8),Z=j(9),L=j(11),P={};function C(M,k,B,R,F){if(W.env.NODE_ENV!=="production"){for(var K in M)if(M.hasOwnProperty(K)){var O;try{Q(typeof M[K]=="function","%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",R||"React class",B,K,typeof M[K]),O=M[K](k,K,R,B,null,L)}catch(ft){O=ft}if(Z(!O||O instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",R||"React class",B,K,typeof O),O instanceof Error&&!(O.message in P)){P[O.message]=!0;var _=F?F():"";Z(!1,"Failed %s type: %s%s",B,O.message,_!=null?_:"")}}}}X.exports=C}).call(tt,j(5))},function(X,tt,j){"use strict";var W=j(7),Q=j(8),Z=j(11);X.exports=function(){function L(M,k,B,R,F,K){K!==Z&&Q(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}L.isRequired=L;function P(){return L}var C={array:L,bool:L,func:L,number:L,object:L,string:L,symbol:L,any:L,arrayOf:P,element:L,instanceOf:P,node:L,objectOf:P,oneOf:P,oneOfType:P,shape:P,exact:P};return C.checkPropTypes=W,C.PropTypes=C,C}},function(X,tt){X.exports=$(67294)},function(X,tt){"use strict";var j=function(Z,L){return Z===L};function W(Q){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:j,L=void 0,P=[],C=void 0,M=!1,k=function(F,K){return Z(F,P[K])},B=function(){for(var F=arguments.length,K=Array(F),O=0;O<F;O++)K[O]=arguments[O];return M&&L===this&&K.length===P.length&&K.every(k)||(M=!0,L=this,P=K,C=Q.apply(this,K)),C};return B}X.exports=W}])},29154:function(sr,it,$){"use strict";$.d(it,{ZP:function(){return iv}});function X(m,y){for(var b=m.length,S=0;S<b;++S)if(y(m[S],S))return!0;return!1}function tt(m,y){for(var b=m.length,S=0;S<b;++S)if(y(m[S],S))return m[S];return null}function j(m){var y=m;if(typeof y=="undefined"){if(typeof navigator=="undefined"||!navigator)return"";y=navigator.userAgent||""}return y.toLowerCase()}function W(m,y){try{return new RegExp(m,"g").exec(y)}catch(b){return null}}function Q(){if(typeof navigator=="undefined"||!navigator||!navigator.userAgentData)return!1;var m=navigator.userAgentData,y=m.brands||m.uaList;return!!(y&&y.length)}function Z(m,y){var b=W("("+m+")((?:\\/|\\s|:)([0-9|\\.|_]+))",y);return b?b[3]:""}function L(m){return m.replace(/_/g,".")}function P(m,y){var b=null,S="-1";return X(m,function(D){var J=W("("+D.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",y);return!J||D.brand?!1:(b=D,S=J[3]||"-1",D.versionAlias?S=D.versionAlias:D.versionTest&&(S=Z(D.versionTest.toLowerCase(),y)||S),S=L(S),!0)}),{preset:b,version:S}}function C(m,y){var b={brand:"",version:"-1"};return X(m,function(S){var D=M(y,S);return D?(b.brand=S.id,b.version=S.versionAlias||D.version,b.version!=="-1"):!1}),b}function M(m,y){return tt(m,function(b){var S=b.brand;return W(""+y.test,S.toLowerCase())})}var k=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],B=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],R=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],F=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],K=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function O(m){return!!P(F,m).preset}function _(m){var y=j(m),b=!!/mobi/g.exec(y),S={name:"unknown",version:"-1",majorVersion:-1,webview:O(y),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},D={name:"unknown",version:"-1",majorVersion:-1},J=P(k,y),lt=J.preset,xt=J.version,_t=P(K,y),Wt=_t.preset,qt=_t.version,Jt=P(B,y);if(S.chromium=!!Jt.preset,S.chromiumVersion=Jt.version,!S.chromium){var Ut=P(R,y);S.webkit=!!Ut.preset,S.webkitVersion=Ut.version}return Wt&&(D.name=Wt.id,D.version=qt,D.majorVersion=parseInt(qt,10)),lt&&(S.name=lt.id,S.version=xt,S.webview&&D.name==="ios"&&S.name!=="safari"&&(S.webview=!1)),S.majorVersion=parseInt(S.version,10),{browser:S,os:D,isMobile:b,isHints:!1}}function ft(m){var y=navigator.userAgentData,b=(y.uaList||y.brands).slice(),S=m&&m.fullVersionList,D=y.mobile||!1,J=b[0],lt=(m&&m.platform||y.platform||navigator.platform).toLowerCase(),xt={name:J.brand,version:J.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!C(F,b).brand||O(j())},_t={name:"unknown",version:"-1",majorVersion:-1};xt.webkit=!xt.chromium&&X(R,function(Ce){return M(b,Ce)});var Wt=C(B,b);if(xt.chromium=!!Wt.brand,xt.chromiumVersion=Wt.version,!xt.chromium){var qt=C(R,b);xt.webkit=!!qt.brand,xt.webkitVersion=qt.version}var Jt=tt(K,function(Ce){return new RegExp(""+Ce.test,"g").exec(lt)});if(_t.name=Jt?Jt.id:"",m&&(_t.version=m.platformVersion),S&&S.length){var Ut=C(k,S);xt.name=Ut.brand||xt.name,xt.version=Ut.version||xt.version}else{var xe=C(k,b);xt.name=xe.brand||xt.name,xt.version=xe.brand&&m?m.uaFullVersion:xe.version}return xt.webkit&&(_t.name=D?"ios":"mac"),_t.name==="ios"&&xt.webview&&(xt.version="-1"),_t.version=L(_t.version),xt.version=L(xt.version),_t.majorVersion=parseInt(_t.version,10),xt.majorVersion=parseInt(xt.version,10),{browser:xt,os:_t,isMobile:D,isHints:!0}}function mt(m){return Q()?navigator.userAgentData.getHighEntropyValues(["architecture","model","platform","platformVersion","uaFullVersion","fullVersionList"]).then(function(y){var b=ft(y);return m&&m(b),b}):(m&&m(st()),typeof Promise=="undefined"||!Promise?null:Promise.resolve(st()))}function st(m){return typeof m=="undefined"&&Q()?ft():_(m)}var ut=st;function dt(m){for(var y=[],b=1;b<arguments.length;b++)y[b-1]=arguments[b];return y.map(function(S){return S.split(" ").map(function(D){return D?""+m+D:""}).join(" ")}).join(" ")}function gt(m,y){return y.replace(/([^}{]*){/gm,function(b,S){return S.replace(/\.([^{,\s\d.]+)/g,"."+m+"$1")+"{"})}function wt(m,y){return function(b){b&&(m[y]=b)}}function ot(m,y,b){return function(S){S&&(m[y][b]=S)}}function pt(m,y){return function(b){var S=b.prototype;m.forEach(function(D){y(S,D)})}}function Nt(m,y){return y===void 0&&(y={}),function(b,S){m.forEach(function(D){var J=y[D]||D;J in b||(b[J]=function(){for(var lt,xt=[],_t=0;_t<arguments.length;_t++)xt[_t]=arguments[_t];var Wt=(lt=this[S])[D].apply(lt,xt);return Wt===this[S]?this:Wt})})}}var Gt="rgb",se="rgba",ie="hsl",Be="hsla",ke=[Gt,se,ie,Be],we="function",At="property",Yt="array",be="object",nn="string",Ee="number",le="undefined",Le=typeof window!==le,Ze=typeof document!==le&&document,fe=null,Re=function(m){if(!Ze)return"";var y=(Ze.body||Ze.documentElement).style,b=fe.length;if(typeof y[m]!==le)return m;for(var S=0;S<b;++S){var D="-"+fe[S]+"-"+m;if(typeof y[D]!==le)return D}return""},He=null,pe=null,Ge=null,te=null,Me=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],We=1e-7,ee=1/We,Pt={cm:function(m){return m*96/2.54},mm:function(m){return m*96/254},in:function(m){return m*96},pt:function(m){return m*96/72},pc:function(m){return m*96/6},"%":function(m,y){return m*y/100},vw:function(m,y){return y===void 0&&(y=window.innerWidth),m/100*y},vh:function(m,y){return y===void 0&&(y=window.innerHeight),m/100*y},vmax:function(m,y){return y===void 0&&(y=Math.max(window.innerWidth,window.innerHeight)),m/100*y},vmin:function(m,y){return y===void 0&&(y=Math.min(window.innerWidth,window.innerHeight)),m/100*y}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function yt(){for(var m=0,y=0,b=arguments.length;y<b;y++)m+=arguments[y].length;for(var S=Array(m),D=0,y=0;y<b;y++)for(var J=arguments[y],lt=0,xt=J.length;lt<xt;lt++,D++)S[D]=J[lt];return S}function Ne(m,y,b,S){return(m*S+y*b)/(b+S)}function tn(m){return typeof m===le}function fn(m){return m&&typeof m===be}function Rt(m){return Array.isArray(m)}function Yn(m){return typeof m===nn}function Un(m){return typeof m===Ee}function xr(m){return typeof m===we}function cr(m,y){var b=m===""||m==" ",S=y===""||y==" ";return S&&b||m===y}function Ur(m,y,b,S,D){var J=fa(m,y,b);return J?b:Sa(m,y,b+1,S,D)}function fa(m,y,b){if(!m.ignore)return null;var S=y.slice(Math.max(b-3,0),b+3).join("");return new RegExp(m.ignore).exec(S)}function Sa(m,y,b,S,D){for(var J=function(Wt){var qt=y[Wt].trim();if(qt===m.close&&!fa(m,y,Wt))return{value:Wt};var Jt=Wt,Ut=Cr(D,function(xe){var Ce=xe.open;return Ce===qt});if(Ut&&(Jt=Ur(Ut,y,Wt,S,D)),Jt===-1)return lt=Wt,"break";Wt=Jt,lt=Wt},lt,xt=b;xt<S;++xt){var _t=J(xt);if(xt=lt,typeof _t=="object")return _t.value;if(_t==="break")break}return-1}function sa(m,y){var b=Yn(y)?{separator:y}:y,S=b.separator,D=S===void 0?",":S,J=b.isSeparateFirst,lt=b.isSeparateOnlyOpenClose,xt=b.isSeparateOpenClose,_t=xt===void 0?lt:xt,Wt=b.openCloseCharacters,qt=Wt===void 0?Me:Wt,Jt=qt.map(function(pr){var zr=pr.open,Er=pr.close;return zr===Er?zr:zr+"|"+Er}).join("|"),Ut="(\\s*"+D+"\\s*|"+Jt+"|\\s+)",xe=new RegExp(Ut,"g"),Ce=m.split(xe).filter(function(pr){return pr&&pr!=="undefined"}),Ue=Ce.length,en=[],dn=[];function Rn(){return dn.length?(en.push(dn.join("")),dn=[],!0):!1}for(var nr=function(pr){var zr=Ce[pr].trim(),Er=pr,oa=Cr(qt,function(va){var Ua=va.open;return Ua===zr}),Gr=Cr(qt,function(va){var Ua=va.close;return Ua===zr});if(oa){if(Er=Ur(oa,Ce,pr,Ue,qt),Er!==-1&&_t)return Rn()&&J||(en.push(Ce.slice(pr,Er+1).join("")),pr=Er,J)?(Kn=pr,"break"):(Kn=pr,"continue")}else if(Gr&&!fa(Gr,Ce,pr)){var wa=yt(qt);return wa.splice(qt.indexOf(Gr),1),{value:sa(m,{separator:D,isSeparateFirst:J,isSeparateOnlyOpenClose:lt,isSeparateOpenClose:_t,openCloseCharacters:wa})}}else if(cr(zr,D)&&!lt)return Rn(),J?(Kn=pr,"break"):(Kn=pr,"continue");Er===-1&&(Er=Ue-1),dn.push(Ce.slice(pr,Er+1).join("")),pr=Er,Kn=pr},Kn,Sr=0;Sr<Ue;++Sr){var jn=nr(Sr);if(Sr=Kn,typeof jn=="object")return jn.value;if(jn==="break")break}return dn.length&&en.push(dn.join("")),en}function Da(m){return sa(m,"")}function Rr(m){return sa(m,",")}function Mn(m){var y=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(m);return!y||y.length<4?{}:{prefix:y[1],value:y[2],suffix:y[3]}}function ar(m){var y=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(m);if(!y)return{prefix:"",unit:"",value:NaN};var b=y[1],S=y[2],D=y[3];return{prefix:b,unit:D,value:parseFloat(S)}}function Fn(m){return m.replace(/[\s-_]+([^\s-_])/g,function(y,b){return b.toUpperCase()})}function tr(m,y){return y===void 0&&(y="-"),m.replace(/([a-z])([A-Z])/g,function(b,S,D){return""+S+y+D.toLowerCase()})}function Gn(m){return[].slice.call(m)}function jr(){return Date.now?Date.now():new Date().getTime()}function Hr(m,y,b){b===void 0&&(b=-1);for(var S=m.length,D=0;D<S;++D)if(y(m[D],D,m))return D;return b}function Ea(m,y,b){b===void 0&&(b=-1);for(var S=m.length,D=S-1;D>=0;--D)if(y(m[D],D,m))return D;return b}function lr(m,y,b){var S=Ea(m,y);return S>-1?m[S]:b}function Cr(m,y,b){var S=Hr(m,y);return S>-1?m[S]:b}var vr=function(){var m=jr(),y=Le&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return y?y.bind(window):function(b){var S=jr(),D=setTimeout(function(){b(S-m)},1e3/60);return D}}(),Tr=function(){var m=Le&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return m?m.bind(window):function(y){clearTimeout(y)}}();function ta(m){return Object.keys(m)}function ra(m){var y=ta(m);return y.map(function(b){return m[b]})}function Zr(m){var y=ta(m);return y.map(function(b){return[b,m[b]]})}function vt(m,y){y===void 0&&(y=[]),m.sort(function(b,S){var D=y.indexOf(b),J=y.indexOf(S);return J===-1&&D===-1?0:D===-1?1:J===-1?-1:D-J})}function _n(m,y){var b=ar(m),S=b.value,D=b.unit;if(fn(y)){var J=y[D];if(J){if(xr(J))return J(S);if(Pt[D])return Pt[D](S,J)}}else if(D==="%")return S*y/100;return Pt[D]?Pt[D](S):S}function an(m,y,b){return Math.max(y,Math.min(m,b))}function Lt(m,y,b,S){return S===void 0&&(S=m[0]/m[1]),[[Ht(y[0],We),Ht(y[0]/S,We)],[Ht(y[1]*S,We),Ht(y[1],We)]].filter(function(D){return D.every(function(J,lt){var xt=y[lt],_t=Ht(xt,We);return b?J<=xt||J<=_t:J>=xt||J>=_t})})[0]||m}function kt(m,y,b,S){if(!S)return m.map(function(xe,Ce){return an(xe,y[Ce],b[Ce])});var D=m[0],J=m[1],lt=S===!0?D/J:S,xt=Lt(m,y,!1,lt),_t=xt[0],Wt=xt[1],qt=Lt(m,b,!0,lt),Jt=qt[0],Ut=qt[1];return D<_t||J<Wt?(D=_t,J=Wt):(D>Jt||J>Ut)&&(D=Jt,J=Ut),[D,J]}function at(m){for(var y=m.length,b=0,S=y-1;S>=0;--S)b+=m[S];return b}function H(m){for(var y=m.length,b=0,S=y-1;S>=0;--S)b+=m[S];return y?b/y:0}function Y(m,y){var b=y[0]-m[0],S=y[1]-m[1],D=Math.atan2(S,b);return D>=0?D:D+Math.PI*2}function bt(m){return[0,1].map(function(y){return H(m.map(function(b){return b[y]}))})}function $t(m){var y=bt(m),b=Y(y,m[0]),S=Y(y,m[1]);return b<S&&S-b<Math.PI||b>S&&S-b<-Math.PI?1:-1}function jt(m,y){return Math.sqrt(Math.pow((y?y[0]:0)-m[0],2)+Math.pow((y?y[1]:0)-m[1],2))}function Ht(m,y){if(!y)return m;var b=1/y;return Math.round(m/y)/b}function re(m,y){return m.forEach(function(b,S){m[S]=Ht(m[S],y)}),m}function on(m){for(var y=[],b=0;b<m;++b)y.push(b);return y}function Je(m,y,b){var S=!1;return m.replace(y,function(){for(var D=[],J=0;J<arguments.length;J++)D[J]=arguments[J];return S?D[0]:(S=!0,Yn(b)?b:b.apply(void 0,D))})}function Ve(m){return m.reduce(function(y,b){return y.concat(b)},[])}function qn(m){return m.reduce(function(y,b){return Rt(b)?y.push.apply(y,qn(b)):y.push(b),y},[])}function Ln(m,y){m.indexOf(y)===-1&&m.push(y)}function qr(m){return m.replace("#","")}function Ca(m){var y=qr(m),b=parseInt(y.substring(0,2),16),S=parseInt(y.substring(2,4),16),D=parseInt(y.substring(4,6),16),J=parseInt(y.substring(6,8),16)/255;return isNaN(J)&&(J=1),[b,S,D,J]}function Qn(m){var y=m.charAt(1),b=m.charAt(2),S=m.charAt(3),D=m.charAt(4),J=["#",y,y,b,b,S,S,D,D];return J.join("")}function _r(m){var y,b=m[0],S=m[1],D=m[2];b<0&&(b+=Math.floor((Math.abs(b)+360)/360)*360),b%=360;var J=(1-Math.abs(2*D-1))*S,lt=J*(1-Math.abs(b/60%2-1)),xt=D-J/2,_t;return b<60?_t=[J,lt,0]:b<120?_t=[lt,J,0]:b<180?_t=[0,J,lt]:b<240?_t=[0,lt,J]:b<300?_t=[lt,0,J]:b<360?_t=[J,0,lt]:_t=[0,0,0],[Math.round((_t[0]+xt)*255),Math.round((_t[1]+xt)*255),Math.round((_t[2]+xt)*255),(y=m[3])!==null&&y!==void 0?y:1]}function ea(m){if(m.charAt(0)==="#")return m.length===4||m.length===5?Ca(Qn(m)):Ca(m);if(m.indexOf("(")!==-1){var y=Mn(m),b=y.prefix,S=y.value;if(!b||!S)return;var D=Rr(S),J=[0,0,0,1],lt=D.length;switch(b){case Gt:case se:for(var xt=0;xt<lt;++xt)J[xt]=parseFloat(D[xt]);return J;case ie:case Be:for(var xt=0;xt<lt;++xt)D[xt].indexOf("%")!==-1?J[xt]=parseFloat(D[xt])/100:J[xt]=parseFloat(D[xt]);return _r(J)}}}function La(m,y){return Ze?y?Ze.querySelectorAll(m):Ze.querySelector(m):y?[]:null}function ha(m,y){return m.classList?m.classList.contains(y):!!m.className.match(new RegExp("(\\s|^)"+y+"(\\s|$)"))}function _i(m,y){m.classList?m.classList.add(y):m.className+=" "+y}function Ni(m,y){if(m.classList)m.classList.remove(y);else{var b=new RegExp("(\\s|^)"+y+"(\\s|$)");m.className=m.className.replace(b," ")}}function vi(m,y){if(!m||!y||!y.length)return{};var b;if(m instanceof Element)b=m;else if(m.length)b=m[0];else return{};for(var S={},D=hn(b).getComputedStyle(b),J=y.length,lt=0;lt<J;++lt)S[y[lt]]=D[y[lt]];return S}function si(m,y,b,S){m.addEventListener(y,b,S)}function Mi(m,y,b,S){m.removeEventListener(y,b,S)}function Pa(m){return(m==null?void 0:m.ownerDocument)||Ze}function un(m){return Pa(m).documentElement}function Oe(m){return Pa(m).body}function hn(m){var y;return((y=m==null?void 0:m.ownerDocument)===null||y===void 0?void 0:y.defaultView)||window}function Hn(m){return m&&"postMessage"in m&&"blur"in m&&"self"in m}function Bn(m){return fn(m)&&m.nodeName&&m.nodeType&&"ownerDocument"in m}function Jn(m,y,b,S,D,J){for(var lt=0;lt<D;++lt){var xt=b+lt*D,_t=S+lt*D;m[xt]+=m[_t]*J,y[xt]+=y[_t]*J}}function Lr(m,y,b,S,D){for(var J=0;J<D;++J){var lt=b+J*D,xt=S+J*D,_t=m[lt],Wt=y[lt];m[lt]=m[xt],m[xt]=_t,y[lt]=y[xt],y[xt]=Wt}}function ya(m,y,b,S,D){for(var J=0;J<S;++J){var lt=b+J*S;m[lt]/=D,y[lt]/=D}}function Fa(m,y,b){b===void 0&&(b=Math.sqrt(m.length));for(var S=m.slice(),D=0;D<b;++D)S[D*b+y-1]=0,S[(y-1)*b+D]=0;return S[(y-1)*(b+1)]=1,S}function ui(m,y){y===void 0&&(y=Math.sqrt(m.length));for(var b=m.slice(),S=Wi(y),D=0;D<y;++D){var J=y*D+D;if(!Ht(b[J],We)){for(var lt=D+1;lt<y;++lt)if(b[y*D+lt]){Lr(b,S,D,lt,y);break}}if(!Ht(b[J],We))return[];ya(b,S,D,y,b[J]);for(var lt=0;lt<y;++lt){var xt=lt,_t=lt+D*y,Wt=b[_t];!Ht(Wt,We)||D===lt||Jn(b,S,xt,D,y,-Wt)}}return S}function Ei(m,y){y===void 0&&(y=Math.sqrt(m.length));for(var b=[],S=0;S<y;++S)for(var D=0;D<y;++D)b[D*y+S]=m[y*S+D];return b}function oo(m,y){y===void 0&&(y=Math.sqrt(m.length));for(var b=[],S=m[y*y-1],D=0;D<y-1;++D)b[D]=m[y*(y-1)+D]/S;return b[y-1]=0,b}function po(m,y){for(var b=Wi(y),S=0;S<y-1;++S)b[y*(y-1)+S]=m[S]||0;return b}function bo(m,y){for(var b=m.slice(),S=m.length;S<y-1;++S)b[S]=0;return b[y-1]=1,b}function ts(m,y,b){if(y===void 0&&(y=Math.sqrt(m.length)),y===b)return m;for(var S=Wi(b),D=Math.min(y,b),J=0;J<D-1;++J){for(var lt=0;lt<D-1;++lt)S[J*b+lt]=m[J*y+lt];S[(J+1)*b-1]=m[(J+1)*y-1],S[(b-1)*b+J]=m[(y-1)*y+J]}return S[b*b-1]=m[y*y-1],S}function Wo(m){for(var y=[],b=1;b<arguments.length;b++)y[b-1]=arguments[b];var S=Wi(m);return y.forEach(function(D){S=Yi(S,D,m)}),S}function Yi(m,y,b){b===void 0&&(b=Math.sqrt(m.length));var S=[],D=m.length/b,J=y.length/D;if(D){if(!J)return m}else return y;for(var lt=0;lt<b;++lt)for(var xt=0;xt<J;++xt){S[xt*b+lt]=0;for(var _t=0;_t<D;++_t)S[xt*b+lt]+=m[_t*b+lt]*y[xt*D+_t]}return S}function wi(m,y){for(var b=Math.min(m.length,y.length),S=m.slice(),D=0;D<b;++D)S[D]=S[D]+y[D];return S}function gi(m,y){for(var b=Math.min(m.length,y.length),S=m.slice(),D=0;D<b;++D)S[D]=S[D]-y[D];return S}function us(m,y){return y===void 0&&(y=m.length===6),y?[m[0],m[1],0,m[2],m[3],0,m[4],m[5],1]:m}function Do(m,y){return y===void 0&&(y=m.length===9),y?[m[0],m[1],m[3],m[4],m[6],m[7]]:m}function Io(m,y,b){b===void 0&&(b=y.length);var S=Yi(m,y,b),D=S[b-1];return S.map(function(J){return J/D})}function zs(m,y){return Yi(m,[1,0,0,0,0,Math.cos(y),Math.sin(y),0,0,-Math.sin(y),Math.cos(y),0,0,0,0,1],4)}function mu(m,y){return Yi(m,[Math.cos(y),0,-Math.sin(y),0,0,1,0,0,Math.sin(y),0,Math.cos(y),0,0,0,0,1],4)}function ds(m,y){return Yi(m,qo(y,4))}function Ms(m,y){var b=y[0],S=b===void 0?1:b,D=y[1],J=D===void 0?1:D,lt=y[2],xt=lt===void 0?1:lt;return Yi(m,[S,0,0,0,0,J,0,0,0,0,xt,0,0,0,0,1],4)}function yu(m,y){return Io(qo(y,3),bo(m,3))}function uu(m,y){var b=y[0],S=b===void 0?0:b,D=y[1],J=D===void 0?0:D,lt=y[2],xt=lt===void 0?0:lt;return Yi(m,[1,0,0,0,0,1,0,0,0,0,1,0,S,J,xt,1],4)}function Cs(m,y){return Yi(m,y,4)}function qo(m,y){var b=Math.cos(m),S=Math.sin(m),D=Wi(y);return D[0]=b,D[1]=S,D[y]=-S,D[y+1]=b,D}function Wi(m){for(var y=m*m,b=[],S=0;S<y;++S)b[S]=S%(m+1)?0:1;return b}function ls(m,y){for(var b=Wi(y),S=Math.min(m.length,y-1),D=0;D<S;++D)b[(y+1)*D]=m[D];return b}function is(m,y){for(var b=Wi(y),S=Math.min(m.length,y-1),D=0;D<S;++D)b[y*(y-1)+D]=m[D];return b}function Es(m,y,b,S,D,J,lt,xt){var _t=m[0],Wt=m[1],qt=y[0],Jt=y[1],Ut=b[0],xe=b[1],Ce=S[0],Ue=S[1],en=D[0],dn=D[1],Rn=J[0],nr=J[1],Kn=lt[0],Sr=lt[1],jn=xt[0],pr=xt[1],zr=[_t,0,qt,0,Ut,0,Ce,0,Wt,0,Jt,0,xe,0,Ue,0,1,0,1,0,1,0,1,0,0,_t,0,qt,0,Ut,0,Ce,0,Wt,0,Jt,0,xe,0,Ue,0,1,0,1,0,1,0,1,-en*_t,-dn*_t,-Rn*qt,-nr*qt,-Kn*Ut,-Sr*Ut,-jn*Ce,-pr*Ce,-en*Wt,-dn*Wt,-Rn*Jt,-nr*Jt,-Kn*xe,-Sr*xe,-jn*Ue,-pr*Ue],Er=ui(zr,8);if(!Er.length)return[];var oa=Yi(Er,[en,dn,Rn,nr,Kn,Sr,jn,pr],8);return oa[8]=1,ts(Ei(oa),3,4)}function tl(m){return[0,1].map(function(y){return average(m.map(function(b){return b[y]}))})}function bu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Ys(m){return Ro(Ns(m))}function ka(m){return Ys(getComputedStyle(m).transform)}function Ku(m,y){var b=Io(m,[y[0],y[1]||0,y[2]||0,1],4),S=b[3]||1;return[b[0]/S,b[1]/S,b[2]/S]}function Vs(m,y){y===void 0&&(y=document.body);for(var b=m,S=bu();b;){var D=getComputedStyle(b).transform;if(S=matrix3d(Ys(D),S),b===y)break;b=b.parentElement}return S=invert(S,4),S[12]=0,S[13]=0,S[14]=0,S}function Ro(m){var y=bu();return m.forEach(function(b){var S=b.matrixFunction,D=b.functionValue;!S||(y=S(y,D))}),y}function Ns(m){var y=Rt(m)?m:Da(m);return y.map(function(b){var S=Mn(b),D=S.prefix,J=S.value,lt=null,xt=D,_t="";if(D==="translate"||D==="translateX"||D==="translate3d"){var Wt=Rr(J).map(function(oa){return parseFloat(oa)}),qt=Wt[0],Jt=Wt[1],Ut=Jt===void 0?0:Jt,xe=Wt[2],Ce=xe===void 0?0:xe;lt=uu,_t=[qt,Ut,Ce]}else if(D==="translateY"){var Ut=parseFloat(J);lt=uu,_t=[0,Ut,0]}else if(D==="translateZ"){var Ce=parseFloat(J);lt=uu,_t=[0,0,Ce]}else if(D==="scale"||D==="scale3d"){var Ue=Rr(J).map(function(oa){return parseFloat(oa)}),en=Ue[0],dn=Ue[1],Rn=dn===void 0?en:dn,nr=Ue[2],Kn=nr===void 0?1:nr;lt=Ms,_t=[en,Rn,Kn]}else if(D==="scaleX"){var en=parseFloat(J);lt=Ms,_t=[en,1,1]}else if(D==="scaleY"){var Rn=parseFloat(J);lt=Ms,_t=[1,Rn,1]}else if(D==="scaleZ"){var Kn=parseFloat(J);lt=Ms,_t=[1,1,Kn]}else if(D==="rotate"||D==="rotateZ"||D==="rotateX"||D==="rotateY"){var Sr=ar(J),jn=Sr.unit,pr=Sr.value,zr=jn==="rad"?pr:pr*Math.PI/180;D==="rotate"||D==="rotateZ"?(xt="rotateZ",lt=ds):D==="rotateX"?lt=zs:D==="rotateY"&&(lt=mu),_t=zr}else if(D==="matrix3d")lt=Cs,_t=Rr(J).map(function(oa){return parseFloat(oa)});else if(D==="matrix"){var Er=Rr(J).map(function(oa){return parseFloat(oa)});lt=Cs,_t=[Er[0],Er[1],0,0,Er[2],Er[3],0,0,0,0,1,0,Er[4],Er[5],0,1]}else xt="";return{name:D,functionName:xt,value:J,matrixFunction:lt,functionValue:_t}})}var tu=function(){function m(){this.keys=[],this.values=[]}var y=m.prototype;return y.get=function(b){return this.values[this.keys.indexOf(b)]},y.set=function(b,S){var D=this.keys,J=this.values,lt=D.indexOf(b),xt=lt===-1?D.length:lt;D[xt]=b,J[xt]=S},m}(),eu=function(){function m(){this.object={}}var y=m.prototype;return y.get=function(b){return this.object[b]},y.set=function(b,S){this.object[b]=S},m}(),Zu=typeof Map=="function",bn=function(){function m(){}var y=m.prototype;return y.connect=function(b,S){this.prev=b,this.next=S,b&&(b.next=this),S&&(S.prev=this)},y.disconnect=function(){var b=this.prev,S=this.next;b&&(b.next=S),S&&(S.prev=b)},y.getIndex=function(){for(var b=this,S=-1;b;)b=b.prev,++S;return S},m}();function Xr(m,y){var b=[],S=[];return m.forEach(function(D){var J=D[0],lt=D[1],xt=new bn;b[J]=xt,S[lt]=xt}),b.forEach(function(D,J){D.connect(b[J-1])}),m.filter(function(D,J){return!y[J]}).map(function(D,J){var lt=D[0],xt=D[1];if(lt===xt)return[0,0];var _t=b[lt],Wt=S[xt-1],qt=_t.getIndex();_t.disconnect(),Wt?_t.connect(Wt,Wt.next):_t.connect(void 0,b[0]);var Jt=_t.getIndex();return[qt,Jt]})}var pa=function(){function m(b,S,D,J,lt,xt,_t,Wt){this.prevList=b,this.list=S,this.added=D,this.removed=J,this.changed=lt,this.maintained=xt,this.changedBeforeAdded=_t,this.fixed=Wt}var y=m.prototype;return Object.defineProperty(y,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(y,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),y.caculateOrdered=function(){var b=Xr(this.changedBeforeAdded,this.fixed),S=this.changed,D=[];this.cacheOrdered=b.filter(function(J,lt){var xt=J[0],_t=J[1],Wt=S[lt],qt=Wt[0],Jt=Wt[1];if(xt!==_t)return D.push([qt,Jt]),!0}),this.cachePureChanged=D},m}();function Ra(m,y,b){var S=Zu?Map:b?eu:tu,D=b||function(Rn){return Rn},J=[],lt=[],xt=[],_t=m.map(D),Wt=y.map(D),qt=new S,Jt=new S,Ut=[],xe=[],Ce={},Ue=[],en=0,dn=0;return _t.forEach(function(Rn,nr){qt.set(Rn,nr)}),Wt.forEach(function(Rn,nr){Jt.set(Rn,nr)}),_t.forEach(function(Rn,nr){var Kn=Jt.get(Rn);typeof Kn=="undefined"?(++dn,lt.push(nr)):Ce[Kn]=dn}),Wt.forEach(function(Rn,nr){var Kn=qt.get(Rn);typeof Kn=="undefined"?(J.push(nr),++en):(xt.push([Kn,nr]),dn=Ce[nr]||0,Ut.push([Kn-dn,nr-en]),xe.push(nr===Kn),Kn!==nr&&Ue.push([Kn,nr]))}),lt.reverse(),new pa(m,y,J,lt,Ue,xt,Ut,xe)}var Qi=function(){function m(b,S){b===void 0&&(b=[]),this.findKeyCallback=S,this.list=[].slice.call(b)}var y=m.prototype;return y.update=function(b){var S=[].slice.call(b),D=Ra(this.list,S,this.findKeyCallback);return this.list=S,D},m}(),Co=Qi;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var to=function(m,y){return to=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,S){b.__proto__=S}||function(b,S){for(var D in S)S.hasOwnProperty(D)&&(b[D]=S[D])},to(m,y)};function xo(m,y){to(m,y);function b(){this.constructor=m}m.prototype=y===null?Object.create(y):(b.prototype=y.prototype,new b)}var gs=typeof Map=="function"?void 0:function(){var m=0;return function(y){return y.__DIFF_KEY__||(y.__DIFF_KEY__=++m)}}(),vo=function(m){xo(y,m);function y(b){return b===void 0&&(b=[]),m.call(this,b,gs)||this}return y}(Co);function ou(m,y){return Ra(m,y,gs)}var ms=vo;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var xu=function(){return xu=Object.assign||function(y){for(var b,S=1,D=arguments.length;S<D;S++){b=arguments[S];for(var J in b)Object.prototype.hasOwnProperty.call(b,J)&&(y[J]=b[J])}return y},xu.apply(this,arguments)};function dl(){for(var m=0,y=0,b=arguments.length;y<b;y++)m+=arguments[y].length;for(var S=Array(m),D=0,y=0;y<b;y++)for(var J=arguments[y],lt=0,xt=J.length;lt<xt;lt++,D++)S[D]=J[lt];return S}var kl=function(){function m(){this._events={}}var y=m.prototype;return y.on=function(b,S){if(fn(b))for(var D in b)this.on(D,b[D]);else this._addEvent(b,S,{});return this},y.off=function(b,S){if(!b)this._events={};else if(fn(b))for(var D in b)this.off(D);else if(!S)this._events[b]=[];else{var J=this._events[b];if(J){var lt=Hr(J,function(xt){return xt.listener===S});lt>-1&&J.splice(lt,1)}}return this},y.once=function(b,S){var D=this;return S&&this._addEvent(b,S,{once:!0}),new Promise(function(J){D._addEvent(b,J,{once:!0})})},y.emit=function(b,S){var D=this;S===void 0&&(S={});var J=this._events[b];if(!b||!J)return!0;var lt=!1;return S.eventType=b,S.stop=function(){lt=!0},S.currentTarget=this,dl(J).forEach(function(xt){xt.listener(S),xt.once&&D.off(b,xt.listener)}),!lt},y.trigger=function(b,S){return S===void 0&&(S={}),this.emit(b,S)},y._addEvent=function(b,S,D){var J=this._events;J[b]=J[b]||[];var lt=J[b];lt.push(xu({listener:S},D))},m}(),Ks=kl;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var el=function(m,y){return el=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,S){b.__proto__=S}||function(b,S){for(var D in S)S.hasOwnProperty(D)&&(b[D]=S[D])},el(m,y)};function lu(m,y){el(m,y);function b(){this.constructor=m}m.prototype=y===null?Object.create(y):(b.prototype=y.prototype,new b)}var Du=function(){return Du=Object.assign||function(y){for(var b,S=1,D=arguments.length;S<D;S++){b=arguments[S];for(var J in b)Object.prototype.hasOwnProperty.call(b,J)&&(y[J]=b[J])}return y},Du.apply(this,arguments)};function pl(m){var y=m.container;return y===document.body?[y.scrollLeft||document.documentElement.scrollLeft,y.scrollTop||document.documentElement.scrollTop]:[y.scrollLeft,y.scrollTop]}function ns(m,y){return m.addEventListener("scroll",y),function(){m.removeEventListener("scroll",y)}}function _s(m){if(m){if(Yn(m))return document.querySelector(m)}else return null;if(xr(m))return m();if(m instanceof Element)return m;if("current"in m)return m.current;if("value"in m)return m.value}var Bu=function(m){lu(y,m);function y(){var S=m!==null&&m.apply(this,arguments)||this;return S._startRect=null,S._startPos=[],S._prevTime=0,S._timer=0,S._prevScrollPos=[0,0],S._isWait=!1,S._flag=!1,S._currentOptions=null,S._lock=!1,S._unregister=null,S._onScroll=function(){var D=S._currentOptions;S._lock||!D||S.emit("scrollDrag",{next:function(J){S.checkScroll({container:D.container,inputEvent:J})}})},S}var b=y.prototype;return b.dragStart=function(S,D){var J=_s(D.container);if(!J){this._flag=!1;return}var lt=0,xt=0,_t=0,Wt=0;if(J===document.body)_t=window.innerWidth,Wt=window.innerHeight;else{var qt=J.getBoundingClientRect();lt=qt.top,xt=qt.left,_t=qt.width,Wt=qt.height}this._flag=!0,this._startPos=[S.clientX,S.clientY],this._startRect={top:lt,left:xt,width:_t,height:Wt},this._prevScrollPos=this._getScrollPosition([0,0],D),this._currentOptions=D,this._registerScrollEvent(D)},b.drag=function(S,D){if(clearTimeout(this._timer),!!this._flag){var J=S.clientX,lt=S.clientY,xt=D.threshold,_t=xt===void 0?0:xt,Wt=this,qt=Wt._startRect,Jt=Wt._startPos;this._currentOptions=D;var Ut=[0,0];return qt.top>lt-_t?(Jt[1]>qt.top||lt<Jt[1])&&(Ut[1]=-1):qt.top+qt.height<lt+_t&&(Jt[1]<qt.top+qt.height||lt>Jt[1])&&(Ut[1]=1),qt.left>J-_t?(Jt[0]>qt.left||J<Jt[0])&&(Ut[0]=-1):qt.left+qt.width<J+_t&&(Jt[0]<qt.left+qt.width||J>Jt[0])&&(Ut[0]=1),!Ut[0]&&!Ut[1]?!1:this._continueDrag(Du(Du({},D),{direction:Ut,inputEvent:S,isDrag:!0}))}},b.checkScroll=function(S){var D=this;if(this._isWait)return!1;var J=S.prevScrollPos,lt=J===void 0?this._prevScrollPos:J,xt=S.direction,_t=S.throttleTime,Wt=_t===void 0?0:_t,qt=S.inputEvent,Jt=S.isDrag,Ut=this._getScrollPosition(xt||[0,0],S),xe=Ut[0]-lt[0],Ce=Ut[1]-lt[1],Ue=xt||[xe?Math.abs(xe)/xe:0,Ce?Math.abs(Ce)/Ce:0];return this._prevScrollPos=Ut,this._lock=!1,!xe&&!Ce?!1:(this.emit("move",{offsetX:Ue[0]?xe:0,offsetY:Ue[1]?Ce:0,inputEvent:qt}),Wt&&Jt&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){D._continueDrag(S)},Wt)),!0)},b.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},b._getScrollPosition=function(S,D){var J=D.container,lt=D.getScrollPosition,xt=lt===void 0?pl:lt;return xt({container:_s(J),direction:S})},b._continueDrag=function(S){var D=this,J,lt=S.container,xt=S.direction,_t=S.throttleTime,Wt=S.useScroll,qt=S.isDrag,Jt=S.inputEvent;if(!(!this._flag||qt&&this._isWait)){var Ut=jr(),xe=Math.max(_t+this._prevTime-Ut,0);if(xe>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){D._continueDrag(S)},xe),!1;this._prevTime=Ut;var Ce=this._getScrollPosition(xt,S);this._prevScrollPos=Ce,qt&&(this._isWait=!0),Wt||(this._lock=!0);var Ue={container:_s(lt),direction:xt,inputEvent:Jt};return(J=S.requestScroll)===null||J===void 0||J.call(S,Ue),this.emit("scroll",Ue),this._isWait=!1,Wt||this.checkScroll(Du(Du({},S),{prevScrollPos:Ce,direction:xt,inputEvent:Jt}))}},b._registerScrollEvent=function(S){this._unregisterScrollEvent();var D=S.checkScrollEvent;if(!!D){var J=D===!0?ns:D,lt=_s(S.container);D===!0&&(lt===document.body||lt===document.documentElement)?this._unregister=ns(window,this._onScroll):this._unregister=J(lt,this._onScroll)}},b._unregisterScrollEvent=function(){var S;(S=this._unregister)===null||S===void 0||S.call(this),this._unregister=null},y}(Ks),Au=Bu;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function wu(){for(var m=0,y=0,b=arguments.length;y<b;y++)m+=arguments[y].length;for(var S=Array(m),D=0,y=0;y<b;y++)for(var J=arguments[y],lt=0,xt=J.length;lt<xt;lt++,D++)S[D]=J[lt];return S}function nu(m){return Ht(m,We)}function Tl(m,y){return m.every(function(b,S){return nu(b-y[S])===0})}function xc(m,y){return!nu(m[0]-y[0])&&!nu(m[1]-y[1])}function Sl(m){return m.reduce(function(y,b){return y.push.apply(y,b),y},[])}function ol(m){return m.length<3?0:Math.abs(at(m.map(function(y,b){var S=m[b+1]||m[0];return y[0]*S[1]-S[0]*y[1]})))/2}function ys(m,y){var b=y.width,S=y.height,D=y.left,J=y.top,lt=vl(m),xt=lt.minX,_t=lt.minY,Wt=lt.maxX,qt=lt.maxY,Jt=b/(Wt-xt),Ut=S/(qt-_t);return m.map(function(xe){return[D+(xe[0]-xt)*Jt,J+(xe[1]-_t)*Ut]})}function vl(m){var y=m.map(function(S){return S[0]}),b=m.map(function(S){return S[1]});return{minX:Math.min.apply(Math,y),minY:Math.min.apply(Math,b),maxX:Math.max.apply(Math,y),maxY:Math.max.apply(Math,b)}}function kc(m,y,b){var S=m[0],D=m[1],J=vl(y),lt=J.minX,xt=J.maxX,_t=[[lt,D],[xt,D]],Wt=Ol(_t[0],_t[1]),qt=me(y),Jt=[];if(qt.forEach(function(Ce){var Ue=Ol(Ce[0],Ce[1]),en=Ce[0];if(Tl(Wt,Ue))Jt.push({pos:m,line:Ce,type:"line"});else{var dn=ae(_e(Wt,Ue),[_t,Ce]);dn.forEach(function(Rn){Ce.some(function(nr){return xc(nr,Rn)})?Jt.push({pos:Rn,line:Ce,type:"point"}):nu(en[1]-D)!==0&&Jt.push({pos:Rn,line:Ce,type:"intersection"})})}}),!b&&Cr(Jt,function(Ce){return Ce[0]===S}))return!0;var Ut=0,xe={};return Jt.forEach(function(Ce){var Ue=Ce.pos,en=Ce.type,dn=Ce.line;if(!(Ue[0]>S))if(en==="intersection")++Ut;else{if(en==="line")return;if(en==="point"){var Rn=Cr(dn,function(Sr){return Sr[1]!==D}),nr=xe[Ue[0]],Kn=Rn[1]>D?1:-1;nr?nr!==Kn&&++Ut:xe[Ue[0]]=Kn}}}),Ut%2==1}function Dl(m,y){var b=m[0],S=m[1],D=m[2];return(b*y[0]+S*y[1]+D)/(b*b+S*S)}function Ol(m,y){var b=m[0],S=m[1],D=y[0],J=y[1],lt=D-b,xt=J-S;Math.abs(lt)<We&&(lt=0),Math.abs(xt)<We&&(xt=0);var _t=0,Wt=0,qt=0;return lt?xt?(_t=-xt/lt,Wt=1,qt=-_t*b-S):(Wt=1,qt=-S):xt&&(_t=-1,qt=b),[_t,Wt,qt]}function _e(m,y){var b=m[0],S=m[1],D=m[2],J=y[0],lt=y[1],xt=y[2],_t=b===0&&J===0,Wt=S===0&&lt===0,qt=[];if(_t&&Wt)return[];if(_t){var Jt=-D/S,Ut=-xt/lt;return Jt!==Ut?[]:[[-Infinity,Jt],[Infinity,Jt]]}else if(Wt){var xe=-D/b,Ce=-xt/J;return xe!==Ce?[]:[[xe,-Infinity],[xe,Infinity]]}else if(b===0){var Ue=-D/S,en=-(lt*Ue+xt)/J;qt=[[en,Ue]]}else if(J===0){var Ue=-xt/lt,en=-(S*Ue+D)/b;qt=[[en,Ue]]}else if(S===0){var en=-D/b,Ue=-(J*en+xt)/lt;qt=[[en,Ue]]}else if(lt===0){var en=-xt/J,Ue=-(b*en+D)/S;qt=[[en,Ue]]}else{var en=(S*xt-lt*D)/(lt*b-S*J),Ue=-(b*en+D)/S;qt=[[en,Ue]]}return qt.map(function(dn){return[dn[0],dn[1]]})}function ve(m,y,b){var S=_e(Ol(m[0],m[1]),Ol(y[0],y[1]));return b?ae(S,[m,y]):S}function Bt(m,y){var b=Ol(y[0],y[1]);return nu(Dl(b,m))===0}function ae(m,y){var b=y.map(function(Jt){return[0,1].map(function(Ut){return[Math.min(Jt[0][Ut],Jt[1][Ut]),Math.max(Jt[0][Ut],Jt[1][Ut])]})}),S=[];if(m.length===2){var D=m[0],J=D[0],lt=D[1];if(nu(J-m[1][0])){if(!nu(lt-m[1][1])){var Wt=Math.max.apply(Math,b.map(function(Jt){return Jt[0][0]})),qt=Math.min.apply(Math,b.map(function(Jt){return Jt[0][1]}));if(nu(Wt-qt)>0)return[];S=[[Wt,lt],[qt,lt]]}}else{var xt=Math.max.apply(Math,b.map(function(Jt){return Jt[1][0]})),_t=Math.min.apply(Math,b.map(function(Jt){return Jt[1][1]}));if(nu(xt-_t)>0)return[];S=[[J,xt],[J,_t]]}}return S.length||(S=m.filter(function(Jt){var Ut=Jt[0],xe=Jt[1];return b.every(function(Ce){return 0<=nu(Ut-Ce[0][0])&&0<=nu(Ce[0][1]-Ut)&&0<=nu(xe-Ce[1][0])&&0<=nu(Ce[1][1]-xe)})})),S.map(function(Jt){return[nu(Jt[0]),nu(Jt[1])]})}function me(m){return wu(m.slice(1),[m[0]]).map(function(y,b){return[m[b],y]})}function En(m,y){var b=m.slice(),S=y.slice();$t(b)===-1&&b.reverse(),$t(S)===-1&&S.reverse();var D=me(b),J=me(S),lt=D.map(function(qt){return Ol(qt[0],qt[1])}),xt=J.map(function(qt){return Ol(qt[0],qt[1])}),_t=[];lt.forEach(function(qt,Jt){var Ut=D[Jt],xe=[];xt.forEach(function(Ce,Ue){var en=_e(qt,Ce),dn=ae(en,[Ut,J[Ue]]);xe.push.apply(xe,dn.map(function(Rn){return{index1:Jt,index2:Ue,pos:Rn,type:"intersection"}}))}),xe.sort(function(Ce,Ue){return jt(Ut[0],Ce.pos)-jt(Ut[0],Ue.pos)}),_t.push.apply(_t,xe),kc(Ut[1],S)&&_t.push({index1:Jt,index2:-1,pos:Ut[1],type:"inside"})}),J.forEach(function(qt,Jt){if(!!kc(qt[1],b)){var Ut=!1,xe=Hr(_t,function(Ce){var Ue=Ce.index2;return Ue===Jt?(Ut=!0,!1):!!Ut});xe===-1&&(Ut=!1,xe=Hr(_t,function(Ce){var Ue=Ce.index1,en=Ce.index2;return Ue===-1&&en+1===Jt?(Ut=!0,!1):!!Ut})),xe===-1?_t.push({index1:-1,index2:Jt,pos:qt[1],type:"inside"}):_t.splice(xe,0,{index1:-1,index2:Jt,pos:qt[1],type:"inside"})}});var Wt={};return _t.filter(function(qt){var Jt=qt.pos,Ut=Jt[0]+"x"+Jt[1];return Wt[Ut]?!1:(Wt[Ut]=!0,!0)})}function Zn(m,y){var b=En(m,y);return b.map(function(S){var D=S.pos;return D})}function Kt(m){var y=m[0],b=y.index1,S=y.index2,D=m[1],J=D.index1,lt=D.index2;return b!==-1&&(b===J||b+1===J)||S!==-1&&(S===lt||S+1===lt)}function ge(m,y){var b=En(m,y),S=[],D;return En(m,y).forEach(function(J,lt,xt){lt===0||!Kt([xt[lt-1],J])?(D=[J],S.push(D)):D.push(J)}),S.map(function(J){return J.map(function(lt){var xt=lt.pos;return xt})})}function Ae(m,y,b,S){b===void 0&&(b=0),S===void 0&&(S=[]);for(var D=S.length===0,J=m.length,lt=m[b]?b:0,xt=wu(m.slice(lt),m.slice(0,lt)),_t=function(Jt){var Ut=xt[Jt];if(find(y,function(dn){return dn[0]===Ut[0]&&dn[1]===Ut[1]}))return"continue";if(S.some(function(dn){return find(dn,function(Rn){return Rn[0]===Ut[0]&&Rn[1]===Ut[1]})}))return D?"continue":"break";var xe=void 0;D?(xe=[],S.push(xe)):xe=S[S.length-1],xe.push(Ut);var Ce=[Ut,m[b+1]||m[0]],Ue=y.filter(function(dn){return Bt(dn,Ce)}).sort(function(dn,Rn){return getDist(Ut,dn)-getDist(Ut,Rn)})[0];if(Ue){var en=y.indexOf(Ue);if(Ae(y,m,en,S),!D)return"break"}else return Ae(xt,y,Jt+1,S),"break"},Wt=0;Wt<J;++Wt){var qt=_t(Wt);if(qt==="break")break}return S}function sn(m,y){return Ae(m,wu(y).reverse())}function xn(m,y){if(!y.length)return[wu(m)];var b=ge(m,y),S=[m];return b.forEach(function(D){var J=wu(D).reverse();S=Sl(S.map(function(lt){var xt=Ae(lt,J),_t=xt[0];if(xt.length===1&&J.every(function(Ut){return _t.indexOf(Ut)===-1})){var Wt=_t[_t.length-1],qt=wu(J).sort(function(Ut,xe){return getDist(Wt,Ut)-getDist(Wt,xe)})[0],Jt=J.indexOf(qt);_t.push.apply(_t,wu(J.slice(Jt),J.slice(0,Jt),[J[Jt],Wt]))}return xt}))}),S}function ir(m,y){var b=Zn(m,y);return ol(b)}var $r=$(67294);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Aa=function(m,y){return Aa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,S){b.__proto__=S}||function(b,S){for(var D in S)S.hasOwnProperty(D)&&(b[D]=S[D])},Aa(m,y)};function Va(m,y){Aa(m,y);function b(){this.constructor=m}m.prototype=y===null?Object.create(y):(b.prototype=y.prototype,new b)}var Ba=function(){return Ba=Object.assign||function(y){for(var b,S=1,D=arguments.length;S<D;S++){b=arguments[S];for(var J in b)Object.prototype.hasOwnProperty.call(b,J)&&(y[J]=b[J])}return y},Ba.apply(this,arguments)};function oi(m,y){var b=y[0]-m[0],S=y[1]-m[1],D=Math.atan2(S,b);return D>=0?D:D+Math.PI*2}function ro(m){return oi([m[0].clientX,m[0].clientY],[m[1].clientX,m[1].clientY])/Math.PI*180}function Di(m){return m.touches&&m.touches.length>=2}function Si(m){return m?m.touches?Vo(m.touches):[js(m)]:[]}function _o(m){return m&&(m.type.indexOf("mouse")>-1||"button"in m)}function To(m,y,b){var S=b.length,D=ws(m,S),J=D.clientX,lt=D.clientY,xt=D.originalClientX,_t=D.originalClientY,Wt=ws(y,S),qt=Wt.clientX,Jt=Wt.clientY,Ut=ws(b,S),xe=Ut.clientX,Ce=Ut.clientY,Ue=J-qt,en=lt-Jt,dn=J-xe,Rn=lt-Ce;return{clientX:xt,clientY:_t,deltaX:Ue,deltaY:en,distX:dn,distY:Rn}}function wo(m){return Math.sqrt(Math.pow(m[0].clientX-m[1].clientX,2)+Math.pow(m[0].clientY-m[1].clientY,2))}function Vo(m){for(var y=Math.min(m.length,2),b=[],S=0;S<y;++S)b.push(js(m[S]));return b}function js(m){return{clientX:m.clientX,clientY:m.clientY}}function ws(m,y){y===void 0&&(y=m.length);for(var b={clientX:0,clientY:0,originalClientX:0,originalClientY:0},S=0;S<y;++S){var D=m[S];b.originalClientX+="originalClientX"in D?D.originalClientX:D.clientX,b.originalClientY+="originalClientY"in D?D.originalClientY:D.clientY,b.clientX+=D.clientX,b.clientY+=D.clientY}return y?{clientX:b.clientX/y,clientY:b.clientY/y,originalClientX:b.originalClientX/y,originalClientY:b.originalClientY/y}:b}var ks=function(){function m(y){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=y,this.prevClients=y,this.length=y.length}return m.prototype.getAngle=function(y){return y===void 0&&(y=this.prevClients),ro(y)},m.prototype.getRotation=function(y){return y===void 0&&(y=this.prevClients),ro(y)-ro(this.startClients)},m.prototype.getPosition=function(y,b){y===void 0&&(y=this.prevClients);var S=To(y||this.prevClients,this.prevClients,this.startClients),D=S.deltaX,J=S.deltaY;return this.movement+=Math.sqrt(D*D+J*J),this.prevClients=y,S},m.prototype.getPositions=function(y){y===void 0&&(y=this.prevClients);var b=this.prevClients;return this.startClients.map(function(S,D){return To([y[D]],[b[D]],[S])})},m.prototype.getMovement=function(y){var b=this.movement;if(!y)return b;var S=ws(y,this.length),D=ws(this.prevClients,this.length),J=S.clientX-D.clientX,lt=S.clientY-D.clientY;return Math.sqrt(J*J+lt*lt)+b},m.prototype.getDistance=function(y){return y===void 0&&(y=this.prevClients),wo(y)},m.prototype.getScale=function(y){return y===void 0&&(y=this.prevClients),wo(y)/wo(this.startClients)},m.prototype.move=function(y,b){this.startClients.forEach(function(S){S.clientX-=y,S.clientY-=b}),this.prevClients.forEach(function(S){S.clientX-=y,S.clientY-=b})},m}(),Hs=["textarea","input"],Mu=function(m){Va(y,m);function y(b,S){S===void 0&&(S={});var D=m.call(this)||this;D.options={},D.flag=!1,D.pinchFlag=!1,D.data={},D.isDrag=!1,D.isPinch=!1,D.clientStores=[],D.targets=[],D.prevTime=0,D.doubleFlag=!1,D._useMouse=!1,D._useTouch=!1,D._useDrag=!1,D._dragFlag=!1,D._isTrusted=!1,D._isMouseEvent=!1,D._isSecondaryButton=!1,D._preventMouseEvent=!1,D._prevInputEvent=null,D._isDragAPI=!1,D._isIdle=!0,D._window=window,D.onDragStart=function(Ut,xe){if(xe===void 0&&(xe=!0),!(!D.flag&&Ut.cancelable===!1)){var Ce=Ut.type.indexOf("drag")>=-1;if(!(D.flag&&Ce)){D._isDragAPI=!0;var Ue=D.options,en=Ue.container,dn=Ue.pinchOutside,Rn=Ue.preventWheelClick,nr=Ue.preventRightClick,Kn=Ue.preventDefault,Sr=Ue.checkInput,jn=Ue.dragFocusedInput,pr=Ue.preventClickEventOnDragStart,zr=Ue.preventClickEventOnDrag,Er=Ue.preventClickEventByCondition,oa=D._useTouch,Gr=!D.flag;if(D._isSecondaryButton=Ut.which===3||Ut.button===2,Rn&&(Ut.which===2||Ut.button===1)||nr&&(Ut.which===3||Ut.button===2))return D.stop(),!1;if(Gr){var wa=D._window.document.activeElement,va=Ut.target;if(va){var Ua=va.tagName.toLowerCase(),Ja=Hs.indexOf(Ua)>-1,Li=va.isContentEditable;if(Ja||Li){if(Sr||!jn&&wa===va)return!1;if(wa&&(wa===va||Li&&wa.isContentEditable&&wa.contains(va)))if(jn)va.blur();else return!1}else if((Kn||Ut.type==="touchstart")&&wa){var Zi=wa.tagName.toLowerCase();(wa.isContentEditable||Hs.indexOf(Zi)>-1)&&wa.blur()}(pr||zr||Er)&&si(D._window,"click",D._onClick,!0)}D.clientStores=[new ks(Si(Ut))],D._isIdle=!1,D.flag=!0,D.isDrag=!1,D._isTrusted=xe,D._dragFlag=!0,D._prevInputEvent=Ut,D.data={},D.doubleFlag=jr()-D.prevTime<200,D._isMouseEvent=_o(Ut),!D._isMouseEvent&&D._preventMouseEvent&&(D._preventMouseEvent=!1);var Oi=D._preventMouseEvent||D.emit("dragStart",Ba(Ba({data:D.data,datas:D.data,inputEvent:Ut,isMouseEvent:D._isMouseEvent,isSecondaryButton:D._isSecondaryButton,isTrusted:xe,isDouble:D.doubleFlag},D.getCurrentStore().getPosition()),{preventDefault:function(){Ut.preventDefault()},preventDrag:function(){D._dragFlag=!1}}));Oi===!1&&D.stop(),D._isMouseEvent&&D.flag&&Kn&&Ut.preventDefault()}if(!D.flag)return!1;var li=0;if(Gr?(D._attchDragEvent(),oa&&dn&&(li=setTimeout(function(){si(en,"touchstart",D.onDragStart,{passive:!1})}))):oa&&dn&&Mi(en,"touchstart",D.onDragStart),D.flag&&Di(Ut)){if(clearTimeout(li),Gr&&Ut.touches.length!==Ut.changedTouches.length)return;D.pinchFlag||D.onPinchStart(Ut)}}}},D.onDrag=function(Ut,xe){if(!!D.flag){var Ce=D.options.preventDefault;!D._isMouseEvent&&Ce&&Ut.preventDefault(),D._prevInputEvent=Ut;var Ue=Si(Ut),en=D.moveClients(Ue,Ut,!1);if(D._dragFlag){if(D.pinchFlag||en.deltaX||en.deltaY){var dn=D._preventMouseEvent||D.emit("drag",Ba(Ba({},en),{isScroll:!!xe,inputEvent:Ut}));if(dn===!1){D.stop();return}}D.pinchFlag&&D.onPinch(Ut,Ue)}D.getCurrentStore().getPosition(Ue,!0)}},D.onDragEnd=function(Ut){if(!!D.flag){var xe=D.options,Ce=xe.pinchOutside,Ue=xe.container,en=xe.preventClickEventOnDrag,dn=xe.preventClickEventOnDragStart,Rn=xe.preventClickEventByCondition,nr=D.isDrag;(en||dn||Rn)&&requestAnimationFrame(function(){D._allowClickEvent()}),!Rn&&!dn&&en&&!nr&&D._allowClickEvent(),D._useTouch&&Ce&&Mi(Ue,"touchstart",D.onDragStart),D.pinchFlag&&D.onPinchEnd(Ut);var Kn=(Ut==null?void 0:Ut.touches)?Si(Ut):[],Sr=Kn.length;Sr===0||!D.options.keepDragging?D.flag=!1:D._addStore(new ks(Kn));var jn=D._getPosition(),pr=jr(),zr=!nr&&D.doubleFlag;D._prevInputEvent=null,D.prevTime=nr||zr?0:pr,D.flag||(D._dettachDragEvent(),D._preventMouseEvent||D.emit("dragEnd",Ba({data:D.data,datas:D.data,isDouble:zr,isDrag:nr,isClick:!nr,isMouseEvent:D._isMouseEvent,isSecondaryButton:D._isSecondaryButton,inputEvent:Ut,isTrusted:D._isTrusted},jn)),D.clientStores=[],D._isMouseEvent||(D._preventMouseEvent=!0,requestAnimationFrame(function(){requestAnimationFrame(function(){D._preventMouseEvent=!1})})),D._isIdle=!0)}},D.onBlur=function(){D.onDragEnd()},D._allowClickEvent=function(){Mi(D._window,"click",D._onClick,!0)},D._onClick=function(Ut){D._allowClickEvent(),D._preventMouseEvent=!1;var xe=D.options.preventClickEventByCondition;(xe==null?void 0:xe(Ut))||(Ut.stopPropagation(),Ut.preventDefault())},D._onContextMenu=function(Ut){var xe=D.options;xe.preventRightClick?D.onDragEnd(Ut):Ut.preventDefault()},D._passCallback=function(){};var J=[].concat(b),lt=J[0];D._window=Hn(lt)?lt:hn(lt),D.options=Ba({checkInput:!1,container:lt&&!("document"in lt)?hn(lt):lt,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},S);var xt=D.options,_t=xt.container,Wt=xt.events,qt=xt.checkWindowBlur;if(D._useDrag=Wt.indexOf("drag")>-1,D._useTouch=Wt.indexOf("touch")>-1,D._useMouse=Wt.indexOf("mouse")>-1,D.targets=J,D._useDrag&&J.forEach(function(Ut){si(Ut,"dragstart",D.onDragStart)}),D._useMouse&&(J.forEach(function(Ut){si(Ut,"mousedown",D.onDragStart),si(Ut,"mousemove",D._passCallback)}),si(_t,"contextmenu",D._onContextMenu)),qt&&si(hn(),"blur",D.onBlur),D._useTouch){var Jt={passive:!1};J.forEach(function(Ut){si(Ut,"touchstart",D.onDragStart,Jt),si(Ut,"touchmove",D._passCallback,Jt)})}return D}return y.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},y.prototype.getMovement=function(b){return this.getCurrentStore().getMovement(b)+this.clientStores.slice(1).reduce(function(S,D){return S+D.movement},0)},y.prototype.isDragging=function(){return this.isDrag},y.prototype.isIdle=function(){return this._isIdle},y.prototype.isFlag=function(){return this.flag},y.prototype.isPinchFlag=function(){return this.pinchFlag},y.prototype.isDoubleFlag=function(){return this.doubleFlag},y.prototype.isPinching=function(){return this.isPinch},y.prototype.scrollBy=function(b,S,D,J){J===void 0&&(J=!0),!!this.flag&&(this.clientStores[0].move(b,S),J&&this.onDrag(D,!0))},y.prototype.move=function(b,S){var D=b[0],J=b[1],lt=this.getCurrentStore(),xt=lt.prevClients;return this.moveClients(xt.map(function(_t){var Wt=_t.clientX,qt=_t.clientY;return{clientX:Wt+D,clientY:qt+J,originalClientX:Wt,originalClientY:qt}}),S,!0)},y.prototype.triggerDragStart=function(b){this.onDragStart(b,!1)},y.prototype.setEventData=function(b){var S=this.data;for(var D in b)S[D]=b[D];return this},y.prototype.setEventDatas=function(b){return this.setEventData(b)},y.prototype.getCurrentEvent=function(b){return b===void 0&&(b=this._prevInputEvent),Ba(Ba({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:b})},y.prototype.getEventData=function(){return this.data},y.prototype.getEventDatas=function(){return this.data},y.prototype.unset=function(){var b=this,S=this.targets,D=this.options.container;this.off(),Mi(this._window,"blur",this.onBlur),this._useDrag&&S.forEach(function(J){Mi(J,"dragstart",b.onDragStart)}),this._useMouse&&(S.forEach(function(J){Mi(J,"mousedown",b.onDragStart)}),Mi(D,"contextmenu",this._onContextMenu)),this._useTouch&&(S.forEach(function(J){Mi(J,"touchstart",b.onDragStart)}),Mi(D,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},y.prototype.onPinchStart=function(b){var S=this,D=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>D)){var J=new ks(Si(b));this.pinchFlag=!0,this._addStore(J);var lt=this.emit("pinchStart",Ba(Ba({data:this.data,datas:this.data,angle:J.getAngle(),touches:this.getCurrentStore().getPositions()},J.getPosition()),{inputEvent:b,isTrusted:this._isTrusted,preventDefault:function(){b.preventDefault()},preventDrag:function(){S._dragFlag=!1}}));lt===!1&&(this.pinchFlag=!1)}},y.prototype.onPinch=function(b,S){if(!(!this.flag||!this.pinchFlag||S.length<2)){var D=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Ba(Ba({data:this.data,datas:this.data,movement:this.getMovement(S),angle:D.getAngle(S),rotation:D.getRotation(S),touches:D.getPositions(S),scale:D.getScale(S),distance:D.getDistance(S)},D.getPosition(S)),{inputEvent:b,isTrusted:this._isTrusted}))}},y.prototype.onPinchEnd=function(b){if(!!this.pinchFlag){var S=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var D=this.getCurrentStore();this.emit("pinchEnd",Ba(Ba({data:this.data,datas:this.data,isPinch:S,touches:D.getPositions()},D.getPosition()),{inputEvent:b}))}},y.prototype.getCurrentStore=function(){return this.clientStores[0]},y.prototype.moveClients=function(b,S,D){var J=this._getPosition(b,D),lt=this.isDrag;(J.deltaX||J.deltaY)&&(this.isDrag=!0);var xt=!1;return!lt&&this.isDrag&&(xt=!0),Ba(Ba({data:this.data,datas:this.data},J),{movement:this.getMovement(b),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:S,isTrusted:this._isTrusted,isFirstDrag:xt})},y.prototype._addStore=function(b){this.clientStores.splice(0,0,b)},y.prototype._getPosition=function(b,S){var D=this.getCurrentStore(),J=D.getPosition(b,S),lt=this.clientStores.slice(1).reduce(function(Wt,qt){var Jt=qt.getPosition();return Wt.distX+=Jt.distX,Wt.distY+=Jt.distY,Wt},J),xt=lt.distX,_t=lt.distY;return Ba(Ba({},J),{distX:xt,distY:_t})},y.prototype._attchDragEvent=function(){var b=this._window,S=this.options.container,D={passive:!1};this._isDragAPI&&(si(S,"dragover",this.onDrag,D),si(b,"dragend",this.onDragEnd)),this._useMouse&&(si(S,"mousemove",this.onDrag),si(b,"mouseup",this.onDragEnd)),this._useTouch&&(si(S,"touchmove",this.onDrag,D),si(b,"touchend",this.onDragEnd,D),si(b,"touchcancel",this.onDragEnd,D))},y.prototype._dettachDragEvent=function(){var b=this._window,S=this.options.container;this._isDragAPI&&(Mi(S,"dragover",this.onDrag),Mi(b,"dragend",this.onDragEnd)),this._useMouse&&(Mi(S,"mousemove",this.onDrag),Mi(b,"mouseup",this.onDragEnd)),this._useTouch&&(Mi(S,"touchstart",this.onDragStart),Mi(S,"touchmove",this.onDrag),Mi(b,"touchend",this.onDragEnd),Mi(b,"touchcancel",this.onDragEnd))},y}(Ks);function nl(m){for(var y=5381,b=m.length;b;)y=y*33^m.charCodeAt(--b);return y>>>0}var Cl=nl;function Yl(m){return Cl(m).toString(36)}function sl(m){if(m&&m.getRootNode){var y=m.getRootNode();if(y.nodeType===11)return y}}function rl(m,y,b){return b.original?y:y.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(S,D){var J=D.trim();return(J?Rr(J):[""]).map(function(lt){var xt=lt.trim();return xt.indexOf("@")===0?xt:xt.indexOf(":global")>-1?xt.replace(/\:global/g,""):xt.indexOf(":host")>-1?"".concat(xt.replace(/\:host/g,".".concat(m))):xt?".".concat(m," ").concat(xt):".".concat(m)}).join(", ")+" {"})}function _f(m,y,b,S,D){var J=Pa(S),lt=J.createElement("style");return lt.setAttribute("type","text/css"),lt.setAttribute("data-styled-id",m),lt.setAttribute("data-styled-count","1"),b.nonce&&lt.setAttribute("nonce",b.nonce),lt.innerHTML=rl(m,y,b),(D||J.head||J.body).appendChild(lt),lt}function Dc(m){var y="rCS"+Yl(m);return{className:y,inject:function(b,S){S===void 0&&(S={});var D=sl(b),J=(D||b.ownerDocument||document).querySelector('style[data-styled-id="'.concat(y,'"]'));if(!J)J=_f(y,m,S,b,D);else{var lt=parseFloat(J.getAttribute("data-styled-count"))||0;J.setAttribute("data-styled-count","".concat(lt+1))}return{destroy:function(){var xt,_t=parseFloat(J.getAttribute("data-styled-count"))||0;_t<=1?(J.remove?J.remove():(xt=J.parentNode)===null||xt===void 0||xt.removeChild(J),J=null):J.setAttribute("data-styled-count","".concat(_t-1))}}}}}var wc=Dc,ef=function(m,y){return ef=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,S){b.__proto__=S}||function(b,S){for(var D in S)Object.prototype.hasOwnProperty.call(S,D)&&(b[D]=S[D])},ef(m,y)};function A(m,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");ef(m,y);function b(){this.constructor=m}m.prototype=y===null?Object.create(y):(b.prototype=y.prototype,new b)}var nt=function(){return nt=Object.assign||function(y){for(var b,S=1,D=arguments.length;S<D;S++){b=arguments[S];for(var J in b)Object.prototype.hasOwnProperty.call(b,J)&&(y[J]=b[J])}return y},nt.apply(this,arguments)};function Zt(m,y){var b={};for(var S in m)Object.prototype.hasOwnProperty.call(m,S)&&y.indexOf(S)<0&&(b[S]=m[S]);if(m!=null&&typeof Object.getOwnPropertySymbols=="function")for(var D=0,S=Object.getOwnPropertySymbols(m);D<S.length;D++)y.indexOf(S[D])<0&&Object.prototype.propertyIsEnumerable.call(m,S[D])&&(b[S[D]]=m[S[D]]);return b}var de=function(m){A(y,m);function y(){var S=m!==null&&m.apply(this,arguments)||this;return S.injectResult=null,S.tag="div",S}var b=y.prototype;return b.render=function(){var S=this.props,D=S.className,J=D===void 0?"":D,lt=S.cspNonce,xt=S.portalContainer,_t=Zt(S,["className","cspNonce","portalContainer"]),Wt=this.injector.className,qt=this.tag,Jt={};return($r.version||"").indexOf("simple")>-1&&xt&&(Jt={portalContainer:xt}),(0,$r.createElement)(qt,nt(nt({ref:wt(this,"element"),"data-styled-id":Wt,className:"".concat(J," ").concat(Wt)},Jt),_t))},b.componentDidMount=function(){this.injectResult=this.injector.inject(this.element,{nonce:this.props.cspNonce})},b.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},b.getElement=function(){return this.element},y}($r.Component);function Pe(m,y){var b=cssStyled(y);return function(S){A(D,S);function D(){var J=S!==null&&S.apply(this,arguments)||this;return J.injector=b,J.tag=m,J}return D}(de)}function Qe(m,y){var b=wc(y),S=b.className;return(0,$r.forwardRef)(function(D,J){var lt=D.className,xt=lt===void 0?"":lt,_t=D.cspNonce,Wt=Zt(D,["className","cspNonce"]),qt=(0,$r.useRef)();return(0,$r.useImperativeHandle)(J,function(){return qt.current},[]),(0,$r.useEffect)(function(){var Jt=b.inject(qt.current,{nonce:D.cspNonce});return function(){Jt.destroy()}},[]),(0,$r.createElement)(m,nt({ref:qt,"data-styled-id":S,className:"".concat(xt," ").concat(S)},Wt))})}var rn=null,wn=function(m,y){return wn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,S){b.__proto__=S}||function(b,S){for(var D in S)Object.prototype.hasOwnProperty.call(S,D)&&(b[D]=S[D])},wn(m,y)};function kn(m,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");wn(m,y);function b(){this.constructor=m}m.prototype=y===null?Object.create(y):(b.prototype=y.prototype,new b)}var De=function(){return De=Object.assign||function(y){for(var b,S=1,D=arguments.length;S<D;S++){b=arguments[S];for(var J in b)Object.prototype.hasOwnProperty.call(b,J)&&(y[J]=b[J])}return y},De.apply(this,arguments)};function wr(m,y){var b={};for(var S in m)Object.prototype.hasOwnProperty.call(m,S)&&y.indexOf(S)<0&&(b[S]=m[S]);if(m!=null&&typeof Object.getOwnPropertySymbols=="function")for(var D=0,S=Object.getOwnPropertySymbols(m);D<S.length;D++)y.indexOf(S[D])<0&&Object.prototype.propertyIsEnumerable.call(m,S[D])&&(b[S[D]]=m[S[D]]);return b}function ca(m,y,b,S){var D=arguments.length,J=D<3?y:S===null?S=Object.getOwnPropertyDescriptor(y,b):S,lt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")J=Reflect.decorate(m,y,b,S);else for(var xt=m.length-1;xt>=0;xt--)(lt=m[xt])&&(J=(D<3?lt(J):D>3?lt(y,b,J):lt(y,b))||J);return D>3&&J&&Object.defineProperty(y,b,J),J}function Ar(m,y,b){if(b||arguments.length===2)for(var S=0,D=y.length,J;S<D;S++)(J||!(S in y))&&(J||(J=Array.prototype.slice.call(y,0,S)),J[S]=y[S]);return m.concat(J||Array.prototype.slice.call(y))}function ua(m,y){return De({events:[],props:[],name:m},y)}var $a=["n","w","s","e"],ri=["n","w","s","e","nw","ne","sw","se"];function ba(m,y){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*m,'px" height="').concat(32*m,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(y,'deg);transform-origin: 16px 16px"></path></svg>')}function ki(m){var y=ba(1,m),b=Math.round(m/45)*45%180,S="ns-resize";return b===135?S="nwse-resize":b===45?S="nesw-resize":b===90&&(S="ew-resize"),"cursor:".concat(S,";cursor: url('").concat(y,"') 16 16, ").concat(S,";")}var Eo=ut(),Lo=Eo.browser.webkit,Bo=Lo&&function(){var m=typeof window=="undefined"?{userAgent:""}:window.navigator,y=/applewebkit\/([^\s]+)/g.exec(m.userAgent.toLowerCase());return y?parseFloat(y[1])<605:!1}(),go=Eo.browser.name,Ao=parseInt(Eo.browser.version,10),qu=go==="chrome",zu=Eo.browser.chromium,Uu=parseInt(Eo.browser.chromiumVersion,10)||0,Qu=qu&&Ao>=109||zu&&Uu>=109,Wu=go==="firefox",al=parseInt(Eo.browser.webkitVersion,10)>=612||Ao>=15,Vu="moveable-",ps=ri.map(function(m){var y="",b="",S="center",D="center";return m.indexOf("n")>-1&&(y="top: -20px;",D="bottom"),m.indexOf("s")>-1&&(y="top: 0px;",D="top"),m.indexOf("w")>-1&&(b="left: -20px;",S="right"),m.indexOf("e")>-1&&(b="left: 0px;",S="left"),'.around-control[data-direction*="'.concat(m,`"] {
        `).concat(b).concat(y,`
        transform-origin: `).concat(S," ").concat(D,`;
    }`)}).join(`
`),ru=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: -10px;
top: -10px;
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(ps,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(m){return`
.direction[data-rotation="`.concat(m,'"], :global .view-control-rotation').concat(m,` {
`).concat(ki(m),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(Bo?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),pf=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],Ec=1e-4,Ou=1e-7,Uc=1e-9,Wh=Math.pow(10,10),pp=-Wh,$p={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},sd={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},kd={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},vp=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag"];function $f(m,y,b,S,D,J){var lt,xt;J===void 0&&(J="draggable");var _t=(xt=(lt=y.gestos[J])===null||lt===void 0?void 0:lt.move(b,m.inputEvent))!==null&&xt!==void 0?xt:{},Wt=_t.originalDatas||_t.datas,qt=Wt[J]||(Wt[J]={});return De(De({},D?Wp(y,_t):_t),{isPinch:!!S,parentEvent:!0,datas:qt,originalDatas:m.originalDatas})}var If=function(){function m(b){var S;b===void 0&&(b="draggable"),this.ableName=b,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(S={},S[b]={},S)}var y=m.prototype;return y.dragStart=function(b,S){this.isDrag=!1,this.isFlag=!1;var D=S.originalDatas;return this.datas=D,D[this.ableName]||(D[this.ableName]={}),De(De({},this.move(b,S.inputEvent)),{type:"dragstart"})},y.drag=function(b,S){return this.move([b[0]-this.prevX,b[1]-this.prevY],S)},y.move=function(b,S){var D,J,lt=!1;if(!this.isFlag)this.prevX=b[0],this.prevY=b[1],this.startX=b[0],this.startY=b[1],D=b[0],J=b[1],this.isFlag=!0;else{var xt=this.isDrag;D=this.prevX+b[0],J=this.prevY+b[1],(b[0]||b[1])&&(this.isDrag=!0),!xt&&this.isDrag&&(lt=!0)}return this.prevX=D,this.prevY=J,{type:"drag",clientX:D,clientY:J,inputEvent:S,isFirstDrag:lt,isDrag:this.isDrag,distX:D-this.startX,distY:J-this.startY,deltaX:b[0],deltaY:b[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},m}();function Dd(m,y){var b=y.clientX,S=y.clientY,D=y.datas,J=m.state,lt=J.moveableClientRect,xt=J.rootMatrix,_t=J.is3d,Wt=J.pos1,qt=lt.left,Jt=lt.top,Ut=_t?4:3,xe=gi(bh(xt,[b-qt,S-Jt],Ut),Wt),Ce=xe[0],Ue=xe[1],en=Wc({datas:D,distX:Ce,distY:Ue}),dn=en[0],Rn=en[1];return[dn,Rn]}function eh(m,y){var b=y.datas,S=m.state,D=S.allMatrix,J=S.beforeMatrix,lt=S.is3d,xt=S.left,_t=S.top,Wt=S.origin,qt=S.offsetMatrix,Jt=S.targetMatrix,Ut=S.transformOrigin,xe=lt?4:3;b.is3d=lt,b.matrix=D,b.targetMatrix=Jt,b.beforeMatrix=J,b.offsetMatrix=qt,b.transformOrigin=Ut,b.inverseMatrix=ui(D,xe),b.inverseBeforeMatrix=ui(J,xe),b.absoluteOrigin=bo(wi([xt,_t],Wt),xe),b.startDragBeforeDist=Io(b.inverseBeforeMatrix,b.absoluteOrigin,xe),b.startDragDist=Io(b.inverseMatrix,b.absoluteOrigin,xe)}function Gp(m){return Hh(m.datas.beforeTransform,[50,50],100,100).direction}function Oc(m,y){var b=m.datas,S=m.originalDatas.beforeRenderable,D=b.transformIndex,J=S.nextTransforms,lt=J.length,xt=S.nextTransformAppendedIndexes,_t=-1;D===-1?(y==="translate"?_t=0:y==="rotate"&&(_t=Hr(J,function(Ut){return Ut.match(/scale\(/g)})),_t===-1&&(_t=J.length),b.transformIndex=_t):Cr(xt,function(Ut){return Ut.index===D&&Ut.functionName===y})?_t=D:_t=D+xt.filter(function(Ut){return Ut.index<D}).length;var Wt=Cc(J,_t),qt=Wt.targetFunction,Jt=y==="rotate"?"rotateZ":y;b.beforeFunctionTexts=Wt.beforeFunctionTexts,b.afterFunctionTexts=Wt.afterFunctionTexts,b.beforeTransform=Wt.beforeFunctionMatrix,b.beforeTransform2=Wt.beforeFunctionMatrix2,b.targetTansform=Wt.targetFunctionMatrix,b.afterTransform=Wt.afterFunctionMatrix,b.afterTransform2=Wt.afterFunctionMatrix2,b.targetAllTransform=Wt.allFunctionMatrix,qt.functionName===Jt?(b.afterFunctionTexts.splice(0,1),b.isAppendTransform=!1):lt>_t&&(b.isAppendTransform=!0,S.nextTransformAppendedIndexes=Ar(Ar([],xt,!0),[{functionName:y,index:_t,isAppend:!0}],!1))}function vh(m,y,b){return"".concat(m.beforeFunctionTexts.join(" ")," ").concat(m.isAppendTransform?b:y," ").concat(m.afterFunctionTexts.join(" "))}function Pi(m){var y=m.datas,b=m.distX,S=m.distY,D=cs({datas:y,distX:b,distY:S}),J=D[0],lt=D[1],xt=gh(y,po([J,lt],4));return Io(xt,bo([0,0,0],4),4)}function gh(m,y,b){var S=m.beforeTransform,D=m.afterTransform,J=m.beforeTransform2,lt=m.afterTransform2,xt=m.targetAllTransform,_t=b?Yi(xt,y,4):Yi(y,xt,4),Wt=Yi(ui(b?J:S,4),_t,4),qt=Yi(Wt,ui(b?lt:D,4),4);return qt}function cs(m){var y=m.datas,b=m.distX,S=m.distY,D=y.inverseBeforeMatrix,J=y.is3d,lt=y.startDragBeforeDist,xt=y.absoluteOrigin,_t=J?4:3;return gi(Io(D,wi(xt,[b,S]),_t),lt)}function Wc(m,y){var b=m.datas,S=m.distX,D=m.distY,J=b.inverseBeforeMatrix,lt=b.inverseMatrix,xt=b.is3d,_t=b.startDragBeforeDist,Wt=b.startDragDist,qt=b.absoluteOrigin,Jt=xt?4:3;return gi(Io(y?J:lt,wi(qt,[S,D]),Jt),y?_t:Wt)}function Gf(m,y){var b=m.datas,S=m.distX,D=m.distY,J=b.beforeMatrix,lt=b.matrix,xt=b.is3d,_t=b.startDragBeforeDist,Wt=b.startDragDist,qt=b.absoluteOrigin,Jt=xt?4:3;return gi(Io(y?J:lt,wi(y?_t:Wt,[S,D]),Jt),qt)}function nf(m,y,b,S,D,J){return S===void 0&&(S=y),D===void 0&&(D=b),J===void 0&&(J=[0,0]),m?m.map(function(lt,xt){var _t=ar(lt),Wt=_t.value,qt=_t.unit,Jt=xt?D:S,Ut=xt?b:y;if(lt==="%"||isNaN(Wt)){var xe=Jt?J[xt]/Jt:0;return Ut*xe}else if(qt!=="%")return Wt;return Ut*Wt/100}):J}function rf(m){var y=[];return m[1]>=0&&(m[0]>=0&&y.push(3),m[0]<=0&&y.push(2)),m[1]<=0&&(m[0]>=0&&y.push(1),m[0]<=0&&y.push(0)),y}function Od(m,y){return rf(y).map(function(b){return m[b]})}function Nu(m,y){var b=(y[0]+1)/2,S=(y[1]+1)/2,D=[Ne(m[0][0],m[1][0],b,1-b),Ne(m[0][1],m[1][1],b,1-b)],J=[Ne(m[2][0],m[3][0],b,1-b),Ne(m[2][1],m[3][1],b,1-b)];return[Ne(D[0],J[0],S,1-S),Ne(D[1],J[1],S,1-S)]}function ic(m,y,b,S,D,J){var lt=Fc(y,b,S,D),xt=Nu(lt,J),_t=m[0]-xt[0],Wt=m[1]-xt[1];return[_t,Wt]}function mh(m,y,b,S){return Yi(m,sc(y,S,b),S)}function oc(m,y,b){var S=m.transformOrigin,D=m.offsetMatrix,J=m.is3d,lt=J?4:3,xt;if(Yn(b)){var _t=y.beforeTransform,Wt=y.afterTransform;xt=ts(Yi(Yi(_t,Ys([b]),4),Wt,4),4,lt)}else xt=b;return mh(D,xt,S,lt)}function Ot(m,y){var b=m.transformOrigin,S=m.offsetMatrix,D=m.is3d,J=m.targetMatrix,lt=m.targetAllTransform,xt=D?4:3;return mh(S,Yi(lt||J,ls(y,xt),xt),b,xt)}function ne(m){var y=yr(m);return{setTransform:function(b,S){S===void 0&&(S=-1),y.startTransforms=Rt(b)?b:Da(b),Ke(m,S)},setTransformIndex:function(b){Ke(m,b)}}}function Se(m,y){var b=yr(m),S=b.startTransforms;Ke(m,Hr(S,function(D){return D.indexOf("".concat(y,"("))===0}))}function Ke(m,y){var b=yr(m),S=m.datas;if(S.transformIndex=y,y!==-1){var D=b.startTransforms[y];if(!!D){var J=Ns([D]);S.startValue=J[0].functionValue}}}function yn(m,y){var b=yr(m);b.nextTransforms=Da(y)}function yr(m){return m.originalDatas.beforeRenderable}function Ir(m){var y=m.originalDatas.beforeRenderable;return y.nextTransforms}function la(m){return Ir(m).join(" ")}function Dn(m){return yr(m).nextStyle}function Ga(m,y,b,S,D){yn(D,y);var J=zn.drag(m,$f(D,m.state,b,S,!1)),lt=J?J.transform:y;return De(De({transform:y,drag:J},Ml({transform:lt},D)),{afterTransform:lt})}function xi(m,y,b,S){var D=oc(m.state,S,y),J=rs(m,b,D);return J}function Ui(m,y,b,S,D){var J=xi(m,y,b,D),lt=m.state,xt=lt.left,_t=lt.top,Wt=m.props.groupable,qt=Wt?xt:0,Jt=Wt?_t:0,Ut=gi(S,J);return gi(Ut,[qt,Jt])}function Ii(m,y,b,S,D){var J=Ui(m,"scale(".concat(y.join(", "),")"),b,S,D);return J}function Mo(m,y,b){return[-1+m[0]/(y/2),-1+m[1]/(b/2)]}function rs(m,y,b){b===void 0&&(b=m.state.allMatrix);var S=m.state,D=S.width,J=S.height,lt=S.is3d,xt=lt?4:3,_t=[D/2*(1+y[0]),J/2*(1+y[1])];return Ru(b,_t,xt)}function Xo(m,y,b){var S=b.fixedDirection,D=b.fixedPosition;return Ui(m,"rotate(".concat(y,"deg)"),S,D,b)}function so(m,y,b,S,D,J){var lt=m.props.groupable,xt=m.state,_t=xt.transformOrigin,Wt=xt.offsetMatrix,qt=xt.is3d,Jt=xt.width,Ut=xt.height,xe=xt.left,Ce=xt.top,Ue=J.fixedDirection,en=J.nextTargetMatrix||xt.targetMatrix,dn=qt?4:3,Rn=nf(D,y,b,Jt,Ut,_t),nr=lt?xe:0,Kn=lt?Ce:0,Sr=mh(Wt,en,Rn,dn),jn=ic(S,Sr,y,b,dn,Ue);return gi(jn,[nr,Kn])}function jo(m,y){return Nu(Kl(m.state),y)}function Ci(m,y){var b=m.targetGesto,S=m.controlGesto,D;return(b==null?void 0:b.isFlag())&&(D=b.getEventData()[y]),!D&&(S==null?void 0:S.isFlag())&&(D=S.getEventData()[y]),D||{}}function os(m){if(m&&m.getRootNode){var y=m.getRootNode();if(y.nodeType===11)return y}}function zo(m,y,b){for(var S=m,D=[],J=document.documentElement||document.body,lt=!b&&m===y||m===J,xt=lt,_t=!1,Wt=3,qt,Jt,Ut,xe=!1,Ce=pn(y,y,!0).offsetParent,Ue=1;S&&!xt;){xt=lt;var en=Gs(S),dn=en("position"),Rn=en("scale"),nr=ud(S),Kn=dn==="fixed",Sr=us(Tf(nr)),jn=void 0,pr=!1,zr=!1,Er=0,oa=0,Gr=0,wa=0,va={hasTransform:!1,fixedContainer:null};Kn&&(xe=!0,va=Vh(S),Ce=va.fixedContainer);var Ua=Sr.length;!_t&&Ua===16&&(_t=!0,Wt=4,br(D),Ut&&(Ut=ts(Ut,3,4))),_t&&Ua===9&&(Sr=ts(Sr,3,4));var Ja=nh(S,m),Li=Ja.tagName,Zi=Ja.hasOffset,Oi=Ja.isSVG,li=Ja.origin,ti=Ja.targetOrigin,ao=Ja.offset,$o=ao[0],Oo=ao[1];Li==="svg"&&Ut&&(D.push({type:"target",target:S,matrix:Vc(S,Wt)}),D.push({type:"offset",target:S,matrix:Wi(Wt)}));var Ss=parseFloat(en("zoom"))||1;if(Kn)jn=va.fixedContainer,pr=!0;else{var mo=pn(S,y,!1,!0,en),So=mo.offsetZoom;if(jn=mo.offsetParent,pr=mo.isEnd,zr=mo.isStatic,Ue*=So,(mo.isCustomElement||So!==1)&&zr)$o-=jn.offsetLeft,Oo-=jn.offsetTop;else if(Wu||Qu){var fs=mo.parentSlotElement;if(fs){for(var As=jn,qs=0,Ko=0;As&&os(As);)qs+=As.offsetLeft,Ko+=As.offsetTop,As=As.offsetParent;$o-=qs,Oo-=Ko}}}if(Lo&&!al&&Zi&&!Oi&&zr&&(dn==="relative"||dn==="static")&&($o-=jn.offsetLeft,Oo-=jn.offsetTop,lt=lt||pr),Kn)Zi&&va.hasTransform&&(Gr=jn.clientLeft,wa=jn.clientTop);else if(Zi&&Ce!==jn&&(Er=jn.clientLeft,oa=jn.clientTop),Zi&&jn===J){var Ho=ld(S,!1);$o+=Ho[0],Oo+=Ho[1]}if(D.push({type:"target",target:S,matrix:sc(Sr,Wt,li)}),Rn&&Rn!=="1"&&Rn!=="none"){var Cu=Rn.split(" ").map(function(Pu){return parseFloat(Pu)}),Xs=Cu[0],jl=Cu[1],_u=jl===void 0?Xs:jl,hu=ls([Xs,_u],Wt);D.push({type:"offset",target:S,matrix:Wi(Wt)}),D.push({type:"target",target:S,matrix:sc(hu,Wt,li)})}if(Zi){var yl=S===m,du=yl?0:S.scrollLeft,Us=yl?0:S.scrollTop;D.push({type:"offset",target:S,matrix:is([$o-du+Er-Gr,Oo-Us+oa-wa],Wt)})}else D.push({type:"offset",target:S,origin:li});if(Ss!==1&&D.push({type:"zoom",target:S,matrix:sc(ls([Ss,Ss],Wt),Wt,[0,0])}),Ut||(Ut=Sr),qt||(qt=li),Jt||(Jt=ti),xt||Kn)break;S=jn,lt=pr,(!b||S===J)&&(xt=lt)}return Ut||(Ut=Wi(Wt)),qt||(qt=[0,0]),Jt||(Jt=[0,0]),{zoom:Ue,offsetContainer:Ce,matrixes:D,targetMatrix:Ut,transformOrigin:qt,targetOrigin:Jt,is3d:_t,hasFixed:xe}}var Xi=null,Qo=null,Is=null;function $s(m){m?(window.Map&&(Xi=new Map,Qo=new Map),Is=[]):(Xi=null,Is=null,Qo=null)}function Ts(m){var y=Qo==null?void 0:Qo.get(m);if(y)return y;var b=rh(m,!0);return Qo&&Qo.set(m,b),b}function Ds(m,y){if(Is){var b=Cr(Is,function(D){return D[0][0]==m&&D[0][1]==y});if(b)return b[1]}var S=zo(m,y,!0);return Is&&Is.push([[m,y],S]),S}function Gs(m){var y=Xi==null?void 0:Xi.get(m);if(!y){var b=window.getComputedStyle(m);if(!Xi)return function(J){return b[J]};y={style:b,cached:{}},Xi.set(m,y)}var S=y.cached,D=y.style;return function(J){return J in S||(S[J]=D[J]),S[J]}}function dr(m,y){return[m[0]*y[0],m[1]*y[1]]}function Vi(){for(var m=[],y=0;y<arguments.length;y++)m[y]=arguments[y];return dt.apply(void 0,Ar([Vu],m,!1))}function af(m){m()}function Tf(m){return!m||m==="none"?[1,0,0,1,0,0]:fn(m)?m:Ys(m)}function sc(m,y,b){return Wo(y,is(b,y),m,is(b.map(function(S){return-S}),y))}function Af(m,y,b){if(y==="%"){var S=Lc(m.ownerSVGElement);return S[b?"width":"height"]/100}return 1}function Sc(m){var y=Rd(Bd(m,":before"));return y.map(function(b,S){var D=ar(b),J=D.value,lt=D.unit;return J*Af(m,lt,S===0)})}function _l(m){return m?m.split(" "):["0","0"]}function Rd(m){return _l(m.transformOrigin)}function ud(m){var y=Gs(m),b=y("transform");if(b&&b!=="none")return b;if("transform"in m){var S=m.transform,D=S.baseVal;if(!D)return"";var J=D.length;if(!J)return"";for(var lt=[],xt=function(Wt){var qt=D[Wt].matrix;lt.push("matrix(".concat(["a","b","c","d","e","f"].map(function(Jt){return qt[Jt]}).join(", "),")"))},_t=0;_t<J;++_t)xt(_t);return lt.join(" ")}return""}function pn(m,y,b,S,D){var J,lt,xt=m&&m.ownerDocument?m.ownerDocument:document,_t=xt.documentElement||xt.body,Wt=!1,qt,Jt;if(!m||b)qt=m;else{var Ut=(J=m==null?void 0:m.assignedSlot)===null||J===void 0?void 0:J.parentElement,xe=m.parentElement;Ut?(Wt=!0,Jt=xe,qt=Ut):qt=xe}for(var Ce=!1,Ue=m===y||qt===y,en="relative",dn=1,Rn=parseFloat(D==null?void 0:D("zoom"))||1,nr=D==null?void 0:D("position");qt&&qt!==_t;){y===qt&&(Ue=!0);var Kn=Gs(qt),Sr=qt.tagName.toLowerCase(),jn=ud(qt),pr=Kn("willChange"),zr=parseFloat(Kn("zoom"))||1;if(en=Kn("position"),S&&zr!==1){dn=zr;break}if(!b&&S&&Rn!==1&&nr&&nr!=="absolute"||Sr==="svg"||en!=="static"||jn&&jn!=="none"||pr==="transform")break;var Er=(lt=m==null?void 0:m.assignedSlot)===null||lt===void 0?void 0:lt.parentNode,oa=qt.parentNode;Er&&(Wt=!0,Jt=oa);var Gr=oa;if(Gr&&Gr.nodeType===11){qt=Gr.host,Ce=!0,en=Gs(qt)("position");break}qt=Gr,en="relative"}return{offsetZoom:dn,hasSlot:Wt,parentSlotElement:Jt,isCustomElement:Ce,isStatic:en==="static",isEnd:Ue||!qt||qt===_t,offsetParent:qt||_t}}function nh(m,y){var b,S=m.tagName.toLowerCase(),D=m.offsetLeft,J=m.offsetTop,lt=Gs(m),xt=tn(D),_t=!xt,Wt,qt;return!_t&&S!=="svg"?(Wt=Bo?Sc(m):_l(lt("transformOrigin")).map(function(Jt){return parseFloat(Jt)}),qt=Wt.slice(),_t=!0,b=Pc(m,Wt,m===y&&y.tagName.toLowerCase()==="g"),D=b[0],J=b[1],Wt[0]=b[2],Wt[1]=b[3]):(Wt=_l(lt("transformOrigin")).map(function(Jt){return parseFloat(Jt)}),qt=Wt.slice()),{tagName:S,isSVG:xt,hasOffset:_t,offset:[D||0,J||0],origin:Wt,targetOrigin:qt}}function ld(m,y){var b=Gs(m),S=Gs(document.body),D=S("position");if(!y&&(!D||D==="static"))return[0,0];var J=parseInt(S("marginLeft"),10),lt=parseInt(S("marginTop"),10);return b("position")==="absolute"&&((b("top")!=="auto"||b("bottom")!=="auto")&&(lt=0),(b("left")!=="auto"||b("right")!=="auto")&&(J=0)),[J,lt]}function br(m){m.forEach(function(y){var b=y.matrix;b&&(y.matrix=ts(b,3,4))})}function Vh(m){for(var y=m.parentElement,b=!1;y;){var S=Bd(y).transform;if(S&&S!=="none"){b=!0;break}if(y===document.body)break;y=y.parentElement}return{fixedContainer:y||document.body,hasTransform:b}}function Rc(m,y){return y===void 0&&(y=m.length>9),"".concat(y?"matrix3d":"matrix","(").concat(Do(m,!y).join(","),")")}function Lc(m){var y=m.clientWidth,b=m.clientHeight;if(!m)return{x:0,y:0,width:0,height:0,clientWidth:y,clientHeight:b};var S=m.viewBox,D=S&&S.baseVal||{x:0,y:0,width:0,height:0};return{x:D.x,y:D.y,width:D.width||y,height:D.height||b,clientWidth:y,clientHeight:b}}function Vc(m,y){var b=Lc(m),S=b.width,D=b.height,J=b.clientWidth,lt=b.clientHeight,xt=J/S,_t=lt/D,Wt=m.preserveAspectRatio.baseVal,qt=Wt.align,Jt=Wt.meetOrSlice,Ut=[0,0],xe=[xt,_t],Ce=[0,0];if(qt!==1){var Ue=(qt-2)%3,en=Math.floor((qt-2)/3);Ut[0]=S*Ue/2,Ut[1]=D*en/2;var dn=Jt===2?Math.max(_t,xt):Math.min(xt,_t);xe[0]=dn,xe[1]=dn,Ce[0]=(J-S)/2*Ue,Ce[1]=(lt-D)/2*en}var Rn=ls(xe,y);return Rn[y*(y-1)]=Ce[0],Rn[y*(y-1)+1]=Ce[1],sc(Rn,y,Ut)}function Pc(m,y,b){if(!m.getBBox||!b&&m.tagName.toLowerCase()==="g")return[0,0,0,0];var S=m.getBBox(),D=Lc(m.ownerSVGElement),J=S.x-D.x,lt=S.y-D.y;return[J,lt,y[0]-J,y[1]-lt]}function Ru(m,y,b){return Io(m,bo(y,b),b)}function Fc(m,y,b,S){return[[0,0],[y,0],[0,b],[y,b]].map(function(D){return Ru(m,D,S)})}function Rl(m){var y=m.map(function(Wt){return Wt[0]}),b=m.map(function(Wt){return Wt[1]}),S=Math.min.apply(Math,y),D=Math.min.apply(Math,b),J=Math.max.apply(Math,y),lt=Math.max.apply(Math,b),xt=J-S,_t=lt-D;return{left:S,top:D,right:J,bottom:lt,width:xt,height:_t}}function yh(m,y,b,S){var D=Fc(m,y,b,S);return Rl(D)}function jc(m,y,b,S,D){var J,lt=m.target,xt=m.origin,_t=y.matrix,Wt=gp(lt),qt=Wt.offsetWidth,Jt=Wt.offsetHeight,Ut=b.getBoundingClientRect(),xe=[0,0];b===document.body&&(xe=ld(lt,!0));for(var Ce=lt.getBoundingClientRect(),Ue=Ce.left-Ut.left+b.scrollLeft-(b.clientLeft||0)+xe[0],en=Ce.top-Ut.top+b.scrollTop-(b.clientTop||0)+xe[1],dn=Ce.width,Rn=Ce.height,nr=Wo(S,D,_t),Kn=yh(nr,qt,Jt,S),Sr=Kn.left,jn=Kn.top,pr=Kn.width,zr=Kn.height,Er=Ru(nr,xt,S),oa=gi(Er,[Sr,jn]),Gr=[Ue+oa[0]*dn/pr,en+oa[1]*Rn/zr],wa=[0,0],va=0;++va<10;){var Ua=ui(D,S);J=gi(Ru(Ua,Gr,S),Ru(Ua,Er,S)),wa[0]=J[0],wa[1]=J[1];var Ja=Wo(S,D,is(wa,S),_t),Li=yh(Ja,qt,Jt,S),Zi=Li.left,Oi=Li.top,li=Zi-Ue,ti=Oi-en;if(Math.abs(li)<2&&Math.abs(ti)<2)break;Gr[0]-=li,Gr[1]-=ti}return wa.map(function(ao){return Math.round(ao)})}function jh(m,y,b){var S=m.length===16,D=S?4:3,J=y.map(function(_t){return Ru(m,_t,D)}),lt=b.left,xt=b.top;return J.map(function(_t){return[_t[0]+lt,_t[1]+xt]})}function Hh(m,y,b,S){var D=m.length===16,J=D?4:3,lt=Fc(m,b,S,J),xt=lt[0],_t=xt[0],Wt=xt[1],qt=lt[1],Jt=qt[0],Ut=qt[1],xe=lt[2],Ce=xe[0],Ue=xe[1],en=lt[3],dn=en[0],Rn=en[1],nr=Ru(m,y,J),Kn=nr[0],Sr=nr[1],jn=Math.min(_t,Jt,Ce,dn),pr=Math.min(Wt,Ut,Ue,Rn),zr=Math.max(_t,Jt,Ce,dn),Er=Math.max(Wt,Ut,Ue,Rn);_t=_t-jn||0,Jt=Jt-jn||0,Ce=Ce-jn||0,dn=dn-jn||0,Wt=Wt-pr||0,Ut=Ut-pr||0,Ue=Ue-pr||0,Rn=Rn-pr||0,Kn=Kn-jn||0,Sr=Sr-pr||0;var oa=$t(Fc(m,100,100,J));return{left:jn,top:pr,right:zr,bottom:Er,origin:[Kn,Sr],pos1:[_t,Wt],pos2:[Jt,Ut],pos3:[Ce,Ue],pos4:[dn,Rn],direction:oa}}function Hc(m){return Math.sqrt(m[0]*m[0]+m[1]*m[1])}function Sv(m,y){return Hc([y[0]-m[0],y[1]-m[1]])}function vf(m,y,b,S){b===void 0&&(b=1),S===void 0&&(S=Y(m,y));var D=Sv(m,y);return{transform:"translateY(-50%) translate(".concat(m[0],"px, ").concat(m[1],"px) rotate(").concat(S,"rad) scaleY(").concat(b,")"),width:"".concat(D,"px")}}function Ld(m,y){for(var b=[],S=2;S<arguments.length;S++)b[S-2]=arguments[S];var D=b.length,J=b.reduce(function(xt,_t){return xt+_t[0]},0)/D,lt=b.reduce(function(xt,_t){return xt+_t[1]},0)/D;return{transform:"translateZ(0px) translate(".concat(J,"px, ").concat(lt,"px) rotate(").concat(m,"rad) scale(").concat(y,")")}}function gf(m,y){var b=m[y];return fn(b)?De(De({},m),b):m}function gp(m){var y=m&&!tn(m.offsetWidth),b=0,S=0,D=0,J=0,lt=0,xt=0,_t=0,Wt=0,qt=0,Jt=0,Ut=0,xe=0,Ce=Infinity,Ue=Infinity,en=Infinity,dn=Infinity,Rn=0,nr=0,Kn=!1;if(m)if(!y&&m.tagName.toLowerCase()!=="svg"){var Sr=m.getBBox();Kn=!0,b=Sr.width,S=Sr.height,lt=b,xt=S,_t=b,Wt=S,D=b,J=S}else{var jn=Gs(m),pr=m.style,zr=jn("boxSizing")==="border-box",Er=parseFloat(jn("borderLeftWidth"))||0,oa=parseFloat(jn("borderRightWidth"))||0,Gr=parseFloat(jn("borderTopWidth"))||0,wa=parseFloat(jn("borderBottomWidth"))||0,va=parseFloat(jn("paddingLeft"))||0,Ua=parseFloat(jn("paddingRight"))||0,Ja=parseFloat(jn("paddingTop"))||0,Li=parseFloat(jn("paddingBottom"))||0,Zi=va+Ua,Oi=Ja+Li,li=Er+oa,ti=Gr+wa,ao=Zi+li,$o=Oi+ti,Oo=jn("position"),Ss=0,mo=0;if("clientLeft"in m){var So=null;if(Oo==="absolute"){var fs=pn(m,document.body);So=fs.offsetParent}else So=m.parentElement;if(So){var As=Gs(So);Ss=parseFloat(As("width")),mo=parseFloat(As("height"))}}qt=Math.max(Zi,_n(jn("minWidth"),Ss)||0),Jt=Math.max(Oi,_n(jn("minHeight"),mo)||0),Ce=_n(jn("maxWidth"),Ss),Ue=_n(jn("maxHeight"),mo),isNaN(Ce)&&(Ce=Infinity),isNaN(Ue)&&(Ue=Infinity),Rn=_n(pr.width,0)||0,nr=_n(pr.height,0)||0,lt=parseFloat(jn("width"))||0,xt=parseFloat(jn("height"))||0,_t=Math.abs(lt-Rn)<1?an(qt,Rn||lt,Ce):lt,Wt=Math.abs(xt-nr)<1?an(Jt,nr||xt,Ue):xt,b=_t,S=Wt,D=_t,J=Wt,zr?(en=Ce,dn=Ue,Ut=qt,xe=Jt,_t=b-ao,Wt=S-$o):(en=Ce+ao,dn=Ue+$o,Ut=qt+ao,xe=Jt+$o,b=_t+ao,S=Wt+$o),D=_t+Zi,J=Wt+Oi}return{svg:Kn,offsetWidth:b,offsetHeight:S,clientWidth:D,clientHeight:J,contentWidth:_t,contentHeight:Wt,inlineCSSWidth:Rn,inlineCSSHeight:nr,cssWidth:lt,cssHeight:xt,minWidth:qt,minHeight:Jt,maxWidth:Ce,maxHeight:Ue,minOffsetWidth:Ut,minOffsetHeight:xe,maxOffsetWidth:en,maxOffsetHeight:dn}}function mp(m,y){return Y(y>0?m[0]:m[1],y>0?m[1]:m[0])}function Pd(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function yp(m,y){var b=m===document.body||m===document.documentElement,S={clientLeft:m.clientLeft,clientTop:m.clientTop,clientWidth:m.clientWidth,clientHeight:m.clientHeight,scrollWidth:m.scrollWidth,scrollHeight:m.scrollHeight,overflow:!1};return b&&(S.clientHeight=Math.max(y.height,S.clientHeight),S.scrollHeight=Math.max(y.height,S.scrollHeight)),S.overflow=Gs(m)("overflow")!=="visible",De(De({},y),S)}function il(m,y,b,S){var D=m.left,J=m.right,lt=m.top,xt=m.bottom,_t=y.top,Wt=y.left,qt={left:Wt+D,top:_t+lt,right:Wt+J,bottom:_t+xt,width:J-D,height:xt-lt};return b&&S?yp(b,qt):qt}function rh(m,y){var b=0,S=0,D=0,J=0;if(m){var lt=m.getBoundingClientRect();b=lt.left,S=lt.top,D=lt.width,J=lt.height}var xt={left:b,top:S,width:D,height:J,right:b+D,bottom:S+J};return m&&y?yp(m,xt):xt}function Up(m,y,b,S){var D;if(m)D=m;else if(y)D=[0,0];else{var J=b.target;D=Xh(J,S)}return D}function Xh(m,y){if(!!m){var b=m.getAttribute("data-rotation")||"",S=m.getAttribute("data-direction");if(y.deg=b,!!S){var D=[0,0];return S.indexOf("w")>-1&&(D[0]=-1),S.indexOf("e")>-1&&(D[0]=1),S.indexOf("n")>-1&&(D[1]=-1),S.indexOf("s")>-1&&(D[1]=1),D}}}function Fd(m,y){return[wi(y,m[0]),wi(y,m[1]),wi(y,m[2]),wi(y,m[3])]}function Kl(m){var y=m.left,b=m.top,S=m.pos1,D=m.pos2,J=m.pos3,lt=m.pos4;return Fd([S,D,J,lt],[y,b])}function Al(m,y){var b;(b=m[y])===null||b===void 0||b.unset(),m[y]=null}function Ml(m,y){if(y){var b=yr(y);b.nextStyle=De(De({},b.nextStyle),m)}return{style:m,cssText:ta(m).map(function(S){return"".concat(tr(S,"-"),": ").concat(m[S],";")}).join("")}}function ah(m,y,b){var S=y.afterTransform||y.transform;return De(De({},Ml(De(De(De({},m.style),y.style),{transform:S}),b)),{afterTransform:S,transform:m.transform})}function Os(m,y,b,S){var D=y.datas;D.datas||(D.datas={});var J=De(De({},b),{target:m.state.target,clientX:y.clientX,clientY:y.clientY,inputEvent:y.inputEvent,currentTarget:m,moveable:m,datas:D.datas,isFirstDrag:!!y.isFirstDrag,isTrusted:y.isTrusted!==!1,stopAble:function(){D.isEventStart=!1},stopDrag:function(){var lt;(lt=y.stop)===null||lt===void 0||lt.call(y)}});return D.isStartEvent?S||(D.lastEvent=J):D.isStartEvent=!0,J}function Ll(m,y,b){var S=y.datas,D="isDrag"in b?b.isDrag:y.isDrag;return S.datas||(S.datas={}),De(De({isDrag:D},b),{moveable:m,target:m.state.target,clientX:y.clientX,clientY:y.clientY,inputEvent:y.inputEvent,currentTarget:m,lastEvent:S.lastEvent,isDouble:y.isDouble,datas:S.datas,isFirstDrag:!!y.isFirstDrag})}function of(m,y,b){m._emitter.on(y,b)}function Sn(m,y,b,S){return m.triggerEvent(y,b,S)}function Bd(m,y){return window.getComputedStyle(m,y)}function ih(m,y,b){var S={},D={};return m.filter(function(J){var lt=J.name;if(S[lt]||!y.some(function(xt){return J[xt]}))return!1;if(!b&&J.ableGroup){if(D[J.ableGroup])return!1;D[J.ableGroup]=!0}return S[lt]=!0,!0})}function zd(m,y){return m===y||m==null&&y==null}function Mf(){for(var m=[],y=0;y<arguments.length;y++)m[y]=arguments[y];for(var b=m.length-1,S=0;S<b;++S){var D=m[S];if(!tn(D))return D}return m[b]}function sf(m,y){var b=[],S=[];return m.forEach(function(D,J){var lt=y(D,J,m),xt=S.indexOf(lt),_t=b[xt]||[];xt===-1&&(S.push(lt),b.push(_t)),_t.push(D)}),b}function Uf(m,y){var b=[],S={};return m.forEach(function(D,J){var lt=y(D,J,m),xt=S[lt];xt||(xt=[],S[lt]=xt,b.push(xt)),xt.push(D)}),b}function $d(m){return m.reduce(function(y,b){return y.concat(b)},[])}function Wf(){for(var m=[],y=0;y<arguments.length;y++)m[y]=arguments[y];return m.sort(function(b,S){return Math.abs(S)-Math.abs(b)}),m[0]}function bh(m,y,b){return Io(ui(m,b),bo(y,b),b)}function Wp(m,y){var b,S=m.is3d,D=m.rootMatrix,J=S?4:3;return b=bh(D,[y.distX,y.distY],J),y.distX=b[0],y.distY=b[1],y}function xh(m,y,b,S,D){return gi(Ru(m,wi(b,y),D),S)}function ju(m,y,b){return b?"".concat(m/y*100,"%"):"".concat(m,"px")}function oh(m){return Math.abs(m)<=Ou?0:m}function bp(m){return function(y){if(!y.isDragging(m))return"";var b=Ci(y,m),S=b.deg;return S?Vi("view-control-rotation".concat(S)):""}}function cd(m,y){return y===void 0&&(y=[m]),function(b,S){if(S.isRequest)return y.some(function(J){return S.requestAble===J})?S.parentDirection:!1;var D=S.inputEvent.target;return ha(D,Vi("direction"))&&(!m||ha(D,Vi(m)))}}function Cc(m,y){var b=m.slice(0,y<0?void 0:y),S=m.slice(0,y<0?void 0:y+1),D=m[y]||"",J=y<0?[]:m.slice(y),lt=y<0?[]:m.slice(y+1),xt=Ns(b),_t=Ns(S),Wt=Ns([D]),qt=Ns(J),Jt=Ns(lt),Ut=Ro(xt),xe=Ro(_t),Ce=Ro(qt),Ue=Ro(Jt),en=Yi(Ut,Ce,4);return{transforms:m,beforeFunctionMatrix:Ut,beforeFunctionMatrix2:xe,targetFunctionMatrix:Ro(Wt),afterFunctionMatrix:Ce,afterFunctionMatrix2:Ue,allFunctionMatrix:en,beforeFunctions:xt,beforeFunctions2:_t,targetFunction:Wt[0],afterFunctions:qt,afterFunctions2:Jt,beforeFunctionTexts:b,beforeFunctionTexts2:S,targetFunctionText:D,afterFunctionTexts:J,afterFunctionTexts2:lt}}function Yh(m){return!m||!fn(m)||m instanceof Element?!1:Rt(m)||"length"in m}function uf(m,y){return m?m instanceof Element?m:Yn(m)?y?document.querySelector(m):m:xr(m)?m():"current"in m?m.current:m:null}function wh(m,y){if(!m)return[];var b=Yh(m)?[].slice.call(m):[m];return b.reduce(function(S,D){return Yn(D)&&y?Ar(Ar([],S,!0),[].slice.call(document.querySelectorAll(D)),!0):(Rt(D)?S.push(wh(D,y)):S.push(uf(D,y)),S)},[])}function sh(m,y,b){var S=Y(m,y)/Math.PI*180;return S=b>=0?S:180-S,S=S>=0?S:360+S,S}function Pl(m,y){var b=m.rootMatrix,S=m.is3d,D=S?4:3,J=ui(b,D);return S||(J=ts(J,3,4)),J[12]=0,J[13]=0,J[14]=0,Ku(J,y)}function Nf(m,y,b,S,D){var J=m[0],lt=m[1],xt=0,_t=0;if(D&&J&&lt){var Wt=Y([0,0],y),qt=Y([0,0],S),Jt=Hc(y),Ut=Math.cos(Wt-qt)*Jt;if(!S[0])_t=Ut,xt=_t*b;else if(!S[1])xt=Ut,_t=xt/b;else{var xe=S[0]*J,Ce=S[1]*lt,Ue=Math.atan2(xe+y[0],Ce+y[1]),en=Math.atan2(xe,Ce);Ue<0&&(Ue+=Math.PI*2),en<0&&(en+=Math.PI*2);var dn=0;Math.abs(Ue-en)<Math.PI/2||Math.abs(Ue-en)>Math.PI/2*3||(en+=Math.PI),dn=Ue-en,dn>Math.PI*2?dn-=Math.PI*2:dn>Math.PI?dn=2*Math.PI-dn:dn<-Math.PI&&(dn=-2*Math.PI-dn);var Rn=Hc([xe+y[0],Ce+y[1]])*Math.cos(dn);xt=Rn*Math.sin(en)-xe,_t=Rn*Math.cos(en)-Ce,S[0]<0&&(xt*=-1),S[1]<0&&(_t*=-1)}}else xt=S[0]*y[0],_t=S[1]*y[1];return[xt,_t]}function Eh(m,y,b,S){var D,J=b.ratio,lt=b.startOffsetWidth,xt=b.startOffsetHeight,_t=0,Wt=0,qt=S.distX,Jt=S.distY,Ut=S.pinchScale,xe=S.parentDistance,Ce=S.parentDist,Ue=S.parentScale,en=b.fixedDirection,dn=[0,1].map(function(pr){return Math.abs(m[pr]-en[pr])}),Rn=[0,1].map(function(pr){var zr=dn[pr];return zr!==0&&(zr=2/zr),zr});if(Ce)_t=Ce[0],Wt=Ce[1],y&&(_t?Wt||(Wt=_t/J):_t=Wt*J);else if(Un(Ut))_t=(Ut-1)*lt,Wt=(Ut-1)*xt;else if(Ue)_t=(Ue[0]-1)*lt,Wt=(Ue[1]-1)*xt;else if(xe){var nr=lt*dn[0],Kn=xt*dn[1],Sr=Hc([nr,Kn]);_t=xe/Sr*nr*Rn[0],Wt=xe/Sr*Kn*Rn[1]}else{var jn=Wc({datas:b,distX:qt,distY:Jt});jn=Rn.map(function(pr,zr){return jn[zr]*pr}),D=Nf([lt,xt],jn,J,m,y),_t=D[0],Wt=D[1]}return{distWidth:_t,distHeight:Wt}}function fd(m,y){if(y){if(m==="left")return{x:"0%",y:"50%"};if(m==="top")return{x:"50%",y:"50%"};if(m==="center")return{x:"50%",y:"50%"};if(m==="right")return{x:"100%",y:"50%"};if(m==="bottom")return{x:"50%",y:"100%"};var b=m.split(" "),S=b[0],D=b[1],J=fd(S||""),lt=fd(D||""),xt=De(De({},J),lt),_t={x:"50%",y:"50%"};return xt.x&&(_t.x=xt.x),xt.y&&(_t.y=xt.y),xt.value&&(xt.x&&!xt.y&&(_t.y=xt.value),!xt.x&&xt.y&&(_t.x=xt.value)),_t}return m==="left"?{x:"0%"}:m==="right"?{x:"100%"}:m==="top"?{y:"0%"}:m==="bottom"?{y:"100%"}:m?m==="center"?{value:"50%"}:{value:m}:{}}function Vp(m,y,b){var S=fd(m,!0),D=S.x,J=S.y;return[_n(D,y)||0,_n(J,b)||0]}function hd(m,y,b){var S=m.map(function(J){return gi(J,y)}),D=S.map(function(J){return yu(J,b)});return{prev:S,next:D,result:D.map(function(J){return wi(J,y)})}}function jp(m,y){return m.length===y.length&&m.every(function(b,S){var D=y[S],J=Rt(b),lt=Rt(D);return J&&lt?jp(b,D):!J&&!lt?b===D:!1})}function Gd(m,y,b,S){var D=m[y];return y in m&&(D===b||S(D)===S(b))?D:(m[y]=b,b)}var Kh=ua("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(m,y){var b=y.datas,S=y.targets,D=y.angle,J=y.originalDatas,lt=m.props,xt=lt.pinchable,_t=lt.ables;if(!xt)return!1;var Wt="onPinch".concat(S?"Group":"","Start"),qt="drag".concat(S?"Group":"","ControlStart"),Jt=(xt===!0?m.controlAbles:_t.filter(function(Ue){return xt.indexOf(Ue.name)>-1})).filter(function(Ue){return Ue.canPinch&&Ue[qt]}),Ut=Os(m,y,{});S&&(Ut.targets=S);var xe=Sn(m,Wt,Ut);b.isPinch=xe!==!1,b.ables=Jt;var Ce=b.isPinch;return Ce?(Jt.forEach(function(Ue){if(J[Ue.name]=J[Ue.name]||{},!!Ue[qt]){var en=De(De({},y),{datas:J[Ue.name],parentRotate:D,isPinch:!0});Ue[qt](m,en)}}),m.state.snapRenderInfo={request:y.isRequest,direction:[0,0]},Ce):!1},pinch:function(m,y){var b=y.datas,S=y.scale,D=y.distance,J=y.originalDatas,lt=y.inputEvent,xt=y.targets,_t=y.angle;if(!!b.isPinch){var Wt=D*(1-1/S),qt=Os(m,y,{});xt&&(qt.targets=xt);var Jt="onPinch".concat(xt?"Group":"");Sn(m,Jt,qt);var Ut=b.ables,xe="drag".concat(xt?"Group":"","Control");return Ut.forEach(function(Ce){!Ce[xe]||Ce[xe](m,De(De({},y),{datas:J[Ce.name],inputEvent:lt,resolveMatrix:!0,pinchScale:S,parentDistance:Wt,parentRotate:_t,isPinch:!0}))}),qt}},pinchEnd:function(m,y){var b=y.datas,S=y.isPinch,D=y.inputEvent,J=y.targets,lt=y.originalDatas;if(!!b.isPinch){var xt="onPinch".concat(J?"Group":"","End"),_t=Ll(m,y,{isDrag:S});J&&(_t.targets=J),Sn(m,xt,_t);var Wt=b.ables,qt="drag".concat(J?"Group":"","ControlEnd");return Wt.forEach(function(Jt){!Jt[qt]||Jt[qt](m,De(De({},y),{isDrag:S,datas:lt[Jt.name],inputEvent:D,isPinch:!0}))}),S}},pinchGroupStart:function(m,y){return this.pinchStart(m,De(De({},y),{targets:m.props.targets}))},pinchGroup:function(m,y){return this.pinch(m,De(De({},y),{targets:m.props.targets}))},pinchGroupEnd:function(m,y){return this.pinchEnd(m,De(De({},y),{targets:m.props.targets}))}});function Fl(m,y,b){var S=b.originalDatas;S.groupable=S.groupable||{};var D=S.groupable;D.childDatas=D.childDatas||[];var J=D.childDatas;return m.moveables.map(function(lt,xt){return J[xt]=J[xt]||{},J[xt][y]=J[xt][y]||{},De(De({},b),{datas:J[xt][y],originalDatas:J[xt]})})}function uh(m,y,b,S,D,J,lt){var xt=!!b.match(/Start$/g),_t=!!b.match(/End$/g),Wt=D.isPinch,qt=D.datas,Jt=Fl(m,y.name,D),Ut=m.moveables,xe=Jt.map(function(Ce,Ue){var en=Ut[Ue],dn=en.state,Rn=dn.gestos,nr=Ce;if(xt)nr=new If(lt).dragStart(S,Ce);else{if(Rn[lt]||(Rn[lt]=qt.childGestos[Ue]),!Rn[lt])return;nr=$f(Ce,dn,S,Wt,J,lt)}var Kn=y[b](en,De(De({},nr),{parentFlag:!0}));return _t&&(Rn[lt]=null),Kn});return xt&&(qt.childGestos=Ut.map(function(Ce){return Ce.state.gestos[lt]})),xe}function Sh(m,y,b,S,D,J){D===void 0&&(D=function(qt,Jt){return Jt});var lt=!!b.match(/End$/g),xt=Fl(m,y.name,S),_t=m.moveables,Wt=xt.map(function(qt,Jt){var Ut=_t[Jt],xe=qt;xe=D(Ut,qt);var Ce=y[b](Ut,De(De({},xe),{parentFlag:!0}));return Ce&&J&&J(Ut,qt,Ce,Jt),lt&&(Ut.state.gestos={}),Ce});return Wt}function Ch(m,y,b,S){var D=b.fixedDirection,J=b.fixedPosition,lt=S.datas.startPositions||Kl(y.state),xt=Nu(lt,D),_t=Io(qo(-m.rotation/180*Math.PI,3),[xt[0]-J[0],xt[1]-J[1],1],3),Wt=_t[0],qt=_t[1];return S.datas.originalX=Wt,S.datas.originalY=qt,S}var ng=["left","right","center"],Cv=["top","bottom","middle"],vs={start:"left",end:"right",center:"center"},Xc={start:"top",end:"bottom",center:"middle"};function eo(m,y){var b=m.props,S=b.snappable,D=b.bounds,J=b.innerBounds,lt=b.verticalGuidelines,xt=b.horizontalGuidelines,_t=b.snapGridWidth,Wt=b.snapGridHeight,qt=m.state,Jt=qt.guidelines,Ut=qt.enableSnap;return!S||!Ut||y&&S!==!0&&S.indexOf(y)<0?!1:!!(_t||Wt||D||J||Jt&&Jt.length||lt&&lt.length||xt&&xt.length)}function Hp(m){return m===!1?{}:m===!0||!m?{left:!0,right:!0,top:!0,bottom:!0}:m}function _h(m,y){var b=Hp(m),S={};for(var D in b)D in y&&b[D]&&(S[D]=y[D]);return S}function dd(m,y){var b=_h(m,y),S=Cv.filter(function(J){return J in b}),D=ng.filter(function(J){return J in b});return{horizontal:S.map(function(J){return b[J]}),vertical:D.map(function(J){return b[J]})}}function _g(m,y,b){var S=Ru(m,[y.clientLeft,y.clientTop],b);return[y.left+S[0],y.top+S[1]]}function Ig(m){var y=m[0],b=m[1],S=b[0]-y[0],D=b[1]-y[1];Math.abs(S)<We&&(S=0),Math.abs(D)<We&&(D=0);var J=0,lt=0,xt=0;return S?D?(J=-D/S,lt=1,xt=J*y[0]-y[1]):(lt=1,xt=-y[1]):(J=-1,xt=y[0]),[J,lt,xt].map(function(_t){return Ht(_t,We)})}function Ud(m,y,b,S){var D=m.props,J=Mf(S,D.snapThreshold,5);return Xp(m.state.guidelines,y,b,J)}function Xp(m,y,b,S){return{vertical:Kp(m,"vertical",y,S),horizontal:Kp(m,"horizontal",b,S)}}function _v(m,y,b){var S=b[0],D=b[1],J=y[0],lt=y[1],xt=gi(b,y),_t=xt[0],Wt=xt[1],qt=Wt>0,Jt=_t>0;_t=oh(_t),Wt=oh(Wt);var Ut={isSnap:!1,offset:0,pos:0},xe={isSnap:!1,offset:0,pos:0};if(_t===0&&Wt===0)return{vertical:Ut,horizontal:xe};var Ce=Ud(m,_t?[S]:[],Wt?[D]:[]),Ue=Ce.vertical,en=Ce.horizontal;Ue.posInfos.filter(function(Ua){var Ja=Ua.pos;return Jt?Ja>=J:Ja<=J}),en.posInfos.filter(function(Ua){var Ja=Ua.pos;return qt?Ja>=lt:Ja<=lt}),Ue.isSnap=Ue.posInfos.length>0,en.isSnap=en.posInfos.length>0;var dn=Yp(Ue),Rn=dn.isSnap,nr=dn.guideline,Kn=Yp(en),Sr=Kn.isSnap,jn=Kn.guideline,pr=Sr?jn.pos[1]:0,zr=Rn?nr.pos[0]:0;if(_t===0)Sr&&(xe.isSnap=!0,xe.pos=jn.pos[1],xe.offset=D-xe.pos);else if(Wt===0)Rn&&(Ut.isSnap=!0,Ut.pos=zr,Ut.offset=S-zr);else{var Er=Wt/_t,oa=b[1]-Er*S,Gr=0,wa=0,va=!1;Rn?(wa=zr,Gr=Er*wa+oa,va=!0):Sr&&(Gr=pr,wa=(Gr-oa)/Er,va=!0),va&&(Ut.isSnap=!0,Ut.pos=wa,Ut.offset=S-wa,xe.isSnap=!0,xe.pos=Gr,xe.offset=D-Gr)}return{vertical:Ut,horizontal:xe}}function Ih(m,y,b){var S=dd(m.props.snapDirections,y);return Ud(m,S.vertical,S.horizontal,b)}function Yp(m){var y=m.isSnap;if(!y)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var b=m.posInfos[0],S=b.guidelineInfos[0],D=S.offset,J=S.dist,lt=S.guideline;return{isSnap:y,offset:D,dist:J,pos:b.pos,guideline:lt}}function Kp(m,y,b,S){if(!m||!m.length)return{isSnap:!1,index:-1,posInfos:[]};var D=y==="vertical",J=D?0:1,lt=b.map(function(_t,Wt){var qt=m.map(function(Jt){var Ut=Jt.pos,xe=_t-Ut[J];return{offset:xe,dist:Math.abs(xe),guideline:Jt}}).filter(function(Jt){var Ut=Jt.guideline,xe=Jt.dist,Ce=Ut.type;return!(Ce!==y||xe>S)}).sort(function(Jt,Ut){return Jt.dist-Ut.dist});return{pos:_t,index:Wt,guidelineInfos:qt}}).filter(function(_t){return _t.guidelineInfos.length>0}).sort(function(_t,Wt){return _t.guidelineInfos[0].dist-Wt.guidelineInfos[0].dist}),xt=lt.length>0;return{isSnap:xt,index:xt?lt[0].index:-1,posInfos:lt}}function Th(m,y,b,S){S===void 0&&(S=1);var D=[];if(b[0]&&b[1])D=[b,[-b[0],b[1]],[b[0],-b[1]]].map(function(xt){return Nu(y,xt)});else if(!b[0]&&!b[1])for(var J=[y[0],y[1],y[3],y[2],y[0]],lt=0;lt<4;++lt)D.push(J[lt]),D.push([(J[lt][0]+J[lt+1][0])/2,(J[lt][1]+J[lt+1][1])/2]);else m.props.keepRatio?D=[[-1,-1],[-1,1],[1,-1],[1,1],b].map(function(xt){return Nu(y,xt)}):(D=Od(y,b),D.length>1&&D.push([(D[0][0]+D[1][0])/2,(D[0][1]+D[1][1])/2]));return Ud(m,D.map(function(xt){return xt[0]}),D.map(function(xt){return xt[1]}),S)}function Zp(m,y){var b=Math.abs(m.offset),S=Math.abs(y.offset);return m.isBound&&y.isBound?S-b:m.isBound?-1:y.isBound?1:m.isSnap&&y.isSnap?S-b:m.isSnap?-1:y.isSnap||b<Ou?1:S<Ou?-1:b-S}function Ah(m,y){return m.slice().sort(function(b,S){var D=b.sign[y],J=S.sign[y],lt=b.offset[y],xt=S.offset[y];if(D){if(!J)return-1}else return 1;return Zp({isBound:b.isBound,isSnap:b.isSnap,offset:lt},{isBound:S.isBound,isSnap:S.isSnap,offset:xt})})[0]}function Wd(m,y,b){var S=[];if(b)Math.abs(y[0])!==1||Math.abs(y[1])!==1?S.push([y,[-1,-1]],[y,[-1,1]],[y,[1,-1]],[y,[1,1]]):S.push([y,[m[0],-m[1]]],[y,[-m[0],m[1]]]),S.push([y,m]);else if(m[0]&&m[1]||!m[0]&&!m[1]){var D=m[0]?m:[1,1];[1,-1].forEach(function(lt){[1,-1].forEach(function(xt){var _t=[lt*D[0],xt*D[1]];y[0]===_t[0]&&y[1]===_t[1]||S.push([y,_t])})})}else if(m[0]){var J=Math.abs(y[0])===1?[1]:[1,-1];J.forEach(function(lt){S.push([[y[0],-1],[lt*m[0],-1]],[[y[0],0],[lt*m[0],0]],[[y[0],1],[lt*m[0],1]])})}else if(m[1]){var J=Math.abs(y[1])===1?[1]:[1,-1];J.forEach(function(xt){S.push([[-1,y[1]],[-1,xt*m[1]]],[[0,y[1]],[0,xt*m[1]]],[[1,y[1]],[1,xt*m[1]]])})}return S}function Vd(m,y){var b=H([y[0][0],y[1][0]]),S=H([y[0][1],y[1][1]]);return{vertical:b<=m[0],horizontal:S<=m[1]}}function pd(m,y){var b=y[0],S=y[1],D=S[0]-b[0],J=S[1]-b[1];Math.abs(D)<Ou&&(D=0),Math.abs(J)<Ou&&(J=0);var lt,xt;if(!D)lt=b[0],xt=m[0];else if(!J)lt=b[1],xt=m[1];else{var _t=J/D;lt=_t*(m[0]-b[0])+b[1],xt=m[1]}return lt-xt}function xp(m,y,b,S){return S===void 0&&(S=Ou),m.every(function(D){var J=pd(D,y),lt=J<=0;return lt===b||Math.abs(J)<=S})}function vd(m,y,b,S,D){return D===void 0&&(D=0),S&&y-D<=m||!S&&m<=b+D?{isBound:!0,offset:S?y-m:b-m}:{isBound:!1,offset:0}}function jd(m,y){var b=y.line,S=y.centerSign,D=y.verticalSign,J=y.horizontalSign,lt=y.lineConstants,xt=m.props.innerBounds;if(!xt)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var _t=xt.left,Wt=xt.top,qt=xt.width,Jt=xt.height,Ut=[[_t,Wt],[_t,Wt+Jt]],xe=[[_t,Wt],[_t+qt,Wt]],Ce=[[_t+qt,Wt],[_t+qt,Wt+Jt]],Ue=[[_t,Wt+Jt],[_t+qt,Wt+Jt]];if(xp([[_t,Wt],[_t+qt,Wt],[_t,Wt+Jt],[_t+qt,Wt+Jt]],b,S))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var en=kf(b,lt,xe,D),dn=kf(b,lt,Ue,D),Rn=kf(b,lt,Ut,J),nr=kf(b,lt,Ce,J),Kn=en.isBound&&dn.isBound,Sr=en.isBound||dn.isBound,jn=Rn.isBound&&nr.isBound,pr=Rn.isBound||nr.isBound,zr=Wf(en.offset,dn.offset),Er=Wf(Rn.offset,nr.offset),oa=[0,0],Gr=!1,wa=!1;return Math.abs(Er)<Math.abs(zr)?(oa=[zr,0],Gr=Sr,wa=Kn):(oa=[0,Er],Gr=pr,wa=jn),{isAllBound:wa,isVerticalBound:Sr,isHorizontalBound:pr,isBound:Gr,offset:oa}}function kf(m,y,b,S,D,J){var lt=y[0],xt=y[1],_t=m[0],Wt=b[0],qt=b[1],Jt=oh(qt[1]-Wt[1]),Ut=oh(qt[0]-Wt[0]),xe=xt,Ce=lt,Ue=-lt/xt;if(Ut){if(!Jt){if(J&&!xe)return{isBound:!1,offset:0};if(Ce){var nr=(Wt[1]-_t[1])/Ue+_t[0];return vd(nr,Wt[0],qt[0],S,D)}else{var dn=Wt[1]-_t[1],Rn=Math.abs(dn)<=(D||0);return{isBound:Rn,offset:Rn?dn:0}}}}else{if(J&&!Ce)return{isBound:!1,offset:0};if(xe){var en=Ue*(Wt[0]-_t[0])+_t[1];return vd(en,Wt[1],qt[1],S,D)}else{var dn=Wt[0]-_t[0],Rn=Math.abs(dn)<=(D||0);return{isBound:Rn,offset:Rn?dn:0}}}return{isBound:!1,offset:0}}function Hd(m,y,b){return y.map(function(S){var D=jd(m,S),J=D.isBound,lt=D.offset,xt=D.isVerticalBound,_t=D.isHorizontalBound,Wt=S.multiple,qt=Wc({datas:b,distX:lt[0],distY:lt[1]}).map(function(Jt,Ut){return Jt*(Wt[Ut]?2/Wt[Ut]:0)});return{sign:Wt,isBound:J,isVerticalBound:xt,isHorizontalBound:_t,isSnap:!1,offset:qt}})}function wp(m,y,b){var S,D=Mh(m,y,[0,0],!1).map(function(Ut){return De(De({},Ut),{multiple:Ut.multiple.map(function(xe){return Math.abs(xe)*2})})}),J=Hd(m,D,b),lt=Ah(J,0),xt=Ah(J,1),_t=0,Wt=0,qt=lt.isVerticalBound||xt.isVerticalBound,Jt=lt.isHorizontalBound||xt.isHorizontalBound;return(qt||Jt)&&(S=Gf({datas:b,distX:-lt.offset[0],distY:-xt.offset[1]}),_t=S[0],Wt=S[1]),{vertical:{isBound:qt,offset:_t},horizontal:{isBound:Jt,offset:Wt}}}function Xd(m,y){var b=[],S=m[0],D=m[1];return S&&D?b.push([[0,D*2],m,[-S,D]],[[S*2,0],m,[S,-D]]):S?(b.push([[S*2,0],[S,1],[S,-1]]),y&&b.push([[0,-1],[S,-1],[-S,-1]],[[0,1],[S,1],[-S,1]])):D?(b.push([[0,D*2],[1,D],[-1,D]]),y&&b.push([[-1,0],[-1,D],[-1,-D]],[[1,0],[1,D],[1,-D]])):b.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),b}function Mh(m,y,b,S){var D=m.state,J=D.allMatrix,lt=D.is3d,xt=Fc(J,100,100,lt?4:3),_t=Nu(xt,[0,0]);return Xd(b,S).map(function(Wt){var qt=Wt[0],Jt=Wt[1],Ut=Wt[2],xe=[Nu(xt,Jt),Nu(xt,Ut)],Ce=Ig(xe),Ue=Vd(_t,xe),en=Ue.vertical,dn=Ue.horizontal,Rn=pd(_t,xe)<=0;return{multiple:qt,centerSign:Rn,verticalSign:en,horizontalSign:dn,lineConstants:Ce,line:[Nu(y,Jt),Nu(y,Ut)]}})}function Zh(m,y,b,S){var D=S?m.map(function(J){return yu(J,S)}):m;return[[D[0],D[1]],[D[1],D[3]],[D[3],D[2]],[D[2],D[0]]].some(function(J){var lt=pd(b,J)<=0;return!xp(y,J,lt)})}function Ep(m){var y=m[0],b=m[1],S=b[0]-y[0],D=b[1]-y[1];if(!S)return Math.abs(y[0]);if(!D)return Math.abs(y[1]);var J=D/S;return Math.abs((-J*y[0]+y[1])/Math.sqrt(Math.pow(J,2)+1))}function Nh(m){var y=m[0],b=m[1],S=b[0]-y[0],D=b[1]-y[1];if(!S)return[y[0],0];if(!D)return[0,y[1]];var J=D/S,lt=-J*y[0]+y[1];return[-lt/(J+1/J),lt/(J*J+1)]}function Sp(m,y,b,S,D){var J=m.props.innerBounds,lt=D*Math.PI/180;if(!J)return[];var xt=J.left,_t=J.top,Wt=J.width,qt=J.height,Jt=xt-S[0],Ut=xt+Wt-S[0],xe=_t-S[1],Ce=_t+qt-S[1],Ue=[[Jt,xe],[Ut,xe],[Jt,Ce],[Ut,Ce]],en=Nu(b,[0,0]);if(!Zh(b,Ue,en,0))return[];var dn=[],Rn=Ue.map(function(nr){return[Hc(nr),Y([0,0],nr)]});return[[b[0],b[1]],[b[1],b[3]],[b[3],b[2]],[b[2],b[0]]].forEach(function(nr){var Kn=Y([0,0],Nh(nr)),Sr=Ep(nr);dn.push.apply(dn,Rn.filter(function(jn){var pr=jn[0];return pr&&Sr<=pr}).map(function(jn){var pr=jn[0],zr=jn[1],Er=Math.acos(pr?Sr/pr:0),oa=zr+Er,Gr=zr-Er;return[lt+oa-Kn,lt+Gr-Kn]}).reduce(function(jn,pr){return jn.push.apply(jn,pr),jn},[]).filter(function(jn){return!Zh(y,Ue,en,jn)}).map(function(jn){return Ht(jn*180/Math.PI,Ou)}))}),dn}function lh(m){var y=m.props.innerBounds;if(!y)return{vertical:[],horizontal:[]};var b=m.getRect(),S=b.pos1,D=b.pos2,J=b.pos3,lt=b.pos4,xt=[S,D,J,lt],_t=Nu(xt,[0,0]),Wt=y.left,qt=y.top,Jt=y.width,Ut=y.height,xe=[[Wt,qt],[Wt,qt+Ut]],Ce=[[Wt,qt],[Wt+Jt,qt]],Ue=[[Wt+Jt,qt],[Wt+Jt,qt+Ut]],en=[[Wt,qt+Ut],[Wt+Jt,qt+Ut]],dn=Mh(m,xt,[0,0],!1),Rn=[],nr=[],Kn={top:!1,bottom:!1,left:!1,right:!1};return dn.forEach(function(Sr){var jn=Sr.line,pr=Sr.lineConstants,zr=Vd(_t,jn),Er=zr.horizontal,oa=zr.vertical,Gr=kf(jn,pr,Ce,oa,1,!0),wa=kf(jn,pr,en,oa,1,!0),va=kf(jn,pr,xe,Er,1,!0),Ua=kf(jn,pr,Ue,Er,1,!0);Gr.isBound&&!Kn.top&&(Rn.push(qt),Kn.top=!0),wa.isBound&&!Kn.bottom&&(Rn.push(qt+Ut),Kn.bottom=!0),va.isBound&&!Kn.left&&(nr.push(Wt),Kn.left=!0),Ua.isBound&&!Kn.right&&(nr.push(Wt+Jt),Kn.right=!0)}),{horizontal:Rn,vertical:nr}}function Zs(m,y,b){var S=m||{},D=S.position,J=D===void 0?"client":D,lt=S.left,xt=lt===void 0?-Infinity:lt,_t=S.top,Wt=_t===void 0?-Infinity:_t,qt=S.right,Jt=qt===void 0?Infinity:qt,Ut=S.bottom,xe=Ut===void 0?Infinity:Ut,Ce={position:J,left:xt,top:Wt,right:Jt,bottom:xe};return{vertical:Iv(Ce,y,!0),horizontal:Iv(Ce,b,!1)}}function ch(m,y){var b=m.state,S=b.containerClientRect,D=S.clientHeight,J=S.clientWidth,lt=S.clientLeft,xt=S.clientTop,_t=b.snapOffset,Wt=_t.left,qt=_t.top,Jt=_t.right,Ut=_t.bottom,xe=y||m.props.bounds||{},Ce=xe.position||"client",Ue=Ce==="css",en=xe.left,dn=en===void 0?-Infinity:en,Rn=xe.top,nr=Rn===void 0?-Infinity:Rn,Kn=xe.right,Sr=Kn===void 0?Ue?-Infinity:Infinity:Kn,jn=xe.bottom,pr=jn===void 0?Ue?-Infinity:Infinity:jn;return Ue&&(Sr=J+Jt-Wt-Sr,pr=D+Ut-qt-pr),{left:dn+Wt-lt,right:Sr+Wt-lt,top:nr+qt-xt,bottom:pr+qt-xt}}function Df(m,y,b){var S=ch(m),D=S.left,J=S.top,lt=S.right,xt=S.bottom,_t=b[0],Wt=b[1],qt=gi(b,y),Jt=qt[0],Ut=qt[1];Math.abs(Jt)<Ou&&(Jt=0),Math.abs(Ut)<Ou&&(Ut=0);var xe=Ut>0,Ce=Jt>0,Ue={isBound:!1,offset:0,pos:0},en={isBound:!1,offset:0,pos:0};if(Jt===0&&Ut===0)return{vertical:Ue,horizontal:en};if(Jt===0)xe?xt<Wt&&(en.pos=xt,en.offset=Wt-xt):J>Wt&&(en.pos=J,en.offset=Wt-J);else if(Ut===0)Ce?lt<_t&&(Ue.pos=lt,Ue.offset=_t-lt):D>_t&&(Ue.pos=D,Ue.offset=_t-D);else{var dn=Ut/Jt,Rn=b[1]-dn*_t,nr=0,Kn=0,Sr=!1;Ce&&lt<=_t?(nr=dn*lt+Rn,Kn=lt,Sr=!0):!Ce&&_t<=D&&(nr=dn*D+Rn,Kn=D,Sr=!0),Sr&&(nr<J||nr>xt)&&(Sr=!1),Sr||(xe&&xt<=Wt?(nr=xt,Kn=(nr-Rn)/dn,Sr=!0):!xe&&Wt<=J&&(nr=J,Kn=(nr-Rn)/dn,Sr=!0)),Sr&&(Ue.isBound=!0,Ue.pos=Kn,Ue.offset=_t-Kn,en.isBound=!0,en.pos=nr,en.offset=Wt-nr)}return{vertical:Ue,horizontal:en}}function Iv(m,y,b){var S=m[b?"left":"top"],D=m[b?"right":"bottom"],J=Math.min.apply(Math,y),lt=Math.max.apply(Math,y),xt=[];return S+1>J&&xt.push({isBound:!0,offset:J-S,pos:S}),D-1<lt&&xt.push({isBound:!0,offset:lt-D,pos:D}),xt.length||xt.push({isBound:!1,offset:0,pos:0}),xt.sort(function(_t,Wt){return Math.abs(Wt.offset)-Math.abs(_t.offset)})}function cu(m,y,b){var S=b?m.map(function(D){return yu(D,b)}):m;return S.some(function(D){return D[0]<y.left&&Math.abs(D[0]-y.left)>.1||D[0]>y.right&&Math.abs(D[0]-y.right)>.1||D[1]<y.top&&Math.abs(D[1]-y.top)>.1||D[1]>y.bottom&&Math.abs(D[1]-y.bottom)>.1})}function Yd(m,y,b){var S=Hc(m),D=Math.sqrt(S*S-y*y)||0;return[D,-D].sort(function(J,lt){return Math.abs(J-m[b?0:1])-Math.abs(lt-m[b?0:1])}).map(function(J){return Y([0,0],b?[J,y]:[y,J])})}function Tv(m,y,b,S,D){if(!m.props.bounds)return[];var J=D*Math.PI/180,lt=ch(m),xt=lt.left,_t=lt.top,Wt=lt.right,qt=lt.bottom,Jt=xt-S[0],Ut=Wt-S[0],xe=_t-S[1],Ce=qt-S[1],Ue={left:Jt,top:xe,right:Ut,bottom:Ce};if(!cu(b,Ue,0))return[];var en=[];return[[Jt,0],[Ut,0],[xe,1],[Ce,1]].forEach(function(dn){var Rn=dn[0],nr=dn[1];b.forEach(function(Kn){var Sr=Y([0,0],Kn);en.push.apply(en,Yd(Kn,Rn,nr).map(function(jn){return J+jn-Sr}).filter(function(jn){return!cu(y,Ue,jn)}).map(function(jn){return Ht(jn*180/Math.PI,Ou)}))})}),en}function qp(m,y){var b,S=m.direction,D=m.classNames,J=m.size,lt=m.pos,xt=m.zoom,_t=m.key,Wt=S==="horizontal",qt=Wt?"Y":"X";return y.createElement("div",{key:_t,className:D.join(" "),style:(b={},b[Wt?"width":"height"]="".concat(J),b.transform="translate(".concat(lt[0],", ").concat(lt[1],") translate").concat(qt,"(-50%) scale").concat(qt,"(").concat(xt,")"),b)})}function Yc(m,y){return qp(De(De({},m),{classNames:Ar([Vi("line","guideline",m.direction)],m.classNames,!0).filter(function(b){return b}),size:m.size||"".concat(m.sizeValue,"px"),pos:m.pos||m.posValue.map(function(b){return"".concat(Ht(b,.1),"px")})}),y)}function Qp(m,y,b,S,D,J,lt,xt){var _t=m.props.zoom;return b.map(function(Wt,qt){var Jt=Wt.type,Ut=Wt.pos,xe=[0,0];return xe[lt]=S,xe[lt?0:1]=-D+Ut,Yc({key:"".concat(y,"TargetGuideline").concat(qt),classNames:[Vi("target","bold",Jt)],posValue:xe,sizeValue:J,zoom:_t,direction:y},xt)})}function Av(m,y,b,S,D,J){var lt=m.props,xt=lt.zoom,_t=lt.isDisplayInnerSnapDigit,Wt=y==="horizontal"?vs:Xc,qt=D[Wt.start],Jt=D[Wt.end];return b.filter(function(Ut){var xe=Ut.hide,Ce=Ut.elementRect;if(xe)return!1;if(_t&&Ce){var Ue=Ce.rect;if(Ue[Wt.start]<=qt&&Jt<=Ue[Wt.end])return!1}return!0}).map(function(Ut,xe){var Ce=Ut.pos,Ue=Ut.size,en=Ut.element,dn=Ut.className,Rn=[-S[0]+Ce[0],-S[1]+Ce[1]];return Yc({key:"".concat(y,"-default-guideline-").concat(xe),classNames:en?[Vi("bold"),dn]:[Vi("normal"),dn],direction:y,posValue:Rn,sizeValue:Ue,zoom:xt},J)})}function qh(m,y,b,S,D,J,lt,xt){var _t,Wt=m.props,qt=Wt.snapDigit,Jt=qt===void 0?0:qt,Ut=Wt.isDisplaySnapDigit,xe=Ut===void 0?!0:Ut,Ce=Wt.snapDistFormat,Ue=Ce===void 0?function(Sr,jn){return Sr}:Ce,en=Wt.zoom,dn=y==="horizontal"?"X":"Y",Rn=y==="vertical"?"height":"width",nr=Math.abs(D),Kn=xe?parseFloat(nr.toFixed(Jt)):0;return xt.createElement("div",{key:"".concat(y,"-").concat(b,"-guideline-").concat(S),className:Vi("guideline-group",y),style:(_t={left:"".concat(J[0],"px"),top:"".concat(J[1],"px")},_t[Rn]="".concat(nr,"px"),_t)},Yc({direction:y,classNames:[Vi(b),lt],size:"100%",posValue:[0,0],sizeValue:nr,zoom:en},xt),xt.createElement("div",{className:Vi("size-value","gap"),style:{transform:"translate".concat(dn,"(-50%) scale(").concat(en,")")}},Kn>0?Ue(Kn,y):""))}function Jp(m,y,b,S){var D=m==="vertical"?0:1,J=m==="vertical"?1:0,lt=D?vs:Xc,xt=b[lt.start],_t=b[lt.end];return sf(y,function(Wt){return Wt.pos[D]}).map(function(Wt){var qt=[],Jt=[],Ut=[];return Wt.forEach(function(xe){var Ce,Ue,en=xe.element,dn=xe.elementRect.rect;if(dn[lt.end]<xt)qt.push(xe);else if(_t<dn[lt.start])Jt.push(xe);else if(dn[lt.start]<=xt&&_t<=dn[lt.end]&&S){var Rn=xe.pos,nr={element:en,rect:De(De({},dn),(Ce={},Ce[lt.end]=dn[lt.start],Ce))},Kn={element:en,rect:De(De({},dn),(Ue={},Ue[lt.start]=dn[lt.end],Ue))},Sr=[0,0],jn=[0,0];Sr[D]=Rn[D],Sr[J]=Rn[J],jn[D]=Rn[D],jn[J]=Rn[J]+xe.size,qt.push({type:m,pos:Sr,size:0,elementRect:nr}),Jt.push({type:m,pos:jn,size:0,elementRect:Kn})}}),qt.sort(function(xe,Ce){return Ce.pos[J]-xe.pos[J]}),Jt.sort(function(xe,Ce){return xe.pos[J]-Ce.pos[J]}),{total:Wt,start:qt,end:Jt,inner:Ut}})}function Mv(m,y,b,S,D){var J=m.props.isDisplayInnerSnapDigit,lt=[];return["vertical","horizontal"].forEach(function(xt){var _t=y.filter(function(en){return en.type===xt}),Wt=xt==="vertical"?1:0,qt=Wt?0:1,Jt=Jp(xt,_t,S,J),Ut=Wt?Xc:vs,xe=Wt?vs:Xc,Ce=S[Ut.start],Ue=S[Ut.end];Jt.forEach(function(en){var dn=en.total,Rn=en.start,nr=en.end,Kn=en.inner,Sr=b[qt]+dn[0].pos[qt]-S[xe.start],jn=S;Rn.forEach(function(pr){var zr=pr.elementRect.rect,Er=jn[Ut.start]-zr[Ut.end];if(Er>0){var oa=[0,0];oa[Wt]=b[Wt]+jn[Ut.start]-Ce-Er,oa[qt]=Sr,lt.push(qh(m,xt,"dashed",lt.length,Er,oa,pr.className,D))}jn=zr}),jn=S,nr.forEach(function(pr){var zr=pr.elementRect.rect,Er=zr[Ut.start]-jn[Ut.end];if(Er>0){var oa=[0,0];oa[Wt]=b[Wt]+jn[Ut.end]-Ce,oa[qt]=Sr,lt.push(qh(m,xt,"dashed",lt.length,Er,oa,pr.className,D))}jn=zr}),Kn.forEach(function(pr){var zr=pr.elementRect.rect,Er=Ce-zr[Ut.start],oa=zr[Ut.end]-Ue,Gr=[0,0],wa=[0,0];Gr[Wt]=b[Wt]-Er,Gr[qt]=Sr,wa[Wt]=b[Wt]+Ue-Ce,wa[qt]=Sr,lt.push(qh(m,xt,"dashed",lt.length,Er,Gr,pr.className,D)),lt.push(qh(m,xt,"dashed",lt.length,oa,wa,pr.className,D))})})}),lt}function Nv(m,y,b,S,D){var J=[];return["horizontal","vertical"].forEach(function(lt){var xt=y.filter(function(en){return en.type===lt}).slice(0,1),_t=lt==="vertical"?0:1,Wt=_t?0:1,qt=_t?Xc:vs,Jt=_t?vs:Xc,Ut=S[qt.start],xe=S[qt.end],Ce=S[Jt.start],Ue=S[Jt.end];xt.forEach(function(en){var dn=en.gap,Rn=en.gapRects,nr=Math.max.apply(Math,Ar([Ce],Rn.map(function(jn){var pr=jn.rect;return pr[Jt.start]}),!1)),Kn=Math.min.apply(Math,Ar([Ue],Rn.map(function(jn){var pr=jn.rect;return pr[Jt.end]}),!1)),Sr=(nr+Kn)/2;nr===Kn||Sr===(Ce+Ue)/2||Rn.forEach(function(jn){var pr=jn.rect,zr=jn.className,Er=[b[0],b[1]];if(pr[qt.end]<Ut)Er[_t]+=pr[qt.end]-Ut;else if(xe<pr[qt.start])Er[_t]+=pr[qt.start]-Ut-dn;else return;Er[Wt]+=Sr-Ce,J.push(qh(m,_t?"vertical":"horizontal","gap",J.length,dn,Er,zr,D))})})}),J}function Bl(m,y,b,S){var D=y[0]-m[0],J=y[1]-m[1];if(Math.abs(D)<We&&(D=0),Math.abs(J)<We&&(J=0),!D)return S?[0,0]:[0,b];if(!J)return S?[b,0]:[0,0];var lt=J/D,xt=m[1]-lt*m[0];if(S){var _t=lt*(y[0]+b)+xt;return[b,_t-y[1]]}else{var Wt=(y[1]+b-xt)/lt;return[Wt-y[0],b]}}function gd(m,y,b,S,D){var J=Bl(m,y,b,S);if(!J)return{isOutside:!1,offset:[0,0]};var lt=jt(m,y),xt=jt(J,m),_t=jt(J,y),Wt=xt>lt||_t>lt,qt=Wc({datas:D,distX:J[0],distY:J[1]}),Jt=qt[0],Ut=qt[1];return{offset:[Jt,Ut],isOutside:Wt}}function Of(m,y){return m.isBound?m.offset:y.isSnap?Yp(y).offset:0}function kh(m,y,b,S,D){var J=y[0],lt=y[1],xt=b[0],_t=b[1],Wt=S[0],qt=S[1],Jt=D[0],Ut=D[1],xe=-Jt,Ce=-Ut;if(m&&J&&lt){xe=0,Ce=0;var Ue=[];if(xt&&_t?Ue.push([0,Ut],[Jt,0]):xt?Ue.push([Jt,0]):_t?Ue.push([0,Ut]):Wt&&qt?Ue.push([0,Ut],[Jt,0]):Wt?Ue.push([Jt,0]):qt&&Ue.push([0,Ut]),Ue.length){Ue.sort(function(nr,Kn){return Hc(gi([J,lt],nr))-Hc(gi([J,lt],Kn))});var en=Ue[0];if(en[0]&&Math.abs(J)>We)xe=-en[0],Ce=lt*Math.abs(J+xe)/Math.abs(J)-lt;else if(en[1]&&Math.abs(lt)>We){var dn=lt;Ce=-en[1],xe=J*Math.abs(lt+Ce)/Math.abs(dn)-J}if(m&&_t&&xt)if(Math.abs(xe)>We&&Math.abs(xe)<Math.abs(Jt)){var Rn=Math.abs(Jt)/Math.abs(xe);xe*=Rn,Ce*=Rn}else if(Math.abs(Ce)>We&&Math.abs(Ce)<Math.abs(Ut)){var Rn=Math.abs(Ut)/Math.abs(Ce);xe*=Rn,Ce*=Rn}else xe=Wf(-Jt,xe),Ce=Wf(-Ut,Ce)}}else xe=J||xt?-Jt:0,Ce=lt||_t?-Ut:0;return[xe,Ce]}function kv(m,y,b,S,D,J){if(!eo(m,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var lt=Fd(J.absolutePoses,[y,b]),xt=Rl(lt),_t=xt.left,Wt=xt.right,qt=xt.top,Jt=xt.bottom,Ut={horizontal:lt.map(function(Ua){return Ua[1]}),vertical:lt.map(function(Ua){return Ua[0]})},xe=Hp(m.props.snapDirections),Ce=dd(xe,{left:_t,right:Wt,top:qt,bottom:Jt,center:(_t+Wt)/2,middle:(qt+Jt)/2}),Ue=md(m,D,Ce,Ut),en=Ue.vertical,dn=Ue.horizontal,Rn=wp(m,lt,J),nr=Rn.vertical,Kn=Rn.horizontal,Sr=en.isSnap,jn=dn.isSnap,pr=en.isBound||nr.isBound,zr=dn.isBound||Kn.isBound,Er=Wf(en.offset,nr.offset),oa=Wf(dn.offset,Kn.offset),Gr=kh(S,[y,b],[pr,zr],[Sr,jn],[Er,oa]),wa=Gr[0],va=Gr[1];return[{isBound:pr,isSnap:Sr,offset:wa},{isBound:zr,isSnap:jn,offset:va}]}function md(m,y,b,S){S===void 0&&(S=b);var D=Zs(ch(m),S.vertical,S.horizontal),J=D.horizontal,lt=D.vertical,xt=y?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:Ud(m,b.vertical,b.horizontal),_t=xt.horizontal,Wt=xt.vertical,qt=Of(J[0],_t),Jt=Of(lt[0],Wt),Ut=Math.abs(qt),xe=Math.abs(Jt);return{horizontal:{isBound:J[0].isBound,isSnap:_t.isSnap,snapIndex:_t.index,offset:qt,dist:Ut,bounds:J,snap:_t},vertical:{isBound:lt[0].isBound,isSnap:Wt.isSnap,snapIndex:Wt.index,offset:Jt,dist:xe,bounds:lt,snap:Wt}}}function Kd(m,y,b,S,D){var J=Zs(y,b,S),lt=J.horizontal,xt=J.vertical,_t=Xp(m,b,S,D),Wt=_t.horizontal,qt=_t.vertical,Jt=Of(lt[0],Wt),Ut=Of(xt[0],qt),xe=Math.abs(Jt),Ce=Math.abs(Ut);return{horizontal:{isBound:lt[0].isBound,isSnap:Wt.isSnap,snapIndex:Wt.index,offset:Jt,dist:xe,bounds:lt,snap:Wt},vertical:{isBound:xt[0].isBound,isSnap:qt.isSnap,snapIndex:qt.index,offset:Ut,dist:Ce,bounds:xt,snap:qt}}}function tv(m,y,b,S){var D=Y(m,y)/Math.PI*180,J=b.vertical,lt=J.isBound,xt=J.isSnap,_t=J.dist,Wt=b.horizontal,qt=Wt.isBound,Jt=Wt.isSnap,Ut=Wt.dist,xe=D%180,Ce=xe<3||xe>177,Ue=xe>87&&xe<93;return Ut<_t&&(lt||xt&&!Ue&&(!S||!Ce))?"vertical":qt||Jt&&!Ce&&(!S||!Ue)?"horizontal":""}function Bc(m,y,b,S,D,J){return b.map(function(lt){var xt=lt[0],_t=lt[1],Wt=Nu(y,xt),qt=Nu(y,_t),Jt=S?zl(m,Wt,qt,D):md(m,D,{vertical:[qt[0]],horizontal:[qt[1]]}),Ut=Jt.horizontal,xe=Ut.offset,Ce=Ut.isBound,Ue=Ut.isSnap,en=Jt.vertical,dn=en.offset,Rn=en.isBound,nr=en.isSnap,Kn=gi(_t,xt);if(!dn&&!xe)return{isBound:Rn||Ce,isSnap:nr||Ue,sign:Kn,offset:[0,0]};var Sr=tv(Wt,qt,Jt,S);if(!Sr)return{sign:Kn,isBound:!1,isSnap:!1,offset:[0,0]};var jn=Sr==="vertical",pr=[0,0];return!S&&Math.abs(_t[0])===1&&Math.abs(_t[1])===1&&xt[0]!==_t[0]&&xt[1]!==_t[1]?pr=Wc({datas:J,distX:-dn,distY:-xe}):pr=gd(Wt,qt,-(jn?dn:xe),jn,J).offset,pr=pr.map(function(zr,Er){return zr*(Kn[Er]?2/Kn[Er]:0)}),{sign:Kn,isBound:jn?Rn:Ce,isSnap:jn?nr:Ue,offset:pr}})}function Vf(m,y){return m.isBound?m.offset:y.isSnap?y.offset:0}function zl(m,y,b,S){var D=Df(m,y,b),J=D.horizontal,lt=D.vertical,xt=S?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:_v(m,y,b),_t=xt.horizontal,Wt=xt.vertical,qt=Vf(J,_t),Jt=Vf(lt,Wt),Ut=Math.abs(qt),xe=Math.abs(Jt);return{horizontal:{isBound:J.isBound,isSnap:_t.isSnap,offset:qt,dist:Ut},vertical:{isBound:lt.isBound,isSnap:Wt.isSnap,offset:Jt,dist:xe}}}function vc(m,y,b,S,D){var J=[-b[0],-b[1]],lt=m.state,xt=lt.width,_t=lt.height,Wt=m.props.bounds,qt=Infinity,Jt=Infinity;if(Wt){var Ut=[[b[0],-b[1]],[-b[0],b[1]]],xe=Wt.left,Ce=xe===void 0?-Infinity:xe,Ue=Wt.top,en=Ue===void 0?-Infinity:Ue,dn=Wt.right,Rn=dn===void 0?Infinity:dn,nr=Wt.bottom,Kn=nr===void 0?Infinity:nr;Ut.forEach(function(Sr){var jn=Sr[0]!==J[0],pr=Sr[1]!==J[1],zr=Nu(y,Sr),Er=Y(S,zr)*360/Math.PI;if(pr){var oa=zr.slice();(Math.abs(Er-360)<2||Math.abs(Er-180)<2)&&(oa[1]=S[1]);var Gr=gd(S,oa,(S[1]<zr[1]?Kn:en)-zr[1],!1,D),wa=Gr.offset,va=wa[1],Ua=Gr.isOutside;isNaN(va)||(Jt=_t+(Ua?1:-1)*Math.abs(va))}if(jn){var oa=zr.slice();(Math.abs(Er-90)<2||Math.abs(Er-270)<2)&&(oa[0]=S[0]);var Ja=gd(S,oa,(S[0]<zr[0]?Rn:Ce)-zr[0],!0,D),Li=Ja.offset[0],Zi=Ja.isOutside;isNaN(Li)||(qt=xt+(Zi?1:-1)*Math.abs(Li))}})}return{maxWidth:qt,maxHeight:Jt}}function yd(m){var y=m.state,b=y.containerClientRect,S=y.hasFixed,D=b.overflow,J=b.scrollHeight,lt=b.scrollWidth,xt=b.clientHeight,_t=b.clientWidth,Wt=b.clientLeft,qt=b.clientTop,Jt=m.props,Ut=Jt.snapGap,xe=Ut===void 0?!0:Ut,Ce=Jt.verticalGuidelines,Ue=Jt.horizontalGuidelines,en=Jt.snapThreshold,dn=en===void 0?5:en,Rn=Jt.snapGridWidth,nr=Rn===void 0?0:Rn,Kn=Jt.snapGridHeight,Sr=Kn===void 0?0:Kn,jn=Jt.maxSnapElementGuidelineDistance,pr=jn===void 0?Infinity:jn,zr=Rl(Kl(m.state)),Er=zr.top,oa=zr.left,Gr=zr.bottom,wa=zr.right,va={top:Er,left:oa,bottom:Gr,right:wa,center:(oa+wa)/2,middle:(Er+Gr)/2},Ua=nv(m),Ja=Ar([],Ua,!0);xe&&Ja.push.apply(Ja,Dv(m,va,dn)),Ja.push.apply(Ja,ev(nr,Sr,D?lt:_t,D?J:xt,Wt,qt));var Li=De({},y.snapOffset||{left:0,top:0,bottom:0,right:0});if(S){var Zi=b.left,Oi=b.top;Li.left+=Zi,Li.top+=Oi,Li.right+=Zi,Li.bottom+=Oi}return Ja.push.apply(Ja,lf(Ue||!1,Ce||!1,D?lt:_t,D?J:xt,Wt,qt,Li)),Ja=Ja.filter(function(li){var ti=li.element,ao=li.elementRect,$o=li.type;if(!ti||!ao)return!0;var Oo=ao.rect;return Zd(va,Oo,$o,pr)}),Ja}function Dv(m,y,b){var S=m.props,D=S.maxSnapElementGuidelineDistance,J=D===void 0?Infinity:D,lt=S.maxSnapElementGapDistance,xt=lt===void 0?Infinity:lt,_t=m.state.elementRects,Wt=[];return[["vertical",vs,Xc],["horizontal",Xc,vs]].forEach(function(qt){var Jt=qt[0],Ut=qt[1],xe=qt[2],Ce=y[Ut.start],Ue=y[Ut.end],en=y[Ut.center],dn=y[xe.start],Rn=y[xe.end];function nr(jn){var pr=jn.rect;return pr[Ut.end]<Ce+b?Ce-pr[Ut.end]:Ue-b<pr[Ut.start]?pr[Ut.start]-Ue:-1}var Kn=_t.filter(function(jn){var pr=jn.rect;return pr[xe.start]>Rn||pr[xe.end]<dn?!1:nr(jn)>0}).sort(function(jn,pr){return nr(jn)-nr(pr)}),Sr=[];Kn.forEach(function(jn){Kn.forEach(function(pr){if(jn!==pr){var zr=jn.rect,Er=pr.rect,oa=zr[xe.start],Gr=zr[xe.end],wa=Er[xe.start],va=Er[xe.end];oa>va||wa>Gr||Sr.push([jn,pr])}})}),Sr.forEach(function(jn){var pr=jn[0],zr=jn[1],Er=pr.rect,oa=zr.rect,Gr=Er[Ut.start],wa=Er[Ut.end],va=oa[Ut.start],Ua=oa[Ut.end],Ja=0,Li=0,Zi=!1,Oi=!1,li=!1;if(wa<=Ce&&Ue<=va){if(Oi=!0,Ja=(va-wa-(Ue-Ce))/2,Li=wa+Ja+(Ue-Ce)/2,Math.abs(Li-en)>b)return}else if(wa<va&&Ua<Ce+b){if(Zi=!0,Ja=va-wa,Li=Ua+Ja,Math.abs(Li-Ce)>b)return}else if(wa<va&&Ue-b<Gr){if(li=!0,Ja=va-wa,Li=Gr-Ja,Math.abs(Li-Ue)>b)return}else return;!Ja||!Zd(y,oa,Jt,J)||Ja>xt||Wt.push({type:Jt,pos:Jt==="vertical"?[Li,0]:[0,Li],element:zr.element,size:0,className:zr.className,isStart:Zi,isCenter:Oi,isEnd:li,gap:Ja,hide:!0,gapRects:[pr,zr]})})}),Wt}function ev(m,y,b,S,D,J){D===void 0&&(D=0),J===void 0&&(J=0);var lt=[];if(y)for(var xt=0;xt<=S;xt+=y)lt.push({type:"horizontal",pos:[0,Ht(xt-J,.1)],size:b,hide:!0});if(m)for(var xt=0;xt<=b;xt+=m)lt.push({type:"vertical",pos:[Ht(xt-D,.1),0],size:S,hide:!0});return lt}function Zd(m,y,b,S){return b==="horizontal"?Math.abs(m.right-y.left)<=S||Math.abs(m.left-y.right)<=S||m.left<=y.right&&y.left<=m.right:b==="vertical"?Math.abs(m.bottom-y.top)<=S||Math.abs(m.top-y.bottom)<=S||m.top<=y.bottom&&y.top<=m.bottom:!0}function nv(m){var y=m.state,b=m.props.elementGuidelines,S=b===void 0?[]:b;if(!S.length)return y.elementRects=[],[];var D=(y.elementRects||[]).filter(function(Ut){return!Ut.refresh}),J=S.map(function(Ut){return fn(Ut)&&"element"in Ut?De(De({},Ut),{element:uf(Ut.element,!0)}):{element:uf(Ut,!0)}}).filter(function(Ut){return Ut.element}),lt=ou(D.map(function(Ut){return Ut.element}),J.map(function(Ut){return Ut.element})),xt=lt.maintained,_t=lt.added,Wt=[];xt.forEach(function(Ut){var xe=Ut[0],Ce=Ut[1];Wt[Ce]=D[xe]}),ci(m,_t.map(function(Ut){return J[Ut]})).map(function(Ut,xe){Wt[_t[xe]]=Ut}),y.elementRects=Wt;var qt=Hp(m.props.elementSnapDirections),Jt=[];return Wt.forEach(function(Ut){var xe=Ut.element,Ce=Ut.top,Ue=Ce===void 0?qt.top:Ce,en=Ut.left,dn=en===void 0?qt.left:en,Rn=Ut.right,nr=Rn===void 0?qt.right:Rn,Kn=Ut.bottom,Sr=Kn===void 0?qt.bottom:Kn,jn=Ut.center,pr=jn===void 0?qt.center:jn,zr=Ut.middle,Er=zr===void 0?qt.middle:zr,oa=Ut.className,Gr=Ut.rect,wa=dd({top:Ue,right:nr,left:dn,bottom:Sr,center:pr,middle:Er},Gr),va=wa.horizontal,Ua=wa.vertical,Ja=Gr.top,Li=Gr.left,Zi=Gr.right-Li,Oi=Gr.bottom-Ja,li=[Zi,Oi];Ua.forEach(function(ti){Jt.push({type:"vertical",element:xe,pos:[Ht(ti,.1),Ja],size:Oi,sizes:li,className:oa,elementRect:Ut})}),va.forEach(function(ti){Jt.push({type:"horizontal",element:xe,pos:[Li,Ht(ti,.1)],size:Zi,sizes:li,className:oa,elementRect:Ut})})}),Jt}function Dh(m,y){return m?m.map(function(b){var S=fn(b)?b:{pos:b},D=S.pos;return Un(D)?S:De(De({},S),{pos:_n(D,y)})}):[]}function lf(m,y,b,S,D,J,lt){D===void 0&&(D=0),J===void 0&&(J=0),lt===void 0&&(lt={left:0,top:0,right:0,bottom:0});var xt=[],_t=lt.left,Wt=lt.top,qt=lt.bottom,Jt=lt.right,Ut=b+Jt-_t,xe=S+qt-Wt;return Dh(m,xe).forEach(function(Ce){xt.push({type:"horizontal",pos:[_t,Ht(Ce.pos-J+Wt,.1)],size:Ut,className:Ce.className})}),Dh(y,Ut).forEach(function(Ce){xt.push({type:"vertical",pos:[Ht(Ce.pos-D+_t,.1),Wt],size:xe,className:Ce.className})}),xt}function ci(m,y){if(!y.length)return[];var b=m.state,S=b.containerClientRect,D=b.rootMatrix,J=b.is3d,lt=b.offsetDelta,xt=J?4:3,_t=_g(D,S,xt),Wt=_t[0],qt=_t[1];return y.map(function(Jt){var Ut=Jt.element.getBoundingClientRect(),xe=Ut.left-Wt-lt[0],Ce=Ut.top-qt-lt[1],Ue=Ce+Ut.height,en=xe+Ut.width,dn=bh(D,[xe,Ce],xt),Rn=dn[0],nr=dn[1],Kn=bh(D,[en,Ue],xt),Sr=Kn[0],jn=Kn[1];return De(De({},Jt),{rect:{left:Rn,right:Sr,top:nr,bottom:jn,center:(Rn+Sr)/2,middle:(nr+jn)/2}})})}function rv(m){var y=m.state,b=y.container,S=m.props.snapContainer||b;if(y.snapContainer===S&&y.guidelines&&y.guidelines.length)return!1;var D=y.containerClientRect,J={left:0,top:0,bottom:0,right:0};if(b!==S){var lt=uf(S,!0);if(lt){var xt=rh(lt),_t=Pl(y,[xt.left-D.left,xt.top-D.top]),Wt=Pl(y,[xt.right-D.right,xt.bottom-D.bottom]);J.left=Ht(_t[0],1e-5),J.top=Ht(_t[1],1e-5),J.right=Ht(Wt[0],1e-5),J.bottom=Ht(Wt[1],1e-5)}}return y.snapContainer=S,y.snapOffset=J,y.guidelines=yd(m),y.enableSnap=!0,!0}function av(m,y,b,S,D,J){var lt=Fc(m,y,b,J?4:3),xt=Nu(lt,S);return Fd(lt,gi(D,xt))}function rg(m,y,b,S,D,J){var lt=J.fixedDirection,xt=Wd(b,lt,S),_t=Mh(m,y,b,S),Wt=Ar(Ar([],Bc(m,y,xt,S,D,J),!0),Hd(m,_t,J),!0),qt=Ah(Wt,0),Jt=Ah(Wt,1);return{width:{isBound:qt.isBound,offset:qt.offset[0]},height:{isBound:Jt.isBound,offset:Jt.offset[1]}}}function qd(m,y,b,S,D,J,lt,xt,_t){var Wt=Nu(y,lt),qt=md(m,xt,{vertical:[Wt[0]],horizontal:[Wt[1]]}),Jt=qt.horizontal.offset,Ut=qt.vertical.offset;if(Ht(Ut,Ec)||Ht(Jt,Ec)){var xe=Wc({datas:_t,distX:-Ut,distY:-Jt}),Ce=xe[0],Ue=xe[1],en=Math.min(D||Infinity,b+lt[0]*Ce),dn=Math.min(J||Infinity,S+lt[1]*Ue);return[en-b,dn-S]}return[0,0]}function Qh(m,y,b,S,D,J,lt,xt){for(var _t=Kl(m.state),Wt=m.props.keepRatio,qt=0,Jt=0,Ut=0;Ut<2;++Ut){var xe=y(qt,Jt),Ce=rg(m,xe,D,Wt,lt,xt),Ue=Ce.width,en=Ce.height,dn=Ue.isBound,Rn=en.isBound,nr=Ue.offset,Kn=en.offset;if(Ut===1&&(dn||(nr=0),Rn||(Kn=0)),Ut===0&&lt&&!dn&&!Rn)return[0,0];if(Wt){var Sr=Math.abs(nr)*(b?1/b:1),jn=Math.abs(Kn)*(S?1/S:1),pr=dn&&Rn?Sr<jn:Rn||!dn&&Sr<jn;pr?nr=b*Kn/S:Kn=S*nr/b}qt+=nr,Jt+=Kn}if(D[0]&&D[1]){var zr=vc(m,_t,D,J,xt),Er=zr.maxWidth,oa=zr.maxHeight,Gr=qd(m,y(qt,Jt).map(function(Ua){return Ua.map(function(Ja){return Ht(Ja,Ec)})}),b+qt,S+Jt,Er,oa,D,lt,xt),nr=Gr[0],Kn=Gr[1];qt+=nr,Jt+=Kn}return[qt,Jt]}function jf(m,y,b){if(!eo(m,"rotatable"))return{isSnap:!1,rotation:b};var S=y.pos1,D=y.pos2,J=y.pos3,lt=y.pos4,xt=y.origin,_t=b*Math.PI/180,Wt=[S,D,J,lt].map(function(xe){return gi(xe,xt)}),qt=Wt.map(function(xe){return yu(xe,_t)}),Jt=Ar(Ar([],Tv(m,Wt,qt,xt,b),!0),Sp(m,Wt,qt,xt,b),!0);Jt.sort(function(xe,Ce){return Math.abs(xe-b)-Math.abs(Ce-b)});var Ut=Jt.length>0;return{isSnap:Ut,rotation:Ut?Jt[0]:b}}function ag(m,y,b,S,D,J,lt){if(!eo(m,"resizable"))return[0,0];var xt=lt.fixedDirection,_t=lt.nextAllMatrix,Wt=m.state,qt=Wt.allMatrix,Jt=Wt.is3d;return Qh(m,function(Ut,xe){return av(_t||qt,y+Ut,b+xe,xt,D,Jt)},y,b,S,D,J,lt)}function Ov(m,y,b,S,D){if(!eo(m,"scalable"))return[0,0];var J=D.startOffsetWidth,lt=D.startOffsetHeight,xt=D.fixedPosition,_t=D.fixedDirection,Wt=D.is3d,qt=Qh(m,function(Jt,Ut){return av(Ot(D,wi(y,[Jt/J,Ut/lt])),J,lt,_t,xt,Wt)},J,lt,b,xt,S,D);return[qt[0]/J,qt[1]/lt]}function Cp(m,y){y.absolutePoses=Kl(m.state)}function Zl(m){var y=[];return m.forEach(function(b){b.guidelineInfos.forEach(function(S){var D=S.guideline;y.indexOf(D)>-1||y.push(D)})}),y}function ce(m,y,b,S,D,J){var lt=Zs(ch(m,J),y,b),xt=lt.vertical,_t=lt.horizontal;xt.forEach(function(Ut){Ut.isBound&&S.push({type:"bounds",pos:Ut.pos})}),_t.forEach(function(Ut){Ut.isBound&&D.push({type:"bounds",pos:Ut.pos})});var Wt=lh(m),qt=Wt.vertical,Jt=Wt.horizontal;qt.forEach(function(Ut){Hr(S,function(xe){var Ce=xe.type,Ue=xe.pos;return Ce==="bounds"&&Ue===Ut})>=0||S.push({type:"bounds",pos:Ut})}),Jt.forEach(function(Ut){Hr(D,function(xe){var Ce=xe.type,Ue=xe.pos;return Ce==="bounds"&&Ue===Ut})>=0||D.push({type:"bounds",pos:Ut})})}var vn=cd("",["resizable","scalable"]),er={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","snapDigit","snapThreshold","snapRenderThreshold","horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(m,y){var b=m.state,S=b.top,D=b.left,J=b.pos1,lt=b.pos2,xt=b.pos3,_t=b.pos4,Wt=b.snapRenderInfo,qt=m.props.snapRenderThreshold,Jt=qt===void 0?1:qt;if(!Wt||!Wt.render||!eo(m,""))return[];b.guidelines=yd(m);var Ut=Math.min(J[0],lt[0],xt[0],_t[0]),xe=Math.min(J[1],lt[1],xt[1],_t[1]),Ce=Wt.externalPoses||[],Ue=Kl(m.state),en=[],dn=[],Rn=[],nr=[],Kn=[],Sr=Rl(Ue),jn=Sr.width,pr=Sr.height,zr=Sr.top,Er=Sr.left,oa=Sr.bottom,Gr=Sr.right,wa={left:Er,right:Gr,top:zr,bottom:oa,center:(Er+Gr)/2,middle:(zr+oa)/2},va=Ce.length>0,Ua=va?Rl(Ce):{};if(!Wt.request){if(Wt.direction&&Kn.push(Th(m,Ue,Wt.direction,Jt)),Wt.snap){var Ja=Rl(Ue);Wt.center&&(Ja.middle=(Ja.top+Ja.bottom)/2,Ja.center=(Ja.left+Ja.right)/2),Kn.push(Ih(m,Ja,Jt))}va&&(Wt.center&&(Ua.middle=(Ua.top+Ua.bottom)/2,Ua.center=(Ua.left+Ua.right)/2),Kn.push(Ih(m,Ua,Jt))),Kn.forEach(function(li){var ti=li.vertical.posInfos,ao=li.horizontal.posInfos;en.push.apply(en,ti.filter(function($o){var Oo=$o.guidelineInfos;return Oo.some(function(Ss){var mo=Ss.guideline;return!mo.hide})}).map(function($o){return{type:"snap",pos:$o.pos}})),dn.push.apply(dn,ao.filter(function($o){var Oo=$o.guidelineInfos;return Oo.some(function(Ss){var mo=Ss.guideline;return!mo.hide})}).map(function($o){return{type:"snap",pos:$o.pos}})),Rn.push.apply(Rn,Zl(ti)),nr.push.apply(nr,Zl(ao))})}ce(m,[Er,Gr],[zr,oa],en,dn),va&&ce(m,[Ua.left,Ua.right],[Ua.top,Ua.bottom],en,dn,Wt.externalBounds);var Li=Ar(Ar([],Rn,!0),nr,!0),Zi=Li.filter(function(li){return li.element&&!li.gapRects}),Oi=Li.filter(function(li){return li.gapRects}).sort(function(li,ti){return li.gap-ti.gap});return Sn(m,"onSnap",{guidelines:Li.filter(function(li){var ti=li.element;return!ti}),elements:Zi,gaps:Oi},!0),Ar(Ar(Ar(Ar(Ar(Ar([],Mv(m,Zi,[Ut,xe],wa,y),!0),Nv(m,Oi,[Ut,xe],wa,y),!0),Av(m,"horizontal",nr,[D,S],wa,y),!0),Av(m,"vertical",Rn,[D,S],wa,y),!0),Qp(m,"horizontal",dn,Ut,S,jn,0,y),!0),Qp(m,"vertical",en,xe,D,pr,1,y),!0)},dragStart:function(m,y){m.state.snapRenderInfo={request:y.isRequest,snap:!0,center:!0},rv(m)},drag:function(m){var y=m.state;rv(m)||(y.guidelines=yd(m)),y.snapRenderInfo&&(y.snapRenderInfo.render=!0)},pinchStart:function(m){this.unset(m)},dragEnd:function(m){this.unset(m)},dragControlCondition:function(m,y){if(vn(m,y)||he(m,y))return!0;if(!y.isRequest&&y.inputEvent)return ha(y.inputEvent.target,Vi("snap-control"))},dragControlStart:function(m){m.state.snapRenderInfo=null,rv(m)},dragControl:function(m){this.drag(m)},dragControlEnd:function(m){this.unset(m)},dragGroupStart:function(m,y){this.dragStart(m,y)},dragGroup:function(m){this.drag(m)},dragGroupEnd:function(m){this.unset(m)},dragGroupControlStart:function(m){m.state.snapRenderInfo=null,rv(m)},dragGroupControl:function(m){this.drag(m)},dragGroupControlEnd:function(m){this.unset(m)},unset:function(m){var y=m.state;y.enableSnap=!1,y.guidelines=[],y.snapRenderInfo=null,y.elementRects=[]}};function ia(m,y,b,S){var D=m.getState(),J=D.renderPoses,lt=D.rotation,xt=D.direction,_t=gf(m.props,y).zoom,Wt=xt>0?1:-1,qt=lt/Math.PI*180,Jt={},Ut=m.renderState;Ut.renderDirectionMap||(Ut.renderDirectionMap={});var xe=Ut.renderDirectionMap;return b.forEach(function(Ce){var Ue=Ce.dir;Jt[Ue]=!0}),b.map(function(Ce){var Ue=Ce.data,en=Ce.classNames,dn=Ce.dir,Rn=sd[dn];if(!Rn||!Jt[dn])return null;xe[dn]=!0;var nr=(Ht(qt,15)+Wt*kd[dn]+720)%180,Kn={};return ta(Ue).forEach(function(Sr){Kn["data-".concat(Sr)]=Ue[Sr]}),S.createElement("div",De({className:Vi.apply(void 0,Ar(["control","direction",dn,y],en,!1)),"data-rotation":nr,"data-direction":dn},Kn,{key:"direction-".concat(dn),style:Ld.apply(void 0,Ar([lt,_t],Rn.map(function(Sr){return J[Sr]}),!1))}))})}function da(m,y,b,S){var D=gf(m.props,b),J=D.renderDirections,lt=J===void 0?y:J,xt=D.displayAroundControls;if(!lt)return[];var _t=lt===!0?ri:lt;return Ar(Ar([],xt?Ka(m,S,b,_t):[],!0),ia(m,b,_t.map(function(Wt){return{data:{},classNames:[],dir:Wt}}),S),!0)}function aa(m,y,b,S,D,J){for(var lt=[],xt=6;xt<arguments.length;xt++)lt[xt-6]=arguments[xt];var _t=Y(b,S),Wt=y?Ht(_t/Math.PI*180,15)%180:-1;return m.createElement("div",{key:"line-".concat(J),className:Vi.apply(void 0,Ar(["line","direction",y?"edge":"",y],lt,!1)),"data-rotation":Wt,"data-line-key":J,"data-direction":y,style:vf(b,S,D,_t)})}function na(m,y,b,S,D){var J=b===!0?$a:b;return J.map(function(lt,xt){var _t=sd[lt],Wt=_t[0],qt=_t[1];if(qt!=null)return aa(m,lt,S[Wt],S[qt],D,"".concat(y,"Edge").concat(xt),y)}).filter(Boolean)}function Xa(m){return function(y,b){var S=gf(y.props,m).edge;return S&&(S===!0||S.length)?Ar(Ar([],na(b,m,S,y.getState().renderPoses,y.props.zoom),!0),Qa(y,m,b),!0):Oa(y,m,b)}}function Oa(m,y,b){return da(m,ri,y,b)}function Qa(m,y,b){return da(m,["nw","ne","sw","se"],y,b)}function Ka(m,y,b,S){var D=m.renderState;D.renderDirectionMap||(D.renderDirectionMap={});var J=m.getState(),lt=J.renderPoses,xt=J.rotation,_t=J.direction,Wt=D.renderDirectionMap,qt=m.props.zoom,Jt=_t>0?1:-1,Ut=xt/Math.PI*180;return(S||ta(Wt)).map(function(xe){var Ce=sd[xe];if(!Ce)return null;var Ue=(Ht(Ut,15)+Jt*kd[xe]+720)%180,en=["around-control"];return b&&en.push("direction",b),y.createElement("div",{className:Vi.apply(void 0,en),"data-rotation":Ue,"data-direction":xe,key:"direction-around-".concat(xe),style:Ld.apply(void 0,Ar([xt,qt],Ce.map(function(dn){return lt[dn]}),!1))})})}var zn={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(m,y){var b=m.props,S=b.throttleDragRotate,D=b.zoom,J=m.getState(),lt=J.dragInfo,xt=J.beforeOrigin;if(!S||!lt)return[];var _t=lt.dist;if(!_t[0]&&!_t[1])return[];var Wt=Hc(_t),qt=Y(_t,[0,0]);return[y.createElement("div",{className:Vi("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(Wt,"px"),transform:"translate(".concat(xt[0],"px, ").concat(xt[1],"px) rotate(").concat(qt,"rad) scaleY(").concat(D,")")}})]},dragStart:function(m,y){var b=y.datas,S=y.parentEvent,D=y.parentGesto,J=m.state,lt=J.gestos,xt=J.style;if(lt.draggable)return!1;lt.draggable=D||m.targetGesto,b.datas={},b.left=parseFloat(xt.left||"")||0,b.top=parseFloat(xt.top||"")||0,b.bottom=parseFloat(xt.bottom||"")||0,b.right=parseFloat(xt.right||"")||0,b.startValue=[0,0],eh(m,y),Se(y,"translate"),Cp(m,b),b.prevDist=[0,0],b.prevBeforeDist=[0,0],b.isDrag=!1,b.deltaOffset=[0,0];var _t=Os(m,y,De({set:function(qt){b.startValue=qt}},ne(y))),Wt=S||Sn(m,"onDragStart",_t);return Wt!==!1?(b.isDrag=!0,m.state.dragInfo={startRect:m.getRect(),dist:[0,0]}):(lt.draggable=null,b.isPinch=!1),b.isDrag?_t:!1},drag:function(m,y){if(!!y){Oc(y,"translate");var b=y.datas,S=y.parentEvent,D=y.parentFlag,J=y.isPinch,lt=y.isRequest,xt=y.deltaOffset,_t=y.distX,Wt=y.distY,qt=b.isDrag,Jt=b.prevDist,Ut=b.prevBeforeDist,xe=b.startValue;if(!!qt){xt&&(_t+=xt[0],Wt+=xt[1]);var Ce=m.props,Ue=Ce.parentMoveable,en=S?0:Ce.throttleDrag||0,dn=S?0:Ce.throttleDragRotate||0,Rn=0,nr=!1,Kn=!1,Sr=!1,jn=!1;if(!S&&dn>0&&(_t||Wt)){var pr=Ce.startDragRotate||0,zr=Ht(pr+Y([0,0],[_t,Wt])*180/Math.PI,dn)-pr,Er=Wt*Math.abs(Math.cos((zr-90)/180*Math.PI)),oa=_t*Math.abs(Math.cos(zr/180*Math.PI)),Gr=Hc([oa,Er]);Rn=zr*Math.PI/180,_t=Gr*Math.cos(Rn),Wt=Gr*Math.sin(Rn)}if(!J&&!S&&!D){var wa=kv(m,_t,Wt,dn,lt||xt,b),va=wa[0],Ua=wa[1];nr=va.isSnap,Kn=va.isBound,Sr=Ua.isSnap,jn=Ua.isBound;var Ja=va.offset,Li=Ua.offset;_t+=Ja,Wt+=Li}var Zi=wi(cs({datas:b,distX:_t,distY:Wt}),xe),Oi=wi(Pi({datas:b,distX:_t,distY:Wt}),xe);re(Oi,Ou),re(Zi,Ou),dn||(!nr&&!Kn&&(Oi[0]=Ht(Oi[0],en),Zi[0]=Ht(Zi[0],en)),!Sr&&!jn&&(Oi[1]=Ht(Oi[1],en),Zi[1]=Ht(Zi[1],en)));var li=gi(Zi,xe),ti=gi(Oi,xe),ao=gi(ti,Jt),$o=gi(li,Ut);b.prevDist=ti,b.prevBeforeDist=li,b.passDelta=ao,b.passDist=ti;var Oo=b.left+li[0],Ss=b.top+li[1],mo=b.right-li[0],So=b.bottom-li[1],fs=vh(b,"translate(".concat(Oi[0],"px, ").concat(Oi[1],"px)"),"translate(".concat(ti[0],"px, ").concat(ti[1],"px)"));if(yn(y,fs),m.state.dragInfo.dist=S?[0,0]:ti,!(!S&&!Ue&&ao.every(function(Cu){return!Cu})&&$o.some(function(Cu){return!Cu}))){var As=m.state,qs=As.width,Ko=As.height,Ho=Os(m,y,De({transform:fs,dist:ti,delta:ao,translate:Oi,beforeDist:li,beforeDelta:$o,beforeTranslate:Zi,left:Oo,top:Ss,right:mo,bottom:So,width:qs,height:Ko,isPinch:J},Ml({transform:fs},y)));return!S&&Sn(m,"onDrag",Ho),Ho}}}},dragAfter:function(m,y){var b=y.datas,S=b.deltaOffset;return S[0]||S[1]?(b.deltaOffset=[0,0],this.drag(m,De(De({},y),{deltaOffset:S}))):!1},dragEnd:function(m,y){var b=y.parentEvent,S=y.datas;if(m.state.dragInfo=null,!!S.isDrag){S.isDrag=!1;var D=Ll(m,y,{});return!b&&Sn(m,"onDragEnd",D),D}},dragGroupStart:function(m,y){var b=y.datas,S=y.clientX,D=y.clientY,J=this.dragStart(m,y);if(!J)return!1;var lt=uh(m,this,"dragStart",[S||0,D||0],y,!1,"draggable"),xt=De(De({},J),{targets:m.props.targets,events:lt}),_t=Sn(m,"onDragGroupStart",xt);return b.isDrag=_t!==!1,b.isDrag?J:!1},dragGroup:function(m,y){var b=y.datas;if(!!b.isDrag){var S=this.drag(m,y),D=y.datas.passDelta,J=uh(m,this,"drag",D,y,!1,"draggable");if(!!S){var lt=De({targets:m.props.targets,events:J},S);return Sn(m,"onDragGroup",lt),lt}}},dragGroupEnd:function(m,y){var b=y.isDrag,S=y.datas;if(!!S.isDrag){this.dragEnd(m,y);var D=uh(m,this,"dragEnd",[0,0],y,!1,"draggable");return Sn(m,"onDragGroupEnd",Ll(m,y,{targets:m.props.targets,events:D})),b}},request:function(m){var y={},b=m.getRect(),S=0,D=0;return{isControl:!1,requestStart:function(){return{datas:y}},request:function(J){return"x"in J?S=J.x-b.left:"deltaX"in J&&(S+=J.deltaX),"y"in J?D=J.y-b.top:"deltaY"in J&&(D+=J.deltaY),{datas:y,distX:S,distY:D}},requestEnd:function(){return{datas:y,isDrag:!0}}}},unset:function(m){m.state.gestos.draggable=null,m.state.dragInfo=null}},N=cd("resizable"),q={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:Xa("resizable"),dragControlCondition:N,viewClassName:bp("resizable"),dragControlStart:function(m,y){var b,S=y.inputEvent,D=y.isPinch,J=y.isGroup,lt=y.parentDirection,xt=y.parentGesto,_t=y.datas,Wt=y.parentFixedDirection,qt=y.parentEvent,Jt=Up(lt,D,S,_t),Ut=m.state,xe=Ut.target,Ce=Ut.width,Ue=Ut.height,en=Ut.gestos;if(!Jt||!xe||en.resizable)return!1;en.resizable=xt||m.controlGesto,!D&&eh(m,y),_t.datas={},_t.direction=Jt,_t.startOffsetWidth=Ce,_t.startOffsetHeight=Ue,_t.prevWidth=0,_t.prevHeight=0,_t.minSize=[0,0],_t.startWidth=Ut.inlineCSSWidth||Ut.cssWidth,_t.startHeight=Ut.inlineCSSHeight||Ut.cssHeight,_t.maxSize=[Infinity,Infinity],J||(_t.minSize=[Ut.minOffsetWidth,Ut.minOffsetHeight],_t.maxSize=[Ut.maxOffsetWidth,Ut.maxOffsetHeight]);var dn=m.props.transformOrigin||"% %";_t.transformOrigin=dn&&Yn(dn)?dn.split(" "):dn,_t.startOffsetMatrix=Ut.offsetMatrix,_t.startTransformOrigin=Ut.transformOrigin,_t.isWidth=(b=y==null?void 0:y.parentIsWidth)!==null&&b!==void 0?b:!Jt[0]&&!Jt[1]||Jt[0]||!Jt[1];function Rn(Er){_t.ratio=Er&&isFinite(Er)?Er:0}_t.startPositions=Kl(m.state);function nr(Er){_t.fixedDirection=Er,_t.fixedPosition=Nu(_t.startPositions,Er)}function Kn(Er){var oa=m.state,Gr=oa.width,wa=oa.height;_t.fixedPosition=Er,_t.fixedDirection=Mo(Er,Gr,wa)}function Sr(Er){_t.minSize=[_n("".concat(Er[0]),0)||0,_n("".concat(Er[1]),0)||0]}function jn(Er){var oa=[Er[0]||Infinity,Er[1]||Infinity];(!Un(oa[0])||isFinite(oa[0]))&&(oa[0]=_n("".concat(oa[0]),0)||Infinity),(!Un(oa[1])||isFinite(oa[1]))&&(oa[1]=_n("".concat(oa[1]),0)||Infinity),_t.maxSize=oa}Rn(Ce/Ue),nr(Wt||[-Jt[0],-Jt[1]]),_t.setFixedDirection=nr,_t.setFixedPosition=Kn,_t.setMin=Sr,_t.setMax=jn;var pr=Os(m,y,{direction:Jt,startRatio:_t.ratio,set:function(Er){var oa=Er[0],Gr=Er[1];_t.startWidth=oa,_t.startHeight=Gr},setMin:Sr,setMax:jn,setRatio:Rn,setFixedDirection:nr,setFixedPosition:Kn,setOrigin:function(Er){_t.transformOrigin=Er},dragStart:zn.dragStart(m,new If().dragStart([0,0],y))}),zr=qt||Sn(m,"onResizeStart",pr);return _t.startFixedDirection=_t.fixedDirection,_t.startFixedPosition=_t.fixedPosition,zr!==!1&&(_t.isResize=!0,m.state.snapRenderInfo={request:y.isRequest,direction:Jt}),_t.isResize?pr:!1},dragControl:function(m,y){var b,S=y.datas,D=y.parentFlag,J=y.isPinch,lt=y.parentKeepRatio,xt=y.dragClient,_t=y.parentDist,Wt=y.isRequest,qt=y.isGroup,Jt=y.parentEvent,Ut=y.resolveMatrix,xe=S.isResize,Ce=S.transformOrigin,Ue=S.startWidth,en=S.startHeight,dn=S.prevWidth,Rn=S.prevHeight,nr=S.minSize,Kn=S.maxSize,Sr=S.ratio,jn=S.startOffsetWidth,pr=S.startOffsetHeight,zr=S.isWidth;if(!xe)return;if(Ut){var Er=m.state.is3d,oa=S.startOffsetMatrix,Gr=S.startTransformOrigin,wa=Er?4:3,va=Ys(Ir(y)),Ua=Math.sqrt(va.length);wa!==Ua&&(va=ts(va,Ua,wa));var Ja=mh(oa,va,Gr,wa),Li=Fc(Ja,jn,pr,wa);S.startPositions=Li,S.nextTargetMatrix=va,S.nextAllMatrix=Ja}var Zi=gf(m.props,"resizable"),Oi=Zi.resizeFormat,li=Zi.throttleResize,ti=li===void 0?D?0:1:li,ao=Zi.parentMoveable,$o=Zi.keepRatioFinally,Oo=S.direction,Ss=Oo,mo=0,So=0;!Oo[0]&&!Oo[1]&&(Ss=[1,1]);var fs=Sr&&(lt!=null?lt:Zi.keepRatio)||!1;function As(){var lc=S.fixedDirection,mf=Eh(Ss,fs,S,y);mo=mf.distWidth,So=mf.distHeight;var Jh=Ss[0]-lc[0]||fs?Math.max(jn+mo,Ou):jn,Ip=Ss[1]-lc[1]||fs?Math.max(pr+So,Ou):pr;return fs&&jn&&pr&&(zr?Ip=Jh/Sr:Jh=Ip*Sr),[Jh,Ip]}var qs=As(),Ko=qs[0],Ho=qs[1];Jt||(S.setFixedDirection(S.fixedDirection),Sn(m,"onBeforeResize",Os(m,y,{startFixedDirection:S.startFixedDirection,startFixedPosition:S.startFixedPosition,setFixedDirection:function(lc){var mf;return S.setFixedDirection(lc),mf=As(),Ko=mf[0],Ho=mf[1],[Ko,Ho]},setFixedPosition:function(lc){var mf;return S.setFixedPosition(lc),mf=As(),Ko=mf[0],Ho=mf[1],[Ko,Ho]},boundingWidth:Ko,boundingHeight:Ho,setSize:function(lc){Ko=lc[0],Ho=lc[1]}},!0)));var Cu=xt;xt||(!D&&J?Cu=jo(m,[0,0]):Cu=S.fixedPosition);var Xs=[0,0];J||(Xs=ag(m,Ko,Ho,Oo,Cu,Wt,S)),_t&&(!_t[0]&&(Xs[0]=0),!_t[1]&&(Xs[1]=0));function jl(){var lc;Oi&&(lc=Oi([Ko,Ho]),Ko=lc[0],Ho=lc[1]),Ko=Ht(Ko,ti),Ho=Ht(Ho,ti)}if(fs){Ss[0]&&Ss[1]&&Xs[0]&&Xs[1]&&(Math.abs(Xs[0])>Math.abs(Xs[1])?Xs[1]=0:Xs[0]=0);var _u=!Xs[0]&&!Xs[1];_u&&jl(),Ss[0]&&!Ss[1]||Xs[0]&&!Xs[1]||_u&&zr?(Ko+=Xs[0],Ho=Ko/Sr):(!Ss[0]&&Ss[1]||!Xs[0]&&Xs[1]||_u&&!zr)&&(Ho+=Xs[1],Ko=Ho*Sr)}else Ko+=Xs[0],Ho+=Xs[1],Ko=Math.max(0,Ko),Ho=Math.max(0,Ho);b=kt([Ko,Ho],nr,Kn,fs?Sr:!1),Ko=b[0],Ho=b[1],jl(),fs&&(qt||$o)&&(zr?Ho=Ko/Sr:Ko=Ho*Sr),mo=Ko-jn,So=Ho-pr;var hu=[mo-dn,So-Rn];S.prevWidth=mo,S.prevHeight=So;var yl=so(m,Ko,Ho,Cu,Ce,S);if(!(!ao&&hu.every(function(lc){return!lc})&&yl.every(function(lc){return!lc}))){var du=zn.drag(m,$f(y,m.state,yl,!!J,!1,"draggable")),Us=du.transform,Pu=Ue+mo,fh=en+So,ov=Os(m,y,De({width:Pu,height:fh,offsetWidth:Math.round(Ko),offsetHeight:Math.round(Ho),startRatio:Sr,boundingWidth:Ko,boundingHeight:Ho,direction:Oo,dist:[mo,So],delta:hu,isPinch:!!J,drag:du},ah({style:{width:"".concat(Pu,"px"),height:"".concat(fh,"px")},transform:Us},du,y)));return!Jt&&Sn(m,"onResize",ov),ov}},dragControlAfter:function(m,y){var b=y.datas,S=b.isResize,D=b.startOffsetWidth,J=b.startOffsetHeight,lt=b.prevWidth,xt=b.prevHeight;if(!(!S||m.props.checkResizableError===!1)){var _t=m.state,Wt=_t.width,qt=_t.height,Jt=Wt-(D+lt),Ut=qt-(J+xt),xe=Math.abs(Jt)>3,Ce=Math.abs(Ut)>3;if(xe&&(b.startWidth+=Jt,b.startOffsetWidth+=Jt,b.prevWidth+=Jt),Ce&&(b.startHeight+=Ut,b.startOffsetHeight+=Ut,b.prevHeight+=Ut),xe||Ce)return this.dragControl(m,y)}},dragControlEnd:function(m,y){var b=y.datas,S=y.parentEvent;if(!!b.isResize){b.isResize=!1;var D=Ll(m,y,{});return!S&&Sn(m,"onResizeEnd",D),D}},dragGroupControlCondition:N,dragGroupControlStart:function(m,y){var b=y.datas,S=this.dragControlStart(m,De(De({},y),{isGroup:!0}));if(!S)return!1;var D=Fl(m,"resizable",y),J=b.startOffsetWidth,lt=b.startOffsetHeight;function xt(){var xe=b.minSize;D.forEach(function(Ce){var Ue=Ce.datas,en=Ue.minSize,dn=Ue.startOffsetWidth,Rn=Ue.startOffsetHeight,nr=J*(dn?en[0]/dn:0),Kn=lt*(Rn?en[1]/Rn:0);xe[0]=Math.max(xe[0],nr),xe[1]=Math.max(xe[1],Kn)})}function _t(){var xe=b.maxSize;D.forEach(function(Ce){var Ue=Ce.datas,en=Ue.maxSize,dn=Ue.startOffsetWidth,Rn=Ue.startOffsetHeight,nr=J*(dn?en[0]/dn:0),Kn=lt*(Rn?en[1]/Rn:0);xe[0]=Math.min(xe[0],nr),xe[1]=Math.min(xe[1],Kn)})}var Wt=Sh(m,this,"dragControlStart",y,function(xe,Ce){return Ch(m,xe,b,Ce)});xt(),_t();var qt=function(xe){S.setFixedDirection(xe),Wt.forEach(function(Ce,Ue){Ce.setFixedDirection(xe),Ch(m,Ce.moveable,b,D[Ue])})};b.setFixedDirection=qt;var Jt=De(De({},S),{targets:m.props.targets,events:Wt.map(function(xe){return De(De({},xe),{setMin:function(Ce){xe.setMin(Ce),xt()},setMax:function(Ce){xe.setMax(Ce),_t()}})}),setFixedDirection:qt,setMin:function(xe){S.setMin(xe),xt()},setMax:function(xe){S.setMax(xe),_t()}}),Ut=Sn(m,"onResizeGroupStart",Jt);return b.isResize=Ut!==!1,b.isResize?S:!1},dragGroupControl:function(m,y){var b=y.datas;if(!!b.isResize){var S=gf(m.props,"resizable");of(m,"onBeforeResize",function(xe){Sn(m,"onBeforeResizeGroup",Os(m,y,De(De({},xe),{targets:S.targets}),!0))});var D=this.dragControl(m,De(De({},y),{isGroup:!0}));if(!!D){var J=D.boundingWidth,lt=D.boundingHeight,xt=D.dist,_t=S.keepRatio,Wt=[J/(J-xt[0]),lt/(lt-xt[1])],qt=b.fixedPosition,Jt=Sh(m,this,"dragControl",y,function(xe,Ce){var Ue=Io(qo(m.rotation/180*Math.PI,3),[Ce.datas.originalX*Wt[0],Ce.datas.originalY*Wt[1],1],3),en=Ue[0],dn=Ue[1];return De(De({},Ce),{parentDist:null,parentScale:Wt,dragClient:wi(qt,[en,dn]),parentKeepRatio:_t})}),Ut=De({targets:S.targets,events:Jt},D);return Sn(m,"onResizeGroup",Ut),Ut}}},dragGroupControlEnd:function(m,y){var b=y.isDrag,S=y.datas;if(!!S.isResize){this.dragControlEnd(m,y);var D=Sh(m,this,"dragControlEnd",y),J=Ll(m,y,{targets:m.props.targets,events:D});return Sn(m,"onResizeGroupEnd",J),b}},request:function(m){var y={},b=0,S=0,D=m.getRect();return{isControl:!0,requestStart:function(J){var lt;return{datas:y,parentDirection:J.direction||[1,1],parentIsWidth:(lt=J==null?void 0:J.horizontal)!==null&&lt!==void 0?lt:!0}},request:function(J){return"offsetWidth"in J?b=J.offsetWidth-D.offsetWidth:"deltaWidth"in J&&(b+=J.deltaWidth),"offsetHeight"in J?S=J.offsetHeight-D.offsetHeight:"deltaHeight"in J&&(S+=J.deltaHeight),{datas:y,parentDist:[b,S],parentKeepRatio:J.keepRatio}},requestEnd:function(){return{datas:y,isDrag:!0}}}},unset:function(m){m.state.gestos.resizable=null}};function ht(m,y,b,S,D){var J=m.props.groupable,lt=m.state,xt=lt.is3d?4:3,_t=y.origin,Wt=Ru(m.state.rootMatrix,gi([_t[0],_t[1]],J?[0,0]:[lt.left,lt.top]),xt),qt=wi([D.left,D.top],Wt);y.startAbsoluteOrigin=qt,y.prevDeg=Y(qt,[b,S])/Math.PI*180,y.defaultDeg=y.prevDeg,y.prevSnapDeg=0,y.loop=0,y.startDist=jt(qt,[b,S])}function It(m,y,b){var S=b.defaultDeg,D=b.prevDeg,J=D%360,lt=Math.floor(D/360);J<0&&(J+=360),J>m&&J>270&&m<90?++lt:J<m&&J<90&&m>270&&--lt;var xt=y*(lt*360+m-S);return b.prevDeg=S+xt,xt}function Ft(m,y,b,S){return It(Y(S.startAbsoluteOrigin,[m,y])/Math.PI*180,b,S)}function Xt(m,y,b,S,D,J){var lt=m.props.throttleRotate,xt=lt===void 0?0:lt,_t=b.prevSnapDeg,Wt=0,qt=!1;if(J){var Jt=jf(m,y,S);qt=Jt.isSnap,Wt=D+Jt.rotation}qt||(Wt=Ht(D+S,xt));var Ut=Wt-D;return b.prevSnapDeg=Ut,[Ut-_t,Ut,Wt]}function oe(m,y,b){var S=y[0],D=y[1],J=y[2],lt=y[3];if(m==="none")return[];if(Rt(m))return m.map(function(Ue){return oe(Ue,[S,D,J,lt],b)[0]});var xt=(m||"top").split("-"),_t=xt[0],Wt=xt[1],qt=[S,D];_t==="left"?qt=[J,S]:_t==="right"?qt=[D,lt]:_t==="bottom"&&(qt=[lt,J]);var Jt=[(qt[0][0]+qt[1][0])/2,(qt[0][1]+qt[1][1])/2],Ut=mp(qt,b);if(Wt){var xe=Wt==="top"||Wt==="left",Ce=_t==="bottom"||_t==="left";Jt=qt[xe&&!Ce||!xe&&Ce?0:1]}return[[Jt,Ut]]}function he(m,y){if(y.isRequest)return y.requestAble==="rotatable";var b=y.inputEvent.target;if(ha(b,Vi("rotation-control"))||m.props.rotateAroundControls&&ha(b,Vi("around-control"))||ha(b,Vi("control"))&&ha(b,Vi("rotatable")))return!0;var S=m.props.rotationTarget;return S?wh(S,!0).some(function(D){return D?b===D||b.contains(D):!1}):!1}var Te=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,Ye={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[Te],viewClassName:function(m){return m.isDragging("rotatable")?Vi("view-rotation-dragging"):""},render:function(m,y){var b=gf(m.props,"rotatable"),S=b.rotatable,D=b.rotationPosition,J=b.zoom,lt=b.renderDirections,xt=b.rotateAroundControls,_t=b.resolveAblesWithRotatable,Wt=m.getState(),qt=Wt.renderPoses,Jt=Wt.direction;if(!S)return null;var Ut=oe(D,qt,Jt),xe=[];if(Ut.forEach(function(dn,Rn){var nr=dn[0],Kn=dn[1];xe.push(y.createElement("div",{key:"rotation".concat(Rn),className:Vi("rotation"),style:{transform:"translate(-50%) translate(".concat(nr[0],"px, ").concat(nr[1],"px) rotate(").concat(Kn,"rad)")}},y.createElement("div",{className:Vi("line rotation-line"),style:{transform:"scaleX(".concat(J,")")}}),y.createElement("div",{className:Vi("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(J,")")}})))}),lt){var Ce=ta(_t||{}),Ue={};Ce.forEach(function(dn){_t[dn].forEach(function(Rn){Ue[Rn]=dn})});var en=[];Rt(lt)&&(en=lt.map(function(dn){var Rn=Ue[dn];return{data:Rn?{resolve:Rn}:{},classNames:Rn?["move"]:[],dir:dn}})),xe.push.apply(xe,ia(m,"rotatable",en,y))}return xt&&xe.push.apply(xe,Ka(m,y)),xe},dragControlCondition:he,dragControlStart:function(m,y){var b,S,D=y.datas,J=y.clientX,lt=y.clientY,xt=y.parentRotate,_t=y.parentFlag,Wt=y.isPinch,qt=y.isRequest,Jt=m.state,Ut=Jt.target,xe=Jt.left,Ce=Jt.top,Ue=Jt.direction,en=Jt.beforeDirection,dn=Jt.targetTransform,Rn=Jt.moveableClientRect,nr=Jt.offsetMatrix,Kn=Jt.targetMatrix,Sr=Jt.allMatrix,jn=Jt.width,pr=Jt.height;if(!qt&&!Ut)return!1;var zr=m.getRect();D.rect=zr,D.transform=dn,D.left=xe,D.top=Ce;var Er=function(mo){var So=m.state,fs=So.allMatrix,As=So.is3d,qs=So.width,Ko=So.height,Ho=Mo(mo,qs,Ko);D.fixedDirection=Ho,D.fixedPosition=Ru(fs,mo,As?4:3),ao&&ao.setFixedPosition(mo)},oa=function(mo){D.fixedDirection=mo,D.fixedPosition=rs(m,mo),ao&&ao.setFixedDirection(mo)},Gr=J,wa=lt;if(qt||Wt||_t){var va=xt||0;D.beforeInfo={origin:zr.beforeOrigin,prevDeg:va,defaultDeg:va,prevSnapDeg:0,startDist:0},D.afterInfo=De(De({},D.beforeInfo),{origin:zr.origin}),D.absoluteInfo=De(De({},D.beforeInfo),{origin:zr.origin,startValue:va})}else{var Ua=(S=y.inputEvent)===null||S===void 0?void 0:S.target;if(Ua){var Ja=Ua.getAttribute("data-direction")||"",Li=$p[Ja];if(Li){D.isControl=!0,D.isAroundControl=ha(Ua,Vi("around-control")),D.controlDirection=Li;var Zi=Ua.getAttribute("data-resolve");Zi&&(D.resolveAble=Zi);var Oi=jh(Jt.rootMatrix,Jt.renderPoses,Rn);b=Nu(Oi,Li),Gr=b[0],wa=b[1]}}D.beforeInfo={origin:zr.beforeOrigin},D.afterInfo={origin:zr.origin},D.absoluteInfo={origin:zr.origin,startValue:zr.rotation};var li=Er;Er=function(mo){var So=Jt.is3d?4:3,fs=wi(oo(Kn,So),mo),As=fs[0],qs=fs[1],Ko=Io(nr,bo([As,qs],So)),Ho=Io(Sr,bo([mo[0],mo[1]],So));li(mo);var Cu=Jt.posDelta;D.beforeInfo.origin=gi(Ko,Cu),D.afterInfo.origin=gi(Ho,Cu),D.absoluteInfo.origin=gi(Ho,Cu),ht(m,D.beforeInfo,Gr,wa,Rn),ht(m,D.afterInfo,Gr,wa,Rn),ht(m,D.absoluteInfo,Gr,wa,Rn)},oa=function(mo){var So=Nu([[0,0],[jn,0],[0,pr],[jn,pr]],mo);Er(So)}}D.startClientX=Gr,D.startClientY=wa,D.direction=Ue,D.beforeDirection=en,D.startValue=0,D.datas={},Se(y,"rotate");var ti=!1,ao=!1;if(D.isControl&&D.resolveAble){var $o=D.resolveAble;$o==="resizable"&&(ao=q.dragControlStart(m,De(De({},new If("resizable").dragStart([0,0],y)),{parentPosition:D.controlPosition,parentFixedPosition:D.fixedPosition})))}ao||(ti=zn.dragStart(m,new If().dragStart([0,0],y))),Er(Jt.transformOrigin);var Oo=Os(m,y,De(De({set:function(mo){D.startValue=mo*Math.PI/180},setFixedDirection:oa,setFixedPosition:Er},ne(y)),{dragStart:ti,resizeStart:ao})),Ss=Sn(m,"onRotateStart",Oo);return D.isRotate=Ss!==!1,Jt.snapRenderInfo={request:y.isRequest},D.isRotate?Oo:!1},dragControl:function(m,y){var b,S,D,J=y.datas,lt=y.clientDistX,xt=y.clientDistY,_t=y.parentRotate,Wt=y.parentFlag,qt=y.isPinch,Jt=y.groupDelta,Ut=y.resolveMatrix,xe=J.beforeDirection,Ce=J.beforeInfo,Ue=J.afterInfo,en=J.absoluteInfo,dn=J.isRotate,Rn=J.startValue,nr=J.rect,Kn=J.startClientX,Sr=J.startClientY;if(!!dn){Oc(y,"rotate");var jn=Gp(y),pr=xe*jn,zr=m.props.parentMoveable,Er=0,oa,Gr,wa=0,va,Ua,Ja=0,Li,Zi,Oi=180/Math.PI*Rn,li=en.startValue,ti=!1,ao=Kn+lt,$o=Sr+xt;if(!Wt&&"parentDist"in y){var Oo=y.parentDist;oa=Oo,va=Oo,Li=Oo}else qt||Wt?(oa=It(_t,xe,Ce),va=It(_t,pr,Ue),Li=It(_t,pr,en)):(oa=Ft(ao,$o,xe,Ce),va=Ft(ao,$o,pr,Ue),Li=Ft(ao,$o,pr,en),ti=!0);if(Gr=Oi+oa,Ua=Oi+va,Zi=li+Li,Sn(m,"onBeforeRotate",Os(m,y,{beforeRotation:Gr,rotation:Ua,absoluteRotation:Zi,setRotation:function(Xs){va=Xs-Oi,oa=va,Li=va}},!0)),b=Xt(m,nr,Ce,oa,Oi,ti),Er=b[0],oa=b[1],Gr=b[2],S=Xt(m,nr,Ue,va,Oi,ti),wa=S[0],va=S[1],Ua=S[2],D=Xt(m,nr,en,Li,li,ti),Ja=D[0],Li=D[1],Zi=D[2],!(!Ja&&!wa&&!Er&&!zr&&!Ut)){var Ss=vh(J,"rotate(".concat(Ua,"deg)"),"rotate(".concat(va,"deg)"));Ut&&(J.fixedPosition=xi(m,J.targetAllTransform,[0,0],J));var mo=Xo(m,va,J),So=gi(wi(Jt||[0,0],mo),J.prevInverseDist||[0,0]);J.prevInverseDist=mo,J.requestValue=null;var fs=Ga(m,Ss,So,qt,y),As=fs,qs=jt([ao,$o],en.startAbsoluteOrigin)-en.startDist,Ko=void 0;if(J.resolveAble==="resizable"){var Ho=q.dragControl(m,De(De({},$f(y,m.state,[y.deltaX,y.deltaY],!!qt,!1,"resizable")),{resolveMatrix:!0,parentDistance:qs}));Ho&&(Ko=Ho,As=ah(As,Ho,y))}var Cu=Os(m,y,De(De({delta:wa,dist:va,rotate:Ua,rotation:Ua,beforeDist:oa,beforeDelta:Er,beforeRotate:Gr,beforeRotation:Gr,absoluteDist:Li,absoluteDelta:Ja,absoluteRotate:Zi,absoluteRotation:Zi,isPinch:!!qt,resize:Ko},fs),As));return Sn(m,"onRotate",Cu),Cu}}},dragControlEnd:function(m,y){var b=y.datas;if(!!b.isRotate){b.isRotate=!1;var S=Ll(m,y,{});return Sn(m,"onRotateEnd",S),S}},dragGroupControlCondition:he,dragGroupControlStart:function(m,y){var b=y.datas,S=m.state,D=S.left,J=S.top,lt=S.beforeOrigin,xt=this.dragControlStart(m,y);if(!xt)return!1;xt.set(b.beforeDirection*m.rotation);var _t=Sh(m,this,"dragControlStart",y,function(Jt,Ut){var xe=Jt.state,Ce=xe.left,Ue=xe.top,en=xe.beforeOrigin,dn=wi(gi([Ce,Ue],[D,J]),gi(en,lt));return Ut.datas.startGroupClient=dn,Ut.datas.groupClient=dn,De(De({},Ut),{parentRotate:0})}),Wt=De(De({},xt),{targets:m.props.targets,events:_t}),qt=Sn(m,"onRotateGroupStart",Wt);return b.isRotate=qt!==!1,b.isRotate?xt:!1},dragGroupControl:function(m,y){var b=y.datas;if(!!b.isRotate){of(m,"onBeforeRotate",function(Wt){Sn(m,"onBeforeRotateGroup",Os(m,y,De(De({},Wt),{targets:m.props.targets}),!0))});var S=this.dragControl(m,y);if(!!S){var D=b.beforeDirection,J=S.beforeDist,lt=J/180*Math.PI,xt=Sh(m,this,"dragControl",y,function(Wt,qt){var Jt=qt.datas.startGroupClient,Ut=qt.datas.groupClient,xe=Ut[0],Ce=Ut[1],Ue=yu(Jt,lt*D),en=Ue[0],dn=Ue[1],Rn=[en-xe,dn-Ce];return qt.datas.groupClient=[en,dn],De(De({},qt),{parentRotate:J,groupDelta:Rn})});m.rotation=D*S.beforeRotation;var _t=De({targets:m.props.targets,events:xt,set:function(Wt){m.rotation=Wt},setGroupRotation:function(Wt){m.rotation=Wt}},S);return Sn(m,"onRotateGroup",_t),_t}}},dragGroupControlEnd:function(m,y){var b=y.isDrag,S=y.datas;if(!!S.isRotate){this.dragControlEnd(m,y);var D=Sh(m,this,"dragControlEnd",y),J=Ll(m,y,{targets:m.props.targets,events:D});return Sn(m,"onRotateGroupEnd",J),b}},request:function(m){var y={},b=0,S=m.getRotation();return{isControl:!0,requestStart:function(){return{datas:y}},request:function(D){return"deltaRotate"in D?b+=D.deltaRotate:"rotate"in D&&(b=D.rotate-S),{datas:y,parentDist:b}},requestEnd:function(){return{datas:y,isDrag:!0}}}}},gn=cd("scalable"),cn={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:Xa("scalable"),dragControlCondition:gn,viewClassName:bp("scalable"),dragControlStart:function(m,y){var b=y.datas,S=y.isPinch,D=y.inputEvent,J=y.parentDirection,lt=Up(J,S,D,b),xt=m.state,_t=xt.width,Wt=xt.height,qt=xt.targetTransform,Jt=xt.target,Ut=xt.pos1,xe=xt.pos2,Ce=xt.pos4;if(!lt||!Jt)return!1;S||eh(m,y),b.datas={},b.transform=qt,b.prevDist=[1,1],b.direction=lt,b.startOffsetWidth=_t,b.startOffsetHeight=Wt,b.startValue=[1,1];var Ue=jt(Ut,xe),en=jt(xe,Ce),dn=!lt[0]&&!lt[1]||lt[0]||!lt[1];b.scaleWidth=Ue,b.scaleHeight=en,b.scaleXRatio=Ue/_t,b.scaleYRatio=en/Wt,Se(y,"scale"),b.isWidth=dn;function Rn(jn){b.ratio=jn&&isFinite(jn)?jn:0}b.startPositions=Kl(m.state);function nr(jn){b.fixedDirection=jn,b.fixedPosition=Nu(b.startPositions,jn)}b.setFixedDirection=nr,Rn(jt(Ut,xe)/jt(xe,Ce)),nr([-lt[0],-lt[1]]);var Kn=Os(m,y,De(De({direction:lt,set:function(jn){b.startValue=jn},setRatio:Rn,setFixedDirection:nr},ne(y)),{dragStart:zn.dragStart(m,new If().dragStart([0,0],y))})),Sr=Sn(m,"onScaleStart",Kn);return b.startFixedDirection=b.fixedDirection,Sr!==!1&&(b.isScale=!0,m.state.snapRenderInfo={request:y.isRequest,direction:lt}),b.isScale?Kn:!1},dragControl:function(m,y){Oc(y,"scale");var b=y.datas,S=y.parentKeepRatio,D=y.parentFlag,J=y.isPinch,lt=y.dragClient,xt=y.isRequest,_t=y.resolveMatrix,Wt=b.prevDist,qt=b.direction,Jt=b.startOffsetWidth,Ut=b.startOffsetHeight,xe=b.isScale,Ce=b.startValue,Ue=b.isWidth,en=b.ratio;if(!xe)return!1;var dn=m.props,Rn=dn.throttleScale,nr=dn.parentMoveable,Kn=qt;!qt[0]&&!qt[1]&&(Kn=[1,1]);var Sr=en&&(S!=null?S:dn.keepRatio)||!1,jn=m.state;function pr(){var Oo=Eh(Kn,Sr,b,y),Ss=Oo.distWidth,mo=Oo.distHeight,So=Jt?(Jt+Ss)/Jt:1,fs=Ut?(Ut+mo)/Ut:1;return So=Kn[0]||Sr?So*Ce[0]:Ce[0],fs=Kn[1]||Sr?fs*Ce[1]:Ce[1],So===0&&(So=(Wt[0]>0?1:-1)*Uc),fs===0&&(fs=(Wt[1]>0?1:-1)*Uc),[So,fs]}var zr=pr();if(!J&&m.props.groupable){var Er=jn.snapRenderInfo||{},oa=Er.direction;Rt(oa)&&(oa[0]||oa[1])&&(jn.snapRenderInfo={direction:qt,request:y.isRequest})}Sn(m,"onBeforeScale",Os(m,y,{scale:zr,setFixedDirection:function(Oo){return b.setFixedDirection(Oo),zr=pr(),zr},startFixedDirection:b.startFixedDirection,setScale:function(Oo){zr=Oo}},!0));var Gr=[zr[0]/Ce[0],zr[1]/Ce[1]],wa=lt,va=[0,0],Ua=!lt&&!D&&J;if(Ua||_t?wa=xi(m,b.targetAllTransform,[0,0],b):lt||(wa=b.fixedPosition),J||(va=Ov(m,Gr,qt,xt,b)),Sr){Kn[0]&&Kn[1]&&va[0]&&va[1]&&(Math.abs(va[0]*Jt)>Math.abs(va[1]*Ut)?va[1]=0:va[0]=0);var Ja=!va[0]&&!va[1];if(Ja&&(Ue?Gr[0]=Ht(Gr[0]*Ce[0],Rn)/Ce[0]:Gr[1]=Ht(Gr[1]*Ce[1],Rn)/Ce[1]),Kn[0]&&!Kn[1]||va[0]&&!va[1]||Ja&&Ue){Gr[0]+=va[0];var Li=Jt*Gr[0]*Ce[0]/en;Gr[1]=Li/Ut/Ce[1]}else if(!Kn[0]&&Kn[1]||!va[0]&&va[1]||Ja&&!Ue){Gr[1]+=va[1];var Zi=Ut*Gr[1]*Ce[1]*en;Gr[0]=Zi/Jt/Ce[0]}}else Gr[0]+=va[0],Gr[1]+=va[1],va[0]||(Gr[0]=Ht(Gr[0]*Ce[0],Rn)/Ce[0]),va[1]||(Gr[1]=Ht(Gr[1]*Ce[1],Rn)/Ce[1]);Gr[0]===0&&(Gr[0]=(Wt[0]>0?1:-1)*Uc),Gr[1]===0&&(Gr[1]=(Wt[1]>0?1:-1)*Uc);var Oi=[Gr[0]/Wt[0],Gr[1]/Wt[1]];zr=dr(Gr,Ce);var li=Ii(m,Gr,b.fixedDirection,wa,b),ti=Ua?li:gi(li,b.prevInverseDist||[0,0]);if(b.prevDist=Gr,b.prevInverseDist=li,zr[0]===Wt[0]&&zr[1]===Wt[1]&&ti.every(function(Oo){return!Oo})&&!nr&&!Ua)return!1;var ao=vh(b,"scale(".concat(zr.join(", "),")"),"scale(".concat(Gr.join(", "),")")),$o=Os(m,y,De({offsetWidth:Jt,offsetHeight:Ut,direction:qt,scale:zr,dist:Gr,delta:Oi,isPinch:!!J},Ga(m,ao,ti,J,y)));return Sn(m,"onScale",$o),$o},dragControlEnd:function(m,y){var b=y.datas;if(!b.isScale)return!1;b.isScale=!1;var S=Ll(m,y,{});return Sn(m,"onScaleEnd",S),S},dragGroupControlCondition:gn,dragGroupControlStart:function(m,y){var b=y.datas,S=this.dragControlStart(m,y);if(!S)return!1;var D=Fl(m,"resizable",y);b.moveableScale=m.scale;var J=Sh(m,this,"dragControlStart",y,function(Wt,qt){return Ch(m,Wt,b,qt)}),lt=function(Wt){S.setFixedDirection(Wt),J.forEach(function(qt,Jt){qt.setFixedDirection(Wt),Ch(m,qt.moveable,b,D[Jt])})};b.setFixedDirection=lt;var xt=De(De({},S),{targets:m.props.targets,events:J,setFixedDirection:lt}),_t=Sn(m,"onScaleGroupStart",xt);return b.isScale=_t!==!1,b.isScale?xt:!1},dragGroupControl:function(m,y){var b=y.datas;if(!!b.isScale){of(m,"onBeforeScale",function(Jt){Sn(m,"onBeforeScaleGroup",Os(m,y,De(De({},Jt),{targets:m.props.targets}),!0))});var S=this.dragControl(m,y);if(!!S){var D=b.moveableScale;m.scale=[S.scale[0]*D[0],S.scale[1]*D[1]];var J=m.props.keepRatio,lt=S.dist,xt=S.scale,_t=b.fixedPosition,Wt=Sh(m,this,"dragControl",y,function(Jt,Ut){var xe=Io(qo(m.rotation/180*Math.PI,3),[Ut.datas.originalX*lt[0],Ut.datas.originalY*lt[1],1],3),Ce=xe[0],Ue=xe[1];return De(De({},Ut),{parentDist:null,parentScale:xt,parentKeepRatio:J,dragClient:wi(_t,[Ce,Ue])})}),qt=De({targets:m.props.targets,events:Wt},S);return Sn(m,"onScaleGroup",qt),qt}}},dragGroupControlEnd:function(m,y){var b=y.isDrag,S=y.datas;if(!!S.isScale){this.dragControlEnd(m,y);var D=Sh(m,this,"dragControlEnd",y),J=Ll(m,y,{targets:m.props.targets,events:D});return Sn(m,"onScaleGroupEnd",J),b}},request:function(){var m={},y=0,b=0;return{isControl:!0,requestStart:function(S){return{datas:m,parentDirection:S.direction||[1,1]}},request:function(S){return y+=S.deltaWidth,b+=S.deltaHeight,{datas:m,parentDist:[y,b],parentKeepRatio:S.keepRatio}},requestEnd:function(){return{datas:m,isDrag:!0}}}}};function Vn(m,y){return m.map(function(b,S){return Ne(b,y[S],1,2)})}function An(m,y,b){var S=Y(m,y),D=Y(m,b),J=D-S;return J>=0?J:J+2*Math.PI}function ma(m,y){var b=An(m[0],m[1],m[2]),S=An(y[0],y[1],y[2]),D=Math.PI;return!(b>=D&&S<=D||b<=D&&S>=D)}var Or={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:bp("warpable"),render:function(m,y){var b=m.props,S=b.resizable,D=b.scalable,J=b.warpable,lt=b.zoom;if(S||D||!J)return[];var xt=m.state,_t=xt.pos1,Wt=xt.pos2,qt=xt.pos3,Jt=xt.pos4,Ut=Vn(_t,Wt),xe=Vn(Wt,_t),Ce=Vn(_t,qt),Ue=Vn(qt,_t),en=Vn(qt,Jt),dn=Vn(Jt,qt),Rn=Vn(Wt,Jt),nr=Vn(Jt,Wt);return Ar([y.createElement("div",{className:Vi("line"),key:"middeLine1",style:vf(Ut,en,lt)}),y.createElement("div",{className:Vi("line"),key:"middeLine2",style:vf(xe,dn,lt)}),y.createElement("div",{className:Vi("line"),key:"middeLine3",style:vf(Ce,Rn,lt)}),y.createElement("div",{className:Vi("line"),key:"middeLine4",style:vf(Ue,nr,lt)})],Oa(m,"warpable",y),!0)},dragControlCondition:function(m,y){if(y.isRequest)return!1;var b=y.inputEvent.target;return ha(b,Vi("direction"))&&ha(b,Vi("warpable"))},dragControlStart:function(m,y){var b=y.datas,S=y.inputEvent,D=m.props.target,J=S.target,lt=Xh(J,b);if(!lt||!D)return!1;var xt=m.state,_t=xt.transformOrigin,Wt=xt.is3d,qt=xt.targetTransform,Jt=xt.targetMatrix,Ut=xt.width,xe=xt.height,Ce=xt.left,Ue=xt.top;b.datas={},b.targetTransform=qt,b.warpTargetMatrix=Wt?Jt:ts(Jt,3,4),b.targetInverseMatrix=Fa(ui(b.warpTargetMatrix,4),3,4),b.direction=lt,b.left=Ce,b.top=Ue,b.poses=[[0,0],[Ut,0],[0,xe],[Ut,xe]].map(function(Rn){return gi(Rn,_t)}),b.nextPoses=b.poses.map(function(Rn){var nr=Rn[0],Kn=Rn[1];return Io(b.warpTargetMatrix,[nr,Kn,0,1],4)}),b.startValue=Wi(4),b.prevMatrix=Wi(4),b.absolutePoses=Kl(xt),b.posIndexes=rf(lt),eh(m,y),Se(y,"matrix3d"),xt.snapRenderInfo={request:y.isRequest,direction:lt};var en=Os(m,y,De({set:function(Rn){b.startValue=Rn}},ne(y))),dn=Sn(m,"onWarpStart",en);return dn!==!1&&(b.isWarp=!0),b.isWarp},dragControl:function(m,y){var b=y.datas,S=y.isRequest,D=y.distX,J=y.distY,lt=b.targetInverseMatrix,xt=b.prevMatrix,_t=b.isWarp,Wt=b.startValue,qt=b.poses,Jt=b.posIndexes,Ut=b.absolutePoses;if(!_t)return!1;if(Oc(y,"matrix3d"),eo(m,"warpable")){var xe=Jt.map(function(Er){return Ut[Er]});xe.length>1&&xe.push([(xe[0][0]+xe[1][0])/2,(xe[0][1]+xe[1][1])/2]);var Ce=md(m,S,{horizontal:xe.map(function(Er){return Er[1]+J}),vertical:xe.map(function(Er){return Er[0]+D})}),Ue=Ce.horizontal,en=Ce.vertical;J-=Ue.offset,D-=en.offset}var dn=Wc({datas:b,distX:D,distY:J},!0),Rn=b.nextPoses.slice();if(Jt.forEach(function(Er){Rn[Er]=wi(Rn[Er],dn)}),!pf.every(function(Er){return ma(Er.map(function(oa){return qt[oa]}),Er.map(function(oa){return Rn[oa]}))}))return!1;var nr=Es(qt[0],qt[2],qt[1],qt[3],Rn[0],Rn[2],Rn[1],Rn[3]);if(!nr.length)return!1;var Kn=Yi(lt,nr,4),Sr=gh(b,Kn,!0),jn=Yi(ui(xt,4),Sr,4);b.prevMatrix=Sr;var pr=Yi(Wt,Sr,4),zr=vh(b,"matrix3d(".concat(pr.join(", "),")"),"matrix3d(".concat(Sr.join(", "),")"));return yn(y,zr),Sn(m,"onWarp",Os(m,y,De({delta:jn,matrix:pr,dist:Sr,multiply:Yi,transform:zr},Ml({transform:zr},y)))),!0},dragControlEnd:function(m,y){var b=y.datas,S=y.isDrag;return b.isWarp?(b.isWarp=!1,Sn(m,"onWarpEnd",Ll(m,y,{})),S):!1}},Fr=Vi("area-pieces"),rr=Vi("area-piece"),Za=Vi("avoid"),Xn=Vi("view-dragging");function ii(m){var y=m.areaElement;if(!!y){var b=m.state,S=b.width,D=b.height;Ni(y,Za),y.style.cssText+="left: 0px; top: 0px; width: ".concat(S,"px; height: ").concat(D,"px")}}function Ti(m){return m.createElement("div",{key:"area_pieces",className:Fr},m.createElement("div",{className:rr}),m.createElement("div",{className:rr}),m.createElement("div",{className:rr}),m.createElement("div",{className:rr}))}var Ki={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(m,y){var b=m.props,S=b.target,D=b.dragArea,J=b.groupable,lt=b.passDragArea,xt=m.getState(),_t=xt.width,Wt=xt.height,qt=xt.renderPoses,Jt=lt?Vi("area","pass"):Vi("area");if(J)return[y.createElement("div",{key:"area",ref:wt(m,"areaElement"),className:Jt}),Ti(y)];if(!S||!D)return[];var Ut=Es([0,0],[_t,0],[0,Wt],[_t,Wt],qt[0],qt[1],qt[2],qt[3]),xe=Ut.length?Rc(Ut,!0):"none";return[y.createElement("div",{key:"area",ref:wt(m,"areaElement"),className:Jt,style:{top:"0px",left:"0px",width:"".concat(_t,"px"),height:"".concat(Wt,"px"),transformOrigin:"0 0",transform:xe}}),Ti(y)]},dragStart:function(m,y){var b=y.datas,S=y.clientX,D=y.clientY,J=y.inputEvent;if(!J)return!1;b.isDragArea=!1;var lt=m.areaElement,xt=m.state,_t=xt.moveableClientRect,Wt=xt.renderPoses,qt=xt.rootMatrix,Jt=xt.is3d,Ut=_t.left,xe=_t.top,Ce=Rl(Wt),Ue=Ce.left,en=Ce.top,dn=Ce.width,Rn=Ce.height,nr=Jt?4:3,Kn=bh(qt,[S-Ut,D-xe],nr),Sr=Kn[0],jn=Kn[1];Sr-=Ue,jn-=en;var pr=[{left:Ue,top:en,width:dn,height:jn-10},{left:Ue,top:en,width:Sr-10,height:Rn},{left:Ue,top:en+jn+10,width:dn,height:Rn-jn-10},{left:Ue+Sr+10,top:en,width:dn-Sr-10,height:Rn}],zr=[].slice.call(lt.nextElementSibling.children);pr.forEach(function(Er,oa){zr[oa].style.cssText="left: ".concat(Er.left,"px;top: ").concat(Er.top,"px; width: ").concat(Er.width,"px; height: ").concat(Er.height,"px;")}),_i(lt,Za),xt.disableNativeEvent=!0},drag:function(m,y){var b=y.datas,S=y.inputEvent;if(this.enableNativeEvent(m),!S)return!1;b.isDragArea||(b.isDragArea=!0,ii(m))},dragEnd:function(m,y){this.enableNativeEvent(m);var b=y.inputEvent,S=y.datas;if(!b)return!1;S.isDragArea||ii(m)},dragGroupStart:function(m,y){return this.dragStart(m,y)},dragGroup:function(m,y){return this.drag(m,y)},dragGroupEnd:function(m,y){return this.dragEnd(m,y)},unset:function(m){ii(m),m.state.disableNativeEvent=!1},enableNativeEvent:function(m){var y=m.state;y.disableNativeEvent&&vr(function(){y.disableNativeEvent=!1})}},Ai=ua("origin",{render:function(m,y){var b=m.props.zoom,S=m.getState(),D=S.beforeOrigin,J=S.rotation;return[y.createElement("div",{className:Vi("control","origin"),style:Ld(J,b,D),key:"beforeOrigin"})]}});function Yo(m){var y=m.scrollContainer;return[y.scrollLeft,y.scrollTop]}var bi={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(m,y){var b=m.props,S=b.scrollContainer,D=S===void 0?m.getContainer():S,J=b.scrollOptions,lt=new Au,xt=uf(D,!0);y.datas.dragScroll=lt,m.state.dragScroll=lt;var _t=y.isControl?"controlGesto":"targetGesto",Wt=y.targets;lt.on("scroll",function(qt){var Jt=qt.container,Ut=qt.direction,xe=Os(m,y,{scrollContainer:Jt,direction:Ut}),Ce=Wt?"onScrollGroup":"onScroll";Wt&&(xe.targets=Wt),Sn(m,Ce,xe)}).on("move",function(qt){var Jt=qt.offsetX,Ut=qt.offsetY,xe=qt.inputEvent;m[_t].scrollBy(Jt,Ut,xe.inputEvent,!0)}).on("scrollDrag",function(qt){var Jt=qt.next;Jt(m[_t].getCurrentEvent())}),lt.dragStart(y,De({container:xt},J))},checkScroll:function(m,y){var b=y.datas.dragScroll;if(!!b){var S=m.props,D=S.scrollContainer,J=D===void 0?m.getContainer():D,lt=S.scrollThreshold,xt=lt===void 0?0:lt,_t=S.scrollThrottleTime,Wt=_t===void 0?0:_t,qt=S.getScrollPosition,Jt=qt===void 0?Yo:qt,Ut=S.scrollOptions;return b.drag(y,De({container:J,threshold:xt,throttleTime:Wt,getScrollPosition:function(xe){return Jt({scrollContainer:xe.container,direction:xe.direction})}},Ut)),!0}},drag:function(m,y){return this.checkScroll(m,y)},dragEnd:function(m,y){y.datas.dragScroll.dragEnd(),y.datas.dragScroll=null},dragControlStart:function(m,y){return this.dragStart(m,De(De({},y),{isControl:!0}))},dragControl:function(m,y){return this.drag(m,y)},dragControlEnd:function(m,y){return this.dragEnd(m,y)},dragGroupStart:function(m,y){return this.dragStart(m,De(De({},y),{targets:m.props.targets}))},dragGroup:function(m,y){return this.drag(m,De(De({},y),{targets:m.props.targets}))},dragGroupEnd:function(m,y){return this.dragEnd(m,De(De({},y),{targets:m.props.targets}))},dragGroupControlStart:function(m,y){return this.dragStart(m,De(De({},y),{targets:m.props.targets,isControl:!0}))},dragGroupControl:function(m,y){return this.drag(m,De(De({},y),{targets:m.props.targets}))},dragGroupControEnd:function(m,y){return this.dragEnd(m,De(De({},y),{targets:m.props.targets}))},unset:function(m){var y,b=m.state;(y=b.dragScroll)===null||y===void 0||y.dragEnd(),b.dragScroll=null}},Lu={name:"",props:["target","dragTarget","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","transformOrigin","edge","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","displayAroundControls","controlPadding","preventDefault","requestStyles"],events:["changeTargets"]},as=ua("padding",{render:function(m,y){var b=m.props;if(b.dragArea)return[];var S=b.padding||{},D=S.left,J=D===void 0?0:D,lt=S.top,xt=lt===void 0?0:lt,_t=S.right,Wt=_t===void 0?0:_t,qt=S.bottom,Jt=qt===void 0?0:qt,Ut=m.getState(),xe=Ut.renderPoses,Ce=Ut.pos1,Ue=Ut.pos2,en=Ut.pos3,dn=Ut.pos4,Rn=[Ce,Ue,en,dn],nr=[];return J>0&&nr.push([0,2]),xt>0&&nr.push([0,1]),Wt>0&&nr.push([1,3]),Jt>0&&nr.push([2,3]),nr.map(function(Kn,Sr){var jn=Kn[0],pr=Kn[1],zr=Rn[jn],Er=Rn[pr],oa=xe[jn],Gr=xe[pr],wa=Es([0,0],[100,0],[0,100],[100,100],zr,Er,oa,Gr);if(!!wa.length)return y.createElement("div",{key:"padding".concat(Sr),className:Vi("padding"),style:{transform:Rc(wa,!0)}})})}}),gl=["nw","ne","se","sw"];function fu(m,y){var b=m[0]+m[1],S=b>y?y/b:1;return m[0]*=S,m[1]=y-m[1]*S,m}var Rs=[1,2,5,6],Eu=[0,3,4,7],gu=[1,-1,-1,1],zi=[1,1,-1,-1];function ul(m,y,b,S,D,J,lt,xt){D===void 0&&(D=0),J===void 0&&(J=0),lt===void 0&&(lt=b),xt===void 0&&(xt=S);var _t=[],Wt=!1,qt=m.filter(function(Ut){return!Ut.virtual}),Jt=qt.map(function(Ut){var xe=Ut.horizontal,Ce=Ut.vertical,Ue=Ut.pos;if(Ce&&!Wt&&(Wt=!0,_t.push("/")),Wt){var en=Math.max(0,Ce===1?Ue[1]-J:xt-Ue[1]);return _t.push(ju(en,S,y)),en}else{var en=Math.max(0,xe===1?Ue[0]-D:lt-Ue[0]);return _t.push(ju(en,b,y)),en}});return{radiusPoses:qt,styles:_t,raws:Jt}}function ml(m){for(var y=[0,0],b=[0,0],S=m.length,D=0;D<S;++D){var J=m[D];!J.sub||(J.horizontal&&(y[1]===0&&(y[0]=D),y[1]=D-y[0]+1,b[0]=D+1),J.vertical&&(b[1]===0&&(b[0]=D),b[1]=D-b[0]+1))}return{horizontalRange:y,verticalRange:b}}function Jo(m,y,b,S,D,J,lt){var xt,_t,Wt,qt;J===void 0&&(J=[0,0]),lt===void 0&&(lt=!1);var Jt=m.indexOf("/"),Ut=(Jt>-1?m.slice(0,Jt):m).length,xe=m.slice(0,Ut),Ce=m.slice(Ut+1),Ue=xe.length,en=Ce.length,dn=en>0,Rn=xe[0],nr=Rn===void 0?"0px":Rn,Kn=xe[1],Sr=Kn===void 0?nr:Kn,jn=xe[2],pr=jn===void 0?nr:jn,zr=xe[3],Er=zr===void 0?Sr:zr,oa=Ce[0],Gr=oa===void 0?nr:oa,wa=Ce[1],va=wa===void 0?dn?Gr:Sr:wa,Ua=Ce[2],Ja=Ua===void 0?dn?Gr:pr:Ua,Li=Ce[3],Zi=Li===void 0?dn?va:Er:Li,Oi=[nr,Sr,pr,Er].map(function(Ss){return _n(Ss,y)}),li=[Gr,va,Ja,Zi].map(function(Ss){return _n(Ss,b)}),ti=Oi.slice(),ao=li.slice();xt=fu([ti[0],ti[1]],y),ti[0]=xt[0],ti[1]=xt[1],_t=fu([ti[3],ti[2]],y),ti[3]=_t[0],ti[2]=_t[1],Wt=fu([ao[0],ao[3]],b),ao[0]=Wt[0],ao[3]=Wt[1],qt=fu([ao[1],ao[2]],b),ao[1]=qt[0],ao[2]=qt[1];var $o=lt?ti:ti.slice(0,Math.max(J[0],Ue)),Oo=lt?ao:ao.slice(0,Math.max(J[1],en));return Ar(Ar([],$o.map(function(Ss,mo){var So=gl[mo];return{virtual:mo>=Ue,horizontal:gu[mo],vertical:0,pos:[S+Ss,D+(zi[mo]===-1?b:0)],sub:!0,raw:Oi[mo],direction:So}}),!0),Oo.map(function(Ss,mo){var So=gl[mo];return{virtual:mo>=en,horizontal:0,vertical:zi[mo],pos:[S+(gu[mo]===-1?y:0),D+Ss],sub:!0,raw:li[mo],direction:So}}),!0)}function Vl(m,y,b,S,D){D===void 0&&(D=y.length);var J=ml(m.slice(S)),lt=J.horizontalRange,xt=J.verticalRange,_t=b-S,Wt=0;if(_t===0)Wt=D;else if(_t>0&&_t<lt[1])Wt=lt[1]-_t;else if(_t>=xt[0])Wt=xt[0]+xt[1]-_t;else return;m.splice(b,Wt),y.splice(b,Wt)}function Su(m,y,b,S,D,J,lt,xt,_t,Wt,qt){Wt===void 0&&(Wt=0),qt===void 0&&(qt=0);var Jt=ml(m.slice(b)),Ut=Jt.horizontalRange,xe=Jt.verticalRange;if(S>-1)for(var Ce=gu[S]===1?J-Wt:xt-J,Ue=Ut[1];Ue<=S;++Ue){var en=zi[Ue]===1?qt:_t,dn=0;if(S===Ue?dn=J:Ue===0?dn=Wt+Ce:gu[Ue]===-1&&(dn=xt-(y[b][0]-Wt)),m.splice(b+Ue,0,{horizontal:gu[Ue],vertical:0,pos:[dn,en]}),y.splice(b+Ue,0,[dn,en]),Ue===0)break}else if(D>-1){var Rn=zi[D]===1?lt-qt:_t-lt;if(Ut[1]===0&&xe[1]===0){var nr=[Wt+Rn,qt];m.push({horizontal:gu[0],vertical:0,pos:nr}),y.push(nr)}for(var Kn=xe[0],Ue=xe[1];Ue<=D;++Ue){var dn=gu[Ue]===1?Wt:xt,en=0;if(D===Ue?en=lt:Ue===0?en=qt+Rn:zi[Ue]===1?en=y[b+Kn][1]:zi[Ue]===-1&&(en=_t-(y[b+Kn][1]-qt)),m.push({horizontal:0,vertical:zi[Ue],pos:[dn,en]}),y.push([dn,en]),Ue===0)break}}}function co(m,y){y===void 0&&(y=m.map(function(D){return D.raw}));var b=m.map(function(D,J){return D.horizontal?y[J]:null}).filter(function(D){return D!=null}),S=m.map(function(D,J){return D.vertical?y[J]:null}).filter(function(D){return D!=null});return{horizontals:b,verticals:S}}var Ls=[[0,-1,"n"],[1,0,"e"]],pi=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function ll(m,y,b){var S=m.props.clipRelative,D=m.state,J=D.width,lt=D.height,xt=y,_t=xt.type,Wt=xt.poses,qt=_t==="rect",Jt=_t==="circle";if(_t==="polygon")return b.map(function(jn){return"".concat(ju(jn[0],J,S)," ").concat(ju(jn[1],lt,S))});if(qt||_t==="inset"){var Ut=b[1][1],xe=b[3][0],Ce=b[7][0],Ue=b[5][1];if(qt)return[Ut,xe,Ue,Ce].map(function(jn){return"".concat(jn,"px")});var en=[Ut,J-xe,lt-Ue,Ce].map(function(jn,pr){return ju(jn,pr%2?J:lt,S)});if(b.length>8){var dn=gi(b[4],b[0]),Rn=dn[0],nr=dn[1];en.push.apply(en,Ar(["round"],ul(Wt.slice(8).map(function(jn,pr){return De(De({},jn),{pos:b[pr]})}),S,Rn,nr,Ce,Ut,xe,Ue).styles,!1))}return en}else if(Jt||_t==="ellipse"){var Kn=b[0],Sr=ju(Math.abs(b[1][1]-Kn[1]),Jt?Math.sqrt((J*J+lt*lt)/2):lt,S),en=Jt?[Sr]:[ju(Math.abs(b[2][0]-Kn[0]),J,S),Sr];return en.push("at",ju(Kn[0],J,S),ju(Kn[1],lt,S)),en}}function Hf(m,y,b,S){var D=[S,(S+y)/2,y],J=[m,(m+b)/2,b];return pi.map(function(lt){var xt=lt[0],_t=lt[1],Wt=lt[2],qt=D[xt+1],Jt=J[_t+1];return{vertical:Math.abs(_t),horizontal:Math.abs(xt),direction:Wt,pos:[qt,Jt]}})}function bl(m){var y=[Infinity,-Infinity],b=[Infinity,-Infinity];return m.forEach(function(S){var D=S.pos;y[0]=Math.min(y[0],D[0]),y[1]=Math.max(y[1],D[0]),b[0]=Math.min(b[0],D[1]),b[1]=Math.max(b[1],D[1])}),[Math.abs(y[1]-y[0]),Math.abs(b[1]-b[0])]}function Wn(m,y,b,S,D){var J,lt,xt,_t,Wt,qt,Jt;if(!!m){var Ut=D;if(!Ut){var xe=Gs(m),Ce=xe("clipPath");Ut=Ce!=="none"?Ce:xe("clip")}if(!((!Ut||Ut==="none"||Ut==="auto")&&(Ut=S,!Ut))){var Ue=Mn(Ut),en=Ue.prefix,dn=en===void 0?Ut:en,Rn=Ue.value,nr=Rn===void 0?"":Rn,Kn=dn==="circle",Sr=" ";if(dn==="polygon"){var jn=Rr(nr||"0% 0%, 100% 0%, 100% 100%, 0% 100%");Sr=",";var pr=jn.map(function(du){var Us=du.split(" "),Pu=Us[0],fh=Us[1];return{vertical:1,horizontal:1,pos:[_n(Pu,y),_n(fh,b)]}}),zr=vl(pr.map(function(du){return du.pos}));return{type:dn,clipText:Ut,poses:pr,splitter:Sr,left:zr.minX,right:zr.maxX,top:zr.minY,bottom:zr.maxY}}else if(Kn||dn==="ellipse"){var Er="",oa="",Gr=0,wa=0,jn=Da(nr);if(Kn){var va="";J=jn[0],va=J===void 0?"50%":J,lt=jn[2],Er=lt===void 0?"50%":lt,xt=jn[3],oa=xt===void 0?"50%":xt,Gr=_n(va,Math.sqrt((y*y+b*b)/2)),wa=Gr}else{var Ua="",Ja="";_t=jn[0],Ua=_t===void 0?"50%":_t,Wt=jn[1],Ja=Wt===void 0?"50%":Wt,qt=jn[3],Er=qt===void 0?"50%":qt,Jt=jn[4],oa=Jt===void 0?"50%":Jt,Gr=_n(Ua,y),wa=_n(Ja,b)}var Li=[_n(Er,y),_n(oa,b)],pr=Ar([{vertical:1,horizontal:1,pos:Li,direction:"nesw"}],Ls.slice(0,Kn?1:2).map(function(Pu){return{vertical:Math.abs(Pu[1]),horizontal:Pu[0],direction:Pu[2],sub:!0,pos:[Li[0]+Pu[0]*Gr,Li[1]+Pu[1]*wa]}}),!0);return{type:dn,clipText:Ut,radiusX:Gr,radiusY:wa,left:Li[0]-Gr,top:Li[1]-wa,right:Li[0]+Gr,bottom:Li[1]+wa,poses:pr,splitter:Sr}}else if(dn==="inset"){var jn=Da(nr||"0 0 0 0"),Zi=jn.indexOf("round"),Oi=(Zi>-1?jn.slice(0,Zi):jn).length,li=jn.slice(Oi+1),ti=jn.slice(0,Oi),ao=ti[0],$o=ti[1],Oo=$o===void 0?ao:$o,Ss=ti[2],mo=Ss===void 0?ao:Ss,So=ti[3],fs=So===void 0?Oo:So,As=[ao,mo].map(function(Pu){return _n(Pu,b)}),qs=As[0],Ko=As[1],Ho=[fs,Oo].map(function(Pu){return _n(Pu,y)}),Cu=Ho[0],Xs=Ho[1],jl=y-Xs,_u=b-Ko,hu=Jo(li,jl-Cu,_u-qs,Cu,qs),pr=Ar(Ar([],Hf(qs,jl,_u,Cu),!0),hu,!0);return{type:"inset",clipText:Ut,poses:pr,top:qs,left:Cu,right:jl,bottom:_u,radius:li,splitter:Sr}}else if(dn==="rect"){var jn=Rr(nr||"0px, ".concat(y,"px, ").concat(b,"px, 0px"));Sr=",";var yl=jn.map(function(mf){var Jh=ar(mf).value;return Jh}),qs=yl[0],Xs=yl[1],Ko=yl[2],Cu=yl[3],pr=Hf(qs,Xs,Ko,Cu);return{type:"rect",clipText:Ut,poses:pr,top:qs,right:Xs,bottom:Ko,left:Cu,values:jn,splitter:Sr}}}}}function Jr(m,y,b,S,D){var J=m[y],lt=J.direction,xt=J.sub,_t=m.map(function(){return[0,0]}),Wt=lt?lt.split(""):[];if(S&&y<8){var qt=Wt.filter(function(va){return va==="w"||va==="e"}),Jt=Wt.filter(function(va){return va==="n"||va==="s"}),Ut=qt[0],xe=Jt[0];_t[y]=b;var Ce=bl(m),Ue=Ce[0],en=Ce[1],dn=Ue&&en?Ue/en:0;if(dn&&D){var Rn=(y+4)%8,nr=m[Rn].pos,Kn=[0,0];lt.indexOf("w")>-1?Kn[0]=-1:lt.indexOf("e")>-1&&(Kn[0]=1),lt.indexOf("n")>-1?Kn[1]=-1:lt.indexOf("s")>-1&&(Kn[1]=1);var Sr=Nf([Ue,en],b,dn,Kn,!0),jn=Ue+Sr[0],pr=en+Sr[1],zr=nr[1],Er=nr[1],oa=nr[0],Gr=nr[0];Kn[0]===-1?oa=Gr-jn:Kn[0]===1?Gr=oa+jn:(oa=oa-jn/2,Gr=Gr+jn/2),Kn[1]===-1?zr=Er-pr:(Kn[1]===1||(zr=Er-pr/2),Er=zr+pr);var wa=Hf(zr,Gr,Er,oa);m.forEach(function(va,Ua){_t[Ua][0]=wa[Ua].pos[0]-va.pos[0],_t[Ua][1]=wa[Ua].pos[1]-va.pos[1]})}else m.forEach(function(va,Ua){var Ja=va.direction;!Ja||(Ja.indexOf(Ut)>-1&&(_t[Ua][0]=b[0]),Ja.indexOf(xe)>-1&&(_t[Ua][1]=b[1]))}),Ut&&(_t[1][0]=b[0]/2,_t[5][0]=b[0]/2),xe&&(_t[3][1]=b[1]/2,_t[7][1]=b[1]/2)}else lt&&!xt?Wt.forEach(function(va){var Ua=va==="n"||va==="s";m.forEach(function(Ja,Li){var Zi=Ja.direction,Oi=Ja.horizontal,li=Ja.vertical;!Zi||Zi.indexOf(va)===-1||(_t[Li]=[Ua||!Oi?0:b[0],!Ua||!li?0:b[1]])})}):_t[y]=b;return _t}function Nr(m,y){var b=Dd(m,y),S=b[0],D=b[1],J=y.datas,lt=J.clipPath,xt=J.clipIndex,_t=lt,Wt=_t.type,qt=_t.poses,Jt=_t.splitter,Ut=qt.map(function(Rn){return Rn.pos});if(Wt==="polygon")Ut.splice(xt,0,[S,D]);else if(Wt==="inset"){var xe=Rs.indexOf(xt),Ce=Eu.indexOf(xt),Ue=qt.length;if(Su(qt,Ut,8,xe,Ce,S,D,Ut[4][0],Ut[4][1],Ut[0][0],Ut[0][1]),Ue===qt.length)return}else return;var en=ll(m,lt,Ut),dn="".concat(Wt,"(").concat(en.join(Jt),")");Sn(m,"onClip",Os(m,y,De({clipEventType:"added",clipType:Wt,poses:Ut,clipStyles:en,clipStyle:dn,distX:0,distY:0},Ml({clipPath:dn},y))))}function ji(m,y){var b=y.datas,S=b.clipPath,D=b.clipIndex,J=S,lt=J.type,xt=J.poses,_t=J.splitter,Wt=xt.map(function(xe){return xe.pos}),qt=Wt.length;if(lt==="polygon")xt.splice(D,1),Wt.splice(D,1);else if(lt==="inset"){if(D<8||(Vl(xt,Wt,D,8,qt),qt===xt.length))return}else return;var Jt=ll(m,S,Wt),Ut="".concat(lt,"(").concat(Jt.join(_t),")");Sn(m,"onClip",Os(m,y,De({clipEventType:"removed",clipType:lt,poses:Wt,clipStyles:Jt,clipStyle:Ut,distX:0,distY:0},Ml({clipPath:Ut},y))))}var Po={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(m,y){var b=m.props,S=b.customClipPath,D=b.defaultClipPath,J=b.clipArea,lt=b.zoom,xt=b.groupable,_t=m.getState(),Wt=_t.target,qt=_t.width,Jt=_t.height,Ut=_t.allMatrix,xe=_t.is3d,Ce=_t.left,Ue=_t.top,en=_t.pos1,dn=_t.pos2,Rn=_t.pos3,nr=_t.pos4,Kn=_t.clipPathState,Sr=_t.snapBoundInfos,jn=_t.rotation;if(!Wt||xt)return[];var pr=Wn(Wt,qt,Jt,D||"inset",Kn||S);if(!pr)return[];var zr=xe?4:3,Er=pr.type,oa=pr.poses,Gr=oa.map(function(_u){var hu=Ru(Ut,_u.pos,zr);return[hu[0]-Ce,hu[1]-Ue]}),wa=[],va=[],Ua=Er==="rect",Ja=Er==="inset",Li=Er==="polygon";if(Ua||Ja||Li){var Zi=Ja?Gr.slice(0,8):Gr;va=Zi.map(function(_u,hu){var yl=hu===0?Zi[Zi.length-1]:Zi[hu-1],du=Y(yl,_u),Us=Sv(yl,_u);return y.createElement("div",{key:"clipLine".concat(hu),className:Vi("line","clip-line","snap-control"),"data-clip-index":hu,style:{width:"".concat(Us,"px"),transform:"translate(".concat(yl[0],"px, ").concat(yl[1],"px) rotate(").concat(du,"rad) scaleY(").concat(lt,")")}})})}if(wa=Gr.map(function(_u,hu){return y.createElement("div",{key:"clipControl".concat(hu),className:Vi("control","clip-control","snap-control"),"data-clip-index":hu,style:{transform:"translate(".concat(_u[0],"px, ").concat(_u[1],"px) rotate(").concat(jn,"rad) scale(").concat(lt,")")}})}),Ja&&wa.push.apply(wa,Gr.slice(8).map(function(_u,hu){return y.createElement("div",{key:"clipRadiusControl".concat(hu),className:Vi("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+hu,style:{transform:"translate(".concat(_u[0],"px, ").concat(_u[1],"px) rotate(").concat(jn,"rad) scale(").concat(lt,")")}})})),Er==="circle"||Er==="ellipse"){var Oi=pr.left,li=pr.top,ti=pr.radiusX,ao=pr.radiusY,$o=gi(Ru(Ut,[Oi,li],zr),Ru(Ut,[0,0],zr)),Oo=$o[0],Ss=$o[1],mo="none";if(!J){for(var So=Math.max(10,ti/5,ao/5),fs=[],As=0;As<=So;++As){var qs=Math.PI*2/So*As;fs.push([ti+(ti-lt)*Math.cos(qs),ao+(ao-lt)*Math.sin(qs)])}fs.push([ti,-2]),fs.push([-2,-2]),fs.push([-2,ao*2+2]),fs.push([ti*2+2,ao*2+2]),fs.push([ti*2+2,-2]),fs.push([ti,-2]),mo="polygon(".concat(fs.map(function(_u){return"".concat(_u[0],"px ").concat(_u[1],"px")}).join(", "),")")}wa.push(y.createElement("div",{key:"clipEllipse",className:Vi("clip-ellipse","snap-control"),style:{width:"".concat(ti*2,"px"),height:"".concat(ao*2,"px"),clipPath:mo,transform:"translate(".concat(-Ce+Oo,"px, ").concat(-Ue+Ss,"px) ").concat(Rc(Ut))}}))}if(J){var Ko=Rl(Ar([en,dn,Rn,nr],Gr,!0)),Ho=Ko.width,Cu=Ko.height,Xs=Ko.left,jl=Ko.top;if(Li||Ua||Ja){var fs=Ja?Gr.slice(0,8):Gr;wa.push(y.createElement("div",{key:"clipArea",className:Vi("clip-area","snap-control"),style:{width:"".concat(Ho,"px"),height:"".concat(Cu,"px"),transform:"translate(".concat(Xs,"px, ").concat(jl,"px)"),clipPath:"polygon(".concat(fs.map(function(hu){return"".concat(hu[0]-Xs,"px ").concat(hu[1]-jl,"px")}).join(", "),")")}}))}}return Sr&&["vertical","horizontal"].forEach(function(_u){var hu=Sr[_u],yl=_u==="horizontal";hu.isSnap&&va.push.apply(va,hu.snap.posInfos.map(function(du,Us){var Pu=du.pos,fh=gi(Ru(Ut,yl?[0,Pu]:[Pu,0],zr),[Ce,Ue]),ov=gi(Ru(Ut,yl?[qt,Pu]:[Pu,Jt],zr),[Ce,Ue]);return aa(y,"",fh,ov,lt,"clip".concat(_u,"snap").concat(Us),"guideline")})),hu.isBound&&va.push.apply(va,hu.bounds.map(function(du,Us){var Pu=du.pos,fh=gi(Ru(Ut,yl?[0,Pu]:[Pu,0],zr),[Ce,Ue]),ov=gi(Ru(Ut,yl?[qt,Pu]:[Pu,Jt],zr),[Ce,Ue]);return aa(y,"",fh,ov,lt,"clip".concat(_u,"bounds").concat(Us),"guideline","bounds","bold")}))}),Ar(Ar([],wa,!0),va,!0)},dragControlCondition:function(m,y){return y.inputEvent&&(y.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(m,y){var b=m.props,S=b.dragWithClip,D=S===void 0?!0:S;return D?!1:this.dragControlStart(m,y)},drag:function(m,y){return this.dragControl(m,De(De({},y),{isDragTarget:!0}))},dragEnd:function(m,y){return this.dragControlEnd(m,y)},dragControlStart:function(m,y){var b=m.state,S=m.props,D=S.defaultClipPath,J=S.customClipPath,lt=b.target,xt=b.width,_t=b.height,Wt=y.inputEvent?y.inputEvent.target:null,qt=Wt&&Wt.getAttribute("class")||"",Jt=y.datas,Ut=Wn(lt,xt,_t,D||"inset",J);if(!Ut)return!1;var xe=Ut.clipText,Ce=Ut.type,Ue=Ut.poses,en=Sn(m,"onClipStart",Os(m,y,{clipType:Ce,clipStyle:xe,poses:Ue.map(function(dn){return dn.pos})}));return en===!1?(Jt.isClipStart=!1,!1):(Jt.isControl=qt&&qt.indexOf("clip-control")>-1,Jt.isLine=qt.indexOf("clip-line")>-1,Jt.isArea=qt.indexOf("clip-area")>-1||qt.indexOf("clip-ellipse")>-1,Jt.clipIndex=Wt?parseInt(Wt.getAttribute("data-clip-index"),10):-1,Jt.clipPath=Ut,Jt.isClipStart=!0,b.clipPathState=xe,eh(m,y),!0)},dragControl:function(m,y){var b,S,D=y.datas,J=y.originalDatas,lt=y.isDragTarget;if(!D.isClipStart)return!1;var xt=D,_t=xt.isControl,Wt=xt.isLine,qt=xt.isArea,Jt=xt.clipIndex,Ut=xt.clipPath;if(!Ut)return!1;var xe=gf(m.props,"clippable"),Ce=xe.keepRatio,Ue=0,en=0,dn=J.draggable,Rn=Wc(y);lt&&dn?(b=dn.prevBeforeDist,Ue=b[0],en=b[1]):(Ue=Rn[0],en=Rn[1]);var nr=[Ue,en],Kn=m.state,Sr=Kn.width,jn=Kn.height,pr=!qt&&!_t&&!Wt,zr=Ut.type,Er=Ut.poses,oa=Ut.splitter,Gr=Er.map(function(Hu){return Hu.pos});pr&&(Ue=-Ue,en=-en);var wa=!_t||Er[Jt].direction==="nesw",va=zr==="inset"||zr==="rect",Ua=Er.map(function(){return[0,0]});if(_t&&!wa){var Ja=Er[Jt],Li=Ja.horizontal,Zi=Ja.vertical,Oi=[Ue*Math.abs(Li),en*Math.abs(Zi)];Ua=Jr(Er,Jt,Oi,va,Ce)}else wa&&(Ua=Gr.map(function(){return[Ue,en]}));var li=Gr.map(function(Hu,Yf){return wi(Hu,Ua[Yf])}),ti=Ar([],li,!0);Kn.snapBoundInfos=null;var ao=Ut.type==="circle",$o=Ut.type==="ellipse";if(ao||$o){var Oo=Rl(li),Ss=Math.abs(Oo.bottom-Oo.top),mo=Math.abs($o?Oo.right-Oo.left:Ss),So=li[0][1]+Ss,fs=li[0][0]-mo,As=li[0][0]+mo;ao&&(ti.push([As,Oo.bottom]),Ua.push([1,0])),ti.push([Oo.left,So]),Ua.push([0,1]),ti.push([fs,Oo.bottom]),Ua.push([1,0])}var qs=lf((xe.clipHorizontalGuidelines||[]).map(function(Hu){return _n("".concat(Hu),jn)}),(xe.clipVerticalGuidelines||[]).map(function(Hu){return _n("".concat(Hu),Sr)}),Sr,jn),Ko=[],Ho=[];if(ao||$o)Ko=[ti[4][0],ti[2][0]],Ho=[ti[1][1],ti[3][1]];else if(va){var Cu=[ti[0],ti[2],ti[4],ti[6]],Xs=[Ua[0],Ua[2],Ua[4],Ua[6]];Ko=Cu.filter(function(Hu,Yf){return Xs[Yf][0]}).map(function(Hu){return Hu[0]}),Ho=Cu.filter(function(Hu,Yf){return Xs[Yf][1]}).map(function(Hu){return Hu[1]})}else Ko=ti.filter(function(Hu,Yf){return Ua[Yf][0]}).map(function(Hu){return Hu[0]}),Ho=ti.filter(function(Hu,Yf){return Ua[Yf][1]}).map(function(Hu){return Hu[1]});var jl=[0,0],_u=Kd(qs,xe.clipTargetBounds&&{left:0,top:0,right:Sr,bottom:jn},Ko,Ho,5),hu=_u.horizontal,yl=_u.vertical,du=hu.offset,Us=yl.offset;if(hu.isBound&&(jl[1]+=du),yl.isBound&&(jl[0]+=Us),($o||ao)&&Ua[0][0]===0&&Ua[0][1]===0){var Oo=Rl(li),Pu=Oo.bottom-Oo.top,fh=$o?Oo.right-Oo.left:Pu,ov=yl.isBound?Math.abs(Us):yl.snapIndex===0?-Us:Us,lc=hu.isBound?Math.abs(du):hu.snapIndex===0?-du:du;fh-=ov,Pu-=lc,ao&&(Pu=Zp(yl,hu)>0?Pu:fh,fh=Pu);var mf=ti[0];ti[1][1]=mf[1]-Pu,ti[2][0]=mf[0]+fh,ti[3][1]=mf[1]+Pu,ti[4][0]=mf[0]-fh}else if(va&&Ce&&_t){var Jh=bl(Er),Ip=Jh[0],Mg=Jh[1],sm=Ip&&Mg?Ip/Mg:0,um=Er[Jt],Ng=um.direction||"",ig=ti[1][1],So=ti[5][1],fs=ti[7][0],As=ti[3][0];du<=Us?du=Us/sm:Us=du*sm,Ng.indexOf("w")>-1?fs-=Us:Ng.indexOf("e")>-1?As-=Us:(fs+=Us/2,As-=Us/2),Ng.indexOf("n")>-1?ig-=du:Ng.indexOf("s")>-1?So-=du:(ig+=du/2,So-=du/2);var K0=Hf(ig,As,So,fs);ti.forEach(function(Hm,Xm){var Ym;Ym=K0[Xm].pos,Hm[0]=Ym[0],Hm[1]=Ym[1]})}else ti.forEach(function(Hu,Yf){var Lf=Ua[Yf];Lf[0]&&(Hu[0]-=Us),Lf[1]&&(Hu[1]-=du)});var Qd=ll(m,Ut,li),lm="".concat(zr,"(").concat(Qd.join(oa),")");if(Kn.clipPathState=lm,ao||$o)Ko=[ti[4][0],ti[2][0]],Ho=[ti[1][1],ti[3][1]];else if(va){var Cu=[ti[0],ti[2],ti[4],ti[6]];Ko=Cu.map(function(Yf){return Yf[0]}),Ho=Cu.map(function(Yf){return Yf[1]})}else Ko=ti.map(function(Hu){return Hu[0]}),Ho=ti.map(function(Hu){return Hu[1]});if(Kn.snapBoundInfos=Kd(qs,xe.clipTargetBounds&&{left:0,top:0,right:Sr,bottom:jn},Ko,Ho,1),dn){var N1=Kn.is3d,Z0=Kn.allMatrix,cm=N1?4:3,jm=jl;lt&&(jm=[nr[0]+jl[0]-Rn[0],nr[1]+jl[1]-Rn[1]]),dn.deltaOffset=Yi(Z0,[jm[0],jm[1],0,0],cm)}return Sn(m,"onClip",Os(m,y,De({clipEventType:"changed",clipType:zr,poses:li,clipStyle:lm,clipStyles:Qd,distX:Ue,distY:en},Ml((S={},S[zr==="rect"?"clip":"clipPath"]=lm,S),y)))),!0},dragControlEnd:function(m,y){this.unset(m);var b=y.isDrag,S=y.datas,D=y.isDouble,J=S.isLine,lt=S.isClipStart,xt=S.isControl;return lt?(Sn(m,"onClipEnd",Ll(m,y,{})),D&&(xt?ji(m,y):J&&Nr(m,y)),D||b):!1},unset:function(m){m.state.clipPathState="",m.state.snapBoundInfos=null}},Nn={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(m,y){return y.isRequest?y.requestAble==="originDraggable":ha(y.inputEvent.target,Vi("origin"))},dragControlStart:function(m,y){var b=y.datas;eh(m,y);var S=Os(m,y,{dragStart:zn.dragStart(m,new If().dragStart([0,0],y))}),D=Sn(m,"onDragOriginStart",S);return b.startOrigin=m.state.transformOrigin,b.startTargetOrigin=m.state.targetOrigin,b.prevOrigin=[0,0],b.isDragOrigin=!0,D===!1?(b.isDragOrigin=!1,!1):S},dragControl:function(m,y){var b=y.datas,S=y.isPinch,D=y.isRequest;if(!b.isDragOrigin)return!1;var J=Wc(y),lt=J[0],xt=J[1],_t=m.state,Wt=_t.width,qt=_t.height,Jt=_t.offsetMatrix,Ut=_t.targetMatrix,xe=_t.is3d,Ce=m.props.originRelative,Ue=Ce===void 0?!0:Ce,en=xe?4:3,dn=[lt,xt];if(D){var Rn=y.distOrigin;(Rn[0]||Rn[1])&&(dn=Rn)}var nr=wi(b.startOrigin,dn),Kn=wi(b.startTargetOrigin,dn),Sr=gi(dn,b.prevOrigin),jn=mh(Jt,Ut,nr,en),pr=m.getRect(),zr=Rl(Fc(jn,Wt,qt,en)),Er=[pr.left-zr.left,pr.top-zr.top];b.prevOrigin=dn;var oa=[ju(Kn[0],Wt,Ue),ju(Kn[1],qt,Ue)].join(" "),Gr=zn.drag(m,$f(y,m.state,Er,!!S,!1)),wa=Os(m,y,De(De({width:Wt,height:qt,origin:nr,dist:dn,delta:Sr,transformOrigin:oa,drag:Gr},Ml({transformOrigin:oa,transform:Gr.transform},y)),{afterTransform:Gr.transform}));return Sn(m,"onDragOrigin",wa),wa},dragControlEnd:function(m,y){var b=y.datas;return b.isDragOrigin?(Sn(m,"onDragOriginEnd",Ll(m,y,{})),!0):!1},dragGroupControlCondition:function(m,y){return this.dragControlCondition(m,y)},dragGroupControlStart:function(m,y){var b=this.dragControlStart(m,y);return!!b},dragGroupControl:function(m,y){var b=this.dragControl(m,y);return b?(m.transformOrigin=b.transformOrigin,!0):!1},request:function(m){var y={},b=m.getRect(),S=0,D=0,J=b.transformOrigin,lt=[0,0];return{isControl:!0,requestStart:function(){return{datas:y}},request:function(xt){return"deltaOrigin"in xt?(lt[0]+=xt.deltaOrigin[0],lt[1]+=xt.deltaOrigin[1]):"origin"in xt?(lt[0]=xt.origin[0]-J[0],lt[1]=xt.origin[1]-J[1]):("x"in xt?S=xt.x-b.left:"deltaX"in xt&&(S+=xt.deltaX),"y"in xt?D=xt.y-b.top:"deltaY"in xt&&(D+=xt.deltaY)),{datas:y,distX:S,distY:D,distOrigin:lt}},requestEnd:function(){return{datas:y,isDrag:!0}}}}};function ln(m,y,b,S){var D=m.filter(function(_t){var Wt=_t.virtual,qt=_t.horizontal;return qt&&!Wt}).length,J=m.filter(function(_t){var Wt=_t.virtual,qt=_t.vertical;return qt&&!Wt}).length,lt=-1;if(y===0&&(D===0?lt=0:D===1&&(lt=1)),y===2&&(D<=2?lt=2:D<=3&&(lt=3)),y===3&&(J===0?lt=4:J<4&&(lt=7)),y===1&&(J<=1?lt=5:J<=2&&(lt=6)),!(lt===-1||!m[lt].virtual)){var xt=m[lt];fr(m,lt),lt<4?xt.pos[0]=b:xt.pos[1]=S}}function fr(m,y){y<4?m.slice(0,y+1).forEach(function(b){b.virtual=!1}):(m[0].virtual&&(m[0].virtual=!1),m.slice(4,y+1).forEach(function(b){b.virtual=!1}))}function Pr(m,y){y<4?m.slice(y,4).forEach(function(b){b.virtual=!0}):m.slice(y).forEach(function(b){b.virtual=!0})}function Vr(m,y,b,S,D){S===void 0&&(S=[0,0]);var J=[];return!m||m==="0px"?J=[]:J=Da(m),Jo(J,y,b,0,0,S,D)}function mr(m,y,b,S,D){var J=m.state,lt=J.width,xt=J.height,_t=ul(D,m.props.roundRelative,lt,xt),Wt=_t.raws,qt=_t.styles,Jt=_t.radiusPoses,Ut=co(Jt,Wt),xe=Ut.horizontals,Ce=Ut.verticals,Ue=qt.join(" ");J.borderRadiusState=Ue;var en=Os(m,y,De({horizontals:xe,verticals:Ce,borderRadius:Ue,width:lt,height:xt,delta:S,dist:b},Ml({borderRadius:Ue},y)));return Sn(m,"onRound",en),en}function hr(m){var y,b,S=m.getState().style,D=S.borderRadius||"";if(!D&&m.props.groupable){var J=m.moveables[0],lt=m.getTargets()[0];lt&&((J==null?void 0:J.props.target)===lt?(D=(b=(y=m.moveables[0])===null||y===void 0?void 0:y.state.style.borderRadius)!==null&&b!==void 0?b:"",S.borderRadius=D):(D=Bd(lt).borderRadius,S.borderRadius=D))}return D}var Mr={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(m){var y=m.props.roundClickable;return y===!0||y==="line"?Vi("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(m,y){var b=m.getState(),S=b.target,D=b.width,J=b.height,lt=b.allMatrix,xt=b.is3d,_t=b.left,Wt=b.top,qt=b.borderRadiusState,Jt=m.props,Ut=Jt.minRoundControls,xe=Ut===void 0?[0,0]:Ut,Ce=Jt.maxRoundControls,Ue=Ce===void 0?[4,4]:Ce,en=Jt.zoom,dn=Jt.roundPadding,Rn=dn===void 0?0:dn,nr=Jt.isDisplayShadowRoundControls,Kn=Jt.groupable;if(!S)return null;var Sr=qt||hr(m),jn=xt?4:3,pr=Vr(Sr,D,J,xe,!0);if(!pr)return null;var zr=0,Er=0,oa=Kn?[0,0]:[_t,Wt];return pr.map(function(Gr,wa){var va=Gr.horizontal,Ua=Gr.vertical,Ja=Gr.direction||"",Li=Ar([],Gr.pos,!0);Er+=Math.abs(va),zr+=Math.abs(Ua),va&&Ja.indexOf("n")>-1&&(Li[1]-=Rn),Ua&&Ja.indexOf("w")>-1&&(Li[0]-=Rn),va&&Ja.indexOf("s")>-1&&(Li[1]+=Rn),Ua&&Ja.indexOf("e")>-1&&(Li[0]+=Rn);var Zi=gi(Ru(lt,Li,jn),oa),Oi=Gr.vertical?zr<=Ue[1]&&(nr||!Gr.virtual):Er<=Ue[0]&&(nr||!Gr.virtual);return y.createElement("div",{key:"borderRadiusControl".concat(wa),className:Vi("control","border-radius",Gr.vertical?"vertical":"",Gr.virtual?"virtual":""),"data-radius-index":wa,style:{display:Oi?"block":"none",transform:"translate(".concat(Zi[0],"px, ").concat(Zi[1],"px) scale(").concat(en,")")}})})},dragControlCondition:function(m,y){if(!y.inputEvent||y.isRequest)return!1;var b=y.inputEvent.target.getAttribute("class")||"";return b.indexOf("border-radius")>-1||b.indexOf("moveable-line")>-1&&b.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(m,y){return this.dragControlCondition(m,y)},dragControlStart:function(m,y){var b=y.inputEvent,S=y.datas,D=b.target,J=D.getAttribute("class")||"",lt=J.indexOf("border-radius")>-1,xt=J.indexOf("moveable-line")>-1&&J.indexOf("moveable-direction")>-1,_t=lt?parseInt(D.getAttribute("data-radius-index"),10):-1,Wt=-1;if(xt){var qt=D.getAttribute("data-line-key")||"";qt&&(Wt=parseInt(qt.replace(/render-line-/g,""),10),isNaN(Wt)&&(Wt=-1))}if(!lt&&!xt)return!1;var Jt=Os(m,y,{}),Ut=Sn(m,"onRoundStart",Jt);if(Ut===!1)return!1;S.lineIndex=Wt,S.controlIndex=_t,S.isControl=lt,S.isLine=xt,eh(m,y);var xe=m.props,Ce=xe.roundRelative,Ue=xe.minRoundControls,en=Ue===void 0?[0,0]:Ue,dn=m.state,Rn=dn.width,nr=dn.height;S.isRound=!0,S.prevDist=[0,0];var Kn=hr(m),Sr=Vr(Kn||"",Rn,nr,en,!0)||[];return S.controlPoses=Sr,dn.borderRadiusState=ul(Sr,Ce,Rn,nr).styles.join(" "),Jt},dragControl:function(m,y){var b=y.datas,S=b.controlPoses;if(!b.isRound||!b.isControl||!S.length)return!1;var D=b.controlIndex,J=Wc(y),lt=J[0],xt=J[1],_t=[lt,xt],Wt=gi(_t,b.prevDist),qt=m.props.maxRoundControls,Jt=qt===void 0?[4,4]:qt,Ut=m.state,xe=Ut.width,Ce=Ut.height,Ue=S[D],en=Ue.vertical,dn=Ue.horizontal,Rn=S.map(function(Kn){var Sr=Kn.horizontal,jn=Kn.vertical,pr=[Sr*dn*_t[0],jn*en*_t[1]];if(Sr){if(Jt[0]===1)return pr;if(Jt[0]<4&&Sr!==dn)return pr}else{if(Jt[1]===0)return pr[1]=jn*dn*_t[0]/xe*Ce,pr;if(en){if(Jt[1]===1)return pr;if(Jt[1]<4&&jn!==en)return pr}}return[0,0]});Rn[D]=_t;var nr=S.map(function(Kn,Sr){return De(De({},Kn),{pos:wi(Kn.pos,Rn[Sr])})});return D<4?nr.slice(0,D+1).forEach(function(Kn){Kn.virtual=!1}):nr.slice(4,D+1).forEach(function(Kn){Kn.virtual=!1}),b.prevDist=[lt,xt],mr(m,y,_t,Wt,nr)},dragControlEnd:function(m,y){var b=m.state;b.borderRadiusState="";var S=y.datas,D=y.isDouble;if(!S.isRound)return!1;var J=S.isControl,lt=S.controlIndex,xt=S.isLine,_t=S.lineIndex,Wt=S.controlPoses,qt=Wt.filter(function(dn){var Rn=dn.virtual;return Rn}).length,Jt=m.props.roundClickable,Ut=Jt===void 0?!0:Jt;if(D&&Ut){if(J&&(Ut===!0||Ut==="control"))Pr(Wt,lt);else if(xt&&(Ut===!0||Ut==="line")){var xe=Dd(m,y),Ce=xe[0],Ue=xe[1];ln(Wt,_t,Ce,Ue)}qt!==Wt.filter(function(dn){var Rn=dn.virtual;return Rn}).length&&mr(m,y,[0,0],[0,0],Wt)}var en=Ll(m,y,{});return Sn(m,"onRoundEnd",en),b.borderRadiusState="",en},dragGroupControlStart:function(m,y){var b=this.dragControlStart(m,y);if(!b)return!1;var S=m.moveables,D=m.props.targets,J=Fl(m,"roundable",y),lt=De({targets:m.props.targets,events:J.map(function(xt,_t){return De(De({},xt),{target:D[_t],moveable:S[_t],currentTarget:S[_t]})})},b);return Sn(m,"onRoundGroupStart",lt),b},dragGroupControl:function(m,y){var b=this.dragControl(m,y);if(!b)return!1;var S=m.moveables,D=m.props.targets,J=Fl(m,"roundable",y),lt=De({targets:m.props.targets,events:J.map(function(xt,_t){return De(De(De({},xt),{target:D[_t],moveable:S[_t],currentTarget:S[_t]}),Ml({borderRadius:b.borderRadius},xt))})},b);return Sn(m,"onRoundGroup",lt),lt},dragGroupControlEnd:function(m,y){var b=m.moveables,S=m.props.targets,D=Fl(m,"roundable",y);of(m,"onRound",function(xt){var _t=De({targets:m.props.targets,events:D.map(function(Wt,qt){return De(De(De({},Wt),{target:S[qt],moveable:b[qt],currentTarget:b[qt]}),Ml({borderRadius:xt.borderRadius},Wt))})},xt);Sn(m,"onRoundGroup",_t)});var J=this.dragControlEnd(m,y);if(!J)return!1;var lt=De({targets:m.props.targets,events:D.map(function(xt,_t){var Wt;return De(De({},xt),{target:S[_t],moveable:b[_t],currentTarget:b[_t],lastEvent:(Wt=xt.datas)===null||Wt===void 0?void 0:Wt.lastEvent})})},J);return Sn(m,"onRoundGroupEnd",lt),lt},unset:function(m){m.state.borderRadiusState=""}};function On(m,y){var b=y?4:3,S=Wi(b),D="matrix".concat(y?"3d":"","(").concat(S.join(","),")");return m===D||m==="matrix(1,0,0,1,0,0)"}var ur={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(m,y){var b=m.state,S=b.is3d,D=b.target,J=b.targetMatrix,lt=D==null?void 0:D.style.transform,xt=S?"matrix3d(".concat(J.join(","),")"):"matrix(".concat(Do(J,!0),")"),_t=!lt||lt==="none"?xt:lt;y.datas.startTransforms=On(_t,S)?[]:Da(_t)},resetStyle:function(m){var y=m.datas;y.nextStyle={},y.nextTransforms=m.datas.startTransforms,y.nextTransformAppendedIndexes=[]},fillDragStartParams:function(m,y){return Os(m,y,{setTransform:function(b){y.datas.startTransforms=Rt(b)?b:Da(b)},isPinch:!!y.isPinch})},fillDragParams:function(m,y){return Os(m,y,{isPinch:!!y.isPinch})},dragStart:function(m,y){this.setTransform(m,y),this.resetStyle(y),Sn(m,"onBeforeRenderStart",this.fillDragStartParams(m,y))},drag:function(m,y){this.resetStyle(y),Sn(m,"onBeforeRender",Os(m,y,{isPinch:!!y.isPinch}))},dragEnd:function(m,y){Sn(m,"onBeforeRenderEnd",Os(m,y,{isPinch:!!y.isPinch,isDrag:y.isDrag}))},dragGroupStart:function(m,y){var b=this;this.dragStart(m,y);var S=Fl(m,"beforeRenderable",y),D=m.moveables,J=S.map(function(lt,xt){var _t=D[xt];return b.setTransform(_t,lt),b.resetStyle(lt),b.fillDragStartParams(_t,lt)});Sn(m,"onBeforeRenderGroupStart",Os(m,y,{isPinch:!!y.isPinch,targets:m.props.targets,setTransform:function(){},events:J}))},dragGroup:function(m,y){var b=this;this.drag(m,y);var S=Fl(m,"beforeRenderable",y),D=m.moveables,J=S.map(function(lt,xt){var _t=D[xt];return b.resetStyle(lt),b.fillDragParams(_t,lt)});Sn(m,"onBeforeRenderGroup",Os(m,y,{isPinch:!!y.isPinch,targets:m.props.targets,events:J}))},dragGroupEnd:function(m,y){this.dragEnd(m,y),Sn(m,"onBeforeRenderGroupEnd",Os(m,y,{isPinch:!!y.isPinch,isDrag:y.isDrag,targets:m.props.targets}))},dragControlStart:function(m,y){return this.dragStart(m,y)},dragControl:function(m,y){return this.drag(m,y)},dragControlEnd:function(m,y){return this.dragEnd(m,y)},dragGroupControlStart:function(m,y){return this.dragGroupStart(m,y)},dragGroupControl:function(m,y){return this.dragGroup(m,y)},dragGroupControlEnd:function(m,y){return this.dragGroupEnd(m,y)}},Cn={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(m,y){Sn(m,"onRenderStart",Os(m,y,{isPinch:!!y.isPinch}))},drag:function(m,y){Sn(m,"onRender",this.fillDragParams(m,y))},dragAfter:function(m,y){return this.drag(m,y)},dragEnd:function(m,y){Sn(m,"onRenderEnd",this.fillDragEndParams(m,y))},dragGroupStart:function(m,y){Sn(m,"onRenderGroupStart",Os(m,y,{isPinch:!!y.isPinch,targets:m.props.targets}))},dragGroup:function(m,y){var b=this,S=Fl(m,"beforeRenderable",y),D=m.moveables,J=S.map(function(lt,xt){var _t=D[xt];return b.fillDragParams(_t,lt)});Sn(m,"onRenderGroup",Os(m,y,De(De({isPinch:!!y.isPinch,targets:m.props.targets,transform:la(y)},Ml(Dn(y))),{events:J})))},dragGroupEnd:function(m,y){var b=this,S=Fl(m,"beforeRenderable",y),D=m.moveables,J=S.map(function(lt,xt){var _t=D[xt];return b.fillDragEndParams(_t,lt)});Sn(m,"onRenderGroupEnd",Os(m,y,De({isPinch:!!y.isPinch,isDrag:y.isDrag,targets:m.props.targets,events:J,transform:la(y)},Ml(Dn(y)))))},dragControlStart:function(m,y){return this.dragStart(m,y)},dragControl:function(m,y){return this.drag(m,y)},dragControlAfter:function(m,y){return this.dragAfter(m,y)},dragControlEnd:function(m,y){return this.dragEnd(m,y)},dragGroupControlStart:function(m,y){return this.dragGroupStart(m,y)},dragGroupControl:function(m,y){return this.dragGroup(m,y)},dragGroupControlEnd:function(m,y){return this.dragGroupEnd(m,y)},fillDragParams:function(m,y){return Os(m,y,De({isPinch:!!y.isPinch,transform:la(y)},Ml(Dn(y))))},fillDragEndParams:function(m,y){return Os(m,y,De({isPinch:!!y.isPinch,isDrag:y.isDrag,transform:la(y)},Ml(Dn(y))))}};function Dr(m,y,b,S,D,J,lt){J.clientDistX=J.distX,J.clientDistY=J.distY;var xt=D==="Start",_t=D==="End",Wt=D==="After",qt=m.state.target,Jt=J.isRequest;if(!qt||xt&&S.indexOf("Control")>-1&&!Jt&&m.areaElement===J.inputEvent.target)return!1;var Ut=Ar([],m[y],!0);if(Jt){var xe=J.requestAble;Ut.some(function(Er){return Er.name===xe})||Ut.push.apply(Ut,m.props.ables.filter(function(Er){return Er.name===xe}))}if(!Ut.length||Ut.every(function(Er){return Er.dragRelation}))return!1;var Ce=J.inputEvent,Ue;_t&&Ce&&(Ue=document.elementFromPoint(J.clientX,J.clientY)||Ce.target);var en=!1,dn=function(){var Er;en=!0,(Er=J.stop)===null||Er===void 0||Er.call(J)},Rn=xt&&(!m.targetGesto||!m.controlGesto||!m.targetGesto.isFlag()||!m.controlGesto.isFlag());Rn&&m.updateRect(D,!0,!1);var nr=J.datas,Kn=function(Er,oa,Gr){if(!(oa in Er))return!1;var wa=Er.name,va=nr[wa]||(nr[wa]={});if(xt&&(va.isEventStart=!Gr||!Er[Gr]||Er[Gr](m,J)),!va.isEventStart)return!1;var Ua=Er[oa](m,De(De({},J),{stop:dn,datas:va,originalDatas:nr,inputTarget:Ue}));return m._emitter.off(),xt&&Ua===!1&&(va.isEventStart=!1),Ua};Rn&&Ut.forEach(function(Er){Er.unset&&Er.unset(m)}),Kn(ur,"drag".concat(S).concat(D));var Sr=0,jn=0;b.forEach(function(Er){if(en)return!1;var oa="".concat(Er).concat(S).concat(D),Gr="".concat(Er).concat(S,"Condition");D===""&&!Jt&&Wp(m.state,J);var wa=Ut.filter(function(Ja){return Ja[oa]});wa=wa.filter(function(Ja,Li){return Ja.name&&wa.indexOf(Ja)===Li});var va=wa.filter(function(Ja){return Kn(Ja,oa,Gr)}),Ua=va.length;en&&++Sr,Ua&&++jn,!en&&xt&&wa.length&&!Ua&&(Sr+=wa.filter(function(Ja){var Li=Ja.name,Zi=nr[Li];return Zi.isEventStart?Ja.dragRelation!=="strong":!1}).length?1:0)}),(!Wt||jn)&&Kn(Cn,"drag".concat(S).concat(D));var pr=Sr===b.length;if((_t||en||pr)&&(m.state.gestos={},m.moveables&&m.moveables.forEach(function(Er){Er.state.gestos={}}),Ut.forEach(function(Er){Er.unset&&Er.unset(m)})),xt&&!pr&&!Jt&&jn&&m.props.preventDefault&&(J==null||J.preventDefault()),m.isUnmounted||pr)return!1;if(!xt&&jn&&!lt||_t){var zr=m.props.flushSync||af;zr(function(){m.updateRect(_t?D:"",!0,!1),m.forceUpdate()})}return!xt&&!_t&&!Wt&&jn&&!lt&&Dr(m,y,b,S,D+"After",J),!0}function Qr(m){return function(y){var b=m.props.dragTarget,S=y.inputEvent.target,D=m.areaElement;return b&&(S===b||b.contains(S))||S===D||!m.isMoveableElement(S)&&!m.controlBox.contains(S)||ha(S,"moveable-area")||ha(S,"moveable-padding")||ha(S,"moveable-edgeDraggable")}}function _a(m,y,b){var S=m.controlBox,D=[],J=m.props.dragTarget;return D.push(S),(!m.props.dragArea||J)&&D.push(y),Ma(m,D,"targetAbles",b,{dragStart:Qr(m),pinchStart:Qr(m)})}function Ma(m,y,b,S,D){D===void 0&&(D={});var J=b==="targetAbles",lt=m.props,xt=lt.pinchOutside,_t=lt.pinchThreshold,Wt=lt.preventClickEventOnDrag,qt=lt.preventClickDefault,Jt=lt.checkInput,Ut=lt.preventDefault,xe=Ut===void 0?!0:Ut,Ce={preventDefault:xe,preventRightClick:!0,preventWheelClick:!0,container:window,pinchThreshold:_t,pinchOutside:xt,preventClickEventOnDrag:J?Wt:!1,preventClickEventOnDragStart:J?qt:!1,preventClickEventByCondition:J?null:function(dn){return m.controlBox.contains(dn.target)},checkInput:J?Jt:!1},Ue=new Mu(y,Ce),en=S==="Control";return["drag","pinch"].forEach(function(dn){["Start","","End"].forEach(function(Rn){Ue.on("".concat(dn).concat(Rn),function(nr){var Kn,Sr=nr.eventType,jn=dn==="drag"&&nr.isPinch;if(D[Sr]&&!D[Sr](nr)){nr.stop();return}if(!jn){var pr=dn==="drag"?[dn]:["drag",dn],zr=Dr(m,b,pr,S,Rn,nr);zr?(m.props.stopPropagation||Rn==="Start"&&en)&&((Kn=nr==null?void 0:nr.inputEvent)===null||Kn===void 0||Kn.stopPropagation()):nr.stop()}})})}),Ue}var ga=function(){function m(b,S,D){var J=this;this.target=b,this.moveable=S,this.eventName=D,this.ables=[],this._onEvent=function(lt){var xt=J.eventName,_t=J.moveable;_t.state.disableNativeEvent||J.ables.forEach(function(Wt){Wt[xt](_t,{inputEvent:lt})})},b.addEventListener(D.toLowerCase(),this._onEvent)}var y=m.prototype;return y.setAbles=function(b){this.ables=b},y.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},m}();function ai(m,y,b,S){var D;b===void 0&&(b=y);var J=zo(m,y),lt=J.matrixes,xt=J.is3d,_t=J.targetMatrix,Wt=J.transformOrigin,qt=J.targetOrigin,Jt=J.offsetContainer,Ut=J.hasFixed,xe=J.zoom,Ce=Ds(Jt,b),Ue=Ce.matrixes,en=Ce.is3d,dn=Ce.offsetContainer,Rn=Ce.zoom,nr=S||en||xt,Kn=nr?4:3,Sr=m.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in m,jn=_t,pr=Wi(Kn),zr=Wi(Kn),Er=Wi(Kn),oa=Wi(Kn),Gr=lt.length,wa=Ar([],Ue,!0).reverse();lt.reverse(),!xt&&nr&&(jn=ts(jn,3,4),br(lt)),!en&&nr&&br(wa),wa.forEach(function(li){zr=Yi(zr,li.matrix,Kn)});var va=b||document.body,Ua=((D=wa[0])===null||D===void 0?void 0:D.target)||pn(va,va,!0).offsetParent,Ja=wa.slice(1).reduce(function(li,ti){return Yi(li,ti.matrix,Kn)},Wi(Kn));lt.forEach(function(li,ti){if(Gr-2===ti&&(Er=pr.slice()),Gr-1===ti&&(oa=pr.slice()),!li.matrix){var ao=lt[ti+1],$o=jc(li,ao,Ua,Kn,Yi(Ja,pr,Kn));li.matrix=is($o,Kn)}pr=Yi(pr,li.matrix,Kn)});var Li=!Sr&&xt;jn||(jn=Wi(Li?4:3));var Zi=Rc(Sr&&jn.length===16?ts(jn,4,3):jn,Li),Oi=zr;return zr=Fa(zr,Kn,Kn),{hasZoom:xe!==1||Rn!==1,hasFixed:Ut,rootMatrix:zr,originalRootMatrix:Oi,beforeMatrix:Er,offsetMatrix:oa,allMatrix:pr,targetMatrix:jn,targetTransform:Zi,transformOrigin:Wt,targetOrigin:qt,is3d:nr,offsetContainer:Jt,offsetRootContainer:dn}}function uo(m,y,b,S){b===void 0&&(b=y);var D=0,J=0,lt=0,xt={},_t=gp(m);if(m&&(D=_t.offsetWidth,J=_t.offsetHeight),m){var Wt=ai(m,y,b,S),qt=Hh(Wt.allMatrix,Wt.transformOrigin,D,J);xt=De(De({},Wt),qt);var Jt=Hh(Wt.allMatrix,[50,50],100,100);lt=mp([Jt.pos1,Jt.pos2],Jt.direction)}var Ut=S?4:3;return De(De(De({hasZoom:!1,width:D,height:J,rotation:lt},_t),{originalRootMatrix:Wi(Ut),rootMatrix:Wi(Ut),beforeMatrix:Wi(Ut),offsetMatrix:Wi(Ut),allMatrix:Wi(Ut),targetMatrix:Wi(Ut),targetTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!S,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null}),xt)}function bs(m,y,b){return b===void 0&&(b=y),uo(m,y,b,!0)}function Hi(m,y,b,S,D,J){J===void 0&&(J=[]);var lt=1,xt=[0,0],_t=Pd(),Wt=Pd(),qt=Pd(),Jt=Pd(),Ut=[0,0],xe={},Ce=uo(y,b,D,!0);if(y){var Ue=Gs(y);J.forEach(function(wa){xe[wa]=Ue(wa)});var en=Ce.is3d?4:3,dn=Hh(Ce.offsetMatrix,wi(Ce.transformOrigin,oo(Ce.targetMatrix,en)),Ce.width,Ce.height);lt=dn.direction,xt=wi(dn.origin,[dn.left-Ce.left,dn.top-Ce.top]),Jt=rh(Ce.offsetRootContainer);var Rn=pn(S,S,!0).offsetParent||Ce.offsetRootContainer;if(Ce.hasZoom){var nr=Hh(Yi(Ce.originalRootMatrix,Ce.allMatrix),Ce.transformOrigin,Ce.width,Ce.height),Kn=Hh(Ce.originalRootMatrix,_l(Gs(Rn)("transformOrigin")).map(function(wa){return parseFloat(wa)}),Rn.offsetWidth,Rn.offsetHeight);if(_t=il(nr,Jt),qt=il(Kn,Jt,Rn,!0),m){var Sr=nr.left,jn=nr.top;Wt=il({left:Sr,top:jn,bottom:jn,right:jn},Jt)}}else{_t=rh(y),qt=Ts(Rn),m&&(Wt=rh(m));var pr=qt.left,zr=qt.top,Er=qt.clientLeft,oa=qt.clientTop,Gr=[_t.left-pr,_t.top-zr];Ut=gi(bh(Ce.rootMatrix,Gr,4),[Er+Ce.left,oa+Ce.top])}}return De({targetClientRect:_t,containerClientRect:qt,moveableClientRect:Wt,rootContainerClientRect:Jt,beforeDirection:lt,beforeOrigin:xt,originalBeforeOrigin:xt,target:y,style:xe,offsetDelta:Ut},Ce)}function ho(m){var y=m.pos1,b=m.pos2,S=m.pos3,D=m.pos4;if(!y||!b||!S||!D)return null;var J=vl([y,b,S,D]),lt=[J.minX,J.minY],xt=gi(m.origin,lt);return y=gi(y,lt),b=gi(b,lt),S=gi(S,lt),D=gi(D,lt),De(De({},m),{left:m.left,top:m.top,posDelta:lt,pos1:y,pos2:b,pos3:S,pos4:D,origin:xt,beforeOrigin:xt,isPersisted:!0})}var No=function(m){kn(y,m);function y(){var S=m!==null&&m.apply(this,arguments)||this;return S.state=De({container:null,gestos:{},renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},Hi(null)),S.renderState={},S.enabledAbles=[],S.targetAbles=[],S.controlAbles=[],S.rotation=0,S.scale=[1,1],S.isMoveableMounted=!1,S.isUnmounted=!1,S.events={mouseEnter:null,mouseLeave:null},S._emitter=new Ks,S._prevTarget=null,S._prevDragArea=!1,S._isPropTargetChanged=!1,S._hasFirstTarget=!1,S._reiszeObserver=null,S._observerId=0,S._mutationObserver=null,S._rootContainer=null,S._viewContainer=null,S._viewClassNames=[],S._store={},S.checkUpdateRect=function(){if(!S.isDragging()){var D=S.props.parentMoveable;if(D){D.checkUpdateRect();return}Tr(S._observerId),S._observerId=vr(function(){S.isDragging()||S.updateRect()})}},S._onPreventClick=function(D){D.stopPropagation(),D.preventDefault()},S}var b=y.prototype;return b.render=function(){var S=this.props,D=this.getState(),J=S.parentPosition,lt=S.className,xt=S.target,_t=S.zoom,Wt=S.cspNonce,qt=S.translateZ,Jt=S.cssStyled,Ut=S.groupable,xe=S.linePadding,Ce=S.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var Ue=J||[0,0],en=Ue[0],dn=Ue[1],Rn=D.left,nr=D.top,Kn=D.target,Sr=D.direction,jn=D.hasFixed,pr=D.offsetDelta,zr=S.targets,Er=this.isDragging(),oa={};this.getEnabledAbles().forEach(function(Li){oa["data-able-".concat(Li.name.toLowerCase())]=!0});var Gr=this._getAbleClassName(),wa=zr&&zr.length&&(Kn||Ut)||xt||!this._hasFirstTarget&&this.state.isPersisted,va=this.controlBox||this.props.firstRenderState||this.props.persistData,Ua=[Rn-en,nr-dn];!Ut&&S.useAccuratePosition&&(Ua[0]+=pr[0],Ua[1]+=pr[1]);var Ja={position:jn?"fixed":"absolute",display:wa?"block":"none",visibility:va?"visible":"hidden",transform:"translate3d(".concat(Ua[0],"px, ").concat(Ua[1],"px, ").concat(qt,")"),"--zoom":_t,"--zoompx":"".concat(_t,"px")};return xe&&(Ja["--moveable-line-padding"]=xe),Ce&&(Ja["--moveable-control-padding"]=Ce),$r.createElement(Jt,De({cspNonce:Wt,ref:wt(this,"controlBox"),className:"".concat(Vi("control-box",Sr===-1?"reverse":"",Er?"dragging":"")," ").concat(Gr," ").concat(lt)},oa,{onClick:this._onPreventClick,style:Ja}),this.renderAbles(),this._renderLines())},b.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var S=this.props,D=S.parentMoveable,J=S.container,lt=S.wrapperMoveable;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!J&&!D&&!lt&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},b.componentDidUpdate=function(S){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateEvents(),this._updateTargets(),this.updateCheckInput(),this._updateObserver(S)},b.componentWillUnmount=function(){var S,D;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(S=this._reiszeObserver)===null||S===void 0||S.disconnect(),(D=this._mutationObserver)===null||D===void 0||D.disconnect();var J=this._viewContainer;J&&this._changeAbleViewClassNames([]),Al(this,"targetGesto"),Al(this,"controlGesto");var lt=this.events;for(var xt in lt){var _t=lt[xt];_t&&_t.destroy()}},b.getTargets=function(){var S=this.props.target;return S?[S]:[]},b.getAble=function(S){var D=this.props.ables||[];return Cr(D,function(J){return J.name===S})},b.getContainer=function(){var S=this.props,D=S.parentMoveable,J=S.wrapperMoveable,lt=S.container;return lt||J&&J.getContainer()||D&&D.getContainer()||this.controlBox.parentElement},b.isMoveableElement=function(S){var D;return S&&(((D=S.getAttribute)===null||D===void 0?void 0:D.call(S,"class"))||"").indexOf(Vu)>-1},b.dragStart=function(S){var D=this.targetGesto,J=this.controlGesto;return D&&Qr(this)({inputEvent:S})?D.isFlag()||D.triggerDragStart(S):J&&this.isMoveableElement(S.target)&&(J.isFlag()||J.triggerDragStart(S)),this},b.hitTest=function(S){var D=this.state,J=D.target,lt=D.pos1,xt=D.pos2,_t=D.pos3,Wt=D.pos4,qt=D.targetClientRect;if(!J)return 0;var Jt;if(S instanceof Element){var Ut=S.getBoundingClientRect();Jt={left:Ut.left,top:Ut.top,width:Ut.width,height:Ut.height}}else Jt=De({width:0,height:0},S);var xe=Jt.left,Ce=Jt.top,Ue=Jt.width,en=Jt.height,dn=ys([lt,xt,Wt,_t],qt),Rn=ir(dn,[[xe,Ce],[xe+Ue,Ce],[xe+Ue,Ce+en],[xe,Ce+en]]),nr=ol(dn);return!Rn||!nr?0:Math.min(100,Rn/nr*100)},b.isInside=function(S,D){var J=this.state,lt=J.target,xt=J.pos1,_t=J.pos2,Wt=J.pos3,qt=J.pos4,Jt=J.targetClientRect;return lt?kc([S,D],ys([xt,_t,qt,Wt],Jt)):!1},b.updateRect=function(S,D,J){J===void 0&&(J=!0);var lt=this.props,xt=!lt.parentPosition&&!lt.wrapperMoveable;xt&&$s(!0);var _t=lt.parentMoveable,Wt=this.state,qt=Wt.target||lt.target,Jt=this.getContainer(),Ut=_t?_t._rootContainer:this._rootContainer,xe=Hi(this.controlBox,qt,Jt,Jt,Ut||Jt,this._getRequestStyles());if(!qt&&this._hasFirstTarget&&lt.persistData){var Ce=ho(lt.persistData);for(var Ue in Ce)xe[Ue]=Ce[Ue]}xt&&$s(),this.updateState(xe,_t?!1:J)},b.isDragging=function(S){var D,J,lt=this.targetGesto,xt=this.controlGesto;if(lt==null?void 0:lt.isFlag()){if(!S)return!0;var _t=lt.getEventData();return!!((D=_t[S])===null||D===void 0?void 0:D.isEventStart)}if(xt==null?void 0:xt.isFlag()){if(!S)return!0;var _t=xt.getEventData();return!!((J=_t[S])===null||J===void 0?void 0:J.isEventStart)}return!1},b.updateTarget=function(S){this.updateRect(S,!0)},b.getRect=function(){var S=this.state,D=Kl(this.state),J=D[0],lt=D[1],xt=D[2],_t=D[3],Wt=Rl(D),qt=S.width,Jt=S.height,Ut=Wt.width,xe=Wt.height,Ce=Wt.left,Ue=Wt.top,en=[S.left,S.top],dn=wi(en,S.origin),Rn=wi(en,S.beforeOrigin),nr=S.transformOrigin;return{width:Ut,height:xe,left:Ce,top:Ue,pos1:J,pos2:lt,pos3:xt,pos4:_t,offsetWidth:qt,offsetHeight:Jt,beforeOrigin:Rn,origin:dn,transformOrigin:nr,rotation:this.getRotation()}},b.getManager=function(){return this},b.stopDrag=function(S){var D,J;(!S||S==="target")&&((D=this.targetGesto)===null||D===void 0||D.stop()),(!S||S==="control")&&((J=this.controlGesto)===null||J===void 0||J.stop())},b.getRotation=function(){var S=this.state,D=S.pos1,J=S.pos2,lt=S.direction;return sh(D,J,lt)},b.request=function(S,D,J){D===void 0&&(D={});var lt=this.props,xt=lt.ables,_t=lt.groupable,Wt=xt.filter(function(en){return en.name===S})[0];if(this.isDragging()||!Wt||!Wt.request)return{request:function(){return this},requestEnd:function(){return this}};var qt=this,Jt=Wt.request(this),Ut=J||D.isInstant,xe=Jt.isControl?"controlAbles":"targetAbles",Ce="".concat(_t?"Group":"").concat(Jt.isControl?"Control":""),Ue={request:function(en){return Dr(qt,xe,["drag"],Ce,"",De(De({},Jt.request(en)),{requestAble:S,isRequest:!0}),Ut),this},requestEnd:function(){return Dr(qt,xe,["drag"],Ce,"End",De(De({},Jt.requestEnd()),{requestAble:S,isRequest:!0}),Ut),this}};return Dr(qt,xe,["drag"],Ce,"Start",De(De({},Jt.requestStart(D)),{requestAble:S,isRequest:!0}),Ut),Ut?Ue.request(D).requestEnd():Ue},b.destroy=function(){this.componentWillUnmount()},b.updateRenderPoses=function(){var S=this.getState(),D=this.props,J=S.originalBeforeOrigin,lt=S.transformOrigin,xt=S.allMatrix,_t=S.is3d,Wt=S.pos1,qt=S.pos2,Jt=S.pos3,Ut=S.pos4,xe=S.left,Ce=S.top,Ue=S.isPersisted,en=D.padding||{},dn=en.left,Rn=dn===void 0?0:dn,nr=en.top,Kn=nr===void 0?0:nr,Sr=en.bottom,jn=Sr===void 0?0:Sr,pr=en.right,zr=pr===void 0?0:pr,Er=_t?4:3,oa=[];Ue?oa=lt:this.controlBox&&D.groupable?oa=J:oa=wi(J,[xe,Ce]),S.renderPoses=[wi(Wt,xh(xt,[-Rn,-Kn],lt,oa,Er)),wi(qt,xh(xt,[zr,-Kn],lt,oa,Er)),wi(Jt,xh(xt,[-Rn,jn],lt,oa,Er)),wi(Ut,xh(xt,[zr,jn],lt,oa,Er))]},b.checkUpdate=function(){this._isPropTargetChanged=!1;var S=this.props,D=S.target,J=S.container,lt=S.parentMoveable,xt=this.state,_t=xt.target,Wt=xt.container;if(!(!_t&&!D)){this.updateAbles();var qt=!zd(_t,D),Jt=qt||!zd(Wt,J);if(!!Jt){var Ut=J||this.controlBox;Ut&&this.unsetAbles(),this.updateState({target:D,container:J}),!lt&&Ut&&this.updateRect("End",!1,!1),this._isPropTargetChanged=qt}}},b.waitToChangeTarget=function(){return new Promise(function(){})},b.triggerEvent=function(S,D){this._emitter.trigger(S,D);var J=this.props[S];return J&&J(D)},b.useCSS=function(S,D){var J=this.props.customStyledMap,lt=S+D;return J[lt]||(J[lt]=Qe(S,D)),J[lt]},b.getState=function(){var S,D=this.props;(D.target||((S=D.targets)===null||S===void 0?void 0:S.length))&&(this._hasFirstTarget=!0);var J=this.controlBox,lt=D.persistData,xt=D.firstRenderState;if(xt&&!J)return xt;if(!this._hasFirstTarget&&lt){var _t=ho(lt);if(_t)return this.updateState(_t,!1),this.state}return this.state.isPersisted=!1,this.state},b.updateSelectors=function(){},b.unsetAbles=function(){var S=this;this.targetAbles.forEach(function(D){D.unset&&D.unset(S)})},b.updateAbles=function(S,D){S===void 0&&(S=this.props.ables),D===void 0&&(D="");var J=this.props,lt=J.triggerAblesSimultaneously,xt=this.getEnabledAbles(S),_t="drag".concat(D,"Start"),Wt="pinch".concat(D,"Start"),qt="drag".concat(D,"ControlStart"),Jt=ih(xt,[_t,Wt],lt),Ut=ih(xt,[qt],lt);this.enabledAbles=xt,this.targetAbles=Jt,this.controlAbles=Ut},b.updateState=function(S,D){if(D){if(this.isUnmounted)return;this.setState(S)}else{var J=this.state;for(var lt in S)J[lt]=S[lt]}},b.getEnabledAbles=function(S){S===void 0&&(S=this.props.ables);var D=this.props;return S.filter(function(J){return J&&(J.always&&D[J.name]!==!1||D[J.name])})},b.renderAbles=function(){var S=this,D=this.props,J=D.triggerAblesSimultaneously,lt={createElement:$r.createElement};return this.renderState={},Uf($d(ih(this.getEnabledAbles(),["render"],J).map(function(xt){var _t=xt.render;return _t(S,lt)||[]})).filter(function(xt){return xt}),function(xt){var _t=xt.key;return _t}).map(function(xt){return xt[0]})},b.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},b._getRequestStyles=function(){var S=this.getEnabledAbles().reduce(function(D,J){var lt,xt,_t=(xt=(lt=J.requestStyle)===null||lt===void 0?void 0:lt.call(J))!==null&&xt!==void 0?xt:[];return Ar(Ar([],D,!0),_t,!0)},Ar([],this.props.requestStyles||[],!0));return S},b._updateObserver=function(S){this._updateResizeObserver(S),this._updateMutationObserver(S)},b._updateEvents=function(){var S=this.controlBox,D=this.targetAbles.length,J=this.controlAbles.length,lt=this.props,xt=lt.dragTarget||lt.target,_t=!D&&this.targetGesto||this._isTargetChanged(!0);_t&&(Al(this,"targetGesto"),this.updateState({gesto:null})),J||Al(this,"controlGesto"),xt&&D&&!this.targetGesto&&(this.targetGesto=_a(this,xt,"")),!this.controlGesto&&J&&(this.controlGesto=Ma(this,S,"controlAbles","Control"))},b._updateTargets=function(){var S=this.props;this._prevTarget=S.dragTarget||S.target,this._prevDragArea=S.dragArea},b._renderLines=function(){var S=this.props,D=S,J=D.zoom,lt=D.hideDefaultLines,xt=D.hideChildMoveableDefaultLines,_t=D.parentMoveable;if(lt||_t&&xt)return[];var Wt=this.getState().renderPoses,qt={createElement:$r.createElement};return[[0,1],[1,3],[3,2],[2,0]].map(function(Jt,Ut){var xe=Jt[0],Ce=Jt[1];return aa(qt,"",Wt[xe],Wt[Ce],J,"render-line-".concat(Ut))})},b._isTargetChanged=function(S){var D=this.props,J=D.dragTarget||D.target,lt=this._prevTarget,xt=this._prevDragArea,_t=D.dragArea,Wt=!_t&&lt!==J,qt=(S||_t)&&xt!==_t;return Wt||qt},b._updateNativeEvents=function(){var S=this,D=this.props,J=D.dragArea?this.areaElement:this.state.target,lt=this.events,xt=ta(lt);if(this._isTargetChanged())for(var _t in lt){var Wt=lt[_t];Wt&&Wt.destroy(),lt[_t]=null}if(!!J){var qt=this.enabledAbles;xt.forEach(function(Jt){var Ut=ih(qt,[Jt]),xe=Ut.length>0,Ce=lt[Jt];if(!xe){Ce&&(Ce.destroy(),lt[Jt]=null);return}Ce||(Ce=new ga(J,S,Jt),lt[Jt]=Ce),Ce.setAbles(Ut)})}},b._checkUpdateRootContainer=function(){var S=this.props.rootContainer;!this._rootContainer&&S&&(this._rootContainer=uf(S,!0))},b._checkUpdateViewContainer=function(){var S=this.props.viewContainer;!this._viewContainer&&S&&(this._viewContainer=uf(S,!0));var D=this._viewContainer;D&&this._changeAbleViewClassNames(Ar(Ar([],this._getAbleViewClassNames(),!0),[this.isDragging()?Xn:""],!1))},b._changeAbleViewClassNames=function(S){var D=this._viewContainer,J=sf(S.filter(Boolean),function(qt){return qt}).map(function(qt){var Jt=qt[0];return Jt}),lt=this._viewClassNames,xt=Ra(lt,J),_t=xt.removed,Wt=xt.added;_t.forEach(function(qt){Ni(D,lt[qt])}),Wt.forEach(function(qt){_i(D,J[qt])}),this._viewClassNames=J},b._getAbleViewClassNames=function(){var S=this;return(this.getEnabledAbles().map(function(D){var J;return((J=D.viewClassName)===null||J===void 0?void 0:J.call(D,S))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},b._getAbleClassName=function(S){var D=this;S===void 0&&(S="");var J=this.getEnabledAbles(),lt=this.targetGesto,xt=this.controlGesto,_t=(lt==null?void 0:lt.isFlag())?lt.getEventData():{},Wt=(xt==null?void 0:xt.isFlag())?xt.getEventData():{};return J.map(function(qt){var Jt,Ut,xe,Ce=qt.name,Ue=((Jt=qt.className)===null||Jt===void 0?void 0:Jt.call(qt,D))||"";return(((Ut=_t[Ce])===null||Ut===void 0?void 0:Ut.isEventStart)||((xe=Wt[Ce])===null||xe===void 0?void 0:xe.isEventStart))&&(Ue+=" ".concat(Vi("".concat(Ce).concat(S,"-dragging")))),Ue.trim()}).filter(Boolean).join(" ")},b._updateResizeObserver=function(S){var D,J=this.props,lt=J.target;if(!window.ResizeObserver||!lt||!J.useResizeObserver){(D=this._reiszeObserver)===null||D===void 0||D.disconnect();return}if(!(S.target===lt&&this._reiszeObserver)){var xt=new ResizeObserver(this.checkUpdateRect);xt.observe(lt,{box:"border-box"}),this._reiszeObserver=xt}},b._updateMutationObserver=function(S){var D=this,J,lt=this.props,xt=lt.target;if(!window.MutationObserver||!xt||!lt.useMutationObserver){(J=this._mutationObserver)===null||J===void 0||J.disconnect();return}if(!(S.target===xt&&this._mutationObserver)){var _t=new MutationObserver(function(Wt){for(var qt=0,Jt=Wt;qt<Jt.length;qt++){var Ut=Jt[qt];Ut.type==="attributes"&&Ut.attributeName==="style"&&D.checkUpdateRect()}});_t.observe(xt,{attributes:!0}),this._mutationObserver=_t}},y.defaultProps={target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:af,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},y}($r.PureComponent),au={name:"groupable",props:["defaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(m,y){var b,S=m.props,D=S.targets||[],J=m.getState(),lt=J.left,xt=J.top,_t=J.isPersisted,Wt=S.zoom||1,qt=m.renderGroupRects,Jt=((b=S.persistData)===null||b===void 0?void 0:b.children)||[];_t?D=Jt.map(function(){return null}):Jt=[];var Ut=m._store,xe=Gd(Ut,"parentPosition",[lt,xt],function(Ue){return Ue.join(",")}),Ce=Gd(Ut,"requestStyles",m.getRequestChildStyles(),function(Ue){return Ue.join(",")});return m.moveables=m.moveables.slice(0,D.length),Ar(Ar([],D.map(function(Ue,en){return y.createElement(No,{key:"moveable"+en,ref:ot(m,"moveables",en),target:Ue,origin:!1,requestStyles:Ce,cssStyled:S.cssStyled,customStyledMap:S.customStyledMap,useResizeObserver:S.useResizeObserver,hideChildMoveableDefaultLines:S.hideChildMoveableDefaultLines,parentMoveable:m,parentPosition:[lt,xt],persistData:Jt[en],zoom:Wt})}),!0),$d(qt.map(function(Ue,en){var dn=Ue.pos1,Rn=Ue.pos2,nr=Ue.pos3,Kn=Ue.pos4,Sr=[dn,Rn,nr,Kn];return[[0,1],[1,3],[3,2],[2,0]].map(function(jn,pr){var zr=jn[0],Er=jn[1];return aa(y,"",gi(Sr[zr],xe),gi(Sr[Er],xe),Wt,"group-rect-".concat(en,"-").concat(pr))})})),!0)}},xl=ua("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(m,y){y.datas.inputTarget=y.inputEvent&&y.inputEvent.target},dragEnd:function(m,y){var b=m.props.target,S=y.inputEvent,D=y.inputTarget,J=m.isMoveableElement(D),lt=!J&&m.controlBox.contains(D);if(!(!S||!D||y.isDrag||m.isMoveableElement(D)||lt)){var xt=b.contains(D);Sn(m,"onClick",Os(m,y,{isDouble:y.isDouble,inputTarget:D,isTarget:b===D,moveableTarget:m.props.target,containsTarget:xt}))}},dragGroupEnd:function(m,y){var b=y.inputEvent,S=y.inputTarget;if(!(!b||!S||y.isDrag||m.isMoveableElement(S)||y.datas.inputTarget===S)){var D=m.props.targets,J=D.indexOf(S),lt=J>-1,xt=!1;J===-1&&(J=Hr(D,function(_t){return _t.contains(S)}),xt=J>-1),Sn(m,"onClickGroup",Os(m,y,{isDouble:y.isDouble,targets:D,inputTarget:S,targetIndex:J,isTarget:lt,containsTarget:xt,moveableTarget:D[J]}))}},dragControlEnd:function(m,y){this.dragEnd(m,y)},dragGroupControlEnd:function(m,y){this.dragEnd(m,y)}});function uc(m){var y=m.originalDatas.draggable;return y||(m.originalDatas.draggable={},y=m.originalDatas.draggable),De(De({},m),{datas:y})}var Rv=ua("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(m,y){var b=m.props,S=b.edgeDraggable;return S?na(y,"edgeDraggable",S,m.getState().renderPoses,b.zoom):[]},dragCondition:function(m,y){var b,S=m.props,D=(b=y.inputEvent)===null||b===void 0?void 0:b.target;return!S.edgeDraggable||!D?!1:!S.draggable&&ha(D,Vi("direction"))&&ha(D,Vi("edge"))&&ha(D,Vi("edgeDraggable"))},dragStart:function(m,y){return zn.dragStart(m,uc(y))},drag:function(m,y){return zn.drag(m,uc(y))},dragEnd:function(m,y){return zn.dragEnd(m,uc(y))},dragGroupCondition:function(m,y){var b,S=m.props,D=(b=y.inputEvent)===null||b===void 0?void 0:b.target;return!S.edgeDraggable||!D?!1:!S.draggable&&ha(D,Vi("direction"))&&ha(D,Vi("line"))},dragGroupStart:function(m,y){return zn.dragGroupStart(m,uc(y))},dragGroup:function(m,y){return zn.dragGroup(m,uc(y))},dragGroupEnd:function(m,y){return zn.dragGroupEnd(m,uc(y))},unset:function(m){return zn.unset(m)}}),Xf={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},Tg=[ur,Lu,er,Kh,zn,Rv,q,cn,Or,Ye,bi,as,Ai,Nn,Po,Mr,au,Xf,xl,Ki,Cn],Kc=null,Rf=null;function bd(m,y){var b=m[0],S=m[1],D=m[2];return(b*y[0]+S*y[1]+D)/Math.sqrt(b*b+S*S)}function ql(m,y){var b=m[0],S=m[1];return-b*y[0]-S*y[1]}function _p(m,y){return Math.max.apply(Math,m.map(function(b){var S=b[0],D=b[1],J=b[2],lt=b[3];return Math.max(S[y],D[y],J[y],lt[y])}))}function Vm(m,y){return Math.min.apply(Math,m.map(function(b){var S=b[0],D=b[1],J=b[2],lt=b[3];return Math.min(S[y],D[y],J[y],lt[y])}))}function X0(m,y){var b,S=[0,0],D=[0,0],J=[0,0],lt=[0,0],xt=0,_t=0;if(!m.length)return{pos1:S,pos2:D,pos3:J,pos4:lt,minX:0,minY:0,maxX:0,maxY:0,width:xt,height:_t,rotation:y};var Wt=Ht(y,Ou);if(Wt%90){var qt=Wt/180*Math.PI,Jt=Math.tan(qt),Ut=-1/Jt,xe=[Wh,pp],Ce=[[0,0],[0,0]],Ue=[Wh,pp],en=[[0,0],[0,0]];m.forEach(function(li){li.forEach(function(ti){var ao=bd([-Jt,1,0],ti),$o=bd([-Ut,1,0],ti);xe[0]>ao&&(Ce[0]=ti,xe[0]=ao),xe[1]<ao&&(Ce[1]=ti,xe[1]=ao),Ue[0]>$o&&(en[0]=ti,Ue[0]=$o),Ue[1]<$o&&(en[1]=ti,Ue[1]=$o)})});var dn=Ce[0],Rn=Ce[1],nr=en[0],Kn=en[1],Sr=[-Jt,1,ql([-Jt,1],dn)],jn=[-Jt,1,ql([-Jt,1],Rn)],pr=[-Ut,1,ql([-Ut,1],nr)],zr=[-Ut,1,ql([-Ut,1],Kn)];b=[[Sr,pr],[Sr,zr],[jn,pr],[jn,zr]].map(function(li){var ti=li[0],ao=li[1];return _e(ti,ao)[0]}),S=b[0],D=b[1],J=b[2],lt=b[3],xt=Ue[1]-Ue[0],_t=xe[1]-xe[0]}else{var Er=Vm(m,0),oa=Vm(m,1),Gr=_p(m,0),wa=_p(m,1);if(S=[Er,oa],D=[Gr,oa],J=[Er,wa],lt=[Gr,wa],xt=Gr-Er,_t=wa-oa,Wt%180){var va=[J,S,lt,D];S=va[0],D=va[1],J=va[2],lt=va[3],xt=wa-oa,_t=Gr-Er}}if(Wt%360>180){var va=[lt,J,D,S];S=va[0],D=va[1],J=va[2],lt=va[3]}var Ua=vl([S,D,J,lt]),Ja=Ua.minX,Li=Ua.minY,Zi=Ua.maxX,Oi=Ua.maxY;return{pos1:S,pos2:D,pos3:J,pos4:lt,width:xt,height:_t,minX:Ja,minY:Li,maxX:Zi,maxY:Oi,rotation:y}}function Ag(m,y){var b=y.map(function(S){if(Rt(S)){var D=Ag(m,S),J=D.length;return J>1?D:J===1?D[0]:null}else{var lt=Cr(m,function(xt){var _t=xt.manager;return _t.props.target===S});return lt?(lt.finded=!0,lt.manager):null}}).filter(Boolean);return b.length===1&&Rt(b[0])?b[0]:b}var im=function(m){kn(y,m);function y(){var S=m!==null&&m.apply(this,arguments)||this;return S.differ=new ms,S.moveables=[],S.transformOrigin="50% 50%",S.renderGroupRects=[],S._targetGroups=[],S._hasFirstTargets=!1,S}var b=y.prototype;return b.componentDidMount=function(){m.prototype.componentDidMount.call(this)},b.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},b.getTargets=function(){return this.props.targets},b.updateRect=function(S,D,J){var lt;J===void 0&&(J=!0);var xt=this.state;if(!this.controlBox||xt.isPersisted)return;$s(!0),this.moveables.forEach(function(As){As.updateRect(S,!1,!1)});var _t=this.props,Wt=this.moveables,qt=xt.target||_t.target,Jt=Wt.map(function(As){return{finded:!1,manager:As}}),Ut=this.props.targetGroups||[],xe=Ag(Jt,Ut);xe.push.apply(xe,Jt.filter(function(As){var qs=As.finded;return!qs}).map(function(As){var qs=As.manager;return qs}));var Ce=[],Ue=!D||S!==""&&_t.updateGroup,en=_t.defaultGroupRotate||0;if(!this._hasFirstTargets){var dn=(lt=this.props.persistData)===null||lt===void 0?void 0:lt.rotation;dn!=null&&(en=dn)}function Rn(As,qs,Ko){var Ho=As.map(function(du){if(Rt(du)){var Us=Rn(du,qs),Pu=[Us.pos1,Us.pos2,Us.pos3,Us.pos4];return Ce.push(Us),{poses:Pu,rotation:Us.rotation}}else return{poses:Kl(du.state),rotation:du.getRotation()}}),Cu=Ho.map(function(du){var Us=du.rotation;return Us}),Xs=0,jl=Cu[0],_u=Cu.every(function(du){return Math.abs(jl-du)<.1});Ue?Xs=_u?jl:en:Xs=!Ko&&_u?jl:qs;var hu=Ho.map(function(du){var Us=du.poses;return Us}),yl=X0(hu,Xs);return yl}var nr=Rn(xe,this.rotation,!0);Ue&&(this.rotation=nr.rotation,this.transformOrigin=_t.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=Ut,this.renderGroupRects=Ce;var Kn=this.transformOrigin,Sr=this.rotation,jn=this.scale,pr=nr.width,zr=nr.height,Er=nr.minX,oa=nr.minY,Gr=hd([[0,0],[pr,0],[0,zr],[pr,zr]],Vp(Kn,pr,zr),this.rotation/180*Math.PI),wa=vl(Gr.result),va=wa.minX,Ua=wa.minY,Ja=" rotate(".concat(Sr,"deg)")+" scale(".concat(jn[0]>=0?1:-1,", ").concat(jn[1]>=0?1:-1,")"),Li="translate(".concat(-va,"px, ").concat(-Ua,"px)").concat(Ja);this.controlBox.style.transform="translate3d(".concat(Er,"px, ").concat(oa,"px, ").concat(this.props.translateZ||0,")"),qt.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(Kn,";")+"width:".concat(pr,"px;height:").concat(zr,"px;")+"transform: ".concat(Li),xt.width=pr,xt.height=zr;var Zi=this.getContainer(),Oi=Hi(this.controlBox,qt,this.controlBox,this.getContainer(),this._rootContainer||Zi,[]),li=[Oi.left,Oi.top],ti=Kl(Oi),ao=ti[0],$o=ti[1],Oo=ti[2],Ss=ti[3],mo=vl([ao,$o,Oo,Ss]),So=[mo.minX,mo.minY],fs=jn[0]*jn[1]>0?1:-1;Oi.pos1=gi(ao,So),Oi.pos2=gi($o,So),Oi.pos3=gi(Oo,So),Oi.pos4=gi(Ss,So),Oi.left=Er-Oi.left+So[0],Oi.top=oa-Oi.top+So[1],Oi.origin=gi(wi(li,Oi.origin),So),Oi.beforeOrigin=gi(wi(li,Oi.beforeOrigin),So),Oi.originalBeforeOrigin=wi(li,Oi.originalBeforeOrigin),Oi.transformOrigin=gi(wi(li,Oi.transformOrigin),So),qt.style.transform="translate(".concat(-va-So[0],"px, ").concat(-Ua-So[1],"px)")+Ja,$s(),this.updateState(De(De({},Oi),{posDelta:So,direction:fs,beforeDirection:fs}),J)},b.getRect=function(){return De(De({},m.prototype.getRect.call(this)),{children:this.moveables.map(function(S){return S.getRect()})})},b.triggerEvent=function(S,D,J){if(J||S.indexOf("Group")>-1)return m.prototype.triggerEvent.call(this,S,D);this._emitter.trigger(S,D)},b.getRequestChildStyles=function(){var S=this.getEnabledAbles().reduce(function(D,J){var lt,xt,_t=(xt=(lt=J.requestChildStyle)===null||lt===void 0?void 0:lt.call(J))!==null&&xt!==void 0?xt:[];return Ar(Ar([],D,!0),_t,!0)},[]);return S},b.updateAbles=function(){m.prototype.updateAbles.call(this,Ar(Ar([],this.props.ables,!0),[au],!1),"Group")},b._updateTargets=function(){m.prototype._updateTargets.call(this),this._prevTarget=this.props.dragTarget||this.areaElement},b._updateEvents=function(){var S=this.state,D=this.props,J=this._prevTarget,lt=D.dragTarget||this.areaElement;J!==lt&&(Al(this,"targetGesto"),Al(this,"controlGesto"),S.target=null),S.target||(S.target=this.areaElement,this.controlBox.style.display="block"),S.target&&(this.targetGesto||(this.targetGesto=_a(this,lt,"Group")),this.controlGesto||(this.controlGesto=Ma(this,this.controlBox,"controlAbles","GroupControl")));var xt=!zd(S.container,D.container);xt&&(S.container=D.container);var _t=D.targets,Wt=this.differ.update(_t),qt=Wt.added,Jt=Wt.changed,Ut=Wt.removed,xe=qt.length||Ut.length;(xt||xe||this.transformOrigin!==(D.defaultGroupOrigin||"50% 50%")||Jt.length||_t.length&&!jp(this._targetGroups,D.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!xe},b._updateObserver=function(){},y.defaultProps=De(De({},No.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),y}(No),om=function(m){kn(y,m);function y(){var S=m!==null&&m.apply(this,arguments)||this;return S.moveables=[],S}var b=y.prototype;return b.render=function(){var S=this,D,J=this.props,lt=J.cspNonce,xt=J.cssStyled,_t=J.persistData,Wt=J.targets||[],qt=Wt.length,Jt=this.isUnmounted||!qt,Ut=(D=_t==null?void 0:_t.children)!==null&&D!==void 0?D:[];return Jt&&!qt&&Ut.length?Wt=Ut.map(function(){return null}):Jt||(Ut=[]),$r.createElement(xt,{cspNonce:lt,ref:wt(this,"controlBox"),className:Vi("control-box")},Wt.map(function(xe,Ce){var Ue,en,dn=(en=(Ue=J.individualGroupableProps)===null||Ue===void 0?void 0:Ue.call(J,xe,Ce))!==null&&en!==void 0?en:{};return $r.createElement(No,De({key:"moveable"+Ce,ref:ot(S,"moveables",Ce)},J,dn,{target:xe,wrapperMoveable:S,isWrapperMounted:S.isMoveableMounted,persistData:Ut[Ce]}))}))},b.componentDidUpdate=function(){},b.getTargets=function(){return this.props.targets},b.updateRect=function(S,D,J){J===void 0&&(J=!0),$s(!0),this.moveables.forEach(function(lt){lt.updateRect(S,D,J)}),$s()},b.getRect=function(){return De(De({},m.prototype.getRect.call(this)),{children:this.moveables.map(function(S){return S.getRect()})})},b.request=function(){return{request:function(){return this},requestEnd:function(){return this}}},b.dragStart=function(){return this},b.hitTest=function(){return 0},b.isInside=function(){return!1},b.isDragging=function(){return!1},b.updateRenderPoses=function(){},b.checkUpdate=function(){},b.triggerEvent=function(){},b.updateAbles=function(){},b._updateEvents=function(){},b._updateObserver=function(){},y}(No);function Lv(m,y){var b=[];return m.forEach(function(S){if(!!S){if(Yn(S)){y[S]&&b.push.apply(b,y[S]);return}Rt(S)?b.push.apply(b,Lv(S,y)):b.push(S)}}),b}function M1(m,y){var b=[];return m.forEach(function(S){if(!!S){if(Yn(S)){y[S]&&b.push.apply(b,y[S]);return}Rt(S)?b.push(M1(S,y)):b.push(S)}}),b}function Y0(m,y){return m.length!==y.length||m.some(function(b,S){var D=y[S];return!b&&!D?!1:b!=D?Rt(b)&&Rt(D)?Y0(b,D):!0:!1})}var xd=function(m){kn(y,m);function y(){var S=m!==null&&m.apply(this,arguments)||this;return S.refTargets=[],S.selectorMap={},S._differ=new ms,S._elementTargets=[],S._onChangeTargets=null,S}var b=y.prototype;return y.makeStyled=function(){var S={},D=this.getTotalAbles();D.forEach(function(lt){var xt=lt.css;!xt||xt.forEach(function(_t){S[_t]=!0})});var J=ta(S).join(`
`);this.defaultStyled=Qe("div",gt(Vu,ru+J))},y.getTotalAbles=function(){return Ar([Lu,au,Xf,Ki],this.defaultAbles,!0)},b.render=function(){var S,D=this.constructor;D.defaultStyled||D.makeStyled();var J=this.props,lt=J.ables,xt=J.props,_t=wr(J,["ables","props"]),Wt=this._updateRefs(!0),qt=Lv(Wt,this.selectorMap),Jt=qt.length>1,Ut=D.getTotalAbles(),xe=Ar(Ar([],Ut,!0),lt||[],!0),Ce=De(De(De({},_t),xt||{}),{ables:xe,cssStyled:D.defaultStyled,customStyledMap:D.customStyledMap});this._elementTargets=qt;var Ue=null,en=this.moveable,dn=_t.persistData;if((dn==null?void 0:dn.children)&&(Jt=!0),_t.individualGroupable)return $r.createElement(om,De({key:"individual-group",ref:wt(this,"moveable")},Ce,{target:null,targets:qt}));if(Jt){var Rn=M1(Wt,this.selectorMap);if(en&&!en.props.groupable&&!en.props.individualGroupable){var nr=en.props.target;nr&&qt.indexOf(nr)>-1&&(Ue=De({},en.state))}return $r.createElement(im,De({key:"group",ref:wt(this,"moveable")},Ce,(S=_t.groupableProps)!==null&&S!==void 0?S:{},{target:null,targets:qt,targetGroups:Rn,firstRenderState:Ue}))}else{var Kn=qt[0];if(en&&(en.props.groupable||en.props.individualGroupable)){var Sr=en.moveables||[],jn=Cr(Sr,function(pr){return pr.props.target===Kn});jn&&(Ue=De({},jn.state))}return $r.createElement(No,De({key:"single",ref:wt(this,"moveable")},Ce,{target:Kn,firstRenderState:Ue}))}},b.componentDidMount=function(){this._checkChangeTargets(),this._updateRefs()},b.componentDidUpdate=function(){this._checkChangeTargets()},b.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},b.getTargets=function(){var S,D;return(D=(S=this.moveable)===null||S===void 0?void 0:S.getTargets())!==null&&D!==void 0?D:[]},b.updateSelectors=function(){this.selectorMap={},this._updateRefs()},b.waitToChangeTarget=function(){var S=this,D;return this._onChangeTargets=function(){S._onChangeTargets=null,D()},new Promise(function(J){D=J})},b.waitToChangeTargets=function(){return this.waitToChangeTarget()},b.getManager=function(){return this.moveable},b._updateRefs=function(S){var D=this.refTargets,J=wh(this.props.target||this.props.targets),lt=typeof document!="undefined",xt=Y0(D,J),_t=this.selectorMap,Wt={};return this.refTargets.forEach(function qt(Jt){if(Yn(Jt)){var Ut=_t[Jt];Ut?Wt[Jt]=_t[Jt]:lt&&(xt=!0,Wt[Jt]=[].slice.call(document.querySelectorAll(Jt)))}else Rt(Jt)&&Jt.forEach(qt)}),this.refTargets=J,this.selectorMap=Wt,!S&&xt&&this.forceUpdate(),J},b._checkChangeTargets=function(){var S,D,J,lt=this._differ.update(this._elementTargets),xt=lt.added,_t=lt.removed,Wt=xt.length||_t.length;Wt&&((D=(S=this.props).onChangeTargets)===null||D===void 0||D.call(S,{moveable:this.moveable,targets:this._elementTargets}),(J=this._onChangeTargets)===null||J===void 0||J.call(this)),this._updateRefs()},y.defaultAbles=[],y.customStyledMap={},y.defaultStyled=null,ca([Nt(vp)],y.prototype,"moveable",void 0),y}($r.PureComponent),iv=function(m){kn(y,m);function y(){return m!==null&&m.apply(this,arguments)||this}return y.defaultAbles=Tg,y}(xd);function _c(m){var y;return y=function(b){kn(S,b);function S(){return b!==null&&b.apply(this,arguments)||this}return S}(xd),y.defaultAbles=m,y}},17453:function(sr,it,$){"use strict";var X=$(22122),tt=$(19756),j=$(63349),W=$(41788),Q=$(67294),Z=!!document.documentElement.currentStyle,L={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},P=["letter-spacing","line-height","font-family","font-weight","font-size","font-style","tab-size","text-rendering","text-transform","width","text-indent","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","box-sizing"],C={},M=document.createElement("textarea"),k=function(mt){Object.keys(L).forEach(function(st){mt.style.setProperty(st,L[st],"important")})};M.setAttribute("tab-index","-1"),M.setAttribute("aria-hidden","true"),k(M);function B(ft,mt,st,ut,dt){st===void 0&&(st=!1),ut===void 0&&(ut=null),dt===void 0&&(dt=null),M.parentNode===null&&document.body.appendChild(M);var gt=R(ft,mt,st);if(gt===null)return null;var wt=gt.paddingSize,ot=gt.borderSize,pt=gt.boxSizing,Nt=gt.sizingStyle;Object.keys(Nt).forEach(function(At){M.style[At]=Nt[At]}),k(M),M.value=ft.value||ft.placeholder||"x";var Gt=-Infinity,se=Infinity,ie=M.scrollHeight;pt==="border-box"?ie=ie+ot:pt==="content-box"&&(ie=ie-wt),M.value="x";var Be=M.scrollHeight-wt,ke=Math.floor(ie/Be);ut!==null&&(Gt=Be*ut,pt==="border-box"&&(Gt=Gt+wt+ot),ie=Math.max(Gt,ie)),dt!==null&&(se=Be*dt,pt==="border-box"&&(se=se+wt+ot),ie=Math.min(se,ie));var we=Math.floor(ie/Be);return{height:ie,minHeight:Gt,maxHeight:se,rowCount:we,valueRowCount:ke}}function R(ft,mt,st){if(st===void 0&&(st=!1),st&&C[mt])return C[mt];var ut=window.getComputedStyle(ft);if(ut===null)return null;var dt=P.reduce(function(Nt,Gt){return Nt[Gt]=ut.getPropertyValue(Gt),Nt},{}),gt=dt["box-sizing"];if(gt==="")return null;Z&&gt==="border-box"&&(dt.width=parseFloat(dt.width)+parseFloat(ut["border-right-width"])+parseFloat(ut["border-left-width"])+parseFloat(ut["padding-right"])+parseFloat(ut["padding-left"])+"px");var wt=parseFloat(dt["padding-bottom"])+parseFloat(dt["padding-top"]),ot=parseFloat(dt["border-bottom-width"])+parseFloat(dt["border-top-width"]),pt={sizingStyle:dt,paddingSize:wt,borderSize:ot,boxSizing:gt};return st&&(C[mt]=pt),pt}var F=function(mt){delete C[mt]},K=function(){},O=0,_=function(ft){(0,W.Z)(mt,ft);function mt(ut){var dt;return dt=ft.call(this,ut)||this,dt._onRef=function(gt){dt._ref=gt;var wt=dt.props.inputRef;if(typeof wt=="function"){wt(gt);return}wt.current=gt},dt._onChange=function(gt){dt._controlled||dt._resizeComponent(),dt.props.onChange(gt,(0,j.Z)(dt))},dt._resizeComponent=function(gt){gt===void 0&&(gt=K);var wt=B(dt._ref,dt._uid,dt.props.useCacheForDOMMeasurements,dt.props.minRows,dt.props.maxRows);if(wt===null){gt();return}var ot=wt.height,pt=wt.minHeight,Nt=wt.maxHeight,Gt=wt.rowCount,se=wt.valueRowCount;if(dt.rowCount=Gt,dt.valueRowCount=se,dt.state.height!==ot||dt.state.minHeight!==pt||dt.state.maxHeight!==Nt){dt.setState({height:ot,minHeight:pt,maxHeight:Nt},gt);return}gt()},dt.state={height:ut.style&&ut.style.height||0,minHeight:-Infinity,maxHeight:Infinity},dt._uid=O++,dt._controlled=ut.value!==void 0,dt._resizeLock=!1,dt}var st=mt.prototype;return st.render=function(){var dt=this.props,gt=dt.inputRef,wt=dt.maxRows,ot=dt.minRows,pt=dt.onHeightChange,Nt=dt.useCacheForDOMMeasurements,Gt=(0,tt.Z)(dt,["inputRef","maxRows","minRows","onHeightChange","useCacheForDOMMeasurements"]);Gt.style=(0,X.Z)({},Gt.style,{height:this.state.height});var se=Math.max(Gt.style.maxHeight||Infinity,this.state.maxHeight);return se<this.state.height&&(Gt.style.overflow="hidden"),(0,Q.createElement)("textarea",(0,X.Z)({},Gt,{onChange:this._onChange,ref:this._onRef}))},st.componentDidMount=function(){var dt=this;this._resizeComponent(),this._resizeListener=function(){dt._resizeLock||(dt._resizeLock=!0,dt._resizeComponent(function(){dt._resizeLock=!1}))},window.addEventListener("resize",this._resizeListener)},st.componentDidUpdate=function(dt,gt){dt!==this.props&&this._resizeComponent(),this.state.height!==gt.height&&this.props.onHeightChange(this.state.height,this)},st.componentWillUnmount=function(){window.removeEventListener("resize",this._resizeListener),F(this._uid)},mt}(Q.Component);_.defaultProps={inputRef:K,onChange:K,onHeightChange:K,useCacheForDOMMeasurements:!1},it.Z=_},81550:function(sr){(function(it,$){sr.exports=$()})(this,function(){"use strict";var it=function(ce){return ce instanceof Uint8Array||ce instanceof Uint16Array||ce instanceof Uint32Array||ce instanceof Int8Array||ce instanceof Int16Array||ce instanceof Int32Array||ce instanceof Float32Array||ce instanceof Float64Array||ce instanceof Uint8ClampedArray},$=function(ce,vn){for(var er=Object.keys(vn),ia=0;ia<er.length;++ia)ce[er[ia]]=vn[er[ia]];return ce},X=`
`;function tt(ce){return typeof atob!="undefined"?atob(ce):"base64:"+ce}function j(ce){var vn=new Error("(regl) "+ce);throw console.error(vn),vn}function W(ce,vn){ce||j(vn)}function Q(ce){return ce?": "+ce:""}function Z(ce,vn,er){ce in vn||j("unknown parameter ("+ce+")"+Q(er)+". possible values: "+Object.keys(vn).join())}function L(ce,vn){it(ce)||j("invalid parameter type"+Q(vn)+". must be a typed array")}function P(ce,vn){switch(vn){case"number":return typeof ce=="number";case"object":return typeof ce=="object";case"string":return typeof ce=="string";case"boolean":return typeof ce=="boolean";case"function":return typeof ce=="function";case"undefined":return typeof ce=="undefined";case"symbol":return typeof ce=="symbol"}}function C(ce,vn,er){P(ce,vn)||j("invalid parameter type"+Q(er)+". expected "+vn+", got "+typeof ce)}function M(ce,vn){ce>=0&&(ce|0)===ce||j("invalid parameter type, ("+ce+")"+Q(vn)+". must be a nonnegative integer")}function k(ce,vn,er){vn.indexOf(ce)<0&&j("invalid value"+Q(er)+". must be one of: "+vn)}var B=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function R(ce){Object.keys(ce).forEach(function(vn){B.indexOf(vn)<0&&j('invalid regl constructor argument "'+vn+'". must be one of '+B)})}function F(ce,vn){for(ce=ce+"";ce.length<vn;)ce=" "+ce;return ce}function K(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function O(ce,vn){this.number=ce,this.line=vn,this.errors=[]}function _(ce,vn,er){this.file=ce,this.line=vn,this.message=er}function ft(){var ce=new Error,vn=(ce.stack||ce).toString(),er=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(vn);if(er)return er[1];var ia=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(vn);return ia?ia[1]:"unknown"}function mt(){var ce=new Error,vn=(ce.stack||ce).toString(),er=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(vn);if(er)return er[1];var ia=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(vn);return ia?ia[1]:"unknown"}function st(ce,vn){var er=ce.split(`
`),ia=1,da=0,aa={unknown:new K,0:new K};aa.unknown.name=aa[0].name=vn||ft(),aa.unknown.lines.push(new O(0,""));for(var na=0;na<er.length;++na){var Xa=er[na],Oa=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Xa);if(Oa)switch(Oa[1]){case"line":var Qa=/(\d+)(\s+\d+)?/.exec(Oa[2]);Qa&&(ia=Qa[1]|0,Qa[2]&&(da=Qa[2]|0,da in aa||(aa[da]=new K)));break;case"define":var Ka=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Oa[2]);Ka&&(aa[da].name=Ka[1]?tt(Ka[2]):Ka[2]);break}aa[da].lines.push(new O(ia++,Xa))}return Object.keys(aa).forEach(function(zn){var N=aa[zn];N.lines.forEach(function(q){N.index[q.number]=q})}),aa}function ut(ce){var vn=[];return ce.split(`
`).forEach(function(er){if(!(er.length<5)){var ia=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(er);ia?vn.push(new _(ia[1]|0,ia[2]|0,ia[3].trim())):er.length>0&&vn.push(new _("unknown",0,er))}}),vn}function dt(ce,vn){vn.forEach(function(er){var ia=ce[er.file];if(ia){var da=ia.index[er.line];if(da){da.errors.push(er),ia.hasErrors=!0;return}}ce.unknown.hasErrors=!0,ce.unknown.lines[0].errors.push(er)})}function gt(ce,vn,er,ia,da){if(!ce.getShaderParameter(vn,ce.COMPILE_STATUS)){var aa=ce.getShaderInfoLog(vn),na=ia===ce.FRAGMENT_SHADER?"fragment":"vertex";ie(er,"string",na+" shader source must be a string",da);var Xa=st(er,da),Oa=ut(aa);dt(Xa,Oa),Object.keys(Xa).forEach(function(Qa){var Ka=Xa[Qa];if(!Ka.hasErrors)return;var zn=[""],N=[""];function q(ht,It){zn.push(ht),N.push(It||"")}q("file number "+Qa+": "+Ka.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Ka.lines.forEach(function(ht){if(ht.errors.length>0){q(F(ht.number,4)+"|  ","background-color:yellow; font-weight:bold"),q(ht.line+X,"color:red; background-color:yellow; font-weight:bold");var It=0;ht.errors.forEach(function(Ft){var Xt=Ft.message,oe=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Xt);if(oe){var he=oe[1];switch(Xt=oe[2],he){case"assign":he="=";break}It=Math.max(ht.line.indexOf(he,It),0)}else It=0;q(F("| ",6)),q(F("^^^",It+3)+X,"font-weight:bold"),q(F("| ",6)),q(Xt+X,"font-weight:bold")}),q(F("| ",6)+X)}else q(F(ht.number,4)+"|  "),q(ht.line+X,"color:red")}),typeof document!="undefined"&&!window.chrome?(N[0]=zn.join("%c"),console.log.apply(console,N)):console.log(zn.join(""))}),W.raise("Error compiling "+na+" shader, "+Xa[0].name)}}function wt(ce,vn,er,ia,da){if(!ce.getProgramParameter(vn,ce.LINK_STATUS)){var aa=ce.getProgramInfoLog(vn),na=st(er,da),Xa=st(ia,da),Oa='Error linking program with vertex shader, "'+Xa[0].name+'", and fragment shader "'+na[0].name+'"';typeof document!="undefined"?console.log("%c"+Oa+X+"%c"+aa,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Oa+X+aa),W.raise(Oa)}}function ot(ce){ce._commandRef=ft()}function pt(ce,vn,er,ia){ot(ce);function da(Oa){return Oa?ia.id(Oa):0}ce._fragId=da(ce.static.frag),ce._vertId=da(ce.static.vert);function aa(Oa,Qa){Object.keys(Qa).forEach(function(Ka){Oa[ia.id(Ka)]=!0})}var na=ce._uniformSet={};aa(na,vn.static),aa(na,vn.dynamic);var Xa=ce._attributeSet={};aa(Xa,er.static),aa(Xa,er.dynamic),ce._hasCount="count"in ce.static||"count"in ce.dynamic||"elements"in ce.static||"elements"in ce.dynamic}function Nt(ce,vn){var er=mt();j(ce+" in command "+(vn||ft())+(er==="unknown"?"":" called from "+er))}function Gt(ce,vn,er){ce||Nt(vn,er||ft())}function se(ce,vn,er,ia){ce in vn||Nt("unknown parameter ("+ce+")"+Q(er)+". possible values: "+Object.keys(vn).join(),ia||ft())}function ie(ce,vn,er,ia){P(ce,vn)||Nt("invalid parameter type"+Q(er)+". expected "+vn+", got "+typeof ce,ia||ft())}function Be(ce){ce()}function ke(ce,vn,er){ce.texture?k(ce.texture._texture.internalformat,vn,"unsupported texture format for attachment"):k(ce.renderbuffer._renderbuffer.format,er,"unsupported renderbuffer format for attachment")}var we=33071,At=9728,Yt=9984,be=9985,nn=9986,Ee=9987,le=5120,Le=5121,Ze=5122,fe=5123,Re=5124,He=5125,pe=5126,Ge=32819,te=32820,Me=33635,We=34042,ee=36193,Pt={};Pt[le]=Pt[Le]=1,Pt[Ze]=Pt[fe]=Pt[ee]=Pt[Me]=Pt[Ge]=Pt[te]=2,Pt[Re]=Pt[He]=Pt[pe]=Pt[We]=4;function yt(ce,vn){return ce===te||ce===Ge||ce===Me?2:ce===We?4:Pt[ce]*vn}function Ne(ce){return!(ce&ce-1)&&!!ce}function tn(ce,vn,er){var ia,da=vn.width,aa=vn.height,na=vn.channels;W(da>0&&da<=er.maxTextureSize&&aa>0&&aa<=er.maxTextureSize,"invalid texture shape"),(ce.wrapS!==we||ce.wrapT!==we)&&W(Ne(da)&&Ne(aa),"incompatible wrap mode for texture, both width and height must be power of 2"),vn.mipmask===1?da!==1&&aa!==1&&W(ce.minFilter!==Yt&&ce.minFilter!==nn&&ce.minFilter!==be&&ce.minFilter!==Ee,"min filter requires mipmap"):(W(Ne(da)&&Ne(aa),"texture must be a square power of 2 to support mipmapping"),W(vn.mipmask===(da<<1)-1,"missing or incomplete mipmap data")),vn.type===pe&&(er.extensions.indexOf("oes_texture_float_linear")<0&&W(ce.minFilter===At&&ce.magFilter===At,"filter not supported, must enable oes_texture_float_linear"),W(!ce.genMipmaps,"mipmap generation not supported with float textures"));var Xa=vn.images;for(ia=0;ia<16;++ia)if(Xa[ia]){var Oa=da>>ia,Qa=aa>>ia;W(vn.mipmask&1<<ia,"missing mipmap data");var Ka=Xa[ia];if(W(Ka.width===Oa&&Ka.height===Qa,"invalid shape for mip images"),W(Ka.format===vn.format&&Ka.internalformat===vn.internalformat&&Ka.type===vn.type,"incompatible type for mip image"),!Ka.compressed)if(Ka.data){var zn=Math.ceil(yt(Ka.type,na)*Oa/Ka.unpackAlignment)*Ka.unpackAlignment;W(Ka.data.byteLength===zn*Qa,"invalid data for image, buffer size is inconsistent with image format")}else Ka.element||Ka.copy}else ce.genMipmaps||W((vn.mipmask&1<<ia)==0,"extra mipmap data");vn.compressed&&W(!ce.genMipmaps,"mipmap generation for compressed images not supported")}function fn(ce,vn,er,ia){var da=ce.width,aa=ce.height,na=ce.channels;W(da>0&&da<=ia.maxTextureSize&&aa>0&&aa<=ia.maxTextureSize,"invalid texture shape"),W(da===aa,"cube map must be square"),W(vn.wrapS===we&&vn.wrapT===we,"wrap mode not supported by cube map");for(var Xa=0;Xa<er.length;++Xa){var Oa=er[Xa];W(Oa.width===da&&Oa.height===aa,"inconsistent cube map face shape"),vn.genMipmaps&&(W(!Oa.compressed,"can not generate mipmap for compressed textures"),W(Oa.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Qa=Oa.images,Ka=0;Ka<16;++Ka){var zn=Qa[Ka];if(zn){var N=da>>Ka,q=aa>>Ka;W(Oa.mipmask&1<<Ka,"missing mipmap data"),W(zn.width===N&&zn.height===q,"invalid shape for mip images"),W(zn.format===ce.format&&zn.internalformat===ce.internalformat&&zn.type===ce.type,"incompatible type for mip image"),zn.compressed||(zn.data?W(zn.data.byteLength===N*q*Math.max(yt(zn.type,na),zn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):zn.element||zn.copy)}}}}var Rt=$(W,{optional:Be,raise:j,commandRaise:Nt,command:Gt,parameter:Z,commandParameter:se,constructor:R,type:C,commandType:ie,isTypedArray:L,nni:M,oneOf:k,shaderError:gt,linkError:wt,callSite:mt,saveCommandRef:ot,saveDrawInfo:pt,framebufferFormat:ke,guessCommand:ft,texture2D:tn,textureCube:fn}),Yn=0,Un=0,xr=5,cr=6;function Ur(ce,vn){this.id=Yn++,this.type=ce,this.data=vn}function fa(ce){return ce.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Sa(ce){if(ce.length===0)return[];var vn=ce.charAt(0),er=ce.charAt(ce.length-1);if(ce.length>1&&vn===er&&(vn==='"'||vn==="'"))return['"'+fa(ce.substr(1,ce.length-2))+'"'];var ia=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ce);if(ia)return Sa(ce.substr(0,ia.index)).concat(Sa(ia[1])).concat(Sa(ce.substr(ia.index+ia[0].length)));var da=ce.split(".");if(da.length===1)return['"'+fa(ce)+'"'];for(var aa=[],na=0;na<da.length;++na)aa=aa.concat(Sa(da[na]));return aa}function sa(ce){return"["+Sa(ce).join("][")+"]"}function Da(ce,vn){return new Ur(ce,sa(vn+""))}function Rr(ce){return typeof ce=="function"&&!ce._reglType||ce instanceof Ur}function Mn(ce,vn){if(typeof ce=="function")return new Ur(Un,ce);if(typeof ce=="number"||typeof ce=="boolean")return new Ur(xr,ce);if(Array.isArray(ce))return new Ur(cr,ce.map((er,ia)=>Mn(er,vn+"["+ia+"]")));if(ce instanceof Ur)return ce;Rt(!1,"invalid option type in uniform "+vn)}var ar={DynamicVariable:Ur,define:Da,isDynamic:Rr,unbox:Mn,accessor:sa},Fn={next:typeof requestAnimationFrame=="function"?function(ce){return requestAnimationFrame(ce)}:function(ce){return setTimeout(ce,16)},cancel:typeof cancelAnimationFrame=="function"?function(ce){return cancelAnimationFrame(ce)}:clearTimeout},tr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Gn(){var ce={"":0},vn=[""];return{id:function(er){var ia=ce[er];return ia||(ia=ce[er]=vn.length,vn.push(er),ia)},str:function(er){return vn[er]}}}function jr(ce,vn,er){var ia=document.createElement("canvas");$(ia.style,{border:0,margin:0,padding:0,top:0,left:0}),ce.appendChild(ia),ce===document.body&&(ia.style.position="absolute",$(ce.style,{margin:0,padding:0}));function da(){var Xa=window.innerWidth,Oa=window.innerHeight;if(ce!==document.body){var Qa=ce.getBoundingClientRect();Xa=Qa.right-Qa.left,Oa=Qa.bottom-Qa.top}ia.width=er*Xa,ia.height=er*Oa,$(ia.style,{width:Xa+"px",height:Oa+"px"})}var aa;ce!==document.body&&typeof ResizeObserver=="function"?(aa=new ResizeObserver(function(){setTimeout(da)}),aa.observe(ce)):window.addEventListener("resize",da,!1);function na(){aa?aa.disconnect():window.removeEventListener("resize",da),ce.removeChild(ia)}return da(),{canvas:ia,onDestroy:na}}function Hr(ce,vn){function er(ia){try{return ce.getContext(ia,vn)}catch(da){return null}}return er("webgl")||er("experimental-webgl")||er("webgl-experimental")}function Ea(ce){return typeof ce.nodeName=="string"&&typeof ce.appendChild=="function"&&typeof ce.getBoundingClientRect=="function"}function lr(ce){return typeof ce.drawArrays=="function"||typeof ce.drawElements=="function"}function Cr(ce){return typeof ce=="string"?ce.split():(Rt(Array.isArray(ce),"invalid extension array"),ce)}function vr(ce){return typeof ce=="string"?(Rt(typeof document!="undefined","not supported outside of DOM"),document.querySelector(ce)):ce}function Tr(ce){var vn=ce||{},er,ia,da,aa,na={},Xa=[],Oa=[],Qa=typeof window=="undefined"?1:window.devicePixelRatio,Ka=!1,zn=function(ht){ht&&Rt.raise(ht)},N=function(){};if(typeof vn=="string"?(Rt(typeof document!="undefined","selector queries only supported in DOM enviroments"),er=document.querySelector(vn),Rt(er,"invalid query string for element")):typeof vn=="object"?Ea(vn)?er=vn:lr(vn)?(aa=vn,da=aa.canvas):(Rt.constructor(vn),"gl"in vn?aa=vn.gl:"canvas"in vn?da=vr(vn.canvas):"container"in vn&&(ia=vr(vn.container)),"attributes"in vn&&(na=vn.attributes,Rt.type(na,"object","invalid context attributes")),"extensions"in vn&&(Xa=Cr(vn.extensions)),"optionalExtensions"in vn&&(Oa=Cr(vn.optionalExtensions)),"onDone"in vn&&(Rt.type(vn.onDone,"function","invalid or missing onDone callback"),zn=vn.onDone),"profile"in vn&&(Ka=!!vn.profile),"pixelRatio"in vn&&(Qa=+vn.pixelRatio,Rt(Qa>0,"invalid pixel ratio"))):Rt.raise("invalid arguments to regl"),er&&(er.nodeName.toLowerCase()==="canvas"?da=er:ia=er),!aa){if(!da){Rt(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var q=jr(ia||document.body,zn,Qa);if(!q)return null;da=q.canvas,N=q.onDestroy}na.premultipliedAlpha===void 0&&(na.premultipliedAlpha=!0),aa=Hr(da,na)}return aa?{gl:aa,canvas:da,container:ia,extensions:Xa,optionalExtensions:Oa,pixelRatio:Qa,profile:Ka,onDone:zn,onDestroy:N}:(N(),zn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function ta(ce,vn){var er={};function ia(na){Rt.type(na,"string","extension name must be string");var Xa=na.toLowerCase(),Oa;try{Oa=er[Xa]=ce.getExtension(Xa)}catch(Qa){}return!!Oa}for(var da=0;da<vn.extensions.length;++da){var aa=vn.extensions[da];if(!ia(aa))return vn.onDestroy(),vn.onDone('"'+aa+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return vn.optionalExtensions.forEach(ia),{extensions:er,restore:function(){Object.keys(er).forEach(function(na){if(er[na]&&!ia(na))throw new Error("(regl): error restoring extension "+na)})}}}function ra(ce,vn){for(var er=Array(ce),ia=0;ia<ce;++ia)er[ia]=vn(ia);return er}var Zr=5120,vt=5121,_n=5122,an=5123,Lt=5124,kt=5125,at=5126;function H(ce){for(var vn=16;vn<=1<<28;vn*=16)if(ce<=vn)return vn;return 0}function Y(ce){var vn,er;return vn=(ce>65535)<<4,ce>>>=vn,er=(ce>255)<<3,ce>>>=er,vn|=er,er=(ce>15)<<2,ce>>>=er,vn|=er,er=(ce>3)<<1,ce>>>=er,vn|=er,vn|ce>>1}function bt(){var ce=ra(8,function(){return[]});function vn(aa){var na=H(aa),Xa=ce[Y(na)>>2];return Xa.length>0?Xa.pop():new ArrayBuffer(na)}function er(aa){ce[Y(aa.byteLength)>>2].push(aa)}function ia(aa,na){var Xa=null;switch(aa){case Zr:Xa=new Int8Array(vn(na),0,na);break;case vt:Xa=new Uint8Array(vn(na),0,na);break;case _n:Xa=new Int16Array(vn(2*na),0,na);break;case an:Xa=new Uint16Array(vn(2*na),0,na);break;case Lt:Xa=new Int32Array(vn(4*na),0,na);break;case kt:Xa=new Uint32Array(vn(4*na),0,na);break;case at:Xa=new Float32Array(vn(4*na),0,na);break;default:return null}return Xa.length!==na?Xa.subarray(0,na):Xa}function da(aa){er(aa.buffer)}return{alloc:vn,free:er,allocType:ia,freeType:da}}var $t=bt();$t.zero=bt();var jt=3408,Ht=3410,re=3411,on=3412,Je=3413,Ve=3414,qn=3415,Ln=33901,qr=33902,Ca=3379,Qn=3386,_r=34921,ea=36347,La=36348,ha=35661,_i=35660,Ni=34930,vi=36349,si=34076,Mi=34024,Pa=7936,un=7937,Oe=7938,hn=35724,Hn=34047,Bn=36063,Jn=34852,Lr=3553,ya=34067,Fa=34069,ui=33984,Ei=6408,oo=5126,po=5121,bo=36160,ts=36053,Wo=36064,Yi=16384,wi=function(ce,vn){var er=1;vn.ext_texture_filter_anisotropic&&(er=ce.getParameter(Hn));var ia=1,da=1;vn.webgl_draw_buffers&&(ia=ce.getParameter(Jn),da=ce.getParameter(Bn));var aa=!!vn.oes_texture_float;if(aa){var na=ce.createTexture();ce.bindTexture(Lr,na),ce.texImage2D(Lr,0,Ei,1,1,0,Ei,oo,null);var Xa=ce.createFramebuffer();if(ce.bindFramebuffer(bo,Xa),ce.framebufferTexture2D(bo,Wo,Lr,na,0),ce.bindTexture(Lr,null),ce.checkFramebufferStatus(bo)!==ts)aa=!1;else{ce.viewport(0,0,1,1),ce.clearColor(1,0,0,1),ce.clear(Yi);var Oa=$t.allocType(oo,4);ce.readPixels(0,0,1,1,Ei,oo,Oa),ce.getError()?aa=!1:(ce.deleteFramebuffer(Xa),ce.deleteTexture(na),aa=Oa[0]===1),$t.freeType(Oa)}}var Qa=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Ka=!0;if(!Qa){var zn=ce.createTexture(),N=$t.allocType(po,36);ce.activeTexture(ui),ce.bindTexture(ya,zn),ce.texImage2D(Fa,0,Ei,3,3,0,Ei,po,N),$t.freeType(N),ce.bindTexture(ya,null),ce.deleteTexture(zn),Ka=!ce.getError()}return{colorBits:[ce.getParameter(Ht),ce.getParameter(re),ce.getParameter(on),ce.getParameter(Je)],depthBits:ce.getParameter(Ve),stencilBits:ce.getParameter(qn),subpixelBits:ce.getParameter(jt),extensions:Object.keys(vn).filter(function(q){return!!vn[q]}),maxAnisotropic:er,maxDrawbuffers:ia,maxColorAttachments:da,pointSizeDims:ce.getParameter(Ln),lineWidthDims:ce.getParameter(qr),maxViewportDims:ce.getParameter(Qn),maxCombinedTextureUnits:ce.getParameter(ha),maxCubeMapSize:ce.getParameter(si),maxRenderbufferSize:ce.getParameter(Mi),maxTextureUnits:ce.getParameter(Ni),maxTextureSize:ce.getParameter(Ca),maxAttributes:ce.getParameter(_r),maxVertexUniforms:ce.getParameter(ea),maxVertexTextureUnits:ce.getParameter(_i),maxVaryingVectors:ce.getParameter(La),maxFragmentUniforms:ce.getParameter(vi),glsl:ce.getParameter(hn),renderer:ce.getParameter(un),vendor:ce.getParameter(Pa),version:ce.getParameter(Oe),readFloat:aa,npotTextureCube:Ka}};function gi(ce){return!!ce&&typeof ce=="object"&&Array.isArray(ce.shape)&&Array.isArray(ce.stride)&&typeof ce.offset=="number"&&ce.shape.length===ce.stride.length&&(Array.isArray(ce.data)||it(ce.data))}var us=function(ce){return Object.keys(ce).map(function(vn){return ce[vn]})},Do={shape:yu,flatten:Ms};function Io(ce,vn,er){for(var ia=0;ia<vn;++ia)er[ia]=ce[ia]}function zs(ce,vn,er,ia){for(var da=0,aa=0;aa<vn;++aa)for(var na=ce[aa],Xa=0;Xa<er;++Xa)ia[da++]=na[Xa]}function mu(ce,vn,er,ia,da,aa){for(var na=aa,Xa=0;Xa<vn;++Xa)for(var Oa=ce[Xa],Qa=0;Qa<er;++Qa)for(var Ka=Oa[Qa],zn=0;zn<ia;++zn)da[na++]=Ka[zn]}function ds(ce,vn,er,ia,da){for(var aa=1,na=er+1;na<vn.length;++na)aa*=vn[na];var Xa=vn[er];if(vn.length-er==4){var Oa=vn[er+1],Qa=vn[er+2],Ka=vn[er+3];for(na=0;na<Xa;++na)mu(ce[na],Oa,Qa,Ka,ia,da),da+=aa}else for(na=0;na<Xa;++na)ds(ce[na],vn,er+1,ia,da),da+=aa}function Ms(ce,vn,er,ia){var da=1;if(vn.length)for(var aa=0;aa<vn.length;++aa)da*=vn[aa];else da=0;var na=ia||$t.allocType(er,da);switch(vn.length){case 0:break;case 1:Io(ce,vn[0],na);break;case 2:zs(ce,vn[0],vn[1],na);break;case 3:mu(ce,vn[0],vn[1],vn[2],na,0);break;default:ds(ce,vn,0,na,0)}return na}function yu(ce){for(var vn=[],er=ce;er.length;er=er[0])vn.push(er.length);return vn}var uu={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Cs=5120,qo=5122,Wi=5124,ls=5121,is=5123,Es=5125,tl=5126,bu=5126,Ys={int8:Cs,int16:qo,int32:Wi,uint8:ls,uint16:is,uint32:Es,float:tl,float32:bu},ka=35048,Ku=35040,Vs={dynamic:ka,stream:Ku,static:35044},Ro=Do.flatten,Ns=Do.shape,tu=35044,eu=35040,Zu=5121,bn=5126,Xr=[];Xr[5120]=1,Xr[5122]=2,Xr[5124]=4,Xr[5121]=1,Xr[5123]=2,Xr[5125]=4,Xr[5126]=4;function pa(ce){return uu[Object.prototype.toString.call(ce)]|0}function Ra(ce,vn){for(var er=0;er<vn.length;++er)ce[er]=vn[er]}function Qi(ce,vn,er,ia,da,aa,na){for(var Xa=0,Oa=0;Oa<er;++Oa)for(var Qa=0;Qa<ia;++Qa)ce[Xa++]=vn[da*Oa+aa*Qa+na]}function Co(ce,vn,er,ia){var da=0,aa={};function na(It){this.id=da++,this.buffer=ce.createBuffer(),this.type=It,this.usage=tu,this.byteLength=0,this.dimension=1,this.dtype=Zu,this.persistentData=null,er.profile&&(this.stats={size:0})}na.prototype.bind=function(){ce.bindBuffer(this.type,this.buffer)},na.prototype.destroy=function(){N(this)};var Xa=[];function Oa(It,Ft){var Xt=Xa.pop();return Xt||(Xt=new na(It)),Xt.bind(),zn(Xt,Ft,eu,0,1,!1),Xt}function Qa(It){Xa.push(It)}function Ka(It,Ft,Xt){It.byteLength=Ft.byteLength,ce.bufferData(It.type,Ft,Xt)}function zn(It,Ft,Xt,oe,he,Te){var Ye;if(It.usage=Xt,Array.isArray(Ft)){if(It.dtype=oe||bn,Ft.length>0){var gn;if(Array.isArray(Ft[0])){Ye=Ns(Ft);for(var cn=1,Vn=1;Vn<Ye.length;++Vn)cn*=Ye[Vn];It.dimension=cn,gn=Ro(Ft,Ye,It.dtype),Ka(It,gn,Xt),Te?It.persistentData=gn:$t.freeType(gn)}else if(typeof Ft[0]=="number"){It.dimension=he;var An=$t.allocType(It.dtype,Ft.length);Ra(An,Ft),Ka(It,An,Xt),Te?It.persistentData=An:$t.freeType(An)}else it(Ft[0])?(It.dimension=Ft[0].length,It.dtype=oe||pa(Ft[0])||bn,gn=Ro(Ft,[Ft.length,Ft[0].length],It.dtype),Ka(It,gn,Xt),Te?It.persistentData=gn:$t.freeType(gn)):Rt.raise("invalid buffer data")}}else if(it(Ft))It.dtype=oe||pa(Ft),It.dimension=he,Ka(It,Ft,Xt),Te&&(It.persistentData=new Uint8Array(new Uint8Array(Ft.buffer)));else if(gi(Ft)){Ye=Ft.shape;var ma=Ft.stride,Or=Ft.offset,Fr=0,rr=0,Za=0,Xn=0;Ye.length===1?(Fr=Ye[0],rr=1,Za=ma[0],Xn=0):Ye.length===2?(Fr=Ye[0],rr=Ye[1],Za=ma[0],Xn=ma[1]):Rt.raise("invalid shape"),It.dtype=oe||pa(Ft.data)||bn,It.dimension=rr;var ii=$t.allocType(It.dtype,Fr*rr);Qi(ii,Ft.data,Fr,rr,Za,Xn,Or),Ka(It,ii,Xt),Te?It.persistentData=ii:$t.freeType(ii)}else Ft instanceof ArrayBuffer?(It.dtype=Zu,It.dimension=he,Ka(It,Ft,Xt),Te&&(It.persistentData=new Uint8Array(new Uint8Array(Ft)))):Rt.raise("invalid buffer data")}function N(It){vn.bufferCount--,ia(It);var Ft=It.buffer;Rt(Ft,"buffer must not be deleted already"),ce.deleteBuffer(Ft),It.buffer=null,delete aa[It.id]}function q(It,Ft,Xt,oe){vn.bufferCount++;var he=new na(Ft);aa[he.id]=he;function Te(cn){var Vn=tu,An=null,ma=0,Or=0,Fr=1;return Array.isArray(cn)||it(cn)||gi(cn)||cn instanceof ArrayBuffer?An=cn:typeof cn=="number"?ma=cn|0:cn&&(Rt.type(cn,"object","buffer arguments must be an object, a number or an array"),"data"in cn&&(Rt(An===null||Array.isArray(An)||it(An)||gi(An),"invalid data for buffer"),An=cn.data),"usage"in cn&&(Rt.parameter(cn.usage,Vs,"invalid buffer usage"),Vn=Vs[cn.usage]),"type"in cn&&(Rt.parameter(cn.type,Ys,"invalid buffer type"),Or=Ys[cn.type]),"dimension"in cn&&(Rt.type(cn.dimension,"number","invalid dimension"),Fr=cn.dimension|0),"length"in cn&&(Rt.nni(ma,"buffer length must be a nonnegative integer"),ma=cn.length|0)),he.bind(),An?zn(he,An,Vn,Or,Fr,oe):(ma&&ce.bufferData(he.type,ma,Vn),he.dtype=Or||Zu,he.usage=Vn,he.dimension=Fr,he.byteLength=ma),er.profile&&(he.stats.size=he.byteLength*Xr[he.dtype]),Te}function Ye(cn,Vn){Rt(Vn+cn.byteLength<=he.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+cn.byteLength+" starting from offset "+Vn+" to a buffer of size "+he.byteLength),ce.bufferSubData(he.type,Vn,cn)}function gn(cn,Vn){var An=(Vn||0)|0,ma;if(he.bind(),it(cn)||cn instanceof ArrayBuffer)Ye(cn,An);else if(Array.isArray(cn)){if(cn.length>0)if(typeof cn[0]=="number"){var Or=$t.allocType(he.dtype,cn.length);Ra(Or,cn),Ye(Or,An),$t.freeType(Or)}else if(Array.isArray(cn[0])||it(cn[0])){ma=Ns(cn);var Fr=Ro(cn,ma,he.dtype);Ye(Fr,An),$t.freeType(Fr)}else Rt.raise("invalid buffer data")}else if(gi(cn)){ma=cn.shape;var rr=cn.stride,Za=0,Xn=0,ii=0,Ti=0;ma.length===1?(Za=ma[0],Xn=1,ii=rr[0],Ti=0):ma.length===2?(Za=ma[0],Xn=ma[1],ii=rr[0],Ti=rr[1]):Rt.raise("invalid shape");var Ki=Array.isArray(cn.data)?he.dtype:pa(cn.data),Ai=$t.allocType(Ki,Za*Xn);Qi(Ai,cn.data,Za,Xn,ii,Ti,cn.offset),Ye(Ai,An),$t.freeType(Ai)}else Rt.raise("invalid data for buffer subdata");return Te}return Xt||Te(It),Te._reglType="buffer",Te._buffer=he,Te.subdata=gn,er.profile&&(Te.stats=he.stats),Te.destroy=function(){N(he)},Te}function ht(){us(aa).forEach(function(It){It.buffer=ce.createBuffer(),ce.bindBuffer(It.type,It.buffer),ce.bufferData(It.type,It.persistentData||It.byteLength,It.usage)})}return er.profile&&(vn.getTotalBufferSize=function(){var It=0;return Object.keys(aa).forEach(function(Ft){It+=aa[Ft].stats.size}),It}),{create:q,createStream:Oa,destroyStream:Qa,clear:function(){us(aa).forEach(N),Xa.forEach(N)},getBuffer:function(It){return It&&It._buffer instanceof na?It._buffer:null},restore:ht,_initBuffer:zn}}var to=0,xo=0,gs=1,vo=1,ou=4,ms=4,xu={points:to,point:xo,lines:gs,line:vo,triangles:ou,triangle:ms,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},dl=0,kl=1,Ks=4,el=5120,lu=5121,Du=5122,pl=5123,ns=5124,_s=5125,Bu=34963,Au=35040,wu=35044;function nu(ce,vn,er,ia){var da={},aa=0,na={uint8:lu,uint16:pl};vn.oes_element_index_uint&&(na.uint32=_s);function Xa(ht){this.id=aa++,da[this.id]=this,this.buffer=ht,this.primType=Ks,this.vertCount=0,this.type=0}Xa.prototype.bind=function(){this.buffer.bind()};var Oa=[];function Qa(ht){var It=Oa.pop();return It||(It=new Xa(er.create(null,Bu,!0,!1)._buffer)),zn(It,ht,Au,-1,-1,0,0),It}function Ka(ht){Oa.push(ht)}function zn(ht,It,Ft,Xt,oe,he,Te){ht.buffer.bind();var Ye;if(It){var gn=Te;!Te&&(!it(It)||gi(It)&&!it(It.data))&&(gn=vn.oes_element_index_uint?_s:pl),er._initBuffer(ht.buffer,It,Ft,gn,3)}else ce.bufferData(Bu,he,Ft),ht.buffer.dtype=Ye||lu,ht.buffer.usage=Ft,ht.buffer.dimension=3,ht.buffer.byteLength=he;if(Ye=Te,!Te){switch(ht.buffer.dtype){case lu:case el:Ye=lu;break;case pl:case Du:Ye=pl;break;case _s:case ns:Ye=_s;break;default:Rt.raise("unsupported type for element array")}ht.buffer.dtype=Ye}ht.type=Ye,Rt(Ye!==_s||!!vn.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var cn=oe;cn<0&&(cn=ht.buffer.byteLength,Ye===pl?cn>>=1:Ye===_s&&(cn>>=2)),ht.vertCount=cn;var Vn=Xt;if(Xt<0){Vn=Ks;var An=ht.buffer.dimension;An===1&&(Vn=dl),An===2&&(Vn=kl),An===3&&(Vn=Ks)}ht.primType=Vn}function N(ht){ia.elementsCount--,Rt(ht.buffer!==null,"must not double destroy elements"),delete da[ht.id],ht.buffer.destroy(),ht.buffer=null}function q(ht,It){var Ft=er.create(null,Bu,!0),Xt=new Xa(Ft._buffer);ia.elementsCount++;function oe(he){if(!he)Ft(),Xt.primType=Ks,Xt.vertCount=0,Xt.type=lu;else if(typeof he=="number")Ft(he),Xt.primType=Ks,Xt.vertCount=he|0,Xt.type=lu;else{var Te=null,Ye=wu,gn=-1,cn=-1,Vn=0,An=0;Array.isArray(he)||it(he)||gi(he)?Te=he:(Rt.type(he,"object","invalid arguments for elements"),"data"in he&&(Te=he.data,Rt(Array.isArray(Te)||it(Te)||gi(Te),"invalid data for element buffer")),"usage"in he&&(Rt.parameter(he.usage,Vs,"invalid element buffer usage"),Ye=Vs[he.usage]),"primitive"in he&&(Rt.parameter(he.primitive,xu,"invalid element buffer primitive"),gn=xu[he.primitive]),"count"in he&&(Rt(typeof he.count=="number"&&he.count>=0,"invalid vertex count for elements"),cn=he.count|0),"type"in he&&(Rt.parameter(he.type,na,"invalid buffer type"),An=na[he.type]),"length"in he?Vn=he.length|0:(Vn=cn,An===pl||An===Du?Vn*=2:(An===_s||An===ns)&&(Vn*=4))),zn(Xt,Te,Ye,gn,cn,Vn,An)}return oe}return oe(ht),oe._reglType="elements",oe._elements=Xt,oe.subdata=function(he,Te){return Ft.subdata(he,Te),oe},oe.destroy=function(){N(Xt)},oe}return{create:q,createStream:Qa,destroyStream:Ka,getElements:function(ht){return typeof ht=="function"&&ht._elements instanceof Xa?ht._elements:null},clear:function(){us(da).forEach(N)}}}var Tl=new Float32Array(1),xc=new Uint32Array(Tl.buffer),Sl=5123;function ol(ce){for(var vn=$t.allocType(Sl,ce.length),er=0;er<ce.length;++er)if(isNaN(ce[er]))vn[er]=65535;else if(ce[er]===Infinity)vn[er]=31744;else if(ce[er]===-Infinity)vn[er]=64512;else{Tl[0]=ce[er];var ia=xc[0],da=ia>>>31<<15,aa=(ia<<1>>>24)-127,na=ia>>13&(1<<10)-1;if(aa<-24)vn[er]=da;else if(aa<-14){var Xa=-14-aa;vn[er]=da+(na+(1<<10)>>Xa)}else aa>15?vn[er]=da+31744:vn[er]=da+(aa+15<<10)+na}return vn}function ys(ce){return Array.isArray(ce)||it(ce)}var vl=function(ce){return!(ce&ce-1)&&!!ce},kc=34467,Dl=3553,Ol=34067,_e=34069,ve=6408,Bt=6406,ae=6407,me=6409,En=6410,Zn=32854,Kt=32855,ge=36194,Ae=32819,sn=32820,xn=33635,ir=34042,$r=6402,Aa=34041,Va=35904,Ba=35906,oi=36193,ro=33776,Di=33777,Si=33778,_o=33779,To=35986,wo=35987,Vo=34798,js=35840,ws=35841,ks=35842,Hs=35843,Mu=36196,nl=5121,Cl=5123,Yl=5125,sl=5126,rl=10242,_f=10243,Dc=10497,wc=33071,ef=33648,A=10240,nt=10241,Zt=9728,de=9729,Pe=9984,Qe=9985,rn=9986,wn=9987,kn=33170,De=4352,wr=4353,ca=4354,Ar=34046,ua=3317,$a=37440,ri=37441,ba=37443,ki=37444,Eo=33984,Lo=[Pe,rn,Qe,wn],Bo=[0,me,En,ae,ve],go={};go[me]=go[Bt]=go[$r]=1,go[Aa]=go[En]=2,go[ae]=go[Va]=3,go[ve]=go[Ba]=4;function Ao(ce){return"[object "+ce+"]"}var qu=Ao("HTMLCanvasElement"),zu=Ao("OffscreenCanvas"),Uu=Ao("CanvasRenderingContext2D"),Qu=Ao("ImageBitmap"),Wu=Ao("HTMLImageElement"),al=Ao("HTMLVideoElement"),Vu=Object.keys(uu).concat([qu,zu,Uu,Qu,Wu,al]),ps=[];ps[nl]=1,ps[sl]=4,ps[oi]=2,ps[Cl]=2,ps[Yl]=4;var ru=[];ru[Zn]=2,ru[Kt]=2,ru[ge]=2,ru[Aa]=4,ru[ro]=.5,ru[Di]=.5,ru[Si]=1,ru[_o]=1,ru[To]=.5,ru[wo]=1,ru[Vo]=1,ru[js]=.5,ru[ws]=.25,ru[ks]=.5,ru[Hs]=.25,ru[Mu]=.5;function pf(ce){return Array.isArray(ce)&&(ce.length===0||typeof ce[0]=="number")}function Ec(ce){if(!Array.isArray(ce))return!1;var vn=ce.length;return!(vn===0||!ys(ce[0]))}function Ou(ce){return Object.prototype.toString.call(ce)}function Uc(ce){return Ou(ce)===qu}function Wh(ce){return Ou(ce)===zu}function pp(ce){return Ou(ce)===Uu}function $p(ce){return Ou(ce)===Qu}function sd(ce){return Ou(ce)===Wu}function kd(ce){return Ou(ce)===al}function vp(ce){if(!ce)return!1;var vn=Ou(ce);return Vu.indexOf(vn)>=0?!0:pf(ce)||Ec(ce)||gi(ce)}function $f(ce){return uu[Object.prototype.toString.call(ce)]|0}function If(ce,vn){var er=vn.length;switch(ce.type){case nl:case Cl:case Yl:case sl:var ia=$t.allocType(ce.type,er);ia.set(vn),ce.data=ia;break;case oi:ce.data=ol(vn);break;default:Rt.raise("unsupported texture type, must specify a typed array")}}function Dd(ce,vn){return $t.allocType(ce.type===oi?sl:ce.type,vn)}function eh(ce,vn){ce.type===oi?(ce.data=ol(vn),$t.freeType(vn)):ce.data=vn}function Gp(ce,vn,er,ia,da,aa){for(var na=ce.width,Xa=ce.height,Oa=ce.channels,Qa=na*Xa*Oa,Ka=Dd(ce,Qa),zn=0,N=0;N<Xa;++N)for(var q=0;q<na;++q)for(var ht=0;ht<Oa;++ht)Ka[zn++]=vn[er*q+ia*N+da*ht+aa];eh(ce,Ka)}function Oc(ce,vn,er,ia,da,aa){var na;if(typeof ru[ce]!="undefined"?na=ru[ce]:na=go[ce]*ps[vn],aa&&(na*=6),da){for(var Xa=0,Oa=er;Oa>=1;)Xa+=na*Oa*Oa,Oa/=2;return Xa}else return na*er*ia}function vh(ce,vn,er,ia,da,aa,na){var Xa={"don't care":De,"dont care":De,nice:ca,fast:wr},Oa={repeat:Dc,clamp:wc,mirror:ef},Qa={nearest:Zt,linear:de},Ka=$({mipmap:wn,"nearest mipmap nearest":Pe,"linear mipmap nearest":Qe,"nearest mipmap linear":rn,"linear mipmap linear":wn},Qa),zn={none:0,browser:ki},N={uint8:nl,rgba4:Ae,rgb565:xn,"rgb5 a1":sn},q={alpha:Bt,luminance:me,"luminance alpha":En,rgb:ae,rgba:ve,rgba4:Zn,"rgb5 a1":Kt,rgb565:ge},ht={};vn.ext_srgb&&(q.srgb=Va,q.srgba=Ba),vn.oes_texture_float&&(N.float32=N.float=sl),vn.oes_texture_half_float&&(N.float16=N["half float"]=oi),vn.webgl_depth_texture&&($(q,{depth:$r,"depth stencil":Aa}),$(N,{uint16:Cl,uint32:Yl,"depth stencil":ir})),vn.webgl_compressed_texture_s3tc&&$(ht,{"rgb s3tc dxt1":ro,"rgba s3tc dxt1":Di,"rgba s3tc dxt3":Si,"rgba s3tc dxt5":_o}),vn.webgl_compressed_texture_atc&&$(ht,{"rgb atc":To,"rgba atc explicit alpha":wo,"rgba atc interpolated alpha":Vo}),vn.webgl_compressed_texture_pvrtc&&$(ht,{"rgb pvrtc 4bppv1":js,"rgb pvrtc 2bppv1":ws,"rgba pvrtc 4bppv1":ks,"rgba pvrtc 2bppv1":Hs}),vn.webgl_compressed_texture_etc1&&(ht["rgb etc1"]=Mu);var It=Array.prototype.slice.call(ce.getParameter(kc));Object.keys(ht).forEach(function(Wn){var Jr=ht[Wn];It.indexOf(Jr)>=0&&(q[Wn]=Jr)});var Ft=Object.keys(q);er.textureFormats=Ft;var Xt=[];Object.keys(q).forEach(function(Wn){var Jr=q[Wn];Xt[Jr]=Wn});var oe=[];Object.keys(N).forEach(function(Wn){var Jr=N[Wn];oe[Jr]=Wn});var he=[];Object.keys(Qa).forEach(function(Wn){var Jr=Qa[Wn];he[Jr]=Wn});var Te=[];Object.keys(Ka).forEach(function(Wn){var Jr=Ka[Wn];Te[Jr]=Wn});var Ye=[];Object.keys(Oa).forEach(function(Wn){var Jr=Oa[Wn];Ye[Jr]=Wn});var gn=Ft.reduce(function(Wn,Jr){var Nr=q[Jr];return Nr===me||Nr===Bt||Nr===me||Nr===En||Nr===$r||Nr===Aa||vn.ext_srgb&&(Nr===Va||Nr===Ba)?Wn[Nr]=Nr:Nr===Kt||Jr.indexOf("rgba")>=0?Wn[Nr]=ve:Wn[Nr]=ae,Wn},{});function cn(){this.internalformat=ve,this.format=ve,this.type=nl,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=ki,this.width=0,this.height=0,this.channels=0}function Vn(Wn,Jr){Wn.internalformat=Jr.internalformat,Wn.format=Jr.format,Wn.type=Jr.type,Wn.compressed=Jr.compressed,Wn.premultiplyAlpha=Jr.premultiplyAlpha,Wn.flipY=Jr.flipY,Wn.unpackAlignment=Jr.unpackAlignment,Wn.colorSpace=Jr.colorSpace,Wn.width=Jr.width,Wn.height=Jr.height,Wn.channels=Jr.channels}function An(Wn,Jr){if(!(typeof Jr!="object"||!Jr)){if("premultiplyAlpha"in Jr&&(Rt.type(Jr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Wn.premultiplyAlpha=Jr.premultiplyAlpha),"flipY"in Jr&&(Rt.type(Jr.flipY,"boolean","invalid texture flip"),Wn.flipY=Jr.flipY),"alignment"in Jr&&(Rt.oneOf(Jr.alignment,[1,2,4,8],"invalid texture unpack alignment"),Wn.unpackAlignment=Jr.alignment),"colorSpace"in Jr&&(Rt.parameter(Jr.colorSpace,zn,"invalid colorSpace"),Wn.colorSpace=zn[Jr.colorSpace]),"type"in Jr){var Nr=Jr.type;Rt(vn.oes_texture_float||!(Nr==="float"||Nr==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),Rt(vn.oes_texture_half_float||!(Nr==="half float"||Nr==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),Rt(vn.webgl_depth_texture||!(Nr==="uint16"||Nr==="uint32"||Nr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Rt.parameter(Nr,N,"invalid texture type"),Wn.type=N[Nr]}var ji=Wn.width,Po=Wn.height,Nn=Wn.channels,ln=!1;"shape"in Jr?(Rt(Array.isArray(Jr.shape)&&Jr.shape.length>=2,"shape must be an array"),ji=Jr.shape[0],Po=Jr.shape[1],Jr.shape.length===3&&(Nn=Jr.shape[2],Rt(Nn>0&&Nn<=4,"invalid number of channels"),ln=!0),Rt(ji>=0&&ji<=er.maxTextureSize,"invalid width"),Rt(Po>=0&&Po<=er.maxTextureSize,"invalid height")):("radius"in Jr&&(ji=Po=Jr.radius,Rt(ji>=0&&ji<=er.maxTextureSize,"invalid radius")),"width"in Jr&&(ji=Jr.width,Rt(ji>=0&&ji<=er.maxTextureSize,"invalid width")),"height"in Jr&&(Po=Jr.height,Rt(Po>=0&&Po<=er.maxTextureSize,"invalid height")),"channels"in Jr&&(Nn=Jr.channels,Rt(Nn>0&&Nn<=4,"invalid number of channels"),ln=!0)),Wn.width=ji|0,Wn.height=Po|0,Wn.channels=Nn|0;var fr=!1;if("format"in Jr){var Pr=Jr.format;Rt(vn.webgl_depth_texture||!(Pr==="depth"||Pr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Rt.parameter(Pr,q,"invalid texture format");var Vr=Wn.internalformat=q[Pr];Wn.format=gn[Vr],Pr in N&&("type"in Jr||(Wn.type=N[Pr])),Pr in ht&&(Wn.compressed=!0),fr=!0}!ln&&fr?Wn.channels=go[Wn.format]:ln&&!fr?Wn.channels!==Bo[Wn.format]&&(Wn.format=Wn.internalformat=Bo[Wn.channels]):fr&&ln&&Rt(Wn.channels===go[Wn.format],"number of channels inconsistent with specified format")}}function ma(Wn){ce.pixelStorei($a,Wn.flipY),ce.pixelStorei(ri,Wn.premultiplyAlpha),ce.pixelStorei(ba,Wn.colorSpace),ce.pixelStorei(ua,Wn.unpackAlignment)}function Or(){cn.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Fr(Wn,Jr){var Nr=null;if(vp(Jr)?Nr=Jr:Jr&&(Rt.type(Jr,"object","invalid pixel data type"),An(Wn,Jr),"x"in Jr&&(Wn.xOffset=Jr.x|0),"y"in Jr&&(Wn.yOffset=Jr.y|0),vp(Jr.data)&&(Nr=Jr.data)),Rt(!Wn.compressed||Nr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Jr.copy){Rt(!Nr,"can not specify copy and data field for the same texture");var ji=da.viewportWidth,Po=da.viewportHeight;Wn.width=Wn.width||ji-Wn.xOffset,Wn.height=Wn.height||Po-Wn.yOffset,Wn.needsCopy=!0,Rt(Wn.xOffset>=0&&Wn.xOffset<ji&&Wn.yOffset>=0&&Wn.yOffset<Po&&Wn.width>0&&Wn.width<=ji&&Wn.height>0&&Wn.height<=Po,"copy texture read out of bounds")}else if(!Nr)Wn.width=Wn.width||1,Wn.height=Wn.height||1,Wn.channels=Wn.channels||4;else if(it(Nr))Wn.channels=Wn.channels||4,Wn.data=Nr,!("type"in Jr)&&Wn.type===nl&&(Wn.type=$f(Nr));else if(pf(Nr))Wn.channels=Wn.channels||4,If(Wn,Nr),Wn.alignment=1,Wn.needsFree=!0;else if(gi(Nr)){var Nn=Nr.data;!Array.isArray(Nn)&&Wn.type===nl&&(Wn.type=$f(Nn));var ln=Nr.shape,fr=Nr.stride,Pr,Vr,mr,hr,Mr,On;ln.length===3?(mr=ln[2],On=fr[2]):(Rt(ln.length===2,"invalid ndarray pixel data, must be 2 or 3D"),mr=1,On=1),Pr=ln[0],Vr=ln[1],hr=fr[0],Mr=fr[1],Wn.alignment=1,Wn.width=Pr,Wn.height=Vr,Wn.channels=mr,Wn.format=Wn.internalformat=Bo[mr],Wn.needsFree=!0,Gp(Wn,Nn,hr,Mr,On,Nr.offset)}else if(Uc(Nr)||Wh(Nr)||pp(Nr))Uc(Nr)||Wh(Nr)?Wn.element=Nr:Wn.element=Nr.canvas,Wn.width=Wn.element.width,Wn.height=Wn.element.height,Wn.channels=4;else if($p(Nr))Wn.element=Nr,Wn.width=Nr.width,Wn.height=Nr.height,Wn.channels=4;else if(sd(Nr))Wn.element=Nr,Wn.width=Nr.naturalWidth,Wn.height=Nr.naturalHeight,Wn.channels=4;else if(kd(Nr))Wn.element=Nr,Wn.width=Nr.videoWidth,Wn.height=Nr.videoHeight,Wn.channels=4;else if(Ec(Nr)){var ur=Wn.width||Nr[0].length,Cn=Wn.height||Nr.length,Dr=Wn.channels;ys(Nr[0][0])?Dr=Dr||Nr[0][0].length:Dr=Dr||1;for(var Qr=Do.shape(Nr),_a=1,Ma=0;Ma<Qr.length;++Ma)_a*=Qr[Ma];var ga=Dd(Wn,_a);Do.flatten(Nr,Qr,"",ga),eh(Wn,ga),Wn.alignment=1,Wn.width=ur,Wn.height=Cn,Wn.channels=Dr,Wn.format=Wn.internalformat=Bo[Dr],Wn.needsFree=!0}Wn.type===sl?Rt(er.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Wn.type===oi&&Rt(er.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function rr(Wn,Jr,Nr){var ji=Wn.element,Po=Wn.data,Nn=Wn.internalformat,ln=Wn.format,fr=Wn.type,Pr=Wn.width,Vr=Wn.height;ma(Wn),ji?ce.texImage2D(Jr,Nr,ln,ln,fr,ji):Wn.compressed?ce.compressedTexImage2D(Jr,Nr,Nn,Pr,Vr,0,Po):Wn.needsCopy?(ia(),ce.copyTexImage2D(Jr,Nr,ln,Wn.xOffset,Wn.yOffset,Pr,Vr,0)):ce.texImage2D(Jr,Nr,ln,Pr,Vr,0,ln,fr,Po||null)}function Za(Wn,Jr,Nr,ji,Po){var Nn=Wn.element,ln=Wn.data,fr=Wn.internalformat,Pr=Wn.format,Vr=Wn.type,mr=Wn.width,hr=Wn.height;ma(Wn),Nn?ce.texSubImage2D(Jr,Po,Nr,ji,Pr,Vr,Nn):Wn.compressed?ce.compressedTexSubImage2D(Jr,Po,Nr,ji,fr,mr,hr,ln):Wn.needsCopy?(ia(),ce.copyTexSubImage2D(Jr,Po,Nr,ji,Wn.xOffset,Wn.yOffset,mr,hr)):ce.texSubImage2D(Jr,Po,Nr,ji,mr,hr,Pr,Vr,ln)}var Xn=[];function ii(){return Xn.pop()||new Or}function Ti(Wn){Wn.needsFree&&$t.freeType(Wn.data),Or.call(Wn),Xn.push(Wn)}function Ki(){cn.call(this),this.genMipmaps=!1,this.mipmapHint=De,this.mipmask=0,this.images=Array(16)}function Ai(Wn,Jr,Nr){var ji=Wn.images[0]=ii();Wn.mipmask=1,ji.width=Wn.width=Jr,ji.height=Wn.height=Nr,ji.channels=Wn.channels=4}function Yo(Wn,Jr){var Nr=null;if(vp(Jr))Nr=Wn.images[0]=ii(),Vn(Nr,Wn),Fr(Nr,Jr),Wn.mipmask=1;else if(An(Wn,Jr),Array.isArray(Jr.mipmap))for(var ji=Jr.mipmap,Po=0;Po<ji.length;++Po)Nr=Wn.images[Po]=ii(),Vn(Nr,Wn),Nr.width>>=Po,Nr.height>>=Po,Fr(Nr,ji[Po]),Wn.mipmask|=1<<Po;else Nr=Wn.images[0]=ii(),Vn(Nr,Wn),Fr(Nr,Jr),Wn.mipmask=1;Vn(Wn,Wn.images[0]),Wn.compressed&&(Wn.internalformat===ro||Wn.internalformat===Di||Wn.internalformat===Si||Wn.internalformat===_o)&&Rt(Wn.width%4==0&&Wn.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function bi(Wn,Jr){for(var Nr=Wn.images,ji=0;ji<Nr.length;++ji){if(!Nr[ji])return;rr(Nr[ji],Jr,ji)}}var Lu=[];function as(){var Wn=Lu.pop()||new Ki;cn.call(Wn),Wn.mipmask=0;for(var Jr=0;Jr<16;++Jr)Wn.images[Jr]=null;return Wn}function gl(Wn){for(var Jr=Wn.images,Nr=0;Nr<Jr.length;++Nr)Jr[Nr]&&Ti(Jr[Nr]),Jr[Nr]=null;Lu.push(Wn)}function fu(){this.minFilter=Zt,this.magFilter=Zt,this.wrapS=wc,this.wrapT=wc,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=De}function Rs(Wn,Jr){if("min"in Jr){var Nr=Jr.min;Rt.parameter(Nr,Ka),Wn.minFilter=Ka[Nr],Lo.indexOf(Wn.minFilter)>=0&&!("faces"in Jr)&&(Wn.genMipmaps=!0)}if("mag"in Jr){var ji=Jr.mag;Rt.parameter(ji,Qa),Wn.magFilter=Qa[ji]}var Po=Wn.wrapS,Nn=Wn.wrapT;if("wrap"in Jr){var ln=Jr.wrap;typeof ln=="string"?(Rt.parameter(ln,Oa),Po=Nn=Oa[ln]):Array.isArray(ln)&&(Rt.parameter(ln[0],Oa),Rt.parameter(ln[1],Oa),Po=Oa[ln[0]],Nn=Oa[ln[1]])}else{if("wrapS"in Jr){var fr=Jr.wrapS;Rt.parameter(fr,Oa),Po=Oa[fr]}if("wrapT"in Jr){var Pr=Jr.wrapT;Rt.parameter(Pr,Oa),Nn=Oa[Pr]}}if(Wn.wrapS=Po,Wn.wrapT=Nn,"anisotropic"in Jr){var Vr=Jr.anisotropic;Rt(typeof Vr=="number"&&Vr>=1&&Vr<=er.maxAnisotropic,"aniso samples must be between 1 and "),Wn.anisotropic=Jr.anisotropic}if("mipmap"in Jr){var mr=!1;switch(typeof Jr.mipmap){case"string":Rt.parameter(Jr.mipmap,Xa,"invalid mipmap hint"),Wn.mipmapHint=Xa[Jr.mipmap],Wn.genMipmaps=!0,mr=!0;break;case"boolean":mr=Wn.genMipmaps=Jr.mipmap;break;case"object":Rt(Array.isArray(Jr.mipmap),"invalid mipmap type"),Wn.genMipmaps=!1,mr=!0;break;default:Rt.raise("invalid mipmap type")}mr&&!("min"in Jr)&&(Wn.minFilter=Pe)}}function Eu(Wn,Jr){ce.texParameteri(Jr,nt,Wn.minFilter),ce.texParameteri(Jr,A,Wn.magFilter),ce.texParameteri(Jr,rl,Wn.wrapS),ce.texParameteri(Jr,_f,Wn.wrapT),vn.ext_texture_filter_anisotropic&&ce.texParameteri(Jr,Ar,Wn.anisotropic),Wn.genMipmaps&&(ce.hint(kn,Wn.mipmapHint),ce.generateMipmap(Jr))}var gu=0,zi={},ul=er.maxTextureUnits,ml=Array(ul).map(function(){return null});function Jo(Wn){cn.call(this),this.mipmask=0,this.internalformat=ve,this.id=gu++,this.refCount=1,this.target=Wn,this.texture=ce.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new fu,na.profile&&(this.stats={size:0})}function Vl(Wn){ce.activeTexture(Eo),ce.bindTexture(Wn.target,Wn.texture)}function Su(){var Wn=ml[0];Wn?ce.bindTexture(Wn.target,Wn.texture):ce.bindTexture(Dl,null)}function co(Wn){var Jr=Wn.texture;Rt(Jr,"must not double destroy texture");var Nr=Wn.unit,ji=Wn.target;Nr>=0&&(ce.activeTexture(Eo+Nr),ce.bindTexture(ji,null),ml[Nr]=null),ce.deleteTexture(Jr),Wn.texture=null,Wn.params=null,Wn.pixels=null,Wn.refCount=0,delete zi[Wn.id],aa.textureCount--}$(Jo.prototype,{bind:function(){var Wn=this;Wn.bindCount+=1;var Jr=Wn.unit;if(Jr<0){for(var Nr=0;Nr<ul;++Nr){var ji=ml[Nr];if(ji){if(ji.bindCount>0)continue;ji.unit=-1}ml[Nr]=Wn,Jr=Nr;break}Jr>=ul&&Rt.raise("insufficient number of texture units"),na.profile&&aa.maxTextureUnits<Jr+1&&(aa.maxTextureUnits=Jr+1),Wn.unit=Jr,ce.activeTexture(Eo+Jr),ce.bindTexture(Wn.target,Wn.texture)}return Jr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&co(this)}});function Ls(Wn,Jr){var Nr=new Jo(Dl);zi[Nr.id]=Nr,aa.textureCount++;function ji(ln,fr){var Pr=Nr.texInfo;fu.call(Pr);var Vr=as();return typeof ln=="number"?typeof fr=="number"?Ai(Vr,ln|0,fr|0):Ai(Vr,ln|0,ln|0):ln?(Rt.type(ln,"object","invalid arguments to regl.texture"),Rs(Pr,ln),Yo(Vr,ln)):Ai(Vr,1,1),Pr.genMipmaps&&(Vr.mipmask=(Vr.width<<1)-1),Nr.mipmask=Vr.mipmask,Vn(Nr,Vr),Rt.texture2D(Pr,Vr,er),Nr.internalformat=Vr.internalformat,ji.width=Vr.width,ji.height=Vr.height,Vl(Nr),bi(Vr,Dl),Eu(Pr,Dl),Su(),gl(Vr),na.profile&&(Nr.stats.size=Oc(Nr.internalformat,Nr.type,Vr.width,Vr.height,Pr.genMipmaps,!1)),ji.format=Xt[Nr.internalformat],ji.type=oe[Nr.type],ji.mag=he[Pr.magFilter],ji.min=Te[Pr.minFilter],ji.wrapS=Ye[Pr.wrapS],ji.wrapT=Ye[Pr.wrapT],ji}function Po(ln,fr,Pr,Vr){Rt(!!ln,"must specify image data");var mr=fr|0,hr=Pr|0,Mr=Vr|0,On=ii();return Vn(On,Nr),On.width=0,On.height=0,Fr(On,ln),On.width=On.width||(Nr.width>>Mr)-mr,On.height=On.height||(Nr.height>>Mr)-hr,Rt(Nr.type===On.type&&Nr.format===On.format&&Nr.internalformat===On.internalformat,"incompatible format for texture.subimage"),Rt(mr>=0&&hr>=0&&mr+On.width<=Nr.width&&hr+On.height<=Nr.height,"texture.subimage write out of bounds"),Rt(Nr.mipmask&1<<Mr,"missing mipmap data"),Rt(On.data||On.element||On.needsCopy,"missing image data"),Vl(Nr),Za(On,Dl,mr,hr,Mr),Su(),Ti(On),ji}function Nn(ln,fr){var Pr=ln|0,Vr=fr|0||Pr;if(Pr===Nr.width&&Vr===Nr.height)return ji;ji.width=Nr.width=Pr,ji.height=Nr.height=Vr,Vl(Nr);for(var mr=0;Nr.mipmask>>mr;++mr){var hr=Pr>>mr,Mr=Vr>>mr;if(!hr||!Mr)break;ce.texImage2D(Dl,mr,Nr.format,hr,Mr,0,Nr.format,Nr.type,null)}return Su(),na.profile&&(Nr.stats.size=Oc(Nr.internalformat,Nr.type,Pr,Vr,!1,!1)),ji}return ji(Wn,Jr),ji.subimage=Po,ji.resize=Nn,ji._reglType="texture2d",ji._texture=Nr,na.profile&&(ji.stats=Nr.stats),ji.destroy=function(){Nr.decRef()},ji}function pi(Wn,Jr,Nr,ji,Po,Nn){var ln=new Jo(Ol);zi[ln.id]=ln,aa.cubeCount++;var fr=new Array(6);function Pr(hr,Mr,On,ur,Cn,Dr){var Qr,_a=ln.texInfo;for(fu.call(_a),Qr=0;Qr<6;++Qr)fr[Qr]=as();if(typeof hr=="number"||!hr){var Ma=hr|0||1;for(Qr=0;Qr<6;++Qr)Ai(fr[Qr],Ma,Ma)}else if(typeof hr=="object")if(Mr)Yo(fr[0],hr),Yo(fr[1],Mr),Yo(fr[2],On),Yo(fr[3],ur),Yo(fr[4],Cn),Yo(fr[5],Dr);else if(Rs(_a,hr),An(ln,hr),"faces"in hr){var ga=hr.faces;for(Rt(Array.isArray(ga)&&ga.length===6,"cube faces must be a length 6 array"),Qr=0;Qr<6;++Qr)Rt(typeof ga[Qr]=="object"&&!!ga[Qr],"invalid input for cube map face"),Vn(fr[Qr],ln),Yo(fr[Qr],ga[Qr])}else for(Qr=0;Qr<6;++Qr)Yo(fr[Qr],hr);else Rt.raise("invalid arguments to cube map");for(Vn(ln,fr[0]),er.npotTextureCube||Rt(vl(ln.width)&&vl(ln.height),"your browser does not support non power or two texture dimensions"),_a.genMipmaps?ln.mipmask=(fr[0].width<<1)-1:ln.mipmask=fr[0].mipmask,Rt.textureCube(ln,_a,fr,er),ln.internalformat=fr[0].internalformat,Pr.width=fr[0].width,Pr.height=fr[0].height,Vl(ln),Qr=0;Qr<6;++Qr)bi(fr[Qr],_e+Qr);for(Eu(_a,Ol),Su(),na.profile&&(ln.stats.size=Oc(ln.internalformat,ln.type,Pr.width,Pr.height,_a.genMipmaps,!0)),Pr.format=Xt[ln.internalformat],Pr.type=oe[ln.type],Pr.mag=he[_a.magFilter],Pr.min=Te[_a.minFilter],Pr.wrapS=Ye[_a.wrapS],Pr.wrapT=Ye[_a.wrapT],Qr=0;Qr<6;++Qr)gl(fr[Qr]);return Pr}function Vr(hr,Mr,On,ur,Cn){Rt(!!Mr,"must specify image data"),Rt(typeof hr=="number"&&hr===(hr|0)&&hr>=0&&hr<6,"invalid face");var Dr=On|0,Qr=ur|0,_a=Cn|0,Ma=ii();return Vn(Ma,ln),Ma.width=0,Ma.height=0,Fr(Ma,Mr),Ma.width=Ma.width||(ln.width>>_a)-Dr,Ma.height=Ma.height||(ln.height>>_a)-Qr,Rt(ln.type===Ma.type&&ln.format===Ma.format&&ln.internalformat===Ma.internalformat,"incompatible format for texture.subimage"),Rt(Dr>=0&&Qr>=0&&Dr+Ma.width<=ln.width&&Qr+Ma.height<=ln.height,"texture.subimage write out of bounds"),Rt(ln.mipmask&1<<_a,"missing mipmap data"),Rt(Ma.data||Ma.element||Ma.needsCopy,"missing image data"),Vl(ln),Za(Ma,_e+hr,Dr,Qr,_a),Su(),Ti(Ma),Pr}function mr(hr){var Mr=hr|0;if(Mr!==ln.width){Pr.width=ln.width=Mr,Pr.height=ln.height=Mr,Vl(ln);for(var On=0;On<6;++On)for(var ur=0;ln.mipmask>>ur;++ur)ce.texImage2D(_e+On,ur,ln.format,Mr>>ur,Mr>>ur,0,ln.format,ln.type,null);return Su(),na.profile&&(ln.stats.size=Oc(ln.internalformat,ln.type,Pr.width,Pr.height,!1,!0)),Pr}}return Pr(Wn,Jr,Nr,ji,Po,Nn),Pr.subimage=Vr,Pr.resize=mr,Pr._reglType="textureCube",Pr._texture=ln,na.profile&&(Pr.stats=ln.stats),Pr.destroy=function(){ln.decRef()},Pr}function ll(){for(var Wn=0;Wn<ul;++Wn)ce.activeTexture(Eo+Wn),ce.bindTexture(Dl,null),ml[Wn]=null;us(zi).forEach(co),aa.cubeCount=0,aa.textureCount=0}na.profile&&(aa.getTotalTextureSize=function(){var Wn=0;return Object.keys(zi).forEach(function(Jr){Wn+=zi[Jr].stats.size}),Wn});function Hf(){for(var Wn=0;Wn<ul;++Wn){var Jr=ml[Wn];Jr&&(Jr.bindCount=0,Jr.unit=-1,ml[Wn]=null)}us(zi).forEach(function(Nr){Nr.texture=ce.createTexture(),ce.bindTexture(Nr.target,Nr.texture);for(var ji=0;ji<32;++ji)if((Nr.mipmask&1<<ji)!=0)if(Nr.target===Dl)ce.texImage2D(Dl,ji,Nr.internalformat,Nr.width>>ji,Nr.height>>ji,0,Nr.internalformat,Nr.type,null);else for(var Po=0;Po<6;++Po)ce.texImage2D(_e+Po,ji,Nr.internalformat,Nr.width>>ji,Nr.height>>ji,0,Nr.internalformat,Nr.type,null);Eu(Nr.texInfo,Nr.target)})}function bl(){for(var Wn=0;Wn<ul;++Wn){var Jr=ml[Wn];Jr&&(Jr.bindCount=0,Jr.unit=-1,ml[Wn]=null),ce.activeTexture(Eo+Wn),ce.bindTexture(Dl,null),ce.bindTexture(Ol,null)}}return{create2D:Ls,createCube:pi,clear:ll,getTexture:function(Wn){return null},restore:Hf,refresh:bl}}var Pi=36161,gh=32854,cs=32855,Wc=36194,Gf=33189,nf=36168,rf=34041,Od=35907,Nu=34836,ic=34842,mh=34843,oc=[];oc[gh]=2,oc[cs]=2,oc[Wc]=2,oc[Gf]=2,oc[nf]=1,oc[rf]=4,oc[Od]=4,oc[Nu]=16,oc[ic]=8,oc[mh]=6;function Ot(ce,vn,er){return oc[ce]*vn*er}var ne=function(ce,vn,er,ia,da){var aa={rgba4:gh,rgb565:Wc,"rgb5 a1":cs,depth:Gf,stencil:nf,"depth stencil":rf};vn.ext_srgb&&(aa.srgba=Od),vn.ext_color_buffer_half_float&&(aa.rgba16f=ic,aa.rgb16f=mh),vn.webgl_color_buffer_float&&(aa.rgba32f=Nu);var na=[];Object.keys(aa).forEach(function(q){var ht=aa[q];na[ht]=q});var Xa=0,Oa={};function Qa(q){this.id=Xa++,this.refCount=1,this.renderbuffer=q,this.format=gh,this.width=0,this.height=0,da.profile&&(this.stats={size:0})}Qa.prototype.decRef=function(){--this.refCount<=0&&Ka(this)};function Ka(q){var ht=q.renderbuffer;Rt(ht,"must not double destroy renderbuffer"),ce.bindRenderbuffer(Pi,null),ce.deleteRenderbuffer(ht),q.renderbuffer=null,q.refCount=0,delete Oa[q.id],ia.renderbufferCount--}function zn(q,ht){var It=new Qa(ce.createRenderbuffer());Oa[It.id]=It,ia.renderbufferCount++;function Ft(oe,he){var Te=0,Ye=0,gn=gh;if(typeof oe=="object"&&oe){var cn=oe;if("shape"in cn){var Vn=cn.shape;Rt(Array.isArray(Vn)&&Vn.length>=2,"invalid renderbuffer shape"),Te=Vn[0]|0,Ye=Vn[1]|0}else"radius"in cn&&(Te=Ye=cn.radius|0),"width"in cn&&(Te=cn.width|0),"height"in cn&&(Ye=cn.height|0);"format"in cn&&(Rt.parameter(cn.format,aa,"invalid renderbuffer format"),gn=aa[cn.format])}else typeof oe=="number"?(Te=oe|0,typeof he=="number"?Ye=he|0:Ye=Te):oe?Rt.raise("invalid arguments to renderbuffer constructor"):Te=Ye=1;if(Rt(Te>0&&Ye>0&&Te<=er.maxRenderbufferSize&&Ye<=er.maxRenderbufferSize,"invalid renderbuffer size"),!(Te===It.width&&Ye===It.height&&gn===It.format))return Ft.width=It.width=Te,Ft.height=It.height=Ye,It.format=gn,ce.bindRenderbuffer(Pi,It.renderbuffer),ce.renderbufferStorage(Pi,gn,Te,Ye),Rt(ce.getError()===0,"invalid render buffer format"),da.profile&&(It.stats.size=Ot(It.format,It.width,It.height)),Ft.format=na[It.format],Ft}function Xt(oe,he){var Te=oe|0,Ye=he|0||Te;return Te===It.width&&Ye===It.height||(Rt(Te>0&&Ye>0&&Te<=er.maxRenderbufferSize&&Ye<=er.maxRenderbufferSize,"invalid renderbuffer size"),Ft.width=It.width=Te,Ft.height=It.height=Ye,ce.bindRenderbuffer(Pi,It.renderbuffer),ce.renderbufferStorage(Pi,It.format,Te,Ye),Rt(ce.getError()===0,"invalid render buffer format"),da.profile&&(It.stats.size=Ot(It.format,It.width,It.height))),Ft}return Ft(q,ht),Ft.resize=Xt,Ft._reglType="renderbuffer",Ft._renderbuffer=It,da.profile&&(Ft.stats=It.stats),Ft.destroy=function(){It.decRef()},Ft}da.profile&&(ia.getTotalRenderbufferSize=function(){var q=0;return Object.keys(Oa).forEach(function(ht){q+=Oa[ht].stats.size}),q});function N(){us(Oa).forEach(function(q){q.renderbuffer=ce.createRenderbuffer(),ce.bindRenderbuffer(Pi,q.renderbuffer),ce.renderbufferStorage(Pi,q.format,q.width,q.height)}),ce.bindRenderbuffer(Pi,null)}return{create:zn,clear:function(){us(Oa).forEach(Ka)},restore:N}},Se=36160,Ke=36161,yn=3553,yr=34069,Ir=36064,la=36096,Dn=36128,Ga=33306,xi=36053,Ui=36054,Ii=36055,Mo=36057,rs=36061,Xo=36193,so=5121,jo=5126,Ci=6407,os=6408,zo=6402,Xi=[Ci,os],Qo=[];Qo[os]=4,Qo[Ci]=3;var Is=[];Is[so]=1,Is[jo]=4,Is[Xo]=2;var $s=32854,Ts=32855,Ds=36194,Gs=33189,dr=36168,Vi=34041,af=35907,Tf=34836,sc=34842,Af=34843,Sc=[$s,Ts,Ds,af,sc,Af,Tf],_l={};_l[xi]="complete",_l[Ui]="incomplete attachment",_l[Mo]="incomplete dimensions",_l[Ii]="incomplete, missing attachment",_l[rs]="unsupported";function Rd(ce,vn,er,ia,da,aa){var na={cur:null,next:null,dirty:!1,setFBO:null},Xa=["rgba"],Oa=["rgba4","rgb565","rgb5 a1"];vn.ext_srgb&&Oa.push("srgba"),vn.ext_color_buffer_half_float&&Oa.push("rgba16f","rgb16f"),vn.webgl_color_buffer_float&&Oa.push("rgba32f");var Qa=["uint8"];vn.oes_texture_half_float&&Qa.push("half float","float16"),vn.oes_texture_float&&Qa.push("float","float32");function Ka(Or,Fr,rr){this.target=Or,this.texture=Fr,this.renderbuffer=rr;var Za=0,Xn=0;Fr?(Za=Fr.width,Xn=Fr.height):rr&&(Za=rr.width,Xn=rr.height),this.width=Za,this.height=Xn}function zn(Or){Or&&(Or.texture&&Or.texture._texture.decRef(),Or.renderbuffer&&Or.renderbuffer._renderbuffer.decRef())}function N(Or,Fr,rr){if(!!Or)if(Or.texture){var Za=Or.texture._texture,Xn=Math.max(1,Za.width),ii=Math.max(1,Za.height);Rt(Xn===Fr&&ii===rr,"inconsistent width/height for supplied texture"),Za.refCount+=1}else{var Ti=Or.renderbuffer._renderbuffer;Rt(Ti.width===Fr&&Ti.height===rr,"inconsistent width/height for renderbuffer"),Ti.refCount+=1}}function q(Or,Fr){Fr&&(Fr.texture?ce.framebufferTexture2D(Se,Or,Fr.target,Fr.texture._texture.texture,0):ce.framebufferRenderbuffer(Se,Or,Ke,Fr.renderbuffer._renderbuffer.renderbuffer))}function ht(Or){var Fr=yn,rr=null,Za=null,Xn=Or;typeof Or=="object"&&(Xn=Or.data,"target"in Or&&(Fr=Or.target|0)),Rt.type(Xn,"function","invalid attachment data");var ii=Xn._reglType;return ii==="texture2d"?(rr=Xn,Rt(Fr===yn)):ii==="textureCube"?(rr=Xn,Rt(Fr>=yr&&Fr<yr+6,"invalid cube map target")):ii==="renderbuffer"?(Za=Xn,Fr=Ke):Rt.raise("invalid regl object for attachment"),new Ka(Fr,rr,Za)}function It(Or,Fr,rr,Za,Xn){if(rr){var ii=ia.create2D({width:Or,height:Fr,format:Za,type:Xn});return ii._texture.refCount=0,new Ka(yn,ii,null)}else{var Ti=da.create({width:Or,height:Fr,format:Za});return Ti._renderbuffer.refCount=0,new Ka(Ke,null,Ti)}}function Ft(Or){return Or&&(Or.texture||Or.renderbuffer)}function Xt(Or,Fr,rr){Or&&(Or.texture?Or.texture.resize(Fr,rr):Or.renderbuffer&&Or.renderbuffer.resize(Fr,rr),Or.width=Fr,Or.height=rr)}var oe=0,he={};function Te(){this.id=oe++,he[this.id]=this,this.framebuffer=ce.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ye(Or){Or.colorAttachments.forEach(zn),zn(Or.depthAttachment),zn(Or.stencilAttachment),zn(Or.depthStencilAttachment)}function gn(Or){var Fr=Or.framebuffer;Rt(Fr,"must not double destroy framebuffer"),ce.deleteFramebuffer(Fr),Or.framebuffer=null,aa.framebufferCount--,delete he[Or.id]}function cn(Or){var Fr;ce.bindFramebuffer(Se,Or.framebuffer);var rr=Or.colorAttachments;for(Fr=0;Fr<rr.length;++Fr)q(Ir+Fr,rr[Fr]);for(Fr=rr.length;Fr<er.maxColorAttachments;++Fr)ce.framebufferTexture2D(Se,Ir+Fr,yn,null,0);ce.framebufferTexture2D(Se,Ga,yn,null,0),ce.framebufferTexture2D(Se,la,yn,null,0),ce.framebufferTexture2D(Se,Dn,yn,null,0),q(la,Or.depthAttachment),q(Dn,Or.stencilAttachment),q(Ga,Or.depthStencilAttachment);var Za=ce.checkFramebufferStatus(Se);!ce.isContextLost()&&Za!==xi&&Rt.raise("framebuffer configuration not supported, status = "+_l[Za]),ce.bindFramebuffer(Se,na.next?na.next.framebuffer:null),na.cur=na.next,ce.getError()}function Vn(Or,Fr){var rr=new Te;aa.framebufferCount++;function Za(ii,Ti){var Ki;Rt(na.next!==rr,"can not update framebuffer which is currently in use");var Ai=0,Yo=0,bi=!0,Lu=!0,as=null,gl=!0,fu="rgba",Rs="uint8",Eu=1,gu=null,zi=null,ul=null,ml=!1;if(typeof ii=="number")Ai=ii|0,Yo=Ti|0||Ai;else if(!ii)Ai=Yo=1;else{Rt.type(ii,"object","invalid arguments for framebuffer");var Jo=ii;if("shape"in Jo){var Vl=Jo.shape;Rt(Array.isArray(Vl)&&Vl.length>=2,"invalid shape for framebuffer"),Ai=Vl[0],Yo=Vl[1]}else"radius"in Jo&&(Ai=Yo=Jo.radius),"width"in Jo&&(Ai=Jo.width),"height"in Jo&&(Yo=Jo.height);("color"in Jo||"colors"in Jo)&&(as=Jo.color||Jo.colors,Array.isArray(as)&&Rt(as.length===1||vn.webgl_draw_buffers,"multiple render targets not supported")),as||("colorCount"in Jo&&(Eu=Jo.colorCount|0,Rt(Eu>0,"invalid color buffer count")),"colorTexture"in Jo&&(gl=!!Jo.colorTexture,fu="rgba4"),"colorType"in Jo&&(Rs=Jo.colorType,gl?(Rt(vn.oes_texture_float||!(Rs==="float"||Rs==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),Rt(vn.oes_texture_half_float||!(Rs==="half float"||Rs==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Rs==="half float"||Rs==="float16"?(Rt(vn.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),fu="rgba16f"):(Rs==="float"||Rs==="float32")&&(Rt(vn.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),fu="rgba32f"),Rt.oneOf(Rs,Qa,"invalid color type")),"colorFormat"in Jo&&(fu=Jo.colorFormat,Xa.indexOf(fu)>=0?gl=!0:Oa.indexOf(fu)>=0?gl=!1:gl?Rt.oneOf(Jo.colorFormat,Xa,"invalid color format for texture"):Rt.oneOf(Jo.colorFormat,Oa,"invalid color format for renderbuffer"))),("depthTexture"in Jo||"depthStencilTexture"in Jo)&&(ml=!!(Jo.depthTexture||Jo.depthStencilTexture),Rt(!ml||vn.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Jo&&(typeof Jo.depth=="boolean"?bi=Jo.depth:(gu=Jo.depth,Lu=!1)),"stencil"in Jo&&(typeof Jo.stencil=="boolean"?Lu=Jo.stencil:(zi=Jo.stencil,bi=!1)),"depthStencil"in Jo&&(typeof Jo.depthStencil=="boolean"?bi=Lu=Jo.depthStencil:(ul=Jo.depthStencil,bi=!1,Lu=!1))}var Su=null,co=null,Ls=null,pi=null;if(Array.isArray(as))Su=as.map(ht);else if(as)Su=[ht(as)];else for(Su=new Array(Eu),Ki=0;Ki<Eu;++Ki)Su[Ki]=It(Ai,Yo,gl,fu,Rs);Rt(vn.webgl_draw_buffers||Su.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),Rt(Su.length<=er.maxColorAttachments,"too many color attachments, not supported"),Ai=Ai||Su[0].width,Yo=Yo||Su[0].height,gu?co=ht(gu):bi&&!Lu&&(co=It(Ai,Yo,ml,"depth","uint32")),zi?Ls=ht(zi):Lu&&!bi&&(Ls=It(Ai,Yo,!1,"stencil","uint8")),ul?pi=ht(ul):!gu&&!zi&&Lu&&bi&&(pi=It(Ai,Yo,ml,"depth stencil","depth stencil")),Rt(!!gu+!!zi+!!ul<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var ll=null;for(Ki=0;Ki<Su.length;++Ki)if(N(Su[Ki],Ai,Yo),Rt(!Su[Ki]||Su[Ki].texture&&Xi.indexOf(Su[Ki].texture._texture.format)>=0||Su[Ki].renderbuffer&&Sc.indexOf(Su[Ki].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ki+" is invalid"),Su[Ki]&&Su[Ki].texture){var Hf=Qo[Su[Ki].texture._texture.format]*Is[Su[Ki].texture._texture.type];ll===null?ll=Hf:Rt(ll===Hf,"all color attachments much have the same number of bits per pixel.")}return N(co,Ai,Yo),Rt(!co||co.texture&&co.texture._texture.format===zo||co.renderbuffer&&co.renderbuffer._renderbuffer.format===Gs,"invalid depth attachment for framebuffer object"),N(Ls,Ai,Yo),Rt(!Ls||Ls.renderbuffer&&Ls.renderbuffer._renderbuffer.format===dr,"invalid stencil attachment for framebuffer object"),N(pi,Ai,Yo),Rt(!pi||pi.texture&&pi.texture._texture.format===Vi||pi.renderbuffer&&pi.renderbuffer._renderbuffer.format===Vi,"invalid depth-stencil attachment for framebuffer object"),Ye(rr),rr.width=Ai,rr.height=Yo,rr.colorAttachments=Su,rr.depthAttachment=co,rr.stencilAttachment=Ls,rr.depthStencilAttachment=pi,Za.color=Su.map(Ft),Za.depth=Ft(co),Za.stencil=Ft(Ls),Za.depthStencil=Ft(pi),Za.width=rr.width,Za.height=rr.height,cn(rr),Za}function Xn(ii,Ti){Rt(na.next!==rr,"can not resize a framebuffer which is currently in use");var Ki=Math.max(ii|0,1),Ai=Math.max(Ti|0||Ki,1);if(Ki===rr.width&&Ai===rr.height)return Za;for(var Yo=rr.colorAttachments,bi=0;bi<Yo.length;++bi)Xt(Yo[bi],Ki,Ai);return Xt(rr.depthAttachment,Ki,Ai),Xt(rr.stencilAttachment,Ki,Ai),Xt(rr.depthStencilAttachment,Ki,Ai),rr.width=Za.width=Ki,rr.height=Za.height=Ai,cn(rr),Za}return Za(Or,Fr),$(Za,{resize:Xn,_reglType:"framebuffer",_framebuffer:rr,destroy:function(){gn(rr),Ye(rr)},use:function(ii){na.setFBO({framebuffer:Za},ii)}})}function An(Or){var Fr=Array(6);function rr(Xn){var ii;Rt(Fr.indexOf(na.next)<0,"can not update framebuffer which is currently in use");var Ti={color:null},Ki=0,Ai=null,Yo="rgba",bi="uint8",Lu=1;if(typeof Xn=="number")Ki=Xn|0;else if(!Xn)Ki=1;else{Rt.type(Xn,"object","invalid arguments for framebuffer");var as=Xn;if("shape"in as){var gl=as.shape;Rt(Array.isArray(gl)&&gl.length>=2,"invalid shape for framebuffer"),Rt(gl[0]===gl[1],"cube framebuffer must be square"),Ki=gl[0]}else"radius"in as&&(Ki=as.radius|0),"width"in as?(Ki=as.width|0,"height"in as&&Rt(as.height===Ki,"must be square")):"height"in as&&(Ki=as.height|0);("color"in as||"colors"in as)&&(Ai=as.color||as.colors,Array.isArray(Ai)&&Rt(Ai.length===1||vn.webgl_draw_buffers,"multiple render targets not supported")),Ai||("colorCount"in as&&(Lu=as.colorCount|0,Rt(Lu>0,"invalid color buffer count")),"colorType"in as&&(Rt.oneOf(as.colorType,Qa,"invalid color type"),bi=as.colorType),"colorFormat"in as&&(Yo=as.colorFormat,Rt.oneOf(as.colorFormat,Xa,"invalid color format for texture"))),"depth"in as&&(Ti.depth=as.depth),"stencil"in as&&(Ti.stencil=as.stencil),"depthStencil"in as&&(Ti.depthStencil=as.depthStencil)}var fu;if(Ai)if(Array.isArray(Ai))for(fu=[],ii=0;ii<Ai.length;++ii)fu[ii]=Ai[ii];else fu=[Ai];else{fu=Array(Lu);var Rs={radius:Ki,format:Yo,type:bi};for(ii=0;ii<Lu;++ii)fu[ii]=ia.createCube(Rs)}for(Ti.color=Array(fu.length),ii=0;ii<fu.length;++ii){var Eu=fu[ii];Rt(typeof Eu=="function"&&Eu._reglType==="textureCube","invalid cube map"),Ki=Ki||Eu.width,Rt(Eu.width===Ki&&Eu.height===Ki,"invalid cube map shape"),Ti.color[ii]={target:yr,data:fu[ii]}}for(ii=0;ii<6;++ii){for(var gu=0;gu<fu.length;++gu)Ti.color[gu].target=yr+ii;ii>0&&(Ti.depth=Fr[0].depth,Ti.stencil=Fr[0].stencil,Ti.depthStencil=Fr[0].depthStencil),Fr[ii]?Fr[ii](Ti):Fr[ii]=Vn(Ti)}return $(rr,{width:Ki,height:Ki,color:fu})}function Za(Xn){var ii,Ti=Xn|0;if(Rt(Ti>0&&Ti<=er.maxCubeMapSize,"invalid radius for cube fbo"),Ti===rr.width)return rr;var Ki=rr.color;for(ii=0;ii<Ki.length;++ii)Ki[ii].resize(Ti);for(ii=0;ii<6;++ii)Fr[ii].resize(Ti);return rr.width=rr.height=Ti,rr}return rr(Or),$(rr,{faces:Fr,resize:Za,_reglType:"framebufferCube",destroy:function(){Fr.forEach(function(Xn){Xn.destroy()})}})}function ma(){na.cur=null,na.next=null,na.dirty=!0,us(he).forEach(function(Or){Or.framebuffer=ce.createFramebuffer(),cn(Or)})}return $(na,{getFramebuffer:function(Or){if(typeof Or=="function"&&Or._reglType==="framebuffer"){var Fr=Or._framebuffer;if(Fr instanceof Te)return Fr}return null},create:Vn,createCube:An,clear:function(){us(he).forEach(gn)},restore:ma})}var ud=5126,pn=34962;function nh(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ud,this.offset=0,this.stride=0,this.divisor=0}function ld(ce,vn,er,ia,da){for(var aa=er.maxAttributes,na=new Array(aa),Xa=0;Xa<aa;++Xa)na[Xa]=new nh;var Oa=0,Qa={},Ka={Record:nh,scope:{},state:na,currentVAO:null,targetVAO:null,restore:N()?he:function(){},createVAO:Te,getVAO:ht,destroyBuffer:zn,setVAO:N()?It:Ft,clear:N()?Xt:function(){}};function zn(Ye){for(var gn=0;gn<na.length;++gn){var cn=na[gn];cn.buffer===Ye&&(ce.disableVertexAttribArray(gn),cn.buffer=null)}}function N(){return vn.oes_vertex_array_object}function q(){return vn.angle_instanced_arrays}function ht(Ye){return typeof Ye=="function"&&Ye._vao?Ye._vao:null}function It(Ye){if(Ye!==Ka.currentVAO){var gn=N();Ye?gn.bindVertexArrayOES(Ye.vao):gn.bindVertexArrayOES(null),Ka.currentVAO=Ye}}function Ft(Ye){if(Ye!==Ka.currentVAO){if(Ye)Ye.bindAttrs();else for(var gn=q(),cn=0;cn<na.length;++cn){var Vn=na[cn];Vn.buffer?(ce.enableVertexAttribArray(cn),ce.vertexAttribPointer(cn,Vn.size,Vn.type,Vn.normalized,Vn.stride,Vn.offfset),gn&&Vn.divisor&&gn.vertexAttribDivisorANGLE(cn,Vn.divisor)):(ce.disableVertexAttribArray(cn),ce.vertexAttrib4f(cn,Vn.x,Vn.y,Vn.z,Vn.w))}Ka.currentVAO=Ye}}function Xt(){us(Qa).forEach(function(Ye){Ye.destroy()})}function oe(){this.id=++Oa,this.attributes=[];var Ye=N();Ye?this.vao=Ye.createVertexArrayOES():this.vao=null,Qa[this.id]=this,this.buffers=[]}oe.prototype.bindAttrs=function(){for(var Ye=q(),gn=this.attributes,cn=0;cn<gn.length;++cn){var Vn=gn[cn];Vn.buffer?(ce.enableVertexAttribArray(cn),ce.bindBuffer(pn,Vn.buffer.buffer),ce.vertexAttribPointer(cn,Vn.size,Vn.type,Vn.normalized,Vn.stride,Vn.offset),Ye&&Vn.divisor&&Ye.vertexAttribDivisorANGLE(cn,Vn.divisor)):(ce.disableVertexAttribArray(cn),ce.vertexAttrib4f(cn,Vn.x,Vn.y,Vn.z,Vn.w))}for(var An=gn.length;An<aa;++An)ce.disableVertexAttribArray(An)},oe.prototype.refresh=function(){var Ye=N();Ye&&(Ye.bindVertexArrayOES(this.vao),this.bindAttrs(),Ka.currentVAO=this)},oe.prototype.destroy=function(){if(this.vao){var Ye=N();this===Ka.currentVAO&&(Ka.currentVAO=null,Ye.bindVertexArrayOES(null)),Ye.deleteVertexArrayOES(this.vao),this.vao=null}Qa[this.id]&&(delete Qa[this.id],ia.vaoCount-=1)};function he(){var Ye=N();Ye&&us(Qa).forEach(function(gn){gn.refresh()})}function Te(Ye){var gn=new oe;ia.vaoCount+=1;function cn(Vn){Rt(Array.isArray(Vn),"arguments to vertex array constructor must be an array"),Rt(Vn.length<aa,"too many attributes"),Rt(Vn.length>0,"must specify at least one attribute");var An={},ma=gn.attributes;ma.length=Vn.length;for(var Or=0;Or<Vn.length;++Or){var Fr=Vn[Or],rr=ma[Or]=new nh,Za=Fr.data||Fr;if(Array.isArray(Za)||it(Za)||gi(Za)){var Xn;gn.buffers[Or]&&(Xn=gn.buffers[Or],it(Za)&&Xn._buffer.byteLength>=Za.byteLength?Xn.subdata(Za):(Xn.destroy(),gn.buffers[Or]=null)),gn.buffers[Or]||(Xn=gn.buffers[Or]=da.create(Fr,pn,!1,!0)),rr.buffer=da.getBuffer(Xn),rr.size=rr.buffer.dimension|0,rr.normalized=!1,rr.type=rr.buffer.dtype,rr.offset=0,rr.stride=0,rr.divisor=0,rr.state=1,An[Or]=1}else da.getBuffer(Fr)?(rr.buffer=da.getBuffer(Fr),rr.size=rr.buffer.dimension|0,rr.normalized=!1,rr.type=rr.buffer.dtype,rr.offset=0,rr.stride=0,rr.divisor=0,rr.state=1):da.getBuffer(Fr.buffer)?(rr.buffer=da.getBuffer(Fr.buffer),rr.size=(+Fr.size||rr.buffer.dimension)|0,rr.normalized=!!Fr.normalized||!1,"type"in Fr?(Rt.parameter(Fr.type,Ys,"invalid buffer type"),rr.type=Ys[Fr.type]):rr.type=rr.buffer.dtype,rr.offset=(Fr.offset||0)|0,rr.stride=(Fr.stride||0)|0,rr.divisor=(Fr.divisor||0)|0,rr.state=1,Rt(rr.size>=1&&rr.size<=4,"size must be between 1 and 4"),Rt(rr.offset>=0,"invalid offset"),Rt(rr.stride>=0&&rr.stride<=255,"stride must be between 0 and 255"),Rt(rr.divisor>=0,"divisor must be positive"),Rt(!rr.divisor||!!vn.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Fr?(Rt(Or>0,"first attribute must not be a constant"),rr.x=+Fr.x||0,rr.y=+Fr.y||0,rr.z=+Fr.z||0,rr.w=+Fr.w||0,rr.state=2):Rt(!1,"invalid attribute spec for location "+Or)}for(var ii=0;ii<gn.buffers.length;++ii)!An[ii]&&gn.buffers[ii]&&(gn.buffers[ii].destroy(),gn.buffers[ii]=null);return gn.refresh(),cn}return cn.destroy=function(){for(var Vn=0;Vn<gn.buffers.length;++Vn)gn.buffers[Vn]&&gn.buffers[Vn].destroy();gn.buffers.length=0,gn.destroy()},cn._vao=gn,cn._reglType="vao",cn(Ye)}return Ka}var br=35632,Vh=35633,Rc=35718,Lc=35721;function Vc(ce,vn,er,ia){var da={},aa={};function na(It,Ft,Xt,oe){this.name=It,this.id=Ft,this.location=Xt,this.info=oe}function Xa(It,Ft){for(var Xt=0;Xt<It.length;++Xt)if(It[Xt].id===Ft.id){It[Xt].location=Ft.location;return}It.push(Ft)}function Oa(It,Ft,Xt){var oe=It===br?da:aa,he=oe[Ft];if(!he){var Te=vn.str(Ft);he=ce.createShader(It),ce.shaderSource(he,Te),ce.compileShader(he),Rt.shaderError(ce,he,Te,It,Xt),oe[Ft]=he}return he}var Qa={},Ka=[],zn=0;function N(It,Ft){this.id=zn++,this.fragId=It,this.vertId=Ft,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,ia.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function q(It,Ft,Xt){var oe,he,Te=Oa(br,It.fragId),Ye=Oa(Vh,It.vertId),gn=It.program=ce.createProgram();if(ce.attachShader(gn,Te),ce.attachShader(gn,Ye),Xt)for(oe=0;oe<Xt.length;++oe){var cn=Xt[oe];ce.bindAttribLocation(gn,cn[0],cn[1])}ce.linkProgram(gn),Rt.linkError(ce,gn,vn.str(It.fragId),vn.str(It.vertId),Ft);var Vn=ce.getProgramParameter(gn,Rc);ia.profile&&(It.stats.uniformsCount=Vn);var An=It.uniforms;for(oe=0;oe<Vn;++oe)if(he=ce.getActiveUniform(gn,oe),he)if(he.size>1)for(var ma=0;ma<he.size;++ma){var Or=he.name.replace("[0]","["+ma+"]");Xa(An,new na(Or,vn.id(Or),ce.getUniformLocation(gn,Or),he))}else Xa(An,new na(he.name,vn.id(he.name),ce.getUniformLocation(gn,he.name),he));var Fr=ce.getProgramParameter(gn,Lc);ia.profile&&(It.stats.attributesCount=Fr);var rr=It.attributes;for(oe=0;oe<Fr;++oe)he=ce.getActiveAttrib(gn,oe),he&&Xa(rr,new na(he.name,vn.id(he.name),ce.getAttribLocation(gn,he.name),he))}ia.profile&&(er.getMaxUniformsCount=function(){var It=0;return Ka.forEach(function(Ft){Ft.stats.uniformsCount>It&&(It=Ft.stats.uniformsCount)}),It},er.getMaxAttributesCount=function(){var It=0;return Ka.forEach(function(Ft){Ft.stats.attributesCount>It&&(It=Ft.stats.attributesCount)}),It});function ht(){da={},aa={};for(var It=0;It<Ka.length;++It)q(Ka[It],null,Ka[It].attributes.map(function(Ft){return[Ft.location,Ft.name]}))}return{clear:function(){var It=ce.deleteShader.bind(ce);us(da).forEach(It),da={},us(aa).forEach(It),aa={},Ka.forEach(function(Ft){ce.deleteProgram(Ft.program)}),Ka.length=0,Qa={},er.shaderCount=0},program:function(It,Ft,Xt,oe){Rt.command(It>=0,"missing vertex shader",Xt),Rt.command(Ft>=0,"missing fragment shader",Xt);var he=Qa[Ft];he||(he=Qa[Ft]={});var Te=he[It];if(Te&&(Te.refCount++,!oe))return Te;var Ye=new N(Ft,It);return er.shaderCount++,q(Ye,Xt,oe),Te||(he[It]=Ye),Ka.push(Ye),$(Ye,{destroy:function(){if(Ye.refCount--,Ye.refCount<=0){ce.deleteProgram(Ye.program);var gn=Ka.indexOf(Ye);Ka.splice(gn,1),er.shaderCount--}he[Ye.vertId].refCount<=0&&(ce.deleteShader(aa[Ye.vertId]),delete aa[Ye.vertId],delete Qa[Ye.fragId][Ye.vertId]),Object.keys(Qa[Ye.fragId]).length||(ce.deleteShader(da[Ye.fragId]),delete da[Ye.fragId],delete Qa[Ye.fragId])}})},restore:ht,shader:Oa,frag:-1,vert:-1}}var Pc=6408,Ru=5121,Fc=3333,Rl=5126;function yh(ce,vn,er,ia,da,aa,na){function Xa(Ka){var zn;vn.next===null?(Rt(da.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),zn=Ru):(Rt(vn.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),zn=vn.next.colorAttachments[0].texture._texture.type,aa.oes_texture_float?(Rt(zn===Ru||zn===Rl,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),zn===Rl&&Rt(na.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):Rt(zn===Ru,"Reading from a framebuffer is only allowed for the type 'uint8'"));var N=0,q=0,ht=ia.framebufferWidth,It=ia.framebufferHeight,Ft=null;it(Ka)?Ft=Ka:Ka&&(Rt.type(Ka,"object","invalid arguments to regl.read()"),N=Ka.x|0,q=Ka.y|0,Rt(N>=0&&N<ia.framebufferWidth,"invalid x offset for regl.read"),Rt(q>=0&&q<ia.framebufferHeight,"invalid y offset for regl.read"),ht=(Ka.width||ia.framebufferWidth-N)|0,It=(Ka.height||ia.framebufferHeight-q)|0,Ft=Ka.data||null),Ft&&(zn===Ru?Rt(Ft instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):zn===Rl&&Rt(Ft instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),Rt(ht>0&&ht+N<=ia.framebufferWidth,"invalid width for read pixels"),Rt(It>0&&It+q<=ia.framebufferHeight,"invalid height for read pixels"),er();var Xt=ht*It*4;return Ft||(zn===Ru?Ft=new Uint8Array(Xt):zn===Rl&&(Ft=Ft||new Float32Array(Xt))),Rt.isTypedArray(Ft,"data buffer for regl.read() must be a typedarray"),Rt(Ft.byteLength>=Xt,"data buffer for regl.read() too small"),ce.pixelStorei(Fc,4),ce.readPixels(N,q,ht,It,Pc,zn,Ft),Ft}function Oa(Ka){var zn;return vn.setFBO({framebuffer:Ka.framebuffer},function(){zn=Xa(Ka)}),zn}function Qa(Ka){return!Ka||!("framebuffer"in Ka)?Xa(Ka):Oa(Ka)}return Qa}function jc(ce){return Array.prototype.slice.call(ce)}function jh(ce){return jc(ce).join("")}function Hh(){var ce=0,vn=[],er=[];function ia(zn){for(var N=0;N<er.length;++N)if(er[N]===zn)return vn[N];var q="g"+ce++;return vn.push(q),er.push(zn),q}function da(){var zn=[];function N(){zn.push.apply(zn,jc(arguments))}var q=[];function ht(){var It="v"+ce++;return q.push(It),arguments.length>0&&(zn.push(It,"="),zn.push.apply(zn,jc(arguments)),zn.push(";")),It}return $(N,{def:ht,toString:function(){return jh([q.length>0?"var "+q.join(",")+";":"",jh(zn)])}})}function aa(){var zn=da(),N=da(),q=zn.toString,ht=N.toString;function It(Ft,Xt){N(Ft,Xt,"=",zn.def(Ft,Xt),";")}return $(function(){zn.apply(zn,jc(arguments))},{def:zn.def,entry:zn,exit:N,save:It,set:function(Ft,Xt,oe){It(Ft,Xt),zn(Ft,Xt,"=",oe,";")},toString:function(){return q()+ht()}})}function na(){var zn=jh(arguments),N=aa(),q=aa(),ht=N.toString,It=q.toString;return $(N,{then:function(){return N.apply(N,jc(arguments)),this},else:function(){return q.apply(q,jc(arguments)),this},toString:function(){var Ft=It();return Ft&&(Ft="else{"+Ft+"}"),jh(["if(",zn,"){",ht(),"}",Ft])}})}var Xa=da(),Oa={};function Qa(zn,N){var q=[];function ht(){var he="a"+q.length;return q.push(he),he}N=N||0;for(var It=0;It<N;++It)ht();var Ft=aa(),Xt=Ft.toString,oe=Oa[zn]=$(Ft,{arg:ht,toString:function(){return jh(["function(",q.join(),"){",Xt(),"}"])}});return oe}function Ka(){var zn=['"use strict";',Xa,"return {"];Object.keys(Oa).forEach(function(ht){zn.push('"',ht,'":',Oa[ht].toString(),",")}),zn.push("}");var N=jh(zn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),q=Function.apply(null,vn.concat(N));return q.apply(null,er)}return{global:Xa,link:ia,block:da,proc:Qa,scope:aa,cond:na,compile:Ka}}var Hc="xyzw".split(""),Sv=5121,vf=1,Ld=2,gf=0,gp=1,mp=2,Pd=3,yp=4,il=5,rh=6,Up="dither",Xh="blend.enable",Fd="blend.color",Kl="blend.equation",Al="blend.func",Ml="depth.enable",ah="depth.func",Os="depth.range",Ll="depth.mask",of="colorMask",Sn="cull.enable",Bd="cull.face",ih="frontFace",zd="lineWidth",Mf="polygonOffset.enable",sf="polygonOffset.offset",Uf="sample.alpha",$d="sample.enable",Wf="sample.coverage",bh="stencil.enable",Wp="stencil.mask",xh="stencil.func",ju="stencil.opFront",oh="stencil.opBack",bp="scissor.enable",cd="scissor.box",Cc="viewport",Yh="profile",uf="framebuffer",wh="vert",sh="frag",Pl="elements",Nf="primitive",Eh="count",fd="offset",Vp="instances",hd="vao",jp="Width",Gd="Height",Kh=uf+jp,Fl=uf+Gd,uh=Cc+jp,Sh=Cc+Gd,Ch="drawingBuffer",ng=Ch+jp,Cv=Ch+Gd,vs=[Al,Kl,xh,ju,oh,Wf,Cc,cd,sf],Xc=34962,eo=34963,Hp=35632,_h=35633,dd=3553,_g=34067,Ig=2884,Ud=3042,Xp=3024,_v=2960,Ih=2929,Yp=3089,Kp=32823,Th=32926,Zp=32928,Ah=5126,Wd=35664,Vd=35665,pd=35666,xp=5124,vd=35667,jd=35668,kf=35669,Hd=35670,wp=35671,Xd=35672,Mh=35673,Zh=35674,Ep=35675,Nh=35676,Sp=35678,lh=35680,Zs=4,ch=1028,Df=1029,Iv=2304,cu=2305,Yd=32775,Tv=32776,qp=519,Yc=7680,Qp=0,Av=1,qh=32774,Jp=513,Mv=36160,Nv=36064,Bl={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},gd=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Of={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},kh={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},kv={frag:Hp,vert:_h},md={cw:Iv,ccw:cu};function Kd(ce){return Array.isArray(ce)||it(ce)||gi(ce)}function tv(ce){return ce.sort(function(vn,er){return vn===Cc?-1:er===Cc?1:vn<er?-1:1})}function Bc(ce,vn,er,ia){this.thisDep=ce,this.contextDep=vn,this.propDep=er,this.append=ia}function Vf(ce){return ce&&!(ce.thisDep||ce.contextDep||ce.propDep)}function zl(ce){return new Bc(!1,!1,!1,ce)}function vc(ce,vn){var er=ce.type;if(er===gf){var ia=ce.data.length;return new Bc(!0,ia>=1,ia>=2,vn)}else if(er===yp){var da=ce.data;return new Bc(da.thisDep,da.contextDep,da.propDep,vn)}else{if(er===il)return new Bc(!1,!1,!1,vn);if(er===rh){for(var aa=!1,na=!1,Xa=!1,Oa=0;Oa<ce.data.length;++Oa){var Qa=ce.data[Oa];if(Qa.type===gp)Xa=!0;else if(Qa.type===mp)na=!0;else if(Qa.type===Pd)aa=!0;else if(Qa.type===gf){aa=!0;var Ka=Qa.data;Ka>=1&&(na=!0),Ka>=2&&(Xa=!0)}else Qa.type===yp&&(aa=aa||Qa.data.thisDep,na=na||Qa.data.contextDep,Xa=Xa||Qa.data.propDep)}return new Bc(aa,na,Xa,vn)}else return new Bc(er===Pd,er===mp,er===gp,vn)}}var yd=new Bc(!1,!1,!1,function(){});function Dv(ce,vn,er,ia,da,aa,na,Xa,Oa,Qa,Ka,zn,N,q,ht){var It=Qa.Record,Ft={add:32774,subtract:32778,"reverse subtract":32779};er.ext_blend_minmax&&(Ft.min=Yd,Ft.max=Tv);var Xt=er.angle_instanced_arrays,oe=er.webgl_draw_buffers,he={dirty:!0,profile:ht.profile},Te={},Ye=[],gn={},cn={};function Vn(Nn){return Nn.replace(".","_")}function An(Nn,ln,fr){var Pr=Vn(Nn);Ye.push(Nn),Te[Pr]=he[Pr]=!!fr,gn[Pr]=ln}function ma(Nn,ln,fr){var Pr=Vn(Nn);Ye.push(Nn),Array.isArray(fr)?(he[Pr]=fr.slice(),Te[Pr]=fr.slice()):he[Pr]=Te[Pr]=fr,cn[Pr]=ln}An(Up,Xp),An(Xh,Ud),ma(Fd,"blendColor",[0,0,0,0]),ma(Kl,"blendEquationSeparate",[qh,qh]),ma(Al,"blendFuncSeparate",[Av,Qp,Av,Qp]),An(Ml,Ih,!0),ma(ah,"depthFunc",Jp),ma(Os,"depthRange",[0,1]),ma(Ll,"depthMask",!0),ma(of,of,[!0,!0,!0,!0]),An(Sn,Ig),ma(Bd,"cullFace",Df),ma(ih,ih,cu),ma(zd,zd,1),An(Mf,Kp),ma(sf,"polygonOffset",[0,0]),An(Uf,Th),An($d,Zp),ma(Wf,"sampleCoverage",[1,!1]),An(bh,_v),ma(Wp,"stencilMask",-1),ma(xh,"stencilFunc",[qp,0,-1]),ma(ju,"stencilOpSeparate",[ch,Yc,Yc,Yc]),ma(oh,"stencilOpSeparate",[Df,Yc,Yc,Yc]),An(bp,Yp),ma(cd,"scissor",[0,0,ce.drawingBufferWidth,ce.drawingBufferHeight]),ma(Cc,Cc,[0,0,ce.drawingBufferWidth,ce.drawingBufferHeight]);var Or={gl:ce,context:N,strings:vn,next:Te,current:he,draw:zn,elements:aa,buffer:da,shader:Ka,attributes:Qa.state,vao:Qa,uniforms:Oa,framebuffer:Xa,extensions:er,timer:q,isBufferArgs:Kd},Fr={primTypes:xu,compareFuncs:Of,blendFuncs:Bl,blendEquations:Ft,stencilOps:kh,glTypes:Ys,orientationType:md};Rt.optional(function(){Or.isArrayLike=ys}),oe&&(Fr.backBuffer=[Df],Fr.drawBuffer=ra(ia.maxDrawbuffers,function(Nn){return Nn===0?[0]:ra(Nn,function(ln){return Nv+ln})}));var rr=0;function Za(){var Nn=Hh(),ln=Nn.link,fr=Nn.global;Nn.id=rr++,Nn.batchId="0";var Pr=ln(Or),Vr=Nn.shared={props:"a0"};Object.keys(Or).forEach(function(ur){Vr[ur]=fr.def(Pr,".",ur)}),Rt.optional(function(){Nn.CHECK=ln(Rt),Nn.commandStr=Rt.guessCommand(),Nn.command=ln(Nn.commandStr),Nn.assert=function(ur,Cn,Dr){ur("if(!(",Cn,"))",this.CHECK,".commandRaise(",ln(Dr),",",this.command,");")},Fr.invalidBlendCombinations=gd});var mr=Nn.next={},hr=Nn.current={};Object.keys(cn).forEach(function(ur){Array.isArray(he[ur])&&(mr[ur]=fr.def(Vr.next,".",ur),hr[ur]=fr.def(Vr.current,".",ur))});var Mr=Nn.constants={};Object.keys(Fr).forEach(function(ur){Mr[ur]=fr.def(JSON.stringify(Fr[ur]))}),Nn.invoke=function(ur,Cn){switch(Cn.type){case gf:var Dr=["this",Vr.context,Vr.props,Nn.batchId];return ur.def(ln(Cn.data),".call(",Dr.slice(0,Math.max(Cn.data.length+1,4)),")");case gp:return ur.def(Vr.props,Cn.data);case mp:return ur.def(Vr.context,Cn.data);case Pd:return ur.def("this",Cn.data);case yp:return Cn.data.append(Nn,ur),Cn.data.ref;case il:return Cn.data.toString();case rh:return Cn.data.map(function(Qr){return Nn.invoke(ur,Qr)})}},Nn.attribCache={};var On={};return Nn.scopeAttrib=function(ur){var Cn=vn.id(ur);if(Cn in On)return On[Cn];var Dr=Qa.scope[Cn];Dr||(Dr=Qa.scope[Cn]=new It);var Qr=On[Cn]=ln(Dr);return Qr},Nn}function Xn(Nn){var ln=Nn.static,fr=Nn.dynamic,Pr;if(Yh in ln){var Vr=!!ln[Yh];Pr=zl(function(hr,Mr){return Vr}),Pr.enable=Vr}else if(Yh in fr){var mr=fr[Yh];Pr=vc(mr,function(hr,Mr){return hr.invoke(Mr,mr)})}return Pr}function ii(Nn,ln){var fr=Nn.static,Pr=Nn.dynamic;if(uf in fr){var Vr=fr[uf];return Vr?(Vr=Xa.getFramebuffer(Vr),Rt.command(Vr,"invalid framebuffer object"),zl(function(hr,Mr){var On=hr.link(Vr),ur=hr.shared;Mr.set(ur.framebuffer,".next",On);var Cn=ur.context;return Mr.set(Cn,"."+Kh,On+".width"),Mr.set(Cn,"."+Fl,On+".height"),On})):zl(function(hr,Mr){var On=hr.shared;Mr.set(On.framebuffer,".next","null");var ur=On.context;return Mr.set(ur,"."+Kh,ur+"."+ng),Mr.set(ur,"."+Fl,ur+"."+Cv),"null"})}else if(uf in Pr){var mr=Pr[uf];return vc(mr,function(hr,Mr){var On=hr.invoke(Mr,mr),ur=hr.shared,Cn=ur.framebuffer,Dr=Mr.def(Cn,".getFramebuffer(",On,")");Rt.optional(function(){hr.assert(Mr,"!"+On+"||"+Dr,"invalid framebuffer object")}),Mr.set(Cn,".next",Dr);var Qr=ur.context;return Mr.set(Qr,"."+Kh,Dr+"?"+Dr+".width:"+Qr+"."+ng),Mr.set(Qr,"."+Fl,Dr+"?"+Dr+".height:"+Qr+"."+Cv),Dr})}else return null}function Ti(Nn,ln,fr){var Pr=Nn.static,Vr=Nn.dynamic;function mr(On){if(On in Pr){var ur=Pr[On];Rt.commandType(ur,"object","invalid "+On,fr.commandStr);var Cn=!0,Dr=ur.x|0,Qr=ur.y|0,_a,Ma;return"width"in ur?(_a=ur.width|0,Rt.command(_a>=0,"invalid "+On,fr.commandStr)):Cn=!1,"height"in ur?(Ma=ur.height|0,Rt.command(Ma>=0,"invalid "+On,fr.commandStr)):Cn=!1,new Bc(!Cn&&ln&&ln.thisDep,!Cn&&ln&&ln.contextDep,!Cn&&ln&&ln.propDep,function(uo,bs){var Hi=uo.shared.context,ho=_a;"width"in ur||(ho=bs.def(Hi,".",Kh,"-",Dr));var No=Ma;return"height"in ur||(No=bs.def(Hi,".",Fl,"-",Qr)),[Dr,Qr,ho,No]})}else if(On in Vr){var ga=Vr[On],ai=vc(ga,function(uo,bs){var Hi=uo.invoke(bs,ga);Rt.optional(function(){uo.assert(bs,Hi+"&&typeof "+Hi+'==="object"',"invalid "+On)});var ho=uo.shared.context,No=bs.def(Hi,".x|0"),au=bs.def(Hi,".y|0"),xl=bs.def('"width" in ',Hi,"?",Hi,".width|0:","(",ho,".",Kh,"-",No,")"),uc=bs.def('"height" in ',Hi,"?",Hi,".height|0:","(",ho,".",Fl,"-",au,")");return Rt.optional(function(){uo.assert(bs,xl+">=0&&"+uc+">=0","invalid "+On)}),[No,au,xl,uc]});return ln&&(ai.thisDep=ai.thisDep||ln.thisDep,ai.contextDep=ai.contextDep||ln.contextDep,ai.propDep=ai.propDep||ln.propDep),ai}else return ln?new Bc(ln.thisDep,ln.contextDep,ln.propDep,function(uo,bs){var Hi=uo.shared.context;return[0,0,bs.def(Hi,".",Kh),bs.def(Hi,".",Fl)]}):null}var hr=mr(Cc);if(hr){var Mr=hr;hr=new Bc(hr.thisDep,hr.contextDep,hr.propDep,function(On,ur){var Cn=Mr.append(On,ur),Dr=On.shared.context;return ur.set(Dr,"."+uh,Cn[2]),ur.set(Dr,"."+Sh,Cn[3]),Cn})}return{viewport:hr,scissor_box:mr(cd)}}function Ki(Nn,ln){var fr=Nn.static,Pr=typeof fr[sh]=="string"&&typeof fr[wh]=="string";if(Pr){if(Object.keys(ln.dynamic).length>0)return null;var Vr=ln.static,mr=Object.keys(Vr);if(mr.length>0&&typeof Vr[mr[0]]=="number"){for(var hr=[],Mr=0;Mr<mr.length;++Mr)Rt(typeof Vr[mr[Mr]]=="number","must specify all vertex attribute locations when using vaos"),hr.push([Vr[mr[Mr]]|0,mr[Mr]]);return hr}}return null}function Ai(Nn,ln,fr){var Pr=Nn.static,Vr=Nn.dynamic;function mr(Cn){if(Cn in Pr){var Dr=vn.id(Pr[Cn]);Rt.optional(function(){Ka.shader(kv[Cn],Dr,Rt.guessCommand())});var Qr=zl(function(){return Dr});return Qr.id=Dr,Qr}else if(Cn in Vr){var _a=Vr[Cn];return vc(_a,function(Ma,ga){var ai=Ma.invoke(ga,_a),uo=ga.def(Ma.shared.strings,".id(",ai,")");return Rt.optional(function(){ga(Ma.shared.shader,".shader(",kv[Cn],",",uo,",",Ma.command,");")}),uo})}return null}var hr=mr(sh),Mr=mr(wh),On=null,ur;return Vf(hr)&&Vf(Mr)?(On=Ka.program(Mr.id,hr.id,null,fr),ur=zl(function(Cn,Dr){return Cn.link(On)})):ur=new Bc(hr&&hr.thisDep||Mr&&Mr.thisDep,hr&&hr.contextDep||Mr&&Mr.contextDep,hr&&hr.propDep||Mr&&Mr.propDep,function(Cn,Dr){var Qr=Cn.shared.shader,_a;hr?_a=hr.append(Cn,Dr):_a=Dr.def(Qr,".",sh);var Ma;Mr?Ma=Mr.append(Cn,Dr):Ma=Dr.def(Qr,".",wh);var ga=Qr+".program("+Ma+","+_a;return Rt.optional(function(){ga+=","+Cn.command}),Dr.def(ga+")")}),{frag:hr,vert:Mr,progVar:ur,program:On}}function Yo(Nn,ln){var fr=Nn.static,Pr=Nn.dynamic;function Vr(){if(Pl in fr){var Cn=fr[Pl];Kd(Cn)?Cn=aa.getElements(aa.create(Cn,!0)):Cn&&(Cn=aa.getElements(Cn),Rt.command(Cn,"invalid elements",ln.commandStr));var Dr=zl(function(_a,Ma){if(Cn){var ga=_a.link(Cn);return _a.ELEMENTS=ga,ga}return _a.ELEMENTS=null,null});return Dr.value=Cn,Dr}else if(Pl in Pr){var Qr=Pr[Pl];return vc(Qr,function(_a,Ma){var ga=_a.shared,ai=ga.isBufferArgs,uo=ga.elements,bs=_a.invoke(Ma,Qr),Hi=Ma.def("null"),ho=Ma.def(ai,"(",bs,")"),No=_a.cond(ho).then(Hi,"=",uo,".createStream(",bs,");").else(Hi,"=",uo,".getElements(",bs,");");return Rt.optional(function(){_a.assert(No.else,"!"+bs+"||"+Hi,"invalid elements")}),Ma.entry(No),Ma.exit(_a.cond(ho).then(uo,".destroyStream(",Hi,");")),_a.ELEMENTS=Hi,Hi})}return null}var mr=Vr();function hr(){if(Nf in fr){var Cn=fr[Nf];return Rt.commandParameter(Cn,xu,"invalid primitve",ln.commandStr),zl(function(Qr,_a){return xu[Cn]})}else if(Nf in Pr){var Dr=Pr[Nf];return vc(Dr,function(Qr,_a){var Ma=Qr.constants.primTypes,ga=Qr.invoke(_a,Dr);return Rt.optional(function(){Qr.assert(_a,ga+" in "+Ma,"invalid primitive, must be one of "+Object.keys(xu))}),_a.def(Ma,"[",ga,"]")})}else if(mr)return Vf(mr)?mr.value?zl(function(Qr,_a){return _a.def(Qr.ELEMENTS,".primType")}):zl(function(){return Zs}):new Bc(mr.thisDep,mr.contextDep,mr.propDep,function(Qr,_a){var Ma=Qr.ELEMENTS;return _a.def(Ma,"?",Ma,".primType:",Zs)});return null}function Mr(Cn,Dr){if(Cn in fr){var Qr=fr[Cn]|0;return Rt.command(!Dr||Qr>=0,"invalid "+Cn,ln.commandStr),zl(function(Ma,ga){return Dr&&(Ma.OFFSET=Qr),Qr})}else if(Cn in Pr){var _a=Pr[Cn];return vc(_a,function(Ma,ga){var ai=Ma.invoke(ga,_a);return Dr&&(Ma.OFFSET=ai,Rt.optional(function(){Ma.assert(ga,ai+">=0","invalid "+Cn)})),ai})}else if(Dr&&mr)return zl(function(Ma,ga){return Ma.OFFSET="0",0});return null}var On=Mr(fd,!0);function ur(){if(Eh in fr){var Cn=fr[Eh]|0;return Rt.command(typeof Cn=="number"&&Cn>=0,"invalid vertex count",ln.commandStr),zl(function(){return Cn})}else if(Eh in Pr){var Dr=Pr[Eh];return vc(Dr,function(Ma,ga){var ai=Ma.invoke(ga,Dr);return Rt.optional(function(){Ma.assert(ga,"typeof "+ai+'==="number"&&'+ai+">=0&&"+ai+"===("+ai+"|0)","invalid vertex count")}),ai})}else if(mr)if(Vf(mr)){if(mr)return On?new Bc(On.thisDep,On.contextDep,On.propDep,function(Ma,ga){var ai=ga.def(Ma.ELEMENTS,".vertCount-",Ma.OFFSET);return Rt.optional(function(){Ma.assert(ga,ai+">=0","invalid vertex offset/element buffer too small")}),ai}):zl(function(Ma,ga){return ga.def(Ma.ELEMENTS,".vertCount")});var Qr=zl(function(){return-1});return Rt.optional(function(){Qr.MISSING=!0}),Qr}else{var _a=new Bc(mr.thisDep||On.thisDep,mr.contextDep||On.contextDep,mr.propDep||On.propDep,function(Ma,ga){var ai=Ma.ELEMENTS;return Ma.OFFSET?ga.def(ai,"?",ai,".vertCount-",Ma.OFFSET,":-1"):ga.def(ai,"?",ai,".vertCount:-1")});return Rt.optional(function(){_a.DYNAMIC=!0}),_a}return null}return{elements:mr,primitive:hr(),count:ur(),instances:Mr(Vp,!1),offset:On}}function bi(Nn,ln){var fr=Nn.static,Pr=Nn.dynamic,Vr={};return Ye.forEach(function(mr){var hr=Vn(mr);function Mr(On,ur){if(mr in fr){var Cn=On(fr[mr]);Vr[hr]=zl(function(){return Cn})}else if(mr in Pr){var Dr=Pr[mr];Vr[hr]=vc(Dr,function(Qr,_a){return ur(Qr,_a,Qr.invoke(_a,Dr))})}}switch(mr){case Sn:case Xh:case Up:case bh:case Ml:case bp:case Mf:case Uf:case $d:case Ll:return Mr(function(On){return Rt.commandType(On,"boolean",mr,ln.commandStr),On},function(On,ur,Cn){return Rt.optional(function(){On.assert(ur,"typeof "+Cn+'==="boolean"',"invalid flag "+mr,On.commandStr)}),Cn});case ah:return Mr(function(On){return Rt.commandParameter(On,Of,"invalid "+mr,ln.commandStr),Of[On]},function(On,ur,Cn){var Dr=On.constants.compareFuncs;return Rt.optional(function(){On.assert(ur,Cn+" in "+Dr,"invalid "+mr+", must be one of "+Object.keys(Of))}),ur.def(Dr,"[",Cn,"]")});case Os:return Mr(function(On){return Rt.command(ys(On)&&On.length===2&&typeof On[0]=="number"&&typeof On[1]=="number"&&On[0]<=On[1],"depth range is 2d array",ln.commandStr),On},function(On,ur,Cn){Rt.optional(function(){On.assert(ur,On.shared.isArrayLike+"("+Cn+")&&"+Cn+".length===2&&typeof "+Cn+'[0]==="number"&&typeof '+Cn+'[1]==="number"&&'+Cn+"[0]<="+Cn+"[1]","depth range must be a 2d array")});var Dr=ur.def("+",Cn,"[0]"),Qr=ur.def("+",Cn,"[1]");return[Dr,Qr]});case Al:return Mr(function(On){Rt.commandType(On,"object","blend.func",ln.commandStr);var ur="srcRGB"in On?On.srcRGB:On.src,Cn="srcAlpha"in On?On.srcAlpha:On.src,Dr="dstRGB"in On?On.dstRGB:On.dst,Qr="dstAlpha"in On?On.dstAlpha:On.dst;return Rt.commandParameter(ur,Bl,hr+".srcRGB",ln.commandStr),Rt.commandParameter(Cn,Bl,hr+".srcAlpha",ln.commandStr),Rt.commandParameter(Dr,Bl,hr+".dstRGB",ln.commandStr),Rt.commandParameter(Qr,Bl,hr+".dstAlpha",ln.commandStr),Rt.command(gd.indexOf(ur+", "+Dr)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+ur+", "+Dr+")",ln.commandStr),[Bl[ur],Bl[Dr],Bl[Cn],Bl[Qr]]},function(On,ur,Cn){var Dr=On.constants.blendFuncs;Rt.optional(function(){On.assert(ur,Cn+"&&typeof "+Cn+'==="object"',"invalid blend func, must be an object")});function Qr(Hi,ho){var No=ur.def('"',Hi,ho,'" in ',Cn,"?",Cn,".",Hi,ho,":",Cn,".",Hi);return Rt.optional(function(){On.assert(ur,No+" in "+Dr,"invalid "+mr+"."+Hi+ho+", must be one of "+Object.keys(Bl))}),No}var _a=Qr("src","RGB"),Ma=Qr("dst","RGB");Rt.optional(function(){var Hi=On.constants.invalidBlendCombinations;On.assert(ur,Hi+".indexOf("+_a+'+", "+'+Ma+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ga=ur.def(Dr,"[",_a,"]"),ai=ur.def(Dr,"[",Qr("src","Alpha"),"]"),uo=ur.def(Dr,"[",Ma,"]"),bs=ur.def(Dr,"[",Qr("dst","Alpha"),"]");return[ga,uo,ai,bs]});case Kl:return Mr(function(On){if(typeof On=="string")return Rt.commandParameter(On,Ft,"invalid "+mr,ln.commandStr),[Ft[On],Ft[On]];if(typeof On=="object")return Rt.commandParameter(On.rgb,Ft,mr+".rgb",ln.commandStr),Rt.commandParameter(On.alpha,Ft,mr+".alpha",ln.commandStr),[Ft[On.rgb],Ft[On.alpha]];Rt.commandRaise("invalid blend.equation",ln.commandStr)},function(On,ur,Cn){var Dr=On.constants.blendEquations,Qr=ur.def(),_a=ur.def(),Ma=On.cond("typeof ",Cn,'==="string"');return Rt.optional(function(){function ga(ai,uo,bs){On.assert(ai,bs+" in "+Dr,"invalid "+uo+", must be one of "+Object.keys(Ft))}ga(Ma.then,mr,Cn),On.assert(Ma.else,Cn+"&&typeof "+Cn+'==="object"',"invalid "+mr),ga(Ma.else,mr+".rgb",Cn+".rgb"),ga(Ma.else,mr+".alpha",Cn+".alpha")}),Ma.then(Qr,"=",_a,"=",Dr,"[",Cn,"];"),Ma.else(Qr,"=",Dr,"[",Cn,".rgb];",_a,"=",Dr,"[",Cn,".alpha];"),ur(Ma),[Qr,_a]});case Fd:return Mr(function(On){return Rt.command(ys(On)&&On.length===4,"blend.color must be a 4d array",ln.commandStr),ra(4,function(ur){return+On[ur]})},function(On,ur,Cn){return Rt.optional(function(){On.assert(ur,On.shared.isArrayLike+"("+Cn+")&&"+Cn+".length===4","blend.color must be a 4d array")}),ra(4,function(Dr){return ur.def("+",Cn,"[",Dr,"]")})});case Wp:return Mr(function(On){return Rt.commandType(On,"number",hr,ln.commandStr),On|0},function(On,ur,Cn){return Rt.optional(function(){On.assert(ur,"typeof "+Cn+'==="number"',"invalid stencil.mask")}),ur.def(Cn,"|0")});case xh:return Mr(function(On){Rt.commandType(On,"object",hr,ln.commandStr);var ur=On.cmp||"keep",Cn=On.ref||0,Dr="mask"in On?On.mask:-1;return Rt.commandParameter(ur,Of,mr+".cmp",ln.commandStr),Rt.commandType(Cn,"number",mr+".ref",ln.commandStr),Rt.commandType(Dr,"number",mr+".mask",ln.commandStr),[Of[ur],Cn,Dr]},function(On,ur,Cn){var Dr=On.constants.compareFuncs;Rt.optional(function(){function ga(){On.assert(ur,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ga(Cn+"&&typeof ",Cn,'==="object"'),ga('!("cmp" in ',Cn,")||(",Cn,".cmp in ",Dr,")")});var Qr=ur.def('"cmp" in ',Cn,"?",Dr,"[",Cn,".cmp]",":",Yc),_a=ur.def(Cn,".ref|0"),Ma=ur.def('"mask" in ',Cn,"?",Cn,".mask|0:-1");return[Qr,_a,Ma]});case ju:case oh:return Mr(function(On){Rt.commandType(On,"object",hr,ln.commandStr);var ur=On.fail||"keep",Cn=On.zfail||"keep",Dr=On.zpass||"keep";return Rt.commandParameter(ur,kh,mr+".fail",ln.commandStr),Rt.commandParameter(Cn,kh,mr+".zfail",ln.commandStr),Rt.commandParameter(Dr,kh,mr+".zpass",ln.commandStr),[mr===oh?Df:ch,kh[ur],kh[Cn],kh[Dr]]},function(On,ur,Cn){var Dr=On.constants.stencilOps;Rt.optional(function(){On.assert(ur,Cn+"&&typeof "+Cn+'==="object"',"invalid "+mr)});function Qr(_a){return Rt.optional(function(){On.assert(ur,'!("'+_a+'" in '+Cn+")||("+Cn+"."+_a+" in "+Dr+")","invalid "+mr+"."+_a+", must be one of "+Object.keys(kh))}),ur.def('"',_a,'" in ',Cn,"?",Dr,"[",Cn,".",_a,"]:",Yc)}return[mr===oh?Df:ch,Qr("fail"),Qr("zfail"),Qr("zpass")]});case sf:return Mr(function(On){Rt.commandType(On,"object",hr,ln.commandStr);var ur=On.factor|0,Cn=On.units|0;return Rt.commandType(ur,"number",hr+".factor",ln.commandStr),Rt.commandType(Cn,"number",hr+".units",ln.commandStr),[ur,Cn]},function(On,ur,Cn){Rt.optional(function(){On.assert(ur,Cn+"&&typeof "+Cn+'==="object"',"invalid "+mr)});var Dr=ur.def(Cn,".factor|0"),Qr=ur.def(Cn,".units|0");return[Dr,Qr]});case Bd:return Mr(function(On){var ur=0;return On==="front"?ur=ch:On==="back"&&(ur=Df),Rt.command(!!ur,hr,ln.commandStr),ur},function(On,ur,Cn){return Rt.optional(function(){On.assert(ur,Cn+'==="front"||'+Cn+'==="back"',"invalid cull.face")}),ur.def(Cn,'==="front"?',ch,":",Df)});case zd:return Mr(function(On){return Rt.command(typeof On=="number"&&On>=ia.lineWidthDims[0]&&On<=ia.lineWidthDims[1],"invalid line width, must be a positive number between "+ia.lineWidthDims[0]+" and "+ia.lineWidthDims[1],ln.commandStr),On},function(On,ur,Cn){return Rt.optional(function(){On.assert(ur,"typeof "+Cn+'==="number"&&'+Cn+">="+ia.lineWidthDims[0]+"&&"+Cn+"<="+ia.lineWidthDims[1],"invalid line width")}),Cn});case ih:return Mr(function(On){return Rt.commandParameter(On,md,hr,ln.commandStr),md[On]},function(On,ur,Cn){return Rt.optional(function(){On.assert(ur,Cn+'==="cw"||'+Cn+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),ur.def(Cn+'==="cw"?'+Iv+":"+cu)});case of:return Mr(function(On){return Rt.command(ys(On)&&On.length===4,"color.mask must be length 4 array",ln.commandStr),On.map(function(ur){return!!ur})},function(On,ur,Cn){return Rt.optional(function(){On.assert(ur,On.shared.isArrayLike+"("+Cn+")&&"+Cn+".length===4","invalid color.mask")}),ra(4,function(Dr){return"!!"+Cn+"["+Dr+"]"})});case Wf:return Mr(function(On){Rt.command(typeof On=="object"&&On,hr,ln.commandStr);var ur="value"in On?On.value:1,Cn=!!On.invert;return Rt.command(typeof ur=="number"&&ur>=0&&ur<=1,"sample.coverage.value must be a number between 0 and 1",ln.commandStr),[ur,Cn]},function(On,ur,Cn){Rt.optional(function(){On.assert(ur,Cn+"&&typeof "+Cn+'==="object"',"invalid sample.coverage")});var Dr=ur.def('"value" in ',Cn,"?+",Cn,".value:1"),Qr=ur.def("!!",Cn,".invert");return[Dr,Qr]})}}),Vr}function Lu(Nn,ln){var fr=Nn.static,Pr=Nn.dynamic,Vr={};return Object.keys(fr).forEach(function(mr){var hr=fr[mr],Mr;if(typeof hr=="number"||typeof hr=="boolean")Mr=zl(function(){return hr});else if(typeof hr=="function"){var On=hr._reglType;On==="texture2d"||On==="textureCube"?Mr=zl(function(ur){return ur.link(hr)}):On==="framebuffer"||On==="framebufferCube"?(Rt.command(hr.color.length>0,'missing color attachment for framebuffer sent to uniform "'+mr+'"',ln.commandStr),Mr=zl(function(ur){return ur.link(hr.color[0])})):Rt.commandRaise('invalid data for uniform "'+mr+'"',ln.commandStr)}else ys(hr)?Mr=zl(function(ur){var Cn=ur.global.def("[",ra(hr.length,function(Dr){return Rt.command(typeof hr[Dr]=="number"||typeof hr[Dr]=="boolean","invalid uniform "+mr,ur.commandStr),hr[Dr]}),"]");return Cn}):Rt.commandRaise('invalid or missing data for uniform "'+mr+'"',ln.commandStr);Mr.value=hr,Vr[mr]=Mr}),Object.keys(Pr).forEach(function(mr){var hr=Pr[mr];Vr[mr]=vc(hr,function(Mr,On){return Mr.invoke(On,hr)})}),Vr}function as(Nn,ln){var fr=Nn.static,Pr=Nn.dynamic,Vr={};return Object.keys(fr).forEach(function(mr){var hr=fr[mr],Mr=vn.id(mr),On=new It;if(Kd(hr))On.state=vf,On.buffer=da.getBuffer(da.create(hr,Xc,!1,!0)),On.type=0;else{var ur=da.getBuffer(hr);if(ur)On.state=vf,On.buffer=ur,On.type=0;else if(Rt.command(typeof hr=="object"&&hr,"invalid data for attribute "+mr,ln.commandStr),"constant"in hr){var Cn=hr.constant;On.buffer="null",On.state=Ld,typeof Cn=="number"?On.x=Cn:(Rt.command(ys(Cn)&&Cn.length>0&&Cn.length<=4,"invalid constant for attribute "+mr,ln.commandStr),Hc.forEach(function(uo,bs){bs<Cn.length&&(On[uo]=Cn[bs])}))}else{Kd(hr.buffer)?ur=da.getBuffer(da.create(hr.buffer,Xc,!1,!0)):ur=da.getBuffer(hr.buffer),Rt.command(!!ur,'missing buffer for attribute "'+mr+'"',ln.commandStr);var Dr=hr.offset|0;Rt.command(Dr>=0,'invalid offset for attribute "'+mr+'"',ln.commandStr);var Qr=hr.stride|0;Rt.command(Qr>=0&&Qr<256,'invalid stride for attribute "'+mr+'", must be integer betweeen [0, 255]',ln.commandStr);var _a=hr.size|0;Rt.command(!("size"in hr)||_a>0&&_a<=4,'invalid size for attribute "'+mr+'", must be 1,2,3,4',ln.commandStr);var Ma=!!hr.normalized,ga=0;"type"in hr&&(Rt.commandParameter(hr.type,Ys,"invalid type for attribute "+mr,ln.commandStr),ga=Ys[hr.type]);var ai=hr.divisor|0;"divisor"in hr&&(Rt.command(ai===0||Xt,'cannot specify divisor for attribute "'+mr+'", instancing not supported',ln.commandStr),Rt.command(ai>=0,'invalid divisor for attribute "'+mr+'"',ln.commandStr)),Rt.optional(function(){var uo=ln.commandStr,bs=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(hr).forEach(function(Hi){Rt.command(bs.indexOf(Hi)>=0,'unknown parameter "'+Hi+'" for attribute pointer "'+mr+'" (valid parameters are '+bs+")",uo)})}),On.buffer=ur,On.state=vf,On.size=_a,On.normalized=Ma,On.type=ga||ur.dtype,On.offset=Dr,On.stride=Qr,On.divisor=ai}}Vr[mr]=zl(function(uo,bs){var Hi=uo.attribCache;if(Mr in Hi)return Hi[Mr];var ho={isStream:!1};return Object.keys(On).forEach(function(No){ho[No]=On[No]}),On.buffer&&(ho.buffer=uo.link(On.buffer),ho.type=ho.type||ho.buffer+".dtype"),Hi[Mr]=ho,ho})}),Object.keys(Pr).forEach(function(mr){var hr=Pr[mr];function Mr(On,ur){var Cn=On.invoke(ur,hr),Dr=On.shared,Qr=On.constants,_a=Dr.isBufferArgs,Ma=Dr.buffer;Rt.optional(function(){On.assert(ur,Cn+"&&(typeof "+Cn+'==="object"||typeof '+Cn+'==="function")&&('+_a+"("+Cn+")||"+Ma+".getBuffer("+Cn+")||"+Ma+".getBuffer("+Cn+".buffer)||"+_a+"("+Cn+'.buffer)||("constant" in '+Cn+"&&(typeof "+Cn+'.constant==="number"||'+Dr.isArrayLike+"("+Cn+".constant))))",'invalid dynamic attribute "'+mr+'"')});var ga={isStream:ur.def(!1)},ai=new It;ai.state=vf,Object.keys(ai).forEach(function(ho){ga[ho]=ur.def(""+ai[ho])});var uo=ga.buffer,bs=ga.type;ur("if(",_a,"(",Cn,")){",ga.isStream,"=true;",uo,"=",Ma,".createStream(",Xc,",",Cn,");",bs,"=",uo,".dtype;","}else{",uo,"=",Ma,".getBuffer(",Cn,");","if(",uo,"){",bs,"=",uo,".dtype;",'}else if("constant" in ',Cn,"){",ga.state,"=",Ld,";","if(typeof "+Cn+'.constant === "number"){',ga[Hc[0]],"=",Cn,".constant;",Hc.slice(1).map(function(ho){return ga[ho]}).join("="),"=0;","}else{",Hc.map(function(ho,No){return ga[ho]+"="+Cn+".constant.length>"+No+"?"+Cn+".constant["+No+"]:0;"}).join(""),"}}else{","if(",_a,"(",Cn,".buffer)){",uo,"=",Ma,".createStream(",Xc,",",Cn,".buffer);","}else{",uo,"=",Ma,".getBuffer(",Cn,".buffer);","}",bs,'="type" in ',Cn,"?",Qr.glTypes,"[",Cn,".type]:",uo,".dtype;",ga.normalized,"=!!",Cn,".normalized;");function Hi(ho){ur(ga[ho],"=",Cn,".",ho,"|0;")}return Hi("size"),Hi("offset"),Hi("stride"),Hi("divisor"),ur("}}"),ur.exit("if(",ga.isStream,"){",Ma,".destroyStream(",uo,");","}"),ga}Vr[mr]=vc(hr,Mr)}),Vr}function gl(Nn,ln){var fr=Nn.static,Pr=Nn.dynamic;if(hd in fr){var Vr=fr[hd];return Vr!==null&&Qa.getVAO(Vr)===null&&(Vr=Qa.createVAO(Vr)),zl(function(hr){return hr.link(Qa.getVAO(Vr))})}else if(hd in Pr){var mr=Pr[hd];return vc(mr,function(hr,Mr){var On=hr.invoke(Mr,mr);return Mr.def(hr.shared.vao+".getVAO("+On+")")})}return null}function fu(Nn){var ln=Nn.static,fr=Nn.dynamic,Pr={};return Object.keys(ln).forEach(function(Vr){var mr=ln[Vr];Pr[Vr]=zl(function(hr,Mr){return typeof mr=="number"||typeof mr=="boolean"?""+mr:hr.link(mr)})}),Object.keys(fr).forEach(function(Vr){var mr=fr[Vr];Pr[Vr]=vc(mr,function(hr,Mr){return hr.invoke(Mr,mr)})}),Pr}function Rs(Nn,ln,fr,Pr,Vr){var mr=Nn.static,hr=Nn.dynamic;Rt.optional(function(){var Hi=[uf,wh,sh,Pl,Nf,fd,Eh,Vp,Yh,hd].concat(Ye);function ho(No){Object.keys(No).forEach(function(au){Rt.command(Hi.indexOf(au)>=0,'unknown parameter "'+au+'"',Vr.commandStr)})}ho(mr),ho(hr)});var Mr=Ki(Nn,ln),On=ii(Nn,Vr),ur=Ti(Nn,On,Vr),Cn=Yo(Nn,Vr),Dr=bi(Nn,Vr),Qr=Ai(Nn,Vr,Mr);function _a(Hi){var ho=ur[Hi];ho&&(Dr[Hi]=ho)}_a(Cc),_a(Vn(cd));var Ma=Object.keys(Dr).length>0,ga={framebuffer:On,draw:Cn,shader:Qr,state:Dr,dirty:Ma,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ga.profile=Xn(Nn,Vr),ga.uniforms=Lu(fr,Vr),ga.drawVAO=ga.scopeVAO=gl(Nn,Vr),!ga.drawVAO&&Qr.program&&!Mr&&er.angle_instanced_arrays){var ai=!0,uo=Qr.program.attributes.map(function(Hi){var ho=ln.static[Hi];return ai=ai&&!!ho,ho});if(ai&&uo.length>0){var bs=Qa.getVAO(Qa.createVAO(uo));ga.drawVAO=new Bc(null,null,null,function(Hi,ho){return Hi.link(bs)}),ga.useVAO=!0}}return Mr?ga.useVAO=!0:ga.attributes=as(ln,Vr),ga.context=fu(Pr,Vr),ga}function Eu(Nn,ln,fr){var Pr=Nn.shared,Vr=Pr.context,mr=Nn.scope();Object.keys(fr).forEach(function(hr){ln.save(Vr,"."+hr);var Mr=fr[hr],On=Mr.append(Nn,ln);Array.isArray(On)?mr(Vr,".",hr,"=[",On.join(),"];"):mr(Vr,".",hr,"=",On,";")}),ln(mr)}function gu(Nn,ln,fr,Pr){var Vr=Nn.shared,mr=Vr.gl,hr=Vr.framebuffer,Mr;oe&&(Mr=ln.def(Vr.extensions,".webgl_draw_buffers"));var On=Nn.constants,ur=On.drawBuffer,Cn=On.backBuffer,Dr;fr?Dr=fr.append(Nn,ln):Dr=ln.def(hr,".next"),Pr||ln("if(",Dr,"!==",hr,".cur){"),ln("if(",Dr,"){",mr,".bindFramebuffer(",Mv,",",Dr,".framebuffer);"),oe&&ln(Mr,".drawBuffersWEBGL(",ur,"[",Dr,".colorAttachments.length]);"),ln("}else{",mr,".bindFramebuffer(",Mv,",null);"),oe&&ln(Mr,".drawBuffersWEBGL(",Cn,");"),ln("}",hr,".cur=",Dr,";"),Pr||ln("}")}function zi(Nn,ln,fr){var Pr=Nn.shared,Vr=Pr.gl,mr=Nn.current,hr=Nn.next,Mr=Pr.current,On=Pr.next,ur=Nn.cond(Mr,".dirty");Ye.forEach(function(Cn){var Dr=Vn(Cn);if(!(Dr in fr.state)){var Qr,_a;if(Dr in hr){Qr=hr[Dr],_a=mr[Dr];var Ma=ra(he[Dr].length,function(ai){return ur.def(Qr,"[",ai,"]")});ur(Nn.cond(Ma.map(function(ai,uo){return ai+"!=="+_a+"["+uo+"]"}).join("||")).then(Vr,".",cn[Dr],"(",Ma,");",Ma.map(function(ai,uo){return _a+"["+uo+"]="+ai}).join(";"),";"))}else{Qr=ur.def(On,".",Dr);var ga=Nn.cond(Qr,"!==",Mr,".",Dr);ur(ga),Dr in gn?ga(Nn.cond(Qr).then(Vr,".enable(",gn[Dr],");").else(Vr,".disable(",gn[Dr],");"),Mr,".",Dr,"=",Qr,";"):ga(Vr,".",cn[Dr],"(",Qr,");",Mr,".",Dr,"=",Qr,";")}}}),Object.keys(fr.state).length===0&&ur(Mr,".dirty=false;"),ln(ur)}function ul(Nn,ln,fr,Pr){var Vr=Nn.shared,mr=Nn.current,hr=Vr.current,Mr=Vr.gl;tv(Object.keys(fr)).forEach(function(On){var ur=fr[On];if(!(Pr&&!Pr(ur))){var Cn=ur.append(Nn,ln);if(gn[On]){var Dr=gn[On];Vf(ur)?Cn?ln(Mr,".enable(",Dr,");"):ln(Mr,".disable(",Dr,");"):ln(Nn.cond(Cn).then(Mr,".enable(",Dr,");").else(Mr,".disable(",Dr,");")),ln(hr,".",On,"=",Cn,";")}else if(ys(Cn)){var Qr=mr[On];ln(Mr,".",cn[On],"(",Cn,");",Cn.map(function(_a,Ma){return Qr+"["+Ma+"]="+_a}).join(";"),";")}else ln(Mr,".",cn[On],"(",Cn,");",hr,".",On,"=",Cn,";")}})}function ml(Nn,ln){Xt&&(Nn.instancing=ln.def(Nn.shared.extensions,".angle_instanced_arrays"))}function Jo(Nn,ln,fr,Pr,Vr){var mr=Nn.shared,hr=Nn.stats,Mr=mr.current,On=mr.timer,ur=fr.profile;function Cn(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Dr,Qr;function _a(Hi){Dr=ln.def(),Hi(Dr,"=",Cn(),";"),typeof Vr=="string"?Hi(hr,".count+=",Vr,";"):Hi(hr,".count++;"),q&&(Pr?(Qr=ln.def(),Hi(Qr,"=",On,".getNumPendingQueries();")):Hi(On,".beginQuery(",hr,");"))}function Ma(Hi){Hi(hr,".cpuTime+=",Cn(),"-",Dr,";"),q&&(Pr?Hi(On,".pushScopeStats(",Qr,",",On,".getNumPendingQueries(),",hr,");"):Hi(On,".endQuery();"))}function ga(Hi){var ho=ln.def(Mr,".profile");ln(Mr,".profile=",Hi,";"),ln.exit(Mr,".profile=",ho,";")}var ai;if(ur){if(Vf(ur)){ur.enable?(_a(ln),Ma(ln.exit),ga("true")):ga("false");return}ai=ur.append(Nn,ln),ga(ai)}else ai=ln.def(Mr,".profile");var uo=Nn.block();_a(uo),ln("if(",ai,"){",uo,"}");var bs=Nn.block();Ma(bs),ln.exit("if(",ai,"){",bs,"}")}function Vl(Nn,ln,fr,Pr,Vr){var mr=Nn.shared;function hr(On){switch(On){case Wd:case vd:case wp:return 2;case Vd:case jd:case Xd:return 3;case pd:case kf:case Mh:return 4;default:return 1}}function Mr(On,ur,Cn){var Dr=mr.gl,Qr=ln.def(On,".location"),_a=ln.def(mr.attributes,"[",Qr,"]"),Ma=Cn.state,ga=Cn.buffer,ai=[Cn.x,Cn.y,Cn.z,Cn.w],uo=["buffer","normalized","offset","stride"];function bs(){ln("if(!",_a,".buffer){",Dr,".enableVertexAttribArray(",Qr,");}");var ho=Cn.type,No;if(Cn.size?No=ln.def(Cn.size,"||",ur):No=ur,ln("if(",_a,".type!==",ho,"||",_a,".size!==",No,"||",uo.map(function(xl){return _a+"."+xl+"!=="+Cn[xl]}).join("||"),"){",Dr,".bindBuffer(",Xc,",",ga,".buffer);",Dr,".vertexAttribPointer(",[Qr,No,ho,Cn.normalized,Cn.stride,Cn.offset],");",_a,".type=",ho,";",_a,".size=",No,";",uo.map(function(xl){return _a+"."+xl+"="+Cn[xl]+";"}).join(""),"}"),Xt){var au=Cn.divisor;ln("if(",_a,".divisor!==",au,"){",Nn.instancing,".vertexAttribDivisorANGLE(",[Qr,au],");",_a,".divisor=",au,";}")}}function Hi(){ln("if(",_a,".buffer){",Dr,".disableVertexAttribArray(",Qr,");",_a,".buffer=null;","}if(",Hc.map(function(ho,No){return _a+"."+ho+"!=="+ai[No]}).join("||"),"){",Dr,".vertexAttrib4f(",Qr,",",ai,");",Hc.map(function(ho,No){return _a+"."+ho+"="+ai[No]+";"}).join(""),"}")}Ma===vf?bs():Ma===Ld?Hi():(ln("if(",Ma,"===",vf,"){"),bs(),ln("}else{"),Hi(),ln("}"))}Pr.forEach(function(On){var ur=On.name,Cn=fr.attributes[ur],Dr;if(Cn){if(!Vr(Cn))return;Dr=Cn.append(Nn,ln)}else{if(!Vr(yd))return;var Qr=Nn.scopeAttrib(ur);Rt.optional(function(){Nn.assert(ln,Qr+".state","missing attribute "+ur)}),Dr={},Object.keys(new It).forEach(function(_a){Dr[_a]=ln.def(Qr,".",_a)})}Mr(Nn.link(On),hr(On.info.type),Dr)})}function Su(Nn,ln,fr,Pr,Vr){for(var mr=Nn.shared,hr=mr.gl,Mr,On=0;On<Pr.length;++On){var ur=Pr[On],Cn=ur.name,Dr=ur.info.type,Qr=fr.uniforms[Cn],_a=Nn.link(ur),Ma=_a+".location",ga;if(Qr){if(!Vr(Qr))continue;if(Vf(Qr)){var ai=Qr.value;if(Rt.command(ai!==null&&typeof ai!="undefined",'missing uniform "'+Cn+'"',Nn.commandStr),Dr===Sp||Dr===lh){Rt.command(typeof ai=="function"&&(Dr===Sp&&(ai._reglType==="texture2d"||ai._reglType==="framebuffer")||Dr===lh&&(ai._reglType==="textureCube"||ai._reglType==="framebufferCube")),"invalid texture for uniform "+Cn,Nn.commandStr);var uo=Nn.link(ai._texture||ai.color[0]._texture);ln(hr,".uniform1i(",Ma,",",uo+".bind());"),ln.exit(uo,".unbind();")}else if(Dr===Zh||Dr===Ep||Dr===Nh){Rt.optional(function(){Rt.command(ys(ai),"invalid matrix for uniform "+Cn,Nn.commandStr),Rt.command(Dr===Zh&&ai.length===4||Dr===Ep&&ai.length===9||Dr===Nh&&ai.length===16,"invalid length for matrix uniform "+Cn,Nn.commandStr)});var bs=Nn.global.def("new Float32Array(["+Array.prototype.slice.call(ai)+"])"),Hi=2;Dr===Ep?Hi=3:Dr===Nh&&(Hi=4),ln(hr,".uniformMatrix",Hi,"fv(",Ma,",false,",bs,");")}else{switch(Dr){case Ah:Rt.commandType(ai,"number","uniform "+Cn,Nn.commandStr),Mr="1f";break;case Wd:Rt.command(ys(ai)&&ai.length===2,"uniform "+Cn,Nn.commandStr),Mr="2f";break;case Vd:Rt.command(ys(ai)&&ai.length===3,"uniform "+Cn,Nn.commandStr),Mr="3f";break;case pd:Rt.command(ys(ai)&&ai.length===4,"uniform "+Cn,Nn.commandStr),Mr="4f";break;case Hd:Rt.commandType(ai,"boolean","uniform "+Cn,Nn.commandStr),Mr="1i";break;case xp:Rt.commandType(ai,"number","uniform "+Cn,Nn.commandStr),Mr="1i";break;case wp:Rt.command(ys(ai)&&ai.length===2,"uniform "+Cn,Nn.commandStr),Mr="2i";break;case vd:Rt.command(ys(ai)&&ai.length===2,"uniform "+Cn,Nn.commandStr),Mr="2i";break;case Xd:Rt.command(ys(ai)&&ai.length===3,"uniform "+Cn,Nn.commandStr),Mr="3i";break;case jd:Rt.command(ys(ai)&&ai.length===3,"uniform "+Cn,Nn.commandStr),Mr="3i";break;case Mh:Rt.command(ys(ai)&&ai.length===4,"uniform "+Cn,Nn.commandStr),Mr="4i";break;case kf:Rt.command(ys(ai)&&ai.length===4,"uniform "+Cn,Nn.commandStr),Mr="4i";break}ln(hr,".uniform",Mr,"(",Ma,",",ys(ai)?Array.prototype.slice.call(ai):ai,");")}continue}else ga=Qr.append(Nn,ln)}else{if(!Vr(yd))continue;ga=ln.def(mr.uniforms,"[",vn.id(Cn),"]")}Dr===Sp?(Rt(!Array.isArray(ga),"must specify a scalar prop for textures"),ln("if(",ga,"&&",ga,'._reglType==="framebuffer"){',ga,"=",ga,".color[0];","}")):Dr===lh&&(Rt(!Array.isArray(ga),"must specify a scalar prop for cube maps"),ln("if(",ga,"&&",ga,'._reglType==="framebufferCube"){',ga,"=",ga,".color[0];","}")),Rt.optional(function(){function uc(Kc,Rf){Nn.assert(ln,Kc,'bad data or missing for uniform "'+Cn+'".  '+Rf)}function Rv(Kc){Rt(!Array.isArray(ga),"must not specify an array type for uniform"),uc("typeof "+ga+'==="'+Kc+'"',"invalid type, expected "+Kc)}function Xf(Kc,Rf){Array.isArray(ga)?Rt(ga.length===Kc,"must have length "+Kc):uc(mr.isArrayLike+"("+ga+")&&"+ga+".length==="+Kc,"invalid vector, should have length "+Kc,Nn.commandStr)}function Tg(Kc){Rt(!Array.isArray(ga),"must not specify a value type"),uc("typeof "+ga+'==="function"&&'+ga+'._reglType==="texture'+(Kc===dd?"2d":"Cube")+'"',"invalid texture type",Nn.commandStr)}switch(Dr){case xp:Rv("number");break;case vd:Xf(2,"number");break;case jd:Xf(3,"number");break;case kf:Xf(4,"number");break;case Ah:Rv("number");break;case Wd:Xf(2,"number");break;case Vd:Xf(3,"number");break;case pd:Xf(4,"number");break;case Hd:Rv("boolean");break;case wp:Xf(2,"boolean");break;case Xd:Xf(3,"boolean");break;case Mh:Xf(4,"boolean");break;case Zh:Xf(4,"number");break;case Ep:Xf(9,"number");break;case Nh:Xf(16,"number");break;case Sp:Tg(dd);break;case lh:Tg(_g);break}});var ho=1;switch(Dr){case Sp:case lh:var No=ln.def(ga,"._texture");ln(hr,".uniform1i(",Ma,",",No,".bind());"),ln.exit(No,".unbind();");continue;case xp:case Hd:Mr="1i";break;case vd:case wp:Mr="2i",ho=2;break;case jd:case Xd:Mr="3i",ho=3;break;case kf:case Mh:Mr="4i",ho=4;break;case Ah:Mr="1f";break;case Wd:Mr="2f",ho=2;break;case Vd:Mr="3f",ho=3;break;case pd:Mr="4f",ho=4;break;case Zh:Mr="Matrix2fv";break;case Ep:Mr="Matrix3fv";break;case Nh:Mr="Matrix4fv";break}if(ln(hr,".uniform",Mr,"(",Ma,","),Mr.charAt(0)==="M"){var au=Math.pow(Dr-Zh+2,2),xl=Nn.global.def("new Float32Array(",au,")");Array.isArray(ga)?ln("false,(",ra(au,function(uc){return xl+"["+uc+"]="+ga[uc]}),",",xl,")"):ln("false,(Array.isArray(",ga,")||",ga," instanceof Float32Array)?",ga,":(",ra(au,function(uc){return xl+"["+uc+"]="+ga+"["+uc+"]"}),",",xl,")")}else ho>1?ln(ra(ho,function(uc){return Array.isArray(ga)?ga[uc]:ga+"["+uc+"]"})):(Rt(!Array.isArray(ga),"uniform value must not be an array"),ln(ga));ln(");")}}function co(Nn,ln,fr,Pr){var Vr=Nn.shared,mr=Vr.gl,hr=Vr.draw,Mr=Pr.draw;function On(){var No=Mr.elements,au,xl=ln;return No?((No.contextDep&&Pr.contextDynamic||No.propDep)&&(xl=fr),au=No.append(Nn,xl)):au=xl.def(hr,".",Pl),au&&xl("if("+au+")"+mr+".bindBuffer("+eo+","+au+".buffer.buffer);"),au}function ur(){var No=Mr.count,au,xl=ln;return No?((No.contextDep&&Pr.contextDynamic||No.propDep)&&(xl=fr),au=No.append(Nn,xl),Rt.optional(function(){No.MISSING&&Nn.assert(ln,"false","missing vertex count"),No.DYNAMIC&&Nn.assert(xl,au+">=0","missing vertex count")})):(au=xl.def(hr,".",Eh),Rt.optional(function(){Nn.assert(xl,au+">=0","missing vertex count")})),au}var Cn=On();function Dr(No){var au=Mr[No];return au?au.contextDep&&Pr.contextDynamic||au.propDep?au.append(Nn,fr):au.append(Nn,ln):ln.def(hr,".",No)}var Qr=Dr(Nf),_a=Dr(fd),Ma=ur();if(typeof Ma=="number"){if(Ma===0)return}else fr("if(",Ma,"){"),fr.exit("}");var ga,ai;Xt&&(ga=Dr(Vp),ai=Nn.instancing);var uo=Cn+".type",bs=Mr.elements&&Vf(Mr.elements);function Hi(){function No(){fr(ai,".drawElementsInstancedANGLE(",[Qr,Ma,uo,_a+"<<(("+uo+"-"+Sv+")>>1)",ga],");")}function au(){fr(ai,".drawArraysInstancedANGLE(",[Qr,_a,Ma,ga],");")}Cn?bs?No():(fr("if(",Cn,"){"),No(),fr("}else{"),au(),fr("}")):au()}function ho(){function No(){fr(mr+".drawElements("+[Qr,Ma,uo,_a+"<<(("+uo+"-"+Sv+")>>1)"]+");")}function au(){fr(mr+".drawArrays("+[Qr,_a,Ma]+");")}Cn?bs?No():(fr("if(",Cn,"){"),No(),fr("}else{"),au(),fr("}")):au()}Xt&&(typeof ga!="number"||ga>=0)?typeof ga=="string"?(fr("if(",ga,">0){"),Hi(),fr("}else if(",ga,"<0){"),ho(),fr("}")):Hi():ho()}function Ls(Nn,ln,fr,Pr,Vr){var mr=Za(),hr=mr.proc("body",Vr);return Rt.optional(function(){mr.commandStr=ln.commandStr,mr.command=mr.link(ln.commandStr)}),Xt&&(mr.instancing=hr.def(mr.shared.extensions,".angle_instanced_arrays")),Nn(mr,hr,fr,Pr),mr.compile().body}function pi(Nn,ln,fr,Pr){ml(Nn,ln),fr.useVAO?fr.drawVAO?ln(Nn.shared.vao,".setVAO(",fr.drawVAO.append(Nn,ln),");"):ln(Nn.shared.vao,".setVAO(",Nn.shared.vao,".targetVAO);"):(ln(Nn.shared.vao,".setVAO(null);"),Vl(Nn,ln,fr,Pr.attributes,function(){return!0})),Su(Nn,ln,fr,Pr.uniforms,function(){return!0}),co(Nn,ln,ln,fr)}function ll(Nn,ln){var fr=Nn.proc("draw",1);ml(Nn,fr),Eu(Nn,fr,ln.context),gu(Nn,fr,ln.framebuffer),zi(Nn,fr,ln),ul(Nn,fr,ln.state),Jo(Nn,fr,ln,!1,!0);var Pr=ln.shader.progVar.append(Nn,fr);if(fr(Nn.shared.gl,".useProgram(",Pr,".program);"),ln.shader.program)pi(Nn,fr,ln,ln.shader.program);else{fr(Nn.shared.vao,".setVAO(null);");var Vr=Nn.global.def("{}"),mr=fr.def(Pr,".id"),hr=fr.def(Vr,"[",mr,"]");fr(Nn.cond(hr).then(hr,".call(this,a0);").else(hr,"=",Vr,"[",mr,"]=",Nn.link(function(Mr){return Ls(pi,Nn,ln,Mr,1)}),"(",Pr,");",hr,".call(this,a0);"))}Object.keys(ln.state).length>0&&fr(Nn.shared.current,".dirty=true;")}function Hf(Nn,ln,fr,Pr){Nn.batchId="a1",ml(Nn,ln);function Vr(){return!0}Vl(Nn,ln,fr,Pr.attributes,Vr),Su(Nn,ln,fr,Pr.uniforms,Vr),co(Nn,ln,ln,fr)}function bl(Nn,ln,fr,Pr){ml(Nn,ln);var Vr=fr.contextDep,mr=ln.def(),hr="a0",Mr="a1",On=ln.def();Nn.shared.props=On,Nn.batchId=mr;var ur=Nn.scope(),Cn=Nn.scope();ln(ur.entry,"for(",mr,"=0;",mr,"<",Mr,";++",mr,"){",On,"=",hr,"[",mr,"];",Cn,"}",ur.exit);function Dr(uo){return uo.contextDep&&Vr||uo.propDep}function Qr(uo){return!Dr(uo)}if(fr.needsContext&&Eu(Nn,Cn,fr.context),fr.needsFramebuffer&&gu(Nn,Cn,fr.framebuffer),ul(Nn,Cn,fr.state,Dr),fr.profile&&Dr(fr.profile)&&Jo(Nn,Cn,fr,!1,!0),Pr)fr.useVAO?fr.drawVAO?Dr(fr.drawVAO)?Cn(Nn.shared.vao,".setVAO(",fr.drawVAO.append(Nn,Cn),");"):ur(Nn.shared.vao,".setVAO(",fr.drawVAO.append(Nn,ur),");"):ur(Nn.shared.vao,".setVAO(",Nn.shared.vao,".targetVAO);"):(ur(Nn.shared.vao,".setVAO(null);"),Vl(Nn,ur,fr,Pr.attributes,Qr),Vl(Nn,Cn,fr,Pr.attributes,Dr)),Su(Nn,ur,fr,Pr.uniforms,Qr),Su(Nn,Cn,fr,Pr.uniforms,Dr),co(Nn,ur,Cn,fr);else{var _a=Nn.global.def("{}"),Ma=fr.shader.progVar.append(Nn,Cn),ga=Cn.def(Ma,".id"),ai=Cn.def(_a,"[",ga,"]");Cn(Nn.shared.gl,".useProgram(",Ma,".program);","if(!",ai,"){",ai,"=",_a,"[",ga,"]=",Nn.link(function(uo){return Ls(Hf,Nn,fr,uo,2)}),"(",Ma,");}",ai,".call(this,a0[",mr,"],",mr,");")}}function Wn(Nn,ln){var fr=Nn.proc("batch",2);Nn.batchId="0",ml(Nn,fr);var Pr=!1,Vr=!0;Object.keys(ln.context).forEach(function(_a){Pr=Pr||ln.context[_a].propDep}),Pr||(Eu(Nn,fr,ln.context),Vr=!1);var mr=ln.framebuffer,hr=!1;mr?(mr.propDep?Pr=hr=!0:mr.contextDep&&Pr&&(hr=!0),hr||gu(Nn,fr,mr)):gu(Nn,fr,null),ln.state.viewport&&ln.state.viewport.propDep&&(Pr=!0);function Mr(_a){return _a.contextDep&&Pr||_a.propDep}zi(Nn,fr,ln),ul(Nn,fr,ln.state,function(_a){return!Mr(_a)}),(!ln.profile||!Mr(ln.profile))&&Jo(Nn,fr,ln,!1,"a1"),ln.contextDep=Pr,ln.needsContext=Vr,ln.needsFramebuffer=hr;var On=ln.shader.progVar;if(On.contextDep&&Pr||On.propDep)bl(Nn,fr,ln,null);else{var ur=On.append(Nn,fr);if(fr(Nn.shared.gl,".useProgram(",ur,".program);"),ln.shader.program)bl(Nn,fr,ln,ln.shader.program);else{fr(Nn.shared.vao,".setVAO(null);");var Cn=Nn.global.def("{}"),Dr=fr.def(ur,".id"),Qr=fr.def(Cn,"[",Dr,"]");fr(Nn.cond(Qr).then(Qr,".call(this,a0,a1);").else(Qr,"=",Cn,"[",Dr,"]=",Nn.link(function(_a){return Ls(bl,Nn,ln,_a,2)}),"(",ur,");",Qr,".call(this,a0,a1);"))}}Object.keys(ln.state).length>0&&fr(Nn.shared.current,".dirty=true;")}function Jr(Nn,ln){var fr=Nn.proc("scope",3);Nn.batchId="a2";var Pr=Nn.shared,Vr=Pr.current;Eu(Nn,fr,ln.context),ln.framebuffer&&ln.framebuffer.append(Nn,fr),tv(Object.keys(ln.state)).forEach(function(hr){var Mr=ln.state[hr],On=Mr.append(Nn,fr);ys(On)?On.forEach(function(ur,Cn){fr.set(Nn.next[hr],"["+Cn+"]",ur)}):fr.set(Pr.next,"."+hr,On)}),Jo(Nn,fr,ln,!0,!0),[Pl,fd,Eh,Vp,Nf].forEach(function(hr){var Mr=ln.draw[hr];!Mr||fr.set(Pr.draw,"."+hr,""+Mr.append(Nn,fr))}),Object.keys(ln.uniforms).forEach(function(hr){var Mr=ln.uniforms[hr].append(Nn,fr);Array.isArray(Mr)&&(Mr="["+Mr.join()+"]"),fr.set(Pr.uniforms,"["+vn.id(hr)+"]",Mr)}),Object.keys(ln.attributes).forEach(function(hr){var Mr=ln.attributes[hr].append(Nn,fr),On=Nn.scopeAttrib(hr);Object.keys(new It).forEach(function(ur){fr.set(On,"."+ur,Mr[ur])})}),ln.scopeVAO&&fr.set(Pr.vao,".targetVAO",ln.scopeVAO.append(Nn,fr));function mr(hr){var Mr=ln.shader[hr];Mr&&fr.set(Pr.shader,"."+hr,Mr.append(Nn,fr))}mr(wh),mr(sh),Object.keys(ln.state).length>0&&(fr(Vr,".dirty=true;"),fr.exit(Vr,".dirty=true;")),fr("a1(",Nn.shared.context,",a0,",Nn.batchId,");")}function Nr(Nn){if(!(typeof Nn!="object"||ys(Nn))){for(var ln=Object.keys(Nn),fr=0;fr<ln.length;++fr)if(ar.isDynamic(Nn[ln[fr]]))return!0;return!1}}function ji(Nn,ln,fr){var Pr=ln.static[fr];if(!Pr||!Nr(Pr))return;var Vr=Nn.global,mr=Object.keys(Pr),hr=!1,Mr=!1,On=!1,ur=Nn.global.def("{}");mr.forEach(function(Dr){var Qr=Pr[Dr];if(ar.isDynamic(Qr)){typeof Qr=="function"&&(Qr=Pr[Dr]=ar.unbox(Qr));var _a=vc(Qr,null);hr=hr||_a.thisDep,On=On||_a.propDep,Mr=Mr||_a.contextDep}else{switch(Vr(ur,".",Dr,"="),typeof Qr){case"number":Vr(Qr);break;case"string":Vr('"',Qr,'"');break;case"object":Array.isArray(Qr)&&Vr("[",Qr.join(),"]");break;default:Vr(Nn.link(Qr));break}Vr(";")}});function Cn(Dr,Qr){mr.forEach(function(_a){var Ma=Pr[_a];if(!!ar.isDynamic(Ma)){var ga=Dr.invoke(Qr,Ma);Qr(ur,".",_a,"=",ga,";")}})}ln.dynamic[fr]=new ar.DynamicVariable(yp,{thisDep:hr,contextDep:Mr,propDep:On,ref:ur,append:Cn}),delete ln.static[fr]}function Po(Nn,ln,fr,Pr,Vr){var mr=Za();mr.stats=mr.link(Vr),Object.keys(ln.static).forEach(function(Mr){ji(mr,ln,Mr)}),vs.forEach(function(Mr){ji(mr,Nn,Mr)});var hr=Rs(Nn,ln,fr,Pr,mr);return ll(mr,hr),Jr(mr,hr),Wn(mr,hr),$(mr.compile(),{destroy:function(){hr.shader.program.destroy()}})}return{next:Te,current:he,procs:function(){var Nn=Za(),ln=Nn.proc("poll"),fr=Nn.proc("refresh"),Pr=Nn.block();ln(Pr),fr(Pr);var Vr=Nn.shared,mr=Vr.gl,hr=Vr.next,Mr=Vr.current;Pr(Mr,".dirty=false;"),gu(Nn,ln),gu(Nn,fr,null,!0);var On;Xt&&(On=Nn.link(Xt)),er.oes_vertex_array_object&&fr(Nn.link(er.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var ur=0;ur<ia.maxAttributes;++ur){var Cn=fr.def(Vr.attributes,"[",ur,"]"),Dr=Nn.cond(Cn,".buffer");Dr.then(mr,".enableVertexAttribArray(",ur,");",mr,".bindBuffer(",Xc,",",Cn,".buffer.buffer);",mr,".vertexAttribPointer(",ur,",",Cn,".size,",Cn,".type,",Cn,".normalized,",Cn,".stride,",Cn,".offset);").else(mr,".disableVertexAttribArray(",ur,");",mr,".vertexAttrib4f(",ur,",",Cn,".x,",Cn,".y,",Cn,".z,",Cn,".w);",Cn,".buffer=null;"),fr(Dr),Xt&&fr(On,".vertexAttribDivisorANGLE(",ur,",",Cn,".divisor);")}return fr(Nn.shared.vao,".currentVAO=null;",Nn.shared.vao,".setVAO(",Nn.shared.vao,".targetVAO);"),Object.keys(gn).forEach(function(Qr){var _a=gn[Qr],Ma=Pr.def(hr,".",Qr),ga=Nn.block();ga("if(",Ma,"){",mr,".enable(",_a,")}else{",mr,".disable(",_a,")}",Mr,".",Qr,"=",Ma,";"),fr(ga),ln("if(",Ma,"!==",Mr,".",Qr,"){",ga,"}")}),Object.keys(cn).forEach(function(Qr){var _a=cn[Qr],Ma=he[Qr],ga,ai,uo=Nn.block();if(uo(mr,".",_a,"("),ys(Ma)){var bs=Ma.length;ga=Nn.global.def(hr,".",Qr),ai=Nn.global.def(Mr,".",Qr),uo(ra(bs,function(Hi){return ga+"["+Hi+"]"}),");",ra(bs,function(Hi){return ai+"["+Hi+"]="+ga+"["+Hi+"];"}).join("")),ln("if(",ra(bs,function(Hi){return ga+"["+Hi+"]!=="+ai+"["+Hi+"]"}).join("||"),"){",uo,"}")}else ga=Pr.def(hr,".",Qr),ai=Pr.def(Mr,".",Qr),uo(ga,");",Mr,".",Qr,"=",ga,";"),ln("if(",ga,"!==",ai,"){",uo,"}");fr(uo)}),Nn.compile()}(),compile:Po}}function ev(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Zd=34918,nv=34919,Dh=35007,lf=function(ce,vn){if(!vn.ext_disjoint_timer_query)return null;var er=[];function ia(){return er.pop()||vn.ext_disjoint_timer_query.createQueryEXT()}function da(Xt){er.push(Xt)}var aa=[];function na(Xt){var oe=ia();vn.ext_disjoint_timer_query.beginQueryEXT(Dh,oe),aa.push(oe),q(aa.length-1,aa.length,Xt)}function Xa(){vn.ext_disjoint_timer_query.endQueryEXT(Dh)}function Oa(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Qa=[];function Ka(){return Qa.pop()||new Oa}function zn(Xt){Qa.push(Xt)}var N=[];function q(Xt,oe,he){var Te=Ka();Te.startQueryIndex=Xt,Te.endQueryIndex=oe,Te.sum=0,Te.stats=he,N.push(Te)}var ht=[],It=[];function Ft(){var Xt,oe,he=aa.length;if(he!==0){It.length=Math.max(It.length,he+1),ht.length=Math.max(ht.length,he+1),ht[0]=0,It[0]=0;var Te=0;for(Xt=0,oe=0;oe<aa.length;++oe){var Ye=aa[oe];vn.ext_disjoint_timer_query.getQueryObjectEXT(Ye,nv)?(Te+=vn.ext_disjoint_timer_query.getQueryObjectEXT(Ye,Zd),da(Ye)):aa[Xt++]=Ye,ht[oe+1]=Te,It[oe+1]=Xt}for(aa.length=Xt,Xt=0,oe=0;oe<N.length;++oe){var gn=N[oe],cn=gn.startQueryIndex,Vn=gn.endQueryIndex;gn.sum+=ht[Vn]-ht[cn];var An=It[cn],ma=It[Vn];ma===An?(gn.stats.gpuTime+=gn.sum/1e6,zn(gn)):(gn.startQueryIndex=An,gn.endQueryIndex=ma,N[Xt++]=gn)}N.length=Xt}}return{beginQuery:na,endQuery:Xa,pushScopeStats:q,update:Ft,getNumPendingQueries:function(){return aa.length},clear:function(){er.push.apply(er,aa);for(var Xt=0;Xt<er.length;Xt++)vn.ext_disjoint_timer_query.deleteQueryEXT(er[Xt]);aa.length=0,er.length=0},restore:function(){aa.length=0,er.length=0}}},ci=16384,rv=256,av=1024,rg=34962,qd="webglcontextlost",Qh="webglcontextrestored",jf=1,ag=2,Ov=3;function Cp(ce,vn){for(var er=0;er<ce.length;++er)if(ce[er]===vn)return er;return-1}function Zl(ce){var vn=Tr(ce);if(!vn)return null;var er=vn.gl,ia=er.getContextAttributes(),da=er.isContextLost(),aa=ta(er,vn);if(!aa)return null;var na=Gn(),Xa=ev(),Oa=aa.extensions,Qa=lf(er,Oa),Ka=tr(),zn=er.drawingBufferWidth,N=er.drawingBufferHeight,q={tick:0,time:0,viewportWidth:zn,viewportHeight:N,framebufferWidth:zn,framebufferHeight:N,drawingBufferWidth:zn,drawingBufferHeight:N,pixelRatio:vn.pixelRatio},ht={},It={elements:null,primitive:4,count:-1,offset:0,instances:-1},Ft=wi(er,Oa),Xt=Co(er,Xa,vn,he),oe=ld(er,Oa,Ft,Xa,Xt);function he(co){return oe.destroyBuffer(co)}var Te=nu(er,Oa,Xt,Xa),Ye=Vc(er,na,Xa,vn),gn=vh(er,Oa,Ft,function(){An.procs.poll()},q,Xa,vn),cn=ne(er,Oa,Ft,Xa,vn),Vn=Rd(er,Oa,Ft,gn,cn,Xa),An=Dv(er,na,Oa,Ft,Xt,Te,gn,Vn,ht,oe,Ye,It,q,Qa,vn),ma=yh(er,Vn,An.procs.poll,q,ia,Oa,Ft),Or=An.next,Fr=er.canvas,rr=[],Za=[],Xn=[],ii=[vn.onDestroy],Ti=null;function Ki(){if(rr.length===0){Qa&&Qa.update(),Ti=null;return}Ti=Fn.next(Ki),ul();for(var co=rr.length-1;co>=0;--co){var Ls=rr[co];Ls&&Ls(q,null,0)}er.flush(),Qa&&Qa.update()}function Ai(){!Ti&&rr.length>0&&(Ti=Fn.next(Ki))}function Yo(){Ti&&(Fn.cancel(Ki),Ti=null)}function bi(co){co.preventDefault(),da=!0,Yo(),Za.forEach(function(Ls){Ls()})}function Lu(co){er.getError(),da=!1,aa.restore(),Ye.restore(),Xt.restore(),gn.restore(),cn.restore(),Vn.restore(),oe.restore(),Qa&&Qa.restore(),An.procs.refresh(),Ai(),Xn.forEach(function(Ls){Ls()})}Fr&&(Fr.addEventListener(qd,bi,!1),Fr.addEventListener(Qh,Lu,!1));function as(){rr.length=0,Yo(),Fr&&(Fr.removeEventListener(qd,bi),Fr.removeEventListener(Qh,Lu)),Ye.clear(),Vn.clear(),cn.clear(),gn.clear(),Te.clear(),Xt.clear(),oe.clear(),Qa&&Qa.clear(),ii.forEach(function(co){co()})}function gl(co){Rt(!!co,"invalid args to regl({...})"),Rt.type(co,"object","invalid args to regl({...})");function Ls(Vr){var mr=$({},Vr);delete mr.uniforms,delete mr.attributes,delete mr.context,delete mr.vao,"stencil"in mr&&mr.stencil.op&&(mr.stencil.opBack=mr.stencil.opFront=mr.stencil.op,delete mr.stencil.op);function hr(Mr){if(Mr in mr){var On=mr[Mr];delete mr[Mr],Object.keys(On).forEach(function(ur){mr[Mr+"."+ur]=On[ur]})}}return hr("blend"),hr("depth"),hr("cull"),hr("stencil"),hr("polygonOffset"),hr("scissor"),hr("sample"),"vao"in Vr&&(mr.vao=Vr.vao),mr}function pi(Vr,mr){var hr={},Mr={};return Object.keys(Vr).forEach(function(On){var ur=Vr[On];if(ar.isDynamic(ur)){Mr[On]=ar.unbox(ur,On);return}else if(mr&&Array.isArray(ur)){for(var Cn=0;Cn<ur.length;++Cn)if(ar.isDynamic(ur[Cn])){Mr[On]=ar.unbox(ur,On);return}}hr[On]=ur}),{dynamic:Mr,static:hr}}var ll=pi(co.context||{},!0),Hf=pi(co.uniforms||{},!0),bl=pi(co.attributes||{},!1),Wn=pi(Ls(co),!1),Jr={gpuTime:0,cpuTime:0,count:0},Nr=An.compile(Wn,bl,Hf,ll,Jr),ji=Nr.draw,Po=Nr.batch,Nn=Nr.scope,ln=[];function fr(Vr){for(;ln.length<Vr;)ln.push(null);return ln}function Pr(Vr,mr){var hr;if(da&&Rt.raise("context lost"),typeof Vr=="function")return Nn.call(this,null,Vr,0);if(typeof mr=="function")if(typeof Vr=="number")for(hr=0;hr<Vr;++hr)Nn.call(this,null,mr,hr);else if(Array.isArray(Vr))for(hr=0;hr<Vr.length;++hr)Nn.call(this,Vr[hr],mr,hr);else return Nn.call(this,Vr,mr,0);else if(typeof Vr=="number"){if(Vr>0)return Po.call(this,fr(Vr|0),Vr|0)}else if(Array.isArray(Vr)){if(Vr.length)return Po.call(this,Vr,Vr.length)}else return ji.call(this,Vr)}return $(Pr,{stats:Jr,destroy:function(){Nr.destroy()}})}var fu=Vn.setFBO=gl({framebuffer:ar.define.call(null,jf,"framebuffer")});function Rs(co,Ls){var pi=0;An.procs.poll();var ll=Ls.color;ll&&(er.clearColor(+ll[0]||0,+ll[1]||0,+ll[2]||0,+ll[3]||0),pi|=ci),"depth"in Ls&&(er.clearDepth(+Ls.depth),pi|=rv),"stencil"in Ls&&(er.clearStencil(Ls.stencil|0),pi|=av),Rt(!!pi,"called regl.clear with no buffer specified"),er.clear(pi)}function Eu(co){if(Rt(typeof co=="object"&&co,"regl.clear() takes an object as input"),"framebuffer"in co)if(co.framebuffer&&co.framebuffer_reglType==="framebufferCube")for(var Ls=0;Ls<6;++Ls)fu($({framebuffer:co.framebuffer.faces[Ls]},co),Rs);else fu(co,Rs);else Rs(null,co)}function gu(co){Rt.type(co,"function","regl.frame() callback must be a function"),rr.push(co);function Ls(){var pi=Cp(rr,co);Rt(pi>=0,"cannot cancel a frame twice");function ll(){var Hf=Cp(rr,ll);rr[Hf]=rr[rr.length-1],rr.length-=1,rr.length<=0&&Yo()}rr[pi]=ll}return Ai(),{cancel:Ls}}function zi(){var co=Or.viewport,Ls=Or.scissor_box;co[0]=co[1]=Ls[0]=Ls[1]=0,q.viewportWidth=q.framebufferWidth=q.drawingBufferWidth=co[2]=Ls[2]=er.drawingBufferWidth,q.viewportHeight=q.framebufferHeight=q.drawingBufferHeight=co[3]=Ls[3]=er.drawingBufferHeight}function ul(){q.tick+=1,q.time=Jo(),zi(),An.procs.poll()}function ml(){gn.refresh(),zi(),An.procs.refresh(),Qa&&Qa.update()}function Jo(){return(tr()-Ka)/1e3}ml();function Vl(co,Ls){Rt.type(Ls,"function","listener callback must be a function");var pi;switch(co){case"frame":return gu(Ls);case"lost":pi=Za;break;case"restore":pi=Xn;break;case"destroy":pi=ii;break;default:Rt.raise("invalid event, must be one of frame,lost,restore,destroy")}return pi.push(Ls),{cancel:function(){for(var ll=0;ll<pi.length;++ll)if(pi[ll]===Ls){pi[ll]=pi[pi.length-1],pi.pop();return}}}}var Su=$(gl,{clear:Eu,prop:ar.define.bind(null,jf),context:ar.define.bind(null,ag),this:ar.define.bind(null,Ov),draw:gl({}),buffer:function(co){return Xt.create(co,rg,!1,!1)},elements:function(co){return Te.create(co,!1)},texture:gn.create2D,cube:gn.createCube,renderbuffer:cn.create,framebuffer:Vn.create,framebufferCube:Vn.createCube,vao:oe.createVAO,attributes:ia,frame:gu,on:Vl,limits:Ft,hasExtension:function(co){return Ft.extensions.indexOf(co.toLowerCase())>=0},read:ma,destroy:as,_gl:er,_refresh:ml,poll:function(){ul(),Qa&&Qa.update()},now:Jo,stats:Xa});return vn.onDone(null,Su),Su}return Zl})},36377:function(sr,it,$){var X=$(84832),tt=$(68652),j=$(90801),W=$(92030),Q=$(3618),Z=$(89049),L=$(51971);L.alea=X,L.xor128=tt,L.xorwow=j,L.xorshift7=W,L.xor4096=Q,L.tychei=Z,sr.exports=L},84832:function(sr,it,$){sr=$.nmd(sr);var X;(function(tt,j,W){function Q(C){var M=this,k=P();M.next=function(){var B=2091639*M.s0+M.c*23283064365386963e-26;return M.s0=M.s1,M.s1=M.s2,M.s2=B-(M.c=B|0)},M.c=1,M.s0=k(" "),M.s1=k(" "),M.s2=k(" "),M.s0-=k(C),M.s0<0&&(M.s0+=1),M.s1-=k(C),M.s1<0&&(M.s1+=1),M.s2-=k(C),M.s2<0&&(M.s2+=1),k=null}function Z(C,M){return M.c=C.c,M.s0=C.s0,M.s1=C.s1,M.s2=C.s2,M}function L(C,M){var k=new Q(C),B=M&&M.state,R=k.next;return R.int32=function(){return k.next()*4294967296|0},R.double=function(){return R()+(R()*2097152|0)*11102230246251565e-32},R.quick=R,B&&(typeof B=="object"&&Z(B,k),R.state=function(){return Z(k,{})}),R}function P(){var C=4022871197,M=function(k){k=k.toString();for(var B=0;B<k.length;B++){C+=k.charCodeAt(B);var R=.02519603282416938*C;C=R>>>0,R-=C,R*=C,C=R>>>0,R-=C,C+=R*4294967296}return(C>>>0)*23283064365386963e-26};return M}j&&j.exports?j.exports=L:$.amdD&&$.amdO?(X=function(){return L}.call(it,$,it,j),X!==void 0&&(j.exports=X)):this.alea=L})(this,sr,$.amdD)},89049:function(sr,it,$){sr=$.nmd(sr);var X;(function(tt,j,W){function Q(P){var C=this,M="";C.next=function(){var B=C.b,R=C.c,F=C.d,K=C.a;return B=B<<25^B>>>7^R,R=R-F|0,F=F<<24^F>>>8^K,K=K-B|0,C.b=B=B<<20^B>>>12^R,C.c=R=R-F|0,C.d=F<<16^R>>>16^K,C.a=K-B|0},C.a=0,C.b=0,C.c=2654435769|0,C.d=1367130551,P===Math.floor(P)?(C.a=P/4294967296|0,C.b=P|0):M+=P;for(var k=0;k<M.length+20;k++)C.b^=M.charCodeAt(k)|0,C.next()}function Z(P,C){return C.a=P.a,C.b=P.b,C.c=P.c,C.d=P.d,C}function L(P,C){var M=new Q(P),k=C&&C.state,B=function(){return(M.next()>>>0)/4294967296};return B.double=function(){do var R=M.next()>>>11,F=(M.next()>>>0)/4294967296,K=(R+F)/(1<<21);while(K===0);return K},B.int32=M.next,B.quick=B,k&&(typeof k=="object"&&Z(k,M),B.state=function(){return Z(M,{})}),B}j&&j.exports?j.exports=L:$.amdD&&$.amdO?(X=function(){return L}.call(it,$,it,j),X!==void 0&&(j.exports=X)):this.tychei=L})(this,sr,$.amdD)},68652:function(sr,it,$){sr=$.nmd(sr);var X;(function(tt,j,W){function Q(P){var C=this,M="";C.x=0,C.y=0,C.z=0,C.w=0,C.next=function(){var B=C.x^C.x<<11;return C.x=C.y,C.y=C.z,C.z=C.w,C.w^=C.w>>>19^B^B>>>8},P===(P|0)?C.x=P:M+=P;for(var k=0;k<M.length+64;k++)C.x^=M.charCodeAt(k)|0,C.next()}function Z(P,C){return C.x=P.x,C.y=P.y,C.z=P.z,C.w=P.w,C}function L(P,C){var M=new Q(P),k=C&&C.state,B=function(){return(M.next()>>>0)/4294967296};return B.double=function(){do var R=M.next()>>>11,F=(M.next()>>>0)/4294967296,K=(R+F)/(1<<21);while(K===0);return K},B.int32=M.next,B.quick=B,k&&(typeof k=="object"&&Z(k,M),B.state=function(){return Z(M,{})}),B}j&&j.exports?j.exports=L:$.amdD&&$.amdO?(X=function(){return L}.call(it,$,it,j),X!==void 0&&(j.exports=X)):this.xor128=L})(this,sr,$.amdD)},3618:function(sr,it,$){sr=$.nmd(sr);var X;(function(tt,j,W){function Q(P){var C=this;C.next=function(){var k=C.w,B=C.X,R=C.i,F,K;return C.w=k=k+1640531527|0,K=B[R+34&127],F=B[R=R+1&127],K^=K<<13,F^=F<<17,K^=K>>>15,F^=F>>>12,K=B[R]=K^F,C.i=R,K+(k^k>>>16)|0};function M(k,B){var R,F,K,O,_,ft=[],mt=128;for(B===(B|0)?(F=B,B=null):(B=B+"\0",F=0,mt=Math.max(mt,B.length)),K=0,O=-32;O<mt;++O)B&&(F^=B.charCodeAt((O+32)%B.length)),O===0&&(_=F),F^=F<<10,F^=F>>>15,F^=F<<4,F^=F>>>13,O>=0&&(_=_+1640531527|0,R=ft[O&127]^=F+_,K=R==0?K+1:0);for(K>=128&&(ft[(B&&B.length||0)&127]=-1),K=127,O=4*128;O>0;--O)F=ft[K+34&127],R=ft[K=K+1&127],F^=F<<13,R^=R<<17,F^=F>>>15,R^=R>>>12,ft[K]=F^R;k.w=_,k.X=ft,k.i=K}M(C,P)}function Z(P,C){return C.i=P.i,C.w=P.w,C.X=P.X.slice(),C}function L(P,C){P==null&&(P=+new Date);var M=new Q(P),k=C&&C.state,B=function(){return(M.next()>>>0)/4294967296};return B.double=function(){do var R=M.next()>>>11,F=(M.next()>>>0)/4294967296,K=(R+F)/(1<<21);while(K===0);return K},B.int32=M.next,B.quick=B,k&&(k.X&&Z(k,M),B.state=function(){return Z(M,{})}),B}j&&j.exports?j.exports=L:$.amdD&&$.amdO?(X=function(){return L}.call(it,$,it,j),X!==void 0&&(j.exports=X)):this.xor4096=L})(this,sr,$.amdD)},92030:function(sr,it,$){sr=$.nmd(sr);var X;(function(tt,j,W){function Q(P){var C=this;C.next=function(){var k=C.x,B=C.i,R,F,K;return R=k[B],R^=R>>>7,F=R^R<<24,R=k[B+1&7],F^=R^R>>>10,R=k[B+3&7],F^=R^R>>>3,R=k[B+4&7],F^=R^R<<7,R=k[B+7&7],R=R^R<<13,F^=R^R<<9,k[B]=F,C.i=B+1&7,F};function M(k,B){var R,F,K=[];if(B===(B|0))F=K[0]=B;else for(B=""+B,R=0;R<B.length;++R)K[R&7]=K[R&7]<<15^B.charCodeAt(R)+K[R+1&7]<<13;for(;K.length<8;)K.push(0);for(R=0;R<8&&K[R]===0;++R);for(R==8?F=K[7]=-1:F=K[R],k.x=K,k.i=0,R=256;R>0;--R)k.next()}M(C,P)}function Z(P,C){return C.x=P.x.slice(),C.i=P.i,C}function L(P,C){P==null&&(P=+new Date);var M=new Q(P),k=C&&C.state,B=function(){return(M.next()>>>0)/4294967296};return B.double=function(){do var R=M.next()>>>11,F=(M.next()>>>0)/4294967296,K=(R+F)/(1<<21);while(K===0);return K},B.int32=M.next,B.quick=B,k&&(k.x&&Z(k,M),B.state=function(){return Z(M,{})}),B}j&&j.exports?j.exports=L:$.amdD&&$.amdO?(X=function(){return L}.call(it,$,it,j),X!==void 0&&(j.exports=X)):this.xorshift7=L})(this,sr,$.amdD)},90801:function(sr,it,$){sr=$.nmd(sr);var X;(function(tt,j,W){function Q(P){var C=this,M="";C.next=function(){var B=C.x^C.x>>>2;return C.x=C.y,C.y=C.z,C.z=C.w,C.w=C.v,(C.d=C.d+362437|0)+(C.v=C.v^C.v<<4^(B^B<<1))|0},C.x=0,C.y=0,C.z=0,C.w=0,C.v=0,P===(P|0)?C.x=P:M+=P;for(var k=0;k<M.length+64;k++)C.x^=M.charCodeAt(k)|0,k==M.length&&(C.d=C.x<<10^C.x>>>4),C.next()}function Z(P,C){return C.x=P.x,C.y=P.y,C.z=P.z,C.w=P.w,C.v=P.v,C.d=P.d,C}function L(P,C){var M=new Q(P),k=C&&C.state,B=function(){return(M.next()>>>0)/4294967296};return B.double=function(){do var R=M.next()>>>11,F=(M.next()>>>0)/4294967296,K=(R+F)/(1<<21);while(K===0);return K},B.int32=M.next,B.quick=B,k&&(typeof k=="object"&&Z(k,M),B.state=function(){return Z(M,{})}),B}j&&j.exports?j.exports=L:$.amdD&&$.amdO?(X=function(){return L}.call(it,$,it,j),X!==void 0&&(j.exports=X)):this.xorwow=L})(this,sr,$.amdD)},51971:function(sr,it,$){var X;(function(tt,j){var W=this,Q=256,Z=6,L=52,P="random",C=j.pow(Q,Z),M=j.pow(2,L),k=M*2,B=Q-1,R;function F(ut,dt,gt){var wt=[];dt=dt==!0?{entropy:!0}:dt||{};var ot=ft(_(dt.entropy?[ut,st(tt)]:ut==null?mt():ut,3),wt),pt=new K(wt),Nt=function(){for(var Gt=pt.g(Z),se=C,ie=0;Gt<M;)Gt=(Gt+ie)*Q,se*=Q,ie=pt.g(1);for(;Gt>=k;)Gt/=2,se/=2,ie>>>=1;return(Gt+ie)/se};return Nt.int32=function(){return pt.g(4)|0},Nt.quick=function(){return pt.g(4)/4294967296},Nt.double=Nt,ft(st(pt.S),tt),(dt.pass||gt||function(Gt,se,ie,Be){return Be&&(Be.S&&O(Be,pt),Gt.state=function(){return O(pt,{})}),ie?(j[P]=Gt,se):Gt})(Nt,ot,"global"in dt?dt.global:this==j,dt.state)}j["seed"+P]=F;function K(ut){var dt,gt=ut.length,wt=this,ot=0,pt=wt.i=wt.j=0,Nt=wt.S=[];for(gt||(ut=[gt++]);ot<Q;)Nt[ot]=ot++;for(ot=0;ot<Q;ot++)Nt[ot]=Nt[pt=B&pt+ut[ot%gt]+(dt=Nt[ot])],Nt[pt]=dt;(wt.g=function(Gt){for(var se,ie=0,Be=wt.i,ke=wt.j,we=wt.S;Gt--;)se=we[Be=B&Be+1],ie=ie*Q+we[B&(we[Be]=we[ke=B&ke+se])+(we[ke]=se)];return wt.i=Be,wt.j=ke,ie})(Q)}function O(ut,dt){return dt.i=ut.i,dt.j=ut.j,dt.S=ut.S.slice(),dt}function _(ut,dt){var gt=[],wt=typeof ut,ot;if(dt&&wt=="object")for(ot in ut)try{gt.push(_(ut[ot],dt-1))}catch(pt){}return gt.length?gt:wt=="string"?ut:ut+"\0"}function ft(ut,dt){for(var gt=ut+"",wt,ot=0;ot<gt.length;)dt[B&ot]=B&(wt^=dt[B&ot]*19)+gt.charCodeAt(ot++);return st(dt)}function mt(){try{var ut;return R&&(ut=R.randomBytes)?ut=ut(Q):(ut=new Uint8Array(Q),(W.crypto||W.msCrypto).getRandomValues(ut)),st(ut)}catch(wt){var dt=W.navigator,gt=dt&&dt.plugins;return[+new Date,W,gt,W.screen,st(tt)]}}function st(ut){return String.fromCharCode.apply(0,ut)}if(ft(j.random(),tt),sr.exports){sr.exports=F;try{R=$(75042)}catch(ut){}}else X=function(){return F}.call(it,$,it,sr),X!==void 0&&(sr.exports=X)})([],Math)},86851:function(sr,it,$){"use strict";var X=$(89594),tt=Array.prototype.concat,j=Array.prototype.slice,W=sr.exports=function(Z){for(var L=[],P=0,C=Z.length;P<C;P++){var M=Z[P];X(M)?L=tt.call(L,j.call(M)):L.push(M)}return L};W.wrap=function(Q){return function(){return Q(W(arguments))}}},89594:function(sr){sr.exports=function($){return!$||typeof $=="string"?!1:$ instanceof Array||Array.isArray($)||$.length>=0&&($.splice instanceof Function||Object.getOwnPropertyDescriptor($,$.length-1)&&$.constructor.name!=="String")}}}]);
