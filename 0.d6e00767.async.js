var gA=Math.pow;var jr=(ur,ot,$)=>new Promise((Y,tt)=>{var j=Z=>{try{Q($.next(Z))}catch(R){tt(R)}},W=Z=>{try{Q($.throw(Z))}catch(R){tt(R)}},Q=Z=>Z.done?Y(Z.value):Promise.resolve(Z.value).then(j,W);Q(($=$.apply(ur,ot)).next())});(self.webpackChunkbiomedgps_studio=self.webpackChunkbiomedgps_studio||[]).push([[0],{7364:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"}},{tag:"path",attrs:{d:"M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"}}]},name:"aim",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="AimOutlined";var R=tt.forwardRef(Z)},43396:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M952 224h-52c-4.4 0-8 3.6-8 8v248h-92V304c0-4.4-3.6-8-8-8H232c-4.4 0-8 3.6-8 8v176h-92V232c0-4.4-3.6-8-8-8H72c-4.4 0-8 3.6-8 8v560c0 4.4 3.6 8 8 8h52c4.4 0 8-3.6 8-8V548h92v172c0 4.4 3.6 8 8 8h560c4.4 0 8-3.6 8-8V548h92v244c0 4.4 3.6 8 8 8h52c4.4 0 8-3.6 8-8V232c0-4.4-3.6-8-8-8zM296 368h88v288h-88V368zm432 288H448V368h280v288z"}}]},name:"box-plot",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="BoxPlotOutlined";var R=tt.forwardRef(Z)},71938:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M740 161c-61.8 0-112 50.2-112 112 0 50.1 33.1 92.6 78.5 106.9v95.9L320 602.4V318.1c44.2-15 76-56.9 76-106.1 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 49.2 31.8 91 76 106.1V706c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-27.8l423.5-138.7a50.52 50.52 0 0034.9-48.2V378.2c42.9-15.8 73.6-57 73.6-105.2 0-61.8-50.2-112-112-112zm-504 51a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm96 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm408-491a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"branches",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="BranchesOutlined";var R=tt.forwardRef(Z)},72850:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="ClearOutlined";var R=tt.forwardRef(Z)},19671:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M624 706.3h-74.1V464c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v242.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.7a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-download",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="CloudDownloadOutlined";var R=tt.forwardRef(Z)},43587:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M704 446H320c-4.4 0-8 3.6-8 8v402c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8V454c0-4.4-3.6-8-8-8zm-328 64h272v117H376V510zm272 290H376V683h272v117z"}},{tag:"path",attrs:{d:"M424 748a32 32 0 1064 0 32 32 0 10-64 0zm0-178a32 32 0 1064 0 32 32 0 10-64 0z"}},{tag:"path",attrs:{d:"M811.4 368.9C765.6 248 648.9 162 512.2 162S258.8 247.9 213 368.8C126.9 391.5 63.5 470.2 64 563.6 64.6 668 145.6 752.9 247.6 762c4.7.4 8.7-3.3 8.7-8v-60.4c0-4-3-7.4-7-7.9-27-3.4-52.5-15.2-72.1-34.5-24-23.5-37.2-55.1-37.2-88.6 0-28 9.1-54.4 26.2-76.4 16.7-21.4 40.2-36.9 66.1-43.7l37.9-10 13.9-36.7c8.6-22.8 20.6-44.2 35.7-63.5 14.9-19.2 32.6-36 52.4-50 41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.3c19.9 14 37.5 30.8 52.4 50 15.1 19.3 27.1 40.7 35.7 63.5l13.8 36.6 37.8 10c54.2 14.4 92.1 63.7 92.1 120 0 33.6-13.2 65.1-37.2 88.6-19.5 19.2-44.9 31.1-71.9 34.5-4 .5-6.9 3.9-6.9 7.9V754c0 4.7 4.1 8.4 8.8 8 101.7-9.2 182.5-94 183.2-198.2.6-93.4-62.7-172.1-148.6-194.9z"}}]},name:"cloud-server",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="CloudServerOutlined";var R=tt.forwardRef(Z)},62298:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="CloudUploadOutlined";var R=tt.forwardRef(Z)},93695:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 256H736v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zm-200 0H360v-72h304v72z"}}]},name:"delete",theme:"filled"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="DeleteFilled";var R=tt.forwardRef(Z)},93181:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM288 604a64 64 0 10128 0 64 64 0 10-128 0zm118-224a48 48 0 1096 0 48 48 0 10-96 0zm158 228a96 96 0 10192 0 96 96 0 10-192 0zm148-314a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"dot-chart",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="DotChartOutlined";var R=tt.forwardRef(Z)},62876:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M855 160.1l-189.2 23.5c-6.6.8-9.3 8.8-4.7 13.5l54.7 54.7-153.5 153.5a8.03 8.03 0 000 11.3l45.1 45.1c3.1 3.1 8.2 3.1 11.3 0l153.6-153.6 54.7 54.7a7.94 7.94 0 0013.5-4.7L863.9 169a7.9 7.9 0 00-8.9-8.9zM416.6 562.3a8.03 8.03 0 00-11.3 0L251.8 715.9l-54.7-54.7a7.94 7.94 0 00-13.5 4.7L160.1 855c-.6 5.2 3.7 9.5 8.9 8.9l189.2-23.5c6.6-.8 9.3-8.8 4.7-13.5l-54.7-54.7 153.6-153.6c3.1-3.1 3.1-8.2 0-11.3l-45.2-45z"}}]},name:"expand-alt",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="ExpandAltOutlined";var R=tt.forwardRef(Z)},82738:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 100c-61.8 0-112 50.2-112 112 0 47.7 29.9 88.5 72 104.6v27.6L512 601.4 312 344.2v-27.6c42.1-16.1 72-56.9 72-104.6 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 50.6 33.8 93.5 80 107.3v34.4c0 9.7 3.3 19.3 9.3 27L476 672.3v33.6c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-33.6l226.7-291.6c6-7.7 9.3-17.3 9.3-27v-34.4c46.2-13.8 80-56.7 80-107.3 0-61.8-50.2-112-112-112zM224 212a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm336 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm192-552a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"fork",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="ForkOutlined";var R=tt.forwardRef(Z)},20015:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M955.7 856l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-790.4-23.9L512 231.9 858.7 832H165.3zm319-474.1l-228 394c-12.3 21.3 3.1 48 27.7 48h455.8c24.7 0 40.1-26.7 27.7-48L539.7 358c-6.2-10.7-17-16-27.7-16-10.8 0-21.6 5.3-27.7 16zm214 386H325.7L512 422l186.3 322zm-214-194.1l-57 98.4C415 669.5 430.4 696 455 696h114c24.6 0 39.9-26.5 27.7-47.7l-57-98.4c-6.1-10.6-16.9-15.9-27.7-15.9s-21.5 5.3-27.7 15.9zm57.1 98.4h-58.7l29.4-50.7 29.3 50.7z"}}]},name:"heat-map",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="HeatMapOutlined";var R=tt.forwardRef(Z)},41935:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.3 338.4a447.57 447.57 0 00-96.1-143.3 443.09 443.09 0 00-143-96.3A443.91 443.91 0 00512 64h-2c-60.5.3-119 12.3-174.1 35.9a444.08 444.08 0 00-141.7 96.5 445 445 0 00-95 142.8A449.89 449.89 0 0065 514.1c.3 69.4 16.9 138.3 47.9 199.9v152c0 25.4 20.6 46 45.9 46h151.8a447.72 447.72 0 00199.5 48h2.1c59.8 0 117.7-11.6 172.3-34.3A443.2 443.2 0 00827 830.5c41.2-40.9 73.6-88.7 96.3-142 23.5-55.2 35.5-113.9 35.8-174.5.2-60.9-11.6-120-34.8-175.6zM312.4 560c-26.4 0-47.9-21.5-47.9-48s21.5-48 47.9-48 47.9 21.5 47.9 48-21.4 48-47.9 48zm199.6 0c-26.4 0-47.9-21.5-47.9-48s21.5-48 47.9-48 47.9 21.5 47.9 48-21.5 48-47.9 48zm199.6 0c-26.4 0-47.9-21.5-47.9-48s21.5-48 47.9-48 47.9 21.5 47.9 48-21.5 48-47.9 48z"}}]},name:"message",theme:"filled"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="MessageFilled";var R=tt.forwardRef(Z)},75491:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="MessageOutlined";var R=tt.forwardRef(Z)},84387:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 708c-22.1 0-40-17.9-40-40s17.9-40 40-40 40 17.9 40 40-17.9 40-40 40zm62.9-219.5a48.3 48.3 0 00-30.9 44.8V620c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8v-21.5c0-23.1 6.7-45.9 19.9-64.9 12.9-18.6 30.9-32.8 52.1-40.9 34-13.1 56-41.6 56-72.7 0-44.1-43.1-80-96-80s-96 35.9-96 80v7.6c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V420c0-39.3 17.2-76 48.4-103.3C430.4 290.4 470 276 512 276s81.6 14.5 111.6 40.7C654.8 344 672 380.7 672 420c0 57.8-38.1 109.8-97.1 132.5z"}}]},name:"question-circle",theme:"filled"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="QuestionCircleFilled";var R=tt.forwardRef(Z)},55076:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 568a56 56 0 10112 0 56 56 0 10-112 0zm338.7 119.7c-23.1 18.2-68.9 37.8-114.7 37.8s-91.6-19.6-114.7-37.8c-14.4-11.3-35.3-8.9-46.7 5.5s-8.9 35.3 5.5 46.7C396.3 771.6 457.5 792 512 792s115.7-20.4 155.9-52.1a33.25 33.25 0 10-41.2-52.2zM960 456c0-61.9-50.1-112-112-112-42.1 0-78.7 23.2-97.9 57.6-57.6-31.5-127.7-51.8-204.1-56.5L612.9 195l127.9 36.9c11.5 32.6 42.6 56.1 79.2 56.1 46.4 0 84-37.6 84-84s-37.6-84-84-84c-32 0-59.8 17.9-74 44.2L603.5 123a33.2 33.2 0 00-39.6 18.4l-90.8 203.9c-74.5 5.2-142.9 25.4-199.2 56.2A111.94 111.94 0 00176 344c-61.9 0-112 50.1-112 112 0 45.8 27.5 85.1 66.8 102.5-7.1 21-10.8 43-10.8 65.5 0 154.6 175.5 280 392 280s392-125.4 392-280c0-22.6-3.8-44.5-10.8-65.5C932.5 541.1 960 501.8 960 456zM820 172.5a31.5 31.5 0 110 63 31.5 31.5 0 010-63zM120 456c0-30.9 25.1-56 56-56a56 56 0 0150.6 32.1c-29.3 22.2-53.5 47.8-71.5 75.9a56.23 56.23 0 01-35.1-52zm392 381.5c-179.8 0-325.5-95.6-325.5-213.5S332.2 410.5 512 410.5 837.5 506.1 837.5 624 691.8 837.5 512 837.5zM868.8 508c-17.9-28.1-42.2-53.7-71.5-75.9 9-18.9 28.3-32.1 50.6-32.1 30.9 0 56 25.1 56 56 .1 23.5-14.5 43.7-35.1 52zM624 568a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"reddit",theme:"outlined"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="RedditOutlined";var R=tt.forwardRef(Z)},90841:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return R}});var Y=$(28991),tt=$(67294),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512.5 390.6c-29.9 0-57.9 11.6-79.1 32.8-21.1 21.2-32.8 49.2-32.8 79.1 0 29.9 11.7 57.9 32.8 79.1 21.2 21.1 49.2 32.8 79.1 32.8 29.9 0 57.9-11.7 79.1-32.8 21.1-21.2 32.8-49.2 32.8-79.1 0-29.9-11.7-57.9-32.8-79.1a110.96 110.96 0 00-79.1-32.8zm412.3 235.5l-65.4-55.9c3.1-19 4.7-38.4 4.7-57.7s-1.6-38.8-4.7-57.7l65.4-55.9a32.03 32.03 0 009.3-35.2l-.9-2.6a442.5 442.5 0 00-79.6-137.7l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.2 28.9c-30-24.6-63.4-44-99.6-57.5l-15.7-84.9a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52-9.4-106.8-9.4-158.8 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.3a353.44 353.44 0 00-98.9 57.3l-81.8-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a445.93 445.93 0 00-79.6 137.7l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.2 56.5c-3.1 18.8-4.6 38-4.6 57 0 19.2 1.5 38.4 4.6 57l-66 56.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.3 44.8 96.8 79.6 137.7l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.8-29.1c29.8 24.5 63 43.9 98.9 57.3l15.8 85.3a32.05 32.05 0 0025.8 25.7l2.7.5a448.27 448.27 0 00158.8 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-84.9c36.2-13.6 69.6-32.9 99.6-57.5l81.2 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.5-87.4 79.6-137.7l.9-2.6c4.3-12.4.6-26.3-9.5-35zm-412.3 52.2c-97.1 0-175.8-78.7-175.8-175.8s78.7-175.8 175.8-175.8 175.8 78.7 175.8 175.8-78.7 175.8-175.8 175.8z"}}]},name:"setting",theme:"filled"},W=j,Q=$(27029),Z=function(C,A){return tt.createElement(Q.Z,(0,Y.Z)((0,Y.Z)({},C),{},{ref:A,icon:W}))};Z.displayName="SettingFilled";var R=tt.forwardRef(Z)},62238:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var $=function(j,W){var Q=j.nodes,Z=j.edges,R=[],L={};if(!Q)throw new Error("invalid nodes data!");return Q&&Q.forEach(function(C,A){L[C.id]=A;var N=[];R.push(N)}),Z&&Z.forEach(function(C){var A=C.source,N=C.target,B=L[A],O=L[N];!B&&B!==0||!O&&O!==0||(R[B][O]=1,W||(R[O][B]=1))}),R},Y=$;ot.default=Y},10369:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),Object.defineProperty(ot,"GADDIAsync",{enumerable:!0,get:function(){return Y.GADDIAsync}}),Object.defineProperty(ot,"connectedComponentAsync",{enumerable:!0,get:function(){return Y.connectedComponentAsync}}),ot.default=void 0,Object.defineProperty(ot,"detectAllCyclesAsync",{enumerable:!0,get:function(){return Y.detectAllCyclesAsync}}),Object.defineProperty(ot,"detectAllDirectedCycleAsync",{enumerable:!0,get:function(){return Y.detectAllDirectedCycleAsync}}),Object.defineProperty(ot,"detectAllUndirectedCycleAsync",{enumerable:!0,get:function(){return Y.detectAllUndirectedCycleAsync}}),Object.defineProperty(ot,"detectCycleAsync",{enumerable:!0,get:function(){return Y.detectCycleAsync}}),ot.detectDirectedCycleAsync=void 0,Object.defineProperty(ot,"dijkstraAsync",{enumerable:!0,get:function(){return Y.dijkstraAsync}}),Object.defineProperty(ot,"findAllPathAsync",{enumerable:!0,get:function(){return Y.findAllPathAsync}}),Object.defineProperty(ot,"findShortestPathAsync",{enumerable:!0,get:function(){return Y.findShortestPathAsync}}),Object.defineProperty(ot,"floydWarshallAsync",{enumerable:!0,get:function(){return Y.floydWarshallAsync}}),Object.defineProperty(ot,"getAdjMatrixAsync",{enumerable:!0,get:function(){return Y.getAdjMatrixAsync}}),Object.defineProperty(ot,"getDegreeAsync",{enumerable:!0,get:function(){return Y.getDegreeAsync}}),Object.defineProperty(ot,"getInDegreeAsync",{enumerable:!0,get:function(){return Y.getInDegreeAsync}}),Object.defineProperty(ot,"getNeighborsAsync",{enumerable:!0,get:function(){return Y.getNeighborsAsync}}),Object.defineProperty(ot,"getOutDegreeAsync",{enumerable:!0,get:function(){return Y.getOutDegreeAsync}}),Object.defineProperty(ot,"labelPropagationAsync",{enumerable:!0,get:function(){return Y.labelPropagationAsync}}),Object.defineProperty(ot,"louvainAsync",{enumerable:!0,get:function(){return Y.louvainAsync}}),Object.defineProperty(ot,"minimumSpanningTreeAsync",{enumerable:!0,get:function(){return Y.minimumSpanningTreeAsync}}),Object.defineProperty(ot,"pageRankAsync",{enumerable:!0,get:function(){return Y.pageRankAsync}});var Y=$(30485),tt=Y.detectCycleAsync;ot.detectDirectedCycleAsync=tt;var j={getAdjMatrixAsync:Y.getAdjMatrixAsync,connectedComponentAsync:Y.connectedComponentAsync,getDegreeAsync:Y.getDegreeAsync,getInDegreeAsync:Y.getInDegreeAsync,getOutDegreeAsync:Y.getOutDegreeAsync,detectCycleAsync:Y.detectCycleAsync,detectDirectedCycleAsync:tt,detectAllCyclesAsync:Y.detectAllCyclesAsync,detectAllDirectedCycleAsync:Y.detectAllDirectedCycleAsync,detectAllUndirectedCycleAsync:Y.detectAllUndirectedCycleAsync,dijkstraAsync:Y.dijkstraAsync,findAllPathAsync:Y.findAllPathAsync,findShortestPathAsync:Y.findShortestPathAsync,floydWarshallAsync:Y.floydWarshallAsync,labelPropagationAsync:Y.labelPropagationAsync,louvainAsync:Y.louvainAsync,minimumSpanningTreeAsync:Y.minimumSpanningTreeAsync,pageRankAsync:Y.pageRankAsync,getNeighborsAsync:Y.getNeighborsAsync,GADDIAsync:Y.GADDIAsync};ot.default=j},83764:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=j($(93026)),tt=$(70643);function j(R){return R&&R.__esModule?R:{default:R}}function W(R){R===void 0&&(R={});var L=R,C=function(){},A=function(){var N={};return function(B){var O=B.next,F=O;return N[F]?!1:(N[F]=!0,!0)}}();return L.allowTraversal=R.allowTraversal||A,L.enter=R.enter||C,L.leave=R.leave||C,L}var Q=function(L,C,A,N){N===void 0&&(N=!0);var B=W(A),O=new Y.default,F=L.edges,K=F===void 0?[]:F;O.enqueue(C);for(var nt="",P=function(){var yt=O.dequeue();B.enter({current:yt,previous:nt}),(0,tt.getNeighbors)(yt,K,N?"target":void 0).forEach(function(st){B.allowTraversal({previous:nt,current:yt,next:st})&&O.enqueue(st)}),B.leave({current:yt,previous:nt}),nt=yt};!O.isEmpty();)P()},Z=Q;ot.default=Z},59527:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=W,ot.detectStrongConnectComponents=ot.detectConnectedComponents=void 0;var Y=$(70643),tt=function(Z){for(var R=Z.nodes,L=R===void 0?[]:R,C=Z.edges,A=C===void 0?[]:C,N=[],B={},O=[],F=function k(yt){O.push(yt),B[yt.id]=!0;for(var st=(0,Y.getNeighbors)(yt.id,A),lt=function(wt){var ut=st[wt];if(!B[ut]){var pt=L.filter(function(Nt){return Nt.id===ut});pt.length>0&&k(pt[0])}},ht=0;ht<st.length;++ht)lt(ht)},K=0;K<L.length;K++){var nt=L[K];if(!B[nt.id]){F(nt);for(var P=[];O.length>0;)P.push(O.pop());N.push(P)}}return N};ot.detectConnectedComponents=tt;var j=function(Z){for(var R=Z.nodes,L=R===void 0?[]:R,C=Z.edges,A=C===void 0?[]:C,N=[],B={},O={},F={},K=[],nt=0,P=function lt(ht){O[ht.id]=nt,F[ht.id]=nt,nt+=1,N.push(ht),B[ht.id]=!0;for(var mt=(0,Y.getNeighbors)(ht.id,A,"target").filter(function(Ut){return L.map(function(ue){return ue.id}).indexOf(Ut)>-1}),wt=function(ue){var se=mt[ue];if(!O[se]&&O[se]!==0){var Le=L.filter(function(Ne){return Ne.id===se});Le.length>0&&lt(Le[0]),F[ht.id]=Math.min(F[ht.id],F[se])}else B[se]&&(F[ht.id]=Math.min(F[ht.id],O[se]))},ut=0;ut<mt.length;ut++)wt(ut);if(F[ht.id]===O[ht.id]){for(var pt=[];N.length>0;){var Nt=N.pop();if(B[Nt.id]=!1,pt.push(Nt),Nt===ht)break}pt.length>0&&K.push(pt)}},k=0,yt=L;k<yt.length;k++){var st=yt[k];!O[st.id]&&O[st.id]!==0&&P(st)}return K};ot.detectStrongConnectComponents=j;function W(Q,Z){return Z?j(Q):tt(Q)}},92935:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.secondReg=ot.dateReg=void 0;var $=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/;ot.secondReg=$;var Y=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/;ot.dateReg=Y},82556:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.getOutDegree=ot.getInDegree=ot.default=void 0;var $=function(Q){var Z={},R=Q.nodes,L=R===void 0?[]:R,C=Q.edges,A=C===void 0?[]:C;return L.forEach(function(N){Z[N.id]={degree:0,inDegree:0,outDegree:0}}),A.forEach(function(N){Z[N.source].degree++,Z[N.source].outDegree++,Z[N.target].degree++,Z[N.target].inDegree++}),Z},Y=$;ot.default=Y;var tt=function(Q,Z){var R=$(Q);return R[Z]?$(Q)[Z].inDegree:0};ot.getInDegree=tt;var j=function(Q,Z){var R=$(Q);return R[Z]?$(Q)[Z].outDegree:0};ot.getOutDegree=j},94282:function(ur,ot,$){"use strict";function Y(O){return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},Y(O)}Object.defineProperty(ot,"__esModule",{value:!0}),ot.detectAllUndirectedCycle=ot.detectAllDirectedCycle=ot.detectAllCycles=ot.default=void 0;var tt=R($(45891)),j=Z($(59527)),W=$(70643);function Q(O){if(typeof WeakMap!="function")return null;var F=new WeakMap,K=new WeakMap;return(Q=function(P){return P?K:F})(O)}function Z(O,F){if(!F&&O&&O.__esModule)return O;if(O===null||Y(O)!=="object"&&typeof O!="function")return{default:O};var K=Q(F);if(K&&K.has(O))return K.get(O);var nt={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var k in O)if(k!=="default"&&Object.prototype.hasOwnProperty.call(O,k)){var yt=P?Object.getOwnPropertyDescriptor(O,k):null;yt&&(yt.get||yt.set)?Object.defineProperty(nt,k,yt):nt[k]=O[k]}return nt.default=O,K&&K.set(O,nt),nt}function R(O){return O&&O.__esModule?O:{default:O}}var L=function(F){var K=null,nt=F.nodes,P=nt===void 0?[]:nt,k={},yt={},st={},lt={};P.forEach(function(wt){yt[wt.id]=wt});for(var ht={enter:function(ut){var pt=ut.current,Nt=ut.previous;if(st[pt]){K={};for(var Ut=pt,ue=Nt;ue!==pt;)K[Ut]=ue,Ut=ue,ue=k[ue];K[Ut]=ue}else st[pt]=pt,delete yt[pt],k[pt]=Nt},leave:function(ut){var pt=ut.current;lt[pt]=pt,delete st[pt]},allowTraversal:function(ut){var pt=ut.next;return K?!1:!lt[pt]}};Object.keys(yt).length;){var mt=Object.keys(yt)[0];(0,tt.default)(F,mt,ht)}return K},C=function(F,K,nt){var P,k;nt===void 0&&(nt=!0);for(var yt=[],st=(0,j.default)(F,!1),lt=0,ht=st;lt<ht.length;lt++){var mt=ht[lt];if(!!mt.length)for(var wt=mt[0],ut=wt.id,pt=[wt],Nt=(P={},P[ut]=wt,P),Ut=(k={},k[ut]=new Set,k);pt.length>0;)for(var ue=pt.pop(),se=ue.id,Le=(0,W.getNeighbors)(se,F.edges),Ne=function(Qt){var de,rn=Le[Qt],Ee=F.nodes.find(function(Ye){return Ye.id===rn});if(rn===se)yt.push((de={},de[rn]=ue,de));else if(!(rn in Ut))Nt[rn]=ue,pt.push(Ee),Ut[rn]=new Set([ue]);else if(!Ut[se].has(Ee)){for(var ce=!0,Oe=[Ee,ue],Ze=Nt[se];Ut[rn].size&&!Ut[rn].has(Ze)&&(Oe.push(Ze),Ze!==Nt[Ze.id]);)Ze=Nt[Ze.id];if(Oe.push(Ze),K&&nt?(ce=!1,Oe.findIndex(function(Ye){return K.indexOf(Ye.id)>-1})>-1&&(ce=!0)):K&&!nt&&Oe.findIndex(function(Ye){return K.indexOf(Ye.id)>-1})>-1&&(ce=!1),ce){for(var fe={},Ae=1;Ae<Oe.length;Ae+=1)fe[Oe[Ae-1].id]=Oe[Ae];Oe.length&&(fe[Oe[Oe.length-1].id]=Oe[0]),yt.push(fe)}Ut[rn].add(ue)}},we=0;we<Le.length;we+=1)Ne(we)}return yt};ot.detectAllUndirectedCycle=C;var A=function(F,K,nt){nt===void 0&&(nt=!0);for(var P=[],k=new Set,yt=[],st=[],lt={},ht={},mt=function(Ze){for(var fe=[Ze];fe.length>0;){var Ae=fe.pop();k.has(Ae)&&(k.delete(Ae),yt[Ae.id].forEach(function(Ye){fe.push(Ye)}),yt[Ae.id].clear())}},wt=function Oe(Ze,fe,Ae){var Ye=!1;if(K&&nt===!1&&K.indexOf(Ze.id)>-1)return Ye;P.push(Ze),k.add(Ze);for(var ge=Ae[Ze.id],Be=0;Be<ge.length;Be+=1){var te=lt[ge[Be]];if(te===fe){for(var ke={},Ve=1;Ve<P.length;Ve+=1)ke[P[Ve-1].id]=P[Ve];P.length&&(ke[P[P.length-1].id]=P[0]),st.push(ke),Ye=!0}else k.has(te)||Oe(te,fe,Ae)&&(Ye=!0)}if(Ye)mt(Ze);else for(var Be=0;Be<ge.length;Be+=1){var te=lt[ge[Be]];yt[te.id].has(Ze)||yt[te.id].add(Ze)}return P.pop(),Ye},ut=F.nodes,pt=ut===void 0?[]:ut,Nt=0;Nt<pt.length;Nt+=1){var Ut=pt[Nt],ue=Ut.id;ht[ue]=Nt,lt[Nt]=Ut}if(K&&nt)for(var se=function(Ze){var fe=K[Ze];ht[pt[Ze].id]=ht[fe],ht[fe]=0,lt[0]=pt.find(function(Ae){return Ae.id===fe}),lt[ht[pt[Ze].id]]=pt[Ze]},Nt=0;Nt<K.length;Nt++)se(Nt);for(var Le=function(Ze){for(var fe,Ae,Ye=Infinity,ge=0;ge<Ze.length;ge+=1)for(var Be=Ze[ge],te=0;te<Be.length;te++){var ke=ht[Be[te].id];ke<Ye&&(Ye=ke,Ae=ge)}for(var Ve=Ze[Ae],ee=[],ge=0;ge<Ve.length;ge+=1){var Ft=Ve[ge];ee[Ft.id]=[];for(var bt=0,Me=(0,W.getNeighbors)(Ft.id,F.edges,"target").filter(function(Rt){return Ve.map(function(Xn){return Xn.id}).indexOf(Rt)>-1});bt<Me.length;bt++){var en=Me[bt];en===Ft.id&&!(nt===!1&&K.indexOf(Ft.id)>-1)?st.push((fe={},fe[Ft.id]=Ft,fe)):ee[Ft.id].push(ht[en])}}return{component:Ve,adjList:ee,minIdx:Ye}},Ne=0;Ne<pt.length;){var we=pt.filter(function(Oe){return ht[Oe.id]>=Ne}),At=(0,j.detectStrongConnectComponents)({nodes:we,edges:F.edges}).filter(function(Oe){return Oe.length>1});if(At.length===0)break;var Qt=Le(At),de=Qt.minIdx,rn=Qt.adjList,Ee=Qt.component;if(Ee.length>1){Ee.forEach(function(Oe){yt[Oe.id]=new Set});var ce=lt[de];if(K&&nt&&K.indexOf(ce.id)===-1)return st;wt(ce,ce,rn),Ne=de+1}else break}return st};ot.detectAllDirectedCycle=A;var N=function(F,K,nt,P){return P===void 0&&(P=!0),K?A(F,nt,P):C(F,nt,P)};ot.detectAllCycles=N;var B=L;ot.default=B},45891:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=W;var Y=$(70643);function tt(Q){Q===void 0&&(Q={});var Z=Q,R=function(){},L=function(){var C={};return function(A){var N=A.next;return C[N]?!1:(C[N]=!0,!0)}}();return Z.allowTraversal=Q.allowTraversal||L,Z.enter=Q.enter||R,Z.leave=Q.leave||R,Z}function j(Q,Z,R,L){L.enter({current:Z,previous:R});var C=Q.edges,A=C===void 0?[]:C;(0,Y.getNeighbors)(Z,A,"target").forEach(function(N){L.allowTraversal({previous:R,current:Z,next:N})&&j(Q,N,Z,L)}),L.leave({current:Z,previous:R})}function W(Q,Z,R){j(Q,Z,"",tt(R))}},78089:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=$(65353),tt=$(23044),j=$(70643),W=function(C,A,N){for(var B=Infinity,O,F=0;F<A.length;F++){var K=A[F].id;!N[K]&&C[K]<=B&&(B=C[K],O=A[F])}return O},Q=function(C,A,N,B){var O=C.nodes,F=O===void 0?[]:O,K=C.edges,nt=K===void 0?[]:K,P=[],k={},yt={},st={};F.forEach(function(Nt,Ut){var ue=Nt.id;P.push(ue),yt[ue]=Infinity,ue===A&&(yt[ue]=0)});for(var lt=F.length,ht=function(Ut){var ue=W(yt,F,k),se=ue.id;if(k[se]=!0,yt[se]===Infinity)return"continue";var Le=[];N?Le=(0,j.getOutEdgesNodeId)(se,nt):Le=(0,j.getEdgesByNodeId)(se,nt),Le.forEach(function(Ne){var we=Ne.target,At=Ne.source,Qt=we===se?At:we,de=B&&Ne[B]?Ne[B]:1;yt[Qt]>yt[ue.id]+de?(yt[Qt]=yt[ue.id]+de,st[Qt]=[ue.id]):yt[Qt]===yt[ue.id]+de&&st[Qt].push(ue.id)})},mt=0;mt<lt;mt++)ht(mt);st[A]=[A];var wt={};for(var ut in yt)yt[ut]!==Infinity&&R(A,ut,st,wt);var pt={};for(var ut in wt)pt[ut]=wt[ut][0];return{length:yt,path:pt,allPath:wt}},Z=Q;ot.default=Z;function R(L,C,A,N){if(L===C)return[L];if(N[C])return N[C];for(var B=[],O=0,F=A[C];O<F.length;O++){var K=F[O],nt=R(L,K,A,N);if(!nt)return;for(var P=0,k=nt;P<k.length;P++){var yt=k[P];(0,tt.isArray)(yt)?B.push((0,Y.__spreadArray)((0,Y.__spreadArray)([],yt,!0),[C],!1)):B.push([yt,C])}}return N[C]=B,N[C]}},41727:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.findShortestPath=ot.findAllPath=void 0;var Y=j($(78089)),tt=$(70643);function j(Z){return Z&&Z.__esModule?Z:{default:Z}}var W=function(R,L,C,A,N){var B=(0,Y.default)(R,L,A,N),O=B.length,F=B.path,K=B.allPath;return{length:O[C],path:F[C],allPath:K[C]}};ot.findShortestPath=W;var Q=function(R,L,C,A){var N;if(L===C)return[[L]];var B=R.edges,O=B===void 0?[]:B,F=[L],K=(N={},N[L]=!0,N),nt=[],P=[],k=A?(0,tt.getNeighbors)(L,O,"target"):(0,tt.getNeighbors)(L,O);for(nt.push(k);F.length>0&&nt.length>0;){var yt=nt[nt.length-1];if(yt.length){var st=yt.shift();st&&(F.push(st),K[st]=!0,k=A?(0,tt.getNeighbors)(st,O,"target"):(0,tt.getNeighbors)(st,O),nt.push(k.filter(function(mt){return!K[mt]})))}else{var lt=F.pop();K[lt]=!1,nt.pop();continue}if(F[F.length-1]===C){var ht=F.map(function(wt){return wt});P.push(ht);var lt=F.pop();K[lt]=!1,nt.pop()}}return P};ot.findAllPath=Q},75033:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=tt($(62238));function tt(Q){return Q&&Q.__esModule?Q:{default:Q}}var j=function(Z,R){for(var L=(0,Y.default)(Z,R),C=[],A=L.length,N=0;N<A;N+=1){C[N]=[];for(var B=0;B<A;B+=1)N===B?C[N][B]=0:L[N][B]===0||!L[N][B]?C[N][B]=Infinity:C[N][B]=L[N][B]}for(var O=0;O<A;O+=1)for(var N=0;N<A;N+=1)for(var B=0;B<A;B+=1)C[N][B]>C[N][O]+C[O][B]&&(C[N][B]=C[N][O]+C[O][B]);return C},W=j;ot.default=W},21146:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=$(23044),tt=$(68575),j=function(){function B(O,F,K,nt,P){this.fromNode=O,this.toNode=F,this.nodeEdgeNodeLabel={nodeLabel1:K||tt.VACANT_NODE_LABEL,edgeLabel:nt||tt.VACANT_EDGE_LABEL,nodeLabel2:P||tt.VACANT_NODE_LABEL}}return B.prototype.equalTo=function(O){return this.fromNode===O.formNode&&this.toNode===O.toNode&&this.nodeEdgeNodeLabel===O.nodeEdgeNodeLabel},B.prototype.notEqualTo=function(O){return!this.equalTo(O)},B}(),W=function(){function B(){this.rmpath=[],this.dfsEdgeList=[]}return B.prototype.equalTo=function(O){var F=this.dfsEdgeList.length,K=O.length;if(F!==K)return!1;for(var nt=0;nt<F;nt++)if(this.dfsEdgeList[nt]!==O[nt])return!1;return!0},B.prototype.notEqualTo=function(O){return!this.equalTo(O)},B.prototype.pushBack=function(O,F,K,nt,P){return this.dfsEdgeList.push(new j(O,F,K,nt,P)),this.dfsEdgeList},B.prototype.toGraph=function(O,F){O===void 0&&(O=tt.VACANT_GRAPH_ID),F===void 0&&(F=!1);var K=new tt.Graph(O,!0,F);return this.dfsEdgeList.forEach(function(nt){var P=nt.fromNode,k=nt.toNode,yt=nt.nodeEdgeNodeLabel,st=yt.nodeLabel1,lt=yt.edgeLabel,ht=yt.nodeLabel2;st!==tt.VACANT_NODE_LABEL&&K.addNode(P,st),ht!==tt.VACANT_NODE_LABEL&&K.addNode(k,ht),st!==tt.VACANT_NODE_LABEL&&ht!==st&&K.addEdge(void 0,P,k,lt)}),K},B.prototype.buildRmpath=function(){this.rmpath=[];for(var O=void 0,F=this.dfsEdgeList.length,K=F-1;K>=0;K--){var nt=this.dfsEdgeList[K],P=nt.fromNode,k=nt.toNode;P<k&&(O===void 0||k===O)&&(this.rmpath.push(K),O=P)}return this.rmpath},B.prototype.getNodeNum=function(){var O={};return this.dfsEdgeList.forEach(function(F){O[F.fromNode]||(O[F.fromNode]=!0),O[F.toNode]||(O[F.toNode]=!0)}),Object.keys(O).length},B}(),Q=function(){function B(O){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],!!O){for(;O;){var F=O.edge;this.edges.push(F),this.nodesUsed[F.from]=1,this.nodesUsed[F.to]=1,this.edgesUsed[F.id]=1,O=O.preNode}this.edges=this.edges.reverse()}}return B.prototype.hasNode=function(O){return this.nodesUsed[O.id]===1},B.prototype.hasEdge=function(O){return this.edgesUsed[O.id]===1},B}(),Z=function(){function B(O){var F=O.graphs,K=O.minSupport,nt=K===void 0?2:K,P=O.minNodeNum,k=P===void 0?1:P,yt=O.maxNodeNum,st=yt===void 0?4:yt,lt=O.top,ht=lt===void 0?10:lt,mt=O.directed,wt=mt===void 0?!1:mt,ut=O.verbose,pt=ut===void 0?!1:ut;this.graphs=F,this.dfsCode=new W,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=nt,this.top=ht,this.directed=wt,this.counter=0,this.maxNodeNum=st,this.minNodeNum=k,this.verbose=pt,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return B.prototype.findForwardRootEdges=function(O,F){var K=this,nt=[],P=O.nodeMap;return F.edges.forEach(function(k){(K.directed||F.label<=P[k.to].label)&&nt.push(k)}),nt},B.prototype.findBackwardEdge=function(O,F,K,nt){if(!this.directed&&F===K)return null;for(var P=O.nodeMap,k=P[K.to],yt=k.edges,st=yt.length,lt=0;lt<st;lt++){var ht=yt[lt];if(!(nt.hasEdge(ht)||ht.to!==F.from)){if(this.directed){if(P[F.from].label<P[K.to].label||P[F.from].label===P[K.to].label&&F.label<=ht.label)return ht}else if(F.label<ht.label||F.label===ht.label&&P[F.to].label<=P[K.to].label)return ht}}return null},B.prototype.findForwardPureEdges=function(O,F,K,nt){for(var P=[],k=F.to,yt=O.nodeMap[k].edges,st=yt.length,lt=0;lt<st;lt++){var ht=yt[lt],mt=O.nodeMap[ht.to];K<=mt.label&&!nt.hasNode(mt)&&P.push(ht)}return P},B.prototype.findForwardRmpathEdges=function(O,F,K,nt){for(var P=[],k=O.nodeMap,yt=k[F.to].label,st=k[F.from],lt=st.edges,ht=lt.length,mt=0;mt<ht;mt++){var wt=lt[mt],ut=k[wt.to].label;F.to===wt.to||K>ut||nt.hasNode(k[wt.to])||(F.label<wt.label||F.label===wt.label&&yt<=ut)&&P.push(wt)}return P},B.prototype.getSupport=function(O){var F={};return O.forEach(function(K){F[K.graphId]||(F[K.graphId]=!0)}),Object.keys(F).length},B.prototype.findMinLabel=function(O){var F=void 0;return Object.keys(O).forEach(function(K){var nt=O[K],P=nt.nodeLabel1,k=nt.edgeLabel,yt=nt.nodeLabel2;if(!F){F={nodeLabel1:P,edgeLabel:k,nodeLabel2:yt};return}(P<F.nodeLabel1||P===F.nodeLabel1&&k<F.edgeLabel||P===F.nodeLabel1&&k===F.edgeLabel&&yt<F.nodeLabel2)&&(F={nodeLabel1:P,edgeLabel:k,nodeLabel2:yt})}),F},B.prototype.isMin=function(){var O=this,F=this.dfsCode;if(this.verbose&&console.log("isMin checking",F),F.dfsEdgeList.length===1)return!0;var K=this.directed,nt=F.toGraph(tt.VACANT_GRAPH_ID,K),P=nt.nodeMap,k=new W,yt={};nt.nodes.forEach(function(mt){var wt=O.findForwardRootEdges(nt,mt);wt.forEach(function(ut){var pt=P[ut.to],Nt="".concat(mt.label,"-").concat(ut.label,"-").concat(pt.label);yt[Nt]||(yt[Nt]={projected:[],nodeLabel1:mt.label,edgeLabel:ut.label,nodeLabel2:pt.label});var Ut={graphId:nt.id,edge:ut,preNode:null};yt[Nt].projected.push(Ut)})});var st=this.findMinLabel(yt);if(!!st){k.dfsEdgeList.push(new j(0,1,st.nodeLabel1,st.edgeLabel,st.nodeLabel2));var lt=function mt(wt){for(var ut=k.buildRmpath(),pt=k.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,Nt=k.dfsEdgeList[ut[0]].toNode,Ut={},ue=!1,se=0,Le=K?-1:0,Ne=function(ge){if(ue)return"break";wt.forEach(function(Be){var te=new Q(Be),ke=O.findBackwardEdge(nt,te.edges[ut[ge]],te.edges[ut[0]],te);ke&&(Ut[ke.label]||(Ut[ke.label]={projected:[],edgeLabel:ke.label}),Ut[ke.label].projected.push({graphId:nt.id,edge:Ut,preNode:Be}),se=k.dfsEdgeList[ut[ge]].fromNode,ue=!0)})},we=ut.length-1;we>Le;we--){var At=Ne(we);if(At==="break")break}if(ue){var Qt=O.findMinLabel(Ut);k.dfsEdgeList.push(new j(Nt,se,tt.VACANT_NODE_LABEL,Qt.edgeLabel,tt.VACANT_NODE_LABEL));var de=k.dfsEdgeList.length-1;return O.dfsCode.dfsEdgeList[de]!==k.dfsEdgeList[de]?!1:mt(Ut[Qt.edgeLabel].projected)}var rn={};ue=!1;var Ee=0;wt.forEach(function(Ye){var ge=new Q(Ye),Be=O.findForwardPureEdges(nt,ge.edges[ut[0]],pt,ge);Be.length>0&&(ue=!0,Ee=Nt,Be.forEach(function(te){var ke="".concat(te.label,"-").concat(P[te.to].label);rn[ke]||(rn[ke]={projected:[],edgeLabel:te.label,nodeLabel2:P[te.to].label}),rn[ke].projected.push({graphId:nt.id,edge:te,preNode:Ye})}))});for(var ce=ut.length,Oe=function(ge){if(ue)return"break";var Be=ut[ge];wt.forEach(function(te){var ke=new Q(te),Ve=O.findForwardRmpathEdges(nt,ke.edges[Be],pt,ke);Ve.length>0&&(ue=!0,Ee=k.dfsEdgeList[Be].fromNode,Ve.forEach(function(ee){var Ft="".concat(ee.label,"-").concat(P[ee.to].label);rn[Ft]||(rn[Ft]={projected:[],edgeLabel:ee.label,nodeLabel2:P[ee.to].label}),rn[Ft].projected.push({graphId:nt.id,edge:ee,preNode:te})}))})},we=0;we<ce;we++){var Ze=Oe(we);if(Ze==="break")break}if(!ue)return!0;var fe=O.findMinLabel(rn);k.dfsEdgeList.push(new j(Ee,Nt+1,tt.VACANT_NODE_LABEL,fe.edgeLabel,fe.nodeLabel2));var Ae=k.dfsEdgeList.length-1;return F.dfsEdgeList[Ae]!==k.dfsEdgeList[Ae]?!1:mt(rn["".concat(fe.edgeLabel,"-").concat(fe.nodeLabel2)].projected)},ht="".concat(st.nodeLabel1,"-").concat(st.edgeLabel,"-").concat(st.nodeLabel2);return lt(yt[ht].projected)}},B.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var O=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push((0,Y.clone)(O))}},B.prototype.subGraphMining=function(O){var F=this,K=this.getSupport(O);if(!(K<this.minSupport)&&!!this.isMin()){this.report();var nt=this.dfsCode.getNodeNum(),P=this.dfsCode.buildRmpath(),k=this.dfsCode.dfsEdgeList[P[0]].toNode,yt=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,st={},lt={};O.forEach(function(ht){for(var mt=F.graphs[ht.graphId],wt=mt.nodeMap,ut=new Q(ht),pt=P.length-1;pt>=0;pt--){var Nt=F.findBackwardEdge(mt,ut.edges[P[pt]],ut.edges[P[0]],ut);if(Nt){var Ut="".concat(F.dfsCode.dfsEdgeList[P[pt]].fromNode,"-").concat(Nt.label);lt[Ut]||(lt[Ut]={projected:[],toNodeId:F.dfsCode.dfsEdgeList[P[pt]].fromNode,edgeLabel:Nt.label}),lt[Ut].projected.push({graphId:ht.graphId,edge:Nt,preNode:ht})}}if(!(nt>=F.maxNodeNum)){var ue=F.findForwardPureEdges(mt,ut.edges[P[0]],yt,ut);ue.forEach(function(Le){var Ne="".concat(k,"-").concat(Le.label,"-").concat(wt[Le.to].label);st[Ne]||(st[Ne]={projected:[],fromNodeId:k,edgeLabel:Le.label,nodeLabel2:wt[Le.to].label}),st[Ne].projected.push({graphId:ht.graphId,edge:Le,preNode:ht})});for(var se=function(Ne){var we=F.findForwardRmpathEdges(mt,ut.edges[P[Ne]],yt,ut);we.forEach(function(At){var Qt="".concat(F.dfsCode.dfsEdgeList[P[Ne]].fromNode,"-").concat(At.label,"-").concat(wt[At.to].label);st[Qt]||(st[Qt]={projected:[],fromNodeId:F.dfsCode.dfsEdgeList[P[Ne]].fromNode,edgeLabel:At.label,nodeLabel2:wt[At.to].label}),st[Qt].projected.push({graphId:ht.graphId,edge:At,preNode:ht})})},pt=0;pt<P.length;pt++)se(pt)}}),Object.keys(lt).forEach(function(ht){var mt=lt[ht],wt=mt.toNodeId,ut=mt.edgeLabel;F.dfsCode.dfsEdgeList.push(new j(k,wt,"-1",ut,"-1")),F.subGraphMining(lt[ht].projected),F.dfsCode.dfsEdgeList.pop()}),Object.keys(st).forEach(function(ht){var mt=st[ht],wt=mt.fromNodeId,ut=mt.edgeLabel,pt=mt.nodeLabel2;F.dfsCode.dfsEdgeList.push(new j(wt,k+1,tt.VACANT_NODE_LABEL,ut,pt)),F.subGraphMining(st[ht].projected),F.dfsCode.dfsEdgeList.pop()})}},B.prototype.generate1EdgeFrequentSubGraphs=function(){var O=this.graphs,F=this.directed,K=this.minSupport,nt=this.frequentSize1Subgraphs,P={},k={},yt={},st={};return Object.keys(O).forEach(function(lt){var ht=O[lt],mt=ht.nodeMap;ht.nodes.forEach(function(wt,ut){var pt=wt.label,Nt="".concat(lt,"-").concat(pt);if(!yt[Nt]){var Ut=P[pt]||0;Ut++,P[pt]=Ut}yt[Nt]={graphKey:lt,label:pt},wt.edges.forEach(function(ue){var se=pt,Le=mt[ue.to].label;if(!F&&se>Le){var Ne=Le;Le=se,se=Ne}var we=ue.label,At="".concat(lt,"-").concat(se,"-").concat(we,"-").concat(Le),Qt="".concat(se,"-").concat(we,"-").concat(Le);if(!k[Qt]){var de=k[Qt]||0;de++,k[Qt]=de}st[At]={graphId:lt,nodeLabel1:se,edgeLabel:we,nodeLabel2:Le}})})}),Object.keys(P).forEach(function(lt){var ht=P[lt];if(!(ht<K)){var mt={nodes:[],edges:[]};mt.nodes.push({id:"0",label:lt}),nt.push(mt)}}),nt},B.prototype.run=function(){var O=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var F=this.graphs,K=this.directed,nt={};Object.keys(F).forEach(function(P){var k=F[P],yt=k.nodeMap;k.nodes.forEach(function(st){var lt=O.findForwardRootEdges(k,st);lt.forEach(function(ht){var mt=yt[ht.to],wt="".concat(st.label,"-").concat(ht.label,"-").concat(mt.label);nt[wt]||(nt[wt]={projected:[],nodeLabel1:st.label,edgeLabel:ht.label,nodeLabel2:mt.label});var ut={graphId:P,edge:ht,preNode:null};nt[wt].projected.push(ut)})})}),Object.keys(nt).forEach(function(P){var k=nt[P],yt=k.projected,st=k.nodeLabel1,lt=k.edgeLabel,ht=k.nodeLabel2;O.dfsCode.dfsEdgeList.push(new j(0,1,st,lt,ht)),O.subGraphMining(yt),O.dfsCode.dfsEdgeList.pop()})}},B}(),R=function(O,F,K,nt){var P={};return Object.keys(O).forEach(function(k,yt){var st=O[k],lt=new tt.Graph(yt,!0,F),ht={};st.nodes.forEach(function(mt,wt){lt.addNode(wt,mt[K]),ht[mt.id]=wt}),st.edges.forEach(function(mt,wt){var ut=ht[mt.source],pt=ht[mt.target];lt.addEdge(-1,ut,pt,mt[nt])}),lt&&lt.getNodeNum()&&(P[lt.id]=lt)}),P},L=function(O,F,K){var nt=[];return O.forEach(function(P){var k={nodes:[],edges:[]};P.nodes.forEach(function(yt){var st;k.nodes.push((st={id:"".concat(yt.id)},st[F]=yt.label,st))}),P.edges.forEach(function(yt){var st;k.edges.push((st={source:"".concat(yt.from),target:"".concat(yt.to)},st[K]=yt.label,st))}),nt.push(k)}),nt},C="cluster",A=function(O){var F=O.graphs,K=O.directed,nt=K===void 0?!1:K,P=O.nodeLabelProp,k=P===void 0?C:P,yt=O.edgeLabelProp,st=yt===void 0?C:yt,lt=R(F,nt,k,st),ht=O.minSupport,mt=O.maxNodeNum,wt=O.minNodeNum,ut=O.verbose,pt=O.top,Nt={graphs:lt,minSupport:ht,maxNodeNum:mt,minNodeNum:wt,top:pt,verbose:ut,directed:nt},Ut=new Z(Nt);Ut.run();var ue=L(Ut.frequentSubgraphs,k,st);return ue},N=A;ot.default=N},68575:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.VACANT_NODE_LABEL=ot.VACANT_NODE_ID=ot.VACANT_GRAPH_ID=ot.VACANT_EDGE_LABEL=ot.VACANT_EDGE_ID=ot.Node=ot.Graph=ot.Edge=ot.AUTO_EDGE_ID=void 0;var $=-1;ot.VACANT_EDGE_ID=$;var Y=-1;ot.VACANT_NODE_ID=Y;var tt="-1";ot.VACANT_EDGE_LABEL=tt;var j="-1";ot.VACANT_NODE_LABEL=j;var W=-1;ot.VACANT_GRAPH_ID=W;var Q="-1";ot.AUTO_EDGE_ID=Q;var Z=function(){function C(A,N,B,O){A===void 0&&(A=$),N===void 0&&(N=Y),B===void 0&&(B=Y),O===void 0&&(O=tt),this.id=A,this.from=N,this.to=B,this.label=O}return C}();ot.Edge=Z;var R=function(){function C(A,N){A===void 0&&(A=Y),N===void 0&&(N=j),this.id=A,this.label=N,this.edges=[],this.edgeMap={}}return C.prototype.addEdge=function(A){this.edges.push(A),this.edgeMap[A.id]=A},C}();ot.Node=R;var L=function(){function C(A,N,B){A===void 0&&(A=Y),N===void 0&&(N=!0),B===void 0&&(B=!1),this.id=A,this.edgeIdAutoIncrease=N,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=B}return C.prototype.getNodeNum=function(){return this.nodes.length},C.prototype.addNode=function(A,N){if(!this.nodeMap[A]){var B=new R(A,N);this.nodes.push(B),this.nodeMap[A]=B,this.nodeLabelMap[N]||(this.nodeLabelMap[N]=[]),this.nodeLabelMap[N].push(A)}},C.prototype.addEdge=function(A,N,B,O){if((this.edgeIdAutoIncrease||A===void 0)&&(A=this.counter++),!(this.nodeMap[N]&&this.nodeMap[B]&&this.nodeMap[B].edgeMap[A])){var F=new Z(A,N,B,O);if(this.edges.push(F),this.edgeMap[A]=F,this.nodeMap[N].addEdge(F),this.edgeLabelMap[O]||(this.edgeLabelMap[O]=[]),this.edgeLabelMap[O].push(F),!this.directed){var K=new Z(A,B,N,O);this.nodeMap[B].addEdge(K),this.edgeLabelMap[O].push(K)}}},C}();ot.Graph=L},82812:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=$(65353),tt=Z($(75033)),j=Z($(21146)),W=Z($(78089)),Q=$(70643);function Z(st){return st&&st.__esModule?st:{default:st}}var R=function(lt,ht,mt,wt){mt===void 0&&(mt="cluster"),wt===void 0&&(wt=2);var ut=[],pt=lt.nodes;return ht.forEach(function(Nt,Ut){ut.push(L(pt,Nt,Ut,mt,wt))}),ut},L=function(lt,ht,mt,wt,ut){var pt=[mt],Nt=[],Ut={};return ht.forEach(function(ue,se){if(ue<=ut&&mt!==se){pt.push(se),Nt.push(lt[se]);var Le=lt[se][wt];Ut[Le]?(Ut[Le].count++,Ut[Le].dists.push(ue)):Ut[Le]={count:1,dists:[ue]}}}),Object.keys(Ut).forEach(function(ue){Ut[ue].dists=Ut[ue].dists.sort(function(se,Le){return se-Le})}),{nodeIdx:mt,nodeId:lt[mt].id,nodeIdxs:pt,neighbors:Nt,neighborNum:pt.length-1,nodeLabelCountMap:Ut}},C=function(lt,ht,mt,wt,ut){var pt=Math.ceil(mt/ht),Nt={},Ut=0;return wt.forEach(function(ue,se){for(var Le=0,Ne=0,we=ue.nodeIdxs,At=ue.neighborNum-1;Le<pt;){for(var Qt=we[1+Math.floor(Math.random()*At)],de=0;(Nt["".concat(se,"-").concat(Qt)]||Nt["".concat(Qt,"-").concat(se)])&&(Qt=Math.floor(Math.random()*ht),de++,!(de>2*ht)););if(de<2*ht&&(Nt["".concat(se,"-").concat(Qt)]={start:se,end:Qt,distance:ut[se][Qt]},Le++,Ut++,Ut>=mt))return Nt;if(Ne++,Ne>2*ht)break}if(Le<pt){var rn=pt-Le;pt=(pt+rn)/(ht-se-1)}}),Nt},A=function(lt,ht,mt,wt){var ut=mt.nodes;return wt||(wt={}),Object.keys(lt).forEach(function(pt){var Nt,Ut;if(!(wt&&wt[pt])){wt[pt]={nodes:[],edges:[]};var ue=lt[pt],se=(Nt=ht[ue.start])===null||Nt===void 0?void 0:Nt.nodeIdxs,Le=(Ut=ht[ue.end])===null||Ut===void 0?void 0:Ut.nodeIdxs;if(!(!se||!Le)){var Ne=new Set(Le),we=se.filter(function(Ee){return Ne.has(Ee)});if(!(!we||!we.length)){for(var At={},Qt=we.length,de=0;de<Qt;de++){var rn=ut[we[de]];wt[pt].nodes.push(rn),At[rn.id]=!0}mt.edges.forEach(function(Ee){At[Ee.source]&&At[Ee.target]&&wt[pt].edges.push(Ee)})}}}}),wt},N=function(lt,ht,mt,wt){var ut,pt,Nt={};lt.nodes.forEach(function(ue){Nt[ue.id]=ue});var Ut=0;return!((ut=ht==null?void 0:ht.edges)===null||ut===void 0?void 0:ut.length)||((pt=ht==null?void 0:ht.nodes)===null||pt===void 0?void 0:pt.length)<2?0:(lt.edges.forEach(function(ue){var se=Nt[ue.source][mt],Le=Nt[ue.target][mt],Ne=ht==null?void 0:ht.nodes[0][mt],we=ht==null?void 0:ht.nodes[1][mt],At=ht==null?void 0:ht.edges[0][wt];ue[wt]===At&&(se===Ne&&Le===we||se===we&&Le===Ne)&&Ut++}),Ut)},B=function(lt,ht,mt){for(var wt=Infinity,ut=0,pt=function(ue){var se=lt[ue],Le=Object.keys(se).sort(function(Ee,ce){return se[Ee]-se[ce]}),Ne=10,we=[];Le.forEach(function(Ee,ce){we[ce%Ne]||(we[ce%Ne]={graphs:[],totalCount:0,aveCount:0}),we[ce%Ne].graphs.push(Ee),we[ce%Ne].totalCount+=se[Ee]});var At=0,Qt=[];we.forEach(function(Ee){var ce=Ee.totalCount/Ee.graphs.length;Ee.aveCount=ce,Qt.push(ce);var Oe=0,Ze=Ee.length;Ee.graphs.forEach(function(fe,Ae){var Ye=se[fe];Ee.graphs.forEach(function(ge,Be){Ae!==Be&&(Oe+=Math.abs(Ye-se[ge]))})}),Oe/=Ze*(Ze-1)/2,At+=Oe}),At/=we.length;var de=0;Qt.forEach(function(Ee,ce){Qt.forEach(function(Oe,Ze){ce!==Ze&&(de+=Math.abs(Ee-Oe))}),de/=Qt.length*(Qt.length-1)/2});var rn=de-At;wt<rn&&(wt=rn,ut=ue)},Nt=0;Nt<ht;Nt++)pt(Nt);return{structure:mt[ut],structureCountMap:lt[ut]}},O=function(lt,ht){var mt={},wt={};return lt.forEach(function(ut,pt){mt[ut.id]={idx:pt,node:ut,degree:0,inDegree:0,outDegree:0};var Nt=ut[ht];wt[Nt]||(wt[Nt]=[]),wt[Nt].push(ut)}),{nodeMap:mt,nodeLabelMap:wt}},F=function(lt,ht,mt){var wt={},ut={};return lt.forEach(function(pt,Nt){wt["".concat(Q.uniqueId)]={idx:Nt,edge:pt};var Ut=pt[ht];ut[Ut]||(ut[Ut]=[]),ut[Ut].push(pt);var ue=mt[pt.source];ue&&(ue.degree++,ue.outDegree++);var se=mt[pt.target];se&&(se.degree++,se.inDegree++)}),{edgeMap:wt,edgeLabelMap:ut}},K=function(lt,ht,mt){var wt=ht.length,ut={};return ht.forEach(function(pt,Nt){for(var Ut=mt?0:Nt+1,ue=lt[Nt].id,se=Ut;se<wt;se++)if(Nt!==se){var Le=lt[se].id,Ne=pt[se];ut["".concat(ue,"-").concat(Le)]=Ne,mt||(ut["".concat(Le,"-").concat(ue)]=Ne)}}),ut},nt=function(lt,ht,mt,wt,ut,pt,Nt,Ut,ue,se,Le){var Ne,we="".concat(ht.id,"-").concat(mt.id);if(se&&se[we])return se[we];var At=Le?Le[we]:void 0;if(!At){var Qt=(Ne={},Ne[we]={start:wt[ht.id].idx,end:wt[mt.id].idx,distance:ut},Ne);Le=A(Qt,pt,lt,Le),At=Le[we]}return N(At,Nt,Ut,ue)},P=function(lt,ht,mt,wt){var ut,pt,Nt,Ut=(ut=lt[ht])===null||ut===void 0?void 0:ut.degree,ue=(pt=lt[ht])===null||pt===void 0?void 0:pt.inDegree,se=(Nt=lt[ht])===null||Nt===void 0?void 0:Nt.outDegree;return lt[ht]===void 0&&(Ut=Infinity,ue=Infinity,se=Infinity,wt[ht].forEach(function(Le){var Ne=mt[Le.id].degree;Ut>Ne&&(Ut=Ne);var we=mt[Le.id].inDegree;ue>we&&(ue=we);var At=mt[Le.id].outDegree;se>At&&(se=At)}),lt[ht]={degree:Ut,inDegree:ue,outDegree:se}),{minPatternNodeLabelDegree:Ut,minPatternNodeLabelInDegree:ue,minPatternNodeLabelOutDegree:se}},k=function(lt,ht,mt,wt,ut,pt,Nt){var Ut;if(mt===void 0&&(mt=!1),pt===void 0&&(pt="cluster"),Nt===void 0&&(Nt="cluster"),!(!lt||!lt.nodes)){var ue=lt.nodes.length;if(!!ue){var se=(0,tt.default)(lt,mt),Le=(0,tt.default)(ht,mt),Ne=K(lt.nodes,se,mt),we=K(ht.nodes,Le,mt),At=O(lt.nodes,pt),Qt=At.nodeMap,de=At.nodeLabelMap,rn=O(ht.nodes,pt),Ee=rn.nodeMap,ce=rn.nodeLabelMap;F(lt.edges,Nt,Qt);var Oe=F(ht.edges,Nt,Ee).edgeLabelMap,Ze=[];Le==null||Le.forEach(function(pr){Ze=Ze.concat(pr)}),ut||(ut=Math.max.apply(Math,(0,Y.__spreadArray)((0,Y.__spreadArray)([],Ze,!1),[2],!1))),wt||(wt=ut);var fe=R(lt,se,pt,wt),Ae=R(ht,Le,pt,wt),Ye=Math.min(100,ue*(ue-1)/2),ge=C(wt,ue,Ye,fe,se),Be=A(ge,fe,lt),te=10,ke=1,Ve=1,ee=4,Ft={graphs:Be,nodeLabelProp:pt,edgeLabelProp:Nt,minSupport:ke,minNodeNum:Ve,maxNodeNum:ee,directed:mt},bt=(0,j.default)(Ft).slice(0,te),Me=bt.length,en=[];bt.forEach(function(pr,qr){en[qr]={},Object.keys(Be).forEach(function(ua){var $r=Be[ua],ba=N($r,pr,pt,Nt);en[qr][ua]=ba})});var fn=B(en,Me,bt),Rt=fn.structure,Xn=fn.structureCountMap,Bn=ht.nodes[0],xr=[],dr=(Ut=ht.nodes[0])===null||Ut===void 0?void 0:Ut[pt],Ur=-Infinity;ht.nodes.forEach(function(pr){var qr=pr[pt],ua=de[qr];(ua==null?void 0:ua.length)>Ur&&(Ur=ua.length,xr=ua,dr=qr,Bn=pr)});var fa={},Ea={},aa={},Da={},Lr={},_n={};Object.keys(ce).forEach(function(pr,qr){Lr[pr]=[],mt&&(_n[pr]=[]);var ua=-Infinity,$r=ce[pr],ba={};$r.forEach(function(Ot){var it=we["".concat(Bn.id,"-").concat(Ot.id)];if(it&&Lr[pr].push(it),ua<it&&(ua=it),ba["".concat(Bn.id,"-").concat(Ot.id)]={start:0,end:Ee[Ot.id].idx,distance:it},mt){var H=we["".concat(Ot.id,"-").concat(Bn.id)];H&&_n[pr].push(H)}}),Lr[pr]=Lr[pr].sort(function(Ot,it){return Ot-it}),mt&&(_n[pr]=_n[pr].sort(function(Ot,it){return Ot-it})),Ea=A(ba,Ae,ht,Ea);var gt=[];if(Object.keys(ba).forEach(function(Ot){if(aa[Ot]){gt.push(aa[Ot]);return}var it=Ea[Ot];aa[Ot]=N(it,Rt,pt,Nt),gt.push(aa[Ot])}),gt=gt.sort(function(Ot,it){return it-Ot}),Da["".concat(Bn.id,"-").concat(pr)]=gt,pr!==dr)for(var Dn=(xr==null?void 0:xr.length)||0,un=function(it){var H=xr[it],X=fe[Qt[H.id].idx],xt=X.nodeLabelCountMap[pr],zt=ce[pr].length;if(!xt||xt.count<zt)return xr.splice(it,1),"continue";for(var Vt=!1,Xt=0;Xt<zt;Xt++)if(xt.dists[Xt]>Lr[pr][Xt]){Vt=!0;break}if(Vt)return xr.splice(it,1),"continue";var ne={};X.neighbors.forEach(function(He){var Qn=Ne["".concat(H.id,"-").concat(He.id)];ne["".concat(H.id,"-").concat(He.id)]={start:Qt[H.id].idx,end:Qt[He.id].idx,distance:Qn}}),Be=A(ne,fe,lt,Be);var on=[];Object.keys(ne).forEach(function(He){if(Xn[He]){on.push(Xn[He]);return}var Qn=Be[He];Xn[He]=N(Qn,Rt,pt,Nt),on.push(Xn[He])}),on=on.sort(function(He,Qn){return Qn-He});for(var tn=!1,Xt=0;Xt<zt;Xt++)if(on[Xt]<gt[Xt]){tn=!0;break}if(tn)return xr.splice(it,1),"continue"},Lt=Dn-1;Lt>=0;Lt--)un(Lt)});var sr=[];xr==null||xr.forEach(function(pr){for(var qr=Qt[pr.id].idx,ua=L(lt.nodes,se[qr],qr,pt,ut),$r=ua.neighbors,ba=$r.length,gt=!1,Dn=ba-1;Dn>=0;Dn--){if($r.length+1<ht.nodes.length){gt=!0;return}var un=$r[Dn],Lt=un[pt];if(!ce[Lt]||!ce[Lt].length){$r.splice(Dn,1);continue}if(!Lr[Lt]||!Lr[Lt].length){$r.splice(Dn,1);continue}var Ot="".concat(pr.id,"-").concat(un.id),it=Ne[Ot],H=Lr[Lt].length-1,X=Lr[Lt][H];if(it>X){$r.splice(Dn,1);continue}if(mt){var xt="".concat(un.id,"-").concat(pr.id),zt=Ne[xt];H=_n[Lt].length-1;var Vt=_n[Lt][H];if(zt>Vt){$r.splice(Dn,1);continue}}var Xt=Xn[Ot]?Xn[Ot]:nt(lt,pr,un,Qt,it,fe,Rt,pt,Nt,Xn,Be),ne="".concat(Bn.id,"-").concat(Lt),on=Da[ne][Da[ne].length-1];if(Xt<on){$r.splice(Dn,1);continue}var tn=P(fa,Lt,Ee,ce),He=tn.minPatternNodeLabelDegree,Qn=tn.minPatternNodeLabelInDegree,Ln=tn.minPatternNodeLabelOutDegree;if(Qt[un.id].degree<He){$r.splice(Dn,1);continue}}gt||sr.push({nodes:[pr].concat($r)})});var Pn=(0,W.default)(ht,Bn.id,!1).length,tr={};mt?(Object.keys(Pn).forEach(function(pr){var qr=Ee[pr].node[pt];tr[qr]?tr[qr].push(Pn[pr]):tr[qr]=[Pn[pr]]}),Object.keys(tr).forEach(function(pr){tr[pr].sort(function(qr,ua){return qr-ua})})):tr=Lr;for(var zn=sr.length,Wr=function(qr){var ua=sr[qr],$r=ua.nodes[0],ba={},gt={};ua.nodes.forEach(function(Ra,ln){gt[Ra.id]={idx:ln,node:Ra,degree:0,inDegree:0,outDegree:0};var De=Ra[pt];ba[De]?ba[De]++:ba[De]=1});var Dn=[],un={};lt.edges.forEach(function(Ra){gt[Ra.source]&&gt[Ra.target]&&(Dn.push(Ra),un[Ra[Nt]]?un[Ra[Nt]]++:un[Ra[Nt]]=1,gt[Ra.source].degree++,gt[Ra.target].degree++,gt[Ra.source].outDegree++,gt[Ra.target].inDegree++)});for(var Lt=Object.keys(Oe).length,Ot=!1,it=0;it<Lt;it++){var H=Object.keys(Oe)[it];if(!un[H]||un[H]<Oe[H].length){Ot=!0;break}}if(Ot)return sr.splice(qr,1),"continue";var X=Dn.length;if(X<ht.edges.length)return sr.splice(qr,1),"break";for(var xt=!1,zt=function(ln){var De=Dn[ln],dn=De[Nt],Wn=Oe[dn];if(!Wn||!Wn.length)return un[dn]--,Wn&&un[dn]<Wn.length?(xt=!0,"break"):(Dn.splice(ln,1),gt[De.source].degree--,gt[De.target].degree--,gt[De.source].outDegree--,gt[De.target].inDegree--,"continue");var Gn=gt[De.source].node[pt],Kn=gt[De.target].node[pt],Rr=!1;if(Wn.forEach(function(xa){var La=Ee[xa.source].node,ui=Ee[xa.target].node;La[pt]===Gn&&ui[pt]===Kn&&(Rr=!0),!mt&&La[pt]===Kn&&ui[pt]===Gn&&(Rr=!0)}),!Rr)return un[dn]--,Wn&&un[dn]<Wn.length?(xt=!0,"break"):(Dn.splice(ln,1),gt[De.source].degree--,gt[De.target].degree--,gt[De.source].outDegree--,gt[De.target].inDegree--,"continue")},it=X-1;it>=0;it--){var Vt=zt(it);if(Vt==="break")break}if(xt)return sr.splice(qr,1),"continue";ua.edges=Dn;var Xt=(0,W.default)(ua,ua.nodes[0].id,!1).length;if(Object.keys(Xt).reverse().forEach(function(Ra){if(!(Ra===ua.nodes[0].id||xt)){if(Xt[Ra]===Infinity){var ln=gt[Ra].node[pt];if(ba[ln]--,ba[ln]<ce[ln].length){xt=!0;return}var De=ua.nodes.indexOf(gt[Ra].node);ua.nodes.splice(De,1),gt[Ra]=void 0;return}var dn=Qt[Ra].node[pt];if(!tr[dn]||!tr[dn].length||Xt[Ra]>tr[dn][tr[dn].length-1]){var ln=gt[Ra].node[pt];if(ba[ln]--,ba[ln]<ce[ln].length){xt=!0;return}var De=ua.nodes.indexOf(gt[Ra].node);ua.nodes.splice(De,1),gt[Ra]=void 0}}}),xt)return sr.splice(qr,1),"continue";for(var ne=!0,on=0;ne&&!xt;){ne=!1;var tn=mt?gt[$r.id].degree<Ee[Bn.id].degree||gt[$r.id].inDegree<Ee[Bn.id].inDegree||gt[$r.id].outDegree<Ee[Bn.id].outDegree:gt[$r.id].degree<Ee[Bn.id].degree;if(tn){xt=!0;break}if(ba[$r[pt]]<ce[$r[pt]].length){xt=!0;break}for(var He=ua.nodes.length,Qn=He-1;Qn>=0;Qn--){var Ln=ua.nodes[Qn],Qr=gt[Ln.id].degree,Ia=gt[Ln.id].inDegree,Jn=gt[Ln.id].outDegree,Ar=Ln[pt],na=P(fa,Ar,Ee,ce),za=na.minPatternNodeLabelDegree,da=na.minPatternNodeLabelInDegree,Ti=na.minPatternNodeLabelOutDegree,ki=mt?Qr<za||Ia<da||Jn<Ti:Qr<za;if(ki){if(ba[Ln[pt]]--,ba[Ln[pt]]<ce[Ln[pt]].length){xt=!0;break}ua.nodes.splice(Qn,1),gt[Ln.id]=void 0,ne=!0}}if(xt||!ne&&on!==0)break;X=Dn.length;for(var vi=X-1;vi>=0;vi--){var ii=Dn[vi];if(!gt[ii.source]||!gt[ii.target]){Dn.splice(vi,1);var Di=ii[Nt];if(un[Di]--,gt[ii.source]&&(gt[ii.source].degree--,gt[ii.source].outDegree--),gt[ii.target]&&(gt[ii.target].degree--,gt[ii.target].inDegree--),Oe[Di]&&un[Di]<Oe[Di].length){xt=!0;break}ne=!0}}on++}if(xt||xt||ua.nodes.length<ht.nodes.length||Dn.length<ht.edges.length)return sr.splice(qr,1),"continue"},Yr=zn-1;Yr>=0;Yr--){var nr=Wr(Yr);if(nr==="break")break}for(var wr=sr.length,Sr=function(qr){var ua=sr[qr],$r={};ua.edges.forEach(function(Dn){var un="".concat(Dn.source,"-").concat(Dn.target,"-").concat(Dn.label);$r[un]?$r[un]++:$r[un]=1});for(var ba=function(un){var Lt=sr[un],Ot={};Lt.edges.forEach(function(H){var X="".concat(H.source,"-").concat(H.target,"-").concat(H.label);Ot[X]?Ot[X]++:Ot[X]=1});var it=!0;Object.keys(Ot).length!==Object.keys($r).length?it=!1:Object.keys($r).forEach(function(H){Ot[H]!==$r[H]&&(it=!1)}),it&&sr.splice(un,1)},gt=wr-1;gt>qr;gt--)ba(gt);wr=sr.length},Yr=0;Yr<=wr-1;Yr++)Sr(Yr);return sr}}},yt=k;ot.default=yt},5170:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=j($(62238)),tt=$(70643);function j(Z){return Z&&Z.__esModule?Z:{default:Z}}var W=function(R,L,C,A){L===void 0&&(L=!1),C===void 0&&(C="weight"),A===void 0&&(A=1e3);var N=R.nodes,B=N===void 0?[]:N,O=R.edges,F=O===void 0?[]:O,K={},nt={};B.forEach(function(pt,Nt){var Ut=(0,tt.uniqueId)();pt.clusterId=Ut,K[Ut]={id:Ut,nodes:[pt]},nt[pt.id]={node:pt,idx:Nt}});var P=(0,Y.default)(R,L),k=[],yt={};P.forEach(function(pt,Nt){var Ut=0,ue=B[Nt].id;yt[ue]={},pt.forEach(function(se,Le){if(!!se){Ut+=se;var Ne=B[Le].id;yt[ue][Ne]=se}}),k.push(Ut)});for(var st=0,lt=function(){var Nt=!1;if(B.forEach(function(Ut){var ue={};Object.keys(yt[Ut.id]).forEach(function(rn){var Ee=yt[Ut.id][rn],ce=nt[rn].node,Oe=ce.clusterId;ue[Oe]||(ue[Oe]=0),ue[Oe]+=Ee});var se=-Infinity,Le=[];if(Object.keys(ue).forEach(function(rn){se<ue[rn]?(se=ue[rn],Le=[rn]):se===ue[rn]&&Le.push(rn)}),!(Le.length===1&&Le[0]===Ut.clusterId)){var Ne=Le.indexOf(Ut.clusterId);if(Ne>=0&&Le.splice(Ne,1),Le&&Le.length){Nt=!0;var we=K[Ut.clusterId],At=we.nodes.indexOf(Ut);we.nodes.splice(At,1);var Qt=Math.floor(Math.random()*Le.length),de=K[Le[Qt]];de.nodes.push(Ut),Ut.clusterId=de.id}}}),!Nt)return"break";st++};st<A;){var ht=lt();if(ht==="break")break}Object.keys(K).forEach(function(pt){var Nt=K[pt];(!Nt.nodes||!Nt.nodes.length)&&delete K[pt]});var mt=[],wt={};F.forEach(function(pt){var Nt=pt.source,Ut=pt.target,ue=pt[C]||1,se=nt[Nt].node.clusterId,Le=nt[Ut].node.clusterId,Ne="".concat(se,"---").concat(Le);if(wt[Ne])wt[Ne].weight+=ue,wt[Ne].count++;else{var we={source:se,target:Le,weight:ue,count:1};wt[Ne]=we,mt.push(we)}});var ut=[];return Object.keys(K).forEach(function(pt){ut.push(K[pt])}),{clusters:ut,clusterEdges:mt}},Q=W;ot.default=Q},57363:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=$(23044),tt=Z($(62238)),j=Z($(29741)),W=$(3665),Q=$(26838);function Z(N){return N&&N.__esModule?N:{default:N}}var R=function(B,O,F,K){for(var nt=O.length,P=2*K,k=0,yt=0;yt<nt;yt++)for(var st=B[yt].clusterId,lt=0;lt<nt;lt++){var ht=B[lt].clusterId;if(st===ht){var mt=O[yt][lt]||0,wt=F[yt]||0,ut=F[lt]||0;k+=mt-wt*ut/P}}return k*=1/P,k},L=function(B,O){B===void 0&&(B=[]);for(var F=B.length,K=new j.default([]),nt=0;nt<F;nt++)K=K.add(new j.default(O[nt]));var P=K.avg(F);P.normalize();for(var k=0,nt=0;nt<F;nt++){var yt=new j.default(O[nt]),st=yt.squareEuclideanDistance(P);k+=st}var lt=[];B.forEach(function(){lt.push([])});for(var nt=0;nt<F;nt++){var yt=new j.default(O[nt]);B[nt].clusterInertial=0;for(var ht=0;ht<F;ht++){if(nt===ht){lt[nt][ht]=0;continue}var mt=new j.default(O[ht]);lt[nt][ht]=yt.squareEuclideanDistance(mt),B[nt].clusterInertial+=lt[nt][ht]}}for(var wt=0,ut=2*F*k,nt=0;nt<F;nt++)for(var pt=B[nt].clusterId,ht=0;ht<F;ht++){var Nt=B[ht].clusterId;if(!(nt===ht||pt!==Nt)){var Ut=B[nt].clusterInertial*B[ht].clusterInertial/Math.pow(ut,2)-lt[nt][ht]/ut;wt+=Ut}}return Number(wt.toFixed(4))},C=function(B,O,F,K,nt,P,k,yt,st){O===void 0&&(O=!1),F===void 0&&(F="weight"),K===void 0&&(K=1e-4),nt===void 0&&(nt=!1),P===void 0&&(P=void 0),k===void 0&&(k=[]),yt===void 0&&(yt=["id"]),st===void 0&&(st=1);var lt=B.nodes,ht=lt===void 0?[]:lt,mt=B.edges,wt=mt===void 0?[]:mt,ut=[];if(nt){ht.forEach(function(Be,te){Be.properties=Be.properties||{},Be.originIndex=te});var pt=[];ht.every(function(Be){return Be.hasOwnProperty("nodeType")})&&(pt=Array.from(new Set(ht.map(function(Be){return Be.nodeType}))),ht.forEach(function(Be){Be.properties.nodeType=pt.findIndex(function(te){return te===Be.nodeType})}));var Nt=(0,W.getAllProperties)(ht,P);ut=(0,Q.oneHot)(Nt,k,yt)}var Ut=1,ue={},se={};ht.forEach(function(Be,te){var ke=String(Ut++);Be.clusterId=ke,ue[ke]={id:ke,nodes:[Be]},se[Be.id]={node:Be,idx:te}});var Le=(0,tt.default)(B,O),Ne=[],we={},At=0;Le.forEach(function(Be,te){var ke=0,Ve=ht[te].id;we[Ve]={},Be.forEach(function(ee,Ft){if(!!ee){ke+=ee;var bt=ht[Ft].id;we[Ve][bt]=ee,At+=ee}}),Ne.push(ke)}),At/=2;for(var Qt=Infinity,de=Infinity,rn=0,Ee=[],ce={};;){nt&&ht.every(function(Be){return Be.hasOwnProperty("properties")})?Qt=R(ht,Le,Ne,At)+L(ht,ut)*st:Qt=R(ht,Le,Ne,At),rn===0&&(de=Qt,Ee=ht,ce=ue);var Oe=Qt>0&&Qt>de&&Qt-de<K;if(Qt>de&&(Ee=ht.map(function(Be){return{node:Be,clusterId:Be.clusterId}}),ce=(0,Y.clone)(ue),de=Qt),Oe||rn>100)break;rn++,Object.keys(ue).forEach(function(Be){var te=0;wt.forEach(function(ke){var Ve=ke.source,ee=ke.target,Ft=se[Ve].node.clusterId,bt=se[ee].node.clusterId;(Ft===Be&&bt!==Be||bt===Be&&Ft!==Be)&&(te=te+(ke[F]||1))}),ue[Be].sumTot=te}),ht.forEach(function(Be,te){var ke=ue[Be.clusterId],Ve=0,ee,Ft=Ne[te]/(2*At),bt=0,Me=ke.nodes;Me.forEach(function(Ea){var aa=se[Ea.id].idx;bt+=Le[te][aa]||0});var en=bt-ke.sumTot*Ft,fn=Me.filter(function(Ea){return Ea.id!==Be.id}),Rt=[];fn.forEach(function(Ea,aa){Rt[aa]=ut[Ea.originIndex]});var Xn=L(fn,ut)*st,Bn=we[Be.id];if(Object.keys(Bn).forEach(function(Ea){var aa=se[Ea].node,Da=aa.clusterId;if(Da!==Be.clusterId){var Lr=ue[Da],_n=Lr.nodes;if(!(!_n||!_n.length)){var sr=0;_n.forEach(function(nr){var wr=se[nr.id].idx;sr+=Le[te][wr]||0});var Pn=sr-Lr.sumTot*Ft,tr=_n.concat([Be]),zn=[];tr.forEach(function(nr,wr){zn[wr]=ut[nr.originIndex]});var Wr=L(tr,ut)*st,Yr=Pn-en;nt&&(Yr=Pn+Wr-(en+Xn)),Yr>Ve&&(Ve=Yr,ee=Lr)}}}),Ve>0){ee.nodes.push(Be);var xr=Be.clusterId;Be.clusterId=ee.id;var dr=ke.nodes.indexOf(Be);ke.nodes.splice(dr,1);var Ur=0,fa=0;wt.forEach(function(Ea){var aa=Ea.source,Da=Ea.target,Lr=se[aa].node.clusterId,_n=se[Da].node.clusterId;(Lr===ee.id&&_n!==ee.id||_n===ee.id&&Lr!==ee.id)&&(Ur=Ur+(Ea[F]||1)),(Lr===xr&&_n!==xr||_n===xr&&Lr!==xr)&&(fa=fa+(Ea[F]||1))}),ee.sumTot=Ur,ke.sumTot=fa}})}var Ze={},fe=0;Object.keys(ce).forEach(function(Be){var te=ce[Be];if(!te.nodes||!te.nodes.length){delete ce[Be];return}var ke=String(fe+1);ke!==Be&&(te.id=ke,te.nodes=te.nodes.map(function(Ve){return{id:Ve.id,clusterId:ke}}),ce[ke]=te,Ze[Be]=ke,delete ce[Be],fe++)}),Ee.forEach(function(Be){var te=Be.node,ke=Be.clusterId;!te||(te.clusterId=ke,te.clusterId&&Ze[te.clusterId]&&(te.clusterId=Ze[te.clusterId]))});var Ae=[],Ye={};wt.forEach(function(Be){var te=Be.source,ke=Be.target,Ve=Be[F]||1,ee=se[te].node.clusterId,Ft=se[ke].node.clusterId;if(!(!ee||!Ft)){var bt="".concat(ee,"---").concat(Ft);if(Ye[bt])Ye[bt].weight+=Ve,Ye[bt].count++;else{var Me={source:ee,target:Ft,weight:Ve,count:1};Ye[bt]=Me,Ae.push(Me)}}});var ge=[];return Object.keys(ce).forEach(function(Be){ge.push(ce[Be])}),{clusters:ge,clusterEdges:Ae}},A=C;ot.default=A},89454:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=W($(38823)),tt=W($(57085)),j=$(70643);function W(C){return C&&C.__esModule?C:{default:C}}var Q=function(A,N){var B=[],O=A.nodes,F=O===void 0?[]:O,K=A.edges,nt=K===void 0?[]:K;if(F.length===0)return B;var P=F[0],k=new Set;k.add(P);var yt=function(ut,pt){return N?ut.weight-pt.weight:0},st=new tt.default(yt);for((0,j.getEdgesByNodeId)(P.id,nt).forEach(function(wt){st.insert(wt)});!st.isEmpty();){var lt=st.delMin(),ht=lt.source,mt=lt.target;k.has(ht)&&k.has(mt)||(B.push(lt),k.has(ht)||(k.add(ht),(0,j.getEdgesByNodeId)(ht,nt).forEach(function(wt){st.insert(wt)})),k.has(mt)||(k.add(mt),(0,j.getEdgesByNodeId)(mt,nt).forEach(function(wt){st.insert(wt)})))}return B},Z=function(A,N){var B=[],O=A.nodes,F=O===void 0?[]:O,K=A.edges,nt=K===void 0?[]:K;if(F.length===0)return B;var P=nt.map(function(ht){return ht});N&&P.sort(function(ht,mt){return ht.weight-mt.weight});for(var k=new Y.default(F.map(function(ht){return ht.id}));P.length>0;){var yt=P.shift(),st=yt.source,lt=yt.target;k.connected(st,lt)||(B.push(yt),k.union(st,lt))}return B},R=function(A,N,B){var O={prim:Q,kruskal:Z};return B?O[B](A,N):Z(A,N)},L=R;ot.default=L},74926:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=j($(82556)),tt=$(70643);function j(Z){return Z&&Z.__esModule?Z:{default:Z}}var W=function(R,L,C){typeof L!="number"&&(L=1e-6),typeof C!="number"&&(C=.85);for(var A=1,N=0,B=1e3,O=R.nodes,F=O===void 0?[]:O,K=R.edges,nt=K===void 0?[]:K,P=F.length,k,yt={},st={},lt=0;lt<P;++lt){var ht=F[lt],mt=ht.id;yt[mt]=1/P,st[mt]=1/P}for(var wt=(0,Y.default)(R);B>0&&A>L;){N=0;for(var lt=0;lt<P;++lt){var ht=F[lt],mt=ht.id;if(k=0,wt[ht.id].inDegree===0)yt[mt]=0;else{for(var ut=(0,tt.getNeighbors)(mt,nt,"source"),pt=0;pt<ut.length;++pt){var Nt=ut[pt],Ut=wt[Nt].outDegree;Ut>0&&(k+=st[Nt]/Ut)}yt[mt]=C*k,N+=yt[mt]}}N=(1-N)/P,A=0;for(var lt=0;lt<P;++lt){var ht=F[lt],mt=ht.id;k=yt[mt]+N,A+=Math.abs(k-st[mt]),st[mt]=k}B-=1}return st},Q=W;ot.default=Q},57085:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var $=function(W,Q){return W-Q},Y=function(){function j(W){W===void 0&&(W=$),this.compareFn=W,this.list=[]}return j.prototype.getLeft=function(W){return 2*W+1},j.prototype.getRight=function(W){return 2*W+2},j.prototype.getParent=function(W){return W===0?null:Math.floor((W-1)/2)},j.prototype.isEmpty=function(){return this.list.length<=0},j.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},j.prototype.delMin=function(){var W=this.top(),Q=this.list.pop();return this.list.length>0&&(this.list[0]=Q,this.moveDown(0)),W},j.prototype.insert=function(W){if(W!==null){this.list.push(W);var Q=this.list.length-1;return this.moveUp(Q),!0}return!1},j.prototype.moveUp=function(W){for(var Q=this.getParent(W);W&&W>0&&this.compareFn(this.list[Q],this.list[W])>0;){var Z=this.list[Q];this.list[Q]=this.list[W],this.list[W]=Z,W=Q,Q=this.getParent(W)}},j.prototype.moveDown=function(W){var Q,Z=W,R=this.getLeft(W),L=this.getRight(W),C=this.list.length;R!==null&&R<C&&this.compareFn(this.list[Z],this.list[R])>0?Z=R:L!==null&&L<C&&this.compareFn(this.list[Z],this.list[L])>0&&(Z=L),W!==Z&&(Q=[this.list[Z],this.list[W]],this.list[W]=Q[0],this.list[Z]=Q[1],this.moveDown(Z))},j}(),tt=Y;ot.default=tt},88481:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=ot.LinkedListNode=void 0;var $=function(Q,Z){return Q===Z},Y=function(){function W(Q,Z){Z===void 0&&(Z=null),this.value=Q,this.next=Z}return W.prototype.toString=function(Q){return Q?Q(this.value):"".concat(this.value)},W}();ot.LinkedListNode=Y;var tt=function(){function W(Q){Q===void 0&&(Q=$),this.head=null,this.tail=null,this.compare=Q}return W.prototype.prepend=function(Q){var Z=new Y(Q,this.head);return this.head=Z,this.tail||(this.tail=Z),this},W.prototype.append=function(Q){var Z=new Y(Q);return this.head?(this.tail.next=Z,this.tail=Z,this):(this.head=Z,this.tail=Z,this)},W.prototype.delete=function(Q){if(!this.head)return null;for(var Z=null;this.head&&this.compare(this.head.value,Q);)Z=this.head,this.head=this.head.next;var R=this.head;if(R!==null)for(;R.next;)this.compare(R.next.value,Q)?(Z=R.next,R.next=R.next.next):R=R.next;return this.compare(this.tail.value,Q)&&(this.tail=R),Z},W.prototype.find=function(Q){var Z=Q.value,R=Z===void 0?void 0:Z,L=Q.callback,C=L===void 0?void 0:L;if(!this.head)return null;for(var A=this.head;A;){if(C&&C(A.value)||R!==void 0&&this.compare(A.value,R))return A;A=A.next}return null},W.prototype.deleteTail=function(){var Q=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,Q;for(var Z=this.head;Z.next;)Z.next.next?Z=Z.next:Z.next=null;return this.tail=Z,Q},W.prototype.deleteHead=function(){if(!this.head)return null;var Q=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),Q},W.prototype.fromArray=function(Q){var Z=this;return Q.forEach(function(R){return Z.append(R)}),this},W.prototype.toArray=function(){for(var Q=[],Z=this.head;Z;)Q.push(Z),Z=Z.next;return Q},W.prototype.reverse=function(){for(var Q=this.head,Z=null,R=null;Q;)R=Q.next,Q.next=Z,Z=Q,Q=R;this.tail=this.head,this.head=Z},W.prototype.toString=function(Q){return Q===void 0&&(Q=void 0),this.toArray().map(function(Z){return Z.toString(Q)}).toString()},W}(),j=tt;ot.default=j},93026:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=tt($(88481));function tt(Q){return Q&&Q.__esModule?Q:{default:Q}}var j=function(){function Q(){this.linkedList=new Y.default}return Q.prototype.isEmpty=function(){return!this.linkedList.head},Q.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},Q.prototype.enqueue=function(Z){this.linkedList.append(Z)},Q.prototype.dequeue=function(){var Z=this.linkedList.deleteHead();return Z?Z.value:null},Q.prototype.toString=function(Z){return this.linkedList.toString(Z)},Q}(),W=j;ot.default=W},38823:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var $=function(){function tt(j){this.count=j.length,this.parent={};for(var W=0,Q=j;W<Q.length;W++){var Z=Q[W];this.parent[Z]=Z}}return tt.prototype.find=function(j){for(;this.parent[j]!==j;)j=this.parent[j];return j},tt.prototype.union=function(j,W){var Q=this.find(j),Z=this.find(W);Q!==Z&&(Q<Z?(this.parent[W]!==W&&this.union(this.parent[W],j),this.parent[W]=this.parent[j]):(this.parent[j]!==j&&this.union(this.parent[j],W),this.parent[j]=this.parent[W]))},tt.prototype.connected=function(j,W){return this.find(j)===this.find(W)},tt}(),Y=$;ot.default=Y},17892:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.DistanceType=void 0;var $;ot.DistanceType=$,function(Y){Y.EuclideanDistance="euclideanDistance"}($||(ot.DistanceType=$={}))},70643:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.uniqueId=ot.getOutEdgesNodeId=ot.getNeighbors=ot.getEdgesByNodeId=void 0;var $=function(Q,Z,R){Z===void 0&&(Z=[]);var L=Z.filter(function(B){return B.source===Q||B.target===Q});if(R==="target"){var C=function(O){return O.source===Q};return L.filter(C).map(function(B){return B.target})}if(R==="source"){var A=function(O){return O.target===Q};return L.filter(A).map(function(B){return B.source})}var N=function(O){return O.source===Q?O.target:O.source};return L.map(N)};ot.getNeighbors=$;var Y=function(Q,Z){return Z.filter(function(R){return R.source===Q})};ot.getOutEdgesNodeId=Y;var tt=function(Q,Z){return Z.filter(function(R){return R.source===Q||R.target===Q})};ot.getEdgesByNodeId=tt;var j=function(Q){Q===void 0&&(Q=0);var Z="".concat(Math.random()).split(".")[1].substr(0,5),R="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(Q,"-").concat(Z).concat(R)};ot.uniqueId=j},26838:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.oneHot=ot.getDistance=ot.getAllKeyValueMap=ot.default=void 0;var Y=$(23044),tt=$(17892),j=W($(29741));function W(C){return C&&C.__esModule?C:{default:C}}var Q=function(A,N,B){var O=[];(N==null?void 0:N.length)?O=N:(A.forEach(function(K){O=O.concat(Object.keys(K))}),O=(0,Y.uniq)(O));var F={};return O.forEach(function(K){var nt=[];A.forEach(function(P){P[K]!==void 0&&P[K]!==""&&nt.push(P[K])}),nt.length&&!(B==null?void 0:B.includes(K))&&(F[K]=(0,Y.uniq)(nt))}),F};ot.getAllKeyValueMap=Q;var Z=function(A,N,B){var O=Q(A,N,B),F=[];if(!Object.keys(O).length)return F;var K=Object.values(O),nt=K.every(function(P){return P.every(function(k){return typeof k=="number"})});return A.forEach(function(P,k){var yt=[];Object.keys(O).forEach(function(st){var lt=P[st],ht=O[st],mt=ht.findIndex(function(pt){return lt===pt}),wt=[];if(nt)wt.push(lt);else for(var ut=0;ut<ht.length;ut++)ut===mt?wt.push(1):wt.push(0);yt=yt.concat(wt)}),F[k]=yt}),F};ot.oneHot=Z;var R=function(A,N,B,O){B===void 0&&(B=tt.DistanceType.EuclideanDistance);var F=0;switch(B){case tt.DistanceType.EuclideanDistance:F=new j.default(A).euclideanDistance(new j.default(N));break;default:break}return F};ot.getDistance=R;var L={getAllKeyValueMap:Q,oneHot:Z,getDistance:R};ot.default=L},3665:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.getPropertyWeight=ot.getAllSortProperties=ot.getAllProperties=ot.default=void 0;var Y=$(92935),tt=function(L,C){L===void 0&&(L=[]),C===void 0&&(C=100);var A={};L.forEach(function(B){!B.properties||Object.keys(B.properties).forEach(function(O){if(O==="id"||!"".concat(B.properties[O]).match(Y.secondReg)&&!"".concat(B.properties[O]).match(Y.dateReg)&&isNaN(Number(B.properties[O]))){A.hasOwnProperty(O)&&delete A[O];return}A.hasOwnProperty(O)?A[O]+=1:A[O]=1})});var N=Object.keys(A).sort(function(B,O){return A[O]-A[B]});return N.length<C?N:N.slice(0,C)};ot.getAllSortProperties=tt;var j=function(L,C){return C.map(function(A){return L.hasOwnProperty(A)?L[A]:0})},W=function(L){for(var C=tt(L),A=[],N=0;N<L.length;N++)A[N]=j(L[N].properties,C);return A};ot.getPropertyWeight=W;var Q=function(L,C){C===void 0&&(C=void 0);var A=[];return L.forEach(function(N){C===void 0&&A.push(N),N[C]!==void 0&&A.push(N[C])}),A};ot.getAllProperties=Q;var Z={getAllSortProperties:tt,getPropertyWeight:W,getAllProperties:Q};ot.default=Z},29741:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=$(23044),tt=function(){function W(Q){this.arr=Q}return W.prototype.getArr=function(){return this.arr||[]},W.prototype.add=function(Q){var Z,R=Q.arr;if(!((Z=this.arr)===null||Z===void 0?void 0:Z.length))return new W(R);if(!(R==null?void 0:R.length))return new W(this.arr);if(this.arr.length===R.length){var L=[];for(var C in this.arr)L[C]=this.arr[C]+R[C];return new W(L)}},W.prototype.subtract=function(Q){var Z,R=Q.arr;if(!((Z=this.arr)===null||Z===void 0?void 0:Z.length))return new W(R);if(!(R==null?void 0:R.length))return new W(this.arr);if(this.arr.length===R.length){var L=[];for(var C in this.arr)L[C]=this.arr[C]-R[C];return new W(L)}},W.prototype.avg=function(Q){var Z=[];if(Q!==0)for(var R in this.arr)Z[R]=this.arr[R]/Q;return new W(Z)},W.prototype.negate=function(){var Q=[];for(var Z in this.arr)Q[Z]=-this.arr[Z];return new W(Q)},W.prototype.squareEuclideanDistance=function(Q){var Z,R=Q.arr;if(!((Z=this.arr)===null||Z===void 0?void 0:Z.length)||!(R==null?void 0:R.length))return 0;if(this.arr.length===R.length){var L=0;for(var C in this.arr)L+=Math.pow(this.arr[C]-Q.arr[C],2);return L}},W.prototype.euclideanDistance=function(Q){var Z,R=Q.arr;if(!((Z=this.arr)===null||Z===void 0?void 0:Z.length)||!(R==null?void 0:R.length))return 0;if(this.arr.length===R.length){var L=0;for(var C in this.arr)L+=Math.pow(this.arr[C]-Q.arr[C],2);return Math.sqrt(L)}else console.error("The two vectors are unequal in length.")},W.prototype.normalize=function(){var Q=[],Z=(0,Y.clone)(this.arr);Z.sort(function(A,N){return A-N});var R=Z[Z.length-1],L=Z[0];for(var C in this.arr)Q[C]=(this.arr[C]-L)/(R-L);return new W(Q)},W.prototype.norm2=function(){var Q;if(!((Q=this.arr)===null||Q===void 0?void 0:Q.length))return 0;var Z=0;for(var R in this.arr)Z+=Math.pow(this.arr[R],2);return Math.sqrt(Z)},W.prototype.dot=function(Q){var Z,R=Q.arr;if(!((Z=this.arr)===null||Z===void 0?void 0:Z.length)||!(R==null?void 0:R.length))return 0;if(this.arr.length===R.length){var L=0;for(var C in this.arr)L+=this.arr[C]*Q.arr[C];return L}else console.error("The two vectors are unequal in length.")},W.prototype.equal=function(Q){var Z,R=Q.arr;if(((Z=this.arr)===null||Z===void 0?void 0:Z.length)!==(R==null?void 0:R.length))return!1;for(var L in this.arr)if(this.arr[L]!==R[L])return!1;return!0},W}(),j=tt;ot.default=j},31656:function(ur,ot,$){"use strict";function Y(st){return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(lt){return typeof lt}:function(lt){return lt&&typeof Symbol=="function"&&lt.constructor===Symbol&&lt!==Symbol.prototype?"symbol":typeof lt},Y(st)}Object.defineProperty(ot,"__esModule",{value:!0}),Object.defineProperty(ot,"GADDI",{enumerable:!0,get:function(){return K.default}}),Object.defineProperty(ot,"breadthFirstSearch",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(ot,"connectedComponent",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(ot,"depthFirstSearch",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(ot,"detectCycle",{enumerable:!0,get:function(){return Z.default}}),Object.defineProperty(ot,"dijkstra",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(ot,"findAllPath",{enumerable:!0,get:function(){return C.findAllPath}}),Object.defineProperty(ot,"findShortestPath",{enumerable:!0,get:function(){return C.findShortestPath}}),Object.defineProperty(ot,"floydWarshall",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(ot,"getAdjMatrix",{enumerable:!0,get:function(){return tt.default}}),Object.defineProperty(ot,"getDegree",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(ot,"getInDegree",{enumerable:!0,get:function(){return Q.getInDegree}}),Object.defineProperty(ot,"getNeighbors",{enumerable:!0,get:function(){return nt.getNeighbors}}),Object.defineProperty(ot,"getOutDegree",{enumerable:!0,get:function(){return Q.getOutDegree}}),Object.defineProperty(ot,"labelPropagation",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(ot,"louvain",{enumerable:!0,get:function(){return B.default}}),Object.defineProperty(ot,"minimumSpanningTree",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(ot,"pageRank",{enumerable:!0,get:function(){return F.default}});var tt=yt($(62238)),j=yt($(83764)),W=yt($(59527)),Q=k($(82556)),Z=yt($(94282)),R=yt($(45891)),L=yt($(78089)),C=$(41727),A=yt($(75033)),N=yt($(5170)),B=yt($(57363)),O=yt($(89454)),F=yt($(74926)),K=yt($(82812)),nt=$(70643);function P(st){if(typeof WeakMap!="function")return null;var lt=new WeakMap,ht=new WeakMap;return(P=function(wt){return wt?ht:lt})(st)}function k(st,lt){if(!lt&&st&&st.__esModule)return st;if(st===null||Y(st)!=="object"&&typeof st!="function")return{default:st};var ht=P(lt);if(ht&&ht.has(st))return ht.get(st);var mt={},wt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ut in st)if(ut!=="default"&&Object.prototype.hasOwnProperty.call(st,ut)){var pt=wt?Object.getOwnPropertyDescriptor(st,ut):null;pt&&(pt.get||pt.set)?Object.defineProperty(mt,ut,pt):mt[ut]=st[ut]}return mt.default=st,ht&&ht.set(st,mt),mt}function yt(st){return st&&st.__esModule?st:{default:st}}},66044:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.MESSAGE=ot.ALGORITHM=void 0;var $={pageRank:"pageRank",breadthFirstSearch:"breadthFirstSearch",connectedComponent:"connectedComponent",depthFirstSearch:"depthFirstSearch",detectCycle:"detectCycle",detectDirectedCycle:"detectDirectedCycle",detectAllCycles:"detectAllCycles",detectAllDirectedCycle:"detectAllDirectedCycle",detectAllUndirectedCycle:"detectAllUndirectedCycle",dijkstra:"dijkstra",findAllPath:"findAllPath",findShortestPath:"findShortestPath",floydWarshall:"floydWarshall",getAdjMatrix:"getAdjMatrix",getDegree:"getDegree",getInDegree:"getInDegree",getNeighbors:"getNeighbors",getOutDegree:"getOutDegree",labelPropagation:"labelPropagation",louvain:"louvain",GADDI:"GADDI",minimumSpanningTree:"minimumSpanningTree",SUCCESS:"SUCCESS",FAILURE:"FAILURE"};ot.ALGORITHM=$;var Y={SUCCESS:"SUCCESS",FAILURE:"FAILURE"};ot.MESSAGE=Y},70585:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var Y=$(66044),tt=j($(12067));function j(Z){return Z&&Z.__esModule?Z:{default:Z}}var W=function(R){return function(){for(var L=[],C=0;C<arguments.length;C++)L[C]=arguments[C];return new Promise(function(A,N){var B=new tt.default;B.postMessage({_algorithmType:R,data:L}),B.onmessage=function(O){var F=O.data,K=F.data,nt=F._algorithmType;Y.MESSAGE.SUCCESS===nt?A(K):N(),B.terminate()}})}},Q=W;ot.default=Q},30485:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.pageRankAsync=ot.minimumSpanningTreeAsync=ot.louvainAsync=ot.labelPropagationAsync=ot.getOutDegreeAsync=ot.getNeighborsAsync=ot.getInDegreeAsync=ot.getDegreeAsync=ot.getAdjMatrixAsync=ot.floydWarshallAsync=ot.findShortestPathAsync=ot.findAllPathAsync=ot.dijkstraAsync=ot.detectCycleAsync=ot.detectAllUndirectedCycleAsync=ot.detectAllDirectedCycleAsync=ot.detectAllCyclesAsync=ot.connectedComponentAsync=ot.GADDIAsync=void 0;var Y=j($(70585)),tt=$(66044);function j(mt){return mt&&mt.__esModule?mt:{default:mt}}var W=function(wt,ut){return(0,Y.default)(tt.ALGORITHM.getAdjMatrix).apply(void 0,[wt,ut])};ot.getAdjMatrixAsync=W;var Q=function(wt,ut){return(0,Y.default)(tt.ALGORITHM.connectedComponent).apply(void 0,[wt,ut])};ot.connectedComponentAsync=Q;var Z=function(wt){return(0,Y.default)(tt.ALGORITHM.getDegree)(wt)};ot.getDegreeAsync=Z;var R=function(wt,ut){return(0,Y.default)(tt.ALGORITHM.getInDegree)(wt,ut)};ot.getInDegreeAsync=R;var L=function(wt,ut){return(0,Y.default)(tt.ALGORITHM.getOutDegree)(wt,ut)};ot.getOutDegreeAsync=L;var C=function(wt){return(0,Y.default)(tt.ALGORITHM.detectCycle)(wt)};ot.detectCycleAsync=C;var A=function(wt){return(0,Y.default)(tt.ALGORITHM.detectAllCycles)(wt)};ot.detectAllCyclesAsync=A;var N=function(wt){return(0,Y.default)(tt.ALGORITHM.detectAllDirectedCycle)(wt)};ot.detectAllDirectedCycleAsync=N;var B=function(wt){return(0,Y.default)(tt.ALGORITHM.detectAllUndirectedCycle)(wt)};ot.detectAllUndirectedCycleAsync=B;var O=function(wt,ut,pt,Nt){return(0,Y.default)(tt.ALGORITHM.dijkstra).apply(void 0,[wt,ut,pt,Nt])};ot.dijkstraAsync=O;var F=function(wt,ut,pt,Nt){return(0,Y.default)(tt.ALGORITHM.findAllPath).apply(void 0,[wt,ut,pt,Nt])};ot.findAllPathAsync=F;var K=function(wt,ut,pt,Nt,Ut){return(0,Y.default)(tt.ALGORITHM.findShortestPath).apply(void 0,[wt,ut,pt,Nt,Ut])};ot.findShortestPathAsync=K;var nt=function(wt,ut){return(0,Y.default)(tt.ALGORITHM.floydWarshall).apply(void 0,[wt,ut])};ot.floydWarshallAsync=nt;var P=function(wt,ut,pt,Nt){return Nt===void 0&&(Nt=1e3),(0,Y.default)(tt.ALGORITHM.labelPropagation)(wt,ut,pt,Nt)};ot.labelPropagationAsync=P;var k=function(wt,ut,pt,Nt){return(0,Y.default)(tt.ALGORITHM.louvain)(wt,ut,pt,Nt)};ot.louvainAsync=k;var yt=function(wt,ut,pt){return(0,Y.default)(tt.ALGORITHM.minimumSpanningTree).apply(void 0,[wt,ut,pt])};ot.minimumSpanningTreeAsync=yt;var st=function(wt,ut,pt){return(0,Y.default)(tt.ALGORITHM.pageRank).apply(void 0,[wt,ut,pt])};ot.pageRankAsync=st;var lt=function(wt,ut,pt){return(0,Y.default)(tt.ALGORITHM.getNeighbors).apply(void 0,[wt,ut,pt])};ot.getNeighborsAsync=lt;var ht=function(wt,ut,pt,Nt,Ut,ue,se){return pt===void 0&&(pt=!1),ue===void 0&&(ue="cluster"),se===void 0&&(se="cluster"),(0,Y.default)(tt.ALGORITHM.GADDI).apply(void 0,[wt,ut,pt,Nt,Ut,ue,se])};ot.GADDIAsync=ht},12067:function(ur,ot,$){"use strict";function Y(L){return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},Y(L)}Object.defineProperty(ot,"__esModule",{value:!0}),ot.default=void 0;var tt=Q($(31656)),j=$(66044);function W(L){if(typeof WeakMap!="function")return null;var C=new WeakMap,A=new WeakMap;return(W=function(B){return B?A:C})(L)}function Q(L,C){if(!C&&L&&L.__esModule)return L;if(L===null||Y(L)!=="object"&&typeof L!="function")return{default:L};var A=W(C);if(A&&A.has(L))return A.get(L);var N={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in L)if(O!=="default"&&Object.prototype.hasOwnProperty.call(L,O)){var F=B?Object.getOwnPropertyDescriptor(L,O):null;F&&(F.get||F.set)?Object.defineProperty(N,O,F):N[O]=L[O]}return N.default=L,A&&A.set(L,N),N}var Z=typeof self!="undefined"?self:{};Z.onmessage=function(L){var C=L.data,A=C._algorithmType,N=C.data;if(!!A){if(typeof tt[A]=="function"){var B=tt[A].apply(tt,N);Z.postMessage({_algorithmType:j.MESSAGE.SUCCESS,data:B});return}Z.postMessage({_algorithmType:j.MESSAGE.FAILURE})}};var R=null;ot.default=R},79984:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{Kernel:function(){return ue},World:function(){return ba}});var Y=$(92137),tt=$(96156),j=$(6610),W=$(5991),Q=$(36719),Z=$.n(Q),R=$(81763),L=$.n(R),C=$(1469),A=$.n(C),N=$(87757),B=$.n(N),O=null,F=1;function K(){return F++}var nt=null,P=null,k;(function(gt){gt[gt.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",gt[gt.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",gt[gt.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",gt[gt.POINTS=0]="POINTS",gt[gt.LINES=1]="LINES",gt[gt.LINE_LOOP=2]="LINE_LOOP",gt[gt.LINE_STRIP=3]="LINE_STRIP",gt[gt.TRIANGLES=4]="TRIANGLES",gt[gt.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",gt[gt.TRIANGLE_FAN=6]="TRIANGLE_FAN",gt[gt.ZERO=0]="ZERO",gt[gt.ONE=1]="ONE",gt[gt.SRC_COLOR=768]="SRC_COLOR",gt[gt.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",gt[gt.SRC_ALPHA=770]="SRC_ALPHA",gt[gt.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",gt[gt.DST_ALPHA=772]="DST_ALPHA",gt[gt.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",gt[gt.DST_COLOR=774]="DST_COLOR",gt[gt.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",gt[gt.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",gt[gt.FUNC_ADD=32774]="FUNC_ADD",gt[gt.BLEND_EQUATION=32777]="BLEND_EQUATION",gt[gt.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",gt[gt.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",gt[gt.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",gt[gt.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",gt[gt.MAX_EXT=32776]="MAX_EXT",gt[gt.MIN_EXT=32775]="MIN_EXT",gt[gt.BLEND_DST_RGB=32968]="BLEND_DST_RGB",gt[gt.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",gt[gt.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",gt[gt.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",gt[gt.CONSTANT_COLOR=32769]="CONSTANT_COLOR",gt[gt.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",gt[gt.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",gt[gt.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",gt[gt.BLEND_COLOR=32773]="BLEND_COLOR",gt[gt.ARRAY_BUFFER=34962]="ARRAY_BUFFER",gt[gt.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",gt[gt.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",gt[gt.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",gt[gt.STREAM_DRAW=35040]="STREAM_DRAW",gt[gt.STATIC_DRAW=35044]="STATIC_DRAW",gt[gt.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",gt[gt.BUFFER_SIZE=34660]="BUFFER_SIZE",gt[gt.BUFFER_USAGE=34661]="BUFFER_USAGE",gt[gt.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",gt[gt.FRONT=1028]="FRONT",gt[gt.BACK=1029]="BACK",gt[gt.FRONT_AND_BACK=1032]="FRONT_AND_BACK",gt[gt.CULL_FACE=2884]="CULL_FACE",gt[gt.BLEND=3042]="BLEND",gt[gt.DITHER=3024]="DITHER",gt[gt.STENCIL_TEST=2960]="STENCIL_TEST",gt[gt.DEPTH_TEST=2929]="DEPTH_TEST",gt[gt.SCISSOR_TEST=3089]="SCISSOR_TEST",gt[gt.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",gt[gt.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",gt[gt.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",gt[gt.NO_ERROR=0]="NO_ERROR",gt[gt.INVALID_ENUM=1280]="INVALID_ENUM",gt[gt.INVALID_VALUE=1281]="INVALID_VALUE",gt[gt.INVALID_OPERATION=1282]="INVALID_OPERATION",gt[gt.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",gt[gt.CW=2304]="CW",gt[gt.CCW=2305]="CCW",gt[gt.LINE_WIDTH=2849]="LINE_WIDTH",gt[gt.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",gt[gt.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",gt[gt.CULL_FACE_MODE=2885]="CULL_FACE_MODE",gt[gt.FRONT_FACE=2886]="FRONT_FACE",gt[gt.DEPTH_RANGE=2928]="DEPTH_RANGE",gt[gt.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",gt[gt.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",gt[gt.DEPTH_FUNC=2932]="DEPTH_FUNC",gt[gt.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",gt[gt.STENCIL_FUNC=2962]="STENCIL_FUNC",gt[gt.STENCIL_FAIL=2964]="STENCIL_FAIL",gt[gt.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",gt[gt.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",gt[gt.STENCIL_REF=2967]="STENCIL_REF",gt[gt.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",gt[gt.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",gt[gt.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",gt[gt.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",gt[gt.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",gt[gt.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",gt[gt.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",gt[gt.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",gt[gt.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",gt[gt.VIEWPORT=2978]="VIEWPORT",gt[gt.SCISSOR_BOX=3088]="SCISSOR_BOX",gt[gt.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",gt[gt.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",gt[gt.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",gt[gt.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",gt[gt.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",gt[gt.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",gt[gt.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",gt[gt.RED_BITS=3410]="RED_BITS",gt[gt.GREEN_BITS=3411]="GREEN_BITS",gt[gt.BLUE_BITS=3412]="BLUE_BITS",gt[gt.ALPHA_BITS=3413]="ALPHA_BITS",gt[gt.DEPTH_BITS=3414]="DEPTH_BITS",gt[gt.STENCIL_BITS=3415]="STENCIL_BITS",gt[gt.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",gt[gt.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",gt[gt.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",gt[gt.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",gt[gt.SAMPLES=32937]="SAMPLES",gt[gt.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",gt[gt.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",gt[gt.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",gt[gt.DONT_CARE=4352]="DONT_CARE",gt[gt.FASTEST=4353]="FASTEST",gt[gt.NICEST=4354]="NICEST",gt[gt.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",gt[gt.BYTE=5120]="BYTE",gt[gt.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",gt[gt.SHORT=5122]="SHORT",gt[gt.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",gt[gt.INT=5124]="INT",gt[gt.UNSIGNED_INT=5125]="UNSIGNED_INT",gt[gt.FLOAT=5126]="FLOAT",gt[gt.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",gt[gt.ALPHA=6406]="ALPHA",gt[gt.RGB=6407]="RGB",gt[gt.RGBA=6408]="RGBA",gt[gt.LUMINANCE=6409]="LUMINANCE",gt[gt.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",gt[gt.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",gt[gt.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",gt[gt.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",gt[gt.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",gt[gt.VERTEX_SHADER=35633]="VERTEX_SHADER",gt[gt.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",gt[gt.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",gt[gt.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",gt[gt.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",gt[gt.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",gt[gt.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",gt[gt.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",gt[gt.SHADER_TYPE=35663]="SHADER_TYPE",gt[gt.DELETE_STATUS=35712]="DELETE_STATUS",gt[gt.LINK_STATUS=35714]="LINK_STATUS",gt[gt.VALIDATE_STATUS=35715]="VALIDATE_STATUS",gt[gt.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",gt[gt.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",gt[gt.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",gt[gt.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",gt[gt.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",gt[gt.NEVER=512]="NEVER",gt[gt.LESS=513]="LESS",gt[gt.EQUAL=514]="EQUAL",gt[gt.LEQUAL=515]="LEQUAL",gt[gt.GREATER=516]="GREATER",gt[gt.NOTEQUAL=517]="NOTEQUAL",gt[gt.GEQUAL=518]="GEQUAL",gt[gt.ALWAYS=519]="ALWAYS",gt[gt.KEEP=7680]="KEEP",gt[gt.REPLACE=7681]="REPLACE",gt[gt.INCR=7682]="INCR",gt[gt.DECR=7683]="DECR",gt[gt.INVERT=5386]="INVERT",gt[gt.INCR_WRAP=34055]="INCR_WRAP",gt[gt.DECR_WRAP=34056]="DECR_WRAP",gt[gt.VENDOR=7936]="VENDOR",gt[gt.RENDERER=7937]="RENDERER",gt[gt.VERSION=7938]="VERSION",gt[gt.NEAREST=9728]="NEAREST",gt[gt.LINEAR=9729]="LINEAR",gt[gt.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",gt[gt.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",gt[gt.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",gt[gt.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",gt[gt.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",gt[gt.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",gt[gt.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",gt[gt.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",gt[gt.TEXTURE_2D=3553]="TEXTURE_2D",gt[gt.TEXTURE=5890]="TEXTURE",gt[gt.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",gt[gt.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",gt[gt.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",gt[gt.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",gt[gt.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",gt[gt.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",gt[gt.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",gt[gt.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",gt[gt.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",gt[gt.TEXTURE0=33984]="TEXTURE0",gt[gt.TEXTURE1=33985]="TEXTURE1",gt[gt.TEXTURE2=33986]="TEXTURE2",gt[gt.TEXTURE3=33987]="TEXTURE3",gt[gt.TEXTURE4=33988]="TEXTURE4",gt[gt.TEXTURE5=33989]="TEXTURE5",gt[gt.TEXTURE6=33990]="TEXTURE6",gt[gt.TEXTURE7=33991]="TEXTURE7",gt[gt.TEXTURE8=33992]="TEXTURE8",gt[gt.TEXTURE9=33993]="TEXTURE9",gt[gt.TEXTURE10=33994]="TEXTURE10",gt[gt.TEXTURE11=33995]="TEXTURE11",gt[gt.TEXTURE12=33996]="TEXTURE12",gt[gt.TEXTURE13=33997]="TEXTURE13",gt[gt.TEXTURE14=33998]="TEXTURE14",gt[gt.TEXTURE15=33999]="TEXTURE15",gt[gt.TEXTURE16=34e3]="TEXTURE16",gt[gt.TEXTURE17=34001]="TEXTURE17",gt[gt.TEXTURE18=34002]="TEXTURE18",gt[gt.TEXTURE19=34003]="TEXTURE19",gt[gt.TEXTURE20=34004]="TEXTURE20",gt[gt.TEXTURE21=34005]="TEXTURE21",gt[gt.TEXTURE22=34006]="TEXTURE22",gt[gt.TEXTURE23=34007]="TEXTURE23",gt[gt.TEXTURE24=34008]="TEXTURE24",gt[gt.TEXTURE25=34009]="TEXTURE25",gt[gt.TEXTURE26=34010]="TEXTURE26",gt[gt.TEXTURE27=34011]="TEXTURE27",gt[gt.TEXTURE28=34012]="TEXTURE28",gt[gt.TEXTURE29=34013]="TEXTURE29",gt[gt.TEXTURE30=34014]="TEXTURE30",gt[gt.TEXTURE31=34015]="TEXTURE31",gt[gt.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",gt[gt.REPEAT=10497]="REPEAT",gt[gt.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",gt[gt.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",gt[gt.FLOAT_VEC2=35664]="FLOAT_VEC2",gt[gt.FLOAT_VEC3=35665]="FLOAT_VEC3",gt[gt.FLOAT_VEC4=35666]="FLOAT_VEC4",gt[gt.INT_VEC2=35667]="INT_VEC2",gt[gt.INT_VEC3=35668]="INT_VEC3",gt[gt.INT_VEC4=35669]="INT_VEC4",gt[gt.BOOL=35670]="BOOL",gt[gt.BOOL_VEC2=35671]="BOOL_VEC2",gt[gt.BOOL_VEC3=35672]="BOOL_VEC3",gt[gt.BOOL_VEC4=35673]="BOOL_VEC4",gt[gt.FLOAT_MAT2=35674]="FLOAT_MAT2",gt[gt.FLOAT_MAT3=35675]="FLOAT_MAT3",gt[gt.FLOAT_MAT4=35676]="FLOAT_MAT4",gt[gt.SAMPLER_2D=35678]="SAMPLER_2D",gt[gt.SAMPLER_CUBE=35680]="SAMPLER_CUBE",gt[gt.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",gt[gt.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",gt[gt.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",gt[gt.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",gt[gt.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",gt[gt.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",gt[gt.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",gt[gt.COMPILE_STATUS=35713]="COMPILE_STATUS",gt[gt.LOW_FLOAT=36336]="LOW_FLOAT",gt[gt.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",gt[gt.HIGH_FLOAT=36338]="HIGH_FLOAT",gt[gt.LOW_INT=36339]="LOW_INT",gt[gt.MEDIUM_INT=36340]="MEDIUM_INT",gt[gt.HIGH_INT=36341]="HIGH_INT",gt[gt.FRAMEBUFFER=36160]="FRAMEBUFFER",gt[gt.RENDERBUFFER=36161]="RENDERBUFFER",gt[gt.RGBA4=32854]="RGBA4",gt[gt.RGB5_A1=32855]="RGB5_A1",gt[gt.RGB565=36194]="RGB565",gt[gt.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",gt[gt.STENCIL_INDEX=6401]="STENCIL_INDEX",gt[gt.STENCIL_INDEX8=36168]="STENCIL_INDEX8",gt[gt.DEPTH_STENCIL=34041]="DEPTH_STENCIL",gt[gt.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",gt[gt.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",gt[gt.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",gt[gt.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",gt[gt.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",gt[gt.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",gt[gt.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",gt[gt.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",gt[gt.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",gt[gt.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",gt[gt.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",gt[gt.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",gt[gt.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",gt[gt.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",gt[gt.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",gt[gt.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",gt[gt.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",gt[gt.NONE=0]="NONE",gt[gt.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",gt[gt.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",gt[gt.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",gt[gt.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",gt[gt.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",gt[gt.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",gt[gt.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",gt[gt.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",gt[gt.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",gt[gt.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",gt[gt.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",gt[gt.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",gt[gt.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",gt[gt.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",gt[gt.COPY_SRC=1]="COPY_SRC",gt[gt.COPY_DST=2]="COPY_DST",gt[gt.SAMPLED=4]="SAMPLED",gt[gt.STORAGE=8]="STORAGE",gt[gt.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(k||(k={}));var yt=function(){function gt(){(0,j.Z)(this,gt),this.config=void 0}return(0,W.Z)(gt,[{key:"get",value:function(){return this.config}},{key:"set",value:function(un){this.config=un}}]),gt}(),st=typeof navigator!="undefined"&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),lt;(function(gt){gt.Void="Void",gt.Boolean="Boolean",gt.Float="Float",gt.Uint32="Uint32",gt.Int32="Int32",gt.Vector="Vector",gt.Vector2Float="vec2<f32>",gt.Vector3Float="vec3<f32>",gt.Vector4Float="vec4<f32>",gt.Vector2Boolean="vec2<bool>",gt.Vector3Boolean="vec3<bool>",gt.Vector4Boolean="vec4<bool>",gt.Vector2Uint="vec2<u32>",gt.Vector3Uint="vec3<u32>",gt.Vector4Uint="vec4<u32>",gt.Vector2Int="vec2<i32>",gt.Vector3Int="vec3<i32>",gt.Vector4Int="vec4<i32>",gt.Matrix="Matrix",gt.Matrix3x3Float="mat3x3<f32>",gt.Matrix4x4Float="mat4x4<i32>",gt.Struct="Struct",gt.FloatArray="Float[]",gt.Vector4FloatArray="vec4<f32>[]"})(lt||(lt={}));var ht;(function(gt){gt.Program="Program",gt.Identifier="Identifier",gt.VariableDeclaration="VariableDeclaration",gt.BlockStatement="BlockStatement",gt.ReturnStatement="ReturnStatement",gt.FunctionDeclaration="FunctionDeclaration",gt.VariableDeclarator="VariableDeclarator",gt.AssignmentExpression="AssignmentExpression",gt.LogicalExpression="LogicalExpression",gt.BinaryExpression="BinaryExpression",gt.ArrayExpression="ArrayExpression",gt.UnaryExpression="UnaryExpression",gt.UpdateExpression="UpdateExpression",gt.FunctionExpression="FunctionExpression",gt.MemberExpression="MemberExpression",gt.ConditionalExpression="ConditionalExpression",gt.ExpressionStatement="ExpressionStatement",gt.CallExpression="CallExpression",gt.NumThreadStatement="NumThreadStatement",gt.StorageStatement="StorageStatement",gt.DoWhileStatement="DoWhileStatement",gt.WhileStatement="WhileStatement",gt.ForStatement="ForStatement",gt.BreakStatement="BreakStatement",gt.ContinueStatement="ContinueStatement",gt.IfStatement="IfStatement",gt.ImportedFunctionStatement="ImportedFunctionStatement"})(ht||(ht={}));var mt;(function(gt){gt.Input="Input",gt.Output="Output",gt.Uniform="Uniform",gt.Workgroup="Workgroup",gt.UniformConstant="UniformConstant",gt.Image="Image",gt.StorageBuffer="StorageBuffer",gt.Private="Private",gt.Function="Function"})(mt||(mt={}));var wt;(function(gt){gt.GLSL100="GLSL100",gt.GLSL450="GLSL450",gt.WGSL="WGSL"})(wt||(wt={}));var ut="__DefineValuePlaceholder__";function pt(){if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Nt(gt,Dn){var un=Object.keys(gt);if(Object.getOwnPropertySymbols){var Lt=Object.getOwnPropertySymbols(gt);Dn&&(Lt=Lt.filter(function(Ot){return Object.getOwnPropertyDescriptor(gt,Ot).enumerable})),un.push.apply(un,Lt)}return un}function Ut(gt){for(var Dn=1;Dn<arguments.length;Dn++){var un=arguments[Dn]!=null?arguments[Dn]:{};Dn%2?Nt(Object(un),!0).forEach(function(Lt){(0,tt.Z)(gt,Lt,un[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(gt,Object.getOwnPropertyDescriptors(un)):Nt(Object(un)).forEach(function(Lt){Object.defineProperty(gt,Lt,Object.getOwnPropertyDescriptor(un,Lt))})}return gt}var ue=function(){function gt(Dn,un){(0,j.Z)(this,gt),this.engine=Dn,this.configService=un,this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}return(0,W.Z)(gt,[{key:"init",value:function(){var un=this.configService.get(),Lt=un.canvas,Ot=un.engineOptions;this.initPromise=this.engine.init(Ut({canvas:Lt||pt(),antialiasing:!1},Ot))}},{key:"setBundle",value:function(un){this.compiledBundle=JSON.parse(JSON.stringify(un))}},{key:"setDispatch",value:function(un){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=un),this}},{key:"setMaxIteration",value:function(un){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=un),this}},{key:"setBinding",value:function(un,Lt){var Ot=this;if(typeof un=="string"){var it=L()(Lt)||Z()(Lt)||A()(Lt);if(this.compiledBundle&&this.compiledBundle.context){var H=this.compiledBundle.context.defines.find(function(xt){return xt.name===un});if(H)return H.value=Lt,this;var X=this.compiledBundle.context.uniforms.find(function(xt){return xt.name===un});X&&(it?(X.data=Lt,X.isReferer=!1,X.storageClass===mt.Uniform?this.model&&this.model.updateUniform(un,Lt):this.model&&this.model.updateBuffer(un,Lt)):(X.isReferer=!0,X.data=Lt))}}else Object.keys(un).forEach(function(xt){Ot.setBinding(xt,un[xt])});return this}},{key:"execute",value:function(){var Dn=(0,Y.Z)(B().mark(function Lt(){var Ot=this,it,H,X=arguments;return B().wrap(function(zt){for(;;)switch(zt.prev=zt.next){case 0:if(it=X.length>0&&X[0]!==void 0?X[0]:1,!this.dirty){zt.next=6;break}return this.compiledBundle.context&&(it>1?this.compiledBundle.context.maxIteration=it:this.compiledBundle.context.maxIteration++),zt.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(Vt){var Xt=Vt.isReferer;return Xt}).forEach(function(Vt){var Xt=Vt.data,ne=Vt.name;Ot.model.confirmInput(Xt.model,ne)}),H=0;H<it;H++)this.model.run();return this.engine.endFrame(),zt.abrupt("return",this);case 12:case"end":return zt.stop()}},Lt,this)}));function un(){return Dn.apply(this,arguments)}return un}()},{key:"getOutput",value:function(){var Dn=(0,Y.Z)(B().mark(function Lt(){return B().wrap(function(it){for(;;)switch(it.prev=it.next){case 0:return it.abrupt("return",this.model.readData());case 1:case"end":return it.stop()}},Lt,this)}));function un(){return Dn.apply(this,arguments)}return un}()},{key:"compile",value:function(){var Dn=(0,Y.Z)(B().mark(function Lt(){var Ot,it,H;return B().wrap(function(xt){for(;;)switch(xt.prev=xt.next){case 0:return xt.next=2,this.initPromise;case 2:return Ot=Ut({},this.compiledBundle.context),it=this.engine.supportWebGPU?this.engine.useWGSL?wt.WGSL:wt.GLSL450:wt.GLSL100,H=this.compiledBundle.shaders[it],Ot.defines.filter(function(zt){return zt.runtime}).forEach(function(zt){var Vt="".concat(ut).concat(zt.name);H=H.replace(Vt,"".concat(zt.value))}),Ot.shader=H,Ot.uniforms.forEach(function(zt){if(!zt.data&&zt.storageClass===mt.StorageBuffer){var Vt=1;zt.type===lt.FloatArray?Vt=1:zt.type===lt.Vector4FloatArray&&(Vt=4),zt.data=new Float32Array(Ot.output.length*Vt).fill(0)}}),this.compiledBundle.context=Ot,xt.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=xt.sent;case 12:case"end":return xt.stop()}},Lt,this)}));function un(){return Dn.apply(this,arguments)}return un}()}]),gt}(),se=$(81550),Le=$.n(se),Ne=function(){function gt(Dn,un){(0,j.Z)(this,gt),this.attribute=void 0,this.buffer=void 0;var Lt=un.buffer,Ot=un.offset,it=un.stride,H=un.normalized,X=un.size,xt=un.divisor;this.buffer=Lt,this.attribute={buffer:Lt.get(),offset:Ot||0,stride:it||0,normalized:H||!1,divisor:xt||0},X&&(this.attribute.size=X)}return(0,W.Z)(gt,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(un){this.buffer.subData(un)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),gt}(),we,At,Qt,de,rn,Ee,ce,Oe,Ze,fe,Ae,Ye,ge,Be,te=(we={},(0,tt.Z)(we,k.POINTS,"points"),(0,tt.Z)(we,k.LINES,"lines"),(0,tt.Z)(we,k.LINE_LOOP,"line loop"),(0,tt.Z)(we,k.LINE_STRIP,"line strip"),(0,tt.Z)(we,k.TRIANGLES,"triangles"),(0,tt.Z)(we,k.TRIANGLE_FAN,"triangle fan"),(0,tt.Z)(we,k.TRIANGLE_STRIP,"triangle strip"),we),ke=(At={},(0,tt.Z)(At,k.STATIC_DRAW,"static"),(0,tt.Z)(At,k.DYNAMIC_DRAW,"dynamic"),(0,tt.Z)(At,k.STREAM_DRAW,"stream"),At),Ve=(Qt={},(0,tt.Z)(Qt,k.BYTE,"int8"),(0,tt.Z)(Qt,k.UNSIGNED_INT,"int16"),(0,tt.Z)(Qt,k.INT,"int32"),(0,tt.Z)(Qt,k.UNSIGNED_BYTE,"uint8"),(0,tt.Z)(Qt,k.UNSIGNED_SHORT,"uint16"),(0,tt.Z)(Qt,k.UNSIGNED_INT,"uint32"),(0,tt.Z)(Qt,k.FLOAT,"float"),Qt),ee=(de={},(0,tt.Z)(de,k.ALPHA,"alpha"),(0,tt.Z)(de,k.LUMINANCE,"luminance"),(0,tt.Z)(de,k.LUMINANCE_ALPHA,"luminance alpha"),(0,tt.Z)(de,k.RGB,"rgb"),(0,tt.Z)(de,k.RGBA,"rgba"),(0,tt.Z)(de,k.RGBA4,"rgba4"),(0,tt.Z)(de,k.RGB5_A1,"rgb5 a1"),(0,tt.Z)(de,k.RGB565,"rgb565"),(0,tt.Z)(de,k.DEPTH_COMPONENT,"depth"),(0,tt.Z)(de,k.DEPTH_STENCIL,"depth stencil"),de),Ft=(rn={},(0,tt.Z)(rn,k.DONT_CARE,"dont care"),(0,tt.Z)(rn,k.NICEST,"nice"),(0,tt.Z)(rn,k.FASTEST,"fast"),rn),bt=(Ee={},(0,tt.Z)(Ee,k.NEAREST,"nearest"),(0,tt.Z)(Ee,k.LINEAR,"linear"),(0,tt.Z)(Ee,k.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,tt.Z)(Ee,k.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,tt.Z)(Ee,k.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,tt.Z)(Ee,k.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Ee),Me=(ce={},(0,tt.Z)(ce,k.REPEAT,"repeat"),(0,tt.Z)(ce,k.CLAMP_TO_EDGE,"clamp"),(0,tt.Z)(ce,k.MIRRORED_REPEAT,"mirror"),ce),en=(Oe={},(0,tt.Z)(Oe,k.NONE,"none"),(0,tt.Z)(Oe,k.BROWSER_DEFAULT_WEBGL,"browser"),Oe),fn=(Ze={},(0,tt.Z)(Ze,k.NEVER,"never"),(0,tt.Z)(Ze,k.ALWAYS,"always"),(0,tt.Z)(Ze,k.LESS,"less"),(0,tt.Z)(Ze,k.LEQUAL,"lequal"),(0,tt.Z)(Ze,k.GREATER,"greater"),(0,tt.Z)(Ze,k.GEQUAL,"gequal"),(0,tt.Z)(Ze,k.EQUAL,"equal"),(0,tt.Z)(Ze,k.NOTEQUAL,"notequal"),Ze),Rt=(fe={},(0,tt.Z)(fe,k.FUNC_ADD,"add"),(0,tt.Z)(fe,k.MIN_EXT,"min"),(0,tt.Z)(fe,k.MAX_EXT,"max"),(0,tt.Z)(fe,k.FUNC_SUBTRACT,"subtract"),(0,tt.Z)(fe,k.FUNC_REVERSE_SUBTRACT,"reverse subtract"),fe),Xn=(Ae={},(0,tt.Z)(Ae,k.ZERO,"zero"),(0,tt.Z)(Ae,k.ONE,"one"),(0,tt.Z)(Ae,k.SRC_COLOR,"src color"),(0,tt.Z)(Ae,k.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,tt.Z)(Ae,k.SRC_ALPHA,"src alpha"),(0,tt.Z)(Ae,k.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,tt.Z)(Ae,k.DST_COLOR,"dst color"),(0,tt.Z)(Ae,k.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,tt.Z)(Ae,k.DST_ALPHA,"dst alpha"),(0,tt.Z)(Ae,k.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,tt.Z)(Ae,k.CONSTANT_COLOR,"constant color"),(0,tt.Z)(Ae,k.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,tt.Z)(Ae,k.CONSTANT_ALPHA,"constant alpha"),(0,tt.Z)(Ae,k.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,tt.Z)(Ae,k.SRC_ALPHA_SATURATE,"src alpha saturate"),Ae),Bn=(Ye={},(0,tt.Z)(Ye,k.NEVER,"never"),(0,tt.Z)(Ye,k.ALWAYS,"always"),(0,tt.Z)(Ye,k.LESS,"less"),(0,tt.Z)(Ye,k.LEQUAL,"lequal"),(0,tt.Z)(Ye,k.GREATER,"greater"),(0,tt.Z)(Ye,k.GEQUAL,"gequal"),(0,tt.Z)(Ye,k.EQUAL,"equal"),(0,tt.Z)(Ye,k.NOTEQUAL,"notequal"),Ye),xr=(ge={},(0,tt.Z)(ge,k.ZERO,"zero"),(0,tt.Z)(ge,k.KEEP,"keep"),(0,tt.Z)(ge,k.REPLACE,"replace"),(0,tt.Z)(ge,k.INVERT,"invert"),(0,tt.Z)(ge,k.INCR,"increment"),(0,tt.Z)(ge,k.DECR,"decrement"),(0,tt.Z)(ge,k.INCR_WRAP,"increment wrap"),(0,tt.Z)(ge,k.DECR_WRAP,"decrement wrap"),ge),dr=(Be={},(0,tt.Z)(Be,k.FRONT,"front"),(0,tt.Z)(Be,k.BACK,"back"),Be),Ur=function(){function gt(Dn,un){(0,j.Z)(this,gt),this.buffer=void 0;var Lt=un.data,Ot=un.usage,it=un.type;this.buffer=Dn.buffer({data:Lt,usage:ke[Ot||k.STATIC_DRAW],type:Ve[it||k.UNSIGNED_BYTE]})}return(0,W.Z)(gt,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(un){var Lt=un.data,Ot=un.offset;this.buffer.subdata(Lt,Ot)}}]),gt}(),fa=$(85061);function Ea(gt,Dn){var un=Object.keys(gt);if(Object.getOwnPropertySymbols){var Lt=Object.getOwnPropertySymbols(gt);Dn&&(Lt=Lt.filter(function(Ot){return Object.getOwnPropertyDescriptor(gt,Ot).enumerable})),un.push.apply(un,Lt)}return un}function aa(gt){for(var Dn=1;Dn<arguments.length;Dn++){var un=arguments[Dn]!=null?arguments[Dn]:{};Dn%2?Ea(Object(un),!0).forEach(function(Lt){(0,tt.Z)(gt,Lt,un[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(gt,Object.getOwnPropertyDescriptors(un)):Ea(Object(un)).forEach(function(Lt){Object.defineProperty(gt,Lt,Object.getOwnPropertyDescriptor(un,Lt))})}return gt}var Da=`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,Lr=0,_n=!1,sr=function(){function gt(Dn,un){var Lt=this;(0,j.Z)(this,gt),this.reGl=Dn,this.context=un,this.entity=K(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var Ot={};this.context.uniforms.forEach(function(zt){var Vt=zt.name,Xt=zt.type,ne=zt.data,on=zt.isReferer,tn=zt.storageClass;if(tn===mt.StorageBuffer){if(on)Lt.textureCache[Vt]={data:void 0},Ot["".concat(Vt,"Size")]=function(){return ne.compiledBundle.context.output.textureSize};else{Lt.textureCache[Vt]=Lt.calcDataTexture(Vt,Xt,ne);var He=Lt.textureCache[Vt],Qn=He.textureWidth,Ln=He.isOutput;Ot["".concat(Vt,"Size")]=[Qn,Qn],Ln&&(Lt.outputTextureName=Vt,Lt.context.needPingpong&&(Lt.outputTextureName="".concat(Vt,"Output"),Lt.textureCache[Lt.outputTextureName]=Lt.calcDataTexture(Vt,Xt,ne)))}Ot[Vt]=function(){return _n&&console.log("[".concat(Lt.entity,"]: ").concat(Vt," ").concat(Lt.textureCache[Vt].id)),Lt.textureCache[Vt].texture}}else if(tn===mt.Uniform){if(ne&&(Array.isArray(ne)||Z()(ne))&&ne.length>16)throw new Error("invalid data type ".concat(Xt));Ot[Vt]=function(){return zt.data}}});var it=this.getOuputDataTexture(),H=it.textureWidth,X=it.texelCount;Ot.u_OutputTextureSize=[H,H],Ot.u_OutputTexelCount=X,this.context.output.textureSize=[H,H];var xt={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:Ot,vert:Da,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(xt)}return(0,W.Z)(gt,[{key:"run",value:function(){var un=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){un.computeCommand()}),_n&&console.log("[".concat(this.entity,"]: output ").concat(this.getOuputDataTexture().id))}},{key:"readData",value:function(){var Dn=(0,Y.Z)(B().mark(function Lt(){var Ot=this,it,H,X,xt,zt,Vt,Xt,ne;return B().wrap(function(tn){for(;;)switch(tn.prev=tn.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){it=Ot.reGl.read()}),!it){tn.next=6;break}if(H=this.getOuputDataTexture(),X=H.originalDataLength,xt=H.elementsPerTexel,zt=H.typedArrayConstructor,Vt=zt===void 0?Float32Array:zt,Xt=[],xt!==4)for(ne=0;ne<it.length;ne+=4)xt===1?Xt.push(it[ne]):xt===2?Xt.push(it[ne],it[ne+1]):Xt.push(it[ne],it[ne+1],it[ne+2]);else Xt=it;return tn.abrupt("return",new Vt(Xt.slice(0,X)));case 6:return tn.abrupt("return",new Float32Array);case 7:case"end":return tn.stop()}},Lt,this)}));function un(){return Dn.apply(this,arguments)}return un}()},{key:"confirmInput",value:function(un,Lt){var Ot;this.entity===un.entity?(this.dynamicPingpong=!0,Ot=this):Ot=un,this.textureCache[Lt].id=Ot.getOuputDataTexture().id,this.textureCache[Lt].texture=Ot.getOuputDataTexture().texture,_n&&console.log("[".concat(this.entity,"]: confirm input ").concat(Lt," from model ").concat(Ot.entity,", ").concat(Ot.getOuputDataTexture().id))}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(un,Lt){var Ot=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,it=this.context.uniforms.find(function(zt){var Vt=zt.name;return Vt===un});if(it){var H=this.calcDataTexture(un,it.type,Lt),X=H.texture,xt=H.data;this.textureCache[un].data=xt,this.textureCache[un].texture=X}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var un=this.context.output.name;this.textureCache[un].id=this.getOuputDataTexture().id,this.textureCache[un].texture=this.getOuputDataTexture().texture}var Lt=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=Lt,_n&&console.log("[".concat(this.entity,"]: after swap, output ").concat(this.getOuputDataTexture().id))}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var un=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=un}},{key:"cloneDataTexture",value:function(un){var Lt=un.data,Ot=un.textureWidth;return aa(aa({},un),{},{id:Lr++,texture:this.reGl.texture({width:Ot,height:Ot,data:Lt,type:"float"})})}},{key:"calcDataTexture",value:function(un,Lt,Ot){var it=1;Lt===lt.Vector4FloatArray&&(it=4);for(var H=[],X=0;X<Ot.length;X+=it)it===1?H.push(Ot[X],0,0,0):it===2?H.push(Ot[X],Ot[X+1],0,0):it===3?H.push(Ot[X],Ot[X+1],Ot[X+2],0):it===4&&H.push(Ot[X],Ot[X+1],Ot[X+2],Ot[X+3]);var xt=Ot.length,zt=Math.ceil(xt/it),Vt=Math.ceil(Math.sqrt(zt)),Xt=Vt*Vt;zt<Xt&&H.push.apply(H,(0,fa.Z)(new Array((Xt-zt)*4).fill(0)));var ne=this.reGl.texture({width:Vt,height:Vt,data:H,type:"float"});return{id:Lr++,data:H,originalDataLength:xt,typedArrayConstructor:Z()(Ot)?Ot.constructor:void 0,textureWidth:Vt,texture:ne,texelCount:zt,elementsPerTexel:it,isOutput:un===this.context.output.name}}}]),gt}(),Pn=function(){function gt(Dn,un){(0,j.Z)(this,gt),this.elements=void 0;var Lt=un.data,Ot=un.usage,it=un.type,H=un.count;this.elements=Dn.elements({data:Lt,usage:ke[Ot||k.STATIC_DRAW],type:Ve[it||k.UNSIGNED_BYTE],count:H})}return(0,W.Z)(gt,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(un){var Lt=un.data;this.elements.subdata(Lt)}},{key:"destroy",value:function(){this.elements.destroy()}}]),gt}(),tr=function(){function gt(Dn,un){(0,j.Z)(this,gt),this.framebuffer=void 0;var Lt=un.width,Ot=un.height,it=un.color,H=un.colors,X=un.depth,xt=un.stencil,zt={width:Lt,height:Ot};Array.isArray(H)&&(zt.colors=H.map(function(Vt){return Vt.get()})),it&&typeof it!="boolean"&&(zt.color=it.get()),this.framebuffer=Dn.framebuffer(zt)}return(0,W.Z)(gt,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(un){var Lt=un.width,Ot=un.height;this.framebuffer.resize(Lt,Ot)}}]),gt}(),zn=$(90484),Wr=$(68630),Yr=$.n(Wr);function nr(gt){var Dn={};return Object.keys(gt).forEach(function(un){wr(un,gt[un],Dn,"")}),Dn}function wr(gt,Dn,un,Lt){if(Dn===null||typeof Dn=="number"||typeof Dn=="boolean"||Array.isArray(Dn)&&typeof Dn[0]=="number"||Z()(Dn)||Dn===""||Dn.resize!==void 0){un["".concat(Lt&&Lt+".").concat(gt)]=Dn;return}Yr()(Dn)&&Object.keys(Dn).forEach(function(Ot){wr(Ot,Dn[Ot],un,"".concat(Lt&&Lt+".").concat(gt))}),Array.isArray(Dn)&&Dn.forEach(function(Ot,it){Object.keys(Ot).forEach(function(H){wr(H,Ot[H],un,"".concat(Lt&&Lt+".").concat(gt,"[").concat(it,"]"))})})}function Sr(gt,Dn){var un=Object.keys(gt);if(Object.getOwnPropertySymbols){var Lt=Object.getOwnPropertySymbols(gt);Dn&&(Lt=Lt.filter(function(Ot){return Object.getOwnPropertyDescriptor(gt,Ot).enumerable})),un.push.apply(un,Lt)}return un}function pr(gt){for(var Dn=1;Dn<arguments.length;Dn++){var un=arguments[Dn]!=null?arguments[Dn]:{};Dn%2?Sr(Object(un),!0).forEach(function(Lt){(0,tt.Z)(gt,Lt,un[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(gt,Object.getOwnPropertyDescriptors(un)):Sr(Object(un)).forEach(function(Lt){Object.defineProperty(gt,Lt,Object.getOwnPropertyDescriptor(un,Lt))})}return gt}var qr=function(){function gt(Dn,un){(0,j.Z)(this,gt),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=Dn;var Lt=un.vs,Ot=un.fs,it=un.defines,H=un.attributes,X=un.uniforms,xt=un.primitive,zt=un.count,Vt=un.elements,Xt=un.depth,ne=un.blend,on=un.stencil,tn=un.cull,He=un.instances,Qn=un.scissor,Ln=un.viewport,Qr={};X&&(this.uniforms=nr(X),Object.keys(X).forEach(function(na){Qr[na]=Dn.prop(na)}));var Ia={};Object.keys(H).forEach(function(na){Ia[na]=H[na].get()});var Jn=it&&this.generateDefines(it)||"",Ar={attributes:Ia,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(Jn,`
`).concat(Ot),uniforms:Qr,vert:`
`.concat(Jn,`
`).concat(Lt),primitive:te[xt===void 0?k.TRIANGLES:xt]};He&&(Ar.instances=He),zt&&(Ar.count=zt),Vt&&(Ar.elements=Vt.get()),Qn&&(Ar.scissor=Qn),Ln&&(Ar.viewport=Ln),this.initDepthDrawParams({depth:Xt},Ar),this.initBlendDrawParams({blend:ne},Ar),this.initStencilDrawParams({stencil:on},Ar),this.initCullDrawParams({cull:tn},Ar),this.drawCommand=Dn(Ar)}return(0,W.Z)(gt,[{key:"addUniforms",value:function(un){this.uniforms=pr(pr({},this.uniforms),nr(un))}},{key:"draw",value:function(un){var Lt=pr(pr({},this.uniforms),nr(un.uniforms||{})),Ot={};Object.keys(Lt).forEach(function(it){var H=(0,zn.Z)(Lt[it]);H==="boolean"||H==="number"||Array.isArray(Lt[it])||Lt[it].BYTES_PER_ELEMENT?Ot[it]=Lt[it]:H==="string"||(Ot[it]=Lt[it].get())}),this.drawCommand(Ot)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(un,Lt){var Ot=un.depth;Ot&&(Lt.depth={enable:Ot.enable===void 0?!0:!!Ot.enable,mask:Ot.mask===void 0?!0:!!Ot.mask,func:fn[Ot.func||k.LESS],range:Ot.range||[0,1]})}},{key:"initBlendDrawParams",value:function(un,Lt){var Ot=un.blend;if(Ot){var it=Ot.enable,H=Ot.func,X=Ot.equation,xt=Ot.color,zt=xt===void 0?[0,0,0,0]:xt;Lt.blend={enable:!!it,func:{srcRGB:Xn[H&&H.srcRGB||k.SRC_ALPHA],srcAlpha:Xn[H&&H.srcAlpha||k.SRC_ALPHA],dstRGB:Xn[H&&H.dstRGB||k.ONE_MINUS_SRC_ALPHA],dstAlpha:Xn[H&&H.dstAlpha||k.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Rt[X&&X.rgb||k.FUNC_ADD],alpha:Rt[X&&X.alpha||k.FUNC_ADD]},color:zt}}}},{key:"initStencilDrawParams",value:function(un,Lt){var Ot=un.stencil;if(Ot){var it=Ot.enable,H=Ot.mask,X=H===void 0?-1:H,xt=Ot.func,zt=xt===void 0?{cmp:k.ALWAYS,ref:0,mask:-1}:xt,Vt=Ot.opFront,Xt=Vt===void 0?{fail:k.KEEP,zfail:k.KEEP,zpass:k.KEEP}:Vt,ne=Ot.opBack,on=ne===void 0?{fail:k.KEEP,zfail:k.KEEP,zpass:k.KEEP}:ne;Lt.stencil={enable:!!it,mask:X,func:pr(pr({},zt),{},{cmp:Bn[zt.cmp]}),opFront:{fail:xr[Xt.fail],zfail:xr[Xt.zfail],zpass:xr[Xt.zpass]},opBack:{fail:xr[on.fail],zfail:xr[on.zfail],zpass:xr[on.zpass]}}}}},{key:"initCullDrawParams",value:function(un,Lt){var Ot=un.cull;if(Ot){var it=Ot.enable,H=Ot.face,X=H===void 0?k.BACK:H;Lt.cull={enable:!!it,face:dr[X]}}}},{key:"generateDefines",value:function(un){return Object.keys(un).map(function(Lt){return"#define ".concat(Lt," ").concat(Number(un[Lt]))}).join(`
`)}}]),gt}(),ua=function(){function gt(Dn,un){(0,j.Z)(this,gt),this.texture=void 0,this.width=void 0,this.height=void 0;var Lt=un.data,Ot=un.type,it=Ot===void 0?k.UNSIGNED_BYTE:Ot,H=un.width,X=un.height,xt=un.flipY,zt=xt===void 0?!1:xt,Vt=un.format,Xt=Vt===void 0?k.RGBA:Vt,ne=un.mipmap,on=ne===void 0?!1:ne,tn=un.wrapS,He=tn===void 0?k.CLAMP_TO_EDGE:tn,Qn=un.wrapT,Ln=Qn===void 0?k.CLAMP_TO_EDGE:Qn,Qr=un.aniso,Ia=Qr===void 0?0:Qr,Jn=un.alignment,Ar=Jn===void 0?1:Jn,na=un.premultiplyAlpha,za=na===void 0?!1:na,da=un.mag,Ti=da===void 0?k.NEAREST:da,ki=un.min,vi=ki===void 0?k.NEAREST:ki,ii=un.colorSpace,Di=ii===void 0?k.BROWSER_DEFAULT_WEBGL:ii;this.width=H,this.height=X;var Ra={width:H,height:X,type:Ve[it],format:ee[Xt],wrapS:Me[He],wrapT:Me[Ln],mag:bt[Ti],min:bt[vi],alignment:Ar,flipY:zt,colorSpace:en[Di],premultiplyAlpha:za,aniso:Ia};Lt&&(Ra.data=Lt),typeof on=="number"?Ra.mipmap=Ft[on]:typeof on=="boolean"&&(Ra.mipmap=on),this.texture=Dn.texture(Ra)}return(0,W.Z)(gt,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(un){var Lt=un.width,Ot=un.height;this.texture.resize(Lt,Ot),this.width=Lt,this.height=Ot}},{key:"destroy",value:function(){this.texture.destroy()}}]),gt}(),$r=function(){function gt(){var Dn=this;(0,j.Z)(this,gt),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var un=(0,Y.Z)(B().mark(function Lt(Ot){return B().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!Ot.uniforms){H.next=3;break}return H.next=3,Promise.all(Object.keys(Ot.uniforms).map(function(){var X=(0,Y.Z)(B().mark(function xt(zt){var Vt;return B().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(!(Ot.uniforms[zt]&&Ot.uniforms[zt].load!==void 0)){ne.next=5;break}return ne.next=3,Ot.uniforms[zt].load();case 3:Vt=ne.sent,Ot.uniforms[zt]=Vt;case 5:case"end":return ne.stop()}},xt)}));return function(xt){return X.apply(this,arguments)}}()));case 3:return H.abrupt("return",new qr(Dn.gl,Ot));case 4:case"end":return H.stop()}},Lt)}));return function(Lt){return un.apply(this,arguments)}}(),this.createAttribute=function(un){return new Ne(Dn.gl,un)},this.createBuffer=function(un){return new Ur(Dn.gl,un)},this.createElements=function(un){return new Pn(Dn.gl,un)},this.createTexture2D=function(un){return new ua(Dn.gl,un)},this.createFramebuffer=function(un){return new tr(Dn.gl,un)},this.useFramebuffer=function(un,Lt){Dn.gl({framebuffer:un?un.get():null})(Lt)},this.createComputeModel=function(){var un=(0,Y.Z)(B().mark(function Lt(Ot){return B().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.abrupt("return",new sr(Dn.gl,Ot));case 1:case"end":return H.stop()}},Lt)}));return function(Lt){return un.apply(this,arguments)}}(),this.clear=function(un){var Lt=un.color,Ot=un.depth,it=un.stencil,H=un.framebuffer,X=H===void 0?null:H,xt={color:Lt,depth:Ot,stencil:it};xt.framebuffer=X===null?X:X.get(),Dn.gl.clear(xt)},this.setScissor=function(un){Dn.gl&&Dn.gl._gl&&(un.enable&&un.box?(Dn.gl._gl.enable(k.SCISSOR_TEST),Dn.gl._gl.scissor(un.box.x,un.box.y,un.box.width,un.box.height)):Dn.gl._gl.disable(k.SCISSOR_TEST),Dn.gl._refresh())},this.viewport=function(un){var Lt=un.x,Ot=un.y,it=un.width,H=un.height;Dn.gl&&Dn.gl._gl&&(Dn.gl._gl.viewport(Lt,Ot,it,H),Dn.gl._refresh())},this.readPixels=function(un){var Lt=un.framebuffer,Ot=un.x,it=un.y,H=un.width,X=un.height,xt={x:Ot,y:it,width:H,height:X};return Lt&&(xt.framebuffer=Lt.get()),Dn.gl.read(xt)},this.getCanvas=function(){return Dn.$canvas},this.getGLContext=function(){return Dn.gl._gl},this.destroy=function(){Dn.gl&&(Dn.gl.destroy(),Dn.inited=!1)}}return(0,W.Z)(gt,[{key:"init",value:function(){var Dn=(0,Y.Z)(B().mark(function Lt(Ot){return B().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!this.inited){H.next=2;break}return H.abrupt("return");case 2:return this.$canvas=Ot.canvas,H.next=5,new Promise(function(X,xt){Le()({canvas:Ot.canvas,attributes:{alpha:!0,antialias:Ot.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(Vt,Xt){(Vt||!Xt)&&xt(Vt),X(Xt)}})});case 5:this.gl=H.sent,this.inited=!0;case 7:case"end":return H.stop()}},Lt,this)}));function un(Lt){return Dn.apply(this,arguments)}return un}()},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),gt}(),ba=function(){function gt(){(0,j.Z)(this,gt),this.engine=void 0,this.configService=new yt}return(0,W.Z)(gt,[{key:"setConfig",value:function(un){this.configService.set(un)}},{key:"setEngine",value:function(un){this.engine=un}},{key:"createEntity",value:function(){return K()}},{key:"createKernel",value:function(un){var Lt=new ue(this.engine,this.configService);return typeof un=="string"?Lt.setBundle(JSON.parse(un)):Lt.setBundle(un),Lt.init(),Lt}},{key:"destroy",value:function(){this.engine.destroy()}}],[{key:"create",value:function(){var un=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Lt=new gt;return Lt.setConfig(un),Lt.setEngine(new $r),Lt}}]),gt}()},9106:function(ur,ot,$){"use strict";$.d(ot,{ZP:function(){return tx}});var Y={};$.r(Y),$.d(Y,{GADDI:function(){return is},Stack:function(){return Du},breadthFirstSearch:function(){return Ve},connectedComponent:function(){return bt},cosineSimilarity:function(){return Ia},default:function(){return Cu},depthFirstSearch:function(){return xr},detectAllCycles:function(){return Ea},detectAllDirectedCycle:function(){return fa},detectAllUndirectedCycle:function(){return Ur},detectCycle:function(){return aa},detectDirectedCycle:function(){return qs},dijkstra:function(){return _n},findAllPath:function(){return tr},findShortestPath:function(){return Pn},floydWarshall:function(){return Wr},getAdjMatrix:function(){return de},getDegree:function(){return en},getInDegree:function(){return fn},getNeighbors:function(){return Ae},getOutDegree:function(){return Rt},iLouvain:function(){return ne},kCore:function(){return tn},kMeans:function(){return Ln},labelPropagation:function(){return nr},louvain:function(){return Vt},minimumSpanningTree:function(){return Ra},nodesCosineSimilarity:function(){return Ar},pageRank:function(){return De}});var tt={};$.r(tt),$.d(tt,{Line:function(){return Pu},applyMatrix:function(){return Vr},compare:function(){return os},distance:function(){return Vi},floydWarshall:function(){return ao},fractionToLine:function(){return gu},getAdjMatrix:function(){return So},getBBoxBoundLine:function(){return Nu},getCircleCenterByPoints:function(){return Fa},getCircleIntersectByPoint:function(){return Qu},getDegree:function(){return Au},getEllipseIntersectByPoint:function(){return xn},getLineIntersect:function(){return Ss},getPointsCenter:function(){return Fu},getRectIntersectByPoint:function(){return Qs},intersectBBox:function(){return Js},invertMatrix:function(){return pa},isPointInPolygon:function(){return bl},isPointsOverlap:function(){return tu},isPolygonsIntersect:function(){return Mu},itemIntersectByLine:function(){return Bs},lerp:function(){return vl},lerpArray:function(){return Ls},move:function(){return fo},pointLineDistance:function(){return Bl},pointLineSquareDist:function(){return Ju},pointRectSquareDist:function(){return gc},rotate:function(){return Cs},scale:function(){return ou},scaleMatrix:function(){return Ao},squareDist:function(){return Wu},translate:function(){return Ts}});var j={};$.r(j),$.d(j,{cloneBesidesImg:function(){return Rl},getAnimateCfgWithCallback:function(){return Ll},getBBox:function(){return Oa},getComboBBox:function(){return su},getLabelPosition:function(){return Ai},getLetterWidth:function(){return Ro},getLoopCfgs:function(){return so},getTextSize:function(){return Ys},plainCombosToTrees:function(){return As},reconstructTree:function(){return Vs},shouldRefreshEdge:function(){return xl},traverseTree:function(){return wo},traverseTreeUp:function(){return ho},truncateLabelByLength:function(){return Ps}});var W={};$.r(W),$.d(W,{catmullRomToBezier:function(){return Kt},fillPath:function(){return Hu},fillPathByDiff:function(){return uu},formatPath:function(){return zl},intersection:function(){return Vu},parsePathArray:function(){return We},parsePathString:function(){return rt},pathToAbsolute:function(){return Re},pathToCurve:function(){return Mn},rectPath:function(){return ma}});var Q={};$.r(Q),$.d(Q,{easeBack:function(){return Dv},easeBackIn:function(){return Jv},easeBackInOut:function(){return Dv},easeBackOut:function(){return mu},easeBounce:function(){return $s},easeBounceIn:function(){return Wd},easeBounceInOut:function(){return md},easeBounceOut:function(){return $s},easeCircle:function(){return Bd},easeCircleIn:function(){return Fd},easeCircleInOut:function(){return Bd},easeCircleOut:function(){return Sp},easeCubic:function(){return Kp},easeCubicIn:function(){return pd},easeCubicInOut:function(){return Kp},easeCubicOut:function(){return th},easeElastic:function(){return ev},easeElasticIn:function(){return tv},easeElasticInOut:function(){return nv},easeElasticOut:function(){return ev},easeExp:function(){return Pd},easeExpIn:function(){return vd},easeExpInOut:function(){return Pd},easeExpOut:function(){return Hh},easeLinear:function(){return Nv},easePoly:function(){return Ld},easePolyIn:function(){return Sg},easePolyInOut:function(){return Ld},easePolyOut:function(){return Qv},easeQuad:function(){return qi},easeQuadIn:function(){return zs},easeQuadInOut:function(){return qi},easeQuadOut:function(){return af},easeSin:function(){return Qp},easeSinIn:function(){return kv},easeSinInOut:function(){return Qp},easeSinOut:function(){return qp}});var Z={};$.r(Z),$.d(Z,{calculationItemsBBox:function(){return It},cloneEvent:function(){return J},formatPadding:function(){return D},isNaN:function(){return vt},isViewportChanged:function(){return ct},processParallelEdges:function(){return Bt},uniqueId:function(){return S}});var R={};$.r(R),$.d(R,{getClosedSpline:function(){return Wm},getControlPoint:function(){return qh},getSpline:function(){return kp},getStarPath:function(){return D1},paddedHull:function(){return um},pathToPoints:function(){return Cg},pointsToPolygon:function(){return W0},roundedHull:function(){return sm}});var L={};$.r(L),$.d(L,{defaultSubjectColors:function(){return Hm}});var C={};$.r(C),$.d(C,{isForce:function(){return Fx}});var A={};$.r(A),$.d(A,{Base:function(){return Dp},Circle:function(){return Xx},Ellipse:function(){return Uc},Image:function(){return Jh},Line:function(){return KS},Marker:function(){return qS},Path:function(){return kg},Polygon:function(){return a2},Polyline:function(){return vm},Rect:function(){return yA},Text:function(){return Y1}});var N={};$.r(N),$.d(N,{Base:function(){return Yd},Circle:function(){return p2},Dom:function(){return g2},Ellipse:function(){return y2},Image:function(){return b2},Line:function(){return x2},Marker:function(){return w2},Path:function(){return E2},Polygon:function(){return S2},Polyline:function(){return C2},Rect:function(){return I2},Text:function(){return M2}});var B={};$.r(B),$.d(B,{getColorSetsBySubjectColors:function(){return K2},getColorsWithSubjectColor:function(){return ob},mixColor:function(){return yf}});var O={};$.r(O),$.d(O,{arrayToTextureData:function(){return eC},attributesToTextureData:function(){return vw},buildTextureData:function(){return Q2},buildTextureDataWithOneEdgeAttr:function(){return J2},buildTextureDataWithTwoEdgeAttr:function(){return tC},proccessToFunc:function(){return yy},radialLayout:function(){return nC}});var F={};$.r(F),$.d(F,{gpuDetector:function(){return by}});var K={};$.r(K),$.d(K,{getBrowserName:function(){return gw}});var nt={};$.r(nt),$.d(nt,{assign:function(){return bv},default:function(){return Yw},defaultI18n:function(){return Oy},format:function(){return Hw},parse:function(){return Xw},setGlobalDateI18n:function(){return Bw},setGlobalDateMasks:function(){return jw}});var P=$(65353),k=$(23044),yt={getDefaultCfg:function(){return{}},getEvents:function(){return{}},updateCfg:function(a){return Object.assign(this,a),!0},shouldBegin:function(){return!0},shouldUpdate:function(){return!0},shouldEnd:function(){return!0},bind:function(a){var e=this,i=this.events;this.graph=a,(this.type==="drag-canvas"||this.type==="brush-select"||this.type==="lasso-select")&&a.get("canvas").set("draggable",!0),(0,k.each)(i,function(s,l){a.on(l,s)}),document.addEventListener("visibilitychange",function(){e.keydown=!1})},unbind:function(a){var e=this.events,i=a.get("canvas").get("draggable");(this.type==="drag-canvas"||this.type==="brush-select"||this.type==="lasso-select")&&a.get("canvas").set("draggable",!1),(0,k.each)(e,function(s,l){a.off(l,s)}),a.get("canvas").set("draggable",i)},get:function(a){return this[a]},set:function(a,e){return this[a]=e,this}},st=function(){function c(){}return c.registerBehavior=function(a,e){if(!e)throw new Error("please specify handler for this behavior: ".concat(a));var i=(0,k.clone)(yt);Object.assign(i,e);var s=function(f){var d=this;Object.assign(this,this.getDefaultCfg(),f);var v=this.getEvents();this.events=null;var x={};v&&((0,k.each)(v,function(w,I){x[I]=(0,k.wrapBehavior)(d,w)}),this.events=x)};s.prototype=i,c.types[a]=s},c.hasBehavior=function(a){return!!c.types[a]},c.getBehavior=function(a){return c.types[a]},c.types={},c}(),lt=st,ht=lt,mt="*",wt=function(){function c(){this._events={}}return c.prototype.on=function(a,e,i){return this._events[a]||(this._events[a]=[]),this._events[a].push({callback:e,once:!!i}),this},c.prototype.once=function(a,e){return this.on(a,e,!0)},c.prototype.emit=function(a){for(var e=this,i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var l=this._events[a]||[],f=this._events[mt]||[],d=function(v){for(var x=v.length,w=0;w<x;w++)if(!!v[w]){var I=v[w],G=I.callback,U=I.once;U&&(v.splice(w,1),v.length===0&&delete e._events[a],x--,w--),G.apply(e,i)}};d(l),d(f)},c.prototype.off=function(a,e){if(!a)this._events={};else if(!e)delete this._events[a];else{for(var i=this._events[a]||[],s=i.length,l=0;l<s;l++)i[l].callback===e&&(i.splice(l,1),s--,l--);i.length===0&&delete this._events[a]}return this},c.prototype.getEvents=function(){return this._events},c}(),ut=wt,pt=$(35600);function Nt(c,a,e){var i=[0,0,0,0,0,0,0,0,0];return pt.fromTranslation(i,e),pt.multiply(c,i,a)}function Ut(c,a,e){var i=[0,0,0,0,0,0,0,0,0];return pt.fromRotation(i,e),pt.multiply(c,i,a)}function ue(c,a,e){var i=[0,0,0,0,0,0,0,0,0];return pt.fromScaling(i,e),pt.multiply(c,i,a)}function se(c,a,e){return pt.multiply(c,e,a)}function Le(c,a){for(var e=c?[].concat(c):[1,0,0,0,1,0,0,0,1],i=0,s=a.length;i<s;i++){var l=a[i];switch(l[0]){case"t":Nt(e,e,[l[1],l[2]]);break;case"s":ue(e,e,[l[1],l[2]]);break;case"r":Ut(e,e,l[1]);break;case"m":se(e,e,l[1]);break;default:break}}return e}function Ne(c,a){return c[0]*a[1]-a[0]*c[1]}function we(c,a,e){var i=vec2.angle(c,a),s=Ne(c,a)>=0;return e?s?Math.PI*2-i:i:s?i:Math.PI*2-i}function At(c,a,e){return e?(c[0]=a[1],c[1]=-1*a[0]):(c[0]=-1*a[1],c[1]=a[0]),c}var Qt=function(a,e){var i=a.nodes,s=a.edges,l=[],f={};if(!i)throw new Error("invalid nodes data!");return i&&i.forEach(function(d,v){f[d.id]=v;var x=[];l.push(x)}),s&&s.forEach(function(d){var v=d.source,x=d.target,w=f[v],I=f[x];!w&&w!==0||!I&&I!==0||(l[w][I]=1,e||(l[I][w]=1))}),l},de=Qt,rn=function(a,e){return a===e},Ee=function(){function c(a,e){e===void 0&&(e=null),this.value=a,this.next=e}return c.prototype.toString=function(a){return a?a(this.value):"".concat(this.value)},c}(),ce=function(){function c(a){a===void 0&&(a=rn),this.head=null,this.tail=null,this.compare=a}return c.prototype.prepend=function(a){var e=new Ee(a,this.head);return this.head=e,this.tail||(this.tail=e),this},c.prototype.append=function(a){var e=new Ee(a);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},c.prototype.delete=function(a){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,a);)e=this.head,this.head=this.head.next;var i=this.head;if(i!==null)for(;i.next;)this.compare(i.next.value,a)?(e=i.next,i.next=i.next.next):i=i.next;return this.compare(this.tail.value,a)&&(this.tail=i),e},c.prototype.find=function(a){var e=a.value,i=e===void 0?void 0:e,s=a.callback,l=s===void 0?void 0:s;if(!this.head)return null;for(var f=this.head;f;){if(l&&l(f.value)||i!==void 0&&this.compare(f.value,i))return f;f=f.next}return null},c.prototype.deleteTail=function(){var a=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,a;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,a},c.prototype.deleteHead=function(){if(!this.head)return null;var a=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),a},c.prototype.fromArray=function(a){var e=this;return a.forEach(function(i){return e.append(i)}),this},c.prototype.toArray=function(){for(var a=[],e=this.head;e;)a.push(e),e=e.next;return a},c.prototype.reverse=function(){for(var a=this.head,e=null,i=null;a;)i=a.next,a.next=e,e=a,a=i;this.tail=this.head,this.head=e},c.prototype.toString=function(a){return a===void 0&&(a=void 0),this.toArray().map(function(e){return e.toString(a)}).toString()},c}(),Oe=ce,Ze=function(){function c(){this.linkedList=new Oe}return c.prototype.isEmpty=function(){return!this.linkedList.head},c.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},c.prototype.enqueue=function(a){this.linkedList.append(a)},c.prototype.dequeue=function(){var a=this.linkedList.deleteHead();return a?a.value:null},c.prototype.toString=function(a){return this.linkedList.toString(a)},c}(),fe=Ze,Ae=function(a,e,i){e===void 0&&(e=[]);var s=e.filter(function(v){return v.source===a||v.target===a});if(i==="target"){var l=function(x){return x.source===a};return s.filter(l).map(function(v){return v.target})}if(i==="source"){var f=function(x){return x.target===a};return s.filter(f).map(function(v){return v.source})}var d=function(x){return x.source===a?x.target:x.source};return s.map(d)},Ye=function(a,e){return e.filter(function(i){return i.source===a})},ge=function(a,e){return e.filter(function(i){return i.source===a||i.target===a})},Be=function(a){a===void 0&&(a=0);var e="".concat(Math.random()).split(".")[1].substr(0,5),i="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(a,"-").concat(e).concat(i)};function te(c){c===void 0&&(c={});var a=c,e=function(){},i=function(){var s={};return function(l){var f=l.next,d=f;return s[d]?!1:(s[d]=!0,!0)}}();return a.allowTraversal=c.allowTraversal||i,a.enter=c.enter||e,a.leave=c.leave||e,a}var ke=function(a,e,i,s){s===void 0&&(s=!0);var l=te(i),f=new fe,d=a.edges,v=d===void 0?[]:d;f.enqueue(e);for(var x="",w=function(){var G=f.dequeue();l.enter({current:G,previous:x}),Ae(G,v,s?"target":void 0).forEach(function(U){l.allowTraversal({previous:x,current:G,next:U})&&f.enqueue(U)}),l.leave({current:G,previous:x}),x=G};!f.isEmpty();)w()},Ve=ke,ee=function(a){for(var e=a.nodes,i=e===void 0?[]:e,s=a.edges,l=s===void 0?[]:s,f=[],d={},v=[],x=function U(et){v.push(et),d[et.id]=!0;for(var ft=Ae(et.id,l),Ct=function($t){var Jt=ft[$t];if(!d[Jt]){var Ce=i.filter(function(je){return je.id===Jt});Ce.length>0&&U(Ce[0])}},Mt=0;Mt<ft.length;++Mt)Ct(Mt)},w=0;w<i.length;w++){var I=i[w];if(!d[I.id]){x(I);for(var G=[];v.length>0;)G.push(v.pop());f.push(G)}}return f},Ft=function(a){for(var e=a.nodes,i=e===void 0?[]:e,s=a.edges,l=s===void 0?[]:s,f=[],d={},v={},x={},w=[],I=0,G=function Ct(Mt){v[Mt.id]=I,x[Mt.id]=I,I+=1,f.push(Mt),d[Mt.id]=!0;for(var kt=Ae(Mt.id,l,"target").filter(function(ze){return i.map(function(pn){return pn.id}).indexOf(ze)>-1}),$t=function(pn){var Fn=kt[pn];if(!v[Fn]&&v[Fn]!==0){var Tn=i.filter(function(cr){return cr.id===Fn});Tn.length>0&&Ct(Tn[0]),x[Mt.id]=Math.min(x[Mt.id],x[Fn])}else d[Fn]&&(x[Mt.id]=Math.min(x[Mt.id],v[Fn]))},Jt=0;Jt<kt.length;Jt++)$t(Jt);if(x[Mt.id]===v[Mt.id]){for(var Ce=[];f.length>0;){var je=f.pop();if(d[je.id]=!1,Ce.push(je),je===Mt)break}Ce.length>0&&w.push(Ce)}},U=0,et=i;U<et.length;U++){var ft=et[U];!v[ft.id]&&v[ft.id]!==0&&G(ft)}return w};function bt(c,a){return a?Ft(c):ee(c)}var Me=function(a){var e={},i=a.nodes,s=i===void 0?[]:i,l=a.edges,f=l===void 0?[]:l;return s.forEach(function(d){e[d.id]={degree:0,inDegree:0,outDegree:0}}),f.forEach(function(d){e[d.source].degree++,e[d.source].outDegree++,e[d.target].degree++,e[d.target].inDegree++}),e},en=Me,fn=function(a,e){var i=Me(a);return i[e]?Me(a)[e].inDegree:0},Rt=function(a,e){var i=Me(a);return i[e]?Me(a)[e].outDegree:0};function Xn(c){c===void 0&&(c={});var a=c,e=function(){},i=function(){var s={};return function(l){var f=l.next;return s[f]?!1:(s[f]=!0,!0)}}();return a.allowTraversal=c.allowTraversal||i,a.enter=c.enter||e,a.leave=c.leave||e,a}function Bn(c,a,e,i){i.enter({current:a,previous:e});var s=c.edges,l=s===void 0?[]:s;Ae(a,l,"target").forEach(function(f){i.allowTraversal({previous:e,current:a,next:f})&&Bn(c,f,a,i)}),i.leave({current:a,previous:e})}function xr(c,a,e){Bn(c,a,"",Xn(e))}var dr=function(a){var e=null,i=a.nodes,s=i===void 0?[]:i,l={},f={},d={},v={};s.forEach(function(I){f[I.id]=I});for(var x={enter:function(G){var U=G.current,et=G.previous;if(d[U]){e={};for(var ft=U,Ct=et;Ct!==U;)e[ft]=Ct,ft=Ct,Ct=l[Ct];e[ft]=Ct}else d[U]=U,delete f[U],l[U]=et},leave:function(G){var U=G.current;v[U]=U,delete d[U]},allowTraversal:function(G){var U=G.next;return e?!1:!v[U]}};Object.keys(f).length;){var w=Object.keys(f)[0];xr(a,w,x)}return e},Ur=function(a,e,i){var s,l;i===void 0&&(i=!0);for(var f=[],d=bt(a,!1),v=0,x=d;v<x.length;v++){var w=x[v];if(!!w.length)for(var I=w[0],G=I.id,U=[I],et=(s={},s[G]=I,s),ft=(l={},l[G]=new Set,l);U.length>0;)for(var Ct=U.pop(),Mt=Ct.id,kt=Ae(Mt,a.edges),$t=function(je){var ze,pn=kt[je],Fn=a.nodes.find(function(ei){return ei.id===pn});if(pn===Mt)f.push((ze={},ze[pn]=Ct,ze));else if(!(pn in ft))et[pn]=Ct,U.push(Fn),ft[pn]=new Set([Ct]);else if(!ft[Mt].has(Fn)){for(var Tn=!0,cr=[Fn,Ct],kr=et[Mt];ft[pn].size&&!ft[pn].has(kr)&&(cr.push(kr),kr!==et[kr.id]);)kr=et[kr.id];if(cr.push(kr),e&&i?(Tn=!1,cr.findIndex(function(ei){return e.indexOf(ei.id)>-1})>-1&&(Tn=!0)):e&&!i&&cr.findIndex(function(ei){return e.indexOf(ei.id)>-1})>-1&&(Tn=!1),Tn){for(var Aa={},ci=1;ci<cr.length;ci+=1)Aa[cr[ci-1].id]=cr[ci];cr.length&&(Aa[cr[cr.length-1].id]=cr[0]),f.push(Aa)}ft[pn].add(Ct)}},Jt=0;Jt<kt.length;Jt+=1)$t(Jt)}return f},fa=function(a,e,i){i===void 0&&(i=!0);for(var s=[],l=new Set,f=[],d=[],v={},x={},w=function(kr){for(var Aa=[kr];Aa.length>0;){var ci=Aa.pop();l.has(ci)&&(l.delete(ci),f[ci.id].forEach(function(ei){Aa.push(ei)}),f[ci.id].clear())}},I=function cr(kr,Aa,ci){var ei=!1;if(e&&i===!1&&e.indexOf(kr.id)>-1)return ei;s.push(kr),l.add(kr);for(var Ca=ci[kr.id],Pi=0;Pi<Ca.length;Pi+=1){var Ni=v[Ca[Pi]];if(Ni===Aa){for(var _a={},Ya=1;Ya<s.length;Ya+=1)_a[s[Ya-1].id]=s[Ya];s.length&&(_a[s[s.length-1].id]=s[0]),d.push(_a),ei=!0}else l.has(Ni)||cr(Ni,Aa,ci)&&(ei=!0)}if(ei)w(kr);else for(var Pi=0;Pi<Ca.length;Pi+=1){var Ni=v[Ca[Pi]];f[Ni.id].has(kr)||f[Ni.id].add(kr)}return s.pop(),ei},G=a.nodes,U=G===void 0?[]:G,et=0;et<U.length;et+=1){var ft=U[et],Ct=ft.id;x[Ct]=et,v[et]=ft}if(e&&i)for(var Mt=function(kr){var Aa=e[kr];x[U[kr].id]=x[Aa],x[Aa]=0,v[0]=U.find(function(ci){return ci.id===Aa}),v[x[U[kr].id]]=U[kr]},et=0;et<e.length;et++)Mt(et);for(var kt=function(kr){for(var Aa,ci,ei=Infinity,Ca=0;Ca<kr.length;Ca+=1)for(var Pi=kr[Ca],Ni=0;Ni<Pi.length;Ni++){var _a=x[Pi[Ni].id];_a<ei&&(ei=_a,ci=Ca)}for(var Ya=kr[ci],hi=[],Ca=0;Ca<Ya.length;Ca+=1){var di=Ya[Ca];hi[di.id]=[];for(var Xi=0,go=Ae(di.id,a.edges,"target").filter(function(hl){return Ya.map(function(Lu){return Lu.id}).indexOf(hl)>-1});Xi<go.length;Xi++){var vs=go[Xi];vs===di.id&&!(i===!1&&e.indexOf(di.id)>-1)?d.push((Aa={},Aa[di.id]=di,Aa)):hi[di.id].push(x[vs])}}return{component:Ya,adjList:hi,minIdx:ei}},$t=0;$t<U.length;){var Jt=U.filter(function(cr){return x[cr.id]>=$t}),Ce=Ft({nodes:Jt,edges:a.edges}).filter(function(cr){return cr.length>1});if(Ce.length===0)break;var je=kt(Ce),ze=je.minIdx,pn=je.adjList,Fn=je.component;if(Fn.length>1){Fn.forEach(function(cr){f[cr.id]=new Set});var Tn=v[ze];if(e&&i&&e.indexOf(Tn.id)===-1)return d;I(Tn,Tn,pn),$t=ze+1}else break}return d},Ea=function(a,e,i,s){return s===void 0&&(s=!0),e?fa(a,i,s):Ur(a,i,s)},aa=dr,Da=function(a,e,i){for(var s=Infinity,l,f=0;f<e.length;f++){var d=e[f].id;!i[d]&&a[d]<=s&&(s=a[d],l=e[f])}return l},Lr=function(a,e,i,s){var l=a.nodes,f=l===void 0?[]:l,d=a.edges,v=d===void 0?[]:d,x=[],w={},I={},G={};f.forEach(function($t,Jt){var Ce=$t.id;x.push(Ce),I[Ce]=Infinity,Ce===e&&(I[Ce]=0)});for(var U=f.length,et=function(Jt){var Ce=Da(I,f,w),je=Ce.id;if(w[je]=!0,I[je]===Infinity)return"continue";var ze=[];i?ze=Ye(je,v):ze=ge(je,v),ze.forEach(function(pn){var Fn=pn.target,Tn=pn.source,cr=Fn===je?Tn:Fn,kr=s&&pn[s]?pn[s]:1;I[cr]>I[Ce.id]+kr?(I[cr]=I[Ce.id]+kr,G[cr]=[Ce.id]):I[cr]===I[Ce.id]+kr&&G[cr].push(Ce.id)})},ft=0;ft<U;ft++)et(ft);G[e]=[e];var Ct={};for(var Mt in I)I[Mt]!==Infinity&&sr(e,Mt,G,Ct);var kt={};for(var Mt in Ct)kt[Mt]=Ct[Mt][0];return{length:I,path:kt,allPath:Ct}},_n=Lr;function sr(c,a,e,i){if(c===a)return[c];if(i[a])return i[a];for(var s=[],l=0,f=e[a];l<f.length;l++){var d=f[l],v=sr(c,d,e,i);if(!v)return;for(var x=0,w=v;x<w.length;x++){var I=w[x];(0,k.isArray)(I)?s.push((0,P.__spreadArray)((0,P.__spreadArray)([],I,!0),[a],!1)):s.push([I,a])}}return i[a]=s,i[a]}var Pn=function(a,e,i,s,l){var f=_n(a,e,s,l),d=f.length,v=f.path,x=f.allPath;return{length:d[i],path:v[i],allPath:x[i]}},tr=function(a,e,i,s){var l;if(e===i)return[[e]];var f=a.edges,d=f===void 0?[]:f,v=[e],x=(l={},l[e]=!0,l),w=[],I=[],G=s?Ae(e,d,"target"):Ae(e,d);for(w.push(G);v.length>0&&w.length>0;){var U=w[w.length-1];if(U.length){var et=U.shift();et&&(v.push(et),x[et]=!0,G=s?Ae(et,d,"target"):Ae(et,d),w.push(G.filter(function(Mt){return!x[Mt]})))}else{var ft=v.pop();x[ft]=!1,w.pop();continue}if(v[v.length-1]===i){var Ct=v.map(function(kt){return kt});I.push(Ct);var ft=v.pop();x[ft]=!1,w.pop()}}return I},zn=function(a,e){for(var i=de(a,e),s=[],l=i.length,f=0;f<l;f+=1){s[f]=[];for(var d=0;d<l;d+=1)f===d?s[f][d]=0:i[f][d]===0||!i[f][d]?s[f][d]=Infinity:s[f][d]=i[f][d]}for(var v=0;v<l;v+=1)for(var f=0;f<l;f+=1)for(var d=0;d<l;d+=1)s[f][d]>s[f][v]+s[v][d]&&(s[f][d]=s[f][v]+s[v][d]);return s},Wr=zn,Yr=function(a,e,i,s){e===void 0&&(e=!1),i===void 0&&(i="weight"),s===void 0&&(s=1e3);var l=a.nodes,f=l===void 0?[]:l,d=a.edges,v=d===void 0?[]:d,x={},w={};f.forEach(function(Jt,Ce){var je=Be();Jt.clusterId=je,x[je]={id:je,nodes:[Jt]},w[Jt.id]={node:Jt,idx:Ce}});var I=de(a,e),G=[],U={};I.forEach(function(Jt,Ce){var je=0,ze=f[Ce].id;U[ze]={},Jt.forEach(function(pn,Fn){if(!!pn){je+=pn;var Tn=f[Fn].id;U[ze][Tn]=pn}}),G.push(je)});for(var et=0,ft=function(){var Ce=!1;if(f.forEach(function(je){var ze={};Object.keys(U[je.id]).forEach(function(ei){var Ca=U[je.id][ei],Pi=w[ei].node,Ni=Pi.clusterId;ze[Ni]||(ze[Ni]=0),ze[Ni]+=Ca});var pn=-Infinity,Fn=[];if(Object.keys(ze).forEach(function(ei){pn<ze[ei]?(pn=ze[ei],Fn=[ei]):pn===ze[ei]&&Fn.push(ei)}),!(Fn.length===1&&Fn[0]===je.clusterId)){var Tn=Fn.indexOf(je.clusterId);if(Tn>=0&&Fn.splice(Tn,1),Fn&&Fn.length){Ce=!0;var cr=x[je.clusterId],kr=cr.nodes.indexOf(je);cr.nodes.splice(kr,1);var Aa=Math.floor(Math.random()*Fn.length),ci=x[Fn[Aa]];ci.nodes.push(je),je.clusterId=ci.id}}}),!Ce)return"break";et++};et<s;){var Ct=ft();if(Ct==="break")break}Object.keys(x).forEach(function(Jt){var Ce=x[Jt];(!Ce.nodes||!Ce.nodes.length)&&delete x[Jt]});var Mt=[],kt={};v.forEach(function(Jt){var Ce=Jt.source,je=Jt.target,ze=Jt[i]||1,pn=w[Ce].node.clusterId,Fn=w[je].node.clusterId,Tn="".concat(pn,"---").concat(Fn);if(kt[Tn])kt[Tn].weight+=ze,kt[Tn].count++;else{var cr={source:pn,target:Fn,weight:ze,count:1};kt[Tn]=cr,Mt.push(cr)}});var $t=[];return Object.keys(x).forEach(function(Jt){$t.push(x[Jt])}),{clusters:$t,clusterEdges:Mt}},nr=Yr,wr=function(){function c(a){this.arr=a}return c.prototype.getArr=function(){return this.arr||[]},c.prototype.add=function(a){var e,i=a.arr;if(!((e=this.arr)===null||e===void 0?void 0:e.length))return new c(i);if(!(i==null?void 0:i.length))return new c(this.arr);if(this.arr.length===i.length){var s=[];for(var l in this.arr)s[l]=this.arr[l]+i[l];return new c(s)}},c.prototype.subtract=function(a){var e,i=a.arr;if(!((e=this.arr)===null||e===void 0?void 0:e.length))return new c(i);if(!(i==null?void 0:i.length))return new c(this.arr);if(this.arr.length===i.length){var s=[];for(var l in this.arr)s[l]=this.arr[l]-i[l];return new c(s)}},c.prototype.avg=function(a){var e=[];if(a!==0)for(var i in this.arr)e[i]=this.arr[i]/a;return new c(e)},c.prototype.negate=function(){var a=[];for(var e in this.arr)a[e]=-this.arr[e];return new c(a)},c.prototype.squareEuclideanDistance=function(a){var e,i=a.arr;if(!((e=this.arr)===null||e===void 0?void 0:e.length)||!(i==null?void 0:i.length))return 0;if(this.arr.length===i.length){var s=0;for(var l in this.arr)s+=Math.pow(this.arr[l]-a.arr[l],2);return s}},c.prototype.euclideanDistance=function(a){var e,i=a.arr;if(!((e=this.arr)===null||e===void 0?void 0:e.length)||!(i==null?void 0:i.length))return 0;if(this.arr.length===i.length){var s=0;for(var l in this.arr)s+=Math.pow(this.arr[l]-a.arr[l],2);return Math.sqrt(s)}else console.error("The two vectors are unequal in length.")},c.prototype.normalize=function(){var a=[],e=(0,k.clone)(this.arr);e.sort(function(f,d){return f-d});var i=e[e.length-1],s=e[0];for(var l in this.arr)a[l]=(this.arr[l]-s)/(i-s);return new c(a)},c.prototype.norm2=function(){var a;if(!((a=this.arr)===null||a===void 0?void 0:a.length))return 0;var e=0;for(var i in this.arr)e+=Math.pow(this.arr[i],2);return Math.sqrt(e)},c.prototype.dot=function(a){var e,i=a.arr;if(!((e=this.arr)===null||e===void 0?void 0:e.length)||!(i==null?void 0:i.length))return 0;if(this.arr.length===i.length){var s=0;for(var l in this.arr)s+=this.arr[l]*a.arr[l];return s}else console.error("The two vectors are unequal in length.")},c.prototype.equal=function(a){var e,i=a.arr;if(((e=this.arr)===null||e===void 0?void 0:e.length)!==(i==null?void 0:i.length))return!1;for(var s in this.arr)if(this.arr[s]!==i[s])return!1;return!0},c}(),Sr=wr,pr=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/,qr=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/,ua=function(a,e){a===void 0&&(a=[]),e===void 0&&(e=100);var i={};a.forEach(function(l){!l.properties||Object.keys(l.properties).forEach(function(f){if(f==="id"||!"".concat(l.properties[f]).match(pr)&&!"".concat(l.properties[f]).match(qr)&&isNaN(Number(l.properties[f]))){i.hasOwnProperty(f)&&delete i[f];return}i.hasOwnProperty(f)?i[f]+=1:i[f]=1})});var s=Object.keys(i).sort(function(l,f){return i[f]-i[l]});return s.length<e?s:s.slice(0,e)},$r=function(a,e){return e.map(function(i){return a.hasOwnProperty(i)?a[i]:0})},ba=function(a){for(var e=ua(a),i=[],s=0;s<a.length;s++)i[s]=$r(a[s].properties,e);return i},gt=function(a,e){e===void 0&&(e=void 0);var i=[];return a.forEach(function(s){e===void 0&&i.push(s),s[e]!==void 0&&i.push(s[e])}),i},Dn={getAllSortProperties:ua,getPropertyWeight:ba,getAllProperties:gt},un;(function(c){c.EuclideanDistance="euclideanDistance"})(un||(un={}));var Lt=function(a,e,i){var s=[];(e==null?void 0:e.length)?s=e:(a.forEach(function(f){s=s.concat(Object.keys(f))}),s=(0,k.uniq)(s));var l={};return s.forEach(function(f){var d=[];a.forEach(function(v){v[f]!==void 0&&v[f]!==""&&d.push(v[f])}),d.length&&!(i==null?void 0:i.includes(f))&&(l[f]=(0,k.uniq)(d))}),l},Ot=function(a,e,i){var s=Lt(a,e,i),l=[];if(!Object.keys(s).length)return l;var f=Object.values(s),d=f.every(function(v){return v.every(function(x){return typeof x=="number"})});return a.forEach(function(v,x){var w=[];Object.keys(s).forEach(function(I){var G=v[I],U=s[I],et=U.findIndex(function(Mt){return G===Mt}),ft=[];if(d)ft.push(G);else for(var Ct=0;Ct<U.length;Ct++)Ct===et?ft.push(1):ft.push(0);w=w.concat(ft)}),l[x]=w}),l},it=function(a,e,i,s){i===void 0&&(i=un.EuclideanDistance);var l=0;switch(i){case un.EuclideanDistance:l=new Sr(a).euclideanDistance(new Sr(e));break;default:break}return l},H={getAllKeyValueMap:Lt,oneHot:Ot,getDistance:it},X=function(a,e,i,s){for(var l=e.length,f=2*s,d=0,v=0;v<l;v++)for(var x=a[v].clusterId,w=0;w<l;w++){var I=a[w].clusterId;if(x===I){var G=e[v][w]||0,U=i[v]||0,et=i[w]||0;d+=G-U*et/f}}return d*=1/f,d},xt=function(a,e){a===void 0&&(a=[]);for(var i=a.length,s=new Sr([]),l=0;l<i;l++)s=s.add(new Sr(e[l]));var f=s.avg(i);f.normalize();for(var d=0,l=0;l<i;l++){var v=new Sr(e[l]),x=v.squareEuclideanDistance(f);d+=x}var w=[];a.forEach(function(){w.push([])});for(var l=0;l<i;l++){var v=new Sr(e[l]);a[l].clusterInertial=0;for(var I=0;I<i;I++){if(l===I){w[l][I]=0;continue}var G=new Sr(e[I]);w[l][I]=v.squareEuclideanDistance(G),a[l].clusterInertial+=w[l][I]}}for(var U=0,et=2*i*d,l=0;l<i;l++)for(var ft=a[l].clusterId,I=0;I<i;I++){var Ct=a[I].clusterId;if(!(l===I||ft!==Ct)){var Mt=a[l].clusterInertial*a[I].clusterInertial/Math.pow(et,2)-w[l][I]/et;U+=Mt}}return Number(U.toFixed(4))},zt=function(a,e,i,s,l,f,d,v,x){e===void 0&&(e=!1),i===void 0&&(i="weight"),s===void 0&&(s=1e-4),l===void 0&&(l=!1),f===void 0&&(f=void 0),d===void 0&&(d=[]),v===void 0&&(v=["id"]),x===void 0&&(x=1);var w=a.nodes,I=w===void 0?[]:w,G=a.edges,U=G===void 0?[]:G,et=[];if(l){I.forEach(function(_a,Ya){_a.properties=_a.properties||{},_a.originIndex=Ya});var ft=[];I.every(function(_a){return _a.hasOwnProperty("nodeType")})&&(ft=Array.from(new Set(I.map(function(_a){return _a.nodeType}))),I.forEach(function(_a){_a.properties.nodeType=ft.findIndex(function(Ya){return Ya===_a.nodeType})}));var Ct=gt(I,f);et=Ot(Ct,d,v)}var Mt=1,kt={},$t={};I.forEach(function(_a,Ya){var hi=String(Mt++);_a.clusterId=hi,kt[hi]={id:hi,nodes:[_a]},$t[_a.id]={node:_a,idx:Ya}});var Jt=de(a,e),Ce=[],je={},ze=0;Jt.forEach(function(_a,Ya){var hi=0,di=I[Ya].id;je[di]={},_a.forEach(function(Xi,go){if(!!Xi){hi+=Xi;var vs=I[go].id;je[di][vs]=Xi,ze+=Xi}}),Ce.push(hi)}),ze/=2;for(var pn=Infinity,Fn=Infinity,Tn=0,cr=[],kr={};;){l&&I.every(function(_a){return _a.hasOwnProperty("properties")})?pn=X(I,Jt,Ce,ze)+xt(I,et)*x:pn=X(I,Jt,Ce,ze),Tn===0&&(Fn=pn,cr=I,kr=kt);var Aa=pn>0&&pn>Fn&&pn-Fn<s;if(pn>Fn&&(cr=I.map(function(_a){return{node:_a,clusterId:_a.clusterId}}),kr=(0,k.clone)(kt),Fn=pn),Aa||Tn>100)break;Tn++,Object.keys(kt).forEach(function(_a){var Ya=0;U.forEach(function(hi){var di=hi.source,Xi=hi.target,go=$t[di].node.clusterId,vs=$t[Xi].node.clusterId;(go===_a&&vs!==_a||vs===_a&&go!==_a)&&(Ya=Ya+(hi[i]||1))}),kt[_a].sumTot=Ya}),I.forEach(function(_a,Ya){var hi=kt[_a.clusterId],di=0,Xi,go=Ce[Ya]/(2*ze),vs=0,Fs=hi.nodes;Fs.forEach(function(Vc){var jc=$t[Vc.id].idx;vs+=Jt[Ya][jc]||0});var hl=vs-hi.sumTot*go,Lu=Fs.filter(function(Vc){return Vc.id!==_a.id}),dl=[];Lu.forEach(function(Vc,jc){dl[jc]=et[Vc.originIndex]});var _l=xt(Lu,et)*x,rc=je[_a.id];if(Object.keys(rc).forEach(function(Vc){var jc=$t[Vc].node,Oh=jc.clusterId;if(Oh!==_a.clusterId){var Df=kt[Oh],Rh=Df.nodes;if(!(!Rh||!Rh.length)){var au=0;Rh.forEach(function(xu){var wu=$t[xu.id].idx;au+=Jt[Ya][wu]||0});var Ku=au-Df.sumTot*go,Ks=Rh.concat([_a]),Zu=[];Ks.forEach(function(xu,wu){Zu[wu]=et[xu.originIndex]});var Il=xt(Ks,et)*x,Ho=Ku-hl;l&&(Ho=Ku+Il-(hl+_l)),Ho>di&&(di=Ho,Xi=Df)}}}),di>0){Xi.nodes.push(_a);var Vl=_a.clusterId;_a.clusterId=Xi.id;var zp=hi.nodes.indexOf(_a);hi.nodes.splice(zp,1);var xf=0,Dh=0;U.forEach(function(Vc){var jc=Vc.source,Oh=Vc.target,Df=$t[jc].node.clusterId,Rh=$t[Oh].node.clusterId;(Df===Xi.id&&Rh!==Xi.id||Rh===Xi.id&&Df!==Xi.id)&&(xf=xf+(Vc[i]||1)),(Df===Vl&&Rh!==Vl||Rh===Vl&&Df!==Vl)&&(Dh=Dh+(Vc[i]||1))}),Xi.sumTot=xf,hi.sumTot=Dh}})}var ci={},ei=0;Object.keys(kr).forEach(function(_a){var Ya=kr[_a];if(!Ya.nodes||!Ya.nodes.length){delete kr[_a];return}var hi=String(ei+1);hi!==_a&&(Ya.id=hi,Ya.nodes=Ya.nodes.map(function(di){return{id:di.id,clusterId:hi}}),kr[hi]=Ya,ci[_a]=hi,delete kr[_a],ei++)}),cr.forEach(function(_a){var Ya=_a.node,hi=_a.clusterId;!Ya||(Ya.clusterId=hi,Ya.clusterId&&ci[Ya.clusterId]&&(Ya.clusterId=ci[Ya.clusterId]))});var Ca=[],Pi={};U.forEach(function(_a){var Ya=_a.source,hi=_a.target,di=_a[i]||1,Xi=$t[Ya].node.clusterId,go=$t[hi].node.clusterId;if(!(!Xi||!go)){var vs="".concat(Xi,"---").concat(go);if(Pi[vs])Pi[vs].weight+=di,Pi[vs].count++;else{var Fs={source:Xi,target:go,weight:di,count:1};Pi[vs]=Fs,Ca.push(Fs)}}});var Ni=[];return Object.keys(kr).forEach(function(_a){Ni.push(kr[_a])}),{clusters:Ni,clusterEdges:Ca}},Vt=zt,Xt=function(a,e,i,s,l,f,d,v){return e===void 0&&(e=!1),i===void 0&&(i="weight"),s===void 0&&(s=1e-4),l===void 0&&(l=void 0),f===void 0&&(f=[]),d===void 0&&(d=["id"]),v===void 0&&(v=1),Vt(a,e,i,s,!0,l,f,d,v)},ne=Xt,on=function(a,e){var i;e===void 0&&(e=1);for(var s=(0,k.clone)(a),l=s.nodes,f=l===void 0?[]:l,d=s.edges,v=d===void 0?[]:d,x=function(){var G=en({nodes:f,edges:v}),U=Object.keys(G);U.sort(function(Ct,Mt){var kt,$t;return((kt=G[Ct])===null||kt===void 0?void 0:kt.degree)-(($t=G[Mt])===null||$t===void 0?void 0:$t.degree)});var et=U[0];if(!f.length||((i=G[et])===null||i===void 0?void 0:i.degree)>=e)return"break";var ft=f.findIndex(function(Ct){return Ct.id===et});f.splice(ft,1),v=v.filter(function(Ct){return!(Ct.source===et||Ct.target===et)})};;){var w=x();if(w==="break")break}return{nodes:f,edges:v}},tn=on,He=function(a,e,i){var s=[];switch(a){case un.EuclideanDistance:s=e[i];break;default:s=[];break}return s},Qn=function(a,e,i,s,l,f){e===void 0&&(e=3),i===void 0&&(i=void 0),s===void 0&&(s=[]),l===void 0&&(l=["id"]),f===void 0&&(f=un.EuclideanDistance);var d=a.nodes,v=d===void 0?[]:d,x=a.edges,w=x===void 0?[]:x,I={clusters:[{id:"0",nodes:v}],clusterEdges:[]};if(f===un.EuclideanDistance&&!v.every(function(hi){return hi.hasOwnProperty(i)}))return I;var G=[],U=[];if(f===un.EuclideanDistance&&(G=gt(v,i),U=Ot(G,s,l)),!U.length)return I;for(var et=(0,k.uniq)(U.map(function(hi){return hi.join("")})),ft=Math.min(e,v.length,et.length),Ct=0;Ct<v.length;Ct++)v[Ct].originIndex=Ct;for(var Mt=[],kt=[],$t=[],Ct=0;Ct<ft;Ct++)if(Ct===0){var Jt=Math.floor(Math.random()*v.length);switch(f){case un.EuclideanDistance:Mt[Ct]=U[Jt];break;default:Mt[Ct]=[];break}kt.push(Jt),$t[Ct]=[v[Jt]],v[Jt].clusterId=String(Ct)}else{for(var Ce=-Infinity,je=0,ze=function(Xi){if(!kt.includes(Xi)){for(var go=0,vs=0;vs<Mt.length;vs++){var Fs=0;switch(f){case un.EuclideanDistance:Fs=it(U[v[Xi].originIndex],Mt[vs],f);break;default:break}go+=Fs}var hl=go/Mt.length;hl>Ce&&!Mt.find(function(Lu){return(0,k.isEqual)(Lu,He(f,U,v[Xi].originIndex))})&&(Ce=hl,je=Xi)}},pn=0;pn<v.length;pn++)ze(pn);Mt[Ct]=He(f,U,je),kt.push(je),$t[Ct]=[v[je]],v[je].clusterId=String(Ct)}for(var Fn=0;;){for(var Ct=0;Ct<v.length;Ct++){var Tn=0,cr=Infinity;if(!(Fn===0&&kt.includes(Ct))){for(var kr=0;kr<Mt.length;kr++){var Aa=0;switch(f){case un.EuclideanDistance:Aa=it(U[Ct],Mt[kr],f);break;default:break}Aa<cr&&(cr=Aa,Tn=kr)}if(v[Ct].clusterId!==void 0)for(var ci=$t[Number(v[Ct].clusterId)].length-1;ci>=0;ci--)$t[Number(v[Ct].clusterId)][ci].id===v[Ct].id&&$t[Number(v[Ct].clusterId)].splice(ci,1);v[Ct].clusterId=String(Tn),$t[Tn].push(v[Ct])}}for(var ei=!1,Ct=0;Ct<$t.length;Ct++){for(var Ca=$t[Ct],Pi=new Sr([]),kr=0;kr<Ca.length;kr++)Pi=Pi.add(new Sr(U[Ca[kr].originIndex]));var Ni=Pi.avg(Ca.length);Ni.equal(new Sr(Mt[Ct]))||(ei=!0,Mt[Ct]=Ni.getArr())}if(Fn++,v.every(function(hi){return hi.clusterId!==void 0})&&ei||Fn>=1e3)break}var _a=[],Ya={};return w.forEach(function(hi){var di,Xi,go=hi.source,vs=hi.target,Fs=(di=v.find(function(_l){return _l.id===go}))===null||di===void 0?void 0:di.clusterId,hl=(Xi=v.find(function(_l){return _l.id===vs}))===null||Xi===void 0?void 0:Xi.clusterId,Lu="".concat(Fs,"---").concat(hl);if(Ya[Lu])Ya[Lu].count++;else{var dl={source:Fs,target:hl,count:1};Ya[Lu]=dl,_a.push(dl)}}),{clusters:$t,clusterEdges:_a}},Ln=Qn,Qr=function(a,e){var i=new Sr(e),s=i.norm2(),l=new Sr(a),f=l.norm2(),d=i.dot(l),v=s*f,x=v?d/v:0;return x},Ia=Qr,Jn=function(a,e,i,s,l){a===void 0&&(a=[]),i===void 0&&(i=void 0),s===void 0&&(s=[]),l===void 0&&(l=[]);var f=(0,k.clone)(a.filter(function(G){return G.id!==e.id})),d=a.findIndex(function(G){return G.id===e.id}),v=gt(a,i),x=Ot(v,s,l),w=x[d],I=[];return f.forEach(function(G,U){if(G.id!==e.id){var et=x[U],ft=Ia(et,w);I.push(ft),G.cosineSimilarity=ft}}),f.sort(function(G,U){return U.cosineSimilarity-G.cosineSimilarity}),{allCosineSimilarity:I,similarNodes:f}},Ar=Jn,na=function(){function c(a){this.count=a.length,this.parent={};for(var e=0,i=a;e<i.length;e++){var s=i[e];this.parent[s]=s}}return c.prototype.find=function(a){for(;this.parent[a]!==a;)a=this.parent[a];return a},c.prototype.union=function(a,e){var i=this.find(a),s=this.find(e);i!==s&&(i<s?(this.parent[e]!==e&&this.union(this.parent[e],a),this.parent[e]=this.parent[a]):(this.parent[a]!==a&&this.union(this.parent[a],e),this.parent[a]=this.parent[e]))},c.prototype.connected=function(a,e){return this.find(a)===this.find(e)},c}(),za=na,da=function(a,e){return a-e},Ti=function(){function c(a){a===void 0&&(a=da),this.compareFn=a,this.list=[]}return c.prototype.getLeft=function(a){return 2*a+1},c.prototype.getRight=function(a){return 2*a+2},c.prototype.getParent=function(a){return a===0?null:Math.floor((a-1)/2)},c.prototype.isEmpty=function(){return this.list.length<=0},c.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},c.prototype.delMin=function(){var a=this.top(),e=this.list.pop();return this.list.length>0&&(this.list[0]=e,this.moveDown(0)),a},c.prototype.insert=function(a){if(a!==null){this.list.push(a);var e=this.list.length-1;return this.moveUp(e),!0}return!1},c.prototype.moveUp=function(a){for(var e=this.getParent(a);a&&a>0&&this.compareFn(this.list[e],this.list[a])>0;){var i=this.list[e];this.list[e]=this.list[a],this.list[a]=i,a=e,e=this.getParent(a)}},c.prototype.moveDown=function(a){var e,i=a,s=this.getLeft(a),l=this.getRight(a),f=this.list.length;s!==null&&s<f&&this.compareFn(this.list[i],this.list[s])>0?i=s:l!==null&&l<f&&this.compareFn(this.list[i],this.list[l])>0&&(i=l),a!==i&&(e=[this.list[i],this.list[a]],this.list[a]=e[0],this.list[i]=e[1],this.moveDown(i))},c}(),ki=Ti,vi=function(a,e){var i=[],s=a.nodes,l=s===void 0?[]:s,f=a.edges,d=f===void 0?[]:f;if(l.length===0)return i;var v=l[0],x=new Set;x.add(v);var w=function(Ct,Mt){return e?Ct.weight-Mt.weight:0},I=new ki(w);for(ge(v.id,d).forEach(function(ft){I.insert(ft)});!I.isEmpty();){var G=I.delMin(),U=G.source,et=G.target;x.has(U)&&x.has(et)||(i.push(G),x.has(U)||(x.add(U),ge(U,d).forEach(function(ft){I.insert(ft)})),x.has(et)||(x.add(et),ge(et,d).forEach(function(ft){I.insert(ft)})))}return i},ii=function(a,e){var i=[],s=a.nodes,l=s===void 0?[]:s,f=a.edges,d=f===void 0?[]:f;if(l.length===0)return i;var v=d.map(function(U){return U});e&&v.sort(function(U,et){return U.weight-et.weight});for(var x=new za(l.map(function(U){return U.id}));v.length>0;){var w=v.shift(),I=w.source,G=w.target;x.connected(I,G)||(i.push(w),x.union(I,G))}return i},Di=function(a,e,i){var s={prim:vi,kruskal:ii};return i?s[i](a,e):ii(a,e)},Ra=Di,ln=function(a,e,i){typeof e!="number"&&(e=1e-6),typeof i!="number"&&(i=.85);for(var s=1,l=0,f=1e3,d=a.nodes,v=d===void 0?[]:d,x=a.edges,w=x===void 0?[]:x,I=v.length,G,U={},et={},ft=0;ft<I;++ft){var Ct=v[ft],Mt=Ct.id;U[Mt]=1/I,et[Mt]=1/I}for(var kt=en(a);f>0&&s>e;){l=0;for(var ft=0;ft<I;++ft){var Ct=v[ft],Mt=Ct.id;if(G=0,kt[Ct.id].inDegree===0)U[Mt]=0;else{for(var $t=Ae(Mt,w,"source"),Jt=0;Jt<$t.length;++Jt){var Ce=$t[Jt],je=kt[Ce].outDegree;je>0&&(G+=et[Ce]/je)}U[Mt]=i*G,l+=U[Mt]}}l=(1-l)/I,s=0;for(var ft=0;ft<I;++ft){var Ct=v[ft],Mt=Ct.id;G=U[Mt]+l,s+=Math.abs(G-et[Mt]),et[Mt]=G}f-=1}return et},De=ln,dn=-1,Wn=-1,Gn="-1",Kn="-1",Rr=-1,xa="-1",La=function(){function c(a,e,i,s){a===void 0&&(a=dn),e===void 0&&(e=Wn),i===void 0&&(i=Wn),s===void 0&&(s=Gn),this.id=a,this.from=e,this.to=i,this.label=s}return c}(),ui=function(){function c(a,e){a===void 0&&(a=Wn),e===void 0&&(e=Kn),this.id=a,this.label=e,this.edges=[],this.edgeMap={}}return c.prototype.addEdge=function(a){this.edges.push(a),this.edgeMap[a.id]=a},c}(),Fi=function(){function c(a,e,i){a===void 0&&(a=Wn),e===void 0&&(e=!0),i===void 0&&(i=!1),this.id=a,this.edgeIdAutoIncrease=e,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=i}return c.prototype.getNodeNum=function(){return this.nodes.length},c.prototype.addNode=function(a,e){if(!this.nodeMap[a]){var i=new ui(a,e);this.nodes.push(i),this.nodeMap[a]=i,this.nodeLabelMap[e]||(this.nodeLabelMap[e]=[]),this.nodeLabelMap[e].push(a)}},c.prototype.addEdge=function(a,e,i,s){if((this.edgeIdAutoIncrease||a===void 0)&&(a=this.counter++),!(this.nodeMap[e]&&this.nodeMap[i]&&this.nodeMap[i].edgeMap[a])){var l=new La(a,e,i,s);if(this.edges.push(l),this.edgeMap[a]=l,this.nodeMap[e].addEdge(l),this.edgeLabelMap[s]||(this.edgeLabelMap[s]=[]),this.edgeLabelMap[s].push(l),!this.directed){var f=new La(a,i,e,s);this.nodeMap[i].addEdge(f),this.edgeLabelMap[s].push(f)}}},c}(),Ki=function(){function c(a,e,i,s,l){this.fromNode=a,this.toNode=e,this.nodeEdgeNodeLabel={nodeLabel1:i||Kn,edgeLabel:s||Gn,nodeLabel2:l||Kn}}return c.prototype.equalTo=function(a){return this.fromNode===a.formNode&&this.toNode===a.toNode&&this.nodeEdgeNodeLabel===a.nodeEdgeNodeLabel},c.prototype.notEqualTo=function(a){return!this.equalTo(a)},c}(),xo=function(){function c(){this.rmpath=[],this.dfsEdgeList=[]}return c.prototype.equalTo=function(a){var e=this.dfsEdgeList.length,i=a.length;if(e!==i)return!1;for(var s=0;s<e;s++)if(this.dfsEdgeList[s]!==a[s])return!1;return!0},c.prototype.notEqualTo=function(a){return!this.equalTo(a)},c.prototype.pushBack=function(a,e,i,s,l){return this.dfsEdgeList.push(new Ki(a,e,i,s,l)),this.dfsEdgeList},c.prototype.toGraph=function(a,e){a===void 0&&(a=Rr),e===void 0&&(e=!1);var i=new Fi(a,!0,e);return this.dfsEdgeList.forEach(function(s){var l=s.fromNode,f=s.toNode,d=s.nodeEdgeNodeLabel,v=d.nodeLabel1,x=d.edgeLabel,w=d.nodeLabel2;v!==Kn&&i.addNode(l,v),w!==Kn&&i.addNode(f,w),v!==Kn&&w!==v&&i.addEdge(void 0,l,f,x)}),i},c.prototype.buildRmpath=function(){this.rmpath=[];for(var a=void 0,e=this.dfsEdgeList.length,i=e-1;i>=0;i--){var s=this.dfsEdgeList[i],l=s.fromNode,f=s.toNode;l<f&&(a===void 0||f===a)&&(this.rmpath.push(i),a=l)}return this.rmpath},c.prototype.getNodeNum=function(){var a={};return this.dfsEdgeList.forEach(function(e){a[e.fromNode]||(a[e.fromNode]=!0),a[e.toNode]||(a[e.toNode]=!0)}),Object.keys(a).length},c}(),vo=function(){function c(a){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],!!a){for(;a;){var e=a.edge;this.edges.push(e),this.nodesUsed[e.from]=1,this.nodesUsed[e.to]=1,this.edgesUsed[e.id]=1,a=a.preNode}this.edges=this.edges.reverse()}}return c.prototype.hasNode=function(a){return this.nodesUsed[a.id]===1},c.prototype.hasEdge=function(a){return this.edgesUsed[a.id]===1},c}(),es=function(){function c(a){var e=a.graphs,i=a.minSupport,s=i===void 0?2:i,l=a.minNodeNum,f=l===void 0?1:l,d=a.maxNodeNum,v=d===void 0?4:d,x=a.top,w=x===void 0?10:x,I=a.directed,G=I===void 0?!1:I,U=a.verbose,et=U===void 0?!1:U;this.graphs=e,this.dfsCode=new xo,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=s,this.top=w,this.directed=G,this.counter=0,this.maxNodeNum=v,this.minNodeNum=f,this.verbose=et,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return c.prototype.findForwardRootEdges=function(a,e){var i=this,s=[],l=a.nodeMap;return e.edges.forEach(function(f){(i.directed||e.label<=l[f.to].label)&&s.push(f)}),s},c.prototype.findBackwardEdge=function(a,e,i,s){if(!this.directed&&e===i)return null;for(var l=a.nodeMap,f=l[i.to],d=f.edges,v=d.length,x=0;x<v;x++){var w=d[x];if(!(s.hasEdge(w)||w.to!==e.from)){if(this.directed){if(l[e.from].label<l[i.to].label||l[e.from].label===l[i.to].label&&e.label<=w.label)return w}else if(e.label<w.label||e.label===w.label&&l[e.to].label<=l[i.to].label)return w}}return null},c.prototype.findForwardPureEdges=function(a,e,i,s){for(var l=[],f=e.to,d=a.nodeMap[f].edges,v=d.length,x=0;x<v;x++){var w=d[x],I=a.nodeMap[w.to];i<=I.label&&!s.hasNode(I)&&l.push(w)}return l},c.prototype.findForwardRmpathEdges=function(a,e,i,s){for(var l=[],f=a.nodeMap,d=f[e.to].label,v=f[e.from],x=v.edges,w=x.length,I=0;I<w;I++){var G=x[I],U=f[G.to].label;e.to===G.to||i>U||s.hasNode(f[G.to])||(e.label<G.label||e.label===G.label&&d<=U)&&l.push(G)}return l},c.prototype.getSupport=function(a){var e={};return a.forEach(function(i){e[i.graphId]||(e[i.graphId]=!0)}),Object.keys(e).length},c.prototype.findMinLabel=function(a){var e=void 0;return Object.keys(a).forEach(function(i){var s=a[i],l=s.nodeLabel1,f=s.edgeLabel,d=s.nodeLabel2;if(!e){e={nodeLabel1:l,edgeLabel:f,nodeLabel2:d};return}(l<e.nodeLabel1||l===e.nodeLabel1&&f<e.edgeLabel||l===e.nodeLabel1&&f===e.edgeLabel&&d<e.nodeLabel2)&&(e={nodeLabel1:l,edgeLabel:f,nodeLabel2:d})}),e},c.prototype.isMin=function(){var a=this,e=this.dfsCode;if(this.verbose&&console.log("isMin checking",e),e.dfsEdgeList.length===1)return!0;var i=this.directed,s=e.toGraph(Rr,i),l=s.nodeMap,f=new xo,d={};s.nodes.forEach(function(I){var G=a.findForwardRootEdges(s,I);G.forEach(function(U){var et=l[U.to],ft="".concat(I.label,"-").concat(U.label,"-").concat(et.label);d[ft]||(d[ft]={projected:[],nodeLabel1:I.label,edgeLabel:U.label,nodeLabel2:et.label});var Ct={graphId:s.id,edge:U,preNode:null};d[ft].projected.push(Ct)})});var v=this.findMinLabel(d);if(!!v){f.dfsEdgeList.push(new Ki(0,1,v.nodeLabel1,v.edgeLabel,v.nodeLabel2));var x=function I(G){for(var U=f.buildRmpath(),et=f.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,ft=f.dfsEdgeList[U[0]].toNode,Ct={},Mt=!1,kt=0,$t=i?-1:0,Jt=function(Pi){if(Mt)return"break";G.forEach(function(Ni){var _a=new vo(Ni),Ya=a.findBackwardEdge(s,_a.edges[U[Pi]],_a.edges[U[0]],_a);Ya&&(Ct[Ya.label]||(Ct[Ya.label]={projected:[],edgeLabel:Ya.label}),Ct[Ya.label].projected.push({graphId:s.id,edge:Ct,preNode:Ni}),kt=f.dfsEdgeList[U[Pi]].fromNode,Mt=!0)})},Ce=U.length-1;Ce>$t;Ce--){var je=Jt(Ce);if(je==="break")break}if(Mt){var ze=a.findMinLabel(Ct);f.dfsEdgeList.push(new Ki(ft,kt,Kn,ze.edgeLabel,Kn));var pn=f.dfsEdgeList.length-1;return a.dfsCode.dfsEdgeList[pn]!==f.dfsEdgeList[pn]?!1:I(Ct[ze.edgeLabel].projected)}var Fn={};Mt=!1;var Tn=0;G.forEach(function(Ca){var Pi=new vo(Ca),Ni=a.findForwardPureEdges(s,Pi.edges[U[0]],et,Pi);Ni.length>0&&(Mt=!0,Tn=ft,Ni.forEach(function(_a){var Ya="".concat(_a.label,"-").concat(l[_a.to].label);Fn[Ya]||(Fn[Ya]={projected:[],edgeLabel:_a.label,nodeLabel2:l[_a.to].label}),Fn[Ya].projected.push({graphId:s.id,edge:_a,preNode:Ca})}))});for(var cr=U.length,kr=function(Pi){if(Mt)return"break";var Ni=U[Pi];G.forEach(function(_a){var Ya=new vo(_a),hi=a.findForwardRmpathEdges(s,Ya.edges[Ni],et,Ya);hi.length>0&&(Mt=!0,Tn=f.dfsEdgeList[Ni].fromNode,hi.forEach(function(di){var Xi="".concat(di.label,"-").concat(l[di.to].label);Fn[Xi]||(Fn[Xi]={projected:[],edgeLabel:di.label,nodeLabel2:l[di.to].label}),Fn[Xi].projected.push({graphId:s.id,edge:di,preNode:_a})}))})},Ce=0;Ce<cr;Ce++){var Aa=kr(Ce);if(Aa==="break")break}if(!Mt)return!0;var ci=a.findMinLabel(Fn);f.dfsEdgeList.push(new Ki(Tn,ft+1,Kn,ci.edgeLabel,ci.nodeLabel2));var ei=f.dfsEdgeList.length-1;return e.dfsEdgeList[ei]!==f.dfsEdgeList[ei]?!1:I(Fn["".concat(ci.edgeLabel,"-").concat(ci.nodeLabel2)].projected)},w="".concat(v.nodeLabel1,"-").concat(v.edgeLabel,"-").concat(v.nodeLabel2);return x(d[w].projected)}},c.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var a=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push((0,k.clone)(a))}},c.prototype.subGraphMining=function(a){var e=this,i=this.getSupport(a);if(!(i<this.minSupport)&&!!this.isMin()){this.report();var s=this.dfsCode.getNodeNum(),l=this.dfsCode.buildRmpath(),f=this.dfsCode.dfsEdgeList[l[0]].toNode,d=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,v={},x={};a.forEach(function(w){for(var I=e.graphs[w.graphId],G=I.nodeMap,U=new vo(w),et=l.length-1;et>=0;et--){var ft=e.findBackwardEdge(I,U.edges[l[et]],U.edges[l[0]],U);if(ft){var Ct="".concat(e.dfsCode.dfsEdgeList[l[et]].fromNode,"-").concat(ft.label);x[Ct]||(x[Ct]={projected:[],toNodeId:e.dfsCode.dfsEdgeList[l[et]].fromNode,edgeLabel:ft.label}),x[Ct].projected.push({graphId:w.graphId,edge:ft,preNode:w})}}if(!(s>=e.maxNodeNum)){var Mt=e.findForwardPureEdges(I,U.edges[l[0]],d,U);Mt.forEach(function($t){var Jt="".concat(f,"-").concat($t.label,"-").concat(G[$t.to].label);v[Jt]||(v[Jt]={projected:[],fromNodeId:f,edgeLabel:$t.label,nodeLabel2:G[$t.to].label}),v[Jt].projected.push({graphId:w.graphId,edge:$t,preNode:w})});for(var kt=function(Jt){var Ce=e.findForwardRmpathEdges(I,U.edges[l[Jt]],d,U);Ce.forEach(function(je){var ze="".concat(e.dfsCode.dfsEdgeList[l[Jt]].fromNode,"-").concat(je.label,"-").concat(G[je.to].label);v[ze]||(v[ze]={projected:[],fromNodeId:e.dfsCode.dfsEdgeList[l[Jt]].fromNode,edgeLabel:je.label,nodeLabel2:G[je.to].label}),v[ze].projected.push({graphId:w.graphId,edge:je,preNode:w})})},et=0;et<l.length;et++)kt(et)}}),Object.keys(x).forEach(function(w){var I=x[w],G=I.toNodeId,U=I.edgeLabel;e.dfsCode.dfsEdgeList.push(new Ki(f,G,"-1",U,"-1")),e.subGraphMining(x[w].projected),e.dfsCode.dfsEdgeList.pop()}),Object.keys(v).forEach(function(w){var I=v[w],G=I.fromNodeId,U=I.edgeLabel,et=I.nodeLabel2;e.dfsCode.dfsEdgeList.push(new Ki(G,f+1,Kn,U,et)),e.subGraphMining(v[w].projected),e.dfsCode.dfsEdgeList.pop()})}},c.prototype.generate1EdgeFrequentSubGraphs=function(){var a=this.graphs,e=this.directed,i=this.minSupport,s=this.frequentSize1Subgraphs,l={},f={},d={},v={};return Object.keys(a).forEach(function(x){var w=a[x],I=w.nodeMap;w.nodes.forEach(function(G,U){var et=G.label,ft="".concat(x,"-").concat(et);if(!d[ft]){var Ct=l[et]||0;Ct++,l[et]=Ct}d[ft]={graphKey:x,label:et},G.edges.forEach(function(Mt){var kt=et,$t=I[Mt.to].label;if(!e&&kt>$t){var Jt=$t;$t=kt,kt=Jt}var Ce=Mt.label,je="".concat(x,"-").concat(kt,"-").concat(Ce,"-").concat($t),ze="".concat(kt,"-").concat(Ce,"-").concat($t);if(!f[ze]){var pn=f[ze]||0;pn++,f[ze]=pn}v[je]={graphId:x,nodeLabel1:kt,edgeLabel:Ce,nodeLabel2:$t}})})}),Object.keys(l).forEach(function(x){var w=l[x];if(!(w<i)){var I={nodes:[],edges:[]};I.nodes.push({id:"0",label:x}),s.push(I)}}),s},c.prototype.run=function(){var a=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var e=this.graphs,i=this.directed,s={};Object.keys(e).forEach(function(l){var f=e[l],d=f.nodeMap;f.nodes.forEach(function(v){var x=a.findForwardRootEdges(f,v);x.forEach(function(w){var I=d[w.to],G="".concat(v.label,"-").concat(w.label,"-").concat(I.label);s[G]||(s[G]={projected:[],nodeLabel1:v.label,edgeLabel:w.label,nodeLabel2:I.label});var U={graphId:l,edge:w,preNode:null};s[G].projected.push(U)})})}),Object.keys(s).forEach(function(l){var f=s[l],d=f.projected,v=f.nodeLabel1,x=f.edgeLabel,w=f.nodeLabel2;a.dfsCode.dfsEdgeList.push(new Ki(0,1,v,x,w)),a.subGraphMining(d),a.dfsCode.dfsEdgeList.pop()})}},c}(),Wo=function(a,e,i,s){var l={};return Object.keys(a).forEach(function(f,d){var v=a[f],x=new Fi(d,!0,e),w={};v.nodes.forEach(function(I,G){x.addNode(G,I[i]),w[I.id]=G}),v.edges.forEach(function(I,G){var U=w[I.source],et=w[I.target];x.addEdge(-1,U,et,I[s])}),x&&x.getNodeNum()&&(l[x.id]=x)}),l},Zi=function(a,e,i){var s=[];return a.forEach(function(l){var f={nodes:[],edges:[]};l.nodes.forEach(function(d){var v;f.nodes.push((v={id:"".concat(d.id)},v[e]=d.label,v))}),l.edges.forEach(function(d){var v;f.edges.push((v={source:"".concat(d.from),target:"".concat(d.to)},v[i]=d.label,v))}),s.push(f)}),s},bi="cluster",gi=function(a){var e=a.graphs,i=a.directed,s=i===void 0?!1:i,l=a.nodeLabelProp,f=l===void 0?bi:l,d=a.edgeLabelProp,v=d===void 0?bi:d,x=Wo(e,s,f,v),w=a.minSupport,I=a.maxNodeNum,G=a.minNodeNum,U=a.verbose,et=a.top,ft={graphs:x,minSupport:w,maxNodeNum:I,minNodeNum:G,top:et,verbose:U,directed:s},Ct=new es(ft);Ct.run();var Mt=Zi(Ct.frequentSubgraphs,f,v);return Mt},ms=gi,Do=function(a,e,i,s){i===void 0&&(i="cluster"),s===void 0&&(s=2);var l=[],f=a.nodes;return e.forEach(function(d,v){l.push(To(f,d,v,i,s))}),l},To=function(a,e,i,s,l){var f=[i],d=[],v={};return e.forEach(function(x,w){if(x<=l&&i!==w){f.push(w),d.push(a[w]);var I=a[w][s];v[I]?(v[I].count++,v[I].dists.push(x)):v[I]={count:1,dists:[x]}}}),Object.keys(v).forEach(function(x){v[x].dists=v[x].dists.sort(function(w,I){return w-I})}),{nodeIdx:i,nodeId:a[i].id,nodeIdxs:f,neighbors:d,neighborNum:f.length-1,nodeLabelCountMap:v}},Zs=function(a,e,i,s,l){var f=Math.ceil(i/e),d={},v=0;return s.forEach(function(x,w){for(var I=0,G=0,U=x.nodeIdxs,et=x.neighborNum-1;I<f;){for(var ft=U[1+Math.floor(Math.random()*et)],Ct=0;(d["".concat(w,"-").concat(ft)]||d["".concat(ft,"-").concat(w)])&&(ft=Math.floor(Math.random()*e),Ct++,!(Ct>2*e)););if(Ct<2*e&&(d["".concat(w,"-").concat(ft)]={start:w,end:ft,distance:l[w][ft]},I++,v++,v>=i))return d;if(G++,G>2*e)break}if(I<f){var Mt=f-I;f=(f+Mt)/(e-w-1)}}),d},Eu=function(a,e,i,s){var l=i.nodes;return s||(s={}),Object.keys(a).forEach(function(f){var d,v;if(!(s&&s[f])){s[f]={nodes:[],edges:[]};var x=a[f],w=(d=e[x.start])===null||d===void 0?void 0:d.nodeIdxs,I=(v=e[x.end])===null||v===void 0?void 0:v.nodeIdxs;if(!(!w||!I)){var G=new Set(I),U=w.filter(function(kt){return G.has(kt)});if(!(!U||!U.length)){for(var et={},ft=U.length,Ct=0;Ct<ft;Ct++){var Mt=l[U[Ct]];s[f].nodes.push(Mt),et[Mt.id]=!0}i.edges.forEach(function(kt){et[kt.source]&&et[kt.target]&&s[f].edges.push(kt)})}}}}),s},as=function(a,e,i,s){var l,f,d={};a.nodes.forEach(function(x){d[x.id]=x});var v=0;return!((l=e==null?void 0:e.edges)===null||l===void 0?void 0:l.length)||((f=e==null?void 0:e.nodes)===null||f===void 0?void 0:f.length)<2?0:(a.edges.forEach(function(x){var w=d[x.source][i],I=d[x.target][i],G=e==null?void 0:e.nodes[0][i],U=e==null?void 0:e.nodes[1][i],et=e==null?void 0:e.edges[0][s];x[s]===et&&(w===G&&I===U||w===U&&I===G)&&v++}),v)},Rs=function(a,e,i){for(var s=Infinity,l=0,f=function(x){var w=a[x],I=Object.keys(w).sort(function(kt,$t){return w[kt]-w[$t]}),G=10,U=[];I.forEach(function(kt,$t){U[$t%G]||(U[$t%G]={graphs:[],totalCount:0,aveCount:0}),U[$t%G].graphs.push(kt),U[$t%G].totalCount+=w[kt]});var et=0,ft=[];U.forEach(function(kt){var $t=kt.totalCount/kt.graphs.length;kt.aveCount=$t,ft.push($t);var Jt=0,Ce=kt.length;kt.graphs.forEach(function(je,ze){var pn=w[je];kt.graphs.forEach(function(Fn,Tn){ze!==Tn&&(Jt+=Math.abs(pn-w[Fn]))})}),Jt/=Ce*(Ce-1)/2,et+=Jt}),et/=U.length;var Ct=0;ft.forEach(function(kt,$t){ft.forEach(function(Jt,Ce){$t!==Ce&&(Ct+=Math.abs(kt-Jt))}),Ct/=ft.length*(ft.length-1)/2});var Mt=Ct-et;s<Mt&&(s=Mt,l=x)},d=0;d<e;d++)f(d);return{structure:i[l],structureCountMap:a[l]}},Su=function(a,e){var i={},s={};return a.forEach(function(l,f){i[l.id]={idx:f,node:l,degree:0,inDegree:0,outDegree:0};var d=l[e];s[d]||(s[d]=[]),s[d].push(l)}),{nodeMap:i,nodeLabelMap:s}},fu=function(a,e,i){var s={},l={};return a.forEach(function(f,d){s["".concat(Be)]={idx:d,edge:f};var v=f[e];l[v]||(l[v]=[]),l[v].push(f);var x=i[f.source];x&&(x.degree++,x.outDegree++);var w=i[f.target];w&&(w.degree++,w.inDegree++)}),{edgeMap:s,edgeLabelMap:l}},Is=function(a,e,i){var s=e.length,l={};return e.forEach(function(f,d){for(var v=i?0:d+1,x=a[d].id,w=v;w<s;w++)if(d!==w){var I=a[w].id,G=f[w];l["".concat(x,"-").concat(I)]=G,i||(l["".concat(I,"-").concat(x)]=G)}}),l},Zo=function(a,e,i,s,l,f,d,v,x,w,I){var G,U="".concat(e.id,"-").concat(i.id);if(w&&w[U])return w[U];var et=I?I[U]:void 0;if(!et){var ft=(G={},G[U]={start:s[e.id].idx,end:s[i.id].idx,distance:l},G);I=Eu(ft,f,a,I),et=I[U]}return as(et,d,v,x)},Wi=function(a,e,i,s){var l,f,d,v=(l=a[e])===null||l===void 0?void 0:l.degree,x=(f=a[e])===null||f===void 0?void 0:f.inDegree,w=(d=a[e])===null||d===void 0?void 0:d.outDegree;return a[e]===void 0&&(v=Infinity,x=Infinity,w=Infinity,s[e].forEach(function(I){var G=i[I.id].degree;v>G&&(v=G);var U=i[I.id].inDegree;x>U&&(x=U);var et=i[I.id].outDegree;w>et&&(w=et)}),a[e]={degree:v,inDegree:x,outDegree:w}),{minPatternNodeLabelDegree:v,minPatternNodeLabelInDegree:x,minPatternNodeLabelOutDegree:w}},ys=function(a,e,i,s,l,f,d){var v;if(i===void 0&&(i=!1),f===void 0&&(f="cluster"),d===void 0&&(d="cluster"),!(!a||!a.nodes)){var x=a.nodes.length;if(!!x){var w=Wr(a,i),I=Wr(e,i),G=Is(a.nodes,w,i),U=Is(e.nodes,I,i),et=Su(a.nodes,f),ft=et.nodeMap,Ct=et.nodeLabelMap,Mt=Su(e.nodes,f),kt=Mt.nodeMap,$t=Mt.nodeLabelMap;fu(a.edges,d,ft);var Jt=fu(e.edges,d,kt).edgeLabelMap,Ce=[];I==null||I.forEach(function(au){Ce=Ce.concat(au)}),l||(l=Math.max.apply(Math,(0,P.__spreadArray)((0,P.__spreadArray)([],Ce,!1),[2],!1))),s||(s=l);var je=Do(a,w,f,s),ze=Do(e,I,f,s),pn=Math.min(100,x*(x-1)/2),Fn=Zs(s,x,pn,je,w),Tn=Eu(Fn,je,a),cr=10,kr=1,Aa=1,ci=4,ei={graphs:Tn,nodeLabelProp:f,edgeLabelProp:d,minSupport:kr,minNodeNum:Aa,maxNodeNum:ci,directed:i},Ca=ms(ei).slice(0,cr),Pi=Ca.length,Ni=[];Ca.forEach(function(au,Ku){Ni[Ku]={},Object.keys(Tn).forEach(function(Ks){var Zu=Tn[Ks],Il=as(Zu,au,f,d);Ni[Ku][Ks]=Il})});var _a=Rs(Ni,Pi,Ca),Ya=_a.structure,hi=_a.structureCountMap,di=e.nodes[0],Xi=[],go=(v=e.nodes[0])===null||v===void 0?void 0:v[f],vs=-Infinity;e.nodes.forEach(function(au){var Ku=au[f],Ks=Ct[Ku];(Ks==null?void 0:Ks.length)>vs&&(vs=Ks.length,Xi=Ks,go=Ku,di=au)});var Fs={},hl={},Lu={},dl={},_l={},rc={};Object.keys($t).forEach(function(au,Ku){_l[au]=[],i&&(rc[au]=[]);var Ks=-Infinity,Zu=$t[au],Il={};Zu.forEach(function(Tu){var Uu=U["".concat(di.id,"-").concat(Tu.id)];if(Uu&&_l[au].push(Uu),Ks<Uu&&(Ks=Uu),Il["".concat(di.id,"-").concat(Tu.id)]={start:0,end:kt[Tu.id].idx,distance:Uu},i){var dc=U["".concat(Tu.id,"-").concat(di.id)];dc&&rc[au].push(dc)}}),_l[au]=_l[au].sort(function(Tu,Uu){return Tu-Uu}),i&&(rc[au]=rc[au].sort(function(Tu,Uu){return Tu-Uu})),hl=Eu(Il,ze,e,hl);var Ho=[];if(Object.keys(Il).forEach(function(Tu){if(Lu[Tu]){Ho.push(Lu[Tu]);return}var Uu=hl[Tu];Lu[Tu]=as(Uu,Ya,f,d),Ho.push(Lu[Tu])}),Ho=Ho.sort(function(Tu,Uu){return Uu-Tu}),dl["".concat(di.id,"-").concat(au)]=Ho,au!==go)for(var xu=(Xi==null?void 0:Xi.length)||0,wu=function(Uu){var dc=Xi[Uu],_d=je[ft[dc.id].idx],Dc=_d.nodeLabelCountMap[au],Kg=$t[au].length;if(!Dc||Dc.count<Kg)return Xi.splice(Uu,1),"continue";for(var Zg=!1,Of=0;Of<Kg;Of++)if(Dc.dists[Of]>_l[au][Of]){Zg=!0;break}if(Zg)return Xi.splice(Uu,1),"continue";var ap={};_d.neighbors.forEach(function(uh){var ip=G["".concat(dc.id,"-").concat(uh.id)];ap["".concat(dc.id,"-").concat(uh.id)]={start:ft[dc.id].idx,end:ft[uh.id].idx,distance:ip}}),Tn=Eu(ap,je,a,Tn);var Id=[];Object.keys(ap).forEach(function(uh){if(hi[uh]){Id.push(hi[uh]);return}var ip=Tn[uh];hi[uh]=as(ip,Ya,f,d),Id.push(hi[uh])}),Id=Id.sort(function(uh,ip){return ip-uh});for(var bg=!1,Of=0;Of<Kg;Of++)if(Id[Of]<Ho[Of]){bg=!0;break}if(bg)return Xi.splice(Uu,1),"continue"},Dl=xu-1;Dl>=0;Dl--)wu(Dl)});var Vl=[];Xi==null||Xi.forEach(function(au){for(var Ku=ft[au.id].idx,Ks=To(a.nodes,w[Ku],Ku,f,l),Zu=Ks.neighbors,Il=Zu.length,Ho=!1,xu=Il-1;xu>=0;xu--){if(Zu.length+1<e.nodes.length){Ho=!0;return}var wu=Zu[xu],Dl=wu[f];if(!$t[Dl]||!$t[Dl].length){Zu.splice(xu,1);continue}if(!_l[Dl]||!_l[Dl].length){Zu.splice(xu,1);continue}var Tu="".concat(au.id,"-").concat(wu.id),Uu=G[Tu],dc=_l[Dl].length-1,_d=_l[Dl][dc];if(Uu>_d){Zu.splice(xu,1);continue}if(i){var Dc="".concat(wu.id,"-").concat(au.id),Kg=G[Dc];dc=rc[Dl].length-1;var Zg=rc[Dl][dc];if(Kg>Zg){Zu.splice(xu,1);continue}}var Of=hi[Tu]?hi[Tu]:Zo(a,au,wu,ft,Uu,je,Ya,f,d,hi,Tn),ap="".concat(di.id,"-").concat(Dl),Id=dl[ap][dl[ap].length-1];if(Of<Id){Zu.splice(xu,1);continue}var bg=Wi(Fs,Dl,kt,$t),uh=bg.minPatternNodeLabelDegree,ip=bg.minPatternNodeLabelInDegree,$p=bg.minPatternNodeLabelOutDegree;if(ft[wu.id].degree<uh){Zu.splice(xu,1);continue}}Ho||Vl.push({nodes:[au].concat(Zu)})});var zp=_n(e,di.id,!1).length,xf={};i?(Object.keys(zp).forEach(function(au){var Ku=kt[au].node[f];xf[Ku]?xf[Ku].push(zp[au]):xf[Ku]=[zp[au]]}),Object.keys(xf).forEach(function(au){xf[au].sort(function(Ku,Ks){return Ku-Ks})})):xf=_l;for(var Dh=Vl.length,Vc=function(Ku){var Ks=Vl[Ku],Zu=Ks.nodes[0],Il={},Ho={};Ks.nodes.forEach(function(jl,ud){Ho[jl.id]={idx:ud,node:jl,degree:0,inDegree:0,outDegree:0};var Oc=jl[f];Il[Oc]?Il[Oc]++:Il[Oc]=1});var xu=[],wu={};a.edges.forEach(function(jl){Ho[jl.source]&&Ho[jl.target]&&(xu.push(jl),wu[jl[d]]?wu[jl[d]]++:wu[jl[d]]=1,Ho[jl.source].degree++,Ho[jl.target].degree++,Ho[jl.source].outDegree++,Ho[jl.target].inDegree++)});for(var Dl=Object.keys(Jt).length,Tu=!1,Uu=0;Uu<Dl;Uu++){var dc=Object.keys(Jt)[Uu];if(!wu[dc]||wu[dc]<Jt[dc].length){Tu=!0;break}}if(Tu)return Vl.splice(Ku,1),"continue";var _d=xu.length;if(_d<e.edges.length)return Vl.splice(Ku,1),"break";for(var Dc=!1,Kg=function(ud){var Oc=xu[ud],Sv=Oc[d],Qg=Jt[Sv];if(!Qg||!Qg.length)return wu[Sv]--,Qg&&wu[Sv]<Qg.length?(Dc=!0,"break"):(xu.splice(ud,1),Ho[Oc.source].degree--,Ho[Oc.target].degree--,Ho[Oc.source].outDegree--,Ho[Oc.target].inDegree--,"continue");var rx=Ho[Oc.source].node[f],VE=Ho[Oc.target].node[f],Td=!1;if(Qg.forEach(function(ax){var ix=kt[ax.source].node,SI=kt[ax.target].node;ix[f]===rx&&SI[f]===VE&&(Td=!0),!i&&ix[f]===VE&&SI[f]===rx&&(Td=!0)}),!Td)return wu[Sv]--,Qg&&wu[Sv]<Qg.length?(Dc=!0,"break"):(xu.splice(ud,1),Ho[Oc.source].degree--,Ho[Oc.target].degree--,Ho[Oc.source].outDegree--,Ho[Oc.target].inDegree--,"continue")},Uu=_d-1;Uu>=0;Uu--){var Zg=Kg(Uu);if(Zg==="break")break}if(Dc)return Vl.splice(Ku,1),"continue";Ks.edges=xu;var Of=_n(Ks,Ks.nodes[0].id,!1).length;if(Object.keys(Of).reverse().forEach(function(jl){if(!(jl===Ks.nodes[0].id||Dc)){if(Of[jl]===Infinity){var ud=Ho[jl].node[f];if(Il[ud]--,Il[ud]<$t[ud].length){Dc=!0;return}var Oc=Ks.nodes.indexOf(Ho[jl].node);Ks.nodes.splice(Oc,1),Ho[jl]=void 0;return}var Sv=ft[jl].node[f];if(!xf[Sv]||!xf[Sv].length||Of[jl]>xf[Sv][xf[Sv].length-1]){var ud=Ho[jl].node[f];if(Il[ud]--,Il[ud]<$t[ud].length){Dc=!0;return}var Oc=Ks.nodes.indexOf(Ho[jl].node);Ks.nodes.splice(Oc,1),Ho[jl]=void 0}}}),Dc)return Vl.splice(Ku,1),"continue";for(var ap=!0,Id=0;ap&&!Dc;){ap=!1;var bg=i?Ho[Zu.id].degree<kt[di.id].degree||Ho[Zu.id].inDegree<kt[di.id].inDegree||Ho[Zu.id].outDegree<kt[di.id].outDegree:Ho[Zu.id].degree<kt[di.id].degree;if(bg){Dc=!0;break}if(Il[Zu[f]]<$t[Zu[f]].length){Dc=!0;break}for(var uh=Ks.nodes.length,ip=uh-1;ip>=0;ip--){var $p=Ks.nodes[ip],GE=Ho[$p.id].degree,wI=Ho[$p.id].inDegree,EI=Ho[$p.id].outDegree,l1=$p[f],ex=Wi(Fs,l1,kt,$t),UE=ex.minPatternNodeLabelDegree,WE=ex.minPatternNodeLabelInDegree,k0=ex.minPatternNodeLabelOutDegree,nx=i?GE<UE||wI<WE||EI<k0:GE<UE;if(nx){if(Il[$p[f]]--,Il[$p[f]]<$t[$p[f]].length){Dc=!0;break}Ks.nodes.splice(ip,1),Ho[$p.id]=void 0,ap=!0}}if(Dc||!ap&&Id!==0)break;_d=xu.length;for(var qg=_d-1;qg>=0;qg--){var Hv=xu[qg];if(!Ho[Hv.source]||!Ho[Hv.target]){xu.splice(qg,1);var Gp=Hv[d];if(wu[Gp]--,Ho[Hv.source]&&(Ho[Hv.source].degree--,Ho[Hv.source].outDegree--),Ho[Hv.target]&&(Ho[Hv.target].degree--,Ho[Hv.target].inDegree--),Jt[Gp]&&wu[Gp]<Jt[Gp].length){Dc=!0;break}ap=!0}}Id++}if(Dc||Dc||Ks.nodes.length<e.nodes.length||xu.length<e.edges.length)return Vl.splice(Ku,1),"continue"},jc=Dh-1;jc>=0;jc--){var Oh=Vc(jc);if(Oh==="break")break}for(var Df=Vl.length,Rh=function(Ku){var Ks=Vl[Ku],Zu={};Ks.edges.forEach(function(xu){var wu="".concat(xu.source,"-").concat(xu.target,"-").concat(xu.label);Zu[wu]?Zu[wu]++:Zu[wu]=1});for(var Il=function(wu){var Dl=Vl[wu],Tu={};Dl.edges.forEach(function(dc){var _d="".concat(dc.source,"-").concat(dc.target,"-").concat(dc.label);Tu[_d]?Tu[_d]++:Tu[_d]=1});var Uu=!0;Object.keys(Tu).length!==Object.keys(Zu).length?Uu=!1:Object.keys(Zu).forEach(function(dc){Tu[dc]!==Zu[dc]&&(Uu=!1)}),Uu&&Vl.splice(wu,1)},Ho=Df-1;Ho>Ku;Ho--)Il(Ho);Df=Vl.length},jc=0;jc<=Df-1;jc++)Rh(jc);return Vl}}},is=ys,Us=function(){function c(a){a===void 0&&(a=10),this.linkedList=new Oe,this.maxStep=a}return Object.defineProperty(c.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),c.prototype.isEmpty=function(){return!this.linkedList.head},c.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},c.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},c.prototype.push=function(a){this.linkedList.prepend(a),this.length>this.maxStep&&this.linkedList.deleteTail()},c.prototype.pop=function(){var a=this.linkedList.deleteHead();return a?a.value:null},c.prototype.toArray=function(){return this.linkedList.toArray().map(function(a){return a.value})},c.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},c}(),Du=Us,qs=aa,Cu={getAdjMatrix:de,breadthFirstSearch:Ve,connectedComponent:bt,getDegree:en,getInDegree:fn,getOutDegree:Rt,detectCycle:aa,detectDirectedCycle:qs,detectAllCycles:Ea,detectAllDirectedCycle:fa,detectAllUndirectedCycle:Ur,depthFirstSearch:xr,dijkstra:_n,findAllPath:tr,findShortestPath:Pn,floydWarshall:Wr,labelPropagation:nr,louvain:Vt,iLouvain:ne,kCore:tn,kMeans:Ln,cosineSimilarity:Ia,nodesCosineSimilarity:Ar,minimumSpanningTree:Ra,pageRank:De,getNeighbors:Ae,Stack:Du,GADDI:is},ji=$(77160),Bi=$(31437),Ms=Le,os=function(a){return function(e,i){return e[a]-i[a]}},Ws=function(a,e,i){return a>=e&&a<=i},Ss=function(a,e,i,s){var l=1e-4,f={x:i.x-a.x,y:i.y-a.y},d={x:e.x-a.x,y:e.y-a.y},v={x:s.x-i.x,y:s.y-i.y},x=d.x*v.y-d.y*v.x,w=x*x,I=1/x,G=d.x*d.x+d.y*d.y,U=v.x*v.x+v.y*v.y;if(w>l*G*U){var et=(f.x*v.y-f.y*v.x)*I,ft=(f.x*d.y-f.y*d.x)*I;return!Ws(et,0,1)||!Ws(ft,0,1)?null:{x:a.x+et*d.x,y:a.y+et*d.y}}return null},Qs=function(a,e){var i=a.x,s=a.y,l=a.width,f=a.height,d=i+l/2,v=s+f/2,x=[],w={x:d,y:v};x.push({x:i,y:s}),x.push({x:i+l,y:s}),x.push({x:i+l,y:s+f}),x.push({x:i,y:s+f}),x.push({x:i,y:s});for(var I=null,G=1;G<x.length&&(I=Ss(x[G-1],x[G],w,e),!I);G++);return I},Qu=function(a,e){var i=a.x,s=a.y,l=a.r,f=e.x,d=e.y,v=f-i,x=d-s;if(v*v+x*x<l*l)return null;var w=Math.atan(x/v);return{x:i+Math.abs(l*Math.cos(w))*Math.sign(v),y:s+Math.abs(l*Math.sin(w))*Math.sign(x)}},xn=function(a,e){var i=a.rx,s=a.ry,l=a.x,f=a.y,d=e.x-l,v=e.y-f,x=Math.atan2(v/s,d/i);return x<0&&(x+=2*Math.PI),{x:l+i*Math.cos(x),y:f+s*Math.sin(x)}},Vr=function(a,e,i){i===void 0&&(i=1);var s=[a.x,a.y,i];return(!e||isNaN(e[0]))&&(e=[1,0,0,0,1,0,0,0,1]),ji.transformMat3(s,s,e),{x:s[0],y:s[1]}},pa=function(a,e,i){i===void 0&&(i=1),(!e||isNaN(e[0]))&&(e=[1,0,0,0,1,0,0,0,1]);var s=pt.invert([1,0,0,0,1,0,0,0,1],e);s||(s=[1,0,0,0,1,0,0,0,1]);var l=[a.x,a.y,i];return ji.transformMat3(l,l,s),{x:l[0],y:l[1]}},Fa=function(a,e,i){var s=a.x-e.x,l=a.y-e.y,f=a.x-i.x,d=a.y-i.y,v=(a.x*a.x-e.x*e.x-e.y*e.y+a.y*a.y)/2,x=(a.x*a.x-i.x*i.x-i.y*i.y+a.y*a.y)/2,w=l*f-s*d;return{x:-(d*v-l*x)/w,y:-(s*x-f*v)/w}},Vi=function(a,e){var i=a.x-e.x,s=a.y-e.y;return Math.sqrt(i*i+s*s)},Ao=function(a,e){var i=[];return a.forEach(function(s){var l=[];s.forEach(function(f){l.push(f*e)}),i.push(l)}),i},ao=function(a){for(var e=[],i=a.length,s=0;s<i;s+=1){e[s]=[];for(var l=0;l<i;l+=1)s===l?e[s][l]=0:a[s][l]===0||!a[s][l]?e[s][l]=Infinity:e[s][l]=a[s][l]}for(var f=0;f<i;f+=1)for(var s=0;s<i;s+=1)for(var l=0;l<i;l+=1)e[s][l]>e[s][f]+e[f][l]&&(e[s][l]=e[s][f]+e[f][l]);return e},So=function(a,e){var i=a.nodes,s=a.edges,l=[],f={};if(!i)throw new Error("invalid nodes data!");return i&&i.forEach(function(d,v){f[d.id]=v;var x=[];l.push(x)}),s&&s.forEach(function(d){var v=d.source,x=d.target,w=f[v],I=f[x];l[w][I]=1,e||(l[I][w]=1)}),l},Ts=function(a,e){a.translate(e.x,e.y)},fo=function(a,e,i,s){s===void 0&&(s={duration:500});var l=a.getMatrix();l||(l=[1,0,0,0,1,0,0,0,1]);var f=a.getCanvasBBox(),d=e.x-f.minX,v=e.y-f.minY;if(i){var x=d*l[0],w=v*l[4],I=0,G=0,U=0,et=0;a.animate(function(Ct){return U=x*Ct,et=w*Ct,l=Ms(l,[["t",U-I,et-G]]),I=U,G=et,{matrix:l}},s)}else{var ft=Ms(l,[["t",d,v]]);a.setMatrix(ft)}},ou=function(a,e){var i=a.getMatrix();i||(i=[1,0,0,0,1,0,0,0,1]);var s=e;(0,k.isArray)(e)||(s=[e,e]),(0,k.isArray)(e)&&e.length===1&&(s=[e[0],e[0]]),i=Ms(i,[["s",s[0],s[1]]]),a.setMatrix(i)},Cs=function(a,e){var i=a.getMatrix();i||(i=[1,0,0,0,1,0,0,0,1]),i=Ms(i,[["r",e]]),a.setMatrix(i)},Au=function(a,e,i){for(var s=[],l=0;l<a;l++)s[l]=0;return i.forEach(function(f){f.source&&(s[e[f.source]]+=1),f.target&&(s[e[f.target]]+=1)}),s};function Tl(c,a,e){return(e[0]-c[0])*(a[1]-c[1])==(a[0]-c[0])*(e[1]-c[1])&&Math.min(c[0],a[0])<=e[0]&&e[0]<=Math.max(c[0],a[0])&&Math.min(c[1],a[1])<=e[1]&&e[1]<=Math.max(c[1],a[1])}var bl=function(a,e,i){var s=!1,l=a.length,f=1e-6;function d(I){return Math.abs(I)<f?0:I<0?-1:1}if(l<=2)return!1;for(var v=0;v<l;v++){var x=a[v],w=a[(v+1)%l];if(Tl(x,w,[e,i]))return!0;d(x[1]-i)>0!=d(w[1]-i)>0&&d(e-(i-x[1])*(x[0]-w[0])/(x[1]-w[1])-x[0])<0&&(s=!s)}return s},Js=function(a,e){return!(e.minX>a.maxX||e.maxX<a.minX||e.minY>a.maxY||e.maxY<a.minY)},ul=function(a,e){var i=!1;return(0,k.each)(a,function(s){if(Ss(s.from,s.to,e.from,e.to))return i=!0,!1}),i},Mu=function(a,e){var i=function(G){var U=G.map(function(ft){return ft[0]}),et=G.map(function(ft){return ft[1]});return{minX:Math.min.apply(null,U),maxX:Math.max.apply(null,U),minY:Math.min.apply(null,et),maxY:Math.max.apply(null,et)}},s=function(G){for(var U=[],et=G.length,ft=0;ft<et-1;ft++){var Ct=G[ft],Mt=G[ft+1];U.push({from:{x:Ct[0],y:Ct[1]},to:{x:Mt[0],y:Mt[1]}})}if(U.length>1){var kt=G[0],$t=G[et-1];U.push({from:{x:$t[0],y:$t[1]},to:{x:kt[0],y:kt[1]}})}return U};if(a.length<2||e.length<2)return!1;var l=i(a),f=i(e);if(!Js(l,f))return!1;var d=!1;if((0,k.each)(e,function(I){if(bl(a,I[0],I[1]))return d=!0,!1}),d||((0,k.each)(a,function(I){if(bl(e,I[0],I[1]))return d=!0,!1}),d))return!0;var v=s(a),x=s(e),w=!1;return(0,k.each)(x,function(I){if(ul(v,I))return w=!0,!1}),w},Pu=function(){function c(a,e,i,s){this.x1=a,this.y1=e,this.x2=i,this.y2=s}return c.prototype.getBBox=function(){var a=Math.min(this.x1,this.x2),e=Math.min(this.y1,this.y2),i=Math.max(this.x1,this.x2),s=Math.max(this.y1,this.y2),l={x:a,y:e,minX:a,minY:e,maxX:i,maxY:s,width:i-a,height:s-e};return l},c}(),Nu=function(a,e){var i={top:[a.minX,a.minY,a.maxX,a.minY],left:[a.minX,a.minY,a.minX,a.maxY],bottom:[a.minX,a.maxY,a.maxX,a.maxY],right:[a.maxX,a.minY,a.maxX,a.maxY]};return i[e]},fs=function(a,e){var i=(e.x2-e.x1)*(a.y1-e.y1)-(e.y2-e.y1)*(a.x1-e.x1),s=(a.x2-a.x1)*(a.y1-e.y1)-(a.y2-a.y1)*(a.x1-e.x1),l=(e.y2-e.y1)*(a.x2-a.x1)-(e.x2-e.x1)*(a.y2-a.y1);if(l){var f=i/l,d=s/l;if(f>=0&&f<=1&&d>=0&&d<=1)return f}return Number.POSITIVE_INFINITY},Bs=function(a,e){for(var i=["top","left","bottom","right"],s=a.getBBox(),l=0,f=[],d=0;d<4;d++){var v=Nu(s,i[d]),x=v[0],w=v[1],I=v[2],G=v[3];f[d]=Ss({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},{x,y:w},{x:I,y:G}),f[d]&&(l+=1)}return[f,l]},gu=function(a,e){for(var i=["top","left","bottom","right"],s=a.getBBox(),l=Number.POSITIVE_INFINITY,f=0,d=0;d<4;d++){var v=Nu(s,i[d]),x=v[0],w=v[1],I=v[2],G=v[3],U=fs(e,new Pu(x,w,I,G));U=Math.abs(U-.5),U>=0&&U<=1&&(f+=1,l=U<l?U:l)}return f===0?-1:l},Fu=function(a){var e=0,i=0;if(a.length>0){for(var s=0,l=a;s<l.length;s++){var f=l[s];e+=f.x,i+=f.y}e/=a.length,i/=a.length}return{x:e,y:i}},Wu=function(a,e){return Math.pow(a.x-e.x,2)+Math.pow(a.y-e.y,2)},Ju=function(a,e){var i=e.x1,s=e.y1,l=e.x2-i,f=e.y2-s,d=a.x-i,v=a.y-s,x=d*l+v*f,w;x<=0?w=0:(d=l-d,v=f-v,x=d*l+v*f,x<=0?w=0:w=x*x/(l*l+f*f));var I=d*d+v*v-w;return I<0&&(I=0),I},tu=function(a,e,i){return i===void 0&&(i=.001),Math.pow(a.x-e.x,2)+Math.pow(a.y-e.y,2)<Math.pow(i,2)},gc=function(a,e){var i=a.x<e.x,s=a.x>e.x+e.width,l=a.y>e.y+e.height,f=a.y<e.y,d=i||s||l||f;if(!d)return 0;if(l&&!i&&!s)return Math.pow(e.y+e.height-a.y,2);if(f&&!i&&!s)return Math.pow(a.y-e.y,2);if(i&&!l&&!f)return Math.pow(e.x-a.x,2);if(s&&!l&&!f)return Math.pow(e.x+e.width-a.x,2);var v=Math.min(Math.abs(e.x-a.x),Math.abs(e.x+e.width-a.x)),x=Math.min(Math.abs(e.y-a.y),Math.abs(e.y+e.height-a.y));return v*v+x*x},Bl=function(a,e){var i=a[0],s=a[1],l=a[2],f=a[3],d=e.x,v=e.y,x=[l-i,f-s];if(Bi.exactEquals(x,[0,0]))return NaN;var w=[-x[1],x[0]];Bi.normalize(w,w);var I=[d-i,v-s];return Math.abs(Bi.dot(I,w))},vl=function(a,e,i){return a+(e-a)*i},Ls=function(a,e,i){for(var s=Math.min(a.length,e.length),l=new Array(s),f=0;f<s;f++)l[f]=vl(a[f],e[f],i);return l},el="rgb(95, 149, 255)",oc="rgb(255, 255, 255)",Ol="rgb(0, 0, 0)",Ic="rgb(247, 250, 255)",Se="rgb(239, 244, 255)",ve="rgb(253, 253, 253)",Gt="rgb(250, 250, 250)",re="rgb(224, 224, 224)",me="rgb(234, 234, 234)",bn="rgb(245, 245, 245)",Zn="rgb(191, 213, 255)",Yt="#4572d9",Ie="rgb(223, 234, 255)",Ge={mainStroke:el,mainFill:Se,activeStroke:el,activeFill:Ic,inactiveStroke:Zn,inactiveFill:Ic,selectedStroke:el,selectedFill:oc,highlightStroke:Yt,highlightFill:Ie,disableStroke:re,disableFill:Gt,edgeMainStroke:re,edgeActiveStroke:el,edgeInactiveStroke:me,edgeSelectedStroke:el,edgeHighlightStroke:el,edgeDisableStroke:bn,comboMainStroke:re,comboMainFill:ve,comboActiveStroke:el,comboActiveFill:Ic,comboInactiveStroke:re,comboInactiveFill:ve,comboSelectedStroke:el,comboSelectedFill:ve,comboHighlightStroke:Yt,comboHighlightFill:ve,comboDisableStroke:me,comboDisableFill:Gt},Fe={version:"0.8.17",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:Ge.mainStroke,fill:Se},size:20,color:Ge.mainStroke,linkPoints:{size:8,lineWidth:1,fill:Ge.activeFill,stroke:Ge.activeStroke}},nodeStateStyles:{active:{fill:Ge.activeFill,stroke:Ge.activeStroke,lineWidth:2,shadowColor:Ge.mainStroke,shadowBlur:10},selected:{fill:Ge.selectedFill,stroke:Ge.selectedStroke,lineWidth:4,shadowColor:Ge.selectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:Ge.highlightFill,stroke:Ge.highlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:Ge.inactiveFill,stroke:Ge.inactiveStroke,lineWidth:1},disable:{fill:Ge.disableFill,stroke:Ge.disableStroke,lineWidth:1}},edgeLabel:{style:{fill:Ol,textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:Ge.edgeMainStroke,lineAppendWidth:2},color:Ge.edgeMainStroke},edgeStateStyles:{active:{stroke:Ge.edgeActiveStroke,lineWidth:1},selected:{stroke:Ge.edgeSelectedStroke,lineWidth:2,shadowColor:Ge.edgeSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:Ge.edgeHighlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:Ge.edgeInactiveStroke,lineWidth:1},disable:{stroke:Ge.edgeDisableStroke,lineWidth:1}},comboLabel:{style:{fill:Ol,textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:Ge.comboMainFill,lineWidth:1,stroke:Ge.comboMainStroke,r:5,width:20,height:10},size:[20,5],color:Ge.comboMainStroke,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:Ge.comboActiveStroke,lineWidth:1,fill:Ge.comboActiveFill},selected:{stroke:Ge.comboSelectedStroke,lineWidth:2,fill:Ge.comboSelectedFill,shadowColor:Ge.comboSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:Ge.comboHighlightStroke,lineWidth:2,fill:Ge.comboHighlightFill,"text-shape":{fontWeight:500}},inactive:{stroke:Ge.comboInactiveStroke,fill:Ge.comboInactiveFill,lineWidth:1},disable:{stroke:Ge.comboDisableStroke,fill:Ge.comboDisableFill,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},windowFontFamily:typeof window!="undefined"&&window.getComputedStyle&&document.body&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"},In={" ":.3329986572265625,a:.5589996337890625,A:.6569992065429687,b:.58599853515625,B:.6769989013671875,c:.5469985961914062,C:.7279998779296875,d:.58599853515625,D:.705999755859375,e:.554998779296875,E:.63699951171875,f:.37299957275390627,F:.5769989013671875,g:.5909988403320312,G:.7479995727539063,h:.555999755859375,H:.7199996948242188,i:.255999755859375,I:.23699951171875,j:.26699981689453123,J:.5169998168945312,k:.5289993286132812,K:.6899993896484375,l:.23499908447265624,L:.5879989624023437,m:.854998779296875,M:.8819992065429687,n:.5589996337890625,N:.7189987182617188,o:.58599853515625,O:.7669998168945312,p:.58599853515625,P:.6419998168945312,q:.58599853515625,Q:.7669998168945312,r:.3649993896484375,R:.6759994506835938,s:.504998779296875,S:.6319992065429687,t:.354998779296875,T:.6189987182617187,u:.5599990844726562,U:.7139999389648437,v:.48199920654296874,V:.6389999389648438,w:.754998779296875,W:.929998779296875,x:.5089996337890625,X:.63699951171875,y:.4959991455078125,Y:.66199951171875,z:.48699951171875,Z:.6239990234375,"0":.6,"1":.40099945068359377,"2":.6,"3":.6,"4":.6,"5":.6,"6":.6,"7":.5469985961914062,"8":.6,"9":.6,"[":.3329986572265625,"]":.3329986572265625,",":.26399993896484375,".":.26399993896484375,";":.26399993896484375,":":.26399993896484375,"{":.3329986572265625,"}":.3329986572265625,"\\":.5,"|":.19499969482421875,"=":.604998779296875,"+":.604998779296875,"-":.604998779296875,_:.5,"`":.3329986572265625," ~":.8329986572265625,"!":.3329986572265625,"@":.8579986572265625,"#":.6,$:.6,"%":.9699996948242188,"^":.517999267578125,"&":.7259994506835937,"*":.505999755859375,"(":.3329986572265625,")":.3329986572265625,"<":.604998779296875,">":.604998779296875,"/":.5,"?":.53699951171875},ar=Math.PI,ra=Math.sin,Ta=Math.cos,$a=ra(ar/8),ja=Ta(ar/8),Oa=function(a,e){var i=a.getBBox(),s={x:i.minX,y:i.minY},l={x:i.maxX,y:i.maxY};if(e){var f=e.getMatrix();f||(f=[1,0,0,0,1,0,0,0,1]),s=Vr(s,f),l=Vr(l,f)}var d=s.x,v=s.y,x=l.x,w=l.y;return{x:d,y:v,minX:d,minY:v,maxX:x,maxY:w,width:x-d,height:w-v}},so=function(a){var e=a.sourceNode||a.targetNode,i=e.get("group"),s=i.getMatrix();s||(s=[1,0,0,0,1,0,0,0,1]);var l=e.getKeyShape(),f=l.getBBox(),d=a.loopCfg||{},v=d.dist||Math.max(f.width,f.height)*2,x=d.position||Fe.defaultLoopPosition,w=[(f.minX+f.maxX)/2+s[6],(f.minY+f.maxY)/2+s[7]],I=[a.startPoint.x,a.startPoint.y],G=[a.endPoint.x,a.endPoint.y],U=f.height/2,et=f.width/2,ft=U,Ct=U,Mt=ft*$a,kt=ft*ja,$t=Ct*$a,Jt=Ct*ja,Ce=l.get("type"),je=Math.min(U/2,et/2),ze=Math.min(U,et),pn=(d==null?void 0:d.pointPadding)?Math.min(ze,d==null?void 0:d.pointPadding):je;if(I[0]===G[0]&&I[1]===G[1]){switch(x){case"top":Ce==="circle"?(I=[w[0]-Mt,w[1]-kt],G=[w[0]+$t,w[1]-Jt]):(I=[w[0]-pn,w[1]-U],G=[w[0]+pn,w[1]-U]);break;case"top-right":ft=U,Ct=et,Ce==="circle"?(Mt=ft*$a,kt=ft*ja,$t=Ct*$a,Jt=Ct*ja,I=[w[0]+Mt,w[1]-kt],G=[w[0]+Jt,w[1]-$t]):(I=[w[0]+et-pn,w[1]-U],G=[w[0]+et,w[1]-U+pn]);break;case"right":ft=et,Ct=et,Ce==="circle"?(Mt=ft*$a,kt=ft*ja,$t=Ct*$a,Jt=Ct*ja,I=[w[0]+kt,w[1]-Mt],G=[w[0]+Jt,w[1]+$t]):(I=[w[0]+et,w[1]-pn],G=[w[0]+et,w[1]+pn]);break;case"bottom-right":ft=et,Ct=U,Ce==="circle"?(Mt=ft*$a,kt=ft*ja,$t=Ct*$a,Jt=Ct*ja,I=[w[0]+kt,w[1]+Mt],G=[w[0]+$t,w[1]+Jt]):(I=[w[0]+et,w[1]+U-pn],G=[w[0]+et-pn,w[1]+U]);break;case"bottom":ft=U,Ct=U,Ce==="circle"?(Mt=ft*$a,kt=ft*ja,$t=Ct*$a,Jt=Ct*ja,I=[w[0]+Mt,w[1]+kt],G=[w[0]-$t,w[1]+Jt]):(I=[w[0]-pn,w[1]+U],G=[w[0]+pn,w[1]+U]);break;case"bottom-left":ft=U,Ct=et,Ce==="circle"?(Mt=ft*$a,kt=ft*ja,$t=Ct*$a,Jt=Ct*ja,I=[w[0]-Mt,w[1]+kt],G=[w[0]-Jt,w[1]+$t]):(I=[w[0]-et,w[1]+U-pn],G=[w[0]-et+pn,w[1]+U]);break;case"left":ft=et,Ct=et,Ce==="circle"?(Mt=ft*$a,kt=ft*ja,$t=Ct*$a,Jt=Ct*ja,I=[w[0]-kt,w[1]+Mt],G=[w[0]-Jt,w[1]-$t]):(I=[w[0]-et,w[1]-pn],G=[w[0]-et,w[1]+pn]);break;case"top-left":ft=et,Ct=U,Ce==="circle"?(Mt=ft*$a,kt=ft*ja,$t=Ct*$a,Jt=Ct*ja,I=[w[0]-kt,w[1]-Mt],G=[w[0]-$t,w[1]-Jt]):(I=[w[0]-et+pn,w[1]-U],G=[w[0]-et,w[1]-U+pn]);break;default:ft=et,Ct=et,Mt=ft*$a,kt=ft*ja,$t=Ct*$a,Jt=Ct*ja,I=[w[0]-Mt,w[1]-kt],G=[w[0]+$t,w[1]-Jt]}if(d.clockwise===!1){var Fn=[I[0],I[1]];I=[G[0],G[1]],G=[Fn[0],Fn[1]]}}var Tn=[I[0]-w[0],I[1]-w[1]],cr=(ft+v)/ft,kr=(Ct+v)/Ct;d.clockwise===!1&&(cr=(Ct+v)/Ct,kr=(ft+v)/ft);var Aa=Bi.scale([0,0],Tn,cr),ci=[w[0]+Aa[0],w[1]+Aa[1]],ei=[G[0]-w[0],G[1]-w[1]],Ca=Bi.scale([0,0],ei,kr),Pi=[w[0]+Ca[0],w[1]+Ca[1]];return a.startPoint={x:I[0],y:I[1]},a.endPoint={x:G[0],y:G[1]},a.controlPoints=[{x:ci[0],y:ci[1]},{x:Pi[0],y:Pi[1]}],a},Ai=function(a,e,i,s,l){var f=1e-4,d=[],v=a==null?void 0:a.getPoint(e);if(!v)return{x:0,y:0,angle:0};if(e<f)d=a.getStartTangent().reverse();else if(e>1-f)d=a.getEndTangent();else{var x=a==null?void 0:a.getPoint(e+f);d.push([v.x,v.y]),d.push([x.x,x.y])}var w=Math.atan2(d[1][1]-d[0][1],d[1][0]-d[0][0]);if(w<0&&(w+=ar*2),i&&(v.x+=Ta(w)*i,v.y+=ra(w)*i),s){var I=w-ar/2;w>1/2*ar&&w<3*1/2*ar&&(I-=ar),v.x+=Ta(I)*s,v.y+=ra(I)*s}var G={x:v.x,y:v.y,angle:w};return l?(w>.5*ar&&w<1.5*ar&&(w-=ar),(0,P.__assign)({rotate:w},G)):G},Oi=function c(a,e,i,s){if(s(a,e,i)===!1)return!1;if(a&&a.children){for(var l=a.children.length-1;l>=0;l--)if(!c(a.children[l],a,l,s))return!1}return!0},hs=function c(a,e,i,s){if(a&&a.children){for(var l=a.children.length-1;l>=0;l--)if(!c(a.children[l],a,l,s))return}return s(a,e,i)!==!1},wo=function(a,e){typeof e=="function"&&Oi(a,null,-1,e)},ho=function(a,e){typeof e=="function"&&hs(a,null,-1,e)},Ro=function(a,e){return e*(In[a]||1)},Ys=function(a,e){var i=0,s=new RegExp("[\u4E00-\u9FA5]+");return a.split("").forEach(function(l){s.test(l)?i+=e:i+=Ro(l,e)}),[i,e]},Ps=function(a,e){return typeof e!="number"||e<=0||e>=a.length?a:a.substring(0,e)+"..."},As=function(a,e){var i=[],s={},l={};a.forEach(function(v){l[v.id]=v}),a.forEach(function(v,x){var w=(0,k.clone)(v);w.itemType="combo",w.children=void 0,w.parentId===w.id?(console.warn("The parentId for combo ".concat(w.id," can not be the same as the combo's id")),delete w.parentId):w.parentId&&!l[w.parentId]&&(console.warn("The parent combo for combo ".concat(w.id," does not exist!")),delete w.parentId);var I=s[w.id];if(I){if(w.children=I.children,s[w.id]=w,I=w,!I.parentId){i.push(I);return}var G=s[I.parentId];if(G)G.children?G.children.push(w):G.children=[w];else{var U={id:I.parentId,children:[I]};s[I.parentId]=U,s[w.id]=w}return}if((0,k.isString)(v.parentId)){var et=s[v.parentId];if(et)et.children?et.children.push(w):et.children=[w],s[w.id]=w;else{var ft={id:v.parentId,children:[w]};s[ft.id]=ft,s[w.id]=w}}else i.push(w),s[w.id]=w});var f={};(e||[]).forEach(function(v){f[v.id]=v;var x=s[v.comboId];if(x){var w={id:v.id,comboId:v.comboId};x.children?x.children.push(w):x.children=[w],w.itemType="node",s[v.id]=w}});var d=0;return i.forEach(function(v){v.depth=d+10,wo(v,function(x){var w,I=s[x.id].itemType;I==="node"?w=s[x.comboId]:w=s[x.parentId],w&&I==="node"?x.depth=d+1:x.depth=d+10,d<x.depth&&(d=x.depth);var G=f[x.id];return G&&(G.depth=x.depth),!0})}),i},Vs=function(a,e,i){var s,l=a,f,d={root:{children:a}},v=!1,x="root";(a||[]).forEach(function(et){if(!v){if(et.id===e){f=et,et.itemType==="combo"?f.parentId=i:f.comboId=i,v=!0;return}wo(et,function(ft){var Ct;return d[ft.id]={children:(ft==null?void 0:ft.children)||[]},l=(Ct=d[ft.parentId||ft.comboId||"root"])===null||Ct===void 0?void 0:Ct.children,ft&&(ft.removed||e===ft.id)&&l?(x=ft.parentId||ft.comboId||"root",f=ft,ft.itemType==="combo"?f.parentId=i:f.comboId=i,v=!0,!1):!0})}}),l=(s=d[x])===null||s===void 0?void 0:s.children;var w=l?l.indexOf(f):-1;if(w>-1&&l.splice(w,1),v||(f={id:e,itemType:"node",comboId:i},d[e]={children:void 0}),e){var I=!1;if(i){var G=0;(a||[]).forEach(function(et){I||wo(et,function(ft){return i===ft.id?(I=!0,ft.children?ft.children.push(f):ft.children=[f],G=ft.depth,f.itemType==="node"?f.depth=G+2:f.depth=G+1,!1):!0})})}else(!i||!I)&&f.itemType!=="node"&&a.push(f);var U=f.depth;wo(f,function(et){return et.itemType==="node"?U+=2:U+=1,et.depth=U,!0})}return a},su=function(a,e,i){var s={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity,x:void 0,y:void 0,width:void 0,height:void 0,centerX:void 0,centerY:void 0};if(!a||a.length===0){var l=i==null?void 0:i.getModel(),f=l||{},d=f.x,v=f.y,x=f.fixSize,w=f.collapsed,I=f.fixCollapseSize,G=w?I:x,U=(0,k.isArray)(G)?G:[G,G],et=U[0],ft=U[1],Ct=[et/2,ft/2];return{minX:d-Ct[0],minY:v-Ct[1],maxX:d+Ct[0],maxY:v+Ct[1],x:d,y:v,width:et,height:ft}}return a.forEach(function(Mt){var kt=e.findById(Mt.id);if(!(!kt||!kt.isVisible())){kt.set("bboxCanvasCache",void 0);var $t=kt.getCanvasBBox();$t.x&&s.minX>$t.minX&&(s.minX=$t.minX),$t.y&&s.minY>$t.minY&&(s.minY=$t.minY),$t.x&&s.maxX<$t.maxX&&(s.maxX=$t.maxX),$t.y&&s.maxY<$t.maxY&&(s.maxY=$t.maxY)}}),s.x=(s.minX+s.maxX)/2,s.y=(s.minY+s.maxY)/2,s.width=s.maxX-s.minX,s.height=s.maxY-s.minY,s.centerX=(s.minX+s.maxX)/2,s.centerY=(s.minY+s.maxY)/2,(i==null?void 0:i.getKeyShape().get("type"))==="circle"&&(s.width=Math.hypot(s.height,s.width),s.height=s.width),Object.keys(s).forEach(function(Mt){(s[Mt]===Infinity||s[Mt]===-Infinity)&&(s[Mt]=void 0)}),s},xl=function(a){var e=(0,k.isNumber)(a.x)||(0,k.isNumber)(a.y)||a.type||a.anchorPoints||a.size;return a.style&&(e=e||(0,k.isNumber)(a.style.r)||(0,k.isNumber)(a.style.width)||(0,k.isNumber)(a.style.height)||(0,k.isNumber)(a.style.rx)||(0,k.isNumber)(a.style.ry)),e},Rl=function(a){var e={};return Object.keys(a).forEach(function(i){var s=a[i];if((0,k.isObject)(s)&&!(0,k.isArray)(s)){var l={};Object.keys(s).forEach(function(f){var d=s[f];f==="img"&&!(0,k.isString)(d)||(l[f]=(0,k.clone)(d))}),e[i]=l}else e[i]=(0,k.clone)(s)}),e},Ll=function(a){var e=a.animateCfg,i=a.callback,s;if(!e)s={duration:500,callback:i};else if(s=(0,k.clone)(e),e.callback){var l=e.callback;s.callback=function(){i(),l()}}else s.callback=i;return s},nl=function(a){if(!a)return console.error("G6 Error Tips: the data must be defined"),!1;var e=a.nodes,i=a.edges,s=a.combos,l=s===void 0?[]:s;if(!e&&!i){var f=!0;return wo(a,function(G){return(0,k.isString)(G.id)?!0:(f=!1,!1)}),f}var d=(e||[]).find(function(G){return!(0,k.isString)(G.id)});if(d)return console.warn("G6 Warning Tips: missing 'id' property, or %c".concat(d.id,"%c is not a string."),"font-size: 20px; color: red;",""),!1;var v=(e||[]).map(function(G){return G.id}),x=l==null?void 0:l.map(function(G){return G.id}),w=(0,P.__spreadArray)((0,P.__spreadArray)([],v,!0),x,!0),I=(i||[]).find(function(G){return!w.includes(G.source)||!w.includes(G.target)});return I?(console.warn("G6 Warning Tips: The source %c".concat(I.source,"%c or the target %c").concat(I.target,"%c of the edge do not exist in the nodes or combos."),"font-size: 20px; color: red;","","font-size: 20px; color: red;",""),!1):!0},rl=function(a,e){if(a==="node"||a==="combo"){if(e.id&&!(0,k.isString)(e.id))return console.warn("G6 Warning Tips: missing 'id' property, or the 'id' %c".concat(e.id,"%c is not a string."),"font-size: 20px; color: red;",""),!1}else if(a==="edge"&&(!e.source||!e.target))return console.warn("G6 Warning Tips: missing 'source' or 'target' for the edge."),!1;return!0},Ef=function(){function c(a){this.graph=a,this.destroyed=!1,this.modes=a.get("modes")||{default:[]},this.formatModes(),this.mode=a.get("defaultMode")||"default",this.currentBehaves=[],this.setMode(this.mode)}return c.prototype.formatModes=function(){var a=this.modes;(0,k.each)(a,function(e){(0,k.each)(e,function(i,s){(0,k.isString)(i)&&(e[s]={type:i})})})},c.prototype.setBehaviors=function(a){var e=this.graph,i=this.modes[a],s=[],l;(0,k.each)(i||[],function(f){var d=lt.getBehavior(f.type||f);!d||(l=new d(f),l&&(l.bind(e),s.push(l)))}),this.currentBehaves=s},c.mergeBehaviors=function(a,e){return(0,k.each)(e,function(i){a.indexOf(i)<0&&((0,k.isString)(i)&&(i={type:i}),a.push(i))}),a},c.filterBehaviors=function(a,e){var i=[];return a.forEach(function(s){var l="";(0,k.isString)(s)?l=s:l=s.type,e.indexOf(l)<0&&i.push(s)}),i},c.prototype.setMode=function(a){var e=this,i=e.modes,s=e.graph,l=a,f=i[l];!f||(s.emit("beforemodechange",{mode:a}),(0,k.each)(this.currentBehaves,function(d){d.delegate&&d.delegate.remove(),d.unbind(s)}),this.setBehaviors(l),s.emit("aftermodechange",{mode:a}),this.mode=a)},c.prototype.getMode=function(){return this.mode},c.prototype.manipulateBehaviors=function(a,e,i){var s=this,l;if((0,k.isArray)(a)?l=a:l=[a],(0,k.isArray)(e))return(0,k.each)(e,function(d){s.modes[d]?i?s.modes[d]=c.mergeBehaviors(s.modes[d]||[],l):s.modes[d]=c.filterBehaviors(s.modes[d]||[],l):i&&(s.modes[d]=l)}),this;var f=e;return e||(f=this.mode),this.modes[f]||i&&(this.modes[f]=l),i?this.modes[f]=c.mergeBehaviors(this.modes[f]||[],l):this.modes[f]=c.filterBehaviors(this.modes[f]||[],l),this.formatModes(),this.setMode(this.mode),this},c.prototype.updateBehavior=function(a,e,i){(0,k.isString)(a)&&(a={type:a});var s=[];if(!i||i===this.mode||i==="default"){if(s=this.currentBehaves,!s||!s.length)return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."),this;for(var l=s.length,f=0;f<l;f++){var d=s[f];if(d.type===a.type)return d.updateCfg(e),this;f===l-1&&console.warn("Update behavior failed! There is no such behavior in the mode")}}else{if(s=this.modes[i],!s||!s.length)return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."),this;for(var v=s.length,f=0;f<v;f++){var d=s[f];if(d.type===a.type||d===a.type)return d===a.type&&(d={type:d}),Object.assign(d,e),s[f]=d,this;f===v-1&&console.warn("Update behavior failed! There is no such behavior in the mode")}}return this},c.prototype.destroy=function(){this.graph=null,this.modes=null,this.currentBehaves=null,this.destroyed=!0},c}(),Sf=Ef,Yl=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,Cf=new RegExp("([a-z])["+Yl+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Yl+"]*,?["+Yl+"]*)+)","ig"),T=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Yl+"]*,?["+Yl+"]*","ig"),rt=function(c){if(!c)return null;if((0,k.isArray)(c))return c;var a={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},e=[];return String(c).replace(Cf,function(i,s,l){var f=[],d=s.toLowerCase();if(l.replace(T,function(v,x){x&&f.push(+x)}),d==="m"&&f.length>2&&(e.push([s].concat(f.splice(0,2))),d="l",s=s==="m"?"l":"L"),d==="o"&&f.length===1&&e.push([s,f[0]]),d==="r")e.push([s].concat(f));else for(;f.length>=a[d]&&(e.push([s].concat(f.splice(0,a[d]))),!!a[d]););return c}),e},Kt=function(c,a){for(var e=[],i=0,s=c.length;s-2*!a>i;i+=2){var l=[{x:+c[i-2],y:+c[i-1]},{x:+c[i],y:+c[i+1]},{x:+c[i+2],y:+c[i+3]},{x:+c[i+4],y:+c[i+5]}];a?i?s-4===i?l[3]={x:+c[0],y:+c[1]}:s-2===i&&(l[2]={x:+c[0],y:+c[1]},l[3]={x:+c[2],y:+c[3]}):l[0]={x:+c[s-2],y:+c[s-1]}:s-4===i?l[3]=l[2]:i||(l[0]={x:+c[i],y:+c[i+1]}),e.push(["C",(-l[0].x+6*l[1].x+l[2].x)/6,(-l[0].y+6*l[1].y+l[2].y)/6,(l[1].x+6*l[2].x-l[3].x)/6,(l[1].y+6*l[2].y-l[3].y)/6,l[2].x,l[2].y])}return e},pe=function(c,a,e,i,s){var l=[];if(s===null&&i===null&&(i=e),c=+c,a=+a,e=+e,i=+i,s!==null){var f=Math.PI/180,d=c+e*Math.cos(-i*f),v=c+e*Math.cos(-s*f),x=a+e*Math.sin(-i*f),w=a+e*Math.sin(-s*f);l=[["M",d,x],["A",e,e,0,+(s-i>180),0,v,w]]}else l=[["M",c,a],["m",0,-i],["a",e,i,0,1,1,0,2*i],["a",e,i,0,1,1,0,-2*i],["z"]];return l},Re=function(c){if(c=rt(c),!c||!c.length)return[["M",0,0]];var a=[],e=0,i=0,s=0,l=0,f=0,d,v;c[0][0]==="M"&&(e=+c[0][1],i=+c[0][2],s=e,l=i,f++,a[0]=["M",e,i]);for(var x=c.length===3&&c[0][0]==="M"&&c[1][0].toUpperCase()==="R"&&c[2][0].toUpperCase()==="Z",w=void 0,I=void 0,G=f,U=c.length;G<U;G++){if(a.push(w=[]),I=c[G],d=I[0],d!==d.toUpperCase())switch(w[0]=d.toUpperCase(),w[0]){case"A":w[1]=I[1],w[2]=I[2],w[3]=I[3],w[4]=I[4],w[5]=I[5],w[6]=+I[6]+e,w[7]=+I[7]+i;break;case"V":w[1]=+I[1]+i;break;case"H":w[1]=+I[1]+e;break;case"R":v=[e,i].concat(I.slice(1));for(var et=2,ft=v.length;et<ft;et++)v[et]=+v[et]+e,v[++et]=+v[et]+i;a.pop(),a=a.concat(Kt(v,x));break;case"O":a.pop(),v=pe(e,i,I[1],I[2]),v.push(v[0]),a=a.concat(v);break;case"U":a.pop(),a=a.concat(pe(e,i,I[1],I[2],I[3])),w=["U"].concat(a[a.length-1].slice(-2));break;case"M":s=+I[1]+e,l=+I[2]+i;break;default:for(var et=1,ft=I.length;et<ft;et++)w[et]=+I[et]+(et%2?e:i)}else if(d==="R")v=[e,i].concat(I.slice(1)),a.pop(),a=a.concat(Kt(v,x)),w=["R"].concat(I.slice(-2));else if(d==="O")a.pop(),v=pe(e,i,I[1],I[2]),v.push(v[0]),a=a.concat(v);else if(d==="U")a.pop(),a=a.concat(pe(e,i,I[1],I[2],I[3])),w=["U"].concat(a[a.length-1].slice(-2));else for(var Ct=0,Mt=I.length;Ct<Mt;Ct++)w[Ct]=I[Ct];if(d=d.toUpperCase(),d!=="O")switch(w[0]){case"Z":e=+s,i=+l;break;case"H":e=w[1];break;case"V":i=w[1];break;case"M":s=w[w.length-2],l=w[w.length-1];break;default:e=w[w.length-2],i=w[w.length-1]}}return a},Je=function(c,a,e,i){return[c,a,e,i,e,i]},an=function(c,a,e,i,s,l){var f=1/3,d=2/3;return[f*c+d*e,f*a+d*i,f*s+d*e,f*l+d*i,s,l]},wn=function(c,a,e,i,s,l,f,d,v,x){e===i&&(e+=1);var w=Math.PI*120/180,I=Math.PI/180*(+s||0),G=[],U,et,ft,Ct,Mt,kt=function(hl,Lu,dl){var _l=hl*Math.cos(dl)-Lu*Math.sin(dl),rc=hl*Math.sin(dl)+Lu*Math.cos(dl);return{x:_l,y:rc}};if(x)et=x[0],ft=x[1],Ct=x[2],Mt=x[3];else{U=kt(c,a,-I),c=U.x,a=U.y,U=kt(d,v,-I),d=U.x,v=U.y,c===d&&a===v&&(d+=1,v+=1);var $t=(c-d)/2,Jt=(a-v)/2,Ce=$t*$t/(e*e)+Jt*Jt/(i*i);Ce>1&&(Ce=Math.sqrt(Ce),e=Ce*e,i=Ce*i);var je=e*e,ze=i*i,pn=(l===f?-1:1)*Math.sqrt(Math.abs((je*ze-je*Jt*Jt-ze*$t*$t)/(je*Jt*Jt+ze*$t*$t)));Ct=pn*e*Jt/i+(c+d)/2,Mt=pn*-i*$t/e+(a+v)/2,et=Math.asin(((a-Mt)/i).toFixed(9)),ft=Math.asin(((v-Mt)/i).toFixed(9)),et=c<Ct?Math.PI-et:et,ft=d<Ct?Math.PI-ft:ft,et<0&&(et=Math.PI*2+et),ft<0&&(ft=Math.PI*2+ft),f&&et>ft&&(et=et-Math.PI*2),!f&&ft>et&&(ft=ft-Math.PI*2)}var Fn=ft-et;if(Math.abs(Fn)>w){var Tn=ft,cr=d,kr=v;ft=et+w*(f&&ft>et?1:-1),d=Ct+e*Math.cos(ft),v=Mt+i*Math.sin(ft),G=wn(d,v,e,i,s,0,f,cr,kr,[ft,Tn,Ct,Mt])}Fn=ft-et;var Aa=Math.cos(et),ci=Math.sin(et),ei=Math.cos(ft),Ca=Math.sin(ft),Pi=Math.tan(Fn/4),Ni=4/3*e*Pi,_a=4/3*i*Pi,Ya=[c,a],hi=[c+Ni*ci,a-_a*Aa],di=[d+Ni*Ca,v-_a*ei],Xi=[d,v];if(hi[0]=2*Ya[0]-hi[0],hi[1]=2*Ya[1]-hi[1],x)return[hi,di,Xi].concat(G);G=[hi,di,Xi].concat(G).join().split(",");for(var go=[],vs=0,Fs=G.length;vs<Fs;vs++)go[vs]=vs%2?kt(G[vs-1],G[vs],I).y:kt(G[vs],G[vs+1],I).x;return go},Mn=function(c,a){var e=Re(c),i=a&&Re(a),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},l={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},f=[],d=[],v="",x="",w,I=function($t,Jt,Ce){var je,ze;if(!$t)return["C",Jt.x,Jt.y,Jt.x,Jt.y,Jt.x,Jt.y];switch(!($t[0]in{T:1,Q:1})&&(Jt.qx=Jt.qy=null),$t[0]){case"M":Jt.X=$t[1],Jt.Y=$t[2];break;case"A":$t=["C"].concat(wn.apply(0,[Jt.x,Jt.y].concat($t.slice(1))));break;case"S":Ce==="C"||Ce==="S"?(je=Jt.x*2-Jt.bx,ze=Jt.y*2-Jt.by):(je=Jt.x,ze=Jt.y),$t=["C",je,ze].concat($t.slice(1));break;case"T":Ce==="Q"||Ce==="T"?(Jt.qx=Jt.x*2-Jt.qx,Jt.qy=Jt.y*2-Jt.qy):(Jt.qx=Jt.x,Jt.qy=Jt.y),$t=["C"].concat(an(Jt.x,Jt.y,Jt.qx,Jt.qy,$t[1],$t[2]));break;case"Q":Jt.qx=$t[1],Jt.qy=$t[2],$t=["C"].concat(an(Jt.x,Jt.y,$t[1],$t[2],$t[3],$t[4]));break;case"L":$t=["C"].concat(Je(Jt.x,Jt.y,$t[1],$t[2]));break;case"H":$t=["C"].concat(Je(Jt.x,Jt.y,$t[1],Jt.y));break;case"V":$t=["C"].concat(Je(Jt.x,Jt.y,Jt.x,$t[1]));break;case"Z":$t=["C"].concat(Je(Jt.x,Jt.y,Jt.X,Jt.Y));break;default:break}return $t},G=function($t,Jt){if($t[Jt].length>7){$t[Jt].shift();for(var Ce=$t[Jt];Ce.length;)f[Jt]="A",i&&(d[Jt]="A"),$t.splice(Jt++,0,["C"].concat(Ce.splice(0,6)));$t.splice(Jt,1),w=Math.max(e.length,i&&i.length||0)}},U=function($t,Jt,Ce,je,ze){$t&&Jt&&$t[ze][0]==="M"&&Jt[ze][0]!=="M"&&(Jt.splice(ze,0,["M",je.x,je.y]),Ce.bx=0,Ce.by=0,Ce.x=$t[ze][1],Ce.y=$t[ze][2],w=Math.max(e.length,i&&i.length||0))};w=Math.max(e.length,i&&i.length||0);for(var et=0;et<w;et++){e[et]&&(v=e[et][0]),v!=="C"&&(f[et]=v,et&&(x=f[et-1])),e[et]=I(e[et],s,x),f[et]!=="A"&&v==="C"&&(f[et]="C"),G(e,et),i&&(i[et]&&(v=i[et][0]),v!=="C"&&(d[et]=v,et&&(x=d[et-1])),i[et]=I(i[et],l,x),d[et]!=="A"&&v==="C"&&(d[et]="C"),G(i,et)),U(e,i,s,l,et),U(i,e,l,s,et);var ft=e[et],Ct=i&&i[et],Mt=ft.length,kt=i&&Ct.length;s.x=ft[Mt-2],s.y=ft[Mt-1],s.bx=parseFloat(ft[Mt-4])||s.x,s.by=parseFloat(ft[Mt-3])||s.y,l.bx=i&&(parseFloat(Ct[kt-4])||l.x),l.by=i&&(parseFloat(Ct[kt-3])||l.y),l.x=i&&Ct[kt-2],l.y=i&&Ct[kt-1]}return i?[e,i]:e},rr=/,?([a-z]),?/gi,We=function(c){return c.join(",").replace(rr,"$1")},ca=function(c,a,e,i,s){var l=-3*a+9*e-9*i+3*s,f=c*l+6*a-12*e+6*i;return c*f-3*a+3*e},ha=function(c,a,e,i,s,l,f,d,v){v===null&&(v=1),v=v>1?1:v<0?0:v;for(var x=v/2,w=12,I=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],G=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],U=0,et=0;et<w;et++){var ft=x*I[et]+x,Ct=ca(ft,c,e,s,f),Mt=ca(ft,a,i,l,d),kt=Ct*Ct+Mt*Mt;U+=G[et]*Math.sqrt(kt)}return x*U},_r=function(c,a,e,i,s,l,f,d){for(var v=[],x=[[],[]],w,I,G,U,et=0;et<2;++et){if(et===0?(I=6*c-12*e+6*s,w=-3*c+9*e-9*s+3*f,G=3*e-3*c):(I=6*a-12*i+6*l,w=-3*a+9*i-9*l+3*d,G=3*i-3*a),Math.abs(w)<1e-12){if(Math.abs(I)<1e-12)continue;U=-G/I,U>0&&U<1&&v.push(U);continue}var ft=I*I-4*G*w,Ct=Math.sqrt(ft);if(!(ft<0)){var Mt=(-I+Ct)/(2*w);Mt>0&&Mt<1&&v.push(Mt);var kt=(-I-Ct)/(2*w);kt>0&&kt<1&&v.push(kt)}}for(var $t=v.length,Jt=$t,Ce;$t--;)U=v[$t],Ce=1-U,x[0][$t]=Ce*Ce*Ce*c+3*Ce*Ce*U*e+3*Ce*U*U*s+U*U*U*f,x[1][$t]=Ce*Ce*Ce*a+3*Ce*Ce*U*i+3*Ce*U*U*l+U*U*U*d;return x[0][Jt]=c,x[1][Jt]=a,x[0][Jt+1]=f,x[1][Jt+1]=d,x[0].length=x[1].length=Jt+2,{min:{x:Math.min.apply(0,x[0]),y:Math.min.apply(0,x[1])},max:{x:Math.max.apply(0,x[0]),y:Math.max.apply(0,x[1])}}},Va=function(c,a,e,i,s,l,f,d){if(!(Math.max(c,e)<Math.min(s,f)||Math.min(c,e)>Math.max(s,f)||Math.max(a,i)<Math.min(l,d)||Math.min(a,i)>Math.max(l,d))){var v=(c*i-a*e)*(s-f)-(c-e)*(s*d-l*f),x=(c*i-a*e)*(l-d)-(a-i)*(s*d-l*f),w=(c-e)*(l-d)-(a-i)*(s-f);if(!!w){var I=v/w,G=x/w,U=+I.toFixed(2),et=+G.toFixed(2);if(!(U<+Math.min(c,e).toFixed(2)||U>+Math.max(c,e).toFixed(2)||U<+Math.min(s,f).toFixed(2)||U>+Math.max(s,f).toFixed(2)||et<+Math.min(a,i).toFixed(2)||et>+Math.max(a,i).toFixed(2)||et<+Math.min(l,d).toFixed(2)||et>+Math.max(l,d).toFixed(2)))return{x:I,y:G}}}},qa=function(c,a,e){return a>=c.x&&a<=c.x+c.width&&e>=c.y&&e<=c.y+c.height},ma=function(c,a,e,i,s){if(s)return[["M",+c+ +s,a],["l",e-s*2,0],["a",s,s,0,0,1,s,s],["l",0,i-s*2],["a",s,s,0,0,1,-s,s],["l",s*2-e,0],["a",s,s,0,0,1,-s,-s],["l",0,s*2-i],["a",s,s,0,0,1,s,-s],["z"]];var l=[["M",c,a],["l",e,0],["l",0,i],["l",-e,0],["z"]];return l.parsePathArray=We,l},Mi=function(c,a,e,i){return c===null&&(c=a=e=i=0),a===null&&(a=c.y,e=c.width,i=c.height,c=c.x),{x:c,y:a,width:e,w:e,height:i,h:i,x2:c+e,y2:a+i,cx:c+e/2,cy:a+i/2,r1:Math.min(e,i)/2,r2:Math.max(e,i)/2,r0:Math.sqrt(e*e+i*i)/2,path:ma(c,a,e,i),vb:[c,a,e,i].join(" ")}},zo=function(c,a){return c=Mi(c),a=Mi(a),qa(a,c.x,c.y)||qa(a,c.x2,c.y)||qa(a,c.x,c.y2)||qa(a,c.x2,c.y2)||qa(c,a.x,a.y)||qa(c,a.x2,a.y)||qa(c,a.x,a.y2)||qa(c,a.x2,a.y2)||(c.x<a.x2&&c.x>a.x||a.x<c.x2&&a.x>c.x)&&(c.y<a.y2&&c.y>a.y||a.y<c.y2&&a.y>c.y)},_o=function(c,a,e,i,s,l,f,d){(0,k.isArray)(c)||(c=[c,a,e,i,s,l,f,d]);var v=_r.apply(null,c);return Mi(v.min.x,v.min.y,v.max.x-v.min.x,v.max.y-v.min.y)},Lo=function(c,a,e,i,s,l,f,d,v){var x=1-v,w=Math.pow(x,3),I=Math.pow(x,2),G=v*v,U=G*v,et=w*c+I*3*v*e+x*3*v*v*s+U*f,ft=w*a+I*3*v*i+x*3*v*v*l+U*d,Ct=c+2*v*(e-c)+G*(s-2*e+c),Mt=a+2*v*(i-a)+G*(l-2*i+a),kt=e+2*v*(s-e)+G*(f-2*s+e),$t=i+2*v*(l-i)+G*(d-2*l+i),Jt=x*c+v*e,Ce=x*a+v*i,je=x*s+v*f,ze=x*l+v*d,pn=90-Math.atan2(Ct-kt,Mt-$t)*180/Math.PI;return{x:et,y:ft,m:{x:Ct,y:Mt},n:{x:kt,y:$t},start:{x:Jt,y:Ce},end:{x:je,y:ze},alpha:pn}},yo=function(c,a,e){var i=_o(c),s=_o(a);if(!zo(i,s))return e?0:[];for(var l=ha.apply(0,c),f=ha.apply(0,a),d=~~(l/8),v=~~(f/8),x=[],w=[],I={},G=e?0:[],U=0;U<d+1;U++){var et=Lo.apply(0,c.concat(U/d));x.push({x:et.x,y:et.y,t:U/d})}for(var U=0;U<v+1;U++){var et=Lo.apply(0,a.concat(U/v));w.push({x:et.x,y:et.y,t:U/v})}for(var U=0;U<d;U++)for(var ft=0;ft<v;ft++){var Ct=x[U],Mt=x[U+1],kt=w[ft],$t=w[ft+1],Jt=Math.abs(Mt.x-Ct.x)<.001?"y":"x",Ce=Math.abs($t.x-kt.x)<.001?"y":"x",je=Va(Ct.x,Ct.y,Mt.x,Mt.y,kt.x,kt.y,$t.x,$t.y);if(je){if(I[je.x.toFixed(4)]===je.y.toFixed(4))continue;I[je.x.toFixed(4)]=je.y.toFixed(4);var ze=Ct.t+Math.abs((je[Jt]-Ct[Jt])/(Mt[Jt]-Ct[Jt]))*(Mt.t-Ct.t),pn=kt.t+Math.abs((je[Ce]-kt[Ce])/($t[Ce]-kt[Ce]))*($t.t-kt.t);ze>=0&&ze<=1&&pn>=0&&pn<=1&&(e?G+=1:G.push({x:je.x,y:je.y,t1:ze,t2:pn}))}}return G},No=function(c,a,e){c=Mn(c),a=Mn(a);for(var i,s,l,f,d,v,x,w,I,G,U=e?0:[],et=0,ft=c.length;et<ft;et++){var Ct=c[et];if(Ct[0]==="M")i=d=Ct[1],s=v=Ct[2];else{Ct[0]==="C"?(I=[i,s].concat(Ct.slice(1)),i=I[6],s=I[7]):(I=[i,s,i,s,d,v,d,v],i=d,s=v);for(var Mt=0,kt=a.length;Mt<kt;Mt++){var $t=a[Mt];if($t[0]==="M")l=x=$t[1],f=w=$t[2];else{$t[0]==="C"?(G=[l,f].concat($t.slice(1)),l=G[6],f=G[7]):(G=[l,f,l,f,x,w,x,w],l=x,f=w);var Jt=yo(I,G,e);if(e)U+=Jt;else{for(var Ce=0,je=Jt.length;Ce<je;Ce++)Jt[Ce].segment1=et,Jt[Ce].segment2=Mt,Jt[Ce].bez1=I,Jt[Ce].bez2=G;U=U.concat(Jt)}}}}}return U},Vu=function(c,a){return No(c,a)};function Bu(c,a){var e=[],i=[];function s(l,f){if(l.length===1)e.push(l[0]),i.push(l[0]);else{for(var d=[],v=0;v<l.length-1;v++)v===0&&e.push(l[0]),v===l.length-2&&i.push(l[v+1]),d[v]=[(1-f)*l[v][0]+f*l[v+1][0],(1-f)*l[v][1]+f*l[v+1][1]];s(d,f)}}return c.length&&s(c,a),{left:e,right:i.reverse()}}function ju(c,a,e){var i=[[c[1],c[2]]];e=e||2;var s=[];a[0]==="A"?(i.push(a[6]),i.push(a[7])):a[0]==="C"?(i.push([a[1],a[2]]),i.push([a[3],a[4]]),i.push([a[5],a[6]])):a[0]==="S"||a[0]==="Q"?(i.push([a[1],a[2]]),i.push([a[3],a[4]])):i.push([a[1],a[2]]);for(var l=i,f=1/e,d=0;d<e-1;d++){var v=f/(1-f*d),x=Bu(l,v);s.push(x.left),l=x.right}s.push(l);var w=s.map(function(I){var G=[];return I.length===4&&(G.push("C"),G=G.concat(I[2])),I.length>=3&&(I.length===3&&G.push("Q"),G=G.concat(I[1])),I.length===2&&G.push("L"),G=G.concat(I[I.length-1]),G});return w}var tl=function(c,a,e){if(e===1)return[[].concat(c)];var i=[];if(a[0]==="L"||a[0]==="C"||a[0]==="Q")i=i.concat(ju(c,a,e));else{var s=[].concat(c);s[0]==="M"&&(s[0]="L");for(var l=0;l<=e-1;l++)i.push(s)}return i},Hu=function(c,a){if(c.length===1)return c;var e=c.length-1,i=a.length-1,s=e/i,l=[];if(c.length===1&&c[0][0]==="M"){for(var f=0;f<i-e;f++)c.push(c[0]);return c}for(var f=0;f<i;f++){var d=Math.floor(s*f);l[d]=(l[d]||0)+1}var v=l.reduce(function(x,w,I){return I===e?x.concat(c[e]):x.concat(tl(c[I],c[I+1],w))},[]);return v.unshift(c[0]),(a[i]==="Z"||a[i]==="z")&&v.push("Z"),v},al=function(c,a){if(c.length!==a.length)return!1;var e=!0;return(0,k.each)(c,function(i,s){if(i!==a[s])return e=!1,!1}),e};function il(c,a,e){var i=null,s=e;return a<s&&(s=a,i="add"),c<s&&(s=c,i="del"),{type:i,min:s}}var ds=function(c,a){var e=c.length,i=a.length,s,l,f=0;if(e===0||i===0)return null;for(var d=[],v=0;v<=e;v++)d[v]=[],d[v][0]={min:v};for(var x=0;x<=i;x++)d[0][x]={min:x};for(var v=1;v<=e;v++){s=c[v-1];for(var x=1;x<=i;x++){l=a[x-1],al(s,l)?f=0:f=1;var w=d[v-1][x].min+1,I=d[v][x-1].min+1,G=d[v-1][x-1].min+f;d[v][x]=il(w,I,G)}}return d},uu=function(c,a){var e=ds(c,a),i=c.length,s=a.length,l=[],f=1,d=1;if(e[i][s].min!==i){for(var v=1;v<=i;v++){var x=e[v][v].min;d=v;for(var w=f;w<=s;w++)e[v][w].min<x&&(x=e[v][w].min,d=w);f=d,e[v][f].type&&l.push({index:v-1,type:e[v][f].type})}for(var v=l.length-1;v>=0;v--)f=l[v].index,l[v].type==="add"?c.splice(f,0,[].concat(c[f])):c.splice(f,1)}i=c.length;var I=s-i;if(i<s)for(var v=0;v<I;v++)c[i-1][0]==="z"||c[i-1][0]==="Z"?c.splice(i-2,0,c[i-2]):c.push(c[i-1]),i+=1;return c};function Jc(c,a,e){for(var i=[].concat(c),s,l=1/(e+1),f=tf(a)[0],d=1;d<=e;d++)l*=d,s=Math.floor(c.length*l),s===0?i.unshift([f[0]*l+c[s][0]*(1-l),f[1]*l+c[s][1]*(1-l)]):i.splice(s,0,[f[0]*l+c[s][0]*(1-l),f[1]*l+c[s][1]*(1-l)]);return i}function tf(c){var a=[];switch(c[0]){case"M":a.push([c[1],c[2]]);break;case"L":a.push([c[1],c[2]]);break;case"A":a.push([c[6],c[7]]);break;case"Q":a.push([c[3],c[4]]),a.push([c[1],c[2]]);break;case"T":a.push([c[1],c[2]]);break;case"C":a.push([c[5],c[6]]),a.push([c[1],c[2]]),a.push([c[3],c[4]]);break;case"S":a.push([c[3],c[4]]),a.push([c[1],c[2]]);break;case"H":a.push([c[1],c[1]]);break;case"V":a.push([c[1],c[1]]);break;default:}return a}var zl=function(c,a){if(c.length<=1)return c;for(var e,i=0;i<a.length;i++)if(c[i][0]!==a[i][0])switch(e=tf(c[i]),a[i][0]){case"M":c[i]=["M"].concat(e[0]);break;case"L":c[i]=["L"].concat(e[0]);break;case"A":c[i]=[].concat(a[i]),c[i][6]=e[0][0],c[i][7]=e[0][1];break;case"Q":if(e.length<2)if(i>0)e=Jc(e,c[i-1],1);else{c[i]=a[i];break}c[i]=["Q"].concat(e.reduce(function(s,l){return s.concat(l)},[]));break;case"T":c[i]=["T"].concat(e[0]);break;case"C":if(e.length<3)if(i>0)e=Jc(e,c[i-1],2);else{c[i]=a[i];break}c[i]=["C"].concat(e.reduce(function(s,l){return s.concat(l)},[]));break;case"S":if(e.length<2)if(i>0)e=Jc(e,c[i-1],1);else{c[i]=a[i];break}c[i]=["S"].concat(e.reduce(function(s,l){return s.concat(l)},[]));break;default:c[i]=a[i]}return c},wl=function(){function c(a,e){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=a,this.name=a,this.originalEvent=e,this.timeStamp=e.timeStamp}return c.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},c.prototype.stopPropagation=function(){this.propagationStopped=!0},c.prototype.toString=function(){var a=this.type;return"[Event (type="+a+")]"},c.prototype.save=function(){},c.prototype.restore=function(){},c}(),hh=wl;function Nd(c,a){var e=c.indexOf(a);e!==-1&&c.splice(e,1)}var fp=typeof window!="undefined"&&typeof window.document!="undefined";function Vp(c,a){if(c.isCanvas())return!0;for(var e=a.getParent(),i=!1;e;){if(e===c){i=!0;break}e=e.getParent()}return i}function dh(c){return c.cfg.visible&&c.cfg.capture}var kd=function(c){(0,P.__extends)(a,c);function a(e){var i=c.call(this)||this;i.destroyed=!1;var s=i.getDefaultCfg();return i.cfg=(0,k.mix)(s,e),i}return a.prototype.getDefaultCfg=function(){return{}},a.prototype.get=function(e){return this.cfg[e]},a.prototype.set=function(e,i){this.cfg[e]=i},a.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},a}(ut),jp=kd,df=$(34155),Rf=function(c,a,e){if(e||arguments.length===2)for(var i=0,s=a.length,l;i<s;i++)(l||!(i in a))&&(l||(l=Array.prototype.slice.call(a,0,i)),l[i]=a[i]);return c.concat(l||Array.prototype.slice.call(a))},hp=function(){function c(a,e,i){this.name=a,this.version=e,this.os=i,this.type="browser"}return c}(),jf=function(){function c(a){this.version=a,this.type="node",this.name="node",this.os=df.platform}return c}(),pf=function(){function c(a,e,i,s){this.name=a,this.version=e,this.os=i,this.bot=s,this.type="bot-device"}return c}(),ph=function(){function c(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return c}(),Ri=function(){function c(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return c}(),Lh=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,bs=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ph=3,sc=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Lh]],ef=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function vf(c){return c?js(c):typeof document=="undefined"&&typeof navigator!="undefined"&&navigator.product==="ReactNative"?new Ri:typeof navigator!="undefined"?js(navigator.userAgent):Pl()}function vh(c){return c!==""&&sc.reduce(function(a,e){var i=e[0],s=e[1];if(a)return a;var l=s.exec(c);return!!l&&[i,l]},!1)}function Lf(c){var a=vh(c);return a?a[0]:null}function js(c){var a=vh(c);if(!a)return null;var e=a[0],i=a[1];if(e==="searchbot")return new ph;var s=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);s?s.length<Ph&&(s=Rf(Rf([],s,!0),Dt(Ph-s.length),!0)):s=[];var l=s.join("."),f=dp(c),d=bs.exec(c);return d&&d[1]?new pf(e,l,f,d[1]):new hp(e,l,f)}function dp(c){for(var a=0,e=ef.length;a<e;a++){var i=ef[a],s=i[0],l=i[1],f=l.exec(c);if(f)return s}return null}function Pl(){var c=typeof df!="undefined"&&df.version;return c?new jf(df.version.slice(1)):null}function Dt(c){for(var a=[],e=0;e<c;e++)a.push("0");return a}function ae(c,a){var e=[],i=c[0],s=c[1],l=c[2],f=c[3],d=c[4],v=c[5],x=c[6],w=c[7],I=c[8],G=a[0],U=a[1],et=a[2],ft=a[3],Ct=a[4],Mt=a[5],kt=a[6],$t=a[7],Jt=a[8];return e[0]=G*i+U*f+et*x,e[1]=G*s+U*d+et*w,e[2]=G*l+U*v+et*I,e[3]=ft*i+Ct*f+Mt*x,e[4]=ft*s+Ct*d+Mt*w,e[5]=ft*l+Ct*v+Mt*I,e[6]=kt*i+$t*f+Jt*x,e[7]=kt*s+$t*d+Jt*w,e[8]=kt*l+$t*v+Jt*I,e}function xe(c,a){var e=[],i=a[0],s=a[1];return e[0]=c[0]*i+c[3]*s+c[6],e[1]=c[1]*i+c[4]*s+c[7],e}function qe(c){var a=[],e=c[0],i=c[1],s=c[2],l=c[3],f=c[4],d=c[5],v=c[6],x=c[7],w=c[8],I=w*f-d*x,G=-w*l+d*v,U=x*l-f*v,et=e*I+i*G+s*U;return et?(et=1/et,a[0]=I*et,a[1]=(-w*i+s*x)*et,a[2]=(d*i-s*f)*et,a[3]=G*et,a[4]=(w*e-s*v)*et,a[5]=(-d*e+s*l)*et,a[6]=U*et,a[7]=(-x*e+i*v)*et,a[8]=(f*e-i*l)*et,a):null}var yn=Le,Er="matrix",Cr=["zIndex","capture","visible","type"],oa=["repeat"],Nn=":",Pa="*";function wi(c){for(var a=[],e=0;e<c.length;e++)(0,k.isArray)(c[e])?a.push([].concat(c[e])):a.push(c[e]);return a}function Ui(c,a){var e={},i=a.attrs;for(var s in c)e[s]=i[s];return e}function Ei(c,a){var e={},i=a.attr();return(0,k.each)(c,function(s,l){oa.indexOf(l)===-1&&!(0,k.isEqual)(i[l],s)&&(e[l]=s)}),e}function Oo(c,a){if(a.onFrame)return c;var e=a.startTime,i=a.delay,s=a.duration,l=Object.prototype.hasOwnProperty;return(0,k.each)(c,function(f){e+i<f.startTime+f.delay+f.duration&&s>f.delay&&(0,k.each)(a.toAttrs,function(d,v){l.call(f.toAttrs,v)&&(delete f.toAttrs[v],delete f.fromAttrs[v])})}),c}var us=function(c){(0,P.__extends)(a,c);function a(e){var i=c.call(this,e)||this;i.attrs={};var s=i.getDefaultAttrs();return(0,k.mix)(s,e.attrs),i.attrs=s,i.initAttrs(s),i.initAnimate(),i}return a.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},a.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},a.prototype.onCanvasChange=function(e){},a.prototype.initAttrs=function(e){},a.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},a.prototype.isGroup=function(){return!1},a.prototype.getParent=function(){return this.get("parent")},a.prototype.getCanvas=function(){return this.get("canvas")},a.prototype.attr=function(){for(var e,i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var l=i[0],f=i[1];if(!l)return this.attrs;if((0,k.isObject)(l)){for(var d in l)this.setAttr(d,l[d]);return this.afterAttrsChange(l),this}return i.length===2?(this.setAttr(l,f),this.afterAttrsChange((e={},e[l]=f,e)),this):this.attrs[l]},a.prototype.isClipped=function(e,i){var s=this.getClip();return s&&!s.isHit(e,i)},a.prototype.setAttr=function(e,i){var s=this.attrs[e];s!==i&&(this.attrs[e]=i,this.onAttrChange(e,i,s))},a.prototype.onAttrChange=function(e,i,s){e==="matrix"&&this.set("totalMatrix",null)},a.prototype.afterAttrsChange=function(e){if(this.cfg.isClipShape){var i=this.cfg.applyTo;i&&i.onCanvasChange("clip")}else this.onCanvasChange("attr")},a.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},a.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},a.prototype.setZIndex=function(e){this.set("zIndex",e);var i=this.getParent();return i&&i.sort(),this},a.prototype.toFront=function(){var e=this.getParent();if(!!e){var i=e.getChildren(),s=this.get("el"),l=i.indexOf(this);i.splice(l,1),i.push(this),this.onCanvasChange("zIndex")}},a.prototype.toBack=function(){var e=this.getParent();if(!!e){var i=e.getChildren(),s=this.get("el"),l=i.indexOf(this);i.splice(l,1),i.unshift(this),this.onCanvasChange("zIndex")}},a.prototype.remove=function(e){e===void 0&&(e=!0);var i=this.getParent();i?(Nd(i.getChildren(),this),i.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),e&&this.destroy()},a.prototype.resetMatrix=function(){this.attr(Er,this.getDefaultMatrix()),this.onCanvasChange("matrix")},a.prototype.getMatrix=function(){return this.attr(Er)},a.prototype.setMatrix=function(e){this.attr(Er,e),this.onCanvasChange("matrix")},a.prototype.getTotalMatrix=function(){var e=this.cfg.totalMatrix;if(!e){var i=this.attr("matrix"),s=this.cfg.parentMatrix;s&&i?e=ae(s,i):e=i||s,this.set("totalMatrix",e)}return e},a.prototype.applyMatrix=function(e){var i=this.attr("matrix"),s=null;e&&i?s=ae(e,i):s=i||e,this.set("totalMatrix",s),this.set("parentMatrix",e)},a.prototype.getDefaultMatrix=function(){return null},a.prototype.applyToMatrix=function(e){var i=this.attr("matrix");return i?xe(i,e):e},a.prototype.invertFromMatrix=function(e){var i=this.attr("matrix");if(i){var s=qe(i);if(s)return xe(s,e)}return e},a.prototype.setClip=function(e){var i=this.getCanvas(),s=null;if(e){var l=this.getShapeBase(),f=(0,k.upperFirst)(e.type),d=l[f];d&&(s=new d({type:e.type,isClipShape:!0,applyTo:this,attrs:e.attrs,canvas:i}))}return this.set("clipShape",s),this.onCanvasChange("clip"),s},a.prototype.getClip=function(){var e=this.cfg.clipShape;return e||null},a.prototype.clone=function(){var e=this,i=this.attrs,s={};(0,k.each)(i,function(d,v){(0,k.isArray)(i[v])?s[v]=wi(i[v]):s[v]=i[v]});var l=this.constructor,f=new l({attrs:s});return(0,k.each)(Cr,function(d){f.set(d,e.get(d))}),f},a.prototype.destroy=function(){var e=this.destroyed;e||(this.attrs={},c.prototype.destroy.call(this))},a.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},a.prototype.animate=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(!(!this.get("timeline")&&!this.get("canvas"))){this.set("animating",!0);var s=this.get("timeline");s||(s=this.get("canvas").get("timeline"),this.set("timeline",s));var l=this.get("animations")||[];s.timer||s.initTimer();var f=e[0],d=e[1],v=e[2],x=v===void 0?"easeLinear":v,w=e[3],I=w===void 0?k.noop:w,G=e[4],U=G===void 0?0:G,et,ft,Ct,Mt,kt;(0,k.isFunction)(f)?(et=f,f={}):(0,k.isObject)(f)&&f.onFrame&&(et=f.onFrame,ft=f.repeat),(0,k.isObject)(d)?(kt=d,d=kt.duration,x=kt.easing||"easeLinear",U=kt.delay||0,ft=kt.repeat||ft||!1,I=kt.callback||k.noop,Ct=kt.pauseCallback||k.noop,Mt=kt.resumeCallback||k.noop):((0,k.isNumber)(I)&&(U=I,I=null),(0,k.isFunction)(x)?(I=x,x="easeLinear"):x=x||"easeLinear");var $t=Ei(f,this),Jt={fromAttrs:Ui($t,this),toAttrs:$t,duration:d,easing:x,repeat:ft,callback:I,pauseCallback:Ct,resumeCallback:Mt,delay:U,startTime:s.getTime(),id:(0,k.uniqueId)(),onFrame:et,pathFormatted:!1};l.length>0?l=Oo(l,Jt):s.addAnimator(this),l.push(Jt),this.set("animations",l),this.set("_pause",{isPaused:!1})}},a.prototype.stopAnimate=function(e){var i=this;e===void 0&&(e=!0);var s=this.get("animations");(0,k.each)(s,function(l){e&&(l.onFrame?i.attr(l.onFrame(1)):i.attr(l.toAttrs)),l.callback&&l.callback()}),this.set("animating",!1),this.set("animations",[])},a.prototype.pauseAnimate=function(){var e=this.get("timeline"),i=this.get("animations"),s=e.getTime();return(0,k.each)(i,function(l){l._paused=!0,l._pauseTime=s,l.pauseCallback&&l.pauseCallback()}),this.set("_pause",{isPaused:!0,pauseTime:s}),this},a.prototype.resumeAnimate=function(){var e=this.get("timeline"),i=e.getTime(),s=this.get("animations"),l=this.get("_pause").pauseTime;return(0,k.each)(s,function(f){f.startTime=f.startTime+(i-l),f._paused=!1,f._pauseTime=null,f.resumeCallback&&f.resumeCallback()}),this.set("_pause",{isPaused:!1}),this.set("animations",s),this},a.prototype.emitDelegation=function(e,i){var s=this,l=i.propagationPath,f=this.getEvents(),d;e==="mouseenter"?d=i.fromShape:e==="mouseleave"&&(d=i.toShape);for(var v=function(G){var U=l[G],et=U.get("name");if(et){if((U.isGroup()||U.isCanvas&&U.isCanvas())&&d&&Vp(U,d))return"break";(0,k.isArray)(et)?(0,k.each)(et,function(ft){s.emitDelegateEvent(U,ft,i)}):x.emitDelegateEvent(U,et,i)}},x=this,w=0;w<l.length;w++){var I=v(w);if(I==="break")break}},a.prototype.emitDelegateEvent=function(e,i,s){var l=this.getEvents(),f=i+Nn+s.type;(l[f]||l[Pa])&&(s.name=f,s.currentTarget=e,s.delegateTarget=this,s.delegateObject=e.get("delegateObject"),this.emit(f,s))},a.prototype.translate=function(e,i){e===void 0&&(e=0),i===void 0&&(i=0);var s=this.getMatrix(),l=yn(s,[["t",e,i]]);return this.setMatrix(l),this},a.prototype.move=function(e,i){var s=this.attr("x")||0,l=this.attr("y")||0;return this.translate(e-s,i-l),this},a.prototype.moveTo=function(e,i){return this.move(e,i)},a.prototype.scale=function(e,i){var s=this.getMatrix(),l=yn(s,[["s",e,i||e]]);return this.setMatrix(l),this},a.prototype.rotate=function(e){var i=this.getMatrix(),s=yn(i,[["r",e]]);return this.setMatrix(s),this},a.prototype.rotateAtStart=function(e){var i=this.attr(),s=i.x,l=i.y,f=this.getMatrix(),d=yn(f,[["t",-s,-l],["r",e],["t",s,l]]);return this.setMatrix(d),this},a.prototype.rotateAtPoint=function(e,i,s){var l=this.getMatrix(),f=yn(l,[["t",-e,-i],["r",s],["t",e,i]]);return this.setMatrix(f),this},a}(jp),Vo=us,uo={},$o="_INDEX";function Si(c,a){if(c.set("canvas",a),c.isGroup()){var e=c.get("children");e.length&&e.forEach(function(i){Si(i,a)})}}function ns(c,a){if(c.set("timeline",a),c.isGroup()){var e=c.get("children");e.length&&e.forEach(function(i){ns(i,a)})}}function Xo(c,a){var e=c.getChildren();return e.indexOf(a)>=0}function eo(c,a,e){e===void 0&&(e=!0),e?a.destroy():(a.set("parent",null),a.set("canvas",null)),Nd(c.getChildren(),a)}function qo(c){return function(a,e){var i=c(a,e);return i===0?a[$o]-e[$o]:i}}var Ns=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.isCanvas=function(){return!1},a.prototype.getBBox=function(){var e=Infinity,i=-Infinity,s=Infinity,l=-Infinity,f=this.getChildren().filter(function(v){return v.get("visible")&&(!v.isGroup()||v.isGroup()&&v.getChildren().length>0)});f.length>0?(0,k.each)(f,function(v){var x=v.getBBox(),w=x.minX,I=x.maxX,G=x.minY,U=x.maxY;w<e&&(e=w),I>i&&(i=I),G<s&&(s=G),U>l&&(l=U)}):(e=0,i=0,s=0,l=0);var d={x:e,y:s,minX:e,minY:s,maxX:i,maxY:l,width:i-e,height:l-s};return d},a.prototype.getCanvasBBox=function(){var e=Infinity,i=-Infinity,s=Infinity,l=-Infinity,f=this.getChildren().filter(function(v){return v.get("visible")&&(!v.isGroup()||v.isGroup()&&v.getChildren().length>0)});f.length>0?(0,k.each)(f,function(v){var x=v.getCanvasBBox(),w=x.minX,I=x.maxX,G=x.minY,U=x.maxY;w<e&&(e=w),I>i&&(i=I),G<s&&(s=G),U>l&&(l=U)}):(e=0,i=0,s=0,l=0);var d={x:e,y:s,minX:e,minY:s,maxX:i,maxY:l,width:i-e,height:l-s};return d},a.prototype.getDefaultCfg=function(){var e=c.prototype.getDefaultCfg.call(this);return e.children=[],e},a.prototype.onAttrChange=function(e,i,s){if(c.prototype.onAttrChange.call(this,e,i,s),e==="matrix"){var l=this.getTotalMatrix();this._applyChildrenMarix(l)}},a.prototype.applyMatrix=function(e){var i=this.getTotalMatrix();c.prototype.applyMatrix.call(this,e);var s=this.getTotalMatrix();s!==i&&this._applyChildrenMarix(s)},a.prototype._applyChildrenMarix=function(e){var i=this.getChildren();(0,k.each)(i,function(s){s.applyMatrix(e)})},a.prototype.addShape=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var s=e[0],l=e[1];(0,k.isObject)(s)?l=s:l.type=s;var f=uo[l.type];f||(f=(0,k.upperFirst)(l.type),uo[l.type]=f);var d=this.getShapeBase(),v=new d[f](l);return this.add(v),v},a.prototype.addGroup=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var s=e[0],l=e[1],f;if((0,k.isFunction)(s))l?f=new s(l):f=new s({parent:this});else{var d=s||{},v=this.getGroupBase();f=new v(d)}return this.add(f),f},a.prototype.getCanvas=function(){var e;return this.isCanvas()?e=this:e=this.get("canvas"),e},a.prototype.getShape=function(e,i,s){if(!dh(this))return null;var l=this.getChildren(),f;if(this.isCanvas())f=this._findShape(l,e,i,s);else{var d=[e,i,1];d=this.invertFromMatrix(d),this.isClipped(d[0],d[1])||(f=this._findShape(l,d[0],d[1],s))}return f},a.prototype._findShape=function(e,i,s,l){for(var f=null,d=e.length-1;d>=0;d--){var v=e[d];if(dh(v)&&(v.isGroup()?f=v.getShape(i,s,l):v.isHit(i,s)&&(f=v)),f)break}return f},a.prototype.add=function(e){var i=this.getCanvas(),s=this.getChildren(),l=this.get("timeline"),f=e.getParent();f&&eo(f,e,!1),e.set("parent",this),i&&Si(e,i),l&&ns(e,l),s.push(e),e.onCanvasChange("add"),this._applyElementMatrix(e)},a.prototype._applyElementMatrix=function(e){var i=this.getTotalMatrix();i&&e.applyMatrix(i)},a.prototype.getChildren=function(){return this.get("children")},a.prototype.sort=function(){var e=this.getChildren();(0,k.each)(e,function(i,s){return i[$o]=s,i}),e.sort(qo(function(i,s){return i.get("zIndex")-s.get("zIndex")})),this.onCanvasChange("sort")},a.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var e=this.getChildren(),i=e.length-1;i>=0;i--)e[i].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},a.prototype.destroy=function(){this.get("destroyed")||(this.clear(),c.prototype.destroy.call(this))},a.prototype.getFirst=function(){return this.getChildByIndex(0)},a.prototype.getLast=function(){var e=this.getChildren();return this.getChildByIndex(e.length-1)},a.prototype.getChildByIndex=function(e){var i=this.getChildren();return i[e]},a.prototype.getCount=function(){var e=this.getChildren();return e.length},a.prototype.contain=function(e){var i=this.getChildren();return i.indexOf(e)>-1},a.prototype.removeChild=function(e,i){i===void 0&&(i=!0),this.contain(e)&&e.remove(i)},a.prototype.findAll=function(e){var i=[],s=this.getChildren();return(0,k.each)(s,function(l){e(l)&&i.push(l),l.isGroup()&&(i=i.concat(l.findAll(e)))}),i},a.prototype.find=function(e){var i=null,s=this.getChildren();return(0,k.each)(s,function(l){if(e(l)?i=l:l.isGroup()&&(i=l.find(e)),i)return!1}),i},a.prototype.findById=function(e){return this.find(function(i){return i.get("id")===e})},a.prototype.findByClassName=function(e){return this.find(function(i){return i.get("className")===e})},a.prototype.findAllByName=function(e){return this.findAll(function(i){return i.get("name")===e})},a}(Vo),lu=Ns,ls=0,ks=0,Ou=0,lr=1e3,ll,mo,Hf=0,mc=0,Xc=0,Jl=typeof performance=="object"&&performance.now?performance:Date,Kl=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(c){setTimeout(c,17)};function Xf(){return mc||(Kl(Hp),mc=Jl.now()+Xc)}function Hp(){mc=0}function mn(){this._call=this._time=this._next=null}mn.prototype=Yc.prototype={constructor:mn,restart:function(c,a,e){if(typeof c!="function")throw new TypeError("callback is not a function");e=(e==null?Xf():+e)+(a==null?0:+a),!this._next&&mo!==this&&(mo?mo._next=this:ll=this,mo=this),this._call=c,this._time=e,Tc()},stop:function(){this._call&&(this._call=null,this._time=Infinity,Tc())}};function Yc(c,a,e){var i=new mn;return i.restart(c,a,e),i}function pp(){Xf(),++ls;for(var c=ll,a;c;)(a=mc-c._time)>=0&&c._call.call(null,a),c=c._next;--ls}function br(){mc=(Hf=Jl.now())+Xc,ls=ks=0;try{pp()}finally{ls=0,Pf(),mc=0}}function Yf(){var c=Jl.now(),a=c-Hf;a>lr&&(Xc-=a,Hf=c)}function Pf(){for(var c,a=ll,e,i=Infinity;a;)a._call?(i>a._time&&(i=a._time),c=a,a=a._next):(e=a._next,a._next=null,a=c?c._next=e:ll=e);mo=c,Tc(i)}function Tc(c){if(!ls){ks&&(ks=clearTimeout(ks));var a=c-mc;a>24?(c<Infinity&&(ks=setTimeout(br,c-Jl.now()-Xc)),Ou&&(Ou=clearInterval(Ou))):(Ou||(Hf=Jl.now(),Ou=setInterval(Yf,lr)),ls=1,Kl(br))}}function yc(c,a,e){c.prototype=a.prototype=e,e.constructor=c}function gf(c,a){var e=Object.create(c.prototype);for(var i in a)e[i]=a[i];return e}function nf(){}var ol=.7,Pc=1/ol,tc="\\s*([+-]?\\d+)\\s*",Ff="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ac="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Av=/^#([0-9a-f]{3,8})$/,Bf=new RegExp("^rgb\\(".concat(tc,",").concat(tc,",").concat(tc,"\\)$")),zf=new RegExp("^rgb\\(".concat(Ac,",").concat(Ac,",").concat(Ac,"\\)$")),Kf=new RegExp("^rgba\\(".concat(tc,",").concat(tc,",").concat(tc,",").concat(Ff,"\\)$")),Fh=new RegExp("^rgba\\(".concat(Ac,",").concat(Ac,",").concat(Ac,",").concat(Ff,"\\)$")),gh=new RegExp("^hsl\\(".concat(Ff,",").concat(Ac,",").concat(Ac,"\\)$")),mh=new RegExp("^hsla\\(".concat(Ff,",").concat(Ac,",").concat(Ac,",").concat(Ff,"\\)$")),vp={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yc(nf,Zf,{copy:function(a){return Object.assign(new this.constructor,this,a)},displayable:function(){return this.rgb().displayable()},hex:gp,formatHex:gp,formatHex8:fd,formatHsl:gl,formatRgb:mp,toString:mp});function gp(){return this.rgb().formatHex()}function fd(){return this.rgb().formatHex8()}function gl(){return $h(this).formatHsl()}function mp(){return this.rgb().formatRgb()}function Zf(c){var a,e;return c=(c+"").trim().toLowerCase(),(a=Av.exec(c))?(e=a[1].length,a=parseInt(a[1],16),e===6?Dd(a):e===3?new ml(a>>8&15|a>>4&240,a>>4&15|a&240,(a&15)<<4|a&15,1):e===8?Bh(a>>24&255,a>>16&255,a>>8&255,(a&255)/255):e===4?Bh(a>>12&15|a>>8&240,a>>8&15|a>>4&240,a>>4&15|a&240,((a&15)<<4|a&15)/255):null):(a=Bf.exec(c))?new ml(a[1],a[2],a[3],1):(a=zf.exec(c))?new ml(a[1]*255/100,a[2]*255/100,a[3]*255/100,1):(a=Kf.exec(c))?Bh(a[1],a[2],a[3],a[4]):(a=Fh.exec(c))?Bh(a[1]*255/100,a[2]*255/100,a[3]*255/100,a[4]):(a=gh.exec(c))?yh(a[1],a[2]/100,a[3]/100,1):(a=mh.exec(c))?yh(a[1],a[2]/100,a[3]/100,a[4]):vp.hasOwnProperty(c)?Dd(vp[c]):c==="transparent"?new ml(NaN,NaN,NaN,0):null}function Dd(c){return new ml(c>>16&255,c>>8&255,c&255,1)}function Bh(c,a,e,i){return i<=0&&(c=a=e=NaN),new ml(c,a,e,i)}function zh(c){return c instanceof nf||(c=Zf(c)),c?(c=c.rgb(),new ml(c.r,c.g,c.b,c.opacity)):new ml}function uc(c,a,e,i){return arguments.length===1?zh(c):new ml(c,a,e,i==null?1:i)}function ml(c,a,e,i){this.r=+c,this.g=+a,this.b=+e,this.opacity=+i}yc(ml,uc,gf(nf,{brighter:function(a){return a=a==null?Pc:Math.pow(Pc,a),new ml(this.r*a,this.g*a,this.b*a,this.opacity)},darker:function(a){return a=a==null?ol:Math.pow(ol,a),new ml(this.r*a,this.g*a,this.b*a,this.opacity)},rgb:function(){return this},clamp:function(){return new ml(ir(this.r),ir(this.g),ir(this.b),ec(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Al,formatHex:Al,formatHex8:qv,formatRgb:ps,toString:ps}));function Al(){return"#".concat(no(this.r)).concat(no(this.g)).concat(no(this.b))}function qv(){return"#".concat(no(this.r)).concat(no(this.g)).concat(no(this.b)).concat(no((isNaN(this.opacity)?1:this.opacity)*255))}function ps(){var c=ec(this.opacity);return"".concat(c===1?"rgb(":"rgba(").concat(ir(this.r),", ").concat(ir(this.g),", ").concat(ir(this.b)).concat(c===1?")":", ".concat(c,")"))}function ec(c){return isNaN(c)?1:Math.max(0,Math.min(1,c))}function ir(c){return Math.max(0,Math.min(255,Math.round(c)||0))}function no(c){return c=ir(c),(c<16?"0":"")+c.toString(16)}function yh(c,a,e,i){return i<=0?c=a=e=NaN:e<=0||e>=1?c=a=NaN:a<=0&&(c=NaN),new $l(c,a,e,i)}function $h(c){if(c instanceof $l)return new $l(c.h,c.s,c.l,c.opacity);if(c instanceof nf||(c=Zf(c)),!c)return new $l;if(c instanceof $l)return c;c=c.rgb();var a=c.r/255,e=c.g/255,i=c.b/255,s=Math.min(a,e,i),l=Math.max(a,e,i),f=NaN,d=l-s,v=(l+s)/2;return d?(a===l?f=(e-i)/d+(e<i)*6:e===l?f=(i-a)/d+2:f=(a-e)/d+4,d/=v<.5?l+s:2-l-s,f*=60):d=v>0&&v<1?0:f,new $l(f,d,v,c.opacity)}function Xp(c,a,e,i){return arguments.length===1?$h(c):new $l(c,a,e,i==null?1:i)}function $l(c,a,e,i){this.h=+c,this.s=+a,this.l=+e,this.opacity=+i}yc($l,Xp,gf(nf,{brighter:function(a){return a=a==null?Pc:Math.pow(Pc,a),new $l(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=a==null?ol:Math.pow(ol,a),new $l(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=this.h%360+(this.h<0)*360,e=isNaN(a)||isNaN(this.s)?0:this.s,i=this.l,s=i+(i<.5?i:1-i)*e,l=2*i-s;return new ml(Gh(a>=240?a-240:a+120,l,s),Gh(a,l,s),Gh(a<120?a+240:a-120,l,s),this.opacity)},clamp:function(){return new $l(qf(this.h),Od(this.s),Od(this.l),ec(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var a=ec(this.opacity);return"".concat(a===1?"hsl(":"hsla(").concat(qf(this.h),", ").concat(Od(this.s)*100,"%, ").concat(Od(this.l)*100,"%").concat(a===1?")":", ".concat(a,")"))}}));function qf(c){return c=(c||0)%360,c<0?c+360:c}function Od(c){return Math.max(0,Math.min(1,c||0))}function Gh(c,a,e){return(c<60?a+(e-a)*c/60:c<180?e:c<240?a+(e-a)*(240-c)/60:a)*255}function Qf(c,a,e,i,s){var l=c*c,f=l*c;return((1-3*c+3*l-f)*a+(4-6*l+3*f)*e+(1+3*c+3*l-3*f)*i+f*s)/6}function Uh(c){var a=c.length-1;return function(e){var i=e<=0?e=0:e>=1?(e=1,a-1):Math.floor(e*a),s=c[i],l=c[i+1],f=i>0?c[i-1]:2*s-l,d=i<a-1?c[i+2]:2*l-s;return Qf((e-i/a)*a,f,s,l,d)}}function yp(c){var a=c.length;return function(e){var i=Math.floor(((e%=1)<0?++e:e)*a),s=c[(i+a-1)%a],l=c[i%a],f=c[(i+1)%a],d=c[(i+2)%a];return Qf((e-i/a)*a,s,l,f,d)}}var Ml=function(c){return function(){return c}};function bc(c,a){return function(e){return c+e*a}}function hd(c,a,e){return c=Math.pow(c,e),a=Math.pow(a,e)-c,e=1/e,function(i){return Math.pow(c+i*a,e)}}function Rd(c,a){var e=a-c;return e?bc(c,e>180||e<-180?e-360*Math.round(e/360):e):constant(isNaN(c)?a:c)}function xc(c){return(c=+c)==1?Wh:function(a,e){return e-a?hd(a,e,c):Ml(isNaN(a)?e:a)}}function Wh(c,a){var e=a-c;return e?bc(c,e):Ml(isNaN(c)?a:c)}var Vh=function c(a){var e=xc(a);function i(s,l){var f=e((s=uc(s)).r,(l=uc(l)).r),d=e(s.g,l.g),v=e(s.b,l.b),x=Wh(s.opacity,l.opacity);return function(w){return s.r=f(w),s.g=d(w),s.b=v(w),s.opacity=x(w),s+""}}return i.gamma=c,i}(1);function Kc(c){return function(a){var e=a.length,i=new Array(e),s=new Array(e),l=new Array(e),f,d;for(f=0;f<e;++f)d=uc(a[f]),i[f]=d.r||0,s[f]=d.g||0,l[f]=d.b||0;return i=c(i),s=c(s),l=c(l),d.opacity=1,function(v){return d.r=i(v),d.g=s(v),d.b=l(v),d+""}}}var _f=Kc(Uh),lc=Kc(yp);function If(c,a){a||(a=[]);var e=c?Math.min(a.length,c.length):0,i=a.slice(),s;return function(l){for(s=0;s<e;++s)i[s]=c[s]*(1-l)+a[s]*l;return i}}function Jf(c){return ArrayBuffer.isView(c)&&!(c instanceof DataView)}function bp(c,a){return(Jf(a)?If:dd)(c,a)}function dd(c,a){var e=a?a.length:0,i=c?Math.min(e,c.length):0,s=new Array(i),l=new Array(e),f;for(f=0;f<i;++f)s[f]=jh(c[f],a[f]);for(;f<e;++f)l[f]=a[f];return function(d){for(f=0;f<i;++f)l[f]=s[f](d);return l}}function xp(c,a){var e=new Date;return c=+c,a=+a,function(i){return e.setTime(c*(1-i)+a*i),e}}function wp(c,a){return c=+c,a=+a,function(e){return c*(1-e)+a*e}}function Yp(c,a){var e={},i={},s;(c===null||typeof c!="object")&&(c={}),(a===null||typeof a!="object")&&(a={});for(s in a)s in c?e[s]=jh(c[s],a[s]):i[s]=a[s];return function(l){for(s in e)i[s]=e[s](l);return i}}var bh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rf=new RegExp(bh.source,"g");function wc(c){return function(){return c}}function Mv(c){return function(a){return c(a)+""}}function $f(c,a){var e=bh.lastIndex=rf.lastIndex=0,i,s,l,f=-1,d=[],v=[];for(c=c+"",a=a+"";(i=bh.exec(c))&&(s=rf.exec(a));)(l=s.index)>e&&(l=a.slice(e,l),d[f]?d[f]+=l:d[++f]=l),(i=i[0])===(s=s[0])?d[f]?d[f]+=s:d[++f]=s:(d[++f]=null,v.push({i:f,x:wp(i,s)})),e=rf.lastIndex;return e<a.length&&(l=a.slice(e),d[f]?d[f]+=l:d[++f]=l),d.length<2?v[0]?Mv(v[0].x):wc(a):(a=v.length,function(x){for(var w=0,I;w<a;++w)d[(I=v[w]).i]=I.x(x);return d.join("")})}function jh(c,a){var e=typeof a,i;return a==null||e==="boolean"?Ml(a):(e==="number"?wp:e==="string"?(i=Zf(a))?(a=i,Vh):$f:a instanceof Zf?Vh:a instanceof Date?xp:Jf(a)?If:Array.isArray(a)?dd:typeof a.valueOf!="function"&&typeof a.toString!="function"||isNaN(a)?Yp:wp)(c,a)}function Nv(c){return+c}function zs(c){return c*c}function af(c){return c*(2-c)}function qi(c){return((c*=2)<=1?c*c:--c*(2-c)+1)/2}function pd(c){return c*c*c}function th(c){return--c*c*c+1}function Kp(c){return((c*=2)<=1?c*c*c:(c-=2)*c*c+2)/2}var Ep=3,Sg=function c(a){a=+a;function e(i){return Math.pow(i,a)}return e.exponent=c,e}(Ep),Qv=function c(a){a=+a;function e(i){return 1-Math.pow(1-i,a)}return e.exponent=c,e}(Ep),Ld=function c(a){a=+a;function e(i){return((i*=2)<=1?Math.pow(i,a):2-Math.pow(2-i,a))/2}return e.exponent=c,e}(Ep),Zp=Math.PI,xh=Zp/2;function kv(c){return+c==1?1:1-Math.cos(c*xh)}function qp(c){return Math.sin(c*xh)}function Qp(c){return(1-Math.cos(Zp*c))/2}function eh(c){return(Math.pow(2,-10*c)-.0009765625)*1.0009775171065494}function vd(c){return eh(1-+c)}function Hh(c){return 1-eh(c)}function Pd(c){return((c*=2)<=1?eh(1-c):2-eh(c-1))/2}function Fd(c){return 1-Math.sqrt(1-c*c)}function Sp(c){return Math.sqrt(1- --c*c)}function Bd(c){return((c*=2)<=1?1-Math.sqrt(1-c*c):Math.sqrt(1-(c-=2)*c)+1)/2}var wh=4/11,Cp=6/11,Tf=8/11,zd=3/4,$d=9/11,gd=10/11,Eh=15/16,Gd=21/22,Ud=63/64,Xh=1/wh/wh;function Wd(c){return 1-$s(1-c)}function $s(c){return(c=+c)<wh?Xh*c*c:c<Tf?Xh*(c-=Cp)*c+zd:c<gd?Xh*(c-=$d)*c+Eh:Xh*(c-=Gd)*c+Ud}function md(c){return((c*=2)<=1?1-$s(1-c):$s(c-1)+1)/2}var Mc=1.70158,Jv=function c(a){a=+a;function e(i){return(i=+i)*i*(a*(i-1)+i)}return e.overshoot=c,e}(Mc),mu=function c(a){a=+a;function e(i){return--i*i*((i+1)*a+i)+1}return e.overshoot=c,e}(Mc),Dv=function c(a){a=+a;function e(i){return((i*=2)<1?i*i*((a+1)*i-a):(i-=2)*i*((a+1)*i+a)+2)/2}return e.overshoot=c,e}(Mc),Vd=2*Math.PI,Jp=1,Zc=.3,tv=function c(a,e){var i=Math.asin(1/(a=Math.max(1,a)))*(e/=Vd);function s(l){return a*eh(- --l)*Math.sin((i-l)/e)}return s.amplitude=function(l){return c(l,e*Vd)},s.period=function(l){return c(a,l)},s}(Jp,Zc),ev=function c(a,e){var i=Math.asin(1/(a=Math.max(1,a)))*(e/=Vd);function s(l){return 1-a*eh(l=+l)*Math.sin((l+i)/e)}return s.amplitude=function(l){return c(l,e*Vd)},s.period=function(l){return c(a,l)},s}(Jp,Zc),nv=function c(a,e){var i=Math.asin(1/(a=Math.max(1,a)))*(e/=Vd);function s(l){return((l=l*2-1)<0?a*eh(-l)*Math.sin((i-l)/e):2-a*eh(l)*Math.sin((i+l)/e))/2}return s.amplitude=function(l){return c(l,e*Vd)},s.period=function(l){return c(a,l)},s}(Jp,Zc),Sh={};function rv(c){return Sh[c.toLowerCase()]||Q[c]}function tg(c,a){Sh[c.toLowerCase()]=a}var Gl=function(c){return["fill","stroke","fillStyle","strokeStyle"].includes(c)},av=function(c){return/^[r,R,L,l]{1}[\s]*\(/.test(c)},Af=[1,0,0,0,1,0,0,0,1];function Mf(c,a,e){var i={},s=a.fromAttrs,l=a.toAttrs;if(!c.destroyed){var f;for(var d in l)if(!(0,k.isEqual)(s[d],l[d]))if(d==="path"){var v=l[d],x=s[d];v.length>x.length?(v=rt(l[d]),x=rt(s[d]),x=uu(x,v),x=zl(x,v),a.fromAttrs.path=x,a.toAttrs.path=v):a.pathFormatted||(v=rt(l[d]),x=rt(s[d]),x=zl(x,v),a.fromAttrs.path=x,a.toAttrs.path=v,a.pathFormatted=!0),i[d]=[];for(var w=0;w<v.length;w++){for(var I=v[w],G=x[w],U=[],et=0;et<I.length;et++)(0,k.isNumber)(I[et])&&G&&(0,k.isNumber)(G[et])?(f=jh(G[et],I[et]),U.push(f(e))):U.push(I[et]);i[d].push(U)}}else if(d==="matrix"){var ft=bp(s[d]||Af,l[d]||Af),Ct=ft(e);i[d]=Ct}else Gl(d)&&av(l[d])?i[d]=l[d]:(0,k.isFunction)(l[d])||(f=jh(s[d],l[d]),i[d]=f(e));c.attr(i)}}function Ov(c,a,e){var i=a.startTime,s=a.delay;if(e<i+s||a._paused)return!1;var l,f=a.duration,d=a.easing,v=rv(d);if(e=e-i-a.delay,a.repeat)l=e%f/f,l=v(l);else if(l=e/f,l<1)l=v(l);else return a.onFrame?c.attr(a.onFrame(1)):c.attr(a.toAttrs),!0;if(a.onFrame){var x=a.onFrame(l);c.attr(x)}else Mf(c,a,l);return!1}var iv=function(){function c(a){this.animators=[],this.current=0,this.timer=null,this.canvas=a}return c.prototype.initTimer=function(){var a=this,e=!1,i,s,l;this.timer=Yc(function(f){if(a.current=f,a.animators.length>0){for(var d=a.animators.length-1;d>=0;d--){if(i=a.animators[d],i.destroyed){a.removeAnimator(d);continue}if(!i.isAnimatePaused()){s=i.get("animations");for(var v=s.length-1;v>=0;v--)l=s[v],e=Ov(i,l,f),e&&(s.splice(v,1),e=!1,l.callback&&l.callback())}s.length===0&&a.removeAnimator(d)}var x=a.canvas.get("autoDraw");x||a.canvas.draw()}})},c.prototype.addAnimator=function(a){this.animators.push(a)},c.prototype.removeAnimator=function(a){this.animators.splice(a,1)},c.prototype.isAnimating=function(){return!!this.animators.length},c.prototype.stop=function(){this.timer&&this.timer.stop()},c.prototype.stopAllAnimations=function(a){a===void 0&&(a=!0),this.animators.forEach(function(e){e.stopAnimate(a)}),this.animators=[],this.canvas.draw()},c.prototype.getTime=function(){return this.current},c}(),Yh=iv,ov=40,Nc=0,Ch=":",El=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function Fc(c,a){for(var e in c)if(c.hasOwnProperty(e)&&e.indexOf(Ch+a)>=0)return!0;return!1}function jd(c,a,e){e.name=a,e.target=c,e.currentTarget=c,e.delegateTarget=c,c.emit(a,e)}function _p(c,a,e){if(e.bubbles){var i=void 0,s=!1;if(a==="mouseenter"?(i=e.fromShape,s=!0):a==="mouseleave"&&(s=!0,i=e.toShape),c.isCanvas()&&s)return;if(i&&Vp(c,i)){e.bubbles=!1;return}e.name=a,e.currentTarget=c,e.delegateTarget=c,c.emit(a,e)}}var sv=function(){function c(a){var e=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(i){var s=i.type;e._triggerEvent(s,i)},this._onDocumentMove=function(i){var s=e.canvas,l=s.get("el");if(l!==i.target&&(e.dragging||e.currentShape)){var f=e._getPointInfo(i);e.dragging&&e._emitEvent("drag",i,f,e.draggingShape)}},this._onDocumentMouseUp=function(i){var s=e.canvas,l=s.get("el");if(l!==i.target&&e.dragging){var f=e._getPointInfo(i);e.draggingShape&&e._emitEvent("drop",i,f,null),e._emitEvent("dragend",i,f,e.draggingShape),e._afterDrag(e.draggingShape,f,i)}},this.canvas=a.canvas}return c.prototype.init=function(){this._bindEvents()},c.prototype._bindEvents=function(){var a=this,e=this.canvas.get("el");(0,k.each)(El,function(i){e.addEventListener(i,a._eventCallback)}),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},c.prototype._clearEvents=function(){var a=this,e=this.canvas.get("el");(0,k.each)(El,function(i){e.removeEventListener(i,a._eventCallback)}),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},c.prototype._getEventObj=function(a,e,i,s,l,f){var d=new hh(a,e);return d.fromShape=l,d.toShape=f,d.x=i.x,d.y=i.y,d.clientX=i.clientX,d.clientY=i.clientY,d.propagationPath.push(s),d},c.prototype._getShape=function(a,e){return this.canvas.getShape(a.x,a.y,e)},c.prototype._getPointInfo=function(a){var e=this.canvas,i=e.getClientByEvent(a),s=e.getPointByEvent(a);return{x:s.x,y:s.y,clientX:i.x,clientY:i.y}},c.prototype._triggerEvent=function(a,e){var i=this._getPointInfo(e),s=this._getShape(i,e),l=this["_on"+a],f=!1;if(l)l.call(this,i,s,e);else{var d=this.currentShape;a==="mouseenter"||a==="dragenter"||a==="mouseover"?(this._emitEvent(a,e,i,null,null,s),s&&this._emitEvent(a,e,i,s,null,s),a==="mouseenter"&&this.draggingShape&&this._emitEvent("dragenter",e,i,null)):a==="mouseleave"||a==="dragleave"||a==="mouseout"?(f=!0,d&&this._emitEvent(a,e,i,d,d,null),this._emitEvent(a,e,i,null,d,null),a==="mouseleave"&&this.draggingShape&&this._emitEvent("dragleave",e,i,null)):this._emitEvent(a,e,i,s,null,null)}if(f||(this.currentShape=s),s&&!s.get("destroyed")){var v=this.canvas,x=v.get("el");x.style.cursor=s.attr("cursor")||v.get("cursor")}},c.prototype._onmousedown=function(a,e,i){i.button===Nc&&(this.mousedownShape=e,this.mousedownPoint=a,this.mousedownTimeStamp=i.timeStamp),this._emitEvent("mousedown",i,a,e,null,null)},c.prototype._emitMouseoverEvents=function(a,e,i,s){var l=this.canvas.get("el");i!==s&&(i&&(this._emitEvent("mouseout",a,e,i,i,s),this._emitEvent("mouseleave",a,e,i,i,s),(!s||s.get("destroyed"))&&(l.style.cursor=this.canvas.get("cursor"))),s&&(this._emitEvent("mouseover",a,e,s,i,s),this._emitEvent("mouseenter",a,e,s,i,s)))},c.prototype._emitDragoverEvents=function(a,e,i,s,l){s?(s!==i&&(i&&this._emitEvent("dragleave",a,e,i,i,s),this._emitEvent("dragenter",a,e,s,i,s)),l||this._emitEvent("dragover",a,e,s)):i&&this._emitEvent("dragleave",a,e,i,i,s),l&&this._emitEvent("dragover",a,e,s)},c.prototype._afterDrag=function(a,e,i){a&&(a.set("capture",!0),this.draggingShape=null),this.dragging=!1;var s=this._getShape(e,i);s!==a&&this._emitMouseoverEvents(i,e,a,s),this.currentShape=s},c.prototype._onmouseup=function(a,e,i){if(i.button===Nc){var s=this.draggingShape;this.dragging?(s&&this._emitEvent("drop",i,a,e),this._emitEvent("dragend",i,a,s),this._afterDrag(s,a,i)):(this._emitEvent("mouseup",i,a,e),e===this.mousedownShape&&this._emitEvent("click",i,a,e),this.mousedownShape=null,this.mousedownPoint=null)}},c.prototype._ondragover=function(a,e,i){i.preventDefault();var s=this.currentShape;this._emitDragoverEvents(i,a,s,e,!0)},c.prototype._onmousemove=function(a,e,i){var s=this.canvas,l=this.currentShape,f=this.draggingShape;if(this.dragging)f&&this._emitDragoverEvents(i,a,l,e,!1),this._emitEvent("drag",i,a,f);else{var d=this.mousedownPoint;if(d){var v=this.mousedownShape,x=i.timeStamp,w=x-this.mousedownTimeStamp,I=d.clientX-a.clientX,G=d.clientY-a.clientY,U=I*I+G*G;w>120||U>ov?v&&v.get("draggable")?(f=this.mousedownShape,f.set("capture",!1),this.draggingShape=f,this.dragging=!0,this._emitEvent("dragstart",i,a,f),this.mousedownShape=null,this.mousedownPoint=null):!v&&s.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",i,a,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(i,a,l,e),this._emitEvent("mousemove",i,a,e)):(this._emitMouseoverEvents(i,a,l,e),this._emitEvent("mousemove",i,a,e))}else this._emitMouseoverEvents(i,a,l,e),this._emitEvent("mousemove",i,a,e)}},c.prototype._emitEvent=function(a,e,i,s,l,f){var d=this._getEventObj(a,e,i,s,l,f);if(s){d.shape=s,jd(s,a,d);for(var v=s.getParent();v;)v.emitDelegation(a,d),d.propagationStopped||_p(v,a,d),d.propagationPath.push(v),v=v.getParent()}else{var x=this.canvas;jd(x,a,d)}},c.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},c}(),uv=sv,Ip="px",_h=vf(),of=_h&&_h.name==="firefox",li=function(c){(0,P.__extends)(a,c);function a(e){var i=c.call(this,e)||this;return i.initContainer(),i.initDom(),i.initEvents(),i.initTimeline(),i}return a.prototype.getDefaultCfg=function(){var e=c.prototype.getDefaultCfg.call(this);return e.cursor="default",e.supportCSSTransform=!1,e},a.prototype.initContainer=function(){var e=this.get("container");(0,k.isString)(e)&&(e=document.getElementById(e),this.set("container",e))},a.prototype.initDom=function(){var e=this.createDom();this.set("el",e);var i=this.get("container");i.appendChild(e),this.setDOMSize(this.get("width"),this.get("height"))},a.prototype.initEvents=function(){var e=new uv({canvas:this});e.init(),this.set("eventController",e)},a.prototype.initTimeline=function(){var e=new Yh(this);this.set("timeline",e)},a.prototype.setDOMSize=function(e,i){var s=this.get("el");fp&&(s.style.width=e+Ip,s.style.height=i+Ip)},a.prototype.changeSize=function(e,i){this.setDOMSize(e,i),this.set("width",e),this.set("height",i),this.onCanvasChange("changeSize")},a.prototype.getRenderer=function(){return this.get("renderer")},a.prototype.getCursor=function(){return this.get("cursor")},a.prototype.setCursor=function(e){this.set("cursor",e);var i=this.get("el");fp&&i&&(i.style.cursor=e)},a.prototype.getPointByEvent=function(e){var i=this.get("supportCSSTransform");if(i){if(of&&!(0,k.isNil)(e.layerX)&&e.layerX!==e.offsetX)return{x:e.layerX,y:e.layerY};if(!(0,k.isNil)(e.offsetX))return{x:e.offsetX,y:e.offsetY}}var s=this.getClientByEvent(e),l=s.x,f=s.y;return this.getPointByClient(l,f)},a.prototype.getClientByEvent=function(e){var i=e;return e.touches&&(e.type==="touchend"?i=e.changedTouches[0]:i=e.touches[0]),{x:i.clientX,y:i.clientY}},a.prototype.getPointByClient=function(e,i){var s=this.get("el"),l=s.getBoundingClientRect();return{x:e-l.left,y:i-l.top}},a.prototype.getClientByPoint=function(e,i){var s=this.get("el"),l=s.getBoundingClientRect();return{x:e+l.left,y:i+l.top}},a.prototype.draw=function(){},a.prototype.removeDom=function(){var e=this.get("el");e.parentNode.removeChild(e)},a.prototype.clearEvents=function(){var e=this.get("eventController");e.destroy()},a.prototype.isCanvas=function(){return!0},a.prototype.getParent=function(){return null},a.prototype.destroy=function(){var e=this.get("timeline");this.get("destroyed")||(this.clear(),e&&e.stop(),this.clearEvents(),this.removeDom(),c.prototype.destroy.call(this))},a}(lu),eg=li,Tp=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.isGroup=function(){return!0},a.prototype.isEntityGroup=function(){return!1},a.prototype.clone=function(){for(var e=c.prototype.clone.call(this),i=this.getChildren(),s=0;s<i.length;s++){var l=i[s];e.add(l.clone())}return e},a}(lu),lv=Tp,Ap=function(c){(0,P.__extends)(a,c);function a(e){return c.call(this,e)||this}return a.prototype._isInBBox=function(e,i){var s=this.getBBox();return s.minX<=e&&s.maxX>=e&&s.minY<=i&&s.maxY>=i},a.prototype.afterAttrsChange=function(e){c.prototype.afterAttrsChange.call(this,e),this.clearCacheBBox()},a.prototype.getBBox=function(){var e=this.cfg.bbox;return e||(e=this.calculateBBox(),this.set("bbox",e)),e},a.prototype.getCanvasBBox=function(){var e=this.cfg.canvasBBox;return e||(e=this.calculateCanvasBBox(),this.set("canvasBBox",e)),e},a.prototype.applyMatrix=function(e){c.prototype.applyMatrix.call(this,e),this.set("canvasBBox",null)},a.prototype.calculateCanvasBBox=function(){var e=this.getBBox(),i=this.getTotalMatrix(),s=e.minX,l=e.minY,f=e.maxX,d=e.maxY;if(i){var v=xe(i,[e.minX,e.minY]),x=xe(i,[e.maxX,e.minY]),w=xe(i,[e.minX,e.maxY]),I=xe(i,[e.maxX,e.maxY]);s=Math.min(v[0],x[0],w[0],I[0]),f=Math.max(v[0],x[0],w[0],I[0]),l=Math.min(v[1],x[1],w[1],I[1]),d=Math.max(v[1],x[1],w[1],I[1])}var G=this.attrs;if(G.shadowColor){var U=G.shadowBlur,et=U===void 0?0:U,ft=G.shadowOffsetX,Ct=ft===void 0?0:ft,Mt=G.shadowOffsetY,kt=Mt===void 0?0:Mt,$t=s-et+Ct,Jt=f+et+Ct,Ce=l-et+kt,je=d+et+kt;s=Math.min(s,$t),f=Math.max(f,Jt),l=Math.min(l,Ce),d=Math.max(d,je)}return{x:s,y:l,minX:s,minY:l,maxX:f,maxY:d,width:f-s,height:d-l}},a.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},a.prototype.isClipShape=function(){return this.get("isClipShape")},a.prototype.isInShape=function(e,i){return!1},a.prototype.isOnlyHitBox=function(){return!1},a.prototype.isHit=function(e,i){var s=this.get("startArrowShape"),l=this.get("endArrowShape"),f=[e,i,1];f=this.invertFromMatrix(f);var d=f[0],v=f[1],x=this._isInBBox(d,v);return this.isOnlyHitBox()?x:!!(x&&!this.isClipped(d,v)&&(this.isInShape(d,v)||s&&s.isHit(d,v)||l&&l.isHit(d,v)))},a}(Vo),yd=Ap,cv=new Map;function nh(c,a){cv.set(c,a)}function Rv(c){return cv.get(c)}function Mp(c){var a=c.attr(),e=a.x,i=a.y,s=a.width,l=a.height;return{x:e,y:i,width:s,height:l}}function Np(c){var a=c.attr(),e=a.x,i=a.y,s=a.r;return{x:e-s,y:i-s,width:s*2,height:s*2}}function oe(c,a,e,i){var s=c-e,l=a-i;return Math.sqrt(s*s+l*l)}function vn(c,a){return Math.abs(c-a)<.001}function qn(c,a){var e=(0,k.min)(c),i=(0,k.min)(a),s=(0,k.max)(c),l=(0,k.max)(a);return{x:e,y:i,width:s-e,height:l-i}}function ia(c,a,e,i){return{minX:(0,k.min)([c,e]),maxX:(0,k.max)([c,e]),minY:(0,k.min)([a,i]),maxY:(0,k.max)([a,i])}}function Sa(c){return(c+Math.PI*2)%(Math.PI*2)}var Hr={box:function(c,a,e,i){return qn([c,e],[a,i])},length:function(c,a,e,i){return oe(c,a,e,i)},pointAt:function(c,a,e,i,s){return{x:(1-s)*c+s*e,y:(1-s)*a+s*i}},pointDistance:function(c,a,e,i,s,l){var f=(e-c)*(s-c)+(i-a)*(l-a);if(f<0)return oe(c,a,s,l);var d=(e-c)*(e-c)+(i-a)*(i-a);return f>d?oe(e,i,s,l):this.pointToLine(c,a,e,i,s,l)},pointToLine:function(c,a,e,i,s,l){var f=[e-c,i-a];if(Bi.exactEquals(f,[0,0]))return Math.sqrt((s-c)*(s-c)+(l-a)*(l-a));var d=[-f[1],f[0]];Bi.normalize(d,d);var v=[s-c,l-a];return Math.abs(Bi.dot(v,d))},tangentAngle:function(c,a,e,i){return Math.atan2(i-a,e-c)}},ea=1e-4;function Ha(c,a,e,i,s,l){var f,d=Infinity,v=[e,i],x=20;l&&l>200&&(x=l/10);for(var w=1/x,I=w/10,G=0;G<=x;G++){var U=G*w,et=[s.apply(null,c.concat([U])),s.apply(null,a.concat([U]))],ft=oe(v[0],v[1],et[0],et[1]);ft<d&&(f=U,d=ft)}if(f===0)return{x:c[0],y:a[0]};if(f===1){var Ct=c.length;return{x:c[Ct-1],y:a[Ct-1]}}d=Infinity;for(var G=0;G<32&&!(I<ea);G++){var Mt=f-I,kt=f+I,et=[s.apply(null,c.concat([Mt])),s.apply(null,a.concat([Mt]))],ft=oe(v[0],v[1],et[0],et[1]);if(Mt>=0&&ft<d)f=Mt,d=ft;else{var $t=[s.apply(null,c.concat([kt])),s.apply(null,a.concat([kt]))],Jt=oe(v[0],v[1],$t[0],$t[1]);kt<=1&&Jt<d?(f=kt,d=Jt):I*=.5}}return{x:s.apply(null,c.concat([f])),y:s.apply(null,a.concat([f]))}}function Wa(c,a){for(var e=0,i=c.length,s=0;s<i;s++){var l=c[s],f=a[s],d=c[(s+1)%i],v=a[(s+1)%i];e+=oe(l,f,d,v)}return e/2}function Ga(c,a,e,i){var s=1-i;return s*s*c+2*i*s*a+i*i*e}function Qa(c,a,e){var i=c+e-2*a;if(vn(i,0))return[.5];var s=(c-a)/i;return s<=1&&s>=0?[s]:[]}function Vn(c,a,e,i){return 2*(1-i)*(a-c)+2*i*(e-a)}function M(c,a,e,i,s,l,f){var d=Ga(c,e,s,f),v=Ga(a,i,l,f),x=Hr.pointAt(c,a,e,i,f),w=Hr.pointAt(e,i,s,l,f);return[[c,a,x.x,x.y,d,v],[d,v,w.x,w.y,s,l]]}function q(c,a,e,i,s,l,f){if(f===0)return(oe(c,a,e,i)+oe(e,i,s,l)+oe(c,a,s,l))/2;var d=M(c,a,e,i,s,l,.5),v=d[0],x=d[1];return v.push(f-1),x.push(f-1),q.apply(null,v)+q.apply(null,x)}var dt={box:function(c,a,e,i,s,l){var f=Qa(c,e,s)[0],d=Qa(a,i,l)[0],v=[c,s],x=[a,l];return f!==void 0&&v.push(Ga(c,e,s,f)),d!==void 0&&x.push(Ga(a,i,l,d)),qn(v,x)},length:function(c,a,e,i,s,l){return q(c,a,e,i,s,l,3)},nearestPoint:function(c,a,e,i,s,l,f,d){return Ha([c,e,s],[a,i,l],f,d,Ga)},pointDistance:function(c,a,e,i,s,l,f,d){var v=this.nearestPoint(c,a,e,i,s,l,f,d);return oe(v.x,v.y,f,d)},interpolationAt:Ga,pointAt:function(c,a,e,i,s,l,f){return{x:Ga(c,e,s,f),y:Ga(a,i,l,f)}},divide:function(c,a,e,i,s,l,f){return M(c,a,e,i,s,l,f)},tangentAngle:function(c,a,e,i,s,l,f){var d=Vn(c,e,s,f),v=Vn(a,i,l,f),x=Math.atan2(v,d);return Sa(x)}};function _t(c,a,e,i,s){var l=1-s;return l*l*l*c+3*a*s*l*l+3*e*s*s*l+i*s*s*s}function Pt(c,a,e,i,s){var l=1-s;return 3*(l*l*(a-c)+2*l*s*(e-a)+s*s*(i-e))}function jt(c,a,e,i){var s=-3*c+9*a-9*e+3*i,l=6*c-12*a+6*e,f=3*a-3*c,d=[],v,x,w;if(vn(s,0))vn(l,0)||(v=-f/l,v>=0&&v<=1&&d.push(v));else{var I=l*l-4*s*f;vn(I,0)?d.push(-l/(2*s)):I>0&&(w=Math.sqrt(I),v=(-l+w)/(2*s),x=(-l-w)/(2*s),v>=0&&v<=1&&d.push(v),x>=0&&x<=1&&d.push(x))}return d}function ie(c,a,e,i,s,l,f,d,v){var x=_t(c,e,s,f,v),w=_t(a,i,l,d,v),I=Hr.pointAt(c,a,e,i,v),G=Hr.pointAt(e,i,s,l,v),U=Hr.pointAt(s,l,f,d,v),et=Hr.pointAt(I.x,I.y,G.x,G.y,v),ft=Hr.pointAt(G.x,G.y,U.x,U.y,v);return[[c,a,I.x,I.y,et.x,et.y,x,w],[x,w,ft.x,ft.y,U.x,U.y,f,d]]}function he(c,a,e,i,s,l,f,d,v){if(v===0)return Wa([c,e,s,f],[a,i,l,d]);var x=ie(c,a,e,i,s,l,f,d,.5),w=x[0],I=x[1];return w.push(v-1),I.push(v-1),he.apply(null,w)+he.apply(null,I)}var Te={extrema:jt,box:function(c,a,e,i,s,l,f,d){for(var v=[c,f],x=[a,d],w=jt(c,e,s,f),I=jt(a,i,l,d),G=0;G<w.length;G++)v.push(_t(c,e,s,f,w[G]));for(var G=0;G<I.length;G++)x.push(_t(a,i,l,d,I[G]));return qn(v,x)},length:function(c,a,e,i,s,l,f,d){return he(c,a,e,i,s,l,f,d,3)},nearestPoint:function(c,a,e,i,s,l,f,d,v,x,w){return Ha([c,e,s,f],[a,i,l,d],v,x,_t,w)},pointDistance:function(c,a,e,i,s,l,f,d,v,x,w){var I=this.nearestPoint(c,a,e,i,s,l,f,d,v,x,w);return oe(I.x,I.y,v,x)},interpolationAt:_t,pointAt:function(c,a,e,i,s,l,f,d,v){return{x:_t(c,e,s,f,v),y:_t(a,i,l,d,v)}},divide:function(c,a,e,i,s,l,f,d,v){return ie(c,a,e,i,s,l,f,d,v)},tangentAngle:function(c,a,e,i,s,l,f,d,v){var x=Pt(c,e,s,f,v),w=Pt(a,i,l,d,v);return Sa(Math.atan2(w,x))}};function Ke(c,a){var e=Math.abs(c);return a>0?e:e*-1}var gn={box:function(c,a,e,i){return{x:c-e,y:a-i,width:e*2,height:i*2}},length:function(c,a,e,i){return Math.PI*(3*(e+i)-Math.sqrt((3*e+i)*(e+3*i)))},nearestPoint:function(c,a,e,i,s,l){var f=e,d=i;if(f===0||d===0)return{x:c,y:a};for(var v=s-c,x=l-a,w=Math.abs(v),I=Math.abs(x),G=f*f,U=d*d,et=Math.PI/4,ft,Ct,Mt=0;Mt<4;Mt++){ft=f*Math.cos(et),Ct=d*Math.sin(et);var kt=(G-U)*Math.pow(Math.cos(et),3)/f,$t=(U-G)*Math.pow(Math.sin(et),3)/d,Jt=ft-kt,Ce=Ct-$t,je=w-kt,ze=I-$t,pn=Math.hypot(Ce,Jt),Fn=Math.hypot(ze,je),Tn=pn*Math.asin((Jt*ze-Ce*je)/(pn*Fn)),cr=Tn/Math.sqrt(G+U-ft*ft-Ct*Ct);et+=cr,et=Math.min(Math.PI/2,Math.max(0,et))}return{x:c+Ke(ft,v),y:a+Ke(Ct,x)}},pointDistance:function(c,a,e,i,s,l){var f=this.nearestPoint(c,a,e,i,s,l);return oe(f.x,f.y,s,l)},pointAt:function(c,a,e,i,s){var l=2*Math.PI*s;return{x:c+e*Math.cos(l),y:a+i*Math.sin(l)}},tangentAngle:function(c,a,e,i,s){var l=2*Math.PI*s,f=Math.atan2(i*Math.cos(l),-e*Math.sin(l));return Sa(f)}};function cn(c,a,e,i,s,l,f,d){return-1*e*Math.cos(s)*Math.sin(d)-i*Math.sin(s)*Math.cos(d)}function jn(c,a,e,i,s,l,f,d){return-1*e*Math.sin(s)*Math.sin(d)+i*Math.cos(s)*Math.cos(d)}function En(c,a,e){return Math.atan(-a/c*Math.tan(e))}function ya(c,a,e){return Math.atan(a/(c*Math.tan(e)))}function Dr(c,a,e,i,s,l){return e*Math.cos(s)*Math.cos(l)-i*Math.sin(s)*Math.sin(l)+c}function Fr(c,a,e,i,s,l){return e*Math.sin(s)*Math.cos(l)+i*Math.cos(s)*Math.sin(l)+a}function or(c,a,e,i){var s=Math.atan2(i*c,e*a);return(s+Math.PI*2)%(Math.PI*2)}function Xa(c,a,e){return{x:c*Math.cos(e),y:a*Math.sin(e)}}function Hn(c,a,e){var i=Math.cos(e),s=Math.sin(e);return[c*i-a*s,c*s+a*i]}var si={box:function(c,a,e,i,s,l,f){for(var d=En(e,i,s),v=Infinity,x=-Infinity,w=[l,f],I=-Math.PI*2;I<=Math.PI*2;I+=Math.PI){var G=d+I;l<f?l<G&&G<f&&w.push(G):f<G&&G<l&&w.push(G)}for(var I=0;I<w.length;I++){var U=Dr(c,a,e,i,s,w[I]);U<v&&(v=U),U>x&&(x=U)}for(var et=ya(e,i,s),ft=Infinity,Ct=-Infinity,Mt=[l,f],I=-Math.PI*2;I<=Math.PI*2;I+=Math.PI){var kt=et+I;l<f?l<kt&&kt<f&&Mt.push(kt):f<kt&&kt<l&&Mt.push(kt)}for(var I=0;I<Mt.length;I++){var $t=Fr(c,a,e,i,s,Mt[I]);$t<ft&&(ft=$t),$t>Ct&&(Ct=$t)}return{x:v,y:ft,width:x-v,height:Ct-ft}},length:function(c,a,e,i,s,l,f){},nearestPoint:function(c,a,e,i,s,l,f,d,v){var x=Hn(d-c,v-a,-s),w=x[0],I=x[1],G=gn.nearestPoint(0,0,e,i,w,I),U=or(e,i,G.x,G.y);U<l?G=Xa(e,i,l):U>f&&(G=Xa(e,i,f));var et=Hn(G.x,G.y,s);return{x:et[0]+c,y:et[1]+a}},pointDistance:function(c,a,e,i,s,l,f,d,v){var x=this.nearestPoint(c,a,e,i,d,v);return oe(x.x,x.y,d,v)},pointAt:function(c,a,e,i,s,l,f,d){var v=(f-l)*d+l;return{x:Dr(c,a,e,i,s,v),y:Fr(c,a,e,i,s,v)}},tangentAngle:function(c,a,e,i,s,l,f,d){var v=(f-l)*d+l,x=cn(c,a,e,i,s,l,f,v),w=jn(c,a,e,i,s,l,f,v);return Sa(Math.atan2(w,x))}};function Ci(c){for(var a=0,e=[],i=0;i<c.length-1;i++){var s=c[i],l=c[i+1],f=oe(s[0],s[1],l[0],l[1]),d={from:s,to:l,length:f};e.push(d),a+=f}return{segments:e,totalLength:a}}function Yi(c){if(c.length<2)return 0;for(var a=0,e=0;e<c.length-1;e++){var i=c[e],s=c[e+1];a+=oe(i[0],i[1],s[0],s[1])}return a}function _i(c,a){if(a>1||a<0||c.length<2)return null;var e=Ci(c),i=e.segments,s=e.totalLength;if(s===0)return{x:c[0][0],y:c[0][1]};for(var l=0,f=null,d=0;d<i.length;d++){var v=i[d],x=v.from,w=v.to,I=v.length/s;if(a>=l&&a<=l+I){var G=(a-l)/I;f=Hr.pointAt(x[0],x[1],w[0],w[1],G);break}l+=I}return f}function Yo(c,a){if(a>1||a<0||c.length<2)return 0;for(var e=Ci(c),i=e.segments,s=e.totalLength,l=0,f=0,d=0;d<i.length;d++){var v=i[d],x=v.from,w=v.to,I=v.length/s;if(a>=l&&a<=l+I){f=Math.atan2(w[1]-x[1],w[0]-x[0]);break}l+=I}return f}function xi(c,a,e){for(var i=Infinity,s=0;s<c.length-1;s++){var l=c[s],f=c[s+1],d=Hr.pointDistance(l[0],l[1],f[0],f[1],a,e);d<i&&(i=d)}return i}var Xu={box:function(c){for(var a=[],e=[],i=0;i<c.length;i++){var s=c[i];a.push(s[0]),e.push(s[1])}return qn(a,e)},length:function(c){return Yi(c)},pointAt:function(c,a){return _i(c,a)},pointDistance:function(c,a,e){return xi(c,a,e)},tangentAngle:function(c,a){return Yo(c,a)}};function jo(c){var a=c.slice(0);return c.length&&a.push(c[0]),a}var Fl={box:function(c){return Xu.box(c)},length:function(c){return Yi(jo(c))},pointAt:function(c,a){return _i(jo(c),a)},pointDistance:function(c,a,e){return xi(jo(c),a,e)},tangentAngle:function(c,a){return Yo(jo(c),a)}};function ku(c,a){return!c||!a?c||a:{minX:Math.min(c.minX,a.minX),minY:Math.min(c.minY,a.minY),maxX:Math.max(c.maxX,a.maxX),maxY:Math.max(c.maxY,a.maxY)}}function xs(c,a){var e=c.get("startArrowShape"),i=c.get("endArrowShape"),s=null,l=null;return e&&(s=e.getCanvasBBox(),a=ku(a,s)),i&&(l=i.getCanvasBBox(),a=ku(a,l)),a}function _u(c){for(var a=c.attr(),e=a.points,i=[],s=[],l=0;l<e.length;l++){var f=e[l];i.push(f[0]),s.push(f[1])}var d=qn(i,s),v=d.x,x=d.y,w=d.width,I=d.height,G={minX:v,minY:x,maxX:v+w,maxY:x+I};return G=xs(c,G),{x:G.minX,y:G.minY,width:G.maxX-G.minX,height:G.maxY-G.minY}}function cl(c){for(var a=c.attr(),e=a.points,i=[],s=[],l=0;l<e.length;l++){var f=e[l];i.push(f[0]),s.push(f[1])}return qn(i,s)}var zi=null;function zu(){if(!zi){var c=document.createElement("canvas");c.width=1,c.height=1,zi=c.getContext("2d")}return zi}function sl(c,a,e){var i=1;if((0,k.isString)(c)&&(i=c.split(`
`).length),i>1){var s=Qo(a,e);return a*i+s*(i-1)}return a}function Qo(c,a){return a?a-c:c*.14}function Zl(c,a){var e=zu(),i=0;if((0,k.isNil)(c)||c==="")return i;if(e.save(),e.font=a,(0,k.isString)(c)&&c.includes(`
`)){var s=c.split(`
`);(0,k.each)(s,function(l){var f=e.measureText(l).width;i<f&&(i=f)})}else i=e.measureText(c).width;return e.restore(),i}function yu(c){var a=c.fontSize,e=c.fontFamily,i=c.fontWeight,s=c.fontStyle,l=c.fontVariant;return[s,l,i,a+"px",e].join(" ").trim()}function po(c){var a=c.attr(),e=a.x,i=a.y,s=a.text,l=a.fontSize,f=a.lineHeight,d=a.font;d||(d=yu(a));var v=Zl(s,d),x;if(!v)x={x:e,y:i,width:0,height:0};else{var w=a.textAlign,I=a.textBaseline,G=sl(s,l,f),U={x:e,y:i-G};w&&(w==="end"||w==="right"?U.x-=v:w==="center"&&(U.x-=v/2)),I&&(I==="top"?U.y+=G:I==="middle"&&(U.y+=G/2)),x={x:U.x,y:U.y,width:v,height:G}}return x}var Ds=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig,pi=/[^\s\,]+/ig;function Sl(c){var a=c||[];if((0,k.isArray)(a))return a;if((0,k.isString)(a))return a=a.match(Ds),(0,k.each)(a,function(e,i){if(e=e.match(pi),e[0].length>1){var s=e[0].charAt(0);e.splice(1,0,e[0].substr(1)),e[0]=s}(0,k.each)(e,function(l,f){isNaN(l)||(e[f]=+l)}),a[i]=e}),a}var rh=Sl;function fl(c,a,e,i){var s=[],l=!!i,f,d,v,x,w,I,G;if(l){v=i[0],x=i[1];for(var U=0,et=c.length;U<et;U+=1){var ft=c[U];v=Bi.min([0,0],v,ft),x=Bi.max([0,0],x,ft)}}for(var U=0,Ct=c.length;U<Ct;U+=1){var ft=c[U];if(U===0&&!e)G=ft;else if(U===Ct-1&&!e)I=ft,s.push(G),s.push(I);else{var Mt=[U?U-1:Ct-1,U-1][e?0:1];f=c[Mt],d=c[e?(U+1)%Ct:U+1];var kt=[0,0];kt=Bi.sub(kt,d,f),kt=Bi.scale(kt,kt,a);var $t=Bi.distance(ft,f),Jt=Bi.distance(ft,d),Ce=$t+Jt;Ce!==0&&($t/=Ce,Jt/=Ce);var je=Bi.scale([0,0],kt,-$t),ze=Bi.scale([0,0],kt,Jt);I=Bi.add([0,0],ft,je),w=Bi.add([0,0],ft,ze),w=Bi.min([0,0],w,Bi.max([0,0],d,ft)),w=Bi.max([0,0],w,Bi.min([0,0],d,ft)),je=Bi.sub([0,0],w,ft),je=Bi.scale([0,0],je,-$t/Jt),I=Bi.add([0,0],ft,je),I=Bi.min([0,0],I,Bi.max([0,0],f,ft)),I=Bi.max([0,0],I,Bi.min([0,0],f,ft)),ze=Bi.sub([0,0],ft,I),ze=Bi.scale([0,0],ze,Jt/$t),w=Bi.add([0,0],ft,ze),l&&(I=Bi.max([0,0],I,v),I=Bi.min([0,0],I,x),w=Bi.max([0,0],w,v),w=Bi.min([0,0],w,x)),s.push(G),s.push(I),G=w}}return e&&s.push(s.shift()),s}function $n(c,a,e){a===void 0&&(a=!1),e===void 0&&(e=[[0,0],[1,1]]);for(var i=!!a,s=[],l=0,f=c.length;l<f;l+=2)s.push([c[l],c[l+1]]);for(var d=fl(s,.4,i,e),v=s.length,x=[],w,I,G,l=0;l<v-1;l+=1)w=d[l*2],I=d[l*2+1],G=s[l+1],x.push(["C",w[0],w[1],I[0],I[1],G[0],G[1]]);return i&&(w=d[v],I=d[v+1],G=s[0],x.push(["C",w[0],w[1],I[0],I[1],G[0],G[1]])),x}var Jr=$n;function Nr(c,a,e){var i=null,s=e;return a<s&&(s=a,i="add"),c<s&&(s=c,i="del"),{type:i,min:s}}var Hi=function(c,a){var e=c.length,i=a.length,s,l,f=0;if(e===0||i===0)return null;for(var d=[],v=0;v<=e;v++)d[v]=[],d[v][0]={min:v};for(var x=0;x<=i;x++)d[0][x]={min:x};for(var v=1;v<=e;v++){s=c[v-1];for(var x=1;x<=i;x++){l=a[x-1],isEqual(s,l)?f=0:f=1;var w=d[v-1][x].min+1,I=d[v][x-1].min+1,G=d[v-1][x-1].min+f;d[v][x]=Nr(w,I,G)}}return d};function Jo(c,a){var e=Hi(c,a),i=c.length,s=a.length,l=[],f=1,d=1;if(e[i][s]!==i){for(var v=1;v<=i;v++){var x=e[v][v].min;d=v;for(var w=f;w<=s;w++)e[v][w].min<x&&(x=e[v][w].min,d=w);f=d,e[v][f].type&&l.push({index:v-1,type:e[v][f].type})}for(var v=l.length-1;v>=0;v--)f=l[v].index,l[v].type==="add"?c.splice(f,0,[].concat(c[f])):c.splice(f,1)}if(i=c.length,i<s)for(var v=0;v<s-i;v++)c[i-1][0]==="z"||c[i-1][0]==="Z"?c.splice(i-2,0,c[i-2]):c.push(c[i-1]);return c}var An=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,sn=new RegExp("([a-z])["+An+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+An+"]*,?["+An+"]*)+)","ig"),hr=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+An+"]*,?["+An+"]*","ig");function Pr(c){if(!c)return null;if((0,k.isArray)(c))return c;var a={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},e=[];return String(c).replace(sn,function(i,s,l){var f=[],d=s.toLowerCase();if(l.replace(hr,function(v,x){x&&f.push(+x)}),d==="m"&&f.length>2&&(e.push([s].concat(f.splice(0,2))),d="l",s=s==="m"?"l":"L"),d==="o"&&f.length===1&&e.push([s,f[0]]),d==="r")e.push([s].concat(f));else for(;f.length>=a[d]&&(e.push([s].concat(f.splice(0,a[d]))),!!a[d]););return""}),e}var Xr=/[a-z]/;function yr(c,a){return[a[0]+(a[0]-c[0]),a[1]+(a[1]-c[1])]}function vr(c){var a=Pr(c);if(!a||!a.length)return[["M",0,0]];for(var e=!1,i=0;i<a.length;i++){var s=a[i][0];if(Xr.test(s)||["V","H","T","S"].indexOf(s)>=0){e=!0;break}}if(!e)return a;var l=[],f=0,d=0,v=0,x=0,w=0,I,G,U=a[0];(U[0]==="M"||U[0]==="m")&&(f=+U[1],d=+U[2],v=f,x=d,w++,l[0]=["M",f,d]);for(var i=w,et=a.length;i<et;i++){var ft=a[i],Ct=l[i-1],Mt=[],s=ft[0],kt=s.toUpperCase();if(s!==kt)switch(Mt[0]=kt,kt){case"A":Mt[1]=ft[1],Mt[2]=ft[2],Mt[3]=ft[3],Mt[4]=ft[4],Mt[5]=ft[5],Mt[6]=+ft[6]+f,Mt[7]=+ft[7]+d;break;case"V":Mt[1]=+ft[1]+d;break;case"H":Mt[1]=+ft[1]+f;break;case"M":v=+ft[1]+f,x=+ft[2]+d,Mt[1]=v,Mt[2]=x;break;default:for(var $t=1,Jt=ft.length;$t<Jt;$t++)Mt[$t]=+ft[$t]+($t%2?f:d)}else Mt=a[i];switch(kt){case"Z":f=+v,d=+x;break;case"H":f=Mt[1],Mt=["L",f,d];break;case"V":d=Mt[1],Mt=["L",f,d];break;case"T":f=Mt[1],d=Mt[2];var Ce=yr([Ct[1],Ct[2]],[Ct[3],Ct[4]]);Mt=["Q",Ce[0],Ce[1],f,d];break;case"S":f=Mt[Mt.length-2],d=Mt[Mt.length-1];var je=Ct.length,ze=yr([Ct[je-4],Ct[je-3]],[Ct[je-2],Ct[je-1]]);Mt=["C",ze[0],ze[1],Mt[1],Mt[2],f,d];break;case"M":v=Mt[Mt.length-2],x=Mt[Mt.length-1];break;default:f=Mt[Mt.length-2],d=Mt[Mt.length-1]}l.push(Mt)}return l}var Mr=Math.PI*2,kn=function(c,a,e,i,s,l,f){var d=c.x,v=c.y;d*=a,v*=e;var x=i*d-s*v,w=s*d+i*v;return{x:x+l,y:w+f}},fr=function(c,a){var e=a===1.5707963267948966?.551915024494:a===-1.5707963267948966?-.551915024494:4/3*Math.tan(a/4),i=Math.cos(c),s=Math.sin(c),l=Math.cos(c+a),f=Math.sin(c+a);return[{x:i-s*e,y:s+i*e},{x:l+f*e,y:f-l*e},{x:l,y:f}]},Sn=function(c,a,e,i){var s=c*i-a*e<0?-1:1,l=c*e+a*i;return l>1&&(l=1),l<-1&&(l=-1),s*Math.acos(l)},Or=function(c,a,e,i,s,l,f,d,v,x,w,I){var G=Math.pow(s,2),U=Math.pow(l,2),et=Math.pow(w,2),ft=Math.pow(I,2),Ct=G*U-G*ft-U*et;Ct<0&&(Ct=0),Ct/=G*ft+U*et,Ct=Math.sqrt(Ct)*(f===d?-1:1);var Mt=Ct*s/l*I,kt=Ct*-l/s*w,$t=x*Mt-v*kt+(c+e)/2,Jt=v*Mt+x*kt+(a+i)/2,Ce=(w-Mt)/s,je=(I-kt)/l,ze=(-w-Mt)/s,pn=(-I-kt)/l,Fn=Sn(1,0,Ce,je),Tn=Sn(Ce,je,ze,pn);return d===0&&Tn>0&&(Tn-=Mr),d===1&&Tn<0&&(Tn+=Mr),[$t,Jt,Fn,Tn]},Zr=function(c){var a=c.px,e=c.py,i=c.cx,s=c.cy,l=c.rx,f=c.ry,d=c.xAxisRotation,v=d===void 0?0:d,x=c.largeArcFlag,w=x===void 0?0:x,I=c.sweepFlag,G=I===void 0?0:I,U=[];if(l===0||f===0)return[{x1:0,y1:0,x2:0,y2:0,x:i,y:s}];var et=Math.sin(v*Mr/360),ft=Math.cos(v*Mr/360),Ct=ft*(a-i)/2+et*(e-s)/2,Mt=-et*(a-i)/2+ft*(e-s)/2;if(Ct===0&&Mt===0)return[{x1:0,y1:0,x2:0,y2:0,x:i,y:s}];l=Math.abs(l),f=Math.abs(f);var kt=Math.pow(Ct,2)/Math.pow(l,2)+Math.pow(Mt,2)/Math.pow(f,2);kt>1&&(l*=Math.sqrt(kt),f*=Math.sqrt(kt));var $t=Or(a,e,i,s,l,f,w,G,et,ft,Ct,Mt),Jt=$t[0],Ce=$t[1],je=$t[2],ze=$t[3],pn=Math.abs(ze)/(Mr/4);Math.abs(1-pn)<1e-7&&(pn=1);var Fn=Math.max(Math.ceil(pn),1);ze/=Fn;for(var Tn=0;Tn<Fn;Tn++)U.push(fr(je,ze)),je+=ze;return U.map(function(cr){var kr=kn(cr[0],l,f,ft,et,Jt,Ce),Aa=kr.x,ci=kr.y,ei=kn(cr[1],l,f,ft,et,Jt,Ce),Ca=ei.x,Pi=ei.y,Ni=kn(cr[2],l,f,ft,et,Jt,Ce),_a=Ni.x,Ya=Ni.y;return{x1:Aa,y1:ci,x2:Ca,y2:Pi,x:_a,y:Ya}})};function wa(c,a,e,i,s,l,f,d,v){var x=Zr({px:c,py:a,cx:d,cy:v,rx:e,ry:i,xAxisRotation:s,largeArcFlag:l,sweepFlag:f});return x.reduce(function(w,I){var G=I.x1,U=I.y1,et=I.x2,ft=I.y2,Ct=I.x,Mt=I.y;return w.push(G,U,et,ft,Ct,Mt),w},[])}function Na(c,a){"TQ".indexOf(c[0])<0&&(a.qx=null,a.qy=null);var e=c.slice(1),i=e[0],s=e[1];switch(c[0]){case"M":return a.x=i,a.y=s,c;case"A":return["C"].concat(arcToCubic.apply(0,[a.x1,a.y1].concat(c.slice(1))));case"Q":return a.qx=i,a.qy=s,["C"].concat(quadToCubic.apply(0,[a.x1,a.y1].concat(c.slice(1))));case"L":return["C"].concat(lineToCubic(a.x1,a.y1,c[1],c[2]));case"H":return["C"].concat(lineToCubic(a.x1,a.y1,c[1],a.y1));case"V":return["C"].concat(lineToCubic(a.x1,a.y1,a.x1,c[1]));case"Z":return["C"].concat(lineToCubic(a.x1,a.y1,a.x,a.y));default:}return c}function ga(c,a){a===void 0&&(a=!1);for(var e=path2Absolute(c),i={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},s=[],l="",f=e.length,d,v,x=[],w=0;w<f;w+=1)e[w]&&(l=e[w][0]),s[w]=l,e[w]=segmentToCubic(e[w],i),ai(e,s,w),f=e.length,l==="Z"&&x.push(w),d=e[w],v=d.length,i.x1=+d[v-2],i.y1=+d[v-1],i.x2=+d[v-4]||i.x1,i.y2=+d[v-3]||i.y1;return a?[e,x]:e}function ai(c,a,e){if(c[e].length>7){c[e].shift();for(var i=c[e],s=e;i.length;)a[e]="A",c.splice(s+=1,0,["C"].concat(i.splice(0,6)));c.splice(e,1)}}var lo=function(c,a,e,i,s){var l=-3*a+9*e-9*i+3*s,f=c*l+6*a-12*e+6*i;return c*f-3*a+3*e},cs=function(c,a,e,i,s,l,f,d,v){v===null&&(v=1),v=v>1?1:v<0?0:v;for(var x=v/2,w=12,I=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],G=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],U=0,et=0;et<w;et++){var ft=x*I[et]+x,Ct=lo(ft,c,e,s,f),Mt=lo(ft,a,i,l,d),kt=Ct*Ct+Mt*Mt;U+=G[et]*Math.sqrt(kt)}return x*U},Qi=function(c,a,e,i,s,l,f,d){for(var v=[],x=[[],[]],w,I,G,U,et=0;et<2;++et){if(et===0?(I=6*c-12*e+6*s,w=-3*c+9*e-9*s+3*f,G=3*e-3*c):(I=6*a-12*i+6*l,w=-3*a+9*i-9*l+3*d,G=3*i-3*a),Math.abs(w)<1e-12){if(Math.abs(I)<1e-12)continue;U=-G/I,U>0&&U<1&&v.push(U);continue}var ft=I*I-4*G*w,Ct=Math.sqrt(ft);if(!(ft<0)){var Mt=(-I+Ct)/(2*w);Mt>0&&Mt<1&&v.push(Mt);var kt=(-I-Ct)/(2*w);kt>0&&kt<1&&v.push(kt)}}for(var $t=v.length,Jt=$t,Ce;$t--;)U=v[$t],Ce=1-U,x[0][$t]=Ce*Ce*Ce*c+3*Ce*Ce*U*e+3*Ce*U*U*s+U*U*U*f,x[1][$t]=Ce*Ce*Ce*a+3*Ce*Ce*U*i+3*Ce*U*U*l+U*U*U*d;return x[0][Jt]=c,x[1][Jt]=a,x[0][Jt+1]=f,x[1][Jt+1]=d,x[0].length=x[1].length=Jt+2,{min:{x:Math.min.apply(0,x[0]),y:Math.min.apply(0,x[1])},max:{x:Math.max.apply(0,x[0]),y:Math.max.apply(0,x[1])}}},Io=function(c,a,e,i,s,l,f,d){if(!(Math.max(c,e)<Math.min(s,f)||Math.min(c,e)>Math.max(s,f)||Math.max(a,i)<Math.min(l,d)||Math.min(a,i)>Math.max(l,d))){var v=(c*i-a*e)*(s-f)-(c-e)*(s*d-l*f),x=(c*i-a*e)*(l-d)-(a-i)*(s*d-l*f),w=(c-e)*(l-d)-(a-i)*(s-f);if(!!w){var I=v/w,G=x/w,U=+I.toFixed(2),et=+G.toFixed(2);if(!(U<+Math.min(c,e).toFixed(2)||U>+Math.max(c,e).toFixed(2)||U<+Math.min(s,f).toFixed(2)||U>+Math.max(s,f).toFixed(2)||et<+Math.min(a,i).toFixed(2)||et>+Math.max(a,i).toFixed(2)||et<+Math.min(l,d).toFixed(2)||et>+Math.max(l,d).toFixed(2)))return{x:I,y:G}}}},Mo=function(c,a,e){return a>=c.x&&a<=c.x+c.width&&e>=c.y&&e<=c.y+c.height},Os=function(c,a,e,i){return c===null&&(c=a=e=i=0),a===null&&(a=c.y,e=c.width,i=c.height,c=c.x),{x:c,y:a,width:e,w:e,height:i,h:i,x2:c+e,y2:a+i,cx:c+e/2,cy:a+i/2,r1:Math.min(e,i)/2,r2:Math.max(e,i)/2,r0:Math.sqrt(e*e+i*i)/2,path:rectPath(c,a,e,i),vb:[c,a,e,i].join(" ")}},yl=function(c,a){return c=Os(c),a=Os(a),Mo(a,c.x,c.y)||Mo(a,c.x2,c.y)||Mo(a,c.x,c.y2)||Mo(a,c.x2,c.y2)||Mo(c,a.x,a.y)||Mo(c,a.x2,a.y)||Mo(c,a.x,a.y2)||Mo(c,a.x2,a.y2)||(c.x<a.x2&&c.x>a.x||a.x<c.x2&&a.x>c.x)&&(c.y<a.y2&&c.y>a.y||a.y<c.y2&&a.y>c.y)},sf=function(c,a,e,i,s,l,f,d){isArray(c)||(c=[c,a,e,i,s,l,f,d]);var v=Qi.apply(null,c);return Os(v.min.x,v.min.y,v.max.x-v.min.x,v.max.y-v.min.y)},Ih=function(c,a,e,i,s,l,f,d,v){var x=1-v,w=Math.pow(x,3),I=Math.pow(x,2),G=v*v,U=G*v,et=w*c+I*3*v*e+x*3*v*v*s+U*f,ft=w*a+I*3*v*i+x*3*v*v*l+U*d,Ct=c+2*v*(e-c)+G*(s-2*e+c),Mt=a+2*v*(i-a)+G*(l-2*i+a),kt=e+2*v*(s-e)+G*(f-2*s+e),$t=i+2*v*(l-i)+G*(d-2*l+i),Jt=x*c+v*e,Ce=x*a+v*i,je=x*s+v*f,ze=x*l+v*d,pn=90-Math.atan2(Ct-kt,Mt-$t)*180/Math.PI;return{x:et,y:ft,m:{x:Ct,y:Mt},n:{x:kt,y:$t},start:{x:Jt,y:Ce},end:{x:je,y:ze},alpha:pn}},ah=function(c,a,e){var i=sf(c),s=sf(a);if(!yl(i,s))return e?0:[];for(var l=cs.apply(0,c),f=cs.apply(0,a),d=~~(l/8),v=~~(f/8),x=[],w=[],I={},G=e?0:[],U=0;U<d+1;U++){var et=Ih.apply(0,c.concat(U/d));x.push({x:et.x,y:et.y,t:U/d})}for(var U=0;U<v+1;U++){var et=Ih.apply(0,a.concat(U/v));w.push({x:et.x,y:et.y,t:U/v})}for(var U=0;U<d;U++)for(var ft=0;ft<v;ft++){var Ct=x[U],Mt=x[U+1],kt=w[ft],$t=w[ft+1],Jt=Math.abs(Mt.x-Ct.x)<.001?"y":"x",Ce=Math.abs($t.x-kt.x)<.001?"y":"x",je=Io(Ct.x,Ct.y,Mt.x,Mt.y,kt.x,kt.y,$t.x,$t.y);if(je){if(I[je.x.toFixed(4)]===je.y.toFixed(4))continue;I[je.x.toFixed(4)]=je.y.toFixed(4);var ze=Ct.t+Math.abs((je[Jt]-Ct[Jt])/(Mt[Jt]-Ct[Jt]))*(Mt.t-Ct.t),pn=kt.t+Math.abs((je[Ce]-kt[Ce])/($t[Ce]-kt[Ce]))*($t.t-kt.t);ze>=0&&ze<=1&&pn>=0&&pn<=1&&(e?G++:G.push({x:je.x,y:je.y,t1:ze,t2:pn}))}}return G},Lv=function(c,a,e){c=path2Curve(c),a=path2Curve(a);for(var i,s,l,f,d,v,x,w,I,G,U=e?0:[],et=0,ft=c.length;et<ft;et++){var Ct=c[et];if(Ct[0]==="M")i=d=Ct[1],s=v=Ct[2];else{Ct[0]==="C"?(I=[i,s].concat(Ct.slice(1)),i=I[6],s=I[7]):(I=[i,s,i,s,d,v,d,v],i=d,s=v);for(var Mt=0,kt=a.length;Mt<kt;Mt++){var $t=a[Mt];if($t[0]==="M")l=x=$t[1],f=w=$t[2];else{$t[0]==="C"?(G=[l,f].concat($t.slice(1)),l=G[6],f=G[7]):(G=[l,f,l,f,x,w,x,w],l=x,f=w);var Jt=ah(I,G,e);if(e)U+=Jt;else{for(var Ce=0,je=Jt.length;Ce<je;Ce++)Jt[Ce].segment1=et,Jt[Ce].segment2=Mt,Jt[Ce].bez1=I,Jt[Ce].bez2=G;U=U.concat(Jt)}}}}}return U};function Nf(c,a){return Lv(c,a)}function mf(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Hd(c,a){return mf(c)*mf(a)?(c[0]*a[0]+c[1]*a[1])/(mf(c)*mf(a)):1}function kc(c,a){return(c[0]*a[1]<c[1]*a[0]?-1:1)*Math.acos(Hd(c,a))}function Th(c,a){return c[0]===a[0]&&c[1]===a[1]}function G0(c,a){var e=a[1],i=a[2],s=(0,k.mod)((0,k.toRadian)(a[3]),Math.PI*2),l=a[4],f=a[5],d=c[0],v=c[1],x=a[6],w=a[7],I=Math.cos(s)*(d-x)/2+Math.sin(s)*(v-w)/2,G=-1*Math.sin(s)*(d-x)/2+Math.cos(s)*(v-w)/2,U=I*I/(e*e)+G*G/(i*i);U>1&&(e*=Math.sqrt(U),i*=Math.sqrt(U));var et=e*e*(G*G)+i*i*(I*I),ft=et?Math.sqrt((e*e*(i*i)-et)/et):1;l===f&&(ft*=-1),isNaN(ft)&&(ft=0);var Ct=i?ft*e*G/i:0,Mt=e?ft*-i*I/e:0,kt=(d+x)/2+Math.cos(s)*Ct-Math.sin(s)*Mt,$t=(v+w)/2+Math.sin(s)*Ct+Math.cos(s)*Mt,Jt=[(I-Ct)/e,(G-Mt)/i],Ce=[(-1*I-Ct)/e,(-1*G-Mt)/i],je=kc([1,0],Jt),ze=kc(Jt,Ce);return Hd(Jt,Ce)<=-1&&(ze=Math.PI),Hd(Jt,Ce)>=1&&(ze=0),f===0&&ze>0&&(ze=ze-2*Math.PI),f===1&&ze<0&&(ze=ze+2*Math.PI),{cx:kt,cy:$t,rx:Th(c,[x,w])?0:e,ry:Th(c,[x,w])?0:i,startAngle:je,endAngle:je+ze,xRotation:s,arcFlag:l,sweepFlag:f}}function Gm(c,a){return[a[0]+(a[0]-c[0]),a[1]+(a[1]-c[1])]}function im(c){c=rh(c);for(var a=[],e=null,i=null,s=null,l=0,f=c.length,d=0;d<f;d++){var v=c[d];i=c[d+1];var x=v[0],w={command:x,prePoint:e,params:v,startTangent:null,endTangent:null};switch(x){case"M":s=[v[1],v[2]],l=d;break;case"A":var I=G0(e,v);w.arcParams=I;break;default:break}if(x==="Z")e=s,i=c[l+1];else{var G=v.length;e=[v[G-2],v[G-1]]}i&&i[0]==="Z"&&(i=c[l],a[l]&&(a[l].prePoint=e)),w.currentPoint=e,a[l]&&Th(e,a[l].currentPoint)&&(a[l].prePoint=w.prePoint);var U=i?[i[i.length-2],i[i.length-1]]:null;w.nextPoint=U;var et=w.prePoint;if(["L","H","V"].includes(x))w.startTangent=[et[0]-e[0],et[1]-e[1]],w.endTangent=[e[0]-et[0],e[1]-et[1]];else if(x==="Q"){var ft=[v[1],v[2]];w.startTangent=[et[0]-ft[0],et[1]-ft[1]],w.endTangent=[e[0]-ft[0],e[1]-ft[1]]}else if(x==="T"){var Ct=a[d-1],ft=Gm(Ct.currentPoint,et);Ct.command==="Q"?(w.command="Q",w.startTangent=[et[0]-ft[0],et[1]-ft[1]],w.endTangent=[e[0]-ft[0],e[1]-ft[1]]):(w.command="TL",w.startTangent=[et[0]-e[0],et[1]-e[1]],w.endTangent=[e[0]-et[0],e[1]-et[1]])}else if(x==="C"){var Mt=[v[1],v[2]],kt=[v[3],v[4]];w.startTangent=[et[0]-Mt[0],et[1]-Mt[1]],w.endTangent=[e[0]-kt[0],e[1]-kt[1]],w.startTangent[0]===0&&w.startTangent[1]===0&&(w.startTangent=[Mt[0]-kt[0],Mt[1]-kt[1]]),w.endTangent[0]===0&&w.endTangent[1]===0&&(w.endTangent=[kt[0]-Mt[0],kt[1]-Mt[1]])}else if(x==="S"){var Ct=a[d-1],Mt=Gm(Ct.currentPoint,et),kt=[v[1],v[2]];Ct.command==="C"?(w.command="C",w.startTangent=[et[0]-Mt[0],et[1]-Mt[1]],w.endTangent=[e[0]-kt[0],e[1]-kt[1]]):(w.command="SQ",w.startTangent=[et[0]-kt[0],et[1]-kt[1]],w.endTangent=[e[0]-kt[0],e[1]-kt[1]])}else if(x==="A"){var $t=.001,Jt=w.arcParams||{},Ce=Jt.cx,je=Ce===void 0?0:Ce,ze=Jt.cy,pn=ze===void 0?0:ze,Fn=Jt.rx,Tn=Fn===void 0?0:Fn,cr=Jt.ry,kr=cr===void 0?0:cr,Aa=Jt.sweepFlag,ci=Aa===void 0?0:Aa,ei=Jt.startAngle,Ca=ei===void 0?0:ei,Pi=Jt.endAngle,Ni=Pi===void 0?0:Pi;ci===0&&($t*=-1);var _a=Tn*Math.cos(Ca-$t)+je,Ya=kr*Math.sin(Ca-$t)+pn;w.startTangent=[_a-s[0],Ya-s[1]];var hi=Tn*Math.cos(Ca+Ni+$t)+je,di=kr*Math.sin(Ca+Ni-$t)+pn;w.endTangent=[et[0]-hi,et[1]-di]}a.push(w)}return a}function ng(c){for(var a=[],e=c.length,i=0;i<e-1;i++){var s=c[i],l=c[i+1];a.push({from:{x:s[0],y:s[1]},to:{x:l[0],y:l[1]}})}if(a.length>1){var f=c[0],d=c[e-1];a.push({from:{x:d[0],y:d[1]},to:{x:f[0],y:f[1]}})}return a}function Um(c,a){var e=!1;return each(c,function(i){if(getLineIntersect(i.from,i.to,a.from,a.to))return e=!0,!1}),e}function Pv(c){var a=c.map(function(i){return i[0]}),e=c.map(function(i){return i[1]});return{minX:Math.min.apply(null,a),maxX:Math.max.apply(null,a),minY:Math.min.apply(null,e),maxY:Math.max.apply(null,e)}}function U0(c,a){return!(a.minX>c.maxX||a.maxX<c.minX||a.minY>c.maxY||a.maxY<c.minY)}function k1(c,a){if(c.length<2||a.length<2)return!1;var e=Pv(c),i=Pv(a);if(!U0(e,i))return!1;var s=!1;if(each(a,function(v){if(isPointInPolygon(c,v[0],v[1]))return s=!0,!1}),s||(each(c,function(v){if(isPointInPolygon(a,v[0],v[1]))return s=!0,!1}),s))return!0;var l=ng(c),f=ng(a),d=!1;return each(f,function(v){if(Um(l,v))return d=!0,!1}),d}function fv(c,a){for(var e=[],i=[],s=[],l=0;l<c.length;l++){var f=c[l],d=f.currentPoint,v=f.params,x=f.prePoint,w=void 0;switch(f.command){case"Q":w=dt.box(x[0],x[1],v[1],v[2],v[3],v[4]);break;case"C":w=Te.box(x[0],x[1],v[1],v[2],v[3],v[4],v[5],v[6]);break;case"A":var I=f.arcParams;w=si.box(I.cx,I.cy,I.rx,I.ry,I.xRotation,I.startAngle,I.endAngle);break;default:e.push(d[0]),i.push(d[1]);break}w&&(f.box=w,e.push(w.x,w.x+w.width),i.push(w.y,w.y+w.height)),a&&(f.command==="L"||f.command==="M")&&f.prePoint&&f.nextPoint&&s.push(f)}e=e.filter(function(Mt){return!Number.isNaN(Mt)&&Mt!==Infinity&&Mt!==-Infinity}),i=i.filter(function(Mt){return!Number.isNaN(Mt)&&Mt!==Infinity&&Mt!==-Infinity});var G=(0,k.min)(e),U=(0,k.min)(i),et=(0,k.max)(e),ft=(0,k.max)(i);if(s.length===0)return{x:G,y:U,width:et-G,height:ft-U};for(var l=0;l<s.length;l++){var f=s[l],d=f.currentPoint,Ct=void 0;d[0]===G?(Ct=Kh(f,a),G=G-Ct.xExtra):d[0]===et&&(Ct=Kh(f,a),et=et+Ct.xExtra),d[1]===U?(Ct=Kh(f,a),U=U-Ct.yExtra):d[1]===ft&&(Ct=Kh(f,a),ft=ft+Ct.yExtra)}return{x:G,y:U,width:et-G,height:ft-U}}function Kh(c,a){var e=c.prePoint,i=c.currentPoint,s=c.nextPoint,l=Math.pow(i[0]-e[0],2)+Math.pow(i[1]-e[1],2),f=Math.pow(i[0]-s[0],2)+Math.pow(i[1]-s[1],2),d=Math.pow(e[0]-s[0],2)+Math.pow(e[1]-s[1],2),v=Math.acos((l+f-d)/(2*Math.sqrt(l)*Math.sqrt(f)));if(!v||Math.sin(v)===0||(0,k.isNumberEqual)(v,0))return{xExtra:0,yExtra:0};var x=Math.abs(Math.atan2(s[1]-i[1],s[0]-i[0])),w=Math.abs(Math.atan2(s[0]-i[0],s[1]-i[1]));x=x>Math.PI/2?Math.PI-x:x,w=w>Math.PI/2?Math.PI-w:w;var I={xExtra:Math.cos(v/2-x)*(a/2*(1/Math.sin(v/2)))-a/2||0,yExtra:Math.cos(w-v/2)*(a/2*(1/Math.sin(v/2)))-a/2||0};return I}function Ec(c){var a=c.attr(),e=a.path,i=a.stroke,s=i?a.lineWidth:0,l=c.get("segments")||im(e),f=fv(l,s),d=f.x,v=f.y,x=f.width,w=f.height,I={minX:d,minY:v,maxX:d+x,maxY:v+w};return I=xs(c,I),{x:I.minX,y:I.minY,width:I.maxX-I.minX,height:I.maxY-I.minY}}function hv(c){var a=c.attr(),e=a.x1,i=a.y1,s=a.x2,l=a.y2,f=Math.min(e,s),d=Math.max(e,s),v=Math.min(i,l),x=Math.max(i,l),w={minX:f,maxX:d,minY:v,maxY:x};return w=xs(c,w),{x:w.minX,y:w.minY,width:w.maxX-w.minX,height:w.maxY-w.minY}}function y(c){var a=c.attr(),e=a.x,i=a.y,s=a.rx,l=a.ry;return{x:e-s,y:i-l,width:s*2,height:l*2}}nh("rect",Mp),nh("image",Mp),nh("circle",Np),nh("marker",Np),nh("polyline",_u),nh("polygon",cl),nh("text",po),nh("path",Ec),nh("line",hv),nh("ellipse",y);var m="0.5.11",E=function(c){(0,P.__extends)(a,c);function a(e,i){var s=c.call(this,e,i)||this;return s.item=i.item,s.canvasX=i.canvasX,s.canvasY=i.canvasY,s.wheelDelta=i.wheelDelta,s.detail=i.detail,s}return a}(hh),S=function(a){return"".concat(a,"-").concat(Math.random()).concat(Date.now())},D=function(a){if((0,k.isArray)(a))switch(a.length){case 4:return a;case 3:return a.push(a[1]),a;case 2:return a.concat(a);case 1:return[a[0],a[0],a[0],a[0]];default:return[0,0,0,0]}if((0,k.isNumber)(a))return[a,a,a,a];if((0,k.isString)(a)){var e=parseInt(a,10);return[e,e,e,e]}return[0,0,0,0]},J=function(a){var e=new E(a.type,a);return e.clientX=a.clientX,e.clientY=a.clientY,e.x=a.x,e.y=a.y,e.target=a.target,e.currentTarget=a.currentTarget,e.bubbles=!0,e.item=a.item,e},ct=function(a){if(!a)return!1;for(var e=9,i=[1,0,0,0,1,0,0,0,1],s=0;s<e;s++)if(a[s]!==i[s])return!0;return!1},vt=function(a){return Number.isNaN(Number(a))},It=function(a){for(var e=Infinity,i=-Infinity,s=Infinity,l=-Infinity,f=0;f<a.length;f++){var d=a[f],v=d.getBBox(),x=v.minX,w=v.minY,I=v.maxX,G=v.maxY;x<e&&(e=x),w<s&&(s=w),I>i&&(i=I),G>l&&(l=G)}var U=Math.floor(e),et=Math.floor(s),ft=Math.ceil(i)-Math.floor(e),Ct=Math.ceil(l)-Math.floor(s);return{x:U,y:et,width:ft,height:Ct,minX:e,minY:s,maxX:i,maxY:l}},Bt=function(a,e,i,s,l){e===void 0&&(e=15),i===void 0&&(i="quadratic"),s===void 0&&(s=void 0),l===void 0&&(l=void 0);for(var f=a.length,d=e*2,v=["top","top-right","right","bottom-right","bottom","bottom-left","left","top-left"],x={},w=[],I={},G=0;G<f;G++){var U=a[G],et=U.source,ft=U.target,Ct="".concat(et,"-").concat(ft);if(!w[G]){x[Ct]||(x[Ct]=[]),w[G]=!0,x[Ct].push(U);for(var Mt=0;Mt<f;Mt++)if(G!==Mt){var kt=a[Mt],$t=kt.source,Jt=kt.target;w[Mt]||(et===Jt&&ft===$t?(x[Ct].push(kt),w[Mt]=!0,I["".concat($t,"|").concat(Jt,"|").concat(x[Ct].length-1)]=!0):et===$t&&ft===Jt&&(x[Ct].push(kt),w[Mt]=!0))}}}for(var Ce in x)for(var je=x[Ce],ze=je.length,pn=0;pn<ze;pn++){var Fn=je[pn];if(Fn.source===Fn.target){l&&(Fn.type=l),Fn.loopCfg={position:v[pn%8],dist:Math.floor(pn/8)*20+50};continue}if(ze===1&&s&&Fn.source!==Fn.target){Fn.type=s;continue}Fn.type=i;var Tn=(pn%2==0?1:-1)*(I["".concat(Fn.source,"|").concat(Fn.target,"|").concat(pn)]?-1:1);ze%2==1?Fn.curveOffset=Tn*Math.ceil(pn/2)*d:Fn.curveOffset=Tn*(Math.floor(pn/2)*d+e)}return a},qt=$(31278),Zt=function(){function c(a){this.destroyed=!1,this.graph=a,this.destroyed=!1}return c.prototype.getViewCenter=function(){var a=this.getFormatPadding(),e=this.graph,i=this.graph.get("width"),s=e.get("height");return{x:(i-a[1]-a[3])/2+a[3],y:(s-a[0]-a[2])/2+a[0]}},c.prototype.fitCenter=function(a,e){var i=this.graph,s=i.get("group"),l,f=i.getNodes();if(f.length>i.get("optimizeThreshold")){var d=Infinity,v=Infinity,x=-Infinity,w=-Infinity;f.forEach(function(Jt){var Ce=Jt.getModel(),je=Ce.x,ze=Ce.y;d>je&&(d=je),v>ze&&(v=ze),x<je&&(x=je),w<ze&&(w=ze)});var I=s.getMatrix()||[1,0,0,0,1,0,0,0,1],G=Vr({x:d,y:v},I),U=G.x,et=G.y,ft=Vr({x,y:w},I),Ct=ft.x,Mt=ft.y;l={minX:U,maxX:Ct,minY:et,maxY:Mt,width:Ct-U,height:Mt-et,x:U,y:et}}else l=s.getCanvasBBox();if(!(l.width===0||l.height===0)){var kt=this.getViewCenter(),$t={x:l.x+l.width/2,y:l.y+l.height/2};i.translate(kt.x-$t.x,kt.y-$t.y,a,e)}},c.prototype.animatedFitView=function(a,e,i,s,l,f,d,v){var x=this.graph;i=i||{duration:500,easing:"easeCubic"};var w=[1,0,0,0,1,0,0,0,1],I=s.x+l.x-f.x-s.minX,G=s.y+l.y-f.y-s.minY;if(!(vt(I)||vt(G))){var U=(0,qt.vs)(w,[["t",I,G]]);if(!v){var et=Ll({animateCfg:i,callback:function(){x.emit("viewportchange",{action:"translate",matrix:U})}});a.animate(function(Jt){return{matrix:Ls(e,U,Jt)}},et);return}var ft=x.get("minZoom"),Ct=x.get("maxZoom"),Mt=d;ft&&d<ft?(Mt=ft,console.warn("fitview failed, ratio out of range, ratio: %f",d,"graph minzoom has been used instead")):Ct&&d>Ct&&(Mt=Ct,console.warn("fitview failed, ratio out of range, ratio: %f",d,"graph maxzoom has been used instead"));var kt=(0,qt.vs)(U,[["t",-l.x,-l.y],["s",Mt,Mt],["t",l.x,l.y]]),$t=Ll({animateCfg:i,callback:function(){a.setMatrix(kt),x.emit("viewportchange",{action:"translate",matrix:U}),x.emit("viewportchange",{action:"zoom",matrix:kt})}});a.stopAnimate(),a.setMatrix(e),a.animate(function(Jt){return{matrix:Ls(e,kt,Jt)}},$t)}},c.prototype.fitView=function(a,e){var i=this.graph,s=this.getFormatPadding(),l=i.get("width"),f=i.get("height"),d=i.get("group"),v=d.getMatrix()||[1,0,0,0,1,0,0,0,1];d.resetMatrix();var x,w=i.getNodes();if(w.length>i.get("optimizeThreshold")){var I=Infinity,G=Infinity,U=-Infinity,et=-Infinity;w.forEach(function(je){var ze=je.getModel(),pn=ze.x,Fn=ze.y;I>pn&&(I=pn),G>Fn&&(G=Fn),U<pn&&(U=pn),et<Fn&&(et=Fn)}),x={minX:I,maxX:U,minY:G,maxY:et,width:U-I,height:et-G,x:I,y:G}}else x=d.getCanvasBBox();if(!(x.width===0||x.height===0)){var ft=this.getViewCenter(),Ct={x:x.x+x.width/2,y:x.y+x.height/2},Mt=(l-s[1]-s[3])/x.width,kt=(f-s[0]-s[2])/x.height,$t=Mt;if(Mt>kt&&($t=kt),a)this.animatedFitView(d,v,e,x,ft,Ct,$t,!0);else{var Jt=ft.x-Ct.x,Ce=ft.y-Ct.y;if(vt(Jt)||vt(Ce))return;i.translate(Jt,Ce),i.zoom($t,ft)||console.warn("zoom failed, ratio out of range, ratio: %f",$t)}}},c.prototype.fitViewByRules=function(a,e,i){var s=a.onlyOutOfViewPort,l=s===void 0?!1:s,f=a.direction,d=f===void 0?"both":f,v=a.ratioRule,x=v===void 0?"min":v,w=this.graph,I=this.getFormatPadding(),G=w.get("width"),U=w.get("height"),et=w.get("group"),ft=et.getMatrix()||[1,0,0,0,1,0,0,0,1];et.resetMatrix();var Ct,Mt=w.getNodes();if(Mt.length>w.get("optimizeThreshold")){var kt=Infinity,$t=Infinity,Jt=-Infinity,Ce=-Infinity;Mt.forEach(function(ci){var ei=ci.getModel(),Ca=ei.x,Pi=ei.y;kt>Ca&&(kt=Ca),$t>Pi&&($t=Pi),Jt<Ca&&(Jt=Ca),Ce<Pi&&(Ce=Pi)}),Ct={minX:kt,maxX:Jt,minY:$t,maxY:Ce,width:Jt-kt,height:Ce-$t,x:kt,y:$t}}else Ct=et.getCanvasBBox();if(!(Ct.width===0||Ct.height===0)){var je=this.getViewCenter(),ze={x:Ct.x+Ct.width/2,y:Ct.y+Ct.height/2},pn=(G-I[1]-I[3])/Ct.width,Fn=(U-I[0]-I[2])/Ct.height,Tn;if(d==="x"?Tn=pn:d==="y"?Tn=Fn:Tn=x==="max"?Math.max(pn,Fn):Math.min(pn,Fn),l&&(Tn=Tn<1?Tn:1),e)this.animatedFitView(et,ft,i,Ct,je,ze,Tn,!0);else{var cr=w.getZoom(),kr=cr*Tn,Aa=w.get("minZoom");kr<Aa&&(kr=Aa,console.warn("fitview failed, ratio out of range, ratio: %f",Tn,"graph minzoom has been used instead")),w.translate(je.x-ze.x,je.y-ze.y),w.zoomTo(kr,je)}}},c.prototype.getFormatPadding=function(){var a=this.graph.get("fitViewPadding");return D(a)},c.prototype.focusPoint=function(a,e,i){var s=this,l=this.getViewCenter(),f=this.getPointByCanvas(l.x,l.y),d=this.graph.get("group").getMatrix();if(d||(d=[1,0,0,0,1,0,0,0,1]),e){var v=(f.x-a.x)*d[0],x=(f.y-a.y)*d[4],w=0,I=0,G=0,U=0;this.graph.get("canvas").animate(function(et){G=v*et,U=x*et,s.graph.translate(G-w,U-I),w=G,I=U},(0,P.__assign)({},i))}else this.graph.translate((f.x-a.x)*d[0],(f.y-a.y)*d[4])},c.prototype.getPointByCanvas=function(a,e){var i=this.graph.get("group").getMatrix();i||(i=[1,0,0,0,1,0,0,0,1]);var s=pa({x:a,y:e},i);return s},c.prototype.getPointByClient=function(a,e){var i=this.graph.get("canvas"),s=i.getPointByClient(a,e);return this.getPointByCanvas(s.x,s.y)},c.prototype.getClientByPoint=function(a,e){var i=this.graph.get("canvas"),s=this.getCanvasByPoint(a,e),l=i.getClientByPoint(s.x,s.y);return{x:l.x,y:l.y}},c.prototype.getCanvasByPoint=function(a,e){var i=this.graph.get("group").getMatrix();return i||(i=[1,0,0,0,1,0,0,0,1]),Vr({x:a,y:e},i)},c.prototype.focus=function(a,e,i){if((0,k.isString)(a)&&(a=this.graph.findById(a)),a){var s=0,l=0;if(a.getType&&a.getType()==="edge"){var f=a.getSource().get("group").getMatrix(),d=a.getTarget().get("group").getMatrix();f&&d?(s=(f[6]+d[6])/2,l=(f[7]+d[7])/2):(f||d)&&(s=f?f[6]:d[6],l=f?f[7]:d[7])}else{var v=a.get("group"),x=v.getMatrix();x||(x=[1,0,0,0,1,0,0,0,1]),s=x[6],l=x[7]}this.focusPoint({x:s,y:l},e,i)}},c.prototype.focusItems=function(a,e,i,s){if(!!a.length){var l=this.graph,f=this.getFormatPadding(),d=l.get("width"),v=l.get("height"),x=l.get("group"),w=x.getMatrix()||[1,0,0,0,1,0,0,0,1];x.resetMatrix();for(var I={x:0,y:0,minX:Number.MAX_SAFE_INTEGER,minY:Number.MAX_SAFE_INTEGER,maxX:Number.MIN_SAFE_INTEGER,maxY:Number.MIN_SAFE_INTEGER,width:0,height:0},G=0,U=a;G<U.length;G++){var et=U[G],ft=et.getBBox();ft.minX<I.minX&&(I.minX=ft.minX),ft.minY<I.minY&&(I.minY=ft.minY),ft.maxX>I.maxX&&(I.maxX=ft.maxX),ft.maxY>I.maxY&&(I.maxY=ft.maxY)}if(I.x=I.minX,I.y=I.minY,I.width=I.maxX-I.minX,I.height=I.maxY-I.minY,!(I.width===0||I.height===0)){var Ct=this.getViewCenter(),Mt={x:I.x+I.width/2,y:I.y+I.height/2},kt=(d-f[1]-f[3])/I.width,$t=(v-f[0]-f[2])/I.height,Jt=kt;kt>$t&&(Jt=$t),i?this.animatedFitView(x,w,s,I,Ct,Mt,Jt,e):(l.translate(Ct.x-Mt.x,Ct.y-Mt.y),e&&!l.zoom(Jt,Ct)&&console.warn("zoom failed, ratio out of range, ratio: %f",Jt))}}},c.prototype.changeSize=function(a,e){var i=this.graph;if(!(0,k.isNumber)(a)||!(0,k.isNumber)(e))throw Error("invalid canvas width & height, please make sure width & height type is number");i.set({width:a,height:e});var s=i.get("canvas");s.changeSize(a,e);var l=i.get("plugins");l.forEach(function(f){f.get("gridContainer")&&f.positionInit()})},c.prototype.destroy=function(){this.graph=null,this.destroyed=!1},c}(),Ht=Zt;function be(c){return be=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},be(c)}function _e(c){if(typeof c!="string")return c;var a=function(ze){if(typeof ze!="string")return ze;try{return JSON.parse(ze.trim())}catch(pn){return ze.trim()}},e=a(c);if(typeof e!="string")return e;for(var i=function(ze){return ze[ze.length-1]},s=c.trim(),l=[],f=[],d=function(){for(var ze=[],pn=0;pn<arguments.length;pn++)ze[pn]=arguments[pn];return ze.some(function(Fn){return i(f)===Fn})},v=function(){return i(l)},x=null,w=0,I="";w<s.length;){var G=s[w],U=d('"',"'");if(!U&&!G.trim()){w+=1;continue}var et=s[w-1]==="\\",ft=d("}"),Ct=d("]"),Mt=d(","),kt=v();if(U)if(i(f)===G&&!et){f.pop();var $t=a(I);kt.push($t),x=$t,I=""}else I+=G;else if(Ct&&G===",")I&&(kt.push(a(I)),I="");else if(ft&&G===":")f.push(","),I&&(kt.push(I),I="");else if(Mt&&G===",")I&&(kt.push(a(I)),I=""),f.pop();else if(G==="}"&&(ft||Mt)){I&&(kt.push(a(I)),I=""),Mt&&f.pop();for(var Jt={},Ce=1;Ce<kt.length;Ce+=2)Jt[kt[Ce-1]]=kt[Ce];l.pop(),l.length&&i(l).push(Jt),f.pop(),x=Jt}else G==="]"&&Ct?(I&&(kt.push(a(I)),I=""),l.pop(),l.length&&i(l).push(kt),f.pop(),x=kt):G==="{"?(l.push([]),f.push("}")):G==="["?(l.push([]),f.push("]")):G==='"'?f.push('"'):G==="'"?f.push("'"):I+=G;w+=1}return x||I}var Ue=function(a){return a.split("-").reduce(function(e,i){return e+i.charAt(0).toUpperCase()+i.slice(1)})},nn=function(a){return function(e){for(var i=a.length,s=[],l=0,f="";l<i;)if(a[l]==="{"&&a[l+1]==="{")s.push(f),f="",l+=2;else if(a[l]==="}"&&a[l+1]==="}"){if(s.length){var d=s.pop();f=(0,k.get)(e,f,d.endsWith("=")?'"{'.concat(f,'}"'):f),s.push(d+f)}l+=2,f=""}else f+=a[l],l+=1;return s.push(f),s.map(function(v,x){return s[x-1]&&s[x-1].endsWith("=")?'"{'.concat(v,'}"'):v}).join("")}};function hn(c,a){var e={},i=c.getAttributeNames&&c.getAttributeNames()||[],s=c.children&&Array.from(c.children).map(function(d){return hn(d,a)}),l={},f=c.tagName?c.tagName.toLowerCase():"group";return f==="text"&&(e.text=c.innerText),l.type=f,f==="img"&&(l.type="image"),Array.from(i).forEach(function(d){var v=Ue(d),x=c.getAttribute(d);try{if(v==="style"||v==="attrs"){var w=_e(x);e=(0,P.__assign)((0,P.__assign)({},e),w)}else l[v]=_e(x)}catch(I){if(v==="style")throw I;l[v]=x}}),l.attrs=e,a&&a.style&&l.name&&be(a.style[l.name])==="object"&&(l.attrs=(0,P.__assign)((0,P.__assign)({},l.attrs),a.style[l.name])),a&&a.style&&l.keyshape&&(l.attrs=(0,P.__assign)((0,P.__assign)({},l.attrs),a.style)),s.length&&(l.children=s),l}function On(c,a,e){var i=c.attrs,s=i===void 0?{}:i,l={x:a.x||0,y:a.y||0,width:e.width||0,height:e.height||0},f,d;switch(c.type){case"maker":case"circle":s.r&&(d=2*s.r,f=2*s.r);break;case"text":s.text&&(d=Ys(s.text,s.fontSize||12)[0],f=16,l.y+=f,l.height=f,l.width=d,c.attrs=(0,P.__assign)({fontSize:12,fill:"#000"},s));break;default:s.width&&(d=s.width),s.height&&(f=s.height)}return f>=0&&(l.height=f),d>=0&&(l.width=d),s.marginTop&&(l.y+=s.marginTop),s.marginLeft&&(l.x+=s.marginLeft),l}function er(c,a){var e;a===void 0&&(a={x:0,y:0});var i=(0,P.__assign)({x:0,y:0,width:0,height:0},a);if((e=c.children)===null||e===void 0?void 0:e.length){var s=c.attrs,l=s===void 0?{}:s,f=l.marginTop,d=(0,P.__assign)({},a);f&&(d.y+=f);for(var v=0;v<c.children.length;v++){c.children[v].attrs.key="".concat(l.key||"root"," -").concat(v," ");var x=er(c.children[v],d);if(x.bbox){var w=x.bbox;x.attrs.next==="inline"?d.x+=x.bbox.width:d.y+=x.bbox.height,w.width+w.x>i.width&&(i.width=w.width+w.x),w.height+w.y>i.height&&(i.height=w.height+w.y)}}}return c.bbox=On(c,a,i),c.attrs=(0,P.__assign)((0,P.__assign)({},c.attrs),c.bbox),c}function Yn(c,a){var e,i,s,l,f=(c||{}).type,d=((a==null?void 0:a.attrs)||{}).key;if(d&&c&&(c.attrs.key=d),!c&&a)return{action:"delete",val:a,type:f,key:d};if(c&&!a)return{action:"add",val:c,type:f};if(!c&&!a)return{action:"same",type:f};var v=[];if(((e=c.children)===null||e===void 0?void 0:e.length)>0||((i=a.children)===null||i===void 0?void 0:i.length)>0)for(var x=Math.max((s=c.children)===null||s===void 0?void 0:s.length,(l=a.children)===null||l===void 0?void 0:l.length),w=a.children||[],I=c.children||[],G=0;G<x;G+=1)v.push(Yn(I[G],w[G]));var U=Object.keys(a.attrs),et=Object.keys(c.attrs);return a.type!==c.type?{action:"restructure",nowTarget:c,formerTarget:a,key:d,children:v}:U.filter(function(ft){return ft!=="children"}).some(function(ft){return c.attrs[ft]!==a.attrs[ft]||!et.includes(ft)})?{action:"change",val:c,children:v,type:f,key:d}:{action:"same",children:v,type:f,key:d}}function Ir(c){var a={},e=function(s){var l=typeof c=="function"?c(s):c,f=nn(l)(s),d=document.createElement("div");d.innerHTML=f;var v=d.children[0],x=er(hn(v,s));return d.remove(),x};return{draw:function(s,l){var f=e(s),d=l,v=function x(w){var I=w.attrs,G=I===void 0?{}:I,U=w.bbox,et=w.type,ft=w.children,Ct=(0,P.__rest)(w,["attrs","bbox","type","children"]);if(w.type!=="group"){var Mt=l.addShape(w.type,(0,P.__assign)({attrs:G,origin:{bbox:U,type:et,children:ft}},Ct));w.keyshape&&(d=Mt)}w.children&&w.children.forEach(function(kt){return x(kt)})};return v(f),a[s.id]=[f],d},update:function(s,l){a[s.id]||(a[s.id]=[]);var f=l.getContainer(),d=f.get("children"),v=e(s),x=a[s.id].pop(),w=Yn(v,x),I=function et(ft){var Ct;ft.type!=="group"&&f.addShape(ft.type,{attrs:ft.attrs}),((Ct=ft.children)===null||Ct===void 0?void 0:Ct.length)&&ft.children.map(function(Mt){return et(Mt)})},G=function et(ft){var Ct,Mt=d.find(function(kt){return kt.attrs.key===ft.attrs.key});Mt&&f.removeChild(Mt),((Ct=ft.children)===null||Ct===void 0?void 0:Ct.length)&&ft.children.map(function(kt){return et(kt)})},U=function et(ft){var Ct=ft.key;if(ft.type!=="group"){var Mt=d.find(function($t){return $t.attrs.key===Ct});switch(ft.action){case"change":if(Mt){var kt=ft.val.keyshape?l.getOriginStyle():{};Mt.attr((0,P.__assign)((0,P.__assign)({},kt),ft.val.attrs))}break;case"add":I(ft.val);break;case"delete":G(ft.val);break;case"restructure":G(ft.formerTarget),I(ft.nowTarget);break;default:break}}ft.children&&ft.children.forEach(function($t){return et($t)})};U(w),a[s.id].push(v)},getAnchorPoints:function(){return[[0,.5],[1,.5],[.5,1],[.5,0]]}}}var Un={};function gr(c){return Un[c]||(Un[c]=(0,k.upperFirst)(c)),Un[c]}var Br={defaultShapeType:"defaultType",className:null,getShape:function(a){var e=this,i=e[a]||e[e.defaultShapeType]||e["simple-circle"];return i},draw:function(a,e,i){var s=this.getShape(a);i.shapeMap={};var l=s.draw(e,i);return s.afterDraw&&s.afterDraw(e,i,l),l},baseUpdate:function(a,e,i,s){var l,f,d=this.getShape(a);d.update&&(d.mergeStyle=(l=d.getOptions)===null||l===void 0?void 0:l.call(d,e,s),(f=d.update)===null||f===void 0||f.call(d,e,i,s)),d.afterUpdate&&d.afterUpdate(e,i)},setState:function(a,e,i,s){var l=this.getShape(a);l.setState(e,i,s)},shouldUpdate:function(a){var e=this.getShape(a);return!!e.update},getControlPoints:function(a,e){var i=this.getShape(a);return i.getControlPoints(e)},getAnchorPoints:function(a,e){var i=this.getShape(a);return i.getAnchorPoints(e)}},Tr={options:{},draw:function(a,e){return this.drawShape(a,e)},drawShape:function(){},afterDraw:function(){},afterUpdate:function(){},setState:function(){},getControlPoints:function(a){return a.controlPoints},getAnchorPoints:function(a){var e=this.options.anchorPoints,i=a.anchorPoints||e;return i}},sa=function(){function c(){}return c.registerFactory=function(a,e){var i=gr(a),s=Br,l=(0,P.__assign)((0,P.__assign)({},s),e);return c[i]=l,l.className=i,l},c.getFactory=function(a){var e=gr(a);return c[e]},c.registerNode=function(a,e,i){var s=c.Node,l;if(typeof e=="string"||typeof e=="function"){var f=Ir(e);l=(0,P.__assign)((0,P.__assign)({},s.getShape("single-node")),f)}else if(e.jsx){var d=e.jsx,f=Ir(d);l=(0,P.__assign)((0,P.__assign)((0,P.__assign)({},s.getShape("single-node")),f),e)}else{s.getShape(i);var v=i?s.getShape(i):Tr;l=(0,P.__assign)((0,P.__assign)({},v),e)}return l.type=a,l.itemType="node",s[a]=l,l},c.registerEdge=function(a,e,i){var s=c.Edge,l=i?s.getShape(i):Tr,f=(0,P.__assign)((0,P.__assign)({},l),e);return f.type=a,f.itemType="edge",s[a]=f,f},c.registerCombo=function(a,e,i){var s=c.Combo,l=i?s.getShape(i):Tr,f=(0,P.__assign)((0,P.__assign)({},l),e);return f.type=a,f.itemType="combo",s[a]=f,f},c}(),Gr=sa;sa.registerFactory("node",{defaultShapeType:"circle"}),sa.registerFactory("edge",{defaultShapeType:"line"}),sa.registerFactory("combo",{defaultShapeType:"circle"});var va="bboxCache",la="bboxCanvasCache",ka=null,ri=function(){function c(a){this._cfg={},this.destroyed=!1,this.optimize=!1;var e={id:void 0,type:"item",model:{},group:void 0,animate:!1,visible:!0,locked:!1,event:!0,keyShape:void 0,states:[]};this._cfg=Object.assign(e,this.getDefaultCfg(),a);var i=this.get("model"),s=i.id,l=this.get("type");typeof s=="undefined"?s=S(l):typeof s!="string"&&(s=String(s)),this.get("model").id=s,this.set("id",s);var f=a.group;f&&(f.set("item",this),f.set("id",s)),this.init(),this.draw();var d=i.shape||i.type||(l==="edge"?"line":"circle"),v=this.get("shapeFactory");if(v&&v[d]){var x=v[d].options;if(x&&x.stateStyles){var w=this.get("styles")||i.stateStyles;w=(0,k.deepMix)({},x.stateStyles,w),this.set("styles",w)}}}return c.prototype.calculateBBox=function(){var a=this.get("keyShape"),e=this.get("group"),i=Oa(a,e);return i.x=i.minX,i.y=i.minY,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i.centerX=(i.minX+i.maxX)/2,i.centerY=(i.minY+i.maxY)/2,i},c.prototype.calculateCanvasBBox=function(){var a=this.get("keyShape"),e=this.get("group"),i=Oa(a,e);return i.x=i.minX,i.y=i.minY,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i.centerX=(i.minX+i.maxX)/2,i.centerY=(i.minY+i.maxY)/2,i},c.prototype.drawInner=function(){var a=this,e=a.get("shapeFactory"),i=a.get("group"),s=a.get("model");i.clear();var l=s.visible;if(l!==void 0&&!l&&a.changeVisibility(l),!!e){a.updatePosition(s);var f=a.getShapeCfg(s),d=f.type,v=e.draw(d,f,i);v&&(a.set("keyShape",v),v.set("isKeyShape",!0),v.set("draggable",!0)),this.setOriginStyle(),this.set("currentShape",d),this.restoreStates(e,d)}},c.prototype.setOriginStyle=function(){var a=this.get("group"),e=a.get("children"),i=this.getKeyShape(),s=this,l=i.get("name");if(this.get("originStyle")){var U=this.get("originStyle");l&&!U[l]&&(U[l]={});for(var et=this.getCurrentStatesStyle(),ft=function(Mt){var kt=e[Mt],$t=kt.get("name"),Jt=kt.attr();if($t&&$t!==l){var Ce=et[$t];U[$t]||(U[$t]={}),Ce?Object.keys(Jt).forEach(function(pn){var Fn=Jt[pn];Fn!==Ce[pn]&&(U[$t][pn]=Fn)}):U[$t]=kt.get("type")!=="image"?(0,k.clone)(Jt):s.getShapeStyleByName($t)}else{var je=kt.attr(),ze={};Object.keys(et).forEach(function(pn){var Fn=et[pn];(pn===l||!(0,k.isPlainObject)(Fn))&&(ze[pn]=Fn)}),Object.keys(je).forEach(function(pn){var Fn=je[pn];ze[pn]!==Fn&&(l?U[l][pn]=Fn:U[pn]=Fn)})}},d=0;d<e.length;d++)ft(d);delete U.path,delete U.matrix,delete U.x,delete U.y,U[l]&&(delete U[l].x,delete U[l].y,delete U[l].matrix,delete U[l].path),s.set("originStyle",U)}else{for(var f={},d=0;d<e.length;d++){var v=e[d],x=v.get("type"),w=v.get("name");if(w&&w!==l)f[w]=x!=="image"?(0,k.clone)(v.attr()):s.getShapeStyleByName(w),x==="text"&&f[w]&&(delete f[w].x,delete f[w].y,delete f[w].matrix);else{var I=s.getShapeStyleByName();if(delete I.path,delete I.matrix,!l)Object.assign(f,I);else if(w)f[l]=I;else{var G=S("shape");v.set("name",G),a.shapeMap[G]=v,f[G]=x!=="image"?(0,k.clone)(v.attr()):s.getShapeStyleByName(w)}}}s.set("originStyle",f)}},c.prototype.restoreStates=function(a,e){var i=this,s=i.get("states");(0,k.each)(s,function(l){a.setState(e,l,!0,i)})},c.prototype.init=function(){var a=Gr.getFactory(this.get("type"));this.set("shapeFactory",a)},c.prototype.get=function(a){return this._cfg[a]},c.prototype.set=function(a,e){(0,k.isPlainObject)(a)?this._cfg=(0,P.__assign)((0,P.__assign)({},this._cfg),a):this._cfg[a]=e},c.prototype.getDefaultCfg=function(){return{}},c.prototype.clearCache=function(){this.set(va,null),this.set(la,null)},c.prototype.beforeDraw=function(){},c.prototype.afterDraw=function(){},c.prototype.afterUpdate=function(){},c.prototype.draw=function(){this.beforeDraw(),this.drawInner(),this.afterDraw()},c.prototype.getShapeStyleByName=function(a){var e=this.get("group"),i;if(a?i=e.shapeMap[a]:i=this.getKeyShape(),i){var s={};return(0,k.each)(i.attr(),function(l,f){(f!=="img"||(0,k.isString)(l))&&(s[f]=l)}),s}return{}},c.prototype.getShapeCfg=function(a,e){var i=this.get("styles");if(i){var s=a;return s.style=(0,P.__assign)((0,P.__assign)({},i),a.style),s}return a},c.prototype.getStateStyle=function(a){var e=this.get("styles"),i=e&&e[a];return i},c.prototype.getOriginStyle=function(){return this.get("originStyle")},c.prototype.getCurrentStatesStyle=function(){var a=this,e={},i=a.getStates();return!i||!i.length?this.get("originStyle"):((0,k.each)(a.getStates(),function(s){e=Object.assign(e,a.getStateStyle(s))}),e)},c.prototype.setState=function(a,e){var i=this.get("states"),s=this.get("shapeFactory"),l=a,f=a;(0,k.isString)(e)&&(l="".concat(a,":").concat(e),f="".concat(a,":"));var d=i;if((0,k.isBoolean)(e)){var v=i.indexOf(f);if(e){if(v>-1)return;i.push(l)}else v>-1&&i.splice(v,1)}else if((0,k.isString)(e)){var x=i.filter(function(G){return G.includes(f)});x.length>0&&this.clearStates(x),d=d.filter(function(G){return!G.includes(f)}),d.push(l),this.set("states",d)}if(s){var w=this.get("model"),I=w.type;s.setState(I,a,e,this)}},c.prototype.clearStates=function(a){var e=this,i=e.getStates(),s=e.get("shapeFactory"),l=e.get("model"),f=l.type;a||(a=i),(0,k.isString)(a)&&(a=[a]);var d=i.filter(function(v){return a.indexOf(v)===-1});e.set("states",d),a.forEach(function(v){s.setState(f,v,!1,e)})},c.prototype.setOptimize=function(a){this.optimize=a},c.prototype.getContainer=function(){return this.get("group")},c.prototype.getKeyShape=function(){return this.get("keyShape")},c.prototype.getModel=function(){return this.get("model")},c.prototype.getType=function(){return this.get("type")},c.prototype.getID=function(){return this.get("id")},c.prototype.isItem=function(){return!0},c.prototype.getStates=function(){return this.get("states")},c.prototype.hasState=function(a){var e=this.getStates();return e.indexOf(a)>=0},c.prototype.refresh=function(a){var e=this.get("model");this.updatePosition(e),this.updateShape(a),this.afterUpdate(),this.clearCache()},c.prototype.getUpdateType=function(a){},c.prototype.update=function(a,e){e===void 0&&(e=void 0);var i=this.get("model");if(e==="move")this.updatePosition(a);else{var s=i.visible,l=a.visible;s!==l&&l!==void 0&&this.changeVisibility(l);var f={x:i.x,y:i.y};a.x=isNaN(+a.x)?i.x:+a.x,a.y=isNaN(+a.y)?i.y:+a.y;var d=this.get("styles");if(a.stateStyles){var v=a.stateStyles;(0,k.mix)(d,v),delete a.stateStyles}Object.assign(i,a),(f.x!==a.x||f.y!==a.y)&&this.updatePosition(a),this.updateShape(e)}this.afterUpdate(),this.clearCache()},c.prototype.updateShape=function(a){var e=this.get("shapeFactory"),i=this.get("model"),s=i.type;if(e.shouldUpdate(s)&&s===this.get("currentShape")){var l=this.getShapeCfg(i,a);e.baseUpdate(s,l,this,a),a!=="move"&&this.setOriginStyle()}else this.draw();this.restoreStates(e,s)},c.prototype.updatePosition=function(a){var e=this.get("model"),i=isNaN(+a.x)?+e.x:+a.x,s=isNaN(+a.y)?+e.y:+a.y,l=this.get("group");if(isNaN(i)||isNaN(s))return!1;e.x=i,e.y=s;var f=l.getMatrix();return f&&f[6]===i&&f[7]===s?!1:(l.resetMatrix(),Ts(l,{x:i,y:s}),this.clearCache(),!0)},c.prototype.getBBox=function(){var a=this.get(va);return a||(a=this.calculateBBox(),this.set(va,a)),a},c.prototype.getCanvasBBox=function(){var a=this.get(la);return a||(a=this.calculateCanvasBBox(),this.set(la,a)),a},c.prototype.toFront=function(){var a=this.get("group");a.toFront()},c.prototype.toBack=function(){var a=this.get("group");a.toBack()},c.prototype.show=function(){this.changeVisibility(!0)},c.prototype.hide=function(){this.changeVisibility(!1)},c.prototype.changeVisibility=function(a){var e=this.get("group");a?e.show():e.hide(),this.set("visible",a)},c.prototype.isVisible=function(){return this.get("visible")},c.prototype.enableCapture=function(a){var e=this.get("group");e&&e.set("capture",a)},c.prototype.destroy=function(){if(!this.destroyed){var a=this.get("animate"),e=this.get("group");a&&e.stopAnimate(),e.shapeMap={},this.clearCache(),e.remove(),this._cfg=null,this.destroyed=!0}},c}(),Li=ri,to={source:"start",target:"end"},fi="Node",Ii="Point",Ja="Anchor",oo=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultCfg=function(){return{type:"edge",sourceNode:null,targetNode:null,startPoint:null,endPoint:null,linkCenter:!1}},a.prototype.setEnd=function(e,i){var s=to[e]+Ii,l=e+fi,f=this.get(l);f&&!f.destroyed&&f.removeEdge(this),(0,k.isPlainObject)(i)?(this.set(s,i),this.set(l,null)):i&&(i.addEdge(this),this.set(l,i),this.set(s,null))},a.prototype.getLinkPoint=function(e,i,s){var l=to[e]+Ii,f=e+fi,d=this.get(l);if(!d){var v=this.get(f),x=e+Ja,w=this.getPrePoint(e,s),I=i[x];(0,k.isNil)(I)||(d=v.getLinkPointByAnchor(I)),d=d||v.getLinkPoint(w),(0,k.isNil)(d.index)||this.set("".concat(e,"AnchorIndex"),d.index)}return d},a.prototype.getPrePoint=function(e,i){if(i&&i.length){var s=e==="source"?0:i.length-1;return i[s]}var l=e==="source"?"target":"source";return this.getEndPoint(l)},a.prototype.getEndPoint=function(e){var i=e+fi,s=to[e]+Ii,l=this.get(i);return l&&!l.destroyed?l.get("model"):this.get(s)},a.prototype.getControlPointsByCenter=function(e){var i=this.getEndPoint("source"),s=this.getEndPoint("target"),l=this.get("shapeFactory"),f=e.type;return l.getControlPoints(f,{startPoint:i,endPoint:s})},a.prototype.getEndCenter=function(e){var i=e+fi,s=to[e]+Ii,l=this.get(i);if(l){var f=l.getBBox();return{x:f.centerX,y:f.centerY}}return this.get(s)},a.prototype.init=function(){c.prototype.init.call(this),this.setSource(this.get("source")),this.setTarget(this.get("target"))},a.prototype.getShapeCfg=function(e,i){var s=this,l=s.get("linkCenter"),f=(i==null?void 0:i.includes("move"))?e:c.prototype.getShapeCfg.call(this,e);if(l)f.startPoint=s.getEndCenter("source"),f.endPoint=s.getEndCenter("target");else{var d=f.controlPoints||s.getControlPointsByCenter(f);f.startPoint=s.getLinkPoint("source",e,d),f.endPoint=s.getLinkPoint("target",e,d)}return f.sourceNode=s.get("sourceNode"),f.targetNode=s.get("targetNode"),f},a.prototype.getModel=function(){var e=this.get("model"),i=this.get("source".concat(fi)),s=this.get("target".concat(fi));return i?delete e["source".concat(fi)]:e.source=this.get("start".concat(Ii)),s?delete e["target".concat(fi)]:e.target=this.get("end".concat(Ii)),!(0,k.isString)(e.source)&&!(0,k.isPlainObject)(e.source)&&(e.source=e.source.getID()),!(0,k.isString)(e.target)&&!(0,k.isPlainObject)(e.target)&&(e.target=e.target.getID()),e},a.prototype.setSource=function(e){this.setEnd("source",e),this.set("source",e)},a.prototype.setTarget=function(e){this.setEnd("target",e),this.set("target",e)},a.prototype.getSource=function(){return this.get("source")},a.prototype.getTarget=function(){return this.get("target")},a.prototype.updatePosition=function(){return!1},a.prototype.update=function(e,i){i===void 0&&(i=void 0);var s=this.get("model"),l=s.visible,f=e.visible;l!==f&&f!==void 0&&this.changeVisibility(f);var d=this.get("source"),v=this.get("target");if(!(!d||d.destroyed||!v||v.destroyed)){var x=this.get("styles");if(e.stateStyles){var w=e.stateStyles;(0,k.mix)(x,w),delete e.stateStyles}Object.assign(s,e),this.updateShape(i),this.afterUpdate(),this.clearCache()}},a.prototype.destroy=function(){var e=this.get("source".concat(fi)),i=this.get("target".concat(fi));e&&!e.destroyed&&e.removeEdge(this),i&&!i.destroyed&&i.removeEdge(this),c.prototype.destroy.call(this)},a}(Li),Po=oo,Fo="anchorPointsCache",_s="bboxCache",Eo=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getNearestPoint=function(e,i){for(var s=0,l=e[0],f=Vi(e[0],i),d=0;d<e.length;d++){var v=e[d],x=Vi(v,i);x<f&&(l=v,f=x,s=d)}return l.anchorIndex=s,l},a.prototype.getDefaultCfg=function(){return{type:"node",edges:[]}},a.prototype.getEdges=function(){return this.get("edges")},a.prototype.getInEdges=function(){var e=this;return this.get("edges").filter(function(i){return i.get("target")===e})},a.prototype.getOutEdges=function(){var e=this;return this.get("edges").filter(function(i){return i.get("source")===e})},a.prototype.getNeighbors=function(e){var i=this,s=this.get("edges");if(e==="target"){var l=function(x){return x.getSource()===i};return s.filter(l).map(function(v){return v.getTarget()})}if(e==="source"){var f=function(x){return x.getTarget()===i};return s.filter(f).map(function(v){return v.getSource()})}var d=function(x){return x.getSource()===i?x.getTarget():x.getSource()};return s.map(d)},a.prototype.getLinkPointByAnchor=function(e){var i=this.getAnchorPoints();return i[e]},a.prototype.getLinkPoint=function(e){var i=this.get("keyShape"),s=i.get("type"),l=this.get("type"),f,d,v=this.getBBox();l==="combo"?(f=v.centerX||(v.maxX+v.minX)/2,d=v.centerY||(v.maxY+v.minY)/2):(f=v.centerX,d=v.centerY);var x=this.getAnchorPoints(),w;switch(s){case"circle":w=Qu({x:f,y:d,r:v.width/2},e);break;case"ellipse":w=xn({x:f,y:d,rx:v.width/2,ry:v.height/2},e);break;default:w=Qs(v,e)}var I=w;return x.length&&(I||(I=e),I=this.getNearestPoint(x,I)),I||(I={x:f,y:d}),I},a.prototype.getAnchorPoints=function(){var e=this.get(Fo);if(!e){e=[];var i=this.get("shapeFactory"),s=this.getBBox(),l=this.get("model"),f=this.getShapeCfg(l),d=l.type,v=i.getAnchorPoints(d,f)||[];(0,k.each)(v,function(x,w){var I={x:s.minX+x[0]*s.width,y:s.minY+x[1]*s.height,anchorIndex:w};e.push(I)}),this.set(Fo,e)}return e},a.prototype.addEdge=function(e){this.get("edges").push(e)},a.prototype.lock=function(){this.set("locked",!0)},a.prototype.unlock=function(){this.set("locked",!1)},a.prototype.hasLocked=function(){return this.get("locked")},a.prototype.removeEdge=function(e){var i=this.getEdges(),s=i.indexOf(e);s>-1&&i.splice(s,1)},a.prototype.clearCache=function(){this.set(_s,null),this.set(Fo,null)},a.prototype.getUpdateType=function(e){var i,s,l,f,d;if(!!e){var v=!(0,k.isNil)(e.x),x=!(0,k.isNil)(e.y),w=Object.keys(e);if(w.length===1&&(v||x)||w.length===2&&v&&x)return"move";if((0,k.isNumber)(e.x)||(0,k.isNumber)(e.y)||e.type||e.anchorPoints||e.size||(e==null?void 0:e.style)&&(((i=e==null?void 0:e.style)===null||i===void 0?void 0:i.r)||((s=e==null?void 0:e.style)===null||s===void 0?void 0:s.width)||((l=e==null?void 0:e.style)===null||l===void 0?void 0:l.height)||((f=e==null?void 0:e.style)===null||f===void 0?void 0:f.rx)||((d=e==null?void 0:e.style)===null||d===void 0?void 0:d.ry)))return"bbox|label";var I=w.includes("label")||w.includes("labelCfg");return I?"style|label":"style"}},a.prototype.setState=function(e,i){var s=this;if(this.optimize){c.prototype.setState.call(this,e,i);return}this.runWithBBoxAffected(function(){return c.prototype.setState.call(s,e,i)})},a.prototype.clearStates=function(e){var i=this;if(this.optimize){c.prototype.clearStates.call(this,e);return}this.runWithBBoxAffected(function(){return c.prototype.clearStates.call(i,e)})},a.prototype.runWithBBoxAffected=function(e){var i=["r","width","height","rx","ry","lineWidth"],s=this.getKeyShape().attr(),l={};Object.keys(this.getKeyShape().attr()).forEach(function(x){i.includes(x)&&(l[x]=s[x])}),e();for(var f=this.getKeyShape().attr(),d=0;d<i.length;d++){var v=i[d];if(f[v]!==l[v]){this.clearCache(),this.getEdges().forEach(function(x){return x.refresh()});break}}},a}(Li),Co=Eo,ws="bboxCache",rs="bboxCanvasCache",$u="sizeCache",Bo="anchorPointsCache",ts=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultCfg=function(){return{type:"combo",nodes:[],edges:[],combos:[]}},a.prototype.getShapeCfg=function(e){var i=this.get("styles"),s=this.get("bbox");if(i&&s){var l=e,f=(0,k.isNumber)(e.size)?[e.size,e.size]:e.size,d=(0,k.isNumber)(e.fixSize)?[e.fixSize,e.fixSize]:e.fixSize,v=f||d||Fe.defaultCombo.size,x={r:(Math.max(s.width,s.height)||Math.max(v[0],v[1]))/2,width:s.width||v[0],height:s.height||v[1]};l.style=(0,P.__assign)((0,P.__assign)((0,P.__assign)({},i),e.style),x);var w=e.padding||Fe.defaultCombo.padding;return(0,k.isNumber)(w)?(x.r+=w,x.width+=w*2,x.height+=w*2):(x.r=x.r+Math.max.apply(Math,w),x.width+=w[1]+w[3]||w[1]*2,x.height+=w[0]+w[2]||w[0]*2),this.set($u,x),l}return e},a.prototype.calculateCanvasBBox=function(){if(!this.destroyed){var e=this.get("keyShape"),i=this.get("group"),s=Oa(e,i);s.centerX=(s.minX+s.maxX)/2,s.centerY=(s.minY+s.maxY)/2;var l=this.get(ws)||{},f=l.x,d=l.x;return s.width=s.maxX-s.minX,s.height=s.maxY-s.minY,s.centerX=(s.minX+s.maxX)/2,s.centerY=(s.minY+s.maxY)/2,s.x=s.minX,s.y=s.minY,(s.x!==f||s.y!==d)&&this.set(Bo,null),s}},a.prototype.getChildren=function(){var e=this;return{nodes:e.getNodes(),combos:e.getCombos()}},a.prototype.getNodes=function(){var e=this;return e.get("nodes")},a.prototype.getCombos=function(){var e=this;return e.get("combos")},a.prototype.addChild=function(e){var i=this,s=e.getType();switch(s){case"node":i.addNode(e);break;case"combo":i.addCombo(e);break;default:return console.warn("Only node or combo items are allowed to be added into a combo"),!1}return!0},a.prototype.addCombo=function(e){var i=this;return i.get("combos").push(e),!0},a.prototype.addNode=function(e){var i=this;return i.get("nodes").push(e),!0},a.prototype.removeChild=function(e){var i=this,s=e.getType();switch(s){case"node":i.removeNode(e);break;case"combo":i.removeCombo(e);break;default:return console.warn("Only node or combo items are allowed to be added into a combo"),!1}return!0},a.prototype.removeCombo=function(e){if(!!e){var i=this.getCombos(),s=i.indexOf(e);return s>-1?(i.splice(s,1),!0):!1}},a.prototype.removeNode=function(e){if(!!e){var i=this.getNodes(),s=i.indexOf(e);return s>-1?(i.splice(s,1),!0):!1}},a.prototype.getUpdateType=function(e){},a.prototype.getBBox=function(){this.set(rs,null);var e=this.calculateCanvasBBox();return e},a.prototype.clearCache=function(){this.set(ws,null),this.set(rs,null),this.set(Bo,null)},a.prototype.destroy=function(){if(!this.destroyed){var e=this.get("animate"),i=this.get("group");e&&i.stopAnimate(),i.shapeMap={},this.clearCache(),this.set($u,null),this.set("bbox",null),i.remove(),this._cfg=null,this.destroyed=!0}},a}(Co),hu=ts,eu="node",Nl="edge",Gu="vedge",nu="combo",kl="default",cu="Mapper",Hs="stateStyles",Ru=function(){function c(a){var e=this;this.edgeToBeUpdateMap={},this.throttleRefresh=(0,k.throttle)(function(i){var s=e.graph;if(!(!s||s.get("destroyed"))){var l=e.edgeToBeUpdateMap;if(!!l){var f=Object.values(l);!f.length||(f.forEach(function(d){var v=d.edge;if(!(!v||v.destroyed)){var x=v.getSource(),w=v.getTarget();!x||x.destroyed||!w||w.destroyed||v.refresh(d.updateType)}}),e.edgeToBeUpdateMap={})}}},16,{trailing:!0,leading:!0}),this.graph=a,this.destroyed=!1}return c.prototype.addItem=function(a,e){var i=this.graph,s=a===Gu?Nl:a,l=i.get("".concat(s,"Group"))||i.get("group"),f=(0,k.upperFirst)(s),d=null,v=i.get(s+(0,k.upperFirst)(Hs))||{},x=i.get(kl+f);e[Hs]&&(v=e[Hs]),x&&(0,k.each)(x,function(je,ze){(0,k.isObject)(je)&&!(0,k.isArray)(je)?e[ze]=(0,k.deepMix)({},je,e[ze]):(0,k.isArray)(je)?e[ze]=e[ze]||(0,k.clone)(x[ze]):e[ze]=e[ze]||x[ze]});var w=i.get(s+cu);if(w){var I=w(e);I[Hs]&&(v=I[Hs],delete I[Hs]),(0,k.each)(I,function(je,ze){(0,k.isObject)(je)&&!(0,k.isArray)(je)?e[ze]=(0,k.deepMix)({},e[ze],je):e[ze]=I[ze]||e[ze]})}if(i.emit("beforeadditem",{type:a,model:e}),a===Nl||a===Gu){var G=void 0,U=void 0;if(G=e.source,U=e.target,G&&(0,k.isString)(G)&&(G=i.findById(G)),U&&(0,k.isString)(U)&&(U=i.findById(U)),!G||!U){console.warn("The source or target node of edge ".concat(e.id," does not exist!"));return}G.getType&&G.getType()==="combo"&&(e.isComboEdge=!0),U.getType&&U.getType()==="combo"&&(e.isComboEdge=!0),d=new Po({model:e,source:G,target:U,styles:v,linkCenter:i.get("linkCenter"),group:l.addGroup()})}else if(a===eu)d=new Co({model:e,styles:v,group:l.addGroup()});else if(a===nu){var et=e.children,ft=su(et,i),Ct=void 0,Mt=void 0;if(isNaN(ft.x)?isNaN(e.x)&&(Ct=Math.random()*100):Ct=ft.x,isNaN(ft.y)?isNaN(e.y)&&(Mt=Math.random()*100):Mt=ft.y,isNaN(e.x)||isNaN(e.y))e.x=Ct,e.y=Mt;else{var kt=e.x-Ct,$t=e.y-Mt;this.updateComboSucceeds(e.id,kt,$t,et)}var Jt=l.addGroup();Jt.setZIndex(e.depth),d=new hu({model:e,styles:v,animate:i.get("animate"),bbox:e.collapsed?su([],i):ft,group:Jt}),!e.collapsed&&d.getKeyShape().get("type")==="circle"&&(ft.width=Math.hypot(ft.height,ft.width),ft.height=ft.width,d.set("bbox",ft),d.refresh());var Ce=d.getModel();(et||[]).forEach(function(je){var ze=i.findById(je.id);d.addChild(ze),je.depth=Ce.depth+2})}if(d)return d.setOptimize(i.getNodes().length>i.get("optimizeThreshold")),i.get("".concat(a,"s")).push(d),i.get("itemMap")[d.get("id")]=d,i.emit("afteradditem",{item:d,model:e}),d},c.prototype.updateItem=function(a,e){var i=this,s,l,f=this.graph;if((0,k.isString)(a)&&(a=f.findById(a)),!(!a||a.destroyed)){var d="";a.getType&&(d=a.getType());var v=f.get(d+cu),x=a.getModel(),w=x.x,I=x.y,G=a.getUpdateType(e);if(v){var U=(0,k.deepMix)({},x,e),et=v(U),ft=(0,k.deepMix)({},x,et,e);et[Hs]&&(a.set("styles",ft[Hs]),delete ft[Hs]),(0,k.each)(ft,function(Tn,cr){e[cr]=Tn})}else(0,k.each)(e,function(Tn,cr){x[cr]&&(0,k.isObject)(Tn)&&!(0,k.isArray)(Tn)&&(e[cr]=(0,P.__assign)((0,P.__assign)({},x[cr]),e[cr]))});if(f.emit("beforeupdateitem",{item:a,cfg:e}),d===Nl){if(e.source){var Ct=e.source;(0,k.isString)(Ct)&&(Ct=f.findById(Ct)),a.setSource(Ct)}if(e.target){var Mt=e.target;(0,k.isString)(Mt)&&(Mt=f.findById(Mt)),a.setTarget(Mt)}a.update(e)}else if(d===eu){a.update(e,G);var kt=a.getEdges();G==="move"?(0,k.each)(kt,function(Tn){i.edgeToBeUpdateMap[Tn.getID()]={edge:Tn,updateType:G},i.throttleRefresh()}):(G==null?void 0:G.includes("bbox"))&&(0,k.each)(kt,function(Tn){Tn.refresh(G)})}else if(d===nu){if(a.update(e,G),!isNaN(e.x)||!isNaN(e.y)){var $t=e.x-w||0,Jt=e.y-I||0;this.updateComboSucceeds(x.id,$t,Jt)}var Ce=a.getEdges(),je=(G==null?void 0:G.includes("bbox"))||G==="move";if(je&&d===nu){var ze=a.get("shapeFactory"),pn=x.type||"circle",Fn=x.animate===void 0||e.animate===void 0?(l=(s=ze[pn])===null||s===void 0?void 0:s.options)===null||l===void 0?void 0:l.animate:x.animate||e.animate;Fn?setTimeout(function(){if(!(!a||a.destroyed)){var Tn=a.getKeyShape();!Tn||Tn.destroyed||(0,k.each)(Ce,function(cr){cr&&!cr.destroyed&&cr.refresh()})}},201):(0,k.each)(Ce,function(Tn){Tn.refresh()})}}a.setOptimize(f.getNodes().length>f.get("optimizeThreshold")),f.emit("afterupdateitem",{item:a,cfg:e})}},c.prototype.updateCombo=function(a,e,i){var s=this,l,f,d=this.graph;if((0,k.isString)(a)&&(a=d.findById(a)),!(!a||a.destroyed)){var v=a.getModel(),x=su(e,d,a),w=x.x,I=x.y;a.set("bbox",x);var G=w,U=I;i?(G=isNaN(v.x)?w:v.x,U=isNaN(v.y)?I:v.y):(G=isNaN(w)?v.x:w,U=isNaN(I)?v.y:I),a.update({x:G,y:U});var et=a.get("shapeFactory"),ft=v.type||"circle",Ct=v.animate===void 0?(f=(l=et[ft])===null||l===void 0?void 0:l.options)===null||f===void 0?void 0:f.animate:v.animate;Ct?setTimeout(function(){if(!(!a||a.destroyed)){var Mt=a.getKeyShape();!Mt||Mt.destroyed||(a.getShapeCfg(v),s.updateComboEdges(a))}},201):this.updateComboEdges(a)}},c.prototype.updateComboEdges=function(a){for(var e,i,s=a.getEdges()||[],l=0;l<s.length;l++){var f=s[l];!(f==null?void 0:f.destroyed)&&!((e=f==null?void 0:f.getSource())===null||e===void 0?void 0:e.destroyed)&&!((i=f==null?void 0:f.getTarget())===null||i===void 0?void 0:i.destroyed)&&f.refresh()}},c.prototype.collapseCombo=function(a,e){e===void 0&&(e=!0);var i=this.graph;(0,k.isString)(a)&&(a=i.findById(a));var s=a.getChildren();s.nodes.forEach(function(l){i.hideItem(l,e)}),s.combos.forEach(function(l){i.hideItem(l,e)})},c.prototype.updateComboSucceeds=function(a,e,i,s){var l=this;s===void 0&&(s=[]);var f=this.graph;if(!(!e&&!i)){var d=s;if(!(d==null?void 0:d.length)){var v=f.get("comboTrees");v==null||v.forEach(function(x){wo(x,function(w){return w.id===a?(d=w.children,!1):!0})})}d==null||d.forEach(function(x){var w=f.findById(x.id);if(w){var I=w.getModel();l.updateItem(x.id,{x:(I.x||0)+e,y:(I.y||0)+i})}})}},c.prototype.expandCombo=function(a,e){e===void 0&&(e=!0);var i=this.graph;(0,k.isString)(a)&&(a=i.findById(a));var s=a.getChildren(),l=new Set;s.nodes.forEach(function(f){i.showItem(f,e),f.getEdges().forEach(function(d){return l.add(d)})}),s.combos.forEach(function(f){f.getModel().collapsed?f.show():i.showItem(f,e),f.getEdges().forEach(function(d){return l.add(d)})}),l.forEach(function(f){return f.refresh()})},c.prototype.removeItem=function(a){var e=this,i=this.graph;if((0,k.isString)(a)&&(a=i.findById(a)),!(!a||a.destroyed)){var s=(0,k.clone)(a.getModel()),l="";a.getType&&(l=a.getType()),i.emit("beforeremoveitem",{item:s,type:l});var f=i.get("".concat(l,"s")),d=f.indexOf(a);if(d>-1&&f.splice(d,1),l===Nl){var v=i.get("v".concat(l,"s")),x=v.indexOf(a);x>-1&&v.splice(x,1)}var w=a.get("id"),I=i.get("itemMap");delete I[w];var G=i.get("comboTrees"),U=a.get("id");if(l===eu){var et=a.getModel().comboId;if(G&&et){var ft=G,Ct=!1;G.forEach(function(je){Ct||wo(je,function(ze){if(ze.id===U&&ft){var pn=ft.indexOf(ze);return ft.splice(pn,1),Ct=!0,!1}return ft=ze.children,!0})})}for(var Mt=a.getEdges(),kt=Mt.length-1;kt>=0;kt--)i.removeItem(Mt[kt],!1);et&&i.updateCombo(et)}else if(l===nu){var $t=a.getModel().parentId,Jt,Ce=!1;(G||[]).forEach(function(ze){Ce||wo(ze,function(pn){return pn.id===U?(Jt=pn,Ce=!0,!1):!0})}),Jt.removed=!0,Jt&&Jt.children&&Jt.children.forEach(function(ze){e.removeItem(ze.id)});for(var Mt=a.getEdges(),kt=Mt.length;kt>=0;kt--)i.removeItem(Mt[kt],!1);$t&&i.updateCombo($t)}a.destroy(),i.emit("afterremoveitem",{item:s,type:l})}},c.prototype.setItemState=function(a,e,i){var s=this.graph,l=e;(0,k.isString)(i)&&(l="".concat(e,":").concat(i)),!(a.hasState(l)===i&&i||(0,k.isString)(i)&&a.hasState(l))&&(s.emit("beforeitemstatechange",{item:a,state:l,enabled:i}),a.setState(e,i),s.autoPaint(),s.emit("afteritemstatechange",{item:a,state:l,enabled:i}))},c.prototype.priorityState=function(a,e){var i=this.graph,s=a;(0,k.isString)(a)&&(s=i.findById(a)),this.setItemState(s,e,!1),this.setItemState(s,e,!0)},c.prototype.clearItemStates=function(a,e){var i=this.graph;(0,k.isString)(a)&&(a=i.findById(a)),i.emit("beforeitemstatesclear",{item:a,states:e}),a.clearStates(e),i.emit("afteritemstatesclear",{item:a,states:e})},c.prototype.refreshItem=function(a){var e=this.graph;(0,k.isString)(a)&&(a=e.findById(a)),e.emit("beforeitemrefresh",{item:a}),a.refresh(),e.emit("afteritemrefresh",{item:a})},c.prototype.addCombos=function(a,e){var i=this,s=this.graph;(a||[]).forEach(function(f){ho(f,function(d){var v;return e.forEach(function(x){x.id===d.id&&(x.children=d.children,x.depth=d.depth,v=x)}),v&&i.addItem("combo",v),!0})});var l=s.get("comboGroup");l&&l.sort()},c.prototype.changeItemVisibility=function(a,e){var i=this,s=this.graph;if((0,k.isString)(a)&&(a=s.findById(a)),!a){console.warn("The item to be shown or hidden does not exist!");return}if(s.emit("beforeitemvisibilitychange",{item:a,visible:e}),a.changeVisibility(e),a.getType&&a.getType()===eu){var l=a.getEdges();(0,k.each)(l,function(w){e&&!(w.get("source").isVisible()&&w.get("target").isVisible())||i.changeItemVisibility(w,e)})}else if(a.getType&&a.getType()===nu){var f=s.get("comboTrees"),d=a.get("id"),v=[],x=!1;(f||[]).forEach(function(I){x||!I.children||I.children.length===0||wo(I,function(G){return G.id===d?(v=G.children,x=!0,!1):!0})}),v&&(!e||e&&!a.getModel().collapsed)&&v.forEach(function(I){var G=s.findById(I.id);i.changeItemVisibility(G,e)});var l=a.getEdges();(0,k.each)(l,function(I){e&&!(I.get("source").isVisible()&&I.get("target").isVisible())||i.changeItemVisibility(I,e)})}return s.emit("afteritemvisibilitychange",{item:a,visible:e}),a},c.prototype.destroy=function(){this.graph=null,this.destroyed=!0},c}(),ih=Ru,Zh=function(){function c(a){this.graph=a,this.destroyed=!1}return c.prototype.updateState=function(a,e,i){var s=this.graph.get("states"),l=e;(0,k.isString)(i)&&(l="".concat(e,":").concat(i)),s[l]||(s[l]=[]),i?s[l].push(a):s[l]=s[l].filter(function(f){return f!==a}),this.graph.set("states",s),this.graph.emit("graphstatechange",{states:s})},c.prototype.updateStates=function(a,e,i){var s=this.graph.get("states"),l=(0,k.isString)(e)?[e]:e;l.forEach(function(f){var d=f;s[d]||(s[d]=[]),(0,k.isString)(i)&&(d="".concat(f,":").concat(i)),i?s[d].push(a):s[d]=s[d].filter(function(v){return v!==a})}),this.graph.set("states",s),this.graph.emit("graphstatechange",{states:e})},c.prototype.destroy=function(){this.graph=null,this.destroyed=!0},c}(),qc=Zh,Bc=function(a,e){return!a||!e?a:a.replace(/\\?\{([^{}]+)\}/g,function(i,s){if(i.charAt(0)==="\\")return i.slice(1);var l=e[s];return l===0&&(l="0"),l||""})},kp=function(a){var e=[];if(a.length<2)throw new Error("point length must largn than 2, now it's ".concat(a.length));for(var i=0,s=a;i<s.length;i++){var l=s[i],f=l.x,d=l.y;e.push(f),e.push(d)}var v=Jr(e);return v.unshift(["M",a[0].x,a[0].y]),v},qh=function(a,e,i,s){i===void 0&&(i=0),s===void 0&&(s=0);var l={x:(1-i)*a.x+i*e.x,y:(1-i)*a.y+i*e.y},f=[0,0];Bi.normalize(f,[e.x-a.x,e.y-a.y]),(!f||!f[0]&&!f[1])&&(f=[0,0]);var d=[-f[1]*s,f[0]*s];return l.x+=d[0],l.y+=d[1],l},W0=function(a,e){var i=a.length;if(!i)return"";for(var s="",l="",f=0;f<i;f++){var d=a[f];f===0?l="M{x} {y}":l="L{x} {y}",s+=Bc(l,d)}return e&&(s+="Z"),s},Cg=function(a){var e=[];return a.forEach(function(i){var s=i[0];if(s!=="A")for(var l=1;l<i.length;l=l+2)e.push([i[l],i[l+1]]);else{var f=i.length;e.push([i[f-2],i[f-1]])}}),e},Wm=function(a){if(a.length<2)throw new Error("point length must largn than 2, now it's ".concat(a.length));var e=a[0],i=a[1],s=a[a.length-1],l=a[a.length-2];a.unshift(s),a.unshift(l),a.push(e),a.push(i);for(var f=[],d=1;d<a.length-2;d+=1){var v=a[d-1].x,x=a[d-1].y,w=a[d].x,I=a[d].y,G=a[d+1].x,U=a[d+1].y,et=d!==a.length-2?a[d+2].x:G,ft=d!==a.length-2?a[d+2].y:U,Ct=w+(G-v)/6,Mt=I+(U-x)/6,kt=G-(et-w)/6,$t=U-(ft-I)/6;f.push(["C",Ct,Mt,kt,$t,G,U])}return f.unshift(["M",s.x,s.y]),f},Fv=function(a,e){return Bi.scale([0,0],Bi.normalize([0,0],a),e)},om=function(a,e){var i=[a[1]-e[1],e[0]-a[0]],s=Math.sqrt(i[0]*i[0]+i[1]*i[1]);if(s===0)throw new Error("p0 should not be equal to p1");return[i[0]/s,i[1]/s]},dv=function(a,e){return[e[0]-a[0],e[1]-a[1]]};function sm(c,a){var e=function(I){var G=[I[0][0],I[0][1]-a],U=[I[0][0],I[0][1]+a];return"M ".concat(G," A ").concat(a,",").concat(a,",0,0,0,").concat(U," A ").concat(a,",").concat(a,",0,0,0,").concat(G)},i=function(I){var G=Bi.scale([0,0],om(I[0],I[1]),a),U=Bi.scale([0,0],G,-1),et=Bi.add([0,0],I[0],G),ft=Bi.add([0,0],I[1],G),Ct=Bi.add([0,0],I[1],U),Mt=Bi.add([0,0],I[0],U);return"M ".concat(et," L ").concat(ft," A ").concat([a,a,"0,0,0",Ct].join(",")," L ").concat(Mt," A ").concat([a,a,"0,0,0",et].join(","))};if(!c||c.length<1)return"";if(c.length===1)return e(c);if(c.length===2)return i(c);for(var s=new Array(c.length),l=0;l<s.length;++l){var f=l===0?c[c.length-1]:c[l-1],d=c[l],v=Bi.scale([0,0],om(f,d),a);s[l]=[Bi.add([0,0],f,v),Bi.add([0,0],d,v)]}var x="A ".concat([a,a,"0,0,0,"].join(","));return s=s.map(function(w,I){var G="";return I===0&&(G="M ".concat(s[s.length-1][1]," ")),G+="".concat(x+w[0]," L ").concat(w[1]),G}),s.join(" ")}function um(c,a){var e=c.length,i=function(w){var I=[w[0][0],w[0][1]-a],G=[w[0][0],w[0][1]+a];return"M ".concat(I," A ").concat([a,a,"0,0,0",G].join(",")," A ").concat([a,a,"0,0,0",I].join(","))},s=function(w){var I=dv(w[0],w[1]),G=Fv(I,a),U=Bi.add([0,0],w[0],Bi.scale([0,0],G,-1)),et=Bi.add([0,0],w[1],G),ft=1.2*a,Ct=Fv(Bi.normalize([0,0],I),ft),Mt=Bi.scale([0,0],Ct,-1),kt=Bi.add([0,0],U,Mt),$t=Bi.add([0,0],et,Mt),Jt=Bi.add([0,0],U,Ct);return"M ".concat(U," C ").concat([kt,$t,et].join(",")," S ").concat([Jt,U].join(",")," Z")};if(!c||e<1)return"";if(e===1)return i(c);if(e===2)return s(c);for(var l=c.map(function(x,w){var I=c[(w+1)%e];return{p:x,v:Bi.normalize([0,0],dv(x,I))}}),f=0;f<l.length;++f){var d=f>0?f-1:e-1,v=Bi.normalize([0,0],Bi.add([0,0],l[d].v,Bi.scale([0,0],l[f].v,-1)));l[f].p=Bi.add([0,0],l[f].p,Bi.scale([0,0],v,a))}return l.map(function(x){var w=x.p;return{x:w[0],y:w[1]}})}var D1=function(a,e){for(var i=[],s=0;s<5;s++){var l=Math.cos((18+72*s)/180*Math.PI)*a,f=Math.sin((18+72*s)/180*Math.PI)*a,d=Math.cos((54+72*s)/180*Math.PI)*e,v=Math.sin((54+72*s)/180*Math.PI)*e;s===0?i.push(["M",l,-f]):i.push(["L",l,-f]),i.push(["L",d,-v])}return i.push(["Z"]),i},lm=function(a,e,i){return(a.y-i.y)*(e.x-i.x)-(a.x-i.x)*(e.y-i.y)},V0=function(a){var e=a.map(function(I){return{x:I.getModel().x,y:I.getModel().y}});e.sort(function(I,G){return I.x===G.x?I.y-G.y:I.x-G.x});for(var i={},s=e.length-1;s>=0;s--){var l=e[s],f=l.x,d=l.y;i["".concat(f,"-").concat(d)]&&e.splice(s,1),i["".concat(f,"-").concat(d)]=!0}if(e.length===1)return e;for(var v=[],s=0;s<e.length;s++){for(;v.length>=2&&lm(v[v.length-2],v[v.length-1],e[s])<=0;)v.pop();v.push(e[s])}for(var x=[],s=e.length-1;s>=0;s--){for(;x.length>=2&&lm(x[x.length-2],x[x.length-1],e[s])<=0;)x.pop();x.push(e[s])}x.pop(),v.pop();var w=v.concat(x);return w},bd={maxRoutingIterations:100,maxMarchingIterations:100,pixelGroupSize:2,edgeR0:10,edgeR1:10,nodeR0:5,nodeR1:10,morphBuffer:5,threshold:.001,skip:16,nodeInfluenceFactor:1,edgeInfluenceFactor:1,negativeNodeInfluenceFactor:-.5};function Ul(c,a,e){var i=!1,s=function(v,x){return a.cells[v+x*a.width]},l=function(v,x){var w=0;return s(v-1,x-1)>=e&&(w+=1),s(v,x-1)>e&&(w+=2),s(v-1,x)>e&&(w+=4),s(v,x)>e&&(w+=8),w},f=function(v,x){for(var w=v,I=x,G,U,et=0;et<a.width*a.height;et++){if(G=w,U=I,c.findIndex(function(Ct){return Ct.x===w&&Ct.y===I})>-1){if(!(c[0].x!==w||c[0].y!==I))return!0}else c.push({x:w,y:I});var ft=l(w,I);switch(ft){case-1:return console.warn("Marched out of bounds"),!0;case 0:case 3:case 2:case 7:w++;break;case 12:case 14:case 4:w--;break;case 6:G===0&&(U===-1?w-=1:w+=1);break;case 1:case 13:case 5:I--;break;case 9:G===1&&(U===0?I-=1:I+=1);break;case 10:case 8:case 11:I++;break;default:return console.warn("Marching squares invalid state: ".concat(ft)),!0}}};this.march=function(){for(var d=0;d<a.width&&!i;d+=1)for(var v=0;v<a.height&&!i;v+=1)s(d,v)>e&&l(d,v)!==15&&(i=f(d,v));return i}}var Cl=function(a,e,i){var s=Math.ceil(a/i),l=Math.ceil(e/i),f=new Float32Array(Math.max(0,s*l)).fill(0);return{cells:f,width:s,height:l}},j0=function(a,e,i){var s=null,l=Number.POSITIVE_INFINITY;return e.forEach(function(f){var d={x:a.getModel().x,y:a.getModel().y},v={x:f.getModel().x,y:f.getModel().y},x=Wu(d,v),w=new Pu(d.x,d.y,v.x,v.y),I=i.reduce(function(G,U){return gu(U,w)>0?G+1:G},0);x*Math.pow(I+1,2)<l&&(s=f,l=x*Math.pow(I+1,2))}),s},_g=function(a,e){var i=Number.POSITIVE_INFINITY,s=null;return a.forEach(function(l){var f=gu(l,e);f>=0&&f<i&&(s=l,i=f)}),s},O1=function(a,e,i,s){var l=[],f=[];f.push(a);for(var d=!0,v=0,x=function(U,et){var ft=!1;return et.forEach(function(Ct){ft||(tu(U,{x:Ct.x1,y:Ct.y1})||tu(U,{x:Ct.x2,y:Ct.y2}))&&(ft=!0)}),ft},w=function(U,et){for(var ft=0,Ct=et;ft<Ct.length;ft++){var Mt=Ct[ft],kt=Mt.getBBox(),$t=[[kt.x,kt.y],[kt.x+kt.width,kt.y],[kt.x,kt.y+kt.height],[kt.x+kt.width,kt.y+kt.height]];if(bl($t,U.x,U.y))return!0}return!1};d&&v<i;){d=!1;for(var I=function(){var U=f.pop(),et=_g(e,U);if(et){var ft=Bs(et,U),Ct=ft[0],Mt=ft[1];if(Mt===2){var kt=function(Jt){for(var Ce=s,je=H0(et,Ce,Ct,Jt),ze=x(je,f)||x(je,l),pn=w(je,e);!ze&&pn&&Ce>=1;)Ce/=1.5,je=H0(et,Ce,Ct,Jt),ze=x(je,f)||x(je,l),pn=w(je,e);je&&!ze&&(!Jt||!pn)&&(f.push(new Pu(U.x1,U.y1,je.x,je.y)),f.push(new Pu(je.x,je.y,U.x2,U.y2)),d=!0)};kt(!0),d||kt(!1)}}d||l.push(U),v+=1};!d&&f.length;)I()}for(;f.length;)l.push(f.pop());return l};function cm(c,a,e,i,s){var l=j0(c,e,a);if(l===null)return[];var f=function(I){for(var G=[];I.length>0;){var U=I.pop();if(I.length===0){G.push(U);break}var et=I.pop(),ft=new Pu(U.x1,U.y1,et.x2,et.y2),Ct=_g(a,ft);Ct?(G.push(U),I.push(et)):I.push(ft)}return G},d=new Pu(c.getModel().x,c.getModel().y,l.getModel().x,l.getModel().y),v=O1(d,a,i,s),x=f(v);return x}var MS=function(a,e,i){var s=Object.assign(bd,i),l=Fu(a.map(function(kt){return{x:kt.getModel().x,y:kt.getModel().y}}));a=a.sort(function(kt,$t){return Wu({x:kt.getModel().x,y:kt.getModel().y},l)-Wu({x:$t.getModel().x,y:$t.getModel().y},l)});var f=[],d=[];a.forEach(function(kt){var $t=cm(kt,e,f,s.maxRoutingIterations,s.morphBuffer);$t.forEach(function(Jt){d.push(Jt)}),f.push(kt)});for(var v=fm(a,d,s.nodeR0),x=Cl(v.width,v.height,s.pixelGroupSize),w=[],I=[],G=0;G<s.maxMarchingIterations;G++)if(NS(a,e,d,v,x,s),w=[],I=[],!!new Ul(w,x,s.threshold).march()){var U=w.map(function(kt){return{x:Math.round(kt.x*s.pixelGroupSize+v.minX),y:Math.round(kt.y*s.pixelGroupSize+v.minY)}});if(U){var et=U.length;if(s.skip>1)for(et=Math.floor(U.length/s.skip);et<3&&s.skip>1;)s.skip-=1,et=Math.floor(U.length/s.skip);for(var ft=0,Ct=0;Ct<et;Ct+=1,ft+=s.skip)I.push({x:U[ft].x,y:U[ft].y})}var Mt=function(){for(var $t=0,Jt=a;$t<Jt.length;$t++){var Ce=Jt[$t],je=I.map(function(ze){return[ze.x,ze.y]});if(!bl(je,Ce.getBBox().centerX,Ce.getBBox().centerY))return!1}return!0};if(I&&Mt())return I;if(s.threshold*=.9,G<=s.maxMarchingIterations*.5)s.memberInfluenceFactor*=1.2,s.edgeInfluenceFactor*=1.2;else if(s.nonMemberInfluenceFactor!==0&&e.length>0)s.nonMemberInfluenceFactor*=.8;else break}return I};function fm(c,a,e){var i={minX:Number.POSITIVE_INFINITY,minY:Number.POSITIVE_INFINITY,maxX:Number.NEGATIVE_INFINITY,maxY:Number.NEGATIVE_INFINITY,width:0,height:0,x:0,y:0},s=[];c.forEach(function(v){s.push(v.getBBox())}),a.forEach(function(v){s.push(v.getBBox())});for(var l=0,f=s;l<f.length;l++){var d=f[l];i.minX=(d.minX<i.minX?d.minX:i.minX)-e,i.minY=(d.minY<i.minY?d.minY:i.minY)-e,i.maxX=(d.maxX>i.maxX?d.maxX:i.maxX)+e,i.maxY=(d.maxY>i.maxY?d.maxY:i.maxY)+e}return i.width=i.maxX-i.minX,i.height=i.maxY-i.minY,i.x=i.minX,i.y=i.minY,i}function NS(c,a,e,i,s,l){function f(U,et){var ft=Math.floor((U-et)/l.pixelGroupSize);return ft<0?0:ft}function d(U,et){return U*l.pixelGroupSize+et}var v=(l.nodeR0-l.nodeR1)*(l.nodeR0-l.nodeR1),x=(l.edgeR0-l.edgeR1)*(l.edgeR0-l.edgeR1),w=function(et,ft){var Ct=Math.min(f(et.minX,ft+i.minX),s.width),Mt=Math.min(f(et.minY,ft+i.minY),s.height),kt=Math.min(f(et.maxX,-ft+i.minX),s.width),$t=Math.min(f(et.maxY,-ft+i.minY),s.height);return[Ct,Mt,kt,$t]},I=function(et,ft){for(var Ct=et.getBBox(),Mt=w(Ct,l.nodeR1),kt=Mt[0],$t=Mt[1],Jt=Mt[2],Ce=Mt[3],je=$t;je<Ce;je+=1)for(var ze=kt;ze<Jt;ze+=1)if(!(ft<0&&s[ze+je*s.width]<=0)){var pn=d(ze,i.minX),Fn=d(je,i.minY),Tn=gc({x:pn,y:Fn},{x:Ct.minX,y:Ct.minY,width:Ct.width,height:Ct.height});if(Tn<Math.pow(l.nodeR1,2)){var cr=Math.sqrt(Tn)-l.nodeR1;s.cells[ze+je*s.width]+=ft*cr*cr}}},G=function(et,ft){for(var Ct=et.getBBox(),Mt=w(Ct,l.edgeR1),kt=Mt[0],$t=Mt[1],Jt=Mt[2],Ce=Mt[3],je=$t;je<Ce;je+=1)for(var ze=kt;ze<Jt;ze+=1)if(!(ft<0&&s.cells[ze+je*s.width]<=0)){var pn=d(ze,i.minX),Fn=d(je,i.minY),Tn=Ju({x:pn,y:Fn},et);if(Tn<Math.pow(l.edgeR1,2)){var cr=Math.sqrt(Tn)-l.edgeR1;s.cells[ze+je*s.width]+=ft*cr*cr}}};l.nodeInfluenceFactor&&c.forEach(function(U){I(U,l.nodeInfluenceFactor/v)}),l.edgeInfluenceFactor&&e.forEach(function(U){G(U,l.edgeInfluenceFactor/x)}),l.negativeNodeInfluenceFactor&&a.forEach(function(U){I(U,l.negativeNodeInfluenceFactor/v)})}function H0(c,a,e,i){var s=c.getBBox(),l=e[0],f=e[1],d=e[2],v=e[3],x={topLeft:{x:s.minX-a,y:s.minY-a},topRight:{x:s.maxX+a,y:s.minY-a},bottomLeft:{x:s.minX-a,y:s.maxY+a},bottomRight:{x:s.maxX+a,y:s.maxY+a}},w=s.height*s.width;function I(et,ft){return s.width*((et.y-s.minY+(ft.y-s.minY))*.5)}if(f){if(l)return i?x.topLeft:x.bottomRight;if(d)return i?x.bottomLeft:x.topRight;var G=I(f,v);return G<w*.5?f.y>v.y?i?x.topLeft:x.bottomRight:i?x.topRight:x.bottomLeft:f.y<v.y?i?x.bottomLeft:x.topRight:i?x.bottomRight:x.topLeft}if(v){if(l)return i?x.topRight:x.bottomLeft;if(d)return i?x.bottomRight:x.topLeft}var U=I(l,d);return U<w*.5?l.x>d.x?i?x.topLeft:x.bottomRight:i?x.bottomLeft:x.topRight:l.x<d.x?i?x.topRight:x.bottomLeft:i?x.bottomRight:x.topLeft}var kS=function(){function c(a,e){this.cfg=(0,k.deepMix)(this.getDefaultCfg(),e),this.graph=a,this.id=this.cfg.id,this.group=this.cfg.group,this.members=this.cfg.members.map(function(i){return(0,k.isString)(i)?a.findById(i):i}),this.nonMembers=this.cfg.nonMembers.map(function(i){return(0,k.isString)(i)?a.findById(i):i}),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()}return c.prototype.getDefaultCfg=function(){return{id:"g6-hull",type:"round-convex",members:[],nonMembers:[],style:{fill:"lightblue",stroke:"blue",opacity:.2},padding:10}},c.prototype.setPadding=function(){var a=this.members.length&&this.members[0].getKeyShape().getCanvasBBox().width/2;this.padding=this.cfg.padding>0?this.cfg.padding+a:10+a,this.cfg.bubbleCfg={nodeR0:this.padding-a,nodeR1:this.padding-a,morphBuffer:this.padding-a}},c.prototype.setType=function(){this.type=this.cfg.type,this.members.length<3&&(this.type="round-convex"),this.type!=="round-convex"&&this.type!=="smooth-convex"&&this.type!=="bubble"&&(console.warn("The hull type should be either round-convex, smooth-convex or bubble, round-convex is used by default."),this.type="round-convex")},c.prototype.calcPath=function(a,e){var i,s,l;switch(this.type){case"round-convex":i=V0(a),l=sm(i.map(function(f){return[f.x,f.y]}),this.padding),s=Pr(l);break;case"smooth-convex":i=V0(a),i.length===2?(l=sm(i.map(function(f){return[f.x,f.y]}),this.padding),s=Pr(l)):i.length>2&&(l=um(i.map(function(f){return[f.x,f.y]}),this.padding),s=Wm(l));break;case"bubble":i=MS(a,e,this.cfg.bubbleCfg),s=i.length>=2&&Wm(i);break;default:}return s},c.prototype.render=function(){this.group.addShape("path",{attrs:(0,P.__assign)({path:this.path},this.cfg.style),id:this.id,name:this.cfg.id,capture:!1}),this.group.toBack()},c.prototype.addMember=function(a){if(!!a){(0,k.isString)(a)&&(a=this.graph.findById(a)),this.members.push(a);var e=this.nonMembers.indexOf(a);return e>-1&&this.nonMembers.splice(e,1),this.updateData(this.members,this.nonMembers),!0}},c.prototype.addNonMember=function(a){if(!!a){(0,k.isString)(a)&&(a=this.graph.findById(a)),this.nonMembers.push(a);var e=this.members.indexOf(a);return e>-1&&this.members.splice(e,1),this.updateData(this.members,this.nonMembers),!0}},c.prototype.removeMember=function(a){if(!!a){(0,k.isString)(a)&&(a=this.graph.findById(a));var e=this.members.indexOf(a);return e>-1?(this.members.splice(e,1),this.updateData(this.members,this.nonMembers),!0):!1}},c.prototype.removeNonMember=function(a){if(!!a){(0,k.isString)(a)&&(a=this.graph.findById(a));var e=this.nonMembers.indexOf(a);return e>-1?(this.nonMembers.splice(e,1),this.updateData(this.members,this.nonMembers),!0):!1}},c.prototype.updateData=function(a,e){var i=this;this.group.findById(this.id).remove(),a&&(this.members=a.map(function(s){return(0,k.isString)(s)?i.graph.findById(s):s})),e&&(this.nonMembers=e.map(function(s){return(0,k.isString)(s)?i.graph.findById(s):s})),this.path=this.calcPath(this.members,this.nonMembers),this.render()},c.prototype.updateStyle=function(a){var e=this.group.findById(this.id);e.attr((0,P.__assign)({},a))},c.prototype.updateCfg=function(a){var e=this;this.cfg=(0,k.deepMix)(this.cfg,a),this.id=this.cfg.id,this.group=this.cfg.group,a.members&&(this.members=this.cfg.members.map(function(i){return(0,k.isString)(i)?e.graph.findById(i):i})),a.nonMembers&&(this.nonMembers=this.cfg.nonMembers.map(function(i){return(0,k.isString)(i)?e.graph.findById(i):i})),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()},c.prototype.contain=function(a){var e=this,i;(0,k.isString)(a)?i=this.graph.findById(a):i=a;var s,l=i.getKeyShape();if(i.get("type")==="path")s=Cg(l.attr("path"));else{var f=l.getCanvasBBox();s=[[f.minX,f.minY],[f.maxX,f.minY],[f.maxX,f.maxY],[f.minX,f.maxY]]}return s=s.map(function(d){var v=e.graph.getPointByCanvas(d[0],d[1]);return[v.x,v.y]}),Mu(s,Cg(this.path))},c.prototype.destroy=function(){this.group.remove(),this.cfg=null},c}(),Qh=kS,Vm=Le,xd="node",DS=function(c){(0,P.__extends)(a,c);function a(e){var i=c.call(this)||this;return i.sortCombos=(0,k.debounce)(function(){var s=i.get("comboSorted");if(!(!i||i.destroyed||s)){i.set("comboSorted",!0);var l=[],f={},d=i.get("comboTrees");(d||[]).forEach(function(x){wo(x,function(w){return l[w.depth]?l[w.depth].push(w.id):l[w.depth]=[w.id],f[w.id]=w.depth,!0})});var v=i.getEdges().concat(i.get("vedges"));(v||[]).forEach(function(x){var w=x.getModel(),I=f[w.source]||0,G=f[w.target]||0,U=Math.max(I,G);l[U]?l[U].push(w.id):l[U]=[w.id]}),l.forEach(function(x){if(!(!x||!x.length))for(var w=x.length-1;w>=0;w--){var I=i.findById(x[w]);I&&I.toFront()}})}},500,!1),i.cfg=(0,k.deepMix)(i.getDefaultCfg(),e),i.init(),i.animating=!1,i.destroyed=!1,i.cfg.enabledStack&&(i.undoStack=new Du(i.cfg.maxStep),i.redoStack=new Du(i.cfg.maxStep)),i}return a.prototype.init=function(){this.initCanvas();var e=new Ht(this),i=new Sf(this),s=new ih(this),l=new qc(this);this.set({viewController:e,modeController:i,itemController:s,stateController:l}),this.initLayoutController(),this.initEventController(),this.initGroups(),this.initPlugins()},a.prototype.initGroups=function(){var e=this.get("canvas");if(!!e){var i=e.get("el"),s=(i||{}).id,l=s===void 0?"g6":s,f=e.addGroup({id:"".concat(l,"-root"),className:Fe.rootContainerClassName});if(this.get("groupByTypes")){var d=f.addGroup({id:"".concat(l,"-edge"),className:Fe.edgeContainerClassName}),v=f.addGroup({id:"".concat(l,"-node"),className:Fe.nodeContainerClassName}),x=f.addGroup({id:"".concat(l,"-combo"),className:Fe.comboContainerClassName});x.toBack(),this.set({nodeGroup:v,edgeGroup:d,comboGroup:x})}var w=f.addGroup({id:"".concat(l,"-delegate"),className:Fe.delegateContainerClassName});this.set({delegateGroup:w}),this.set("group",f)}},a.prototype.getDefaultCfg=function(){return{container:void 0,width:void 0,height:void 0,renderer:"canvas",modes:{},plugins:[],data:{},fitViewPadding:10,minZoom:.02,maxZoom:10,event:!0,groupByTypes:!0,directed:!1,autoPaint:!0,nodes:[],edges:[],combos:[],vedges:[],itemMap:{},linkCenter:!1,defaultNode:{},defaultEdge:{},nodeStateStyles:{},edgeStateStyles:{},states:{},animate:!1,animateCfg:{onFrame:void 0,duration:500,easing:"easeLinear"},callback:void 0,enabledStack:!1,maxStep:10,tooltips:[],optimizeThreshold:1e3}},a.prototype.set=function(e,i){return(0,k.isPlainObject)(e)?this.cfg=(0,P.__assign)((0,P.__assign)({},this.cfg),e):this.cfg[e]=i,e==="enabledStack"&&i&&!this.undoStack&&!this.redoStack&&(this.undoStack=new Du(this.cfg.maxStep),this.redoStack=new Du(this.cfg.maxStep)),this},a.prototype.get=function(e){var i;return(i=this.cfg)===null||i===void 0?void 0:i[e]},a.prototype.getGroup=function(){return this.get("group")},a.prototype.getContainer=function(){return this.get("container")},a.prototype.getMinZoom=function(){return this.get("minZoom")},a.prototype.setMinZoom=function(e){return this.set("minZoom",e)},a.prototype.getMaxZoom=function(){return this.get("maxZoom")},a.prototype.setMaxZoom=function(e){return this.set("maxZoom",e)},a.prototype.getWidth=function(){return this.get("width")},a.prototype.getHeight=function(){return this.get("height")},a.prototype.clearItemStates=function(e,i){(0,k.isString)(e)&&(e=this.findById(e));var s=this.get("itemController");i||(i=e.get("states")),s.clearItemStates(e,i);var l=this.get("stateController");l.updateStates(e,i,!1)},a.prototype.node=function(e){typeof e=="function"&&this.set("nodeMapper",e)},a.prototype.edge=function(e){typeof e=="function"&&this.set("edgeMapper",e)},a.prototype.combo=function(e){typeof e=="function"&&this.set("comboMapper",e)},a.prototype.findById=function(e){return this.get("itemMap")[e]},a.prototype.find=function(e,i){var s,l=this.get("".concat(e,"s"));return(0,k.each)(l,function(f,d){if(i(f,d))return s=f,s}),s},a.prototype.findAll=function(e,i){var s=[];return(0,k.each)(this.get("".concat(e,"s")),function(l,f){i(l,f)&&s.push(l)}),s},a.prototype.findAllByState=function(e,i,s){return s?this.findAll(e,function(l){return l.hasState(i)&&s(l)}):this.findAll(e,function(l){return l.hasState(i)})},a.prototype.translate=function(e,i,s,l){var f=this,d=this.get("group"),v=(0,k.clone)(d.getMatrix());if(v||(v=[1,0,0,0,1,0,0,0,1]),s){var x=Ll({animateCfg:l,callback:function(){return f.emit("viewportchange",{action:"translate",matrix:d.getMatrix()})}});fo(d,{x:d.getCanvasBBox().x+e,y:d.getCanvasBBox().y+i},s,x||{duration:500,easing:"easeCubic"})}else v=Vm(v,[["t",e,i]]),d.setMatrix(v),this.emit("viewportchange",{action:"translate",matrix:v}),this.autoPaint()},a.prototype.moveTo=function(e,i,s,l){var f=this.get("group");fo(f,{x:e,y:i},s,l||{duration:500,easing:"easeCubic"}),this.emit("viewportchange",{action:"move",matrix:f.getMatrix()})},a.prototype.fitView=function(e,i,s,l){e&&this.set("fitViewPadding",e);var f=this.get("viewController");i?f.fitViewByRules(i,s,l):f.fitView(s,l),this.autoPaint()},a.prototype.fitCenter=function(e,i){var s=this.get("viewController");s.fitCenter(e,i),this.autoPaint()},a.prototype.addBehaviors=function(e,i){var s=this.get("modeController");return s.manipulateBehaviors(e,i,!0),this},a.prototype.removeBehaviors=function(e,i){var s=this.get("modeController");return s.manipulateBehaviors(e,i,!1),this},a.prototype.updateBehavior=function(e,i,s){var l=this.get("modeController");return l.updateBehavior(e,i,s),this},a.prototype.zoom=function(e,i,s,l){var f=this,d=this.get("group"),v=(0,k.clone)(d.getMatrix())||[1,0,0,0,1,0,0,0,1],x=this.get("minZoom"),w=this.get("maxZoom"),I=this.getZoom()||1,G=I*e,U=e,et=!1;if(x&&G<x?(U=x/I,et=!0):w&&G>w&&(U=w/I,et=!0),i?v=Vm(v,[["t",-i.x,-i.y],["s",U,U],["t",i.x,i.y]]):v=Vm(v,[["s",U,U]]),s){var ft=(0,k.clone)(d.getMatrix());ft||(ft=[1,0,0,0,1,0,0,0,1]);var Ct=ft[0],Mt=Ct*U,kt=Ll({animateCfg:l,callback:function(){return f.emit("viewportchange",{action:"zoom",matrix:d.getMatrix()})}});d.animate(function($t){if($t===1)ft=v;else{var Jt=vl(Ct,Mt,$t)/ft[0];i?ft=Vm(ft,[["t",-i.x,-i.y],["s",Jt,Jt],["t",i.x,i.y]]):ft=Vm(ft,[["s",Jt,Jt]])}return{matrix:ft}},kt)}else d.setMatrix(v),this.emit("viewportchange",{action:"zoom",matrix:v}),this.autoPaint();return!et},a.prototype.zoomTo=function(e,i,s,l){var f=e/this.getZoom();return this.zoom(f,i,s,l)},a.prototype.focusItem=function(e,i,s){var l=this.get("viewController"),f=!1;i?f=!0:i===void 0&&(f=this.get("animate"));var d={};s?d=s:s===void 0&&(d=this.get("animateCfg")),l.focus(e,f,d),this.autoPaint()},a.prototype.focusItems=function(e,i,s,l){var f=this.get("viewController");f.focusItems(e,i,s,l)},a.prototype.autoPaint=function(){this.get("autoPaint")&&this.paint()},a.prototype.paint=function(){this.emit("beforepaint"),this.get("canvas").draw(),this.emit("afterpaint")},a.prototype.getPointByClient=function(e,i){var s=this.get("viewController");return s.getPointByClient(e,i)},a.prototype.getClientByPoint=function(e,i){var s=this.get("viewController");return s.getClientByPoint(e,i)},a.prototype.getPointByCanvas=function(e,i){var s=this.get("viewController");return s.getPointByCanvas(e,i)},a.prototype.getCanvasByPoint=function(e,i){var s=this.get("viewController");return s.getCanvasByPoint(e,i)},a.prototype.getGraphCenterPoint=function(){var e=this.get("group").getCanvasBBox();return{x:(e.minX+e.maxX)/2,y:(e.minY+e.maxY)/2}},a.prototype.getViewPortCenterPoint=function(){return this.getPointByCanvas(this.get("width")/2,this.get("height")/2)},a.prototype.showItem=function(e,i){i===void 0&&(i=!0);var s=this.get("itemController"),l=s.changeItemVisibility(e,!0);if(i&&this.get("enabledStack")){var f=l.getID(),d=l.getType(),v={},x={};switch(d){case"node":v.nodes=[{id:f,visible:!1}],x.nodes=[{id:f,visible:!0}];break;case"edge":v.nodes=[{id:f,visible:!1}],x.edges=[{id:f,visible:!0}];break;case"combo":v.nodes=[{id:f,visible:!1}],x.combos=[{id:f,visible:!0}];break;default:break}this.pushStack("visible",{before:v,after:x})}},a.prototype.hideItem=function(e,i){i===void 0&&(i=!0);var s=this.get("itemController"),l=s.changeItemVisibility(e,!1);if(i&&this.get("enabledStack")){var f=l.getID(),d=l.getType(),v={},x={};switch(d){case"node":v.nodes=[{id:f,visible:!0}],x.nodes=[{id:f,visible:!1}];break;case"edge":v.nodes=[{id:f,visible:!0}],x.edges=[{id:f,visible:!1}];break;case"combo":v.nodes=[{id:f,visible:!0}],x.combos=[{id:f,visible:!1}];break;default:break}this.pushStack("visible",{before:v,after:x})}},a.prototype.refreshItem=function(e){var i=this.get("itemController");i.refreshItem(e)},a.prototype.setAutoPaint=function(e){var i=this;i.set("autoPaint",e);var s=i.get("canvas");s.set("autoDraw",e)},a.prototype.remove=function(e,i){i===void 0&&(i=!0),this.removeItem(e,i)},a.prototype.removeItem=function(e,i){i===void 0&&(i=!0);var s=e;if((0,k.isString)(e)&&(s=this.findById(e)),!s&&(0,k.isString)(e))console.warn("The item ".concat(e," to be removed does not exist!"));else if(s){var l="";if(s.getType&&(l=s.getType()),i&&this.get("enabledStack")){var f=(0,P.__assign)((0,P.__assign)({},s.getModel()),{itemType:l}),d={};switch(l){case"node":{d.nodes=[f],d.edges=[];for(var v=s.getEdges(),x=v.length-1;x>=0;x--)d.edges.push((0,P.__assign)((0,P.__assign)({},v[x].getModel()),{itemType:"edge"}));break}case"edge":d.edges=[f];break;case"combo":d.combos=[f];break;default:break}this.pushStack("delete",{before:d,after:{}})}if(l==="node"){var w=s.getModel();w.comboId&&this.updateComboTree(s,void 0,!1)}var I=this.get("itemController");if(I.removeItem(s),l==="combo"){var G=Vs(this.get("comboTrees"));this.set("comboTrees",G)}}},a.prototype.innerAddItem=function(e,i,s){if(!rl(e,i))return!1;if(i.id&&this.findById(i.id)){console.warn("This item exists already. Be sure the id %c".concat(i.id,"%c is unique."),"font-size: 20px; color: red;","");return}var l,f=this.get("comboTrees")||[];if(e==="combo"){var d=this.get("itemMap"),v=!1;if(f.forEach(function(et){v||ho(et,function(ft){if(i.parentId===ft.id){v=!0;var Ct=(0,P.__assign)({id:i.id,depth:ft.depth+2},i);ft.children?ft.children.push(Ct):ft.children=[Ct],i.depth=Ct.depth,l=s.addItem(e,i)}var Mt=d[ft.id];return v&&Mt&&Mt.getType&&Mt.getType()==="combo"&&s.updateCombo(Mt,ft.children),!0})}),!v){var x=(0,P.__assign)({id:i.id,depth:0},i);i.depth=x.depth,f.push(x),l=s.addItem(e,i)}this.set("comboTrees",f),i.collapsed&&(this.collapseCombo(l,!1),this.updateCombo(l))}else if(e==="node"&&(0,k.isString)(i.comboId)&&f){var w=this.findById(i.comboId);w&&w.getType&&w.getType()!=="combo"&&console.warn("'".concat(i.comboId,"' is not a id of a combo in the graph, the node will be added without combo.")),l=s.addItem(e,i);var I=this.get("itemMap"),G=!1,U=!1;f.forEach(function(et){U||G||ho(et,function(ft){if(ft.id===i.id)return U=!0,!1;if(i.comboId===ft.id&&!U){G=!0;var Ct=(0,k.clone)(i);Ct.itemType="node",ft.children?ft.children.push(Ct):ft.children=[Ct],Ct.depth=ft.depth+1}return G&&I[ft.id].getType&&I[ft.id].getType()==="combo"&&s.updateCombo(I[ft.id],ft.children),!0})})}else l=s.addItem(e,i);if(e==="node"&&i.comboId||e==="combo"&&i.parentId){var w=this.findById(i.comboId||i.parentId);w&&w.getType&&w.getType()==="combo"&&w.addChild(l)}return l},a.prototype.addItem=function(e,i,s,l){s===void 0&&(s=!0),l===void 0&&(l=!0);var f=this.get("comboSorted");this.set("comboSorted",f&&!l);var d=this.get("itemController"),v=this.innerAddItem(e,i,d);if(v===!1||v===!0)return v;var x=this.get("combos");if(x&&x.length>0&&this.sortCombos(),this.autoPaint(),s&&this.get("enabledStack")){var w=(0,P.__assign)((0,P.__assign)({},v.getModel()),{itemType:e}),I={};switch(e){case"node":I.nodes=[w];break;case"edge":I.edges=[w];break;case"combo":I.combos=[w];break;default:break}this.pushStack("add",{before:{},after:I})}return v},a.prototype.addItems=function(e,i,s){e===void 0&&(e=[]),i===void 0&&(i=!0),s===void 0&&(s=!0);var l=this.get("comboSorted");this.set("comboSorted",l&&!s);for(var f=this.get("itemController"),d=[],v=0;v<e.length;v++){var x=e[v];x.type!=="edge"&&x.type!=="vedge"?d.push(this.innerAddItem(x.type,x.model,f)):d.push(void 0)}for(var v=0;v<e.length;v++){var x=e[v];(x.type==="edge"||x.type==="vedge")&&(d[v]=this.innerAddItem(x.type,x.model,f))}if(s){var w=this.get("combos");w&&w.length>0&&this.sortCombos()}if(this.autoPaint(),i&&this.get("enabledStack")){for(var I={nodes:[],edges:[],combos:[]},v=0;v<e.length;v++){var G=e[v].type,U=d[v];if(!!U&&U!==!0){var et=(0,P.__assign)((0,P.__assign)({},U.getModel()),{itemType:G});switch(G){case"node":I.nodes.push(et);break;case"edge":I.edges.push(et);break;case"combo":I.combos.push(et);break;default:break}}}this.pushStack("addItems",{before:{},after:I})}return d},a.prototype.add=function(e,i,s,l){return s===void 0&&(s=!0),l===void 0&&(l=!0),this.addItem(e,i,s,l)},a.prototype.updateItem=function(e,i,s){var l=this;s===void 0&&(s=!0);var f=this.get("itemController"),d;(0,k.isString)(e)?d=this.findById(e):d=e;var v=s&&this.get("enabledStack"),x;v&&(x=(0,k.clone)(d.getModel()));var w="";d.getType&&(w=d.getType());var I=(0,P.__spreadArray)([],d.getStates(),!0);if(w==="combo"&&(0,k.each)(I,function(ft){return l.setItemState(d,ft,!1)}),f.updateItem(d,i),w==="combo"&&(0,k.each)(I,function(ft){return l.setItemState(d,ft,!0)}),v){var G={nodes:[],edges:[],combos:[]},U={nodes:[],edges:[],combos:[]},et=(0,P.__assign)({id:x.id},i);switch(w){case"node":G.nodes.push(x),U.nodes.push(et);break;case"edge":G.edges.push(x),U.edges.push(et);break;case"combo":G.combos.push(x),U.combos.push(et);break;default:break}this.pushStack("update",{before:G,after:U})}},a.prototype.update=function(e,i,s){s===void 0&&(s=!0),this.updateItem(e,i,s)},a.prototype.setItemState=function(e,i,s){(0,k.isString)(e)&&(e=this.findById(e));var l=this.get("itemController");l.setItemState(e,i,s);var f=this.get("stateController");f.updateState(e,i,s)},a.prototype.priorityState=function(e,i){var s=this.get("itemController");s.priorityState(e,i)},a.prototype.data=function(e){nl(e),this.set("data",e)},a.prototype.render=function(){var e=this;this.set("comboSorted",!1);var i=this.get("data");if(this.get("enabledStack")&&this.clearStack(),!i)throw new Error("data must be defined first");var s=i.nodes,l=s===void 0?[]:s,f=i.edges,d=f===void 0?[]:f,v=i.combos,x=v===void 0?[]:v;if(this.clear(!0),this.emit("beforerender"),e.addItems(l.map(function(Ct){return{type:"node",model:Ct}}),!1,!1),(x==null?void 0:x.length)!==0){var w=As(x,l);this.set("comboTrees",w),e.addCombos(x)}e.addItems(d.map(function(Ct){return{type:"edge",model:Ct}}),!1,!1);var I=e.get("animate");(e.get("fitView")||e.get("fitCenter"))&&e.set("animate",!1);var G=e.get("layoutController");if(G){if(G.layout(U),this.destroyed)return}else U();function U(){(e.get("comboTrees")||[]).forEach(function(Ct){ho(Ct,function(Mt){var kt=e.findById(Mt.id);return kt.getType()==="combo"&&Mt.collapsed&&(e.collapseCombo(Mt.id,!1),e.updateCombo(kt)),!0})}),e.get("fitView")?e.fitView():e.get("fitCenter")&&e.fitCenter(),e.autoPaint(),e.emit("afterrender"),(e.get("fitView")||e.get("fitCenter"))&&e.set("animate",I),setTimeout(function(){var Ct;(Ct=e.getCombos())===null||Ct===void 0||Ct.forEach(function(Mt){Mt.set("animate",!0)})},0)}if(!this.get("groupByTypes"))if(x&&x.length!==0)this.sortCombos();else if(i.nodes&&i.edges&&i.nodes.length<i.edges.length){var et=this.getNodes();et.forEach(function(Ct){Ct.toFront()})}else{var ft=this.getEdges();ft.forEach(function(Ct){Ct.toBack()})}},a.prototype.read=function(e){this.data(e),this.render()},a.prototype.diffItems=function(e,i,s){var l=this,f,d=this.get("itemMap");(0,k.each)(s,function(v){if(f=d[v.id],f){if(l.get("animate")&&e===xd){var x=f.getContainer().getMatrix();x||(x=[1,0,0,0,1,0,0,0,1]),f.set("originAttrs",{x:x[6],y:x[7]})}l.updateItem(f,v,!1)}else f=l.addItem(e,v,!1);f&&i["".concat(e,"s")].push(f)})},a.prototype.changeData=function(e,i){var s=this,l;i===void 0&&(i=!0);var f=this,d=e||f.get("data");if(!nl(d))return this;this.emit("beforechangedata"),i&&this.get("enabledStack")&&this.pushStack("changedata",{before:f.save(),after:d}),this.set("comboSorted",!1),this.removeHulls(),this.getNodes().map(function(kt){return f.clearItemStates(kt)}),this.getEdges().map(function(kt){return f.clearItemStates(kt)});var v=this.get("canvas"),x=v.get("localRefresh");v.set("localRefresh",!1),f.get("data")||(f.data(d),f.render());var w=this.get("itemMap"),I={nodes:[],edges:[]},G=d.combos;if(G){var U=As(G,d.nodes);this.set("comboTrees",U)}else this.set("comboTrees",[]);this.diffItems("node",I,d.nodes),(0,k.each)(w,function(kt,$t){w[$t].getModel().depth=0,!(kt.getType&&kt.getType()==="edge")&&(kt.getType&&kt.getType()==="combo"?(delete w[$t],kt.destroy()):I.nodes.indexOf(kt)<0&&(delete w[$t],f.remove(kt,!1)))});for(var et=this.getCombos(),ft=et.length,Ct=ft-1;Ct>=0;Ct--)et[Ct].destroyed&&et.splice(Ct,1);G&&(f.addCombos(G),this.get("groupByTypes")||this.sortCombos()),this.diffItems("edge",I,d.edges),(0,k.each)(w,function(kt,$t){kt.getType&&(kt.getType()==="node"||kt.getType()==="combo")||I.edges.indexOf(kt)<0&&(delete w[$t],f.remove(kt,!1))}),(this.get("comboTrees")||[]).forEach(function(kt){ho(kt,function($t){var Jt=s.findById($t.id);return Jt.getType()==="combo"&&$t.collapsed&&s.collapseCombo($t.id,!1),!0})}),this.set({nodes:I.nodes,edges:I.edges});var Mt=this.get("layoutController");return Mt&&(Mt.changeData(function(){setTimeout(function(){var kt;(kt=f.getCombos())===null||kt===void 0||kt.forEach(function($t){$t.set("animate",!0)})},0)}),f.get("animate")&&!Mt.getLayoutType()?(f.positionsAnimate(),(l=f.getCombos())===null||l===void 0||l.forEach(function(kt){return kt.set("animate",!0)})):f.autoPaint()),setTimeout(function(){v.set("localRefresh",x)},16),this.set("data",d),this.emit("afterchangedata"),this},a.prototype.addCombos=function(e){var i=this,s=i.get("comboTrees"),l=this.get("itemController");l.addCombos(s,e)},a.prototype.createCombo=function(e,i,s){var l=this;s===void 0&&(s=!0);var f=this.get("itemController");this.set("comboSorted",!1);var d="",v;if(!!e){if((0,k.isString)(e))d=e,v={id:e};else{if(d=e.id,!d){console.warn("Create combo failed. Please assign a unique string id for the adding combo.");return}v=e}var x=s&&this.get("enabledStack"),w={nodes:[],combos:[]};x&&i.forEach(function(Mt){var kt=l.findById(Mt),$t=kt.getType();if(!($t!=="node"&&$t!=="combo")){var Jt=kt.getModel();w["".concat($t,"s")].push({id:Mt,parentId:$t==="node"?Jt.comboId:Jt.parentId})}});var I=this.get("comboTrees"),G=new Set(i),U=new Map;I&&(I.forEach(function(Mt){ho(Mt,function(kt,$t,Jt){if(G.has(kt.id)){if($t){var Ce=l.findById($t.id),je=l.findById(kt.id);$t.children.splice(Jt,1),Ce.removeChild(je),f.updateCombo(Ce,$t.children)}kt.itemType==="combo"&&U.set(kt.id,kt)}return!0})}),I=I.filter(function(Mt){return!G.has(Mt.id)}),this.set("comboTrees",I));var et={nodes:[],combos:[]},ft=i.map(function(Mt){var kt=l.findById(Mt),$t=kt.getModel(),Jt="";kt.getType&&(Jt=kt.getType());var Ce=U.get(Mt)||{id:kt.getID(),itemType:Jt};return Jt==="combo"?(Ce.parentId=d,$t.parentId=d):Jt==="node"&&(Ce.comboId=d,$t.comboId=d),x&&et["".concat(Jt,"s")].push({id:$t.id,parentId:d}),Ce});v.children=ft,this.addItem("combo",v,!1),this.set("comboSorted",!1),I&&(I.forEach(function(Mt){wo(Mt,function(kt){return kt.id===d?(kt.itemType="combo",kt.children=ft,!1):!0})}),this.sortCombos()),x&&(et.combos.push(v),this.pushStack("createCombo",{before:w,after:et}));var Ct=this.findById(d);!Ct.getModel().parentId&&Ct.getChildren().combos.length&&this.updateComboTree(Ct,void 0,!1),setTimeout(function(){Ct.set("animate",!0)},0)}},a.prototype.uncombo=function(e,i){var s=this,l,f;i===void 0&&(i=!0);var d=this,v=e;if((0,k.isString)(e)&&(v=this.findById(e)),!v||v.getType&&v.getType()!=="combo"){console.warn("The item is not a combo!");return}var x=v.getModel(),w=v.getModel().parentId,I=d.get("comboTrees");I||(I=[]);var G=this.get("itemMap"),U=v.get("id"),et,ft=[],Ct=this.get("combos"),Mt=this.findById(w),kt=i&&this.get("enabledStack"),$t={};if(kt&&($t=(0,k.clone)(x),$t.children=[]),I.forEach(function(ze){et||ho(ze,function(pn){var Fn;if(pn.id===U){et=pn;var Tn=v.getEdges().map(function(Aa){return Aa.getID()});Tn.forEach(function(Aa){s.removeItem(Aa,!1)});var cr=Ct.indexOf(v);Ct.splice(cr,1),delete G[U];var kr=(0,k.clone)(v.getModel());v.destroy(),s.emit("afterremoveitem",{item:kr,type:"combo"})}if(w&&et&&pn.id===w){Mt.removeCombo(v),ft=pn.children;var cr=ft.indexOf(et);return cr!==-1&&ft.splice(cr,1),(Fn=et.children)===null||Fn===void 0||Fn.forEach(function(ci){var ei=s.findById(ci.id),Ca=ei.getModel();ei.getType&&ei.getType()==="combo"?(ci.parentId=w,delete ci.comboId,Ca.parentId=w,delete Ca.comboId):ei.getType&&ei.getType()==="node"&&(ci.comboId=w,Ca.comboId=w),Mt.addChild(ei),ft.push(ci)}),s.updateCombo(Mt),!1}return!0})}),!w&&et){var Jt=I.indexOf(et);I.splice(Jt,1),(l=et.children)===null||l===void 0||l.forEach(function(ze){ze.parentId=void 0;var pn=s.findById(ze.id).getModel();delete pn.parentId,delete pn.comboId,ze.itemType!=="node"&&I.push(ze)})}if(kt){var Ce={nodes:[],combos:[]},je={nodes:[],combos:[]};(f=et.children)===null||f===void 0||f.forEach(function(ze){var pn=s.findById(ze.id),Fn=pn.getType();Fn!=="node"&&Fn!=="combo"||(Ce["".concat(Fn,"s")].push({id:ze.id,parentId:U}),je["".concat(Fn,"s")].push({id:ze.id,parentId:w}))}),Ce.combos.push($t),this.pushStack("uncombo",{before:Ce,after:je})}},a.prototype.updateCombos=function(e){var i=this;e===void 0&&(e=!1);var s=this,l=this.get("comboTrees"),f=s.get("itemController"),d=s.get("itemMap");(l||[]).forEach(function(v){ho(v,function(x){var w;if(!x)return!0;var I=d[x.id];if(((w=I==null?void 0:I.getType)===null||w===void 0?void 0:w.call(I))==="combo"){var G=(0,P.__spreadArray)([],I.getStates(),!0);(0,k.each)(G,function(U){return i.setItemState(I,U,!1)}),f.updateCombo(I,x.children,e),(0,k.each)(G,function(U){return i.setItemState(I,U,!0)})}return!0})}),s.sortCombos()},a.prototype.updateCombo=function(e){var i=this,s=this,l=e,f;if((0,k.isString)(e)&&(l=this.findById(e)),!l||l.getType&&l.getType()!=="combo"){console.warn("The item to be updated is not a combo!");return}f=l.get("id");var d=this.get("comboTrees"),v=s.get("itemController"),x=s.get("itemMap");(d||[]).forEach(function(w){ho(w,function(I){if(!I)return!0;var G=x[I.id];if(f===I.id&&G&&G.getType&&G.getType()==="combo"){var U=(0,P.__spreadArray)([],G.getStates(),!0);(0,k.each)(U,function(et){G.getStateStyle(et)&&i.setItemState(G,et,!1)}),v.updateCombo(G,I.children),(0,k.each)(U,function(et){G.getStateStyle(et)&&i.setItemState(G,et,!0)}),f&&(f=I.parentId)}return!0})})},a.prototype.updateComboTree=function(e,i,s){s===void 0&&(s=!0);var l=this;this.set("comboSorted",!1);var f;(0,k.isString)(e)?f=l.findById(e):f=e;var d=f.getModel(),v=d.comboId||d.parentId,x="";if(f.getType&&(x=f.getType()),i&&x==="combo"){var w=this.get("comboTrees"),I=!0,G;if((w||[]).forEach(function(kt){G||wo(kt,function($t){if(!G)return $t.id===f.getID()&&(G=$t),!0})}),wo(G,function(kt){return kt.id===i?(I=!1,!1):!0}),!I){console.warn("Failed to update the combo tree! The parentId points to a descendant of the combo!");return}}if(s&&this.get("enabledStack")){var U={},et={};x==="combo"?(U.combos=[{id:d.id,parentId:d.parentId}],et.combos=[{id:d.id,parentId:i}]):x==="node"&&(U.nodes=[{id:d.id,parentId:d.comboId}],et.nodes=[{id:d.id,parentId:i}]),this.pushStack("updateComboTree",{before:U,after:et})}if(d.parentId||d.comboId){var ft=this.findById(d.parentId||d.comboId);ft&&ft.removeChild(f)}if(x==="combo"?d.parentId=i:x==="node"&&(d.comboId=i),i){var Ct=this.findById(i);Ct&&Ct.addChild(f)}if(v){var Ct=this.findById(v);Ct&&Ct.removeChild(f)}var Mt=Vs(this.get("comboTrees"),d.id,i);this.set("comboTrees",Mt),this.updateCombos()},a.prototype.save=function(){var e=[],i=[],s=[];return(0,k.each)(this.get("nodes"),function(l){e.push(l.getModel())}),(0,k.each)(this.get("edges"),function(l){i.push(l.getModel())}),(0,k.each)(this.get("combos"),function(l){s.push(l.getModel())}),{nodes:e,edges:i,combos:s}},a.prototype.changeSize=function(e,i){var s=this.get("viewController");return s.changeSize(e,i),this},a.prototype.refresh=function(){var e=this;if(e.emit("beforegraphrefresh"),e.get("animate"))e.positionsAnimate();else{var i=e.get("nodes"),s=e.get("edges"),l=e.get("edges");(0,k.each)(i,function(f){f.refresh()}),(0,k.each)(s,function(f){f.refresh()}),(0,k.each)(l,function(f){f.refresh()})}e.emit("aftergraphrefresh"),e.autoPaint()},a.prototype.getNodes=function(){return this.get("nodes")},a.prototype.getEdges=function(){return this.get("edges")},a.prototype.getCombos=function(){return this.get("combos")},a.prototype.getComboChildren=function(e){if((0,k.isString)(e)&&(e=this.findById(e)),!e||e.getType&&e.getType()!=="combo"){console.warn("The combo does not exist!");return}return e.getChildren()},a.prototype.positionsAnimate=function(e){var i=this;i.emit("beforeanimate");var s=i.get("animateCfg"),l=s.onFrame,f=e?i.getNodes().concat(i.getCombos()):i.getNodes(),d=f.map(function(x){var w=x.getModel();return{id:w.id,x:w.x,y:w.y}});i.stopAnimate();var v=i.get("canvas");i.animating=!0,setTimeout(function(){v.animate(function(x){(0,k.each)(d,function(w){var I=i.findById(w.id);if(!(!I||I.destroyed)){var G=I.get("originAttrs"),U=I.get("model"),et=I.getContainer().getMatrix();if(G==null&&(et&&(G={x:et[6],y:et[7]}),I.set("originAttrs",G||0)),l){var ft=l(I,x,w,G||{x:0,y:0});I.set("model",Object.assign(U,ft))}else G?(U.x=G.x+(w.x-G.x)*x,U.y=G.y+(w.y-G.y)*x):(U.x=w.x,U.y=w.y)}}),i.refreshPositions(e)},{duration:s.duration,easing:s.easing,callback:function(){(0,k.each)(f,function(w){w.set("originAttrs",null)}),s.callback&&s.callback(),i.emit("afteranimate"),i.animating=!1}})},0)},a.prototype.refreshPositions=function(e){var i=this;i.emit("beforegraphrefreshposition");var s=i.get("nodes"),l=i.get("edges"),f=i.get("vedges"),d=i.get("combos"),v,x={},w=function(G){(0,k.each)(G,function(U){v=U.getModel();var et=U.get("originAttrs");if(!(et&&v.x===et.x&&v.y===et.y)){var ft=U.updatePosition({x:v.x,y:v.y});x[v.id]=ft,v.comboId&&(x[v.comboId]=x[v.comboId]||ft),v.parentId&&(x[v.parentId]=x[v.parentId]||ft)}})};w(d),w(s),d&&d.length!==0&&(e&&w(d),i.updateCombos()),(0,k.each)(l,function(I){var G=I.getSource().getModel(),U=I.getTarget();if(!(0,k.isPlainObject)(U)){var et=U.getModel();(x[G.id]||x[et.id]||I.getModel().isComboEdge)&&I.refresh()}}),(0,k.each)(f,function(I){I.refresh()}),i.emit("aftergraphrefreshposition"),i.autoPaint()},a.prototype.stopAnimate=function(){var e=this.get("canvas"),i=e.cfg.timeline;i&&i.stopAllAnimations()},a.prototype.isAnimating=function(){return this.animating},a.prototype.getZoom=function(){var e=this.get("group").getMatrix();return e?e[0]:1},a.prototype.getCurrentMode=function(){var e=this.get("modeController");return e.getMode()},a.prototype.setMode=function(e){var i=this.get("modeController");return i.setMode(e),this},a.prototype.clear=function(e){var i;return e===void 0&&(e=!1),(i=this.get("canvas"))===null||i===void 0||i.clear(),this.initGroups(),this.set({itemMap:{},nodes:[],edges:[],vedges:[],groups:[],combos:[],comboTrees:[]}),e||this.emit("afterrender"),this},a.prototype.updateLayout=function(e,i,s,l){var f=this;e===void 0&&(e={}),l===void 0&&(l=!0);var d=this.get("layoutController");if((0,k.isString)(e)&&(e={type:e}),i){var v=s;v||(i==="begin"?v={x:0,y:0}:v={x:this.getWidth()/2,y:this.getHeight()/2}),v=this.getPointByCanvas(v.x,v.y);var x=["force","gForce","fruchterman","force2"];x.includes(e.type)||!e.type&&x.includes(d==null?void 0:d.layoutType)?e.center=[v.x,v.y]:this.once("afterlayout",function(G){var U=f.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];v.x=v.x*U[0]+U[6],v.y=v.y*U[0]+U[7];var et=f.getGroup().getCanvasBBox(),ft=et.minX,Ct=et.maxX,Mt=et.minY,kt=et.maxY,$t={x:(ft+Ct)/2,y:(Mt+kt)/2};i==="begin"&&($t.x=ft,$t.y=Mt),f.translate(v.x-$t.x,v.y-$t.y)})}var w=(0,P.__assign)({},this.get("layout")),I={};Object.assign(I,w,e),e.pipes&&!e.type?delete I.type:!e.pipes&&I.type&&delete I.pipes,this.set("layout",I),!!d&&(d.isLayoutTypeSame(I)&&I.gpuEnabled===w.gpuEnabled?d.updateLayoutCfg(I):d.changeLayout(I),l&&this.get("enabledStack")&&this.pushStack("layout",{before:w,after:I}))},a.prototype.destroyLayout=function(){var e=this.get("layoutController");e==null||e.destroyLayout()},a.prototype.layout=function(){var e,i=this.get("layoutController"),s=this.get("layout");if(!(!s||!i)){if(s.workerEnabled){i.layout();return}((e=i.layoutMethods)===null||e===void 0?void 0:e.length)?i.relayout(!0):i.layout()}},a.prototype.collapseCombo=function(e,i){var s=this;if(i===void 0&&(i=!0),!this.destroyed){if((0,k.isString)(e)&&(e=this.findById(e)),!e){console.warn("The combo to be collapsed does not exist!");return}this.emit("beforecollapseexpandcombo",{action:"expand",item:e});var l=e.getModel(),f=this.get("itemController");f.collapseCombo(e,i),l.collapsed=!0;var d=this.getEdges().concat(this.get("vedges")),v=[],x=this.get("comboTrees"),w=!1;(x||[]).forEach(function(G){w||wo(G,function(U){if(w&&U.depth<=l.depth)return!1;if(l.id===U.id&&(w=!0),w){var et=s.findById(U.id);et&&et.getType&&et.getType()==="combo"&&(v=v.concat(et.getNodes()),v=v.concat(et.getCombos()))}return!0})});var I={};d.forEach(function(G){var U=G.getModel(),et=U.isVEdge,ft=U.size,Ct=ft===void 0?1:ft;if(!(G.isVisible()&&!et)){var Mt=G.getSource(),kt=G.getTarget(),$t=null,Jt;if(Mt.getModel().id===l.id||v.includes(Mt)&&!v.includes(kt)?($t=kt,Jt=!1):(kt.getModel().id===l.id||!v.includes(Mt)&&v.includes(kt))&&($t=Mt,Jt=!0),$t){if(et){s.removeItem(G,!1);return}for(var Ce=$t.getModel();!$t.isVisible();){var je=Ce.parentId,ze=Ce.comboId,pn=je||ze;if($t=s.findById(pn),!$t||!pn)return;Ce=$t.getModel()}var Fn=Ce.id,Tn=Jt?{source:Fn,target:l.id,size:Ct,isVEdge:!0}:{source:l.id,target:Fn,size:Ct,isVEdge:!0},cr="".concat(Tn.source,"-").concat(Tn.target);if(I[cr]){I[cr].size+=Ct;return}I[cr]=Tn}}}),this.addItems(Object.values(I).map(function(G){return{type:"vedge",model:G}}),!1),this.emit("aftercollapseexpandcombo",{action:"collapse",item:e})}},a.prototype.expandCombo=function(e,i){var s=this;if(i===void 0&&(i=!0),(0,k.isString)(e)&&(e=this.findById(e)),!e||e.getType&&e.getType()!=="combo"){console.warn("The combo to be collapsed does not exist!");return}this.emit("beforecollapseexpandcombo",{action:"expand",item:e});var l=e.getModel(),f=this.get("itemController");f.expandCombo(e,i),l.collapsed=!1;var d=this.getEdges().concat(this.get("vedges")),v=[],x=this.get("comboTrees"),w=!1;(x||[]).forEach(function(G){w||wo(G,function(U){if(w&&U.depth<=l.depth)return!1;if(l.id===U.id&&(w=!0),w){var et=s.findById(U.id);et&&et.getType&&et.getType()==="combo"&&(v=v.concat(et.getNodes()),v=v.concat(et.getCombos()))}return!0})});var I={};d.forEach(function(G){if(!(G.isVisible()&&!G.getModel().isVEdge)){var U=G.getSource(),et=G.getTarget(),ft=U.get("id"),Ct=et.get("id"),Mt=null,kt;if(ft===l.id||v.includes(U)&&!v.includes(et)?(Mt=et,kt=!1):Ct===l.id||!v.includes(U)&&v.includes(et)?(Mt=U,kt=!0):v.includes(U)&&v.includes(et)&&U.isVisible()&&et.isVisible()&&G.show(),Mt){var $t=G.getModel(),Jt=$t.isVEdge,Ce=$t.size,je=Ce===void 0?1:Ce;if(Jt){s.removeItem(G,!1);return}for(var ze=Mt.getModel();!Mt.isVisible();){var pn=ze.parentId,Fn=ze.comboId,Tn=pn||Fn;if(Mt=s.findById(Tn),!Mt||!Tn)return;ze=Mt.getModel()}for(var cr=ze.id,kr=kt?et:U,Aa=kr.getModel();!kr.isVisible();){var ci=Aa.parentId,ei=Aa.comboId,Ca=ci||ei;if(kr=s.findById(Ca),!kr||!Ca)return;if(Aa.comboId===l.id||Aa.parentId===l.id)break;Aa=kr.getModel()}var Pi=Aa.id;if(cr){var Ni=kt?{source:cr,target:Pi,isVEdge:!0,size:je}:{source:Pi,target:cr,isVEdge:!0,size:je},_a="".concat(Ni.source,"-").concat(Ni.target);if(I[_a]){I[_a].size+=je;return}I[_a]=Ni}}}}),this.addItems(Object.values(I).map(function(G){return{type:"vedge",model:G}}),!1),this.emit("aftercollapseexpandcombo",{action:"expand",item:e})},a.prototype.collapseExpandCombo=function(e,i){if(i===void 0&&(i=!0),(0,k.isString)(e)&&(e=this.findById(e)),!(!e||e.getType&&e.getType()!=="combo")){for(var s=e.getModel(),l=this.findById(s.parentId);l;){var f=l.getModel();if(f.collapsed){console.warn("Fail to expand the combo since it's ancestor combo is collapsed."),l=void 0;return}l=this.findById(f.parentId)}var d=s.collapsed;d?this.expandCombo(e,i):this.collapseCombo(e,i),this.updateCombo(e)}},a.prototype.getNeighbors=function(e,i){var s=e;return(0,k.isString)(e)&&(s=this.findById(e)),s.getNeighbors(i)},a.prototype.getNodeDegree=function(e,i,s){i===void 0&&(i=void 0),s===void 0&&(s=!1);var l=e;(0,k.isString)(e)&&(l=this.findById(e));var f=this.get("degrees");(!f||s)&&(f=en(this.save()),this.set("degrees",f));var d=f[l.getID()],v=0;if(!d)return 0;switch(i){case"in":v=d.inDegree;break;case"out":v=d.outDegree;break;case"all":v=d;break;default:v=d.degree;break}return v},a.prototype.getUndoStack=function(){return this.undoStack},a.prototype.getRedoStack=function(){return this.redoStack},a.prototype.getStackData=function(){return this.get("enabledStack")?{undoStack:this.undoStack.toArray(),redoStack:this.redoStack.toArray()}:null},a.prototype.clearStack=function(){this.get("enabledStack")&&(this.undoStack.clear(),this.redoStack.clear(),this.emit("stackchange",{undoStack:this.undoStack,redoStack:this.redoStack}))},a.prototype.pushStack=function(e,i,s){if(e===void 0&&(e="update"),s===void 0&&(s="undo"),!this.get("enabledStack")){console.warn("\u8BF7\u5148\u542F\u7528 undo & redo \u529F\u80FD\uFF0C\u5728\u5B9E\u4F8B\u5316 Graph \u65F6\u5019\u914D\u7F6E enabledStack: true !");return}var l=i?(0,k.clone)(i):{before:{},after:(0,k.clone)(this.save())};s==="redo"?this.redoStack.push({action:e,data:l}):this.undoStack.push({action:e,data:l}),this.emit("stackchange",{action:e,stackType:s,undoStack:this.undoStack,redoStack:this.redoStack})},a.prototype.getAdjMatrix=function(e,i){e===void 0&&(e=!0),i===void 0&&(i=this.get("directed"));var s=this.get("adjMatrix");return(!s||!e)&&(s=de(this.save(),i),this.set("adjMatrix",s)),s},a.prototype.getShortestPathMatrix=function(e,i){e===void 0&&(e=!0),i===void 0&&(i=this.get("directed"));var s=this.get("adjMatrix"),l=this.get("shortestPathMatrix");return(!s||!e)&&(s=de(this.save(),i),this.set("adjMatrix",s)),(!l||!e)&&(l=Wr(this.save(),i),this.set("shortestPathMatrix",l)),l},a.prototype.on=function(e,i,s){return c.prototype.on.call(this,e,i,s)},a.prototype.destroy=function(){var e,i,s,l,f;this.clear(),this.clearStack(),(e=this.get("itemController"))===null||e===void 0||e.destroy(),(i=this.get("modeController"))===null||i===void 0||i.destroy(),(s=this.get("viewController"))===null||s===void 0||s.destroy(),(l=this.get("stateController"))===null||l===void 0||l.destroy(),(f=this.get("canvas"))===null||f===void 0||f.destroy(),this.cfg=null,this.destroyed=!0,this.redoStack=null,this.undoStack=null},a.prototype.createHull=function(e){if(!e.members||e.members.length<1){console.warn("Create hull failed! The members is empty.");return}var i=this.get("hullGroup"),s=this.get("hullMap");if(s||(s={},this.set("hullMap",s)),(!i||i.get("destroyed"))&&(i=this.get("group").addGroup({id:"hullGroup"}),i.toBack(),this.set("hullGroup",i)),s[e.id])return console.warn("Existed hull id."),s[e.id];var l=i.addGroup({id:"".concat(e.id,"-container")}),f=new Qh(this,(0,P.__assign)((0,P.__assign)({},e),{group:l})),d=f.id;return s[d]=f,f},a.prototype.getHulls=function(){return this.get("hullMap")},a.prototype.getHullById=function(e){return this.get("hullMap")[e]},a.prototype.removeHull=function(e){var i,s;(0,k.isString)(e)?s=this.getHullById(e):s=e,(i=this.get("hullMap"))===null||i===void 0||delete i[s.id],s.destroy()},a.prototype.removeHulls=function(){var e=this.getHulls();!e||!Object.keys(e).length||(Object.keys(e).forEach(function(i){var s=e[i];s.destroy()}),this.set("hullMap",{}))},a}(ut),X0=DS;function R1(c){return R1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},R1(c)}var wd=Le,Ox="-shape",jm="-label",Y0=["startArrow","endArrow"],Ig={lineWidth:1,stroke:void 0,fill:void 0,lineAppendWidth:1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,x:0,y:0,r:10,width:20,height:20,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},OS={lineWidth:1,stroke:"#000",lineDash:void 0,startArrow:!1,endArrow:!1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},pv={edge:OS,node:Ig,combo:Ig},L1="-label-bg",Ah={options:{labelCfg:{style:{fontFamily:Fe.windowFontFamily}},descriptionCfg:{style:{fontFamily:Fe.windowFontFamily}}},itemType:"",type:"",getCustomConfig:function(a){return{}},getOptions:function(a,e){return e==="move"||(e==null?void 0:e.includes("bbox"))?a:(0,k.deepMix)({},this.options,this.getCustomConfig(a)||{},a)},draw:function(a,e){e.shapeMap={},this.mergeStyle=this.getOptions(a);var i=this.drawShape(a,e);if(i.set("className",this.itemType+Ox),e.shapeMap[this.itemType+Ox]=i,a.label){var s=this.drawLabel(a,e);s.set("className",this.itemType+jm),e.shapeMap[this.itemType+jm]=s}return i},afterDraw:function(a,e,i){},drawShape:function(a,e){return null},drawLabel:function(a,e){var i=(this.mergeStyle||this.getOptions(a)||{}).labelCfg,s=i||{},l=this.getLabelStyle(a,s,e),f=l.rotate;delete l.rotate;var d=e.addShape("text",{attrs:l,draggable:!0,className:"text-shape",name:"text-shape",labelRelated:!0});if(e.shapeMap["text-shape"]=d,!isNaN(f)&&f!==""){var v=d.getBBox(),x=[1,0,0,0,1,0,0,0,1];if(l.rotateCenter)switch(l.rotateCenter){case"center":x=wd(x,[["t",-v.width/2,-v.height/2],["r",f],["t",v.width/2,v.height/2]]);break;case"lefttop":x=wd(x,[["t",-l.x,-l.y],["r",f],["t",l.x,l.y]]);break;case"leftcenter":x=wd(x,[["t",-l.x,-l.y-v.height/2],["r",f],["t",l.x,l.y+v.height/2]]);break;default:x=wd(x,[["t",-v.width/2,-v.height/2],["r",f],["t",v.width/2,v.height/2]]);break}else x=wd(x,[["t",-l.x,-l.y-v.height/2],["r",f],["t",l.x,l.y+v.height/2]]);d.setMatrix(x)}if(l.background){var w=this.drawLabelBg(a,e,d),I=this.itemType+L1;w.set("classname",I),e.shapeMap[I]=w,d.toFront()}return d},drawLabelBg:function(a,e,i){var s=this.options.labelCfg,l=(0,k.mix)({},s,a.labelCfg),f=this.getLabelBgStyleByPosition(i,l),d=e.addShape("rect",{name:"text-bg-shape",attrs:f,labelRelated:!0});return e.shapeMap["text-bg-shape"]=d,d},getLabelStyleByPosition:function(a,e,i){return{text:a.label}},getLabelBgStyleByPosition:function(a,e){return{}},getLabelStyle:function(a,e,i){var s=this.getLabelStyleByPosition(a,e,i),l="".concat(this.itemType,"Label"),f=Fe[l]?Fe[l].style:null;return(0,P.__assign)((0,P.__assign)((0,P.__assign)({},f),s),e.style)},getShapeStyle:function(a){return a.style},update:function(a,e,i){this.updateShapeStyle(a,e,i),this.updateLabel(a,e,i)},updateShapeStyle:function(a,e,i){var s,l=e.getContainer(),f=e.getKeyShape(),d=(0,k.mix)({},f.attr(),a.style),v=function(I){var G,U=d[I];if((0,k.isPlainObject)(U)){var et=((s=l.shapeMap)===null||s===void 0?void 0:s[I])||l.find(function(ft){return ft.get("name")===I});et==null||et.attr(U)}else f.attr((G={},G[I]=U,G))};for(var x in d)v(x)},updateLabel:function(a,e,i){var s,l,f=e.getContainer(),d=(this.mergeStyle||this.getOptions({},i)||{}).labelCfg,v=d===void 0?{}:d,x=this.itemType+jm,w=f.shapeMap[x]||f.find(function(Jt){return Jt.get("className")===x}),I=this.itemType+L1,G=f.shapeMap[I]||f.find(function(Jt){return Jt.get("className")===I});if(w&&a.label===void 0&&(f.removeChild(w),delete f.shapeMap[x],G&&(f.removeChild(G),delete f.shapeMap[I])),a.label||a.label==="")if(w){(!i||i==="bbox|label"||this.itemType==="edge"&&i!=="style")&&(v=(0,k.deepMix)(v,a.labelCfg));var et=this.getLabelStyleByPosition(a,v,f),ft=(s=a.labelCfg)===null||s===void 0?void 0:s.style,Ct=(0,P.__assign)((0,P.__assign)({},et),ft),Mt=Ct.rotate;if(delete Ct.rotate,!isNaN(Mt)&&Mt!==""){var kt=[1,0,0,0,1,0,0,0,1];kt=wd(kt,[["t",-Ct.x,-Ct.y],["r",Mt],["t",Ct.x,Ct.y]]),Ct.matrix=kt,w.attr(Ct)}else((l=w.getMatrix())===null||l===void 0?void 0:l[4])!==1&&w.resetMatrix(),w.attr(Ct);if(!G)Ct.background&&(G=this.drawLabelBg(a,f,w),G.set("classname",I),f.shapeMap[I]=G,w.toFront());else if(Ct.background){var $t=this.getLabelBgStyleByPosition(w,v);G.attr($t)}else f.removeChild(G)}else{var U=this.drawLabel(a,f);U.set("className",x),f.shapeMap[x]=U}},afterUpdate:function(a,e){},setState:function(a,e,i){var s,l,f,d=i.get("keyShape");if(!(!d||d.destroyed)){var v=i.getType(),x=(0,k.isBoolean)(e)?a:"".concat(a,":").concat(e),w=this.getStateStyle(x,i),I=i.getStateStyle(x);if(!(!I&&!w)){var G=(0,k.mix)({},I||w),U=i.getContainer(),et={x:1,y:1,cx:1,cy:1,matrix:1};if(v==="combo"&&(et.r=1,et.width=1,et.height=1),e){var ft=function(Ca){var Pi,Ni=G[Ca];if((0,k.isPlainObject)(Ni)&&!Y0.includes(Ca)){var _a=((f=U.shapeMap)===null||f===void 0?void 0:f[Ca])||U.find(function(Ya){return Ya.get("name")===Ca});_a==null||_a.attr(Ni)}else d.attr((Pi={},Pi[Ca]=Ni,Pi))};for(var Ct in G)ft(Ct)}else{var Mt=Rl(i.getCurrentStatesStyle()),kt=i.getModel(),$t=(0,k.mix)({},kt.style,Rl(i.getOriginStyle())),Jt=d.get("name"),Ce=d.attr(),je={};Object.keys(Ce).forEach(function(ei){if(ei!=="img"){var Ca=Ce[ei];Ca&&R1(Ca)==="object"?je[ei]=(0,k.clone)(Ca):je[ei]=Ca}});var ze={},pn=function(Ca){var Pi=G[Ca];if((0,k.isPlainObject)(Pi)&&!Y0.includes(Ca)){var Ni=U.shapeMap[Ca]||U.find(function(hi){return hi.get("name")===Ca});if(Ni){var _a=Rl(Ni.attr());(0,k.each)(Pi,function(hi,di){if(Ca===Jt&&je[di]&&!et[di]){delete je[di];var Xi=$t[Ca][di]||pv[v][di];d.attr(di,Xi)}else if(_a[di]||_a[di]===0){delete _a[di];var go=$t[Ca][di]||pv[v][di];Ni.attr(di,go)}}),ze[Ca]=_a}}else if(je[Ca]&&!et[Ca]){delete je[Ca];var Ya=$t[Ca]||($t[Jt]?$t[Jt][Ca]:void 0)||pv[v][Ca];d.attr(Ca,Ya)}};for(var Fn in G)pn(Fn);Jt?ze[Jt]=je:(0,k.mix)(ze,je);for(var Ct in Mt)if(!et[Ct]){var Tn=Mt[Ct];(!(0,k.isPlainObject)(Tn)||Y0.includes(Ct))&&(Jt?((0,k.mix)($t[Jt],(l={},l[Ct]=Tn,l)),delete $t[Ct]):(0,k.mix)($t,(s={},s[Ct]=Tn,s)),delete Mt[Ct])}var cr={};(0,k.deepMix)(cr,$t,ze,Mt);var kr=!1,Aa=function(Ca){var Pi,Ni,_a=cr[Ca];if((0,k.isPlainObject)(_a)&&!Y0.includes(Ca)){var Ya=U.shapeMap[Ca]||U.find(function(di){return di.get("name")===Ca});Ya&&((Ya.get("type")==="text"||Ya.get("labelRelated"))&&(delete _a.x,delete _a.y,delete _a.matrix),Ca===Jt&&(v==="combo"&&(delete _a.r,delete _a.width,delete _a.height),kr=!0),Ya.attr(_a))}else if(!kr){var hi=_a||pv[v][Ca];v==="combo"?Jt||d.attr((Pi={},Pi[Ca]=hi,Pi)):d.attr((Ni={},Ni[Ca]=hi,Ni))}};for(var ci in cr)Aa(ci)}}}},getStateStyle:function(a,e){var i=e.getModel(),s=e.getType(),l=this.getOptions(i),f=l.stateStyles,d=l.style,v=d===void 0?{}:d,x=i.stateStyles?i.stateStyles[a]:f&&f[a];return s==="combo"?(0,k.clone)(x):(0,k.mix)({},v,x)},getControlPoints:function(a){return a.controlPoints},getAnchorPoints:function(a){var e,i,s=(a==null?void 0:a.anchorPoints)||((e=this.getCustomConfig(a))===null||e===void 0?void 0:e.anchorPoints)||((i=this.options)===null||i===void 0?void 0:i.anchorPoints);return s}},RS={itemType:"node",shapeType:"single-node",labelPosition:"center",offset:Fe.nodeLabel.offset,getSize:function(a){var e,i=((e=this.mergeStyle)===null||e===void 0?void 0:e.size)||a.size||this.getOptions({}).size||Fe.defaultNode.size;return(0,k.isArray)(i)&&i.length===1&&(i=[i[0],i[0]]),(0,k.isArray)(i)||(i=[i,i]),i},getLabelStyleByPosition:function(a,e){var i=e.maxLength,s=a.label;i&&(s=Ps(s,i));var l=e.position||this.labelPosition;if(l==="center")return{x:0,y:0,text:s,textBaseline:"middle",textAlign:"center"};var f=e.offset;(0,k.isNil)(f)&&(f=this.offset);var d=this.getSize(a),v;switch(l){case"top":v={x:0,y:-d[1]/2-f,textBaseline:"bottom",textAlign:"center"};break;case"bottom":v={x:0,y:d[1]/2+f,textBaseline:"top",textAlign:"center"};break;case"left":v={x:-d[0]/2-f,y:0,textBaseline:"middle",textAlign:"right"};break;default:v={x:d[0]/2+f,y:0,textBaseline:"middle",textAlign:"left"};break}return v.text=s,v},getLabelBgStyleByPosition:function(a,e){var i;if(!a)return{};var s=(i=e.style)===null||i===void 0?void 0:i.background;if(!s)return{};var l=a.getBBox(),f=D(s.padding),d=l.width+f[1]+f[3],v=l.height+f[0]+f[2];return(0,P.__assign)((0,P.__assign)({x:l.minX-f[3],y:l.minY-f[0]},s),{width:d,height:v})},drawShape:function(a,e){var i=this.shapeType,s=this.getShapeStyle(a),l=e.addShape(i,{attrs:s,draggable:!0,name:"node-shape"});return e.shapeMap["node-shape"]=l,l},updateLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=e.shapeMap["link-point-left"]||e.find(function(cr){return cr.get("className")==="link-point-left"}),l=e.shapeMap["link-point-right"]||e.find(function(cr){return cr.get("className")==="link-point-right"}),f=e.shapeMap["link-point-top"]||e.find(function(cr){return cr.get("className")==="link-point-top"}),d=e.shapeMap["link-point-bottom"]||e.find(function(cr){return cr.get("className")==="link-point-bottom"}),v;s&&(v=s.attr()),l&&!v&&(v=l.attr()),f&&!v&&(v=f.attr()),d&&!v&&(v=d.attr()),v||(v=i);var x=(0,k.mix)({},v,a.linkPoints),w=x.fill,I=x.stroke,G=x.lineWidth,U=x.size/2;U||(U=x.r);var et=a.linkPoints?a.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},ft=et.left,Ct=et.right,Mt=et.top,kt=et.bottom,$t=this.getSize(a),Jt=$t[0],Ce=$t[1],je={r:U,fill:w,stroke:I,lineWidth:G};if(s)!ft&&ft!==void 0?(s.remove(),delete e.shapeMap["link-point-left"]):s.attr((0,P.__assign)((0,P.__assign)({},je),{x:-Jt/2,y:0}));else if(ft){var ze="link-point-left";e.shapeMap[ze]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},je),{x:-Jt/2,y:0}),className:ze,name:ze,isAnchorPoint:!0})}if(l)!Ct&&Ct!==void 0&&(l.remove(),delete e.shapeMap["link-point-right"]),l.attr((0,P.__assign)((0,P.__assign)({},je),{x:Jt/2,y:0}));else if(Ct){var pn="link-point-right";e.shapeMap[pn]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},je),{x:Jt/2,y:0}),className:pn,name:pn,isAnchorPoint:!0})}if(f)!Mt&&Mt!==void 0&&(f.remove(),delete e.shapeMap["link-point-top"]),f.attr((0,P.__assign)((0,P.__assign)({},je),{x:0,y:-Ce/2}));else if(Mt){var Fn="link-point-top";e.shapeMap[Fn]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},je),{x:0,y:-Ce/2}),className:Fn,name:Fn,isAnchorPoint:!0})}if(d)!kt&&kt!==void 0?(d.remove(),delete e.shapeMap["link-point-bottom"]):d.attr((0,P.__assign)((0,P.__assign)({},je),{x:0,y:Ce/2}));else if(kt){var Tn="link-point-bottom";e.shapeMap[Tn]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},je),{x:0,y:Ce/2}),className:Tn,name:Tn,isAnchorPoint:!0})}},updateShape:function(a,e,i,s,l){var f=e.get("keyShape");f.attr((0,P.__assign)({},i)),this.updateLabel(a,e,l),s&&this.updateIcon(a,e)},updateIcon:function(a,e){var i=this,s=e.getContainer(),l=(this.mergeStyle||this.getOptions(a)).icon,f=a.icon?a.icon:{show:void 0,text:void 0},d=f.show,v=f.text,x=s.shapeMap["".concat(this.type,"-icon")]||s.find(function(Mt){return Mt.get("name")==="".concat(i.type,"-icon")});if(x)if(d||d===void 0){var w=(0,k.mix)({},x.attr(),l),I=w.width,G=I===void 0?20:I,U=w.height,et=U===void 0?20:U;(w.fontFamily==="iconfont"||w.hasOwnProperty("text"))&&(G=0,et=0),x.attr((0,P.__assign)((0,P.__assign)({},w),{x:-G/2,y:-et/2}))}else x.remove(),delete s.shapeMap["".concat(this.type,"-icon")];else if(d){var ft="".concat(this.type,"-icon");if(v)s.shapeMap[ft]=s.addShape("text",{attrs:(0,P.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},l),className:ft,name:ft});else{var G=l.width,et=l.height;s.shapeMap[ft]=s.addShape("image",{attrs:(0,P.__assign)((0,P.__assign)({},l),{x:-G/2,y:-et/2}),className:ft,name:ft})}var Ct=s.shapeMap["node-label"]||s.find(function(Mt){return Mt.get("name")==="node-label"});Ct&&Ct.toFront()}}},Bv=(0,P.__assign)((0,P.__assign)({},Ah),RS);Gr.registerNode("single-node",Bv);var K0="edge-shape";function Z0(c){var a=c;return c==="start"?a="end":c==="end"&&(a="start"),a}var LS={itemType:"edge",labelPosition:"center",refX:0,refY:0,labelAutoRotate:!1,options:{size:Fe.defaultEdge.size,style:{x:0,y:0,stroke:Fe.defaultEdge.style.stroke,lineAppendWidth:Fe.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:Fe.edgeLabel.style.fill,fontSize:Fe.edgeLabel.style.fontSize,fontFamily:Fe.windowFontFamily}},stateStyles:(0,P.__assign)({},Fe.edgeStateStyles)},getPath:function(a){var e=[];return(0,k.each)(a,function(i,s){s===0?e.push(["M",i.x,i.y]):e.push(["L",i.x,i.y])}),e},getShapeStyle:function(a){var e=this.options.style,i={stroke:a.color},s=(0,k.mix)({},e,i,a.style),l=a.size||Fe.defaultEdge.size;a=this.getPathPoints(a);var f=a.startPoint,d=a.endPoint,v=this.getControlPoints(a),x=[f];v&&(x=x.concat(v)),x.push(d);var w=this.getPath(x),I=(0,k.mix)({},Fe.defaultEdge.style,{stroke:Fe.defaultEdge.color,lineWidth:l,path:w},s);return I},updateShapeStyle:function(a,e,i){var s,l=e.getContainer(),f=((s=e.getKeyShape)===null||s===void 0?void 0:s.call(e))||l.shapeMap["edge-shape"],d=a.size;a=this.getPathPoints(a);var v=a.startPoint,x=a.endPoint,w=this.getControlPoints(a),I=[v];w&&(I=I.concat(w)),I.push(x);var G=f.attr(),U=a.style||{};U.stroke===void 0&&(U.stroke=a.color);var et=a.sourceNode,ft=a.targetNode,Ct={radius:U.radius};w||(Ct={source:et,target:ft,offset:U.offset,radius:U.radius});var Mt=this.getPath(I,Ct),kt={};i==="move"?kt={path:Mt}:(G.endArrow&&U.endArrow===!1&&(a.style.endArrow={path:""}),G.startArrow&&U.startArrow===!1&&(a.style.startArrow={path:""}),kt=(0,P.__assign)({},a.style),kt.lineWidth===void 0&&(kt.lineWdith=((0,k.isNumber)(d)?d:d==null?void 0:d[0])||G.lineWidth),kt.path===void 0&&(kt.path=Mt),kt.stroke===void 0&&(kt.stroke=G.stroke||a.color)),f&&f.attr(kt)},getLabelStyleByPosition:function(a,e,i){var s=e.position||this.labelPosition,l={},f=i==null?void 0:i.shapeMap[K0],d;s==="start"?d=0:s==="end"?d=1:d=.5;var v=e.refX||this.refX,x=e.refY||this.refY;if(a.startPoint.x===a.endPoint.x&&a.startPoint.y===a.endPoint.y)return l.x=a.startPoint.x+v,l.y=a.startPoint.y+x,l.text=a.label,l;var w;(0,k.isNil)(e.autoRotate)?w=this.labelAutoRotate:w=e.autoRotate;var I=Ai(f,d,v,x,w);return l.x=I.x,l.y=I.y,l.rotate=I.rotate,l.textAlign=this._getTextAlign(s,I.angle),l.text=a.label,l},getLabelBgStyleByPosition:function(a,e){if(!a)return{};var i=a.getBBox(),s=e.style&&e.style.background;if(!s)return{};var l=s.padding,f=i.width+l[1]+l[3],d=i.height+l[0]+l[2],v=(0,P.__assign)((0,P.__assign)({},s),{width:f,height:d,x:i.minX-l[3],y:i.minY-l[0],matrix:[1,0,0,0,1,0,0,0,1]}),x;return(0,k.isNil)(e.autoRotate)?x=this.labelAutoRotate:x=e.autoRotate,x&&(v.matrix=a.attr("matrix")||[1,0,0,0,1,0,0,0,1]),v},_getTextAlign:function(a,e){var i="center";return e?(e=e%(Math.PI*2),a!=="center"&&(e>=0&&e<=Math.PI/2||e>=3/2*Math.PI&&e<2*Math.PI?i=a:i=Z0(a)),i):a},getControlPoints:function(a){return a.controlPoints},getPathPoints:function(a){return a},drawShape:function(a,e){var i=this.getShapeStyle(a),s=e.addShape("path",{className:K0,name:K0,attrs:i});return e.shapeMap[K0]=s,s},drawLabel:function(a,e){var i=this.options.labelCfg,s=(0,k.deepMix)({},i,a.labelCfg),l=this.getLabelStyle(a,s,e),f=l.rotate;delete l.rotate;var d=e.addShape("text",{attrs:l,name:"text-shape",labelRelated:!0,draggable:!0});if(e.shapeMap["text-shape"]=d,!isNaN(f)&&f!==""&&d.rotateAtStart(f),l.background){var v=this.drawLabelBg(a,e,d,l,f),x=this.itemType+L1;v.set("classname",x),e.shapeMap[x]=v,d.toFront()}return d},drawLabelBg:function(a,e,i,s,l){var f=this.options.labelCfg,d=(0,k.deepMix)({},f,a.labelCfg),v=this.getLabelBgStyleByPosition(i,d),x=e.addShape("rect",{name:"text-bg-shape",attrs:v,labelRelated:!0});return e.shapeMap["text-bg-shape"]=x,x}},Rx=(0,P.__assign)((0,P.__assign)({},Ah),LS);Gr.registerEdge("single-edge",Rx),Gr.registerEdge("line",{getControlPoints:function(){}},"single-edge"),Gr.registerEdge("spline",{getPath:function(a){var e=kp(a);return e}},"single-edge"),Gr.registerEdge("arc",{curveOffset:20,clockwise:1,getControlPoints:function(a){var e=a.startPoint,i=a.endPoint,s={x:(e.x+i.x)/2,y:(e.y+i.y)/2},l,f;if(a.controlPoints!==void 0){if(f=a.controlPoints[0],l=Fa(e,f,i),e.x<=i.x&&e.y>i.y?this.clockwise=l.x>f.x?0:1:e.x<=i.x&&e.y<i.y?this.clockwise=l.x>f.x?1:0:e.x>i.x&&e.y<=i.y?this.clockwise=l.y<f.y?0:1:this.clockwise=l.y<f.y?1:0,(f.x-e.x)/(f.y-e.y)==(i.x-e.x)/(i.y-e.y))return[]}else{a.curveOffset===void 0&&(a.curveOffset=this.curveOffset),(0,k.isArray)(a.curveOffset)&&(a.curveOffset=a.curveOffset[0]),a.curveOffset<0?this.clockwise=0:this.clockwise=1;var d={x:i.x-e.x,y:i.y-e.y},v=Math.atan2(d.y,d.x);f={x:a.curveOffset*Math.cos(-Math.PI/2+v)+s.x,y:a.curveOffset*Math.sin(-Math.PI/2+v)+s.y},l=Fa(e,f,i)}var x=Vi(e,l),w=[{x,y:x}];return w},getPath:function(a){var e=[];return e.push(["M",a[0].x,a[0].y]),a.length===2?e.push(["L",a[1].x,a[1].y]):e.push(["A",a[1].x,a[1].y,0,0,this.clockwise,a[2].x,a[2].y]),e}},"single-edge"),Gr.registerEdge("quadratic",{curvePosition:.5,curveOffset:-20,getControlPoints:function(a){var e=a.controlPoints;if(!e||!e.length){var i=a.startPoint,s=a.endPoint;a.curveOffset===void 0&&(a.curveOffset=this.curveOffset),a.curvePosition===void 0&&(a.curvePosition=this.curvePosition),(0,k.isArray)(a.curveOffset)&&(a.curveOffset=a.curveOffset[0]),(0,k.isArray)(a.curvePosition)&&(a.curvePosition=a.curveOffset[0]);var l=qh(i,s,a.curvePosition,a.curveOffset);e=[l]}return e},getPath:function(a){var e=[];return e.push(["M",a[0].x,a[0].y]),e.push(["Q",a[1].x,a[1].y,a[2].x,a[2].y]),e}},"single-edge"),Gr.registerEdge("cubic",{curvePosition:[1/2,1/2],curveOffset:[-20,20],getControlPoints:function(a){var e=a.controlPoints;if(a.curveOffset===void 0&&(a.curveOffset=this.curveOffset),a.curvePosition===void 0&&(a.curvePosition=this.curvePosition),(0,k.isNumber)(a.curveOffset)&&(a.curveOffset=[a.curveOffset,-a.curveOffset]),(0,k.isNumber)(a.curvePosition)&&(a.curvePosition=[a.curvePosition,1-a.curvePosition]),!e||!e.length||e.length<2){var i=a.startPoint,s=a.endPoint,l=qh(i,s,a.curvePosition[0],a.curveOffset[0]),f=qh(i,s,a.curvePosition[1],a.curveOffset[1]);e=[l,f]}return e},getPath:function(a){var e=[];return e.push(["M",a[0].x,a[0].y]),e.push(["C",a[1].x,a[1].y,a[2].x,a[2].y,a[3].x,a[3].y]),e}},"single-edge"),Gr.registerEdge("cubic-vertical",{curvePosition:[1/2,1/2],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(a){var e=a.startPoint,i=a.endPoint;a.curvePosition===void 0&&(a.curvePosition=this.curvePosition),a.curveOffset===void 0&&(a.curveOffset=this.curveOffset),a.minCurveOffset===void 0&&(a.minCurveOffset=this.minCurveOffset),(0,k.isNumber)(a.curveOffset)&&(a.curveOffset=[a.curveOffset,-a.curveOffset]),(0,k.isNumber)(a.minCurveOffset)&&(a.minCurveOffset=[a.minCurveOffset,-a.minCurveOffset]),(0,k.isNumber)(a.curvePosition)&&(a.curvePosition=[a.curvePosition,1-a.curvePosition]);var s=i.y-e.y,l=[0,0];a.curveOffset?l=a.curveOffset:Math.abs(s)<Math.abs(a.minCurveOffset[0])&&(l=a.minCurveOffset);var f={x:e.x,y:e.y+s*this.curvePosition[0]+l[0]},d={x:i.x,y:i.y-s*this.curvePosition[1]+l[1]};return[f,d]}},"cubic"),Gr.registerEdge("cubic-horizontal",{curvePosition:[1/2,1/2],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(a){var e=a.startPoint,i=a.endPoint;a.curvePosition===void 0&&(a.curvePosition=this.curvePosition),a.curveOffset===void 0&&(a.curveOffset=this.curveOffset),a.minCurveOffset===void 0&&(a.minCurveOffset=this.minCurveOffset),(0,k.isNumber)(a.curveOffset)&&(a.curveOffset=[a.curveOffset,-a.curveOffset]),(0,k.isNumber)(a.minCurveOffset)&&(a.minCurveOffset=[a.minCurveOffset,-a.minCurveOffset]),(0,k.isNumber)(a.curvePosition)&&(a.curvePosition=[a.curvePosition,1-a.curvePosition]);var s=i.x-e.x,l=[0,0];a.curveOffset?l=a.curveOffset:Math.abs(s)<Math.abs(a.minCurveOffset[0])&&(l=a.minCurveOffset);var f={x:e.x+s*this.curvePosition[0]+l[0],y:e.y},d={x:i.x-s*this.curvePosition[1]+l[1],y:i.y},v=[f,d];return v}},"cubic"),Gr.registerEdge("loop",{getPathPoints:function(a){return so(a)},getControlPoints:function(a){return a.controlPoints},afterDraw:function(a){a.controlPoints=void 0},afterUpdate:function(a){a.controlPoints=void 0}},"cubic");var PS={itemType:"combo",shapeType:"single-combo",labelPosition:"top",refX:Fe.comboLabel.refX,refY:Fe.comboLabel.refY,options:{style:{stroke:Fe.defaultCombo.style.stroke,fill:Fe.defaultCombo.style.fill,lineWidth:Fe.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Fe.comboLabel.style.fill,fontSize:Fe.comboLabel.style.fontSize,fontFamily:Fe.windowFontFamily}},stateStyles:(0,P.__assign)({},Fe.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},getSize:function(a){var e=(0,k.clone)(a.size||this.options.size||Fe.defaultCombo.size);return(0,k.isArray)(e)&&e.length===1&&(e=[e[0],e[0]]),(0,k.isArray)(e)||(e=[e,e]),e},getLabelStyleByPosition:function(a,e){var i=e.position||this.labelPosition,s=a.style,l=a.padding||this.options.padding;(0,k.isArray)(l)&&(l=Math.max.apply(Math,l));var f=e.refX,d=e.refY;(0,k.isNil)(f)&&(f=this.refX),(0,k.isNil)(d)&&(d=this.refY);var v=this.getSize(a),x=Math.max(s.r,v[0]/2)||v[0]/2,w=x+l,I;switch(i){case"top":I={x:0,y:-w-d,textBaseline:"bottom",textAlign:"center"};break;case"bottom":I={x:0,y:w+d,textBaseline:"bottom",textAlign:"center"};break;case"left":I={x:-w+f,y:0,textAlign:"left"};break;case"center":I={x:0,y:0,text:a.label,textAlign:"center"};break;default:I={x:w+f,y:0,textAlign:"right"};break}return I.text=a.label,I},drawShape:function(a,e){var i=this.shapeType,s=this.getShapeStyle(a),l=e.addShape(i,{attrs:s,draggable:!0,name:"combo-shape"});return l},updateCollapsedIcon:function(a,e,i){var s=a.collapsed,l=a.collapsedSubstituteIcon,f=l===void 0?{}:l,d=Object.assign({},this.options.collapsedSubstituteIcon,f),v=d.show,x=d.img,w=d.width,I=d.height,G=e.getContainer(),U=G.find(function(Mt){return Mt.get("name")==="combo-collapsed-substitute-icon"}),et=U&&!U.destroyed,ft=e.get("keyShape");if(s&&v){if(et)U.show();else{var Ct={width:w||i.r*2||i.width,height:I||i.r*2||i.height};U=G.addShape("image",{attrs:(0,P.__assign)({img:x,x:-Ct.width/2,y:-Ct.height/2},Ct),name:"combo-collapsed-substitute-icon",draggable:!0})}ft.hide()}else et&&(U.hide(),ft.show())},updateShape:function(a,e,i){var s=this,l=e.get("keyShape"),f=e.get("animate"),d=f&&(a.animate===void 0?this.options.animate:a.animate);d&&l.animate?(a.collapsed||this.updateCollapsedIcon(a,e,i),l.animate(i,{duration:200,easing:"easeLinear",callback:function(){a.collapsed&&s.updateCollapsedIcon(a,e,i)}})):(l.attr((0,P.__assign)({},i)),this.updateCollapsedIcon(a,e,i)),this.updateLabel(a,e)}},Lx=(0,P.__assign)((0,P.__assign)({},Ah),PS);Gr.registerCombo("single-combo",Lx),Gr.registerCombo("circle",{options:{size:[Fe.defaultCombo.size[0],Fe.defaultCombo.size[0]],padding:Math.max.apply(Math,Fe.defaultCombo.padding),animate:!0,style:{stroke:Fe.defaultCombo.style.stroke,fill:Fe.defaultCombo.style.fill,lineWidth:Fe.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Fe.comboLabel.style.fill,fontSize:Fe.comboLabel.style.fontSize},refX:0,refY:0},stateStyles:(0,P.__assign)({},Fe.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},shapeType:"circle",labelPosition:"top",drawShape:function(a,e){var i=this.getShapeStyle(a);delete i.height,delete i.width;var s=e.addShape("circle",{attrs:i,className:"circle-combo",name:"circle-combo",draggable:!0});return s},getShapeStyle:function(a){var e=this.options.style,i=a.padding||this.options.padding;(0,k.isArray)(i)&&(i=Math.max.apply(Math,i));var s={stroke:a.color},l=(0,k.mix)({},e,s,a.style),f=a.collapsed&&a.fixCollapseSize?a.fixCollapseSize:a.fixSize,d;if(f)d=(0,k.isNumber)(f)?f/2:f[0]/2;else{var v=this.getSize(a);!(0,k.isNumber)(l.r)||isNaN(l.r)?d=v[0]/2||Fe.defaultCombo.style.r:d=Math.max(l.r,v[0]/2)||v[0]/2}l.r=d+i;var x=(0,P.__assign)({x:0,y:0},l);return a.style?a.style.r=d:a.style={r:d},x},update:function(a,e){var i=this.getSize(a),s=a.padding||this.options.padding;(0,k.isArray)(s)&&(s=Math.max.apply(Math,s));var l=(0,k.clone)(a.style),f=a.collapsed&&a.fixCollapseSize?a.fixCollapseSize:a.fixSize,d;f?d=(0,k.isNumber)(f)?f/2:f[0]/2:d=Math.max(l.r,i[0]/2)||i[0]/2,l.r=d+s;var v=e.get("sizeCache");v&&(v.r=l.r);var x={stroke:a.color},w=e.get("keyShape"),I=(0,k.mix)({},w.attr(),x,l);a.style?a.style.r=d:a.style={r:d},this.updateShape(a,e,I,!0)}},"single-combo"),Gr.registerCombo("rect",{options:{size:[40,5],padding:[25,20,15,20],animate:!0,style:{radius:0,stroke:Fe.defaultCombo.style.stroke,fill:Fe.defaultCombo.style.fill,lineWidth:Fe.defaultCombo.style.lineWidth},labelCfg:{style:{fill:Fe.comboLabel.style.fill,fontSize:Fe.comboLabel.style.fontSize,fontFamily:Fe.windowFontFamily}},anchorPoints:[[0,.5],[1,.5]],stateStyles:(0,P.__assign)({},Fe.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},shapeType:"rect",labelPosition:"top",drawShape:function(a,e){var i=this.getShapeStyle(a),s=e.addShape("rect",{attrs:i,className:"rect-combo",name:"rect-combo",draggable:!0});return s},getLabelStyleByPosition:function(a,e){var i=e.position||this.labelPosition,s=a.style,l=a.padding||this.options.padding;(0,k.isNumber)(l)&&(l=[l,l,l,l]);var f=e.refX,d=e.refY;(0,k.isNil)(f)&&(f=this.refX),(0,k.isNil)(d)&&(d=this.refY);var v=-s.width/2-l[3],x=s.width/2+l[1],w=-s.height/2-l[0],I=s.height/2+l[2],G;switch(i){case"top":G={x:v+f,y:w+d,textBaseline:"top",textAlign:"left"};break;case"bottom":G={x:0,y:I+d,textBaseline:"top",textAlign:"center"};break;case"left":G={x:v+d,y:0,textAlign:"left"};break;case"center":G={x:0,y:0,text:a.label,textAlign:"center"};break;case"top-center":G={x:0,y:w+d,textBaseline:"top",textAlign:"center"};break;default:G={x:x+f,y:0,textAlign:"right"};break}return G.text=a.label,G},getShapeStyle:function(a){var e=this.options.style,i=a.padding||this.options.padding;(0,k.isNumber)(i)&&(i=[i,i,i,i]);var s={stroke:a.color},l=(0,k.mix)({},e,s,a.style),f=this.getSize(a),d,v,x=a.collapsed&&a.fixCollapseSize?a.fixCollapseSize:a.fixSize;x?(0,k.isNumber)(x)?(d=x,v=x):(d=x[0],v=x[1]):(!(0,k.isNumber)(l.width)||isNaN(l.width)?d=f[0]||Fe.defaultCombo.style.width:d=Math.max(l.width,f[0])||f[0],!(0,k.isNumber)(l.height)||isNaN(l.height)?v=f[1]||Fe.defaultCombo.style.height:v=Math.max(l.height,f[1])||f[1]);var w=-d/2-i[3],I=-v/2-i[0];l.width=d+i[1]+i[3],l.height=v+i[0]+i[2];var G=(0,P.__assign)({x:w,y:I},l);return a.style?(a.style.width=d,a.style.height=v):a.style={width:d,height:v},G},update:function(a,e){var i=this.getSize(a),s=a.padding||this.options.padding;(0,k.isNumber)(s)&&(s=[s,s,s,s]);var l=(0,k.clone)(a.style),f,d,v=a.collapsed&&a.fixCollapseSize?a.fixCollapseSize:a.fixSize;v?(0,k.isNumber)(v)?(f=v,d=v):(f=v[0],d=v[1]):(f=Math.max(l.width,i[0])||i[0],d=Math.max(l.height,i[1])||i[1]),l.width=f+s[1]+s[3],l.height=d+s[0]+s[2];var x=e.get("sizeCache");x&&(x.width=l.width,x.height=l.height),l.x=-f/2-s[3],l.y=-d/2-s[0];var w={stroke:a.color},I=e.get("keyShape"),G=(0,k.mix)({},I.attr(),w,l);a.style?(a.style.width=f,a.style.height=d):a.style={width:f,height:d},this.updateShape(a,e,G,!1)}},"single-combo"),Gr.registerNode("simple-circle",{options:{size:Fe.defaultNode.size,style:{x:0,y:0,stroke:Fe.defaultNode.style.stroke,fill:Fe.defaultNode.style.fill,lineWidth:Fe.defaultNode.style.lineWidth},labelCfg:{style:{fill:Fe.nodeLabel.style.fill,fontSize:Fe.nodeLabel.style.fontSize,fontFamily:Fe.windowFontFamily}},stateStyles:(0,P.__assign)({},Fe.nodeStateStyles)},shapeType:"simple-circle",labelPosition:"center",shapeMap:{},drawShape:function(a,e){var i=this.getShapeStyle(a),s="".concat(this.type,"-keyShape"),l=e.addShape("circle",{attrs:i,className:"".concat(this.type,"-keyShape"),name:s,draggable:!0});return e.shapeMap[s]=l,l},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,k.deepMix)({},e,i),l=this.getSize(a),f=l[0]/2,d=(0,P.__assign)({x:0,y:0,r:f},s);return d},update:function(a,e,i){var s=this.getSize(a),l={stroke:a.color,r:s[0]/2},f=e.get("keyShape"),d=(0,k.deepMix)({},f.attr(),l,a.style);this.updateShape(a,e,d,!0,i)}},"single-node"),Gr.registerNode("simple-rect",{options:{size:[100,30],style:{radius:0,stroke:Fe.defaultNode.style.stroke,fill:Fe.defaultNode.style.fill,lineWidth:Fe.defaultNode.style.lineWidth},labelCfg:{style:{fill:Fe.nodeLabel.style.fill,fontSize:Fe.nodeLabel.style.fontSize,fontFamily:Fe.windowFontFamily}},anchorPoints:[[0,.5],[1,.5]],stateStyles:(0,P.__assign)({},Fe.nodeStateStyles)},shapeType:"simple-rect",labelPosition:"center",drawShape:function(a,e){var i=this.getShapeStyle(a),s=e.addShape("rect",{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return s},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,k.mix)({},e,i),l=this.getSize(a),f=s.width||l[0],d=s.height||l[1],v=(0,P.__assign)({x:-f/2,y:-d/2,width:f,height:d},s);return v},update:function(a,e,i){var s=e.getContainer(),l=(this.mergeStyle||this.getOptions(a)).style,f=this.getSize(a),d=e.get("keyShape");a.size||(f[0]=d.attr("width")||l.width,f[1]=d.attr("height")||l.height);var v={stroke:a.color,x:-f[0]/2,y:-f[1]/2,width:f[0],height:f[1]},x=(0,k.mix)({},l,d.attr(),v);x=(0,k.mix)(x,a.style),this.updateShape(a,e,x,!1,i)}},"single-node"),Gr.registerNode("image",{options:{img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*eD7nT6tmYgAAAAAAAAAAAABkARQnAQ",size:200,labelCfg:{style:{fontFamily:Fe.windowFontFamily}},clipCfg:{show:!1,type:"circle",r:50,rx:50,ry:35,width:50,height:35,points:[[30,12],[12,30],[30,48],[48,30]],path:[["M",25,25],["L",50,25],["A",12.5,12.5,0,1,1,50,50],["A",12.5,12.5,0,1,0,50,50],["L",25,75],["Z"]],x:0,y:0}},shapeType:"image",labelPosition:"bottom",drawShape:function(a,e){var i=this.shapeType,s=this.getShapeStyle(a);delete s.fill;var l=e.addShape(i,{attrs:s,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return this.drawClip(a,l),l},drawClip:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).clipCfg;if(!!i.show){var s=i.type,l=i.x,f=i.y,d=i.style;if(s==="circle"){var v=i.r;e.setClip({type:"circle",attrs:(0,P.__assign)({r:v,x:l,y:f},d)})}else if(s==="rect"){var x=i.width,w=i.height,I=l-x/2,G=f-w/2;e.setClip({type:"rect",attrs:(0,P.__assign)({x:I,y:G,width:x,height:w},d)})}else if(s==="ellipse"){var U=i.rx,et=i.ry;e.setClip({type:"ellipse",attrs:(0,P.__assign)({x:l,y:f,rx:U,ry:et},d)})}else if(s==="polygon"){var ft=i.points;e.setClip({type:"polygon",attrs:(0,P.__assign)({points:ft},d)})}else if(s==="path"){var Ct=i.path;e.setClip({type:"path",attrs:(0,P.__assign)({path:Ct},d)})}}},getShapeStyle:function(a){var e=this.mergeStyle||this.getOptions(a),i=e.style,s=e.img,l=this.getSize(a),f=l[0],d=l[1];i&&(f=i.width||l[0],d=i.height||l[1]);var v=(0,P.__assign)({x:-f/2,y:-d/2,width:f,height:d,img:s},i);return v},updateShapeStyle:function(a,e){var i=e.getContainer(),s="".concat(this.itemType,"-shape"),l=i.shapeMap[s]||i.find(function(d){return d.get("className")===s})||e.getKeyShape(),f=this.getShapeStyle(a);l&&!l.destroyed&&l.attr(f)}},"single-node");var Px={triangle:function(a,e,i){a===void 0&&(a=10),e===void 0&&(e=15),i===void 0&&(i=0);var s=i*2,l="M ".concat(s,",0 L ").concat(s+e,",-").concat(a/2," L ").concat(s+e,",").concat(a/2," Z");return l},vee:function(a,e,i){a===void 0&&(a=15),e===void 0&&(e=20),i===void 0&&(i=0);var s=i*2,l="M ".concat(s,",0 L ").concat(s+e,",-").concat(a/2,`
        L `).concat(s+2*e/3,",0 L ").concat(s+e,",").concat(a/2," Z");return l},circle:function(a,e){a===void 0&&(a=5),e===void 0&&(e=0);var i=e*2,s="M ".concat(i,`, 0
            a `).concat(a,",").concat(a," 0 1,0 ").concat(a*2,`,0
            a `).concat(a,",").concat(a," 0 1,0 ").concat(-a*2,",0");return s},rect:function(a,e,i){a===void 0&&(a=10),e===void 0&&(e=10),i===void 0&&(i=0);var s=i*2,l="M ".concat(s,",").concat(-a/2,` 
        L `).concat(s+e,",").concat(-a/2,` 
        L `).concat(s+e,",").concat(a/2,` 
        L `).concat(s,",").concat(a/2," Z");return l},diamond:function(a,e,i){a===void 0&&(a=15),e===void 0&&(e=15),i===void 0&&(i=0);var s=i*2,l="M ".concat(s,`,0 
        L `).concat(s+e/2,",").concat(-a/2,` 
        L `).concat(s+e,`,0 
        L `).concat(s+e/2,",").concat(a/2," Z");return l},triangleRect:function(a,e,i,s,l,f){a===void 0&&(a=15),e===void 0&&(e=15),i===void 0&&(i=15),s===void 0&&(s=3),l===void 0&&(l=5),f===void 0&&(f=0);var d=f*2,v=d+e+l,x="M ".concat(d,",0 L ").concat(d+e,",-").concat(a/2," L ").concat(d+e,",").concat(a/2,` Z
            M `).concat(v,", -").concat(i/2,`
            L `).concat(v+s," -").concat(i/2,`
            L `).concat(v+s," ").concat(i/2,`
            L `).concat(v," ").concat(i/2,`
            Z`);return x}},P1={collapse:function(a,e,i){return[["M",a-i,e],["a",i,i,0,1,0,i*2,0],["a",i,i,0,1,0,-i*2,0],["M",a-i+4,e],["L",a+i-4,e]]},expand:function(a,e,i){return[["M",a-i,e],["a",i,i,0,1,0,i*2,0],["a",i,i,0,1,0,-i*2,0],["M",a-i+4,e],["L",a-i+2*i-4,e],["M",a-i+i,e-i+4],["L",a,e+i-4]]},upTriangle:function(a,e,i){var s=i*Math.cos(Math.PI/6),l=i*Math.sin(Math.PI/6);return[["M",a-s,e+l],["L",a+s,e+l],["L",a,e-i],["Z"]]},downTriangle:function(a,e,i){var s=i*Math.cos(Math.PI/6),l=i*Math.sin(Math.PI/6);return[["M",a-s,e-l],["L",a+s,e-l],["L",a,e+i],["Z"]]}},rg=Gr,Hm=["#5F95FF","#61DDAA","#65789B","#F6BD16","#7262FD","#78D3F8","#9661BC","#F6903D","#008685","#F08BB4"],Fx=function(a){return a==="force"||a==="g6force"||a==="gForce"||a==="force2"},Xm=Le,FS=(0,P.__assign)((0,P.__assign)((0,P.__assign)((0,P.__assign)((0,P.__assign)((0,P.__assign)((0,P.__assign)({},Z),j),R),tt),L),C),{transform:Xm,mat3:pt}),Sc=FS,Bx=function(){function c(a){this.graph=a,this.layoutCfg=a.get("layout")||{},this.layoutType=this.getLayoutType(),this.layoutMethods=[],this.initLayout()}return c.prototype.initLayout=function(){},c.prototype.getLayoutType=function(){return this.getLayoutCfgType(this.layoutCfg)},c.prototype.getLayoutCfgType=function(a){var e=a.type;if(e)return e;var i=a.pipes;return Array.isArray(i)?i.map(function(s){return(s==null?void 0:s.type)||""}):null},c.prototype.isLayoutTypeSame=function(a){var e=this.getLayoutCfgType(a),i=Array.isArray(this.layoutType),s=Array.isArray(e);return i&&s?this.layoutType.every(function(l,f){return l===e[f]}):Array.isArray(e)||Array.isArray(this.layoutType)?!1:(a==null?void 0:a.type)===this.layoutType},c.prototype.refreshLayout=function(){var a=this,e=a.graph,i=a.layoutType,s=a.layoutCfg,l=s===void 0?{}:s;if(!!e){var f=l.animate,d=f===void 0&&(i==="force"||i==="force2"),v=Fx(i)&&(f||d);e.get("animate")&&!v?e.positionsAnimate(i==="comboCombined"):e.refreshPositions(i==="comboCombined")}},c.prototype.changeLayout=function(a){var e=a.disableTriggerLayout,i=(0,P.__rest)(a,["disableTriggerLayout"]);this.layoutCfg=i,this.layoutType=i.type||this.layoutType,!e&&this.layout()},c.prototype.changeData=function(a){this.layout(a)},c.prototype.destoryLayoutMethods=function(){var a=this.layoutMethods,e=[];return a==null||a.forEach(function(i){var s,l=(s=i.getType)===null||s===void 0?void 0:s.call(i);l&&e.push(l),i.destroy()}),this.layoutMethods=[],e},c.prototype.destroyLayout=function(){this.destoryLayoutMethods();var a=this.graph;a&&!a.get("destroyed")&&a.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0},c.prototype.setDataFromGraph=function(){for(var a,e=[],i=[],s=[],l=[],f=[],d=[],v=[],x=this.graph.getNodes(),w=this.graph.getEdges(),I=this.graph.getCombos(),G=x.length,U=0;U<G;U++){var et=x[U];if(!(!et||et.destroyed)){var ft=et.getModel();if(!et.isVisible()){i.push(ft);continue}e.push(ft)}}for(var Ct=w.length,U=0;U<Ct;U++){var Mt=w[U];if(!(!Mt||Mt.destroyed)){var ft=Mt.getModel();if(!Mt.isVisible()){l.push(ft);continue}ft.isComboEdge?f.push(ft):s.push(ft)}}for(var kt=I.length,U=0;U<kt;U++){var $t=I[U];if(!$t.destroyed){var ft=$t.getModel();if(!$t.isVisible()){v.push(ft);continue}d.push(ft)}}return{nodes:e,hiddenNodes:i,edges:s,hiddenEdges:l,combos:d,hiddenCombos:v,comboEdges:f,vedges:(a=this.graph.get("vedges"))===null||a===void 0?void 0:a.map(function(Jt){return Jt.getModel()})}},c.prototype.relayout=function(a){var e=this,i=this,s=i.graph,l=i.layoutMethods,f=i.layoutCfg;if(!(!s||s.get("destroyed"))){var d=Promise.resolve();if(a){this.data=this.setDataFromGraph();var v=this.data.nodes;if(!v)return!1;d=this.initPositions(f.center,v)}s.emit("beforelayout"),l==null||l.forEach(function(x,w){var I=f[w]||f;d=d.then(function(){var G,U=e.execLayoutMethod(I,w);return w===l.length-1&&((G=f.onAllLayoutEnd)===null||G===void 0||G.call(f)),U})})}},c.prototype.filterLayoutData=function(a,e){var i=a.nodes,s=a.edges,l=(0,P.__rest)(a,["nodes","edges"]);if(!i)return a;var f,d;(0,k.isFunction)(e==null?void 0:e.nodesFilter)?f=e.nodesFilter:f=function(){return!0};var v=i.filter(f);if((0,k.isFunction)(e==null?void 0:e.edgesFilter))d=e.edgesFilter;else{var x=v.reduce(function(w,I){return w[I.id]=!0,w},{});d=function(I){return x[I.source]&&x[I.target]}}return(0,P.__assign)({nodes:v,edges:s.filter(d)},l)},c.prototype.getLayoutBBox=function(a){var e=this.graph,i=(0,k.groupBy)(e.getNodes(),function(f){return f.getModel().layoutOrder}),s=Object.values(i).map(function(f){var d=It(f);return d.size=[d.width,d.height],d}),l=Object.values((0,k.groupBy)(a,"layoutOrder"));return{groupNodes:l,layoutNodes:s}},c.prototype.layoutAnimate=function(){},c.prototype.moveToZero=function(){var a=this.graph,e=a.get("data"),i=e.nodes;if(!(i[0].x===void 0||i[0].x===null||vt(i[0].x))){for(var s=[0,0],l=i.length,f=0;f<l;f++){var d=i[f];s[0]+=d.x,s[1]+=d.y}s[0]/=i.length,s[1]/=i.length;for(var f=0;f<l;f++){var d=i[f];d.x-=s[0],d.y-=s[1]}}},c.prototype.initPositions=function(a,e){var i;return(0,P.__awaiter)(this,void 0,void 0,function(){var s,l,f;return(0,P.__generator)(this,function(d){return s=this.graph,(e==null?void 0:e.length)?(l=e.filter(function(v){return vt(v.x)||vt(v.y)}),f=l?l.length:0,f?[2,(i=this.initWithPreset)===null||i===void 0?void 0:i.call(this,function(){},function(){var v=s.get("width")*.85,x=s.get("height")*.85,w=Math.ceil(Math.sqrt(f)*(v/x)),I=Math.ceil(f/w),G=v/(w-1),U=x/(I-1);(!isFinite(G)||!G)&&(G=0),(!isFinite(U)||!G)&&(U=0);for(var et=a[0]-v/2,ft=a[1]-x/2,Ct=!0,Mt=0;Mt<f;Mt++){var kt=l[Mt];vt(+kt.x)&&(Ct=!1,kt.x=Mt%w*G+et),vt(+kt.y)&&(Ct=!1,kt.y=Math.floor(Mt/w)*U+ft)}})]:[2]):[2,Promise.resolve()]})})},c.prototype.destroy=function(){this.graph=null,this.destoryLayoutMethods(),this.destroyed=!0},c}(),zx=Bx,F1=function(){function c(a){this.graph=a,this.destroyed=!1,this.initEvents()}return c}(),$x=F1,zc=rg.registerNode,Gx=rg.registerEdge,q0=rg.registerCombo,Ux=ht.registerBehavior,oi=Fe,mA={version:Fe.version,AbstractGraph:X0,BaseGlobal:oi,Util:Sc,Shape:rg,Node:Co,Edge:Po,Combo:hu,Hull:Qh,registerNode:rg.registerNode,registerEdge:rg.registerEdge,registerCombo:rg.registerCombo,registerBehavior:ht.registerBehavior,Arrow:Px,Marker:P1,AbstractLayout:zx,AbstractEvent:$x},hm=$(10369);function BS(){return window?window.devicePixelRatio:1}function B1(c,a,e,i){var s=c-e,l=a-i;return Math.sqrt(s*s+l*l)}function Tg(c,a,e,i,s,l){return s>=c&&s<=c+e&&l>=a&&l<=a+i}function Gf(c,a){return!(a.minX>c.maxX||a.maxX<c.minX||a.minY>c.maxY||a.maxY<c.minY)}function zS(c,a){return!c||!a?c||a:{minX:Math.min(c.minX,a.minX),minY:Math.min(c.minY,a.minY),maxX:Math.max(c.maxX,a.maxX),maxY:Math.max(c.maxY,a.maxY)}}function ss(c,a){return c[0]===a[0]&&c[1]===a[1]}var $S=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Q0=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,z1=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,$1=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function uf(c,a){var e=c.match($1);(0,k.each)(e,function(i){var s=i.split(":");a.addColorStop(s[0],s[1])})}function $c(c,a,e){var i=$S.exec(e),s=parseFloat(i[1])%360*(Math.PI/180),l=i[2],f=a.getBBox(),d,v;s>=0&&s<1/2*Math.PI?(d={x:f.minX,y:f.minY},v={x:f.maxX,y:f.maxY}):1/2*Math.PI<=s&&s<Math.PI?(d={x:f.maxX,y:f.minY},v={x:f.minX,y:f.maxY}):Math.PI<=s&&s<3/2*Math.PI?(d={x:f.maxX,y:f.maxY},v={x:f.minX,y:f.minY}):(d={x:f.minX,y:f.maxY},v={x:f.maxX,y:f.minY});var x=Math.tan(s),w=x*x,I=(v.x-d.x+x*(v.y-d.y))/(w+1)+d.x,G=x*(v.x-d.x+x*(v.y-d.y))/(w+1)+d.y,U=c.createLinearGradient(d.x,d.y,I,G);return uf(l,U),U}function kf(c,a,e){var i=Q0.exec(e),s=parseFloat(i[1]),l=parseFloat(i[2]),f=parseFloat(i[3]),d=i[4];if(f===0){var v=d.match($1);return v[v.length-1].split(":")[1]}var x=a.getBBox(),w=x.maxX-x.minX,I=x.maxY-x.minY,G=Math.sqrt(w*w+I*I)/2,U=c.createRadialGradient(x.minX+w*s,x.minY+I*l,0,x.minX+w/2,x.minY+I/2,f*G);return uf(d,U),U}function Gc(c,a,e){if(a.get("patternSource")&&a.get("patternSource")===e)return a.get("pattern");var i,s,l=z1.exec(e),f=l[1],d=l[2];function v(){i=c.createPattern(s,f),a.set("pattern",i),a.set("patternSource",e)}switch(f){case"a":f="repeat";break;case"x":f="repeat-x";break;case"y":f="repeat-y";break;case"n":f="no-repeat";break;default:f="no-repeat"}return s=new Image,d.match(/^data:/i)||(s.crossOrigin="Anonymous"),s.src=d,s.complete?v():(s.onload=v,s.src=s.src),i}function dm(c,a,e){var i=a.getBBox();if(isNaN(i.x)||isNaN(i.y)||isNaN(i.width)||isNaN(i.height))return e;if((0,k.isString)(e)){if(e[1]==="("||e[2]==="("){if(e[0]==="l")return $c(c,a,e);if(e[0]==="r")return kf(c,a,e);if(e[0]==="p")return Gc(c,a,e)}return e}if(e instanceof CanvasPattern)return e}function Qc(c){var a=0,e=0,i=0,s=0;return(0,k.isArray)(c)?c.length===1?a=e=i=s=c[0]:c.length===2?(a=i=c[0],e=s=c[1]):c.length===3?(a=c[0],e=s=c[1],i=c[2]):(a=c[0],e=c[1],i=c[2],s=c[3]):a=e=i=s=c,[a,e,i,s]}function J0(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Ym(c,a){return J0(c)*J0(a)?(c[0]*a[0]+c[1]*a[1])/(J0(c)*J0(a)):1}function Wx(c,a){return(c[0]*a[1]<c[1]*a[0]?-1:1)*Math.acos(Ym(c,a))}function Ed(c,a){var e=a[1],i=a[2],s=(0,k.mod)((0,k.toRadian)(a[3]),Math.PI*2),l=a[4],f=a[5],d=c[0],v=c[1],x=a[6],w=a[7],I=Math.cos(s)*(d-x)/2+Math.sin(s)*(v-w)/2,G=-1*Math.sin(s)*(d-x)/2+Math.cos(s)*(v-w)/2,U=I*I/(e*e)+G*G/(i*i);U>1&&(e*=Math.sqrt(U),i*=Math.sqrt(U));var et=e*e*(G*G)+i*i*(I*I),ft=et?Math.sqrt((e*e*(i*i)-et)/et):1;l===f&&(ft*=-1),isNaN(ft)&&(ft=0);var Ct=i?ft*e*G/i:0,Mt=e?ft*-i*I/e:0,kt=(d+x)/2+Math.cos(s)*Ct-Math.sin(s)*Mt,$t=(v+w)/2+Math.sin(s)*Ct+Math.cos(s)*Mt,Jt=[(I-Ct)/e,(G-Mt)/i],Ce=[(-1*I-Ct)/e,(-1*G-Mt)/i],je=Wx([1,0],Jt),ze=Wx(Jt,Ce);return Ym(Jt,Ce)<=-1&&(ze=Math.PI),Ym(Jt,Ce)>=1&&(ze=0),f===0&&ze>0&&(ze=ze-2*Math.PI),f===1&&ze<0&&(ze=ze+2*Math.PI),{cx:kt,cy:$t,rx:ss(c,[x,w])?0:e,ry:ss(c,[x,w])?0:i,startAngle:je,endAngle:je+ze,xRotation:s,arcFlag:l,sweepFlag:f}}var ty=Math.sin,ag=Math.cos,G1=Math.atan2,Ag=Math.PI;function Vx(c,a,e,i,s,l,f){var d=a.stroke,v=a.lineWidth,x=e-s,w=i-l,I=G1(w,x),G=new kg({type:"path",canvas:c.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*ag(Ag/6)+","+10*ty(Ag/6)+" L0,0 L"+10*ag(Ag/6)+",-"+10*ty(Ag/6),stroke:d,lineWidth:v}});G.translate(s,l),G.rotateAtPoint(s,l,I),c.set(f?"startArrowShape":"endArrowShape",G)}function U1(c,a,e,i,s,l,f){var d=a.startArrow,v=a.endArrow,x=a.stroke,w=a.lineWidth,I=f?d:v,G=I.d,U=I.fill,et=I.stroke,ft=I.lineWidth,Ct=(0,P.__rest)(I,["d","fill","stroke","lineWidth"]),Mt=e-s,kt=i-l,$t=G1(kt,Mt);G&&(s=s-ag($t)*G,l=l-ty($t)*G);var Jt=new kg({type:"path",canvas:c.get("canvas"),isArrowShape:!0,attrs:(0,P.__assign)((0,P.__assign)({},Ct),{stroke:et||x,lineWidth:ft||w,fill:U})});Jt.translate(s,l),Jt.rotateAtPoint(s,l,$t),c.set(f?"startArrowShape":"endArrowShape",Jt)}function Mg(c,a,e,i,s){var l=G1(i-a,e-c);return{dx:ag(l)*s,dy:ty(l)*s}}function Ng(c,a,e,i,s,l){typeof a.startArrow=="object"?U1(c,a,e,i,s,l,!0):a.startArrow?Vx(c,a,e,i,s,l,!0):c.set("startArrowShape",null)}function W1(c,a,e,i,s,l){typeof a.endArrow=="object"?U1(c,a,e,i,s,l,!1):a.endArrow?Vx(c,a,e,i,s,l,!1):c.set("startArrowShape",null)}var ey={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function pm(c,a){var e=a.attr();for(var i in e){var s=e[i],l=ey[i]?ey[i]:i;l==="matrix"&&s?c.transform(s[0],s[1],s[3],s[4],s[6],s[7]):l==="lineDash"&&c.setLineDash?(0,k.isArray)(s)&&c.setLineDash(s):(l==="strokeStyle"||l==="fillStyle"?s=dm(c,a,s):l==="globalAlpha"&&(s=s*c.globalAlpha),c[l]=s)}}function ny(c,a,e){for(var i=0;i<a.length;i++){var s=a[i];s.cfg.visible?s.draw(c,e):s.skipDraw()}}function GS(c,a,e){var i=c.get("refreshElements");(0,k.each)(i,function(s){if(s!==c)for(var l=s.cfg.parent;l&&l!==c&&!l.cfg.refresh;)l.cfg.refresh=!0,l=l.cfg.parent}),i[0]===c?ig(a,e):nc(a,e)}function nc(c,a){for(var e=0;e<c.length;e++){var i=c[e];if(i.cfg.visible)if(i.cfg.hasChanged)i.cfg.refresh=!0,i.isGroup()&&ig(i.cfg.children,a);else if(i.cfg.refresh)i.isGroup()&&nc(i.cfg.children,a);else{var s=US(i,a);i.cfg.refresh=s,s&&i.isGroup()&&nc(i.cfg.children,a)}}}function jx(c){for(var a=0;a<c.length;a++){var e=c[a];e.cfg.hasChanged=!1,e.isGroup()&&!e.destroyed&&jx(e.cfg.children)}}function ig(c,a){for(var e=0;e<c.length;e++){var i=c[e];!i.cfg.visible||(i.cfg.refresh=!0,i.isGroup()&&ig(i.get("children"),a))}}function US(c,a){var e=c.cfg.cacheCanvasBBox,i=c.cfg.isInView&&e&&Gf(e,a);return i}function og(c,a,e,i){var s=e.path,l=e.startArrow,f=e.endArrow;if(!!s){var d=[0,0],v=[0,0],x={dx:0,dy:0};a.beginPath();for(var w=0;w<s.length;w++){var I=s[w],G=I[0];if(w===0&&l&&l.d){var U=c.getStartTangent();x=Mg(U[0][0],U[0][1],U[1][0],U[1][1],l.d)}else if(w===s.length-2&&s[w+1][0]==="Z"&&f&&f.d){var et=s[w+1];if(et[0]==="Z"){var U=c.getEndTangent();x=Mg(U[0][0],U[0][1],U[1][0],U[1][1],f.d)}}else if(w===s.length-1&&f&&f.d&&s[0]!=="Z"){var U=c.getEndTangent();x=Mg(U[0][0],U[0][1],U[1][0],U[1][1],f.d)}var ft=x.dx,Ct=x.dy;switch(G){case"M":a.moveTo(I[1]-ft,I[2]-Ct),v=[I[1],I[2]];break;case"L":a.lineTo(I[1]-ft,I[2]-Ct);break;case"Q":a.quadraticCurveTo(I[1],I[2],I[3]-ft,I[4]-Ct);break;case"C":a.bezierCurveTo(I[1],I[2],I[3],I[4],I[5]-ft,I[6]-Ct);break;case"A":{var Mt=void 0;i?(Mt=i[w],Mt||(Mt=Ed(d,I),i[w]=Mt)):Mt=Ed(d,I);var kt=Mt.cx,$t=Mt.cy,Jt=Mt.rx,Ce=Mt.ry,je=Mt.startAngle,ze=Mt.endAngle,pn=Mt.xRotation,Fn=Mt.sweepFlag;if(a.ellipse)a.ellipse(kt,$t,Jt,Ce,pn,je,ze,1-Fn);else{var Tn=Jt>Ce?Jt:Ce,cr=Jt>Ce?1:Jt/Ce,kr=Jt>Ce?Ce/Jt:1;a.translate(kt,$t),a.rotate(pn),a.scale(cr,kr),a.arc(0,0,Tn,je,ze,1-Fn),a.scale(1/cr,1/kr),a.rotate(-pn),a.translate(-kt,-$t)}break}case"Z":a.closePath();break;default:break}if(G==="Z")d=v;else{var Aa=I.length;d=[I[Aa-2],I[Aa-1]]}}}}function Hx(c,a){var e=c.get("canvas");e&&(a==="remove"&&(c._cacheCanvasBBox=c.get("cacheCanvasBBox")),c.get("hasChanged")||(c.set("hasChanged",!0),c.cfg.parent&&c.cfg.parent.get("hasChanged")||(e.refreshElement(c,a,e),e.get("autoDraw")&&e.draw())))}function V1(c){var a;if(c.destroyed)a=c._cacheCanvasBBox;else{var e=c.get("cacheCanvasBBox"),i=e&&!!(e.width&&e.height),s=c.getCanvasBBox(),l=s&&!!(s.width&&s.height);i&&l?a=zS(e,s):i?a=e:l&&(a=s)}return a}function WS(c){if(!c.length)return null;var a=[],e=[],i=[],s=[];return(0,k.each)(c,function(l){var f=V1(l);f&&(a.push(f.minX),e.push(f.minY),i.push(f.maxX),s.push(f.maxY))}),{minX:(0,k.min)(a),minY:(0,k.min)(e),maxX:(0,k.max)(i),maxY:(0,k.max)(s)}}function ry(c,a){return!c||!a||!Gf(c,a)?null:{minX:Math.max(c.minX,a.minX),minY:Math.max(c.minY,a.minY),maxX:Math.min(c.maxX,a.maxX),maxY:Math.min(c.maxY,a.maxY)}}var VS=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.onCanvasChange=function(e){Hx(this,e)},a.prototype.getShapeBase=function(){return A},a.prototype.getGroupBase=function(){return a},a.prototype._applyClip=function(e,i){i&&(e.save(),pm(e,i),i.createPath(e),e.restore(),e.clip(),i._afterDraw())},a.prototype.cacheCanvasBBox=function(){var e=this.cfg.children,i=[],s=[];(0,k.each)(e,function(G){var U=G.cfg.cacheCanvasBBox;U&&G.cfg.isInView&&(i.push(U.minX,U.maxX),s.push(U.minY,U.maxY))});var l=null;if(i.length){var f=(0,k.min)(i),d=(0,k.max)(i),v=(0,k.min)(s),x=(0,k.max)(s);l={minX:f,minY:v,x:f,y:v,maxX:d,maxY:x,width:d-f,height:x-v};var w=this.cfg.canvas;if(w){var I=w.getViewRange();this.set("isInView",Gf(l,I))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",l)},a.prototype.draw=function(e,i){var s=this.cfg.children,l=i?this.cfg.refresh:!0;s.length&&l&&(e.save(),pm(e,this),this._applyClip(e,this.getClip()),ny(e,s,i),e.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},a.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},a}(lv),Km=VS,jS=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},a.prototype.getShapeBase=function(){return A},a.prototype.getGroupBase=function(){return Km},a.prototype.onCanvasChange=function(e){Hx(this,e)},a.prototype.calculateBBox=function(){var e=this.get("type"),i=this.getHitLineWidth(),s=Rv(e),l=s(this),f=i/2,d=l.x-f,v=l.y-f,x=l.x+l.width+f,w=l.y+l.height+f;return{x:d,minX:d,y:v,minY:v,width:l.width+i,height:l.height+i,maxX:x,maxY:w}},a.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},a.prototype.isStroke=function(){return!!this.attrs.stroke},a.prototype._applyClip=function(e,i){i&&(e.save(),pm(e,i),i.createPath(e),e.restore(),e.clip(),i._afterDraw())},a.prototype.draw=function(e,i){var s=this.cfg.clipShape;if(i){if(this.cfg.refresh===!1){this.set("hasChanged",!1);return}var l=this.getCanvasBBox();if(!Gf(i,l)){this.set("hasChanged",!1),this.cfg.isInView&&this._afterDraw();return}}e.save(),pm(e,this),this._applyClip(e,s),this.drawPath(e),e.restore(),this._afterDraw()},a.prototype.getCanvasViewBox=function(){var e=this.cfg.canvas;return e?e.getViewRange():null},a.prototype.cacheCanvasBBox=function(){var e=this.getCanvasViewBox();if(e){var i=this.getCanvasBBox(),s=Gf(i,e);this.set("isInView",s),s?this.set("cacheCanvasBBox",i):this.set("cacheCanvasBBox",null)}},a.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},a.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},a.prototype.drawPath=function(e){this.createPath(e),this.strokeAndFill(e),this.afterDrawPath(e)},a.prototype.fill=function(e){e.fill()},a.prototype.stroke=function(e){e.stroke()},a.prototype.strokeAndFill=function(e){var i=this.attrs,s=i.lineWidth,l=i.opacity,f=i.strokeOpacity,d=i.fillOpacity;this.isFill()&&(!(0,k.isNil)(d)&&d!==1?(e.globalAlpha=d,this.fill(e),e.globalAlpha=l):this.fill(e)),this.isStroke()&&s>0&&(!(0,k.isNil)(f)&&f!==1&&(e.globalAlpha=f),this.stroke(e)),this.afterDrawPath(e)},a.prototype.createPath=function(e){},a.prototype.afterDrawPath=function(e){},a.prototype.isInShape=function(e,i){var s=this.isStroke(),l=this.isFill(),f=this.getHitLineWidth();return this.isInStrokeOrPath(e,i,s,l,f)},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){return!1},a.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var e=this.attrs;return e.lineWidth+e.lineAppendWidth},a}(yd),Dp=jS,HS=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x:0,y:0,r:0})},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){var d=this.attr(),v=d.x,x=d.y,w=d.r,I=f/2,G=B1(v,x,e,i);return l&&s?G<=w+I:l?G<=w:s?G>=w-I&&G<=w+I:!1},a.prototype.createPath=function(e){var i=this.attr(),s=i.x,l=i.y,f=i.r;e.beginPath(),e.arc(s,l,f,0,Math.PI*2,!1),e.closePath()},a}(Dp),Xx=HS;function ay(c,a,e,i){return c/(e*e)+a/(i*i)}var sg=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x:0,y:0,rx:0,ry:0})},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){var d=this.attr(),v=f/2,x=d.x,w=d.y,I=d.rx,G=d.ry,U=(e-x)*(e-x),et=(i-w)*(i-w);return l&&s?ay(U,et,I+v,G+v)<=1:l?ay(U,et,I,G)<=1:s?ay(U,et,I-v,G-v)>=1&&ay(U,et,I+v,G+v)<=1:!1},a.prototype.createPath=function(e){var i=this.attr(),s=i.x,l=i.y,f=i.rx,d=i.ry;if(e.beginPath(),e.ellipse)e.ellipse(s,l,f,d,0,0,Math.PI*2,!1);else{var v=f>d?f:d,x=f>d?1:f/d,w=f>d?d/f:1;e.save(),e.translate(s,l),e.scale(x,w),e.arc(0,0,v,0,Math.PI*2),e.restore(),e.closePath()}},a}(Dp),Uc=sg;function Op(c){return c instanceof HTMLElement&&(0,k.isString)(c.nodeName)&&c.nodeName.toUpperCase()==="CANVAS"}var XS=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x:0,y:0,width:0,height:0})},a.prototype.initAttrs=function(e){this._setImage(e.img)},a.prototype.isStroke=function(){return!1},a.prototype.isOnlyHitBox=function(){return!0},a.prototype._afterLoading=function(){if(this.get("toDraw")===!0){var e=this.get("canvas");e?e.draw():this.createPath(this.get("context"))}},a.prototype._setImage=function(e){var i=this,s=this.attrs;if((0,k.isString)(e)){var l=new Image;l.onload=function(){if(i.destroyed)return!1;i.attr("img",l),i.set("loading",!1),i._afterLoading();var f=i.get("callback");f&&f.call(i)},l.crossOrigin="Anonymous",l.src=e,this.set("loading",!0)}else e instanceof Image?(s.width||(s.width=e.width),s.height||(s.height=e.height)):Op(e)&&(s.width||(s.width=Number(e.getAttribute("width"))),s.height||(s.height,Number(e.getAttribute("height"))))},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),e==="img"&&this._setImage(i)},a.prototype.createPath=function(e){if(this.get("loading")){this.set("toDraw",!0),this.set("context",e);return}var i=this.attr(),s=i.x,l=i.y,f=i.width,d=i.height,v=i.sx,x=i.sy,w=i.swidth,I=i.sheight,G=i.img;(G instanceof Image||Op(G))&&(!(0,k.isNil)(v)&&!(0,k.isNil)(x)&&!(0,k.isNil)(w)&&!(0,k.isNil)(I)?e.drawImage(G,v,x,w,I,s,l,f,d):e.drawImage(G,s,l,f,d))},a}(Dp),Jh=XS;function ug(c,a,e,i,s,l,f){var d=Math.min(c,e),v=Math.max(c,e),x=Math.min(a,i),w=Math.max(a,i),I=s/2;return l>=d-I&&l<=v+I&&f>=x-I&&f<=w+I?Hr.pointToLine(c,a,e,i,l,f)<=s/2:!1}var YS=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},a.prototype.initAttrs=function(e){this.setArrow()},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),this.setArrow()},a.prototype.setArrow=function(){var e=this.attr(),i=e.x1,s=e.y1,l=e.x2,f=e.y2,d=e.startArrow,v=e.endArrow;d&&Ng(this,e,l,f,i,s),v&&W1(this,e,i,s,l,f)},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){if(!s||!f)return!1;var d=this.attr(),v=d.x1,x=d.y1,w=d.x2,I=d.y2;return ug(v,x,w,I,f,e,i)},a.prototype.createPath=function(e){var i=this.attr(),s=i.x1,l=i.y1,f=i.x2,d=i.y2,v=i.startArrow,x=i.endArrow,w={dx:0,dy:0},I={dx:0,dy:0};v&&v.d&&(w=Mg(s,l,f,d,i.startArrow.d)),x&&x.d&&(I=Mg(s,l,f,d,i.endArrow.d)),e.beginPath(),e.moveTo(s+w.dx,l+w.dy),e.lineTo(f-I.dx,d-I.dy)},a.prototype.afterDrawPath=function(e){var i=this.get("startArrowShape"),s=this.get("endArrowShape");i&&i.draw(e),s&&s.draw(e)},a.prototype.getTotalLength=function(){var e=this.attr(),i=e.x1,s=e.y1,l=e.x2,f=e.y2;return Hr.length(i,s,l,f)},a.prototype.getPoint=function(e){var i=this.attr(),s=i.x1,l=i.y1,f=i.x2,d=i.y2;return Hr.pointAt(s,l,f,d,e)},a}(Dp),KS=YS,zv={circle:function(c,a,e){return[["M",c-e,a],["A",e,e,0,1,0,c+e,a],["A",e,e,0,1,0,c-e,a]]},square:function(c,a,e){return[["M",c-e,a-e],["L",c+e,a-e],["L",c+e,a+e],["L",c-e,a+e],["Z"]]},diamond:function(c,a,e){return[["M",c-e,a],["L",c,a-e],["L",c+e,a],["L",c,a+e],["Z"]]},triangle:function(c,a,e){var i=e*Math.sin(1/3*Math.PI);return[["M",c-e,a+i],["L",c,a-i],["L",c+e,a+i],["Z"]]},"triangle-down":function(c,a,e){var i=e*Math.sin(1/3*Math.PI);return[["M",c-e,a-i],["L",c+e,a-i],["L",c,a+i],["Z"]]}},ZS=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.initAttrs=function(e){this._resetParamsCache()},a.prototype._resetParamsCache=function(){this.set("paramsCache",{})},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),["symbol","x","y","r","radius"].indexOf(e)!==-1&&this._resetParamsCache()},a.prototype.isOnlyHitBox=function(){return!0},a.prototype._getR=function(e){return(0,k.isNil)(e.r)?e.radius:e.r},a.prototype._getPath=function(){var e=this.attr(),i=e.x,s=e.y,l=e.symbol||"circle",f=this._getR(e),d,v;if((0,k.isFunction)(l))d=l,v=d(i,s,f),v=vr(v);else{if(d=a.Symbols[l],!d)return console.warn(l+" marker is not supported."),null;v=d(i,s,f)}return v},a.prototype.createPath=function(e){var i=this._getPath(),s=this.get("paramsCache");og(this,e,{path:i},s)},a.Symbols=zv,a}(Dp),qS=ZS;function Yx(c,a,e){var i=zu();return c.createPath(i),i.isPointInPath(a,e)}var QS=1e-6;function j1(c){return Math.abs(c)<QS?0:c<0?-1:1}function JS(c,a,e){return(e[0]-c[0])*(a[1]-c[1])==(a[0]-c[0])*(e[1]-c[1])&&Math.min(c[0],a[0])<=e[0]&&e[0]<=Math.max(c[0],a[0])&&Math.min(c[1],a[1])<=e[1]&&e[1]<=Math.max(c[1],a[1])}function Kx(c,a,e){var i=!1,s=c.length;if(s<=2)return!1;for(var l=0;l<s;l++){var f=c[l],d=c[(l+1)%s];if(JS(f,d,[a,e]))return!0;j1(f[1]-e)>0!=j1(d[1]-e)>0&&j1(a-(e-f[1])*(f[0]-d[0])/(f[1]-d[1])-f[0])<0&&(i=!i)}return i}function Zm(c,a,e,i,s,l,f,d){var v=(Math.atan2(d-a,f-c)+Math.PI*2)%(Math.PI*2);if(v<i||v>s)return!1;var x={x:c+e*Math.cos(v),y:a+e*Math.sin(v)};return B1(x.x,x.y,f,d)<=l/2}var t2=Le;function qm(c){for(var a=!1,e=c.length,i=0;i<e;i++){var s=c[i],l=s[0];if(l==="C"||l==="A"||l==="Q"){a=!0;break}}return a}function e2(c,a,e,i,s){for(var l=!1,f=a/2,d=0;d<c.length;d++){var v=c[d],x=v.currentPoint,w=v.params,I=v.prePoint,G=v.box;if(!(G&&!Tg(G.x-f,G.y-f,G.width+a,G.height+a,e,i))){switch(v.command){case"L":case"Z":l=ug(I[0],I[1],x[0],x[1],a,e,i);break;case"Q":var U=dt.pointDistance(I[0],I[1],w[1],w[2],w[3],w[4],e,i);l=U<=a/2;break;case"C":var et=Te.pointDistance(I[0],I[1],w[1],w[2],w[3],w[4],w[5],w[6],e,i,s);l=et<=a/2;break;case"A":var ft=v.arcParams,Ct=ft.cx,Mt=ft.cy,kt=ft.rx,$t=ft.ry,Jt=ft.startAngle,Ce=ft.endAngle,je=ft.xRotation,ze=[e,i,1],pn=kt>$t?kt:$t,Fn=kt>$t?1:kt/$t,Tn=kt>$t?$t/kt:1,cr=t2(null,[["t",-Ct,-Mt],["r",-je],["s",1/Fn,1/Tn]]);ji.transformMat3(ze,ze,cr),l=Zm(0,0,pn,Jt,Ce,a,ze[0],ze[1]);break;default:break}if(l)break}}return l}function n2(c){for(var a=c.length,e=[],i=[],s=[],l=0;l<a;l++){var f=c[l],d=f[0];d==="M"?(s.length&&(i.push(s),s=[]),s.push([f[1],f[2]])):d==="Z"?s.length&&(e.push(s),s=[]):s.push([f[1],f[2]])}return s.length>0&&i.push(s),{polygons:e,polylines:i}}var iy=(0,P.__assign)({hasArc:qm,extractPolygons:n2,isPointInStroke:e2},W);function H1(c,a,e){for(var i=!1,s=0;s<c.length;s++){var l=c[s];if(i=Kx(l,a,e),i)break}return i}var r2=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{startArrow:!1,endArrow:!1})},a.prototype.initAttrs=function(e){this._setPathArr(e.path),this.setArrow()},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),e==="path"&&this._setPathArr(i),this.setArrow()},a.prototype._setPathArr=function(e){this.attrs.path=vr(e);var i=iy.hasArc(e);this.set("hasArc",i),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},a.prototype.getSegments=function(){var e=this.get("segements");return e||(e=im(this.attr("path")),this.set("segments",e)),e},a.prototype.setArrow=function(){var e=this.attr(),i=e.startArrow,s=e.endArrow;if(i){var l=this.getStartTangent();Ng(this,e,l[0][0],l[0][1],l[1][0],l[1][1])}if(s){var l=this.getEndTangent();W1(this,e,l[0][0],l[0][1],l[1][0],l[1][1])}},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){var d=this.getSegments(),v=this.get("hasArc"),x=!1;if(s){var w=this.getTotalLength();x=iy.isPointInStroke(d,f,e,i,w)}if(!x&&l)if(v)x=Yx(this,e,i);else{var I=this.attr("path"),G=iy.extractPolygons(I);x=H1(G.polygons,e,i)||H1(G.polylines,e,i)}return x},a.prototype.createPath=function(e){var i=this.attr(),s=this.get("paramsCache");og(this,e,i,s)},a.prototype.afterDrawPath=function(e){var i=this.get("startArrowShape"),s=this.get("endArrowShape");i&&i.draw(e),s&&s.draw(e)},a.prototype.getTotalLength=function(){var e=this.get("totalLength");return(0,k.isNil)(e)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):e},a.prototype.getPoint=function(e){var i=this.get("tCache");i||(this._calculateCurve(),this._setTcache(),i=this.get("tCache"));var s,l,f=this.get("curve");if(!i||i.length===0)return f?{x:f[0][1],y:f[0][2]}:null;(0,k.each)(i,function(w,I){e>=w[0]&&e<=w[1]&&(s=(e-w[0])/(w[1]-w[0]),l=I)});var d=f[l];if((0,k.isNil)(d)||(0,k.isNil)(l))return null;var v=d.length,x=f[l+1];return Te.pointAt(d[v-2],d[v-1],x[1],x[2],x[3],x[4],x[5],x[6],s)},a.prototype._calculateCurve=function(){var e=this.attr().path;this.set("curve",iy.pathToCurve(e))},a.prototype._setTcache=function(){var e=0,i=0,s=[],l,f,d,v,x=this.get("curve");if(!!x){if((0,k.each)(x,function(w,I){d=x[I+1],v=w.length,d&&(e+=Te.length(w[v-2],w[v-1],d[1],d[2],d[3],d[4],d[5],d[6])||0)}),this.set("totalLength",e),e===0){this.set("tCache",[]);return}(0,k.each)(x,function(w,I){d=x[I+1],v=w.length,d&&(l=[],l[0]=i/e,f=Te.length(w[v-2],w[v-1],d[1],d[2],d[3],d[4],d[5],d[6]),i+=f||0,l[1]=i/e,s.push(l))}),this.set("tCache",s)}},a.prototype.getStartTangent=function(){var e=this.getSegments(),i;if(e.length>1){var s=e[0].currentPoint,l=e[1].currentPoint,f=e[1].startTangent;i=[],f?(i.push([s[0]-f[0],s[1]-f[1]]),i.push([s[0],s[1]])):(i.push([l[0],l[1]]),i.push([s[0],s[1]]))}return i},a.prototype.getEndTangent=function(){var e=this.getSegments(),i=e.length,s;if(i>1){var l=e[i-2].currentPoint,f=e[i-1].currentPoint,d=e[i-1].endTangent;s=[],d?(s.push([f[0]-d[0],f[1]-d[1]]),s.push([f[0],f[1]])):(s.push([l[0],l[1]]),s.push([f[0],f[1]]))}return s},a}(Dp),kg=r2;function Zx(c,a,e,i,s){var l=c.length;if(l<2)return!1;for(var f=0;f<l-1;f++){var d=c[f][0],v=c[f][1],x=c[f+1][0],w=c[f+1][1];if(ug(d,v,x,w,a,e,i))return!0}if(s){var I=c[0],G=c[l-1];if(ug(I[0],I[1],G[0],G[1],a,e,i))return!0}return!1}var oy=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.isInStrokeOrPath=function(e,i,s,l,f){var d=this.attr().points,v=!1;return s&&(v=Zx(d,f,e,i,!0)),!v&&l&&(v=Kx(d,e,i)),v},a.prototype.createPath=function(e){var i=this.attr(),s=i.points;if(!(s.length<2)){e.beginPath();for(var l=0;l<s.length;l++){var f=s[l];l===0?e.moveTo(f[0],f[1]):e.lineTo(f[0],f[1])}e.closePath()}},a}(Dp),a2=oy,i2=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{startArrow:!1,endArrow:!1})},a.prototype.initAttrs=function(e){this.setArrow()},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),this.setArrow(),["points"].indexOf(e)!==-1&&this._resetCache()},a.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},a.prototype.setArrow=function(){var e=this.attr(),i=this.attrs,s=i.points,l=i.startArrow,f=i.endArrow,d=s.length,v=s[0][0],x=s[0][1],w=s[d-1][0],I=s[d-1][1];l&&Ng(this,e,s[1][0],s[1][1],v,x),f&&W1(this,e,s[d-2][0],s[d-2][1],w,I)},a.prototype.isFill=function(){return!1},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){if(!s||!f)return!1;var d=this.attr().points;return Zx(d,f,e,i,!1)},a.prototype.isStroke=function(){return!0},a.prototype.createPath=function(e){var i=this.attr(),s=i.points,l=i.startArrow,f=i.endArrow,d=s.length;if(!(s.length<2)){var v=s[0][0],x=s[0][1],w=s[d-1][0],I=s[d-1][1];if(l&&l.d){var G=Mg(v,x,s[1][0],s[1][1],l.d);v+=G.dx,x+=G.dy}if(f&&f.d){var G=Mg(s[d-2][0],s[d-2][1],w,I,f.d);w-=G.dx,I-=G.dy}e.beginPath(),e.moveTo(v,x);for(var U=0;U<d-1;U++){var et=s[U];e.lineTo(et[0],et[1])}e.lineTo(w,I)}},a.prototype.afterDrawPath=function(e){var i=this.get("startArrowShape"),s=this.get("endArrowShape");i&&i.draw(e),s&&s.draw(e)},a.prototype.getTotalLength=function(){var e=this.attr().points,i=this.get("totalLength");return(0,k.isNil)(i)?(this.set("totalLength",Xu.length(e)),this.get("totalLength")):i},a.prototype.getPoint=function(e){var i=this.attr().points,s=this.get("tCache");s||(this._setTcache(),s=this.get("tCache"));var l,f;return(0,k.each)(s,function(d,v){e>=d[0]&&e<=d[1]&&(l=(e-d[0])/(d[1]-d[0]),f=v)}),Hr.pointAt(i[f][0],i[f][1],i[f+1][0],i[f+1][1],l)},a.prototype._setTcache=function(){var e=this.attr().points;if(!(!e||e.length===0)){var i=this.getTotalLength();if(!(i<=0)){var s=0,l=[],f,d;(0,k.each)(e,function(v,x){e[x+1]&&(f=[],f[0]=s/i,d=Hr.length(v[0],v[1],e[x+1][0],e[x+1][1]),s+=d,f[1]=s/i,l.push(f))}),this.set("tCache",l)}}},a.prototype.getStartTangent=function(){var e=this.attr().points,i=[];return i.push([e[1][0],e[1][1]]),i.push([e[0][0],e[0][1]]),i},a.prototype.getEndTangent=function(){var e=this.attr().points,i=e.length-1,s=[];return s.push([e[i-1][0],e[i-1][1]]),s.push([e[i][0],e[i][1]]),s},a}(Dp),vm=i2;function X1(c,a,e,i,s,l,f){var d=s/2;return Tg(c-d,a-d,e,s,l,f)||Tg(c+e-d,a-d,s,i,l,f)||Tg(c+d,a+i-d,e,s,l,f)||Tg(c-d,a+d,s,i,l,f)}function o2(c,a,e,i,s,l,f,d){var v=l/2;return ug(c+s,a,c+e-s,a,l,f,d)||ug(c+e,a+s,c+e,a+i-s,l,f,d)||ug(c+e-s,a+i,c+s,a+i,l,f,d)||ug(c,a+i-s,c,a+s,l,f,d)||Zm(c+e-s,a+s,s,1.5*Math.PI,2*Math.PI,l,f,d)||Zm(c+e-s,a+i-s,s,0,.5*Math.PI,l,f,d)||Zm(c+s,a+i-s,s,.5*Math.PI,Math.PI,l,f,d)||Zm(c+s,a+s,s,Math.PI,1.5*Math.PI,l,f,d)}var s2=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x:0,y:0,width:0,height:0,radius:0})},a.prototype.isInStrokeOrPath=function(e,i,s,l,f){var d=this.attr(),v=d.x,x=d.y,w=d.width,I=d.height,G=d.radius;if(G){var et=!1;return s&&(et=o2(v,x,w,I,G,f,e,i)),!et&&l&&(et=Yx(this,e,i)),et}else{var U=f/2;if(l&&s)return Tg(v-U,x-U,w+U,I+U,e,i);if(l)return Tg(v,x,w,I,e,i);if(s)return X1(v,x,w,I,f,e,i)}},a.prototype.createPath=function(e){var i=this.attr(),s=i.x,l=i.y,f=i.width,d=i.height,v=i.radius;if(e.beginPath(),v===0)e.rect(s,l,f,d);else{var x=Qc(v),w=x[0],I=x[1],G=x[2],U=x[3];e.moveTo(s+w,l),e.lineTo(s+f-I,l),I!==0&&e.arc(s+f-I,l+I,I,-Math.PI/2,0),e.lineTo(s+f,l+d-G),G!==0&&e.arc(s+f-G,l+d-G,G,0,Math.PI/2),e.lineTo(s+U,l+d),U!==0&&e.arc(s+U,l+d-U,U,Math.PI/2,Math.PI),e.lineTo(s,l+w),w!==0&&e.arc(s+w,l+w,w,Math.PI,Math.PI*1.5),e.closePath()}},a}(Dp),yA=s2,bA=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},a.prototype.isOnlyHitBox=function(){return!0},a.prototype.initAttrs=function(e){this._assembleFont(),e.text&&this._setText(e.text)},a.prototype._assembleFont=function(){var e=this.attrs;e.font=yu(e)},a.prototype._setText=function(e){var i=null;(0,k.isString)(e)&&e.indexOf(`
`)!==-1&&(i=e.split(`
`)),this.set("textArr",i)},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),e.startsWith("font")&&this._assembleFont(),e==="text"&&this._setText(i)},a.prototype._getSpaceingY=function(){var e=this.attrs,i=e.lineHeight,s=e.fontSize*1;return i?i-s:s*.14},a.prototype._drawTextArr=function(e,i,s){var l=this.attrs,f=l.textBaseline,d=l.x,v=l.y,x=l.fontSize*1,w=this._getSpaceingY(),I=sl(l.text,l.fontSize,l.lineHeight),G;(0,k.each)(i,function(U,et){G=v+et*(w+x)-I+x,f==="middle"&&(G+=I-x-(I-x)/2),f==="top"&&(G+=I-x),(0,k.isNil)(U)||(s?e.fillText(U,d,G):e.strokeText(U,d,G))})},a.prototype._drawText=function(e,i){var s=this.attr(),l=s.x,f=s.y,d=this.get("textArr");if(d)this._drawTextArr(e,d,i);else{var v=s.text;(0,k.isNil)(v)||(i?e.fillText(v,l,f):e.strokeText(v,l,f))}},a.prototype.strokeAndFill=function(e){var i=this.attrs,s=i.lineWidth,l=i.opacity,f=i.strokeOpacity,d=i.fillOpacity;this.isStroke()&&s>0&&(!(0,k.isNil)(f)&&f!==1&&(e.globalAlpha=l),this.stroke(e)),this.isFill()&&(!(0,k.isNil)(d)&&d!==1?(e.globalAlpha=d,this.fill(e),e.globalAlpha=l):this.fill(e)),this.afterDrawPath(e)},a.prototype.fill=function(e){this._drawText(e,!0)},a.prototype.stroke=function(e){this._drawText(e,!1)},a}(Dp),Y1=bA;function u2(c,a){if(a){var e=qe(a);return xe(e,c)}return c}function qx(c,a,e){var i=c.getTotalMatrix();if(i){var s=u2([a,e,1],i),l=s[0],f=s[1];return[l,f]}return[a,e]}function Qx(c,a,e){if(c.isCanvas&&c.isCanvas())return!0;if(!dh(c)||c.cfg.isInView===!1)return!1;if(c.cfg.clipShape){var i=qx(c,a,e),s=i[0],l=i[1];if(c.isClipped(s,l))return!1}var f=c.cfg.cacheCanvasBBox||c.getCanvasBBox();return a>=f.minX&&a<=f.maxX&&e>=f.minY&&e<=f.maxY}function Jx(c,a,e){if(!Qx(c,a,e))return null;for(var i=null,s=c.getChildren(),l=s.length,f=l-1;f>=0;f--){var d=s[f];if(d.isGroup())i=Jx(d,a,e);else if(Qx(d,a,e)){var v=d,x=qx(d,a,e),w=x[0],I=x[1];v.isInShape(w,I)&&(i=d)}if(i)break}return i}var l2=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.getDefaultCfg=function(){var e=c.prototype.getDefaultCfg.call(this);return e.renderer="canvas",e.autoDraw=!0,e.localRefresh=!0,e.refreshElements=[],e.clipView=!0,e.quickHit=!1,e},a.prototype.onCanvasChange=function(e){(e==="attr"||e==="sort"||e==="changeSize")&&(this.set("refreshElements",[this]),this.draw())},a.prototype.getShapeBase=function(){return A},a.prototype.getGroupBase=function(){return Km},a.prototype.getPixelRatio=function(){var e=this.get("pixelRatio")||BS();return e>=1?Math.ceil(e):1},a.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},a.prototype.createDom=function(){var e=document.createElement("canvas"),i=e.getContext("2d");return this.set("context",i),e},a.prototype.setDOMSize=function(e,i){c.prototype.setDOMSize.call(this,e,i);var s=this.get("context"),l=this.get("el"),f=this.getPixelRatio();l.width=f*e,l.height=f*i,f>1&&s.scale(f,f)},a.prototype.clear=function(){c.prototype.clear.call(this),this._clearFrame();var e=this.get("context"),i=this.get("el");e.clearRect(0,0,i.width,i.height)},a.prototype.getShape=function(e,i){var s;return this.get("quickHit")?s=Jx(this,e,i):s=c.prototype.getShape.call(this,e,i,null),s},a.prototype._getRefreshRegion=function(){var e=this.get("refreshElements"),i=this.getViewRange(),s;if(e.length&&e[0]===this)s=i;else if(s=WS(e),s){s.minX=Math.floor(s.minX),s.minY=Math.floor(s.minY),s.maxX=Math.ceil(s.maxX),s.maxY=Math.ceil(s.maxY),s.maxY+=1;var l=this.get("clipView");l&&(s=ry(s,i))}return s},a.prototype.refreshElement=function(e){var i=this.get("refreshElements");i.push(e)},a.prototype._clearFrame=function(){var e=this.get("drawFrame");e&&((0,k.clearAnimationFrame)(e),this.set("drawFrame",null),this.set("refreshElements",[]))},a.prototype.draw=function(){var e=this.get("drawFrame");this.get("autoDraw")&&e||this._startDraw()},a.prototype._drawAll=function(){var e=this.get("context"),i=this.get("el"),s=this.getChildren();e.clearRect(0,0,i.width,i.height),pm(e,this),ny(e,s),this.set("refreshElements",[])},a.prototype._drawRegion=function(){var e=this.get("context"),i=this.get("refreshElements"),s=this.getChildren(),l=this._getRefreshRegion();l?(e.clearRect(l.minX,l.minY,l.maxX-l.minX,l.maxY-l.minY),e.save(),e.beginPath(),e.rect(l.minX,l.minY,l.maxX-l.minX,l.maxY-l.minY),e.clip(),pm(e,this),GS(this,s,l),ny(e,s,l),e.restore()):i.length&&jx(i),(0,k.each)(i,function(f){f.get("hasChanged")&&f.set("hasChanged",!1)}),this.set("refreshElements",[])},a.prototype._startDraw=function(){var e=this,i=this.get("drawFrame");i||(i=(0,k.requestAnimationFrame)(function(){e.get("localRefresh")?e._drawRegion():e._drawAll(),e.set("drawFrame",null)}),this.set("drawFrame",i))},a.prototype.skipDraw=function(){},a.prototype.removeDom=function(){var e=this.get("el");e.width=0,e.height=0,e.parentNode.removeChild(e)},a}(eg),$v=l2,c2="0.5.12",K1={rect:"path",circle:"circle",line:"line",path:"path",marker:"path",text:"text",polyline:"polyline",polygon:"polygon",image:"image",ellipse:"ellipse",dom:"foreignObject"},du={opacity:"opacity",fillStyle:"fill",fill:"fill",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",x:"x",y:"y",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",x1:"x1",x2:"x2",y1:"y1",y2:"y2",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",startArrow:"marker-start",endArrow:"marker-end",path:"d",class:"class",id:"id",style:"style",preserveAspectRatio:"preserveAspectRatio"},Z1=null;function Xd(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}function gm(c){var a=K1[c.type],e=c.getParent();if(!a)throw new Error("the type "+c.type+" is not supported by svg");var i=Xd(a);if(c.get("id")&&(i.id=c.get("id")),c.set("el",i),c.set("attrs",{}),e){var s=e.get("el");s||(s=e.createDom(),e.set("el",s)),s.appendChild(i)}return i}function tw(c,a){var e=c.get("el"),i=(0,k.toArray)(e.children).sort(a),s=document.createDocumentFragment();i.forEach(function(l){s.appendChild(l)}),e.appendChild(s)}function q1(c,a){var e=c.parentNode,i=Array.from(e.childNodes).filter(function(d){return d.nodeType===1&&d.nodeName.toLowerCase()!=="defs"}),s=i[a],l=i.indexOf(c);if(s){if(l>a)e.insertBefore(c,s);else if(l<a){var f=i[a+1];f?e.insertBefore(c,f):e.appendChild(c)}}else e.appendChild(c)}function f2(c,a){var e=c.cfg.el,i=c.attr(),s={dx:i.shadowOffsetX,dy:i.shadowOffsetY,blur:i.shadowBlur,color:i.shadowColor};if(!s.dx&&!s.dy&&!s.blur&&!s.color)e.removeAttribute("filter");else{var l=a.find("filter",s);l||(l=a.addShadow(s)),e.setAttribute("filter","url(#"+l+")")}}function td(c){var a=c.attr().matrix;if(a){for(var e=c.cfg.el,i=[],s=0;s<9;s+=3)i.push(a[s]+","+a[s+1]);i=i.join(","),i.indexOf("NaN")===-1?e.setAttribute("transform","matrix("+i+")"):console.warn("invalid matrix:",a)}}function Qm(c,a){var e=c.getClip(),i=c.get("el");if(!e)i.removeAttribute("clip-path");else if(e&&!i.hasAttribute("clip-path")){gm(e),e.createPath(a);var s=a.addClip(e);i.setAttribute("clip-path","url(#"+s+")")}}function Jm(c,a){a.forEach(function(e){e.draw(c)})}function ew(c,a){var e=c.get("canvas");if(e&&e.get("autoDraw")){var i=e.get("context"),s=c.getParent(),l=s?s.getChildren():[e],f=c.get("el");if(a==="remove"){var d=c.get("isClipShape");if(d){var v=f&&f.parentNode,x=v&&v.parentNode;v&&x&&x.removeChild(v)}else f&&f.parentNode&&f.parentNode.removeChild(f)}else if(a==="show")f.setAttribute("visibility","visible");else if(a==="hide")f.setAttribute("visibility","hidden");else if(a==="zIndex")q1(f,l.indexOf(c));else if(a==="sort"){var w=c.get("children");w&&w.length&&tw(c,function(I,G){return w.indexOf(I)-w.indexOf(G)?1:0})}else a==="clear"?f&&(f.innerHTML=""):a==="matrix"?td(c):a==="clip"?Qm(c,i):a==="attr"||a==="add"&&c.draw(i)}}var ed=function(c){(0,P.__extends)(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.isEntityGroup=function(){return!0},a.prototype.createDom=function(){var e=Xd("g");this.set("el",e);var i=this.getParent();if(i){var s=i.get("el");s||(s=i.createDom(),i.set("el",s)),s.appendChild(e)}return e},a.prototype.afterAttrsChange=function(e){c.prototype.afterAttrsChange.call(this,e);var i=this.get("canvas");if(i&&i.get("autoDraw")){var s=i.get("context");this.createPath(s,e)}},a.prototype.onCanvasChange=function(e){ew(this,e)},a.prototype.getShapeBase=function(){return N},a.prototype.getGroupBase=function(){return a},a.prototype.draw=function(e){var i=this.getChildren(),s=this.get("el");this.get("destroyed")?s&&s.parentNode.removeChild(s):(s||this.createDom(),Qm(this,e),this.createPath(e),i.length&&Jm(e,i))},a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,k.each)(i||s,function(f,d){du[d]&&l.setAttribute(du[d],f)}),td(this)},a}(lv),nw=ed,h2=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="svg",e.canFill=!1,e.canStroke=!1,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},a.prototype.afterAttrsChange=function(e){c.prototype.afterAttrsChange.call(this,e);var i=this.get("canvas");if(i&&i.get("autoDraw")){var s=i.get("context");this.draw(s,e)}},a.prototype.getShapeBase=function(){return N},a.prototype.getGroupBase=function(){return nw},a.prototype.onCanvasChange=function(e){ew(this,e)},a.prototype.calculateBBox=function(){var e=this.get("el"),i=null;if(e)i=e.getBBox();else{var s=Rv(this.get("type"));s&&(i=s(this))}if(i){var l=i.x,f=i.y,d=i.width,v=i.height,x=this.getHitLineWidth(),w=x/2,I=l-w,G=f-w,U=l+d+w,et=f+v+w;return{x:I,y:G,minX:I,minY:G,maxX:U,maxY:et,width:d+x,height:v+x}}return{x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}},a.prototype.isFill=function(){var e=this.attr(),i=e.fill,s=e.fillStyle;return(i||s||this.isClipShape())&&this.canFill},a.prototype.isStroke=function(){var e=this.attr(),i=e.stroke,s=e.strokeStyle;return(i||s)&&this.canStroke},a.prototype.draw=function(e,i){var s=this.get("el");this.get("destroyed")?s&&s.parentNode.removeChild(s):(s||gm(this),Qm(this,e),this.createPath(e,i),this.shadow(e,i),this.strokeAndFill(e,i),this.transform(i))},a.prototype.createPath=function(e,i){},a.prototype.strokeAndFill=function(e,i){var s=i||this.attr(),l=s.fill,f=s.fillStyle,d=s.stroke,v=s.strokeStyle,x=s.fillOpacity,w=s.strokeOpacity,I=s.lineWidth,G=this.get("el");this.canFill&&(i?"fill"in s?this._setColor(e,"fill",l):"fillStyle"in s&&this._setColor(e,"fill",f):this._setColor(e,"fill",l||f),x&&G.setAttribute(du.fillOpacity,x)),this.canStroke&&I>0&&(i?"stroke"in s?this._setColor(e,"stroke",d):"strokeStyle"in s&&this._setColor(e,"stroke",v):this._setColor(e,"stroke",d||v),w&&G.setAttribute(du.strokeOpacity,w),I&&G.setAttribute(du.lineWidth,I))},a.prototype._setColor=function(e,i,s){var l=this.get("el");if(!s){l.setAttribute(du[i],"none");return}if(s=s.trim(),/^[r,R,L,l]{1}[\s]*\(/.test(s)){var f=e.find("gradient",s);f||(f=e.addGradient(s)),l.setAttribute(du[i],"url(#"+f+")")}else if(/^[p,P]{1}[\s]*\(/.test(s)){var f=e.find("pattern",s);f||(f=e.addPattern(s)),l.setAttribute(du[i],"url(#"+f+")")}else l.setAttribute(du[i],s)},a.prototype.shadow=function(e,i){var s=this.attr(),l=i||s,f=l.shadowOffsetX,d=l.shadowOffsetY,v=l.shadowBlur,x=l.shadowColor;(f||d||v||x)&&f2(this,e)},a.prototype.transform=function(e){var i=this.attr(),s=(e||i).matrix;s&&td(this)},a.prototype.isInShape=function(e,i){return this.isPointInPath(e,i)},a.prototype.isPointInPath=function(e,i){var s=this.get("el"),l=this.get("canvas"),f=l.get("el").getBoundingClientRect(),d=e+f.left,v=i+f.top,x=document.elementFromPoint(d,v);return!!(x&&x.isEqualNode(s))},a.prototype.getHitLineWidth=function(){var e=this.attrs,i=e.lineWidth,s=e.lineAppendWidth;return this.isStroke()?i+s:0},a}(yd),Yd=h2,d2=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="circle",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x:0,y:0,r:0})},a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,k.each)(i||s,function(f,d){d==="x"||d==="y"?l.setAttribute("c"+d,f):du[d]&&l.setAttribute(du[d],f)})},a}(Yd),p2=d2,v2=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="dom",e.canFill=!1,e.canStroke=!1,e}return a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");if((0,k.each)(i||s,function(x,w){du[w]&&l.setAttribute(du[w],x)}),typeof s.html=="function"){var f=s.html.call(this,s);if(f instanceof Element||f instanceof HTMLDocument){for(var d=l.childNodes,v=d.length-1;v>=0;v--)l.removeChild(d[v]);l.appendChild(f)}else l.innerHTML=f}else l.innerHTML=s.html},a}(Yd),g2=v2,m2=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="ellipse",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x:0,y:0,rx:0,ry:0})},a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,k.each)(i||s,function(f,d){d==="x"||d==="y"?l.setAttribute("c"+d,f):du[d]&&l.setAttribute(du[d],f)})},a}(Yd),y2=m2,Q1=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="image",e.canFill=!1,e.canStroke=!1,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x:0,y:0,width:0,height:0})},a.prototype.createPath=function(e,i){var s=this,l=this.attr(),f=this.get("el");(0,k.each)(i||l,function(d,v){v==="img"?s._setImage(l.img):du[v]&&f.setAttribute(du[v],d)})},a.prototype.setAttr=function(e,i){this.attrs[e]=i,e==="img"&&this._setImage(i)},a.prototype._setImage=function(e){var i=this.attr(),s=this.get("el");if((0,k.isString)(e))s.setAttribute("href",e);else if(e instanceof window.Image)i.width||(s.setAttribute("width",e.width),this.attr("width",e.width)),i.height||(s.setAttribute("height",e.height),this.attr("height",e.height)),s.setAttribute("href",e.src);else if(e instanceof HTMLElement&&(0,k.isString)(e.nodeName)&&e.nodeName.toUpperCase()==="CANVAS")s.setAttribute("href",e.toDataURL());else if(e instanceof ImageData){var l=document.createElement("canvas");l.setAttribute("width",""+e.width),l.setAttribute("height",""+e.height),l.getContext("2d").putImageData(e,0,0),i.width||(s.setAttribute("width",""+e.width),this.attr("width",e.width)),i.height||(s.setAttribute("height",""+e.height),this.attr("height",e.height)),s.setAttribute("href",l.toDataURL())}},a}(Yd),b2=Q1,sy=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="line",e.canFill=!1,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,k.each)(i||s,function(f,d){if(d==="startArrow"||d==="endArrow")if(f){var v=(0,k.isObject)(f)?e.addArrow(s,du[d]):e.getDefaultArrow(s,du[d]);l.setAttribute(du[d],"url(#"+v+")")}else l.removeAttribute(du[d]);else du[d]&&l.setAttribute(du[d],f)})},a.prototype.getTotalLength=function(){var e=this.attr(),i=e.x1,s=e.y1,l=e.x2,f=e.y2;return Hr.length(i,s,l,f)},a.prototype.getPoint=function(e){var i=this.attr(),s=i.x1,l=i.y1,f=i.x2,d=i.y2;return Hr.pointAt(s,l,f,d,e)},a}(Yd),x2=sy,Dg={circle:function(c,a,e){return[["M",c,a],["m",-e,0],["a",e,e,0,1,0,e*2,0],["a",e,e,0,1,0,-e*2,0]]},square:function(c,a,e){return[["M",c-e,a-e],["L",c+e,a-e],["L",c+e,a+e],["L",c-e,a+e],["Z"]]},diamond:function(c,a,e){return[["M",c-e,a],["L",c,a-e],["L",c+e,a],["L",c,a+e],["Z"]]},triangle:function(c,a,e){var i=e*Math.sin(1/3*Math.PI);return[["M",c-e,a+i],["L",c,a-i],["L",c+e,a+i],["z"]]},triangleDown:function(c,a,e){var i=e*Math.sin(1/3*Math.PI);return[["M",c-e,a-i],["L",c+e,a-i],["L",c,a+i],["Z"]]}},rw={get:function(c){return Dg[c]},register:function(c,a){Dg[c]=a},remove:function(c){delete Dg[c]},getAll:function(){return Dg}},J1=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="marker",e.canFill=!0,e.canStroke=!0,e}return a.prototype.createPath=function(e){var i=this.get("el");i.setAttribute("d",this._assembleMarker())},a.prototype._assembleMarker=function(){var e=this._getPath();return(0,k.isArray)(e)?e.map(function(i){return i.join(" ")}).join(""):e},a.prototype._getPath=function(){var e=this.attr(),i=e.x,s=e.y,l=e.r||e.radius,f=e.symbol||"circle",d;return(0,k.isFunction)(f)?d=f:d=rw.get(f),d?d(i,s,l):(console.warn(d+" symbol is not exist."),null)},a.symbolsFactory=rw,a}(Yd),w2=J1,aw=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="path",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{startArrow:!1,endArrow:!1})},a.prototype.createPath=function(e,i){var s=this,l=this.attr(),f=this.get("el");(0,k.each)(i||l,function(d,v){if(v==="path"&&(0,k.isArray)(d))f.setAttribute("d",s._formatPath(d));else if(v==="startArrow"||v==="endArrow")if(d){var x=(0,k.isObject)(d)?e.addArrow(l,du[v]):e.getDefaultArrow(l,du[v]);f.setAttribute(du[v],"url(#"+x+")")}else f.removeAttribute(du[v]);else du[v]&&f.setAttribute(du[v],d)})},a.prototype._formatPath=function(e){var i=e.map(function(s){return s.join(" ")}).join("");return~i.indexOf("NaN")?"":i},a.prototype.getTotalLength=function(){var e=this.get("el");return e?e.getTotalLength():null},a.prototype.getPoint=function(e){var i=this.get("el"),s=this.getTotalLength();if(s===0)return null;var l=i?i.getPointAtLength(e*s):null;return l?{x:l.x,y:l.y}:null},a}(Yd),E2=aw,tb=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="polygon",e.canFill=!0,e.canStroke=!0,e}return a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,k.each)(i||s,function(f,d){d==="points"&&(0,k.isArray)(f)&&f.length>=2?l.setAttribute("points",f.map(function(v){return v[0]+","+v[1]}).join(" ")):du[d]&&l.setAttribute(du[d],f)})},a}(Yd),S2=tb,uy=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="polyline",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{startArrow:!1,endArrow:!1})},a.prototype.onAttrChange=function(e,i,s){c.prototype.onAttrChange.call(this,e,i,s),["points"].indexOf(e)!==-1&&this._resetCache()},a.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},a.prototype.createPath=function(e,i){var s=this.attr(),l=this.get("el");(0,k.each)(i||s,function(f,d){d==="points"&&(0,k.isArray)(f)&&f.length>=2?l.setAttribute("points",f.map(function(v){return v[0]+","+v[1]}).join(" ")):du[d]&&l.setAttribute(du[d],f)})},a.prototype.getTotalLength=function(){var e=this.attr().points,i=this.get("totalLength");return(0,k.isNil)(i)?(this.set("totalLength",Xu.length(e)),this.get("totalLength")):i},a.prototype.getPoint=function(e){var i=this.attr().points,s=this.get("tCache");s||(this._setTcache(),s=this.get("tCache"));var l,f;return(0,k.each)(s,function(d,v){e>=d[0]&&e<=d[1]&&(l=(e-d[0])/(d[1]-d[0]),f=v)}),Hr.pointAt(i[f][0],i[f][1],i[f+1][0],i[f+1][1],l)},a.prototype._setTcache=function(){var e=this.attr().points;if(!(!e||e.length===0)){var i=this.getTotalLength();if(!(i<=0)){var s=0,l=[],f,d;(0,k.each)(e,function(v,x){e[x+1]&&(f=[],f[0]=s/i,d=Hr.length(v[0],v[1],e[x+1][0],e[x+1][1]),s+=d,f[1]=s/i,l.push(f))}),this.set("tCache",l)}}},a.prototype.getStartTangent=function(){var e=this.attr().points,i=[];return i.push([e[1][0],e[1][1]]),i.push([e[0][0],e[0][1]]),i},a.prototype.getEndTangent=function(){var e=this.attr().points,i=e.length-1,s=[];return s.push([e[i-1][0],e[i-1][1]]),s.push([e[i][0],e[i][1]]),s},a}(Yd),C2=uy,ly=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/gi,_2=/[^\s,]+/gi;function cy(c){var a=0,e=0,i=0,s=0;return(0,k.isArray)(c)?c.length===1?a=e=i=s=c[0]:c.length===2?(a=i=c[0],e=s=c[1]):c.length===3?(a=c[0],e=s=c[1],i=c[2]):(a=c[0],e=c[1],i=c[2],s=c[3]):a=e=i=s=c,{r1:a,r2:e,r3:i,r4:s}}function xA(c){if(c=c||[],isArray(c))return c;if(isString(c))return c=c.match(ly),each(c,function(a,e){if(a=a.match(_2),a[0].length>1){var i=a[0].charAt(0);a.splice(1,0,a[0].substr(1)),a[0]=i}each(a,function(s,l){isNaN(s)||(a[l]=+s)}),c[e]=a}),c}var eb=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="rect",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x:0,y:0,width:0,height:0,radius:0})},a.prototype.createPath=function(e,i){var s=this,l=this.attr(),f=this.get("el"),d=!1,v=["x","y","width","height","radius"];(0,k.each)(i||l,function(x,w){v.indexOf(w)!==-1&&!d?(f.setAttribute("d",s._assembleRect(l)),d=!0):v.indexOf(w)===-1&&du[w]&&f.setAttribute(du[w],x)})},a.prototype._assembleRect=function(e){var i=e.x,s=e.y,l=e.width,f=e.height,d=e.radius;if(!d)return"M "+i+","+s+" l "+l+",0 l 0,"+f+" l"+-l+" 0 z";var v=cy(d);(0,k.isArray)(d)?d.length===1?v.r1=v.r2=v.r3=v.r4=d[0]:d.length===2?(v.r1=v.r3=d[0],v.r2=v.r4=d[1]):d.length===3?(v.r1=d[0],v.r2=v.r4=d[1],v.r3=d[2]):(v.r1=d[0],v.r2=d[1],v.r3=d[2],v.r4=d[3]):v.r1=v.r2=v.r3=v.r4=d;var x=[["M "+(i+v.r1)+","+s],["l "+(l-v.r1-v.r2)+",0"],["a "+v.r2+","+v.r2+",0,0,1,"+v.r2+","+v.r2],["l 0,"+(f-v.r2-v.r3)],["a "+v.r3+","+v.r3+",0,0,1,"+-v.r3+","+v.r3],["l "+(v.r3+v.r4-l)+",0"],["a "+v.r4+","+v.r4+",0,0,1,"+-v.r4+","+-v.r4],["l 0,"+(v.r4+v.r1-f)],["a "+v.r1+","+v.r1+",0,0,1,"+v.r1+","+-v.r1],["z"]];return x.join(" ")},a}(Yd),I2=eb,t0=.3,T2={top:"before-edge",middle:"central",bottom:"after-edge",alphabetic:"baseline",hanging:"hanging"},e0={top:"text-before-edge",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",hanging:"hanging"},A2={left:"left",start:"left",center:"middle",right:"end",end:"end"},n0=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="text",e.canFill=!0,e.canStroke=!0,e}return a.prototype.getDefaultAttrs=function(){var e=c.prototype.getDefaultAttrs.call(this);return(0,P.__assign)((0,P.__assign)({},e),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},a.prototype.createPath=function(e,i){var s=this,l=this.attr(),f=this.get("el");this._setFont(),(0,k.each)(i||l,function(d,v){v==="text"?s._setText(""+d):v==="matrix"&&d?td(s):du[v]&&f.setAttribute(du[v],d)}),f.setAttribute("paint-order","stroke"),f.setAttribute("style","stroke-linecap:butt; stroke-linejoin:miter;")},a.prototype._setFont=function(){var e=this.get("el"),i=this.attr(),s=i.textBaseline,l=i.textAlign,f=vf();f&&f.name==="firefox"?e.setAttribute("dominant-baseline",e0[s]||"alphabetic"):e.setAttribute("alignment-baseline",T2[s]||"baseline"),e.setAttribute("text-anchor",A2[l]||"left")},a.prototype._setText=function(e){var i=this.get("el"),s=this.attr(),l=s.x,f=s.textBaseline,d=f===void 0?"bottom":f;if(!e)i.innerHTML="";else if(~e.indexOf(`
`)){var v=e.split(`
`),x=v.length-1,w="";(0,k.each)(v,function(I,G){G===0?d==="alphabetic"?w+='<tspan x="'+l+'" dy="'+-x+'em">'+I+"</tspan>":d==="top"?w+='<tspan x="'+l+'" dy="0.9em">'+I+"</tspan>":d==="middle"?w+='<tspan x="'+l+'" dy="'+-(x-1)/2+'em">'+I+"</tspan>":d==="bottom"?w+='<tspan x="'+l+'" dy="-'+(x+t0)+'em">'+I+"</tspan>":d==="hanging"&&(w+='<tspan x="'+l+'" dy="'+(-(x-1)-t0)+'em">'+I+"</tspan>"):w+='<tspan x="'+l+'" dy="1em">'+I+"</tspan>"}),i.innerHTML=w}else i.innerHTML=e},a}(Yd),M2=n0,r0=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,N2=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,mm=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function iw(c){var a=c.match(mm);if(!a)return"";var e="";return a.sort(function(i,s){return i=i.split(":"),s=s.split(":"),Number(i[0])-Number(s[0])}),(0,k.each)(a,function(i){i=i.split(":"),e+='<stop offset="'+i[0]+'" stop-color="'+i[1]+'"></stop>'}),e}function fy(c,a){var e=r0.exec(c),i=(0,k.mod)((0,k.toRadian)(parseFloat(e[1])),Math.PI*2),s=e[2],l,f;i>=0&&i<.5*Math.PI?(l={x:0,y:0},f={x:1,y:1}):.5*Math.PI<=i&&i<Math.PI?(l={x:1,y:0},f={x:0,y:1}):Math.PI<=i&&i<1.5*Math.PI?(l={x:1,y:1},f={x:0,y:0}):(l={x:0,y:1},f={x:1,y:0});var d=Math.tan(i),v=d*d,x=(f.x-l.x+d*(f.y-l.y))/(v+1)+l.x,w=d*(f.x-l.x+d*(f.y-l.y))/(v+1)+l.y;a.setAttribute("x1",l.x),a.setAttribute("y1",l.y),a.setAttribute("x2",x),a.setAttribute("y2",w),a.innerHTML=iw(s)}function k2(c,a){var e=N2.exec(c),i=parseFloat(e[1]),s=parseFloat(e[2]),l=parseFloat(e[3]),f=e[4];a.setAttribute("cx",i),a.setAttribute("cy",s),a.setAttribute("r",l),a.innerHTML=iw(f)}var nd=function(){function c(a){this.cfg={};var e=null,i=(0,k.uniqueId)("gradient_");return a.toLowerCase()[0]==="l"?(e=Xd("linearGradient"),fy(a,e)):(e=Xd("radialGradient"),k2(a,e)),e.setAttribute("id",i),this.el=e,this.id=i,this.cfg=a,this}return c.prototype.match=function(a,e){return this.cfg===e},c}(),D2=nd,a0={shadowColor:"color",shadowOpacity:"opacity",shadowBlur:"blur",shadowOffsetX:"dx",shadowOffsetY:"dy"},O2={x:"-40%",y:"-40%",width:"200%",height:"200%"},i0=function(){function c(a){this.type="filter",this.cfg={},this.type="filter";var e=Xd("filter");return(0,k.each)(O2,function(i,s){e.setAttribute(s,i)}),this.el=e,this.id=(0,k.uniqueId)("filter_"),this.el.id=this.id,this.cfg=a,this._parseShadow(a,e),this}return c.prototype.match=function(a,e){if(this.type!==a)return!1;var i=!0,s=this.cfg;return(0,k.each)(Object.keys(s),function(l){if(s[l]!==e[l])return i=!1,!1}),i},c.prototype.update=function(a,e){var i=this.cfg;return i[a0[a]]=e,this._parseShadow(i,this.el),this},c.prototype._parseShadow=function(a,e){var i=`<feDropShadow
      dx="`+(a.dx||0)+`"
      dy="`+(a.dy||0)+`"
      stdDeviation="`+(a.blur?a.blur/10:0)+`"
      flood-color="`+(a.color?a.color:"#000")+`"
      flood-opacity="`+(a.opacity?a.opacity:1)+`"
      />`;e.innerHTML=i},c}(),R2=i0,lg=function(){function c(a,e){this.cfg={};var i=Xd("marker"),s=(0,k.uniqueId)("marker_");i.setAttribute("id",s);var l=Xd("path");l.setAttribute("stroke",a.stroke||"none"),l.setAttribute("fill",a.fill||"none"),i.appendChild(l),i.setAttribute("overflow","visible"),i.setAttribute("orient","auto-start-reverse"),this.el=i,this.child=l,this.id=s;var f=a[e==="marker-start"?"startArrow":"endArrow"];return this.stroke=a.stroke||"#000",f===!0?this._setDefaultPath(e,l):(this.cfg=f,this._setMarker(a.lineWidth,l)),this}return c.prototype.match=function(){return!1},c.prototype._setDefaultPath=function(a,e){var i=this.el;e.setAttribute("d","M0,0 L"+10*Math.cos(Math.PI/6)+",5 L0,10"),i.setAttribute("refX",""+10*Math.cos(Math.PI/6)),i.setAttribute("refY",""+5)},c.prototype._setMarker=function(a,e){var i=this.el,s=this.cfg.path,l=this.cfg.d;(0,k.isArray)(s)&&(s=s.map(function(f){return f.join(" ")}).join("")),e.setAttribute("d",s),i.appendChild(e),l&&i.setAttribute("refX",""+l/a)},c.prototype.update=function(a){var e=this.child;e.attr?e.attr("fill",a):e.setAttribute("fill",a)},c}(),ow=lg,rd=function(){function c(a){this.type="clip",this.cfg={};var e=Xd("clipPath");this.el=e,this.id=(0,k.uniqueId)("clip_"),e.id=this.id;var i=a.cfg.el;return e.appendChild(i),this.cfg=a,this}return c.prototype.match=function(){return!1},c.prototype.remove=function(){var a=this.el;a.parentNode.removeChild(a)},c}(),L2=rd,ym=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,P2=function(){function c(a){this.cfg={};var e=Xd("pattern");e.setAttribute("patternUnits","userSpaceOnUse");var i=Xd("image");e.appendChild(i);var s=(0,k.uniqueId)("pattern_");e.id=s,this.el=e,this.id=s,this.cfg=a;var l=ym.exec(a),f=l[2];i.setAttribute("href",f);var d=new Image;f.match(/^data:/i)||(d.crossOrigin="Anonymous"),d.src=f;function v(){e.setAttribute("width",""+d.width),e.setAttribute("height",""+d.height)}return d.complete?v():(d.onload=v,d.src=d.src),this}return c.prototype.match=function(a,e){return this.cfg===e},c}(),nb=P2,F2=function(){function c(a){var e=Xd("defs"),i=(0,k.uniqueId)("defs_");e.id=i,a.appendChild(e),this.children=[],this.defaultArrow={},this.el=e,this.canvas=a}return c.prototype.find=function(a,e){for(var i=this.children,s=null,l=0;l<i.length;l++)if(i[l].match(a,e)){s=i[l].id;break}return s},c.prototype.findById=function(a){for(var e=this.children,i=null,s=0;s<e.length;s++)if(e[s].id===a){i=e[s];break}return i},c.prototype.add=function(a){this.children.push(a),a.canvas=this.canvas,a.parent=this},c.prototype.getDefaultArrow=function(a,e){var i=a.stroke||a.strokeStyle;if(this.defaultArrow[i])return this.defaultArrow[i].id;var s=new ow(a,e);return this.defaultArrow[i]=s,this.el.appendChild(s.el),this.add(s),s.id},c.prototype.addGradient=function(a){var e=new D2(a);return this.el.appendChild(e.el),this.add(e),e.id},c.prototype.addArrow=function(a,e){var i=new ow(a,e);return this.el.appendChild(i.el),this.add(i),i.id},c.prototype.addShadow=function(a){var e=new R2(a);return this.el.appendChild(e.el),this.add(e),e.id},c.prototype.addPattern=function(a){var e=new nb(a);return this.el.appendChild(e.el),this.add(e),e.id},c.prototype.addClip=function(a){var e=new L2(a);return this.el.appendChild(e.el),this.add(e),e.id},c}(),rb=F2,ad=function(c){(0,P.__extends)(a,c);function a(e){return c.call(this,(0,P.__assign)((0,P.__assign)({},e),{autoDraw:!0,renderer:"svg"}))||this}return a.prototype.getShapeBase=function(){return N},a.prototype.getGroupBase=function(){return nw},a.prototype.getShape=function(e,i,s){var l=s.target||s.srcElement;if(!K1[l.tagName]){for(var f=l.parentNode;f&&!K1[f.tagName];)f=f.parentNode;l=f}return this.find(function(d){return d.get("el")===l})},a.prototype.createDom=function(){var e=Xd("svg"),i=new rb(e);return e.setAttribute("width",""+this.get("width")),e.setAttribute("height",""+this.get("height")),this.set("context",i),e},a.prototype.onCanvasChange=function(e){var i=this.get("context"),s=this.get("el");if(e==="sort"){var l=this.get("children");l&&l.length&&tw(this,function(d,v){return l.indexOf(d)-l.indexOf(v)?1:0})}else if(e==="clear"){if(s){s.innerHTML="";var f=i.el;f.innerHTML="",s.appendChild(f)}}else e==="matrix"?td(this):e==="clip"?Qm(this,i):e==="changeSize"&&(s.setAttribute("width",""+this.get("width")),s.setAttribute("height",""+this.get("height")))},a.prototype.draw=function(){var e=this.get("context"),i=this.getChildren();Qm(this,e),i.length&&Jm(e,i)},a}(eg),Rp=ad,wA="0.5.6",B2=$(6767),o0=$.n(B2),hy=$(21997),bm=2,sw=.16,dy=.05,z2=.05,py=.15,uw=5,vy=4,$2=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function Sd(c,a,e){var i;return Math.round(c.h)>=60&&Math.round(c.h)<=240?i=e?Math.round(c.h)-bm*a:Math.round(c.h)+bm*a:i=e?Math.round(c.h)+bm*a:Math.round(c.h)-bm*a,i<0?i+=360:i>=360&&(i-=360),i}function ab(c,a,e){if(c.h===0&&c.s===0)return c.s;var i;return e?i=c.s-sw*a:a===vy?i=c.s+sw:i=c.s+dy*a,i>1&&(i=1),e&&a===uw&&i>.1&&(i=.1),i<.06&&(i=.06),Number(i.toFixed(2))}function s0(c,a,e){var i;return e?i=c.v+z2*a:i=c.v-py*a,i>1&&(i=1),Number(i.toFixed(2))}function gy(c){for(var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=[],i=(0,hy.Z)(c),s=uw;s>0;s-=1){var l=i.toHsv(),f=(0,hy.Z)({h:Sd(l,s,!0),s:ab(l,s,!0),v:s0(l,s,!0)}).toHexString();e.push(f)}e.push(i.toHexString());for(var d=1;d<=vy;d+=1){var v=i.toHsv(),x=(0,hy.Z)({h:Sd(v,d),s:ab(v,d),v:s0(v,d)}).toHexString();e.push(x)}return a.theme==="dark"?$2.map(function(w){var I=w.index,G=w.opacity,U=hy.Z.mix(a.backgroundColor||"#141414",e[I],G*100).toHexString();return U}):e}var u0={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},oh={},ib={};Object.keys(u0).forEach(function(c){oh[c]=gy(u0[c]),oh[c].primary=oh[c][5],ib[c]=gy(u0[c],{theme:"dark",backgroundColor:"#141414"}),ib[c].primary=ib[c][5]});var EA=oh.red,SA=oh.volcano,CA=oh.gold,_A=oh.orange,IA=oh.yellow,TA=oh.lime,G2=oh.green,U2=oh.cyan,W2=oh.blue,V2=oh.geekblue,j2=oh.purple,H2=oh.magenta,AA=oh.grey,yf=function(a,e,i){var s=o0()(a),l=o0()(e);return o0()([(1-i)*s.red()+i*l.red(),(1-i)*s.green()+i*l.green(),(1-i)*s.blue()+i*l.blue()]).rgb()},X2=function(a,e,i){e===void 0&&(e="#fff"),i===void 0&&(i="rgb(150, 150, 150)");var s=yf(e,a,.05).rgb().toString(),l=yf(e,a,.1).rgb().toString(),f=yf(e,a,.2).rgb().toString(),d=yf(e,a,.4).rgb().toString(),v=yf(e,i,.02).rgb().toString(),x=yf(e,i,.05).rgb().toString(),w=yf(e,i,.1).rgb().toString(),I=yf(e,i,.2).rgb().toString(),G=yf(e,i,.3).rgb().toString(),U=gy(a,{theme:"default",backgroundColor:e}),et=o0()(a).hex().toLowerCase(),ft=U.indexOf(et),Ct=a;return ft!==-1&&(Ct=U[ft+1]),{mainStroke:a,mainFill:l,activeStroke:a,activeFill:s,inactiveStroke:d,inactiveFill:s,selectedStroke:a,selectedFill:e,highlightStroke:Ct,highlightFill:f,disableStroke:G,disableFill:x,edgeMainStroke:G,edgeActiveStroke:a,edgeInactiveStroke:I,edgeSelectedStroke:a,edgeHighlightStroke:a,edgeDisableStroke:w,comboMainStroke:G,comboMainFill:v,comboActiveStroke:a,comboActiveFill:s,comboInactiveStroke:G,comboInactiveFill:v,comboSelectedStroke:a,comboSelectedFill:v,comboHighlightStroke:Ct,comboHighlightFill:v,comboDisableStroke:I,comboDisableFill:x}},Y2=function(a,e,i){e===void 0&&(e="#fff"),i===void 0&&(i="#777");var s=yf(e,a,.2).rgb().toString(),l=yf(e,a,.3).rgb().toString(),f=yf(e,a,.6).rgb().toString(),d=yf(e,a,.8).rgb().toString(),v=yf(e,i,.2).rgb().toString(),x=yf(e,i,.25).rgb().toString(),w=yf(e,i,.3).rgb().toString(),I=yf(e,i,.4).rgb().toString(),G=yf(e,i,.5).rgb().toString(),U=gy(a,{theme:"dark",backgroundColor:e}),et=o0()(a).hex().toLowerCase(),ft=U.indexOf(et),Ct=a;return ft!==-1&&(Ct=U[ft+1]),{mainStroke:d,mainFill:s,activeStroke:a,activeFill:l,inactiveStroke:d,inactiveFill:s,selectedStroke:a,selectedFill:s,highlightStroke:a,highlightFill:f,disableStroke:G,disableFill:x,edgeMainStroke:i,edgeActiveStroke:a,edgeInactiveStroke:i,edgeSelectedStroke:a,edgeHighlightStroke:a,edgeDisableStroke:w,comboMainStroke:I,comboMainFill:x,comboActiveStroke:a,comboActiveFill:v,comboInactiveStroke:I,comboInactiveFill:x,comboSelectedStroke:a,comboSelectedFill:v,comboHighlightStroke:Ct,comboHighlightFill:x,comboDisableStroke:I,comboDisableFill:v}},ob=function(a,e,i,s){return e===void 0&&(e="#fff"),i===void 0&&(i="default"),s===void 0&&(s="rgb(150, 150, 150)"),i==="default"?X2(a,e,"rgb(150, 150, 150)"):Y2(a,e,"#777")},K2=function(a,e,i,s){e===void 0&&(e="#fff"),i===void 0&&(i="default"),s===void 0&&(s="rgb(150, 150, 150)");var l=[];return a.forEach(function(f){l.push(ob(f,e,i,s))}),l},Z2="rgb(95, 149, 255)",q2="rgb(255, 255, 255)",lw="rgb(0, 0, 0)",Iu=ob(Z2,q2),cg={version:"0.8.17",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:Iu.mainStroke,fill:Iu.mainFill},size:20,color:Iu.mainStroke,linkPoints:{size:8,lineWidth:1,fill:Iu.activeFill,stroke:Iu.activeStroke}},nodeStateStyles:{active:{fill:Iu.activeFill,stroke:Iu.activeStroke,lineWidth:2,shadowColor:Iu.mainStroke,shadowBlur:10},selected:{fill:Iu.selectedFill,stroke:Iu.selectedStroke,lineWidth:4,shadowColor:Iu.selectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:Iu.highlightFill,stroke:Iu.highlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:Iu.inactiveFill,stroke:Iu.inactiveStroke,lineWidth:1},disable:{fill:Iu.disableFill,stroke:Iu.disableStroke,lineWidth:1}},edgeLabel:{style:{fill:lw,textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:Iu.edgeMainStroke,lineAppendWidth:2},color:Iu.edgeMainStroke},edgeStateStyles:{active:{stroke:Iu.edgeActiveStroke,lineWidth:1},selected:{stroke:Iu.edgeSelectedStroke,lineWidth:2,shadowColor:Iu.edgeSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:Iu.edgeHighlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:Iu.edgeInactiveStroke,lineWidth:1},disable:{stroke:Iu.edgeDisableStroke,lineWidth:1}},comboLabel:{style:{fill:lw,textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:Iu.comboMainFill,lineWidth:1,stroke:Iu.comboMainStroke,r:5,width:20,height:10},size:[20,5],color:Iu.comboMainStroke,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:Iu.comboActiveStroke,lineWidth:1,fill:Iu.comboActiveFill},selected:{stroke:Iu.comboSelectedStroke,lineWidth:2,fill:Iu.comboSelectedFill,shadowColor:Iu.comboSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:Iu.comboHighlightStroke,lineWidth:2,fill:Iu.comboHighlightFill,"text-shape":{fontWeight:500}},inactive:{stroke:Iu.comboInactiveStroke,fill:Iu.comboInactiveFill,lineWidth:1},disable:{stroke:Iu.comboDisableStroke,fill:Iu.comboDisableFill,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},textWaterMarkerConfig:{width:150,height:100,compatible:!1,text:{x:0,y:60,lineHeight:20,rotate:20,fontSize:14,fontFamily:"Microsoft YaHei",fill:"rgba(0, 0, 0, 0.1)",baseline:"Middle"}},imageWaterMarkerConfig:{width:150,height:130,compatible:!1,image:{x:0,y:0,width:30,height:20,rotate:0}},waterMarkerImage:"https://gw.alipayobjects.com/os/s/prod/antv/assets/image/logo-with-text-73b8a.svg"};function l0(c,a,e){if(c){if(typeof c.addEventListener=="function")return c.addEventListener(a,e,!1),{remove:function(){c.removeEventListener(a,e,!1)}};if(typeof c.attachEvent=="function")return c.attachEvent("on"+a,e),{remove:function(){c.detachEvent("on"+a,e)}}}}var cw=Sc.cloneEvent,fw=Sc.isViewportChanged,hw=function(c){(0,P.__extends)(a,c);function a(e){var i=c.call(this,e)||this;return i.extendEvents=[],i.dragging=!1,i.mousedown=!1,i.preItem=null,i.destroy(),i.graph=e,i.destroyed=!1,i.initEvents(),i}return a.prototype.initEvents=function(){var e=this,i=e.graph,s=e.extendEvents,l=s===void 0?[]:s,f=i.get("canvas"),d=f.get("el"),v=(0,k.wrapBehavior)(this,"onCanvasEvents"),x=(0,k.wrapBehavior)(this,"onExtendEvents"),w=(0,k.wrapBehavior)(this,"onWheelEvent");f.off("*").on("*",v),this.canvasHandler=v,l.push(l0(d,"wheel",w)),typeof window!="undefined"&&(l.push(l0(window,"keydown",x)),l.push(l0(window,"keyup",x)),l.push(l0(window,"focus",x))),this.resetHandler&&i.off("afterchangedata",this.resetHandler),this.resetHandler=(0,k.wrapBehavior)(this,"resetStatus"),i.on("afterchangedata",this.resetHandler)},a.getItemRoot=function(e){for(;e&&!e.get("item");)e=e.get("parent");return e},a.prototype.onCanvasEvents=function(e){var i=this,s=this.graph,l=s.get("canvas"),f=e.target,d=e.type;switch(d){case"drag":this.onCanvasEvents(Object.assign({},e,{type:"mousemove"}));break;case"dragend":this.onCanvasEvents(Object.assign({},e,{type:"mouseup"}));break;case"mousedown":this.mousedown=!0;break;case"dragend":case"mouseup":setTimeout(function(){return i.mousedown=!1});break;case"click":if(!this.mousedown)return;break;default:break}e.canvasX=e.x,e.canvasY=e.y;var v={x:e.canvasX,y:e.canvasY},x=s.get("group"),w=x.getMatrix();if(w||(w=[1,0,0,0,1,0,0,0,1]),fw(w)&&(v=s.getPointByClient(e.clientX,e.clientY)),e.x=v.x,e.y=v.y,e.currentTarget=s,f===l){(d==="mousemove"||d==="mouseleave")&&this.handleMouseMove(e,"canvas"),e.target=l,e.item=null,s.emit(d,e),s.emit("canvas:".concat(d),e);return}var I=a.getItemRoot(f);if(!I){s.emit(d,e);return}var G=I.get("item");if(!G.destroyed){var U=G.getType();if(e.target=f,e.item=G,e.canvasX===e.x&&e.canvasY===e.y){var et=s.getCanvasByPoint(e.x,e.y);e.canvasX=et.x,e.canvasY=et.y}e.name&&!e.name.includes(":")?(s.emit("".concat(U,":").concat(d),e),s.emit(d,e)):e.name&&s.emit(e.name,e),d==="dragstart"&&(this.dragging=!0),d==="dragend"&&(this.dragging=!1),d==="mousemove"&&this.handleMouseMove(e,U)}},a.prototype.onExtendEvents=function(e){this.graph.emit(e.type,e)},a.prototype.onWheelEvent=function(e){(0,k.isNil)(e.wheelDelta)&&(e.wheelDelta=-e.detail),this.graph.emit("wheel",e)},a.prototype.handleMouseMove=function(e,i){var s=this,l=s.graph,f=s.preItem,d=l.get("canvas"),v=e.target===d?null:e.item;e=cw(e),f&&f!==v&&!f.destroyed&&(e.item=f,this.emitCustomEvent(f.getType(),"mouseleave",e),this.dragging&&this.emitCustomEvent(f.getType(),"dragleave",e)),v&&f!==v&&(e.item=v,this.emitCustomEvent(i,"mouseenter",e),this.dragging&&this.emitCustomEvent(i,"dragenter",e)),this.preItem=v},a.prototype.emitCustomEvent=function(e,i,s){s.type=i,this.graph.emit("".concat(e,":").concat(i),s)},a.prototype.resetStatus=function(){this.mousedown=!1,this.dragging=!1,this.preItem=null},a.prototype.destroy=function(){var e=this,i=e.graph,s=e.canvasHandler,l=e.extendEvents,f=i.get("canvas");f.off("*",s),(0,k.each)(l,function(d){d.remove()}),this.resetStatus(),this.extendEvents.length=0,this.canvasHandler=null,this.resetHandler=null,this.destroyed=!0},a}($x),dw=hw,pu=$(83360),pw=$(81746),my=$.n(pw),sb=Sc.traverseTree,yy=function(a,e){var i;return a?(0,k.isNumber)(a)?i=function(l){return a}:i=a:i=function(l){return e||1},i},Q2=function(a,e){var i=[],s=[],l={},f=0;for(f=0;f<a.length;f++){var d=a[f];l[d.id]=f,i.push(d.x),i.push(d.y),i.push(0),i.push(0),s.push([])}for(f=0;f<e.length;f++){var v=e[f];s[l[v.source]].push(l[v.target]),s[l[v.target]].push(l[v.source])}var x=0;for(f=0;f<a.length;f++){var w=i.length,I=s[f],G=I.length;i[f*4+2]=w,i[f*4+3]=I.length,x=Math.max(x,I.length);for(var U=0;U<G;++U){var et=I[U];i.push(+et)}}for(;i.length%4!=0;)i.push(0);return{array:new Float32Array(i),maxEdgePerVetex:x}},J2=function(a,e,i){var s=[],l=[],f={},d=0;for(d=0;d<a.length;d++){var v=a[d];f[v.id]=d,s.push(v.x),s.push(v.y),s.push(0),s.push(0),l.push([])}for(d=0;d<e.length;d++){var x=e[d];l[f[x.source]].push(f[x.target]),l[f[x.source]].push(i(x)),l[f[x.target]].push(f[x.source]),l[f[x.target]].push(i(x))}var w=0;for(d=0;d<a.length;d++){var I=s.length,G=l[d],U=G.length;s[d*4+2]=I,s[d*4+3]=U/2,w=Math.max(w,U/2);for(var et=0;et<U;++et){var ft=G[et];s.push(+ft)}}for(;s.length%4!=0;)s.push(0);return{array:new Float32Array(s),maxEdgePerVetex:w}},tC=function(a,e,i,s){var l=[],f=[],d={},v=0;for(v=0;v<a.length;v++){var x=a[v];d[x.id]=v,l.push(x.x),l.push(x.y),l.push(0),l.push(0),f.push([])}for(v=0;v<e.length;v++){var w=e[v];f[d[w.source]].push(d[w.target]),f[d[w.source]].push(i(w)),f[d[w.source]].push(s(w)),f[d[w.source]].push(0),f[d[w.target]].push(d[w.source]),f[d[w.target]].push(i(w)),f[d[w.target]].push(s(w)),f[d[w.target]].push(0)}var I=0;for(v=0;v<a.length;v++){var G=l.length,U=f[v],et=U.length;l[v*4+2]=G+1048576*et/4,l[v*4+3]=0,I=Math.max(I,et/4);for(var ft=0;ft<et;++ft){var Ct=U[ft];l.push(+Ct)}}for(;l.length%4!=0;)l.push(0);return{array:new Float32Array(l),maxEdgePerVetex:I}},vw=function(a,e){var i=[],s=a.length,l={};return e.forEach(function(f){a.forEach(function(d,v){if(l[f[d]]===void 0&&(l[f[d]]=Object.keys(l).length),i.push(l[f[d]]),v===s-1)for(;i.length%4!=0;)i.push(0)})}),{array:new Float32Array(i),count:Object.keys(l).length}},eC=function(a){for(var e=[],i=a.length,s=a[0].length,l=function(v){a.forEach(function(x,w){if(e.push(x[v]),w===i-1)for(;e.length%4!=0;)e.push(0)})},f=0;f<s;f++)l(f);return new Float32Array(e)},nC=function(a,e){var i=["V","TB","BT"],s={x:Infinity,y:Infinity},l={x:-Infinity,y:-Infinity},f="x",d="y";e&&i.indexOf(e)>=0&&(d="x",f="y");var v=0;sb(a,function(I){return v++,I.x>l.x&&(l.x=I.x),I.x<s.x&&(s.x=I.x),I.y>l.y&&(l.y=I.y),I.y<s.y&&(s.y=I.y),!0});var x=Math.PI*2/v,w=l[d]-s[d];return w===0||sb(a,function(I){var G=(I[d]-s[d])/w*(Math.PI*2-x)+x,U=Math.abs(f==="x"?I.x-a.x:I.y-a.y);return I.x=U*Math.cos(G),I.y=U*Math.sin(G),!0}),a},by=function c(){return typeof window=="undefined"||typeof document=="undefined"?{}:{canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var a=document.createElement("canvas");return!!(window.WebGLRenderingContext&&(a.getContext("webgl")||a.getContext("experimental-webgl")))}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`)),e},addGetWebGLMessage:function(e){e=e||{};var i=e.parent!==void 0?e.parent:document.body,s=e.id!==void 0?e.id:"oldie",l=c().getWebGLErrorMessage();l.id=s,i.appendChild(l)}}},gw=function(){var a=navigator.userAgent.toLowerCase();return a.indexOf("firefox")>-1?"firefox":a.indexOf("safari")>-1?"safari":a.indexOf("opr")>-1?"opera":a.indexOf("chrome")>-1?"chrome":a.indexOf("trident")>-1?"ie 11":a.indexOf("ie")>-1?"ie":"unknown"},mw=(0,P.__assign)((0,P.__assign)((0,P.__assign)((0,P.__assign)((0,P.__assign)({},Sc),B),O),F),K),Gv=mw,rC=Gv.radialLayout,yw=function(){function c(a){this.type=a.type,this.radial=a.radial,this.config=a}return c.prototype.init=function(a){var e=this;if(this.data=a,this.radial){this.layoutMethod=function(i){var s=my()[e.type](i,e.config);return rC(s),s};return}this.layoutMethod=function(i){return my()[e.type](i,e.config)}},c.prototype.execute=function(){return this.layoutMethod(this.data,this.config)},c.prototype.layout=function(a){return this.init(a),this.execute()},c}(),bw=yw;(0,pu.registerLayout)("grid",pu.GridLayout),(0,pu.registerLayout)("random",pu.RandomLayout),(0,pu.registerLayout)("force",pu.ForceLayout),(0,pu.registerLayout)("circular",pu.CircularLayout),(0,pu.registerLayout)("dagre",pu.DagreLayout),(0,pu.registerLayout)("dagreCompound",pu.DagreCompoundLayout),(0,pu.registerLayout)("radial",pu.RadialLayout),(0,pu.registerLayout)("concentric",pu.ConcentricLayout),(0,pu.registerLayout)("mds",pu.MDSLayout),(0,pu.registerLayout)("fruchterman",pu.FruchtermanLayout),(0,pu.registerLayout)("fruchterman-gpu",pu.FruchtermanGPULayout),(0,pu.registerLayout)("gForce",pu.GForceLayout),(0,pu.registerLayout)("force2",pu.Force2Layout),(0,pu.registerLayout)("gForce-gpu",pu.GForceGPULayout),(0,pu.registerLayout)("comboForce",pu.ComboForceLayout),(0,pu.registerLayout)("comboCombined",pu.ComboCombinedLayout),(0,pu.registerLayout)("forceAtlas2",pu.ForceAtlas2Layout);var ub=function(a,e){e.isCustomLayout=!0,pu.Layouts[a]=(0,pu.registerLayout)(a,e)},aC=function(){function c(a,e){var i=a.toString(),s=new Blob(["importScripts('".concat(e,"');(").concat(i,")()")],{type:"text/javascript"});return new Worker(URL.createObjectURL(s))}return c}(),iC=aC,oC=function(a){a===void 0&&(a="https://unpkg.com/@antv/layout@0.3.23/dist/layout.min.js");function e(){var s={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};layout.registerLayout("grid",layout.GridLayout),layout.registerLayout("random",layout.RandomLayout),layout.registerLayout("force",layout.ForceLayout),layout.registerLayout("force2",layout.Force2Layout),layout.registerLayout("circular",layout.CircularLayout),layout.registerLayout("dagre",layout.DagreLayout),layout.registerLayout("dagreCompound",layout.DagreCompoundLayout),layout.registerLayout("radial",layout.RadialLayout),layout.registerLayout("concentric",layout.ConcentricLayout),layout.registerLayout("mds",layout.MDSLayout),layout.registerLayout("fruchterman",layout.FruchtermanLayout),layout.registerLayout("fruchterman-gpu",layout.FruchtermanGPULayout),layout.registerLayout("gForce",layout.GForceLayout),layout.registerLayout("gForce-gpu",layout.GForceGPULayout),layout.registerLayout("comboForce",layout.ComboForceLayout),layout.registerLayout("comboCombined",layout.ComboCombinedLayout),layout.registerLayout("forceAtlas2",layout.ForceAtlas2Layout);function l(d){var v=d.data.type;return v===s.RUN||v===s.GPURUN}function f(d){var v=this,x=d.data.type;switch(x){case s.RUN:{var w=d.data,I=w.nodes,G=w.edges,U=w.layoutCfg,et=U===void 0?{}:U,ft=et.type,Ct=layout.getLayoutByName(ft);if(!Ct){this.postMessage({type:s.ERROR,message:"layout ".concat(ft," not found")});break}var Mt;et.onLayoutEnd=function(){v.postMessage({type:s.END,nodes:I}),Mt==null||Mt.destroy()},Mt=new Ct(et),Mt.init({nodes:I,edges:G}),Mt.execute();break}case s.GPURUN:{var kt=d.data,$t=kt.nodes,G=kt.edges,Jt=kt.layoutCfg,et=Jt===void 0?{}:Jt,Ce=kt.canvas,ft=et.type,Ct=layout.getLayoutByName(ft);if(!Ct){this.postMessage({type:s.ERROR,message:"layout ".concat(ft," not found")});break}if(ft.split("-")[1]!=="gpu"){this.postMessage({type:s.ERROR,message:"layout ".concat(ft," does not support GPU")});break}var je=new Ct(et);je.init({nodes:$t,edges:G}),je.executeWithWorker(Ce,this);break}default:break}}onmessage=function(v){l(v)&&f(v)}}var i=new iC(e,a);return i},fg={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};function xm(c){return xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},xm(c)}var c0=function(a){return setTimeout(a,16)},f0=function(a){return clearTimeout(a)},Og={requestAnimationFrame:function(a){var e=typeof window!="undefined"&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame)||c0;return e(a)},cancelAnimationFrame:function(a){var e=typeof window!="undefined"&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame)||f0;return e(a)}},sC=["fruchterman","gForce"],lb=["force","grid","circular"],uC=function(c){(0,P.__extends)(a,c);function a(e){var i=c.call(this,e)||this;return i.graph=e,i.layoutCfg=e.get("layout")||{},i.layoutType=i.getLayoutType(),i.worker=null,i.workerData={},i.initLayout(),i}return a.prototype.initLayout=function(){},a.prototype.getWorker=function(){return this.worker?this.worker:(typeof Worker=="undefined"?(console.warn("Web worker is not supported in current browser."),this.worker=null):this.worker=oC(this.layoutCfg.workerScriptURL),this.worker)},a.prototype.stopWorker=function(){var e=this.workerData;!this.worker||(this.worker.terminate(),this.worker=null,e.requestId&&(Og.cancelAnimationFrame(e.requestId),e.requestId=null),e.requestId2&&(Og.cancelAnimationFrame(e.requestId2),e.requestId2=null))},a.prototype.execLayoutMethod=function(e,i){var s=this;return new Promise(function(l,f){return(0,P.__awaiter)(s,void 0,void 0,function(){var d,v,x,w,I,G,U,et,ft,G,Ct;return(0,P.__generator)(this,function(Mt){switch(Mt.label){case 0:if(d=this.graph,!d||d.get("destroyed"))return[2];v=e.type,e.onLayoutEnd=function(){d.emit("aftersublayout",{type:v}),l()},v&&this.isGPU&&(Sw(v)?v="".concat(v,"-gpu"):console.warn("The '".concat(v,"' layout does not support GPU calculation for now, it will run in CPU."))),Sc.isForce(v)?(x=e.onTick,w=e.animate,I=w===void 0&&(v==="force"||v==="force2"),G=function(){x&&x(),(w||I)&&d.refreshPositions()},e.tick=G):(v==="comboForce"||v==="comboCombined")&&(e.comboTrees=d.get("comboTrees")),U=!1;try{et=new pu.Layouts[v](e),this.layoutMethods[i]&&this.layoutMethods[i].destroy(),this.layoutMethods[i]=et}catch(kt){console.warn("The layout method: '".concat(v,"' does not exist! Please specify it first.")),f()}return U=et.enableTick,U&&(ft=e.onTick,G=function(){ft&&ft(),d.refreshPositions()},et.tick=G),Ct=this.filterLayoutData(this.data,e),Ew(Ct,i),et.init(Ct),d.emit("beforesublayout",{type:v}),[4,et.execute()];case 1:return Mt.sent(),et.isCustomLayout&&e.onLayoutEnd&&e.onLayoutEnd(),[2]}})})})},a.prototype.updateLayoutMethod=function(e,i){var s=this;return new Promise(function(l,f){return(0,P.__awaiter)(s,void 0,void 0,function(){var d,v,x,w,I,G,U;return(0,P.__generator)(this,function(et){switch(et.label){case 0:return d=this.graph,v=i==null?void 0:i.type,i.onLayoutEnd=function(){d.emit("aftersublayout",{type:v}),l()},Sc.isForce(v)&&(x=i.onTick,w=i.animate,I=w===void 0&&(v==="force"||v==="force2"),G=function(){x==null||x(),(w||I)&&d.refreshPositions()},i.tick=G),U=this.filterLayoutData(this.data,i),e.init(U),e.updateCfg(i),d.emit("beforesublayout",{type:v}),[4,e.execute()];case 1:return et.sent(),e.isCustomLayout&&i.onLayoutEnd&&i.onLayoutEnd(),[2]}})})})},a.prototype.layout=function(e){var i=this,s,l=this.graph;if(!(!l||l.get("destroyed"))){this.data=this.setDataFromGraph();var f=this.data,d=f.nodes,v=f.hiddenNodes;if(!d)return!1;var x=l.get("width"),w=l.get("height"),I={};Object.assign(I,{width:x,height:w,center:[x/2,w/2]},this.layoutCfg),this.layoutCfg=I;var G=I.type,U=!1;(s=this.layoutMethods)===null||s===void 0||s.forEach(function(Ce){var je;return U=!!((je=Ce.nodes)===null||je===void 0?void 0:je.length)||U});var et=this.destoryLayoutMethods();l.emit("beforelayout");var ft=Promise.resolve();U&&G&&(et==null?void 0:et.length)===1&&et[0]===G?this.tweakInit():ft=this.initPositions(I.center,d);var Ct=this.initPositions(I.center,v);Ct.then(),this.isGPU=h0(I,G);var Mt=I.onLayoutEnd,kt=I.layoutEndFormatted,$t=I.adjust;if(kt||(I.layoutEndFormatted=!0,I.onAllLayoutEnd=function(){return(0,P.__awaiter)(i,void 0,void 0,function(){return(0,P.__generator)(this,function(Ce){switch(Ce.label){case 0:return Mt&&Mt(d),this.refreshLayout(),$t&&I.pipes?[4,this.adjustPipesBox(this.data,$t)]:[3,2];case 1:Ce.sent(),this.refreshLayout(),Ce.label=2;case 2:return l.emit("afterlayout"),[2]}})})}),this.stopWorker(),I.workerEnabled&&this.layoutWithWorker(this.data,e))return!0;var Jt=!1;return I.type?(Jt=!0,ft=ft.then(function(){return(0,P.__awaiter)(i,void 0,void 0,function(){return(0,P.__generator)(this,function(Ce){switch(Ce.label){case 0:return[4,this.execLayoutMethod(I,0)];case 1:return[2,Ce.sent()]}})})})):I.pipes&&(Jt=!0,I.pipes.forEach(function(Ce,je){ft=ft.then(function(){return(0,P.__awaiter)(i,void 0,void 0,function(){return(0,P.__generator)(this,function(ze){switch(ze.label){case 0:return[4,this.execLayoutMethod(Ce,je)];case 1:return[2,ze.sent()]}})})})})),Jt?ft.then(function(){I.onAllLayoutEnd&&I.onAllLayoutEnd(),e&&e()}).catch(function(Ce){console.warn("graph layout failed,",Ce)}):(l.refreshPositions(),e==null||e()),!1}},a.prototype.tweakInit=function(){var e=this,i=e.data,s=e.graph,l=i.nodes,f=i.edges;if(!!(l==null?void 0:l.length)){var d={};l.forEach(function(w){var I=w.x,G=w.y;!isNaN(I)&&!isNaN(G)&&(d[w.id]={x:I,y:G},w.mass=w.mass||2)}),f.forEach(function(w){var I=w.source,G=w.target,U=d[I],et=d[G];!U&&et?d[I]={x:et.x+(Math.random()-.5)*80,y:et.y+(Math.random()-.5)*80}:!et&&U&&(d[G]={x:U.x+(Math.random()-.5)*80,y:U.y+(Math.random()-.5)*80})});var v=s.get("width"),x=s.get("height");l.forEach(function(w){var I=d[w.id]||{x:v/2+(Math.random()-.5)*20,y:x/2+(Math.random()-.5)*20};w.x=I.x,w.y=I.y})}},a.prototype.initWithPreset=function(e,i){var s=this;return new Promise(function(l,f){return(0,P.__awaiter)(s,void 0,void 0,function(){var d,v,x,w,I,G,U;return(0,P.__generator)(this,function(et){switch(et.label){case 0:return d=this,v=d.layoutCfg,x=d.data,w=v.preset,!(w==null?void 0:w.type)||!pu.Layouts[w==null?void 0:w.type]?(i==null||i(),l(),[2,!1]):(I=h0(w,w.type),G=I?"".concat(w.type,"-gpu"):w.type,U=new pu.Layouts[G](w),delete v.preset,U.init(x),[4,U.execute()]);case 1:return et.sent(),e==null||e(),l(),[2,!0]}})})})},a.prototype.layoutWithWorker=function(e,i){var s=this,l=this,f=l.layoutCfg,d=l.graph,v=this.getWorker(),x=this.workerData;if(!v)return!1;x.requestId=null,x.requestId2=null,x.currentTick=null,x.currentTickData=null,d.emit("beforelayout");var w=Promise.resolve(),I=!1;if(f.type)I=!0,w=w.then(function(){return s.runWebworker(v,e,f)});else if(f.pipes){I=!0;for(var G=function(Mt){w=w.then(function(){return s.runWebworker(v,e,Mt)})},U=0,et=f.pipes;U<et.length;U++){var ft=et[U];G(ft)}}return I&&w.then(function(){f.onAllLayoutEnd&&f.onAllLayoutEnd(),i==null||i()}).catch(function(Ct){console.error("layout failed",Ct)}),!0},a.prototype.runWebworker=function(e,i,s){var l=this,f=this.isGPU,d=this.filterLayoutData(i,s),v=d.nodes,x=d.edges,w=document.createElement("canvas"),I=f&&typeof window!="undefined"&&window.navigator&&!navigator.gpu&&"OffscreenCanvas"in window&&"transferControlToOffscreen"in w,G=ww(s,function(et){return typeof et!="function"});if(!I)e.postMessage({type:fg.RUN,nodes:v,edges:x,layoutCfg:G});else{var U=w.transferControlToOffscreen();G.type="".concat(G.type,"-gpu"),e.postMessage({type:fg.GPURUN,nodes:v,edges:x,layoutCfg:G,canvas:U},[U])}return new Promise(function(et,ft){e.onmessage=function(Ct){l.handleWorkerMessage(et,ft,Ct,d,s)}})},a.prototype.handleWorkerMessage=function(e,i,s,l,f){var d=this,v=d.graph,x=d.workerData,w=s.data,I=w.type,G=function(){f.onTick&&f.onTick()};switch(I){case fg.TICK:x.currentTick=w.currentTick,x.currentTickData=w,x.requestId||(x.requestId=Og.requestAnimationFrame(function(){cb(l,w),v.refreshPositions(),G(),w.currentTick===w.totalTicks?e():x.currentTick===w.totalTicks&&(x.requestId2=Og.requestAnimationFrame(function(){cb(l,x.currentTickData),v.refreshPositions(),x.requestId2=null,G(),e()})),x.requestId=null}));break;case fg.END:x.currentTick==null&&(cb(l,w),e());break;case fg.GPUEND:x.currentTick==null&&(lC(l,w),e());break;case fg.ERROR:console.warn("Web-Worker layout error!",w.message),i();break;default:i();break}},a.prototype.updateLayoutCfg=function(e){var i=this,s=this,l=s.graph,f=s.layoutMethods;if(!(!l||l.get("destroyed"))){var d=e.disableTriggerLayout,v=(0,P.__rest)(e,["disableTriggerLayout"]),x=(0,k.mix)({},this.layoutCfg,v);if(this.layoutCfg=x,!d){if(!(f==null?void 0:f.length)){this.layout();return}if(this.data=this.setDataFromGraph(),this.stopWorker(),!(v.workerEnabled&&this.layoutWithWorker(this.data,null))){l.emit("beforelayout");var w=Promise.resolve(),I=!1;(f==null?void 0:f.length)===1?(I=!0,w=w.then(function(){return(0,P.__awaiter)(i,void 0,void 0,function(){return(0,P.__generator)(this,function(G){switch(G.label){case 0:return[4,this.updateLayoutMethod(f[0],x)];case 1:return[2,G.sent()]}})})})):(f==null?void 0:f.length)&&(I=!0,f.forEach(function(G,U){var et=x.pipes[U];w=w.then(function(){return(0,P.__awaiter)(i,void 0,void 0,function(){return(0,P.__generator)(this,function(ft){switch(ft.label){case 0:return[4,this.updateLayoutMethod(G,et)];case 1:return[2,ft.sent()]}})})})})),I&&w.then(function(){x.onAllLayoutEnd&&x.onAllLayoutEnd()}).catch(function(G){console.warn("layout failed",G)})}}}},a.prototype.adjustPipesBox=function(e,i){var s=this;return new Promise(function(l){var f=e.nodes;(f==null?void 0:f.length)||l(),lb.includes(i)||(console.warn("The adjust type ".concat(i," is not supported yet, please assign it with 'force', 'grid', or 'circular'.")),l());var d={center:s.layoutCfg.center,nodeSize:function(et){return Math.max(et.height,et.width)},preventOverlap:!0,onLayoutEnd:function(){}},v=s.getLayoutBBox(f),x=v.groupNodes,w=v.layoutNodes,I=(0,k.clone)(w);d.onLayoutEnd=function(){w==null||w.forEach(function(U,et){var ft,Ct,Mt,kt=U.x-((ft=I[et])===null||ft===void 0?void 0:ft.x),$t=U.y-((Ct=I[et])===null||Ct===void 0?void 0:Ct.y);(Mt=x[et])===null||Mt===void 0||Mt.forEach(function(Jt){Jt.x+=kt,Jt.y+=$t})}),l()};var G=new pu.Layouts[i](d);G.layout({nodes:w})})},a.prototype.destroy=function(){this.destoryLayoutMethods();var e=this.worker;e&&(e.terminate(),this.worker=null),this.destroyed=!0,this.graph.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0,this.graph=null},a}(zx),xw=uC;function cb(c,a){for(var e=c.nodes,i=a.nodes,s=e.length,l=0;l<s;l++){var f=e[l];f.x=i[l].x,f.y=i[l].y}}function ww(c,a){var e={};return c&&xm(c)==="object"?(Object.keys(c).forEach(function(i){c.hasOwnProperty(i)&&a(c[i])&&(e[i]=c[i])}),e):c}function lC(c,a){for(var e=c.nodes,i=a.vertexEdgeData,s=e.length,l=0;l<s;l++){var f=e[l],d=i[4*l],v=i[4*l+1];f.x=d,f.y=v}}function Ew(c,a){var e;if(!!((e=c==null?void 0:c.nodes)===null||e===void 0?void 0:e.length)){var i=c.nodes;i.forEach(function(s){s.layoutOrder=a})}}function Sw(c){return sC.includes(c)}function h0(c,a){var e=a;a&&a.split("-")[1]==="gpu"&&(e=a.split("-")[0],c.gpuEnabled=!0);var i=!1;return c.gpuEnabled&&(i=!0,by().webgl||(console.warn("Your browser does not support webGL or GPGPU. The layout will run in CPU."),i=!1)),i&&!Sw(e)&&(console.warn("The '".concat(e,"' layout does not support GPU calculation for now, it will run in CPU.")),i=!1),i}var d0,fb,Cw,xy;function cC(){d0=document.createElement("table"),fb=document.createElement("tr"),Cw=/^\s*<(\w+|!)[^>]*>/,xy={tr:document.createElement("tbody"),tbody:d0,thead:d0,tfoot:d0,td:fb,th:fb,"*":document.createElement("div")}}function ql(c){d0||cC();var a=Cw.test(c)&&RegExp.$1;(!a||!(a in xy))&&(a="*");var e=xy[a];c=typeof c=="string"?c.replace(/(^\s*)|(\s*$)/g,""):c,e.innerHTML=""+c;var i=e.childNodes[0];return i&&e.contains(i)&&e.removeChild(i),i}var fC=function(a){var e=a.clone();return hC(a,e),e},hC=function c(a,e){var i;a.isGroup()&&e.isGroup()&&((i=a.get("children"))===null||i===void 0||i.forEach(function(d,v){var x=e.get("children")[v];c(d,x)}));var s=a.get("type"),l=e.get("type");if(!(s!=="image"||l!=="image")){var f=a.get("clipShape");f&&e.setClip({type:f.get("type"),attrs:f.attr()})}},_w=Le,dC="svg",pC=function(c){(0,P.__extends)(a,c);function a(e){var i=c.call(this,e)||this,s=i.get("defaultNode");return s||i.set("defaultNode",{type:"circle"}),s.type||(s.type="circle",i.set("defaultNode",s)),i.destroyed=!1,i}return a.prototype.initLayoutController=function(){var e=new xw(this);this.set({layoutController:e})},a.prototype.initEventController=function(){var e=new dw(this);this.set({eventController:e})},a.prototype.initCanvas=function(){var e=this.get("container");if(typeof e=="string"&&(e=document.getElementById(e),this.set("container",e)),!e)throw new Error("invalid container");var i=e.clientWidth,s=e.clientHeight,l=this.get("width")||i,f=this.get("height")||s;!this.get("width")&&!this.get("height")&&(this.set("width",i),this.set("height",s));var d=this.get("renderer"),v;if(d===dC)v=new Rp({container:e,width:l,height:f});else{var x={container:e,width:l,height:f},w=this.get("pixelRatio");w&&(x.pixelRatio=w,window.devicePixelRatio=w),v=new $v(x)}this.set("canvas",v)},a.prototype.initPlugins=function(){var e=this;(0,k.each)(e.get("plugins"),function(i){!i.destroyed&&i.initPlugin&&i.initPlugin(e)})},a.prototype.downloadImageWatermark=function(e,i,s,l){return(0,P.__awaiter)(this,void 0,void 0,function(){var f,d,v;return(0,P.__generator)(this,function(x){switch(x.label){case 0:return f=e.style.backgroundImage,d=f.slice(5,f.length-2),v=new Image,v.src=d,[4,new Promise(function(w){v.onload=function(){var I=i.createPattern(v,"repeat");i.rect(0,0,s,l),i.fillStyle=I,i.fill(),w("")}})];case 1:return x.sent(),[2]}})})},a.prototype.asyncToDataUrl=function(e,i,s,l,f,d){var v=this,x=document.querySelector(".g6-graph-watermarker"),w=this.get("canvas"),I=w.getRenderer(),G=d||w.get("el"),U="";e||(e="image/png"),setTimeout(function(){return(0,P.__awaiter)(v,void 0,void 0,function(){var et,ft,Ct,Mt,kt,$t,Jt,Ce,je,ze;return(0,P.__generator)(this,function(pn){switch(pn.label){case 0:return I!=="svg"?[3,1]:(et=G.cloneNode(!0),ft=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),Ct=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",ft),Ct.replaceChild(et,Ct.documentElement),Mt=new XMLSerializer().serializeToString(Ct),U="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(Mt)),[3,4]);case 1:return kt=void 0,$t=G.getContext("2d"),Jt=l||this.get("width"),Ce=f||this.get("height"),je=void 0,x?[4,this.downloadImageWatermark(x,$t,Jt,Ce)]:[3,3];case 2:pn.sent(),pn.label=3;case 3:if(i){ze=typeof window!="undefined"?window.devicePixelRatio:1;try{kt=$t.getImageData(0,0,Jt*ze,Ce*ze),je=$t.globalCompositeOperation,$t.globalCompositeOperation="destination-over",$t.fillStyle=i,$t.fillRect(0,0,Jt,Ce)}catch(Fn){console.error("Download image failed. Out of memory at ImageData creation")}}U=G.toDataURL(e),i&&($t.clearRect(0,0,Jt,Ce),$t.putImageData(kt,0,0),$t.globalCompositeOperation=je),pn.label=4;case 4:return s&&s(U),[2]}})})},16)},a.prototype.toDataURL=function(e,i){var s=this.get("canvas"),l=s.getRenderer(),f=s.get("el");e||(e="image/png");var d="";if(l==="svg"){var v=f.cloneNode(!0),x=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),w=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",x);w.replaceChild(v,w.documentElement);var I=new XMLSerializer().serializeToString(w);d="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(I))}else{var G=void 0,U=f.getContext("2d"),et=Math.max(this.get("width"),500),ft=Math.max(this.get("height"),500),Ct=void 0;if(i){var Mt=typeof window!="undefined"&&window.devicePixelRatio||1;try{G=U.getImageData(0,0,et*Mt,ft*Mt),Ct=U.globalCompositeOperation,U.globalCompositeOperation="destination-over",U.fillStyle=i,U.fillRect(0,0,et,ft)}catch(kt){console.error("Download image failed. Out of memory at ImageData creation")}}d=f.toDataURL(e),i&&(U.clearRect(0,0,et,ft),U.putImageData(G,0,0),U.globalCompositeOperation=Ct)}return d},a.prototype.toFullDataURL=function(e,i,s){var l=this.get("group").getCanvasBBox(),f=l.height,d=l.width,v=this.get("renderer"),x=ql('<div id="virtual-image"></div>'),w=s?s.backgroundColor:void 0,I=s?s.padding:void 0;I?(0,k.isNumber)(I)&&(I=[I,I,I,I]):I=[0,0,0,0];var G=f+I[0]+I[2],U=d+I[1]+I[3],et={container:x,height:G,width:U,quickHit:!0},ft=v==="svg"?new Rp(et):new $v(et),Ct=this.get("group"),Mt=Ct.clone(),kt=(0,k.clone)(Mt.getMatrix());kt||(kt=[1,0,0,0,1,0,0,0,1]);var $t=(l.maxX+l.minX)/2,Jt=(l.maxY+l.minY)/2;kt=_w(kt,[["t",-$t,-Jt],["t",d/2+I[3],f/2+I[0]]]),Mt.resetMatrix(),Mt.setMatrix(kt),ft.add(Mt);var Ce=ft.get("el"),je="";i||(i="image/png"),setTimeout(function(){if(v==="svg"){var ze=Ce.cloneNode(!0),pn=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),Fn=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",pn);Fn.replaceChild(ze,Fn.documentElement);var Tn=new XMLSerializer().serializeToString(Fn);je="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(Tn))}else{var cr=void 0,kr=Ce.getContext("2d"),Aa=void 0;if(w){var ci=typeof window!="undefined"?window.devicePixelRatio:1;try{cr=kr.getImageData(0,0,U*ci,G*ci),Aa=kr.globalCompositeOperation,kr.globalCompositeOperation="destination-over",kr.fillStyle=w,kr.fillRect(0,0,U,G)}catch(ei){console.error("Download image failed. Out of memory at ImageData creation")}}je=Ce.toDataURL(i),w&&(kr.clearRect(0,0,U,G),kr.putImageData(cr,0,0),kr.globalCompositeOperation=Aa)}e&&e(je)},16)},a.prototype.downloadFullImage=function(e,i,s){var l=this,f=this.get("group").getCanvasBBox(),d=f.height,v=f.width,x=this.get("renderer"),w=ql('<div id="virtual-image"></div>'),I=document.querySelector(".g6-graph-watermarker"),G=s?s.backgroundColor:void 0,U=s?s.padding:void 0;U?(0,k.isNumber)(U)&&(U=[U,U,U,U]):U=[0,0,0,0];var et=d+U[0]+U[2],ft=v+U[1]+U[3];if(I){var Ct=this.get("graphWaterMarker").cfg||{},Mt=Ct.width,kt=Ct.height;et=Math.ceil(et/kt)*kt,ft=Math.ceil(ft/Mt)*Mt}var $t={container:w,height:et,width:ft},Jt=x==="svg"?new Rp($t):new $v($t),Ce=this.get("group"),je=fC(Ce),ze=(0,k.clone)(je.getMatrix());ze||(ze=[1,0,0,0,1,0,0,0,1]);var pn=(f.maxX+f.minX)/2,Fn=(f.maxY+f.minY)/2;ze=_w(ze,[["t",-pn,-Fn],["t",v/2+U[3],d/2+U[0]]]),je.resetMatrix(),je.setMatrix(ze),Jt.add(je);var Tn=Jt.get("el");i||(i="image/png"),this.asyncToDataUrl(i,G,function(cr){var kr=document.createElement("a"),Aa=(e||"graph")+(x==="svg"?".svg":".".concat(i.split("/")[1]));l.dataURLToImage(cr,x,kr,Aa);var ci=document.createEvent("MouseEvents");ci.initEvent("click",!1,!1),kr.dispatchEvent(ci)},ft,et,Tn)},a.prototype.downloadImage=function(e,i,s){var l=this,f=this;f.stopAnimate();var d=f.get("canvas"),v=d.getRenderer();i||(i="image/png");var x=(e||"graph")+(v==="svg"?".svg":i.split("/")[1]),w=document.createElement("a");f.asyncToDataUrl(i,s,function(I){l.dataURLToImage(I,v,w,x);var G=document.createEvent("MouseEvents");G.initEvent("click",!1,!1),w.dispatchEvent(G)})},a.prototype.dataURLToImage=function(e,i,s,l){if(!e||e==="data:"){console.error("Download image failed. The graph is too large or there is invalid attribute values in graph items");return}if(typeof window!="undefined")if(window.Blob&&window.URL&&i!=="svg"){var f=e.split(","),d="";if(f&&f.length>0){var v=f[0].match(/:(.*?);/);v&&v.length>=2&&(d=v[1])}for(var x=atob(f[1]),w=x.length,I=new Uint8Array(w);w--;)I[w]=x.charCodeAt(w);var G=new Blob([I],{type:d});window.navigator.msSaveBlob?window.navigator.msSaveBlob(G,l):s.addEventListener("click",function(){s.download=l,s.href=window.URL.createObjectURL(G)})}else s.addEventListener("click",function(){s.download=l,s.href=e})},a.prototype.addPlugin=function(e){var i=this;e.destroyed||(i.get("plugins").push(e),e.initPlugin(i))},a.prototype.removePlugin=function(e){var i=this.get("plugins"),s=i.indexOf(e);s>=0&&(e.destroyPlugin(),i.splice(s,1))},a.prototype.setImageWaterMarker=function(e,i){e===void 0&&(e=cg.waterMarkerImage);var s=this.get("container");(0,k.isString)(s)&&(s=document.getElementById(s)),s.style.position||(s.style.position="relative");var l=this.get("graphWaterMarker"),f=(0,k.deepMix)({},cg.imageWaterMarkerConfig,i),d=f.width,v=f.height,x=f.compatible,w=f.image;if(!e){var I=x?s:document.querySelector(".g6-graph-watermarker");I&&(I.style.cssText=void 0),l&&l.clear();return}if(l)l.clear();else{var G={container:s,width:d,height:v,capture:!1},U=this.get("pixelRatio");U&&(G.pixelRatio=U,window.devicePixelRatio=U),l=new $v(G),this.set("graphWaterMarker",l)}l.get("el").style.display="none";var et=l.get("context"),ft=w.rotate,Ct=w.x,Mt=w.y;et.rotate(-ft*Math.PI/180);var kt=new Image;kt.crossOrigin="anonymous",kt.src=e,kt.onload=function(){if(et.drawImage(kt,Ct,Mt,w.width,w.height),et.rotate(ft*Math.PI/180),x)s.style.cssText="background-image: url(".concat(l.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var $t=document.querySelector(".g6-graph-watermarker");$t||($t=document.createElement("div"),$t.className="g6-graph-watermarker"),$t.className="g6-graph-watermarker",l.destroyed||($t.style.cssText="background-image: url(".concat(l.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:-1;"),s.appendChild($t))}}},a.prototype.setTextWaterMarker=function(e,i){var s=this.get("container");(0,k.isString)(s)&&(s=document.getElementById(s)),s.style.position||(s.style.position="relative");var l=this.get("graphWaterMarker"),f=(0,k.deepMix)({},cg.textWaterMarkerConfig,i),d=f.width,v=f.height,x=f.compatible,w=f.text;if(!(e==null?void 0:e.length)){var I=x?s:document.querySelector(".g6-graph-watermarker");I&&(I.style.cssText=void 0),l&&l.clear();return}if(l)l.clear();else{var G={container:s,width:d,height:v,capture:!1},U=this.get("pixelRatio");U&&(G.pixelRatio=U,window.devicePixelRatio=U),l=new $v(G),this.set("graphWaterMarker",l)}l.get("el").style.display="none";var et=l.get("context"),ft=w.rotate,Ct=w.fill,Mt=w.fontFamily,kt=w.fontSize,$t=w.baseline,Jt=w.x,Ce=w.y,je=w.lineHeight;et.rotate(-ft*Math.PI/180),et.font="".concat(kt,"px ").concat(Mt),et.fillStyle=Ct,et.textBaseline=$t;for(var ze=(0,k.isString)(e)?[e]:e,pn=ze.length-1;pn>=0;pn--)et.fillText(ze[pn],Jt,Ce+pn*je);if(et.rotate(ft*Math.PI/180),x)s.style.cssText="background-image: url(".concat(l.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var Fn=document.querySelector(".g6-graph-watermarker");Fn||(Fn=document.createElement("div"),Fn.className="g6-graph-watermarker"),Fn.style.cssText="background-image: url(".concat(l.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:99;"),s.appendChild(Fn)}},a.prototype.destroy=function(){var e,i,s,l;(0,k.each)(this.get("plugins"),function(w){w.destroyPlugin()});var f=this.get("tooltips");if(f)for(var d=0;d<f.length;d++){var v=f[d];if(!!v){var x=v.parentElement;!x||x.removeChild(v)}}(e=this.get("eventController"))===null||e===void 0||e.destroy(),(i=this.get("layoutController"))===null||i===void 0||i.destroy(),(s=this.get("graphWaterMarker"))===null||s===void 0||s.destroy(),(l=document.querySelector(".g6-graph-watermarker"))===null||l===void 0||l.remove(),c.prototype.destroy.call(this)},a}(X0),Iw=pC,vC=Gv.radialLayout,hb=Gv.traverseTree,wm=function(c){(0,P.__extends)(a,c);function a(e){var i=c.call(this,e)||this;return i.layoutAnimating=!1,i.set("removeList",[]),i.set("layoutMethod",i.getLayout()),i}return a.prototype.getLayout=function(){var e=this.get("layout");return e?typeof e=="function"?e:(e.type||(e.type="dendrogram"),e.direction||(e.direction=e.type==="indented"?"LR":"TB"),e.radial?function(i){var s=my()[e.type](i,e);return vC(s),s}:function(i){return my()[e.type](i,e)}):null},a.indexOfChild=function(e,i){var s=-1;return(0,k.each)(e,function(l,f){if(i===l.id)return s=f,!1}),s},a.prototype.getDefaultCfg=function(){var e=c.prototype.getDefaultCfg.call(this);return e.animate=!0,e},a.prototype.innerAddChild=function(e,i,s){var l=this,f=e.data;f&&(f.x=e.x,f.y=e.y,f.depth=e.depth);var d=l.addItem("node",f,!1);if(i){if(d.set("parent",i),s){var v=i.get("originAttrs");if(v)d.set("originAttrs",v);else{var x=i.getModel();d.set("originAttrs",{x:x.x,y:x.y})}}var w=i.get("children");w?w.push(d):i.set("children",[d]),l.addItem("edge",{source:i.get("id"),target:d.get("id"),id:"".concat(i.get("id"),":").concat(d.get("id"))},!1)}return(0,k.each)(e.children||[],function(I){l.innerAddChild(I,d,s)}),l.emit("afteraddchild",{item:d,parent:i}),d},a.prototype.innerUpdateChild=function(e,i,s){var l=this,f=l.findById(e.id);if(!f){l.innerAddChild(e,i,s);return}(0,k.each)(e.children||[],function(et){l.innerUpdateChild(et,f,s)});var d=f.get("children");if(d){var v=d.length;if(v>0)for(var x=d.length-1;x>=0;x--){var w=d[x].getModel();a.indexOfChild(e.children||[],w.id)===-1&&(l.innerRemoveChild(w.id,{x:e.x,y:e.y},s),d.splice(x,1))}}var I,G;f.get("originAttrs")&&(I=f.get("originAttrs").x,G=f.get("originAttrs").y);var U=f.getModel();s&&f.set("originAttrs",{x:U.x,y:U.y}),f.set("model",Object.assign(U,e.data)),(I!==e.x||G!==e.y)&&f.updatePosition({x:e.x,y:e.y})},a.prototype.innerRemoveChild=function(e,i,s){var l=this,f=l.findById(e);if(!!f)if((0,k.each)(f.get("children"),function(v){l.innerRemoveChild(v.getModel().id,i,s)}),s){var d=f.getModel();f.set("to",i),f.set("originAttrs",{x:d.x,y:d.y}),l.get("removeList").push(f)}else l.removeItem(f,!1)},a.prototype.changeData=function(e,i){i===void 0&&(i=!0);var s=this;this.getNodes().map(function(l){return s.clearItemStates(l)}),this.getEdges().map(function(l){return s.clearItemStates(l)}),i&&this.get("enabledStack")&&this.pushStack("changedata",{before:s.get("originData"),after:e||s.get("data")}),e?(s.data(e),s.render(!1)):s.layout(this.get("fitView"))},a.prototype.changeLayout=function(e){console.warn("Please call updateLayout instead of changeLayout. changeLayout will be discarded soon");var i=this;i.updateLayout(e)},a.prototype.updateLayout=function(e,i,s,l){l===void 0&&(l=!0);var f=this;if(!e){console.warn("layout cannot be null");return}if(l&&this.get("enabledStack")&&this.pushStack("layout",{before:f.get("layout"),after:e}),f.set("layout",e),f.set("layoutMethod",f.getLayout()),f.layout(),i){var d=s;d||(i==="begin"?d={x:0,y:0}:d={x:this.getWidth()/2,y:this.getHeight()/2}),d=this.getPointByCanvas(d.x,d.y);var v=this.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];d.x=d.x*v[0]+v[6],d.y=d.y*v[0]+v[7];var x=this.getGroup().getCanvasBBox(),w=x.minX,I=x.maxX,G=x.minY,U=x.maxY,et={x:(w+I)/2,y:(G+U)/2};i==="begin"&&(et.x=w,et.y=G),this.translate(d.x-et.x,d.y-et.y)}},a.prototype.refreshLayout=function(e){console.warn("Please call layout instead of refreshLayout. refreshLayout will be discarded soon");var i=this;i.layout(e)},a.prototype.layout=function(e){var i=this,s=this,l=s.get("data"),f=s.get("layoutMethod"),d=s.get("layout"),v=l;if(d==null?void 0:d.excludeInvisibles){l=(0,k.clone)(s.get("data"));var x={};hb(l,function(G){var U=G.children;if(!(U==null?void 0:U.length))return!0;for(var et=U.length-1;et>=0;et--){var ft=i.findById(U[et].id),Ct=ft?!ft.isVisible():U[et].visible===!1;Ct&&(x[G.id]=x[G.id]||[],x[G.id].push({idx:et,child:U.splice(et,1)[0]}))}}),v=f?f(l,s.get("layout")):l,hb(v,function(G){var U=x[G.id];if(U==null?void 0:U.length)for(var et=U.length-1;et>=0;et--){var ft=U[et],Ct=ft.idx,Mt=ft.child;G.children.splice(Ct,0,Mt)}})}else v=f?f(l,s.get("layout")):l;var w=s.get("animate");if(s.emit("beforerefreshlayout",{data:l,layoutData:v}),s.emit("beforelayout"),s.innerUpdateChild(v,void 0,w),e){var I=s.get("viewController");I.fitView()}w?s.layoutAnimate(v):(s.refresh(),s.paint()),s.emit("afterrefreshlayout",{data:l,layoutData:v}),s.emit("afterlayout")},a.prototype.addChild=function(e,i,s){s===void 0&&(s=!0);var l=this;l.emit("beforeaddchild",{model:e,parent:i}),(0,k.isString)(i)||(i=i.get("id"));var f=l.findDataById(i);if(f){f.children||(f.children=[]),f.children.push(e);var d=l.findById(i);d.refresh(),l.changeData(void 0,s)}},a.prototype.updateChildren=function(e,i,s){s===void 0&&(s=!0);var l=this,f=l.findById(i);if(!i||!f){console.warn("Update children failed! There is no node with id '".concat(i,"'"));return}var d=l.findDataById(i);d.children=e,f.refresh(),l.changeData(void 0,s)},a.prototype.updateChild=function(e,i,s){s===void 0&&(s=!0);var l=this;if(!i||!l.findById(i)){l.changeData(e,s);return}var f=l.findDataById(i),d=l.findById(e.id);if(f.children||(f.children=[]),!d)f.children.push(e);else{var v=a.indexOfChild(f.children,e.id);v>-1&&(f.children[v]=e)}var x=l.findById(i);x==null||x.refresh(),l.changeData(void 0,s)},a.prototype.removeChild=function(e,i){i===void 0&&(i=!0);var s=this,l=s.findById(e),f;if(l?f=l==null?void 0:l.get("parent"):f=s.getNodes().find(function(I){var G=I.getModel().children||[];return!!G.find(function(U){return U.id===e})}),f&&!f.destroyed){var d=f.get("id"),v=s.findDataById(d),x=v&&v.children||[],w=a.indexOfChild(x,e);x.splice(w,1),f.refresh()}s.changeData(void 0,i)},a.prototype.findDataById=function(e,i){var s=this;if(i||(i=s.get("data")),e===i.id)return i;var l=null;return(0,k.each)(i.children||[],function(f){if(f.id===e)return l=f,!1;if(l=s.findDataById(e,f),l)return!1}),l},a.prototype.layoutAnimate=function(e,i){var s=this,l=this.get("animateCfg");s.emit("beforeanimate",{data:e}),s.getEdges().forEach(function(f){var d=f.get("model");d.sourceAnchor||(d.sourceAnchor=f.get("sourceAnchorIndex"))}),this.get("canvas").animate(function(f){hb(e,function(d){var v=s.findById(d.id);if(v){var x=v.get("originAttrs"),w=v.get("model");if(x||(x={x:w.x,y:w.y},v.set("originAttrs",x)),i){var I=i(v,f,x,e);v.set("model",Object.assign(w,I))}else w.x=x.x+(d.x-x.x)*f,w.y=x.y+(d.y-x.y)*f}return!0}),(0,k.each)(s.get("removeList"),function(d){var v=d.getModel(),x=d.get("originAttrs"),w=d.get("to");v.x=x.x+(w.x-x.x)*f,v.y=x.y+(w.y-x.y)*f}),s.refreshPositions()},{duration:l.duration,easing:l.ease,callback:function(){(0,k.each)(s.getNodes(),function(d){d.set("originAttrs",null)}),(0,k.each)(s.get("removeList"),function(d){s.removeItem(d,!1)}),s.set("removeList",[]),l.callback&&l.callback(),s.emit("afteranimate",{data:e})},delay:l.delay})},a.prototype.stopLayoutAnimate=function(){this.get("canvas").stopAnimate(),this.emit("layoutanimateend",{data:this.get("data")}),this.layoutAnimating=!1},a.prototype.isLayoutAnimating=function(){return this.layoutAnimating},a.prototype.render=function(e){e===void 0&&(e=!0);var i=this,s=i.get("data");if(!s||!(0,k.isObject)(s)||!Object.keys(s).length)throw new Error("data must be defined first");i.clear(),e&&this.get("enabledStack")&&this.clearStack(),i.emit("beforerender"),i.layout(this.get("fitView")),i.emit("afterrender")},a.prototype.save=function(){return this.get("data")},a.prototype.data=function(e){c.prototype.data.call(this,e),this.set("originData",JSON.parse(JSON.stringify(e)))},a}(Iw),gC=wm;function ru(c,a){if(c)for(var e in a)a.hasOwnProperty(e)&&(c.style[e]=a[e]);return c}var mC=function(){function c(a){this._cfgs=(0,k.deepMix)(this.getDefaultCfgs(),a),this._events={},this.destroyed=!1}return c.prototype.getDefaultCfgs=function(){return{}},c.prototype.initPlugin=function(a){var e=this;e.set("graph",a);var i=e.getEvents(),s={};(0,k.each)(i,function(l,f){var d=(0,k.wrapBehavior)(e,l);s[f]=d,a.on(f,d)}),this._events=s,this.init()},c.prototype.getEvents=function(){return{}},c.prototype.get=function(a){var e;return(e=this._cfgs)===null||e===void 0?void 0:e[a]},c.prototype.set=function(a,e){this._cfgs[a]=e},c.prototype.destroy=function(){},c.prototype.destroyPlugin=function(){this.destroy();var a=this.get("graph"),e=this._events;(0,k.each)(e,function(i,s){a.off(s,i)}),this._events=null,this._cfgs=null,this.destroyed=!0},c}(),id=mC,yC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Tw="url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2UwZTBlMCIgb3BhY2l0eT0iMC4yIiBzdHJva2Utd2lkdGg9IjEiLz48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZTBlMGUwIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=)",wy=function(c){yC(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{img:Tw,follow:!0}},a.prototype.init=function(){var e=this.get("graph"),i=e.get("container"),s=e.get("canvas").get("el"),l=this.get("img")||Tw;l.includes("url(")||(l='url("'.concat(l,'")'));var f=ql(`<div class='g6-grid-container' style="position:absolute;overflow:hidden;z-index: -1;"></div>`),d=ql(`<div
        class='g6-grid'
        style='position:absolute;
        background-image: `.concat(l,`;
        user-select: none
        '></div>`));this.set("container",f),this.set("gridContainer",d),this.positionInit(),f.appendChild(d),i.insertBefore(f,s)},a.prototype.positionInit=function(){var e=this.get("graph"),i=e.get("minZoom"),s=e.get("width"),l=e.get("height");ru(this.get("container"),{width:"".concat(s,"px"),height:"".concat(l,"px")});var f=s*80/i,d=l*80/i;ru(this.get("gridContainer"),{width:"".concat(f,"px"),height:"".concat(d,"px"),left:"-".concat(f/2,"px"),top:"-".concat(d/2,"px")})},a.prototype.getEvents=function(){return{viewportchange:"updateGrid"}},a.prototype.updateGrid=function(e){var i=this.get("gridContainer"),s=e.matrix;s||(s=[1,0,0,0,1,0,0,0,1]);var l=this.get("follow"),f="matrix(".concat(s[0],", ").concat(s[1],", ").concat(s[3],", ").concat(s[4],", ").concat(l?s[6]:"0",", ").concat(l?s[7]:"0",")");ru(i,{transform:f})},a.prototype.getContainer=function(){return this.get("container")},a.prototype.destroy=function(){var e=this.get("graph"),i=e.get("container"),s=this.get("container");i.removeChild(s)},a}(id),Ey=wy,Sy=$(38186),Em=$.n(Sy),bC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();typeof document!="undefined"&&Em()(`
  .g6-component-contextmenu {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .g6-contextmenu-ul {
    padding: 0;
    margin: 0;
    list-style: none;
  }

`);var xC=function(c){bC(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,handleMenuClick:void 0,getContent:function(i){return`
          <ul class='g6-contextmenu-ul'>
            <li>\u83DC\u5355\u98791</li>
            <li>\u83DC\u5355\u98792</li>
          </ul>
        `},shouldBegin:function(i){return!0},onHide:function(){return!0},itemTypes:["node","edge","combo"],trigger:"contextmenu"}},a.prototype.getEvents=function(){return this.get("trigger")==="click"?{click:"onMenuShow",touchend:"onMenuShow"}:{contextmenu:"onMenuShow"}},a.prototype.init=function(){var e=this.get("className"),i=ql("<div class=".concat(e||"g6-component-contextmenu","></div>"));ru(i,{top:"0px",position:"absolute",visibility:"hidden"});var s=this.get("container");s||(s=this.get("graph").get("container")),(0,k.isString)(s)&&(s=document.getElementById(s)),s.appendChild(i),this.set("menu",i)},a.prototype.onMenuShow=function(e){var i=this;e.preventDefault();var s=this.get("itemTypes");if(e.item){if(e.item&&e.item.getType&&s.indexOf(e.item.getType())===-1){i.onMenuHide();return}}else if(s.indexOf("canvas")===-1){i.onMenuHide();return}var l=this.get("shouldBegin");if(!!l(e)){var f=this.get("menu"),d=this.get("getContent"),v=this.get("graph"),x=d(e,v);(0,k.isString)(x)?f.innerHTML=x:f.innerHTML=x.outerHTML,this.removeMenuEventListener();var w=this.get("handleMenuClick");if(w){var I=function(pn){w(pn.target,e.item,v)};this.set("handleMenuClickWrapper",I),f.addEventListener("click",I)}var G=v.get("width"),U=v.get("height"),et=f.getBoundingClientRect(),ft=this.get("offsetX")||0,Ct=this.get("offsetY")||0,Mt=v.getContainer().offsetTop,kt=v.getContainer().offsetLeft,$t=e.canvasX+kt+ft,Jt=e.canvasY+Mt+Ct;$t+et.width>G&&($t=e.canvasX-et.width-ft+kt),Jt+et.height>U&&(Jt=e.canvasY-et.height-Ct+Mt),ru(f,{top:"".concat(Jt,"px"),left:"".concat($t,"px"),visibility:"visible"});var Ce=this.get("trigger")==="click",je=function(pn){if(Ce){Ce=!1;return}i.onMenuHide()};document.body.addEventListener("click",je),this.set("handler",je)}},a.prototype.removeMenuEventListener=function(){var e=this.get("handleMenuClickWrapper"),i=this.get("handler");if(e){var s=this.get("menu");s.removeEventListener("click",e),this.set("handleMenuClickWrapper",null)}i&&document.body.removeEventListener("click",i)},a.prototype.onMenuHide=function(){var e=this.get("menu");e&&ru(e,{visibility:"hidden"}),this.removeMenuEventListener()},a.prototype.destroy=function(){var e=this.get("menu");if(this.removeMenuEventListener(),e){var i=this.get("container");i||(i=this.get("graph").get("container")),(0,k.isString)(i)&&(i=document.getElementById(i)),i.removeChild(e)}},a}(id),Aw=xC,wC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),db=function(){return db=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},db.apply(this,arguments)},Mw=Math.max,EC=Le,SC="default",CC="keyShape",_C="delegate",Nw="svg",IC=function(c){wC(a,c);function a(e){var i=c.call(this,e)||this;return i.handleUpdateCanvas=(0,k.debounce)(function(s){var l=i;l.destroyed||l.updateCanvas()},100,!1),i}return a.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",type:"default",padding:50,size:[200,120],delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0,hideEdge:!1}},a.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},a.prototype.disableRefresh=function(){this.set("refresh",!1)},a.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},a.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},a.prototype.initViewport=function(){var e=this,i=this._cfgs,s=i.size,l=i.graph;if(!this.destroyed){var f=this.get("canvas"),d=f.get("container"),v=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,x=navigator.userAgent.toLowerCase().indexOf("safari")>-1,w=ql(`
      <div
        class=`.concat(i.viewportClassName,`
        style='position:absolute;
          left:0;
          top:0;
          box-sizing:border-box;
          outline: 2px solid #1980ff;
          cursor:move'
        draggable=`).concat(!(x||v),`
      </div>`)),I=0,G=0,U=!1,et=0,ft=0,Ct=0,Mt=0,kt=0,$t=0,Jt=x||v?"mousedown":"dragstart";w.addEventListener(Jt,function(pn){var Fn,Tn;if(pn.dataTransfer){var cr=new Image;cr.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' %3E%3Cpath /%3E%3C/svg%3E",(Tn=(Fn=pn.dataTransfer).setDragImage)===null||Tn===void 0||Tn.call(Fn,cr,0,0);try{pn.dataTransfer.setData("text/html","view-port-minimap")}catch(Aa){pn.dataTransfer.setData("text","view-port-minimap")}}if(i.refresh=!1,pn.target===w){var kr=w.style;et=parseInt(kr.left,10),ft=parseInt(kr.top,10),Ct=parseInt(kr.width,10),Mt=parseInt(kr.height,10),!(Ct>s[0]||Mt>s[1])&&($t=l.getZoom(),kt=e.get("ratio"),U=!0,I=pn.clientX,G=pn.clientY)}},!1);var Ce=function(Fn){if(!(!U||(0,k.isNil)(Fn.clientX)||(0,k.isNil)(Fn.clientY))){var Tn=I-Fn.clientX,cr=G-Fn.clientY;(et-Tn<0||et-Tn+Ct>=s[0])&&(Tn=0),(ft-cr<0||ft-cr+Mt>=s[1])&&(cr=0),et-=Tn,ft-=cr,ru(w,{left:"".concat(et,"px"),top:"".concat(ft,"px")}),l.translate(Tn*$t/kt,cr*$t/kt),I=Fn.clientX,G=Fn.clientY}};!x&&!v&&w.addEventListener("drag",Ce,!1);var je=function(){U=!1,i.refresh=!0},ze=x||v?"mouseup":"dragend";w.addEventListener(ze,je,!1),d.addEventListener("mouseleave",je),d.addEventListener("mouseup",je),(x||v)&&d.addEventListener("mousemove",Ce,!1),this.set("viewport",w),d.appendChild(w)}},a.prototype.updateViewport=function(){if(!this.destroyed){var e=this.get("ratio"),i=this.get("totaldx"),s=this.get("totaldy"),l=this.get("graph"),f=this.get("size"),d=l.get("canvas").get("el"),v=l.get("width")||d.scrollWidth||500,x=l.get("height")||d.scrollHeight||500,w=l.getPointByCanvas(0,0),I=l.getPointByCanvas(v,x),G=this.get("viewport");G||this.initViewport();var U=(I.x-w.x)*e,et=(I.y-w.y)*e,ft=w.x*e+i,Ct=w.y*e+s,Mt=ft+U,kt=Ct+et;ft<0&&(U+=ft,ft=0),Mt>f[0]&&(U=U-(Mt-f[0])),Ct<0&&(et+=Ct,Ct=0),kt>f[1]&&(et=et-(kt-f[1])),this.set("ratio",e);var $t="".concat(ft,"px"),Jt="".concat(Ct,"px");ru(G,{left:$t,top:Jt,width:"".concat(U,"px"),height:"".concat(et,"px")})}},a.prototype.updateGraphShapes=function(){var e=this._cfgs.graph,i=this.get("canvas"),s=e.get("group");if(!s.destroyed){i.clear();var l;this.get("hideEdge")?(l=i.addGroup(),s.get("children").forEach(function(d){d.get("id").includes("-edge")||l.add(d.clone())})):(l=s.clone(),l.resetMatrix(),i.add(l));var f=e.get("renderer");f===Nw&&this.updateVisible(l)}},a.prototype.updateVisible=function(e){var i=this;if(!e.isGroup()&&!e.get("visible"))e.hide();else{var s=e.get("children");if(!s||!s.length)return;s.forEach(function(l){l.get("visible")||l.hide(),i.updateVisible(l)})}},a.prototype.updateKeyShapes=function(){var e=this,i=this._cfgs.graph,s=this.get("canvas"),l=s.get("children")[0]||s.addGroup();this.get("hideEdge")||(0,k.each)(i.getEdges(),function(v){e.updateOneEdgeKeyShape(v,l)}),(0,k.each)(i.getNodes(),function(v){e.updateOneNodeKeyShape(v,l)});var f=i.getCombos();if(f&&f.length){var d=l.find(function(v){return v.get("name")==="comboGroup"})||l.addGroup({name:"comboGroup"});setTimeout(function(){e.destroyed||((0,k.each)(f,function(v){e.updateOneComboKeyShape(v,d)}),d==null||d.sort(),d==null||d.toBack(),e.updateCanvas())},250)}this.clearDestroyedShapes()},a.prototype.updateOneComboKeyShape=function(e,i){if(!this.destroyed){var s=this.get("itemMap")||{},l=s[e.get("id")],f=e.getBBox(),d=e.get("keyShape").clone(),v=d.attr(),x={x:f.centerX,y:f.centerY};l?x=Object.assign(v,x):(l=d,i.add(l));var w=l.get("type");(w==="rect"||w==="image")&&(x.x=f.minX,x.y=f.minY),l.attr(x),e.isVisible()?l.show():l.hide(),l.exist=!0;var I=e.getModel().depth;isNaN(I)||l.set("zIndex",I),s[e.get("id")]=l,this.set("itemMap",s)}},a.prototype.updateOneNodeKeyShape=function(e,i){var s=this.get("itemMap")||{},l=s[e.get("id")],f=e.getBBox(),d=e.get("keyShape").clone(),v=d.attr(),x={x:f.centerX,y:f.centerY};l?(x=Object.assign(v,x),l.toFront()):(l=d,i.add(l));var w=l.get("type");(w==="rect"||w==="image")&&(x.x=f.minX,x.y=f.minY),l.attr(x),e.isVisible()?l.show():l.hide(),l.exist=!0;var I=e.getModel().depth;isNaN(I)||l.set("zIndex",I),s[e.get("id")]=l,this.set("itemMap",s)},a.prototype.updateDelegateShapes=function(){var e=this,i=this._cfgs.graph,s=this.get("canvas"),l=s.get("children")[0]||s.addGroup();this.get("hideEdge")||(0,k.each)(i.getEdges(),function(v){e.updateOneEdgeKeyShape(v,l)}),(0,k.each)(i.getNodes(),function(v){e.updateOneNodeDelegateShape(v,l)});var f=i.getCombos();if(f&&f.length){var d=l.find(function(v){return v.get("name")==="comboGroup"})||l.addGroup({name:"comboGroup"});setTimeout(function(){e.destroyed||((0,k.each)(f,function(v){e.updateOneComboKeyShape(v,d)}),d==null||d.sort(),d==null||d.toBack(),e.updateCanvas())},250)}this.clearDestroyedShapes()},a.prototype.clearDestroyedShapes=function(){var e=this.get("itemMap")||{},i=Object.keys(e);if(!(!i||i.length===0))for(var s=i.length-1;s>=0;s--){var l=e[i[s]],f=l.exist;l.exist=!1,f||(l.remove(),delete e[i[s]])}},a.prototype.updateOneEdgeKeyShape=function(e,i){var s=this.get("itemMap")||{},l=s[e.get("id")];if(l){var f=e.get("keyShape").attr("path");l.attr("path",f)}else l=e.get("keyShape").clone(),i.add(l);e.isVisible()?l.show():l.hide(),l.exist=!0,s[e.get("id")]=l,this.set("itemMap",s)},a.prototype.updateOneNodeDelegateShape=function(e,i){var s=this.get("delegateStyle"),l=this.get("itemMap")||{},f=l[e.get("id")],d=e.getBBox();if(f){var v={x:d.minX,y:d.minY,width:d.width,height:d.height};f.attr(v),f.toFront()}else f=i.addShape("rect",{attrs:db({x:d.minX,y:d.minY,width:d.width,height:d.height},s),name:"minimap-node-shape"});e.isVisible()?f.show():f.hide(),f.exist=!0,l[e.get("id")]=f,this.set("itemMap",l)},a.prototype.init=function(){this.initContainer(),this.get("graph").on("afterupdateitem",this.handleUpdateCanvas),this.get("graph").on("afteritemstatechange",this.handleUpdateCanvas),this.get("graph").on("afteradditem",this.handleUpdateCanvas),this.get("graph").on("afterremoveitem",this.handleUpdateCanvas),this.get("graph").on("afterrender",this.handleUpdateCanvas),this.get("graph").on("afterlayout",this.handleUpdateCanvas)},a.prototype.initContainer=function(){var e=this,i=e.get("graph"),s=e.get("size"),l=e.get("className"),f=e.get("container"),d=ql("<div class='".concat(l,"' style='width: ").concat(s[0],"px; height: ").concat(s[1],"px; overflow: hidden'></div>"));(0,k.isString)(f)&&(f=document.getElementById(f)),f?f.appendChild(d):i.get("container").appendChild(d),e.set("container",d);var v=ql('<div class="g6-minimap-container" style="position: relative;"></div>');d.appendChild(v),v.addEventListener("dragenter",function(I){I.preventDefault()}),v.addEventListener("dragover",function(I){I.preventDefault()});var x,w=i.get("renderer");w===Nw?x=new Rp({container:v,width:s[0],height:s[1]}):x=new $v({container:v,width:s[0],height:s[1]}),e.set("canvas",x),e.updateCanvas()},a.prototype.updateCanvas=function(){if(!this.destroyed){var e=this.get("refresh");if(!!e){var i=this.get("graph");if(!i.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var s=this.get("size"),l=this.get("canvas"),f=this.get("type"),d=this.get("padding");if(!l.destroyed){switch(f){case SC:this.updateGraphShapes();break;case CC:this.updateKeyShapes();break;case _C:this.updateDelegateShapes();break;default:break}var v=l.get("children")[0];if(!!v){v.resetMatrix();var x=v.getCanvasBBox(),w=i.get("canvas").getCanvasBBox(),I=i.getZoom()||1,G=w.width/I,U=w.height/I;Number.isFinite(x.width)&&(G=Mw(x.width,G),U=Mw(x.height,U)),G+=2*d,U+=2*d;var et=Math.min(s[0]/G,s[1]/U),ft=[1,0,0,0,1,0,0,0,1],Ct=0,Mt=0;Number.isFinite(x.minX)&&(Ct=-x.minX),Number.isFinite(x.minY)&&(Mt=-x.minY);var kt=(s[0]-(G-2*d)*et)/2,$t=(s[1]-(U-2*d)*et)/2;ft=EC(ft,[["t",Ct,Mt],["s",et,et],["t",kt,$t]]),v.setMatrix(ft),this.set("ratio",et),this.set("totaldx",kt+Ct*et),this.set("totaldy",$t+Mt*et),this.set("dx",kt),this.set("dy",$t),this.updateViewport()}}}}}},a.prototype.getCanvas=function(){return this.get("canvas")},a.prototype.getViewport=function(){return this.get("viewport")},a.prototype.getContainer=function(){return this.get("container")},a.prototype.destroy=function(){var e;(e=this.get("canvas"))===null||e===void 0||e.destroy();var i=this.get("container");(i==null?void 0:i.parentNode)&&i.parentNode.removeChild(i)},a}(id),TC=IC,AC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();function Lp(c,a,e){var i=c.x-a.x,s=c.y-a.y;return!e||Math.abs(i)>e||Math.abs(s)>e?Math.sqrt(i*i+s*s):e}function MC(c,a){return c.x*a.x+c.y*a.y}function pb(c,a){var e=(a.source.y-a.target.y)/(a.source.x-a.target.x),i=(e*e*a.source.x+e*(c.y-a.source.y)+c.x)/(e*e+1),s=e*(i-a.source.x)+a.source.y;return{x:i,y:s}}var NC=function(c){AC(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{edgeBundles:[],edgePoints:[],K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:.6666667,bundleThreshold:.6,eps:1e-6,onLayoutEnd:function(){},onTick:function(){}}},a.prototype.init=function(){var e=this.get("graph"),i=this.get("onTick"),s=function(){i&&i(),e.refreshPositions()};this.set("tick",s)},a.prototype.bundling=function(e){var i=this;if(i.set("data",e),!i.isTicking()){var s=e.edges||[],l=e.nodes||[],f={},d=!1;if(l.forEach(function(Jt){(Jt.x===null||!Jt.y===null||Jt.x===void 0||!Jt.y===void 0)&&(d=!0),f[Jt.id]=Jt}),d)throw new Error("please layout the graph or assign x and y for nodes first");i.set("nodeIdMap",f);var v=i.get("divisions"),x=i.get("divRate"),w=i.divideEdges(v);i.set("edgePoints",w);var I=i.getEdgeBundles();i.set("edgeBundles",I);for(var G=i.get("cycles"),U=i.get("iterations"),et=i.get("iterRate"),ft=i.get("lambda"),Ct=0;Ct<G;Ct++){for(var Mt=function(Ce){var je=[];s.forEach(function(ze,pn){if(ze.source!==ze.target){var Fn=f[ze.source],Tn=f[ze.target];je[pn]=i.getEdgeForces({source:Fn,target:Tn},pn,v,ft);for(var cr=0;cr<v+1;cr++)w[pn][cr].x+=je[pn][cr].x,w[pn][cr].y+=je[pn][cr].y}})},kt=0;kt<U;kt++)Mt(kt);ft=ft/2,v*=x,U*=et,w=i.divideEdges(v),i.set("edgePoints",w)}s.forEach(function(Jt,Ce){Jt.source!==Jt.target&&(Jt.type="polyline",Jt.controlPoints=w[Ce].slice(1,w[Ce].length-1))});var $t=i.get("graph");$t.refresh()}},a.prototype.updateBundling=function(e){var i=this,s=e.data;if(s&&i.set("data",s),i.get("ticking")&&i.set("ticking",!1),Object.keys(e).forEach(function(f){i.set(f,e[f])}),e.onTick){var l=this.get("graph");i.set("tick",function(){e.onTick(),l.refresh()})}i.bundling(s)},a.prototype.divideEdges=function(e){var i=this,s=i.get("data").edges,l=i.get("nodeIdMap"),f=i.get("edgePoints");return(!f||f===void 0)&&(f=[]),s.forEach(function(d,v){var x;(!f[v]||f[v]===void 0)&&(f[v]=[]);var w=l[d.source],I=l[d.target];if(e===1)f[v].push({x:w.x,y:w.y}),f[v].push({x:.5*(w.x+I.x),y:.5*(w.y+I.y)}),f[v].push({x:I.x,y:I.y});else{var G=0;((x=f[v])===null||x===void 0?void 0:x.length)?G=i.getEdgeLength(f[v]):G=Lp({x:w.x,y:w.y},{x:I.x,y:I.y});var U=G/(e+1),et=U,ft=[{x:w.x,y:w.y}];f[v].forEach(function(Ct,Mt){if(Mt!==0){for(var kt=Lp(Ct,f[v][Mt-1]);kt>et;){var $t=et/kt,Jt={x:f[v][Mt-1].x,y:f[v][Mt-1].y};Jt.x+=$t*(Ct.x-f[v][Mt-1].x),Jt.y+=$t*(Ct.y-f[v][Mt-1].y),ft.push(Jt),kt-=et,et=U}et-=kt}}),ft.push({x:I.x,y:I.y}),f[v]=ft}}),f},a.prototype.getEdgeLength=function(e){var i=0;return e.forEach(function(s,l){l!==0&&(i+=Lp(s,e[l-1]))}),i},a.prototype.getEdgeBundles=function(){var e=this,i=e.get("data"),s=i.edges||[],l=e.get("bundleThreshold"),f=e.get("nodeIdMap"),d=e.get("edgeBundles");return d||(d=[]),s.forEach(function(v,x){(!d[x]||d[x]===void 0)&&(d[x]=[])}),s.forEach(function(v,x){var w=f[v.source],I=f[v.target];s.forEach(function(G,U){if(!(U<=x)){var et=f[G.source],ft=f[G.target],Ct=e.getBundleScore({source:w,target:I},{source:et,target:ft});Ct>=l&&(d[x].push(U),d[U].push(x))}})}),d},a.prototype.getBundleScore=function(e,i){var s=this;e.vx=e.target.x-e.source.x,e.vy=e.target.y-e.source.y,i.vx=i.target.x-i.source.x,i.vy=i.target.y-i.source.y,e.length=Lp({x:e.source.x,y:e.source.y},{x:e.target.x,y:e.target.y}),i.length=Lp({x:i.source.x,y:i.source.y},{x:i.target.x,y:i.target.y});var l=s.getAngleScore(e,i),f=s.getScaleScore(e,i),d=s.getPositionScore(e,i),v=s.getVisibilityScore(e,i);return l*f*d*v},a.prototype.getAngleScore=function(e,i){var s=MC({x:e.vx,y:e.vy},{x:i.vx,y:i.vy});return s/(e.length*i.length)},a.prototype.getScaleScore=function(e,i){var s=(e.length+i.length)/2,l=2/(s/Math.min(e.length,i.length)+Math.max(e.length,i.length)/s);return l},a.prototype.getPositionScore=function(e,i){var s=(e.length+i.length)/2,l={x:(e.source.x+e.target.x)/2,y:(e.source.y+e.target.y)/2},f={x:(i.source.x+i.target.x)/2,y:(i.source.y+i.target.y)/2},d=Lp(l,f);return s/(s+d)},a.prototype.getVisibilityScore=function(e,i){var s=this.getEdgeVisibility(e,i),l=this.getEdgeVisibility(i,e);return s<l?s:l},a.prototype.getEdgeVisibility=function(e,i){var s=pb(i.source,e),l=pb(i.target,e),f={x:(s.x+l.x)/2,y:(s.y+l.y)/2},d={x:(e.source.x+e.target.x)/2,y:(e.source.y+e.target.y)/2};return Math.max(0,1-2*Lp(f,d)/Lp(s,l))},a.prototype.getEdgeForces=function(e,i,s,l){for(var f=this,d=f.get("edgePoints"),v=f.get("K"),x=v/(Lp(e.source,e.target)*(s+1)),w=[{x:0,y:0}],I=1;I<s;I++){var G={x:0,y:0},U=f.getSpringForce({pre:d[i][I-1],cur:d[i][I],next:d[i][I+1]},x),et=f.getElectrostaticForce(I,i);G.x=l*(U.x+et.x),G.y=l*(U.y+et.y),w.push(G)}return w.push({x:0,y:0}),w},a.prototype.getSpringForce=function(e,i){var s=e.pre.x+e.next.x-2*e.cur.x,l=e.pre.y+e.next.y-2*e.cur.y;return s*=i,l*=i,{x:s,y:l}},a.prototype.getElectrostaticForce=function(e,i){var s=this,l=s.get("eps"),f=s.get("edgeBundles"),d=s.get("edgePoints"),v=f[i],x={x:0,y:0};return v.forEach(function(w){var I={x:d[w][e].x-d[i][e].x,y:d[w][e].y-d[i][e].y};if(Math.abs(I.x)>l||Math.abs(I.y)>l){var G=Lp(d[w][e],d[i][e]),U=1/G;x.x+=I.x*U,x.y+=I.y*U}}),x},a.prototype.isTicking=function(){return this.get("ticking")},a.prototype.getSimulation=function(){return this.get("forceSimulation")},a.prototype.destroy=function(){this.get("ticking")&&this.getSimulation().stop(),c.prototype.destroy.call(this)},a}(id),kC=NC,DC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),vb=function(){return vb=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},vb.apply(this,arguments)},Cy=.05,gb={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:.1,fill:"#ccc"},OC=function(c){DC(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{trigger:"mousemove",d:1.5,r:300,delegateStyle:(0,k.clone)(gb),showLabel:!1,maxD:5,minD:0,scaleRBy:"unset",scaleDBy:"unset",showDPercent:!0}},a.prototype.getEvents=function(){var e;switch(this.get("trigger")){case"click":e={click:"magnify"};break;case"drag":e={click:"createDelegate"};break;default:e={mousemove:"magnify"};break}return e},a.prototype.init=function(){var e=this,i=e.get("r");e.set("cachedMagnifiedModels",[]),e.set("cachedOriginPositions",{}),e.set("r2",i*i);var s=e.get("d");e.set("molecularParam",(s+1)*i)},a.prototype.createDelegate=function(e){var i=this,s=this,l=s.get("delegate");(!l||l.destroyed)&&(s.magnify(e),l=s.get("delegate"),l.on("dragstart",function(f){s.set("delegateCenterDiff",{x:l.attr("x")-f.x,y:l.attr("y")-f.y})}),l.on("drag",function(f){s.magnify(f)}),this.get("scaleDBy")==="wheel"&&l.on("mousewheel",function(f){i.scaleDByWheel(f)}),this.get("scaleRBy")==="wheel"&&l.on("mousewheel",function(f){s.scaleRByWheel(f)}))},a.prototype.scaleRByWheel=function(e){var i=this;if(!(!e||!e.originalEvent)){e.preventDefault&&e.preventDefault();var s=i.get("graph"),l,f=i.get("delegate"),d=f?{x:f.attr("x"),y:f.attr("y")}:void 0,v=d||s.getPointByClient(e.clientX,e.clientY);e.originalEvent.wheelDelta<0?l=1-Cy:l=1/(1-Cy);var x=i.get("maxR"),w=i.get("minR"),I=i.get("r");(I>(x||s.get("height"))&&l>1||I<(w||s.get("height")*.05)&&l<1)&&(l=1),I*=l,i.set("r",I),i.set("r2",I*I);var G=i.get("d");i.set("molecularParam",(G+1)*I),i.set("delegateCenterDiff",void 0),i.magnify(e,v)}},a.prototype.scaleRByDrag=function(e){var i=this;if(!!e){var s=i.get("dragPrePos"),l=i.get("graph"),f,d=l.getPointByClient(e.clientX,e.clientY);e.x-s.x<0?f=1-Cy:f=1/(1-Cy);var v=i.get("maxR"),x=i.get("minR"),w=i.get("r");(w>(v||l.get("height"))&&f>1||w<(x||l.get("height")*.05)&&f<1)&&(f=1),w*=f,i.set("r",w),i.set("r2",w*w);var I=i.get("d");i.set("molecularParam",(I+1)*w),i.magnify(e,d),i.set("dragPrePos",{x:e.x,y:e.y})}},a.prototype.scaleDByWheel=function(e){var i=this;if(!(!e&&!e.originalEvent)){e.preventDefault&&e.preventDefault();var s=0;e.originalEvent.wheelDelta<0?s=-.1:s=.1;var l=i.get("d"),f=l+s,d=i.get("maxD"),v=i.get("minD");if(f<d&&f>v){i.set("d",f);var x=i.get("r");i.set("molecularParam",(f+1)*x);var w=i.get("delegate"),I=w?{x:w.attr("x"),y:w.attr("y")}:void 0;i.set("delegateCenterDiff",void 0),i.magnify(e,I)}}},a.prototype.scaleDByDrag=function(e){var i=this,s=i.get("dragPrePos"),l=e.x-s.x>0?.1:-.1,f=i.get("d"),d=f+l,v=i.get("maxD"),x=i.get("minD");if(d<v&&d>x){i.set("d",d);var w=i.get("r");i.set("molecularParam",(d+1)*w),i.magnify(e)}i.set("dragPrePos",{x:e.x,y:e.y})},a.prototype.magnify=function(e,i){var s=this;s.restoreCache();var l=s.get("graph"),f=s.get("cachedMagnifiedModels"),d=s.get("cachedOriginPositions"),v=s.get("showLabel"),x=s.get("r"),w=s.get("r2"),I=s.get("d"),G=s.get("molecularParam"),U=l.getNodes(),et=U.length,ft=i?{x:i.x,y:i.y}:{x:e.x,y:e.y};s.get("dragging")&&(s.get("trigger")==="mousemove"||s.get("trigger")==="click")&&(ft=s.get("cacheCenter"));var Ct=s.get("delegateCenterDiff");Ct&&(ft.x+=Ct.x,ft.y+=Ct.y),s.updateDelegate(ft,x);for(var Mt=0;Mt<et;Mt++){var kt=U[Mt].getModel(),$t=kt.x,Jt=kt.y;if(!(isNaN($t)||isNaN(Jt))){var Ce=($t-ft.x)*($t-ft.x)+(Jt-ft.y)*(Jt-ft.y);if(!isNaN(Ce)&&Ce<w&&Ce!==0){var je=Math.sqrt(Ce),ze=G*je/(I*je+x),pn=($t-ft.x)/je,Fn=(Jt-ft.y)/je;if(kt.x=pn*ze+ft.x,kt.y=Fn*ze+ft.y,d[kt.id]||(d[kt.id]={x:$t,y:Jt,texts:[]}),f.push(kt),v&&2*je<x)for(var Tn=U[Mt],cr=Tn.getContainer(),kr=cr.getChildren(),Aa=kr.length,ci=0;ci<Aa;ci++){var ei=kr[ci];ei.get("type")==="text"&&(d[kt.id].texts.push({visible:ei.get("visible"),shape:ei}),ei.set("visible",!0))}}}}l.refreshPositions()},a.prototype.restoreCache=function(){for(var e=this,i=e.get("cachedMagnifiedModels"),s=e.get("cachedOriginPositions"),l=i.length,f=0;f<l;f++){var d=i[f],v=d.id,x=s[v];d.x=x.x,d.y=x.y;for(var w=x.texts.length,I=0;I<w;I++){var G=x.texts[I];G.shape.set("visible",G.visible)}}e.set("cachedMagnifiedModels",[]),e.set("cachedOriginPositions",{})},a.prototype.updateParams=function(e){var i=this,s=e.r,l=e.d,f=e.trigger,d=e.minD,v=e.maxD,x=e.minR,w=e.maxR,I=e.scaleDBy,G=e.scaleRBy;isNaN(e.r)||(i.set("r",s),i.set("r2",s*s)),isNaN(l)||i.set("d",l),isNaN(v)||i.set("maxD",v),isNaN(d)||i.set("minD",d),isNaN(w)||i.set("maxR",w),isNaN(x)||i.set("minR",x);var U=i.get("d"),et=i.get("r");if(i.set("molecularParam",(U+1)*et),(f==="mousemove"||f==="click"||f==="drag")&&i.set("trigger",f),I==="drag"||I==="wheel"||I==="unset"){i.set("scaleDBy",I),i.get("delegate").remove(),i.get("delegate").destroy();var ft=i.get("dPercentText");ft&&(ft.remove(),ft.destroy())}if(G==="drag"||G==="wheel"||G==="unset"){i.set("scaleRBy",G),i.get("delegate").remove(),i.get("delegate").destroy();var ft=i.get("dPercentText");ft&&(ft.remove(),ft.destroy())}},a.prototype.updateDelegate=function(e,i){var s=this,l=this,f=l.get("graph"),d=l.get("delegate");if(!d||d.destroyed){var v=f.get("group"),x=l.get("delegateStyle")||gb;d=v.addShape("circle",{attrs:vb({r:i/1.5,x:e.x,y:e.y},x),name:"lens-shape",draggable:!0}),this.get("trigger")!=="drag"&&(this.get("scaleRBy")==="wheel"?d.on("mousewheel",function(et){l.scaleRByWheel(et)}):this.get("scaleRBy")==="drag"&&(d.on("dragstart",function(et){l.set("dragging",!0),l.set("cacheCenter",{x:et.x,y:et.y}),l.set("dragPrePos",{x:et.x,y:et.y})}),d.on("drag",function(et){l.scaleRByDrag(et)}),d.on("dragend",function(et){l.set("dragging",!1)})),this.get("scaleDBy")==="wheel"?d.on("mousewheel",function(et){s.scaleDByWheel(et)}):this.get("scaleDBy")==="drag"&&(d.on("dragstart",function(et){l.set("dragging",!0),l.set("cacheCenter",{x:et.x,y:et.y}),l.set("dragPrePos",{x:et.x,y:et.y})}),d.on("drag",function(et){s.scaleDByDrag(et)}),d.on("dragend",function(et){l.set("dragging",!1)})))}else d.attr({x:e.x,y:e.y,r:i/1.5});if(l.get("showDPercent")){var w=Math.round((l.get("d")-l.get("minD"))/(l.get("maxD")-l.get("minD"))*100),I=l.get("dPercentText"),G=e.y+i/1.5+16;if(!I||I.destroyed){var U=f.get("group");I=U.addShape("text",{attrs:{text:"".concat(w,"%"),x:e.x,y:G,fill:"#aaa",stroke:"#fff",lineWidth:1,fontSize:12}}),l.set("dPercentText",I)}else I.attr({text:"".concat(w,"%"),x:e.x,y:G})}l.set("delegate",d)},a.prototype.clear=function(){var e=this.get("graph");this.restoreCache(),e.refreshPositions();var i=this.get("delegate");i&&!i.destroyed&&(i.remove(),i.destroy());var s=this.get("dPercentText");s&&!s.destroyed&&(s.remove(),s.destroy())},a.prototype.destroy=function(){this.clear()},a}(id),sh=OC,RC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),vv=.05;typeof document!="undefined"&&Em()(`
  .g6-component-toolbar {
    position: absolute;
    list-style-type: none;
    padding: 6px;
    left: 0px;
    top: 0px;
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    margin: 0;
  }
  .g6-component-toolbar li {
    float: left;
    text-align: center;
    width: 35px;
    height: 24px;
    cursor: pointer;
		list-style-type:none;
    list-style: none;
    margin-left: 0px;
  }
  .g6-component-toolbar li .icon {
    opacity: 0.7;
  }
  .g6-component-toolbar li .icon:hover {
    opacity: 1;
  }
`);var LC=function(a){if(!a)return[];if(a.composedPath)return a.composedPath();for(var e=[],i=a.target;i;){if(e.push(i),i.tagName==="HTML")return e.push(document,window),e;i=i.parentElement}return e},PC=function(c){RC(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{handleClick:void 0,getContent:function(i){return`
          <ul class='g6-component-toolbar'>
            <li code='redo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M256 682.666667c0-102.741333 66.730667-213.333333 213.333333-213.333334 107.008 0 190.762667 56.576 230.570667 125.354667L611.968 682.666667H853.333333v-241.365334l-91.562666 91.562667C704.768 448.469333 601.130667 384 469.333333 384c-196.096 0-298.666667 150.229333-298.666666 298.666667h85.333333z" fill="" p-id="2041"></path>
              </svg>
            </li>
            <li code='undo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M170.666667 682.666667h241.365333l-87.936-87.978667C363.904 525.909333 447.658667 469.333333 554.666667 469.333333c146.602667 0 213.333333 110.592 213.333333 213.333334h85.333333c0-148.437333-102.570667-298.666667-298.666666-298.666667-131.797333 0-235.392 64.469333-292.48 148.821333L170.666667 441.301333V682.666667z" fill="" p-id="2764"></path>
              </svg>
            </li>
            <li  code='zoomOut'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M658.432 428.736a33.216 33.216 0 0 1-33.152 33.152H525.824v99.456a33.216 33.216 0 0 1-66.304 0V461.888H360.064a33.152 33.152 0 0 1 0-66.304H459.52V296.128a33.152 33.152 0 0 1 66.304 0V395.52H625.28c18.24 0 33.152 14.848 33.152 33.152z m299.776 521.792a43.328 43.328 0 0 1-60.864-6.912l-189.248-220.992a362.368 362.368 0 0 1-215.36 70.848 364.8 364.8 0 1 1 364.8-364.736 363.072 363.072 0 0 1-86.912 235.968l192.384 224.64a43.392 43.392 0 0 1-4.8 61.184z m-465.536-223.36a298.816 298.816 0 0 0 298.432-298.432 298.816 298.816 0 0 0-298.432-298.432A298.816 298.816 0 0 0 194.24 428.8a298.816 298.816 0 0 0 298.432 298.432z"></path>
              </svg>
            </li>
            <li code='zoomIn'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M639.936 416a32 32 0 0 1-32 32h-256a32 32 0 0 1 0-64h256a32 32 0 0 1 32 32z m289.28 503.552a41.792 41.792 0 0 1-58.752-6.656l-182.656-213.248A349.76 349.76 0 0 1 480 768 352 352 0 1 1 832 416a350.4 350.4 0 0 1-83.84 227.712l185.664 216.768a41.856 41.856 0 0 1-4.608 59.072zM479.936 704c158.784 0 288-129.216 288-288S638.72 128 479.936 128a288.32 288.32 0 0 0-288 288c0 158.784 129.216 288 288 288z" p-id="3853"></path>
              </svg>
            </li>
            <li code='realZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M384 320v384H320V320h64z m256 0v384H576V320h64zM512 576v64H448V576h64z m0-192v64H448V384h64z m355.968 576H92.032A28.16 28.16 0 0 1 64 931.968V28.032C64 12.608 76.608 0 95.168 0h610.368L896 192v739.968a28.16 28.16 0 0 1-28.032 28.032zM704 64v128h128l-128-128z m128 192h-190.464V64H128v832h704V256z"></path>
              </svg>
            </li>
            <li code='autoZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M684.288 305.28l0.128-0.64-0.128-0.64V99.712c0-19.84 15.552-35.904 34.496-35.712a35.072 35.072 0 0 1 34.56 35.776v171.008h170.944c19.648 0 35.84 15.488 35.712 34.432a35.072 35.072 0 0 1-35.84 34.496h-204.16l-0.64-0.128a32.768 32.768 0 0 1-20.864-7.552c-1.344-1.024-2.816-1.664-3.968-2.816-0.384-0.32-0.512-0.768-0.832-1.088a33.472 33.472 0 0 1-9.408-22.848zM305.28 64a35.072 35.072 0 0 0-34.56 35.776v171.008H99.776A35.072 35.072 0 0 0 64 305.216c0 18.944 15.872 34.496 35.84 34.496h204.16l0.64-0.128a32.896 32.896 0 0 0 20.864-7.552c1.344-1.024 2.816-1.664 3.904-2.816 0.384-0.32 0.512-0.768 0.768-1.088a33.024 33.024 0 0 0 9.536-22.848l-0.128-0.64 0.128-0.704V99.712A35.008 35.008 0 0 0 305.216 64z m618.944 620.288h-204.16l-0.64 0.128-0.512-0.128c-7.808 0-14.72 3.2-20.48 7.68-1.28 1.024-2.752 1.664-3.84 2.752-0.384 0.32-0.512 0.768-0.832 1.088a33.664 33.664 0 0 0-9.408 22.912l0.128 0.64-0.128 0.704v204.288c0 19.712 15.552 35.904 34.496 35.712a35.072 35.072 0 0 0 34.56-35.776V753.28h170.944c19.648 0 35.84-15.488 35.712-34.432a35.072 35.072 0 0 0-35.84-34.496z m-593.92 11.52c-0.256-0.32-0.384-0.768-0.768-1.088-1.088-1.088-2.56-1.728-3.84-2.688a33.088 33.088 0 0 0-20.48-7.68l-0.512 0.064-0.64-0.128H99.84a35.072 35.072 0 0 0-35.84 34.496 35.072 35.072 0 0 0 35.712 34.432H270.72v171.008c0 19.84 15.552 35.84 34.56 35.776a35.008 35.008 0 0 0 34.432-35.712V720l-0.128-0.64 0.128-0.704a33.344 33.344 0 0 0-9.472-22.848zM512 374.144a137.92 137.92 0 1 0 0.128 275.84A137.92 137.92 0 0 0 512 374.08z"></path>
              </svg>
            </li>
          </ul>
        `},zoomSensitivity:2}},a.prototype.init=function(){var e=this,i=this.get("graph"),s=this.get("getContent"),l=s(i),f=l;(0,k.isString)(l)&&(f=ql(l));var d=this.get("className");f.setAttribute("class",d||"g6-component-toolbar");var v=this.get("container");v||(v=this.get("graph").get("container")),(0,k.isString)(v)&&(v=document.getElementById(v)),v.appendChild(f),this.set("toolBar",f);var x=this.get("handleClick");f.addEventListener("click",function(I){var G=LC(I).filter(function(et){return et.nodeName==="LI"});if(G.length!==0){var U=G[0].getAttribute("code");!U||(x?x(U,i):e.handleDefaultOperator(U))}});var w=this.get("position");w&&ru(f,{top:"".concat(w.y,"px"),left:"".concat(w.x,"px")}),this.bindUndoRedo()},a.prototype.bindUndoRedo=function(){var e=this.get("graph"),i=document.querySelector('.g6-component-toolbar li[code="undo"]'),s=document.querySelector('.g6-component-toolbar li[code="undo"] svg'),l=document.querySelector('.g6-component-toolbar li[code="redo"]'),f=document.querySelector('.g6-component-toolbar li[code="redo"] svg');!i||!s||!l||!f||(i.setAttribute("style","cursor: not-allowed"),s.setAttribute("style","opacity: 0.4"),l.setAttribute("style","cursor: not-allowed"),f.setAttribute("style","opacity: 0.4"),e.on("stackchange",function(d){var v=d.undoStack,x=d.redoStack,w=v.length,I=x.length;w===0?(i.setAttribute("style","cursor: not-allowed"),s.setAttribute("style","opacity: 0.4")):(i.removeAttribute("style"),s.removeAttribute("style")),I===0?(l.setAttribute("style","cursor: not-allowed"),f.setAttribute("style","opacity: 0.4")):(l.removeAttribute("style"),f.removeAttribute("style"))}))},a.prototype.undo=function(){var e=this.get("graph"),i=e.getUndoStack();if(!(!i||i.length===0)){var s=i.pop();if(s){var l=s.action;e.pushStack(l,(0,k.clone)(s.data),"redo");var f=s.data.before;if(l==="add"&&(f=s.data.after),!f)return;switch(l){case"visible":{Object.keys(f).forEach(function(I){var G=f[I];!G||G.forEach(function(U){var et=e.findById(U.id);U.visible?e.showItem(et,!1):e.hideItem(et,!1)})});break}case"render":case"update":Object.keys(f).forEach(function(I){var G=f[I];!G||G.forEach(function(U){var et=e.findById(U.id);delete U.id,e.updateItem(et,U,!1),et.getType()==="combo"&&e.updateCombo(et)})});break;case"changedata":e.changeData(f,!1);break;case"delete":{Object.keys(f).forEach(function(I){var G=f[I];!G||G.forEach(function(U){var et=U.itemType;delete U.itemType,e.addItem(et,U,!1)})});break}case"add":Object.keys(f).forEach(function(I){var G=f[I];!G||G.forEach(function(U){e.removeItem(U.id,!1)})});break;case"updateComboTree":Object.keys(f).forEach(function(I){var G=f[I];!G||G.forEach(function(U){e.updateComboTree(U.id,U.parentId,!1)})});break;case"createCombo":var d=s.data.after.combos,v=d[d.length-1];Object.keys(f).forEach(function(I){var G=f[I];!G||G.forEach(function(U){e.updateComboTree(U.id,U.parentId,!1)})}),e.removeItem(v.id,!1);break;case"uncombo":var x=f.combos[f.combos.length-1],w=f.nodes.concat(f.combos).map(function(I){return I.id}).filter(function(I){return I!==x.id});e.createCombo(x,w,!1);break;case"layout":e.updateLayout(f,void 0,void 0,!1);break;default:}}}},a.prototype.redo=function(){var e=this.get("graph"),i=e.getRedoStack();if(!(!i||i.length===0)){var s=i.pop();if(s){var l=s.action,f=s.data.after;if(e.pushStack(l,(0,k.clone)(s.data)),l==="delete"&&(f=s.data.before),!f)return;switch(l){case"visible":{Object.keys(f).forEach(function(w){var I=f[w];!I||I.forEach(function(G){var U=e.findById(G.id);G.visible?e.showItem(U,!1):e.hideItem(U,!1)})});break}case"render":case"update":Object.keys(f).forEach(function(w){var I=f[w];!I||I.forEach(function(G){var U=e.findById(G.id);delete G.id,e.updateItem(U,G,!1),U.getType()==="combo"&&e.updateCombo(U)})});break;case"changedata":e.changeData(f,!1);break;case"delete":f.edges&&f.edges.forEach(function(w){e.removeItem(w.id,!1)}),f.nodes&&f.nodes.forEach(function(w){e.removeItem(w.id,!1)}),f.combos&&f.combos.forEach(function(w){e.removeItem(w.id,!1)});break;case"add":{Object.keys(f).forEach(function(w){var I=f[w];!I||I.forEach(function(G){var U=G.itemType;delete G.itemType,e.addItem(U,G,!1)})});break}case"updateComboTree":Object.keys(f).forEach(function(w){var I=f[w];!I||I.forEach(function(G){e.updateComboTree(G.id,G.parentId,!1)})});break;case"createCombo":var d=f.combos[f.combos.length-1];e.createCombo(d,d.children.map(function(w){return w.id}),!1);break;case"uncombo":var v=s.data.before.combos,x=v[v.length-1];e.uncombo(x.id,!1);break;case"layout":e.updateLayout(f,void 0,void 0,!1);break;default:}}}},a.prototype.zoomOut=function(){var e=this.get("graph"),i=e.getZoom(),s=1/(1-vv*this.get("zoomSensitivity")),l=this.get("maxZoom")||e.get("maxZoom");s*i>l||e.zoomTo(i*s)},a.prototype.zoomIn=function(){var e=this.get("graph"),i=e.getZoom(),s=1-vv*this.get("zoomSensitivity"),l=this.get("minZoom")||e.get("minZoom");s*i<l||e.zoomTo(i*s)},a.prototype.realZoom=function(){var e=this.get("graph");e.zoomTo(1)},a.prototype.autoZoom=function(){var e=this.get("graph");e.fitView([20,20])},a.prototype.handleDefaultOperator=function(e){switch(e){case"redo":this.redo();break;case"undo":this.undo();break;case"zoomOut":this.zoomOut();break;case"zoomIn":this.zoomIn();break;case"realZoom":this.realZoom();break;case"autoZoom":this.autoZoom();break;default:}},a.prototype.destroy=function(){var e=this.get("toolBar");if(e){var i=this.get("container");i||(i=this.get("graph").get("container")),(0,k.isString)(i)&&(i=document.getElementById(i)),i.removeChild(e)}var s=this.get("handleClick");s&&e.removeEventListener("click",s)},a}(id),FC=PC,BC=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();typeof document!="undefined"&&Em()(`
  .g6-component-tooltip {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .tooltip-type {
    padding: 0;
    margin: 0;
  }
  .tooltip-id {
    color: #531dab;
  }
`);var zC=function(c){BC(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,getContent:function(i){return`
          <h4 class='tooltip-type'>\u7C7B\u578B\uFF1A`.concat(i.item.getType(),`</h4>
          <span class='tooltip-id'>ID\uFF1A`).concat(i.item.getID(),`</span>
        `)},shouldBegin:function(i){return!0},itemTypes:["node","edge","combo"],trigger:"mouseenter",fixToNode:void 0}},a.prototype.getEvents=function(){return this.get("trigger")==="click"?{"node:click":"onClick","edge:click":"onClick","combo:click":"onClick","canvas:click":"onMouseLeave",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave",drag:"onMouseLeave"}:{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove","edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove","combo:mouseenter":"onMouseEnter","combo:mouseleave":"onMouseLeave","combo:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave","node:drag":"onMouseLeave"}},a.prototype.init=function(){var e=this,i=e.get("className")||"g6-component-tooltip",s=ql("<div class='".concat(i,"'></div>")),l=e.get("container");l||(l=e.get("graph").get("container")),(0,k.isString)(l)&&(l=document.getElementById(l)),ru(s,{position:"absolute",visibility:"hidden",display:"none"}),l.appendChild(s),e.get("trigger")!=="click"&&(s.addEventListener("mouseenter",function(f){ru(s,{visibility:"visible",display:"unset"})}),s.addEventListener("mouseleave",function(f){e.hideTooltip()})),e.set("tooltip",s)},a.prototype.onClick=function(e){var i=this.get("itemTypes");if(!(e.item&&e.item.getType&&i.indexOf(e.item.getType())===-1)){var s=e.item,l=this.get("graph");this.currentTarget===s?(this.currentTarget=null,this.hideTooltip(),l.emit("tooltipchange",{item:e.item,action:"hide"})):(this.currentTarget=s,this.showTooltip(e),l.emit("tooltipchange",{item:e.item,action:"show"}))}},a.prototype.onMouseEnter=function(e){var i=this.get("itemTypes");if(!(e.item&&e.item.getType&&i.indexOf(e.item.getType())===-1)){var s=e.item,l=this.get("graph");this.currentTarget=s,this.showTooltip(e),l.emit("tooltipchange",{item:e.item,action:"show"})}},a.prototype.onMouseMove=function(e){var i=this.get("itemTypes");e.item&&e.item.getType&&i.indexOf(e.item.getType())===-1||!this.currentTarget||e.item!==this.currentTarget||this.showTooltip(e)},a.prototype.onMouseLeave=function(){this.hideTooltip();var e=this.get("graph");e.emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null},a.prototype.clearContainer=function(){var e=this.get("tooltip");e&&(e.innerHTML="")},a.prototype.showTooltip=function(e){if(!!e.item){var i=this.get("itemTypes");if(!(e.item.getType&&i.indexOf(e.item.getType())===-1)){var s=this.get("tooltip"),l=this.get("getContent"),f=l(e);(0,k.isString)(f)?s.innerHTML=f:(this.clearContainer(),s.appendChild(f)),this.updatePosition(e)}}},a.prototype.hideTooltip=function(){var e=this.get("tooltip");e&&ru(e,{visibility:"hidden",display:"none"})},a.prototype.updatePosition=function(e){var i=this.get("shouldBegin"),s=this.get("tooltip");if(!i(e)){ru(s,{visibility:"hidden",display:"none"});return}var l=this.get("graph"),f=l.get("width"),d=l.get("height"),v=this.get("offsetX")||0,x=this.get("offsetY")||0,w=l.getPointByClient(e.clientX,e.clientY),I=this.get("fixToNode"),G=e.item;if(G.getType&&G.getType()==="node"&&I&&(0,k.isArray)(I)&&I.length>=2){var U=G.getBBox();w={x:U.minX+U.width*I[0],y:U.minY+U.height*I[1]}}var et=l.getCanvasByPoint(w.x,w.y),ft=et.x,Ct=et.y,Mt=l.getContainer(),kt={x:ft+Mt.offsetLeft+v,y:Ct+Mt.offsetTop+x};ru(s,{visibility:"visible",display:"unset"});var $t=s.getBoundingClientRect();ft+$t.width+v>f&&(kt.x-=$t.width+v),Ct+$t.height+x>d&&(kt.y-=$t.height+x,kt.y<0&&(kt.y=0)),ru(s,{left:"".concat(kt.x,"px"),top:"".concat(kt.y,"px")})},a.prototype.hide=function(){this.onMouseLeave()},a.prototype.destroy=function(){var e=this.get("tooltip");if(e){var i=this.get("container");i||(i=this.get("graph").get("container")),(0,k.isString)(i)&&(i=document.getElementById(i)),i.removeChild(e)}},a}(id),$C=zC,kw="timebarstartplay",Dw="timebarendplay",gv="valuechange",Rg="timebarConfigChanged",hg="playPauseBtn",p0="nextStepBtn",v0="preStepBtn",MA={opacity:.5,fill:"#000"},NA={opacity:.5,fill:"#000",r:5},kA={fill:"#fff",fontSize:12},GC=function(){function c(a){var e=a.x,i=e===void 0?0:e,s=a.y,l=s===void 0?0:s,f=a.container,d=a.text,v=a.padding,x=v===void 0?[4,4,4,4]:v,w=a.className,I=w===void 0?"g6-component-timebar-tooltip":w,G=a.backgroundColor,U=G===void 0?"#000":G,et=a.textColor,ft=et===void 0?"#fff":et,Ct=a.opacity,Mt=Ct===void 0?.8:Ct,kt=a.fontSize,$t=kt===void 0?12:kt;this.container=f,this.className=I,this.backgroundColor=U,this.textColor=ft,this.x=i,this.y=l,this.text=d,this.padding=x,this.opacity=Mt,this.fontSize=$t,this.render()}return c.prototype.render=function(){var a=this,e=a.className,i=a.x,s=a.y,l=a.backgroundColor,f=a.textColor,d=a.text,v=a.padding,x=a.opacity,w=a.fontSize,I=a.container,G=ql("<div class='".concat(e,`' style="position: absolute; width: fit-content; height: fit-content; opacity: `).concat(x,'"></div>'));(0,k.isString)(I)&&(I=document.getElementById(I)),I.appendChild(G),a.parentHeight=I.offsetHeight,a.parentWidth=I.offsetWidth,ru(G,{visibility:"hidden",top:0,left:0});var U=ql(`
      <div style='position: absolute; white-space:nowrap; background-color: `.concat(l,"; font-size: ").concat(w,"px; border-radius: 4px; width: fit-content; height: fit-content; color: ").concat(f,"; padding: ").concat(v[0],"px ").concat(v[1],"px ").concat(v[2],"px ").concat(v[3],"px'></div>"));U.innerHTML=d,G.appendChild(U),a.backgroundDOM=U;var et=ql("<div style='position: absolute; width: 0px; height: 0px; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 10px solid ".concat(l,"'></div>"));G.appendChild(et),a.arrowDOM=et,a.container=G},c.prototype.show=function(a){var e=this,i=a.text,s=a.x,l=a.y,f=a.clientX,d=a.clientY;e.backgroundDOM.innerHTML=i;var v=e.backgroundDOM.offsetWidth,x=e.backgroundDOM.offsetHeight,w=e.arrowDOM.offsetWidth,I=e.arrowDOM.offsetHeight;ru(e.container,{top:"".concat(-x-I,"px"),left:"".concat(s,"px"),visibility:"visible"}),ru(e.backgroundDOM,{marginLeft:"".concat(-v/2,"px")}),ru(e.arrowDOM,{marginLeft:"".concat(-w/2,"px"),top:"".concat(x,"px")});var G=s-v/2,U=s+v/2;G<0?ru(e.backgroundDOM,{marginLeft:"".concat(-v/2-G,"px")}):U>e.parentWidth&&ru(e.backgroundDOM,{marginLeft:"".concat(-v/2-U+e.parentWidth+12,"px")})},c.prototype.hide=function(){ru(this.container,{top:0,left:0,visibility:"hidden"})},c}(),UC=GC,mb=function(){return mb=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},mb.apply(this,arguments)},WC=function(){function c(a){this.config=(0,k.deepMix)({},a),this.init()}return c.prototype.update=function(a){this.config=(0,k.deepMix)({},this.config,a),this.updateElement(),this.renderMarker()},c.prototype.init=function(){this.initElement(),this.renderMarker()},c.prototype.initElement=function(){var a=this.config,e=a.group,i=a.style,s=i.scale,l=s===void 0?1:s,f=i.offsetX,d=f===void 0?0:f,v=i.offsetY,x=v===void 0?0:v,w=this.config.x+d,I=this.config.y+x,G=e.addGroup({name:hg});this.startMarkerGroup=G.addGroup({name:hg}),this.circle=e.addShape("circle",{attrs:mb({x:w,y:I,r:this.config.r*l},i),name:hg}),this.startMarker=this.startMarkerGroup.addShape("path",{attrs:{path:this.getStartMarkerPath(w,I,l),fill:i.stroke||"#aaa"},name:"start-marker"}),this.pauseMarkerGroup=G.addGroup({name:hg});var U=.25*this.config.r*l,et=.5*this.config.r*Math.sqrt(3)*l;this.pauseLeftMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:w-.375*this.config.r*l,y:I-et/2,width:U,height:et,fill:i.stroke||"#aaa",lineWidth:0}}),this.pauseRightMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:w+1/8*this.config.r*l,y:I-et/2,width:U,height:et,fill:i.stroke||"#aaa",lineWidth:0}})},c.prototype.updateElement=function(){var a=this.config.style,e=a.scale,i=e===void 0?1:e,s=a.offsetX,l=s===void 0?0:s,f=a.offsetY,d=f===void 0?0:f,v=this.config.x+l,x=this.config.y+d;this.circle.attr("x",v),this.circle.attr("y",x),this.circle.attr("r",this.config.r*i),this.startMarker.attr("path",this.getStartMarkerPath(v,x,i));var w=.25*this.config.r*i,I=.5*this.config.r*Math.sqrt(3)*i;this.pauseLeftMarker.attr("x",v-(1/4+1/8)*this.config.r*i),this.pauseLeftMarker.attr("y",x-I/2),this.pauseLeftMarker.attr("width",w),this.pauseLeftMarker.attr("height",I),this.pauseRightMarker.attr("x",v+1/8*this.config.r*i),this.pauseRightMarker.attr("y",x-I/2),this.pauseRightMarker.attr("width",w),this.pauseRightMarker.attr("height",I)},c.prototype.renderMarker=function(){this.config.isPlay?(this.startMarkerGroup.hide(),this.pauseMarkerGroup.show()):(this.startMarkerGroup.show(),this.pauseMarkerGroup.hide())},c.prototype.getStartMarkerPath=function(a,e,i){var s=.5*this.config.r*Math.sqrt(3)*i;return[["M",a-s/Math.sqrt(3)/2,e-s/2],["L",a+s/Math.sqrt(3),e],["L",a-s/Math.sqrt(3)/2,e+s/2]]},c}(),dg=WC,Wc=function(){return Wc=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},Wc.apply(this,arguments)},g0=Le,Lg="#aaa",Pg="green",VC={fill:"#aaa",fillOpacity:.35,stroke:"#aaa"},_y={fill:"#fff"},yb={fill:"green"},mv={pointer:{fill:"#aaa",lineWidth:0},scroller:{stroke:"#aaa",fill:"#aaa",lineWidth:1,lineAppendWidth:5,cursor:"pointer"},text:{fill:"#aaa",textBaseline:"top"}},Iy={check:{stroke:"green",lineWidth:3},box:{fill:"#fff",stroke:"#aaa",lineWidth:2,radius:3,width:12,height:12},text:{fill:"#aaa",fontSize:12,textBaseline:"top"}},Ty={speed:1,loop:!1,fill:"#fff",stroke:"#fff",hideTimeTypeController:!1,preBtnStyle:{fill:"#aaa",stroke:"#aaa"},nextBtnStyle:{fill:"#aaa",stroke:"#aaa"},playBtnStyle:{fill:"#aaa",stroke:"#aaa",fillOpacity:.05},speedControllerStyle:mv,timeTypeControllerStyle:Iy},m0=110,Kd=50,od={SINGLE:"single",RANGE:"range"},y0=function(){function c(a){this.controllerCfg=(0,k.deepMix)({},Ty,a),this.group=a.group,this.controllerGroup=this.group.addGroup({name:"controller-group"}),this.speedAxisY=[],this.currentSpeed=this.controllerCfg.speed,this.currentType=this.controllerCfg.defaultTimeType||od.RANGE,this.fontFamily=a.fontFamily||"Arial, sans-serif",this.init()}return c.prototype.init=function(){this.renderPlayButton()},c.prototype.getNextMarkerPath=function(a,e,i){return[["M",a,e-i],["L",a+i,e],["L",a,e+i],["Z",a,e-i],["M",a,e],["L",a-i,e-i],["L",a-i,e+i],["Z"]]},c.prototype.getPreMarkerPath=function(a,e,i){return[["M",a,e-i],["L",a-i,e],["L",a,e+i],["L",a,e-i],["M",a,e],["L",a+i,e-i],["L",a+i,e+i],["Z"]]},c.prototype.renderPlayButton=function(){var a=this.controllerCfg,e=a.width,i=a.height,s=a.x,l=a.y,f=a.hideTimeTypeController,d=a.fill,v=d===void 0?Lg:d,x=a.stroke,w=x===void 0?Pg:x,I=a.containerStyle,G=I===void 0?{}:I,U=Wc(Wc({},VC),a.playBtnStyle||{}),et=Wc(Wc({},_y),a.preBtnStyle||{}),ft=Wc(Wc({},yb),a.nextBtnStyle||{}),Ct=i/2-5,Mt=l+10,kt=this.controllerGroup.addShape("rect",{attrs:Wc({x:s,y:Mt,width:e,height:i,stroke:w,fill:v},G),name:"container-rect"});this.playButton?this.playButton.update({x:e/2,y:Mt,r:Ct}):this.playButton=new dg({group:this.controllerGroup,x:e/2,y:Mt+Ct+5,r:Ct,isPlay:this.isPlay,style:U});var $t=et.offsetX||0,Jt=et.offsetY||0,Ce=(et.scale||1)*Ct;this.controllerGroup.addShape("path",{attrs:Wc({path:this.getPreMarkerPath(e/2-5*Ct+$t,Mt+Ct+5+Jt,Ce*.5)},et),name:v0});var je=ft.offsetX||0,ze=ft.offsetY||0,pn=(ft.scale||1)*Ct;this.controllerGroup.addShape("path",{attrs:Wc({path:this.getNextMarkerPath(e/2+5*Ct+je,Mt+Ct+5+ze,pn*.5)},ft),name:p0}),kt.toBack(),this.renderSpeedBtn(),f||this.renderToggleTime(),this.bindEvent();var Fn=this.controllerCfg.scale,Tn=Fn===void 0?1:Fn,cr=this.controllerGroup.getCanvasBBox(),kr=(cr.maxX+cr.minX)/2,Aa=(cr.maxY+cr.minY)/2,ci=g0([1,0,0,0,1,0,0,0,1],[["t",-kr,-Aa],["s",Tn,Tn],["t",kr,Aa]]);this.controllerGroup.setMatrix(ci)},c.prototype.renderSpeedBtn=function(){var a=this.controllerCfg,e=a.y,i=a.width,s=a.hideTimeTypeController,l=Wc(Wc({},mv),this.controllerCfg.speedControllerStyle||{}),f=l.scroller,d=f===void 0?{}:f,v=l.text,x=v===void 0?{}:v,w=l.pointer,I=w===void 0?{}:w,G=l.scale,U=G===void 0?1:G,et=l.offsetX,ft=et===void 0?0:et,Ct=l.offsetY,Mt=Ct===void 0?0:Ct,kt=this.controllerGroup.addGroup({name:"speed-group"});this.speedGroup=kt;var $t=[],Jt=5;this.speedAxisY=[19,22,26,32,39];for(var Ce=0;Ce<5;Ce++){var je=e+this.speedAxisY[Ce],ze=i-(s?Kd:m0);kt.addShape("line",{attrs:Wc({x1:ze,x2:ze+15,y1:je,y2:je},d),speed:Jt,name:"speed-rect"}),this.speedAxisY[Ce]=je,$t.push(Jt),Jt=Jt-1}this.speedText=kt.addShape("text",{attrs:Wc({x:i-(s?Kd:m0)+20,y:this.speedAxisY[0]+4,text:"1.0X",fontFamily:this.fontFamily||"Arial, sans-serif"},x),name:"speed-text"}),this.speedPoint=kt.addShape("path",{attrs:Wc({path:this.getPointerPath(i-(s?Kd:m0),0),matrix:[1,0,0,0,1,0,0,this.speedAxisY[4],1]},I),name:"speed-pointer"});var pn=this.speedGroup.getCanvasBBox(),Fn=(pn.maxX+pn.minX)/2,Tn=(pn.maxY+pn.minY)/2,cr=this.speedGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];cr=g0(cr,[["t",-Fn,-Tn],["s",U,U],["t",Fn+ft*U,Tn+Mt*U]]),this.speedGroup.setMatrix(cr)},c.prototype.getPointerPath=function(a,e){return[["M",a,e],["L",a-10,e-4],["L",a-10,e+4],["Z"]]},c.prototype.renderToggleTime=function(){var a,e,i=this.controllerCfg,s=i.width,l=i.defaultTimeType,f=Wc(Wc({},Iy),this.controllerCfg.timeTypeControllerStyle||{}),d=f.scale,v=d===void 0?1:d,x=f.offsetX,w=x===void 0?0:x,I=f.offsetY,G=I===void 0?0:I,U=f.box,et=U===void 0?{}:U,ft=f.check,Ct=ft===void 0?{}:ft,Mt=f.text,kt=Mt===void 0?{}:Mt;this.toggleGroup=this.controllerGroup.addGroup({name:"toggle-group"});var $t=l===od.SINGLE;this.toggleGroup.addShape("rect",{attrs:Wc({x:s-Kd,y:this.speedAxisY[0]+3.5},et),isChecked:$t,name:"toggle-model"}),this.checkedIcon=this.toggleGroup.addShape("path",{attrs:Wc({path:[["M",s-Kd+3,this.speedAxisY[1]+6],["L",s-Kd+7,this.speedAxisY[1]+10],["L",s-Kd+12,this.speedAxisY[1]+4]]},Ct),capture:!1,name:"check-icon"}),$t||this.checkedIcon.hide(),this.checkedText=this.toggleGroup.addShape("text",{attrs:Wc({text:$t?((a=this.controllerCfg)===null||a===void 0?void 0:a.timeRangeControllerText)||"\u65F6\u95F4\u8303\u56F4":((e=this.controllerCfg)===null||e===void 0?void 0:e.timePointControllerText)||"\u5355\u4E00\u65F6\u95F4",x:s-Kd+15,y:this.speedAxisY[0]+4,fontFamily:typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"},kt),name:"checked-text"});var Jt=this.toggleGroup.getCanvasBBox(),Ce=(Jt.maxX+Jt.minX)/2,je=(Jt.maxY+Jt.minY)/2,ze=this.toggleGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];ze=g0(ze,[["t",-Ce,-je],["s",v,v],["t",Ce+w*v,je+G*v]]),this.toggleGroup.setMatrix(ze)},c.prototype.bindEvent=function(){var a=this;this.speedGroup.on("speed-rect:click",function(e){var i=e.target.attr("y1"),s=a.speedPoint.attr("matrix"),l=a.speedAxisY.indexOf(s[7]||0),f=a.speedAxisY.indexOf(i),d=a.speedAxisY[f]-a.speedAxisY[l];s=g0(s,[["t",0,d]]),a.speedPoint.setMatrix(s),a.currentSpeed=a.speedAxisY.length-f,a.speedText.attr("text","".concat(a.currentSpeed,".0X")),a.group.emit(Rg,{speed:a.currentSpeed,type:a.currentType})}),this.speedGroup.on("mousewheel",function(e){e.preventDefault();var i=a.speedPoint.attr("matrix")||[1,0,0,0,1,0,0,0,1],s=i[7],l=a.speedAxisY.indexOf(s);if(l===-1){var f=Infinity;a.speedAxisY.forEach(function(v,x){var w=Math.abs(v-s);f>w&&(f=w,l=x)})}e.originalEvent.deltaY>0?l=Math.max(0,l-1):l=Math.min(a.speedAxisY.length-1,l+1);var d=a.speedAxisY[l]-s;i=g0(i,[["t",0,d]]),a.speedPoint.setMatrix(i),a.currentSpeed=a.speedAxisY.length-l,a.speedText.attr("text","".concat(a.currentSpeed,".0X")),a.group.emit(Rg,{speed:a.currentSpeed,type:a.currentType})}),this.toggleGroup&&this.toggleGroup.on("toggle-model:click",function(e){var i,s,l=e.target.get("isChecked");l?(a.checkedIcon.hide(),a.checkedText.attr("text",((s=a.controllerCfg)===null||s===void 0?void 0:s.timePointControllerText)||"\u5355\u4E00\u65F6\u95F4"),a.currentType=od.RANGE):(a.checkedIcon.show(),a.checkedText.attr("text",((i=a.controllerCfg)===null||i===void 0?void 0:i.timeRangeControllerText)||"\u65F6\u95F4\u8303\u56F4"),a.currentType=od.SINGLE),e.target.set("isChecked",!l),a.group.emit(Rg,{type:a.currentType,speed:a.currentSpeed})})},c.prototype.destroy=function(){this.speedGroup.off("speed-rect:click"),this.toggleGroup&&(this.toggleGroup.off("toggle-model:click"),this.toggleGroup.destroy()),this.speedGroup.destroy()},c}(),Ay=y0,Fg=function(){return Fg=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},Fg.apply(this,arguments)},My=Le,Ny={fill:"#5B8FF9"},bb={fill:"#e6e8e9"},xb=function(){function c(a){this.frameCount=0,this.fontFamily="Arial, sans-serif";var e=a.graph,i=a.canvas,s=a.group,l=a.width,f=a.height,d=a.padding,v=a.data,x=a.start,w=a.end,I=a.x,G=I===void 0?0:I,U=a.y,et=U===void 0?0:U,ft=a.tickLabelFormatter,Ct=a.selectedTickStyle,Mt=Ct===void 0?Ny:Ct,kt=a.unselectedTickStyle,$t=kt===void 0?bb:kt,Jt=a.tooltipBackgroundColor,Ce=a.tooltipFomatter,je=a.tickLabelStyle,ze=a.controllerCfg,pn=ze===void 0?{speed:1}:ze;this.graph=e,this.group=s,this.sliceGroup=s.addGroup({name:"slice-group"}),this.canvas=i,this.width=l,this.height=f,this.padding=d,this.data=v,this.start=x,this.end=w,this.tickLabelFormatter=ft,this.tickLabelStyle=je||{},this.selectedTickStyle=Mt,this.unselectedTickStyle=$t,this.controllerCfg=pn,this.currentSpeed=pn.speed||1,this.x=G,this.y=et,this.tooltipBackgroundColor=Jt,this.tooltipFomatter=Ce,this.fontFamily=typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlices(),this.initEvent()}return c.prototype.renderSlices=function(){var a=this,e=this,i=e.width,s=e.height,l=e.padding,f=e.data,d=e.start,v=e.end,x=e.tickLabelFormatter,w=e.selectedTickStyle,I=e.unselectedTickStyle,G=e.tickLabelStyle,U=i-2*l,et=10,ft=4,Ct=3*l+ft+et,Mt=s-Ct-2*l,kt=2,$t=f.length,Jt=(U-kt*($t-1))/$t;this.tickWidth=Jt;var Ce=this.sliceGroup,je=[],ze=[],pn=Math.round($t*d),Fn=Math.round($t*v);this.startTickRectId=pn,this.endTickRectId=Fn;var Tn=G.rotate;delete G.rotate,f.forEach(function(kr,Aa){var ci=Aa>=pn&&Aa<=Fn,ei=ci?w:I,Ca=Ce.addShape("rect",{attrs:Fg({x:l+Aa*(Jt+kt),y:l,width:Jt,height:Mt},ei),draggable:!0,name:"tick-rect-".concat(Aa)}),Pi=Ce.addShape("rect",{attrs:{x:l+Aa*Jt+kt*(2*Aa-1)/2,y:l,width:Aa===0||Aa===$t-1?Jt+kt/2:Jt+kt,height:Mt,fill:"#fff",opacity:0},draggable:!0,name:"pick-rect-".concat(Aa)});Pi.toFront();var Ni=Ca.getBBox(),_a=(Ni.minX+Ni.maxX)/2;je.push({rect:Ca,pickRect:Pi,value:kr.date,x:_a,y:Ni.minY});var Ya;if(x?(Ya=x(kr),!(0,k.isString)(Ya)&&Ya&&(Ya=kr.date)):Aa%Math.round($t/10)==0&&(Ya=kr.date),Ya){ze.push(Ya);var hi=Ni.maxY+l*2;Ce.addShape("line",{attrs:{stroke:"#BFBFBF",x1:_a,y1:hi,x2:_a,y2:hi+ft},name:"tick-line"});var di=hi+ft+l,Xi=Ce.addShape("text",{attrs:Fg({fill:"#8c8c8c",stroke:"#fff",lineWidth:1,x:_a,y:di,textAlign:"center",text:Ya,textBaseline:"top",fontSize:10,fontFamily:a.fontFamily||"Arial, sans-serif"},G),capture:!1,name:"tick-label"}),go=Xi.getBBox();if(go.maxX>i?Xi.attr("textAlign","right"):go.minX<0&&Xi.attr("textAlign","left"),(0,k.isNumber)(Tn)&&ze.length!==10){var vs=My([1,0,0,0,1,0,0,0,1],[["t",-_a,-di],["r",Tn],["t",_a-5,di+2]]);Xi.attr({textAlign:"left",matrix:vs})}ze.length===1?Xi.attr({textAlign:"left"}):ze.length===10&&Xi.attr({textAlign:"right"})}}),this.tickRects=je;var cr=this.group;this.currentSpeed=1,this.controllerBtnGroup=new Ay(Fg({group:cr,x:this.x,y:this.y+s+5,width:i,height:40,hideTimeTypeController:!0,speed:this.currentSpeed,fontFamily:this.fontFamily||"Arial, sans-serif"},this.controllerCfg))},c.prototype.initEvent=function(){var a=this,e=this.sliceGroup;e.on("click",function(w){var I=w.target;if(!(I.get("type")!=="rect"||!I.get("name"))){var G=parseInt(I.get("name").split("-")[2],10);if(!isNaN(G)){var U=a.tickRects,et=a.unselectedTickStyle;U.forEach(function(kt){kt.rect.attr(et)});var ft=a.selectedTickStyle;U[G].rect.attr(ft),a.startTickRectId=G,a.endTickRectId=G;var Ct=U.length,Mt=G/Ct;a.graph.emit(gv,{value:[Mt,Mt]})}}}),e.on("dragstart",function(w){var I=a.tickRects,G=a.unselectedTickStyle;I.forEach(function(kt){kt.rect.attr(G)});var U=w.target,et=parseInt(U.get("name").split("-")[2],10),ft=a.selectedTickStyle;I[et].rect.attr(ft),a.startTickRectId=et;var Ct=I.length,Mt=et/Ct;a.graph.emit(gv,{value:[Mt,Mt]}),a.dragging=!0}),e.on("dragover",function(w){if(!!a.dragging&&w.target.get("type")==="rect"){for(var I=parseInt(w.target.get("name").split("-")[2],10),G=a.startTickRectId,U=a.tickRects,et=a.selectedTickStyle,ft=a.unselectedTickStyle,Ct=0;Ct<U.length;Ct++){var Mt=Ct>=G&&Ct<=I?et:ft;U[Ct].rect.attr(Mt)}var kt=U.length;a.endTickRectId=I;var $t=G/kt,Jt=I/kt;a.graph.emit(gv,{value:[$t,Jt]})}}),e.on("drop",function(w){if(!!a.dragging&&(a.dragging=!1,w.target.get("type")==="rect")){var I=a.startTickRectId,G=parseInt(w.target.get("name").split("-")[2],10);if(!(G<I)){var U=a.selectedTickStyle,et=a.tickRects;et[G].rect.attr(U),a.endTickRectId=G;var ft=et.length,Ct=I/ft,Mt=G/ft;a.graph.emit(gv,{value:[Ct,Mt]})}}});var i=this,s=i.tooltipBackgroundColor,l=i.tooltipFomatter,f=i.canvas,d=new UC({container:f.get("container"),backgroundColor:s}),v=this.tickRects;v.forEach(function(w){var I=w.pickRect;I.on("mouseenter",function(G){var U=G.target;if(U.get("type")==="rect"){var et=parseInt(U.get("name").split("-")[2],10),ft=f.getClientByPoint(v[et].x,v[et].y);d.show({x:v[et].x,y:v[et].y,clientX:ft.x,clientY:ft.y,text:l?l(v[et].value):v[et].value})}}),I.on("mouseleave",function(G){d.hide()})});var x=this.group;x.on("".concat(hg,":click"),function(){a.isPlay=!a.isPlay,a.changePlayStatus()}),x.on("".concat(p0,":click"),function(){a.updateStartEnd(1)}),x.on("".concat(v0,":click"),function(){a.updateStartEnd(-1)}),x.on(Rg,function(w){var I=w.type,G=w.speed;a.currentSpeed=G})},c.prototype.changePlayStatus=function(a){a===void 0&&(a=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit(kw,null)):this.playHandler&&(typeof window!="undefined"&&window.cancelAnimationFrame(this.playHandler),a&&this.graph.emit(Dw,null))},c.prototype.startPlay=function(){var a=this;return typeof window!="undefined"?window.requestAnimationFrame(function(){var e=a.currentSpeed;a.frameCount%(60/e)==0&&(a.frameCount=0,a.updateStartEnd(1)),a.frameCount++,a.isPlay&&(a.playHandler=a.startPlay())}):void 0},c.prototype.updateStartEnd=function(a){var e=this,i=this.tickRects,s=i.length,l=this.unselectedTickStyle,f=this.selectedTickStyle,d=e.endTickRectId;if(a>0?e.endTickRectId++:(i[e.endTickRectId].rect.attr(l),e.endTickRectId--),d!==e.startTickRectId)e.endTickRectId<e.startTickRectId&&(e.startTickRectId=e.endTickRectId);else{for(var v=e.startTickRectId;v<=e.endTickRectId-1;v++)i[v].rect.attr(l);e.startTickRectId=e.endTickRectId}if(i[e.endTickRectId]){i[e.endTickRectId].rect.attr(f);var x=e.startTickRectId/s,w=e.endTickRectId/s;this.graph.emit(gv,{value:[x,w]})}},c.prototype.destory=function(){var a=this.sliceGroup;a.off("click"),a.off("dragstart"),a.off("dragover"),a.off("drop"),this.tickRects.forEach(function(e){var i=e.pickRect;i.off("mouseenter"),i.off("mouseleave")}),this.tickRects.length=0,a.off("".concat(hg,":click")),a.off("".concat(p0,":click")),a.off("".concat(v0,":click")),a.off(Rg),this.sliceGroup.destroy()},c}(),wb=xb,ky={};function Eb(c){return ky[c]}function Zd(c,a){ky[c]=a}var Sm=function(){function c(a){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=a,this.initCfg(),this.init()}return c.prototype.translate=function(a){return a},c.prototype.change=function(a){(0,k.assign)(this.__cfg__,a),this.init()},c.prototype.clone=function(){return this.constructor(this.__cfg__)},c.prototype.getTicks=function(){var a=this;return(0,k.map)(this.ticks,function(e,i){return(0,k.isObject)(e)?e:{text:a.getText(e,i),tickValue:e,value:a.scale(e)}})},c.prototype.getText=function(a,e){var i=this.formatter,s=i?i(a,e):a;return(0,k.isNil)(s)||!(0,k.isFunction)(s.toString)?"":s.toString()},c.prototype.getConfig=function(a){return this.__cfg__[a]},c.prototype.init=function(){(0,k.assign)(this,this.__cfg__),this.setDomain(),(0,k.isEmpty)(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},c.prototype.initCfg=function(){},c.prototype.setDomain=function(){},c.prototype.calculateTicks=function(){var a=this.tickMethod,e=[];if((0,k.isString)(a)){var i=Eb(a);if(!i)throw new Error("There is no method to to calculate ticks!");e=i(this)}else(0,k.isFunction)(a)&&(e=a(this));return e},c.prototype.rangeMin=function(){return this.range[0]},c.prototype.rangeMax=function(){return this.range[1]},c.prototype.calcPercent=function(a,e,i){return(0,k.isNumber)(a)?(a-e)/(i-e):NaN},c.prototype.calcValue=function(a,e,i){return e+a*(i-e)},c}(),Sb=Sm,Uv=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="cat",e.isCategory=!0,e}return a.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var e=0;e<this.values.length;e++)this.translateIndexMap.set(this.values[e],e)}},a.prototype.translate=function(e){this.buildIndexMap();var i=this.translateIndexMap.get(e);return i===void 0&&(i=(0,k.isNumber)(e)?e:NaN),i},a.prototype.scale=function(e){var i=this.translate(e),s=this.calcPercent(i,this.min,this.max);return this.calcValue(s,this.rangeMin(),this.rangeMax())},a.prototype.invert=function(e){var i=this.max-this.min,s=this.calcPercent(e,this.rangeMin(),this.rangeMax()),l=Math.round(i*s)+this.min;return l<this.min||l>this.max?NaN:this.values[l]},a.prototype.getText=function(e){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];var l=e;return(0,k.isNumber)(e)&&!this.values.includes(e)&&(l=this.values[l]),c.prototype.getText.apply(this,(0,P.__spreadArrays)([l],i))},a.prototype.initCfg=function(){this.tickMethod="cat"},a.prototype.setDomain=function(){if((0,k.isNil)(this.getConfig("min"))&&(this.min=0),(0,k.isNil)(this.getConfig("max"))){var e=this.values.length;this.max=e>1?e-1:e}this.translateIndexMap&&(this.translateIndexMap=void 0)},a}(Sb),Cm=Uv,Cb=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,Wv="\\d\\d?",yv="\\d\\d",Ow="\\d{3}",Rw="\\d{4}",_m="[^\\s]+",Dy=/\[([^]*?)\]/gm;function _b(c,a){for(var e=[],i=0,s=c.length;i<s;i++)e.push(c[i].substr(0,a));return e}var Ib=function(c){return function(a,e){var i=e[c].map(function(l){return l.toLowerCase()}),s=i.indexOf(a.toLowerCase());return s>-1?s:null}};function bv(c){for(var a=[],e=1;e<arguments.length;e++)a[e-1]=arguments[e];for(var i=0,s=a;i<s.length;i++){var l=s[i];for(var f in l)c[f]=l[f]}return c}var Lw=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Pw=["January","February","March","April","May","June","July","August","September","October","November","December"],Tb=_b(Pw,3),Fw=_b(Lw,3),Oy={dayNamesShort:Fw,dayNames:Lw,monthNamesShort:Tb,monthNames:Pw,amPm:["am","pm"],DoFn:function(c){return c+["th","st","nd","rd"][c%10>3?0:(c-c%10!=10?1:0)*c%10]}},Ry=bv({},Oy),Bw=function(c){return Ry=bv(Ry,c)},zw=function(c){return c.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},sd=function(c,a){for(a===void 0&&(a=2),c=String(c);c.length<a;)c="0"+c;return c},jC={D:function(c){return String(c.getDate())},DD:function(c){return sd(c.getDate())},Do:function(c,a){return a.DoFn(c.getDate())},d:function(c){return String(c.getDay())},dd:function(c){return sd(c.getDay())},ddd:function(c,a){return a.dayNamesShort[c.getDay()]},dddd:function(c,a){return a.dayNames[c.getDay()]},M:function(c){return String(c.getMonth()+1)},MM:function(c){return sd(c.getMonth()+1)},MMM:function(c,a){return a.monthNamesShort[c.getMonth()]},MMMM:function(c,a){return a.monthNames[c.getMonth()]},YY:function(c){return sd(String(c.getFullYear()),4).substr(2)},YYYY:function(c){return sd(c.getFullYear(),4)},h:function(c){return String(c.getHours()%12||12)},hh:function(c){return sd(c.getHours()%12||12)},H:function(c){return String(c.getHours())},HH:function(c){return sd(c.getHours())},m:function(c){return String(c.getMinutes())},mm:function(c){return sd(c.getMinutes())},s:function(c){return String(c.getSeconds())},ss:function(c){return sd(c.getSeconds())},S:function(c){return String(Math.round(c.getMilliseconds()/100))},SS:function(c){return sd(Math.round(c.getMilliseconds()/10),2)},SSS:function(c){return sd(c.getMilliseconds(),3)},a:function(c,a){return c.getHours()<12?a.amPm[0]:a.amPm[1]},A:function(c,a){return c.getHours()<12?a.amPm[0].toUpperCase():a.amPm[1].toUpperCase()},ZZ:function(c){var a=c.getTimezoneOffset();return(a>0?"-":"+")+sd(Math.floor(Math.abs(a)/60)*100+Math.abs(a)%60,4)},Z:function(c){var a=c.getTimezoneOffset();return(a>0?"-":"+")+sd(Math.floor(Math.abs(a)/60),2)+":"+sd(Math.abs(a)%60,2)}},$w=function(c){return+c-1},Gw=[null,Wv],Uw=[null,_m],Ww=["isPm",_m,function(c,a){var e=c.toLowerCase();return e===a.amPm[0]?0:e===a.amPm[1]?1:null}],Vw=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(c){var a=(c+"").match(/([+-]|\d\d)/gi);if(a){var e=+a[1]*60+parseInt(a[2],10);return a[0]==="+"?e:-e}return 0}],HC={D:["day",Wv],DD:["day",yv],Do:["day",Wv+_m,function(c){return parseInt(c,10)}],M:["month",Wv,$w],MM:["month",yv,$w],YY:["year",yv,function(c){var a=new Date,e=+(""+a.getFullYear()).substr(0,2);return+(""+(+c>68?e-1:e)+c)}],h:["hour",Wv,void 0,"isPm"],hh:["hour",yv,void 0,"isPm"],H:["hour",Wv],HH:["hour",yv],m:["minute",Wv],mm:["minute",yv],s:["second",Wv],ss:["second",yv],YYYY:["year",Rw],S:["millisecond","\\d",function(c){return+c*100}],SS:["millisecond",yv,function(c){return+c*10}],SSS:["millisecond",Ow],d:Gw,dd:Gw,ddd:Uw,dddd:Uw,MMM:["month",_m,Ib("monthNamesShort")],MMMM:["month",_m,Ib("monthNames")],a:Ww,A:Ww,ZZ:Vw,Z:Vw},Ly={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},jw=function(c){return bv(Ly,c)},Hw=function(c,a,e){if(a===void 0&&(a=Ly.default),e===void 0&&(e={}),typeof c=="number"&&(c=new Date(c)),Object.prototype.toString.call(c)!=="[object Date]"||isNaN(c.getTime()))throw new Error("Invalid Date pass to format");a=Ly[a]||a;var i=[];a=a.replace(Dy,function(l,f){return i.push(f),"@@@"});var s=bv(bv({},Ry),e);return a=a.replace(Cb,function(l){return jC[l](c,s)}),a.replace(/@@@/g,function(){return i.shift()})};function Xw(c,a,e){if(e===void 0&&(e={}),typeof a!="string")throw new Error("Invalid format in fecha parse");if(a=Ly[a]||a,c.length>1e3)return null;var i=new Date,s={year:i.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},l=[],f=[],d=a.replace(Dy,function(Jt,Ce){return f.push(zw(Ce)),"@@@"}),v={},x={};d=zw(d).replace(Cb,function(Jt){var Ce=HC[Jt],je=Ce[0],ze=Ce[1],pn=Ce[3];if(v[je])throw new Error("Invalid format. "+je+" specified twice in format");return v[je]=!0,pn&&(x[pn]=!0),l.push(Ce),"("+ze+")"}),Object.keys(x).forEach(function(Jt){if(!v[Jt])throw new Error("Invalid format. "+Jt+" is required in specified format")}),d=d.replace(/@@@/g,function(){return f.shift()});var w=c.match(new RegExp(d,"i"));if(!w)return null;for(var I=bv(bv({},Ry),e),G=1;G<w.length;G++){var U=l[G-1],et=U[0],ft=U[2],Ct=ft?ft(w[G],I):+w[G];if(Ct==null)return null;s[et]=Ct}s.isPm===1&&s.hour!=null&&+s.hour!=12?s.hour=+s.hour+12:s.isPm===0&&+s.hour==12&&(s.hour=0);var Mt;if(s.timezoneOffset==null){Mt=new Date(s.year,s.month,s.day,s.hour,s.minute,s.second,s.millisecond);for(var kt=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],G=0,$t=kt.length;G<$t;G++)if(v[kt[G][0]]&&s[kt[G][0]]!==Mt[kt[G][1]]())return null}else if(Mt=new Date(Date.UTC(s.year,s.month,s.day,s.hour,s.minute-s.timezoneOffset,s.second,s.millisecond)),s.month>11||s.month<0||s.day>31||s.day<1||s.hour>23||s.hour<0||s.minute>59||s.minute<0||s.second>59||s.second<0)return null;return Mt}var XC={format:Hw,parse:Xw,defaultI18n:Oy,setGlobalDateI18n:Bw,setGlobalDateMasks:jw},Yw=XC;function YC(c){return function(a,e,i,s){for(var l=(0,k.isNil)(i)?0:i,f=(0,k.isNil)(s)?a.length:s;l<f;){var d=l+f>>>1;c(a[d])>e?f=d:l=d+1}return l}}var Kw="format";function Zw(c,a){var e=nt[Kw]||Yw[Kw];return e(c,a)}function Py(c){return(0,k.isString)(c)&&(c.indexOf("T")>0?c=new Date(c).getTime():c=new Date(c.replace(/-/gi,"/")).getTime()),(0,k.isDate)(c)&&(c=c.getTime()),c}var Pp=1e3,Bg=60*Pp,zg=60*Bg,Vv=24*zg,b0=Vv*31,qw=Vv*365,x0=[["HH:mm:ss",Pp],["HH:mm:ss",Pp*10],["HH:mm:ss",Pp*30],["HH:mm",Bg],["HH:mm",Bg*10],["HH:mm",Bg*30],["HH",zg],["HH",zg*6],["HH",zg*12],["YYYY-MM-DD",Vv],["YYYY-MM-DD",Vv*4],["YYYY-WW",Vv*7],["YYYY-MM",b0],["YYYY-MM",b0*4],["YYYY-MM",b0*6],["YYYY",Vv*380]];function KC(c,a,e){var i=(a-c)/e,s=YC(function(f){return f[1]})(x0,i)-1,l=x0[s];return s<0?l=x0[0]:s>=x0.length&&(l=(0,k.last)(x0)),l}var ZC=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="timeCat",e}return a.prototype.translate=function(e){e=Py(e);var i=this.values.indexOf(e);return i===-1&&((0,k.isNumber)(e)&&e<this.values.length?i=e:i=NaN),i},a.prototype.getText=function(e,i){var s=this.translate(e);if(s>-1){var l=this.values[s],f=this.formatter;return l=f?f(l,i):Zw(l,this.mask),l}return e},a.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},a.prototype.setDomain=function(){var e=this.values;(0,k.each)(e,function(i,s){e[s]=Py(i)}),e.sort(function(i,s){return i-s}),c.prototype.setDomain.call(this)},a}(Cm),qC=ZC,QC=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.isContinuous=!0,e}return a.prototype.scale=function(e){if((0,k.isNil)(e))return NaN;var i=this.rangeMin(),s=this.rangeMax(),l=this.max,f=this.min;if(l===f)return i;var d=this.getScalePercent(e);return i+d*(s-i)},a.prototype.init=function(){c.prototype.init.call(this);var e=this.ticks,i=(0,k.head)(e),s=(0,k.last)(e);i<this.min&&(this.min=i),s>this.max&&(this.max=s),(0,k.isNil)(this.minLimit)||(this.min=i),(0,k.isNil)(this.maxLimit)||(this.max=s)},a.prototype.setDomain=function(){var e=(0,k.getRange)(this.values),i=e.min,s=e.max;(0,k.isNil)(this.min)&&(this.min=i),(0,k.isNil)(this.max)&&(this.max=s),this.min>this.max&&(this.min=i,this.max=s)},a.prototype.calculateTicks=function(){var e=this,i=c.prototype.calculateTicks.call(this);return this.nice||(i=(0,k.filter)(i,function(s){return s>=e.min&&s<=e.max})),i},a.prototype.getScalePercent=function(e){var i=this.max,s=this.min;return(e-s)/(i-s)},a.prototype.getInvertPercent=function(e){return(e-this.rangeMin())/(this.rangeMax()-this.rangeMin())},a}(Sb),Fy=QC,JC=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="linear",e.isLinear=!0,e}return a.prototype.invert=function(e){var i=this.getInvertPercent(e);return this.min+i*(this.max-this.min)},a.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},a}(Fy),w0=JC;function pg(c,a){var e=Math.E,i;return a>=0?i=Math.pow(e,Math.log(a)/c):i=Math.pow(e,Math.log(-a)/c)*-1,i}function qd(c,a){return c===1?1:Math.log(a)/Math.log(c)}function Qw(c,a,e){(0,k.isNil)(e)&&(e=Math.max.apply(null,c));var i=e;return(0,k.each)(c,function(s){s>0&&s<i&&(i=s)}),i===e&&(i=e/a),i>1&&(i=1),i}function Jw(c){var a=c.toString().split(/[eE]/),e=(a[0].split(".")[1]||"").length-+(a[1]||0);return e>0?e:0}function DA(c,a){var e=Jw(c),i=Jw(a),s=Math.pow(10,Math.max(e,i));return(c*s+a*s)/s}var t_=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="log",e}return a.prototype.invert=function(e){var i=this.base,s=qd(i,this.max),l=this.rangeMin(),f=this.rangeMax()-l,d,v=this.positiveMin;if(v){if(e===0)return 0;d=qd(i,v/i);var x=1/(s-d)*f;if(e<x)return e/x*v}else d=qd(i,this.min);var w=(e-l)/f,I=w*(s-d)+d;return Math.pow(i,I)},a.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},a.prototype.setDomain=function(){c.prototype.setDomain.call(this);var e=this.min;if(e<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");e===0&&(this.positiveMin=Qw(this.values,this.base,this.max))},a.prototype.getScalePercent=function(e){var i=this.max,s=this.min;if(i===s||e<=0)return 0;var l=this.base,f=this.positiveMin;f&&(s=f*1/l);var d;return e<f?d=e/f/(qd(l,i)-qd(l,s)):d=(qd(l,e)-qd(l,s))/(qd(l,i)-qd(l,s)),d},a}(Fy),e_=t_,n_=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="pow",e}return a.prototype.invert=function(e){var i=this.getInvertPercent(e),s=this.exponent,l=pg(s,this.max),f=pg(s,this.min),d=i*(l-f)+f,v=d>=0?1:-1;return Math.pow(d,s)*v},a.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},a.prototype.getScalePercent=function(e){var i=this.max,s=this.min;if(i===s)return 0;var l=this.exponent,f=(pg(l,e)-pg(l,s))/(pg(l,i)-pg(l,s));return f},a}(Fy),r_=n_,tE=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="time",e}return a.prototype.getText=function(e,i){var s=this.translate(e),l=this.formatter;return l?l(s,i):Zw(s,this.mask)},a.prototype.scale=function(e){var i=e;return((0,k.isString)(i)||(0,k.isDate)(i))&&(i=this.translate(i)),c.prototype.scale.call(this,i)},a.prototype.translate=function(e){return Py(e)},a.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},a.prototype.setDomain=function(){var e=this.values,i=this.getConfig("min"),s=this.getConfig("max");if((!(0,k.isNil)(i)||!(0,k.isNumber)(i))&&(this.min=this.translate(this.min)),(!(0,k.isNil)(s)||!(0,k.isNumber)(s))&&(this.max=this.translate(this.max)),e&&e.length){var l=[],f=Infinity,d=f,v=0;(0,k.each)(e,function(x){var w=Py(x);if(isNaN(w))throw new TypeError("Invalid Time: "+x+" in time scale!");f>w?(d=f,f=w):d>w&&(d=w),v<w&&(v=w),l.push(w)}),e.length>1&&(this.minTickInterval=d-f),(0,k.isNil)(i)&&(this.min=f),(0,k.isNil)(s)&&(this.max=v)}},a}(w0),eE=tE,a_=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="quantize",e}return a.prototype.invert=function(e){var i=this.ticks,s=i.length,l=this.getInvertPercent(e),f=Math.floor(l*(s-1));if(f>=s-1)return(0,k.last)(i);if(f<0)return(0,k.head)(i);var d=i[f],v=i[f+1],x=f/(s-1),w=(f+1)/(s-1);return d+(l-x)/(w-x)*(v-d)},a.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},a.prototype.calculateTicks=function(){var e=c.prototype.calculateTicks.call(this);return this.nice||((0,k.last)(e)!==this.max&&e.push(this.max),(0,k.head)(e)!==this.min&&e.unshift(this.min)),e},a.prototype.getScalePercent=function(e){var i=this.ticks;if(e<(0,k.head)(i))return 0;if(e>(0,k.last)(i))return 1;var s=0;return(0,k.each)(i,function(l,f){if(e>=l)s=f;else return!1}),s/(i.length-1)},a}(Fy),nE=a_,i_=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="quantile",e}return a.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},a}(nE),o_=i_,rE={};function s_(c){return rE[c]}function xv(c,a){if(s_(c))throw new Error("type '"+c+"' existed.");rE[c]=a}var u_=function(c){(0,P.__extends)(a,c);function a(){var e=c!==null&&c.apply(this,arguments)||this;return e.type="identity",e.isIdentity=!0,e}return a.prototype.calculateTicks=function(){return this.values},a.prototype.scale=function(e){return this.values[0]!==e&&(0,k.isNumber)(e)?e:this.range[0]},a.prototype.invert=function(e){var i=this.range;return e<i[0]||e>i[1]?NaN:this.values[0]},a}(Sb),l_=u_;function aE(c){var a=c.values,e=c.tickInterval,i=c.tickCount,s=c.showLast;if((0,k.isNumber)(e)){var l=(0,k.filter)(a,function(et,ft){return ft%e==0}),f=(0,k.last)(a);return s&&(0,k.last)(l)!==f&&l.push(f),l}var d=a.length,v=c.min,x=c.max;if((0,k.isNil)(v)&&(v=0),(0,k.isNil)(x)&&(x=a.length-1),!(0,k.isNumber)(i)||i>=d)return a.slice(v,x+1);if(i<=0||x<=0)return[];for(var w=i===1?d:Math.floor(d/(i-1)),I=[],G=v,U=0;U<i&&!(G>=x);U++)G=Math.min(v+U*w,x),U===i-1&&s?I.push(a[x]):I.push(a[G]);return I}function c_(c){var a=c.min,e=c.max,i=c.nice,s=c.tickCount,l=new f_;return l.domain([a,e]),i&&l.nice(s),l.ticks(s)}var Ab=5,Mb=Math.sqrt(50),Nb=Math.sqrt(10),iE=Math.sqrt(2),f_=function(){function c(){this._domain=[0,1]}return c.prototype.domain=function(a){return a?(this._domain=Array.from(a,Number),this):this._domain.slice()},c.prototype.nice=function(a){var e,i;a===void 0&&(a=Ab);var s=this._domain.slice(),l=0,f=this._domain.length-1,d=this._domain[l],v=this._domain[f],x;return v<d&&(e=[v,d],d=e[0],v=e[1],i=[f,l],l=i[0],f=i[1]),x=By(d,v,a),x>0?(d=Math.floor(d/x)*x,v=Math.ceil(v/x)*x,x=By(d,v,a)):x<0&&(d=Math.ceil(d*x)/x,v=Math.floor(v*x)/x,x=By(d,v,a)),x>0?(s[l]=Math.floor(d/x)*x,s[f]=Math.ceil(v/x)*x,this.domain(s)):x<0&&(s[l]=Math.ceil(d*x)/x,s[f]=Math.floor(v*x)/x,this.domain(s)),this},c.prototype.ticks=function(a){return a===void 0&&(a=Ab),h_(this._domain[0],this._domain[this._domain.length-1],a||Ab)},c}();function h_(c,a,e){var i,s=-1,l,f,d;if(a=+a,c=+c,e=+e,c===a&&e>0)return[c];if((i=a<c)&&(l=c,c=a,a=l),(d=By(c,a,e))===0||!isFinite(d))return[];if(d>0)for(c=Math.ceil(c/d),a=Math.floor(a/d),f=new Array(l=Math.ceil(a-c+1));++s<l;)f[s]=(c+s)*d;else for(c=Math.floor(c*d),a=Math.ceil(a*d),f=new Array(l=Math.ceil(c-a+1));++s<l;)f[s]=(c-s)/d;return i&&f.reverse(),f}function By(c,a,e){var i=(a-c)/Math.max(0,e),s=Math.floor(Math.log(i)/Math.LN10),l=i/Math.pow(10,s);return s>=0?(l>=Mb?10:l>=Nb?5:l>=iE?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(l>=Mb?10:l>=Nb?5:l>=iE?2:1)}function oE(c,a,e){var i;return e==="ceil"?i=Math.ceil(c/a):e==="floor"?i=Math.floor(c/a):i=Math.round(c/a),i*a}function kb(c,a,e){var i=oE(c,e,"floor"),s=oE(a,e,"ceil");i=(0,k.fixedBase)(i,e),s=(0,k.fixedBase)(s,e);for(var l=[],f=Math.max((s-i)/(Math.pow(2,12)-1),e),d=i;d<=s;d=d+f){var v=(0,k.fixedBase)(d,f);l.push(v)}return{min:i,max:s,ticks:l}}function Db(c,a,e){var i,s=c.minLimit,l=c.maxLimit,f=c.min,d=c.max,v=c.tickCount,x=v===void 0?5:v,w=(0,k.isNil)(s)?(0,k.isNil)(a)?f:a:s,I=(0,k.isNil)(l)?(0,k.isNil)(e)?d:e:l;if(w>I&&(i=[w,I],I=i[0],w=i[1]),x<=2)return[w,I];for(var G=(I-w)/(x-1),U=[],et=0;et<x;et++)U.push(w+G*et);return U}function d_(c){var a=c.min,e=c.max,i=c.tickInterval,s=c.minLimit,l=c.maxLimit,f=c_(c);return!(0,k.isNil)(s)||!(0,k.isNil)(l)?Db(c,(0,k.head)(f),(0,k.last)(f)):i?kb(a,e,i).ticks:f}function $g(c){return Math.abs(c)<1e-15?c:parseFloat(c.toFixed(15))}var p_=[1,5,2,2.5,4,3],OA=null,sE=Number.EPSILON*100;function v_(c,a){return(c%a+a)%a}function g_(c){return Math.round(c*1e12)/1e12}function m_(c,a,e,i,s,l){var f=(0,k.size)(a),d=(0,k.indexOf)(a,c),v=0,x=v_(i,l);return(x<sE||l-x<sE)&&i<=0&&s>=0&&(v=1),1-d/(f-1)-e+v}function y_(c,a,e){var i=(0,k.size)(a),s=(0,k.indexOf)(a,c),l=1;return 1-s/(i-1)-e+l}function b_(c,a,e,i,s,l){var f=(c-1)/(l-s),d=(a-1)/(Math.max(l,i)-Math.min(e,s));return 2-Math.max(f/d,d/f)}function uE(c,a){return c>=a?2-(c-1)/(a-1):1}function x_(c,a,e,i){var s=a-c;return 1-.5*(Math.pow(a-i,2)+Math.pow(c-e,2))/Math.pow(.1*s,2)}function w_(c,a,e){var i=a-c;if(e>i){var s=(e-i)/2;return 1-Math.pow(s,2)/Math.pow(.1*i,2)}return 1}function E_(){return 1}function S_(c,a,e,i,s,l){e===void 0&&(e=5),i===void 0&&(i=!0),s===void 0&&(s=p_),l===void 0&&(l=[.25,.2,.5,.05]);var f=e<0?0:Math.round(e);if(Number.isNaN(c)||Number.isNaN(a)||typeof c!="number"||typeof a!="number"||!f)return{min:0,max:0,ticks:[]};if(a-c<1e-15||f===1)return{min:c,max:a,ticks:[c]};if(a-c>1e148){var d=e||5,v=(a-c)/d;return{min:c,max:a,ticks:Array(d).fill(null).map(function(hi,di){return $g(c+v*di)})}}for(var x={score:-2,lmin:0,lmax:0,lstep:0},w=1;w<Infinity;){for(var I=0;I<s.length;I+=1){var G=s[I],U=y_(G,s,w);if(l[0]*U+l[1]+l[2]+l[3]<x.score){w=Infinity;break}for(var et=2;et<Infinity;){var ft=uE(et,f);if(l[0]*U+l[1]+l[2]*ft+l[3]<x.score)break;for(var Ct=(a-c)/(et+1)/w/G,Mt=Math.ceil(Math.log10(Ct));Mt<Infinity;){var kt=w*G*Math.pow(10,Mt),$t=w_(c,a,kt*(et-1));if(l[0]*U+l[1]*$t+l[2]*ft+l[3]<x.score)break;var Jt=Math.floor(a/kt)*w-(et-1)*w,Ce=Math.ceil(c/kt)*w;if(Jt<=Ce)for(var d=Ce-Jt,je=0;je<=d;je+=1){var ze=Jt+je,pn=ze*(kt/w),Fn=pn+kt*(et-1),Tn=kt,cr=m_(G,s,w,pn,Fn,Tn),kr=x_(c,a,pn,Fn),Aa=b_(et,f,c,a,pn,Fn),ci=E_(),ei=l[0]*cr+l[1]*kr+l[2]*Aa+l[3]*ci;ei>x.score&&(!i||pn<=c&&Fn>=a)&&(x.lmin=pn,x.lmax=Fn,x.lstep=Tn,x.score=ei)}Mt+=1}et+=1}}w+=1}var Ca=$g(x.lmax),Pi=$g(x.lmin),Ni=$g(x.lstep),_a=Math.floor(g_((Ca-Pi)/Ni))+1,Ya=new Array(_a);Ya[0]=$g(Pi);for(var I=1;I<_a;I++)Ya[I]=$g(Ya[I-1]+Ni);return{min:Math.min(c,(0,k.head)(Ya)),max:Math.max(a,(0,k.last)(Ya)),ticks:Ya}}function C_(c){var a=c.min,e=c.max,i=c.tickCount,s=c.nice,l=c.tickInterval,f=c.minLimit,d=c.maxLimit,v=S_(a,e,i,s).ticks;return!(0,k.isNil)(f)||!(0,k.isNil)(d)?Db(c,(0,k.head)(v),(0,k.last)(v)):l?kb(a,e,l).ticks:v}function __(c){var a=c.base,e=c.tickCount,i=c.min,s=c.max,l=c.values,f,d=qd(a,s);if(i>0)f=Math.floor(qd(a,i));else{var v=Qw(l,a,s);f=Math.floor(qd(a,v))}for(var x=d-f,w=Math.ceil(x/e),I=[],G=f;G<d+w;G=G+w)I.push(Math.pow(a,G));return i<=0&&I.unshift(0),I}function lE(c,a,e){if(e===void 0&&(e=5),c===a)return{max:a,min:c,ticks:[c]};var i=e<0?0:Math.round(e);if(i===0)return{max:a,min:c,ticks:[]};var s=1.5,l=.5+1.5*s,f=a-c,d=f/i,v=Math.pow(10,Math.floor(Math.log10(d))),x=v;2*v-d<s*(d-x)&&(x=2*v,5*v-d<l*(d-x)&&(x=5*v,10*v-d<s*(d-x)&&(x=10*v)));for(var w=Math.ceil(a/x),I=Math.floor(c/x),G=Math.max(w*x,a),U=Math.min(I*x,c),et=Math.floor((G-U)/x)+1,ft=new Array(et),Ct=0;Ct<et;Ct++)ft[Ct]=$g(U+Ct*x);return{min:U,max:G,ticks:ft}}function I_(c){var a=c.exponent,e=c.tickCount,i=Math.ceil(pg(a,c.max)),s=Math.floor(pg(a,c.min)),l=lE(s,i,e).ticks;return l.map(function(f){var d=f>=0?1:-1;return Math.pow(f,a)*d})}function T_(c,a){var e=c.length*a;return a===1?c[c.length-1]:a===0?c[0]:e%1!=0?c[Math.ceil(e)-1]:c.length%2==0?(c[e-1]+c[e])/2:c[e]}function A_(c){var a=c.tickCount,e=c.values;if(!e||!e.length)return[];for(var i=e.slice().sort(function(d,v){return d-v}),s=[],l=0;l<a;l++){var f=l/(a-1);s.push(T_(i,f))}return s}function M_(c){var a=c.min,e=c.max,i=c.tickCount,s=c.tickInterval,l=c.minLimit,f=c.maxLimit,d=lE(a,e,i).ticks;return!(0,k.isNil)(l)||!(0,k.isNil)(f)?Db(c,(0,k.head)(d),(0,k.last)(d)):s?kb(a,e,s).ticks:d}function N_(c){var a=c.min,e=c.max,i=c.minTickInterval,s=c.tickInterval,l=c.tickCount;if(s)l=Math.ceil((e-a)/s);else{s=KC(a,e,l)[1];var f=(e-a)/s,d=f/l;d>1&&(s=s*Math.ceil(d)),i&&s<i&&(s=i)}s=Math.max(Math.floor((e-a)/(Math.pow(2,12)-1)),s);for(var v=[],x=a;x<e+s;x+=s)v.push(x);return v}function k_(c){var a=aE((0,P.__assign)({showLast:!0},c));return a}function zy(c){return new Date(c).getFullYear()}function D_(c){return new Date(c,0,1).getTime()}function Ob(c){return new Date(c).getMonth()}function O_(c,a){var e=zy(c),i=zy(a),s=Ob(c),l=Ob(a);return(i-e)*12+(l-s)%12}function R_(c,a){return new Date(c,a,1).getTime()}function L_(c,a){return Math.ceil((a-c)/Vv)}function P_(c,a){return Math.ceil((a-c)/zg)}function F_(c,a){return Math.ceil((a-c)/(60*1e3))}function cE(c){var a=c.min,e=c.max,i=c.minTickInterval,s=c.tickCount,l=c.tickInterval,f=[];l||(l=(e-a)/s,i&&l<i&&(l=i)),l=Math.max(Math.floor((e-a)/(Math.pow(2,12)-1)),l);var d=zy(a);if(l>qw)for(var v=zy(e),x=Math.ceil(l/qw),w=d;w<=v+x;w=w+x)f.push(D_(w));else if(l>b0)for(var I=Math.ceil(l/b0),G=Ob(a),U=O_(a,e),w=0;w<=U+I;w=w+I)f.push(R_(d,w+G));else if(l>Vv)for(var et=new Date(a),ft=et.getFullYear(),Ct=et.getMonth(),Mt=et.getDate(),kt=Math.ceil(l/Vv),$t=L_(a,e),w=0;w<$t+kt;w=w+kt)f.push(new Date(ft,Ct,Mt+w).getTime());else if(l>zg)for(var et=new Date(a),ft=et.getFullYear(),Ct=et.getMonth(),kt=et.getDate(),Jt=et.getHours(),Ce=Math.ceil(l/zg),je=P_(a,e),w=0;w<=je+Ce;w=w+Ce)f.push(new Date(ft,Ct,kt,Jt+w).getTime());else if(l>Bg)for(var ze=F_(a,e),pn=Math.ceil(l/Bg),w=0;w<=ze+pn;w=w+pn)f.push(a+w*Bg);else{var Fn=l;Fn<Pp&&(Fn=Pp);for(var Tn=Math.floor(a/Pp)*Pp,cr=Math.ceil((e-a)/Pp),kr=Math.ceil(Fn/Pp),w=0;w<cr+kr;w=w+kr)f.push(Tn+w*Pp)}return f.length>=512&&console.warn("Notice: current ticks length("+f.length+') >= 512, may cause performance issues, even out of memory. Because of the configure "tickInterval"(in milliseconds, current is '+l+") is too small, increase the value to solve the problem!"),f}Zd("cat",aE),Zd("time-cat",k_),Zd("wilkinson-extended",C_),Zd("r-pretty",M_),Zd("time",N_),Zd("time-pretty",cE),Zd("log",__),Zd("pow",I_),Zd("quantile",A_),Zd("d3-linear",d_),xv("cat",Cm),xv("category",Cm),xv("identity",l_),xv("linear",w0),xv("log",e_),xv("pow",r_),xv("time",eE),xv("timeCat",qC),xv("quantize",nE),xv("quantile",o_);var fE=function(c,a,e){if(e||arguments.length===2)for(var i=0,s=a.length,l;i<s;i++)(l||!(i in a))&&(l||(l=Array.prototype.slice.call(a,0,i)),l[i]=a[i]);return c.concat(l||Array.prototype.slice.call(a))};function B_(c){return(0,k.map)(c,function(a,e){var i=e===0?"M":"L",s=a[0],l=a[1];return[i,s,l]})}function hE(c){return B_(c)}function z_(c){if(c.length<=2)return hE(c);var a=[];(0,k.each)(c,function(f){(0,k.isEqual)(f,a.slice(a.length-2))||a.push(f[0],f[1])});var e=Jr(a,!1),i=(0,k.head)(c),s=i[0],l=i[1];return e.unshift(["M",s,l]),e}function $_(c,a,e,i){i===void 0&&(i=!0);var s=new w0({values:c}),l=new Cm({values:(0,k.map)(c,function(d,v){return v})}),f=(0,k.map)(c,function(d,v){return[l.scale(v)*a,e-s.scale(d)*e]});return i?z_(f):hE(f)}function G_(c,a,e,i){i===void 0&&(i=5);for(var s=new w0({values:c}),l=new Cm({values:(0,k.map)(c,function(G,U){return U})}),f=(0,k.map)(c,function(G,U){return[l.scale(U)*a,e-s.scale(G)*e]}),d=[],v=0;v<f.length;v++){var x=f[v],w={x:x[0],y:x[1],y0:e,size:i},I=V_(w);d.push.apply(d,I)}return j_(d)}function U_(c,a){var e=new w0({values:c}),i=Math.max(0,e.min);return a-e.scale(i)*a}function W_(c,a,e,i){var s=fE([],c,!0),l=U_(i,e);return s.push(["L",a,l]),s.push(["L",0,l]),s.push(["Z"]),s}function V_(c){var a=c.x,e=c.y,i=c.y0,s=c.size,l,f;(0,k.isArray)(e)?(l=e[0],f=e[1]):(l=i,f=e);var d,v;(0,k.isArray)(a)?(d=a[0],v=a[1]):(d=a-s/2,v=a+s/2);var x=[{x:d,y:l},{x:d,y:f}];return x.push({x:v,y:f},{x:v,y:l}),x}function j_(c,a){a===void 0&&(a=!0);var e=[],i=c[0];e.push(["M",i.x,i.y]);for(var s=1,l=c.length;s<l;s++)e.push(["L",c[s].x,c[s].y]);return a&&(e.push(["L",i.x,i.y]),e.push(["z"])),e}var E0=function(){return E0=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},E0.apply(this,arguments)},H_={stroke:"#C5C5C5",strokeOpacity:.85},X_={fill:"#CACED4",opacity:.85},Y_=function(){function c(a){var e=a.x,i=e===void 0?0:e,s=a.y,l=s===void 0?0:s,f=a.width,d=f===void 0?200:f,v=a.height,x=v===void 0?26:v,w=a.smooth,I=w===void 0?!0:w,G=a.isArea,U=G===void 0?!1:G,et=a.data,ft=et===void 0?[]:et,Ct=a.lineStyle,Mt=a.areaStyle,kt=a.group,$t=a.interval,Jt=$t===void 0?null:$t;this.group=kt,this.x=i,this.y=l,this.width=d,this.height=x,this.data=ft,this.smooth=I,this.isArea=U,this.lineStyle=Object.assign({},H_,Ct),this.areaStyle=Object.assign({},X_,Mt),this.intervalConfig=Jt,this.renderLine()}return c.prototype.renderLine=function(){var a=this,e=a.x,i=a.y,s=a.width,l=a.height,f=a.barWidth,d=a.data,v=a.smooth,x=a.isArea,w=a.lineStyle,I=a.areaStyle,G=this.group.addGroup({name:"trend-group"});if(d){var U=$_(d,s,l,v);if(G.addShape("path",{attrs:E0({path:U},w),name:"trend-line"}),x){var et=W_(U,s,l,d);G.addShape("path",{attrs:E0({path:et},I),name:"trend-area"})}}this.intervalConfig&&G.addShape("path",{attrs:E0({path:G_(this.intervalConfig.data,s,l,this.intervalConfig.style.barWidth)},this.intervalConfig.style),name:"trend-interval"}),G.move(e,i)},c.prototype.destory=function(){this.group.destroy()},c}(),K_=Y_,Im=function(){return Im=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},Im.apply(this,arguments)},$y={fill:"#1890ff",stroke:"#1890ff",type:"trend",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#0050b3"},lf={fill:"#fff",stroke:"#1890ff",radius:2,opacity:1,cursor:"ew-resize"},RA=function(){function c(a){var e=a.group,i=a.name,s=a.type,l=a.x,f=l===void 0?0:l,d=a.y,v=d===void 0?0:d,x=a.width,w=x===void 0?2:x,I=a.height,G=I===void 0?24:I,U=a.style,et=U===void 0?{}:U;this.group=e,this.name=i,this.handleType=s,this.x=f,this.y=v,this.width=w,this.height=G,s==="trend"?this.style=Im(Im({},$y),et):s==="simple"&&(this.style=Im(Im({},lf),et)),this.renderHandle()}return c.prototype.setX=function(a){this.setXY(a,void 0)},c.prototype.setY=function(a){this.setXY(void 0,a)},c.prototype.setXY=function(a,e){(0,k.isNumber)(a)&&(this.x=a),(0,k.isNumber)(e)&&(this.y=e),this.updateXY()},c.prototype.renderHandle=function(){var a=this,e=a.width,i=a.height,s=a.style,l=a.name,f=s.fill,d=s.stroke,v=s.radius,x=s.opacity,w=s.cursor;this.handleGroup=this.group.addGroup(),this.handleType==="trend"?(this.verticalLine=this.handleGroup.addShape("rect",{attrs:{x:0,y:0,width:e,height:i,fill:f,stroke:d,radius:v,opacity:x,cursor:w},name:"".concat(l,"-handler")}),this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:e/2,y:0,r:2*e,fill:f,stroke:d,radius:v,opacity:x,cursor:w,lineAppendWidth:12},name:"".concat(l,"-handler")}),this.bottomCircle=this.handleGroup.addShape("circle",{attrs:{x:e/2,y:i,r:2*e,fill:f,stroke:d,radius:v,opacity:x,cursor:w},name:"".concat(l,"-handler")})):this.handleType==="simple"&&(this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:e/2,y:i/2,r:2*e,fill:f,stroke:d,radius:v,opacity:x,cursor:w,lineWidth:2},name:"".concat(l,"-handler")})),this.updateXY(),this.handleType==="trend"?this.bindTrendEvents():this.handleType==="simple"&&this.bindSimpleEvents()},c.prototype.bindSimpleEvents=function(){var a=this,e=this.name;this.handleGroup.on("".concat(e,"-handler:mouseenter"),function(){var i=a.style.highLightFill;a.topCircle.attr("fill",i)}),this.handleGroup.on("".concat(e,"-handler:mouseleave"),function(){var i=a.style.fill;a.topCircle.attr("fill",i)})},c.prototype.bindTrendEvents=function(){var a=this,e=this.name;this.handleGroup.on("".concat(e,"-handler:mouseenter"),function(){var i=a.style.highLightFill;a.verticalLine.attr("fill",i),a.topCircle.attr("fill",i),a.bottomCircle.attr("fill",i)}),this.handleGroup.on("".concat(e,"-handler:mouseleave"),function(){var i=a.style.fill;a.verticalLine.attr("fill",i),a.topCircle.attr("fill",i),a.bottomCircle.attr("fill",i)})},c.prototype.show=function(){this.handleGroup.show()},c.prototype.hide=function(){this.handleGroup.hide()},c.prototype.updateXY=function(){this.handleGroup.setMatrix([1,0,0,0,1,0,this.x,this.y,1])},c}(),Qd=RA,Yu=function(){return Yu=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},Yu.apply(this,arguments)},Jd=Le,Kr={fill:"#416180",opacity:.05},Xs={fill:"#416180",opacity:.15,radius:5},Rb={fill:"#5B8FF9",opacity:.3,cursor:"grab"},Gy=2,Gg={width:Gy,height:24},Cd={textBaseline:"middle",fill:"#000",opacity:.45},dE={textAlign:"center",textBaseline:"top",fill:"#607889",opacity:.35},Mh={lineWidth:1,stroke:"#ccc"},Ql=function(){function c(a){var e=this;this.prevX=0,this.onMouseDown=function(hi){return function(di){e.currentHandler=hi;var Xi=di.originalEvent;Xi.stopPropagation(),Xi.preventDefault(),e.prevX=(0,k.get)(Xi,"touches.0.pageX",Xi.pageX);var go=e.canvas.get("container");go.addEventListener("mousemove",e.onMouseMove),go.addEventListener("mouseup",e.onMouseUp),go.addEventListener("mouseleave",e.onMouseUp),go.addEventListener("touchmove",e.onMouseMove),go.addEventListener("touchend",e.onMouseUp),go.addEventListener("touchcancel",e.onMouseUp)}},this.onMouseMove=function(hi){hi.stopPropagation(),hi.preventDefault();var di=(0,k.get)(hi,"touches.0.pageX",hi.pageX),Xi=di-e.prevX,go=e.adjustOffsetRange(Xi/e.width);e.updateStartEnd(go),e.updateUI(),e.prevX=di},this.onMouseUp=function(){e.currentHandler&&(e.currentHandler=void 0);var hi=e.canvas.get("container");hi&&(hi.removeEventListener("mousemove",e.onMouseMove),hi.removeEventListener("mouseup",e.onMouseUp),hi.removeEventListener("mouseleave",e.onMouseUp),hi.removeEventListener("touchmove",e.onMouseMove),hi.removeEventListener("touchend",e.onMouseUp),hi.removeEventListener("touchcancel",e.onMouseUp))};var i=a.x,s=i===void 0?0:i,l=a.y,f=l===void 0?0:l,d=a.width,v=d===void 0?100:d,x=a.height,w=a.padding,I=w===void 0?10:w,G=a.trendCfg,U=a.controllerCfg,et=U===void 0?{speed:1}:U,ft=a.backgroundStyle,Ct=ft===void 0?{}:ft,Mt=a.foregroundStyle,kt=Mt===void 0?{}:Mt,$t=a.handlerStyle,Jt=$t===void 0?{}:$t,Ce=a.textStyle,je=Ce===void 0?{}:Ce,ze=a.start,pn=ze===void 0?0:ze,Fn=a.end,Tn=Fn===void 0?1:Fn,cr=a.minText,kr=cr===void 0?"":cr,Aa=a.maxText,ci=Aa===void 0?"":Aa,ei=a.group,Ca=a.graph,Pi=a.canvas,Ni=a.tick,_a=Ni===void 0?{tickLabelStyle:{},tickLineStyle:{},tickLabelFormatter:function(di){return di},ticks:[]}:Ni,Ya=a.type;this.graph=Ca,this.canvas=Pi,this.group=ei,this.timeBarType=Ya,this.x=s,this.y=f,this.width=v,this.height=x,this.padding=I,this.ticks=_a.ticks,this.trendCfg=G,this.controllerCfg=et,this.currentSpeed=et.speed||1,this.tickLabelFormatter=_a.tickLabelFormatter,Ya==="trend"?this.backgroundStyle=Yu(Yu({},Kr),Ct):Ya==="simple"&&(this.backgroundStyle=Yu(Yu({},Xs),Ct)),this.foregroundStyle=Yu(Yu({},Rb),kt),this.handlerStyle=Yu(Yu({},Gg),Jt),this.textStyle=Yu(Yu({},Cd),je),this.tickLabelStyle=Yu(Yu({},dE),_a.tickLabelStyle),this.tickLineStyle=Yu(Yu({},Mh),_a.tickLineStyle),this.currentMode=et.defaultTimeType||od.RANGE,this.start=pn,this.end=Tn,this.minText=kr,this.maxText=ci,this.fontFamily=typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlider()}return c.prototype.update=function(a){var e=a.x,i=a.y,s=a.width,l=a.height,f=a.minText,d=a.maxText,v=a.start,x=a.end;this.start=Math.min(1,Math.max(v,0)),this.end=Math.min(1,Math.max(x,0)),(0,k.assign)(this,{x:e,y:i,width:s,height:l,minText:f,maxText:d}),this.updateUI()},c.prototype.setText=function(a,e){this.minTextShape.attr("text",a),this.maxTextShape.attr("text",e)},c.prototype.renderSlider=function(){var a=this,e=this,i=e.width,s=e.height,l=e.timeBarType;if(l==="trend"&&(0,k.size)((0,k.get)(this.trendCfg,"data"))){var f=new K_(Yu(Yu({x:this.x,y:this.y,width:i,height:s},this.trendCfg),{group:this.group}));this.trendComponent=f}var d=this.group.addGroup({name:"slider-group"});d.addShape("rect",{attrs:Yu({x:0,y:0,width:i,height:s},this.backgroundStyle),name:"background"});var v=this.group.addGroup();l==="trend"?(this.minTextShape=v.addShape("text",{attrs:Yu({x:0,y:s/2+this.y,textAlign:"right",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"min-text-shape"}),this.maxTextShape=v.addShape("text",{attrs:Yu({y:s/2+this.y,textAlign:"left",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"max-text-shape"})):(this.minTextShape=v.addShape("text",{attrs:Yu({x:0,y:this.y-10,textAlign:"center",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"min-text-shape"}),this.maxTextShape=v.addShape("text",{attrs:Yu({y:this.y-10,textAlign:"center",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"max-text-shape"})),this.foregroundShape=this.group.addGroup().addShape("rect",{attrs:Yu({x:0,y:this.y,height:s},this.foregroundStyle),name:"foreground-shape"}),this.foregroundShape.on("mousedown",function(Mt){Mt.target.attr("cursor","grabbing")}),this.foregroundShape.on("mouseup",function(Mt){Mt.target.attr("cursor",a.foregroundStyle.cursor||"grab")});var x=(0,k.get)(this.handlerStyle,"width",2),w=(0,k.get)(this.handlerStyle,"height",24),I=this.group.addGroup({name:"minHandlerShape"});this.minHandlerShape=new Qd({name:"minHandlerShape",group:I,type:l,x:this.x,y:this.y,width:x,height:w,style:this.handlerStyle});var G=this.group.addGroup({name:"maxHandlerShape"});this.maxHandlerShape=new Qd({name:"maxHandlerShape",group:G,type:l,x:this.x,y:this.y,width:x,height:w,style:this.handlerStyle});var U=this.ticks,et=i/(U.length-1);this.tickPosList=[],this.textList&&this.textList.length&&this.textList.forEach(function(Mt){Mt.destroy()});var ft=-Infinity,Ct=this.tickLabelStyle.rotate;delete this.tickLabelStyle.rotate,this.textList=U.map(function(Mt,kt){a.tickPosList.push(a.x+kt*et);var $t;a.tickLabelFormatter?($t=a.tickLabelFormatter(Mt),!(0,k.isString)($t)&&$t&&($t=Mt.date)):$t=Mt.date;var Jt=a.x+kt*et,Ce=a.y+s+5,je=a.group.addShape("text",{attrs:Yu({x:Jt,y:Ce,text:$t,fontFamily:a.fontFamily||"Arial, sans-serif"},a.tickLabelStyle),name:"tick-label"});if((0,k.isNumber)(Ct)&&kt!==U.length-1){var ze=Jd([1,0,0,0,1,0,0,0,1],[["t",-Jt,-Ce],["r",Ct],["t",Jt-5,Ce+2]]);je.attr({textAlign:"left",matrix:ze})}kt===0?je.attr({textAlign:"left"}):kt!==U.length-1&&je.attr({textAlign:"right"});var pn=a.group.addShape("line",{attrs:Yu({x1:a.x+kt*et,y1:a.y+s+2,x2:a.x+kt*et,y2:a.y+s+6},a.tickLineStyle),name:"tick-line"});pn.toBack();var Fn=je.getBBox();return Fn.minX>ft?(je.show(),pn.show(),ft=Fn.minX+Fn.width+10):(je.hide(),pn.hide()),je}),this.controllerBtnGroup=new Ay(Yu({group:this.group,x:this.x,y:this.y+s+25,width:i,height:35},this.controllerCfg)),this.updateStartEnd(0),this.updateUI(),d.move(this.x,this.y),this.bindEvents(),this.currentMode===od.SINGLE&&(this.minHandlerShape.hide(),this.foregroundShape.hide(),this.minTextShape.hide())},c.prototype.bindEvents=function(){var a=this,e=this.group.find(function(s){return s.get("name")==="minHandlerShape"});e&&(e.on("minHandlerShape-handler:mousedown",this.onMouseDown(this.minHandlerShape)),e.on("minHandlerShape-handler:touchstart",this.onMouseDown(this.minHandlerShape)));var i=this.group.find(function(s){return s.get("name")==="maxHandlerShape"});i&&(i.on("maxHandlerShape-handler:mousedown",this.onMouseDown(this.maxHandlerShape)),i.on("maxHandlerShape-handler:touchstart",this.onMouseDown(this.maxHandlerShape))),this.foregroundShape.on("mousedown",this.onMouseDown(this.foregroundShape)),this.foregroundShape.on("touchstart",this.onMouseDown(this.foregroundShape)),this.group.on("".concat(hg,":click"),function(){a.isPlay=!a.isPlay,a.currentHandler=a.maxHandlerShape,a.changePlayStatus()}),this.group.on("".concat(p0,":click"),function(){a.currentHandler=a.maxHandlerShape,a.updateStartEnd(.01),a.updateUI()}),this.group.on("".concat(v0,":click"),function(){a.currentHandler=a.maxHandlerShape,a.updateStartEnd(-.01),a.updateUI()}),this.group.on(Rg,function(s){var l=s.type,f=s.speed;a.currentSpeed=f,a.currentMode=l,l===od.SINGLE?(a.minHandlerShape.hide(),a.foregroundShape.hide(),a.minTextShape.hide()):l===od.RANGE&&(a.minHandlerShape.show(),a.foregroundShape.show(),a.minTextShape.show())})},c.prototype.adjustTickIndex=function(a){for(var e=0;e<this.tickPosList.length-1;e++)if(this.tickPosList[e]<=a&&a<=this.tickPosList[e+1])return Math.abs(this.tickPosList[e]-a)<Math.abs(a-this.tickPosList[e+1])?e:e+1;return 0},c.prototype.adjustOffsetRange=function(a){switch(this.currentHandler){case this.minHandlerShape:{var e=0-this.start,i=1-this.start;return Math.min(i,Math.max(e,a))}case this.maxHandlerShape:{var e=0-this.end,i=1-this.end;return Math.min(i,Math.max(e,a))}case this.foregroundShape:{var e=0-this.start,i=1-this.end;return Math.min(i,Math.max(e,a))}default:return 0}},c.prototype.updateStartEnd=function(a){var e=this.ticks[this.adjustTickIndex(this.start*this.width)],i=this.ticks[this.adjustTickIndex(this.end*this.width)];if(!this.currentHandler){this.minText=this.tickLabelFormatter?this.tickLabelFormatter(e):e==null?void 0:e.date,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(i):i==null?void 0:i.date;return}switch(this.currentHandler){case this.minHandlerShape:this.maxText=this.maxTextShape.attr("text"),this.start+=a,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(e):e.date;break;case this.maxHandlerShape:this.minText=this.minTextShape.attr("text"),this.end+=a,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(i):i.date;break;case this.foregroundShape:this.start+=a,this.end+=a,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(e):e.date,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(i):i.date;break;default:break}},c.prototype.updateUI=function(){var a=this;this.start<0&&(this.start=0),this.start>1&&(this.start=1),this.end>1&&(this.end=1),this.end<0&&(this.end=0);var e=this.x+this.start*this.width,i=this.x+this.end*this.width;this.foregroundShape.attr("x",e),this.foregroundShape.attr("width",i-e);var s=(0,k.get)(this.handlerStyle,"width",Gy);this.setText(this.minText,this.maxText);var l=this.dodgeText([e,i]),f=l[0],d=l[1];this.minHandlerShape.setX(e-s/2),(0,k.each)(f,function(v,x){return a.minTextShape.attr(x,v)}),this.maxHandlerShape.setX(i-s/2),(0,k.each)(d,function(v,x){return a.maxTextShape.attr(x,v)}),this.currentMode===od.RANGE?this.graph.emit(gv,{value:[this.start,this.end].sort()}):this.currentMode===od.SINGLE&&this.graph.emit(gv,{value:[this.end,this.end]})},c.prototype.dodgeText=function(a){var e,i,s=2,l=(0,k.get)(this.handlerStyle,"width",Gy),f=this.minTextShape,d=this.maxTextShape,v=a[0],x=a[1],w=!1;v>x&&(e=[x,v],v=e[0],x=e[1],i=[d,f],f=i[0],d=i[1],w=!0);var I=f.getBBox(),G=d.getBBox(),U=null,et=null;return this.timeBarType==="trend"?(U=v-I.width<this.x+s?{x:v+l/2+s,textAlign:"left"}:{x:v-l/2-s,textAlign:"right"},et=x+G.width>this.x+this.width?{x:x-l/2-s,textAlign:"right"}:{x:x+l/2+s,textAlign:"left"}):this.timeBarType==="simple"&&(U=f.attr("x")>I.width?{x:v,textAlign:"center"}:{x:v,textAlign:"left"},et=d.attr("x")>this.width-G.width?{x,textAlign:"right"}:{x,textAlign:"center"}),w?[et,U]:[U,et]},c.prototype.startPlay=function(){var a=this;return typeof window!="undefined"?window.requestAnimationFrame(function(){var e=a,i=e.ticks,s=e.width,l=a.currentSpeed,f=s/i.length,d=f/((10-l)*1e3/60),v=a.adjustOffsetRange(d/a.width);a.updateStartEnd(v),a.updateUI(),a.isPlay&&(a.playHandler=a.startPlay())}):void 0},c.prototype.changePlayStatus=function(a){a===void 0&&(a=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit(kw,null)):this.playHandler&&(typeof window!="undefined"&&window.cancelAnimationFrame(this.playHandler),a&&this.graph.emit(Dw,null))},c.prototype.destory=function(){this.graph.off(gv,function(){});var a=this.group,e=a.find(function(s){return s.get("name")==="minHandlerShape"});e&&(e.off("minHandlerShape-handler:mousedown"),e.off("minHandlerShape-handler:touchstart"),e.destroy());var i=a.find(function(s){return s.get("name")==="maxHandlerShape"});i&&(i.off("maxHandlerShape-handler:mousedown"),i.off("maxHandlerShape-handler:touchstart"),i.destroy()),this.foregroundShape.off("mousedown"),this.foregroundShape.off("touchstart"),this.foregroundShape.destroy(),a.off("".concat(hg,":click")),a.off("".concat(p0,":click")),a.off("".concat(v0,":click")),a.off(Rg),a.destroy(),this.trendComponent&&this.trendComponent.destory()},c}(),LA=Ql,jv=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Nh=function(){return Nh=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},Nh.apply(this,arguments)},tp=function(c,a){var e={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&a.indexOf(i)<0&&(e[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(c);s<i.length;s++)a.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(c,i[s])&&(e[i[s]]=c[i[s]]);return e},Lb=4,Pb=26,S0=function(c){jv(a,c);function a(e){var i=c.call(this,e)||this;return i.afterrenderListener=function(s){return i.filterData({})},i.valueChangeListener=(0,k.throttle)(function(s){return i.filterData(s)},200,{trailing:!0,leading:!0}),i.changeData=function(s){var l=i.get("graph");i.cacheGraphData=l.get("data"),i.filterData({})},i}return a.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-component-timebar",padding:10,type:"trend",trend:{data:[],isArea:!1,smooth:!0},controllerCfg:{speed:1,loop:!1},slider:{start:.1,end:.9,minText:"min",maxText:"max"},tick:{start:.1,end:.9,data:[]},textStyle:{},filterEdge:!1,filterItemTypes:["node"],containerCSS:{},putInGraphContainer:!0}},a.prototype.initContainer=function(){var e=this.get("graph"),i=this._cfgs,s=i.width,l=i.height,f=i.putInGraphContainer,d=this.get("className")||"g6-component-timebar",v=this.get("container"),x;if(v?((0,k.isString)(v)&&(v=document.getElementById(v)),x=v):(x=ql("<div class='".concat(d,"'></div>")),ru(x,{position:"relative"})),f){var w=this.get("graph").get("container");w.appendChild(x)}this.set("timeBarContainer",x);var I,G=e.get("renderer");G==="SVG"?I=new Rp({container:x,width:s,height:l}):I=new $v({container:x,width:s,height:l}),this.get("containerCSS")&&ru(x,this.get("containerCSS")),this.set("canvas",I)},a.prototype.init=function(){this.initContainer();var e=this.get("canvas"),i=e.addGroup({name:"timebar-group"});this.set("timeBarGroup",i),this.renderTrend(),this.initEvent();var s=typeof window!="undefined"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif";this.set("fontFamily",s)},a.prototype.play=function(){this.togglePlay(!0)},a.prototype.pause=function(){this.togglePlay(!1)},a.prototype.togglePlay=function(e){var i=this.get("timebar");!i||(i.isPlay=!!e,i.changePlayStatus())},a.prototype.renderTrend=function(){var e=this,i=this._cfgs,s=i.width,l=i.x,f=i.y,d=i.padding,v=i.type,x=i.trend,w=i.slider,I=i.controllerCfg,G=i.textStyle,U=i.tick,et=i.backgroundStyle,ft=i.foregroundStyle,Ct=x.data,Mt=tp(x,["data"]),kt=s-2*d,$t=v==="trend"?Pb:Lb,Jt=this.get("graph"),Ce=this.get("timeBarGroup"),je=this.get("canvas"),ze=null;if(v==="trend"||v==="simple"){var pn=this.get("getValue");ze=new LA(Nh(Nh({graph:Jt,canvas:je,group:Ce,type:v,x:l+d,y:v==="trend"?f+d:f+d+15,width:kt,height:$t,padding:d,backgroundStyle:et,foregroundStyle:ft,trendCfg:Nh(Nh({},Mt),{data:Ct.map(function(Tn){return(pn==null?void 0:pn(Tn))||Tn.value})})},w),{tick:{ticks:Ct,tickLabelFormatter:U.tickLabelFormatter,tickLabelStyle:U.tickLabelStyle,tickLineStyle:U.tickLineStyle},handlerStyle:Nh(Nh({},w.handlerStyle),{height:w.height||$t}),controllerCfg:I,textStyle:G}))}else v==="tick"&&(ze=new wb(Nh({graph:Jt,canvas:je,group:Ce,x:l+d,y:f+d,width:s,height:42,padding:2,controllerCfg:I},U)));var Fn=function Tn(){var cr=e.get("timebar");cr.draggingHandler=!1,cr.isPlay&&(cr.isPlay=!1,cr.currentHandler=cr.maxHandlerShape,cr.changePlayStatus()),document.removeEventListener("mouseup",Tn)};je.on("mousedown",function(Tn){(Tn.target.get("name")==="maxHandlerShape-handler"||Tn.target.get("name")==="minHandlerShape-handler"||Tn.target===ze.foregroundShape)&&document.addEventListener("mouseup",Fn)}),this.set("timebar",ze)},a.prototype.filterData=function(e){var i,s=e.value;if(!s){s=[];var l=this._cfgs.type;!l||l==="trend"||l==="simple"?(s[0]=this._cfgs.slider.start,s[1]=this._cfgs.slider.end):l==="tick"&&(s[0]=this._cfgs.tick.start,s[1]=this._cfgs.tick.end)}var f=null,d=this._cfgs.type;if(d==="trend"||d==="simple"?f=this._cfgs.trend.data:d==="tick"&&(f=this._cfgs.tick.data),!f||f.length===0){console.warn("\u8BF7\u914D\u7F6E TimeBar \u7EC4\u4EF6\u7684\u6570\u636E");return}var v=this.get("rangeChange"),x=this.get("graph"),w=Math.round(f.length*s[0]),I=Math.round(f.length*s[1]);I=I>=f.length?f.length-1:I,w=w>=f.length?f.length-1:w;var G=(i=this._cfgs.tick)===null||i===void 0?void 0:i.tickLabelFormatter,U=G?G(f[w]):f[w].date,et=G?G(f[I]):f[I].date;if(d!=="tick"){var ft=this.get("timebar");ft.setText(U,et)}if(v)v(x,U,et);else{(!this.cacheGraphData||this.cacheGraphData.nodes&&this.cacheGraphData.nodes.length===0)&&(this.cacheGraphData=x.get("data"));var Ct=this.get("filterItemTypes"),Mt=this.get("changeData"),kt=this.get("getDate"),$t=this.get("shouldIgnore"),Jt=f[w].date,Ce=f[I].date;if(Mt||Mt===void 0){var je=this.cacheGraphData.nodes,ze=this.cacheGraphData.edges,pn={},Fn={};x.getNodes().forEach(function(Tn){return pn[Tn.getID()]=!0}),x.getEdges().forEach(function(Tn){return Fn[Tn.getID()]=!0}),Ct.includes("node")&&(je==null||je.forEach(function(Tn){var cr=+((kt==null?void 0:kt(Tn))||Tn.date),kr=cr>=Jt&&cr<=Ce||($t==null?void 0:$t("node",Tn,{min:Jt,max:Ce})),Aa=pn[Tn.id];Aa&&!kr?(x.removeItem(Tn.id),pn[Tn.id]=!1):!Aa&&kr&&(x.addItem("node",Tn),pn[Tn.id]=!0)}),ze==null||ze.forEach(function(Tn){var cr=pn[Tn.source]&&pn[Tn.target]||($t==null?void 0:$t("edge",Tn,{min:Jt,max:Ce})),kr=!!x.findById(Tn.id);kr&&!cr?(x.removeItem(Tn.id),Fn[Tn.id]=!1):!kr&&cr?(x.addItem("edge",Tn),Fn[Tn.id]=!0):kr||(Fn[Tn.id]=!1)})),(this.get("filterEdge")||Ct.includes("edge"))&&(ze==null||ze.filter(function(Tn){var cr=+((kt==null?void 0:kt(Tn))||Tn.date),kr=cr>=Jt&&cr<=Ce||($t==null?void 0:$t("edge",Tn,{min:Jt,max:Ce})),Aa=pn[Tn.source]&&pn[Tn.target],ci=kr&&Aa,ei=Fn[Tn.id];ei&&!ci?(Fn[Tn.id]=!1,x.removeItem(Tn.id)):!ei&&ci&&(Fn[Tn.id]=!0,x.addItem("edge",Tn))}))}else Ct.includes("node")&&x.getNodes().forEach(function(Tn){var cr=Tn.getModel();if(!($t==null?void 0:$t("node",cr,{min:Jt,max:Ce}))){var kr=+((kt==null?void 0:kt(cr))||cr.date);kr<Jt||kr>Ce?x.hideItem(Tn):x.showItem(Tn)}}),(this.get("filterEdge")||Ct.includes("edge"))&&x.getEdges().forEach(function(Tn){var cr=Tn.getModel();if(!($t==null?void 0:$t("edge",cr,{min:f[w].date,max:f[I].date}))){var kr=+((kt==null?void 0:kt(cr))||cr.date);if(kr<f[w].date||kr>f[I].date)x.hideItem(Tn);else{var Aa=Tn.getSource().isVisible(),ci=Tn.getTarget().isVisible();Aa&&ci&&x.showItem(Tn)}}})}},a.prototype.initEvent=function(){var e=this.get("graph");e.on("afterchangedata",this.changeData),e.on("afterrender",this.afterrenderListener),e.on(gv,this.valueChangeListener)},a.prototype.destroy=function(){var e=this.get("graph");e.off("afterchangedata",this.changeData),e.off("afterrender",this.afterrenderListener),e.off(gv,this.valueChangeListener);var i=this.get("timebar");i&&i.destory&&i.destory(),c.prototype.destroy.call(this);var s=this.get("timeBarContainer");if(s){var l=this.get("container");l||(l=this.get("graph").get("container")),(0,k.isString)(l)&&(l=document.getElementById(l)),l===s&&(l=l.parentElement),l.removeChild(s)}},a}(id),Z_=S0,Uy=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),PA=Sc.applyMatrix;function FA(c,a){var e,i;if(c.naturalWidth)e=c.naturalWidth,i=c.naturalHeight;else{var s=new Image;s.src=c.src,s.onload=function(){a&&a(s.width,s.height)}}return[e,i]}var vg=function(c){Uy(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",width:200,delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0}},a.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},a.prototype.disableRefresh=function(){this.set("refresh",!1)},a.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},a.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},a.prototype.initViewport=function(){var e=this,i=this._cfgs,s=i.graph;if(!this.destroyed){var l=this.get("container");(0,k.isString)(l)&&(l=document.getElementById(l));var f=ql("<div class=".concat(i.viewportClassName,`
      style='position:absolute;
        left:0;
        top:0;
        box-sizing:border-box;
        border: 2px solid #1980ff;
        cursor:move'
      </div>`)),d=0,v=0,x=!1,w=0,I=0,G=0,U=0,et=0,ft=0;l.addEventListener("mousedown",function(Ct){if(i.refresh=!1,Ct.target===f){var Mt=f.style;G=parseInt(Mt.width,10),U=parseInt(Mt.height,10);var kt=e.get("width"),$t=e.get("height");G>kt||U>$t||(ft=s.getZoom(),et=e.get("ratio"),x=!0,d=Ct.clientX,v=Ct.clientY)}},!1),l.addEventListener("mousemove",function(Ct){if(!(!x||(0,k.isNil)(Ct.clientX)||(0,k.isNil)(Ct.clientY))){var Mt=e.get("width"),kt=e.get("height"),$t=f.style;w=parseInt($t.left,10),I=parseInt($t.top,10),G=parseInt($t.width,10),U=parseInt($t.height,10);var Jt=d-Ct.clientX,Ce=v-Ct.clientY;w-Jt<0?Jt=w:w-Jt+G>=Mt&&(Jt=0),I-Ce<0?Ce=I:I-Ce+U>=kt&&(Ce=0),w-=Jt,I-=Ce,ru(f,{left:"".concat(w,"px"),top:"".concat(I,"px")}),s.translate(Jt*ft/et,Ce*ft/et),d=Ct.clientX,v=Ct.clientY}},!1),l.addEventListener("mouseleave",function(){x=!1,i.refresh=!0},!1),l.addEventListener("mouseup",function(){x=!1,i.refresh=!0},!1),this.set("viewport",f),l.appendChild(f)}},a.prototype.updateViewport=function(){if(!this.destroyed){var e=this.get("ratio"),i=this.get("width"),s=this.get("height"),l=this.get("graph"),f=l.get("width"),d=l.get("height"),v=f/d,x=l.getGroup(),w=x.getCanvasBBox(),I=[(w.minX+w.maxX)/2,(w.minY+w.maxY)/2],G=[w.maxX-w.minX,w.maxY-w.minY],U={centerX:I[0],centerY:I[1],width:0,height:0,minX:0,minY:0};w[0]/w[1]>v?(U.width=G[0],U.height=U.width/v):(U.height=G[1],U.width=U.height*v),U.minX=I[0]-U.width/2,U.minY=I[1]-U.height/2;var et=x.getMatrix();et||(et=[1,0,0,0,1,0,0,0,1]);var ft=pt.invert([1,0,0,0,1,0,0,0,1],et),Ct=PA({x:U.minX,y:U.minY},ft),Mt=l.getCanvasByPoint(Ct.x,Ct.y),kt=this.get("viewport");kt||this.initViewport();var $t=f/U.width,Jt=$t*i,Ce=$t*s,je=i*-Mt.x/U.width,ze=s*-Mt.y/U.height,pn=je+Jt,Fn=ze+Ce;je<0&&(Jt+=je,je=0),pn>i&&(Jt=Jt-(pn-i)),ze<0&&(Ce+=ze,ze=0),Fn>s&&(Ce=Ce-(Fn-s)),this.set("ratio",e);var Tn="".concat(je,"px"),cr="".concat(ze,"px");ru(kt,{left:Tn,top:cr,width:"".concat(Jt,"px"),height:"".concat(Ce,"px")})}},a.prototype.init=function(){this.initContainer()},a.prototype.initContainer=function(){var e=this,i=e.get("graph"),s=i.get("width"),l=i.get("height"),f=l/s,d=e.get("className"),v=e.get("container"),x=e.get("width"),w=e.get("height");!x&&!w&&(x=200),x?(w=f*x,e.set("height",w)):(x=1/f*w,e.set("width",x));var I=ql("<div class='".concat(d,"' style='width: ").concat(x,"px; height: ").concat(w,"px; overflow: hidden; position: relative;'></div>"));(0,k.isString)(v)&&(v=document.getElementById(v)),v?v.appendChild(I):i.get("container").appendChild(I),e.set("container",I);var G=ql('<div class="g6-minimap-container" style="position: relative; width: 100%; height: 100%; text-align: center; display: table;"></div>');I.appendChild(G);var U=ql('<span style="display: table-cell; vertical-align: middle; "></span>');G.appendChild(U),e.set("containerDOM",G),e.set("containerSpan",U);var et=ql('<img alt="" src="'.concat(this.get("graphImg"),'" style="display: inline-block; user-select: none;" draggable="false" />'));e.set("imgDOM",et),e.updateImgSize(),U.appendChild(et),e.updateCanvas()},a.prototype.updateImgSize=function(){var e=this,i=e.get("imgDOM"),s=e.get("width"),l=e.get("height");i.onload=function(){var f=FA(i);f[0]>f[1]?i.width=s:i.height=l}},a.prototype.updateCanvas=function(){var e=this.get("refresh");if(!!e){var i=this.get("graph");if(!i.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var s=this.get("width"),l=i.get("canvas").getCanvasBBox(),f=l.width,d=s/f;this.set("ratio",d),this.updateViewport()}}},a.prototype.getViewport=function(){return this.get("viewport")},a.prototype.getContainer=function(){return this.get("container")},a.prototype.updateGraphImg=function(e){var i=this,s=i.get("imgDOM");s.remove(),i.set("graphImg",e);var l=ql('<img alt="" src="'.concat(e,'" style="display: inline-block;" ondragstart="return false;" onselectstart="return false;"/>'));i.set("imgDOM",l),l.src=e,i.updateImgSize();var f=i.get("containerSpan");f.appendChild(l),i.updateCanvas()},a.prototype.destroy=function(){var e=this.get("container");e.parentNode.removeChild(e)},a}(id),q_=vg,Ug=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),C0=function(){return C0=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},C0.apply(this,arguments)},bf=Sc.distance,Fb=.05,pE={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:1,fill:"#fff"},vE=function(c){Ug(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{type:"both",trigger:"mousemove",r:60,delegateStyle:(0,k.clone)(pE),showLabel:"edge",scaleRBy:"wheel"}},a.prototype.getEvents=function(){var e;switch(this.get("trigger")){case"click":e={click:"filter"};break;case"drag":e={click:"createDelegate"};break;default:e={mousemove:"filter"};break}return e},a.prototype.init=function(){var e=this,i=e.get("showLabel"),s=i==="node"||i==="both",l=i==="edge"||i==="both";e.set("showNodeLabel",s),e.set("showEdgeLabel",l);var f=e.get("shouldShow");f||e.set("shouldShow",function(){return!0})},a.prototype.createDelegate=function(e){var i=this,s=i.get("delegate");(!s||s.destroyed)&&(i.filter(e),s=i.get("delegate"),s.on("dragstart",function(l){}),s.on("drag",function(l){i.filter(l)}),this.get("scaleRBy")==="wheel"&&s.on("mousewheel",function(l){i.scaleRByWheel(l)}))},a.prototype.scaleRByWheel=function(e){var i=this;if(!(!e||!e.originalEvent)){e.preventDefault&&e.preventDefault();var s=i.get("graph"),l,f=i.get("delegate"),d=f?{x:f.attr("x"),y:f.attr("y")}:void 0,v=d||s.getPointByClient(e.clientX,e.clientY);e.originalEvent.wheelDelta<0?l=1-Fb:l=1/(1-Fb);var x=i.get("maxR"),w=i.get("minR"),I=i.get("r");(I>(x||s.get("height"))&&l>1||I<(w||s.get("height")*.05)&&l<1)&&(l=1),I*=l,i.set("r",I),i.filter(e)}},a.prototype.filter=function(e){var i=this,s=i.get("graph"),l=s.getNodes(),f={},d=i.get("r"),v=i.get("type"),x={x:e.x,y:e.y};i.updateDelegate(x,d);var w=i.get("shouldShow"),I=i.get("vShapes");I&&I.forEach(function(Mt){Mt.remove(),Mt.destroy()}),I=[],l.forEach(function(Mt){var kt=Mt.getModel(),$t=kt.x,Jt=kt.y;bf({x:$t,y:Jt},x)<d&&(f[kt.id]=Mt)});var G=s.getEdges(),U=[];G.forEach(function(Mt){var kt=Mt.getModel(),$t=kt.source,Jt=kt.target;w(kt)&&(v==="only-source"||v==="one"?f[$t]&&!f[Jt]&&U.push(Mt):v==="only-target"||v==="one"?f[Jt]&&!f[$t]&&U.push(Mt):v==="both"&&f[$t]&&f[Jt]&&U.push(Mt))});var et=i.get("showNodeLabel"),ft=i.get("showEdgelabel"),Ct=s.get("group");U.forEach(function(Mt){var kt=Mt.get("group").get("children");kt.forEach(function($t){var Jt=$t.get("type"),Ce=Ct.addShape(Jt,{attrs:$t.attr()});I.push(Ce),et&&Jt==="text"&&Ce.set("visible",!0)})}),Object.keys(f).forEach(function(Mt){var kt=f[Mt],$t=kt.get("group").clone();if(Ct.add($t),I.push($t),ft)for(var Jt=$t.get("children"),Ce=0;Ce<Jt.length;Ce++){var je=Jt[Ce];je.get("type")==="text"&&je.set("visible",!0)}}),i.set("vShapes",I)},a.prototype.updateParams=function(e){var i=this,s=e.r,l=e.trigger,f=e.minR,d=e.maxR,v=e.scaleRBy,x=e.showLabel,w=e.shouldShow;if(isNaN(e.r)||i.set("r",s),isNaN(d)||i.set("maxR",d),isNaN(f)||i.set("minR",f),(l==="mousemove"||l==="click")&&i.set("trigger",l),v==="wheel"||v==="unset"){i.set("scaleRBy",v),i.get("delegate").remove(),i.get("delegate").destroy();var I=i.get("dPercentText");I&&(I.remove(),I.destroy())}(x==="node"||x==="both")&&i.set("showNodeLabel",!0),(x==="edge"||x==="both")&&i.set("showEdgeLabel",!0),w&&i.set("shouldShow",w)},a.prototype.updateDelegate=function(e,i){var s=this,l=s.get("graph"),f=s.get("delegate");if(!f||f.destroyed){var d=l.get("group"),v=s.get("delegateStyle")||pE;f=d.addShape("circle",{attrs:C0({r:i,x:e.x,y:e.y},v),name:"lens-shape",draggable:!0}),this.get("trigger")!=="drag"&&this.get("scaleRBy")==="wheel"&&f.on("mousewheel",function(x){s.scaleRByWheel(x)})}else f.attr({x:e.x,y:e.y,r:i});s.set("delegate",f)},a.prototype.clear=function(){var e=this,i=e.get("vShapes");i&&i.forEach(function(l){l.remove(),l.destroy()}),i=[],e.set("vShapes",i);var s=e.get("delegate");s&&!s.destroyed&&(s.remove(),s.destroy())},a.prototype.destroy=function(){this.clear()},a}(id),BA=vE,Bb=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),_0=Sc.pointLineDistance,zb={stroke:"#FA8C16",lineWidth:1},$b=function(c){Bb(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{line:zb,itemAlignType:"center",tolerance:5,horizontalLines:{},verticalLines:{},alignLines:[]}},a.prototype.init=function(){},a.prototype.getEvents=function(){return{"node:dragstart":"onDragStart","node:drag":"onDrag","node:dragend":"onDragEnd"}},a.prototype.onDragStart=function(){this.initBoxLine()},a.prototype.onDrag=function(e){var i=e.item,s=i.get("delegateShape")||i,l=s.getBBox(),f=i.getModel(),d=f.x-l.x,v=f.y-l.y;this.show({x:l.minX+d,y:l.minY+v},{width:l.width,height:l.height})},a.prototype.onDragEnd=function(){this.destory()},a.prototype.initBoxLine=function(){var e=this._cfgs,i=e.horizontalLines,s=e.verticalLines,l=e.itemAlignType,f=this.get("graph"),d=f.getNodes();d.forEach(function(v){var x=v.getBBox(),w=v.get("id");l===!0||l==="horizontal"?(i["".concat(w,"tltr")]=[x.minX,x.minY,x.maxX,x.minY,v],i["".concat(w,"lcrc")]=[x.minX,x.centerY,x.maxX,x.centerY,v],i["".concat(w,"blbr")]=[x.minX,x.maxY,x.maxX,x.maxY,v]):l==="center"&&(i["".concat(w,"lcrc")]=[x.minX,x.centerY,x.maxX,x.centerY,v]),l===!0||l==="vertical"?(s["".concat(w,"tlbl")]=[x.minX,x.minY,x.minX,x.maxY,v],s["".concat(w,"tcbc")]=[x.centerX,x.minY,x.centerX,x.maxY,v],s["".concat(w,"trbr")]=[x.maxX,x.minY,x.maxX,x.maxY,v]):l==="center"&&(s["".concat(w,"tcbc")]=[x.centerX,x.minY,x.centerX,x.maxY,v])})},a.prototype.show=function(e,i){var s=(0,k.mix)({},e);return this.itemAlign(e,i,s),e},a.prototype.itemAlign=function(e,i,s){var l=this,f=this._cfgs,d=f.horizontalLines,v=f.verticalLines,x=f.tolerance,w={x:s.x+i.width/2,y:s.y},I={x:s.x+i.width/2,y:s.y+i.height/2},G={x:s.x+i.width/2,y:s.y+i.height},U={x:s.x,y:s.y+i.height/2},et={x:s.x+i.width,y:s.y+i.height/2},ft=[],Ct=[],Mt=null;if(this.clearAlignLine(),(0,k.each)(d,function($t){$t[4].isVisible&&(ft.push(l.getLineDisObject($t,w)),ft.push(l.getLineDisObject($t,I)),ft.push(l.getLineDisObject($t,G)))}),(0,k.each)(v,function($t){$t[4].isVisible&&(Ct.push(l.getLineDisObject($t,U)),Ct.push(l.getLineDisObject($t,I)),Ct.push(l.getLineDisObject($t,et)))}),ft.sort(function($t,Jt){return $t.dis-Jt.dis}),Ct.sort(function($t,Jt){return $t.dis-Jt.dis}),ft.length!==0&&ft[0].dis<x){e.y=ft[0].line[1]-ft[0].point.y+s.y,Mt={type:"item",horizontals:[ft[0]]};for(var kt=1;kt<3;kt++)ft[0].dis===ft[kt].dis&&Mt.horizontals.push(ft[kt])}if(Ct.length!==0&&Ct[0].dis<x){e.x=Ct[0].line[0]-Ct[0].point.x+s.x,Mt?Mt.verticals=[Ct[0]]:Mt={type:"item",verticals:[Ct[0]]};for(var kt=1;kt<3;kt++)Ct[0].dis===Ct[kt].dis&&Mt.verticals.push(Ct[kt])}Mt&&(Mt.bbox=i,this.addAlignLine(Mt))},a.prototype.addAlignLine=function(e){var i=e.bbox,s=e.type,l=e.horizontals,f=e.verticals,d=this._cfgs,v=d.line,x=d.alignLines,w=this.get("graph"),I=w.get("group");s==="item"&&(l&&(0,k.each)(l,function(G){var U=G.line,et=G.point,ft=(U[0]+U[2])/2,Ct,Mt;et.x<ft?(Ct=et.x-i.width/2,Mt=Math.max(U[0],U[2])):(Ct=et.x+i.width/2,Mt=Math.min(U[0],U[2]));var kt=(0,k.mix)({x1:Ct,y1:U[1],x2:Mt,y2:U[1]},v),$t=I.addShape("line",{attrs:kt,capture:!1});x.push($t)}),f&&(0,k.each)(f,function(G){var U=G.line,et=G.point,ft=(U[1]+U[3])/2,Ct,Mt;et.y<ft?(Ct=et.y-i.height/2,Mt=Math.max(U[1],U[3])):(Ct=et.y+i.height/2,Mt=Math.min(U[1],U[3]));var kt=(0,k.mix)({x1:U[0],y1:Ct,x2:U[0],y2:Mt},v),$t=I.addShape("line",{attrs:kt,capture:!1});x.push($t)}))},a.prototype.getLineDisObject=function(e,i){return{line:e,point:i,dis:_0(e,i)}},a.prototype.getContainer=function(){return this.get("container")},a.prototype.clearAlignLine=function(){var e=this._cfgs.alignLines;(0,k.each)(e,function(i){i.remove()}),e.length=0},a.prototype.destory=function(){var e=this._cfgs,i=e.horizontalLines,s=e.verticalLines,l=this.get("graph"),f=l.getNodes();f.forEach(function(d){var v=d.get("id");delete i["".concat(v,"tltr")],delete i["".concat(v,"lcrc")],delete i["".concat(v,"blbr")],delete s["".concat(v,"tlbl")],delete s["".concat(v,"tcbc")],delete s["".concat(v,"trbr")]}),this.clearAlignLine()},a}(id),Gb=$b,Ub=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),cc=function(){return cc=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},cc.apply(this,arguments)},cf=["click","mouseenter"],gE=function(c){Ub(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{data:{},position:"top",padding:8,margin:8,offsetX:0,offsetY:0,layout:"horizontal",flipPage:!1,containerStyle:{},align:void 0,horiSep:8,vertiSep:8,filter:{enable:!1,trigger:"click"}}},a.prototype.init=function(){this.formatArray("padding"),this.formatArray("margin");var e=this.get("filter")||{},i=e.multiple;i&&e.trigger==="mouseenter"&&this.set("multiple",!1);var s=this.get("align");if(!s){var l=this.get("position").split("-");l.includes("left")&&(s="left"),l.includes("right")?s="right":s="center",this.set("align",s)}var f=this.get("graph"),d=f.get("container"),v=ql(`<div class='g6-legend-container' style="position: absolute;"></div>`);d.appendChild(v),this.set("container",v);var x=this.render();ru(v,this.getContainerPos(x)),this.bindEvents()},a.prototype.getContainerPos=function(e){e===void 0&&(e=[0,0]);var i=this,s=i.get("graph"),l=this.get("offsetX"),f=this.get("offsetY"),d=this.get("margin"),v=this.get("position").split("-"),x={top:0,right:1,bottom:2,left:3},w=0,I=0,G={left:(s.getWidth()-e[0])/2+w,top:(s.getHeight()-e[1])/2+I};return v.forEach(function(U){var et=d[x[U]],ft=U;switch(U){case"top":et+=I;break;case"left":et+=w;break;case"bottom":et=s.getHeight()-e[1]-et+I,ft="top";break;default:et=s.getWidth()-e[0]-et+w,ft="left";break}G[ft]=et}),G.top+=f+s.getContainer().offsetTop,G.left+=l+s.getContainer().offsetLeft,Object.keys(G).forEach(function(U){G[U]="".concat(G[U],"px")}),G},a.prototype.bindEvents=function(){var e=this,i=e.get("filter");if(!(!i||!i.enable)){var s=i.trigger||"click";cf.includes(s)||(console.warn("Trigger for legend filterling must be 'click' or 'mouseenter', 'click' will take effect by default."),s="click");var l=e.get("legendCanvas");s==="mouseenter"?(l.on("node-container:mouseenter",function(f){return e.filterData(f)}),l.on("node-container:mouseleave",function(f){e.clearFilter(),e.clearActiveLegend()})):(l.on("node-container:click",function(f){return e.filterData(f)}),l.on("click",function(f){f.target&&f.target.isCanvas&&f.target.isCanvas()&&(e.clearFilter(),e.clearActiveLegend())}))}},a.prototype.changeData=function(e){this.set("data",e);var i=this.render();ru(this.get("container"),this.getContainerPos(i))},a.prototype.activateLegend=function(e){var i=this.get("filter"),s=i==null?void 0:i.multiple;s||this.clearActiveLegend();var l=e.get("parent");l.get("active")?(l.set("active",!1),this.findLegendItemsByState("active").length&&l.set("inactive",!0)):(l.set("inactive",!1),l.set("active",!0)),this.findLegendItemsByState("active").length?this.findLegendItemsByState("active","all",!1).forEach(function(I){I.set("inactive",!0)}):this.clearActiveLegend();var f=(i==null?void 0:i.legendStateStyles)||{},d=(f==null?void 0:f.inactive)||{opacity:.5,"text-shape":{opacity:.5}},v=d["text-shape"]||{};this.findLegendItemsByState("inactive").forEach(function(I){var G=I.get("children"),U=G[0],et=G[1];U.attr(cc(cc({},U.get("oriAttrs")),d)),et.attr(cc(cc({},et.get("oriAttrs")),v))});var x=(f==null?void 0:f.active)||{stroke:"#000",lineWidth:2,"text-shape":{fontWeight:"bold"}},w=x["text-shape"]||{};this.findLegendItemsByState("active").forEach(function(I){var G=I.get("children"),U=G[0],et=G[1];U.attr(cc(cc({},U.get("oriAttrs")),x)),et.attr(cc(cc({},et.get("oriAttrs")),w))})},a.prototype.findLegendItemsByState=function(e,i,s){i===void 0&&(i="all"),s===void 0&&(s=!0);var l=this.get("legendCanvas").find(function(v){return v.get("name")==="root"}),f=l.find(function(v){return v.get("name")==="node-group"}),d=l.find(function(v){return v.get("name")==="edge-group"});return i==="node"?f.get("children").filter(function(v){return!!v.get(e)===s}):i==="edge"?d.get("children").filter(function(v){return!!v.get(e)===s}):f.get("children").filter(function(v){return!!v.get(e)===s}).concat(d.get("children").filter(function(v){return!!v.get(e)===s}))},a.prototype.clearActiveLegend=function(){var e=this.get("legendCanvas"),i=e.find(function(l){return l.get("name")==="root"}),s=[i.find(function(l){return l.get("name")==="node-group"}),i.find(function(l){return l.get("name")==="edge-group"})];s.forEach(function(l){l.get("children").forEach(function(f){f.set("active",!1),f.set("inactive",!1);var d=f.get("children"),v=d[0],x=d[1];v.attr(v.get("oriAttrs")),x.attr(x.get("oriAttrs"))})})},a.prototype.filterData=function(e){var i=this.get("filter"),s=i==null?void 0:i.filterFunctions;if(!(!i||!s)){var l=this.get("legendCanvas"),f=this.get("graph"),d=i.graphActiveState||"active",v=i.graphInactiveState||"inactive",x=i.multiple;this.clearFilter(),x||this.clearActiveLegend(),this.activateLegend(e.target);var w=l.find(function(Mt){return Mt.get("name")==="root"}),I=w.find(function(Mt){return Mt.get("name")==="node-group"}),G=w.find(function(Mt){return Mt.get("name")==="edge-group"}),U=I.get("children").filter(function(Mt){return Mt.get("active")}),et=G.get("children").filter(function(Mt){return Mt.get("active")}),ft=0,Ct=["getNodes","getEdges"];Ct.forEach(function(Mt){f[Mt]().forEach(function(kt){var $t=!1,Jt=Mt==="getNodes"?U:et;Jt.forEach(function(Ce){var je=s[Ce.get("id")];$t=$t||je(kt.getModel())}),$t?(f.setItemState(kt,v,!1),f.setItemState(kt,d,!0),ft++):(f.setItemState(kt,d,!1),f.setItemState(kt,v,!0))})}),ft||Ct.forEach(function(Mt){f[Mt]().forEach(function(kt){f.clearItemStates(kt,[v])})})}},a.prototype.clearFilter=function(){var e=this.get("graph"),i=this.get("filter");if(!!i){var s=i.graphActiveState||"active",l=i.graphInactiveState||"inactive";e.getNodes().forEach(function(f){e.clearItemStates(f,[s,l])}),e.getEdges().forEach(function(f){e.clearItemStates(f,[s,l])})}},a.prototype.render=function(){var e=this;this.processData();var i=this.get("legendCanvas");i?i.clear():i=new $v({container:this.get("container"),width:200,height:200});var s=i.addGroup({name:"root"}),l=s.addGroup({name:"node-group"}),f=s.addGroup({name:"edge-group"});this.set("legendCanvas",i);var d=this.get("itemsData"),v=["nodes","edges"],x=[l,f];v.forEach(function(Ca,Pi){d[Ca].forEach(function(Ni){var _a,Ya=x[Pi].addGroup({id:Ni.id,name:"node-container"}),hi,di=Ni.type,Xi=e.getShapeSize(Ni),go=Xi.width,vs=Xi.height,Fs=Xi.r,hl=e.getStyle(Ca.substr(0,4),Ni);switch(Ni.type){case"circle":hi={r:Fs,x:0,y:0};break;case"rect":hi={width:go,height:vs,x:-go/2,y:-vs/2};break;case"ellipse":hi={rx:go,ry:vs,x:0,y:0},di="ellipse";break;case"line":hi={x1:-go/2,y1:0,x2:go/2,y2:0},di="line";break;case"quadratic":hi={path:[["M",-go/2,0],["Q",0,go/2,go/2,0]]},di="path";break;case"cubic":hi={path:[["M",-go/2,0],["C",-go/6,go/2,go/6,-go/2,go/2,0]]},di="path";break;case"diamond":hi={path:[["M",0,-vs],["L",go,0],["L",0,vs],["L",-go,0],["Z"]]},di="path";break;case"triangle":hi={path:[["M",-go,vs],["L",0,-vs],["L",go,vs],["Z"]]},di="path";break;case"star":hi={path:Sc.getStarPath(Fs*3,Fs*1.2)},di="path";break;default:hi={r:Fs,x:0,y:0};break}var Lu=Ya.addShape(di,{attrs:cc(cc({},hi),hl),name:"".concat(Ni.type,"-node-keyShape"),oriAttrs:cc({opacity:1},hl)});if(Ni.label){var dl=Lu.getBBox(),_l=((_a=Ni.labelCfg)===null||_a===void 0?void 0:_a.style)||{},rc=cc({textAlign:"begin",fontSize:12,textBaseline:"middle",fill:"#000",opacity:1,fontWeight:"normal"},_l);Ya.addShape("text",{attrs:cc({x:dl.maxX+4,y:0,text:Ni.label},rc),className:"legend-label",name:"".concat(Ni.type,"-node-text"),oriAttrs:rc})}})});var w=this.get("padding"),I,G=s.find(function(Ca){return Ca.get("name")==="title-container"}),U={height:0,maxY:0,width:0};if(this.get("title")){G||(G=s.addGroup({name:"title-container"}));var et={fontSize:20,fontFamily:"Arial",fontWeight:300,textBaseline:"top",textAlign:"center",fill:"#000",x:0,y:w[0]},ft=this.get("titleConfig")||{},Ct=Object.assign(et,ft.style||{});I=G.addShape("text",{attrs:cc({text:this.get("title")},Ct)}),U=G.getCanvasBBox(),G.setMatrix([1,0,0,0,1,0,ft.offsetX,ft.offsetY,1])}this.layoutItems();var Mt=s.getCanvasBBox(),kt=l.getCanvasBBox(),$t=kt.minX<0?Math.abs(kt.minX)+w[3]:w[3],Jt=U.maxY<kt.minY?Math.abs(U.maxY-kt.minY)+w[0]:U.maxY+w[0],Ce=[1,0,0,0,1,0,$t,Jt,1];l.setMatrix(Ce),Mt=s.getCanvasBBox();var je=[Mt.minX+Mt.width+w[1],Mt.minY+Mt.height+w[2]];if(I){var ft=cc({position:"center",offsetX:0,offsetY:0},this.get("titleConfig"));U=G.getCanvasBBox();var ze=G.getMatrix()||[1,0,0,0,1,0,0,0,1];ft.position==="center"?ze[6]=je[0]/2+ft.offsetX:ft.position==="right"?(ze[6]=je[0]-w[3]+ft.offsetX,I.attr({textAlign:"right"})):(ze[6]=w[3]+ft.offsetX,I.attr({textAlign:"left"})),G.setMatrix(ze),U=G.getCanvasBBox(),$t=kt.minX<0?Math.abs(kt.minX)+w[3]:w[3],Jt=kt.minY<U.maxY?Math.abs(U.maxY-kt.minY)+w[0]:U.maxY+w[0],Ce=[1,0,0,0,1,0,$t,Jt,1],l.setMatrix(Ce);var pn=[1,0,0,0,1,0,$t,Jt,1];this.get("layout")==="vertical"?pn[6]+=kt.maxX+this.get("horiSep"):pn[7]+=kt.maxY+this.get("vertiSep"),f.setMatrix(pn)}else{kt=l.getCanvasBBox();var Fn=[1,0,0,0,1,0,0,0,1];this.get("layout")==="vertical"?Fn[6]+=Ce[6]+kt.maxX+this.get("horiSep"):Fn[7]+=Ce[7]+kt.maxY+this.get("vertiSep"),f.setMatrix(Fn)}Mt=s.getCanvasBBox(),kt=l.getCanvasBBox(),Ce=l.getMatrix()||[1,0,0,0,1,0,0,0,1];var Tn=f.getMatrix()||[1,0,0,0,1,0,0,0,1],cr=f.getCanvasBBox();je=[Math.max(kt.width+Ce[6],cr.width+Tn[6])+w[1],Math.max(kt.height+Ce[7],cr.height+Tn[7])+w[2]],i.changeSize(je[0],je[1]);var kr=this.get("containerStyle"),Aa=s.getMatrix()||[1,0,0,0,1,0,0,0,1],ci=Sc.invertMatrix({x:0,y:0},Aa),ei=s.addShape("rect",{attrs:cc({x:ci.x+(kr.lineWidth||1),y:ci.y+(kr.lineWidth||1),width:je[0]-2*(kr.lineWidth||1),height:je[1]-2*(kr.lineWidth||1),fill:"#f00",stroke:"#000",lineWidth:1,opacity:.5},kr),name:"legend-back-rect",capture:!1});return ei.toBack(),je},a.prototype.layoutItems=function(){var e=this.get("legendCanvas"),i=this.get("horiSep"),s=this.get("vertiSep"),l=this.get("layout"),f=this.get("align"),d=[0,0],v=e.find(function(Jt){return Jt.get("name")==="root"}),x=v.find(function(Jt){return Jt.get("name")==="node-group"}),w=v.find(function(Jt){return Jt.get("name")==="edge-group"}),I={min:0,max:-Infinity},G=-Infinity;x.get("children").forEach(function(Jt,Ce){Ce===0&&(I.min=d[0]);var je=Jt.get("children")[0],ze=Jt.getCanvasBBox(),pn=je.getBBox(),Fn=pn.width,Tn=pn.height,cr=0,kr=0,Aa=0;l==="vertical"?(kr=d[1],Aa=d[0]+Fn/2,d[0]=Aa+ze.height+s,cr=ze.maxX+kr+Fn/2):(kr=d[0]+Fn/2,Aa=d[1],d[0]=kr+ze.width+i,cr=ze.maxY+Aa+Tn/2),d[0]>I.max&&(I.max=d[0]),cr>G&&(G=cr),Jt.setMatrix([1,0,0,0,1,0,kr,Aa,1])});var U=I.max-I.min,et={min:0,max:-Infinity},ft=x.getCanvasBBox();d[0]=0,d[1]=l==="vertical"?ft.maxX+i:ft.maxY+s,w.get("children").forEach(function(Jt,Ce){Ce===0&&(et.min=d[0]);var je=Jt.get("children")[0],ze=Jt.getCanvasBBox(),pn=je.getBBox(),Fn=pn.width,Tn=pn.height,cr=0,kr=0;l==="vertical"?(cr=d[1],kr=d[0],d[0]=kr+ze.height+s,Jt.setMatrix([1,0,0,0,1,0,0,kr+Tn/2,1])):(cr=d[0],kr=d[1],d[0]=cr+ze.width+i,Jt.setMatrix([1,0,0,0,1,0,cr+Fn/2,0,1])),d[0]>et.max&&(et.max=d[0])});var Ct=et.max-et.min;if(f&&f!==""&&f!=="left"){var Mt=U-Ct,kt=f==="center"?Math.abs(Mt)/2:Math.abs(Mt),$t=Mt<0?x:w;$t.get("children").forEach(function(Jt){var Ce=Jt.getMatrix()||[1,0,0,0,1,0,0,0,1];l==="vertical"?Ce[7]+=kt:Ce[6]+=kt,Jt.setMatrix(Ce)})}},a.prototype.processData=function(){var e=this.get("data"),i={nodes:[],edges:[]};e.nodes&&(e.nodes.sort(function(s,l){return s.order-l.order}),e.nodes.forEach(function(s){var l,f,d,v,x,w=s.size||[((l=s.style)===null||l===void 0?void 0:l.width)||((f=s.style)===null||f===void 0?void 0:f.r)||8,((d=s.style)===null||d===void 0?void 0:d.height)||((v=s.style)===null||v===void 0?void 0:v.r)||8],I=((x=s.labelCfg)===null||x===void 0?void 0:x.style)||{};i.nodes.push({id:s.id||(0,k.uniqueId)(),type:s.type||"circle",style:cc({},s.style),order:s.order,label:s.label,itemType:"node",size:w,labelCfg:{position:"right",style:cc({fontFamily:"Arial"},I)}})})),e.edges&&(e.edges.sort(function(s,l){return s.order-l.order}),e.edges.forEach(function(s){var l,f,d=s.type||"line";s.type==="cubic-horizontal"&&(d="cubic");var v=((l=s.labelCfg)===null||l===void 0?void 0:l.style)||{},x=s.size||[((f=s.style)===null||f===void 0?void 0:f.width)||8,1];i.edges.push({id:s.id||(0,k.uniqueId)(),type:d,size:x,style:cc({lineWidth:(0,k.isArray)(x)?x[1]:1},s.style),order:s.order,label:s.label,itemType:"edge",labelCfg:{position:"right",style:cc({fontFamily:"Arial"},v)}})})),this.set("itemsData",i)},a.prototype.getContainer=function(){return this.get("container")},a.prototype.formatArray=function(e){var i=this.get(e);if((0,k.isNumber)(i))this.set(e,[i,i,i,i]);else if((0,k.isArray)(i))switch(i.length){case 0:this.set(e,[0,0,0,0]);break;case 1:this.set(e,[i[0],i[0],i[0],i[0]]);break;case 2:this.set(e,[i[0],i[1],i[0],i[1]]);break;case 3:this.set(e,[i[0],i[1],i[2],i[1]]);break;default:break}return this.get(e)},a.prototype.getShapeSize=function(e){var i,s,l;return e.size&&((0,k.isArray)(e.size)?(i=e.size[0],s=e.size[1]||e.size[0],l=e.size[0]/2):(0,k.isNumber)(e.size)&&(i=e.size,s=e.size,l=e.size/2)),e.style&&(e.style.width&&(i=e.style.width),e.style.height&&(s=e.style.height),e.style.r&&(l=e.style.r)),l||(l=5),i||(i=l),s||(s=l),{width:i,height:s,r:l}},a.prototype.getStyle=function(e,i){var s=e==="node"?{fill:"#ccc",lineWidth:0}:{stroke:"#000",lineWidth:1};return cc(cc({},s),i.style||{})},a.prototype.destroy=function(){var e=this.get("legendCanvas");e==null||e.destroy();var i=this.get("graph"),s=i.get("container"),l=this.get("container");s.removeChild(l)},a}(id),ff=gE,Q_=function(){var c=function(e,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(s[f]=l[f])},c(e,i)};return function(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");c(a,e);function i(){this.constructor=a}a.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ep=function(){return ep=Object.assign||function(c){for(var a,e=1,i=arguments.length;e<i;e++){a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(c[s]=a[s])}return c},ep.apply(this,arguments)},mE=function(c,a){var e={};for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&a.indexOf(i)<0&&(e[i]=c[i]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(c);s<i.length;s++)a.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(c,i[s])&&(e[i[s]]=c[i[s]]);return e};typeof document!="undefined"&&Em()(`
  .g6-annotation-container {
    background-color: rgba(255, 255, 255, 0.3);
    padding: 8px;
  }
  .g6-annotation-wrapper {
    background-color: #fff;
    box-shadow: 0 0 8px rgba(0, 0, 0, 0.85);
  }
  .g6-annotation-header-wapper {
    height: fit-content;
    width: 100%;
    background-color: #5B8FF9;
    display: inline-flex;
    cursor: move;
  }
  .g6-annotation-title {
    margin: 4px 40px 4px 8px;
    cursor: text;
    min-width: 32px;
  }
  .g6-annotation-collapse {
    margin: 4px;
    cursor: pointer;
  }
  .g6-annotation-expand {
    margin: 4px;
    cursor: pointer;
  }
  .g6-annotation-close {
    margin: 4px 8px 4px 0;
    cursor: pointer;
  }
  .g6-annotation-content {
    padding: 8px;
    width: fit-content;
    cursor: text;
    word-break: break-all;
    min-width: 32px;
  }
  .g6-annotation-title-input-wrapper {
    margin: 4px 40px 4px 8px;
  }
  .g6-annotation-content-input {
    height: 100%;
    word-break: break-all;
  }
  .g6-annotation-content-input-wrapper {
    margin: 8px;
    height: 100%;
  }
`);var yE="canvas-annotation",J_=function(c){Q_(a,c);function a(e){return c.call(this,e)||this}return a.prototype.getDefaultCfgs=function(){return{trigger:"click",editable:!0,itemHighlightState:"highlight",linkHighlightStyle:{shadowColor:"#5B8FF9",shadowBlur:10},cardCfg:{minHeight:60,width:"fit-content",height:"fit-content",collapseType:"minimize",closeType:"hide",borderRadius:5,maxTitleLength:20}}},a.prototype.getEvents=function(){var e={viewportchange:"updateLinks",afterlayout:"updateLinks",aftergraphrefreshposition:"updateLinks",afterupdateitem:"updateLink",afterchangedata:"onGraphDataChange",afteritemvisibilitychange:"onGraphItemVisibilityChange"};switch(this.get("trigger")){case"click":e=ep(ep({},e),{"node:click":"showAnnotation","edge:click":"showAnnotation"})}return e},a.prototype.getDOMContent=function(e){if(!this.destroyed){var i=e.collapsed,s=e.maxWidth,l=e.title,f=l===void 0?"":l,d=e.content,v=d===void 0?"":d,x=e.borderRadius,w=x===void 0?5:x,I=i?"<p class='g6-annotation-expand'>+</p>":"<p class='g6-annotation-collapse'>-</p>",G=i?"":" <p class='g6-annotation-content'>".concat(v,"</p>"),U="<p class='g6-annotation-close'>x</p>",et=i?"".concat(w,"px"):"".concat(w,"px ").concat(w,"px 0 0");return'<div class="g6-annotation-wrapper" style="border-radius: '.concat(w,"px; max-width: ").concat(s,`px">
        <div
          class="g6-annotation-header-wapper"
          style="border-radius: `).concat(et,`;"
        >
          <h4 class='g6-annotation-title'>`).concat(f,`</h4>
          `).concat(I,`
          `).concat(U,`
        </div>
        `).concat(G,`
      </div>`)}},a.prototype.init=function(){var e=this;if(!e.destroyed){var i=e.get("graph"),s=i.getContainer(),l=e.get("container"),f=this.get("containerCfg");f?(l=this.createContainer(),s.appendChild(l)):l=s,this.set("container",l);var d=s.getBoundingClientRect(),v=new $v({container:s,width:d.right-d.left,height:d.bottom-d.top});ru(v.get("el"),{position:"absolute",top:0,left:0,pointerEvents:"none"}),window.addEventListener("resize",(0,k.debounce)(function(){return e.resizeCanvas(e)},100));var x=v.addGroup({id:"annotation-link-group"});e.set("linkGroup",x),e.set("canvas",v),e.get("getTitle")||e.set("getTitle",function(I){var G,U=((G=I==null?void 0:I.getModel)===null||G===void 0?void 0:G.call(I))||{},et=U.label,ft=U.id;return et||ft||"-"}),e.get("getContent")||e.set("getContent",function(I){var G,U;if(!I)return"-";var et=((G=I.getModel)===null||G===void 0?void 0:G.call(I))||{},ft=et.label,Ct=et.id,Mt=(U=I.getType)===null||U===void 0?void 0:U.call(I),kt=Mt?"".concat(Mt,": "):"";return"".concat(kt).concat(ft||Ct||"")});var w=e.get("defaultData");w&&this.readData(w)}},a.prototype.createContainer=function(){var e=this;if(!this.destroyed){var i=this.get("containerCfg"),s=this.get("graph"),l=s.getContainer(),f=l.getBoundingClientRect(),d=f.left,v=f.right,x=f.top,w=f.bottom,I=w-x,G=v-d,U=i.position,et=U===void 0?"top":U,ft=i.offsetX,Ct=ft===void 0?0:ft,Mt=i.offsetY,kt=Mt===void 0?0:Mt,$t=mE(i,["position","offsetX","offsetY"]),Jt=i.height,Ce=Jt===void 0?"fit-content":Jt,je=i.width,ze=je===void 0?s.getWidth():je;Ce==="100%"&&(Ce=I),ze==="100%"&&(ze=G);var pn="unset",Fn="unset",Tn={};switch(et){case"right":pn="".concat(I,"px"),Tn={top:0,right:0},Tn.right+=d+Ct,Tn.top+=x+kt;break;case"bottom":Fn="".concat(G,"px"),Tn={bottom:0,left:0},Tn.left+=d+Ct,Tn.bottom+=x+kt;break;case"top":Fn="".concat(G,"px");case"left":pn="".concat(I,"px");default:Tn={top:0,left:0},Tn.left+=d+Ct,Tn.top+=x+kt;break}Object.keys(Tn).forEach(function(kr){Tn[kr]="".concat(Tn[kr],"px")});var cr=ql("<div class='".concat(i.className," g6-annotation-container'></div>"));return ru(cr,ep(ep({position:"absolute",display:et==="top"||et==="bottom"?"inline-flex":"unset",width:(0,k.isNumber)(ze)?"".concat(ze,"px"):ze,height:(0,k.isNumber)(Ce)?"".concat(Ce,"px"):Ce,maxHeight:pn,maxWidth:Fn,overflow:"scroll"},Tn),$t)),l.appendChild(cr),cr.addEventListener("scroll",function(kr){e.updateLinks()}),cr}},a.prototype.resizeCanvas=function(e){clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){if(!(!e||e.destroyed)){var i=e.get("container").getBoundingClientRect(),s=i.right-i.left,l=i.bottom-i.top;e.get("canvas").changeSize(s,l),e.updateOutsideCards(e)}},250)},a.prototype.updateOutsideCards=function(e){var i=e||this,s=i.get("cardInfoMap")||{},l=i.get("graph"),f=l.getPointByCanvas(0,0),d=l.getPointByCanvas(l.getWidth(),l.getHeight()),v=l.getClientByPoint(f.x,f.y),x=v.x,w=v.y,I=l.getClientByPoint(d.x,d.y),G=I.x,U=I.y;Object.values(s).forEach(function(et){var ft=et.card;if(!!ft){var Ct=ft.style,Mt=Wg(Ct.left),kt=Wg(Ct.top),$t=ft.getBoundingClientRect(),Jt=$t.width,Ce=$t.height,je=Mt,ze=kt;Mt+Jt>G-x&&(je=G-x-Jt),Mt<0&&(je=0),kt+Ce>U-w&&(ze=U-w-Ce),kt<0&&(ze=0),ru(ft,{left:"".concat(je,"px"),top:"".concat(ze,"px")})}}),i.updateLinks()},a.prototype.showAnnotation=function(e){if(!this.destroyed){var i=e.item;this.toggleAnnotation(i)}},a.prototype.hideCards=function(){var e=this;if(!e.destroyed){var i=e.get("cardInfoMap")||{};Object.keys(i).forEach(function(s){e.hideCard(s)})}},a.prototype.toggleAnnotation=function(e,i){var s,l;i===void 0&&(i={});var f=this;if(!f.destroyed){var d=f.get("cardInfoMap")||{},v=f.get("graph"),x=f.get("container"),w=f.get("containerCfg"),I=Object.assign({},f.get("cardCfg")||{},i),G=I.minHeight,U=I.minWidth,et=I.width,ft=I.height,Ct=I.collapsed,Mt=Ct===void 0?!1:Ct,kt=I.x,$t=I.y,Jt=I.title,Ce=I.content,je=I.maxTitleLength,ze=I.defaultBegin,pn=mE(I,["minHeight","minWidth","width","height","collapsed","x","y","title","content","maxTitleLength","defaultBegin"]),Fn=f.get("linkGroup"),Tn=this.get("rows")||[[]],cr=(s=e.isCanvas)===null||s===void 0?void 0:s.call(e),kr=cr?yE:e.getID(),Aa=d[kr]||{},ci=Aa.card,ei=Aa.link,Ca=Aa.x,Pi=Aa.y,Ni=Aa.title,_a=Aa.content,Ya=this.get("getTitle"),hi=this.get("getContent"),di=this.get("getContentPlaceholder")||function(){return""},Xi=this.get("getTitlePlaceHolder")||function(){return""},go=di(e),vs=Xi(e),Fs=ql(this.getDOMContent(ep({itemId:kr,collapsed:Mt,title:((l=Ni||Jt||(Ya==null?void 0:Ya(e)))===null||l===void 0?void 0:l.substr(0,je))||vs,content:_a||Ce||(hi==null?void 0:hi(e))||go},pn))),hl=(0,k.isNumber)(G)?"".concat(G,"px"):G;ru(Fs,{minHeight:Mt?"unset":hl,minWidth:(0,k.isNumber)(U)?"".concat(U,"px"):U,height:ft,width:et});var Lu=!!ci;Lu?(ei==null||ei.remove(!0),x.replaceChild(Fs,ci)):x.appendChild(Fs);var dl;if(!w){if(dl=x.getBoundingClientRect()||{},kt!==void 0&&$t!==void 0)Ca=kt,Pi=$t;else if(!Lu&&!cr){var _l=dl.top,rc=ze||{},Vl=rc.left,zp=rc.right,xf=zp===void 0?16:zp,Dh=rc.top,Vc=Dh===void 0?8:Dh,jc=rc.bottom,Oh=xf,Df=Vc;isNaN(Vl)||(Oh=x.scrollWidth-Vl),isNaN(jc)||(Df=x.scrollHeight-jc);var Rh=(0,k.isNumber)(U)?U:100;Ca=x.scrollWidth-Fs.scrollWidth-(Tn.length-1)*Rh-Oh;var au=Tn[Tn.length-1],Ku=(au[au.length-1]||{}).bbox;Pi=(Ku==null?void 0:Ku.bottom)-_l||Df}ru(Fs,{position:"absolute",left:"".concat(Ca,"px"),top:"".concat(Pi,"px"),cusor:w?"unset":"move"})}this.bindListener(Fs,kr);var Ks=Fs.getBoundingClientRect();if(!cr){var Zu=Wb(e,Ks,v,this.get("canvas")),Il=this.get("linkStyle");ei=Fn.addShape("path",{attrs:ep({lineWidth:1,lineDash:[5,5],stroke:"#ccc",path:Zu},Il)})}if(d[kr]=ep(ep({},d[kr]||{}),{id:kr,collapsed:Mt,card:Fs,link:ei,x:Ca,y:Pi,cardBBox:Ks,content:_a||Ce,title:Ni||Jt,contentPlaceholder:go,titlePlaceholder:vs,isCanvas:cr}),f.set("cardInfoMap",d),w)this.updateCardPositionsInConatainer(),this.updateLinks();else{var Ho=!isNaN(kt)&&!isNaN($t);if(!Lu&&!cr&&!Ho){var xu=dl.bottom,wu=xu===void 0?0:xu,_l=dl.top;Tn[Tn.length-1].push({id:kr,bbox:Ks}),Ks.top>wu-_l-Ks.height-16&&Tn.push([]),this.set("rows",Tn)}}this.updateCardSize(kr);var Dl=this.get("onAnnotationChange");Dl==null||Dl(d[kr],Lu?"update":"create")}},a.prototype.updateCardPositionsInConatainer=function(){if(!this.destroyed){var e=this.get("cardInfoMap");if(!!e){var i=this.get("container"),s=this.get("containerCfg").position,l=i.getBoundingClientRect().width,f=getComputedStyle(i),d=Wg(f.paddingLeft)+Wg(f.paddingRight);l-=d,Object.values(e).forEach(function(v){var x=v.card,w=x.getBoundingClientRect().width;switch(s){case"right":ru(x,{marginLeft:l?"".concat(l-w,"px"):"0px"});break;case"top":case"bottom":ru(x,{marginLeft:"8px"});default:break}})}}},a.prototype.handleExpandCollapseCard=function(e){if(!this.destroyed){var i=this.get("graph"),s=this.get("cardInfoMap");if(!!s){var l=s[e].collapsed,f=i.findById(e);if(!!f){var d=this.get("cardCfg").collapseType;d==="hide"&&!l?this.hideCard(e):this.toggleAnnotation(f,{collapsed:!l}),s[e]=ep(ep({},s[e]),{collapsed:!l})}}}},a.prototype.hideCard=function(e){if(!this.destroyed){var i=this.get("cardInfoMap");if(!(!i||!i[e])){var s=i[e],l=s.card,f=s.link;ru(l,{display:"none"}),f==null||f.hide();var d=this.get("onAnnotationChange");d(i[e],"hide")}}},a.prototype.removeCard=function(e){if(!this.destroyed){var i=this.get("cardInfoMap");if(!!i){var s=i[e],l=s.card,f=s.link,d=this.get("container");d.removeChild(l),f==null||f.remove(!0),delete i[e];var v=this.get("onAnnotationChange");v(s,"remove")}}},a.prototype.bindListener=function(e,i){var s=this;if(!this.destroyed){e.addEventListener("mousemove",function(v){var x;if(v.target.className==="g6-annotation-collapse"?x="collapse":v.target.className==="g6-annotation-expand"?x="expand":v.target.className==="g6-annotation-close"&&(x="close"),x){var w=s.get("cardCfg").onMouseEnterIcon,I=w===void 0?function(){}:w;I(v,i,x)}}),e.addEventListener("mouseout",function(v){var x;if(v.target.className==="g6-annotation-collapse"?x="collapse":v.target.className==="g6-annotation-expand"?x="expand":v.target.className==="g6-annotation-close"&&(x="close"),x){var w=s.get("cardCfg").onMouseLeaveIcon,I=w===void 0?function(){}:w;I(v,i,x)}}),e.addEventListener("mouseenter",function(v){var x=s.get("cardInfoMap");if(!!x){var w=s.get("graph"),I=w.findById(i);if(I){var G=s.get("itemHighlightState");w.setItemState(I,G,!0)}var U=x[i].link;if(U){var et=s.get("linkHighlightStyle")||{};U.attr(et)}}}),e.addEventListener("mouseleave",function(v){var x=s.get("cardInfoMap");if(!!x){var w=s.get("graph"),I=w.findById(i);if(I){var G=s.get("itemHighlightState");w.setItemState(I,G,!1)}var U=x[i].link;if(U){var et=s.get("linkHighlightStyle")||{};Object.keys(et).forEach(function(Ct){U.attr(Ct,void 0),U.attr(Ct,void 0)});var ft=s.get("linkStyle");U.attr(ft)}}}),e.addEventListener("click",function(v){var x=(s.get("cardCfg")||{}).onClickIcon;if(v.target.className==="g6-annotation-collapse"||v.target.className==="g6-annotation-expand"){var w=s.get("cardCfg").collapseType;w==="hide"?s.hideCard(i):s.handleExpandCollapseCard(i),x==null||x(v,i,v.target.className==="g6-annotation-collapse"?"collapse":"expand")}else if(v.target.className==="g6-annotation-close"){var I=s.get("cardCfg").closeType;I==="remove"?s.removeCard(i):s.hideCard(i),x==null||x(v,i,"close")}});var l=this.get("editable");l&&e.addEventListener("dblclick",function(v){var x=s.get("cardInfoMap"),w=(s.get("cardCfg")||{}).maxTitleLength,I=w===void 0?20:w;if(!!x){var G=v.target,U=G.className;if(!(U!=="g6-annotation-title"&&U!=="g6-annotation-content")){var et=U==="g6-annotation-title"?G.getBoundingClientRect():G.parentNode.getBoundingClientRect(),ft=et.width,Ct=et.height,Mt=getComputedStyle(G),kt=U==="g6-annotation-title"?"input":"textarea",$t=ql("<".concat(kt,' class="').concat(U,'-input" type="textarea" style="width:').concat(ft,"px; height: ").concat(Ct,'px; min-width: 16px;"/>')),Jt=ql('<div class="'.concat(U,'-input-wrapper" style="width: ').concat(ft,"px; height: ").concat(Ct,"px; min-width: 16px; margin-right: ").concat(Mt.marginRight,'" />'));Jt.appendChild($t),G.parentNode.replaceChild(Jt,G);var Ce=x[i],je=Ce.contentPlaceholder,ze=Ce.titlePlaceholder,pn=Ce.content,Fn=Ce.title,Tn=pn;U==="g6-annotation-title"?($t.name="title",$t.maxLength=I,Tn=Fn):$t.name="content",Tn?($t.innerHTML=G.innerHTML,$t.value=G.innerHTML):$t.placeholder=U==="g6-annotation-title"?ze:je,$t.focus(),$t.addEventListener("blur",function(cr){$t.value&&(G.innerHTML=$t.value,Ce[$t.name||"title"]=$t.value),Jt.parentNode.replaceChild(G,Jt),s.updateCardSize(i);var kr=s.get("onAnnotationChange");kr==null||kr(Ce,"update")})}}});var f=["g6-annotation-title","g6-annotation-content","g6-annotation-title-input","g6-annotation-content-input"];e.draggable=!0,e.addEventListener("dragstart",function(v){var x=v.target.className;if(!f.includes(x)){var w=e.style;s.set("dragging",{card:e,x:v.clientX,y:v.clientY,left:Wg(w.left),top:Wg(w.top)})}}),e.addEventListener("drag",function(v){v.preventDefault();var x=s.get("cardInfoMap");if(!!x){var w=v.clientX,I=v.clientY,G=s.get("dragging");if(!(isNaN(w)||isNaN(I)||!G)){var U=G.x,et=G.y,ft=G.left,Ct=G.top,Mt=G.card,kt=w-U,$t=I-et;ft+=kt,Ct+=$t;var Jt=s.get("graph"),Ce=Jt.getPointByCanvas(0,0),je=Jt.getPointByCanvas(Jt.getWidth(),Jt.getHeight()),ze=Jt.getClientByPoint(Ce.x,Ce.y),pn=ze.x,Fn=ze.y,Tn=Jt.getClientByPoint(je.x,je.y),cr=Tn.x,kr=Tn.y,Aa=Mt.getBoundingClientRect(),ci=Aa.right-Aa.left,ei=Aa.bottom-Aa.top;(ft>cr-pn-ci&&kt>0||ft<0&&kt<0)&&(ft-=kt),(Ct>kr-Fn-ei&&$t>0||Ct<0&&$t<0)&&(Ct-=$t),ru(Mt,{left:"".concat(ft,"px"),top:"".concat(Ct,"px"),visibility:"hidden"}),U=w,et=I;var Ca=(x[i]||{}).link;if(Ca){var Pi=Jt.findById(i);Ca.attr("path",Wb(Pi,Aa,Jt,s.get("canvas")))}s.set("dragging",{x:U,y:et,left:ft,top:Ct,card:Mt})}}});var d=function(x){var w=s.get("cardInfoMap");if(!!w){var I=s.get("dragging");if(I){var G=I.left,U=I.top,et=I.card;w[i].x=G,w[i].y=U,ru(et,{visibility:"visible"}),s.set("dragging",!1);var ft=s.get("rows");ft==null||ft.forEach(function(Mt){for(var kt=Mt.length-1;kt>=0;kt--)Mt[kt].id===i&&Mt.splice(kt,1)});var Ct=s.get("onAnnotationChange");Ct==null||Ct(w[i],"update")}}};e.addEventListener("dragend",d)}},a.prototype.updateCardSize=function(e){var i=this.get("cardInfoMap");if(!!i){var s=i[e].card,l=s.getBoundingClientRect().width,f=s.getElementsByClassName("g6-annotation-title")[0];if(f){var d=getComputedStyle(f),v=Wg(d.marginLeft),x=f.getBoundingClientRect().width;ru(f,{marginRight:"".concat(l-v-24-16-x,"px")})}}},a.prototype.updateLink=function(e){var i=e.item;if(!!i){var s=this.get("cardInfoMap");if(!!s){var l=this.get("canvas"),f=this.get("graph"),d=i.getID(),v=s[d]||{},x=v.link,w=v.card;if(x){var I=Wb(i,w.getBoundingClientRect(),f,l);x.attr("path",I)}}}},a.prototype.updateLinks=function(){var e=this;if(!this.destroyed){var i=this.get("cardInfoMap");if(!!i){var s=this.get("graph");Object.values(i).forEach(function(l){var f=l.id,d=s.findById(f);e.updateLink({item:d})})}}},a.prototype.onGraphDataChange=function(){var e=this,i=this.get("cardInfoMap");if(!!i){var s=this.get("graph");Object.values(i).forEach(function(l){var f=l.id,d=l.card,v=l.isCanvas;if(!(!d||v||d.style.display==="none")){var x=s.findById(f);x&&x.isVisible()?e.toggleAnnotation(x):e.hideCard(f)}})}},a.prototype.onGraphItemVisibilityChange=function(e){var i=e.item,s=e.visible;if(!(!i||i.destroyed)){var l=this.get("cardInfoMap");if(!!l){var f=i.getID();!l[f]||s||this.hideCard(f)}}},a.prototype.saveData=function(e){e===void 0&&(e=!1);var i=this.get("cardInfoMap");if(!!i){var s=this.get("graph"),l=this.get("getTitle"),f=this.get("getContent"),d=[];return Object.values(i).forEach(function(v){var x=v.title,w=v.content,I=v.x,G=v.y,U=v.id,et=v.collapsed,ft=v.card;if(!(ft&&ft.style.display==="none"&&!e)){var Ct=s.findById(U)||s.get("canvas");d.push({id:U,x:I,y:G,collapsed:et,title:x||(l==null?void 0:l(Ct)),content:w||(f==null?void 0:f(Ct)),visible:ft&&ft.style.display!=="none"})}}),d}},a.prototype.readData=function(e){var i=this,s=this.get("graph");e.forEach(function(l){var f=l.id,d=l.x,v=l.y,x=l.title,w=l.content,I=l.collapsed,G=l.visible,U=s.findById(f);if(!U&&f===yE&&(U=s.get("canvas")),!U){var et=i.get("cardInfoMap")||{};et[f]=l,i.set("cardInfoMap",et);return}i.toggleAnnotation(U,{x:d,y:v,title:x,content:w,collapsed:I}),G||i.hideCard(f)})},a.prototype.clear=function(){var e=this.get("cardInfoMap");if(!!e){var i=this.get("container");Object.values(e).forEach(function(s){var l=s.card,f=s.link;i.removeChild(l),f==null||f.remove(!0)}),this.set("cardInfoMap",{})}},a.prototype.destroy=function(){var e;this.clear(),(e=this.get("canvas"))===null||e===void 0||e.destroy();var i=this.get("graph");!i||i.destroyed||(this.get("containerCfg")&&i.getContainer().removeChild(this.get("container")),this.destroyed=!0)},a}(id),tI=J_,eI=function(a,e){var i,s,l,f=Infinity;Object.keys(a).forEach(function(x){var w=a[x];Object.keys(e).forEach(function(I){var G=e[I],U=w.x-G.x,et=w.y-G.y,ft=U*U+et*et;f>ft&&(f=ft,i=w,s=G,l=[x,I])})});var d=20,v=Sc.getControlPoint(i,s,.5,d);return[["M",i.x,i.y],["Q",v.x,v.y,s.x,s.y]]},Wb=function(a,e,i,s){var l,f,d=a.getType();if(d==="edge")f=[a.getKeyShape().getPoint(.5)];else{var v=(l=a.getKeyShape)===null||l===void 0?void 0:l.call(a).getBBox(),x=v.minX,w=v.minY,I=v.maxX,G=v.maxY,U=a.getModel(),et=U.x,ft=U.y;x+=et,w+=ft,I+=et,G+=ft,f={left:{x,y:(w+G)/2},right:{x:I,y:(w+G)/2},top:{x:(x+I)/2,y:w},bottom:{x:(x+I)/2,y:G}}}Object.keys(f).forEach(function(Fn){var Tn=f[Fn],cr=Tn.x,kr=Tn.y,Aa=i.getClientByPoint(cr,kr);f[Fn]=s.getPointByClient(Aa.x,Aa.y)});var Ct=e.top,Mt=Ct===void 0?0:Ct,kt=e.left,$t=kt===void 0?0:kt,Jt=e.right,Ce=Jt===void 0?0:Jt,je=e.bottom,ze=je===void 0?0:je,pn={left:s.getPointByClient($t,(Mt+ze)/2),right:s.getPointByClient(Ce,(Mt+ze)/2),top:s.getPointByClient(($t+Ce)/2,Mt),bottom:s.getPointByClient(($t+Ce)/2,ze)};return eI(f,pn)},Wg=function(a){return Number(a.replace(/\s+|px/gi,""))||0},zA={PluginBase:id,Menu:Aw,Grid:Ey,Minimap:TC,Bundling:kC,ToolBar:FC,Tooltip:$C,Fisheye:sh,TimeBar:Z_,ImageMinimap:q_,EdgeFilterLens:BA,SnapLine:Gb,Legend:ff,Annotation:tI},Tm=zA,bu=Tm;zc("circle",{options:{size:oi.defaultNode.size,style:{x:0,y:0,stroke:oi.defaultNode.style.stroke,fill:oi.defaultNode.style.fill,lineWidth:oi.defaultNode.style.lineWidth},labelCfg:{style:{fill:oi.nodeLabel.style.fill,fontSize:oi.nodeLabel.style.fontSize,fontFamily:oi.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:oi.defaultNode.linkPoints.size,lineWidth:oi.defaultNode.linkPoints.lineWidth,fill:oi.defaultNode.linkPoints.fill,stroke:oi.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:(0,P.__assign)({},oi.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).icon,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=(0,k.deepMix)({},s,a.icon),d="".concat(this.type,"-keyShape"),v=e.addShape("circle",{attrs:l,className:d,name:d,draggable:!0});e.shapeMap[d]=v;var x=f.width,w=f.height,I=f.show,G=f.text;if(I){var U="".concat(this.type,"-icon");G?e.shapeMap[U]=e.addShape("text",{attrs:(0,P.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},f),className:U,name:U,draggable:!0}):e.shapeMap[U]=e.addShape("image",{attrs:(0,P.__assign)({x:-x/2,y:-w/2},f),className:U,name:U,draggable:!0})}return this.drawLinkPoints(a,e),v},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints;if(!!i){var s=i||{},l=s.top,f=s.left,d=s.right,v=s.bottom,x=s.size,w=s.r,I=(0,P.__rest)(s,["top","left","right","bottom","size","r"]),G=this.getSize(a),U=G[0]/2;if(f){var et="link-point-left";e.shapeMap[et]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:-U,y:0,r:x/2||w||5}),className:et,name:et,isAnchorPoint:!0})}if(d){var ft="link-point-right";e.shapeMap[ft]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:U,y:0,r:x/2||w||5}),className:ft,name:ft,isAnchorPoint:!0})}if(l){var Ct="link-point-top";e.shapeMap[Ct]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:0,y:-U,r:x/2||w||5}),className:Ct,name:Ct,isAnchorPoint:!0})}if(v){var Mt="link-point-bottom";e.shapeMap[Mt]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:0,y:U,r:x/2||w||5}),className:Mt,name:Mt,isAnchorPoint:!0})}}},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,k.deepMix)({},e,i),l=this.getSize(a),f=l[0]/2,d=(0,P.__assign)({x:0,y:0,r:f},s);return d},update:function(a,e,i){var s=e.getContainer(),l=this.getSize(a),f=(0,P.__assign)({},a.style);a.style.stroke===void 0&&a.color&&(f.stroke=a.color),a.style.r===void 0&&!isNaN(l[0])&&(f.r=l[0]/2),this.updateShape(a,e,f,!0,i),this.updateLinkPoints(a,s)}},"single-node"),zc("rect",{options:{size:[100,30],style:{radius:0,stroke:oi.defaultNode.style.stroke,fill:oi.defaultNode.style.fill,lineWidth:oi.defaultNode.style.lineWidth},labelCfg:{style:{fill:oi.nodeLabel.style.fill,fontSize:oi.nodeLabel.style.fontSize,fontFamily:oi.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:oi.defaultNode.linkPoints.size,lineWidth:oi.defaultNode.linkPoints.lineWidth,fill:oi.defaultNode.linkPoints.fill,stroke:oi.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},anchorPoints:[[0,.5],[1,.5]],stateStyles:(0,P.__assign)({},oi.nodeStateStyles)},shapeType:"rect",labelPosition:"center",drawShape:function(a,e){var i=this.getShapeStyle(a),s=e.addShape("rect",{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return e.shapeMap["".concat(this.type,"-keyShape")]=s,this.drawLinkPoints(a,e),s},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=i===void 0?{}:i,l=s.top,f=s.left,d=s.right,v=s.bottom,x=s.size,w=s.r,I=(0,P.__rest)(s,["top","left","right","bottom","size","r"]),G=this.getSize(a),U=G[0],et=G[1];f&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:-U/2,y:0,r:x/2||w||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),d&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:U/2,y:0,r:x/2||w||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),l&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:0,y:-et/2,r:x/2||w||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),v&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:0,y:et/2,r:x/2||w||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,k.mix)({},e,i),l=this.getSize(a),f=s.width||l[0],d=s.height||l[1],v=(0,P.__assign)({x:-f/2,y:-d/2,width:f,height:d},s);return v},update:function(a,e,i){var s=e.getContainer(),l=this.getOptions({}).style,f=this.getSize(a),d=e.get("keyShape");a.size||(f[0]=d.attr("width")||l.width,f[1]=d.attr("height")||l.height);var v={stroke:a.color,x:-f[0]/2,y:-f[1]/2,width:f[0],height:f[1]},x=(0,k.mix)({},l,d.attr(),v);x=(0,k.mix)(x,a.style),this.updateShape(a,e,x,!1,i),this.updateLinkPoints(a,s)}},"single-node"),zc("ellipse",{options:{size:[80,40],style:{x:0,y:0,stroke:oi.defaultNode.style.stroke,fill:oi.defaultNode.style.fill,lineWidth:oi.defaultNode.style.lineWidth},labelCfg:{style:{fill:oi.nodeLabel.style.fill,fontSize:oi.nodeLabel.style.fontSize,fontFamily:oi.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:oi.defaultNode.linkPoints.size,lineWidth:oi.defaultNode.linkPoints.lineWidth,fill:oi.defaultNode.linkPoints.fill,stroke:oi.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:(0,P.__assign)({},oi.nodeStateStyles)},shapeType:"ellipse",labelPosition:"center",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).icon,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=e.addShape("ellipse",{attrs:l,className:"ellipse-keyShape",name:"ellipse-keyShape",draggable:!0});e.shapeMap["ellipse-keyShape"]=f;var d=s.width,v=s.height,x=s.show,w=s.text;return x&&(w?e.shapeMap["".concat(this.type,"-icon")]=e.addShape("text",{attrs:(0,P.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.shapeMap["".concat(this.type,"-icon")]=e.addShape("image",{attrs:(0,P.__assign)({x:-d/2,y:-v/2},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(a,e),f},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=i===void 0?{}:i,l=s.top,f=s.left,d=s.right,v=s.bottom,x=s.size,w=s.r,I=(0,P.__rest)(s,["top","left","right","bottom","size","r"]),G=this.getSize(a),U=G[0]/2,et=G[1]/2;f&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:-U,y:0,r:x/2||w||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),d&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:U,y:0,r:x/2||w||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),l&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:0,y:-et,r:x/2||w||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),v&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:0,y:et,r:x/2||w||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,k.mix)({},e,i),l=this.getSize(a),f=l[0]/2,d=l[1]/2,v=(0,P.__assign)({x:0,y:0,rx:f,ry:d},s);return v},update:function(a,e,i){var s=e.getContainer(),l=this.getOptions({}).style,f=this.getSize(a),d={stroke:a.color,rx:f[0]/2,ry:f[1]/2},v=e.get("keyShape"),x=(0,k.mix)({},l,v.attr(),d);x=(0,k.mix)(x,a.style),this.updateShape(a,e,x,!0,i),this.updateLinkPoints(a,s)}},"single-node"),zc("diamond",{options:{size:[80,80],style:{stroke:oi.defaultNode.style.stroke,fill:oi.defaultNode.style.fill,lineWidth:oi.defaultNode.style.lineWidth},labelCfg:{style:{fill:oi.nodeLabel.style.fill,fontSize:oi.nodeLabel.style.fontSize,fontFamily:oi.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:oi.defaultNode.linkPoints.size,lineWidth:oi.defaultNode.linkPoints.lineWidth,fill:oi.defaultNode.linkPoints.fill,stroke:oi.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:(0,P.__assign)({},oi.nodeStateStyles)},shapeType:"diamond",labelPosition:"center",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).icon,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=e.addShape("path",{attrs:l,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e.shapeMap["".concat(this.type,"-keyShape")]=f;var d=s.width,v=s.height,x=s.show,w=s.text;return x&&(w?e.shapeMap["".concat(this.type,"-icon")]=e.addShape("text",{attrs:(0,P.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.shapeMap["".concat(this.type,"-icon")]=e.addShape("image",{attrs:(0,P.__assign)({x:-d/2,y:-v/2},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(a,e),f},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=i===void 0?{}:i,l=s.top,f=s.left,d=s.right,v=s.bottom,x=s.size,w=s.r,I=(0,P.__rest)(s,["top","left","right","bottom","size","r"]),G=this.getSize(a),U=G[0],et=G[1];f&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:-U/2,y:0,r:x/2||w||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),d&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:U/2,y:0,r:x/2||w||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),l&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:0,y:-et/2,r:x/2||w||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),v&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:0,y:et/2,r:x/2||w||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getPath:function(a){var e=this.getSize(a),i=e[0],s=e[1],l=[["M",0,-s/2],["L",i/2,0],["L",0,s/2],["L",-i/2,0],["Z"]];return l},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,k.mix)({},e,i),l=this.getPath(a),f=(0,P.__assign)({path:l},s);return f},update:function(a,e,i){var s=e.getContainer(),l=this.getOptions({}).style,f=this.getPath(a),d={stroke:a.color,path:f},v=e.get("keyShape"),x=(0,k.mix)({},l,v.attr(),d);x=(0,k.mix)(x,a.style),this.updateShape(a,e,x,!0,i),this.updateLinkPoints(a,s)}},"single-node"),zc("triangle",{options:{size:40,direction:"up",style:{stroke:oi.defaultNode.style.stroke,fill:oi.defaultNode.style.fill,lineWidth:oi.defaultNode.style.lineWidth},labelCfg:{style:{fill:oi.nodeLabel.style.fill,fontSize:oi.nodeLabel.style.fontSize},offset:15},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:oi.defaultNode.linkPoints.size,lineWidth:oi.defaultNode.linkPoints.lineWidth,fill:oi.defaultNode.linkPoints.fill,stroke:oi.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20,offset:6},stateStyles:(0,P.__assign)({},oi.nodeStateStyles)},shapeType:"triangle",labelPosition:"bottom",drawShape:function(a,e){var i=this.mergeStyle||this.getOptions(a),s=i.icon,l=s===void 0?{}:s,f=i.direction,d=this.getShapeStyle(a),v=a.direction||f,x=e.addShape("path",{attrs:d,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e.shapeMap["".concat(this.type,"-keyShape")]=x;var w=l.width,I=l.height,G=l.show,U=l.offset,et=l.text;if(G)if(et)e.shapeMap["".concat(this.type,"-icon")]=e.addShape("text",{attrs:(0,P.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},l),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0});else{var ft=-w/2,Ct=-I/2;(v==="up"||v==="down")&&(Ct+=U),(v==="left"||v==="right")&&(ft+=U),e.shapeMap["".concat(this.type,"-icon")]=e.addShape("image",{attrs:(0,P.__assign)({x:ft,y:Ct},l),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})}return this.drawLinkPoints(a,e),x},drawLinkPoints:function(a,e){var i=this.mergeStyle||this.getOptions(a),s=i.linkPoints,l=s===void 0?{}:s,f=i.direction,d=a.direction||f,v=l.top,x=l.left,w=l.right,I=l.bottom,G=l.size,U=l.r,et=(0,P.__rest)(l,["top","left","right","bottom","size","r"]),ft=this.getSize(a),Ct=ft[0];if(x){var Mt=null,kt=Ct*Math.sin(1/3*Math.PI),$t=Ct*Math.sin(1/3*Math.PI);d==="up"?Mt=[-$t,kt]:d==="down"?Mt=[-$t,-kt]:d==="left"&&(Mt=[-$t,$t-kt]),Mt&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},et),{x:Mt[0],y:Mt[1],r:G/2||U||5}),className:"link-point-left",name:"link-point-left"}))}if(w){var Jt=null,kt=Ct*Math.sin(1/3*Math.PI),$t=Ct*Math.sin(1/3*Math.PI);d==="up"?Jt=[$t,kt]:d==="down"?Jt=[$t,-kt]:d==="right"&&(Jt=[$t,$t-kt]),Jt&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},et),{x:Jt[0],y:Jt[1],r:G/2||U||5}),className:"link-point-right",name:"link-point-right"}))}if(v){var Ce=null,kt=Ct*Math.sin(1/3*Math.PI),$t=Ct*Math.sin(1/3*Math.PI);d==="up"?Ce=[$t-kt,-kt]:d==="left"?Ce=[$t,-kt]:d==="right"&&(Ce=[-$t,-kt]),Ce&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},et),{x:Ce[0],y:Ce[1],r:G/2||U||5}),className:"link-point-top",name:"link-point-top"}))}if(I){var je=null,kt=Ct*Math.sin(1/3*Math.PI),$t=Ct*Math.sin(1/3*Math.PI);d==="down"?je=[-$t+kt,kt]:d==="left"?je=[$t,kt]:d==="right"&&(je=[-$t,kt]),je&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},et),{x:je[0],y:je[1],r:G/2||U||5}),className:"link-point-bottom",name:"link-point-bottom"}))}},getPath:function(a){var e=(this.mergeStyle||this.getOptions(a)).direction,i=a.direction||e,s=this.getSize(a),l=s[0],f=l*Math.sin(1/3*Math.PI),d=l*Math.sin(1/3*Math.PI),v=[["M",-d,f],["L",0,-f],["L",d,f],["Z"]];return i==="down"?v=[["M",-d,-f],["L",d,-f],["L",0,f],["Z"]]:i==="left"?v=[["M",-d,d-f],["L",d,-d],["L",d,d],["Z"]]:i==="right"&&(v=[["M",d,d-f],["L",-d,d],["L",-d,-d],["Z"]]),v},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,k.mix)({},e,i),l=this.getPath(a),f=(0,P.__assign)({path:l},s);return f},update:function(a,e,i){var s=e.getContainer(),l=this.getOptions({}).style,f=this.getPath(a),d={stroke:a.color,path:f},v=e.get("keyShape"),x=(0,k.mix)({},l,v.attr(),d);x=(0,k.mix)(x,a.style),this.updateShape(a,e,x,!0,i),this.updateLinkPoints(a,s)},updateLinkPoints:function(a,e){var i=this.getOptions({}),s=i.linkPoints,l=i.direction,f=a.direction||l,d=e.shapeMap["link-point-left"]||e.find(function(Ca){return Ca.get("className")==="link-point-left"}),v=e.shapeMap["link-point-right"]||e.find(function(Ca){return Ca.get("className")==="link-point-right"}),x=e.shapeMap["link-point-top"]||e.find(function(Ca){return Ca.get("className")==="link-point-top"}),w=e.shapeMap["link-point-bottom"]||e.find(function(Ca){return Ca.get("className")==="link-point-bottom"}),I=s,G=d||v||x||w;G&&(I=G.attr());var U=(0,k.mix)({},I,a.linkPoints),et=U.fill,ft=U.stroke,Ct=U.lineWidth,Mt=U.size/2;Mt||(Mt=U.r);var kt=a.linkPoints?a.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},$t=kt.left,Jt=kt.right,Ce=kt.top,je=kt.bottom,ze=this.getSize(a),pn=ze[0],Fn={r:Mt,fill:et,stroke:ft,lineWidth:Ct},Tn=null,cr=pn*Math.sin(1/3*Math.PI),kr=pn*Math.sin(1/3*Math.PI);f==="up"?Tn=[-kr,cr]:f==="down"?Tn=[-kr,-cr]:f==="left"&&(Tn=[-kr,kr-cr]),Tn&&(d?!$t&&$t!==void 0?(d.remove(),delete e.shapeMap["link-point-left"]):d.attr((0,P.__assign)((0,P.__assign)({},Fn),{x:Tn[0],y:Tn[1]})):$t&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},Fn),{x:Tn[0],y:Tn[1]}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})));var Aa=null;f==="up"?Aa=[kr,cr]:f==="down"?Aa=[kr,-cr]:f==="right"&&(Aa=[kr,kr-cr]),Aa&&(v?!Jt&&Jt!==void 0?(v.remove(),delete e.shapeMap["link-point-right"]):v.attr((0,P.__assign)((0,P.__assign)({},Fn),{x:Aa[0],y:Aa[1]})):Jt&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},Fn),{x:Aa[0],y:Aa[1]}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})));var ci=null;f==="up"?ci=[kr-cr,-cr]:f==="left"?ci=[kr,-cr]:f==="right"&&(ci=[-kr,-cr]),ci&&(x?!Ce&&Ce!==void 0?(x.remove(),delete e.shapeMap["link-point-top"]):x.attr((0,P.__assign)((0,P.__assign)({},Fn),{x:ci[0],y:ci[1]})):Ce&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},Fn),{x:ci[0],y:ci[1]}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})));var ei=null;f==="down"?ei=[-kr+cr,cr]:f==="left"?ei=[kr,cr]:f==="right"&&(ei=[-kr,cr]),ei&&(w?!je&&je!==void 0?(w.remove(),delete e.shapeMap["link-point-bottom"]):w.attr((0,P.__assign)((0,P.__assign)({},Fn),{x:ei[0],y:ei[1]})):je&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},Fn),{x:ei[0],y:ei[1]}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})))}},"single-node"),zc("modelRect",{options:{size:[185,70],style:{radius:5,stroke:"#69c0ff",fill:"#ffffff",lineWidth:oi.defaultNode.style.lineWidth,fillOpacity:1},labelCfg:{style:{fill:"#595959",fontSize:14,fontFamily:oi.windowFontFamily},offset:30},descriptionCfg:{style:{fontSize:12,fill:"#bfbfbf",fontFamily:oi.windowFontFamily},paddingTop:0},preRect:{show:!0,width:4,fill:"#40a9ff",radius:2},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:10,lineWidth:1,fill:"#72CC4A",stroke:"#72CC4A"},logoIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg",width:16,height:16,offset:0},stateIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg",width:16,height:16,offset:-5},anchorPoints:[[0,.5],[1,.5]]},shapeType:"modelRect",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).preRect,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=this.getSize(a),d=f[0],v=f[1],x=e.addShape("rect",{attrs:l,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e.shapeMap["".concat(this.type,"-keyShape")]=x;var w=s.show,I=(0,P.__rest)(s,["show"]);return w&&(e.shapeMap["pre-rect"]=e.addShape("rect",{attrs:(0,P.__assign)({x:-d/2,y:-v/2,height:v},I),className:"pre-rect",name:"pre-rect",draggable:!0})),this.drawLogoIcon(a,e),this.drawStateIcon(a,e),this.drawLinkPoints(a,e),x},drawLogoIcon:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).logoIcon,s=i===void 0?{}:i,l=this.getSize(a),f=l[0];if(s.show){var d=s.width,v=s.height,x=s.x,w=s.y,I=s.offset,G=s.text,U=(0,P.__rest)(s,["width","height","x","y","offset","text"]);G?e.shapeMap["rect-logo-icon"]=e.addShape("text",{attrs:(0,P.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},U),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0}):e.shapeMap["rect-logo-icon"]=e.addShape("image",{attrs:(0,P.__assign)((0,P.__assign)({},U),{x:x||-f/2+d+I,y:w||-v/2,width:d,height:v}),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0})}},drawStateIcon:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).stateIcon,s=i===void 0?{}:i,l=this.getSize(a),f=l[0];if(s.show){var d=s.width,v=s.height,x=s.x,w=s.y,I=s.offset,G=s.text,U=(0,P.__rest)(s,["width","height","x","y","offset","text"]);G?e.shapeMap["rect-state-icon"]=e.addShape("text",{attrs:(0,P.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},U),className:"rect-state-icon",name:"rect-state-icon",draggable:!0}):e.shapeMap["rect-state-icon"]=e.addShape("image",{attrs:(0,P.__assign)((0,P.__assign)({},U),{x:x||f/2-d+I,y:w||-v/2,width:d,height:v}),className:"rect-state-icon",name:"rect-state-icon",draggable:!0})}},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=i===void 0?{}:i,l=s.top,f=s.left,d=s.right,v=s.bottom,x=s.size,w=s.r,I=(0,P.__rest)(s,["top","left","right","bottom","size","r"]),G=this.getSize(a),U=G[0],et=G[1];f&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:-U/2,y:0,r:x/2||w||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),d&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:U/2,y:0,r:x/2||w||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),l&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:0,y:-et/2,r:x/2||w||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),v&&(e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},I),{x:0,y:et/2,r:x/2||w||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},drawLabel:function(a,e){var i=this.getOptions(a),s=i.labelCfg,l=s===void 0?{}:s,f=i.logoIcon,d=f===void 0?{}:f,v=i.descriptionCfg,x=v===void 0?{}:v,w=this.getSize(a),I=w[0],G=null,U=d.show,et=d.width,ft=-I/2+l.offset;U&&(ft=-I/2+et+l.offset);var Ct=l.style,Mt=x.style,kt=x.paddingTop;return(0,k.isString)(a.description)?(G=e.addShape("text",{attrs:(0,P.__assign)((0,P.__assign)({},Ct),{x:ft,y:-5,text:a.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),e.shapeMap["text-shape"]=G,e.shapeMap["rect-description"]=e.addShape("text",{attrs:(0,P.__assign)((0,P.__assign)({},Mt),{x:ft,y:17+(kt||0),text:a.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0})):(G=e.addShape("text",{attrs:(0,P.__assign)((0,P.__assign)({},Ct),{x:ft,y:7,text:a.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),e.shapeMap["text-shape"]=G),G},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,k.mix)({},e,i),l=this.getSize(a),f=s.width||l[0],d=s.height||l[1],v=(0,P.__assign)({x:-f/2,y:-d/2,width:f,height:d},s);return v},update:function(a,e){var i=this.mergeStyle||this.getOptions(a),s=i.style,l=s===void 0?{}:s,f=i.labelCfg,d=f===void 0?{}:f,v=i.descriptionCfg,x=v===void 0?{}:v,w=this.getSize(a),I=w[0],G=w[1],U=e.get("keyShape");U.attr((0,P.__assign)((0,P.__assign)({},l),{x:-I/2,y:-G/2,width:I,height:G}));var et=e.getContainer(),ft=et.shapeMap["rect-logo-icon"]||et.find(function(Fs){return Fs.get("className")==="rect-logo-icon"}),Ct=ft?ft.attr():{},Mt=(0,k.mix)({},Ct,a.logoIcon),kt=Mt.width;kt===void 0&&(kt=this.options.logoIcon.width);var $t=a.logoIcon?a.logoIcon.show:void 0,Jt=d.offset,Ce=-I/2+kt+Jt;!$t&&$t!==void 0&&(Ce=-I/2+Jt);var je=et.shapeMap["node-label"]||et.find(function(Fs){return Fs.get("className")==="node-label"}),ze=et.shapeMap["rect-description"]||et.find(function(Fs){return Fs.get("className")==="rect-description"});if(a.label)if(!je)et.shapeMap["node-label"]=et.addShape("text",{attrs:(0,P.__assign)((0,P.__assign)({},d.style),{x:Ce,y:a.description?-5:7,text:a.label}),className:"node-label",name:"node-label",draggable:!0,labelRelated:!0});else{var pn=a.labelCfg?a.labelCfg.style:{},Fn=(0,k.mix)({},je.attr(),pn);a.label&&(Fn.text=a.label),Fn.x=Ce,(0,k.isString)(a.description)&&(Fn.y=-5),ze&&(ze.resetMatrix(),ze.attr({x:Ce})),je.resetMatrix(),je.attr(Fn)}if((0,k.isString)(a.description)){var Tn=x.paddingTop;if(!ze)et.shapeMap["rect-description"]=et.addShape("text",{attrs:(0,P.__assign)((0,P.__assign)({},x.style),{x:Ce,y:17+(Tn||0),text:a.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0});else{var pn=a.descriptionCfg?a.descriptionCfg.style:{},cr=(0,k.mix)({},ze.attr(),pn);(0,k.isString)(a.description)&&(cr.text=a.description),cr.x=Ce,ze.resetMatrix(),ze.attr((0,P.__assign)((0,P.__assign)({},cr),{y:17+(Tn||0)}))}}var kr=et.shapeMap["pre-rect"]||et.find(function(Fs){return Fs.get("className")==="pre-rect"});if(kr&&!kr.destroyed){var Aa=(0,k.mix)({},kr.attr(),a.preRect);kr.attr((0,P.__assign)((0,P.__assign)({},Aa),{x:-I/2,y:-G/2,height:G}))}if(ft&&!ft.destroyed)if(!$t&&$t!==void 0)ft.remove(),delete et.shapeMap["pre-rect"];else{var ci=Mt.width,ei=Mt.height,Ca=Mt.x,Pi=Mt.y,Ni=Mt.offset,_a=(0,P.__rest)(Mt,["width","height","x","y","offset"]);ft.attr((0,P.__assign)((0,P.__assign)({},_a),{x:Ca||-I/2+ci+Ni,y:Pi||-ei/2,width:ci,height:ei}))}else $t&&this.drawLogoIcon(a,et);var Ya=et.shapeMap["rect-state-icon"]||et.find(function(Fs){return Fs.get("className")==="rect-state-icon"}),hi=Ya?Ya.attr():{},di=(0,k.mix)({},hi,a.stateIcon);if(Ya){!di.show&&di.show!==void 0&&(Ya.remove(),delete et.shapeMap["rect-state-icon"]);var Xi=di.width,ei=di.height,Ca=di.x,Pi=di.y,go=di.offset,vs=(0,P.__rest)(di,["width","height","x","y","offset"]);Ya.attr((0,P.__assign)((0,P.__assign)({},vs),{x:Ca||I/2-Xi+go,y:Pi||-ei/2,width:Xi,height:ei}))}else di.show&&this.drawStateIcon(a,et);this.updateLinkPoints(a,et)},getOptions:function(a,e){return e==="move"?a:(0,k.deepMix)({},this.options,this.getCustomConfig(a)||{},a)}},"single-node"),zc("star",{options:{size:60,style:{stroke:oi.defaultNode.style.stroke,fill:oi.defaultNode.style.fill,lineWidth:oi.defaultNode.style.lineWidth},labelCfg:{style:{fill:oi.nodeLabel.style.fill,fontSize:oi.nodeLabel.style.fontSize,fontFamily:oi.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:oi.defaultNode.linkPoints.size,lineWidth:oi.defaultNode.linkPoints.lineWidth,fill:oi.defaultNode.linkPoints.fill,stroke:oi.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:(0,P.__assign)({},oi.nodeStateStyles)},shapeType:"star",labelPosition:"center",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).icon,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=e.addShape("path",{attrs:l,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});e.shapeMap["".concat(this.type,"-keyShape")]=f;var d=s.width,v=s.height,x=s.show,w=s.text;return x&&(w?e.shapeMap["".concat(this.type,"-icon")]=e.addShape("text",{attrs:(0,P.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.shapeMap["".concat(this.type,"-icon")]=e.addShape("image",{attrs:(0,P.__assign)({x:-d/2,y:-v/2},s),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(a,e),f},drawLinkPoints:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).linkPoints,s=i===void 0?{}:i,l=s.top,f=s.left,d=s.right,v=s.leftBottom,x=s.rightBottom,w=s.size,I=s.r,G=(0,P.__rest)(s,["top","left","right","leftBottom","rightBottom","size","r"]),U=this.getSize(a),et=U[0];if(d){var ft=Math.cos((18+72*0)/180*Math.PI)*et,Ct=Math.sin((18+72*0)/180*Math.PI)*et;e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},G),{x:ft,y:-Ct,r:w/2||I||5}),className:"link-point-right",name:"link-point-right"})}if(l){var ft=Math.cos((18+72*1)/180*Math.PI)*et,Ct=Math.sin((18+72*1)/180*Math.PI)*et;e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},G),{x:ft,y:-Ct,r:w/2||I||5}),className:"link-point-top",name:"link-point-top"})}if(f){var ft=Math.cos((18+72*2)/180*Math.PI)*et,Ct=Math.sin((18+72*2)/180*Math.PI)*et;e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},G),{x:ft,y:-Ct,r:w/2||I||5}),className:"link-point-left",name:"link-point-left"})}if(v){var ft=Math.cos((18+72*3)/180*Math.PI)*et,Ct=Math.sin((18+72*3)/180*Math.PI)*et;e.shapeMap["link-point-bottom"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},G),{x:ft,y:-Ct,r:w/2||I||5}),className:"link-point-left-bottom",name:"link-point-left-bottom"})}if(x){var ft=Math.cos((18+72*4)/180*Math.PI)*et,Ct=Math.sin((18+72*4)/180*Math.PI)*et;e.shapeMap["link-point-right-bottom"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},G),{x:ft,y:-Ct,r:w/2||I||5}),className:"link-point-right-bottom",name:"link-point-right-bottom"})}},getPath:function(a){var e=this.getSize(a),i=e[0],s=i*3/8,l=a.innerR||s;return Sc.getStarPath(i,l)},getShapeStyle:function(a){var e=(this.mergeStyle||this.getOptions(a)).style,i={stroke:a.color},s=(0,k.mix)({},e,i),l=this.getPath(a),f=(0,P.__assign)({path:l},s);return f},update:function(a,e,i){var s=e.getContainer(),l=this.getOptions({}).style,f=this.getPath(a),d={stroke:a.color,path:f},v=e.get("keyShape"),x=(0,k.mix)({},l,v.attr(),d);x=(0,k.mix)(x,a.style),this.updateShape(a,e,x,!0,i),this.updateLinkPoints(a,s)},updateLinkPoints:function(a,e){var i=this.getOptions({}).linkPoints,s=e.shapeMap["link-point-left"]||e.find(function(cr){return cr.get("className")==="link-point-left"}),l=e.shapeMap["link-point-right"]||e.find(function(cr){return cr.get("className")==="link-point-right"}),f=e.shapeMap["link-point-top"]||e.find(function(cr){return cr.get("className")==="link-point-top"}),d=e.shapeMap["link-point-left-bottom"]||e.find(function(cr){return cr.get("className")==="link-point-left-bottom"}),v=e.shapeMap["link-point-left-bottom"]||e.find(function(cr){return cr.get("className")==="link-point-right-bottom"}),x=i,w=s||l||f||d||v;w&&(x=w.attr());var I=(0,k.mix)({},x,a.linkPoints),G=I.fill,U=I.stroke,et=I.lineWidth,ft=I.size/2;ft||(ft=I.r);var Ct=a.linkPoints?a.linkPoints:{left:void 0,right:void 0,top:void 0,leftBottom:void 0,rightBottom:void 0},Mt=Ct.left,kt=Ct.right,$t=Ct.top,Jt=Ct.leftBottom,Ce=Ct.rightBottom,je=this.getSize(a),ze=je[0],pn={r:ft,fill:G,stroke:U,lineWidth:et},Fn=Math.cos((18+72*0)/180*Math.PI)*ze,Tn=Math.sin((18+72*0)/180*Math.PI)*ze;l?!kt&&kt!==void 0?(l.remove(),delete e.shapeMap["link-point-right"]):l.attr((0,P.__assign)((0,P.__assign)({},pn),{x:Fn,y:-Tn})):kt&&(e.shapeMap["link-point-right"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},pn),{x:Fn,y:-Tn}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),Fn=Math.cos((18+72*1)/180*Math.PI)*ze,Tn=Math.sin((18+72*1)/180*Math.PI)*ze,f?!$t&&$t!==void 0?(f.remove(),delete e.shapeMap["link-point-top"]):f.attr((0,P.__assign)((0,P.__assign)({},pn),{x:Fn,y:-Tn})):$t&&(e.shapeMap["link-point-top"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},pn),{x:Fn,y:-Tn}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),Fn=Math.cos((18+72*2)/180*Math.PI)*ze,Tn=Math.sin((18+72*2)/180*Math.PI)*ze,s?!Mt&&Mt!==void 0?(s.remove(),delete e.shapeMap["link-point-left"]):s.attr((0,P.__assign)((0,P.__assign)({},pn),{x:Fn,y:-Tn})):Mt&&(e.shapeMap["link-point-left"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},pn),{x:Fn,y:-Tn}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),Fn=Math.cos((18+72*3)/180*Math.PI)*ze,Tn=Math.sin((18+72*3)/180*Math.PI)*ze,d?!Jt&&Jt!==void 0?(d.remove(),delete e.shapeMap["link-point-left-bottom"]):d.attr((0,P.__assign)((0,P.__assign)({},pn),{x:Fn,y:-Tn})):Jt&&(e.shapeMap["link-point-left-bottom"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},pn),{x:Fn,y:-Tn}),className:"link-point-left-bottom",name:"link-point-left-bottom",isAnchorPoint:!0})),Fn=Math.cos((18+72*4)/180*Math.PI)*ze,Tn=Math.sin((18+72*4)/180*Math.PI)*ze,v?!Ce&&Ce!==void 0?(v.remove(),delete e.shapeMap["link-point-right-bottom"]):v.attr((0,P.__assign)((0,P.__assign)({},pn),{x:Fn,y:-Tn})):Ce&&(e.shapeMap["link-point-right-bottom"]=e.addShape("circle",{attrs:(0,P.__assign)((0,P.__assign)({},pn),{x:Fn,y:-Tn}),className:"link-point-right-bottom",name:"link-point-right-bottom",isAnchorPoint:!0}))}},"single-node");var bE=Sc.defaultSubjectColors,Uf="fan-shape-";zc("donut",{options:{size:oi.defaultNode.size,style:{x:0,y:0,stroke:oi.defaultNode.style.stroke,fill:oi.defaultNode.style.fill,lineWidth:oi.defaultNode.style.lineWidth},labelCfg:{style:{fill:oi.nodeLabel.style.fill,fontSize:oi.nodeLabel.style.fontSize,fontFamily:oi.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:oi.defaultNode.linkPoints.size,lineWidth:oi.defaultNode.linkPoints.lineWidth,fill:oi.defaultNode.linkPoints.fill,stroke:oi.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:(0,P.__assign)({},oi.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(a,e){var i=(this.mergeStyle||this.getOptions(a)).icon,s=i===void 0?{}:i,l=this.getShapeStyle(a),f=(0,k.deepMix)({},s,a.icon),d=e.addShape("circle",{attrs:l,className:"".concat(this.type,"-keyShape"),draggable:!0,name:"".concat(this.type,"-keyShape")});e.shapeMap["".concat(this.type,"-keyShape")]=d;var v=f.width,x=f.height,w=f.show,I=f.text;return w&&(I?e.shapeMap["".concat(this.type,"-icon")]=e.addShape("text",{attrs:(0,P.__assign)({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},f),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):e.shapeMap["".concat(this.type,"-icon")]=e.addShape("image",{attrs:(0,P.__assign)({x:-v/2,y:-x/2},f),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),xE(a,e,d),this.drawLinkPoints(a,e),d},updateShape:function(a,e,i,s,l){var f=e.get("keyShape");f.attr((0,P.__assign)({},i)),wE(a,e,f),this.updateLabel(a,e,l),s&&this.updateIcon(a,e)}},"circle");var xE=function(a,e,i){var s=a.donutAttrs,l=s===void 0?{}:s,f=a.donutColorMap,d=f===void 0?{}:f,v=Object.keys(l).length;if(l&&v>1){var x=gg(l,d),w=x.configs,I=x.totalValue;if(I){var G=EE(i),U=G.lineWidth,et=G.arcR,ft=[et,0],Ct=0;if(v===1){Vg(e,{arcR:et,arcBegin:ft,beginAngle:Ct,config:w[0],fanIndex:0,lineWidth:U,totalValue:I,drawWhole:!0});return}for(var Mt=0;Mt<w.length;Mt++){var kt=Vg(e,{arcR:et,arcBegin:ft,beginAngle:Ct,config:w[Mt],fanIndex:Mt,lineWidth:U,totalValue:I});if(kt.shouldEnd)return;ft=kt.arcBegin,Ct=kt.beginAngle}}}},Vg=function(a,e){var i=e.arcR,s=e.arcBegin,l=e.beginAngle,f=e.config,d=e.fanIndex,v=e.lineWidth,x=e.totalValue,w=e.drawWhole,I=w===void 0?!1:w,G=e.updateShape,U=G===void 0?void 0:G,et=f.value/x;if(et<.001)return{beginAngle:l,arcBegin:s,shape:void 0,shouldEnd:!1};var ft,Ct,Mt;if(I||et>.999)ft=[i,1e-4],Mt=1;else{var kt=et*Math.PI*2;Ct=l+kt,ft=[i*Math.cos(Ct),-i*Math.sin(Ct)],Mt=kt>Math.PI?1:0}var $t={path:[["M",s[0],s[1]],["A",i,i,0,Mt,0,ft[0],ft[1]]],stroke:f.color||(U==null?void 0:U.attr("stroke"))||bE[d%bE.length],lineWidth:v};return U?U.attr($t):a.shapeMap["".concat(Uf).concat(d)]=a.addShape("path",{attrs:$t,name:"".concat(Uf).concat(d),draggable:!0}),{beginAngle:Ct,arcBegin:ft,shape:a.shapeMap["".concat(Uf).concat(d)],shouldEnd:I||et>.999}},wE=function(a,e,i){var s=a.donutAttrs,l=a.donutColorMap,f=l===void 0?{}:l,d={},v=e.getContainer();if(s){var x=gg(s,f),w=x.configs,I=x.totalValue;if(I)for(var G=EE(i),U=G.lineWidth,et=G.arcR,ft=[et,0],Ct=0,Mt=0;Mt<w.length;Mt++){var kt="".concat(Uf).concat(Mt),$t=Vg(v,{arcR:et,arcBegin:ft,beginAngle:Ct,config:w[Mt],fanIndex:Mt,lineWidth:U,totalValue:I,drawWhole:w.length===1,updateShape:v.shapeMap[kt]});if($t.shape&&(d[kt]=!0),$t.shouldEnd)break;ft=$t.arcBegin,Ct=$t.beginAngle}}var Jt=Object.keys(v.shapeMap).filter(function(Ce){return Ce.includes(Uf)});Jt.forEach(function(Ce){d[Ce]||(v.shapeMap[Ce].remove(!0),delete v.shapeMap[Ce])})},gg=function(a,e){var i=0,s=[];return Object.keys(a).forEach(function(l){var f=+a[l];isNaN(f)||(s.push({key:l,value:f,color:e[l]}),i+=f)}),{totalValue:i,configs:s}},EE=function(a){var e=a.attr("r"),i=.6*e,s=(e+i)/2,l=e-i;return{lineWidth:l,arcR:s}},I0=function(a){var e=a.x,i=a.y;return{x:e,y:i,centerX:e,centerY:i,minX:e,minY:i,maxX:e,maxY:i,height:0,width:0}},SE=function(a){a===void 0&&(a=[]);var e=[],i=[];a.forEach(function(v){e.push(v.x),i.push(v.y)});var s=Math.min.apply(Math,e),l=Math.max.apply(Math,e),f=Math.min.apply(Math,i),d=Math.max.apply(Math,i);return{centerX:(s+l)/2,centerY:(f+d)/2,maxX:l,maxY:d,minX:s,minY:f,height:d-f,width:l-s}},$A=function(a,e){return Math.abs(a.centerX-e.centerX)*2<a.width+e.width&&Math.abs(a.centerY-e.centerY)*2<a.height+e.height},Wy=function(a){for(var e=[],i={},s=a.length,l=s-1;l>=0;l--){var f=a[l];f.id="".concat(f.x,"|||").concat(f.y),i[f.id]||(i[f.id]=f,e.push(f))}return e},CE=function(a){return Wy(a)},jg=function(a,e){return[a,{x:a.x,y:e.y},e]},Hg=function(a,e){return a.width||a.height?{centerX:a.centerX,centerY:a.centerY,minX:a.minX-e,minY:a.minY-e,maxX:a.maxX+e,maxY:a.maxY+e,height:a.height+2*e,width:a.width+2*e}:a},Am=function(a,e){var i=Math.abs(a.x-e.centerX),s=Math.abs(a.y-e.centerY);return i===0&&s===0?0:i/e.width>s/e.height},wv=function(a,e,i){var s=Am(e,a);if(s===0){var l=a.centerX,f=a.centerY;return i.y<e.y?f=a.minY:i.x>e.x?l=a.maxX:i.x<e.x?l=a.minX:i.x===e.x&&(f=a.maxY),{x:l,y:f}}return s?{x:e.x>a.centerX?a.maxX:a.minX,y:e.y}:{x:e.x,y:e.y>a.centerY?a.maxY:a.minY}},_E=function(a,e){var i=Math.min(a.minX,e.minX),s=Math.min(a.minY,e.minY),l=Math.max(a.maxX,e.maxX),f=Math.max(a.maxY,e.maxY);return{centerX:(i+l)/2,centerY:(s+f)/2,minX:i,minY:s,maxX:l,maxY:f,height:f-s,width:l-i}},Vb=function(a){return[{x:a.minX,y:a.minY},{x:a.maxX,y:a.minY},{x:a.maxX,y:a.maxY},{x:a.minX,y:a.maxY}]},jb=function(a,e){var i=a.x,s=a.y;return i<e.minX||i>e.maxX||s<e.minY||s>e.maxY},GA=function(a,e){return e<a.minX||e>a.maxX?[]:[{x:e,y:a.minY},{x:e,y:a.maxY}]},Fp=function(a,e){return e<a.minY||e>a.maxY?[]:[{x:a.minX,y:e},{x:a.maxX,y:e}]},IE=function(a,e){return GA(a,e.x).concat(Fp(a,e.y))},Vy=function(a,e){return Math.abs(a.x-e.x)+Math.abs(a.y-e.y)},UA=function(a,e){var i=-2,s=0;return e.forEach(function(l){l&&(a.x===l.x&&(s+=i),a.y===l.y&&(s+=i))}),s},nI=function(a,e,i,s,l){return Vy(a,e)+Vy(a,i)+UA(a,[e,i,s,l])},WA=function c(a,e,i,s,l){l===void 0&&(l=0),a.unshift(e[s]),i[s]&&i[s]!==s&&l<=100&&c(a,e,i,i[s],l+1)},jy=function(a,e){var i=a.indexOf(e);i>-1&&a.splice(i,1)},mg=function(a,e,i,s){var l=i.x-a.x,f=i.y-a.y,d=s.x-a.x,v=s.y-a.y,x=i.x-e.x,w=i.y-e.y,I=s.x-e.x,G=s.y-e.y,U=l*v-f*d,et=x*G-w*I,ft=l*w-f*x,Ct=d*G-v*I;return U*et<=0&&ft*Ct<=0},Hb=function(a,e,i){if(i.width||i.height){var s=Vb(i),l=s[0],f=s[1],d=s[2],v=s[3];return mg(a,e,l,f)||mg(a,e,l,v)||mg(a,e,f,d)||mg(a,e,d,v)}return!1},rI=function(a,e,i,s){var l=[];return a.forEach(function(f){if(f!==e&&(f.x===e.x||f.y===e.y)){if(Hb(f,e,i)||Hb(f,e,s))return;l.push(f)}}),Wy(l)},aI=function(a,e,i,s,l,f,d){var v,x=[],w=(v={},v[e.id]=e,v),I={},G={},U={};G[e.id]=0,U[e.id]=nI(e,i,e);var et=new Xy;et.add({id:e.id,value:U[e.id]});var ft={};a.forEach(function(Ce){ft[Ce.id]=Ce});for(var Ct;Object.keys(w).length;){var Mt=et.minId(!1);if(Mt)Ct=w[Mt];else break;if(Ct===i){var kt=[];return WA(kt,ft,I,i.id),kt}delete w[Ct.id],et.remove(Ct.id),x.push(Ct);var $t=rI(a,Ct,s,l),Jt=function(je){je.forEach(function(ze){if(x.indexOf(ze)===-1){var pn=ze.id;w[pn]||(w[pn]=ze);var Fn=U[Ct.id]+Vy(Ct,ze);if(G[pn]&&Fn>=G[pn]){et.add({id:pn,value:U[pn]});return}I[pn]=Ct.id,G[pn]=Fn,U[pn]=G[pn]+nI(ze,i,e,f,d),et.add({id:pn,value:U[pn]})}})};Jt($t)}return[e,i]},Xg=function(a,e,i){return!(a.x===e.x&&e.x===i.x||a.y===e.y&&e.y===i.y)},Xb=function(a,e,i,s){var l=Vy(a,e),f=Vy(i,e);l<s&&(s=l),f<s&&(s=f);var d={x:e.x-s/l*(e.x-a.x),y:e.y-s/l*(e.y-a.y)},v={x:e.x-s/f*(e.x-i.x),y:e.y-s/f*(e.y-i.y)};return[d,v]},T0=function(a,e){var i=[],s=a[0];return i.push("M".concat(s.x," ").concat(s.y)),a.forEach(function(l,f){var d=a[f+1],v=a[f+2];if(d&&v)if(Xg(l,d,v)){var x=Xb(l,d,v,e),w=x[0],I=x[1];i.push("L".concat(w.x," ").concat(w.y)),i.push("Q".concat(d.x," ").concat(d.y," ").concat(I.x," ").concat(I.y)),i.push("L".concat(I.x," ").concat(I.y))}else i.push("L".concat(d.x," ").concat(d.y));else d&&i.push("L".concat(d.x," ").concat(d.y))}),i.join("")},Hy=function(a,e,i,s,l){var f,d;if(!i||!i.getType())f=I0(a);else if(i.getType()==="combo"){var v=i.getKeyShape().getBBox();if(v){var x=i.getModel(),w=x.x,I=x.y;f={x:w,y:I,width:v.width,height:v.height,minX:v.minX+w,maxX:v.maxX+w,minY:v.minY+I,maxY:v.maxY+I},f.centerX=(f.minX+f.maxX)/2,f.centerY=(f.minY+f.maxY)/2}else f=I0(a)}else f=i&&i.getBBox();if(!s||!s.getType())d=I0(e);else if(s.getType()==="combo"){var G=s.getKeyShape().getBBox();if(G){var U=s.getModel(),et=U.x,ft=U.y;d={x:et,y:ft,width:G.width,height:G.height,minX:G.minX+et,maxX:G.maxX+et,minY:G.minY+ft,maxY:G.maxY+ft},d.centerX=(d.minX+d.maxX)/2,d.centerY=(d.minY+d.maxY)/2}else d=I0(e)}else d=s&&s.getBBox();var Ct=Hg(f,l),Mt=Hg(d,l),kt=wv(Ct,a,e),$t=wv(Mt,e,a),Jt=SE([kt,$t]),Ce=_E(Ct,Jt),je=_E(Mt,Jt),ze=[];ze=ze.concat(Vb(Ce)).concat(Vb(je));var pn={x:(a.x+e.x)/2,y:(a.y+e.y)/2};[Jt,Ce,je].forEach(function(Tn){ze=ze.concat(IE(Tn,pn).filter(function(cr){return jb(cr,Ct)&&jb(cr,Mt)}))}),[{x:kt.x,y:$t.y},{x:$t.x,y:kt.y}].forEach(function(Tn){jb(Tn,Ct)&&jb(Tn,Mt)&&ze.push(Tn)}),ze.unshift(kt),ze.push($t),ze=Wy(ze);var Fn=aI(ze,kt,$t,f,d,a,e);return Fn.unshift(a),Fn.push(e),CE(Fn)},TE=function(a){if(!(a==null?void 0:a.length))return a;for(var e=a[a.length-1],i={x:e.x,y:e.y},s=[e],l=[e],f=a.length-2;f>=0;f--){var d=a[f];if(d.x===i.x?s.push(d):(s=[d],i.x=d.x),d.y===i.y?l.push(d):(l=[d],i.y=d.y),s.length>2){var v=a.indexOf(s[1]);v>-1&&a.splice(v,1);continue}if(l.length>2){var v=a.indexOf(l[1]);v>-1&&a.splice(v,1)}}return a},Xy=function(){function c(){this.arr=[],this.map={},this.arr=[],this.map={}}return c.prototype._innerAdd=function(a,e){for(var i=[0,e-1];i[1]-i[0]>1;){var s=Math.floor((i[0]+i[1])/2);if(this.arr[s].value>a.value)i[1]=s;else if(this.arr[s].value<a.value)i[0]=s;else{this.arr.splice(s,0,a),this.map[a.id]=!0;return}}this.arr.splice(i[1],0,a),this.map[a.id]=!0},c.prototype.add=function(a){delete this.map[a.id];var e=this.arr.length;if(!e){this.arr.push(a),this.map[a.id]=!0;return}if(this.arr[e-1].value<a.value){this.arr.push(a),this.map[a.id]=!0;return}this._innerAdd(a,e)},c.prototype.remove=function(a){!this.map[a]||delete this.map[a]},c.prototype._clearAndGetMinId=function(){for(var a,e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?a=this.arr[e].id:this.arr.splice(e,1);return a},c.prototype._findFirstId=function(){for(;this.arr.length;){var a=this.arr.shift();if(this.map[a.id])return a.id}},c.prototype.minId=function(a){return a?this._clearAndGetMinId():this._findFirstId()},c}(),Yy=function(a,e){return Math.abs(a.x-e.x)+Math.abs(a.y-e.y)},Ev=function(a,e){return Math.sqrt(Math.pow(a.x-e.x,2)+Math.pow(a.y-e.y,2))},VA=function(a,e){return[a,e]},jA=function(a,e,i,s,l){return CE(Hy(a,e,i,s,l.offset))},AE={offset:20,maxAllowedDirectionChange:Math.PI/2,maximumLoops:2e3,gridSize:10,directions:[{stepX:1,stepY:0},{stepX:-1,stepY:0},{stepX:0,stepY:1},{stepX:0,stepY:-1}],get penalties(){return{0:0,45:this.gridSize/2,90:this.gridSize/2}},distFunc:Yy,fallbackRoute:jA},Ky={maxAllowedDirectionChange:Math.PI/4,directions:[{stepX:1,stepY:0},{stepX:1,stepY:1},{stepX:0,stepY:1},{stepX:-1,stepY:1},{stepX:-1,stepY:0},{stepX:-1,stepY:-1},{stepX:0,stepY:-1},{stepX:1,stepY:-1}],distFunc:Ev,fallbackRoute:VA},yg=function(a,e){var i=Math.round(Math.abs(a/e)),s=a<0?-1:1;return i<0?0:s*i},Yb=function(a,e,i){var s={};return a.forEach(function(l){if(!!l)for(var f=Hg(l.getBBox(),i),d=yg(f.minX,e);d<=yg(f.maxX,e);d+=1)for(var v=yg(f.minY,e);v<=yg(f.maxY,e);v+=1)s["".concat(d,"|||").concat(v)]=!0}),s},np=function(a,e){var i=e.x-a.x,s=e.y-a.y;return i||s?Math.atan2(s,i):0},ME=function(a,e){var i=Math.abs(a-e);return i>Math.PI?2*Math.PI-i:i},NE=function(a,e,i){for(var s=Infinity,l=0,f=e.length;l<f;l++){var d=i(a,e[l]);d<s&&(s=d)}return s},Kb=function(a,e,i,s,l){var f=[];if(!i)return[a];var d=l.directions,v=l.offset,x=i.getBBox(),w=e.x>x.minX&&e.x<x.maxX&&e.y>x.minY&&e.y<x.maxY,I=Hg(x,v);for(var G in I)I[G]=yg(I[G],l.gridSize);if(w){for(var U=0,et=d;U<et.length;U++)for(var ft=et[U],Ct=[[{x:I.minX,y:I.minY},{x:I.maxX,y:I.minY}],[{x:I.minX,y:I.minY},{x:I.minX,y:I.maxY}],[{x:I.maxX,y:I.minY},{x:I.maxX,y:I.maxY}],[{x:I.minX,y:I.maxY},{x:I.maxX,y:I.maxY}]],G=0;G<4;G++){var Mt=Ct[G],kt=Sc.getLineIntersect(a,{x:a.x+ft.stepX*I.width,y:a.y+ft.stepY*I.height},Mt[0],Mt[1]);kt&&!Hb(a,kt,x)&&(kt.id="".concat(kt.x,"|||").concat(kt.y),f.push(kt))}return f}var $t=wv(I,a,s);return $t.id="".concat($t.x,"|||").concat($t.y),[$t]},Zb=function(a,e,i,s){var l=np(a,e),f=i[a.id];if(!f){var d=np(s,a);return ME(d,l)}var v=np({x:f.x,y:f.y},a);return ME(v,l)},A0=function(a,e,i,s,l,f,d){var v=[s],x=s,w=a.id,I=a.x,G=a.y,U={x:I,y:G,id:w};Zb(U,f,e,i)&&(x={x:f.x===s.x?s.x:U.x*d,y:f.y===s.y?s.y:U.y*d},v.unshift(x));for(var et=e[w];et&&et.id!==w;){var ft={x:I,y:G,id:w},Ct={x:et.x,y:et.y,id:et.id},Mt=Zb(Ct,ft,e,i);Mt&&(x={x:Ct.x===ft.x?x.x:Ct.x*d,y:Ct.y===ft.y?x.y:Ct.y*d},v.unshift(x)),w=Ct.id,I=Ct.x,G=Ct.y,et=e[w]}return v[0].x=I===i.x?l.x:x.x,v[0].y=G===i.y?l.y:x.y,v.unshift(l),v},iI=function(a,e,i,s,l){if(isNaN(a.x)||isNaN(e.x))return[];var f=(0,k.deepMix)(AE,l);f.obstacles=f.obstacles||[];var d=f.penalties,v=f.gridSize,x=Yb(f.obstacles.concat([i,s]),v,f.offset),w={x:yg(a.x,v),y:yg(a.y,v)},I={x:yg(e.x,v),y:yg(e.y,v)};a.id="".concat(w.x,"|||").concat(w.y),e.id="".concat(I.x,"|||").concat(I.y);var G=Kb(w,a,i,I,f),U=Kb(I,e,s,w,f);G.forEach(function(_a){delete x[_a.id]}),U.forEach(function(_a){delete x[_a.id]});for(var et={},ft={},Ct={},Mt={},kt={},$t=new Xy,Jt=0;Jt<G.length;Jt++){var Ce=G[Jt];et[Ce.id]=Ce,Mt[Ce.id]=0,kt[Ce.id]=NE(Ce,U,f.distFunc),$t.add({id:Ce.id,value:kt[Ce.id]})}var je=f.maximumLoops,ze,pn,Fn,Tn,cr,kr,Aa=Infinity,ci={};for(U.forEach(function(_a){ci["".concat(_a.x,"|||").concat(_a.y)]=!0}),Object.keys(et).forEach(function(_a){var Ya=et[_a].id;kt[Ya]<=Aa&&(Aa=kt[Ya],ze=et[Ya])});Object.keys(et).length>0&&je>0;){var ei=$t.minId((je+1)%30==0);if(ei)ze=et[ei];else break;if(ci["".concat(ze.x,"|||").concat(ze.y)])return A0(ze,Ct,w,e,a,I,v);delete et[ze.id],$t.remove(ze.id),ft[ze.id]=!0;for(var Jt=0;Jt<f.directions.length;Jt++){pn=f.directions[Jt];var Ca="".concat(Math.round(ze.x)+pn.stepX,"|||").concat(Math.round(ze.y)+pn.stepY);if(Fn={x:ze.x+pn.stepX,y:ze.y+pn.stepY,id:Ca},!ft[Ca]&&(kr=Zb(ze,Fn,Ct,w),!(kr>f.maxAllowedDirectionChange)&&!x[Ca])){et[Ca]||(et[Ca]=Fn);var Pi=d[kr];Tn=f.distFunc(ze,Fn)+(isNaN(Pi)?v:Pi),cr=Mt[ze.id]+Tn;var Ni=Mt[Ca];Ni&&cr>=Ni||(Ct[Ca]=ze,Mt[Ca]=cr,kt[Ca]=cr+NE(Fn,U,f.distFunc),$t.add({id:Ca,value:kt[Ca]}))}}je-=1}return f.fallbackRoute(a,e,i,s,f)};Gx("polyline",{options:{color:oi.defaultEdge.color,size:oi.defaultEdge.size,style:{radius:0,offset:15,x:0,y:0,stroke:oi.defaultEdge.style.stroke,lineAppendWidth:oi.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:oi.edgeLabel.style.fill,fontSize:oi.edgeLabel.style.fontSize,fontFamily:oi.windowFontFamily}},routeCfg:{obstacles:[],maxAllowedDirectionChange:Math.PI,maximumLoops:500,gridSize:10},stateStyles:(0,P.__assign)({},oi.edgeStateStyles)},shapeType:"polyline",labelPosition:"center",drawShape:function(a,e){var i=this.getShapeStyle(a);i.radius===0&&delete i.radius;var s=e.addShape("path",{className:"edge-shape",name:"edge-shape",attrs:i});return e.shapeMap["edge-shape"]=s,s},getShapeStyle:function(a){var e=this.options.style,i={stroke:a.color},s=(0,k.mix)({},e,i,a.style);a=this.getPathPoints(a),this.radius=s.radius,this.offset=s.offset;var l=a.startPoint,f=a.endPoint,d=this.getControlPoints(a),v=[l];d&&(v=v.concat(d)),v.push(f);var x=a.sourceNode,w=a.targetNode,I=s.radius,G=this.options.routeCfg,U=(0,k.mix)({},G,a.routeCfg);U.offset=s.offset;var et=this.getPath(v,x,w,I,U,!Boolean(d));((0,k.isArray)(et)&&et.length<=1||(0,k.isString)(et)&&et.indexOf("L")===-1)&&(et="M0 0, L0 0"),(isNaN(l.x)||isNaN(l.y)||isNaN(f.x)||isNaN(f.y))&&(et="M0 0, L0 0");var ft=(0,k.mix)({},oi.defaultEdge.style,s,{lineWidth:a.size,path:et});return ft},updateShapeStyle:function(a,e){var i=e.getContainer();if(!!e.isVisible()){var s={stroke:a.color},l=i.shapeMap["edge-shape"]||i.find(function(Jt){return Jt.get("className")==="edge-shape"})||e.getKeyShape(),f=a.size;a=this.getPathPoints(a);var d=a.startPoint,v=a.endPoint,x=this.getControlPoints(a),w=[d];x&&(w=w.concat(x)),w.push(v);var I=l.attr(),G=(0,k.mix)({},s,I,a.style),U=a.sourceNode,et=a.targetNode,ft=G.radius,Ct=this.options.routeCfg,Mt=(0,k.mix)({},Ct,a.routeCfg);Mt.offset=G.offset;var kt=this.getPath(w,U,et,ft,Mt,!Boolean(x));((0,k.isArray)(kt)&&kt.length<=1||(0,k.isString)(kt)&&kt.indexOf("L")===-1)&&(kt="M0 0, L0 0"),(isNaN(d.x)||isNaN(d.y)||isNaN(v.x)||isNaN(v.y))&&(kt="M0 0, L0 0"),I.endArrow&&G.endArrow===!1&&(a.style.endArrow={path:""}),I.startArrow&&G.startArrow===!1&&(a.style.startArrow={path:""});var $t=(0,k.mix)(s,l.attr(),{lineWidth:f,path:kt},a.style);l&&l.attr($t)}},getPath:function(a,e,i,s,l,f){var d=l.offset,v=l.obstacles,x=l.simple;if(!d||a.length>2||f===!1){if(s)return T0(a,s);var w=[];return(0,k.each)(a,function(et,ft){ft===0?w.push(["M",et.x,et.y]):w.push(["L",et.x,et.y])}),w}x!==!1&&!(v==null?void 0:v.length)&&(x=!0);var I=x?Hy(a[a.length-1],a[0],i,e,d):iI(a[0],a[a.length-1],e,i,l);if(!I||!I.length)return"M0 0, L0 0";if(s){var G=T0(I,s);return G}I=TE(I);var U=Sc.pointsToPolygon(I);return U}},"single-edge");var kE=Gv.cloneEvent,oI=Gv.isNaN,DE=Math.abs,sI=10,rp=["shift","ctrl","alt","control"],qb={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,scalableRange:0,allowDragOnItem:!1}},getEvents:function(){return{mousedown:"onMouseDown",drag:"onDragMove",dragend:"onMouseUp","canvas:click":"onMouseUp",keyup:"onKeyUp",focus:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onMouseUp"}},updateViewport:function(a){var e=this.origin,i=+a.clientX,s=+a.clientY;if(!(oI(i)||oI(s))){var l=i-e.x,f=s-e.y;this.get("direction")==="x"?f=0:this.get("direction")==="y"&&(l=0),this.origin={x:i,y:s};var d=this.graph.get("width"),v=this.graph.get("height"),x=this.graph.get("canvas").getCanvasBBox(),w=this.scalableRange,I=this.scalableRange;w<1&&w>-1&&(w=d*w,I=v*I),(x.minX<=d+w&&x.minX+l>d+w||x.maxX+w>=0&&x.maxX+w+l<0)&&(l=0),(x.minY<=v+I&&x.minY+f>v+I||x.maxY+I>=0&&x.maxY+I+f<0)&&(f=0),this.graph.translate(l,f)}},onTouchStart:function(a){var e=this,i=a.originalEvent.touches,s=i[0],l=i[1];s&&l||(a.preventDefault(),this.mousedown=!0,e.onDragStart(a))},onMouseDown:function(a){this.mousedown=!0},onDragMove:function(a){!this.mousedown||(this.dragstart?this.onDrag(a):(this.dragstart=!0,this.onDragStart(a)))},onDragStart:function(a){var e=this,i=a.originalEvent;if(!(i&&a.name!=="touchstart"&&i.button!==0)&&!(a.name!=="touchstart"&&typeof window!="undefined"&&window.event&&!window.event.buttons&&!window.event.button)&&!!this.shouldBegin(a,this)&&!e.keydown&&!!this.allowDrag(a)){if(e.origin={x:a.clientX,y:a.clientY},e.dragging=!1,this.enableOptimize){for(var s=this.graph,l=s.getEdges(),f=0,d=l.length;f<d;f++){var v=l[f].get("group").get("children");!v||v.forEach(function($t){$t.set("ori-visibility",$t.get("ori-visibility")||$t.get("visible")),$t.hide()})}for(var x=s.getNodes(),w=0,I=x.length;w<I;w++)for(var G=x[w].getContainer(),U=G.get("children"),et=0,ft=U;et<ft.length;et++){var Ct=ft[et],Mt=Ct.get("isKeyShape");Mt||(Ct.set("ori-visibility",Ct.get("ori-visibility")||Ct.get("visible")),Ct.hide())}}if(typeof window!="undefined"){var kt=this;this.handleDOMContextMenu=function($t){return kt.onMouseUp($t)},document.body.addEventListener("contextmenu",this.handleDOMContextMenu)}}},onTouchMove:function(a){var e=this,i=a.originalEvent.touches,s=i[0],l=i[1];if(s&&l){this.onMouseUp(a);return}a.preventDefault(),e.onDrag(a)},onDrag:function(a){if(!!this.mousedown){var e=this.graph;if(!this.keydown&&!!this.allowDrag(a)&&(a=kE(a),!!this.origin)){if(this.dragging)a.type="drag",e.emit("canvas:drag",a);else{if(DE(this.origin.x-a.clientX)+DE(this.origin.y-a.clientY)<sI)return;this.shouldBegin(a,this)&&(a.type="dragstart",e.emit("canvas:dragstart",a),this.originPosition={x:a.clientX,y:a.clientY},this.dragging=!0)}this.shouldUpdate(a,this)&&this.updateViewport(a)}}},onMouseUp:function(a){var e,i;this.mousedown=!1,this.dragstart=!1;var s=this.graph;if(!this.keydown){var l=s.getZoom(),f=s.get("modeController"),d=(i=(e=f==null?void 0:f.modes[f.mode])===null||e===void 0?void 0:e.filter(function(ze){return ze.type==="zoom-canvas"}))===null||i===void 0?void 0:i[0],v=d?d.optimizeZoom||.1:0;if(this.enableOptimize){for(var x=s.getEdges(),w=0,I=x.length;w<I;w++){var G=x[w].get("group").get("children");!G||G.forEach(function(ze){var pn=ze.get("ori-visibility");ze.set("ori-visibility",void 0),pn&&ze.show()})}if(l>v)for(var U=s.getNodes(),et=0,ft=U.length;et<ft;et++)for(var Ct=U[et].getContainer(),Mt=Ct.get("children"),kt=0,$t=Mt;kt<$t.length;kt++){var Jt=$t[kt],Ce=Jt.get("isKeyShape");if(!Ce){var je=Jt.get("ori-visibility");Jt.set("ori-visibility",void 0),je&&Jt.show()}}}if(!this.dragging){this.origin=null;return}a=kE(a),this.shouldEnd(a,this)&&this.updateViewport(a),a.type="dragend",a.dx=a.clientX-this.originPosition.x,a.dy=a.clientY-this.originPosition.y,s.emit("canvas:dragend",a),this.endDrag(),typeof window!="undefined"&&document.body.removeEventListener("contextmenu",this.handleDOMContextMenu)}},endDrag:function(){this.origin=null,this.dragging=!1,this.dragbegin=!1,this.mousedown=!1,this.dragstart=!1},onKeyDown:function(a){var e=this,i=a.key;!i||(rp.indexOf(i.toLowerCase())>-1?e.keydown=!0:e.keydown=!1)},onKeyUp:function(){this.keydown=!1,this.origin=null,this.dragging=!1,this.dragbegin=!1},allowDrag:function(a){var e,i,s=a.target,l=s&&s.isCanvas&&s.isCanvas();if((0,k.isBoolean)(this.allowDragOnItem)&&!this.allowDragOnItem&&!l)return!1;if((0,k.isObject)(this.allowDragOnItem)){var f=this.allowDragOnItem,d=f.node,v=f.edge,x=f.combo,w=(i=(e=a.item)===null||e===void 0?void 0:e.getType)===null||i===void 0?void 0:i.call(e);if(!d&&w==="node"||!v&&w==="edge"||!x&&w==="combo")return!1}return!0}},Zy={getDefaultCfg:function(){return{updateEdge:!0,delegateStyle:{},enableDelegate:!1,onlyChangeComboSize:!1,comboActiveState:"",selectedState:"selected",enableOptimize:!1,enableDebounce:!1,enableStack:!0}},getEvents:function(){return{"node:mousedown":"onMouseDown",drag:"onDragMove",dragend:"onDragEnd","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave","combo:drop":"onDropCombo","node:drop":"onDropNode","canvas:drop":"onDropCanvas",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onDragEnd",afterchangedata:"onDragEnd"}},validationCombo:function(a){if(!this.origin||!a||a.destroyed)return!1;var e=a.getType();return e==="combo"},onTouchStart:function(a){if(!!a.item){var e=this;try{var i=a.originalEvent.touches,s=i[0],l=i[1];if(s&&l)return;a.preventDefault()}catch(f){console.warn("Touch original event not exist!")}this.mousedown={item:a.item,target:a.target,origin:{x:a.x,y:a.y}},this.dragstart=!0,e.onDragStart(a)}},onTouchMove:function(a){var e=this;try{var i=a.originalEvent.touches,s=i[0],l=i[1];if(s&&l){e.onDragEnd(a);return}a.preventDefault()}catch(f){console.warn("Touch original event not exist!")}e.onDrag(a)},onMouseDown:function(a){this.mousedown={item:a.item,target:a.target,origin:{x:a.x,y:a.y}},typeof window!="undefined"&&!this.windowEventBinded&&(this.windowEventBinded=!0,document.body.addEventListener("contextmenu",this.onDragEnd.bind(this)),document.body.addEventListener("mouseup",this.onDragEnd.bind(this)))},onDragMove:function(a){var e,i;if(((i=(e=a.item)===null||e===void 0?void 0:e.getType)===null||i===void 0?void 0:i.call(e))!=="node"){this.onDragEnd();return}!this.mousedown||(this.dragstart?this.onDrag((0,P.__assign)((0,P.__assign)({},a),this.mousedown)):(this.dragstart=!0,this.onDragStart(a)))},onDragStart:function(a){var e=this;if(this.currentShouldEnd=!0,!!this.shouldBegin((0,P.__assign)((0,P.__assign)({},a),this.mousedown),this)){var i=this.mousedown,s=i.item,l=i.target;if(!(!s||s.destroyed||s.hasLocked())){var f=s.getContainer();if(f.set("capture",!1),this.cachedCaptureItems||(this.cachedCaptureItems=[]),this.cachedCaptureItems.push(s),l){var d=l.get("isAnchorPoint");if(d)return}var v=this.graph;this.targets=[],this.targetCombo=null;var x=v.findAllByState("node",this.selectedState),w=s.get("id"),I=x.filter(function(U){var et=U.get("id");return w===et});if(I.length===0?this.targets.push(s):x.length>1?x.forEach(function(U){var et=U.hasLocked();et||e.targets.push(U)}):this.targets.push(s),this.graph.get("enabledStack")&&this.enableStack){var G=[];this.targets.forEach(function(U){var et=U.getModel(),ft=et.x,Ct=et.y,Mt=et.id;G.push({x:ft,y:Ct,id:Mt})}),this.set("beforeDragNodes",G)}this.hidenEdge={},this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach(function(U){var et=U.getEdges();et.forEach(function(ft){!ft.isVisible()||(e.hidenEdge[ft.getID()]=!0,ft.hide())})}),this.origin=this.mousedown.origin,this.point={},this.originPoint={}}}},onDrag:function(a){var e=this;if(!(!this.mousedown||!this.origin)&&!!this.shouldUpdate(a,this))if(this.get("enableDelegate"))this.updateDelegate(a);else if(this.enableDebounce)this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:a,updateEdge:this.get("updateEdge"),onlyChangeComboSize:this.onlyChangeComboSize,updateParentCombos:this.updateParentCombos});else{var i={};this.targets.map(function(s){e.update(s,a);var l=s.getModel().comboId;l&&(i[l]=e.graph.findById(l))}),this.onlyChangeComboSize&&this.updateParentCombos()}},onDragEnd:function(a){var e=this,i;if(this.mousedown=!1,this.dragstart=!1,typeof window!="undefined"&&this.windowEventBinded&&(this.windowEventBinded=!1,document.body.removeEventListener("contextmenu",this.onDragEnd.bind(this)),document.body.removeEventListener("mouseup",this.onDragEnd.bind(this))),!!this.origin){(i=this.cachedCaptureItems)===null||i===void 0||i.forEach(function(f){var d=f.getContainer();d.set("capture",!0)}),this.cachedCaptureItems=[],this.delegateRect&&(this.delegateRect.remove(),this.delegateRect=null),this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach(function(f){var d=f.getEdges();d.forEach(function(v){e.hidenEdge[v.getID()]&&v.show(),v.refresh()})}),this.hidenEdge={};var s=this.graph;if(s.get("enabledStack")&&this.enableStack){var l={before:{nodes:[],edges:[],combos:[]},after:{nodes:[],edges:[],combos:[]}};this.get("beforeDragNodes").forEach(function(f){l.before.nodes.push(f)}),this.targets.forEach(function(f){var d=f.getModel(),v=d.x,x=d.y,w=d.id;l.after.nodes.push({x:v,y:x,id:w})}),s.pushStack("update",(0,k.clone)(l))}s.emit("dragnodeend",{items:this.targets,targetItem:null}),this.point={},this.origin=null,this.originPoint={},this.targets.length=0,this.targetCombo=null}},onDropCombo:function(a){var e=a.item;if(this.currentShouldEnd=this.shouldEnd(a,e,this),this.updatePositions(a,!this.currentShouldEnd),!(!this.currentShouldEnd||!this.validationCombo(e))){var i=this.graph;if(this.comboActiveState&&i.setItemState(e,this.comboActiveState,!1),this.targetCombo=e,this.onlyChangeComboSize)i.updateCombos();else{var s=e.getModel();this.targets.map(function(l){var f=l.getModel();f.comboId!==s.id&&i.updateComboTree(l,s.id)}),i.updateCombo(e)}i.emit("dragnodeend",{items:this.targets,targetItem:this.targetCombo})}},onDropCanvas:function(a){var e=this.graph;this.currentShouldEnd=this.shouldEnd(a,void 0,this),this.updatePositions(a,!this.currentShouldEnd),!(!this.targets||this.targets.length===0||!this.currentShouldEnd)&&(this.onlyChangeComboSize?this.updateParentCombos():this.targets.map(function(i){var s=i.getModel();s.comboId&&e.updateComboTree(i)}))},onDropNode:function(a){if(!(!this.targets||this.targets.length===0)){var e=this,i=a.item,s=e.graph,l=i.getModel().comboId,f=l?s.findById(l):void 0;if(this.currentShouldEnd=this.shouldEnd(a,f,this),this.updatePositions(a,!this.currentShouldEnd),!!this.currentShouldEnd){if(this.onlyChangeComboSize)this.updateParentCombos();else if(l){var d=s.findById(l);e.comboActiveState&&s.setItemState(d,e.comboActiveState,!1),this.targets.map(function(v){var x=v.getModel();l!==x.comboId&&s.updateComboTree(v,l)}),s.updateCombo(d)}else this.targets.map(function(v){var x=v.getModel();x.comboId&&s.updateComboTree(v)});s.emit("dragnodeend",{items:this.targets,targetItem:i})}}},onDragEnter:function(a){var e=a.item;if(!!this.validationCombo(e)){var i=this.graph;this.comboActiveState&&i.setItemState(e,this.comboActiveState,!0)}},onDragLeave:function(a){var e=a.item;if(!!this.validationCombo(e)){var i=this.graph;this.comboActiveState&&i.setItemState(e,this.comboActiveState,!1)}},updatePositions:function(a,e){var i=this;!this.targets||this.targets.length===0||(this.get("enableDelegate")?this.enableDebounce?this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:a,updateEdge:this.get("updateEdge"),onlyChangeComboSize:this.onlyChangeComboSize,updateParentCombos:this.updateParentCombos}):e||this.targets.map(function(s){return i.update(s,a)}):this.targets.map(function(s){return i.update(s,a,e)}))},update:function(a,e,i){var s=this.origin,l=a.get("model"),f=a.get("id");this.point[f]||(this.point[f]={x:l.x||0,y:l.y||0});var d=e.x-s.x+this.point[f].x,v=e.y-s.y+this.point[f].y;i&&(d+=s.x-e.x,v+=s.y-e.y);var x={x:d,y:v};this.get("updateEdge")?this.graph.updateItem(a,x,!1):a.updatePosition(x)},debounceUpdate:(0,k.debounce)(function(c){var a=c.targets,e=c.graph,i=c.point,s=c.origin,l=c.evt,f=c.updateEdge,d=c.onlyChangeComboSize,v=c.updateParentCombos;a.map(function(x){var w=x.get("model"),I=x.get("id");i[I]||(i[I]={x:w.x||0,y:w.y||0});var G=l.x-s.x+i[I].x,U=l.y-s.y+i[I].y,et={x:G,y:U};f?e.updateItem(x,et,!1):x.updatePosition(et)}),d&&v(e,a)},50,!0),updateDelegate:function(a){var e=this.graph;if(this.delegateRect){var G=a.x-this.origin.x+this.originPoint.minX,U=a.y-this.origin.y+this.originPoint.minY;this.delegateRect.attr({x:G,y:U})}else{var i=e.get("group"),s=(0,k.deepMix)({},cg.delegateStyle,this.delegateStyle),l=this.calculationGroupPosition(a),f=l.x,d=l.y,v=l.width,x=l.height,w=l.minX,I=l.minY;this.originPoint={x:f,y:d,width:v,height:x,minX:w,minY:I},this.delegateRect=i.addShape("rect",{attrs:(0,P.__assign)({width:v,height:x,x:f,y:d},s),name:"rect-delegate-shape"}),this.delegate=this.delegateRect,this.delegateRect.set("capture",!1)}},calculationGroupPosition:function(a){var e=this.targets;e.length===0&&e.push(a.item);for(var i=Infinity,s=-Infinity,l=Infinity,f=-Infinity,d=0;d<e.length;d++){var v=e[d],x=v.getBBox(),w=x.minX,I=x.minY,G=x.maxX,U=x.maxY;w<i&&(i=w),I<l&&(l=I),G>s&&(s=G),U>f&&(f=U)}var et=Math.floor(i),ft=Math.floor(l),Ct=Math.ceil(s)-Math.floor(i),Mt=Math.ceil(f)-Math.floor(l);return{x:et,y:ft,width:Ct,height:Mt,minX:i,minY:l}},updateParentCombos:function(a,e){var i=a||this.graph,s=e||this.targets,l={};s==null||s.forEach(function(f){var d=f.getModel().comboId;d&&(l[d]=i.findById(d))}),Object.values(l).forEach(function(f){f&&i.updateCombo(f)})}},Qb={getDefaultCfg:function(){return{trigger:"mouseenter",activeState:"active",inactiveState:"inactive",resetSelected:!1,shouldUpdate:function(){return!0}}},getEvents:function(){return this.get("trigger")==="mouseenter"?{"node:mouseenter":"setAllItemStates","combo:mouseenter":"setAllItemStates","node:mouseleave":"clearActiveState","combo:mouseleave":"clearActiveState"}:{"node:click":"setAllItemStates","combo:click":"setAllItemStates","canvas:click":"clearActiveState","node:touchstart":"setOnTouchStart","combo:touchstart":"setOnTouchStart","canvas:touchstart":"clearOnTouchStart"}},setOnTouchStart:function(a){var e=this;try{var i=a.originalEvent.touches,s=i[0],l=i[1];if(s&&l)return;a.preventDefault()}catch(f){console.warn("Touch original event not exist!")}e.setAllItemStates(a)},clearOnTouchStart:function(a){var e=this;try{var i=a.originalEvent.touches,s=i[0],l=i[1];if(s&&l)return;a.preventDefault()}catch(f){console.warn("Touch original event not exist!")}e.clearActiveState(a)},setAllItemStates:function(a){clearTimeout(this.timer),this.throttleSetAllItemStates(a,this)},clearActiveState:function(a){var e=this;this.timer=setTimeout(function(){e.throttleClearActiveState(a,e)},50)},throttleSetAllItemStates:(0,k.throttle)(function(c,a){var e=c.item,i=a.graph;if(!(!i||i.destroyed)&&(a.item=e,!!a.shouldUpdate(c.item,{event:c,action:"activate"},a))){for(var s=a.activeState,l=a.inactiveState,f=i.getNodes(),d=i.getCombos(),v=i.getEdges(),x=i.get("vedges"),w=f.length,I=d.length,G=v.length,U=x.length,et=a.inactiveItems||{},ft=a.activeItems||{},Ct=0;Ct<w;Ct++){var Mt=f[Ct],kt=Mt.getID(),$t=Mt.hasState("selected");a.resetSelected&&$t&&i.setItemState(Mt,"selected",!1),ft[kt]&&(i.setItemState(Mt,s,!1),delete ft[kt]),l&&!et[kt]&&(i.setItemState(Mt,l,!0),et[kt]=Mt)}for(var Ct=0;Ct<I;Ct++){var Jt=d[Ct],Ce=Jt.getID(),$t=Jt.hasState("selected");a.resetSelected&&$t&&i.setItemState(Jt,"selected",!1),ft[Ce]&&(i.setItemState(Jt,s,!1),delete ft[Ce]),l&&!et[Ce]&&(i.setItemState(Jt,l,!0),et[Ce]=Jt)}for(var Ct=0;Ct<G;Ct++){var je=v[Ct],ze=je.getID();ft[ze]&&(i.setItemState(je,s,!1),delete ft[ze]),l&&!et[ze]&&(i.setItemState(je,l,!0),et[ze]=je)}for(var Ct=0;Ct<U;Ct++){var pn=x[Ct],Fn=pn.getID();ft[Fn]&&(i.setItemState(pn,s,!1),delete ft[Fn]),l&&!et[Fn]&&(i.setItemState(pn,l,!0),et[Fn]=pn)}if(e&&!e.destroyed){l&&(i.setItemState(e,l,!1),delete et[e.getID()]),ft[e.getID()]||(i.setItemState(e,s,!0),ft[e.getID()]=e);for(var Tn=e.getEdges(),cr=Tn.length,Ct=0;Ct<cr;Ct++){var je=Tn[Ct],ze=je.getID(),kr=void 0;je.getSource()===e?kr=je.getTarget():kr=je.getSource();var Aa=kr.getID();l&&et[Aa]&&(i.setItemState(kr,l,!1),delete et[Aa]),ft[Aa]||(i.setItemState(kr,s,!0),ft[Aa]=kr),et[ze]&&(i.setItemState(je,l,!1),delete et[ze]),ft[ze]||(i.setItemState(je,s,!0),ft[ze]=je),je.toFront()}}a.activeItems=ft,a.inactiveItems=et,i.emit("afteractivaterelations",{item:c.item,action:"activate"})}},50,{trailing:!0,leading:!0}),throttleClearActiveState:(0,k.throttle)(function(c,a){var e=a.get("graph");if(!(!e||e.destroyed)&&!!a.shouldUpdate(c.item,{event:c,action:"deactivate"},a)){var i=a.activeState,s=a.inactiveState,l=a.activeItems||{},f=a.inactiveItems||{};Object.values(l).filter(function(d){return!d.destroyed}).forEach(function(d){e.clearItemStates(d,i)}),Object.values(f).filter(function(d){return!d.destroyed}).forEach(function(d){e.clearItemStates(d,s)}),a.activeItems={},a.inactiveItems={},e.emit("afteractivaterelations",{item:c.item||a.get("item"),action:"deactivate"})}},50,{trailing:!0,leading:!0})},Mm=Math.min,qy=Math.max,Qy=Math.abs,Jy="shift",uI=["drag","shift","ctrl","alt","control"],kh={getDefaultCfg:function(){return{brushStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:Jy,includeEdges:!0,includeCombos:!1,selectedEdges:[],selectedNodes:[],selectedCombos:[]}},getEvents:function(){return uI.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=Jy,console.warn("Behavior brush-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")),this.trigger==="drag"?{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates"}:{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates",keyup:"onKeyUp",keydown:"onKeyDown"}},onMouseDown:function(a){var e=a.item,i=this.brush;e||this.trigger!=="drag"&&!this.keydown||(this.selectedNodes&&this.selectedNodes.length!==0&&this.clearStates(),i||(i=this.createBrush()),this.originPoint={x:a.canvasX,y:a.canvasY},i.attr({width:0,height:0}),i.show(),this.dragging=!0)},onMouseMove:function(a){!this.dragging||this.trigger!=="drag"&&!this.keydown||this.updateBrush(a)},onMouseUp:function(a){var e=this.graph;!this.brush&&!this.dragging||this.trigger!=="drag"&&!this.keydown||(this.brush.remove(!0),this.brush=null,this.getSelectedNodes(a),this.dragging=!1)},clearStates:function(){var a=this,e=a.graph,i=a.selectedState,s=e.findAllByState("node",i),l=e.findAllByState("edge",i),f=e.findAllByState("combo",i);s.forEach(function(d){return e.setItemState(d,i,!1)}),l.forEach(function(d){return e.setItemState(d,i,!1)}),f.forEach(function(d){return e.setItemState(d,i,!1)}),this.selectedNodes=[],this.selectedEdges=[],this.selectedCombos=[],this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges,this.selectedCombos),e.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1})},isBBoxCenterInRect:function(a,e,i,s,l){var f=a.getBBox();return f.centerX>=e&&f.centerX<=i&&f.centerY>=s&&f.centerY<=l},getSelectedNodes:function(a){var e=this,i=this,s=i.graph,l=i.originPoint,f=i.shouldUpdate,d=i.isBBoxCenterInRect,v=this.selectedState,x={x:a.x,y:a.y},w=s.getPointByCanvas(l.x,l.y),I=Mm(x.x,w.x),G=qy(x.x,w.x),U=Mm(x.y,w.y),et=qy(x.y,w.y),ft=[],Ct=[];s.getNodes().forEach(function($t){if($t.isVisible()&&d($t,I,G,U,et)&&f($t,"select",e)){ft.push($t);var Jt=$t.getModel();Ct.push(Jt.id),s.setItemState($t,v,!0)}});var Mt=[];this.includeEdges&&ft.forEach(function($t){var Jt=$t.getOutEdges();Jt.forEach(function(Ce){if(!!Ce.isVisible()){var je=Ce.getModel(),ze=je.source,pn=je.target;Ct.includes(ze)&&Ct.includes(pn)&&f(Ce,"select",e)&&(Mt.push(Ce),s.setItemState(Ce,e.selectedState,!0))}})});var kt=[];this.includeCombos&&s.getCombos().forEach(function($t){if($t.isVisible()&&d($t,I,G,U,et)&&f($t,"select",e)){kt.push($t);var Jt=$t.getModel();Ct.push(Jt.id),s.setItemState($t,v,!0)}}),this.selectedEdges=Mt,this.selectedNodes=ft,this.selectedCombos=kt,this.onSelect&&this.onSelect(ft,Mt,kt),s.emit("nodeselectchange",{selectedItems:{nodes:ft,edges:Mt,combos:kt},select:!0})},createBrush:function(){var a=this,e=a.graph.get("canvas").addShape("rect",{attrs:a.brushStyle,capture:!1,name:"brush-shape"});return this.brush=e,this.delegate=e,e},updateBrush:function(a){var e=this.originPoint;this.brush.attr({width:Qy(a.canvasX-e.x),height:Qy(a.canvasY-e.y),x:Mm(a.canvasX,e.x),y:Mm(a.canvasY,e.y)})},onKeyDown:function(a){var e=a.key;if(!!e){var i=this.trigger.toLowerCase(),s=e.toLowerCase();s===i||s==="control"&&i==="ctrl"||s==="ctrl"&&i==="control"?this.keydown=!0:this.keydown=!1}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.keydown=!1}},M0="shift",t1=["shift","ctrl","alt","control"],e1={getDefaultCfg:function(){return{multiple:!0,trigger:M0,selectedState:"selected",selectNode:!0,selectEdge:!1,selectCombo:!0}},getEvents:function(){var a=this;return t1.indexOf(a.trigger.toLowerCase())>-1||(a.trigger=M0,console.warn("Behavior click-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")),a.multiple?{"node:click":"onClick","combo:click":"onClick","edge:click":"onClick","canvas:click":"onCanvasClick",keyup:"onKeyUp",keydown:"onKeyDown"}:{"node:click":"onClick","combo:click":"onClick","edge:click":"onClick","canvas:click":"onCanvasClick"}},onClick:function(a){var e=this,i=a.item;if(!(!i||i.destroyed)){var s=i.getType(),l=e.graph,f=e.keydown,d=e.multiple,v=e.shouldUpdate,x=e.shouldBegin;if(!!x(a,e)){if(!f||!d){var w=l.findAllByState("node",e.selectedState).concat(l.findAllByState("edge",e.selectedState)).concat(l.findAllByState("combo",e.selectedState));(0,k.each)(w,function(ft){ft!==i&&l.setItemState(ft,e.selectedState,!1)})}var I=function(){switch(s){case"node":return e.selectNode;case"edge":return e.selectEdge;case"combo":return e.selectCombo;default:return!1}}();if(!I){var G=l.findAllByState("node",e.selectedState),U=l.findAllByState("edge",e.selectedState),et=l.findAllByState("combo",e.selectedState);l.emit("nodeselectchange",{selectedItems:{nodes:G,edges:U,combos:et},select:!1});return}if(i.hasState(e.selectedState)){v(a,e)&&l.setItemState(i,e.selectedState,!1);var G=l.findAllByState("node",e.selectedState),U=l.findAllByState("edge",e.selectedState),et=l.findAllByState("combo",e.selectedState);l.emit("nodeselectchange",{target:i,selectedItems:{nodes:G,edges:U,combos:et},select:!1})}else{v(a,e)&&l.setItemState(i,e.selectedState,!0);var G=l.findAllByState("node",e.selectedState),U=l.findAllByState("edge",e.selectedState),et=l.findAllByState("combo",e.selectedState);l.emit("nodeselectchange",{target:i,selectedItems:{nodes:G,edges:U,combos:et},select:!0})}}}},onCanvasClick:function(a){var e=this,i=this,s=i.graph,l=i.shouldBegin;if(!!l(a,this)){var f=s.findAllByState("node",this.selectedState);(0,k.each)(f,function(x){s.setItemState(x,e.selectedState,!1)});var d=s.findAllByState("edge",this.selectedState);(0,k.each)(d,function(x){s.setItemState(x,e.selectedState,!1)});var v=s.findAllByState("combo",this.selectedState);(0,k.each)(v,function(x){s.setItemState(x,e.selectedState,!1)}),s.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1})}},onKeyDown:function(a){var e=this,i=a.key;!i||(i.toLowerCase()===this.trigger.toLowerCase()||i.toLowerCase()==="control"?e.keydown=!0:e.keydown=!1)},onKeyUp:function(){var a=this;a.keydown=!1}},n1=Le,Yg=.05,r1={getDefaultCfg:function(){return this.isFireFox=gw()==="firefox",{sensitivity:2,minZoom:void 0,maxZoom:void 0,enableOptimize:!1,optimizeZoom:.1,fixSelectedItems:{fixAll:!1,fixLineWidth:!1,fixLabel:!1,fixState:"selected"},animate:!1,animateCfg:{duration:500}}},getEvents:function(){var a=this.fixSelectedItems;return a.fixState||(a.fixState="selected"),a.fixAll&&(a.fixLineWidth=!0,a.fixLabel=!0),{wheel:"onWheel",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd"}},onTouchStart:function(a){var e=a.originalEvent.touches,i=e[0],s=e[1];a.preventDefault(),!!s&&(this.shouldBegin&&!this.shouldBegin(a,this)||(this.startPoint={pageX:i.pageX,pageY:i.pageY},this.moveable=!0,s&&(this.endPoint={pageX:s.pageX,pageY:s.pageY}),this.originScale=this.graph.getZoom()||this.currentScale||1))},onTouchMove:function(a){if(!!this.moveable){a.preventDefault();var e=a.originalEvent.touches,i=e[0],s=e[1];if(!!s){this.endPoint||(this.endPoint={pageX:s.pageX,pageY:s.pageY});var l=function(ft,Ct){return Math.hypot(Ct.x-ft.x,Ct.y-ft.y)},f=l({x:i.pageX,y:i.pageY},{x:s.pageX,y:s.pageY})/l({x:this.startPoint.pageX,y:this.startPoint.pageY},{x:this.endPoint.pageX,y:this.endPoint.pageY}),d=this.originScale*f;this.currentScale=d;var v=this.get("minZoom")||this.graph.get("minZoom"),x=this.get("maxZoom")||this.graph.get("maxZoom");if(!(d>x||d<v)){var w=this.get("animate"),I=this.get("animateCfg"),G=this.graph.get("canvas"),U=G.getPointByClient(a.clientX,a.clientY);this.graph.zoomTo(d,{x:U.x,y:U.y},w,I),this.graph.emit("wheelzoom",a)}}}},onTouchEnd:function(){this.moveable=!1,this.endPoint=null},onWheel:function(a){var e=this,i=this,s=i.graph,l=i.fixSelectedItems;if(!(this.shouldBegin&&!this.shouldBegin(a,this))&&!!this.shouldUpdate(a,this)){a.preventDefault();var f=s.get("canvas"),d=f.getPointByClient(a.clientX,a.clientY),v=this.get("sensitivity"),x=s.getZoom(),w=x,I=x;this.isFireFox?a.deltaY>0||a.wheelDelta<0?w=1-Yg*v:w=1/(1-Yg*v):a.wheelDelta<0?w=1-Yg*v:w=1/(1-Yg*v),I=x*w;var G=this.get("minZoom")||s.get("minZoom"),U=this.get("maxZoom")||s.get("maxZoom");I>U?I=U:I<G&&(I=G);var et=this.get("enableOptimize");if(et){var ft=this.get("optimizeZoom"),Ct=this.get("optimized"),Mt=s.getNodes(),kt=s.getEdges(),$t=Mt.length,Jt=kt.length;if(!Ct){for(var Ce=0;Ce<$t;Ce++){var je=Mt[Ce];if(!je.destroyed)for(var ze=je.get("group").get("children"),pn=ze.length,Fn=0;Fn<pn;Fn++){var Tn=ze[Fn];!Tn.destoryed&&!Tn.get("isKeyShape")&&(Tn.set("ori-visibility",Tn.get("ori-visibility")||Tn.get("visible")),Tn.hide())}}for(var cr=0;cr<Jt;cr++)for(var kr=kt[cr],ze=kr.get("group").get("children"),pn=ze.length,Fn=0;Fn<pn;Fn++){var Tn=ze[Fn];Tn.set("ori-visibility",Tn.get("ori-visibility")||Tn.get("visible")),Tn.hide()}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var Aa=setTimeout(function(){var au=s.getZoom(),Ku=e.get("optimized");if(Ku){e.set("optimized",!1);for(var Ks=0;Ks<$t;Ks++){var Zu=Mt[Ks],Il=Zu.get("group").get("children"),Ho=Il.length;if(au<ft){var xu=Zu.getKeyShape(),wu=xu.get("ori-visibility");xu.set("ori-visibility",void 0),wu&&xu.show()}else for(var Dl=0;Dl<Ho;Dl++){var Tu=Il[Dl],wu=Tu.get("ori-visibility");Tu.set("ori-visibility",void 0),!Tu.get("visible")&&wu&&wu&&Tu.show()}}for(var Uu=0;Uu<Jt;Uu++){var dc=kt[Uu],Il=dc.get("group").get("children"),Ho=Il.length;if(au<ft){var xu=dc.getKeyShape(),wu=xu.get("ori-visibility");xu.set("ori-visibility",void 0),wu&&xu.show()}else for(var Dl=0;Dl<Ho;Dl++){var Tu=Il[Dl];if(!Tu.get("visible")){var wu=Tu.get("ori-visibility");Tu.set("ori-visibility",void 0),wu&&Tu.show()}}}}},100);this.set("timeout",Aa)}if(x<=1){var ci=void 0,ei=void 0;if(l.fixAll||l.fixLineWidth||l.fixLabel){ci=s.findAllByState("node",l.fixState),ei=s.findAllByState("edge",l.fixState);for(var Ca=x/I,Pi=ci.length,Ni=0;Ni<Pi;Ni++){var je=ci[Ni],_a=je.getContainer(),Ya=je.getModel(),hi=je.getOriginStyle(),di=je.getStateStyle(l.fixState),Xi=je.get("shapeFactory").getShape(Ya.type).getStateStyle(l.fixState,je)[l.fixState];if(l.fixAll){if(I<=1){var go=(0,k.clone)(_a.getMatrix());go||(go=[1,0,0,0,1,0,0,0,1]);var vs=je.getModel(),Fs=vs.x,hl=vs.y;go=n1(go,[["t",-Fs,-hl],["s",Ca,Ca],["t",Fs,hl]]),_a.setMatrix(go)}}else for(var ze=_a.get("children"),pn=ze.length,Fn=0;Fn<pn;Fn++){var Tn=ze[Fn],Lu=void 0,dl=void 0;if(l.fixLabel){var _l=Tn.get("type");if(_l==="text"){Lu=Tn.attr("fontSize")||12;var rc=di[Tn.get("name")],Vl=Xi[Tn.get("name")],zp=rc?rc.fontSize:12,xf=Vl?Vl.fontSize:12,Dh=zp||xf||12;if(I<=1&&Tn.attr("fontSize",Dh/I),dl)break}}if(l.fixLineWidth&&Tn.get("isKeyShape")){dl=Tn.attr("lineWidth")||0;var Vc=di.lineWidth||Xi.lineWidth||hi.lineWidth||0;if(I<=1&&Tn.attr("lineWidth",Vc/I),Lu)break}}}for(var jc=ei.length,Oh=0;Oh<jc;Oh++)for(var kr=ei[Oh],_a=kr.getContainer(),ze=_a.get("children"),Ya=kr.getModel(),di=kr.getStateStyle(l.fixState),Xi=kr.get("shapeFactory").getShape(Ya.type).getStateStyle(l.fixState,kr)[l.fixState],pn=ze.length,Fn=0;Fn<pn;Fn++){var Tn=ze[Fn],Lu=void 0,dl=void 0;if(l.fixLabel||l.fixAll){var _l=Tn.get("type");if(_l==="text"){Lu=Tn.attr("fontSize")||12;var rc=di[Tn.get("name")],Vl=Xi[Tn.get("name")],zp=rc?rc.fontSize:12,xf=Vl?Vl.fontSize:12,Dh=zp||xf||12;if(I<=1&&Tn.attr("fontSize",Dh/I),dl)break}}if((l.fixLineWidth||l.fixAll)&&Tn.get("isKeyShape")){dl=Tn.attr("lineWidth")||0;var Vc=di.lineWidth||Xi.lineWidth||1;if(I<=1&&Tn.attr("lineWidth",Vc/I),Lu)break}}}}var Df=this.get("animate"),Rh=this.get("animateCfg");s.zoomTo(I,{x:d.x,y:d.y},Df,Rh),s.emit("wheelzoom",a)}}},a1={onMouseEnter:function(a){var e=a.item;this.currentTarget=e,this.showTooltip(a),this.graph.emit("tooltipchange",{item:a.item,action:"show"})},onMouseMove:function(a){if(!this.shouldUpdate(a,this)){this.hideTooltip();return}!this.currentTarget||a.item!==this.currentTarget||this.updatePosition(a)},onMouseLeave:function(a){!this.shouldEnd(a,this)||(this.hideTooltip(),this.graph.emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null)},showTooltip:function(a){var e=this.container;if(!(!a.item||a.item.destroyed)){e||(e=this.createTooltip(this.graph.get("canvas")),this.container=e);var i=this.formatText(a.item.get("model"),a);e.innerHTML=i,ru(this.container,{visibility:"visible"}),this.updatePosition(a)}},hideTooltip:function(){ru(this.container,{visibility:"hidden"})},updatePosition:function(a){var e=this.get("shouldBegin"),i=this,s=i.width,l=i.height,f=i.container,d=i.graph;if(!e(a,this)){ru(f,{visibility:"hidden"});return}var v=d.getPointByClient(a.clientX,a.clientY),x=d.getCanvasByPoint(v.x,v.y),w=x.x,I=x.y,G=f.getBoundingClientRect();w>s/2?w-=G.width:w+=this.offset,I>l/2?I-=G.height:I+=this.offset;var U="".concat(w,"px"),et="".concat(I,"px");ru(this.container,{left:U,top:et,visibility:"visible"})},createTooltip:function(a){var e=a.get("el");e.style.position="relative";var i=ql('<div class="g6-tooltip g6-'.concat(this.item,'-tooltip"></div>'));return e.parentNode.appendChild(i),ru(i,{position:"absolute",visibility:"visible"}),this.width=a.get("width"),this.height=a.get("height"),this.container=i,this.graph.get("tooltips").push(i),i}},OE=(0,P.__assign)({getDefaultCfg:function(){return{item:"node",offset:12,formatText:function(e){return e.label}}},getEvents:function(){return{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},a1),RE=(0,P.__assign)({getDefaultCfg:function(){return{item:"edge",offset:12,formatText:function(e){return"source: ".concat(e.source," target: ").concat(e.target)}}},getEvents:function(){return{"edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},a1),fc="click",hc=["click","dblclick"],lI={getDefaultCfg:function(){return{trigger:fc,onChange:function(){}}},getEvents:function(){var a,e;return hc.includes(this.trigger)?e=this.trigger:(e=fc,console.warn("Behavior collapse-expand \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click' \u6216 'dblclick'")),a={},a["node:".concat(e)]="onNodeClick",a.touchstart="onNodeClick",a},onNodeClick:function(a){var e=this;if(this.trigger==="click"){if(this.timer){clearTimeout(this.timer),this.timer=0;return}this.timer=setTimeout(function(){e.toggle(a),clearTimeout(e.timer),e.timer=0},200)}else this.toggle(a)},toggle:function(a){var e=a.item;if(!!e){var i=this.graph.findDataById(e.get("id"));if(!!i){var s=i.children;if(!(!s||s.length===0)){var l=!i.collapsed;!this.shouldBegin(a,l,this)||(i.collapsed=l,e.getModel().collapsed=l,this.graph.emit("itemcollapsed",{item:a.item,collapsed:l}),!!this.shouldUpdate(a,l,this)&&(this.onChange(e,l,this),this.graph.layout()))}}}}},cI=Gv.calculationItemsBBox,fI=function c(a,e){if(e(a)!==!1&&a){var i=a.get("combos");if(i.length===0)return!1;(0,k.each)(i,function(s){c(s,e)})}},hI={getDefaultCfg:function(){return{enableDelegate:!1,delegateStyle:{},onlyChangeComboSize:!1,activeState:"",selectedState:"selected",enableStack:!0}},getEvents:function(){return{"combo:mousedown":"onMouseDown","combo:dragstart":"onDragStart","combo:drag":"onDrag","combo:dragend":"onDragEnd","combo:drop":"onDrop","node:drop":"onNodeDrop","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave"}},validationCombo:function(a){var e=a.item;if(!e||e.destroyed||!this.shouldUpdate(a,this))return!1;var i=e.getType();return i==="combo"},onMouseDown:function(a){this.origin={x:a.x,y:a.y}},onDragStart:function(a){var e=this,i=this.graph,s=a.item;if(this.currentShouldEnd=!0,!!this.validationCombo(a)){this.targets=[];var l=i.findAllByState("combo",this.selectedState),f=s.get("id"),d=l.filter(function(x){var w=x.get("id");return f===w});d.length===0?this.targets.push(s):this.targets=l;var v=[];this.targets.forEach(function(x){var w=x.getModel(),I=w.x,G=w.y,U=w.id;v.push({x:I,y:G,id:U})}),this.set("beforeDragItems",v),this.activeState&&this.targets.map(function(x){var w=x.getModel();if(w.parentId){var I=i.findById(w.parentId);I&&i.setItemState(I,e.activeState,!0)}}),this.point={},this.originPoint={},this.currentItemChildCombos=[],fI(s,function(x){if(x.destroyed)return!1;var w=x.getModel();return e.currentItemChildCombos.push(w.id),!0})}},onDrag:function(a){var e=this;if(!!this.origin&&!!this.validationCombo(a))if(this.enableDelegate)this.updateDelegate(a);else{if(this.activeState){var i=this.graph,s=a.item,l=s.getModel(),f=i.getCombos(),d=s.getBBox(),v=d.centerX,x=d.centerY,w=d.width,I=f.filter(function(G){var U=G.getModel();return l.parentId,U.id!==l.id&&!e.currentItemChildCombos.includes(U.id)});I.map(function(G){var U=G.getBBox(),et=U.centerX,ft=U.centerY,Ct=U.width,Mt=v-et,kt=x-ft,$t=2*Math.sqrt(Mt*Mt+kt*kt);w+Ct-$t>.8*w?i.setItemState(G,e.activeState,!0):i.setItemState(G,e.activeState,!1)})}(0,k.each)(this.targets,function(G){e.updateCombo(G,a)}),this.onlyChangeComboSize&&this.updateParentCombos()}},updatePositions:function(a,e){var i=this;(this.enableDelegate||e)&&(0,k.each)(this.targets,function(s){i.updateCombo(s,a,e)})},onDrop:function(a){var e=this,i=a.item;if(this.currentShouldEnd=this.shouldEnd(a,i,this),this.updatePositions(a,!this.currentShouldEnd),!(!this.currentShouldEnd||!i||!this.targets||i.destroyed)){var s=this.graph,l=i.getModel();this.targets.map(function(f){var d=f.getModel();d.parentId!==l.id?(e.activeState&&s.setItemState(i,e.activeState,!1),e.onlyChangeComboSize?s.updateCombo(f):s.updateComboTree(f,l.id,!1)):s.updateCombo(i)}),this.end(i,a),this.endComparison=!0}},onNodeDrop:function(a){var e=this;if(!(!this.targets||this.targets.length===0)){var i=this.graph,s=a.item,l=s.getModel().comboId,f=l?i.findById(l):void 0;if(this.currentShouldEnd=this.shouldEnd(a,f,this),this.updatePositions(a,!this.currentShouldEnd),!!this.currentShouldEnd){var d;if(l){if(this.activeState){var v=i.findById(l);i.setItemState(v,this.activeState,!1)}this.targets.map(function(x){e.onlyChangeComboSize?i.updateCombo(x):l!==x.getID()&&(d=i.findById(l),l!==x.getModel().parentId&&i.updateComboTree(x,l,!1))})}else this.targets.map(function(x){if(e.onlyChangeComboSize)i.updateCombo(x);else{var w=x.getModel();w.comboId&&i.updateComboTree(x,void 0,!1)}});this.endComparison=!0,this.end(d,a)}}},onDragEnter:function(a){if(!!this.origin&&!!this.validationCombo(a)){var e=a.item,i=this.graph;this.activeState&&i.setItemState(e,this.activeState,!0)}},onDragLeave:function(a){if(!!this.origin&&!!this.validationCombo(a)){var e=a.item,i=this.graph;this.activeState&&i.setItemState(e,this.activeState,!1)}},onDragEnd:function(a){if(!(!this.targets||this.targets.length===0)){var e=a.item;this.currentShouldEnd&&this.updatePositions(a);var i=this.getParentCombo(e.getModel().parentId),s=this.graph;i&&this.activeState&&s.setItemState(i,this.activeState,!1),this.end(void 0,a)}},end:function(a,e){var i=this;if(!!this.origin){var s=this.graph;if(this.delegateShape){var l=s.get("delegateGroup");l.clear(),this.delegateShape=null}if(a&&this.activeState&&s.setItemState(a,this.activeState,!1),!a){var f=s.get("enabledStack")&&this.enableStack,d={before:{nodes:[],edges:[],combos:[].concat(this.get("beforeDragItems"))},after:{nodes:[],edges:[],combos:[]}};this.targets.map(function(v){if(!i.onlyChangeComboSize)s.updateComboTree(v,void 0,f);else{s.updateCombo(v);var x=v.getModel(),w=x.x,I=x.y,G=x.id;d.after.combos.push({x:w,y:I,id:G}),s.pushStack("update",d)}})}this.point=[],this.origin=null,this.originPoint=null,this.targets.length=0}},traverse:function(a,e,i){var s=this;if(i===void 0&&(i={}),e(a,i)!==!1&&a){var l=a.get("combos");(0,k.each)(l,function(d){s.traverse(d,e,i)});var f=a.get("nodes");(0,k.each)(f,function(d){s.traverse(d,e,i)})}},updateCombo:function(a,e,i){this.updateSingleItem(a,e,i);var s={};this.traverse(a,function(l,f){return l.destroyed?!1:(l.getEdges().forEach(function(d){return f[d.getID()]=d}),!0)},s),Object.values(s).forEach(function(l){return l.refresh()})},updateSingleItem:function(a,e,i){var s=this.origin,l=this.graph,f=a.getModel(),d=a.get("id");this.point[d]||(this.point[d]={x:f.x,y:f.y});var v=e.x-s.x+this.point[d].x,x=e.y-s.y+this.point[d].y;i&&(v+=s.x-e.x,x+=s.y-e.y),l.updateItem(a,{x:v,y:x},!1)},getParentCombo:function(a){var e=this.graph;if(!!a){var i=e.findById(a);if(!!i)return i}},updateDelegate:function(a){var e=this.graph;if(this.delegateShape){var G=a.x-this.origin.x+this.originPoint.minX,U=a.y-this.origin.y+this.originPoint.minY;this.delegateShape.attr({x:G,y:U})}else{var i=e.get("delegateGroup"),s=null;this.targets.length>1?s=cI(this.targets):s=this.targets[0].getBBox();var l=s.x,f=s.y,d=s.width,v=s.height,x=s.minX,w=s.minY;this.originPoint={x:l,y:f,width:d,height:v,minX:x,minY:w};var I=(0,P.__assign)((0,P.__assign)({},cg.delegateStyle),this.delegateStyle);this.delegateShape=i.addShape("rect",{attrs:(0,P.__assign)({width:s.width,height:s.height,x:s.x,y:s.y},I),name:"combo-delegate-shape"}),this.delegateShape.set("capture",!1),this.delegate=this.delegateShape}},updateParentCombos:function(){var a=this,e=a.graph,i=a.targets,s={};i==null||i.forEach(function(l){var f=l.getModel().parentId;f&&(s[f]=e.findById(f))}),Object.values(s).forEach(function(l){l&&e.updateCombo(l)})}},LE="dblclick",dI=["click","dblclick"],pI={getDefaultCfg:function(){return{trigger:LE,relayout:!0}},getEvents:function(){var a,e;return dI.includes(this.trigger)?e=this.trigger:(e=LE,console.warn("Behavior collapse-expand-group \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click' \u6216 'dblclick'")),a={},a["combo:".concat(e)]="onComboClick",a},onComboClick:function(a){var e=a.item,i=this,s=i.graph,l=i.relayout;if(!(!e||e.destroyed||e.getType()!=="combo")){var f=e.getModel(),d=f.id;!d||(s.collapseExpandCombo(d),l&&s.get("layout")?s.layout():s.refreshPositions())}}},vI=Gv.isPolygonsIntersect,gI=Gv.pathToPoints,PE="shift",mI=["drag","shift","ctrl","alt","control"],yI=function(a,e){var i,s=a.getKeyShape();if(a.get("type")==="path")i=gI(s.attr("path"));else{var l=s.getCanvasBBox();i=[[l.minX,l.minY],[l.maxX,l.minY],[l.maxX,l.maxY],[l.minX,l.maxY]]}return vI(e,i)},bI={getDefaultCfg:function(){return{delegateStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},shouldDeselect:void 0,selectedState:"selected",trigger:PE,includeEdges:!0,selectedEdges:[],selectedNodes:[]}},getEvents:function(){return mI.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=PE,console.warn("Behavior lasso-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")),this.trigger==="drag"?{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd","canvas:click":"clearStates"}:{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd",keyup:"onKeyUp",keydown:"onKeyDown","canvas:click":"clearStates"}},onDragStart:function(a){var e=this.lasso,i=a.item;i||this.trigger!=="drag"&&!this.keydown||(this.selectedNodes&&this.selectedNodes.length!==0&&this.clearStates("dragstart"),e||(e=this.createLasso()),this.dragging=!0,this.originPoint={x:a.x,y:a.y},this.points.push(this.originPoint),e.show())},onDragMove:function(a){!this.dragging||this.trigger!=="drag"&&!this.keydown||(this.points.push({x:a.x,y:a.y}),this.updateLasso(a))},onDragEnd:function(a){!this.lasso&&!this.dragging||this.trigger!=="drag"&&!this.keydown||(this.points.push(this.originPoint),this.getSelectedItems(),this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1)},getLassoPath:function(){var a=this.points,e=[];return a.length&&(a.forEach(function(i,s){s===0?e.push(["M",i.x,i.y]):e.push(["L",i.x,i.y])}),e.push(["L",a[0].x,a[0].y])),e},clearStates:function(a){a===void 0&&(a="canvas:click");var e=this,i=e.graph,s=e.selectedState,l=e.shouldDeselect,f=i.findAllByState("node",s),d=i.findAllByState("edge",s);(!l||l({action:a,nodes:f,edges:d}))&&(f.forEach(function(v){return i.setItemState(v,s,!1)}),d.forEach(function(v){return i.setItemState(v,s,!1)})),this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges),this.selectedNodes=[],this.selectedEdges=[],i.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[]},select:!1})},getSelectedItems:function(){var a=this,e=this,i=e.graph,s=e.shouldUpdate,l=this.points.map(function(w){return[i.getCanvasByPoint(w.x,w.y).x,i.getCanvasByPoint(w.x,w.y).y]}),f=this.selectedState,d=[],v=[];i.getNodes().forEach(function(w){if(!!w.isVisible()&&yI(w,l)&&s(w,"select",a)){d.push(w);var I=w.getModel();v.push(I.id),i.setItemState(w,f,!0)}});var x=[];this.includeEdges&&d.forEach(function(w){var I=w.getOutEdges();I.forEach(function(G){if(!!G.isVisible()){var U=G.getModel(),et=U.source,ft=U.target;v.includes(et)&&v.includes(ft)&&s(G,"select",a)&&(x.push(G),i.setItemState(G,a.selectedState,!0))}})}),this.selectedEdges=x,this.selectedNodes=d,this.onSelect&&this.onSelect(d,x),i.emit("nodeselectchange",{selectedItems:{nodes:d,edges:x},select:!0})},createLasso:function(){var a=this,e=a.graph.get("delegateGroup").addShape("path",{attrs:(0,P.__assign)({path:[]},a.delegateStyle),capture:!1,name:"lasso-shape"});return this.lasso=e,this.delegate=e,this.points=[],e},updateLasso:function(a){var e=this;this.lasso.attr({path:e.getLassoPath()})},onKeyDown:function(a){var e=a.key;!e||(e.toLowerCase()===this.trigger.toLowerCase()?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.lasso&&(this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1),this.keydown=!1}},FE="click",xI=["click","drag"],BE=void 0,zE=["shift","ctrl","control","alt","meta",void 0],i1={getDefaultCfg:function(){return{trigger:FE,key:BE,edgeConfig:{},getEdgeConfig:void 0}},getEvents:function(){var a=this;xI.indexOf(a.trigger.toLowerCase())>-1||(a.trigger=FE,console.warn("Behavior create-edge \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click'\uFF0C'drag'")),a.key&&zE.indexOf(a.key.toLowerCase())===-1&&(a.trigger=BE,console.warn("Behavior create-edge \u7684 key \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'shift'\uFF0C'ctrl'\uFF0C'alt'\uFF0C'control'\uFF0C\u6216 undefined"));var e;return a.trigger==="drag"?e={"node:dragstart":"onClick","combo:dragstart":"onClick",drag:"updateEndPoint","node:drop":"onClick","combo:drop":"onClick",dragend:"onDragEnd"}:a.trigger==="click"&&(e={"node:click":"onClick",mousemove:"updateEndPoint","edge:click":"cancelCreating","canvas:click":"cancelCreating","combo:click":"onClick"}),a.key&&(e.keydown="onKeyDown",e.keyup="onKeyUp"),e},onDragEnd:function(a){var e=this;if(!(e.key&&!e.keydown)){var i=a.item;(!i||i.getID()===e.source||i.getType()!=="node")&&e.cancelCreating({item:e.edge,x:a.x,y:a.y})}},onClick:function(a){var e=this;if(!(e.key&&!e.keydown)){var i=a.item,s=e.graph,l=i.getModel(),f=e.getEdgeConfig;if(e.addingEdge&&e.edge){if(!e.shouldEnd(a,e))return;var d=void 0;f&&(0,k.isFunction)(f)?d=f({source:e.source,target:l.id},e):d=e.edgeConfig;var v=(0,P.__assign)({target:l.id},d);if(e.source===l.id&&(v.type="loop"),s.emit("beforecreateedge",{}),s.updateItem(e.edge,v,!1),s.get("enabledStack")){var x=(0,P.__assign)((0,P.__assign)({},e.edge.getModel()),{itemType:"edge"}),w={};w.edges=[x],s.pushStack("add",{before:{},after:w})}s.emit("aftercreateedge",{edge:e.edge}),e.edge.getKeyShape().set("capture",!0),e.edge=null,e.addingEdge=!1}else{if(!e.shouldBegin(a,e))return;var d=void 0;f&&(0,k.isFunction)(f)?d=f({source:l.id,target:l.id},e):d=e.edgeConfig,e.edge=s.addItem("edge",(0,P.__assign)({source:l.id,target:l.id},d),!1),e.source=l.id,e.addingEdge=!0,e.edge.getKeyShape().set("capture",!1)}}},updateEndPoint:function(a){var e=this;if(!(e.key&&!e.keydown)){e.edge&&e.edge.destroyed&&e.cancelCreating({item:e.edge});var i={x:a.x,y:a.y};if(!e.graph.findById(e.source)){e.addingEdge=!1;return}e.addingEdge&&e.edge&&e.graph.updateItem(e.edge,{target:i},!1)}},cancelCreating:function(a){var e,i,s=this;if(!(s.key&&!s.keydown)){var l=s.graph,f=a.item;if(s.addingEdge&&(s.edge===f||((i=(e=a.target)===null||e===void 0?void 0:e.isCanvas)===null||i===void 0?void 0:i.call(e)))){s.edge&&!s.edge.destroyed&&l.removeItem(s.edge,!1),s.edge=null,s.addingEdge=!1;return}}},onKeyDown:function(a){var e=this,i=a.key;!i||(i.toLowerCase()===e.key.toLowerCase()?e.keydown=!0:e.keydown=!1)},onKeyUp:function(){var a=this;a.addingEdge&&a.edge&&(a.graph.removeItem(a.edge,!1),a.addingEdge=!1,a.edge=null),this.keydown=!1}},N0="ctrl",Jb=["shift","ctrl","alt","control"],o1="1",vu={getDefaultCfg:function(){return{trigger:N0,combinedKey:o1,functionName:"fitView",functionParams:[]}},getEvents:function(){return Jb.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=N0,console.warn("Behavior shortcuts-fit-view \u7684 trigger \u53C2\u6570 '".concat(this.trigger,"' \u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'"))),this.combinedKey===this.trigger&&(this.combinedKey=void 0),{keyup:"onKeyUp",keydown:"onKeyDown"}},onKeyDown:function(a){var e=a.key;if(!!e){var i=this.trigger.toLowerCase(),s=e.toLowerCase();this.triggerKeydown||(s===i||s==="control"&&i==="ctrl"||s==="ctrl"&&i==="control"?this.triggerKeydown=!0:this.triggerKeydown=!1);var l=this.graph;if(!l[this.functionName])return console.warn("Behavior shortcuts-fit-view \u7684 functionName \u53C2\u6570 '".concat(this.functionName,"' \u4E0D\u5408\u6CD5\uFF0C\u5B83\u4E0D\u662F Graph \u7684\u4E00\u4E2A\u51FD\u6570\u540D")),{};if(this.triggerKeydown&&!this.combinedKey){this.functionParams&&this.functionParams.length?l[this.functionName].apply(l,this.functionParams):l[this.functionName]();return}var f=this.combinedKey.toLowerCase();this.triggerKeydown&&(s===f||s==="control"&&f==="ctrl"||s==="ctrl"&&f==="control")&&(this.functionParams&&this.functionParams.length?l[this.functionName].apply(l,this.functionParams):l[this.functionName]())}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.triggerKeydown=!1}},Wl=["shift","ctrl","alt","control","meta"],s1={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,zoomKey:"ctrl",scalableRange:0,allowDragOnItem:!0}},getEvents:function(){return(!this.zoomKey||Wl.indexOf(this.zoomKey)===-1)&&(this.zoomKey="ctrl"),{wheel:"onWheel"}},onWheel:function(a){var e=this;if(!!this.allowDrag(a)){var i=this.graph,s=Array.isArray(this.zoomKey)?[].concat(this.zoomKey):[this.zoomKey];s.includes("control")&&s.push("ctrl");var l=s.some(function(Ya){return a["".concat(Ya,"Key")]});if(l){var f=i.get("canvas"),d=f.getPointByClient(a.clientX,a.clientY),v=i.getZoom();a.wheelDelta>0?v=v+v*.05:v=v-v*.05,i.zoomTo(v,{x:d.x,y:d.y})}else{var x=a.deltaX||a.movementX,w=a.deltaY||a.movementY;!w&&navigator.userAgent.indexOf("Firefox")>-1&&(w=-a.wheelDelta*125/3);var I=this.graph.get("width"),G=this.graph.get("height"),U=this.graph.get("canvas").getCanvasBBox(),et=this.scalableRange,ft=this.scalableRange;et<1&&et>-1&&(et=I*et,ft=G*ft);var Ct=U.minX,Mt=U.maxX,kt=U.minY,$t=U.maxY;x>0?Mt<-et?x=0:Mt-x<-et&&(x=Mt+et):x<0&&(Ct>I+et?x=0:Ct-x>I+et&&(x=Ct-(I+et))),w>0?$t<-ft?w=0:$t-w<-ft&&(w=$t+ft):w<0&&(kt>G+ft?w=0:kt-w>G+ft&&(w=kt-(G+ft))),this.get("direction")==="x"?w=0:this.get("direction")==="y"&&(x=0),i.translate(-x,-w)}a.preventDefault();var Jt=this.get("enableOptimize");if(Jt){var Ce=this.get("optimizeZoom"),je=this.get("optimized"),ze=i.getNodes(),pn=i.getEdges(),Fn=ze.length,Tn=pn.length;if(!je){for(var cr=0;cr<Fn;cr++){var kr=ze[cr];if(!kr.destroyed)for(var Aa=kr.get("group").get("children"),ci=Aa.length,ei=0;ei<ci;ei++){var Ca=Aa[ei];!Ca.destoryed&&!Ca.get("isKeyShape")&&(Ca.set("ori-visibility",Ca.get("ori-visibility")||Ca.get("visible")),Ca.hide())}}for(var Pi=0;Pi<Tn;Pi++)for(var Ni=pn[Pi],Aa=Ni.get("group").get("children"),ci=Aa.length,ei=0;ei<ci;ei++){var Ca=Aa[ei];Ca.set("ori-visibility",Ca.get("ori-visibility")||Ca.get("visible")),Ca.hide()}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var _a=setTimeout(function(){var Ya=i.getZoom(),hi=e.get("optimized");if(hi){e.set("optimized",!1);for(var di=0;di<Fn;di++){var Xi=ze[di],go=Xi.get("group").get("children"),vs=go.length;if(Ya<Ce){var Fs=Xi.getKeyShape(),hl=Fs.get("ori-visibility");hl&&Fs.show()}else for(var Lu=0;Lu<vs;Lu++){var dl=go[Lu],hl=dl.get("ori-visibility");!dl.get("visible")&&hl&&hl&&dl.show()}}for(var _l=0;_l<Tn;_l++){var rc=pn[_l],go=rc.get("group").get("children"),vs=go.length;if(Ya<Ce){var Fs=rc.getKeyShape(),hl=Fs.get("ori-visibility");hl&&Fs.show()}else for(var Lu=0;Lu<vs;Lu++){var dl=go[Lu];if(!dl.get("visible")){var hl=dl.get("ori-visibility");hl&&dl.show()}}}}},100);this.set("timeout",_a)}}},allowDrag:function(a){var e,i,s=a.target,l=s&&s.isCanvas&&s.isCanvas();if((0,k.isBoolean)(this.allowDragOnItem)&&!this.allowDragOnItem&&!l)return!1;if((0,k.isObject)(this.allowDragOnItem)){var f=this.allowDragOnItem,d=f.node,v=f.edge,x=f.combo,w=(i=(e=a.item)===null||e===void 0?void 0:e.getType)===null||i===void 0?void 0:i.call(e);if(!d&&w==="node"||!v&&w==="edge"||!x&&w==="combo")return!1}return!0}},$E={"drag-canvas":qb,"zoom-canvas":r1,"drag-node":Zy,"activate-relations":Qb,"brush-select":kh,"click-select":e1,"lasso-select":bI,tooltip:OE,"edge-tooltip":RE,"collapse-expand":lI,"drag-combo":hI,"collapse-expand-combo":pI,"create-edge":i1,"shortcuts-call":vu,"scroll-canvas":s1};(0,k.each)($E,function(c,a){Ux(a,c)});var Bp=(0,P.__assign)((0,P.__assign)({},Y),hm),HA=bu.Grid,PD=bu.Minimap,FD=bu.Bundling,BD=bu.Menu,XA=bu.Fisheye,zD=bu.ToolBar,$D=bu.Tooltip,YA=bu.TimeBar,KA=bu.ImageMinimap,ZA=bu.EdgeFilterLens,qA=bu.SnapLine,GD=bu.Legend,QA=bu.Annotation,u1={version:cg.version,Graph:Iw,TreeGraph:gC,Util:Gv,Layout:pu.Layouts,TreeLayout:bw,registerLayout:ub,Global:cg,registerBehavior:Ux,registerCombo:q0,registerEdge:Gx,registerNode:zc,Minimap:bu.Minimap,Grid:bu.Grid,Bundling:bu.Bundling,Menu:bu.Menu,ToolBar:bu.ToolBar,Tooltip:bu.Tooltip,Legend:bu.Legend,TimeBar:YA,SnapLine:qA,Fisheye:XA,ImageMinimap:KA,EdgeFilterLens:ZA,Annotation:QA,Algorithm:Bp,Arrow:Px,Marker:P1,Shape:rg};u1.version="4.8.17";var tx=u1,UD="4.8.17"},4714:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return k}});var Y=$(67294),tt=$(36950),j=$(90314),W=function(st){var lt=st.children,ht=st.onClick,mt=ht===void 0?function(){}:ht,wt=Y.useContext(tt.Z),ut=function(){mt();var Nt=wt.contextmenu;Nt.node&&Nt.node.handleClose(),Nt.edge&&Nt.edge.handleClose(),Nt.canvas&&Nt.canvas.handleClose()};return Y.createElement("li",{onClick:ut},lt)},Q=function(st){var lt=st.bindType,ht=lt===void 0?"node":lt,mt=Y.useContext(tt.Z),wt=st.options,ut=st.onChange,pt=function(ue){try{var se=mt.contextmenu,Le=null;ht==="node"&&(Le=se.node.item.getModel()),ht==="edge"&&(Le=se.edge.item.getModel()),ht==="canvas"&&(Le=null),ut&&(ut(ue,Le),se[ht].handleClose())}catch(Ne){console.log(Ne)}},Nt=st.children;return wt?Y.createElement("ul",{className:"graphin-components-contextmenu-content"},wt.map(function(Ut){var ue=Ut.key,se=Ut.icon,Le=Ut.name;return Y.createElement(W,{key:ue||Le,onClick:function(){pt(Ut)}},se," ",Le)})):Y.createElement("ul",{className:"graphin-components-contextmenu-content"},Nt)};Q.Item=W;var Z=Q;function R(yt,st,lt){return st in yt?Object.defineProperty(yt,st,{value:lt,enumerable:!0,configurable:!0,writable:!0}):yt[st]=lt,yt}function L(yt,st){return O(yt)||B(yt,st)||A(yt,st)||C()}function C(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A(yt,st){if(!!yt){if(typeof yt=="string")return N(yt,st);var lt=Object.prototype.toString.call(yt).slice(8,-1);if(lt==="Object"&&yt.constructor&&(lt=yt.constructor.name),lt==="Map"||lt==="Set")return Array.from(yt);if(lt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(lt))return N(yt,st)}}function N(yt,st){(st==null||st>yt.length)&&(st=yt.length);for(var lt=0,ht=new Array(st);lt<st;lt++)ht[lt]=yt[lt];return ht}function B(yt,st){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(yt)))){var lt=[],ht=!0,mt=!1,wt=void 0;try{for(var ut=yt[Symbol.iterator](),pt;!(ht=(pt=ut.next()).done)&&(lt.push(pt.value),!(st&&lt.length===st));ht=!0);}catch(Nt){mt=!0,wt=Nt}finally{try{!ht&&ut.return!=null&&ut.return()}finally{if(mt)throw wt}}return lt}}function O(yt){if(Array.isArray(yt))return yt}var F=tt.Z,K={width:200,background:"#fff"},nt,P=function(st){var lt=st.children,ht=st.bindType,mt=ht===void 0?"node":ht,wt=st.style,ut=Y.useContext(F),pt=ut.graph,Nt=Y.useState({visible:!1,x:0,y:0,item:null}),Ut=L(Nt,2),ue=Ut[0],se=Ut[1],Le=function(Oe){Oe.preventDefault(),Oe.stopPropagation();var Ze=pt.get("width"),fe=pt.get("height"),Ae=nt.getBoundingClientRect(),Ye=pt.get("offsetX")||0,ge=pt.get("offsetY")||0,Be=pt.getContainer().offsetTop,te=pt.getContainer().offsetLeft,ke=Oe.canvasX+te+Ye,Ve=Oe.canvasY+Be+ge;if(ke+Ae.width>Ze&&(ke=Oe.canvasX-Ae.width-Ye+te),Ve+Ae.height>fe&&(Ve=Oe.canvasY-Ae.height-ge+Be),mt==="node"){var ee=Oe.item&&Oe.item.getModel(),Ft=ee.x,bt=ee.y,Me=pt.getCanvasByPoint(Ft,bt),en=Oe.canvasX-Me.x,fn=Oe.canvasY-Me.y;ke=ke-en,Ve=Ve-fn}se(function(Rt){return Object.assign(Object.assign({},Rt),{visible:!0,x:ke,y:Ve,item:Oe.item})})},Ne=function(){se(function(Oe){return Oe.visible?Object.assign(Object.assign({},Oe),{visible:!1,x:0,y:0}):Oe})};(0,Y.useEffect)(function(){return pt.on("".concat(mt,":contextmenu"),Le),pt.on("canvas:click",Ne),pt.on("canvas:drag",Ne),pt.on("wheelzoom",Ne),function(){pt.off("".concat(mt,":contextmenu"),Le),pt.off("canvas:click",Ne),pt.off("canvas:drag",Ne),pt.off("wheelzoom",Ne)}},[]);var we=ue.x,At=ue.y,Qt=ue.visible,de=ue.item,rn={position:"absolute",left:we,top:At};ut.contextmenu=Object.assign(Object.assign({},ut.contextmenu),R({},mt,{handleOpen:Le,handleClose:Ne,item:de,visible:Qt,x:we,y:At,bindType:mt}));var Ee=de&&!de.destroyed&&de.getModel&&de.getModel().id||"";return Y.createElement(Y.Fragment,null,Y.createElement("div",{ref:function(Oe){nt=Oe},className:"graphin-components-contextmenu",style:Object.assign(Object.assign(Object.assign({},K),wt),rn),key:Ee},Qt&&lt))};P.Menu=Z;var k=P},49346:function(ur,ot,$){"use strict";var Y=$(36950),tt=$(9106),j=$(67294),W={r:249,scaleRByWheel:!0,minR:100,maxR:500,delegateStyle:{stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:.1,fill:"#ccc"},showLabel:!1},Q=function(R){var L=j.useContext(Y.Z),C=L.graph,A=R.options,N=R.visible,B=R.handleEscListener;return j.useEffect(function(){var O=Object.assign(Object.assign({},W),A);O.showLabel&&C.getNodes().forEach(function(nt){nt.getContainer().getChildren().forEach(function(P){P.get("type")==="text"&&P.hide()})});var F=new tt.ZP.Fisheye(O),K=function(P){P.keyCode===27&&B&&(B(),C.get("canvas").setCursor("default"))};return N&&(C.addPlugin(F),C.get("canvas").setCursor("zoom-in")),B&&window.addEventListener("keydown",K),function(){C&&!C.destroyed&&(C.get("canvas").setCursor("default"),C.removePlugin(F)),B&&window.removeEventListener("keydown",K)}},[C,A,N,B]),null};ot.Z=Q},50651:function(ur,ot,$){"use strict";var Y=$(36950),tt=$(75345),j=$(67294),W=$(10410),Q=$.n(W),Z=Y.Z,R={background:"#fff"},L=function(N){var B=N.children,O=N.onClick,F=O===void 0?function(){}:O;return j.createElement("li",{onClick:F,onKeyDown:F},B)},C=function(N){var B=N.children,O=N.style,F=O===void 0?{}:O,K=N.direction,nt=K===void 0?"horizontal":K,P=N.options,k=N.onChange,yt=j.useContext(Z),st=nt==="horizontal",lt={position:"absolute"};st?(lt.right=0,lt.top=0):(lt.left=0,lt.bottom=0);var ht=function(wt){try{k&&k(yt,wt)}catch(ut){console.log(ut)}};return P?j.createElement("div",{className:"graphin-components-toolbar",style:Object.assign(Object.assign(Object.assign({},R),lt),F)},j.createElement("ul",{className:"graphin-components-toolbar-content",style:{display:st?"flex":""}},P.map(function(mt){var wt=mt.key,ut=mt.name;return j.createElement(L,{key:wt||ut,onClick:function(){ht(mt)}},ut)}))):j.createElement("div",{style:Object.assign(Object.assign(Object.assign({},R),lt),F),className:"graphin-components-toolbar"},(0,tt.Z)(B)||B&&B.type===L?j.createElement("ul",{className:"graphin-components-toolbar-content",style:{display:st?"flex":""}},B):B)};C.Item=L,ot.Z=C},36950:function(ur,ot,$){"use strict";var Y=$(67294),tt={graph:{},apis:{},theme:{},layout:{}},j=Y.createContext(tt);ot.Z=j},98818:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return ke}});var Y=$(67294),tt=$(36950),j=function(Ve,ee){var Ft={};for(var bt in Ve)Object.prototype.hasOwnProperty.call(Ve,bt)&&ee.indexOf(bt)<0&&(Ft[bt]=Ve[bt]);if(Ve!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Me=0,bt=Object.getOwnPropertySymbols(Ve);Me<bt.length;Me++)ee.indexOf(bt[Me])<0&&Object.prototype.propertyIsEnumerable.call(Ve,bt[Me])&&(Ft[bt[Me]]=Ve[bt[Me]]);return Ft},W=function(ee){var Ft=ee.type,bt=ee.defaultConfig,Me=ee.userProps,en=ee.mode,fn=en===void 0?"default":en,Rt=Y.useContext(tt.Z),Xn=Rt.graph,Bn=Me.disabled,xr=j(Me,["disabled"]);Y.useEffect(function(){if(!(!Xn||Xn.destroyed)&&(Xn.removeBehaviors(Ft,fn),!Bn))return Xn.addBehaviors(Object.assign(Object.assign({type:Ft},bt),xr),fn),function(){Xn.destroyed||Xn.removeBehaviors(Ft,fn)}},[])},Q=W,Z={disabled:!1,trigger:"mouseenter",activeState:"active",inactiveState:"inactive",resetSelected:!1},R=function(ee){return Q({type:"activate-relations",userProps:ee,defaultConfig:Z}),null},L=R,C="shift",A={disabled:!1,brushStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:C,includeEdges:!0,includeCombos:!1},N=function(ee){return Q({type:"brush-select",userProps:ee,defaultConfig:A}),null},B=N,O="shift",F={disabled:!1,multiple:!0,trigger:O,selectedState:"selected",selectNode:!0,selectEdge:!1,selectCombo:!0},K=function(ee){return Q({type:"click-select",userProps:ee,defaultConfig:F}),null},nt=K,P={direction:"both",enableOptimize:!1,scalableRange:0,shouldBegin:function(){return!0},disabled:!1},k=function(ee){return Q({type:"drag-canvas",userProps:ee,defaultConfig:P}),null},yt=k,st={disabled:!1,enableDelegate:!1,delegateStyle:{},onlyChangeComboSize:!1,activeState:"",selectedState:"selected"},lt=function(ee){return Q({type:"drag-combo",userProps:ee,defaultConfig:st}),null},ht=lt,mt={disabled:!1,updateEdge:!0,delegateStyle:{},enableDelegate:!1,onlyChangeComboSize:!1,comboActiveState:"",selectedState:"selected"},wt=function(ee){return Q({type:"drag-node",userProps:ee,defaultConfig:mt}),null},ut=wt,pt=function(ee){var Ft=Y.useContext(tt.Z),bt=Ft.graph,Me=Ft.layout,en=Ft.dragNodes,fn=Ft.updateContext,Rt=ee.autoPin,Xn=ee.pinAction,Bn=ee.dragNodeMass,xr=Bn===void 0?1e10:Bn,dr=Me.instance;return(0,Y.useEffect)(function(){var Ur,fa=dr||{type:(Ur=bt.get("layout"))===null||Ur===void 0?void 0:Ur.type},Ea=fa.simulation,aa=fa.type,Da=function(){var sr;if(Ea)Ea.stop();else{var Pn=((sr=bt.get("layoutController"))===null||sr===void 0?void 0:sr.layoutMethods)||[];Pn.forEach(function(tr){var zn;return(zn=tr.stop)===null||zn===void 0?void 0:zn.call(tr)})}},Lr=function(sr){if(!(aa!=="graphin-force"&&aa!=="force2")&&sr.item){var Pn=sr.item.get("model");Pn.layout=Object.assign(Object.assign({},Pn.layout),{force:{mass:Rt?xr:null}});var tr=[];bt.getNodes().forEach(function(Wr){if(Wr.hasState("selected")){var Yr=Wr.get("model");Yr.layout||(Yr.layout={}),Yr.layout.force={mass:Rt?xr:null},tr.push(Yr)}});var zn=en.concat([Pn]);tr.length>1&&(zn=zn.concat(tr)),fn({dragNodes:zn})}};return bt.on("node:dragstart",Da),bt.on("node:dragend",Lr),function(){bt.off("node:dragstart",Da),bt.off("node:dragend",Lr)}},[bt,Rt,dr,en,fn]),(0,Y.useEffect)(function(){var Ur=Xn||{},fa=Ur.id,Ea=Ur.pinned;if(!!fa){var aa=en;if(!Ea)aa=en.filter(function(_n){return _n.id!==fa});else{var Da=bt.findById(fa);if(!Da)return;var Lr=Da.get("model");Lr.layout||(Lr.layout={}),Lr.layout.force={mass:Rt?xr:null},aa.push(Lr)}fn({dragNodes:aa})}},[Xn]),null};pt.defaultProps={autoPin:!1,dragNodeMass:1e10,pinAction:void 0};var Nt=pt,Ut=function(ee){var Ft=ee.padding,bt=ee.isBindLayoutChange,Me=Y.useContext(tt.Z),en=Me.graph;return(0,Y.useEffect)(function(){var fn=function(){en.fitView(Ft)};return fn(),bt&&en.on("afterlayout",fn),function(){bt&&en.off("afterlayout",fn)}},[]),null},ue=Ut,se=function(){var ee=Y.useContext(tt.Z),Ft=ee.graph;return Y.useEffect(function(){var bt=setTimeout(function(){Ft.getNodes().forEach(function(Me){Ft.setItemState(Me,"normal",!0)}),Ft.paint()},1600);return function(){clearTimeout(bt)}},[]),null},Le=se,Ne=function(ee){var Ft=Y.useContext(tt.Z),bt=ee.bindType,Me=bt===void 0?"node":bt,en=ee.disabled,fn=Ft.graph;return Y.useEffect(function(){if(!en){var Rt=function(Ur){fn.setItemState(Ur.item,"hover",!0)},Xn=function(Ur){fn.setItemState(Ur.item,"hover",!1)},Bn=function(Ur){fn.setItemState(Ur.item,"hover",!0)},xr=function(Ur){fn.setItemState(Ur.item,"hover",!1)};return Me==="node"&&(fn.on("node:mouseenter",Rt),fn.on("node:mouseleave",Xn)),Me==="edge"&&(fn.on("edge:mouseenter",Bn),fn.on("edge:mouseleave",xr)),function(){Me==="node"&&(fn.off("node:mouseenter",Rt),fn.off("node:mouseleave",Xn)),Me==="edge"&&(fn.off("edge:mouseenter",Bn),fn.off("edge:mouseleave",xr))}}},[fn,en]),null},we=Ne,At="shift",Qt={disabled:!1,delegateStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:At,includeEdges:!0},de=function(ee){return Q({type:"lasso-select",userProps:ee,defaultConfig:Qt}),null},rn=de,Ee=$(23044),ce=function(ee){var Ft=ee.graphDOM,bt=Y.useContext(tt.Z);return Y.useEffect(function(){var Me=bt.graph,en=(0,Ee.debounce)(function(){var fn=Ft.clientWidth,Rt=Ft.clientHeight;Me.set("width",fn),Me.set("height",Rt);var Xn=Me.get("canvas");Xn&&(Xn.changeSize(fn,Rt),Me.autoPaint())},200);return window.addEventListener("resize",en,!1),function(){window.removeEventListener("resize",en,!1)}},[]),null},Oe=ce,Ze=function(Ve,ee){var Ft={};for(var bt in Ve)Object.prototype.hasOwnProperty.call(Ve,bt)&&ee.indexOf(bt)<0&&(Ft[bt]=Ve[bt]);if(Ve!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Me=0,bt=Object.getOwnPropertySymbols(Ve);Me<bt.length;Me++)ee.indexOf(bt[Me])<0&&Object.prototype.propertyIsEnumerable.call(Ve,bt[Me])&&(Ft[bt[Me]]=Ve[bt[Me]]);return Ft},fe={trigger:"click"},Ae=function(ee){var Ft=ee.onChange,bt=Ze(ee,["onChange"]),Me=Y.useContext(tt.Z),en=Me.graph;return Q({defaultConfig:fe,userProps:bt,type:"collapse-expand"}),Y.useEffect(function(){var fn=function(Xn){var Bn=Xn.item,xr=Xn.collapsed,dr=Bn.get("model");dr.collapsed=xr,Ft&&Ft(Bn,xr)};return en.on("itemcollapsed",fn),function(){en.off("itemcollapsed",fn)}},[]),null},Ye=Ae,ge={sensitivity:2,minZoom:void 0,maxZoom:void 0,enableOptimize:!1,optimizeZoom:.1,fixSelectedItems:{fixAll:!1,fixLineWidth:!1,fixLabel:!1,fixState:"selected"},disabled:!1,animate:!1,animateCfg:{duration:500}},Be=function(ee){return Q({type:"zoom-canvas",userProps:ee,defaultConfig:ge}),null},te=Be,ke={DragCanvas:yt,ZoomCanvas:te,ClickSelect:nt,BrushSelect:B,DragNode:ut,ResizeCanvas:Oe,LassoSelect:rn,DragCombo:ht,ActivateRelations:L,TreeCollapse:Ye,FitView:ue,FontPaint:Le,DragNodeWithForce:Nt,Hoverable:we}},82735:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return Yr}});var Y=$(67294),tt=$(36950);function j(nr,wr){return L(nr)||R(nr,wr)||Q(nr,wr)||W()}function W(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q(nr,wr){if(!!nr){if(typeof nr=="string")return Z(nr,wr);var Sr=Object.prototype.toString.call(nr).slice(8,-1);if(Sr==="Object"&&nr.constructor&&(Sr=nr.constructor.name),Sr==="Map"||Sr==="Set")return Array.from(nr);if(Sr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Sr))return Z(nr,wr)}}function Z(nr,wr){(wr==null||wr>nr.length)&&(wr=nr.length);for(var Sr=0,pr=new Array(wr);Sr<wr;Sr++)pr[Sr]=nr[Sr];return pr}function R(nr,wr){var Sr=nr==null?null:typeof Symbol!="undefined"&&nr[Symbol.iterator]||nr["@@iterator"];if(Sr!=null){var pr=[],qr=!0,ua=!1,$r,ba;try{for(Sr=Sr.call(nr);!(qr=($r=Sr.next()).done)&&(pr.push($r.value),!(wr&&pr.length===wr));qr=!0);}catch(gt){ua=!0,ba=gt}finally{try{!qr&&Sr.return!=null&&Sr.return()}finally{if(ua)throw ba}}return pr}}function L(nr){if(Array.isArray(nr))return nr}var C=function(wr){var Sr=wr.bindType,pr=Sr===void 0?"node":Sr,qr=wr.container,ua=wr.disableAutoAdjust,$r=Y.useContext(tt.Z),ba=$r.graph,gt=Y.useState({visible:!1,x:0,y:0,item:null,selectedItems:[]}),Dn=j(gt,2),un=Dn[0],Lt=Dn[1],Ot=function(ne){ne.preventDefault(),ne.stopPropagation();var on=ba.get("width"),tn=ba.get("height");if(!!qr.current){var He=qr.current.getBoundingClientRect(),Qn=ba.get("offsetX")||0,Ln=ba.get("offsetY")||0,Qr=ba.getContainer().offsetTop,Ia=ba.getContainer().offsetLeft,Jn=ne.canvasX+Ia+Qn,Ar=ne.canvasY+Qr+Ln;if(ua||(Jn+He.width>on&&(Jn=ne.canvasX-He.width-Qn+Ia),Ar+He.height>tn&&(Ar=ne.canvasY-He.height-Ln+Qr)),pr==="node"){var na=ne.item&&ne.item.getModel(),za=na.x,da=na.y,Ti=ba.getCanvasByPoint(za,da),ki=ne.canvasX-Ti.x,vi=ne.canvasY-Ti.y;Jn=Jn-ki,Ar=Ar-vi}Lt(function(ii){return Object.assign(Object.assign({},ii),{visible:!0,x:Jn,y:Ar,item:ne.item})})}},it=function(){Lt(function(ne){return ne.visible?Object.assign(Object.assign({},ne),{visible:!1,x:0,y:0}):ne})};(0,Y.useEffect)(function(){var Xt=function(on){Lt(function(tn){return Object.assign(Object.assign({},tn),{selectedItems:on.selectedItems})})};return ba.on("".concat(pr,":contextmenu"),Ot),ba.on("canvas:click",it),ba.on("canvas:drag",it),ba.on("wheelzoom",it),pr==="canvas"&&ba.on("nodeselectchange",Xt),function(){ba.off("".concat(pr,":contextmenu"),Ot),ba.off("canvas:click",it),ba.off("canvas:drag",it),ba.off("wheelzoom",it),ba.off("nodeselectchange",Xt)}},[ba,pr]);var H=un.x,X=un.y,xt=un.visible,zt=un.item,Vt=un.selectedItems;return{oneShow:Ot,onClose:it,item:zt,selectedItems:Vt,visible:xt,x:H,y:X}},A=C,N={width:"120px",boxShadow:"0 4px 12px rgb(0 0 0 / 15%)"},B=Y.createRef(),O=function(wr){var Sr=wr.bindType,pr=wr.children,qr=wr.style,ua=wr.disableAutoAdjust,$r=A({bindType:Sr,container:B,disableAutoAdjust:ua}),ba=$r.visible,gt=$r.x,Dn=$r.y,un=$r.item,Lt={position:"absolute",left:gt,top:Dn};if(typeof pr!="function")return console.error("<ContextMenu /> children should be a function"),null;var Ot=un&&!un.destroyed&&un.getModel&&un.getModel().id||"";return Y.createElement("div",{ref:B,className:"graphin-components-contextmenu",style:Object.assign(Object.assign(Object.assign({},N),qr),Lt),key:Ot},ba&&pr(Object.assign(Object.assign({},$r),{id:Ot})))},F=O,K=$(9106),nt={r:249,scaleRByWheel:!0,minR:100,maxR:500,delegateStyle:{stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:.1,fill:"#ccc"},showLabel:!1},P=function(wr){var Sr=Y.useContext(tt.Z),pr=Sr.graph,qr=wr.options,ua=wr.visible,$r=wr.handleEscListener;return Y.useEffect(function(){var ba=Object.assign(Object.assign({},nt),qr);ba.showLabel&&pr.getNodes().forEach(function(un){un.getContainer().getChildren().forEach(function(Lt){Lt.get("type")==="text"&&Lt.hide()})});var gt=new K.ZP.Fisheye(ba),Dn=function(Lt){Lt.keyCode===27&&$r&&($r(),pr.get("canvas").setCursor("default"))};return ua&&(pr.addPlugin(gt),pr.get("canvas").setCursor("zoom-in")),$r&&window.addEventListener("keydown",Dn),function(){pr&&!pr.destroyed&&(pr.get("canvas").setCursor("default"),pr.removePlugin(gt)),$r&&window.removeEventListener("keydown",Dn)}},[pr,qr,ua,$r]),null},k=P,yt=$(23044),st=function(nr,wr){var Sr={};for(var pr in nr)Object.prototype.hasOwnProperty.call(nr,pr)&&wr.indexOf(pr)<0&&(Sr[pr]=nr[pr]);if(nr!=null&&typeof Object.getOwnPropertySymbols=="function")for(var qr=0,pr=Object.getOwnPropertySymbols(nr);qr<pr.length;qr++)wr.indexOf(pr[qr])<0&&Object.prototype.propertyIsEnumerable.call(nr,pr[qr])&&(Sr[pr[qr]]=nr[pr[qr]]);return Sr},lt={members:[],type:"round-convex",nonMembers:[],style:{fill:"lightblue",stroke:"blue",opacity:.2},padding:10},ht=function(wr,Sr){var pr=wr.style,qr=pr===void 0?{}:pr,ua=st(wr,["style"]),$r=Sr.style,ba=$r===void 0?{}:$r,gt=st(Sr,["style"]);return Object.assign(Object.assign(Object.assign({},ua),gt),{style:Object.assign(Object.assign({},qr),ba)})},mt,wt=function(wr){var Sr=Y.useContext(tt.Z),pr=Sr.graph,qr=wr.options;return Y.useEffect(function(){mt&&mt.length&&mt.forEach(function($r){return pr.removeHull($r)}),mt=qr.map(function($r){return pr.createHull(ht(lt,Object.assign({id:"".concat(Math.random())},$r)))});var ua=(0,yt.debounce)(function(){mt.forEach(function($r,ba){$r.group.destroyed?mt[ba]=pr.createHull(ht(lt,Object.assign({id:"".concat(Math.random())},qr[ba]))):$r.updateData($r.members)})});return pr.on("afterupdateitem",ua),pr.on("aftergraphrefreshposition",ua),function(){pr.off("afterupdateitem",ua),pr.off("aftergraphrefreshposition",ua)}},[pr,qr]),null},ut=wt,pt=$(94635);function Nt(nr,wr){return Ne(nr)||Le(nr,wr)||ue(nr,wr)||Ut()}function Ut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ue(nr,wr){if(!!nr){if(typeof nr=="string")return se(nr,wr);var Sr=Object.prototype.toString.call(nr).slice(8,-1);if(Sr==="Object"&&nr.constructor&&(Sr=nr.constructor.name),Sr==="Map"||Sr==="Set")return Array.from(nr);if(Sr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Sr))return se(nr,wr)}}function se(nr,wr){(wr==null||wr>nr.length)&&(wr=nr.length);for(var Sr=0,pr=new Array(wr);Sr<wr;Sr++)pr[Sr]=nr[Sr];return pr}function Le(nr,wr){var Sr=nr==null?null:typeof Symbol!="undefined"&&nr[Symbol.iterator]||nr["@@iterator"];if(Sr!=null){var pr=[],qr=!0,ua=!1,$r,ba;try{for(Sr=Sr.call(nr);!(qr=($r=Sr.next()).done)&&(pr.push($r.value),!(wr&&pr.length===wr));qr=!0);}catch(gt){ua=!0,ba=gt}finally{try{!qr&&Sr.return!=null&&Sr.return()}finally{if(ua)throw ba}}return pr}}function Ne(nr){if(Array.isArray(nr))return nr}var we=function(wr){var Sr=Y.useContext(tt.Z),pr=Sr.graph,qr=Sr.theme,ua=wr.options,$r=wr.dataMap,ba=wr.onChange,gt=qr.mode,Dn=Y.useState({options:ua}),un=Nt(Dn,2),Lt=un[0],Ot=un[1];(0,Y.useEffect)(function(){Ot({options:ua})},[ua]);var it=Lt.options,H=function(xt){var zt=Object.assign(Object.assign({},xt),{checked:!xt.checked}),Vt=it.map(function(ne){var on=ne.value===xt.value;return on?zt:ne});Ot({options:Vt});var Xt=$r.get(zt.value);Xt.forEach(function(ne){pr.setItemState(ne.id,"active",zt.checked),pr.setItemState(ne.id,"inactive",!zt.checked);var on=ne.id,tn=pr.findById(on),He=tn.getEdges();He.forEach(function(Qn){pr.setItemState(Qn,"normal",zt.checked),pr.setItemState(Qn,"inactive",!zt.checked)})}),ba(zt,Vt)};return Y.createElement("ul",{className:"graphin-components-legend-content"},it.map(function(X){var xt=X.label,zt=X.checked,Vt=X.color,Xt={light:{active:Vt,inactive:"#ddd"},dark:{active:Vt,inactive:"#2f2f2f"}},ne={light:{active:"#000",inactive:"#ddd"},dark:{active:"#fff",inactive:"#2f2f2f"}},on=zt?"active":"inactive";return Y.createElement("li",{key:X.value,className:"item",onClick:function(){H(X)},onKeyDown:function(){H(X)}},Y.createElement("span",{className:"dot",style:{background:Xt[gt][on]}}),Y.createElement("span",{className:"label",style:{color:ne[gt][on]}},xt))}))},At=we,Qt=$(43054);function de(nr){return Oe(nr)||ce(nr)||Ee(nr)||rn()}function rn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ee(nr,wr){if(!!nr){if(typeof nr=="string")return Ze(nr,wr);var Sr=Object.prototype.toString.call(nr).slice(8,-1);if(Sr==="Object"&&nr.constructor&&(Sr=nr.constructor.name),Sr==="Map"||Sr==="Set")return Array.from(nr);if(Sr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Sr))return Ze(nr,wr)}}function ce(nr){if(typeof Symbol!="undefined"&&nr[Symbol.iterator]!=null||nr["@@iterator"]!=null)return Array.from(nr)}function Oe(nr){if(Array.isArray(nr))return Ze(nr)}function Ze(nr,wr){(wr==null||wr>nr.length)&&(wr=nr.length);for(var Sr=0,pr=new Array(wr);Sr<wr;Sr++)pr[Sr]=nr[Sr];return pr}var fe=Qt.Z.getEnumValue,Ae=Qt.Z.getEnumDataMap,Ye=function(wr){var Sr=wr.bindType,pr=Sr===void 0?"node":Sr,qr=wr.sortKey,ua=Y.useContext(tt.Z),$r=ua.graph,ba=$r.save();if(ba.children)return console.error("not support tree graph"),{dataMap:new Map,options:{}};var gt=Ae(ba["".concat(pr,"s")],qr),Dn=de(gt.keys()),un=Dn.map(function(Lt){var Ot=(gt.get(Lt)||[{}])[0],it=fe(Ot,"style.keyshape.fill"),H=fe(Ot,"style.color"),X=it||H;return{color:X,value:Lt,label:Lt,checked:!0}});return{dataMap:gt,options:un}},ge=Ye,Be={position:"absolute",top:"0px",right:"0px"},te=function(wr){var Sr=wr.bindType,pr=Sr===void 0?"node":Sr,qr=wr.sortKey,ua=wr.children,$r=wr.style,ba=ge({bindType:pr,sortKey:qr}),gt=ba.dataMap,Dn=ba.options;return Y.createElement("div",{className:"graphin-components-legend",style:Object.assign(Object.assign({},Be),$r)},ua({bindType:pr,sortKey:qr,dataMap:gt,options:Dn}))};te.Node=At;var ke=te,Ve={className:"graphin-minimap",viewportClassName:"graphin-minimap-viewport",type:"default",padding:50,size:[200,120],delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0},ee={container:{position:"absolute",bottom:0,left:0,background:"#fff",boxShadow:"0px 8px 10px -5px rgba(0,0,0,0.2), 0px 16px 24px 2px rgba(0,0,0,0.14), 0px 6px 30px 5px rgba(0,0,0,0.12)"}},Ft=120,bt=function(wr){var Sr=Y.useContext(tt.Z),pr=Sr.graph,qr=wr.options,ua=wr.style,$r=ua===void 0?{}:ua,ba=Y.useRef(null);Y.useEffect(function(){var Dn=pr.getWidth(),un=pr.getHeight(),Lt=pr.get("fitViewPadding"),Ot=[(Dn-Lt*2)/(un-Lt*2)*Ft,Ft],it=Object.assign(Object.assign(Object.assign({container:ba.current},Ve),{size:Ot}),qr),H=new K.ZP.Minimap(it);return pr.addPlugin(H),function(){H&&!H.destroyed&&pr.removePlugin(H)}},[qr]);var gt=Object.assign(Object.assign({},ee.container),$r);return Y.createElement("div",{ref:ba,style:gt})},Me=bt,en={line:{stroke:"#FA8C16",lineWidth:.5},itemAlignType:"center"},fn=function(wr){var Sr=Y.useContext(tt.Z),pr=Sr.graph,qr=wr.options,ua=wr.visible;return Y.useEffect(function(){var $r=Object.assign(Object.assign({},en),qr),ba=new K.ZP.SnapLine($r);return ua&&pr.addPlugin(ba),function(){pr&&!pr.destroyed&&pr.removePlugin(ba)}},[pr,qr,ua]),null},Rt=fn;function Xn(nr,wr,Sr){var pr=nr.get("canvas"),qr=pr.get("width"),ua=pr.get("height"),$r=Sr<=ua/4,ba=Sr>=3*ua/4,gt=wr<=qr/4,Dn=wr>=3*qr/4;return gt&&$r?"bottom-right":Dn&&$r?"bottom-left":gt&&ba?"top-right":Dn&&ba?"top-left":$r?"bottom":ba?"top":gt?"right":Dn?"left":"center"}var Bn=function(wr){var Sr=wr.graph,pr=wr.placement,qr=wr.nodeSize,ua=wr.x,$r=wr.y,ba=wr.bindType,gt=ba===void 0?"node":ba,Dn=wr.visible;return gt==="edge"?Dn?{left:ua,top:$r}:{visibility:"hidden",left:ua,top:$r}:(pr==="auto"&&(pr=Xn(Sr,ua,$r)),pr==="top"?Dn?{left:ua,top:$r-qr/2,opacity:1,transform:"translate(-50%,calc(-100% - 6px))",transition:"opacity 0.5s,transform 0.5s"}:{visibility:"hidden",left:0,top:0,opacity:0,transform:"translate(-50%,-100%)",transition:"opacity 0.5s,transform 0.5s"}:pr==="bottom"?Dn?{left:ua,top:$r+qr/2,opacity:1,transform:"translate(-50%,6px)",transition:"opacity 0.5s,transform 0.5s"}:{visibility:"hidden",left:ua,top:$r+qr/2,opacity:0,transform:"translate(-50%,0px)",transition:"opacity 0.5s,transform 0.5s"}:pr==="left"?Dn?{left:ua-qr/2,top:$r,transform:"translate(calc(-100% - 6px),-50%)",opacity:1,transition:"opacity 0.5s,transform 0.5s"}:{visibility:"hidden",opacity:0,left:ua-qr/2,top:$r,transform:"translate(-100%,-50%)",transition:"opacity 0.5s,transform 0.5s"}:pr==="right"?Dn?{left:ua+qr/2,top:$r,transform:"translate(6px,-50%)",opacity:1,transition:"opacity 0.5s,transform 0.5s"}:{visibility:"hidden",left:ua+qr/2,top:$r,transform:"translate(0,-50%)",opacity:0,transition:"opacity 0.5s,transform 0.5s"}:pr==="top-left"?Dn?{left:ua-qr/2,top:$r-qr/2,opacity:1,transform:"translate(calc(-100% - 6px),calc(-100% - 6px))",transition:"opacity 0.5s,transform 0.5s"}:{left:ua-qr/2,top:$r-qr/2,opacity:0,transform:"translate(-100%,-100%)",transition:"opacity 0.5s,transform 0.5s"}:pr==="top-right"?Dn?{left:ua+qr/2,top:$r-qr/2,opacity:1,transform:"translate(6px,calc(-100% - 6px))",transition:"opacity 0.5s,transform 0.5s"}:{left:ua+qr/2,top:$r-qr/2,opacity:0,transform:"translate(0,-100%)",transition:"opacity 0.5s,transform 0.5s"}:pr==="bottom-left"?Dn?{left:ua-qr/2,top:$r+qr/2,opacity:1,transform:"translate(calc(-100% - 6px),6px)",transition:"opacity 0.5s,transform 0.5s"}:{left:ua-qr/2,top:$r+qr/2,opacity:0,transform:"translate(-100%,0px)",transition:"opacity 0.5s,transform 0.5s"}:pr==="bottom-right"?Dn?{left:ua+qr/2,top:$r+qr/2,opacity:1,transform:"translate(6px,6px)",transition:"opacity 0.5s,transform 0.5s"}:{left:ua+qr/2,top:$r+qr/2,opacity:0,transform:"translate(0,0)",transition:"opacity 0.5s,transform 0.5s"}:pr==="center"?Dn?{left:ua,top:$r,opacity:1,transition:"opacity 0.5s,transform 0.5s"}:{visibility:"hidden",left:ua,top:$r,opacity:0,transition:"opacity 0.5s,transform 0.5s"}:{left:ua,top:$r})},xr=Bn,dr=$(81355);function Ur(nr,wr){return Lr(nr)||Da(nr,wr)||Ea(nr,wr)||fa()}function fa(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ea(nr,wr){if(!!nr){if(typeof nr=="string")return aa(nr,wr);var Sr=Object.prototype.toString.call(nr).slice(8,-1);if(Sr==="Object"&&nr.constructor&&(Sr=nr.constructor.name),Sr==="Map"||Sr==="Set")return Array.from(nr);if(Sr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Sr))return aa(nr,wr)}}function aa(nr,wr){(wr==null||wr>nr.length)&&(wr=nr.length);for(var Sr=0,pr=new Array(wr);Sr<wr;Sr++)pr[Sr]=nr[Sr];return pr}function Da(nr,wr){var Sr=nr==null?null:typeof Symbol!="undefined"&&nr[Symbol.iterator]||nr["@@iterator"];if(Sr!=null){var pr=[],qr=!0,ua=!1,$r,ba;try{for(Sr=Sr.call(nr);!(qr=($r=Sr.next()).done)&&(pr.push($r.value),!(wr&&pr.length===wr));qr=!0);}catch(gt){ua=!0,ba=gt}finally{try{!qr&&Sr.return!=null&&Sr.return()}finally{if(ua)throw ba}}return pr}}function Lr(nr){if(Array.isArray(nr))return nr}var _n=function(wr){var Sr=wr.bindType,pr=Sr===void 0?"node":Sr,qr=wr.container,ua=Y.useContext(tt.Z),$r=ua.graph,ba=(0,Y.useRef)(),gt=Y.useState({visible:!1,x:0,y:0,item:null}),Dn=Ur(gt,2),un=Dn[0],Lt=Dn[1],Ot=function(Vt){Vt.preventDefault(),Vt.stopPropagation(),ba.current&&window.clearTimeout(ba.current);var Xt=$r.getPointByClient(Vt.clientX,Vt.clientY),ne=$r.getCanvasByPoint(Xt.x,Xt.y),on=ne.x,tn=ne.y;if(pr==="node"&&Vt.item){var He=Vt.item.getModel(),Qn=He.x,Ln=Qn===void 0?0:Qn,Qr=He.y,Ia=Qr===void 0?0:Qr,Jn=$r.getCanvasByPoint(Ln,Ia),Ar=Vt.canvasX-Jn.x,na=Vt.canvasY-Jn.y;on=on-Ar,tn=tn-na}ba.current=window.setTimeout(function(){Lt(function(za){return Object.assign(Object.assign({},za),{visible:!0,item:Vt.item,x:on,y:tn})})},wr.delay.show)},it=function(){ba.current&&window.clearTimeout(ba.current),ba.current=window.setTimeout(function(){Lt(function(Vt){return Object.assign(Object.assign({},Vt),{visible:!1,item:null,x:0,y:0})})},wr.delay.hide)},H=function(){Lt(Object.assign(Object.assign({},un),{visible:!1,x:0,y:0,item:null}))},X=function(Vt){var Xt=$r.getPointByClient(Vt.clientX,Vt.clientY),ne=$r.getCanvasByPoint(Xt.x,Xt.y),on=ne.x,tn=ne.y;if(pr==="node"){if(Vt.item){var He=Vt.item.getModel(),Qn=He.x,Ln=Qn===void 0?0:Qn,Qr=He.y,Ia=Qr===void 0?0:Qr,Jn=$r.getCanvasByPoint(Ln,Ia),Ar=Vt.canvasX-Jn.x,na=Vt.canvasY-Jn.y;on=on-Ar,tn=tn-na}Lt(Object.assign(Object.assign({},un),{visible:!0,x:on,y:tn,item:Vt.item}))}},xt=function(){clearTimeout(ba.current)};return(0,Y.useEffect)(function(){var zt,Vt;return $r.on("".concat(pr,":mouseenter"),Ot),$r.on("".concat(pr,":mouseleave"),it),$r.on("afterremoveitem",it),$r.on("node:dragstart",H),$r.on("node:dragend",X),(zt=qr.current)===null||zt===void 0||zt.addEventListener("mouseenter",xt),(Vt=qr.current)===null||Vt===void 0||Vt.addEventListener("mouseleave",it),function(){var Xt,ne;console.log("effect..remove...."),$r.off("".concat(pr,":mouseenter"),Ot),$r.off("".concat(pr,":mouseleave"),it),$r.off("afterremoveitem",it),$r.off("node:dragstart",H),$r.off("node:dragend",X),(Xt=qr.current)===null||Xt===void 0||Xt.removeEventListener("mouseenter",xt),(ne=qr.current)===null||ne===void 0||ne.removeEventListener("mouseleave",it)}},[]),Object.assign({},un)},sr=_n,Pn={width:"120px",boxShadow:"0 4px 12px rgb(0 0 0 / 15%)"},tr=Y.createRef(),zn=function(wr){var Sr=wr.children,pr=wr.bindType,qr=pr===void 0?"node":pr,ua=wr.style,$r=wr.placement,ba=$r===void 0?"top":$r,gt=wr.hasArrow,Dn=wr.delay,un=Dn===void 0?{show:0,hide:200}:Dn,Lt=sr({bindType:qr,container:tr,delay:un}),Ot=Lt.x,it=Lt.y,H=Lt.visible,X=Lt.item,xt=Y.useContext(tt.Z),zt=xt.graph,Vt=40;try{if(X){var Xt=X.getModel(),ne=Xt.type;if(ne==="graphin-cirle"){var on=X.getModel(),tn=on.style;tn&&(Vt=tn.keyshape.size)}}}catch(Jn){console.log(Jn)}var He=12,Qn=xr({graph:zt,placement:ba,nodeSize:Vt+He,x:Ot,y:it,bindType:qr,visible:H}),Ln=Object.assign({position:"absolute"},Qn);if(typeof Sr!="function")return console.error("<Tooltip /> children should be a function"),null;var Qr=X&&!X.destroyed&&X.getModel&&X.getModel()||{},Ia=Qr.id||"";return Y.createElement(Y.Fragment,null,Y.createElement("div",{ref:tr,className:"graphin-components-tooltip ".concat(ba),style:Object.assign(Object.assign(Object.assign({},Pn),Ln),ua)},H&&Y.createElement("div",null,gt&&Y.createElement("div",{className:"tooltip-arrow ".concat(ba)}),Sr({item:X,bindType:qr,model:Qr,id:Ia}))))},Wr=zn,Yr={ContextMenu:F,Hull:ut,MiniMap:Me,FishEye:k,SnapLine:Rt,Tooltip:Wr,Legend:ke,useLegend:ge,useTooltip:sr,useContextMenu:A}},42134:function(ur,ot,$){"use strict";$.d(ot,{ZP:function(){return Ic}});var Y={};$.r(Y),$.d(Y,{handleAutoZoom:function(){return C},handleChangeZoom:function(){return R},handleRealZoom:function(){return L},handleZoomIn:function(){return Z},handleZoomOut:function(){return Q}});var tt={};$.r(tt),$.d(tt,{focusNodeById:function(){return N},highlightNodeById:function(){return A}});var j=$(9106),W=$(67294),Q=function(ve){return function(){if(!(!ve||ve.destroyed)){var Gt=ve.getZoom(),re=ve.get("canvas"),me=re.getPointByClient(re.get("width")/2,re.get("height")/2),bn=re.get("pixelRatio")||1,Zn=1+.05*5;if(!(Zn*Gt>5))return ve.zoom(Zn,{x:me.x/bn,y:me.y/bn},!0,{easing:"easeCubic",duration:150}),{text:"".concat(Math.round(Zn*Gt*100),"%"),ratio:Zn*Gt}}}},Z=function(ve){return function(){if(!(!ve||ve.destroyed)){var Gt=ve.getZoom(),re=ve.get("canvas"),me=re.getPointByClient(re.get("width")/2,re.get("height")/2),bn=re.get("pixelRatio")||1,Zn=1-.05*5;if(!(Zn*Gt<.3))return ve.zoom(Zn,{x:me.x/bn,y:me.y/bn},!0,{easing:"easeCubic",duration:150}),{text:"".concat(Math.round(Zn*Gt*100),"%"),ratio:Zn*Gt}}}},R=function(ve){return function(Gt){var re=Gt.text,me=Gt.ratio;if(!(!ve||ve.destroyed)){var bn=ve.get("canvas"),Zn=bn.getPointByClient(bn.get("width")/2,bn.get("height")/2),Yt=bn.get("pixelRatio")||1;return ve.zoomTo(me,{x:Zn.x/Yt,y:Zn.y/Yt},!0,{easing:"easeCubic",duration:150}),{text:re,ratio:me}}}},L=function(ve){return function(){if(!(!ve||ve.destroyed)){var Gt=ve.getZoom();return ve.zoom(1/Gt),ve.fitCenter(),{text:"100%",ratio:1}}}},C=function(ve){return function(){if(!(!ve||ve.destroyed)){var Gt=ve.getNodes();Gt.length>0&&ve.fitView([20,20],{},!0);var re=ve.getZoom();return{text:"".concat(Math.round(re*100),"%"),ratio:re}}}},A=function(ve){return function(Gt){ve.getNodes().forEach(function(re){ve.clearItemStates(re,["active","inactive"]),Gt.indexOf(re.get("id"))!==-1?ve.setItemState(re,"active",!0):ve.setItemState(re,"active",!1)})}},N=function(ve){return function(Gt){if(!(!ve||typeof Gt!="string")){var re=ve.findById(Gt);if(!re){console.warn("The node ".concat(Gt," does not exist!"));return}ve.focusItem(Gt,!0,{duration:200,easing:"easeCubic"}),ve.setItemState(re,"selected",!0),re.toFront()}}};function B(Se,ve,Gt){return ve in Se?Object.defineProperty(Se,ve,{value:Gt,enumerable:!0,configurable:!0,writable:!0}):Se[ve]=Gt,Se}var O=Object.assign(Object.assign({},Y),tt),F=function(ve){var Gt=Object.keys(O);return Gt.reduce(function(re,me){return Object.assign(Object.assign({},re),B({},me,O[me](ve)))},{})},K=F,nt=$(98818),P={type:"compactBox",direction:"LR",getId:function(ve){return ve.id},getHeight:function(){return 16},getWidth:function(){return 16},getVGap:function(){return 80},getHGap:function(){return 20}},k=["dendrogram","compactBox","mindmap","indented"],yt={type:"force2"},st=$(36950),lt=function(){return Math.round((Math.random()-.5)*80)},ht=500,mt=300,wt=function(ve,Gt){var re=ve.nodes,me=ve.edges,bn=Gt.nodes,Zn=new Map;bn.forEach(function(Ge){var Fe=Ge.id,In=Ge.x,ar=Ge.y;Zn.set(Fe,{x:In,y:ar})});var Yt=new Map;re.forEach(function(Ge){var Fe=Ge.id,In=Zn.get(Fe),ar=In.x,ra=In.y;!window.isNaN(ar)&&!window.isNaN(ra)?(Ge.x=ar,Ge.y=ra):Yt.set(Fe,Ge)});var Ie=new Map;return me.forEach(function(Ge){var Fe=Ge.source,In=Ge.target,ar=Yt.get(Fe),ra=Yt.get(In),Ta=Zn.get(Fe),$a=!window.isNaN(Ta.x)&&!window.isNaN(Ta.y),ja=Zn.get(In),Oa=!window.isNaN(ja.x)&&!window.isNaN(ja.y);ar&&Oa&&Ie.set(Fe,{x:ja.x+lt(),y:ja.y+lt()}),ra&&$a&&Ie.set(In,{x:Ta.x+lt(),y:Ta.y+lt()})}),re.forEach(function(Ge){var Fe=Ge.id,In=Zn.get(Fe);(window.isNaN(In.x)||window.isNaN(In.y))&&(In=Ie.get(Fe)||{}),!window.isNaN(In.x)&&!window.isNaN(In.y)?(Ge.x=In.x,Ge.y=In.y):(Ge.x=ht/2+Math.round(Math.random()*ht),Ge.y=mt/2+Math.round(Math.random()*mt))}),Object.assign(Object.assign({},ve),{nodes:re,edges:me})},ut=wt,pt=$(9419);function Nt(Se,ve){if(!(Se instanceof ve))throw new TypeError("Cannot call a class as a function")}function Ut(Se,ve){for(var Gt=0;Gt<ve.length;Gt++){var re=ve[Gt];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(Se,re.key,re)}}function ue(Se,ve,Gt){return ve&&Ut(Se.prototype,ve),Gt&&Ut(Se,Gt),Object.defineProperty(Se,"prototype",{writable:!1}),Se}var se=function(ve){return!(ve&&ve.nodes&&ve.nodes.length!==0)},Le=["force","graphin-force","g6force","gForce","comboForce"],Ne=function(){function Se(ve){var Gt=this;Nt(this,Se),this.updateOptions=function(){var re={type:"concentric"},me=Gt.graphin,bn=me.width,Zn=me.height,Yt=me.props,Ie=Yt.layout,Ge=Ie===void 0?re:Ie,Fe=Ge.type,In=Fe===void 0?"concentric":Fe,ar=Ge.preset,ra={width:bn,height:Zn,center:[bn/2,Zn/2]};if(Gt.options=Object.assign(Object.assign(Object.assign({},ra),pt.Z[In]||{}),Ge),se(Gt.graphin.data)){Gt.prevOptions={};return}if(Le.indexOf(In)!==-1){var Ta=Gt.prevOptions.type||"grid";(ar==null?void 0:ar.type)&&(Ta=ar.type),se(Gt.graphin.data)&&(Ta=ar.type||"grid"),Gt.options.preset=Object.assign(Object.assign(Object.assign({type:Ta},ra),pt.Z[Ta]||{}),ar)}},this.processForce=function(){var re=Gt,me=re.options,bn=re.graphin,Zn=bn.graph,Yt=me.type,Ie=me.animation,Ge=me.animate;if(Yt==="graphin-force"&&(re.options.graph=Zn),Yt==="force"||Yt==="g6force"||Yt==="gForce"||Yt==="comboCombined"){var Fe=re.options.onTick,In=function(){Fe&&Fe(),(Ie||Ge)&&re.refreshPosition()};re.options.tick=In;var ar=re.options.onLayoutEnd;re.options.onLayoutEnd=function(){re.refreshPosition(),ar==null||ar(),Zn.emit("afterlayout")}}(Yt==="comboForce"||Yt==="comboCombined")&&(re.options.comboTrees=Zn.get("comboTrees"));var ra={prev:Le.indexOf(re.prevOptions.type)!==-1,current:Le.indexOf(re.options.type)!==-1},Ta=re.options.type===re.prevOptions.type;if(!se(bn.data)){if(ra.current&&!Ta){var $a=re.options.preset;re.presetLayout=new j.ZP.Layout[$a.type](Object.assign({},$a)||{}),re.presetLayout.init(bn.data),re.presetLayout.execute(),re.presetLayout.data=Object.assign({},bn.data)}if(ra.current&&ra.prev&&!re.hasPosition()){var ja=re.graph.save(),Oa=re.options.preset;se(ja)&&(re.presetLayout=new j.ZP.Layout[Oa.type](Object.assign({},Oa)||{}),re.presetLayout.init(bn.data),re.presetLayout.execute(),ja=bn.data),bn.data=ut(bn.data,ja)}}},this.refreshPosition=function(){var re=Gt.graphin,me=re.options,bn=me.animate,Zn=me.layoutAnimate,Yt=Gt.options.type;bn&&!Zn&&!Gt.options.animation?Gt.graph.positionsAnimate(Yt==="comboCombined"):Gt.graph.refreshPositions(Yt==="comboCombined")},this.destroy=function(){Gt.presetLayout&&Gt.presetLayout.destroy&&Gt.presetLayout.destroy(),Gt.instance&&Gt.instance.destroy&&Gt.instance.destroy(),Gt.presetLayout=null,Gt.instance=null},this.getDataFromGraph=function(){for(var re=[],me=[],bn=[],Zn=[],Yt=Gt.graph.getNodes(),Ie=Gt.graph.getEdges(),Ge=Gt.graph.getCombos(),Fe=Yt.length,In=0;In<Fe;In++){var ar=Yt[In];if(ar&&ar.isVisible()){var ra=ar.getModel();re.push(ra)}}for(var Ta=Ie.length,$a=0;$a<Ta;$a++){var ja=Ie[$a];if(ja&&ja.isVisible()){var Oa=ja.getModel();Oa.isComboEdge?Zn.push(Oa):me.push(Oa)}}for(var so=Ge.length,Ai=0;Ai<so;Ai++){var Oi=Ge[Ai];if(Oi&&Oi.isVisible()){var hs=Oi.getModel();bn.push(hs)}}return{nodes:re,edges:me,combos:bn,comboEdges:Zn}},this.graphin=ve,this.graph=this.graphin.graph,this.presetLayout=null,this.prevOptions={},this.init()}return ue(Se,[{key:"hasPosition",value:function(){var Gt=this.graphin,re=Gt.data,me=re===void 0?{}:re;return!me.nodes||me.nodes.length===0?!1:me.nodes.every(function(bn){return!window.isNaN(Number(bn.x))&&!window.isNaN(Number(bn.y))})}},{key:"init",value:function(){this.updateOptions();var Gt=this.options,re=this.graphin,me=re.data,bn=Gt.type;this.processForce(),j.ZP.Layout[bn]||console.warn("".concat(bn," layout not found, current layout is grid"));var Zn=j.ZP.Layout[bn]||j.ZP.Layout.grid;this.graph.emit("beforelayout"),this.instance=new Zn(this.options),this.instance.init(me)}},{key:"start",value:function(){var Gt=this.options.type;this.instance.execute(),!(Gt==="force"||Gt==="g6force"||Gt==="gForce"||Gt==="comboCombined"||Gt==="force2")&&(this.refreshPosition(),this.graph.emit("afterlayout"))}},{key:"changeLayout",value:function(){var Gt=this.graphin,re=Gt.graph,me=Gt.data,bn=Gt.isTree,Zn=Gt.layoutCache;if(!re||re.destroyed||!me||!me.nodes||!me.nodes.length||Zn&&this.hasPosition()||bn)return!1;Le.indexOf(this.options.type)!==-1&&this.destroy(),this.prevOptions=Object.assign({},this.options),this.init(),this.start()}}]),Se}(),we=Ne,At=$(81710),Qt=$(46581),de=$(76575),rn={mode:"light",primaryColor:"#873bf4",nodeSize:26,edgeSize:1,primaryEdgeColor:"#ddd"},Ee=function(ve){var Gt=Object.assign(Object.assign({},rn),ve),re=Gt.primaryColor,me=Gt.primaryEdgeColor,bn=Gt.nodeSize,Zn=Gt.edgeSize,Yt=Gt.mode,Ie=Gt.background,Ge=(0,de.Z)({primaryColor:re,nodeSize:bn,mode:Yt}),Fe=(0,Qt.Z)({primaryEdgeColor:me,edgeSize:Zn,mode:Yt}),In=(0,At.Z)(),ar={light:"#fff",dark:"#1f1f1f"};return Object.assign(Object.assign({},Gt),{mode:Yt,background:Ie||ar[Yt],defaultNodeStyle:{type:Ge.type,style:Ge.style},defaultNodeStatusStyle:{status:Ge.status},defaultEdgeStyle:{type:Fe.type,style:Fe.style},defaultEdgeStatusStyle:{status:Fe.status},defaultComboStyle:{type:In.type,style:In.style},defaultComboStatusStyle:{status:In.status}})},ce=$(57804),Oe=function Se(ve,Gt){if(window.isNaN(ve)&&window.isNaN(Gt)&&typeof ve=="number"&&typeof Gt=="number"||ve===Gt)return!0;if(typeof ve=="function"&&typeof Gt=="function"||ve instanceof Date&&Gt instanceof Date||ve instanceof RegExp&&Gt instanceof RegExp||ve instanceof String&&Gt instanceof String||ve instanceof Number&&Gt instanceof Number)return ve.toString()===Gt.toString();if(!(ve instanceof Object&&Gt instanceof Object))return!1;var re=[],me=Object.keys(ve),bn=Object.keys(Gt);if(me.length!==bn.length)return!1;for(var Zn=0;Zn<me.length;Zn++){var Yt=me[Zn],Ie=Se(ve[Yt],Gt[Yt]);re.push(Ie)}return re.every(function(Ge){return Ge})},Ze=Oe,fe={animation:"animate",minDistanceThreshold:"minMovement",maxIterations:"maxIterations"},Ae=function Se(ve,Gt){if(!ve)return ve;var re={};if(Object.keys(ve).forEach(function(Fe){var In;if(Fe==="preset"&&((In=ve.preset)===null||In===void 0?void 0:In.type)){re.preset=Se(ve.preset,Gt);return}var ar=fe[Fe];ar?re[ar]=ve[Fe]:re[Fe]=ve[Fe]}),ve.done&&(ve.onLayoutEnd?re.onLayoutEnd=function(Fe){ve.onLayoutEnd(Gt,Fe),ve.done(Gt,Fe)}:re.onLayoutEnd=function(Fe){ve.done(Gt,Fe)}),re.type==="concentric"){var me=re.minNodeSpacing,bn=me===void 0?60:me,Zn=re.preventOverlap,Yt=Zn===void 0?!0:Zn,Ie=re.nodeSize,Ge=Ie===void 0?60:Ie;re.minNodeSpacing=bn,re.preventOverlap=Yt,re.nodeSize=Ge}return re};function Ye(Se){return Ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ve){return typeof ve}:function(ve){return ve&&typeof Symbol=="function"&&ve.constructor===Symbol&&ve!==Symbol.prototype?"symbol":typeof ve},Ye(Se)}function ge(Se,ve){if(!(Se instanceof ve))throw new TypeError("Cannot call a class as a function")}function Be(Se,ve){for(var Gt=0;Gt<ve.length;Gt++){var re=ve[Gt];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(Se,re.key,re)}}function te(Se,ve,Gt){return ve&&Be(Se.prototype,ve),Gt&&Be(Se,Gt),Object.defineProperty(Se,"prototype",{writable:!1}),Se}function ke(Se,ve){if(typeof ve!="function"&&ve!==null)throw new TypeError("Super expression must either be null or a function");Se.prototype=Object.create(ve&&ve.prototype,{constructor:{value:Se,writable:!0,configurable:!0}}),Object.defineProperty(Se,"prototype",{writable:!1}),ve&&Ve(Se,ve)}function Ve(Se,ve){return Ve=Object.setPrototypeOf||function(re,me){return re.__proto__=me,re},Ve(Se,ve)}function ee(Se){var ve=Me();return function(){var re=en(Se),me;if(ve){var bn=en(this).constructor;me=Reflect.construct(re,arguments,bn)}else me=re.apply(this,arguments);return Ft(this,me)}}function Ft(Se,ve){if(ve&&(Ye(ve)==="object"||typeof ve=="function"))return ve;if(ve!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bt(Se)}function bt(Se){if(Se===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Se}function Me(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Se){return!1}}function en(Se){return en=Object.setPrototypeOf?Object.getPrototypeOf:function(Gt){return Gt.__proto__||Object.getPrototypeOf(Gt)},en(Se)}var fn=function(Se,ve){var Gt={};for(var re in Se)Object.prototype.hasOwnProperty.call(Se,re)&&ve.indexOf(re)<0&&(Gt[re]=Se[re]);if(Se!=null&&typeof Object.getOwnPropertySymbols=="function")for(var me=0,re=Object.getOwnPropertySymbols(Se);me<re.length;me++)ve.indexOf(re[me])<0&&Object.prototype.propertyIsEnumerable.call(Se,re[me])&&(Gt[re[me]]=Se[re[me]]);return Gt},Rt=nt.Z.DragCanvas,Xn=nt.Z.ZoomCanvas,Bn=nt.Z.DragNode,xr=nt.Z.DragCombo,dr=nt.Z.ClickSelect,Ur=nt.Z.BrushSelect,fa=nt.Z.ResizeCanvas,Ea=function(Se){ke(Gt,Se);var ve=ee(Gt);function Gt(re){var me;ge(this,Gt),me=ve.call(this,re),me.graphDOM=null,me.initData=function(In){In.children&&(me.isTree=!0),me.data=(0,ce.Z)(In)},me.initGraphInstance=function(){var In=me.props,ar=In.theme,ra=In.data,Ta=In.layout,$a=In.width,ja=In.height,Oa=In.defaultCombo,so=Oa===void 0?{style:{},type:"graphin-combo"}:Oa,Ai=In.defaultEdge,Oi=Ai===void 0?{style:{},type:"graphin-line"}:Ai,hs=In.defaultNode,wo=hs===void 0?{style:{},type:"graphin-circle"}:hs,ho=In.nodeStateStyles,Ro=In.edgeStateStyles,Ys=In.comboStateStyles,Ps=In.modes,As=Ps===void 0?{default:[]}:Ps,Vs=In.animate,su=In.handleAfterLayout,xl=fn(In,["theme","data","layout","width","height","defaultCombo","defaultEdge","defaultNode","nodeStateStyles","edgeStateStyles","comboStateStyles","modes","animate","handleAfterLayout"]);As.default.length>0&&console.info("%c suggestion: you can use @antv/graphin Behaviors components","color:lightgreen");var Rl=me.graphDOM,Ll=Rl.clientWidth,nl=Rl.clientHeight;me.initData(ra),me.width=Number($a)||Ll||500,me.height=Number(ja)||nl||500;var rl=Ee(ar),Ef=rl.defaultNodeStyle,Sf=rl.defaultEdgeStyle,Yl=rl.defaultComboStyle,Cf=rl.defaultNodeStatusStyle,T=rl.defaultEdgeStatusStyle,rt=rl.defaultComboStatusStyle,Kt=fn(rl,["defaultNodeStyle","defaultEdgeStyle","defaultComboStyle","defaultNodeStatusStyle","defaultEdgeStatusStyle","defaultComboStatusStyle"]);me.isTree=Boolean(ra.children)||k.indexOf(String(Ta&&Ta.type))!==-1;var pe={defaultNode:{style:Object.assign(Object.assign({},wo.style),{_theme:ar}),type:wo.type||"graphin-circle"},defaultEdge:{style:Object.assign(Object.assign({},Oi.style),{_theme:ar}),type:Oi.type||"graphin-line"},defaultCombo:{style:Object.assign(Object.assign({},so.style),{_theme:ar}),type:so.type||"combo",labelCfg:so.labelCfg},nodeStateStyles:ho,edgeStateStyles:Ro,comboStateStyles:Ys};me.theme=Object.assign(Object.assign({},pe),Kt),me.options=Object.assign(Object.assign(Object.assign({container:me.graphDOM,renderer:"canvas",width:me.width,height:me.height,animate:Vs!==!1},pe),{modes:As}),xl),me.isTree?(me.options.layout=Ta||P,me.graph=new j.ZP.TreeGraph(me.options)):(me.useGraphinLayoutController||(me.options.layout=Ae(Ta,me.graph)||yt),me.graph=new j.ZP.Graph(me.options)),me.graph.on("afterlayout",function(){su&&su(me.graph)}),me.graph.data(me.data),me.setTextDirection(),me.graph.render(),!me.isTree&&me.useGraphinLayoutController&&(me.layout=new we(bt(me)),me.layout.start()),me.initStatus(),me.apis=K(me.graph),me.setState({isReady:!0,context:{graph:me.graph,apis:me.apis,theme:me.theme,layout:me.layout,dragNodes:me.dragNodes,updateContext:me.updateContext}})},me.updateLayout=function(){me.useGraphinLayoutController&&me.layout.changeLayout()},me.updateOptions=function(){var In=fn(me.props,[]);return In},me.initStatus=function(){if(!me.isTree){var In=me.props.data,ar=In.nodes,ra=ar===void 0?[]:ar,Ta=In.edges,$a=Ta===void 0?[]:Ta;ra.forEach(function(ja){var Oa=ja.status;Oa&&Object.keys(Oa).forEach(function(so){me.graph.setItemState(ja.id,so,Boolean(Oa[so]))})}),$a.forEach(function(ja){var Oa=ja.status;Oa&&Object.keys(Oa).forEach(function(so){me.graph.setItemState(ja.id,so,Boolean(Oa[so]))})})}},me.updateContext=function(In){me.setState(function(ar){return{context:Object.assign(Object.assign({},ar.context),In)}})},me.clear=function(){me.layout&&me.layout.destroy&&me.layout.destroy(),me.layout={},me.graph.clear(),me.data={nodes:[],edges:[],combos:[]},me.graph.destroy()};var bn=re.data,Zn=re.layout,Yt=re.width,Ie=re.height,Ge=re.layoutCache,Fe=fn(re,["data","layout","width","height","layoutCache"]);return me.data=bn,me.isTree=Boolean(re.data&&re.data.children)||k.indexOf(String(Zn&&Zn.type))!==-1,me.graph={},me.height=Number(Ie),me.width=Number(Yt),me.theme={},me.apis={},me.layoutCache=Ge,me.layout={},me.dragNodes=[],me.useGraphinLayoutController=(Zn==null?void 0:Zn.type)==="graphin-force",me.options=Object.assign({},Fe),me.state={isReady:!1,context:{graph:me.graph,apis:me.apis,theme:me.theme,layout:me.layout,dragNodes:me.dragNodes,updateContext:me.updateContext}},me}return te(Gt,[{key:"setTextDirection",value:function(){var me=this.props.dir,bn=me===void 0?"ltr":me;this.graph.get("canvas").get("el").setAttribute("dir",bn)}},{key:"componentDidMount",value:function(){this.initGraphInstance()}},{key:"componentDidUpdate",value:function(me){var bn=this,Zn,Yt,Ie=this.shouldUpdate(me,"data"),Ge=this.shouldUpdate(me,"layout"),Fe=this.shouldUpdate(me,"options"),In=this.shouldUpdate(me,"theme"),ar=this.props,ra=ar.data,Ta=ar.layoutCache,$a=ar.rtl,ja=ar.layout,Oa=(0,ce.Z)(ja);this.layoutCache=Ta,Fe&&me.rtl!==$a&&(this.setTextDirection(),this.graph.render());var so;if(Ie){if(this.initData(ra),this.isTree)this.graph.changeData(this.data);else{var Ai=this.state.context.dragNodes;if(so=Ai.filter(function(ho){var Ro;return((Ro=bn.data)===null||Ro===void 0?void 0:Ro.nodes)&&bn.data.nodes.find(function(Ys){return Ys.id===ho.id})}),(Yt=(Zn=this.data)===null||Zn===void 0?void 0:Zn.nodes)===null||Yt===void 0||Yt.forEach(function(ho){var Ro,Ys,Ps,As,Vs=so.find(function(su){return su.id===ho.id});Vs&&(ho.mass=(Ys=(Ro=Vs.layout)===null||Ro===void 0?void 0:Ro.force)===null||Ys===void 0?void 0:Ys.mass,ho.layout=Object.assign(Object.assign({},ho.layout),{force:{mass:(As=(Ps=Vs.layout)===null||Ps===void 0?void 0:Ps.force)===null||As===void 0?void 0:As.mass}}))}),this.useGraphinLayoutController)this.graph.data(this.data),this.graph.set("layoutController",null),this.graph.changeData(this.data),this.data=this.layout.getDataFromGraph(),this.layout.changeLayout();else{Oa&&(Oa.disableTriggerLayout=!0);var Oi=Ae(Oa,this.graph);this.graph.updateLayout(Oi),this.graph.data(this.data),this.graph.changeData(this.data),this.data=this.graph.get("data")}}this.initStatus(),this.apis=K(this.graph),this.setState(function(ho){return Object.assign(Object.assign({},ho),{context:{graph:bn.graph,apis:bn.apis,theme:bn.theme,layout:bn.layout,dragNodes:so||ho.context.dragNodes,updateContext:bn.updateContext}})},function(){bn.graph.emit("graphin:datachange"),Ge&&bn.graph.emit("graphin:layoutchange",{prevLayout:me.layout,layout:Oa})});return}if(Ge){if(this.useGraphinLayoutController=(Oa==null?void 0:Oa.type)==="graphin-force",this.isTree){this.graph.updateLayout(Oa);return}if(this.useGraphinLayoutController)Object.keys(this.layout).length===0&&(this.layout=new we(this)),this.data=this.layout.getDataFromGraph(),this.layout.changeLayout();else{var hs=this.graph.get("layoutController");hs||this.graph.initLayoutController();var wo=Ae(Oa,this.graph);wo&&(wo.disableTriggerLayout=!1),this.graph.updateLayout(wo),this.data=this.graph.get("data")}this.graph.emit("graphin:layoutchange",{prevLayout:me.layout,layout:Oa})}}},{key:"componentWillUnmount",value:function(){var me=this.props.willUnmount;me?(me(),this.layout&&this.layout.destroy&&this.layout.destroy(),this.layout={},this.graph.destroyLayout()):this.clear()}},{key:"componentDidCatch",value:function(me,bn){console.error("Catch component error: ",me,bn)}},{key:"shouldUpdate",value:function(me,bn){var Zn=me[bn],Yt=this.props[bn],Ie=Ze(Zn,Yt);return!Ie}},{key:"render",value:function(){var me=this,bn,Zn=this.state.isReady,Yt=this.props,Ie=Yt.modes,Ge=Yt.style,Fe=Yt.containerId,In=Yt.containerStyle;return W.createElement(st.Z.Provider,{value:this.state.context},W.createElement("div",{id:Fe||"graphin-container",style:Object.assign({height:"100%",width:"100%",position:"relative"},In)},W.createElement("div",{"data-testid":"custom-element",className:"graphin-core",ref:function(ra){me.graphDOM=ra},style:Object.assign({height:"100%",width:" 100%",minHeight:"500px",background:((bn=this.theme)===null||bn===void 0?void 0:bn.background)||"#fff"},Ge)}),W.createElement("div",{className:"graphin-components"},Zn&&W.createElement(W.Fragment,null,!Ie&&W.createElement(W.Fragment,null,W.createElement(Rt,null),W.createElement(Xn,null),W.createElement(Bn,null),W.createElement(xr,null),W.createElement(dr,null),W.createElement(Ur,null)),W.createElement(fa,{graphDOM:this.graphDOM}),this.props.children))))}}],[{key:"registerBehavior",value:function(me,bn){j.ZP.registerBehavior(me,bn)}},{key:"registerFontFamily",value:function(me){var bn=me(),Zn=bn.glyphs,Yt=bn.fontFamily,Ie=Zn.map(function(Ge){return{name:Ge.name,unicode:String.fromCodePoint(Ge.unicode_decimal)}});return new Proxy(Ie,{get:function(Fe,In){var ar=Fe.find(function(ra){return ra.name===In});return ar?ar==null?void 0:ar.unicode:(console.error("%c fontFamily:".concat(Yt,",does not found ").concat(In," icon")),"")}})}},{key:"registerLayout",value:function(me,bn){j.ZP.registerLayout(me,bn)}}]),Gt}(W.PureComponent);Ea.registerNode=function(Se,ve,Gt){j.ZP.registerNode(Se,ve,Gt)},Ea.registerEdge=function(Se,ve,Gt){j.ZP.registerEdge(Se,ve,Gt)},Ea.registerCombo=function(Se,ve,Gt){j.ZP.registerCombo(Se,ve,Gt)};var aa=Ea,Da=$(43054);function Lr(Se){return tr(Se)||Pn(Se)||sr(Se)||_n()}function _n(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sr(Se,ve){if(!!Se){if(typeof Se=="string")return zn(Se,ve);var Gt=Object.prototype.toString.call(Se).slice(8,-1);if(Gt==="Object"&&Se.constructor&&(Gt=Se.constructor.name),Gt==="Map"||Gt==="Set")return Array.from(Se);if(Gt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Gt))return zn(Se,ve)}}function Pn(Se){if(typeof Symbol!="undefined"&&Se[Symbol.iterator]!=null||Se["@@iterator"]!=null)return Array.from(Se)}function tr(Se){if(Array.isArray(Se))return zn(Se)}function zn(Se,ve){(ve==null||ve>Se.length)&&(ve=Se.length);for(var Gt=0,re=new Array(ve);Gt<ve;Gt++)re[Gt]=Se[Gt];return re}var Wr=function(ve,Gt){var re=ve.data.id,me=0,bn=0,Zn=0;return Gt.forEach(function(Yt){Yt.source.id===re&&(bn+=1,me+=1),Yt.target.id===re&&(Zn+=1,me+=1)}),{degree:me,sDegree:bn,tDegree:Zn}},Yr=function(ve,Gt){return Lr(new Set(ve==null?void 0:ve.map(function(re){var me;return(me=re==null?void 0:re.data)===null||me===void 0?void 0:me[Gt]})))||[]},nr=function(ve,Gt,re){var me,bn;return ve==="source"?((me=re==null?void 0:re.find(function(Zn){var Yt;return((Yt=Zn.target)===null||Yt===void 0?void 0:Yt.id)===Gt.id}))===null||me===void 0?void 0:me.source)||{}:((bn=re==null?void 0:re.find(function(Zn){var Yt;return((Yt=Zn.source)===null||Yt===void 0?void 0:Yt.id)===Gt.id}))===null||bn===void 0?void 0:bn.target)||{}},wr=function(ve,Gt,re,me){var bn,Zn=((bn=re==null?void 0:re.data)===null||bn===void 0?void 0:bn[Gt])||"",Yt=(me==null?void 0:me.filter(function(Ie){var Ge;return((Ge=Ie==null?void 0:Ie.data)===null||Ge===void 0?void 0:Ge[Gt])===Zn}))||[];return ve==="leaf"&&(Yt=Yt.filter(function(Ie){var Ge,Fe,In,ar;return((Fe=(Ge=Ie.data)===null||Ge===void 0?void 0:Ge.layout)===null||Fe===void 0?void 0:Fe.sDegree)===0||((ar=(In=Ie.data)===null||In===void 0?void 0:In.layout)===null||ar===void 0?void 0:ar.tDegree)===0})),Yt},Sr=function(ve,Gt,re){var me=[];switch(ve){case"source":me=re==null?void 0:re.filter(function(bn){var Zn;return((Zn=bn.source)===null||Zn===void 0?void 0:Zn.id)===Gt.id}).map(function(bn){return bn.target});break;case"target":me=re==null?void 0:re.filter(function(bn){var Zn;return((Zn=bn.target)===null||Zn===void 0?void 0:Zn.id)===Gt.id}).map(function(bn){return bn.source});break;case"both":me=re==null?void 0:re.filter(function(bn){var Zn;return((Zn=bn.source)===null||Zn===void 0?void 0:Zn.id)===Gt.id}).map(function(bn){return bn.target}).concat(re==null?void 0:re.filter(function(bn){var Zn;return((Zn=bn.target)===null||Zn===void 0?void 0:Zn.id)===Gt.id}).map(function(bn){return bn.source}));break;default:break}return me=Da.Z.uniqBy(me,function(bn,Zn){return bn.id===Zn.id}),me},pr=function(ve,Gt,re,me){var bn,Zn=((bn=Gt==null?void 0:Gt.data)===null||bn===void 0?void 0:bn.layout)||{},Yt=Zn.sDegree,Ie=Zn.tDegree,Ge=Gt,Fe=[];Yt===0?(Ge=nr("source",Gt,re),Fe=Sr("both",Ge,re)):Ie===0&&(Ge=nr("target",Gt,re),Fe=Sr("both",Ge,re)),Fe=Fe.filter(function(ar){var ra;return((ra=ar.data)===null||ra===void 0?void 0:ra.layout)&&(ar.data.layout.sDegree===0||ar.data.layout.tDegree===0)});var In=wr(ve,me,Gt,Fe);return{coreNode:Ge,relativeLeafNodes:Fe,sameTypeLeafNodes:In}},qr=function(ve){var Gt=ve.map(function(Ie){return Ie.x}),re=ve.map(function(Ie){return Ie.y}),me=(Math.max.apply(null,Gt)+Math.min.apply(null,Gt))/2,bn=(Math.max.apply(null,re)+Math.min.apply(null,re))/2,Zn=function(Ge,Fe){return Math.sqrt((Ge-me)*(Ge-me)+(Fe-bn)*(Fe-bn))},Yt=ve.map(function(Ie){return Zn(Ie.x||0,Ie.y||0)});return ve[Yt.findIndex(function(Ie){return Ie===Math.min.apply(null,Yt)})]},ua=function(ve){var Gt={x:0,y:0};ve.forEach(function(me){Gt.x+=me.x||0,Gt.y+=me.y||0});var re=ve.length||1;return{x:Gt.x/re,y:Gt.y/re}},$r={getDegree:Wr,getRelativeNodesType:Yr,getCoreNodeAndRelativeLeafNodes:pr,getCoreNode:nr,getSameTypeNodes:wr,getMinDistanceNode:qr,getAvgNodePosition:ua};function ba(Se,ve){for(var Gt=0;Gt<ve.length;Gt++){var re=ve[Gt];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(Se,re.key,re)}}function gt(Se,ve,Gt){return ve&&ba(Se.prototype,ve),Gt&&ba(Se,Gt),Object.defineProperty(Se,"prototype",{writable:!1}),Se}function Dn(Se,ve){if(!(Se instanceof ve))throw new TypeError("Cannot call a class as a function")}var un=gt(function Se(ve){Dn(this,Se),this.id=ve.id,this.data=ve||{},this.x=ve.x||0,this.y=ve.y||0}),Lt=gt(function Se(ve,Gt,re,me){Dn(this,Se),this.id=ve,this.source=Gt,this.target=re,this.data=me||{}});function Ot(Se){const ve=+this._x.call(null,Se),Gt=+this._y.call(null,Se);return it(this.cover(ve,Gt),ve,Gt,Se)}function it(Se,ve,Gt,re){if(isNaN(ve)||isNaN(Gt))return Se;var me,bn=Se._root,Zn={data:re},Yt=Se._x0,Ie=Se._y0,Ge=Se._x1,Fe=Se._y1,In,ar,ra,Ta,$a,ja,Oa,so;if(!bn)return Se._root=Zn,Se;for(;bn.length;)if(($a=ve>=(In=(Yt+Ge)/2))?Yt=In:Ge=In,(ja=Gt>=(ar=(Ie+Fe)/2))?Ie=ar:Fe=ar,me=bn,!(bn=bn[Oa=ja<<1|$a]))return me[Oa]=Zn,Se;if(ra=+Se._x.call(null,bn.data),Ta=+Se._y.call(null,bn.data),ve===ra&&Gt===Ta)return Zn.next=bn,me?me[Oa]=Zn:Se._root=Zn,Se;do me=me?me[Oa]=new Array(4):Se._root=new Array(4),($a=ve>=(In=(Yt+Ge)/2))?Yt=In:Ge=In,(ja=Gt>=(ar=(Ie+Fe)/2))?Ie=ar:Fe=ar;while((Oa=ja<<1|$a)==(so=(Ta>=ar)<<1|ra>=In));return me[so]=bn,me[Oa]=Zn,Se}function H(Se){var ve,Gt,re=Se.length,me,bn,Zn=new Array(re),Yt=new Array(re),Ie=Infinity,Ge=Infinity,Fe=-Infinity,In=-Infinity;for(Gt=0;Gt<re;++Gt)isNaN(me=+this._x.call(null,ve=Se[Gt]))||isNaN(bn=+this._y.call(null,ve))||(Zn[Gt]=me,Yt[Gt]=bn,me<Ie&&(Ie=me),me>Fe&&(Fe=me),bn<Ge&&(Ge=bn),bn>In&&(In=bn));if(Ie>Fe||Ge>In)return this;for(this.cover(Ie,Ge).cover(Fe,In),Gt=0;Gt<re;++Gt)it(this,Zn[Gt],Yt[Gt],Se[Gt]);return this}function X(Se,ve){if(isNaN(Se=+Se)||isNaN(ve=+ve))return this;var Gt=this._x0,re=this._y0,me=this._x1,bn=this._y1;if(isNaN(Gt))me=(Gt=Math.floor(Se))+1,bn=(re=Math.floor(ve))+1;else{for(var Zn=me-Gt||1,Yt=this._root,Ie,Ge;Gt>Se||Se>=me||re>ve||ve>=bn;)switch(Ge=(ve<re)<<1|Se<Gt,Ie=new Array(4),Ie[Ge]=Yt,Yt=Ie,Zn*=2,Ge){case 0:me=Gt+Zn,bn=re+Zn;break;case 1:Gt=me-Zn,bn=re+Zn;break;case 2:me=Gt+Zn,re=bn-Zn;break;case 3:Gt=me-Zn,re=bn-Zn;break}this._root&&this._root.length&&(this._root=Yt)}return this._x0=Gt,this._y0=re,this._x1=me,this._y1=bn,this}function xt(){var Se=[];return this.visit(function(ve){if(!ve.length)do Se.push(ve.data);while(ve=ve.next)}),Se}function zt(Se){return arguments.length?this.cover(+Se[0][0],+Se[0][1]).cover(+Se[1][0],+Se[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Vt(Se,ve,Gt,re,me){this.node=Se,this.x0=ve,this.y0=Gt,this.x1=re,this.y1=me}function Xt(Se,ve,Gt){var re,me=this._x0,bn=this._y0,Zn,Yt,Ie,Ge,Fe=this._x1,In=this._y1,ar=[],ra=this._root,Ta,$a;for(ra&&ar.push(new Vt(ra,me,bn,Fe,In)),Gt==null?Gt=Infinity:(me=Se-Gt,bn=ve-Gt,Fe=Se+Gt,In=ve+Gt,Gt*=Gt);Ta=ar.pop();)if(!(!(ra=Ta.node)||(Zn=Ta.x0)>Fe||(Yt=Ta.y0)>In||(Ie=Ta.x1)<me||(Ge=Ta.y1)<bn))if(ra.length){var ja=(Zn+Ie)/2,Oa=(Yt+Ge)/2;ar.push(new Vt(ra[3],ja,Oa,Ie,Ge),new Vt(ra[2],Zn,Oa,ja,Ge),new Vt(ra[1],ja,Yt,Ie,Oa),new Vt(ra[0],Zn,Yt,ja,Oa)),($a=(ve>=Oa)<<1|Se>=ja)&&(Ta=ar[ar.length-1],ar[ar.length-1]=ar[ar.length-1-$a],ar[ar.length-1-$a]=Ta)}else{var so=Se-+this._x.call(null,ra.data),Ai=ve-+this._y.call(null,ra.data),Oi=so*so+Ai*Ai;if(Oi<Gt){var hs=Math.sqrt(Gt=Oi);me=Se-hs,bn=ve-hs,Fe=Se+hs,In=ve+hs,re=ra.data}}return re}function ne(Se){if(isNaN(Fe=+this._x.call(null,Se))||isNaN(In=+this._y.call(null,Se)))return this;var ve,Gt=this._root,re,me,bn,Zn=this._x0,Yt=this._y0,Ie=this._x1,Ge=this._y1,Fe,In,ar,ra,Ta,$a,ja,Oa;if(!Gt)return this;if(Gt.length)for(;;){if((Ta=Fe>=(ar=(Zn+Ie)/2))?Zn=ar:Ie=ar,($a=In>=(ra=(Yt+Ge)/2))?Yt=ra:Ge=ra,ve=Gt,!(Gt=Gt[ja=$a<<1|Ta]))return this;if(!Gt.length)break;(ve[ja+1&3]||ve[ja+2&3]||ve[ja+3&3])&&(re=ve,Oa=ja)}for(;Gt.data!==Se;)if(me=Gt,!(Gt=Gt.next))return this;return(bn=Gt.next)&&delete Gt.next,me?(bn?me.next=bn:delete me.next,this):ve?(bn?ve[ja]=bn:delete ve[ja],(Gt=ve[0]||ve[1]||ve[2]||ve[3])&&Gt===(ve[3]||ve[2]||ve[1]||ve[0])&&!Gt.length&&(re?re[Oa]=Gt:this._root=Gt),this):(this._root=bn,this)}function on(Se){for(var ve=0,Gt=Se.length;ve<Gt;++ve)this.remove(Se[ve]);return this}function tn(){return this._root}function He(){var Se=0;return this.visit(function(ve){if(!ve.length)do++Se;while(ve=ve.next)}),Se}function Qn(Se){var ve=[],Gt,re=this._root,me,bn,Zn,Yt,Ie;for(re&&ve.push(new Vt(re,this._x0,this._y0,this._x1,this._y1));Gt=ve.pop();)if(!Se(re=Gt.node,bn=Gt.x0,Zn=Gt.y0,Yt=Gt.x1,Ie=Gt.y1)&&re.length){var Ge=(bn+Yt)/2,Fe=(Zn+Ie)/2;(me=re[3])&&ve.push(new Vt(me,Ge,Fe,Yt,Ie)),(me=re[2])&&ve.push(new Vt(me,bn,Fe,Ge,Ie)),(me=re[1])&&ve.push(new Vt(me,Ge,Zn,Yt,Fe)),(me=re[0])&&ve.push(new Vt(me,bn,Zn,Ge,Fe))}return this}function Ln(Se){var ve=[],Gt=[],re;for(this._root&&ve.push(new Vt(this._root,this._x0,this._y0,this._x1,this._y1));re=ve.pop();){var me=re.node;if(me.length){var bn,Zn=re.x0,Yt=re.y0,Ie=re.x1,Ge=re.y1,Fe=(Zn+Ie)/2,In=(Yt+Ge)/2;(bn=me[0])&&ve.push(new Vt(bn,Zn,Yt,Fe,In)),(bn=me[1])&&ve.push(new Vt(bn,Fe,Yt,Ie,In)),(bn=me[2])&&ve.push(new Vt(bn,Zn,In,Fe,Ge)),(bn=me[3])&&ve.push(new Vt(bn,Fe,In,Ie,Ge))}Gt.push(re)}for(;re=Gt.pop();)Se(re.node,re.x0,re.y0,re.x1,re.y1);return this}function Qr(Se){return Se[0]}function Ia(Se){return arguments.length?(this._x=Se,this):this._x}function Jn(Se){return Se[1]}function Ar(Se){return arguments.length?(this._y=Se,this):this._y}function na(Se,ve,Gt){var re=new za(ve==null?Qr:ve,Gt==null?Jn:Gt,NaN,NaN,NaN,NaN);return Se==null?re:re.addAll(Se)}function za(Se,ve,Gt,re,me,bn){this._x=Se,this._y=ve,this._x0=Gt,this._y0=re,this._x1=me,this._y1=bn,this._root=void 0}function da(Se){for(var ve={data:Se.data},Gt=ve;Se=Se.next;)Gt=Gt.next={data:Se.data};return ve}var Ti=na.prototype=za.prototype;Ti.copy=function(){var Se=new za(this._x,this._y,this._x0,this._y0,this._x1,this._y1),ve=this._root,Gt,re;if(!ve)return Se;if(!ve.length)return Se._root=da(ve),Se;for(Gt=[{source:ve,target:Se._root=new Array(4)}];ve=Gt.pop();)for(var me=0;me<4;++me)(re=ve.source[me])&&(re.length?Gt.push({source:re,target:ve.target[me]=new Array(4)}):ve.target[me]=da(re));return Se},Ti.add=Ot,Ti.addAll=H,Ti.cover=X,Ti.data=xt,Ti.extent=zt,Ti.find=Xt,Ti.remove=ne,Ti.removeAll=on,Ti.root=tn,Ti.size=He,Ti.visit=Qn,Ti.visitAfter=Ln,Ti.x=Ia,Ti.y=Ar;var ki=.81,vi=.1;function ii(Se,ve,Gt){return Se.map(function(re,me){var bn={vx:0,vy:0};return Se.forEach(function(Zn,Yt){if(me!==Yt){var Ie=re.x-Zn.x||.001,Ge=re.y-Zn.y||.001,Fe=Math.sqrt(Ie*Ie+Ge*Ge)+vi,In=Fe*ve,ar=Gt/(In*In)||0;bn.vx+=(Ie/Fe||0)*ar,bn.vy+=(Ge/Fe||0)*ar}}),bn})}function Di(Se,ve,Gt){var re=Gt/(ve*ve),me=Se.map(function(Zn,Yt){return Object.assign(Object.assign({index:Yt},Zn),{vx:0,vy:0,weight:re})}),bn=na(me,function(Zn){return Zn.x},function(Zn){return Zn.y}).visitAfter(Ra);return me.forEach(function(Zn){ln(Zn,bn)}),me.map(function(Zn){return{vx:Zn.vx,vy:Zn.vy}})}function Ra(Se){var ve=0,Gt=0,re=0;if(Se.length){for(var me=0;me<4;me++){var bn=Se[me];bn&&bn.weight&&(ve+=bn.weight,Gt+=bn.x*bn.weight,re+=bn.y*bn.weight)}Se.x=Gt/ve,Se.y=re/ve,Se.weight=ve}else{var Zn=Se;Se.x=Zn.data.x,Se.y=Zn.data.y,Se.weight=Zn.data.weight}}function ln(Se,ve){var Gt=function(me,bn,Zn,Yt,Ie){var Ge=Se.x-me.x||.001,Fe=Se.y-me.y||.001,In=Yt-bn,ar=Ge*Ge+Fe*Fe+vi,ra=Math.sqrt(ar)+vi;if(In*In/ki<ar)return Se.vx+=Ge/ra*me.weight/ar,Se.vy+=Fe/ra*me.weight/ar,!0;if(me.length)return!1;me.data!==Se&&(Se.vx+=Ge/ra*me.data.weight/ar,Se.vy+=Fe/ra*me.data.weight/ar)};ve.visit(Gt)}function De(Se,ve){for(var Gt=0;Gt<ve.length;Gt++){var re=ve[Gt];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(Se,re.key,re)}}function dn(Se,ve,Gt){return ve&&De(Se.prototype,ve),Gt&&De(Se,Gt),Object.defineProperty(Se,"prototype",{writable:!1}),Se}function Wn(Se,ve){if(!(Se instanceof ve))throw new TypeError("Cannot call a class as a function")}var Gn=dn(function Se(ve,Gt){var re=this;Wn(this,Se),this.getvec=function(){return re},this.add=function(me){return new Se(re.x+me.x,re.y+me.y)},this.subtract=function(me){return new Se(re.x-me.x,re.y-me.y)},this.magnitude=function(){return Math.sqrt(re.x*re.x+re.y*re.y)},this.normalise=function(){return re.divide(re.magnitude())},this.divide=function(me){return new Se(re.x/me||0,re.y/me||0)},this.scalarMultip=function(me){return new Se(re.x*me,re.y*me)},this.x=ve,this.y=Gt}),Kn=Gn;function Rr(Se,ve){for(var Gt=0;Gt<ve.length;Gt++){var re=ve[Gt];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(Se,re.key,re)}}function xa(Se,ve,Gt){return ve&&Rr(Se.prototype,ve),Gt&&Rr(Se,Gt),Object.defineProperty(Se,"prototype",{writable:!1}),Se}function La(Se,ve){if(!(Se instanceof ve))throw new TypeError("Cannot call a class as a function")}var ui=xa(function Se(ve,Gt,re){var me=this,bn=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;La(this,Se),this.updateAcc=function(Zn){me.a=me.a.add(Zn.divide(me.m))},this.p=ve,this.m=bn,this.v=new Kn(0,0),this.a=new Kn(0,0),this.id=Gt,this.data=re}),Fi=ui;function Ki(Se,ve){for(var Gt=0;Gt<ve.length;Gt++){var re=ve[Gt];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(Se,re.key,re)}}function xo(Se,ve,Gt){return ve&&Ki(Se.prototype,ve),Gt&&Ki(Se,Gt),Object.defineProperty(Se,"prototype",{writable:!1}),Se}function vo(Se,ve){if(!(Se instanceof ve))throw new TypeError("Cannot call a class as a function")}var es=xo(function Se(ve,Gt,re){vo(this,Se),this.source=ve,this.target=Gt,this.length=re}),Wo=es;function Zi(Se,ve){for(var Gt=0;Gt<ve.length;Gt++){var re=ve[Gt];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(Se,re.key,re)}}function bi(Se,ve,Gt){return ve&&Zi(Se.prototype,ve),Gt&&Zi(Se,Gt),Object.defineProperty(Se,"prototype",{writable:!1}),Se}function gi(Se,ve){if(!(Se instanceof ve))throw new TypeError("Cannot call a class as a function")}var ms=bi(function Se(ve){var Gt=this;gi(this,Se),this.updateOptions=function(re){!re||Object.keys(re).forEach(function(me){Gt.props[me]=re[me]})},this.setData=function(re){Gt.nodes=[],Gt.edges=[],Gt.nodeSet={},Gt.edgeSet={},Gt.nodePoints=new Map,Gt.edgeSprings=new Map,Gt.sourceData=re,Gt.judgingDistance=0,("nodes"in re||"edges"in re)&&(Gt.addNodes(re.nodes),Gt.addEdges(re.edges))},this.getMass=function(re){var me,bn=re.layout||{},Zn=bn.degree,Yt=Zn===void 0?(me=$r.getDegree(re,Gt.edges))===null||me===void 0?void 0:me.degree:Zn,Ie=bn.force;return Ie&&Ie.mass?Ie.mass:Yt<5?1:Yt*5},this.init=function(){var re=Gt.props,me=re.width,bn=re.height,Zn=Gt.props.centripetalOptions,Yt=Gt.props,Ie=Yt.leafCluster,Ge=Yt.clustering,Fe=Yt.nodeClusterBy,In=Yt.clusterNodeStrength,ar=function(Oi){return typeof In=="function"?In(Oi):In},ra;if(Gt.nodes.forEach(function(Ai){var Oi=Ai.data.x||me/2,hs=Ai.data.y||bn/2,wo=new Kn(Oi,hs);Ai.data.layout||(Ai.data.layout={});var ho=$r.getDegree(Ai,Gt.edges);Ai.data.layout=Object.assign(Object.assign({},Ai.data.layout),ho);var Ro=Gt.getMass(Ai.data);Gt.nodePoints.set(Ai.id,new Fi(wo,String(Ai.id),Ai.data,Ro))}),Gt.edges.forEach(function(Ai){var Oi=Gt.nodePoints.get(Ai.source.id),hs=Gt.nodePoints.get(Ai.target.id),wo=Gt.props.defSpringLen(Ai,Oi,hs);Gt.edgeSprings.set(Ai.id,new Wo(Oi,hs,wo))}),Ie){ra=Gt.getSameTypeLeafMap();var Ta=$r.getRelativeNodesType(Gt.nodes,Fe);Zn={single:100,leaf:function(Oi,hs,wo){var ho=ra[Oi.id]||{},Ro=ho.relativeLeafNodes,Ys=ho.sameTypeLeafNodes;return(Ys==null?void 0:Ys.length)===(Ro==null?void 0:Ro.length)||(Ta==null?void 0:Ta.length)===1?1:ar(Oi)},others:1,center:function(Oi,hs,wo){var ho,Ro=((ho=Oi.data)===null||ho===void 0?void 0:ho.layout)||{},Ys=Ro.degree;if(!Ys)return{x:100,y:100};var Ps;if(Ys===1){var As=ra[Oi.id]||{},Vs=As.sameTypeLeafNodes,su=Vs===void 0?[]:Vs;su.length===1?Ps=void 0:su.length>1&&(Ps=$r.getAvgNodePosition(su))}else Ps=void 0;return{x:Ps==null?void 0:Ps.x,y:Ps==null?void 0:Ps.y}}}}if(Ge){ra||(ra=Gt.getSameTypeLeafMap());var $a=Array.from(new Set(Gt.nodes.map(function(Ai){var Oi;return(Oi=Ai.data)===null||Oi===void 0?void 0:Oi[Fe]}))).filter(function(Ai){return Ai!==void 0}),ja={};$a.forEach(function(Ai){var Oi=Gt.nodes.filter(function(hs){var wo;return((wo=hs.data)===null||wo===void 0?void 0:wo[Fe])===Ai});ja[Ai]=$r.getAvgNodePosition(Oi)}),Zn={single:function(Oi){return ar(Oi)},leaf:function(Oi){return ar(Oi)},others:function(Oi){return ar(Oi)},center:function(Oi,hs,wo){var ho,Ro=ja[(ho=Oi.data)===null||ho===void 0?void 0:ho[Fe]];return{x:Ro==null?void 0:Ro.x,y:Ro==null?void 0:Ro.y}}}}Gt.centripetalOptions=Object.assign(Object.assign({},Gt.centripetalOptions),Zn);var Oa=Gt.nodePoints.size,so=Math.pow(10,2);Gt.props.minEnergyThreshold=1/2*Math.pow(1,2)*1*Oa*so},this.start=function(){Gt.init(),Gt.props.animation?Gt.animation():Gt.slienceForce()},this.calTotalEnergy=function(){var re=0;return Gt.nodes.forEach(function(me){var bn=Gt.nodePoints.get(me.id),Zn=bn.v.magnitude(),Yt=bn.m;re+=Yt*Math.pow(Zn,2)*.5}),re},this.slienceForce=function(){for(var re=Gt.props,me=re.done,bn=re.maxIterations,Zn=re.minDistanceThreshold,Yt=0;(Gt.judgingDistance>Zn||Yt<1)&&Yt<bn;Yt++)Gt.tick(Gt.props.tickInterval),Gt.iterations++;Gt.render(),me&&me(Gt.renderNodes)},this.requestAnimationFrame=function(re){var me=Gt.props.enableWorker;return me?setInterval(function(){re()},16):window.requestAnimationFrame(re)},this.cancelAnimationFrame=function(re){var me=Gt.props.enableWorker;me?clearInterval(re):window.cancelAnimationFrame(re)},this.animation=function(){var re=Gt.props,me=re.enableWorker,bn=re.maxIterations,Zn=re.minDistanceThreshold,Yt=re.done,Ie=re.tickInterval;if(me){for(var Ge=new Date().valueOf(),Fe=.22,In=function(Ai){return Ai>10?2e3:20*Ai*Ai},ar=0;ar<bn;ar++){var ra=Math.max(.02,Fe-ar*.002);Gt.tick(ra);var Ta=new Date().valueOf()-Ge;Ta>=In(ar)&&(Gt.render(),Ge=new Date().valueOf());var $a=Gt.calTotalEnergy(),ja=Gt.registers.get("monitor");if(ja&&ja(Gt.reportMointor($a)),Gt.judgingDistance<Zn){Gt.render(),Yt&&Yt(Gt.renderNodes);return}}return}var Oa=function so(){Gt.tick(Ie),Gt.render(),Gt.iterations++;var Ai=Gt.calTotalEnergy(),Oi=Gt.registers.get("monitor");Oi&&Oi(Gt.reportMointor(Ai)),Gt.judgingDistance<Zn||Gt.iterations>Gt.props.maxIterations?(Gt.cancelAnimationFrame(Gt.timer),Gt.iterations=0,Gt.done=!0,Yt&&Yt(Gt.renderNodes)):Gt.timer=Gt.requestAnimationFrame(so)};Gt.timer=Gt.requestAnimationFrame(Oa)},this.render=function(){var re=Gt.registers.get("render");Gt.renderNodes=[],Gt.nodePoints.forEach(function(me){Gt.renderNodes.push(Object.assign(Object.assign({},Gt.nodeSet[me.id]&&Gt.nodeSet[me.id].data),{x:me.p.x,y:me.p.y}))}),re?re({nodes:Gt.renderNodes,edges:Gt.sourceData.edges}):console.error("need a render function")},this.reportMointor=function(re){var me={energy:re,iterations:Gt.iterations,nodes:Gt.nodes,edges:Gt.edges};return me},this.tick=function(re){Gt.updateCoulombsLawOptimized(),Gt.updateHookesLaw(),Gt.attractToCentre(),Gt.attractToSide(),Gt.updateVelocity(re),Gt.updatePosition(re)},this.updateCoulombsLawOptimized=function(){var re=Gt.props.coulombDisScale,me=Gt.props.repulsion,bn=Gt.nodes.map(function(Yt){var Ie=Gt.nodePoints.get(Yt.id).p;return{x:Ie.x,y:Ie.y}}),Zn=Di(bn,re,me);Gt.nodes.forEach(function(Yt,Ie){Gt.nodePoints.get(Yt.id).updateAcc(new Kn(Zn[Ie].vx,Zn[Ie].vy))})},this.updateCoulombsLaw=function(){for(var re=Gt.nodes.length,me=0;me<re;me++)for(var bn=me+1;bn<re;bn++)if(me!==bn){var Zn=Gt.nodes[me],Yt=Gt.nodes[bn],Ie=Gt.props.coulombDisScale,Ge=Gt.props.repulsion,Fe=Gt.nodePoints.get(Zn.id).p.subtract(Gt.nodePoints.get(Yt.id).p),In=(Fe.magnitude()+.1)*Ie,ar=Fe.normalise(),ra=1;Gt.nodePoints.get(Zn.id).updateAcc(ar.scalarMultip(Ge*ra).divide(Math.pow(In,2))),Gt.nodePoints.get(Yt.id).updateAcc(ar.scalarMultip(Ge*ra).divide(-Math.pow(In,2)))}},this.updateHookesLaw=function(){Gt.edges.forEach(function(re){var me=Gt.edgeSprings.get(re.id),bn=me.target.p.subtract(me.source.p),Zn=me.length-bn.magnitude(),Yt=bn.normalise();me.source.updateAcc(Yt.scalarMultip(-Gt.props.stiffness*Zn)),me.target.updateAcc(Yt.scalarMultip(Gt.props.stiffness*Zn))})},this.implementForce=function(re,me){var bn=arguments.length>2&&arguments[2]!==void 0?arguments[2]:2,Zn=Gt.nodePoints.get(re.id),Yt=Zn.p.subtract(me);Zn.updateAcc(Yt.scalarMultip(-bn))},this.attractToCentre=function(){Gt.nodes.forEach(function(re){var me,bn=(me=re.data)===null||me===void 0?void 0:me.layout,Zn=bn.degree,Yt=bn.sDegree,Ie=bn.tDegree,Ge=Gt.centripetalOptions,Fe=Ge.leaf,In=Ge.single,ar=Ge.others,ra=Ge.center,Ta=Gt.props,$a=Ta.width,ja=Ta.height;if(ra!==void 0){var Oa=ra(re,Gt.nodes,Gt.edges,$a,ja),so=Oa.x,Ai=Oa.y,Oi=Oa.centerStrength;if(!(so===void 0||Ai===void 0)){var hs=new Kn(so,Ai);if(Oi){Gt.implementForce(re,hs,Oi);return}var wo=typeof Fe=="function"?Fe(re,Gt.nodes,Gt.edges):Fe,ho=typeof In=="function"?In(re):In,Ro=typeof ar=="function"?ar(re):ar,Ys=Ie===0||Yt===0,Ps=Zn===0;if(!(wo===0||ho===0||Ro===0)){if(Ps){Gt.implementForce(re,hs,ho);return}if(Ys){Gt.implementForce(re,hs,wo);return}Gt.implementForce(re,hs,Ro)}}}})},this.attractToSide=function(){if(!(!Gt.props.defSideCoe||typeof Gt.props.defSideCoe!="function")){var re=Gt.props.height;Gt.nodes.forEach(function(me){var bn=Gt.props.defSideCoe(me);if(bn!==0){var Zn=Gt.nodePoints.get(me.id),Yt=Zn.p.x,Ie=bn>0?0:re,Ge=new Kn(Yt,Ie);Gt.implementForce(me,Ge,Math.abs(bn))}})}},this.updateVelocity=function(re){Gt.nodes.forEach(function(me){var bn=Gt.nodePoints.get(me.id);bn.v=bn.v.add(bn.a.scalarMultip(re)).scalarMultip(Gt.props.damping),bn.v.magnitude()>Gt.props.maxSpeed&&(bn.v=bn.v.normalise().scalarMultip(Gt.props.maxSpeed)),bn.a=new Kn(0,0)})},this.updatePosition=function(re){var me;if(!((me=Gt.nodes)===null||me===void 0?void 0:me.length)){Gt.judgingDistance=0;return}var bn=Gt.props.distanceThresholdMode,Zn=0;bn==="max"?Gt.judgingDistance=-Infinity:bn==="min"&&(Gt.judgingDistance=Infinity),Gt.nodes.forEach(function(Yt){var Ie=Gt.nodePoints.get(Yt.id);Ie.p=Ie.p.add(Ie.v.scalarMultip(re));var Ge=Ie.v.scalarMultip(re),Fe=Ge.magnitude();switch(bn){case"max":Gt.judgingDistance<Fe&&(Gt.judgingDistance=Fe);break;case"min":Gt.judgingDistance>Fe&&(Gt.judgingDistance=Fe);break;default:Zn=Zn+Fe;break}}),(!bn||bn==="mean")&&(Gt.judgingDistance=Zn/Gt.nodes.length)},this.addNode=function(re){var me=Gt.props.ignore;me&&me(re)||(re.id in Gt.nodeSet||Gt.nodes.push(re),Gt.nodeSet[re.id]=re)},this.addNodes=function(re){re.forEach(function(me){Gt.addNode(new un(me))})},this.addEdge=function(re){return re.id in Gt.edgeSet||Gt.edges.push(re),Gt.edgeSet[re.id]=re,re},this.addEdges=function(re){try{for(var me=re.length,bn=0;bn<me;bn++){var Zn=re[bn],Yt=Zn.source,Ie=Zn.target,Ge=Gt.nodeSet[Yt];if(Ge===void 0)throw new TypeError("invalid node name: ".concat(Zn.source));var Fe=Gt.nodeSet[Ie];if(Fe===void 0)throw new TypeError("invalid node name: ".concat(Zn.target));var In=Zn.data,ar=new Lt(String(Gt.nextEdgeId++),Ge,Fe,In);Gt.addEdge(ar)}}catch(ra){console.error(ra)}},this.register=function(re,me){Gt.registers.set(re,me)},this.restart=function(re,me){var bn=Gt.props.ignore;me.getNodes().forEach(function(Yt){var Ie=Yt.get("model");if(!(bn&&bn(Ie))){var Ge=new Kn(Ie.x,Ie.y),Fe=Gt.nodePoints.get(Ie.id);Fe&&(Fe.p=Ge,Gt.nodePoints.set(Ie.id,Fe))}});var Zn=function(Ie){var Ge=new Kn(Ie.x,Ie.y),Fe=Gt.getMass(Ie);Gt.nodePoints.set(Ie.id,new Fi(Ge,Ie.id,Ie.data,Fe)),Gt.edges.forEach(function(In){var ar=Gt.nodePoints.get(In.source.id),ra=Gt.nodePoints.get(In.target.id);if(ar.id===Ie.id||ra.id===Ie.id){var Ta=Gt.edgeSprings.get(In.id).length||100;Gt.edgeSprings.set(In.id,new Wo(ar,ra,Ta))}})};re.forEach(Zn),Gt.props.restartAnimation?Gt.animation():Gt.slienceForce()},this.stop=function(){window.cancelAnimationFrame(Gt.timer),Gt.done=!0},this.getSameTypeLeafMap=function(){var re=Gt.props.nodeClusterBy,me={};return Gt.nodes.forEach(function(bn){var Zn,Yt=((Zn=bn.data)===null||Zn===void 0?void 0:Zn.layout)||{},Ie=Yt.degree;Ie===1&&(me[bn.id]=$r.getCoreNodeAndRelativeLeafNodes("leaf",bn,Gt.edges,re))}),me},this.props={stiffness:200,enableWorker:!1,defSpringLen:function(me){return me.data.spring||200},repulsion:200*5,centripetalOptions:{leaf:2,single:2},leafCluster:!1,clustering:!1,nodeClusterBy:"cluster",clusterNodeStrength:20,damping:.9,minEnergyThreshold:.1,maxSpeed:1e3,coulombDisScale:.005,tickInterval:.02,groupFactor:4,maxIterations:7440,minDistanceThreshold:.4,distanceThresholdMode:"mean",animation:!0,restartAnimation:!0,width:200,height:200},this.updateOptions(ve),this.sourceData={nodes:[],edges:[],combos:[]},this.nodes=[],this.edges=[],this.nodeSet={},this.edgeSet={},this.renderNodes=[],this.nodePoints=new Map,this.edgeSprings=new Map,this.registers=new Map,this.done=!1,this.judgingDistance=0,this.iterations=0,this.nextEdgeId=0,this.timer=0,this.center=new Kn(0,0),this.centripetalOptions={leaf:2,single:2,others:1,center:function(me){return{x:Gt.props.width/2,y:Gt.props.height/2}}},this.dragNodes=[]}),Do=ms,To=Do,Zs=function(Se,ve){var Gt={};for(var re in Se)Object.prototype.hasOwnProperty.call(Se,re)&&ve.indexOf(re)<0&&(Gt[re]=Se[re]);if(Se!=null&&typeof Object.getOwnPropertySymbols=="function")for(var me=0,re=Object.getOwnPropertySymbols(Se);me<re.length;me++)ve.indexOf(re[me])<0&&Object.prototype.propertyIsEnumerable.call(Se,re[me])&&(Gt[re[me]]=Se[re[me]]);return Gt},Eu=function(){j.ZP.registerLayout("graphin-force",{getDefaultCfg:function(){return{preset:{name:"grid",options:{}},stiffness:200,repulsion:200*5,centripetalOptions:{leaf:1.6,single:1.6},damping:.9,minEnergyThreshold:.1,maxSpeed:1e3,MaxIterations:1e4,animation:!0}},init:function(ve){this.nodes=ve.nodes,this.edges=ve.edges;var Gt=this,re=Gt.graph,me=Zs(Gt,["graph"]),bn=Object.assign(Object.assign({},this.getDefaultCfg()),me),Zn=bn.width,Yt=bn.height,Ie=bn.animation,Ge=bn.done,Fe=Ge===void 0?function(){}:Ge,In=Zs(bn,["width","height","animation","done"]);this.simulation=new To(Object.assign(Object.assign(Object.assign({width:Zn,height:Yt,animation:Ie},In),me),{done:function(ra){Fe(re,ra)}})),this.simulation.setData(ve),this.simulation.register("render",function(ar){if(!Ie&&ve&&ve.nodes&&ve.nodes.length>0){var ra=ar.nodes;return ve.nodes.forEach(function($a,ja){var Oa=ra[ja];if(Oa&&Oa.id===$a.id)$a.x=ra[ja].x,$a.y=ra[ja].y;else{var so=ra.find(function(Ai){return Ai.id===$a.id});so&&($a.x=so.x,$a.y=so.y)}}),Object.assign({},ar)}try{if(!re||re.destroyed)return;var Ta=!1;ar.nodes.forEach(function($a){var ja=re.findById($a.id);if(ja){var Oa=ja.get("model");Oa.x=$a.x,Oa.y=$a.y,ja.getType()==="combo"&&(Ta=!0)}}),re.refreshPositions(Ta)}catch($a){console.error($a)}})},execute:function(){this.simulation.start()},layout:function(ve){this.init(ve),this.execute()},updateCfg:function(ve){this.cfg=Object.assign(Object.assign({},this.cfg),ve)},destroy:function(){this.destroyed=!0,this.simulation.stop(),this.simulation=null},getType:function(){return"graphin-force"}})},as=function(){j.ZP.registerLayout("preset",{init:function(){},execute:function(){},destroy:function(){this.destroyed=!0}})},Rs=$(23044);function Su(Se,ve){return ys(Se)||Wi(Se,ve)||Is(Se,ve)||fu()}function fu(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Is(Se,ve){if(!!Se){if(typeof Se=="string")return Zo(Se,ve);var Gt=Object.prototype.toString.call(Se).slice(8,-1);if(Gt==="Object"&&Se.constructor&&(Gt=Se.constructor.name),Gt==="Map"||Gt==="Set")return Array.from(Se);if(Gt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Gt))return Zo(Se,ve)}}function Zo(Se,ve){(ve==null||ve>Se.length)&&(ve=Se.length);for(var Gt=0,re=new Array(ve);Gt<ve;Gt++)re[Gt]=Se[Gt];return re}function Wi(Se,ve){var Gt=Se==null?null:typeof Symbol!="undefined"&&Se[Symbol.iterator]||Se["@@iterator"];if(Gt!=null){var re=[],me=!0,bn=!1,Zn,Yt;try{for(Gt=Gt.call(Se);!(me=(Zn=Gt.next()).done)&&(re.push(Zn.value),!(ve&&re.length===ve));me=!0);}catch(Ie){bn=!0,Yt=Ie}finally{try{!me&&Gt.return!=null&&Gt.return()}finally{if(bn)throw Yt}}return re}}function ys(Se){if(Array.isArray(Se))return Se}var is=function(Se,ve){var Gt={};for(var re in Se)Object.prototype.hasOwnProperty.call(Se,re)&&ve.indexOf(re)<0&&(Gt[re]=Se[re]);if(Se!=null&&typeof Object.getOwnPropertySymbols=="function")for(var me=0,re=Object.getOwnPropertySymbols(Se);me<re.length;me++)ve.indexOf(re[me])<0&&Object.prototype.propertyIsEnumerable.call(Se,re[me])&&(Gt[re[me]]=Se[re[me]]);return Gt},Us=function(ve,Gt,re){if(!!Gt)try{ve.forEach(function(me){var bn=me.cfg.name,Zn=Gt[bn];if(Zn){var Yt=re(Gt,bn),Ie=Yt.animate,Ge=Yt.visible,Fe=is(Yt,["animate","visible"]);if(me.attrs.img)Fe.opacity!==void 0&&me.attr({opacity:Fe.opacity});else if(me.attr(Fe),me.cfg.visible=Ge!==!1,Ie){var In=Ie.attrs,ar=is(Ie,["attrs"]);me.animate(In,ar)}}})}catch(me){console.error(me)}};function Du(Se){return Object.keys(Se).forEach(function(ve){Se[ve]===void 0&&delete Se[ve]}),Se}var qs=function(ve){if(!ve)return[0,0];var Gt=0,re=0;if((0,Rs.isNumber)(ve))Gt=ve,re=ve;else if((0,Rs.isArray)(ve)){if(ve.length===1){var me=Su(ve,1),bn=me[0];Gt=bn,re=bn}else if(ve.length===2){var Zn=Su(ve,2),Yt=Zn[0],Ie=Zn[1];Gt=Yt,re=Ie}}return[Gt,re]},Cu=function(ve){var Gt=ve.label,re=ve.keyshape;if(!(re==null?void 0:re.size)&&!(Gt==null?void 0:Gt.offset))return{x:void 0,y:void 0,textBaseline:Gt==null?void 0:Gt.textBaseline};!(re==null?void 0:re.size)&&(Gt==null?void 0:Gt.offset)&&(re.size=26,console.info("you should set keyshape.size when you update label position,the default keyshape size value is  26"));var me=re.size,bn=[0,0],Zn=Gt.position,Yt=Gt.offset,Ie=Yt===void 0?bn:Yt;(typeof Ie=="number"||typeof Ie=="string")&&(bn=[Number(Ie),Number(Ie)]),Ie.length>0&&(bn=Ie);var Ge=bn,Fe=Su(Ge,2),In=Fe[0],ar=Fe[1];if(Zn==="center")return{x:0+In,y:0+ar};var ra=qs(me),Ta=ra[0],$a=ra[1],ja;switch(Zn){case"top":ja={x:0+In,y:-$a/2-ar,textBaseline:"bottom"};break;case"bottom":ja={x:0+In,y:$a/2+ar,textBaseline:"top"};break;case"left":ja={x:0-Ta-In,y:0+ar,textAlign:"right"};break;case"right":ja={x:0+Ta+In,y:0+ar,textAlign:"left"};break;default:ja={x:0+In,y:$a/2+ar,textBaseline:"top"};break}return ja},ji=function(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"RT",Gt=arguments.length>1?arguments[1]:void 0,re=0,me=0;return ve==="LT"?(re=Gt*Math.cos(Math.PI*3/4),me=-Gt*Math.sin(Math.PI*3/4)):ve==="LB"?(re=Gt*Math.cos(Math.PI*5/4),me=-Gt*Math.sin(Math.PI*5/4)):ve==="RT"?(re=Gt*Math.cos(Math.PI*1/4),me=-Gt*Math.sin(Math.PI*1/4)):ve==="RB"&&(re=Gt*Math.cos(Math.PI*7/4),me=-Gt*Math.sin(Math.PI*7/4)),{x:re,y:me}};function Bi(Se){return Ws(Se)||os(Se)||Qu(Se)||Ms()}function Ms(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function os(Se){if(typeof Symbol!="undefined"&&Se[Symbol.iterator]!=null||Se["@@iterator"]!=null)return Array.from(Se)}function Ws(Se){if(Array.isArray(Se))return xn(Se)}function Ss(Se,ve){return pa(Se)||Vr(Se,ve)||Qu(Se,ve)||Qs()}function Qs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qu(Se,ve){if(!!Se){if(typeof Se=="string")return xn(Se,ve);var Gt=Object.prototype.toString.call(Se).slice(8,-1);if(Gt==="Object"&&Se.constructor&&(Gt=Se.constructor.name),Gt==="Map"||Gt==="Set")return Array.from(Se);if(Gt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Gt))return xn(Se,ve)}}function xn(Se,ve){(ve==null||ve>Se.length)&&(ve=Se.length);for(var Gt=0,re=new Array(ve);Gt<ve;Gt++)re[Gt]=Se[Gt];return re}function Vr(Se,ve){var Gt=Se==null?null:typeof Symbol!="undefined"&&Se[Symbol.iterator]||Se["@@iterator"];if(Gt!=null){var re=[],me=!0,bn=!1,Zn,Yt;try{for(Gt=Gt.call(Se);!(me=(Zn=Gt.next()).done)&&(re.push(Zn.value),!(ve&&re.length===ve));me=!0);}catch(Ie){bn=!0,Yt=Ie}finally{try{!me&&Gt.return!=null&&Gt.return()}finally{if(bn)throw Yt}}return re}}function pa(Se){if(Array.isArray(Se))return Se}var Fa=function(Se,ve){var Gt={};for(var re in Se)Object.prototype.hasOwnProperty.call(Se,re)&&ve.indexOf(re)<0&&(Gt[re]=Se[re]);if(Se!=null&&typeof Object.getOwnPropertySymbols=="function")for(var me=0,re=Object.getOwnPropertySymbols(Se);me<re.length;me++)ve.indexOf(re[me])<0&&Object.prototype.propertyIsEnumerable.call(Se,re[me])&&(Gt[re[me]]=Se[re[me]]);return Gt};function Vi(Se){var ve;return(0,Rs.isNumber)(Se)?ve=Se/2:(0,Rs.isArray)(Se)&&(ve=Se[0]/2),ve}var Ao=function(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Gt=Ee(ve),re=Gt.defaultNodeStyle,me=Gt.defaultNodeStatusStyle;return{style:re.style,status:me.status}},ao=function(ve){var Gt=ve.halo,re=ve.keyshape,me=Gt.size,bn=Gt.visible,Zn=Gt.fill,Yt=Gt.fillOpacity,Ie=Fa(Gt,["size","visible","fill","fillOpacity"]),Ge=Vi(me),Fe,In,ar;if(re&&re.size){var ra=Vi(re.size);Fe=ra+15}re&&re.fill&&(In=re.fill),re&&re.stroke&&(ar=re.stroke);var Ta=Object.assign({x:0,y:0,r:Ge||Fe,fill:Zn||In||ar,fillOpacity:Yt||.1,visible:bn!==!1},Ie);return{name:"halo",visible:bn!==!1,attrs:Du(Ta)}},So=function(ve){var Gt=ve.keyshape,re=Gt.size,me=Gt.visible,bn=Gt.stroke,Zn=Gt.fill,Yt=Gt.fillOpacity,Ie=Gt.strokeOpacity,Ge=Fa(Gt,["size","visible","stroke","fill","fillOpacity","strokeOpacity"]),Fe=Vi(re),In=Object.assign({x:0,y:0,r:Fe,cursor:"pointer",visible:me!==!1,stroke:bn,strokeOpacity:Ie||1,fill:Zn||bn,fillOpacity:Yt||.2},Ge);return{name:"keyshape",visible:me!==!1,attrs:Du(In)}},Ts=function(ve){var Gt=ve.label,re=Gt.value,me=Gt.fill,bn=Gt.fontSize,Zn=Gt.visible,Yt=Fa(Gt,["value","fill","fontSize","visible"]),Ie=Cu(ve),Ge=Object.assign({x:Ie.x,y:Ie.y,fontSize:bn,text:re,textAlign:"center",fill:me,textBaseline:Ie.textBaseline,visible:Zn!==!1},Yt);return{name:"label",visible:Zn!==!1,attrs:Du(Ge)}},fo=function(ve){var Gt=ve.icon,re=Gt.value,me=re===void 0?"":re,bn=Gt.type,Zn=Gt.fontFamily,Yt=Gt.textAlign,Ie=Yt===void 0?"center":Yt,Ge=Gt.textBaseline,Fe=Ge===void 0?"middle":Ge,In=Gt.fill,ar=Gt.size,ra=Gt.visible,Ta=Gt.clip,$a=Fa(Gt,["value","type","fontFamily","textAlign","textBaseline","fill","size","visible","clip"]),ja=qs(ar),Oa=Ss(ja,2),so=Oa[0],Ai=Oa[1],Oi={name:"icon",visible:ra!==!1,capture:!1};return bn==="text"||bn==="font"?Object.assign(Object.assign({},Oi),{attrs:Object.assign({x:0,y:0,textAlign:Ie,textBaseline:Fe,text:me,fontSize:so,fontFamily:Zn,fill:In,visible:ra!==!1},$a)}):Object.assign(Object.assign({},Oi),{attrs:Object.assign({x:-so/2,y:-Ai/2,img:me,width:so,height:Ai,visible:ra!==!1},$a)})},ou=function(ve,Gt){return Gt==="keyshape"?So(ve).attrs:Gt==="halo"?ao(ve).attrs:Gt==="label"?Ts(ve).attrs:Gt==="icon"?fo(ve).attrs:ve[Gt]||{}},Cs=function(ve,Gt,re){var me=ve.type,bn=ve.position,Zn=ve.value,Yt=Zn===void 0?"":Zn,Ie=ve.size,Ge=ve.fill,Fe=ve.stroke,In=ve.color,ar=ve.fontSize,ra=ve.fontFamily,Ta=ve.padding,$a=Ta===void 0?0:Ta,ja=ve.offset,Oa=ja===void 0?[0,0]:ja,so=ve.id,Ai=qs(Oa),Oi=qs(Ie),hs=Ss(Oi,2),wo=hs[0],ho=hs[1],Ro=ji(bn,re),Ys=Ro.x,Ps=Ro.y,As=Ys,Vs=Ps;if(wo===ho){As+=Ai[0],Vs+=Ai[1];var su={attrs:{r:wo/2+$a,fill:Ge,stroke:Fe,x:As,y:Vs},name:"badges-circle"};so&&(su.id=so),Gt.addShape("circle",su)}else{As=Ys-wo-$a*2,Vs=Ps-ho-$a*2,bn==="LB"?Vs=Ps:bn==="RT"?(As=Ys,Vs=Ps-ho-$a*2):bn==="RB"&&(As=Ys,Vs=Ps),As+=Ai[0],Vs+=Ai[1];var xl={attrs:{width:wo+$a*2,height:ho+$a*2,fill:Ge,stroke:Fe,x:As,y:Vs,radius:(ho+$a*2)/3},name:"badges-rect"};so&&(xl.id=so),Gt.addShape("rect",xl)}me==="font"||me==="text"?Gt.addShape("text",{attrs:{x:wo!==ho?As+wo/2+$a:As,y:wo!==ho?Vs+ho/2+$a:Vs,text:Yt,fontSize:ar,textAlign:"center",textBaseline:"middle",fontFamily:ra,fill:In},capture:!1,name:"badges-text"}):me==="image"&&Gt.addShape("image",{attrs:{x:As-wo/2,y:As-ho/2,width:wo,height:ho,img:Yt},capture:!1,name:"badges-image"})},Au=function(){j.ZP.registerNode("graphin-circle",{options:{style:{},status:{}},draw:function(ve,Gt){var re=ve.style._theme;this.options=Ao(re);var me=(0,Rs.deepMix)({},this.options.style,ve.style);ve._initialStyle=Object.assign({},me);var bn=me.icon,Zn=me.badges,Yt=Zn===void 0?[]:Zn,Ie=me.keyshape,Ge=Vi(Ie.size);Gt.addShape("circle",ao(me));var Fe=Gt.addShape("circle",So(me));Gt.addShape("text",Ts(me));var In=bn.type;if((In==="text"||In==="font")&&Gt.addShape("text",fo(me)),In==="image"){var ar=fo(me),ra=Gt.addShape("image",ar),Ta=me.icon.clip;if(Ta){var $a=Ta.r,ja=Fa(Ta,["r"]);ra.setClip({type:"circle",attrs:Object.assign({x:0,y:0,r:$a},ja)})}}return Yt.forEach(function(Oa){Cs(Oa,Gt,Ge)}),Fe},setState:function(ve,Gt,re){var me;if(!!ve){var bn=re.getModel(),Zn=re.getContainer().get("children"),Yt=(0,Rs.deepMix)({},this.options.status,bn.style.status),Ie=re.getModel()._initialStyle,Ge=((me=re._cfg)===null||me===void 0?void 0:me.states)||[];try{Object.keys(Yt).forEach(function(Fe){ve===Fe&&(Gt?Us(Zn,Yt[Fe],ou):(Us(Zn,Ie,ou),Ge.forEach(function(In){Us(Zn,Yt[In],ou)})))})}catch(Fe){console.error(Fe)}}},update:function(ve,Gt){if(!!ve.style)try{var re=(0,Rs.deepMix)({},ve._initialStyle,ve.style);ve._initialStyle=Object.assign({},re);var me=re.badges,bn=re.keyshape,Zn=Vi(bn.size),Yt=Gt.getContainer(),Ie=Yt.get("children");Us(Ie,re,ou);var Ge=Bi(Ie);if(me){var Fe=0;Ge.forEach(function(In){In.cfg.name.startsWith("badges")?Ie.splice(Fe,1):Fe=Fe+1}),me.forEach(function(In){Cs(In,Yt,Zn)})}}catch(In){console.error("error")}}})},Tl=$(32096);function bl(Se,ve,Gt){return ve in Se?Object.defineProperty(Se,ve,{value:Gt,enumerable:!0,configurable:!0,writable:!0}):Se[ve]=Gt,Se}function Js(Se,ve){return fs(Se)||Nu(Se,ve)||Mu(Se,ve)||ul()}function ul(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mu(Se,ve){if(!!Se){if(typeof Se=="string")return Pu(Se,ve);var Gt=Object.prototype.toString.call(Se).slice(8,-1);if(Gt==="Object"&&Se.constructor&&(Gt=Se.constructor.name),Gt==="Map"||Gt==="Set")return Array.from(Se);if(Gt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Gt))return Pu(Se,ve)}}function Pu(Se,ve){(ve==null||ve>Se.length)&&(ve=Se.length);for(var Gt=0,re=new Array(ve);Gt<ve;Gt++)re[Gt]=Se[Gt];return re}function Nu(Se,ve){var Gt=Se==null?null:typeof Symbol!="undefined"&&Se[Symbol.iterator]||Se["@@iterator"];if(Gt!=null){var re=[],me=!0,bn=!1,Zn,Yt;try{for(Gt=Gt.call(Se);!(me=(Zn=Gt.next()).done)&&(re.push(Zn.value),!(ve&&re.length===ve));me=!0);}catch(Ie){bn=!0,Yt=Ie}finally{try{!me&&Gt.return!=null&&Gt.return()}finally{if(bn)throw Yt}}return re}}function fs(Se){if(Array.isArray(Se))return Se}var Bs=function(Se,ve){var Gt={};for(var re in Se)Object.prototype.hasOwnProperty.call(Se,re)&&ve.indexOf(re)<0&&(Gt[re]=Se[re]);if(Se!=null&&typeof Object.getOwnPropertySymbols=="function")for(var me=0,re=Object.getOwnPropertySymbols(Se);me<re.length;me++)ve.indexOf(re[me])<0&&Object.prototype.propertyIsEnumerable.call(Se,re[me])&&(Gt[re[me]]=Se[re[me]]);return Gt},gu=function(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Gt=Ee(ve),re=Gt.defaultEdgeStyle,me=Gt.defaultEdgeStatusStyle;return{style:re.style,status:me.status}},Fu;(function(Se){Se.NORMAL="normal",Se.SELECTED="selected",Se.HOVERED="hovered",Se.DISABLED="disabled"})(Fu||(Fu={}));function Wu(Se){return Object.keys(Se).forEach(function(ve){Se[ve]===void 0&&delete Se[ve]}),Se}function Ju(Se){var ve=Se.value,Gt=Bs(Se,["value"]),re=Object.assign({id:"label",text:ve},Gt);return Wu(re)}function tu(Se){var ve=Bs(Se,[]),Gt=Object.assign({id:"keyshape"},ve);return Wu(Gt)}function gc(Se){var ve=Bs(Se,[]),Gt=Object.assign({id:"halo"},ve);return Wu(Gt)}function Bl(Se){return Object.assign({id:"label-background"},Se)}var vl=function(ve,Gt){return Gt==="keyshape"?tu(ve.keyshape||{}):Gt==="halo"?gc(ve.halo||{}):Gt==="label"?Ju(ve.label||{}):Gt==="label-background"?Bl(ve[Gt]||{}):{}},Ls=function(ve,Gt,re){var me={x:(Gt.x+ve.x)/2,y:(Gt.y+ve.y)/2},bn=Gt.x-ve.x,Zn=Gt.y-ve.y,Yt=Math.sqrt(Math.pow(bn,2)+Math.pow(Zn,2)),Ie=me.y-bn*re/Yt||0,Ge=me.x+Zn*re/Yt||0;return{x:Ge,y:Ie}},el=function(ve,Gt){var re,me,bn,Zn=ve.startPoint,Yt=Zn===void 0?{x:0,y:0}:Zn,Ie=ve.endPoint,Ge=Ie===void 0?{x:0,y:0}:Ie,Fe=ve.sourceNode,In=ve.targetNode,ar=Gt.keyshape,ra=ar.type,Ta=ra===void 0?"line":ra,$a=ar.poly,ja=$a===void 0?{distance:0}:$a,Oa=ar.loop,so=Oa===void 0?{}:Oa,Ai=Fe.get("model"),Oi=((re=In)===null||re===void 0?void 0:re.get("model"))||{id:"temp"};if(Ta==="loop"||Ai.id===Oi.id){var hs=((bn=(me=Ai.style)===null||me===void 0?void 0:me.keyshape)===null||bn===void 0?void 0:bn.size)||26,wo=Object.assign({distance:0,dx:8,rx:void 0,ry:void 0},so),ho=wo.distance,Ro=wo.dx,Ys=wo.rx,Ps=wo.ry,As=hs/2,Vs=Math.sqrt(Math.max(Math.pow(As,2)-Math.pow(Ro,2),0)),su=Ys||As*2*.5,xl=Ps||As*2*.6;return[["M",Yt.x-Ro,Yt.y-Vs],["A",su+ho,xl+ho,0,1,1,Yt.x+Ro,Yt.y-Vs]]}if(Ta==="poly"){var Rl=Ls(Yt,Ge,(ja==null?void 0:ja.distance)||0);return[["M",Yt.x,Yt.y],["Q",Rl.x,Rl.y,Ge.x,Ge.y]]}return[["M",Yt.x,Yt.y],["L",Ge.x,Ge.y]]},oc=function(){j.ZP.registerEdge("graphin-line",{draw:function(ve,Gt){var re,me,bn,Zn,Yt,Ie,Ge,Fe=ve.style._theme;this.options=gu(Fe);var In=(0,Rs.deepMix)({},this.options.style,ve.style);ve&&(ve._initialStyle=Object.assign({},In));var ar=ve.startPoint,ra=ar===void 0?{x:0,y:0}:ar,Ta=ve.endPoint,$a=Ta===void 0?{x:0,y:0}:Ta,ja=ve.sourceNode,Oa=ve.targetNode,so=In.label,Ai=In.halo,Oi=In.keyshape,hs=ja.get("model"),wo=((re=Oa)===null||re===void 0?void 0:re.get("model"))||{id:"temp"},ho=((bn=(me=hs.style)===null||me===void 0?void 0:me.keyshape)===null||bn===void 0?void 0:bn.size)||28,Ro=(Oi==null?void 0:Oi.type)==="loop"||hs.id===wo.id,Ys=so.value,Ps=(Oi==null?void 0:Oi.type)==="poly",As=Ls(ra,$a,((Zn=Oi==null?void 0:Oi.poly)===null||Zn===void 0?void 0:Zn.distance)||0),Vs=(Oi==null?void 0:Oi.lineWidth)||1,su=Vs+5,xl=el(ve,In);Gt.addShape("path",{attrs:Object.assign({id:"halo",path:xl,lineWidth:Vs+10,stroke:Ai.stroke||Oi.stroke,strokeOpacity:Ai.strokeOpacity||.4},Ai),draggable:!0,name:"halo",visible:Ai.visible!==!1});var Rl=Gt.addShape("path",{attrs:Object.assign({id:"keyshape",path:xl,endArrow:Ro?void 0:{d:0,path:"M 0,0 L ".concat(su,",").concat(su/2," L ").concat(su,",-").concat(su/2," Z"),fill:Oi.stroke},startArrow:Ro?{d:0,path:"M 0,0 L ".concat(su,",").concat(su/2," L ").concat(su,",-").concat(su/2," Z"),fill:Oi.stroke}:void 0},Oi),draggable:!0,name:"keyshape"});if(Ys){var Ll=so.value,nl=so.fontSize,rl=nl===void 0?8:nl,Ef=so.offset,Sf=Ef===void 0?[0,0]:Ef,Yl=so.background,Cf=Bs(so,["value","fontSize","offset","background"]),T=Boolean(Yl),rt=Js(Sf,2),Kt=rt[0],pe=rt[1],Re=Math.atan(($a.y-ra.y)/($a.x-ra.x)),Je=[(ra.x+$a.x)/2,(ra.y+$a.y)/2];if(Ps&&(Je=[(As.x+Je[0])/2,(As.y+Je[1])/2]),$a.x-ra.x==0&&(Re=Math.PI/2),Ro&&(Re=2*Math.PI),T){var an=(0,Tl.Z)(Ll),wn=an*rl*.6,Mn=rl*1.8,rr={fill:"#fff",width:wn,height:Mn,stroke:Oi.stroke,lineWidth:1,radius:6},We=Object.assign(Object.assign({},rr),Yl),ca=We.fill,ha=We.width,_r=We.height,Va=We.stroke,qa=Bs(We,["fill","width","height","stroke"]),ma=-_r/2+pe;Ro&&(ma=-(_r/2+pe+rl+ho*1+(((Yt=Oi==null?void 0:Oi.loop)===null||Yt===void 0?void 0:Yt.distance)||0)*2));var Mi=Gt.addShape("rect",{attrs:Object.assign({id:"label-background",x:-ha/2+Kt,y:ma,width:ha,height:_r,fill:ca,stroke:Va},qa),draggable:!0,name:"label-background"});Mi.rotate(Re),Mi.translate(Je[0],Je[1])}var zo=pe-rl/2;T&&(zo=pe+rl/2),Ro&&(T?zo=-(pe+rl/2+ho*1+(((Ie=Oi==null?void 0:Oi.loop)===null||Ie===void 0?void 0:Ie.distance)||0)*2):zo=-(pe+rl+ho*1+(((Ge=Oi==null?void 0:Oi.loop)===null||Ge===void 0?void 0:Ge.distance)||0)*2));var _o=Gt.addShape("text",{attrs:Object.assign({id:"label",x:Kt,y:zo,text:Ll,fontSize:rl},Cf),draggable:!0,name:"label"});_o.rotate(Re),_o.translate(Je[0],Je[1])}return Rl},setState:function(ve,Gt,re){var me;if(!!ve){var bn=re.getModel(),Zn=re.getContainer().get("children"),Yt=(0,Rs.deepMix)({},this.options.status,bn.style.status),Ie=re.getModel()._initialStyle,Ge=((me=re._cfg)===null||me===void 0?void 0:me.states)||[];try{Object.keys(Yt).forEach(function(Fe){var In;ve===Fe&&(Gt?Us(Zn,Yt[Fe],vl):(Us(Zn,Object.assign(Object.assign({},Ie),bl({},"label-background",(In=Ie.label)===null||In===void 0?void 0:In.background)),vl),Ge.forEach(function(ar){Us(Zn,Yt[ar],vl)})))})}catch(Fe){console.error(Fe)}}},afterDraw:function(ve,Gt){var re=(0,Rs.deepMix)({},this.options.style,ve.style),me=re.animate,bn=re.keyshape;if(!(!me||!me.type||me.visible===!1)){var Zn=Gt.get("children").find(function(so){return so.get("name")==="keyshape"}),Yt=me.color,Ie=me.type,Ge=me.repeat,Fe=Ge===void 0?!0:Ge,In=me.duration,ar=In===void 0?3e3:In;if(Ie==="circle-running"){var ra=Zn.getPoint(0),Ta=Gt.addShape("circle",{attrs:{x:ra.x,y:ra.y,fill:Yt||bn.stroke,r:bn.lineWidth*1.5+2},name:"circle-shape"});Ta.animate(function(so){var Ai=Zn.getPoint(so);return{x:Ai.x,y:Ai.y}},{repeat:Fe,duration:ar})}if(Ie==="line-dash"){var $a=0,ja=me.lineDash||bn.lineDash||[4,2,1,2];Zn.animate(function(){return $a++,$a>9&&($a=0),{lineDash:ja,lineDashOffset:-$a}},{repeat:Fe,duration:ar})}if(Ie==="line-growth"){var Oa=Zn.getTotalLength();Zn.animate(function(so){var Ai=so*Oa;return{lineDash:[Ai,Oa-Ai]}},{repeat:Fe,duration:ar})}}}})};Eu(),as(),Au(),oc();var Ol=aa.registerFontFamily,Ic=aa},9419:function(ur,ot,$){"use strict";$.d(ot,{$:function(){return tt}});function Y(W,Q,Z){return Q in W?Object.defineProperty(W,Q,{value:Z,enumerable:!0,configurable:!0,writable:!0}):W[Q]=Z,W}var tt=[{type:"graphin-force",options:{},title:"\u6E10\u8FDB\u529B\u5BFC"},{type:"force",title:"D3\u529B\u5BFC",options:{preventOverlap:!0,linkDistance:250,nodeStrength:30,edgeStrength:.1,collideStrength:.8,nodeSize:30,alpha:.3,alphaDecay:.028,alphaMin:.01,forceSimulation:null,clustering:!1}},{type:"concentric",title:"\u540C\u5FC3\u5706\u5E03\u5C40",options:{minNodeSpacing:60,preventOverlap:!0,nodeSize:60}},{type:"grid",options:{},title:"\u7F51\u683C\u5E03\u5C40"},{type:"radial",options:{},title:"\u8F90\u5C04\u5E03\u5C40"},{type:"dagre",title:"\u5C42\u6B21\u5E03\u5C40",options:{}},{type:"circular",options:{},title:"\u73AF\u5F62\u5E03\u5C40"},{type:"gForce",options:{linkDistance:function(){return 200},preventOverlap:!0},title:"G6\u529B\u5BFC"},{type:"mds",options:{},title:"\u964D\u7EF4\u5E03\u5C40"},{type:"random",options:{},title:"\u968F\u673A\u5E03\u5C40"}],j=tt.map(function(W){var Q=W.type,Z=W.options;return Object.assign({type:Q},Z)}).reduce(function(W,Q){return Object.assign(Object.assign({},W),Y({},Q.type,Q))},{});ot.Z=j},81710:function(ur,ot){"use strict";var $=function(){var tt={type:"circle",style:{labelCfg:{position:"top"}},status:{}};return tt};ot.Z=$},46581:function(ur,ot){"use strict";var $={primaryEdgeColor:"#ddd",edgeSize:1,mode:"light"},Y=function(j){var W=Object.assign(Object.assign({},$),j),Q=W.edgeSize,Z=W.primaryEdgeColor,R=W.mode,L={light:{stroke:Z,label:Z,disabled:"#ddd"},dark:{stroke:Z,label:Z,disabled:"#ddd3"}},C=L[R],A={type:"graphin-line",style:{keyshape:{type:"line",lineWidth:Q,stroke:C.stroke,strokeOpacity:1,lineAppendWidth:9,cursor:"pointer"},halo:{visible:!1,cursor:"pointer",strokeOpacity:.4},label:{value:"",position:"top",fill:C.label,fontSize:12,textAlign:"center"},animate:{}},status:{hover:{halo:{visible:!0}},selected:{halo:{visible:!0},keyshape:{lineWidth:2},label:{visible:!0}},active:{halo:{visible:!0},keyshape:{lineWidth:2},label:{visible:!0}},inactive:{halo:{visible:!1},keyshape:{strokeOpacity:.1},label:{visible:!1}},disabled:{halo:{visible:!1},keyshape:{lineWidth:.5,stroke:C.disabled},label:{visible:!1}}}};return A};ot.Z=Y},76575:function(ur,ot){"use strict";var $={primaryColor:"#FF6A00",nodeSize:26,mode:"light"},Y=function(j){var W=Object.assign(Object.assign({},$),j),Q=W.nodeSize,Z=W.primaryColor,R=W.mode,L=12,C={light:{fill:Z,fillOpacity:.1,stroke:Z,strokeOpacity:1,icon:Z,badge:{fill:Z,stroke:Z,font:"#fff"},label:"#000",disabled:"#ddd"},dark:{fill:Z,fillOpacity:.3,stroke:Z,strokeOpacity:1,icon:"#fff",badge:{fill:Z,stroke:Z,font:"#fff"},label:"#fff",disabled:"#ddd3"}},A=C[R],N={type:"graphin-circle",style:{keyshape:{size:Q,fill:A.fill,fillOpacity:A.fillOpacity,stroke:A.stroke,strokeOpacity:A.strokeOpacity,lineWidth:1,opacity:1,type:"circle"},label:{position:"bottom",value:"",fill:A.label,fontSize:L,offset:0,background:void 0,fillOpacity:1},icon:{type:"text",value:"",size:Q/2,fill:A.icon,fillOpacity:1,offset:[0,0]},badges:[],halo:{visible:!1,fillOpacity:.1}},status:{normal:{},selected:{halo:{visible:!0},keyshape:{lineWidth:5}},hover:{halo:{visible:!0}},active:{},inactive:{keyshape:{fillOpacity:.04,strokeOpacity:.04},icon:{fillOpacity:.04},label:{fillOpacity:.04}},disabled:{halo:{visible:!1},keyshape:{fill:A.disabled,stroke:A.disabled},icon:{fill:A.disabled},label:{fill:A.disabled}}}};return N};ot.Z=Y},32096:function(ur,ot){"use strict";var $=function(tt){return Array.from(String(tt)).reduce(function(j,W){return W.charCodeAt(0)>255?j+2:j+1},0)};ot.Z=$},57804:function(ur,ot,$){"use strict";ur=$.hmd(ur);function Y(xn){return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Vr){return typeof Vr}:function(Vr){return Vr&&typeof Symbol=="function"&&Vr.constructor===Symbol&&Vr!==Symbol.prototype?"symbol":typeof Vr},Y(xn)}var tt=200,j="__lodash_hash_undefined__",W=9007199254740991,Q="[object Arguments]",Z="[object Array]",R="[object Boolean]",L="[object Date]",C="[object Error]",A="[object Function]",N="[object GeneratorFunction]",B="[object Map]",O="[object Number]",F="[object Object]",K="[object Promise]",nt="[object RegExp]",P="[object Set]",k="[object String]",yt="[object Symbol]",st="[object WeakMap]",lt="[object ArrayBuffer]",ht="[object DataView]",mt="[object Float32Array]",wt="[object Float64Array]",ut="[object Int8Array]",pt="[object Int16Array]",Nt="[object Int32Array]",Ut="[object Uint8Array]",ue="[object Uint8ClampedArray]",se="[object Uint16Array]",Le="[object Uint32Array]",Ne=/[\\^$.*+?()[\]{}|]/g,we=/\w*$/,At=/^\[object .+?Constructor\]$/,Qt=/^(?:0|[1-9]\d*)$/,de={};de[Q]=de[Z]=de[lt]=de[ht]=de[R]=de[L]=de[mt]=de[wt]=de[ut]=de[pt]=de[Nt]=de[B]=de[O]=de[F]=de[nt]=de[P]=de[k]=de[yt]=de[Ut]=de[ue]=de[se]=de[Le]=!0,de[C]=de[A]=de[st]=!1;var rn=(typeof $.g=="undefined"?"undefined":Y($.g))=="object"&&$.g&&$.g.Object===Object&&$.g,Ee=(typeof self=="undefined"?"undefined":Y(self))=="object"&&self&&self.Object===Object&&self,ce=rn||Ee||Function("return this")(),Oe=(typeof exports=="undefined"?"undefined":Y(exports))=="object"&&exports&&!exports.nodeType&&exports,Ze=Oe&&Y(ur)=="object"&&ur&&!ur.nodeType&&ur,fe=Ze&&Ze.exports===Oe;function Ae(xn,Vr){return xn.set(Vr[0],Vr[1]),xn}function Ye(xn,Vr){return xn.add(Vr),xn}function ge(xn,Vr){for(var pa=-1,Fa=xn?xn.length:0;++pa<Fa&&Vr(xn[pa],pa,xn)!==!1;);return xn}function Be(xn,Vr){for(var pa=-1,Fa=Vr.length,Vi=xn.length;++pa<Fa;)xn[Vi+pa]=Vr[pa];return xn}function te(xn,Vr,pa,Fa){var Vi=-1,Ao=xn?xn.length:0;for(Fa&&Ao&&(pa=xn[++Vi]);++Vi<Ao;)pa=Vr(pa,xn[Vi],Vi,xn);return pa}function ke(xn,Vr){for(var pa=-1,Fa=Array(xn);++pa<xn;)Fa[pa]=Vr(pa);return Fa}function Ve(xn,Vr){return xn==null?void 0:xn[Vr]}function ee(xn){var Vr=!1;if(xn!=null&&typeof xn.toString!="function")try{Vr=!!(xn+"")}catch(pa){}return Vr}function Ft(xn){var Vr=-1,pa=Array(xn.size);return xn.forEach(function(Fa,Vi){pa[++Vr]=[Vi,Fa]}),pa}function bt(xn,Vr){return function(pa){return xn(Vr(pa))}}function Me(xn){var Vr=-1,pa=Array(xn.size);return xn.forEach(function(Fa){pa[++Vr]=Fa}),pa}var en=Array.prototype,fn=Function.prototype,Rt=Object.prototype,Xn=ce["__core-js_shared__"],Bn=function(){var xn=/[^.]+$/.exec(Xn&&Xn.keys&&Xn.keys.IE_PROTO||"");return xn?"Symbol(src)_1."+xn:""}(),xr=fn.toString,dr=Rt.hasOwnProperty,Ur=Rt.toString,fa=RegExp("^"+xr.call(dr).replace(Ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ea=fe?ce.Buffer:void 0,aa=ce.Symbol,Da=ce.Uint8Array,Lr=bt(Object.getPrototypeOf,Object),_n=Object.create,sr=Rt.propertyIsEnumerable,Pn=en.splice,tr=Object.getOwnPropertySymbols,zn=Ea?Ea.isBuffer:void 0,Wr=bt(Object.keys,Object),Yr=Do(ce,"DataView"),nr=Do(ce,"Map"),wr=Do(ce,"Promise"),Sr=Do(ce,"Set"),pr=Do(ce,"WeakMap"),qr=Do(Object,"create"),ua=Wi(Yr),$r=Wi(nr),ba=Wi(wr),gt=Wi(Sr),Dn=Wi(pr),un=aa?aa.prototype:void 0,Lt=un?un.valueOf:void 0;function Ot(xn){var Vr=-1,pa=xn?xn.length:0;for(this.clear();++Vr<pa;){var Fa=xn[Vr];this.set(Fa[0],Fa[1])}}function it(){this.__data__=qr?qr(null):{}}function H(xn){return this.has(xn)&&delete this.__data__[xn]}function X(xn){var Vr=this.__data__;if(qr){var pa=Vr[xn];return pa===j?void 0:pa}return dr.call(Vr,xn)?Vr[xn]:void 0}function xt(xn){var Vr=this.__data__;return qr?Vr[xn]!==void 0:dr.call(Vr,xn)}function zt(xn,Vr){var pa=this.__data__;return pa[xn]=qr&&Vr===void 0?j:Vr,this}Ot.prototype.clear=it,Ot.prototype.delete=H,Ot.prototype.get=X,Ot.prototype.has=xt,Ot.prototype.set=zt;function Vt(xn){var Vr=-1,pa=xn?xn.length:0;for(this.clear();++Vr<pa;){var Fa=xn[Vr];this.set(Fa[0],Fa[1])}}function Xt(){this.__data__=[]}function ne(xn){var Vr=this.__data__,pa=Ra(Vr,xn);if(pa<0)return!1;var Fa=Vr.length-1;return pa==Fa?Vr.pop():Pn.call(Vr,pa,1),!0}function on(xn){var Vr=this.__data__,pa=Ra(Vr,xn);return pa<0?void 0:Vr[pa][1]}function tn(xn){return Ra(this.__data__,xn)>-1}function He(xn,Vr){var pa=this.__data__,Fa=Ra(pa,xn);return Fa<0?pa.push([xn,Vr]):pa[Fa][1]=Vr,this}Vt.prototype.clear=Xt,Vt.prototype.delete=ne,Vt.prototype.get=on,Vt.prototype.has=tn,Vt.prototype.set=He;function Qn(xn){var Vr=-1,pa=xn?xn.length:0;for(this.clear();++Vr<pa;){var Fa=xn[Vr];this.set(Fa[0],Fa[1])}}function Ln(){this.__data__={hash:new Ot,map:new(nr||Vt),string:new Ot}}function Qr(xn){return ms(this,xn).delete(xn)}function Ia(xn){return ms(this,xn).get(xn)}function Jn(xn){return ms(this,xn).has(xn)}function Ar(xn,Vr){return ms(this,xn).set(xn,Vr),this}Qn.prototype.clear=Ln,Qn.prototype.delete=Qr,Qn.prototype.get=Ia,Qn.prototype.has=Jn,Qn.prototype.set=Ar;function na(xn){this.__data__=new Vt(xn)}function za(){this.__data__=new Vt}function da(xn){return this.__data__.delete(xn)}function Ti(xn){return this.__data__.get(xn)}function ki(xn){return this.__data__.has(xn)}function vi(xn,Vr){var pa=this.__data__;if(pa instanceof Vt){var Fa=pa.__data__;if(!nr||Fa.length<tt-1)return Fa.push([xn,Vr]),this;pa=this.__data__=new Qn(Fa)}return pa.set(xn,Vr),this}na.prototype.clear=za,na.prototype.delete=da,na.prototype.get=Ti,na.prototype.has=ki,na.prototype.set=vi;function ii(xn,Vr){var pa=Du(xn)||Us(xn)?ke(xn.length,String):[],Fa=pa.length,Vi=!!Fa;for(var Ao in xn)(Vr||dr.call(xn,Ao))&&!(Vi&&(Ao=="length"||Su(Ao,Fa)))&&pa.push(Ao);return pa}function Di(xn,Vr,pa){var Fa=xn[Vr];(!(dr.call(xn,Vr)&&is(Fa,pa))||pa===void 0&&!(Vr in xn))&&(xn[Vr]=pa)}function Ra(xn,Vr){for(var pa=xn.length;pa--;)if(is(xn[pa][0],Vr))return pa;return-1}function ln(xn,Vr){return xn&&Zi(Vr,Ss(Vr),xn)}function De(xn,Vr,pa,Fa,Vi,Ao,ao){var So;if(Fa&&(So=Ao?Fa(xn,Vi,Ao,ao):Fa(xn)),So!==void 0)return So;if(!os(xn))return xn;var Ts=Du(xn);if(Ts){if(So=Eu(xn),!Vr)return Wo(xn,So)}else{var fo=Zs(xn),ou=fo==A||fo==N;if(ji(xn))return xa(xn,Vr);if(fo==F||fo==Q||ou&&!Ao){if(ee(xn))return Ao?xn:{};if(So=as(ou?{}:xn),!Vr)return bi(xn,ln(So,xn))}else{if(!de[fo])return Ao?xn:{};So=Rs(xn,fo,De,Vr)}}ao||(ao=new na);var Cs=ao.get(xn);if(Cs)return Cs;if(ao.set(xn,So),!Ts)var Au=pa?gi(xn):Ss(xn);return ge(Au||xn,function(Tl,bl){Au&&(bl=Tl,Tl=xn[bl]),Di(So,bl,De(Tl,Vr,pa,Fa,bl,xn,ao))}),So}function dn(xn){return os(xn)?_n(xn):{}}function Wn(xn,Vr,pa){var Fa=Vr(xn);return Du(xn)?Fa:Be(Fa,pa(xn))}function Gn(xn){return Ur.call(xn)}function Kn(xn){if(!os(xn)||Is(xn))return!1;var Vr=Bi(xn)||ee(xn)?fa:At;return Vr.test(Wi(xn))}function Rr(xn){if(!Zo(xn))return Wr(xn);var Vr=[];for(var pa in Object(xn))dr.call(xn,pa)&&pa!="constructor"&&Vr.push(pa);return Vr}function xa(xn,Vr){if(Vr)return xn.slice();var pa=new xn.constructor(xn.length);return xn.copy(pa),pa}function La(xn){var Vr=new xn.constructor(xn.byteLength);return new Da(Vr).set(new Da(xn)),Vr}function ui(xn,Vr){var pa=Vr?La(xn.buffer):xn.buffer;return new xn.constructor(pa,xn.byteOffset,xn.byteLength)}function Fi(xn,Vr,pa){var Fa=Vr?pa(Ft(xn),!0):Ft(xn);return te(Fa,Ae,new xn.constructor)}function Ki(xn){var Vr=new xn.constructor(xn.source,we.exec(xn));return Vr.lastIndex=xn.lastIndex,Vr}function xo(xn,Vr,pa){var Fa=Vr?pa(Me(xn),!0):Me(xn);return te(Fa,Ye,new xn.constructor)}function vo(xn){return Lt?Object(Lt.call(xn)):{}}function es(xn,Vr){var pa=Vr?La(xn.buffer):xn.buffer;return new xn.constructor(pa,xn.byteOffset,xn.length)}function Wo(xn,Vr){var pa=-1,Fa=xn.length;for(Vr||(Vr=Array(Fa));++pa<Fa;)Vr[pa]=xn[pa];return Vr}function Zi(xn,Vr,pa,Fa){pa||(pa={});for(var Vi=-1,Ao=Vr.length;++Vi<Ao;){var ao=Vr[Vi],So=Fa?Fa(pa[ao],xn[ao],ao,pa,xn):void 0;Di(pa,ao,So===void 0?xn[ao]:So)}return pa}function bi(xn,Vr){return Zi(xn,To(xn),Vr)}function gi(xn){return Wn(xn,Ss,To)}function ms(xn,Vr){var pa=xn.__data__;return fu(Vr)?pa[typeof Vr=="string"?"string":"hash"]:pa.map}function Do(xn,Vr){var pa=Ve(xn,Vr);return Kn(pa)?pa:void 0}var To=tr?bt(tr,Object):Qs,Zs=Gn;(Yr&&Zs(new Yr(new ArrayBuffer(1)))!=ht||nr&&Zs(new nr)!=B||wr&&Zs(wr.resolve())!=K||Sr&&Zs(new Sr)!=P||pr&&Zs(new pr)!=st)&&(Zs=function(Vr){var pa=Ur.call(Vr),Fa=pa==F?Vr.constructor:void 0,Vi=Fa?Wi(Fa):void 0;if(Vi)switch(Vi){case ua:return ht;case $r:return B;case ba:return K;case gt:return P;case Dn:return st}return pa});function Eu(xn){var Vr=xn.length,pa=xn.constructor(Vr);return Vr&&typeof xn[0]=="string"&&dr.call(xn,"index")&&(pa.index=xn.index,pa.input=xn.input),pa}function as(xn){return typeof xn.constructor=="function"&&!Zo(xn)?dn(Lr(xn)):{}}function Rs(xn,Vr,pa,Fa){var Vi=xn.constructor;switch(Vr){case lt:return La(xn);case R:case L:return new Vi(+xn);case ht:return ui(xn,Fa);case mt:case wt:case ut:case pt:case Nt:case Ut:case ue:case se:case Le:return es(xn,Fa);case B:return Fi(xn,Fa,pa);case O:case k:return new Vi(xn);case nt:return Ki(xn);case P:return xo(xn,Fa,pa);case yt:return vo(xn)}}function Su(xn,Vr){return Vr=Vr==null?W:Vr,!!Vr&&(typeof xn=="number"||Qt.test(xn))&&xn>-1&&xn%1==0&&xn<Vr}function fu(xn){var Vr=Y(xn);return Vr=="string"||Vr=="number"||Vr=="symbol"||Vr=="boolean"?xn!=="__proto__":xn===null}function Is(xn){return!!Bn&&Bn in xn}function Zo(xn){var Vr=xn&&xn.constructor,pa=typeof Vr=="function"&&Vr.prototype||Rt;return xn===pa}function Wi(xn){if(xn!=null){try{return xr.call(xn)}catch(Vr){}try{return xn+""}catch(Vr){}}return""}function ys(xn){return De(xn,!0,!0)}function is(xn,Vr){return xn===Vr||xn!==xn&&Vr!==Vr}function Us(xn){return Cu(xn)&&dr.call(xn,"callee")&&(!sr.call(xn,"callee")||Ur.call(xn)==Q)}var Du=Array.isArray;function qs(xn){return xn!=null&&Ms(xn.length)&&!Bi(xn)}function Cu(xn){return Ws(xn)&&qs(xn)}var ji=zn||Qu;function Bi(xn){var Vr=os(xn)?Ur.call(xn):"";return Vr==A||Vr==N}function Ms(xn){return typeof xn=="number"&&xn>-1&&xn%1==0&&xn<=W}function os(xn){var Vr=Y(xn);return!!xn&&(Vr=="object"||Vr=="function")}function Ws(xn){return!!xn&&Y(xn)=="object"}function Ss(xn){return qs(xn)?ii(xn):Rr(xn)}function Qs(){return[]}function Qu(){return!1}ot.Z=ys},43054:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return sr}});var Y=$(23044),tt=$(9419),j=$(81710),W=$(46581),Q=$(76575),Z=function(tr,zn){return tr.reduce(function(Wr,Yr){return Wr.some(function(nr){return zn(Yr,nr)})||Wr.push(Yr),Wr},[])},R=$(32096),L=$(57804),C=!0,A=function(tr){return Math.floor(Math.random()*tr)},N=function(){var tr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,zn=A(255),Wr=A(255),Yr=A(255),nr="rgba(".concat(zn,",").concat(Wr,",").concat(Yr,",").concat(tr,")");return nr},B={},O=function(tr){B[tr]||(B[tr]=N());var zn=B[tr];return function(){if(C,!1){var Wr;for(var Yr,nr,wr;wr<Yr;wr++);}}},F=O,K=function(tr){return tr.charAt(0)==="#"?tr.slice(1):tr},nt=function(tr){var zn=tr.length===3||tr.length===4,Wr=zn?"".concat(tr.slice(0,1)).concat(tr.slice(0,1)):tr.slice(0,2),Yr=zn?"".concat(tr.slice(1,2)).concat(tr.slice(1,2)):tr.slice(2,4),nr=zn?"".concat(tr.slice(2,3)).concat(tr.slice(2,3)):tr.slice(4,6),wr=(zn?"".concat(tr.slice(3,4)).concat(tr.slice(3,4)):tr.slice(6,8))||"ff";return{r:Wr,g:Yr,b:nr,a:wr}},P=function(tr){return parseInt(tr,16)},k=function(tr){var zn=tr.r,Wr=tr.g,Yr=tr.b,nr=tr.a;return{r:P(zn),g:P(Wr),b:P(Yr),a:+(P(nr)/255).toFixed(2)}},yt=function(tr){return!isNaN(parseFloat(String(tr)))&&isFinite(Number(tr))},st=function(tr,zn){var Wr=tr.r,Yr=tr.g,nr=tr.b,wr=tr.a,Sr=yt(zn)?zn:wr;return"rgba(".concat(Wr,", ").concat(Yr,", ").concat(nr,", ").concat(Sr,")")},lt=function(tr,zn){var Wr=K(tr),Yr=nt(Wr),nr=k(Yr);return st(nr,zn)},ht=function(tr){var zn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Wr=K(tr),Yr=nt(Wr),nr=k(Yr),wr=nr.r,Sr=nr.g,pr=nr.b,qr=wr.toString(16),ua=Sr.toString(16),$r=pr.toString(16),ba=Math.round(Number(zn)*255).toString(16);return qr.length===1&&(qr="0".concat(qr)),ua.length===1&&(ua="0".concat(ua)),$r.length===1&&($r="0".concat($r)),ba.length===1&&(ba="0".concat(ba)),"#".concat(qr).concat(ua).concat($r).concat(ba)},mt=lt;function wt(Pn){return Ut(Pn)||Nt(Pn)||pt(Pn)||ut()}function ut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pt(Pn,tr){if(!!Pn){if(typeof Pn=="string")return ue(Pn,tr);var zn=Object.prototype.toString.call(Pn).slice(8,-1);if(zn==="Object"&&Pn.constructor&&(zn=Pn.constructor.name),zn==="Map"||zn==="Set")return Array.from(Pn);if(zn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(zn))return ue(Pn,tr)}}function Nt(Pn){if(typeof Symbol!="undefined"&&Pn[Symbol.iterator]!=null||Pn["@@iterator"]!=null)return Array.from(Pn)}function Ut(Pn){if(Array.isArray(Pn))return ue(Pn)}function ue(Pn,tr){(tr==null||tr>Pn.length)&&(tr=Pn.length);for(var zn=0,Wr=new Array(tr);zn<tr;zn++)Wr[zn]=Pn[zn];return Wr}function se(Pn,tr){for(var zn=0;zn<tr.length;zn++){var Wr=tr[zn];Wr.enumerable=Wr.enumerable||!1,Wr.configurable=!0,"value"in Wr&&(Wr.writable=!0),Object.defineProperty(Pn,Wr.key,Wr)}}function Le(Pn,tr,zn){return tr&&se(Pn.prototype,tr),zn&&se(Pn,zn),Object.defineProperty(Pn,"prototype",{writable:!1}),Pn}function Ne(Pn,tr){if(!(Pn instanceof tr))throw new TypeError("Cannot call a class as a function")}var we=Le(function Pn(tr){var zn=this;Ne(this,Pn),this.nodeIds=[],this.bfs=function(Wr){var Yr;if(!!zn.root){var nr=[];for(nr.push(zn.root);nr.length;){var wr=nr.shift();if(Wr(wr))return wr;((Yr=wr==null?void 0:wr.children)===null||Yr===void 0?void 0:Yr.length)&&nr.push.apply(nr,wt(wr.children))}}},this.getRoot=function(){return zn.root},this.getNode=function(Wr){var Yr=zn.bfs(function(nr){return nr.id===Wr});return Yr},this.addRoot=function(Wr,Yr){zn.root={id:Wr,children:[]},zn.nodeIds.push(Wr)},this.addNode=function(Wr){var Yr=Wr.parentId,nr=Wr.id,wr=Wr.data;if(!zn.root){zn.addRoot(nr,wr);return}var Sr;if(Yr)Sr=zn.getNode(Yr);else{var pr=Math.floor(Math.random()*zn.nodeIds.length);Sr=zn.getNode(zn.nodeIds[pr])}if(!Sr){console.error("Parent node doesn't exist!");return}zn.nodeIds.push(nr),Sr.children.push({id:nr,parent:Sr,children:[]})},tr&&(this.root=tr)}),At=function Pn(tr,zn){zn(tr),tr.children&&tr.children.length>0&&tr.children.forEach(function(Wr){Pn(Wr,zn)})},Qt=At;function de(Pn){return Oe(Pn)||ce(Pn)||Ee(Pn)||rn()}function rn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ee(Pn,tr){if(!!Pn){if(typeof Pn=="string")return Ze(Pn,tr);var zn=Object.prototype.toString.call(Pn).slice(8,-1);if(zn==="Object"&&Pn.constructor&&(zn=Pn.constructor.name),zn==="Map"||zn==="Set")return Array.from(Pn);if(zn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(zn))return Ze(Pn,tr)}}function ce(Pn){if(typeof Symbol!="undefined"&&Pn[Symbol.iterator]!=null||Pn["@@iterator"]!=null)return Array.from(Pn)}function Oe(Pn){if(Array.isArray(Pn))return Ze(Pn)}function Ze(Pn,tr){(tr==null||tr>Pn.length)&&(tr=Pn.length);for(var zn=0,Wr=new Array(tr);zn<tr;zn++)Wr[zn]=Pn[zn];return Wr}function fe(Pn,tr){for(var zn=0;zn<tr.length;zn++){var Wr=tr[zn];Wr.enumerable=Wr.enumerable||!1,Wr.configurable=!0,"value"in Wr&&(Wr.writable=!0),Object.defineProperty(Pn,Wr.key,Wr)}}function Ae(Pn,tr,zn){return tr&&fe(Pn.prototype,tr),zn&&fe(Pn,zn),Object.defineProperty(Pn,"prototype",{writable:!1}),Pn}function Ye(Pn,tr){if(!(Pn instanceof tr))throw new TypeError("Cannot call a class as a function")}var ge={nodeCount:10,nodeType:"company"},Be=Ae(function Pn(tr){var zn=this;Ye(this,Pn),this.initNodes=function(){var Wr=zn.options,Yr=Wr.nodeCount,nr=Wr.nodeType,wr=Array.from({length:Yr});zn.nodes=wr.map(function(qr,ua){return{id:"node-".concat(ua),label:"node-".concat(ua),type:nr}});for(var Sr=0;Sr<Yr;Sr=Sr+1)for(var pr=0;pr<Yr-1;pr=pr+1)zn.edges.push({source:"node-".concat(Sr),target:"node-".concat(pr)});zn.nodeIds=zn.nodes.map(function(qr){return qr.id})},this.expand=function(Wr){return zn.edges=[],zn.nodes=[],Wr.forEach(function(Yr){for(var nr=0;nr<zn.options.nodeCount;nr+=1)zn.nodes.push({id:"".concat(Yr.id,"-").concat(nr),type:Yr.type}),zn.edges.push({source:"".concat(Yr.id,"-").concat(nr),target:Yr.id})}),zn},this.type=function(Wr){return zn.nodes=zn.nodes.map(function(Yr){return Object.assign(Object.assign({},Yr),{type:Wr})}),zn},this.circle=function(){var Wr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Yr=Wr;return zn.nodeIds.indexOf(Yr)===-1&&(Yr="node-0"),zn.edges=zn.edges.filter(function(nr){return nr.source===Yr||nr.target===Yr}),zn},this.random=function(){var Wr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.5,Yr=zn.options.nodeCount,nr=parseInt(String(Yr*Wr)),wr=zn.nodeIds.sort(function(){return Math.random()-.5}).slice(0,nr);return zn.edges=zn.edges.filter(function(Sr){return wr.indexOf(Sr.target)!==-1}),zn.edges=zn.edges.sort(function(){return Math.random()-.5}).slice(0,nr),zn},this.tree=function(){zn.edges=[],zn.treeData=new we;var Wr=zn.nodeIds[0];return zn.nodeIds.forEach(function(Yr){zn.treeData.addNode({id:Yr,style:{label:{value:Yr}}})}),zn.treeData.bfs(function(Yr){var nr;return Yr.id!==Wr&&zn.edges.push({source:(nr=Yr==null?void 0:Yr.parent)===null||nr===void 0?void 0:nr.id,target:Yr.id,properties:[]}),!1}),zn},this.value=function(){return{nodes:zn.nodes,edges:zn.edges}},this.combos=function(Wr){var Yr=new Set;return zn.nodes=zn.nodes.map(function(nr,wr){var Sr=Math.ceil((wr+1)/Wr),pr="combo-".concat(Sr);return Yr.add(pr),Object.assign(Object.assign({},nr),{comboId:pr})}),zn.combosData=de(Yr).map(function(nr){return{id:nr,label:nr}}),zn},this.graphin=function(){return{nodes:zn.nodes.map(function(Wr){return Object.assign(Object.assign({},Wr),{id:Wr.id,type:"graphin-circle",comboId:Wr.comboId,style:{label:{value:"".concat(Wr.id)}}})}),edges:zn.edges.map(function(Wr){return{source:Wr.source,target:Wr.target}}),combos:zn.combosData}},this.graphinTree=function(){var Wr=zn.treeData.getRoot();return Qt(Wr,function(Yr){delete Yr.parent}),Wr},this.options=ge,this.options.nodeCount=tr,this.nodes=[],this.edges=[],this.nodeIds=[],this.treeData=new we,this.initNodes()}),te=function(tr){return new Be(tr)},ke=te;function Ve(Pn){return Pn%2==0}function ee(Pn){return!Ve(Pn)}var Ft=30,bt=10,Me=1,en=function(tr){var zn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{poly:Ft,loop:bt,loopLabelPosition:Me},Wr=zn.poly,Yr=Wr===void 0?Ft:Wr,nr=zn.loop,wr=nr===void 0?bt:nr,Sr=zn.loopLabelPosition,pr=Sr===void 0?Me:Sr,qr={};tr.forEach(function(ba,gt){var Dn=Object.assign({},ba),un=Dn.source,Lt=Dn.target,Ot="".concat(un,"-").concat(Lt);Dn.id=Dn.id||"".concat(un,"-").concat(Lt,"-").concat(gt);var it="".concat(Lt,"-").concat(un);qr[Ot]?qr[Ot].push(Dn):qr[it]?(Dn.revert=!0,qr[it].push(Dn)):qr[Ot]=[Dn]});var ua=Object.values(qr),$r=[];return ua.forEach(function(ba){if(ba.length>1){var gt=Ve(ba.length);ba.forEach(function(Dn,un){var Lt,Ot=Dn.source,it=Dn.target,H=Ot===it,X=un,xt;if(gt){var zt=Math.ceil((X+1)/2);xt=Yr*zt}else{var Vt=ee(X)?X+1:X,Xt=Math.ceil(Vt/2);xt=Yr*Xt}var ne=Ve(X)?xt:-xt;Dn.revert&&(ne=-ne,delete Dn.revert);var on;if(H){var tn=X*wr;if(on={type:"loop",loop:{distance:tn}},(Lt=Dn.style)===null||Lt===void 0?void 0:Lt.label){var He=0,Qn=-(Ft*pr+tn*2);Dn.style.label.offset=[He,Qn]}}else on={type:"poly",poly:{distance:ne}};(0,Y.deepMix)(Dn,{style:{keyshape:on}}),Dn.isMultiple=!0,$r.push(Dn)})}else $r.push(ba[0])}),$r},fn=en;function Rt(Pn){return dr(Pn)||xr(Pn)||Bn(Pn)||Xn()}function Xn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bn(Pn,tr){if(!!Pn){if(typeof Pn=="string")return Ur(Pn,tr);var zn=Object.prototype.toString.call(Pn).slice(8,-1);if(zn==="Object"&&Pn.constructor&&(zn=Pn.constructor.name),zn==="Map"||zn==="Set")return Array.from(Pn);if(zn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(zn))return Ur(Pn,tr)}}function xr(Pn){if(typeof Symbol!="undefined"&&Pn[Symbol.iterator]!=null||Pn["@@iterator"]!=null)return Array.from(Pn)}function dr(Pn){if(Array.isArray(Pn))return Ur(Pn)}function Ur(Pn,tr){(tr==null||tr>Pn.length)&&(tr=Pn.length);for(var zn=0,Wr=new Array(tr);zn<tr;zn++)Wr[zn]=Pn[zn];return Wr}var fa=function(tr,zn){var Wr=zn.split("."),Yr=Wr.reduce(function(nr,wr,Sr,pr){var qr=nr[wr];return!qr&&Sr!==pr.length-1?{}:qr},tr);return Yr},Ea=function(tr,zn){var Wr=new Map;return tr.forEach(function(Yr){var nr=fa(Yr,zn),wr=Wr.get(nr);wr?Wr.set(nr,[].concat(Rt(wr),[Yr])):Wr.set(nr,[Yr])}),Wr},aa=function(tr,zn){var Wr=!0,Yr=Object.keys(tr),nr=Object.keys(zn);if(Yr.length!==nr.length)return!1;for(var wr=0;wr<Yr.length;wr++){var Sr=Yr[wr];if(tr[Sr]!==zn[Sr]){Wr=!1;break}}return Wr},Da=aa,Lr=function(){function tr(){return((1+Math.random())*65536|0).toString(16).substring(1)}return"".concat(tr()+tr(),"-").concat(tr(),"-").concat(tr(),"-").concat(tr(),"-").concat(tr()).concat(tr()).concat(tr())},_n=Lr,sr={hexToRgba:mt,debug:F,mock:ke,shallowEqual:Da,hexToRgbaToHex:ht,getNodeStyleByTheme:Q.Z,getEdgeStyleByTheme:W.Z,getComboStyleByTheme:j.Z,deepMix:Y.deepMix,cloneDeep:L.Z,uuid:_n,walk:Qt,processEdges:fn,calcByteLength:R.Z,layouts:tt.$,uniqBy:Z,getEnumDataMap:Ea,getEnumValue:fa}},69787:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{Graph:function(){return mt},GraphWithEvent:function(){return rn},algorithm:function(){return Y},comparision:function(){return j},essence:function(){return tt},generate:function(){return W}});var Y={};$.r(Y),$.d(Y,{components:function(){return ge},dfs:function(){return ke},dijkstra:function(){return Bn},dijkstraAll:function(){return dr},findCycles:function(){return aa},floydWarshall:function(){return zt},isAcyclic:function(){return Dn},postorder:function(){return Lt},preorder:function(){return it},prim:function(){return Ae},tarjan:function(){return fa},topsort:function(){return ba}});var tt={};$.r(tt),$.d(tt,{hasSelfLoop:function(){return ii},isGraph:function(){return Ti},isNullGraph:function(){return vi},isSimpleGraph:function(){return ki}});var j={};$.r(j),$.d(j,{containAllSameEdges:function(){return Qn},containAllSameNodes:function(){return He},containSameEdges:function(){return Xt},containSameNodes:function(){return Vt},getSameEdges:function(){return on},getSameNodes:function(){return ne},isGraphComplement:function(){return Di},isGraphContainsAnother:function(){return Qr},isGraphOptionSame:function(){return tn},isGraphSame:function(){return Ln}});var W={};$.r(W),$.d(W,{getGraphComplement:function(){return Ra}});var Q;(function(ln){ln.DEFAULT_EDGE_NAME="\0",ln.GRAPH_NODE="\0",ln.EDGE_KEY_DELIM=""})(Q||(Q={}));function Z(ln,De){var dn=ln.get(De)||0;ln.set(De,dn+1)}function R(ln,De){var dn=ln.get(De);dn!==void 0&&(dn=dn-1,dn>0?ln.set(De,dn):ln.delete(De))}function L(ln,De,dn,Wn){var Gn=String(De),Kn=String(dn);if(!ln&&Gn>Kn){var Rr=Gn;Gn=Kn,Kn=Rr}return Gn+Q.EDGE_KEY_DELIM+Kn+Q.EDGE_KEY_DELIM+(Wn===void 0?Q.DEFAULT_EDGE_NAME:Wn)}function C(ln,De,dn,Wn){var Gn=String(De),Kn=String(dn),Rr={v:De,w:dn};if(!ln&&Gn>Kn){var xa=Rr.v;Rr.v=Rr.w,Rr.w=xa}return Wn!==void 0&&(Rr.name=Wn),Rr}function A(ln,De){return L(ln,De.v,De.w,De.name)}function N(ln){return typeof ln=="function"}var B=function(De){return De.nodes().map(function(dn){var Wn=De.node(dn),Gn=De.parent(dn),Kn={id:dn,value:Wn,parent:Gn};return Kn.value===void 0&&delete Kn.value,Kn.parent===void 0&&delete Kn.parent,Kn})},O=function(De){return De.edges().map(function(dn){var Wn=De.edge(dn),Gn={v:dn.v,w:dn.w,value:Wn,name:dn.name};return Gn.name===void 0&&delete Gn.name,Gn.value===void 0&&delete Gn.value,Gn})},F=function(De){var dn={options:{directed:De.isDirected(),multigraph:De.isMultigraph(),compound:De.isCompound()},nodes:B(De),edges:O(De),value:De.graph()};return dn.value===void 0&&delete dn.value,dn},K=function(De){var dn=new mt(De.options);return De.value!==void 0&&dn.setGraph(De.value),De.nodes.forEach(function(Wn){dn.setNode(Wn.id,Wn.value),Wn.parent&&dn.setParent(Wn.id,Wn.parent)}),De.edges.forEach(function(Wn){dn.setEdge(Wn.v,Wn.w,Wn.value,Wn.name)}),dn};function nt(ln,De){var dn=Object.keys(ln);if(Object.getOwnPropertySymbols){var Wn=Object.getOwnPropertySymbols(ln);De&&(Wn=Wn.filter(function(Gn){return Object.getOwnPropertyDescriptor(ln,Gn).enumerable})),dn.push.apply(dn,Wn)}return dn}function P(ln){for(var De=1;De<arguments.length;De++){var dn=arguments[De]!=null?arguments[De]:{};De%2?nt(Object(dn),!0).forEach(function(Wn){k(ln,Wn,dn[Wn])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ln,Object.getOwnPropertyDescriptors(dn)):nt(Object(dn)).forEach(function(Wn){Object.defineProperty(ln,Wn,Object.getOwnPropertyDescriptor(dn,Wn))})}return ln}function k(ln,De,dn){return De in ln?Object.defineProperty(ln,De,{value:dn,enumerable:!0,configurable:!0,writable:!0}):ln[De]=dn,ln}function yt(ln,De){if(!(ln instanceof De))throw new TypeError("Cannot call a class as a function")}function st(ln,De){for(var dn=0;dn<De.length;dn++){var Wn=De[dn];Wn.enumerable=Wn.enumerable||!1,Wn.configurable=!0,"value"in Wn&&(Wn.writable=!0),Object.defineProperty(ln,Wn.key,Wn)}}function lt(ln,De,dn){return De&&st(ln.prototype,De),dn&&st(ln,dn),Object.defineProperty(ln,"prototype",{writable:!1}),ln}var ht={compound:!1,multigraph:!1,directed:!0},mt=function(){function ln(){var De=this,dn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};yt(this,ln),this.directed=!0,this.multigraph=!1,this.compound=!1,this.GRAPH_NODE=Q.GRAPH_NODE,this.label=void 0,this.nodeCountNum=0,this.edgeCountNum=0,this.defaultNodeLabelFn=function(){},this.defaultEdgeLabelFn=function(){},this.parentMap=void 0,this.childrenMap=void 0,this.nodesLabelMap=new Map,this.inEdgesMap=new Map,this.outEdgesMap=new Map,this.predecessorsMap=new Map,this.successorsMap=new Map,this.edgesMap=new Map,this.edgesLabelsMap=new Map,this.isDirected=function(){return De.directed},this.isMultigraph=function(){return De.multigraph},this.isCompound=function(){return De.compound},this.setGraph=function(Gn){return De.label=Gn,De},this.graph=function(){return De.label},this.setDefaultNodeLabel=function(Gn){return N(Gn)?De.defaultNodeLabelFn=Gn:De.defaultNodeLabelFn=function(){return Gn},De},this.nodeCount=function(){return De.nodeCountNum},this.node=function(Gn){return De.nodesLabelMap.get(Gn)},this.nodes=function(){return Array.from(De.nodesLabelMap.keys())},this.sources=function(){return De.nodes().filter(function(Gn){var Kn;return!((Kn=De.inEdgesMap.get(Gn))===null||Kn===void 0?void 0:Kn.size)})},this.sinks=function(){return De.nodes().filter(function(Gn){var Kn;return!((Kn=De.outEdgesMap.get(Gn))===null||Kn===void 0?void 0:Kn.size)})},this.setNodes=function(Gn,Kn){return Gn.map(function(Rr){return De.setNode(Rr,Kn)}),De},this.hasNode=function(Gn){return De.nodesLabelMap.has(Gn)},this.checkCompound=function(){if(!De.isCompound())throw new Error("Cannot construct parent-children relations in a non-compound graph")},this.parent=function(Gn){if(De.isCompound()){var Kn,Rr=(Kn=De.parentMap)===null||Kn===void 0?void 0:Kn.get(Gn);if(Rr!==De.GRAPH_NODE)return Rr}},this.removeFromParentsChildList=function(Gn){var Kn=De.parentMap.get(Gn);De.childrenMap.get(Kn).delete(Gn)},this.setParent=function(Gn,Kn){var Rr,xa;De.checkCompound();for(var La=Kn===void 0?De.GRAPH_NODE:Kn,ui=De.parent(La);ui;){if(Gn===ui)throw new Error("Setting "+Kn+" as parent of "+Gn+" would create a cycle");ui=De.parent(ui)}Kn&&De.setNode(Kn),De.setNode(Gn),De.removeFromParentsChildList(Gn),(Rr=De.parentMap)===null||Rr===void 0||Rr.set(Gn,La);var Fi=De.childrenMap.get(La);return Fi.set(Gn,!0),(xa=De.childrenMap)===null||xa===void 0||xa.set(La,Fi),De},this.children=function(Gn){var Kn=Gn===void 0?De.GRAPH_NODE:Gn;if(De.isCompound()){var Rr,xa=(Rr=De.childrenMap)===null||Rr===void 0?void 0:Rr.get(Kn);return xa?Array.from(xa.keys()):void 0}if(Kn===De.GRAPH_NODE)return De.nodes();if(Gn&&De.hasNode(Gn))return[]},this.predecessors=function(Gn){var Kn=De.predecessorsMap.get(Gn);return Kn?Array.from(Kn.keys()):void 0},this.successors=function(Gn){var Kn=De.successorsMap.get(Gn);return Kn?Array.from(Kn.keys()):void 0},this.neighbors=function(Gn){var Kn;if(!!De.hasNode(Gn))return Array.from(new Set((Kn=De.predecessors(Gn))===null||Kn===void 0?void 0:Kn.concat(De.successors(Gn))))},this.isLeaf=function(Gn){var Kn;if(De.isDirected()){var Rr;return!((Rr=De.successors(Gn))===null||Rr===void 0?void 0:Rr.length)}return!((Kn=De.neighbors(Gn))===null||Kn===void 0?void 0:Kn.length)},this.filterNodes=function(Gn){var Kn=De.directed,Rr=De.multigraph,xa=De.compound,La=new ln({directed:Kn,multigraph:Rr,compound:xa});if(La.setGraph(De.graph()),De.nodes().forEach(function(Fi){Gn(Fi)&&La.setNode(Fi,De.node(Fi))}),De.edges().forEach(function(Fi){La.hasNode(Fi.v)&&La.hasNode(Fi.w)&&La.setEdgeObj(Fi,De.edge(Fi))}),xa){var ui=function(Ki){for(var xo=De.parent(Ki);xo!==void 0&&!La.hasNode(xo);)xo=De.parent(xo);return xo};La.nodes().forEach(function(Fi){La.setParent(Fi,ui(Fi))})}return La},this.setDefaultEdgeLabel=function(Gn){return N(Gn)?De.defaultEdgeLabelFn=Gn:De.defaultEdgeLabelFn=function(){return Gn},De},this.edgeCount=function(){return De.edgeCountNum},this.setEdgeObj=function(Gn,Kn){return De.setEdge(Gn.v,Gn.w,Kn,Gn.name)},this.setPath=function(Gn,Kn){return Gn.reduce(function(Rr,xa){return De.setEdge(Rr,xa,Kn),xa}),De},this.edgeFromArgs=function(Gn,Kn,Rr){return De.edge({v:Gn,w:Kn,name:Rr})},this.edge=function(Gn){return De.edgesLabelsMap.get(A(De.isDirected(),Gn))},this.hasEdge=function(Gn,Kn,Rr){return De.edgesLabelsMap.has(A(De.isDirected(),{v:Gn,w:Kn,name:Rr}))},this.removeEdgeObj=function(Gn){var Kn=Gn.v,Rr=Gn.w,xa=Gn.name;return De.removeEdge(Kn,Rr,xa)},this.edges=function(){return Array.from(De.edgesMap.values())},this.inEdges=function(Gn,Kn){var Rr=De.inEdgesMap.get(Gn);if(Rr)return Array.from(Rr.values()).filter(function(xa){return!Kn||xa.v===Kn})},this.outEdges=function(Gn,Kn){var Rr=De.outEdgesMap.get(Gn);if(Rr)return Array.from(Rr.values()).filter(function(xa){return!Kn||xa.w===Kn})},this.nodeEdges=function(Gn,Kn){var Rr;if(!!De.hasNode(Gn))return(Rr=De.inEdges(Gn,Kn))===null||Rr===void 0?void 0:Rr.concat(De.outEdges(Gn,Kn))},this.toJSON=function(){return F(De)},this.nodeInDegree=function(Gn){var Kn=De.inEdgesMap.get(Gn);return Kn?Kn.size:0},this.nodeOutDegree=function(Gn){var Kn=De.outEdgesMap.get(Gn);return Kn?Kn.size:0},this.nodeDegree=function(Gn){return De.nodeInDegree(Gn)+De.nodeOutDegree(Gn)},this.source=function(Gn){return Gn.v},this.target=function(Gn){return Gn.w};var Wn=P(P({},ht),dn);this.compound=Wn.compound,this.directed=Wn.directed,this.multigraph=Wn.multigraph,this.compound&&(this.parentMap=new Map,this.childrenMap=new Map)}return lt(ln,[{key:"setNode",value:function(dn,Wn){var Gn=this.nodesLabelMap,Kn=this.defaultNodeLabelFn,Rr=this.isCompound,xa=this.parentMap,La=this.childrenMap,ui=this.inEdgesMap,Fi=this.outEdgesMap,Ki=this.predecessorsMap,xo=this.successorsMap;if(Gn.has(dn))return Wn!==void 0&&Gn.set(dn,Wn),this;if(Gn.set(dn,Wn||Kn(dn)),Rr()){var vo;xa==null||xa.set(dn,this.GRAPH_NODE),La==null||La.set(dn,new Map),(La==null?void 0:La.has(this.GRAPH_NODE))||La==null||La.set(this.GRAPH_NODE,new Map),La==null||(vo=La.get(this.GRAPH_NODE))===null||vo===void 0||vo.set(dn,!0)}return[ui,Fi,Ki,xo].forEach(function(es){return es.set(dn,new Map)}),this.nodeCountNum+=1,this}},{key:"removeNode",value:function(dn){var Wn=this;if(this.hasNode(dn)){var Gn=function(Zi){Wn.removeEdge(Zi.v,Zi.w,Zi.name)},Kn=this.inEdgesMap,Rr=this.outEdgesMap,xa=this.predecessorsMap,La=this.successorsMap,ui=this.nodesLabelMap;if(this.isCompound()){var Fi,Ki,xo;this.removeFromParentsChildList(dn),(Fi=this.parentMap)===null||Fi===void 0||Fi.delete(dn),(Ki=this.children(dn))===null||Ki===void 0||Ki.forEach(function(Wo){return Wn.setParent(Wo)}),(xo=this.childrenMap)===null||xo===void 0||xo.delete(dn)}var vo=Kn.get(dn),es=Rr.get(dn);Array.from(vo.values()).forEach(function(Wo){return Gn(Wo)}),Array.from(es.values()).forEach(function(Wo){return Gn(Wo)}),ui.delete(dn),Kn.delete(dn),Rr.delete(dn),xa.delete(dn),La.delete(dn),this.nodeCountNum-=1}return this}},{key:"setEdge",value:function(dn,Wn,Gn,Kn){var Rr,xa,La=C(this.isDirected(),dn,Wn,Kn),ui=A(this.isDirected(),La),Fi=La.v,Ki=La.w;if(this.edgesLabelsMap.has(ui))return this.edgesLabelsMap.set(ui,Gn),this;if(Kn!==void 0&&!this.isMultigraph())throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(Fi),this.setNode(Ki),this.edgesLabelsMap.set(ui,Gn||this.defaultEdgeLabelFn(Fi,Ki,Kn)),Object.freeze(La),this.edgesMap.set(ui,La);var xo=this.predecessorsMap.get(Ki),vo=this.successorsMap.get(Fi);return Z(xo,Fi),Z(vo,Ki),(Rr=this.inEdgesMap.get(Ki))===null||Rr===void 0||Rr.set(ui,La),(xa=this.outEdgesMap.get(Fi))===null||xa===void 0||xa.set(ui,La),this.edgeCountNum+=1,this}},{key:"removeEdge",value:function(dn,Wn,Gn){var Kn=L(this.isDirected(),dn,Wn,Gn),Rr=this.edgesMap.get(Kn);if(Rr){var xa=C(this.isDirected(),dn,Wn,Gn),La=xa.v,ui=xa.w;this.edgesLabelsMap.delete(Kn),this.edgesMap.delete(Kn);var Fi=this.predecessorsMap.get(ui),Ki=this.successorsMap.get(La);R(Fi,La),R(Ki,ui),this.inEdgesMap.get(ui).delete(Kn),this.outEdgesMap.get(La).delete(Kn),this.edgeCountNum-=1}return this}}]),ln}();mt.fromJSON=K;function wt(ln){return wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(De){return typeof De}:function(De){return De&&typeof Symbol=="function"&&De.constructor===Symbol&&De!==Symbol.prototype?"symbol":typeof De},wt(ln)}function ut(ln,De){if(!(ln instanceof De))throw new TypeError("Cannot call a class as a function")}function pt(ln,De){for(var dn=0;dn<De.length;dn++){var Wn=De[dn];Wn.enumerable=Wn.enumerable||!1,Wn.configurable=!0,"value"in Wn&&(Wn.writable=!0),Object.defineProperty(ln,Wn.key,Wn)}}function Nt(ln,De,dn){return De&&pt(ln.prototype,De),dn&&pt(ln,dn),Object.defineProperty(ln,"prototype",{writable:!1}),ln}function Ut(){return typeof Reflect!="undefined"&&Reflect.get?Ut=Reflect.get:Ut=function(De,dn,Wn){var Gn=ue(De,dn);if(!!Gn){var Kn=Object.getOwnPropertyDescriptor(Gn,dn);return Kn.get?Kn.get.call(arguments.length<3?De:Wn):Kn.value}},Ut.apply(this,arguments)}function ue(ln,De){for(;!Object.prototype.hasOwnProperty.call(ln,De)&&(ln=de(ln),ln!==null););return ln}function se(ln,De){if(typeof De!="function"&&De!==null)throw new TypeError("Super expression must either be null or a function");ln.prototype=Object.create(De&&De.prototype,{constructor:{value:ln,writable:!0,configurable:!0}}),Object.defineProperty(ln,"prototype",{writable:!1}),De&&Le(ln,De)}function Le(ln,De){return Le=Object.setPrototypeOf||function(Wn,Gn){return Wn.__proto__=Gn,Wn},Le(ln,De)}function Ne(ln){var De=Qt();return function(){var Wn=de(ln),Gn;if(De){var Kn=de(this).constructor;Gn=Reflect.construct(Wn,arguments,Kn)}else Gn=Wn.apply(this,arguments);return we(this,Gn)}}function we(ln,De){if(De&&(wt(De)==="object"||typeof De=="function"))return De;if(De!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return At(ln)}function At(ln){if(ln===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ln}function Qt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ln){return!1}}function de(ln){return de=Object.setPrototypeOf?Object.getPrototypeOf:function(dn){return dn.__proto__||Object.getPrototypeOf(dn)},de(ln)}var rn=function(ln){se(dn,ln);var De=Ne(dn);function dn(){var Wn;ut(this,dn);for(var Gn=arguments.length,Kn=new Array(Gn),Rr=0;Rr<Gn;Rr++)Kn[Rr]=arguments[Rr];return Wn=De.call.apply(De,[this].concat(Kn)),Wn.eventPool={},Wn}return Nt(dn,[{key:"appendEvent",value:function(Gn,Kn){this.eventPool[Gn]||(this.eventPool[Gn]=[]),this.eventPool[Gn].push(Kn)}},{key:"removeEvent",value:function(Gn,Kn){if(!!this.eventPool[Gn]){var Rr=this.eventPool[Gn].indexOf(Kn);Rr>-1&&this.eventPool[Gn].splice(Rr,1)}}},{key:"emitEvent",value:function(Gn){for(var Kn=arguments.length,Rr=new Array(Kn>1?Kn-1:0),xa=1;xa<Kn;xa++)Rr[xa-1]=arguments[xa];!this.eventPool[Gn]||this.eventPool[Gn].forEach(function(La){La.apply(void 0,Rr)})}},{key:"setNode",value:function(Gn,Kn){return Ut(de(dn.prototype),"setNode",this).call(this,Gn,Kn),this.emitEvent("nodeAdd",Gn,Kn),this}},{key:"removeNode",value:function(Gn){return Ut(de(dn.prototype),"removeNode",this).call(this,Gn),this.emitEvent("nodeRemove",Gn),this}},{key:"setEdge",value:function(Gn,Kn,Rr,xa){return Ut(de(dn.prototype),"setEdge",this).call(this,Gn,Kn,Rr,xa),this.emitEvent("edgeAdd",Gn,Kn,Rr,xa),this}},{key:"removeEdge",value:function(Gn,Kn,Rr){return Ut(de(dn.prototype),"removeEdge",this).call(this,Gn,Kn,Rr),this.emitEvent("edgeRemove",Gn,Kn,Rr),this}}]),dn}(mt);function Ee(ln,De){for(var dn=0;dn<De.length;dn++){var Wn=De[dn];Wn.enumerable=Wn.enumerable||!1,Wn.configurable=!0,"value"in Wn&&(Wn.writable=!0),Object.defineProperty(ln,Wn.key,Wn)}}function ce(ln,De,dn){return De&&Ee(ln.prototype,De),dn&&Ee(ln,dn),Object.defineProperty(ln,"prototype",{writable:!1}),ln}function Oe(ln,De){if(!(ln instanceof De))throw new TypeError("Cannot call a class as a function")}var Ze=ce(function ln(){var De=this;Oe(this,ln),this.arr=[],this.keyIndice=new Map,this.size=function(){return De.arr.length},this.keys=function(){return De.arr.map(function(dn){return dn.key})},this.has=function(dn){return De.keyIndice.has(dn)},this.priority=function(dn){var Wn=De.keyIndice.get(dn);if(Wn!==void 0)return De.arr[Wn].priority},this.swap=function(dn,Wn){var Gn=De.arr,Kn=De.keyIndice,Rr=[Gn[dn],Gn[Wn]],xa=Rr[0],La=Rr[1];Gn[dn]=La,Gn[Wn]=xa,Kn.set(xa.key,Wn),Kn.set(La.key,dn)},this.innerDecrease=function(dn){for(var Wn=De.arr,Gn=Wn[dn].priority,Kn,Rr=dn;Rr!==0;){var xa;if(Kn=Rr>>1,((xa=Wn[Kn])===null||xa===void 0?void 0:xa.priority)<Gn)break;De.swap(Rr,Kn),Rr=Kn}},this.heapify=function(dn){var Wn=De.arr,Gn=dn<<1,Kn=Gn+1,Rr=dn;Gn<Wn.length&&(Rr=Wn[Gn].priority<Wn[Rr].priority?Gn:Rr,Kn<Wn.length&&(Rr=Wn[Kn].priority<Wn[Rr].priority?Kn:Rr),Rr!==dn&&(De.swap(dn,Rr),De.heapify(Rr)))},this.min=function(){if(De.size()===0)throw new Error("Queue underflow");return De.arr[0].key},this.add=function(dn,Wn){var Gn=De.keyIndice,Kn=De.arr;if(!Gn.has(dn)){var Rr=Kn.length;return Gn.set(dn,Rr),Kn.push({key:dn,priority:Wn}),De.innerDecrease(Rr),!0}return!1},this.removeMin=function(){De.swap(0,De.arr.length-1);var dn=De.arr.pop();return De.keyIndice.delete(dn.key),De.heapify(0),dn.key},this.decrease=function(dn,Wn){if(!De.has(dn))throw new Error("There's no key named ".concat(dn));var Gn=De.keyIndice.get(dn);if(Wn>De.arr[Gn].priority)throw new Error("New priority is greater than current priority.Key: ".concat(dn," Old: + ").concat(De.arr[Gn].priority," New: ").concat(Wn));De.arr[Gn].priority=Wn,De.innerDecrease(Gn)}}),fe=function(De,dn){var Wn=new mt,Gn=new Map,Kn=new Ze,Rr;function xa(Fi){var Ki=Fi.v===Rr?Fi.w:Fi.v,xo=Kn.priority(Ki);if(xo!==void 0){var vo=dn(Fi);vo<xo&&(Gn.set(Ki,Rr),Kn.decrease(Ki,vo))}}if(De.nodeCount()===0)return Wn;De.nodes().forEach(function(Fi){Kn.add(Fi,Number.POSITIVE_INFINITY),Wn.setNode(Fi)}),Kn.decrease(De.nodes()[0],0);for(var La=!1;Kn.size()>0;){var ui;if(Rr=Kn.removeMin(),Gn.has(Rr))Wn.setEdge(Rr,Gn.get(Rr));else{if(La)throw new Error("Input graph is not connected: "+De.graph());La=!0}(ui=De.nodeEdges(Rr))===null||ui===void 0||ui.forEach(xa)}return Wn},Ae=fe,Ye=function(De){var dn=new Set,Wn=[],Gn=De.nodes();return Gn.forEach(function(Kn){for(var Rr=[],xa=[Kn];xa.length>0;){var La=xa.pop();if(!dn.has(La)){var ui,Fi;dn.add(La),Rr.push(La),(ui=De.successors(La))===null||ui===void 0||ui.forEach(function(Ki){return xa.push(Ki)}),(Fi=De.predecessors(La))===null||Fi===void 0||Fi.forEach(function(Ki){return xa.push(Ki)})}}Rr.length&&Wn.push(Rr)}),Wn},ge=Ye,Be=function ln(De,dn,Wn,Gn,Kn,Rr){Gn.includes(dn)||(Gn.push(dn),Wn||Rr.push(dn),Kn(dn).forEach(function(xa){return ln(De,xa,Wn,Gn,Kn,Rr)}),Wn&&Rr.push(dn))},te=function(De,dn,Wn){var Gn=Array.isArray(dn)?dn:[dn],Kn=function(ui){return De.isDirected()?De.successors(ui):De.neighbors(ui)},Rr=[],xa=[];return Gn.forEach(function(La){if(De.hasNode(La))Be(De,La,Wn==="post",xa,Kn,Rr);else throw new Error("Graph does not have node: "+La)}),Rr},ke=te;function Ve(ln,De){return en(ln)||Me(ln,De)||Ft(ln,De)||ee()}function ee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ft(ln,De){if(!!ln){if(typeof ln=="string")return bt(ln,De);var dn=Object.prototype.toString.call(ln).slice(8,-1);if(dn==="Object"&&ln.constructor&&(dn=ln.constructor.name),dn==="Map"||dn==="Set")return Array.from(ln);if(dn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(dn))return bt(ln,De)}}function bt(ln,De){(De==null||De>ln.length)&&(De=ln.length);for(var dn=0,Wn=new Array(De);dn<De;dn++)Wn[dn]=ln[dn];return Wn}function Me(ln,De){var dn=ln==null?null:typeof Symbol!="undefined"&&ln[Symbol.iterator]||ln["@@iterator"];if(dn!=null){var Wn=[],Gn=!0,Kn=!1,Rr,xa;try{for(dn=dn.call(ln);!(Gn=(Rr=dn.next()).done)&&(Wn.push(Rr.value),!(De&&Wn.length===De));Gn=!0);}catch(La){Kn=!0,xa=La}finally{try{!Gn&&dn.return!=null&&dn.return()}finally{if(Kn)throw xa}}return Wn}}function en(ln){if(Array.isArray(ln))return ln}var fn=function(){return 1},Rt=function(De,dn,Wn,Gn){return Xn(De,dn,Wn||fn,Gn||function(Kn){return De.outEdges(Kn)})},Xn=function(De,dn,Wn,Gn){var Kn=new Map,Rr=new Ze,xa,La,ui=function(xo){var vo=xo.v!==xa?xo.v:xo.w,es=Kn.get(vo),Wo=Wn(xo),Zi=La.distance+Wo;if(Wo<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+xo+" Weight: "+Wo);Zi<es.distance&&(es.distance=Zi,es.predecessor=xa,Rr.decrease(vo,Zi))};for(De.nodes().forEach(function(Ki){var xo=Ki===dn?0:Number.POSITIVE_INFINITY;Kn.set(Ki,{distance:xo}),Rr.add(Ki,xo)});Rr.size()>0&&(xa=Rr.removeMin(),La=Kn.get(xa),!(La&&La.distance===Number.POSITIVE_INFINITY));)Gn(xa).forEach(ui);var Fi={};return Array.from(Kn.entries()).forEach(function(Ki){var xo=Ve(Ki,2),vo=xo[0],es=xo[1];return Fi[String(vo)]=es,Fi}),Fi},Bn=Rt,xr=function(De,dn,Wn){var Gn={};return De.nodes().forEach(function(Kn){return Gn[String(Kn)]=Bn(De,Kn,dn,Wn),Gn}),Gn},dr=xr,Ur=function(De){var dn=0,Wn=[],Gn=new Map,Kn=[];function Rr(xa){var La,ui={onStack:!0,lowlink:dn,index:dn};if(Gn.set(xa,ui),dn+=1,Wn.push(xa),(La=De.successors(xa))===null||La===void 0||La.forEach(function(vo){var es;if(Gn.has(vo)){if((es=Gn.get(vo))===null||es===void 0?void 0:es.onStack){var Zi=Gn.get(vo);ui.lowlink=Math.min(ui.lowlink,Zi.index)}}else{Rr(vo);var Wo=Gn.get(vo);ui.lowlink=Math.min(ui.lowlink,Wo.lowlink)}}),ui.lowlink===ui.index){var Fi=[],Ki;do{Ki=Wn.pop();var xo=Gn.get(Ki);xo.onStack=!1,Fi.push(Ki)}while(xa!==Ki);Kn.push(Fi)}}return De.nodes().forEach(function(xa){Gn.has(xa)||Rr(xa)}),Kn},fa=Ur,Ea=function(De){return fa(De).filter(function(dn){return dn.length>1||dn.length===1&&De.hasEdge(dn[0],dn[0])})},aa=Ea;function Da(ln){return Da=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(De){return typeof De}:function(De){return De&&typeof Symbol=="function"&&De.constructor===Symbol&&De!==Symbol.prototype?"symbol":typeof De},Da(ln)}function Lr(ln,De){for(var dn=0;dn<De.length;dn++){var Wn=De[dn];Wn.enumerable=Wn.enumerable||!1,Wn.configurable=!0,"value"in Wn&&(Wn.writable=!0),Object.defineProperty(ln,Wn.key,Wn)}}function _n(ln,De,dn){return De&&Lr(ln.prototype,De),dn&&Lr(ln,dn),Object.defineProperty(ln,"prototype",{writable:!1}),ln}function sr(ln,De){if(!(ln instanceof De))throw new TypeError("Cannot call a class as a function")}function Pn(ln,De){if(typeof De!="function"&&De!==null)throw new TypeError("Super expression must either be null or a function");ln.prototype=Object.create(De&&De.prototype,{constructor:{value:ln,writable:!0,configurable:!0}}),Object.defineProperty(ln,"prototype",{writable:!1}),De&&pr(ln,De)}function tr(ln){var De=wr();return function(){var Wn=qr(ln),Gn;if(De){var Kn=qr(this).constructor;Gn=Reflect.construct(Wn,arguments,Kn)}else Gn=Wn.apply(this,arguments);return zn(this,Gn)}}function zn(ln,De){if(De&&(Da(De)==="object"||typeof De=="function"))return De;if(De!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wr(ln)}function Wr(ln){if(ln===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ln}function Yr(ln){var De=typeof Map=="function"?new Map:void 0;return Yr=function(Wn){if(Wn===null||!Sr(Wn))return Wn;if(typeof Wn!="function")throw new TypeError("Super expression must either be null or a function");if(typeof De!="undefined"){if(De.has(Wn))return De.get(Wn);De.set(Wn,Gn)}function Gn(){return nr(Wn,arguments,qr(this).constructor)}return Gn.prototype=Object.create(Wn.prototype,{constructor:{value:Gn,enumerable:!1,writable:!0,configurable:!0}}),pr(Gn,Wn)},Yr(ln)}function nr(ln,De,dn){return wr()?nr=Reflect.construct:nr=function(Gn,Kn,Rr){var xa=[null];xa.push.apply(xa,Kn);var La=Function.bind.apply(Gn,xa),ui=new La;return Rr&&pr(ui,Rr.prototype),ui},nr.apply(null,arguments)}function wr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ln){return!1}}function Sr(ln){return Function.toString.call(ln).indexOf("[native code]")!==-1}function pr(ln,De){return pr=Object.setPrototypeOf||function(Wn,Gn){return Wn.__proto__=Gn,Wn},pr(ln,De)}function qr(ln){return qr=Object.setPrototypeOf?Object.getPrototypeOf:function(dn){return dn.__proto__||Object.getPrototypeOf(dn)},qr(ln)}var ua=function(ln){Pn(dn,ln);var De=tr(dn);function dn(){return sr(this,dn),De.apply(this,arguments)}return _n(dn)}(Yr(Error));function $r(ln){var De=new Set,dn=new Set,Wn=[];function Gn(Kn){if(dn.has(Kn))throw new ua;if(!De.has(Kn)){var Rr;dn.add(Kn),De.add(Kn),(Rr=ln.predecessors(Kn))===null||Rr===void 0||Rr.forEach(Gn),dn.delete(Kn),Wn.push(Kn)}}if(ln.sinks().forEach(Gn),De.size!==ln.nodeCount())throw new ua;return Wn}var ba=$r,gt=function(De){try{ba(De)}catch(dn){if(dn instanceof ua)return!1;throw dn}return!0},Dn=gt,un=function(De,dn){return ke(De,dn,"post")},Lt=un,Ot=function(De,dn){return ke(De,dn,"pre")},it=Ot,H=function(){return 1};function X(ln,De,dn){return xt(ln,De||H,dn||function(Wn){return ln.outEdges(Wn)})}function xt(ln,De,dn){var Wn={},Gn=ln.nodes();return Gn.forEach(function(Kn){var Rr=String(Kn);Wn[Rr]={},Wn[Rr][Rr]={distance:0},Gn.forEach(function(xa){Kn!==xa&&(Wn[Rr][String(xa)]={distance:Number.POSITIVE_INFINITY})}),dn(Kn).forEach(function(xa){var La=xa.v===Kn?xa.w:xa.v,ui=De(xa);Wn[Rr][String(La)]={distance:ui,predecessor:Kn}})}),Gn.forEach(function(Kn){var Rr=String(Kn),xa=Wn[Rr];Gn.forEach(function(La){var ui=String(La),Fi=Wn[ui];Gn.forEach(function(Ki){var xo=String(Ki),vo=Fi[Rr],es=xa[xo],Wo=Fi[xo],Zi=vo.distance+es.distance;Zi<Wo.distance&&(Wo.distance=Zi,Wo.predecessor=es.predecessor)})})}),Wn}var zt=X,Vt=function(De,dn){for(var Wn=De.nodes(),Gn=0;Gn<Wn.length;Gn++){var Kn=Wn[Gn];if(dn.hasNode(Kn))return!0}return!1},Xt=function(De,dn){for(var Wn=De.edges(),Gn=0;Gn<Wn.length;Gn++){var Kn=Wn[Gn];if(dn.hasEdge(Kn.v,Kn.w,Kn.name))return!0}return!1},ne=function(De,dn){var Wn=De.nodes(),Gn=Wn.filter(function(Kn){return dn.hasNode(Kn)});return Gn},on=function(De,dn){var Wn=De.edges(),Gn=Wn.filter(function(Kn){return dn.hasEdge(Kn.v,Kn.w,Kn.name)});return Gn},tn=function(De,dn){return De.isCompound()===dn.isCompound()&&De.isDirected()===dn.isDirected()&&De.isMultigraph()===dn.isMultigraph()},He=function(De,dn){var Wn=ne(De,dn);return Wn.length===De.nodes().length},Qn=function(De,dn){var Wn=on(De,dn);return Wn.length===De.edges().length},Ln=function(De,dn){return tn(De,dn)&&De.nodeCount()===dn.nodeCount()&&He(De,dn)&&De.edgeCount()===dn.edgeCount()&&Qn(De,dn)},Qr=function(De,dn){return He(De,dn)&&Qn(De,dn)};function Ia(ln,De){return da(ln)||za(ln,De)||Ar(ln,De)||Jn()}function Jn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ar(ln,De){if(!!ln){if(typeof ln=="string")return na(ln,De);var dn=Object.prototype.toString.call(ln).slice(8,-1);if(dn==="Object"&&ln.constructor&&(dn=ln.constructor.name),dn==="Map"||dn==="Set")return Array.from(ln);if(dn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(dn))return na(ln,De)}}function na(ln,De){(De==null||De>ln.length)&&(De=ln.length);for(var dn=0,Wn=new Array(De);dn<De;dn++)Wn[dn]=ln[dn];return Wn}function za(ln,De){var dn=ln==null?null:typeof Symbol!="undefined"&&ln[Symbol.iterator]||ln["@@iterator"];if(dn!=null){var Wn=[],Gn=!0,Kn=!1,Rr,xa;try{for(dn=dn.call(ln);!(Gn=(Rr=dn.next()).done)&&(Wn.push(Rr.value),!(De&&Wn.length===De));Gn=!0);}catch(La){Kn=!0,xa=La}finally{try{!Gn&&dn.return!=null&&dn.return()}finally{if(Kn)throw xa}}return Wn}}function da(ln){if(Array.isArray(ln))return ln}function Ti(ln){return ln instanceof mt}function ki(ln){if(ln.isMultigraph())return!1;for(var De=ln.edges(),dn=new Map,Wn=0;Wn<De.length;Wn++){var Gn=De[Wn];if(Gn.v===Gn.w)return!1;var Kn=[Gn.v,Gn.w].sort(),Rr=Ia(Kn,2),xa=Rr[0],La=Rr[1],ui="".concat(xa,"-").concat(La);if(dn.has(ui))return!1;dn.set(ui,!0)}return!0}function vi(ln){return ln.nodes().length===0}function ii(ln){for(var De=ln.edges(),dn=0;dn<De.length;dn++){var Wn=De[dn];if(Wn.v===Wn.w)return!0}return!1}var Di=function(De,dn){if(!ki(De)||!ki(dn)||!He(De,dn)||Xt(De,dn))return!1;var Wn=De.nodeCount();return De.edgeCount()+dn.edgeCount()===Wn*(Wn-1)/2},Ra=function(De){if(!ki(De))return null;for(var dn=De.nodeCount(),Wn=new mt({compound:De.isCompound(),directed:De.isDirected(),multigraph:De.isMultigraph()}),Gn=De.nodes(),Kn=0;Kn<dn;Kn++){var Rr=Gn[Kn];Wn.setNode(Rr,De.node(Rr));for(var xa=Kn+1;xa<dn;xa++){var La=Gn[xa];De.hasEdge(Rr,La)||Wn.setEdge(Rr,La)}}return Wn}},81746:function(ur){(function($,Y){ur.exports=Y()})(typeof self!="undefined"?self:this,function(){return function(ot){var $={};function Y(tt){if($[tt])return $[tt].exports;var j=$[tt]={i:tt,l:!1,exports:{}};return ot[tt].call(j.exports,j,j.exports,Y),j.l=!0,j.exports}return Y.m=ot,Y.c=$,Y.d=function(tt,j,W){Y.o(tt,j)||Object.defineProperty(tt,j,{configurable:!1,enumerable:!0,get:W})},Y.n=function(tt){var j=tt&&tt.__esModule?function(){return tt.default}:function(){return tt};return Y.d(j,"a",j),j},Y.o=function(tt,j){return Object.prototype.hasOwnProperty.call(tt,j)},Y.p="",Y(Y.s=36)}([function(ot,$,Y){"use strict";var tt=Y(3);$.a=function(j){return Array.isArray?Array.isArray(j):Object(tt.a)(j,"Array")}},function(ot,$,Y){"use strict";var tt=function(j){return j!==null&&typeof j!="function"&&isFinite(j.length)};$.a=tt},function(ot,$,Y){"use strict";var tt=Y(3);$.a=function(j){return Object(tt.a)(j,"Function")}},function(ot,$,Y){"use strict";var tt={}.toString,j=function(W,Q){return tt.call(W)==="[object "+Q+"]"};$.a=j},function(ot,$,Y){"use strict";var tt=Y(3);$.a=function(j){return Object(tt.a)(j,"String")}},function(ot,$,Y){"use strict";var tt=Y(3),j=function(W){return Object(tt.a)(W,"Number")};$.a=j},function(ot,$,Y){var tt=Y(38),j=tt.mix;function W(Q,Z,R,L){return L===void 0&&(L="height"),R==="center"?(Q[L]+Z[L])/2:Q.height}ot.exports={assign:j,getHeight:W}},function(ot,$,Y){"use strict";var tt=function(j){return j==null};$.a=tt},function(ot,$,Y){"use strict";var tt=Y(0),j=Y(12);function W(Q,Z){if(!!Q){var R;if(Object(tt.a)(Q))for(var L=0,C=Q.length;L<C&&(R=Z(Q[L],L),R!==!1);L++);else if(Object(j.a)(Q)){for(var A in Q)if(Q.hasOwnProperty(A)&&(R=Z(Q[A],A),R===!1))break}}}$.a=W},function(ot,$,Y){"use strict";var tt=Y(7);$.a=function(j){return Object(tt.a)(j)?"":j.toString()}},function(ot,$,Y){"use strict";var tt=Y(14),j=Y(3),W=function(Q){if(!Object(tt.a)(Q)||!Object(j.a)(Q,"Object"))return!1;if(Object.getPrototypeOf(Q)===null)return!0;for(var Z=Q;Object.getPrototypeOf(Z)!==null;)Z=Object.getPrototypeOf(Z);return Object.getPrototypeOf(Q)===Z};$.a=W},function(ot,$,Y){var tt=Y(18),j=function(){function W(Z,R){R===void 0&&(R={});var L=this;L.options=R,L.rootNode=tt(Z,R)}var Q=W.prototype;return Q.execute=function(){throw new Error("please override this method")},W}();ot.exports=j},function(ot,$,Y){"use strict";$.a=function(tt){var j=typeof tt;return tt!==null&&j==="object"||j==="function"}},function(ot,$,Y){"use strict";var tt=Y(1),j=function(W,Q){return Object(tt.a)(W)?W.indexOf(Q)>-1:!1};$.a=j},function(ot,$,Y){"use strict";var tt=function(j){return typeof j=="object"&&j!==null};$.a=tt},function(ot,$,Y){"use strict";var tt=Y(8),j=Y(2),W=Object.values?function(Q){return Object.values(Q)}:function(Q){var Z=[];return Object(tt.a)(Q,function(R,L){Object(j.a)(Q)&&L==="prototype"||Z.push(R)}),Z};$.a=W},function(ot,$,Y){"use strict";$.a=j;function tt(W,Q){for(var Z in Q)Q.hasOwnProperty(Z)&&Z!=="constructor"&&Q[Z]!==void 0&&(W[Z]=Q[Z])}function j(W,Q,Z,R){return Q&&tt(W,Q),Z&&tt(W,Z),R&&tt(W,R),W}},function(ot,$,Y){var tt=Y(35),j=["LR","RL","TB","BT","H","V"],W=["LR","RL","H"],Q=function(L){return W.indexOf(L)>-1},Z=j[0];ot.exports=function(R,L,C){var A=L.direction||Z;if(L.isHorizontal=Q(A),A&&j.indexOf(A)===-1)throw new TypeError("Invalid direction: "+A);if(A===j[0])C(R,L);else if(A===j[1])C(R,L),R.right2left();else if(A===j[2])C(R,L);else if(A===j[3])C(R,L),R.bottom2top();else if(A===j[4]||A===j[5]){var N=tt(R,L),B=N.left,O=N.right;C(B,L),C(O,L),L.isHorizontal?B.right2left():B.bottom2top(),O.translate(B.x-O.x,B.y-O.y),R.x=B.x,R.y=O.y;var F=R.getBoundingBox();L.isHorizontal?F.top<0&&R.translate(0,-F.top):F.left<0&&R.translate(-F.left,0)}var K=L.fixedRoot;return K===void 0&&(K=!0),K&&R.translate(-(R.x+R.width/2+R.hgap),-(R.y+R.height/2+R.vgap)),R}},function(ot,$,Y){var tt=Y(6),j=18,W=j*2,Q=j,Z={getId:function(A){return A.id||A.name},getPreH:function(A){return A.preH||0},getPreV:function(A){return A.preV||0},getHGap:function(A){return A.hgap||Q},getVGap:function(A){return A.vgap||Q},getChildren:function(A){return A.children},getHeight:function(A){return A.height||W},getWidth:function(A){var N=A.label||" ";return A.width||N.split("").length*j}};function R(C,A){var N=this;if(N.vgap=N.hgap=0,C instanceof R)return C;N.data=C;var B=A.getHGap(C),O=A.getVGap(C);return N.preH=A.getPreH(C),N.preV=A.getPreV(C),N.width=A.getWidth(C),N.height=A.getHeight(C),N.width+=N.preH,N.height+=N.preV,N.id=A.getId(C),N.x=N.y=0,N.depth=0,N.children||(N.children=[]),N.addGap(B,O),N}tt.assign(R.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(A,N){var B=this;B.hgap+=A,B.vgap+=N,B.width+=2*A,B.height+=2*N},eachNode:function(A){for(var N=this,B=[N],O;O=B.shift();)A(O),B=O.children.concat(B)},DFTraverse:function(A){this.eachNode(A)},BFTraverse:function(A){for(var N=this,B=[N],O;O=B.shift();)A(O),B=B.concat(O.children)},getBoundingBox:function(){var A={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(N){A.left=Math.min(A.left,N.x),A.top=Math.min(A.top,N.y),A.width=Math.max(A.width,N.x+N.width),A.height=Math.max(A.height,N.y+N.height)}),A},translate:function(A,N){A===void 0&&(A=0),N===void 0&&(N=0),this.eachNode(function(B){B.x+=A,B.y+=N,B.x+=B.preH,B.y+=B.preV})},right2left:function(){var A=this,N=A.getBoundingBox();A.eachNode(function(B){B.x=B.x-(B.x-N.left)*2-B.width}),A.translate(N.width,0)},bottom2top:function(){var A=this,N=A.getBoundingBox();A.eachNode(function(B){B.y=B.y-(B.y-N.top)*2-B.height}),A.translate(0,N.height)}});function L(C,A,N){A===void 0&&(A={}),A=tt.assign({},Z,A);var B=new R(C,A),O=[B],F;if(!N&&!C.collapsed){for(;F=O.shift();)if(!F.data.collapsed){var K=A.getChildren(F.data),nt=K?K.length:0;if(F.children=new Array(nt),K&&nt)for(var P=0;P<nt;P++){var k=new R(K[P],A);F.children[P]=k,O.push(k),k.parent=F,k.depth=F.depth+1}}}return B}ot.exports=L},function(ot,$,Y){"use strict";var tt=Y(1),j=function(W,Q){if(!Object(tt.a)(W))return W;for(var Z=[],R=0;R<W.length;R++){var L=W[R];Q(L,R)&&Z.push(L)}return Z};$.a=j},function(ot,$,Y){"use strict";var tt=Y(7),j=Y(21);function W(Q,Z){var R=Object(j.a)(Z),L=R.length;if(Object(tt.a)(Q))return!L;for(var C=0;C<L;C+=1){var A=R[C];if(Z[A]!==Q[A]||!(A in Q))return!1}return!0}$.a=W},function(ot,$,Y){"use strict";var tt=Y(8),j=Y(2),W=Object.keys?function(Q){return Object.keys(Q)}:function(Q){var Z=[];return Object(tt.a)(Q,function(R,L){Object(j.a)(Q)&&L==="prototype"||Z.push(L)}),Z};$.a=W},function(ot,$,Y){"use strict";var tt=Y(0);$.a=function(j){if(!!Object(tt.a)(j))return j.reduce(function(W,Q){return Math.max(W,Q)},j[0])}},function(ot,$,Y){"use strict";var tt=Y(0);$.a=function(j){if(!!Object(tt.a)(j))return j.reduce(function(W,Q){return Math.min(W,Q)},j[0])}},function(ot,$,Y){"use strict";var tt=Y(1),j=Array.prototype.splice,W=function(Z,R){if(!Object(tt.a)(Z))return[];for(var L=Z?R.length:0,C=L-1;L--;){var A=void 0,N=R[L];(L===C||N!==A)&&(A=N,j.call(Z,N,1))}return Z};$.a=W},function(ot,$,Y){"use strict";var tt=Y(8),j=Y(0),W=Y(10),Q=function(Z,R,L){if(!Object(j.a)(Z)&&!Object(W.a)(Z))return Z;var C=L;return Object(tt.a)(Z,function(A,N){C=R(C,A,N)}),C};$.a=Q},function(ot,$,Y){"use strict";$.a=tt;function tt(j,W){W===void 0&&(W=new Map);var Q=[];if(Array.isArray(j))for(var Z=0,R=j.length;Z<R;Z++){var L=j[Z];W.has(L)||(Q.push(L),W.set(L,!0))}return Q}},function(ot,$,Y){"use strict";$.a=Q;var tt=Y(0),j=Y(2),W=Y(28);function Q(Z,R){if(!R)return{0:Z};if(!Object(j.a)(R)){var L=Object(tt.a)(R)?R:R.replace(/\s+/g,"").split("*");R=function(C){for(var A="_",N=0,B=L.length;N<B;N++)A+=C[L[N]]&&C[L[N]].toString();return A}}return Object(W.a)(Z,R)}},function(ot,$,Y){"use strict";var tt=Y(0),j=Y(2),W=Object.prototype.hasOwnProperty;function Q(Z,R){if(!R||!Object(tt.a)(Z))return{};for(var L={},C=Object(j.a)(R)?R:function(O){return O[R]},A,N=0;N<Z.length;N++){var B=Z[N];A=C(B),W.call(L,A)?L[A].push(B):L[A]=[B]}return L}$.a=Q},function(ot,$,Y){"use strict";$.a=function(tt,j){return tt.hasOwnProperty(j)}},function(ot,$,Y){"use strict";var tt={}.toString,j=function(W){return tt.call(W).replace(/^\[object /,"").replace(/]$/,"")};$.a=j},function(ot,$,Y){"use strict";var tt=Object.prototype,j=function(W){var Q=W&&W.constructor,Z=typeof Q=="function"&&Q.prototype||tt;return W===Z};$.a=j},function(ot,$,Y){"use strict";var tt=Y(2);$.a=function(j,W){if(!Object(tt.a)(j))throw new TypeError("Expected a function");var Q=function(){for(var Z=[],R=0;R<arguments.length;R++)Z[R]=arguments[R];var L=W?W.apply(this,Z):Z[0],C=Q.cache;if(C.has(L))return C.get(L);var A=j.apply(this,Z);return C.set(L,A),A};return Q.cache=new Map,Q}},function(ot,$,Y){"use strict";var tt=Y(14),j=Y(1),W=Y(4),Q=function(Z,R){if(Z===R)return!0;if(!Z||!R||Object(W.a)(Z)||Object(W.a)(R))return!1;if(Object(j.a)(Z)||Object(j.a)(R)){if(Z.length!==R.length)return!1;for(var L=!0,C=0;C<Z.length&&(L=Q(Z[C],R[C]),!!L);C++);return L}if(Object(tt.a)(Z)||Object(tt.a)(R)){var A=Object.keys(Z),N=Object.keys(R);if(A.length!==N.length)return!1;for(var L=!0,C=0;C<A.length&&(L=Q(Z[A[C]],R[A[C]]),!!L);C++);return L}return!1};$.a=Q},function(ot,$,Y){"use strict";var tt=Y(116),j=Y(15),W=Y(32),Q=Y(4),Z;$.a=Object(W.a)(function(R,L){L===void 0&&(L={});var C=L.fontSize,A=L.fontFamily,N=L.fontWeight,B=L.fontStyle,O=L.fontVariant;return Z||(Z=document.createElement("canvas").getContext("2d")),Z.font=[B,O,N,C+"px",A].join(" "),Z.measureText(Object(Q.a)(R)?R:"").width},function(R,L){return L===void 0&&(L={}),Object(tt.a)([R],Object(j.a)(L)).join("")})},function(ot,$,Y){var tt=Y(18);ot.exports=function(j,W){for(var Q=tt(j.data,W,!0),Z=tt(j.data,W,!0),R=j.children.length,L=Math.round(R/2),C=W.getSide||function(O,F){return F<L?"right":"left"},A=0;A<R;A++){var N=j.children[A],B=C(N,A);B==="right"?Z.children.push(N):Q.children.push(N)}return Q.eachNode(function(O){O.isRoot()||(O.side="left")}),Z.eachNode(function(O){O.isRoot()||(O.side="right")}),{left:Q,right:Z}}},function(ot,$,Y){var tt={compactBox:Y(37),dendrogram:Y(120),indented:Y(122),mindmap:Y(124)};ot.exports=tt},function(ot,$,Y){function tt(N,B){N.prototype=Object.create(B.prototype),N.prototype.constructor=N,j(N,B)}function j(N,B){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(F,K){return F.__proto__=K,F},j(N,B)}var W=Y(11),Q=Y(119),Z=Y(17),R=Y(6),L=function(N){tt(B,N);function B(){return N.apply(this,arguments)||this}var O=B.prototype;return O.execute=function(){var K=this;return Z(K.rootNode,K.options,Q)},B}(W),C={};function A(N,B){return B=R.assign({},C,B),new L(N,B).execute()}ot.exports=A},function(ot,$,Y){"use strict";Object.defineProperty($,"__esModule",{value:!0});var tt=Y(13);Y.d($,"contains",function(){return tt.a}),Y.d($,"includes",function(){return tt.a});var j=Y(39);Y.d($,"difference",function(){return j.a});var W=Y(40);Y.d($,"find",function(){return W.a});var Q=Y(41);Y.d($,"findIndex",function(){return Q.a});var Z=Y(42);Y.d($,"firstValue",function(){return Z.a});var R=Y(43);Y.d($,"flatten",function(){return R.a});var L=Y(44);Y.d($,"flattenDeep",function(){return L.a});var C=Y(45);Y.d($,"getRange",function(){return C.a});var A=Y(46);Y.d($,"pull",function(){return A.a});var N=Y(24);Y.d($,"pullAt",function(){return N.a});var B=Y(25);Y.d($,"reduce",function(){return B.a});var O=Y(47);Y.d($,"remove",function(){return O.a});var F=Y(48);Y.d($,"sortBy",function(){return F.a});var K=Y(49);Y.d($,"union",function(){return K.a});var nt=Y(26);Y.d($,"uniq",function(){return nt.a});var P=Y(50);Y.d($,"valuesOfKey",function(){return P.a});var k=Y(51);Y.d($,"head",function(){return k.a});var yt=Y(52);Y.d($,"last",function(){return yt.a});var st=Y(53);Y.d($,"startsWith",function(){return st.a});var lt=Y(54);Y.d($,"endsWith",function(){return lt.a});var ht=Y(19);Y.d($,"filter",function(){return ht.a});var mt=Y(55);Y.d($,"every",function(){return mt.a});var wt=Y(56);Y.d($,"some",function(){return wt.a});var ut=Y(57);Y.d($,"group",function(){return ut.a});var pt=Y(28);Y.d($,"groupBy",function(){return pt.a});var Nt=Y(27);Y.d($,"groupToMap",function(){return Nt.a});var Ut=Y(58);Y.d($,"getWrapBehavior",function(){return Ut.a});var ue=Y(59);Y.d($,"wrapBehavior",function(){return ue.a});var se=Y(60);Y.d($,"number2color",function(){return se.a});var Le=Y(61);Y.d($,"parseRadius",function(){return Le.a});var Ne=Y(62);Y.d($,"clamp",function(){return Ne.a});var we=Y(63);Y.d($,"fixedBase",function(){return we.a});var At=Y(64);Y.d($,"isDecimal",function(){return At.a});var Qt=Y(65);Y.d($,"isEven",function(){return Qt.a});var de=Y(66);Y.d($,"isInteger",function(){return de.a});var rn=Y(67);Y.d($,"isNegative",function(){return rn.a});var Ee=Y(68);Y.d($,"isNumberEqual",function(){return Ee.a});var ce=Y(69);Y.d($,"isOdd",function(){return ce.a});var Oe=Y(70);Y.d($,"isPositive",function(){return Oe.a});var Ze=Y(22);Y.d($,"max",function(){return Ze.a});var fe=Y(71);Y.d($,"maxBy",function(){return fe.a});var Ae=Y(23);Y.d($,"min",function(){return Ae.a});var Ye=Y(72);Y.d($,"minBy",function(){return Ye.a});var ge=Y(73);Y.d($,"mod",function(){return ge.a});var Be=Y(74);Y.d($,"toDegree",function(){return Be.a});var te=Y(75);Y.d($,"toInteger",function(){return te.a});var ke=Y(76);Y.d($,"toRadian",function(){return ke.a});var Ve=Y(77);Y.d($,"forIn",function(){return Ve.a});var ee=Y(29);Y.d($,"has",function(){return ee.a});var Ft=Y(78);Y.d($,"hasKey",function(){return Ft.a});var bt=Y(79);Y.d($,"hasValue",function(){return bt.a});var Me=Y(21);Y.d($,"keys",function(){return Me.a});var en=Y(20);Y.d($,"isMatch",function(){return en.a});var fn=Y(15);Y.d($,"values",function(){return fn.a});var Rt=Y(80);Y.d($,"lowerCase",function(){return Rt.a});var Xn=Y(81);Y.d($,"lowerFirst",function(){return Xn.a});var Bn=Y(82);Y.d($,"substitute",function(){return Bn.a});var xr=Y(83);Y.d($,"upperCase",function(){return xr.a});var dr=Y(84);Y.d($,"upperFirst",function(){return dr.a});var Ur=Y(30);Y.d($,"getType",function(){return Ur.a});var fa=Y(85);Y.d($,"isArguments",function(){return fa.a});var Ea=Y(0);Y.d($,"isArray",function(){return Ea.a});var aa=Y(1);Y.d($,"isArrayLike",function(){return aa.a});var Da=Y(86);Y.d($,"isBoolean",function(){return Da.a});var Lr=Y(87);Y.d($,"isDate",function(){return Lr.a});var _n=Y(88);Y.d($,"isError",function(){return _n.a});var sr=Y(2);Y.d($,"isFunction",function(){return sr.a});var Pn=Y(89);Y.d($,"isFinite",function(){return Pn.a});var tr=Y(7);Y.d($,"isNil",function(){return tr.a});var zn=Y(90);Y.d($,"isNull",function(){return zn.a});var Wr=Y(5);Y.d($,"isNumber",function(){return Wr.a});var Yr=Y(12);Y.d($,"isObject",function(){return Yr.a});var nr=Y(14);Y.d($,"isObjectLike",function(){return nr.a});var wr=Y(10);Y.d($,"isPlainObject",function(){return wr.a});var Sr=Y(31);Y.d($,"isPrototype",function(){return Sr.a});var pr=Y(91);Y.d($,"isRegExp",function(){return pr.a});var qr=Y(4);Y.d($,"isString",function(){return qr.a});var ua=Y(3);Y.d($,"isType",function(){return ua.a});var $r=Y(92);Y.d($,"isUndefined",function(){return $r.a});var ba=Y(93);Y.d($,"isElement",function(){return ba.a});var gt=Y(94);Y.d($,"requestAnimationFrame",function(){return gt.a});var Dn=Y(95);Y.d($,"clearAnimationFrame",function(){return Dn.a});var un=Y(96);Y.d($,"augment",function(){return un.a});var Lt=Y(97);Y.d($,"clone",function(){return Lt.a});var Ot=Y(98);Y.d($,"debounce",function(){return Ot.a});var it=Y(32);Y.d($,"memoize",function(){return it.a});var H=Y(99);Y.d($,"deepMix",function(){return H.a});var X=Y(8);Y.d($,"each",function(){return X.a});var xt=Y(100);Y.d($,"extend",function(){return xt.a});var zt=Y(101);Y.d($,"indexOf",function(){return zt.a});var Vt=Y(102);Y.d($,"isEmpty",function(){return Vt.a});var Xt=Y(33);Y.d($,"isEqual",function(){return Xt.a});var ne=Y(103);Y.d($,"isEqualWith",function(){return ne.a});var on=Y(104);Y.d($,"map",function(){return on.a});var tn=Y(105);Y.d($,"mapValues",function(){return tn.a});var He=Y(16);Y.d($,"mix",function(){return He.a}),Y.d($,"assign",function(){return He.a});var Qn=Y(106);Y.d($,"get",function(){return Qn.a});var Ln=Y(107);Y.d($,"set",function(){return Ln.a});var Qr=Y(108);Y.d($,"pick",function(){return Qr.a});var Ia=Y(109);Y.d($,"omit",function(){return Ia.a});var Jn=Y(110);Y.d($,"throttle",function(){return Jn.a});var Ar=Y(111);Y.d($,"toArray",function(){return Ar.a});var na=Y(9);Y.d($,"toString",function(){return na.a});var za=Y(112);Y.d($,"uniqueId",function(){return za.a});var da=Y(113);Y.d($,"noop",function(){return da.a});var Ti=Y(114);Y.d($,"identity",function(){return Ti.a});var ki=Y(115);Y.d($,"size",function(){return ki.a});var vi=Y(34);Y.d($,"measureTextWidth",function(){return vi.a});var ii=Y(117);Y.d($,"getEllipsisText",function(){return ii.a});var Di=Y(118);Y.d($,"Cache",function(){return Di.a})},function(ot,$,Y){"use strict";var tt=Y(19),j=Y(13),W=function(Q,Z){return Z===void 0&&(Z=[]),Object(tt.a)(Q,function(R){return!Object(j.a)(Z,R)})};$.a=W},function(ot,$,Y){"use strict";var tt=Y(2),j=Y(20),W=Y(0),Q=Y(10);function Z(R,L){if(!Object(W.a)(R))return null;var C;if(Object(tt.a)(L)&&(C=L),Object(Q.a)(L)&&(C=function(N){return Object(j.a)(N,L)}),C){for(var A=0;A<R.length;A+=1)if(C(R[A]))return R[A]}return null}$.a=Z},function(ot,$,Y){"use strict";function tt(j,W,Q){Q===void 0&&(Q=0);for(var Z=Q;Z<j.length;Z++)if(W(j[Z],Z))return Z;return-1}$.a=tt},function(ot,$,Y){"use strict";var tt=Y(7),j=Y(0),W=function(Q,Z){for(var R=null,L=0;L<Q.length;L++){var C=Q[L],A=C[Z];if(!Object(tt.a)(A)){Object(j.a)(A)?R=A[0]:R=A;break}}return R};$.a=W},function(ot,$,Y){"use strict";var tt=Y(0),j=function(W){if(!Object(tt.a)(W))return[];for(var Q=[],Z=0;Z<W.length;Z++)Q=Q.concat(W[Z]);return Q};$.a=j},function(ot,$,Y){"use strict";var tt=Y(0),j=function(W,Q){if(Q===void 0&&(Q=[]),!Object(tt.a)(W))Q.push(W);else for(var Z=0;Z<W.length;Z+=1)j(W[Z],Q);return Q};$.a=j},function(ot,$,Y){"use strict";var tt=Y(0),j=Y(22),W=Y(23),Q=function(Z){var R=Z.filter(function(B){return!isNaN(B)});if(!R.length)return{min:0,max:0};if(Object(tt.a)(Z[0])){for(var L=[],C=0;C<Z.length;C++)L=L.concat(Z[C]);R=L}var A=Object(j.a)(R),N=Object(W.a)(R);return{min:N,max:A}};$.a=Q},function(ot,$,Y){"use strict";var tt=Array.prototype,j=tt.splice,W=tt.indexOf,Q=function(Z){for(var R=[],L=1;L<arguments.length;L++)R[L-1]=arguments[L];for(var C=0;C<R.length;C++)for(var A=R[C],N=-1;(N=W.call(Z,A))>-1;)j.call(Z,N,1);return Z};$.a=Q},function(ot,$,Y){"use strict";var tt=Y(1),j=Y(24),W=function(Q,Z){var R=[];if(!Object(tt.a)(Q))return R;for(var L=-1,C=[],A=Q.length;++L<A;){var N=Q[L];Z(N,L,Q)&&(R.push(N),C.push(L))}return Object(j.a)(Q,C),R};$.a=W},function(ot,$,Y){"use strict";var tt=Y(0),j=Y(4),W=Y(2);function Q(Z,R){var L;if(Object(W.a)(R))L=function(A,N){return R(A)-R(N)};else{var C=[];Object(j.a)(R)?C.push(R):Object(tt.a)(R)&&(C=R),L=function(A,N){for(var B=0;B<C.length;B+=1){var O=C[B];if(A[O]>N[O])return 1;if(A[O]<N[O])return-1}return 0}}return Z.sort(L),Z}$.a=Q},function(ot,$,Y){"use strict";var tt=Y(26),j=function(){for(var W=[],Q=0;Q<arguments.length;Q++)W[Q]=arguments[Q];return Object(tt.a)([].concat.apply([],W))};$.a=j},function(ot,$,Y){"use strict";var tt=Y(0),j=Y(7);$.a=function(W,Q){for(var Z=[],R={},L=0;L<W.length;L++){var C=W[L],A=C[Q];if(!Object(j.a)(A)){Object(tt.a)(A)||(A=[A]);for(var N=0;N<A.length;N++){var B=A[N];R[B]||(Z.push(B),R[B]=!0)}}}return Z}},function(ot,$,Y){"use strict";$.a=j;var tt=Y(1);function j(W){if(Object(tt.a)(W))return W[0]}},function(ot,$,Y){"use strict";$.a=j;var tt=Y(1);function j(W){if(Object(tt.a)(W)){var Q=W;return Q[Q.length-1]}}},function(ot,$,Y){"use strict";var tt=Y(0),j=Y(4);function W(Q,Z){return Object(tt.a)(Q)||Object(j.a)(Q)?Q[0]===Z:!1}$.a=W},function(ot,$,Y){"use strict";var tt=Y(0),j=Y(4);function W(Q,Z){return Object(tt.a)(Q)||Object(j.a)(Q)?Q[Q.length-1]===Z:!1}$.a=W},function(ot,$,Y){"use strict";var tt=function(j,W){for(var Q=0;Q<j.length;Q++)if(!W(j[Q],Q))return!1;return!0};$.a=tt},function(ot,$,Y){"use strict";var tt=function(j,W){for(var Q=0;Q<j.length;Q++)if(W(j[Q],Q))return!0;return!1};$.a=tt},function(ot,$,Y){"use strict";var tt=Y(27);$.a=function(j,W){if(!W)return[j];var Q=Object(tt.a)(j,W),Z=[];for(var R in Q)Z.push(Q[R]);return Z}},function(ot,$,Y){"use strict";function tt(j,W){return j["_wrap_"+W]}$.a=tt},function(ot,$,Y){"use strict";function tt(j,W){if(j["_wrap_"+W])return j["_wrap_"+W];var Q=function(Z){j[W](Z)};return j["_wrap_"+W]=Q,Q}$.a=tt},function(ot,$,Y){"use strict";var tt={};function j(W){var Q=tt[W];if(!Q){for(var Z=W.toString(16),R=Z.length;R<6;R++)Z="0"+Z;Q="#"+Z,tt[W]=Q}return Q}$.a=j},function(ot,$,Y){"use strict";var tt=Y(0);function j(W){var Q=0,Z=0,R=0,L=0;return Object(tt.a)(W)?W.length===1?Q=Z=R=L=W[0]:W.length===2?(Q=R=W[0],Z=L=W[1]):W.length===3?(Q=W[0],Z=L=W[1],R=W[2]):(Q=W[0],Z=W[1],R=W[2],L=W[3]):Q=Z=R=L=W,{r1:Q,r2:Z,r3:R,r4:L}}$.a=j},function(ot,$,Y){"use strict";var tt=function(j,W,Q){return j<W?W:j>Q?Q:j};$.a=tt},function(ot,$,Y){"use strict";var tt=function(j,W){var Q=W.toString(),Z=Q.indexOf(".");if(Z===-1)return Math.round(j);var R=Q.substr(Z+1).length;return R>20&&(R=20),parseFloat(j.toFixed(R))};$.a=tt},function(ot,$,Y){"use strict";var tt=Y(5),j=function(W){return Object(tt.a)(W)&&W%1!=0};$.a=j},function(ot,$,Y){"use strict";var tt=Y(5),j=function(W){return Object(tt.a)(W)&&W%2==0};$.a=j},function(ot,$,Y){"use strict";var tt=Y(5),j=Number.isInteger?Number.isInteger:function(W){return Object(tt.a)(W)&&W%1==0};$.a=j},function(ot,$,Y){"use strict";var tt=Y(5),j=function(W){return Object(tt.a)(W)&&W<0};$.a=j},function(ot,$,Y){"use strict";$.a=j;var tt=1e-5;function j(W,Q,Z){return Z===void 0&&(Z=tt),Math.abs(W-Q)<Z}},function(ot,$,Y){"use strict";var tt=Y(5),j=function(W){return Object(tt.a)(W)&&W%2!=0};$.a=j},function(ot,$,Y){"use strict";var tt=Y(5),j=function(W){return Object(tt.a)(W)&&W>0};$.a=j},function(ot,$,Y){"use strict";var tt=Y(0),j=Y(2);$.a=function(W,Q){if(!!Object(tt.a)(W)){for(var Z,R=-Infinity,L=0;L<W.length;L++){var C=W[L],A=Object(j.a)(Q)?Q(C):C[Q];A>R&&(Z=C,R=A)}return Z}}},function(ot,$,Y){"use strict";var tt=Y(0),j=Y(2);$.a=function(W,Q){if(!!Object(tt.a)(W)){for(var Z,R=Infinity,L=0;L<W.length;L++){var C=W[L],A=Object(j.a)(Q)?Q(C):C[Q];A<R&&(Z=C,R=A)}return Z}}},function(ot,$,Y){"use strict";var tt=function(j,W){return(j%W+W)%W};$.a=tt},function(ot,$,Y){"use strict";var tt=180/Math.PI,j=function(W){return tt*W};$.a=j},function(ot,$,Y){"use strict";$.a=parseInt},function(ot,$,Y){"use strict";var tt=Math.PI/180,j=function(W){return tt*W};$.a=j},function(ot,$,Y){"use strict";var tt=Y(8);$.a=tt.a},function(ot,$,Y){"use strict";var tt=Y(29);$.a=tt.a},function(ot,$,Y){"use strict";var tt=Y(13),j=Y(15);$.a=function(W,Q){return Object(tt.a)(Object(j.a)(W),Q)}},function(ot,$,Y){"use strict";var tt=Y(9),j=function(W){return Object(tt.a)(W).toLowerCase()};$.a=j},function(ot,$,Y){"use strict";var tt=Y(9),j=function(W){var Q=Object(tt.a)(W);return Q.charAt(0).toLowerCase()+Q.substring(1)};$.a=j},function(ot,$,Y){"use strict";function tt(j,W){return!j||!W?j:j.replace(/\\?\{([^{}]+)\}/g,function(Q,Z){return Q.charAt(0)==="\\"?Q.slice(1):W[Z]===void 0?"":W[Z]})}$.a=tt},function(ot,$,Y){"use strict";var tt=Y(9),j=function(W){return Object(tt.a)(W).toUpperCase()};$.a=j},function(ot,$,Y){"use strict";var tt=Y(9),j=function(W){var Q=Object(tt.a)(W);return Q.charAt(0).toUpperCase()+Q.substring(1)};$.a=j},function(ot,$,Y){"use strict";var tt=Y(3),j=function(W){return Object(tt.a)(W,"Arguments")};$.a=j},function(ot,$,Y){"use strict";var tt=Y(3),j=function(W){return Object(tt.a)(W,"Boolean")};$.a=j},function(ot,$,Y){"use strict";var tt=Y(3),j=function(W){return Object(tt.a)(W,"Date")};$.a=j},function(ot,$,Y){"use strict";var tt=Y(3),j=function(W){return Object(tt.a)(W,"Error")};$.a=j},function(ot,$,Y){"use strict";var tt=Y(5);$.a=function(j){return Object(tt.a)(j)&&isFinite(j)}},function(ot,$,Y){"use strict";var tt=function(j){return j===null};$.a=tt},function(ot,$,Y){"use strict";var tt=Y(3),j=function(W){return Object(tt.a)(W,"RegExp")};$.a=j},function(ot,$,Y){"use strict";var tt=function(j){return j===void 0};$.a=tt},function(ot,$,Y){"use strict";var tt=function(j){return j instanceof Element||j instanceof HTMLDocument};$.a=tt},function(ot,$,Y){"use strict";$.a=tt;function tt(j){var W=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(Q){return setTimeout(Q,16)};return W(j)}},function(ot,$,Y){"use strict";$.a=tt;function tt(j){var W=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;W(j)}},function(ot,$,Y){"use strict";var tt=Y(16),j=Y(2),W=function(){for(var Q=[],Z=0;Z<arguments.length;Z++)Q[Z]=arguments[Z];for(var R=Q[0],L=1;L<Q.length;L++){var C=Q[L];Object(j.a)(C)&&(C=C.prototype),Object(tt.a)(R.prototype,C)}};$.a=W},function(ot,$,Y){"use strict";var tt=Y(0),j=function(W){if(typeof W!="object"||W===null)return W;var Q;if(Object(tt.a)(W)){Q=[];for(var Z=0,R=W.length;Z<R;Z++)typeof W[Z]=="object"&&W[Z]!=null?Q[Z]=j(W[Z]):Q[Z]=W[Z]}else{Q={};for(var L in W)typeof W[L]=="object"&&W[L]!=null?Q[L]=j(W[L]):Q[L]=W[L]}return Q};$.a=j},function(ot,$,Y){"use strict";function tt(j,W,Q){var Z;return function(){var R=this,L=arguments,C=function(){Z=null,Q||j.apply(R,L)},A=Q&&!Z;clearTimeout(Z),Z=setTimeout(C,W),A&&j.apply(R,L)}}$.a=tt},function(ot,$,Y){"use strict";var tt=Y(0),j=Y(10),W=5;function Q(R,L,C,A){C=C||0,A=A||W;for(var N in L)if(L.hasOwnProperty(N)){var B=L[N];B!==null&&Object(j.a)(B)?(Object(j.a)(R[N])||(R[N]={}),C<A?Q(R[N],B,C+1,A):R[N]=L[N]):Object(tt.a)(B)?(R[N]=[],R[N]=R[N].concat(B)):B!==void 0&&(R[N]=B)}}var Z=function(R){for(var L=[],C=1;C<arguments.length;C++)L[C-1]=arguments[C];for(var A=0;A<L.length;A+=1)Q(R,L[A]);return R};$.a=Z},function(ot,$,Y){"use strict";var tt=Y(16),j=Y(2),W=function(Q,Z,R,L){Object(j.a)(Z)||(R=Z,Z=Q,Q=function(){});var C=Object.create?function(N,B){return Object.create(N,{constructor:{value:B}})}:function(N,B){function O(){}O.prototype=N;var F=new O;return F.constructor=B,F},A=C(Z.prototype,Q);return Q.prototype=Object(tt.a)(A,Q.prototype),Q.superclass=C(Z.prototype,Z),Object(tt.a)(A,R),Object(tt.a)(Q,L),Q};$.a=W},function(ot,$,Y){"use strict";var tt=Y(1),j=function(W,Q){if(!Object(tt.a)(W))return-1;var Z=Array.prototype.indexOf;if(Z)return Z.call(W,Q);for(var R=-1,L=0;L<W.length;L++)if(W[L]===Q){R=L;break}return R};$.a=j},function(ot,$,Y){"use strict";var tt=Y(7),j=Y(1),W=Y(30),Q=Y(31),Z=Object.prototype.hasOwnProperty;function R(L){if(Object(tt.a)(L))return!0;if(Object(j.a)(L))return!L.length;var C=Object(W.a)(L);if(C==="Map"||C==="Set")return!L.size;if(Object(Q.a)(L))return!Object.keys(L).length;for(var A in L)if(Z.call(L,A))return!1;return!0}$.a=R},function(ot,$,Y){"use strict";var tt=Y(2),j=Y(33);$.a=function(W,Q,Z){return Object(tt.a)(Z)?!!Z(W,Q):Object(j.a)(W,Q)}},function(ot,$,Y){"use strict";var tt=Y(1),j=function(W,Q){if(!Object(tt.a)(W))return W;for(var Z=[],R=0;R<W.length;R++){var L=W[R];Z.push(Q(L,R))}return Z};$.a=j},function(ot,$,Y){"use strict";var tt=Y(7),j=Y(12),W=function(Q){return Q};$.a=function(Q,Z){Z===void 0&&(Z=W);var R={};return Object(j.a)(Q)&&!Object(tt.a)(Q)&&Object.keys(Q).forEach(function(L){R[L]=Z(Q[L],L)}),R}},function(ot,$,Y){"use strict";var tt=Y(4);$.a=function(j,W,Q){for(var Z=0,R=Object(tt.a)(W)?W.split("."):W;j&&Z<R.length;)j=j[R[Z++]];return j===void 0||Z<R.length?Q:j}},function(ot,$,Y){"use strict";var tt=Y(12),j=Y(4),W=Y(5);$.a=function(Q,Z,R){var L=Q,C=Object(j.a)(Z)?Z.split("."):Z;return C.forEach(function(A,N){N<C.length-1?(Object(tt.a)(L[A])||(L[A]=Object(W.a)(C[N+1])?[]:{}),L=L[A]):L[A]=R}),Q}},function(ot,$,Y){"use strict";var tt=Y(8),j=Y(10),W=Object.prototype.hasOwnProperty;$.a=function(Q,Z){if(Q===null||!Object(j.a)(Q))return{};var R={};return Object(tt.a)(Z,function(L){W.call(Q,L)&&(R[L]=Q[L])}),R}},function(ot,$,Y){"use strict";var tt=Y(25);$.a=function(j,W){return Object(tt.a)(j,function(Q,Z,R){return W.includes(R)||(Q[R]=Z),Q},{})}},function(ot,$,Y){"use strict";$.a=function(tt,j,W){var Q,Z,R,L,C=0;W||(W={});var A=function(){C=W.leading===!1?0:Date.now(),Q=null,L=tt.apply(Z,R),Q||(Z=R=null)},N=function(){var B=Date.now();!C&&W.leading===!1&&(C=B);var O=j-(B-C);return Z=this,R=arguments,O<=0||O>j?(Q&&(clearTimeout(Q),Q=null),C=B,L=tt.apply(Z,R),Q||(Z=R=null)):!Q&&W.trailing!==!1&&(Q=setTimeout(A,O)),L};return N.cancel=function(){clearTimeout(Q),C=0,Q=Z=R=null},N}},function(ot,$,Y){"use strict";var tt=Y(1);$.a=function(j){return Object(tt.a)(j)?Array.prototype.slice.call(j):[]}},function(ot,$,Y){"use strict";var tt={};$.a=function(j){return j=j||"g",tt[j]?tt[j]+=1:tt[j]=1,j+tt[j]}},function(ot,$,Y){"use strict";$.a=function(){}},function(ot,$,Y){"use strict";$.a=function(tt){return tt}},function(ot,$,Y){"use strict";$.a=W;var tt=Y(7),j=Y(1);function W(Q){return Object(tt.a)(Q)?0:Object(j.a)(Q)?Q.length:Object.keys(Q).length}},function(ot,$,Y){"use strict";$.a=st;var tt=function(we,At){return tt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Qt,de){Qt.__proto__=de}||function(Qt,de){for(var rn in de)Object.prototype.hasOwnProperty.call(de,rn)&&(Qt[rn]=de[rn])},tt(we,At)};function j(we,At){if(typeof At!="function"&&At!==null)throw new TypeError("Class extends value "+String(At)+" is not a constructor or null");tt(we,At);function Qt(){this.constructor=we}we.prototype=At===null?Object.create(At):(Qt.prototype=At.prototype,new Qt)}var W=function(){return W=Object.assign||function(At){for(var Qt,de=1,rn=arguments.length;de<rn;de++){Qt=arguments[de];for(var Ee in Qt)Object.prototype.hasOwnProperty.call(Qt,Ee)&&(At[Ee]=Qt[Ee])}return At},W.apply(this,arguments)};function Q(we,At){var Qt={};for(var de in we)Object.prototype.hasOwnProperty.call(we,de)&&At.indexOf(de)<0&&(Qt[de]=we[de]);if(we!=null&&typeof Object.getOwnPropertySymbols=="function")for(var rn=0,de=Object.getOwnPropertySymbols(we);rn<de.length;rn++)At.indexOf(de[rn])<0&&Object.prototype.propertyIsEnumerable.call(we,de[rn])&&(Qt[de[rn]]=we[de[rn]]);return Qt}function Z(we,At,Qt,de){var rn=arguments.length,Ee=rn<3?At:de===null?de=Object.getOwnPropertyDescriptor(At,Qt):de,ce;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Ee=Reflect.decorate(we,At,Qt,de);else for(var Oe=we.length-1;Oe>=0;Oe--)(ce=we[Oe])&&(Ee=(rn<3?ce(Ee):rn>3?ce(At,Qt,Ee):ce(At,Qt))||Ee);return rn>3&&Ee&&Object.defineProperty(At,Qt,Ee),Ee}function R(we,At){return function(Qt,de){At(Qt,de,we)}}function L(we,At,Qt,de,rn,Ee){function ce(ee){if(ee!==void 0&&typeof ee!="function")throw new TypeError("Function expected");return ee}for(var Oe=de.kind,Ze=Oe==="getter"?"get":Oe==="setter"?"set":"value",fe=!At&&we?de.static?we:we.prototype:null,Ae=At||(fe?Object.getOwnPropertyDescriptor(fe,de.name):{}),Ye,ge=!1,Be=Qt.length-1;Be>=0;Be--){var te={};for(var ke in de)te[ke]=ke==="access"?{}:de[ke];for(var ke in de.access)te.access[ke]=de.access[ke];te.addInitializer=function(ee){if(ge)throw new TypeError("Cannot add initializers after decoration has completed");Ee.push(ce(ee||null))};var Ve=(0,Qt[Be])(Oe==="accessor"?{get:Ae.get,set:Ae.set}:Ae[Ze],te);if(Oe==="accessor"){if(Ve===void 0)continue;if(Ve===null||typeof Ve!="object")throw new TypeError("Object expected");(Ye=ce(Ve.get))&&(Ae.get=Ye),(Ye=ce(Ve.set))&&(Ae.set=Ye),(Ye=ce(Ve.init))&&rn.push(Ye)}else(Ye=ce(Ve))&&(Oe==="field"?rn.push(Ye):Ae[Ze]=Ye)}fe&&Object.defineProperty(fe,de.name,Ae),ge=!0}function C(we,At,Qt){for(var de=arguments.length>2,rn=0;rn<At.length;rn++)Qt=de?At[rn].call(we,Qt):At[rn].call(we);return de?Qt:void 0}function A(we){return typeof we=="symbol"?we:"".concat(we)}function N(we,At,Qt){return typeof At=="symbol"&&(At=At.description?"[".concat(At.description,"]"):""),Object.defineProperty(we,"name",{configurable:!0,value:Qt?"".concat(Qt," ",At):At})}function B(we,At){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(we,At)}function O(we,At,Qt,de){function rn(Ee){return Ee instanceof Qt?Ee:new Qt(function(ce){ce(Ee)})}return new(Qt||(Qt=Promise))(function(Ee,ce){function Oe(Ae){try{fe(de.next(Ae))}catch(Ye){ce(Ye)}}function Ze(Ae){try{fe(de.throw(Ae))}catch(Ye){ce(Ye)}}function fe(Ae){Ae.done?Ee(Ae.value):rn(Ae.value).then(Oe,Ze)}fe((de=de.apply(we,At||[])).next())})}function F(we,At){var Qt={label:0,sent:function(){if(Ee[0]&1)throw Ee[1];return Ee[1]},trys:[],ops:[]},de,rn,Ee,ce;return ce={next:Oe(0),throw:Oe(1),return:Oe(2)},typeof Symbol=="function"&&(ce[Symbol.iterator]=function(){return this}),ce;function Oe(fe){return function(Ae){return Ze([fe,Ae])}}function Ze(fe){if(de)throw new TypeError("Generator is already executing.");for(;ce&&(ce=0,fe[0]&&(Qt=0)),Qt;)try{if(de=1,rn&&(Ee=fe[0]&2?rn.return:fe[0]?rn.throw||((Ee=rn.return)&&Ee.call(rn),0):rn.next)&&!(Ee=Ee.call(rn,fe[1])).done)return Ee;switch(rn=0,Ee&&(fe=[fe[0]&2,Ee.value]),fe[0]){case 0:case 1:Ee=fe;break;case 4:return Qt.label++,{value:fe[1],done:!1};case 5:Qt.label++,rn=fe[1],fe=[0];continue;case 7:fe=Qt.ops.pop(),Qt.trys.pop();continue;default:if(Ee=Qt.trys,!(Ee=Ee.length>0&&Ee[Ee.length-1])&&(fe[0]===6||fe[0]===2)){Qt=0;continue}if(fe[0]===3&&(!Ee||fe[1]>Ee[0]&&fe[1]<Ee[3])){Qt.label=fe[1];break}if(fe[0]===6&&Qt.label<Ee[1]){Qt.label=Ee[1],Ee=fe;break}if(Ee&&Qt.label<Ee[2]){Qt.label=Ee[2],Qt.ops.push(fe);break}Ee[2]&&Qt.ops.pop(),Qt.trys.pop();continue}fe=At.call(we,Qt)}catch(Ae){fe=[6,Ae],rn=0}finally{de=Ee=0}if(fe[0]&5)throw fe[1];return{value:fe[0]?fe[1]:void 0,done:!0}}}var K=Object.create?function(we,At,Qt,de){de===void 0&&(de=Qt);var rn=Object.getOwnPropertyDescriptor(At,Qt);(!rn||("get"in rn?!At.__esModule:rn.writable||rn.configurable))&&(rn={enumerable:!0,get:function(){return At[Qt]}}),Object.defineProperty(we,de,rn)}:function(we,At,Qt,de){de===void 0&&(de=Qt),we[de]=At[Qt]};function nt(we,At){for(var Qt in we)Qt!=="default"&&!Object.prototype.hasOwnProperty.call(At,Qt)&&K(At,we,Qt)}function P(we){var At=typeof Symbol=="function"&&Symbol.iterator,Qt=At&&we[At],de=0;if(Qt)return Qt.call(we);if(we&&typeof we.length=="number")return{next:function(){return we&&de>=we.length&&(we=void 0),{value:we&&we[de++],done:!we}}};throw new TypeError(At?"Object is not iterable.":"Symbol.iterator is not defined.")}function k(we,At){var Qt=typeof Symbol=="function"&&we[Symbol.iterator];if(!Qt)return we;var de=Qt.call(we),rn,Ee=[],ce;try{for(;(At===void 0||At-- >0)&&!(rn=de.next()).done;)Ee.push(rn.value)}catch(Oe){ce={error:Oe}}finally{try{rn&&!rn.done&&(Qt=de.return)&&Qt.call(de)}finally{if(ce)throw ce.error}}return Ee}function yt(){for(var we=[],At=0;At<arguments.length;At++)we=we.concat(k(arguments[At]));return we}function st(){for(var we=0,At=0,Qt=arguments.length;At<Qt;At++)we+=arguments[At].length;for(var de=Array(we),rn=0,At=0;At<Qt;At++)for(var Ee=arguments[At],ce=0,Oe=Ee.length;ce<Oe;ce++,rn++)de[rn]=Ee[ce];return de}function lt(we,At,Qt){if(Qt||arguments.length===2)for(var de=0,rn=At.length,Ee;de<rn;de++)(Ee||!(de in At))&&(Ee||(Ee=Array.prototype.slice.call(At,0,de)),Ee[de]=At[de]);return we.concat(Ee||Array.prototype.slice.call(At))}function ht(we){return this instanceof ht?(this.v=we,this):new ht(we)}function mt(we,At,Qt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var de=Qt.apply(we,At||[]),rn,Ee=[];return rn={},ce("next"),ce("throw"),ce("return"),rn[Symbol.asyncIterator]=function(){return this},rn;function ce(ge){de[ge]&&(rn[ge]=function(Be){return new Promise(function(te,ke){Ee.push([ge,Be,te,ke])>1||Oe(ge,Be)})})}function Oe(ge,Be){try{Ze(de[ge](Be))}catch(te){Ye(Ee[0][3],te)}}function Ze(ge){ge.value instanceof ht?Promise.resolve(ge.value.v).then(fe,Ae):Ye(Ee[0][2],ge)}function fe(ge){Oe("next",ge)}function Ae(ge){Oe("throw",ge)}function Ye(ge,Be){ge(Be),Ee.shift(),Ee.length&&Oe(Ee[0][0],Ee[0][1])}}function wt(we){var At,Qt;return At={},de("next"),de("throw",function(rn){throw rn}),de("return"),At[Symbol.iterator]=function(){return this},At;function de(rn,Ee){At[rn]=we[rn]?function(ce){return(Qt=!Qt)?{value:ht(we[rn](ce)),done:!1}:Ee?Ee(ce):ce}:Ee}}function ut(we){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var At=we[Symbol.asyncIterator],Qt;return At?At.call(we):(we=typeof P=="function"?P(we):we[Symbol.iterator](),Qt={},de("next"),de("throw"),de("return"),Qt[Symbol.asyncIterator]=function(){return this},Qt);function de(Ee){Qt[Ee]=we[Ee]&&function(ce){return new Promise(function(Oe,Ze){ce=we[Ee](ce),rn(Oe,Ze,ce.done,ce.value)})}}function rn(Ee,ce,Oe,Ze){Promise.resolve(Ze).then(function(fe){Ee({value:fe,done:Oe})},ce)}}function pt(we,At){return Object.defineProperty?Object.defineProperty(we,"raw",{value:At}):we.raw=At,we}var Nt=Object.create?function(we,At){Object.defineProperty(we,"default",{enumerable:!0,value:At})}:function(we,At){we.default=At};function Ut(we){if(we&&we.__esModule)return we;var At={};if(we!=null)for(var Qt in we)Qt!=="default"&&Object.prototype.hasOwnProperty.call(we,Qt)&&K(At,we,Qt);return Nt(At,we),At}function ue(we){return we&&we.__esModule?we:{default:we}}function se(we,At,Qt,de){if(Qt==="a"&&!de)throw new TypeError("Private accessor was defined without a getter");if(typeof At=="function"?we!==At||!de:!At.has(we))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Qt==="m"?de:Qt==="a"?de.call(we):de?de.value:At.get(we)}function Le(we,At,Qt,de,rn){if(de==="m")throw new TypeError("Private method is not writable");if(de==="a"&&!rn)throw new TypeError("Private accessor was defined without a setter");if(typeof At=="function"?we!==At||!rn:!At.has(we))throw new TypeError("Cannot write private member to an object whose class did not declare it");return de==="a"?rn.call(we,Qt):rn?rn.value=Qt:At.set(we,Qt),Qt}function Ne(we,At){if(At===null||typeof At!="object"&&typeof At!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof we=="function"?At===we:we.has(At)}},function(ot,$,Y){"use strict";var tt=Y(4),j=Y(9),W=Y(34);$.a=function(Q,Z,R,L){L===void 0&&(L="...");var C=16,A=Object(W.a)(L,R),N=Object(tt.a)(Q)?Q:Object(j.a)(Q),B=Z,O=[],F,K;if(Object(W.a)(Q,R)<=Z)return Q;for(;F=N.substr(0,C),K=Object(W.a)(F,R),!(K+A>B&&K>B);)if(O.push(F),B-=K,N=N.substr(C),!N)return O.join("");for(;F=N.substr(0,1),K=Object(W.a)(F,R),!(K+A>B);)if(O.push(F),B-=K,N=N.substr(1),!N)return O.join("");return""+O.join("")+L}},function(ot,$,Y){"use strict";var tt=function(){function j(){this.map={}}return j.prototype.has=function(W){return this.map[W]!==void 0},j.prototype.get=function(W,Q){var Z=this.map[W];return Z===void 0?Q:Z},j.prototype.set=function(W,Q){this.map[W]=Q},j.prototype.clear=function(){this.map={}},j.prototype.delete=function(W){delete this.map[W]},j.prototype.size=function(){return Object.keys(this.map).length},j}();$.a=tt},function(ot,$){function Y(R,L,C,A){A===void 0&&(A=[]);var N=this;N.w=R||0,N.h=L||0,N.y=C||0,N.x=0,N.c=A||[],N.cs=A.length,N.prelim=0,N.mod=0,N.shift=0,N.change=0,N.tl=null,N.tr=null,N.el=null,N.er=null,N.msel=0,N.mser=0}Y.fromNode=function(R,L){if(!R)return null;var C=[];return R.children.forEach(function(A){C.push(Y.fromNode(A,L))}),L?new Y(R.height,R.width,R.x,C):new Y(R.width,R.height,R.y,C)};function tt(R,L,C){C?R.y+=L:R.x+=L,R.children.forEach(function(A){tt(A,L,C)})}function j(R,L){var C=L?R.y:R.x;return R.children.forEach(function(A){C=Math.min(j(A,L),C)}),C}function W(R,L){var C=j(R,L);tt(R,-C,L)}function Q(R,L,C){C?L.y=R.x:L.x=R.x,R.c.forEach(function(A,N){Q(A,L.children[N],C)})}function Z(R,L,C){C===void 0&&(C=0),L?(R.x=C,C+=R.width):(R.y=C,C+=R.height),R.children.forEach(function(A){Z(A,L,C)})}ot.exports=function(R,L){L===void 0&&(L={});var C=L.isHorizontal;function A(ut){if(ut.cs===0){N(ut);return}A(ut.c[0]);for(var pt=mt(nt(ut.c[0].el),0,null),Nt=1;Nt<ut.cs;++Nt){A(ut.c[Nt]);var Ut=nt(ut.c[Nt].er);B(ut,Nt,pt),pt=mt(Ut,Nt,pt)}yt(ut),N(ut)}function N(ut){ut.cs===0?(ut.el=ut,ut.er=ut,ut.msel=ut.mser=0):(ut.el=ut.c[0].el,ut.msel=ut.c[0].msel,ut.er=ut.c[ut.cs-1].er,ut.mser=ut.c[ut.cs-1].mser)}function B(ut,pt,Nt){for(var Ut=ut.c[pt-1],ue=Ut.mod,se=ut.c[pt],Le=se.mod;Ut!==null&&se!==null;){nt(Ut)>Nt.low&&(Nt=Nt.nxt);var Ne=ue+Ut.prelim+Ut.w-(Le+se.prelim);Ne>0&&(Le+=Ne,O(ut,pt,Nt.index,Ne));var we=nt(Ut),At=nt(se);we<=At&&(Ut=K(Ut),Ut!==null&&(ue+=Ut.mod)),we>=At&&(se=F(se),se!==null&&(Le+=se.mod))}!Ut&&!!se?P(ut,pt,se,Le):!!Ut&&!se&&k(ut,pt,Ut,ue)}function O(ut,pt,Nt,Ut){ut.c[pt].mod+=Ut,ut.c[pt].msel+=Ut,ut.c[pt].mser+=Ut,lt(ut,pt,Nt,Ut)}function F(ut){return ut.cs===0?ut.tl:ut.c[0]}function K(ut){return ut.cs===0?ut.tr:ut.c[ut.cs-1]}function nt(ut){return ut.y+ut.h}function P(ut,pt,Nt,Ut){var ue=ut.c[0].el;ue.tl=Nt;var se=Ut-Nt.mod-ut.c[0].msel;ue.mod+=se,ue.prelim-=se,ut.c[0].el=ut.c[pt].el,ut.c[0].msel=ut.c[pt].msel}function k(ut,pt,Nt,Ut){var ue=ut.c[pt].er;ue.tr=Nt;var se=Ut-Nt.mod-ut.c[pt].mser;ue.mod+=se,ue.prelim-=se,ut.c[pt].er=ut.c[pt-1].er,ut.c[pt].mser=ut.c[pt-1].mser}function yt(ut){ut.prelim=(ut.c[0].prelim+ut.c[0].mod+ut.c[ut.cs-1].mod+ut.c[ut.cs-1].prelim+ut.c[ut.cs-1].w)/2-ut.w/2}function st(ut,pt){pt+=ut.mod,ut.x=ut.prelim+pt,ht(ut);for(var Nt=0;Nt<ut.cs;Nt++)st(ut.c[Nt],pt)}function lt(ut,pt,Nt,Ut){if(Nt!==pt-1){var ue=pt-Nt;ut.c[Nt+1].shift+=Ut/ue,ut.c[pt].shift-=Ut/ue,ut.c[pt].change-=Ut-Ut/ue}}function ht(ut){for(var pt=0,Nt=0,Ut=0;Ut<ut.cs;Ut++)pt+=ut.c[Ut].shift,Nt+=pt+ut.c[Ut].change,ut.c[Ut].mod+=Nt}function mt(ut,pt,Nt){for(;Nt!==null&&ut>=Nt.low;)Nt=Nt.nxt;return{low:ut,index:pt,nxt:Nt}}Z(R,C);var wt=Y.fromNode(R,C);return A(wt),st(wt,0),Q(wt,R,C),W(R,C),R}},function(ot,$,Y){function tt(N,B){N.prototype=Object.create(B.prototype),N.prototype.constructor=N,j(N,B)}function j(N,B){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(F,K){return F.__proto__=K,F},j(N,B)}var W=Y(11),Q=Y(121),Z=Y(17),R=Y(6),L=function(N){tt(B,N);function B(){return N.apply(this,arguments)||this}var O=B.prototype;return O.execute=function(){var K=this;return K.rootNode.width=0,Z(K.rootNode,K.options,Q)},B}(W),C={};function A(N,B){return B=R.assign({},C,B),new L(N,B).execute()}ot.exports=A},function(ot,$,Y){var tt=Y(6);function j(Z,R){Z===void 0&&(Z=0),R===void 0&&(R=[]);var L=this;L.x=L.y=0,L.leftChild=L.rightChild=null,L.height=0,L.children=R}var W={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function Q(Z,R,L){L?(R.x=Z.x,R.y=Z.y):(R.x=Z.y,R.y=Z.x),Z.children.forEach(function(C,A){Q(C,R.children[A],L)})}ot.exports=function(Z,R){R===void 0&&(R={}),R=tt.assign({},W,R);var L=0;function C(F){if(!F)return null;F.width=0,F.depth&&F.depth>L&&(L=F.depth);var K=F.children,nt=K.length,P=new j(F.height,[]);return K.forEach(function(k,yt){var st=C(k);P.children.push(st),yt===0&&(P.leftChild=st),yt===nt-1&&(P.rightChild=st)}),P.originNode=F,P.isLeaf=F.isLeaf(),P}function A(F){if(F.isLeaf||F.children.length===0)F.drawingDepth=L;else{var K=F.children.map(function(P){return A(P)}),nt=Math.min.apply(null,K);F.drawingDepth=nt-1}return F.drawingDepth}var N;function B(F){F.x=F.drawingDepth*R.rankSep,F.isLeaf?(F.y=0,N&&(F.y=N.y+N.height+R.nodeSep,F.originNode.parent!==N.originNode.parent&&(F.y+=R.subTreeSep)),N=F):(F.children.forEach(function(K){B(K)}),F.y=(F.leftChild.y+F.rightChild.y)/2)}var O=C(Z);return A(O),B(O),Q(O,Z,R.isHorizontal),Z}},function(ot,$,Y){function tt(O,F){O.prototype=Object.create(F.prototype),O.prototype.constructor=O,j(O,F)}function j(O,F){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(nt,P){return nt.__proto__=P,nt},j(O,F)}var W=Y(11),Q=Y(123),Z=Y(35),R=Y(6),L=["LR","RL","H"],C=L[0],A=function(O){tt(F,O);function F(){return O.apply(this,arguments)||this}var K=F.prototype;return K.execute=function(){var P=this,k=P.options,yt=P.rootNode;k.isHorizontal=!0;var st=k.indent,lt=st===void 0?20:st,ht=k.dropCap,mt=ht===void 0?!0:ht,wt=k.direction,ut=wt===void 0?C:wt,pt=k.align;if(ut&&L.indexOf(ut)===-1)throw new TypeError("Invalid direction: "+ut);if(ut===L[0])Q(yt,lt,mt,pt);else if(ut===L[1])Q(yt,lt,mt,pt),yt.right2left();else if(ut===L[2]){var Nt=Z(yt,k),Ut=Nt.left,ue=Nt.right;Q(Ut,lt,mt,pt),Ut.right2left(),Q(ue,lt,mt,pt);var se=Ut.getBoundingBox();ue.translate(se.width,0),yt.x=ue.x-yt.width/2}return yt},F}(W),N={};function B(O,F){return F=R.assign({},N,F),new A(O,F).execute()}ot.exports=B},function(ot,$,Y){var tt=Y(6);function j(W,Q,Z,R,L){var C=typeof Z=="function"?Z(W):Z*W.depth;if(!R)try{if(W.id===W.parent.children[0].id){W.x+=C,W.y=Q?Q.y:0;return}}catch(B){}if(W.x+=C,Q){if(W.y=Q.y+tt.getHeight(Q,W,L),Q.parent&&W.parent.id!==Q.parent.id){var A=Q.parent,N=A.y+tt.getHeight(A,W,L);W.y=N>W.y?N:W.y}}else W.y=0}ot.exports=function(W,Q,Z,R){var L=null;W.eachNode(function(C){j(C,L,Q,Z,R),L=C})}},function(ot,$,Y){function tt(N,B){N.prototype=Object.create(B.prototype),N.prototype.constructor=N,j(N,B)}function j(N,B){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(F,K){return F.__proto__=K,F},j(N,B)}var W=Y(11),Q=Y(125),Z=Y(17),R=Y(6),L=function(N){tt(B,N);function B(){return N.apply(this,arguments)||this}var O=B.prototype;return O.execute=function(){var K=this;return Z(K.rootNode,K.options,Q)},B}(W),C={};function A(N,B){return B=R.assign({},C,B),new L(N,B).execute()}ot.exports=A},function(ot,$,Y){var tt=Y(6);function j(Z,R){var L=0;return Z.children.length?Z.children.forEach(function(C){L+=j(C,R)}):L=Z.height,Z._subTreeSep=R.getSubTreeSep(Z.data),Z.totalHeight=Math.max(Z.height,L)+2*Z._subTreeSep,Z.totalHeight}function W(Z){var R=Z.children,L=R.length;if(L){R.forEach(function(F){W(F)});var C=R[0],A=R[L-1],N=A.y-C.y+A.height,B=0;if(R.forEach(function(F){B+=F.totalHeight}),N>Z.height)Z.y=C.y+N/2-Z.height/2;else if(R.length!==1||Z.height>B){var O=Z.y+(Z.height-N)/2-C.y;R.forEach(function(F){F.translate(0,O)})}else Z.y=(C.y+C.height/2+A.y+A.height/2)/2-Z.height/2}}var Q={getSubTreeSep:function(){return 0}};ot.exports=function(Z,R){R===void 0&&(R={}),R=tt.assign({},Q,R),Z.parent={x:0,width:0,height:0,y:0},Z.BFTraverse(function(L){L.x=L.parent.x+L.parent.width}),Z.parent=null,j(Z,R),Z.startY=0,Z.y=Z.totalHeight/2-Z.height/2,Z.eachNode(function(L){var C=L.children,A=C.length;if(A){var N=C[0];if(N.startY=L.startY+L._subTreeSep,A===1)N.y=L.y+L.height/2-N.height/2;else{N.y=N.startY+N.totalHeight/2-N.height/2;for(var B=1;B<A;B++){var O=C[B];O.startY=C[B-1].startY+C[B-1].totalHeight,O.y=O.startY+O.totalHeight/2-O.height/2}}}}),W(Z)}}])})},83360:function(ur,ot,$){"use strict";var Y=this&&this.__createBinding||(Object.create?function(W,Q,Z,R){R===void 0&&(R=Z);var L=Object.getOwnPropertyDescriptor(Q,Z);(!L||("get"in L?!Q.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return Q[Z]}}),Object.defineProperty(W,R,L)}:function(W,Q,Z,R){R===void 0&&(R=Z),W[R]=Q[Z]}),tt=this&&this.__exportStar||function(W,Q){for(var Z in W)Z!=="default"&&!Object.prototype.hasOwnProperty.call(Q,Z)&&Y(Q,W,Z)};Object.defineProperty(ot,"__esModule",{value:!0}),ot.getLayoutByName=ot.unRegisterLayout=ot.registerLayout=void 0;var j=$(95326);Object.defineProperty(ot,"registerLayout",{enumerable:!0,get:function(){return j.registerLayout}}),Object.defineProperty(ot,"unRegisterLayout",{enumerable:!0,get:function(){return j.unRegisterLayout}}),Object.defineProperty(ot,"getLayoutByName",{enumerable:!0,get:function(){return j.getLayoutByName}}),tt($(2584),ot)},62329:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.Base=void 0;var $=function(){function Y(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.vedges=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=function(){}}return Y.prototype.layout=function(tt){return this.init(tt),this.execute(!0)},Y.prototype.init=function(tt){this.nodes=tt.nodes||[],this.edges=tt.edges||[],this.combos=tt.combos||[],this.comboEdges=tt.comboEdges||[],this.hiddenNodes=tt.hiddenNodes||[],this.hiddenEdges=tt.hiddenEdges||[],this.hiddenCombos=tt.hiddenCombos||[],this.vedges=tt.vedges||[]},Y.prototype.execute=function(tt){},Y.prototype.executeWithWorker=function(){},Y.prototype.getDefaultCfg=function(){return{}},Y.prototype.updateCfg=function(tt){tt&&Object.assign(this,tt)},Y.prototype.getType=function(){return"base"},Y.prototype.destroy=function(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0},Y}();ot.Base=$},64885:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var L=function(C,A){return L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,B){N.__proto__=B}||function(N,B){for(var O in B)Object.prototype.hasOwnProperty.call(B,O)&&(N[O]=B[O])},L(C,A)};return function(C,A){if(typeof A!="function"&&A!==null)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");L(C,A);function N(){this.constructor=C}C.prototype=A===null?Object.create(A):(N.prototype=A.prototype,new N)}}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.CircularLayout=void 0;var tt=$(62329),j=$(49784);function W(L,C,A,N){L.forEach(function(B,O){L[O].children=[],L[O].parent=[]}),N?C.forEach(function(B){var O=(0,j.getEdgeTerminal)(B,"source"),F=(0,j.getEdgeTerminal)(B,"target"),K=0;O&&(K=A[O]);var nt=0;F&&(nt=A[F]);var P=L[K].children,k=L[nt].parent;P.push(L[nt].id),k.push(L[K].id)}):C.forEach(function(B){var O=(0,j.getEdgeTerminal)(B,"source"),F=(0,j.getEdgeTerminal)(B,"target"),K=0;O&&(K=A[O]);var nt=0;F&&(nt=A[F]);var P=L[K].children,k=L[nt].children;P.push(L[nt].id),k.push(L[K].id)})}function Q(L,C,A){for(var N=A.length,B=0;B<N;B++){var O=(0,j.getEdgeTerminal)(A[B],"source"),F=(0,j.getEdgeTerminal)(A[B],"target");if(L.id===O&&C.id===F||C.id===O&&L.id===F)return!0}return!1}function Z(L,C){var A=L.degree,N=C.degree;return A<N?-1:A>N?1:0}var R=function(L){Y(C,L);function C(A){var N=L.call(this)||this;return N.radius=null,N.nodeSize=void 0,N.startRadius=null,N.endRadius=null,N.startAngle=0,N.endAngle=2*Math.PI,N.clockwise=!0,N.divisions=1,N.ordering=null,N.angleRatio=1,N.nodes=[],N.edges=[],N.nodeMap={},N.degrees=[],N.width=300,N.height=300,N.updateCfg(A),N}return C.prototype.getDefaultCfg=function(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}},C.prototype.execute=function(){var A,N=this,B=N.nodes,O=N.edges,F=B.length;if(F===0){N.onLayoutEnd&&N.onLayoutEnd();return}!N.width&&typeof window!="undefined"&&(N.width=window.innerWidth),!N.height&&typeof window!="undefined"&&(N.height=window.innerHeight),N.center||(N.center=[N.width/2,N.height/2]);var K=N.center;if(F===1){B[0].x=K[0],B[0].y=K[1],N.onLayoutEnd&&N.onLayoutEnd();return}var nt=N.radius,P=N.startRadius,k=N.endRadius,yt=N.divisions,st=N.startAngle,lt=N.endAngle,ht=N.angleRatio,mt=N.ordering,wt=N.clockwise,ut=N.nodeSpacing,pt=N.nodeSize,Nt=(lt-st)/F,Ut={};B.forEach(function(Oe,Ze){Ut[Oe.id]=Ze}),N.nodeMap=Ut;var ue=(0,j.getDegree)(B.length,Ut,O);if(N.degrees=ue,ut){var se=(0,j.getFuncByUnknownType)(10,ut),Le=(0,j.getFuncByUnknownType)(10,pt),Ne=-Infinity;B.forEach(function(Oe){var Ze=Le(Oe);Ne<Ze&&(Ne=Ze)});var we=0;B.forEach(function(Oe,Ze){Ze===0?we+=Ne||10:we+=(se(Oe)||0)+(Ne||10)}),nt=we/(2*Math.PI)}else!nt&&!P&&!k?nt=N.height>N.width?N.width/2:N.height/2:!P&&k?P=k:P&&!k&&(k=P);var At=Nt*ht,Qt=[];mt==="topology"?Qt=N.topologyOrdering():mt==="topology-directed"?Qt=N.topologyOrdering(!0):mt==="degree"?Qt=N.degreeOrdering():Qt=B;for(var de=Math.ceil(F/yt),rn=0;rn<F;++rn){var Ee=nt;!Ee&&P!==null&&k!==null&&(Ee=P+rn*(k-P)/(F-1)),Ee||(Ee=10+rn*100/(F-1));var ce=st+rn%de*At+2*Math.PI/yt*Math.floor(rn/de);wt||(ce=lt-rn%de*At-2*Math.PI/yt*Math.floor(rn/de)),Qt[rn].x=K[0]+Math.cos(ce)*Ee,Qt[rn].y=K[1]+Math.sin(ce)*Ee,Qt[rn].weight=ue[rn].all}return(A=N.onLayoutEnd)===null||A===void 0||A.call(N),{nodes:Qt,edges:this.edges}},C.prototype.topologyOrdering=function(A){A===void 0&&(A=!1);var N=this,B=N.degrees,O=N.edges,F=N.nodes,K=(0,j.clone)(F),nt=N.nodeMap,P=[K[0]],k=[F[0]],yt=[],st=F.length;yt[0]=!0,W(K,O,nt,A);var lt=0;return K.forEach(function(ht,mt){if(mt!==0)if((mt===st-1||B[mt].all!==B[mt+1].all||Q(P[lt],ht,O))&&!yt[mt])P.push(ht),k.push(F[nt[ht.id]]),yt[mt]=!0,lt++;else{for(var wt=P[lt].children,ut=!1,pt=0;pt<wt.length;pt++){var Nt=nt[wt[pt]];if(B[Nt].all===B[mt].all&&!yt[Nt]){P.push(K[Nt]),k.push(F[nt[K[Nt].id]]),yt[Nt]=!0,ut=!0;break}}for(var Ut=0;!ut&&(yt[Ut]||(P.push(K[Ut]),k.push(F[nt[K[Ut].id]]),yt[Ut]=!0,ut=!0),Ut++,Ut!==st););}}),k},C.prototype.degreeOrdering=function(){var A=this,N=A.nodes,B=[],O=A.degrees;return N.forEach(function(F,K){F.degree=O[K].all,B.push(F)}),B.sort(Z),B},C.prototype.getType=function(){return"circular"},C}(tt.Base);ot.CircularLayout=R},63861:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var L=function(C,A){return L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,B){N.__proto__=B}||function(N,B){for(var O in B)Object.prototype.hasOwnProperty.call(B,O)&&(N[O]=B[O])},L(C,A)};return function(C,A){if(typeof A!="function"&&A!==null)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");L(C,A);function N(){this.constructor=C}C.prototype=A===null?Object.create(A):(N.prototype=A.prototype,new N)}}(),tt=this&&this.__assign||function(){return tt=Object.assign||function(L){for(var C,A=1,N=arguments.length;A<N;A++){C=arguments[A];for(var B in C)Object.prototype.hasOwnProperty.call(C,B)&&(L[B]=C[B])}return L},tt.apply(this,arguments)};Object.defineProperty(ot,"__esModule",{value:!0}),ot.ComboCombinedLayout=void 0;var j=$(16470),W=$(62329),Q=$(49784),Z=$(2584),R=function(L){Y(C,L);function C(A){var N=L.call(this)||this;return N.center=[0,0],N.nodes=[],N.edges=[],N.combos=[],N.comboEdges=[],N.comboPadding=10,N.comboTrees=[],N.updateCfg(A),N}return C.prototype.getDefaultCfg=function(){return{}},C.prototype.execute=function(){var A=this,N=A.nodes,B=A.center;if(!N||N.length===0){A.onLayoutEnd&&A.onLayoutEnd();return}if(N.length===1){N[0].x=B[0],N[0].y=B[1],A.onLayoutEnd&&A.onLayoutEnd();return}A.initVals(),A.run(),A.onLayoutEnd&&A.onLayoutEnd()},C.prototype.run=function(){var A,N=this,B=N.nodes,O=N.edges,F=N.combos,K=N.comboEdges,nt=N.center,P={};B.forEach(function(Ne){P[Ne.id]=Ne});var k={};F.forEach(function(Ne){k[Ne.id]=Ne});var yt=N.getInnerGraphs(P),st=[],lt=[],ht={},mt=!0;this.comboTrees.forEach(function(Ne){var we=yt[Ne.id],At=tt(tt({},Ne),{x:we.x||k[Ne.id].x,y:we.y||k[Ne.id].y,fx:we.fx||k[Ne.id].fx,fy:we.fy||k[Ne.id].fy,mass:we.mass||k[Ne.id].mass,size:we.size});lt.push(At),!isNaN(At.x)&&At.x!==0&&!isNaN(At.y)&&At.y!==0?mt=!1:(At.x=Math.random()*100,At.y=Math.random()*100),st.push(Ne.id),(0,Q.traverseTreeUp)(Ne,function(Qt){return Qt.id!==Ne.id&&(ht[Qt.id]=Ne.id),!0})}),B.forEach(function(Ne){if(!(Ne.comboId&&k[Ne.comboId])){var we=tt({},Ne);lt.push(we),!isNaN(we.x)&&we.x!==0&&!isNaN(we.y)&&we.y!==0?mt=!1:(we.x=Math.random()*100,we.y=Math.random()*100),st.push(Ne.id)}});var wt=[];if(O.concat(K).forEach(function(Ne){var we=ht[Ne.source]||Ne.source,At=ht[Ne.target]||Ne.target;we!==At&&st.includes(we)&&st.includes(At)&&wt.push({source:we,target:At})}),lt==null?void 0:lt.length){if(lt.length===1)lt[0].x=nt[0],lt[0].y=nt[1];else{var ut={nodes:lt,edges:wt},pt=this.outerLayout||new Z.GForceLayout({gravity:1,factor:4,linkDistance:function(Ne,we,At){var Qt,de,rn=((((Qt=we.size)===null||Qt===void 0?void 0:Qt[0])||30)+(((de=At.size)===null||de===void 0?void 0:de[0])||30))/2;return Math.min(rn*1.5,700)}}),Nt=(A=pt.getType)===null||A===void 0?void 0:A.call(pt);if(pt.updateCfg({center:nt,kg:5,preventOverlap:!0,animate:!1}),mt&&j.FORCE_LAYOUT_TYPE_MAP[Nt]){var Ut=lt.length<100?new Z.MDSLayout:new Z.GridLayout;Ut.layout(ut)}pt.layout(ut)}lt.forEach(function(Ne){var we=yt[Ne.id];if(!we){var At=P[Ne.id];At&&(At.x=Ne.x,At.y=Ne.y);return}we.visited=!0,we.x=Ne.x,we.y=Ne.y,we.nodes.forEach(function(Qt){Qt.x+=Ne.x,Qt.y+=Ne.y})})}for(var ue=Object.keys(yt),se=function(Ne){var we=ue[Ne],At=yt[we];if(!At)return"continue";At.nodes.forEach(function(Qt){At.visited||(Qt.x+=At.x||0,Qt.y+=At.y||0),P[Qt.id]&&(P[Qt.id].x=Qt.x,P[Qt.id].y=Qt.y)}),k[we]&&(k[we].x=At.x,k[we].y=At.y)},Le=ue.length-1;Le>=0;Le--)se(Le);return{nodes:B,edges:O,combos:F,comboEdges:K}},C.prototype.getInnerGraphs=function(A){var N=this,B=N.comboTrees,O=N.nodeSize,F=N.edges,K=N.comboPadding,nt=N.spacing,P={},k=this.innerLayout||new Z.ConcentricLayout({type:"concentric",sortBy:"id"});return k.center=[0,0],k.preventOverlap=!0,k.nodeSpacing=nt,(B||[]).forEach(function(yt){(0,Q.traverseTreeUp)(yt,function(st){var lt,ht=(K==null?void 0:K(st))||10;if((0,Q.isArray)(ht)&&(ht=Math.max.apply(Math,ht)),(lt=st.children)===null||lt===void 0?void 0:lt.length){var wt=st.children.map(function(de){if(de.itemType==="combo")return P[de.id];var rn=A[de.id]||{};return tt(tt({},rn),de)}),ut=wt.map(function(de){return de.id}),pt={nodes:wt,edges:F.filter(function(de){return ut.includes(de.source)&&ut.includes(de.target)})},Nt=Infinity;wt.forEach(function(de){var rn;de.size||(de.size=((rn=P[de.id])===null||rn===void 0?void 0:rn.size)||(O==null?void 0:O(de))||[30,30]),(0,Q.isNumber)(de.size)&&(de.size=[de.size,de.size]),Nt>de.size[0]&&(Nt=de.size[0]),Nt>de.size[1]&&(Nt=de.size[1])}),k.layout(pt);var Ut=(0,Q.getLayoutBBox)(wt),ue=Ut.minX,se=Ut.minY,Le=Ut.maxX,Ne=Ut.maxY,we={x:(Le+ue)/2,y:(Ne+se)/2};pt.nodes.forEach(function(de){de.x-=we.x,de.y-=we.y});var At=Math.max(Le-ue,Nt)+ht*2,Qt=Math.max(Ne-se,Nt)+ht*2;P[st.id]={id:st.id,nodes:wt,size:[At,Qt]}}else if(st.itemType==="combo"){var mt=ht?[ht*2,ht*2]:[30,30];P[st.id]={id:st.id,nodes:[],size:mt}}return!0})}),P},C.prototype.initVals=function(){var A=this,N=A.nodeSize,B=A.spacing,O,F;if((0,Q.isNumber)(B)?F=function(){return B}:(0,Q.isFunction)(B)?F=B:F=function(){return 0},this.spacing=F,!N)O=function(st){var lt=F(st);if(st.size){if((0,Q.isArray)(st.size)){var ht=st.size[0]>st.size[1]?st.size[0]:st.size[1];return(ht+lt)/2}if((0,Q.isObject)(st.size)){var ht=st.size.width>st.size.height?st.size.width:st.size.height;return(ht+lt)/2}return(st.size+lt)/2}return 10+lt/2};else if((0,Q.isFunction)(N))O=function(st){var lt=N(st),ht=F(st);if((0,Q.isArray)(st.size)){var mt=st.size[0]>st.size[1]?st.size[0]:st.size[1];return(mt+ht)/2}return((lt||10)+ht)/2};else if((0,Q.isArray)(N)){var K=N[0]>N[1]?N[0]:N[1],nt=K/2;O=function(st){return nt+F(st)/2}}else{var P=N/2;O=function(st){return P+F(st)/2}}this.nodeSize=O;var k=A.comboPadding,yt;(0,Q.isNumber)(k)?yt=function(){return k}:(0,Q.isArray)(k)?yt=function(){return Math.max.apply(null,k)}:(0,Q.isFunction)(k)?yt=k:yt=function(){return 0},this.comboPadding=yt},C.prototype.getType=function(){return"comboCombined"},C}(W.Base);ot.ComboCombinedLayout=R},66590:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var Q=function(Z,R){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,C){L.__proto__=C}||function(L,C){for(var A in C)Object.prototype.hasOwnProperty.call(C,A)&&(L[A]=C[A])},Q(Z,R)};return function(Z,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");Q(Z,R);function L(){this.constructor=Z}Z.prototype=R===null?Object.create(R):(L.prototype=R.prototype,new L)}}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.ComboForceLayout=void 0;var tt=$(62329),j=$(49784),W=function(Q){Y(Z,Q);function Z(R){var L=Q.call(this)||this;return L.center=[0,0],L.maxIteration=100,L.gravity=10,L.comboGravity=10,L.linkDistance=10,L.alpha=1,L.alphaMin=.001,L.alphaDecay=1-Math.pow(L.alphaMin,1/300),L.alphaTarget=0,L.velocityDecay=.6,L.edgeStrength=.6,L.nodeStrength=30,L.preventOverlap=!1,L.preventNodeOverlap=!1,L.preventComboOverlap=!1,L.collideStrength=void 0,L.nodeCollideStrength=.5,L.comboCollideStrength=.5,L.comboSpacing=20,L.comboPadding=10,L.optimizeRangeFactor=1,L.onTick=function(){},L.onLayoutEnd=function(){},L.depthAttractiveForceScale=1,L.depthRepulsiveForceScale=2,L.nodes=[],L.edges=[],L.combos=[],L.comboTrees=[],L.width=300,L.height=300,L.bias=[],L.nodeMap={},L.oriComboMap={},L.indexMap={},L.comboMap={},L.previousLayouted=!1,L.updateCfg(R),L}return Z.prototype.getDefaultCfg=function(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}},Z.prototype.execute=function(){var R=this,L=R.nodes,C=R.center;if(R.comboTree={id:"comboTreeRoot",depth:-1,children:R.comboTrees},!L||L.length===0){R.onLayoutEnd&&R.onLayoutEnd();return}if(L.length===1){L[0].x=C[0],L[0].y=C[1],R.onLayoutEnd&&R.onLayoutEnd();return}R.initVals(),R.run(),R.onLayoutEnd&&R.onLayoutEnd()},Z.prototype.run=function(){var R=this,L=R.nodes,C=R.previousLayouted?R.maxIteration/5:R.maxIteration;!R.width&&typeof window!="undefined"&&(R.width=window.innerWidth),!R.height&&typeof window!="undefined"&&(R.height=window.innerHeight);var A=R.center,N=R.velocityDecay,B=R.comboMap;R.previousLayouted||R.initPos(B);for(var O=function(P){var k=[];L.forEach(function(yt,st){k[st]={x:0,y:0}}),R.applyCalculate(k),R.applyComboCenterForce(k),L.forEach(function(yt,st){!(0,j.isNumber)(yt.x)||!(0,j.isNumber)(yt.y)||(yt.x+=k[st].x*N,yt.y+=k[st].y*N)}),R.alpha+=(R.alphaTarget-R.alpha)*R.alphaDecay,R.onTick()},F=0;F<C;F++)O(F);var K=[0,0];L.forEach(function(P){!(0,j.isNumber)(P.x)||!(0,j.isNumber)(P.y)||(K[0]+=P.x,K[1]+=P.y)}),K[0]/=L.length,K[1]/=L.length;var nt=[A[0]-K[0],A[1]-K[1]];L.forEach(function(P,k){!(0,j.isNumber)(P.x)||!(0,j.isNumber)(P.y)||(P.x+=nt[0],P.y+=nt[1])}),R.combos.forEach(function(P){var k=B[P.id];k&&k.empty&&(P.x=k.cx||P.x,P.y=k.cy||P.y)}),R.previousLayouted=!0},Z.prototype.initVals=function(){var R=this,L=R.edges,C=R.nodes,A=R.combos,N={},B={},O={};C.forEach(function(Ee,ce){B[Ee.id]=Ee,O[Ee.id]=ce}),R.nodeMap=B,R.indexMap=O;var F={};A.forEach(function(Ee){F[Ee.id]=Ee}),R.oriComboMap=F,R.comboMap=R.getComboMap();var K=R.preventOverlap;R.preventComboOverlap=R.preventComboOverlap||K,R.preventNodeOverlap=R.preventNodeOverlap||K;var nt=R.collideStrength;nt&&(R.comboCollideStrength=nt,R.nodeCollideStrength=nt),R.comboCollideStrength=R.comboCollideStrength?R.comboCollideStrength:0,R.nodeCollideStrength=R.nodeCollideStrength?R.nodeCollideStrength:0;for(var P=0;P<L.length;++P){var k=(0,j.getEdgeTerminal)(L[P],"source"),yt=(0,j.getEdgeTerminal)(L[P],"target");N[k]?N[k]++:N[k]=1,N[yt]?N[yt]++:N[yt]=1}for(var st=[],P=0;P<L.length;++P){var k=(0,j.getEdgeTerminal)(L[P],"source"),yt=(0,j.getEdgeTerminal)(L[P],"target");st[P]=N[k]/(N[k]+N[yt])}this.bias=st;var lt=R.nodeSize,ht=R.nodeSpacing,mt,wt;if((0,j.isNumber)(ht)?wt=function(){return ht}:(0,j.isFunction)(ht)?wt=ht:wt=function(){return 0},this.nodeSpacing=wt,!lt)mt=function(Ee){if(Ee.size){if((0,j.isArray)(Ee.size)){var ce=Ee.size[0]>Ee.size[1]?Ee.size[0]:Ee.size[1];return ce/2}if((0,j.isObject)(Ee.size)){var ce=Ee.size.width>Ee.size.height?Ee.size.width:Ee.size.height;return ce/2}return Ee.size/2}return 10};else if((0,j.isFunction)(lt))mt=function(Ee){return lt(Ee)};else if((0,j.isArray)(lt)){var ut=lt[0]>lt[1]?lt[0]:lt[1],pt=ut/2;mt=function(Ee){return pt}}else{var Nt=lt/2;mt=function(Ee){return Nt}}this.nodeSize=mt;var Ut=R.comboSpacing,ue;(0,j.isNumber)(Ut)?ue=function(){return Ut}:(0,j.isFunction)(Ut)?ue=Ut:ue=function(){return 0},this.comboSpacing=ue;var se=R.comboPadding,Le;(0,j.isNumber)(se)?Le=function(){return se}:(0,j.isArray)(se)?Le=function(){return Math.max.apply(null,se)}:(0,j.isFunction)(se)?Le=se:Le=function(){return 0},this.comboPadding=Le;var Ne=this.linkDistance,we;Ne||(Ne=10),(0,j.isNumber)(Ne)?we=function(Ee){return Ne}:we=Ne,this.linkDistance=we;var At=this.edgeStrength,Qt;At||(At=1),(0,j.isNumber)(At)?Qt=function(Ee){return At}:Qt=At,this.edgeStrength=Qt;var de=this.nodeStrength,rn;de||(de=30),(0,j.isNumber)(de)?rn=function(Ee){return de}:rn=de,this.nodeStrength=rn},Z.prototype.initPos=function(R){var L=this,C=L.nodes;C.forEach(function(A,N){var B=A.comboId,O=R[B];B&&O?(A.x=O.cx+100/(N+1),A.y=O.cy+100/(N+1)):(A.x=100/(N+1),A.y=100/(N+1))})},Z.prototype.getComboMap=function(){var R=this,L=R.nodeMap,C=R.comboTrees,A=R.oriComboMap,N={};return(C||[]).forEach(function(B){var O=[];(0,j.traverseTreeUp)(B,function(F){if(F.itemType==="node"||!A[F.id])return!0;if(N[F.id]===void 0){var K={id:F.id,name:F.id,cx:0,cy:0,count:0,depth:R.oriComboMap[F.id].depth||0,children:[]};N[F.id]=K}var nt=F.children;nt&&nt.forEach(function(yt){if(!N[yt.id]&&!L[yt.id])return!0;O.push(yt)});var P=N[F.id];if(P.cx=0,P.cy=0,O.length===0){P.empty=!0;var k=A[F.id];P.cx=k.x,P.cy=k.y}return O.forEach(function(yt){if(P.count++,yt.itemType!=="node"){var st=N[yt.id];(0,j.isNumber)(st.cx)&&(P.cx+=st.cx),(0,j.isNumber)(st.cy)&&(P.cy+=st.cy);return}var lt=L[yt.id];!lt||((0,j.isNumber)(lt.x)&&(P.cx+=lt.x),(0,j.isNumber)(lt.y)&&(P.cy+=lt.y))}),P.cx/=P.count||1,P.cy/=P.count||1,P.children=O,!0})}),N},Z.prototype.applyComboCenterForce=function(R){var L=this,C=L.gravity,A=L.comboGravity||C,N=this.alpha,B=L.comboTrees,O=L.indexMap,F=L.nodeMap,K=L.comboMap;(B||[]).forEach(function(nt){(0,j.traverseTreeUp)(nt,function(P){if(P.itemType==="node")return!0;var k=K[P.id];if(!k)return!0;var yt=K[P.id],st=(yt.depth+1)/10*.5,lt=yt.cx,ht=yt.cy;return yt.cx=0,yt.cy=0,yt.children.forEach(function(mt){if(mt.itemType!=="node"){var wt=K[mt.id];wt&&(0,j.isNumber)(wt.cx)&&(yt.cx+=wt.cx),wt&&(0,j.isNumber)(wt.cy)&&(yt.cy+=wt.cy);return}var ut=F[mt.id],pt=ut.x-lt||.005,Nt=ut.y-ht||.005,Ut=Math.sqrt(pt*pt+Nt*Nt),ue=O[ut.id],se=A*N/Ut*st;R[ue].x-=pt*se,R[ue].y-=Nt*se,(0,j.isNumber)(ut.x)&&(yt.cx+=ut.x),(0,j.isNumber)(ut.y)&&(yt.cy+=ut.y)}),yt.cx/=yt.count||1,yt.cy/=yt.count||1,!0})})},Z.prototype.applyCalculate=function(R){var L=this,C=L.comboMap,A=L.nodes,N={};A.forEach(function(O,F){A.forEach(function(K,nt){if(!(F<nt)){var P=O.x-K.x||.005,k=O.y-K.y||.005,yt=P*P+k*k,st=Math.sqrt(yt);yt<1&&(yt=st),N["".concat(O.id,"-").concat(K.id)]={vx:P,vy:k,vl2:yt,vl:st},N["".concat(K.id,"-").concat(O.id)]={vl2:yt,vl:st,vx:-P,vy:-k}}})}),L.updateComboSizes(C),L.calRepulsive(R,N),L.calAttractive(R,N);var B=L.preventComboOverlap;B&&L.comboNonOverlapping(R,C)},Z.prototype.updateComboSizes=function(R){var L=this,C=L.comboTrees,A=L.nodeMap,N=L.nodeSize,B=L.comboSpacing,O=L.comboPadding;(C||[]).forEach(function(F){var K=[];(0,j.traverseTreeUp)(F,function(nt){if(nt.itemType==="node")return!0;var P=R[nt.id];if(!P)return!1;var k=nt.children;k&&k.forEach(function(lt){!R[lt.id]&&!A[lt.id]||K.push(lt)}),P.minX=Infinity,P.minY=Infinity,P.maxX=-Infinity,P.maxY=-Infinity,K.forEach(function(lt){if(lt.itemType!=="node")return!0;var ht=A[lt.id];if(!ht)return!0;var mt=N(ht),wt=ht.x-mt,ut=ht.y-mt,pt=ht.x+mt,Nt=ht.y+mt;P.minX>wt&&(P.minX=wt),P.minY>ut&&(P.minY=ut),P.maxX<pt&&(P.maxX=pt),P.maxY<Nt&&(P.maxY=Nt)});var yt=L.oriComboMap[nt.id].size||10;(0,j.isArray)(yt)&&(yt=yt[0]);var st=Math.max(P.maxX-P.minX,P.maxY-P.minY,yt);return P.r=st/2+B(P)/2+O(P),!0})})},Z.prototype.comboNonOverlapping=function(R,L){var C=this,A=C.comboTree,N=C.comboCollideStrength,B=C.indexMap,O=C.nodeMap;(0,j.traverseTreeUp)(A,function(F){if(!L[F.id]&&!O[F.id]&&F.id!=="comboTreeRoot")return!1;var K=F.children;return K&&K.length>1&&K.forEach(function(nt,P){if(nt.itemType==="node")return!1;var k=L[nt.id];!k||K.forEach(function(yt,st){if(P<=st||yt.itemType==="node")return!1;var lt=L[yt.id];if(!lt)return!1;var ht=k.cx-lt.cx||.005,mt=k.cy-lt.cy||.005,wt=ht*ht+mt*mt,ut=k.r||1,pt=lt.r||1,Nt=ut+pt,Ut=pt*pt,ue=ut*ut;if(wt<Nt*Nt){var se=nt.children;if(!se||se.length===0)return!1;var Le=yt.children;if(!Le||Le.length===0)return!1;var Ne=Math.sqrt(wt),we=(Nt-Ne)/Ne*N,At=ht*we,Qt=mt*we,de=Ut/(ue+Ut),rn=1-de;se.forEach(function(Ee){if(Ee.itemType!=="node")return!1;if(!!O[Ee.id]){var ce=B[Ee.id];Le.forEach(function(Oe){if(Oe.itemType!=="node"||!O[Oe.id])return!1;var Ze=B[Oe.id];R[ce].x+=At*de,R[ce].y+=Qt*de,R[Ze].x-=At*rn,R[Ze].y-=Qt*rn})}})}})}),!0})},Z.prototype.calRepulsive=function(R,L){var C=this,A=C.nodes,N=C.width*C.optimizeRangeFactor,B=C.nodeStrength,O=C.alpha,F=C.nodeCollideStrength,K=C.preventNodeOverlap,nt=C.nodeSize,P=C.nodeSpacing,k=C.depthRepulsiveForceScale,yt=C.center;A.forEach(function(st,lt){if(!(!st.x||!st.y)){if(yt){var ht=C.gravity,mt=st.x-yt[0]||.005,wt=st.y-yt[1]||.005,ut=Math.sqrt(mt*mt+wt*wt);R[lt].x-=mt*ht*O/ut,R[lt].y-=wt*ht*O/ut}A.forEach(function(pt,Nt){if(lt!==Nt&&!(!pt.x||!pt.y)){var Ut=L["".concat(st.id,"-").concat(pt.id)],ue=Ut.vl2,se=Ut.vl;if(!(se>N)){var Le=L["".concat(st.id,"-").concat(pt.id)],Ne=Le.vx,we=Le.vy,At=Math.log(Math.abs(pt.depth-st.depth)/10)+1||1;At=At<1?1:At,pt.comboId!==st.comboId&&(At+=1);var Qt=At?Math.pow(k,At):1,de=B(pt)*O/ue*Qt;if(R[lt].x+=Ne*de,R[lt].y+=we*de,lt<Nt&&K){var rn=nt(st)+P(st)||1,Ee=nt(pt)+P(pt)||1,ce=rn+Ee;if(ue<ce*ce){var Oe=(ce-se)/se*F,Ze=Ee*Ee,fe=Ze/(rn*rn+Ze),Ae=Ne*Oe,Ye=we*Oe;R[lt].x+=Ae*fe,R[lt].y+=Ye*fe,fe=1-fe,R[Nt].x-=Ae*fe,R[Nt].y-=Ye*fe}}}}})}})},Z.prototype.calAttractive=function(R,L){var C=this,A=C.edges,N=C.linkDistance,B=C.alpha,O=C.edgeStrength,F=C.bias,K=C.depthAttractiveForceScale;A.forEach(function(nt,P){var k=(0,j.getEdgeTerminal)(nt,"source"),yt=(0,j.getEdgeTerminal)(nt,"target");if(!(!k||!yt||k===yt)){var st=C.indexMap[k],lt=C.indexMap[yt],ht=C.nodeMap[k],mt=C.nodeMap[yt];if(!(!ht||!mt)){var wt=ht.depth===mt.depth?0:Math.log(Math.abs(ht.depth-mt.depth)/10);ht.comboId===mt.comboId&&(wt=wt/2);var ut=wt?Math.pow(K,wt):1;if(ht.comboId!==mt.comboId&&ut===1?ut=K/2:ht.comboId===mt.comboId&&(ut=2),!(!(0,j.isNumber)(mt.x)||!(0,j.isNumber)(ht.x)||!(0,j.isNumber)(mt.y)||!(0,j.isNumber)(ht.y))){var pt=L["".concat(yt,"-").concat(k)],Nt=pt.vl,Ut=pt.vx,ue=pt.vy,se=(Nt-N(nt))/Nt*B*O(nt)*ut,Le=Ut*se,Ne=ue*se,we=F[P];R[lt].x-=Le*we,R[lt].y-=Ne*we,R[st].x+=Le*(1-we),R[st].y+=Ne*(1-we)}}}})},Z.prototype.getType=function(){return"comboForce"},Z}(tt.Base);ot.ComboForceLayout=W},43281:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var Q=function(Z,R){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,C){L.__proto__=C}||function(L,C){for(var A in C)Object.prototype.hasOwnProperty.call(C,A)&&(L[A]=C[A])},Q(Z,R)};return function(Z,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");Q(Z,R);function L(){this.constructor=Z}Z.prototype=R===null?Object.create(R):(L.prototype=R.prototype,new L)}}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.ConcentricLayout=void 0;var tt=$(49784),j=$(62329),W=function(Q){Y(Z,Q);function Z(R){var L=Q.call(this)||this;return L.nodeSize=30,L.minNodeSpacing=10,L.nodeSpacing=10,L.preventOverlap=!1,L.equidistant=!1,L.startAngle=3/2*Math.PI,L.clockwise=!0,L.sortBy="degree",L.nodes=[],L.edges=[],L.width=300,L.height=300,L.onLayoutEnd=function(){},L.updateCfg(R),L}return Z.prototype.getDefaultCfg=function(){return{nodeSize:30,minNodeSpacing:10,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}},Z.prototype.execute=function(){var R,L,C=this,A=C.nodes,N=C.edges,B=A.length;if(B===0){(R=C.onLayoutEnd)===null||R===void 0||R.call(C);return}!C.width&&typeof window!="undefined"&&(C.width=window.innerWidth),!C.height&&typeof window!="undefined"&&(C.height=window.innerHeight),C.center||(C.center=[C.width/2,C.height/2]);var O=C.center;if(B===1){A[0].x=O[0],A[0].y=O[1],(L=C.onLayoutEnd)===null||L===void 0||L.call(C);return}var F=C.nodeSize,K=C.nodeSpacing,nt=[],P,k=0;(0,tt.isArray)(F)?P=Math.max(F[0],F[1]):P=F,(0,tt.isArray)(K)?k=Math.max(K[0],K[1]):(0,tt.isNumber)(K)&&(k=K),A.forEach(function(At){nt.push(At);var Qt=P;(0,tt.isArray)(At.size)?Qt=Math.max(At.size[0],At.size[1]):(0,tt.isNumber)(At.size)?Qt=At.size:(0,tt.isObject)(At.size)&&(Qt=Math.max(At.size.width,At.size.height)),P=Math.max(P,Qt),(0,tt.isFunction)(K)&&(k=Math.max(K(At),k))}),C.clockwise=C.counterclockwise!==void 0?!C.counterclockwise:C.clockwise;var yt={},st={};if(nt.forEach(function(At,Qt){yt[At.id]=At,st[At.id]=Qt}),(C.sortBy==="degree"||!(0,tt.isString)(C.sortBy)||nt[0][C.sortBy]===void 0)&&(C.sortBy="degree",!(0,tt.isNumber)(A[0].degree))){var lt=(0,tt.getDegree)(A.length,st,N);nt.forEach(function(At,Qt){At.degree=lt[Qt].all})}nt.sort(function(At,Qt){return Qt[C.sortBy]-At[C.sortBy]}),C.maxValueNode=nt[0],C.maxLevelDiff=C.maxLevelDiff||C.maxValueNode[C.sortBy]/4;var ht=[[]],mt=ht[0];nt.forEach(function(At){if(mt.length>0){var Qt=Math.abs(mt[0][C.sortBy]-At[C.sortBy]);C.maxLevelDiff&&Qt>=C.maxLevelDiff&&(mt=[],ht.push(mt))}mt.push(At)});var wt=P+(k||C.minNodeSpacing);if(!C.preventOverlap){var ut=ht.length>0&&ht[0].length>1,pt=Math.min(C.width,C.height)/2-wt,Nt=pt/(ht.length+(ut?1:0));wt=Math.min(wt,Nt)}var Ut=0;if(ht.forEach(function(At){var Qt=C.sweep;Qt===void 0&&(Qt=2*Math.PI-2*Math.PI/At.length);var de=At.dTheta=Qt/Math.max(1,At.length-1);if(At.length>1&&C.preventOverlap){var rn=Math.cos(de)-Math.cos(0),Ee=Math.sin(de)-Math.sin(0),ce=Math.sqrt(wt*wt/(rn*rn+Ee*Ee));Ut=Math.max(ce,Ut)}At.r=Ut,Ut+=wt}),C.equidistant){for(var ue=0,se=0,Le=0;Le<ht.length;Le++){var Ne=ht[Le],we=Ne.r-se;ue=Math.max(ue,we)}se=0,ht.forEach(function(At,Qt){Qt===0&&(se=At.r),At.r=se,se+=ue})}return ht.forEach(function(At){var Qt=At.dTheta,de=At.r;At.forEach(function(rn,Ee){var ce=C.startAngle+(C.clockwise?1:-1)*Qt*Ee;rn.x=O[0]+de*Math.cos(ce),rn.y=O[1]+de*Math.sin(ce)})}),C.onLayoutEnd&&C.onLayoutEnd(),{nodes:A,edges:N}},Z.prototype.getType=function(){return"concentric"},Z}(j.Base);ot.ConcentricLayout=W},16470:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.FORCE_LAYOUT_TYPE_MAP=ot.LAYOUT_MESSAGE=void 0,ot.LAYOUT_MESSAGE={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"},ot.FORCE_LAYOUT_TYPE_MAP={gForce:!0,force2:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0}},20171:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var C=function(A,N){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,O){B.__proto__=O}||function(B,O){for(var F in O)Object.prototype.hasOwnProperty.call(O,F)&&(B[F]=O[F])},C(A,N)};return function(A,N){if(typeof N!="function"&&N!==null)throw new TypeError("Class extends value "+String(N)+" is not a constructor or null");C(A,N);function B(){this.constructor=A}A.prototype=N===null?Object.create(N):(B.prototype=N.prototype,new B)}}(),tt=this&&this.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(ot,"__esModule",{value:!0}),ot.DagreLayout=void 0;var j=tt($(41106)),W=$(49784),Q=$(62329),Z=$(27652),R=function(C){Y(A,C);function A(N){var B=C.call(this)||this;return B.rankdir="TB",B.nodesep=50,B.ranksep=50,B.controlPoints=!1,B.sortByCombo=!1,B.edgeLabelSpace=!0,B.radial=!1,B.nodes=[],B.edges=[],B.onLayoutEnd=function(){},B.layoutNode=function(O){var F=B,K=F.nodes,nt=K.find(function(k){return k.id===O});if(nt){var P=nt.layout!==!1;return P}return!0},B.updateCfg(N),B}return A.prototype.getDefaultCfg=function(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}},A.prototype.execute=function(){var N=this,B,O,F,K,nt=this,P=nt.nodes,k=nt.nodeSize,yt=nt.rankdir,st=nt.combos,lt=nt.begin,ht=nt.radial,mt=nt.comboEdges,wt=mt===void 0?[]:mt,ut=nt.vedges,pt=ut===void 0?[]:ut;if(!!P){var Nt=nt.edges||[],Ut=new Z.Graph({multigraph:!0,compound:!0});nt.nodeMap={};var ue={};P.forEach(function(_n){nt.nodeMap[_n.id]=_n,!!_n.comboId&&(ue[_n.comboId]=ue[_n.comboId]||[],ue[_n.comboId].push(_n.id))});var se=[],Le={};((B=nt.nodeOrder)===null||B===void 0?void 0:B.length)?(nt.nodeOrder.forEach(function(_n){Le[_n]=!0,se.push(nt.nodeMap[_n])}),P.forEach(function(_n){Le[_n.id]||se.push(_n)})):se=P;var Ne;k?(0,W.isArray)(k)?Ne=function(){return k}:Ne=function(){return[k,k]}:Ne=function(_n){return _n.size?(0,W.isArray)(_n.size)?_n.size:(0,W.isObject)(_n.size)?[_n.size.width||40,_n.size.height||40]:[_n.size,_n.size]:[40,40]};var we=(0,W.getFunc)(nt.ranksep,50,nt.ranksepFunc),At=(0,W.getFunc)(nt.nodesep,50,nt.nodesepFunc),Qt=At,de=we;(yt==="LR"||yt==="RL")&&(Qt=we,de=At),Ut.setDefaultEdgeLabel(function(){return{}}),Ut.setGraph(nt);var rn={};this.sortByCombo&&st&&st.forEach(function(_n){if(rn[_n.id]=_n,_n.collapsed){var sr=Ne(_n),Pn=de(_n),tr=Qt(_n),zn=sr[0]+2*tr,Wr=sr[1]+2*Pn;Ut.setNode(_n.id,{width:zn,height:Wr})}!_n.parentId||(rn[_n.parentId]||Ut.setNode(_n.parentId,{}),Ut.setParent(_n.id,_n.parentId))}),se.filter(function(_n){return _n.layout!==!1}).forEach(function(_n){var sr=Ne(_n),Pn=de(_n),tr=Qt(_n),zn=sr[0]+2*tr,Wr=sr[1]+2*Pn,Yr=_n.layer;(0,W.isNumber)(Yr)?Ut.setNode(_n.id,{width:zn,height:Wr,layer:Yr}):Ut.setNode(_n.id,{width:zn,height:Wr}),N.sortByCombo&&_n.comboId&&(rn[_n.comboId]||(rn[_n.comboId]={id:_n.comboId},Ut.setNode(_n.comboId,{})),Ut.setParent(_n.id,_n.comboId))}),Nt.forEach(function(_n){var sr=(0,W.getEdgeTerminal)(_n,"source"),Pn=(0,W.getEdgeTerminal)(_n,"target");N.layoutNode(sr)&&N.layoutNode(Pn)&&Ut.setEdge(sr,Pn,{weight:_n.weight||1})}),(O=wt==null?void 0:wt.concat(pt||[]))===null||O===void 0||O.forEach(function(_n){var sr,Pn,tr=_n.source,zn=_n.target,Wr=((sr=rn[tr])===null||sr===void 0?void 0:sr.collapsed)?[tr]:ue[tr]||[tr],Yr=((Pn=rn[zn])===null||Pn===void 0?void 0:Pn.collapsed)?[zn]:ue[zn]||[zn];Wr.forEach(function(nr){Yr.forEach(function(wr){Ut.setEdge(nr,wr,{weight:_n.weight||1})})})});var Ee=void 0;((F=nt.preset)===null||F===void 0?void 0:F.nodes)&&(Ee=new Z.Graph({multigraph:!0,compound:!0}),nt.preset.nodes.forEach(function(_n){Ee==null||Ee.setNode(_n.id,_n)})),j.default.layout(Ut,{prevGraph:Ee,edgeLabelSpace:nt.edgeLabelSpace,keepNodeOrder:Boolean(!!nt.nodeOrder),nodeOrder:nt.nodeOrder});var ce=[0,0];if(lt){var Oe=Infinity,Ze=Infinity;Ut.nodes().forEach(function(_n){var sr=Ut.node(_n);Oe>sr.x&&(Oe=sr.x),Ze>sr.y&&(Ze=sr.y)}),Ut.edges().forEach(function(_n){var sr,Pn=Ut.edge(_n);(sr=Pn.points)===null||sr===void 0||sr.forEach(function(tr){Oe>tr.x&&(Oe=tr.x),Ze>tr.y&&(Ze=tr.y)})}),ce[0]=lt[0]-Oe,ce[1]=lt[1]-Ze}var fe=yt==="LR"||yt==="RL";if(ht){var Ae=this,Ye=Ae.focusNode,ge=Ae.ranksep,Be=Ae.getRadialPos,te=(0,W.isString)(Ye)?Ye:Ye==null?void 0:Ye.id,ke=te?(K=Ut.node(te))===null||K===void 0?void 0:K._rank:0,Ve=[],ee=fe?"y":"x",Ft=fe?"height":"width",bt=Infinity,Me=-Infinity;Ut.nodes().forEach(function(_n){var sr=Ut.node(_n);if(!!nt.nodeMap[_n]){var Pn=At(nt.nodeMap[_n]);if(ke===0)Ve[sr._rank]||(Ve[sr._rank]={nodes:[],totalWidth:0,maxSize:-Infinity}),Ve[sr._rank].nodes.push(_n),Ve[sr._rank].totalWidth+=Pn*2+sr[Ft],Ve[sr._rank].maxSize<Math.max(sr.width,sr.height)&&(Ve[sr._rank].maxSize=Math.max(sr.width,sr.height));else{var tr=sr._rank-ke;if(tr===0)Ve[tr]||(Ve[tr]={nodes:[],totalWidth:0,maxSize:-Infinity}),Ve[tr].nodes.push(_n),Ve[tr].totalWidth+=Pn*2+sr[Ft],Ve[tr].maxSize<Math.max(sr.width,sr.height)&&(Ve[tr].maxSize=Math.max(sr.width,sr.height));else{var zn=Math.abs(tr);Ve[zn]||(Ve[zn]={left:[],right:[],totalWidth:0,maxSize:-Infinity}),Ve[zn].totalWidth+=Pn*2+sr[Ft],Ve[zn].maxSize<Math.max(sr.width,sr.height)&&(Ve[zn].maxSize=Math.max(sr.width,sr.height)),tr<0?Ve[zn].left.push(_n):Ve[zn].right.push(_n)}}var Wr=sr[ee]-sr[Ft]/2-Pn,Yr=sr[ee]+sr[Ft]/2+Pn;Wr<bt&&(bt=Wr),Yr>Me&&(Me=Yr)}});var en=ge||50,fn={},Rt=(Me-bt)/.9,Xn=[(bt+Me-Rt)*.5,(bt+Me+Rt)*.5],Bn=function(_n,sr,Pn,tr){Pn===void 0&&(Pn=-Infinity),tr===void 0&&(tr=[0,1]);var zn=Pn;return _n.forEach(function(Wr){var Yr=Ut.node(Wr);fn[Wr]=sr;var nr=Be(Yr[ee],Xn,Rt,sr,tr),wr=nr.x,Sr=nr.y;if(!!nt.nodeMap[Wr]){nt.nodeMap[Wr].x=wr+ce[0],nt.nodeMap[Wr].y=Sr+ce[1],nt.nodeMap[Wr]._order=Yr._order;var pr=we(nt.nodeMap[Wr]);zn<pr&&(zn=pr)}}),zn},xr=!0,dr=0;Ve.forEach(function(_n){var sr,Pn,tr,zn,Wr,Yr,nr;if(!(!((sr=_n==null?void 0:_n.nodes)===null||sr===void 0?void 0:sr.length)&&!((Pn=_n==null?void 0:_n.left)===null||Pn===void 0?void 0:Pn.length)&&!((tr=_n==null?void 0:_n.right)===null||tr===void 0?void 0:tr.length))){if(xr&&_n.nodes.length===1){var wr=_n.nodes[0];if(!nt.nodeMap[wr])return;nt.nodeMap[wr].x=ce[0],nt.nodeMap[wr].y=ce[1],fn[_n.nodes[0]]=0,en=we(nt.nodeMap[wr]),xr=!1;return}en=Math.max(en,_n.totalWidth/(2*Math.PI));var Sr=-Infinity;if(ke===0||((zn=_n.nodes)===null||zn===void 0?void 0:zn.length))Sr=Bn(_n.nodes,en,Sr,[0,1]);else{var pr=((Wr=_n.left)===null||Wr===void 0?void 0:Wr.length)/(((Yr=_n.left)===null||Yr===void 0?void 0:Yr.length)+((nr=_n.right)===null||nr===void 0?void 0:nr.length));Sr=Bn(_n.left,en,Sr,[0,pr]),Sr=Bn(_n.right,en,Sr,[pr+.05,1])}en+=Sr,xr=!1,dr-_n.maxSize}}),Ut.edges().forEach(function(_n){var sr,Pn,tr,zn=Ut.edge(_n),Wr=Nt.findIndex(function($r){var ba=(0,W.getEdgeTerminal)($r,"source"),gt=(0,W.getEdgeTerminal)($r,"target");return ba===_n.v&&gt===_n.w});if(!(Wr<=-1)&&nt.edgeLabelSpace&&nt.controlPoints&&Nt[Wr].type!=="loop"){var Yr=ee==="x"?"y":"x",nr=(sr=zn==null?void 0:zn.points)===null||sr===void 0?void 0:sr.slice(1,zn.points.length-1),wr=[],Sr=(Pn=Ut.node(_n.v))===null||Pn===void 0?void 0:Pn[Yr],pr=Sr-((tr=Ut.node(_n.w))===null||tr===void 0?void 0:tr[Yr]),qr=fn[_n.v],ua=qr-fn[_n.w];nr==null||nr.forEach(function($r){var ba=($r[Yr]-Sr)/pr*ua+qr,gt=Be($r[ee],Xn,Rt,ba);wr.push({x:gt.x+ce[0],y:gt.y+ce[1]})}),Nt[Wr].controlPoints=wr}})}else{var Ur=new Set,fa=yt==="BT"||yt==="RL",Ea=fa?function(_n,sr){return sr-_n}:function(_n,sr){return _n-sr};Ut.nodes().forEach(function(_n){var sr=Ut.node(_n);if(!!sr){var Pn=N.nodeMap[_n];Pn||(Pn=st==null?void 0:st.find(function(tr){return tr.id===_n})),!!Pn&&(Pn.x=sr.x+ce[0],Pn.y=sr.y+ce[1],Pn._order=sr._order,Ur.add(fe?Pn.x:Pn.y))}});var aa=Array.from(Ur).sort(Ea),Da=fe?function(_n,sr){return _n.x!==sr.x}:function(_n,sr){return _n.y!==sr.y},Lr=fe?function(_n,sr,Pn){var tr=Math.max(sr.y,Pn.y),zn=Math.min(sr.y,Pn.y);return _n.filter(function(Wr){return Wr.y<=tr&&Wr.y>=zn})}:function(_n,sr,Pn){var tr=Math.max(sr.x,Pn.x),zn=Math.min(sr.x,Pn.x);return _n.filter(function(Wr){return Wr.x<=tr&&Wr.x>=zn})};Ut.edges().forEach(function(_n){var sr,Pn=Ut.edge(_n),tr=Nt.findIndex(function(Yr){var nr=(0,W.getEdgeTerminal)(Yr,"source"),wr=(0,W.getEdgeTerminal)(Yr,"target");return nr===_n.v&&wr===_n.w});if(!(tr<=-1)&&nt.edgeLabelSpace&&nt.controlPoints&&Nt[tr].type!=="loop"){(sr=Pn==null?void 0:Pn.points)===null||sr===void 0||sr.forEach(function(Yr){Yr.x+=ce[0],Yr.y+=ce[1]});var zn=nt.nodeMap[_n.v],Wr=nt.nodeMap[_n.w];Nt[tr].controlPoints=L(Pn==null?void 0:Pn.points,zn,Wr,aa,fe,Da,Lr)}})}return nt.onLayoutEnd&&nt.onLayoutEnd(),{nodes:P,edges:Nt}}},A.prototype.getRadialPos=function(N,B,O,F,K){K===void 0&&(K=[0,1]);var nt=(N-B[0])/O;nt=nt*(K[1]-K[0])+K[0];var P=nt*2*Math.PI;return{x:Math.cos(P)*F,y:Math.sin(P)*F}},A.prototype.getType=function(){return"dagre"},A}(Q.Base);ot.DagreLayout=R;var L=function(C,A,N,B,O,F,K){var nt=(C==null?void 0:C.slice(1,C.length-1))||[];if(A&&N){var P=A.x,k=A.y,yt=N.x,st=N.y;if(O&&(P=A.y,k=A.x,yt=N.y,st=N.x),st!==k&&P!==yt){var lt=B.indexOf(k),ht=B[lt+1];if(ht){var mt=nt[0],wt=O?{x:(k+ht)/2,y:(mt==null?void 0:mt.y)||yt}:{x:(mt==null?void 0:mt.x)||yt,y:(k+ht)/2};(!mt||F(mt,wt))&&nt.unshift(wt)}var ut=B.indexOf(st),pt=Math.abs(ut-lt);if(pt===1)nt=K(nt,A,N),nt.length||nt.push(O?{x:(k+st)/2,y:P}:{x:P,y:(k+st)/2});else if(pt>1){var Nt=B[ut-1];if(Nt){var Ut=nt[nt.length-1],ue=O?{x:(st+Nt)/2,y:(Ut==null?void 0:Ut.y)||yt}:{x:(Ut==null?void 0:Ut.x)||P,y:(st+Nt)/2};(!Ut||F(Ut,ue))&&nt.push(ue)}}}}return nt}},27652:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var W=function(Q,Z){return W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,L){R.__proto__=L}||function(R,L){for(var C in L)Object.prototype.hasOwnProperty.call(L,C)&&(R[C]=L[C])},W(Q,Z)};return function(Q,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");W(Q,Z);function R(){this.constructor=Q}Q.prototype=Z===null?Object.create(Z):(R.prototype=Z.prototype,new R)}}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.Graph=void 0;var tt=$(69787),j=function(W){Y(Q,W);function Q(){return W!==null&&W.apply(this,arguments)||this}return Q}(tt.Graph);ot.Graph=j},41106:function(ur,ot,$){"use strict";var Y=this&&this.__importDefault||function(W){return W&&W.__esModule?W:{default:W}};Object.defineProperty(ot,"__esModule",{value:!0});var tt=Y($(65236)),j=$(69209);ot.default={layout:tt.default,util:{time:j.time,notime:j.notime}}},78029:function(ur,ot,$){"use strict";var Y=this&&this.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}};Object.defineProperty(ot,"__esModule",{value:!0});var tt=Y($(40773)),j=function(Z){var R=function(C){return function(A){var N;return((N=C.edge(A))===null||N===void 0?void 0:N.weight)||1}},L=Z.graph().acyclicer==="greedy"?(0,tt.default)(Z,R(Z)):W(Z);L==null||L.forEach(function(C){var A=Z.edge(C);Z.removeEdgeObj(C),A.forwardName=C.name,A.reversed=!0,Z.setEdge(C.w,C.v,A,"rev-".concat(Math.random()))})},W=function(Z){var R=[],L={},C={},A=function(N){var B;C[N]||(C[N]=!0,L[N]=!0,(B=Z.outEdges(N))===null||B===void 0||B.forEach(function(O){L[O.w]?R.push(O):A(O.w)}),delete L[N])};return Z.nodes().forEach(A),R},Q=function(Z){Z.edges().forEach(function(R){var L=Z.edge(R);if(L.reversed){Z.removeEdgeObj(R);var C=L.forwardName;delete L.reversed,delete L.forwardName,Z.setEdge(R.w,R.v,L,C)}})};ot.default={run:j,undo:Q}},11500:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var Y=$(69209),tt=function(W){var Q,Z=function(R){var L=W.children(R),C=W.node(R);if((L==null?void 0:L.length)&&L.forEach(function(B){return Z(B)}),C.hasOwnProperty("minRank")){C.borderLeft=[],C.borderRight=[];for(var A=C.minRank,N=C.maxRank+1;A<N;A+=1)j(W,"borderLeft","_bl",R,C,A),j(W,"borderRight","_br",R,C,A)}};(Q=W.children())===null||Q===void 0||Q.forEach(function(R){return Z(R)})},j=function(W,Q,Z,R,L,C){var A={rank:C,borderType:Q,width:0,height:0},N=L[Q][C-1],B=(0,Y.addDummyNode)(W,"border",A,Z);L[Q][C]=B,W.setParent(B,R),N&&W.setEdge(N,B,{weight:1})};ot.default=tt},35279:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=function(L){var C,A=(C=L.graph().rankdir)===null||C===void 0?void 0:C.toLowerCase();(A==="lr"||A==="rl")&&tt(L)},Y=function(L){var C,A=(C=L.graph().rankdir)===null||C===void 0?void 0:C.toLowerCase();(A==="bt"||A==="rl")&&W(L),(A==="lr"||A==="rl")&&(Z(L),tt(L))},tt=function(L){L.nodes().forEach(function(C){j(L.node(C))}),L.edges().forEach(function(C){j(L.edge(C))})},j=function(L){var C=L.width;L.width=L.height,L.height=C},W=function(L){L.nodes().forEach(function(C){Q(L.node(C))}),L.edges().forEach(function(C){var A,N=L.edge(C);(A=N.points)===null||A===void 0||A.forEach(function(B){return Q(B)}),N.hasOwnProperty("y")&&Q(N)})},Q=function(L){(L==null?void 0:L.y)&&(L.y=-L.y)},Z=function(L){L.nodes().forEach(function(C){R(L.node(C))}),L.edges().forEach(function(C){var A,N=L.edge(C);(A=N.points)===null||A===void 0||A.forEach(function(B){return R(B)}),N.hasOwnProperty("x")&&R(N)})},R=function(L){var C=L.x;L.x=L.y,L.y=C};ot.default={adjust:$,undo:Y}},55532:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=function(j,W){if(j!=="next"&&j!=="prev")return W},Y=function(j){j.prev.next=j.next,j.next.prev=j.prev,delete j.next,delete j.prev},tt=function(){function j(){var W={};W.prev=W,W.next=W.prev,this.shortcut=W}return j.prototype.dequeue=function(){var W=this.shortcut,Q=W.prev;if(Q&&Q!==W)return Y(Q),Q},j.prototype.enqueue=function(W){var Q=this.shortcut;W.prev&&W.next&&Y(W),W.next=Q.next,Q.next.prev=W,Q.next=W,W.prev=Q},j.prototype.toString=function(){for(var W=[],Q=this.shortcut,Z=Q.prev;Z!==Q;)W.push(JSON.stringify(Z,$)),Z=Z==null?void 0:Z.prev;return"[".concat(W.join(", "),"]")},j}();ot.default=tt},40773:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var O=function(F,K){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(nt,P){nt.__proto__=P}||function(nt,P){for(var k in P)Object.prototype.hasOwnProperty.call(P,k)&&(nt[k]=P[k])},O(F,K)};return function(F,K){if(typeof K!="function"&&K!==null)throw new TypeError("Class extends value "+String(K)+" is not a constructor or null");O(F,K);function nt(){this.constructor=F}F.prototype=K===null?Object.create(K):(nt.prototype=K.prototype,new nt)}}(),tt=this&&this.__importDefault||function(O){return O&&O.__esModule?O:{default:O}};Object.defineProperty(ot,"__esModule",{value:!0});var j=tt($(55532)),W=$(69787),Q=function(O){Y(F,O);function F(){return O!==null&&O.apply(this,arguments)||this}return F}(j.default),Z=function(O){Y(F,O);function F(){return O!==null&&O.apply(this,arguments)||this}return F}(W.Graph),R=function(){return 1},L=function(O,F){var K;if(O.nodeCount()<=1)return[];var nt=N(O,F||R),P=C(nt.graph,nt.buckets,nt.zeroIdx);return(K=P.map(function(k){return O.outEdges(k.v,k.w)}))===null||K===void 0?void 0:K.flat()},C=function(O,F,K){for(var nt=[],P=F[F.length-1],k=F[0],yt;O.nodeCount();){for(;yt=k.dequeue();)A(O,F,K,yt);for(;yt=P.dequeue();)A(O,F,K,yt);if(O.nodeCount()){for(var st=F.length-2;st>0;--st)if(yt=F[st].dequeue(),yt){nt=nt.concat(A(O,F,K,yt,!0));break}}}return nt},A=function(O,F,K,nt,P){var k,yt,st=[];return(k=O.inEdges(nt.v))===null||k===void 0||k.forEach(function(lt){var ht=O.edge(lt),mt=O.node(lt.v);P&&st.push({v:lt.v,w:lt.w,in:0,out:0}),mt.out===void 0&&(mt.out=0),mt.out-=ht,B(F,K,mt)}),(yt=O.outEdges(nt.v))===null||yt===void 0||yt.forEach(function(lt){var ht=O.edge(lt),mt=lt.w,wt=O.node(mt);wt.in===void 0&&(wt.in=0),wt.in-=ht,B(F,K,wt)}),O.removeNode(nt.v),P?st:void 0},N=function(O,F){var K=new Z,nt=0,P=0;O.nodes().forEach(function(ht){K.setNode(ht,{v:ht,in:0,out:0})}),O.edges().forEach(function(ht){var mt=K.edge(ht)||0,wt=(F==null?void 0:F(ht))||1,ut=mt+wt;K.setEdge(ht.v,ht.w,ut),P=Math.max(P,K.node(ht.v).out+=wt),nt=Math.max(nt,K.node(ht.w).in+=wt)});for(var k=[],yt=P+nt+3,st=0;st<yt;st++)k.push(new Q);var lt=nt+1;return K.nodes().forEach(function(ht){B(k,lt,K.node(ht))}),{buckets:k,zeroIdx:lt,graph:K}},B=function(O,F,K){K.out?K.in?O[K.out-K.in+F].enqueue(K):O[O.length-1].enqueue(K):O[0].enqueue(K)};ot.default=L},65236:function(ur,ot,$){"use strict";var Y=this&&this.__assign||function(){return Y=Object.assign||function(fe){for(var Ae,Ye=1,ge=arguments.length;Ye<ge;Ye++){Ae=arguments[Ye];for(var Be in Ae)Object.prototype.hasOwnProperty.call(Ae,Be)&&(fe[Be]=Ae[Be])}return fe},Y.apply(this,arguments)},tt=this&&this.__importDefault||function(fe){return fe&&fe.__esModule?fe:{default:fe}};Object.defineProperty(ot,"__esModule",{value:!0});var j=tt($(78029)),W=tt($(46171)),Q=tt($(76827)),Z=$(69209),R=tt($(33562)),L=tt($(59596)),C=tt($(11500)),A=tt($(35279)),N=tt($(19597)),B=tt($(95)),O=tt($(24956)),F=$(27652),K=function(fe,Ae){var Ye=Ae&&Ae.debugTiming?Z.time:Z.notime;Ye("layout",function(){Ae&&!Ae.keepNodeOrder&&Ae.prevGraph&&Ye("  inheritOrder",function(){P(fe,Ae.prevGraph)});var ge=Ye("  buildLayoutGraph",function(){return Nt(fe)});Ae&&Ae.edgeLabelSpace===!1||Ye("  makeSpaceForEdgeLabels",function(){Ut(ge)});try{Ye("  runLayout",function(){nt(ge,Ye,Ae)})}catch(Be){if(Be.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,Be);return}throw Be}Ye("  updateInputGraph",function(){k(fe,ge)})})},nt=function(fe,Ae,Ye){Ae("    removeSelfEdges",function(){rn(fe)}),Ae("    acyclic",function(){j.default.run(fe)}),Ae("    nestingGraph.run",function(){L.default.run(fe)}),Ae("    rank",function(){(0,Q.default)((0,Z.asNonCompoundGraph)(fe))}),Ae("    injectEdgeLabelProxies",function(){ue(fe)}),Ae("    removeEmptyRanks",function(){(0,Z.removeEmptyRanks)(fe)}),Ae("    nestingGraph.cleanup",function(){L.default.cleanup(fe)}),Ae("    normalizeRanks",function(){(0,Z.normalizeRanks)(fe)}),Ae("    assignRankMinMax",function(){se(fe)}),Ae("    removeEdgeLabelProxies",function(){Le(fe)}),Ae("    normalize.run",function(){W.default.run(fe)}),Ae("    parentDummyChains",function(){(0,R.default)(fe)}),Ae("    addBorderSegments",function(){(0,C.default)(fe)}),Ye&&Ye.keepNodeOrder&&Ae("    initDataOrder",function(){(0,O.default)(fe,Ye.nodeOrder)}),Ae("    order",function(){(0,N.default)(fe,Ye==null?void 0:Ye.keepNodeOrder)}),Ae("    insertSelfEdges",function(){Ee(fe)}),Ae("    adjustCoordinateSystem",function(){A.default.adjust(fe)}),Ae("    position",function(){(0,B.default)(fe)}),Ae("    positionSelfEdges",function(){ce(fe)}),Ae("    removeBorderNodes",function(){de(fe)}),Ae("    normalize.undo",function(){W.default.undo(fe)}),Ae("    fixupEdgeLabelCoords",function(){At(fe)}),Ae("    undoCoordinateSystem",function(){A.default.undo(fe)}),Ae("    translateGraph",function(){Ne(fe)}),Ae("    assignNodeIntersects",function(){we(fe)}),Ae("    reversePoints",function(){Qt(fe)}),Ae("    acyclic.undo",function(){j.default.undo(fe)})},P=function(fe,Ae){fe.nodes().forEach(function(Ye){var ge=fe.node(Ye),Be=Ae.node(Ye);Be!==void 0?(ge.fixorder=Be._order,delete Be._order):delete ge.fixorder})},k=function(fe,Ae){fe.nodes().forEach(function(Ye){var ge,Be=fe.node(Ye);if(Be){var te=Ae.node(Ye);Be.x=te.x,Be.y=te.y,Be._order=te.order,Be._rank=te.rank,((ge=Ae.children(Ye))===null||ge===void 0?void 0:ge.length)&&(Be.width=te.width,Be.height=te.height)}}),fe.edges().forEach(function(Ye){var ge=fe.edge(Ye),Be=Ae.edge(Ye);ge.points=Be?Be.points:[],Be&&Be.hasOwnProperty("x")&&(ge.x=Be.x,ge.y=Be.y)}),fe.graph().width=Ae.graph().width,fe.graph().height=Ae.graph().height},yt=["nodesep","edgesep","ranksep","marginx","marginy"],st={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},lt=["acyclicer","ranker","rankdir","align"],ht=["width","height","layer","fixorder"],mt={width:0,height:0},wt=["minlen","weight","width","height","labeloffset"],ut={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},pt=["labelpos"],Nt=function(fe){var Ae=new F.Graph({multigraph:!0,compound:!0}),Ye=Ze(fe.graph()),ge={};return lt==null||lt.forEach(function(Be){Ye[Be]!==void 0&&(ge[Be]=Ye[Be])}),Ae.setGraph(Object.assign({},st,Oe(Ye,yt),ge)),fe.nodes().forEach(function(Be){var te=Ze(fe.node(Be)),ke=Y(Y({},mt),te),Ve=Oe(ke,ht);Ae.setNode(Be,Ve),Ae.setParent(Be,fe.parent(Be))}),fe.edges().forEach(function(Be){var te=Ze(fe.edge(Be)),ke={};pt==null||pt.forEach(function(Ve){te[Ve]!==void 0&&(ke[Ve]=te[Ve])}),Ae.setEdgeObj(Be,Object.assign({},ut,Oe(te,wt),ke))}),Ae},Ut=function(fe){var Ae=fe.graph();Ae.ranksep||(Ae.ranksep=0),Ae.ranksep/=2,fe.nodes().forEach(function(Ye){var ge=fe.node(Ye);isNaN(ge.layer)||ge.layer||(ge.layer=0)}),fe.edges().forEach(function(Ye){var ge,Be=fe.edge(Ye);Be.minlen*=2,((ge=Be.labelpos)===null||ge===void 0?void 0:ge.toLowerCase())!=="c"&&(Ae.rankdir==="TB"||Ae.rankdir==="BT"?Be.width+=Be.labeloffset:Be.height+=Be.labeloffset)})},ue=function(fe){fe.edges().forEach(function(Ae){var Ye=fe.edge(Ae);if(Ye.width&&Ye.height){var ge=fe.node(Ae.v),Be=fe.node(Ae.w),te={e:Ae,rank:(Be.rank-ge.rank)/2+ge.rank};(0,Z.addDummyNode)(fe,"edge-proxy",te,"_ep")}})},se=function(fe){var Ae=0;fe.nodes().forEach(function(Ye){var ge,Be,te=fe.node(Ye);te.borderTop&&(te.minRank=(ge=fe.node(te.borderTop))===null||ge===void 0?void 0:ge.rank,te.maxRank=(Be=fe.node(te.borderBottom))===null||Be===void 0?void 0:Be.rank,Ae=Math.max(Ae,te.maxRank||-Infinity))}),fe.graph().maxRank=Ae},Le=function(fe){fe.nodes().forEach(function(Ae){var Ye=fe.node(Ae);Ye.dummy==="edge-proxy"&&(fe.edge(Ye.e).labelRank=Ye.rank,fe.removeNode(Ae))})},Ne=function(fe){var Ae,Ye=0,ge,Be=0,te=fe.graph(),ke=te.marginx||0,Ve=te.marginy||0,ee=function(Ft){if(!!Ft){var bt=Ft.x,Me=Ft.y,en=Ft.width,fn=Ft.height;!isNaN(bt)&&!isNaN(en)&&(Ae===void 0&&(Ae=bt-en/2),Ae=Math.min(Ae,bt-en/2),Ye=Math.max(Ye,bt+en/2)),!isNaN(Me)&&!isNaN(fn)&&(ge===void 0&&(ge=Me-fn/2),ge=Math.min(ge,Me-fn/2),Be=Math.max(Be,Me+fn/2))}};fe.nodes().forEach(function(Ft){ee(fe.node(Ft))}),fe.edges().forEach(function(Ft){var bt=fe.edge(Ft);(bt==null?void 0:bt.hasOwnProperty("x"))&&ee(bt)}),Ae-=ke,ge-=Ve,fe.nodes().forEach(function(Ft){var bt=fe.node(Ft);bt&&(bt.x-=Ae,bt.y-=ge)}),fe.edges().forEach(function(Ft){var bt,Me=fe.edge(Ft);(bt=Me.points)===null||bt===void 0||bt.forEach(function(en){en.x-=Ae,en.y-=ge}),Me.hasOwnProperty("x")&&(Me.x-=Ae),Me.hasOwnProperty("y")&&(Me.y-=ge)}),te.width=Ye-Ae+ke,te.height=Be-ge+Ve},we=function(fe){fe.edges().forEach(function(Ae){var Ye=fe.edge(Ae),ge=fe.node(Ae.v),Be=fe.node(Ae.w),te,ke;Ye.points?(te=Ye.points[0],ke=Ye.points[Ye.points.length-1]):(Ye.points=[],te=Be,ke=ge),Ye.points.unshift((0,Z.intersectRect)(ge,te)),Ye.points.push((0,Z.intersectRect)(Be,ke))})},At=function(fe){fe.edges().forEach(function(Ae){var Ye=fe.edge(Ae);if(Ye==null?void 0:Ye.hasOwnProperty("x"))switch((Ye.labelpos==="l"||Ye.labelpos==="r")&&(Ye.width-=Ye.labeloffset),Ye.labelpos){case"l":Ye.x-=Ye.width/2+Ye.labeloffset;break;case"r":Ye.x+=Ye.width/2+Ye.labeloffset;break}})},Qt=function(fe){fe.edges().forEach(function(Ae){var Ye,ge=fe.edge(Ae);ge.reversed&&((Ye=ge.points)===null||Ye===void 0||Ye.reverse())})},de=function(fe){fe.nodes().forEach(function(Ae){var Ye,ge,Be;if((Ye=fe.children(Ae))===null||Ye===void 0?void 0:Ye.length){var te=fe.node(Ae),ke=fe.node(te.borderTop),Ve=fe.node(te.borderBottom),ee=fe.node(te.borderLeft[((ge=te.borderLeft)===null||ge===void 0?void 0:ge.length)-1]),Ft=fe.node(te.borderRight[((Be=te.borderRight)===null||Be===void 0?void 0:Be.length)-1]);te.width=Math.abs((Ft==null?void 0:Ft.x)-(ee==null?void 0:ee.x))||10,te.height=Math.abs((Ve==null?void 0:Ve.y)-(ke==null?void 0:ke.y))||10,te.x=((ee==null?void 0:ee.x)||0)+te.width/2,te.y=((ke==null?void 0:ke.y)||0)+te.height/2}}),fe.nodes().forEach(function(Ae){var Ye;((Ye=fe.node(Ae))===null||Ye===void 0?void 0:Ye.dummy)==="border"&&fe.removeNode(Ae)})},rn=function(fe){fe.edges().forEach(function(Ae){if(Ae.v===Ae.w){var Ye=fe.node(Ae.v);Ye.selfEdges||(Ye.selfEdges=[]),Ye.selfEdges.push({e:Ae,label:fe.edge(Ae)}),fe.removeEdgeObj(Ae)}})},Ee=function(fe){var Ae=(0,Z.buildLayerMatrix)(fe);Ae==null||Ae.forEach(function(Ye){var ge=0;Ye==null||Ye.forEach(function(Be,te){var ke,Ve=fe.node(Be);Ve.order=te+ge,(ke=Ve.selfEdges)===null||ke===void 0||ke.forEach(function(ee){(0,Z.addDummyNode)(fe,"selfedge",{width:ee.label.width,height:ee.label.height,rank:Ve.rank,order:te+ ++ge,e:ee.e,label:ee.label},"_se")}),delete Ve.selfEdges})})},ce=function(fe){fe.nodes().forEach(function(Ae){var Ye=fe.node(Ae);if(Ye.dummy==="selfedge"){var ge=fe.node(Ye.e.v),Be=ge.x+ge.width/2,te=ge.y,ke=Ye.x-Be,Ve=ge.height/2;fe.setEdgeObj(Ye.e,Ye.label),fe.removeNode(Ae),Ye.label.points=[{x:Be+2*ke/3,y:te-Ve},{x:Be+5*ke/6,y:te-Ve},{y:te,x:Be+ke},{x:Be+5*ke/6,y:te+Ve},{x:Be+2*ke/3,y:te+Ve}],Ye.label.x=Ye.x,Ye.label.y=Ye.y}})},Oe=function(fe,Ae){var Ye={};return Ae==null||Ae.forEach(function(ge){fe[ge]!==void 0&&(Ye[ge]=+fe[ge])}),Ye},Ze=function(fe){fe===void 0&&(fe={});var Ae={};return Object.keys(fe).forEach(function(Ye){Ae[Ye.toLowerCase()]=fe[Ye]}),Ae};ot.default=K},59596:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var Y=$(69209),tt=function(R){var L,C=(0,Y.addDummyNode)(R,"root",{},"_root"),A=W(R),N=Math.max.apply(Math,Object.values(A));Math.abs(N)===Infinity&&(N=1);var B=N-1,O=2*B+1;R.graph().nestingRoot=C,R.edges().forEach(function(K){R.edge(K).minlen*=O});var F=Q(R)+1;(L=R.children())===null||L===void 0||L.forEach(function(K){j(R,C,O,F,B,A,K)}),R.graph().nodeRankFactor=O},j=function(R,L,C,A,N,B,O){var F=R.children(O);if(!(F==null?void 0:F.length)){O!==L&&R.setEdge(L,O,{weight:0,minlen:C});return}var K=(0,Y.addBorderNode)(R,"_bt"),nt=(0,Y.addBorderNode)(R,"_bb"),P=R.node(O);R.setParent(K,O),P.borderTop=K,R.setParent(nt,O),P.borderBottom=nt,F==null||F.forEach(function(k){j(R,L,C,A,N,B,k);var yt=R.node(k),st=yt.borderTop?yt.borderTop:k,lt=yt.borderBottom?yt.borderBottom:k,ht=yt.borderTop?A:2*A,mt=st!==lt?1:N-B[O]+1;R.setEdge(K,st,{minlen:mt,weight:ht,nestingEdge:!0}),R.setEdge(lt,nt,{minlen:mt,weight:ht,nestingEdge:!0})}),R.parent(O)||R.setEdge(L,K,{weight:0,minlen:N+B[O]})},W=function(R){var L,C={},A=function(N,B){var O=R.children(N);O==null||O.forEach(function(F){return A(F,B+1)}),C[N]=B};return(L=R.children())===null||L===void 0||L.forEach(function(N){return A(N,1)}),C},Q=function(R){var L=0;return R.edges().forEach(function(C){L+=R.edge(C).weight}),L},Z=function(R){var L=R.graph();L.nestingRoot&&R.removeNode(L.nestingRoot),delete L.nestingRoot,R.edges().forEach(function(C){var A=R.edge(C);A.nestingEdge&&R.removeEdgeObj(C)})};ot.default={run:tt,cleanup:Z}},46171:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var Y=$(69209),tt=function(Q){Q.graph().dummyChains=[],Q.edges().forEach(function(Z){return j(Q,Z)})},j=function(Q,Z){var R=Z.v,L=Q.node(R).rank,C=Z.w,A=Q.node(C).rank,N=Z.name,B=Q.edge(Z),O=B.labelRank;if(A!==L+1){Q.removeEdgeObj(Z);var F=Q.graph(),K,nt,P;for(P=0,++L;L<A;++P,++L)B.points=[],nt={edgeLabel:B,width:0,height:0,edgeObj:Z,rank:L},K=(0,Y.addDummyNode)(Q,"edge",nt,"_d"),L===O&&(nt.width=B.width,nt.height=B.height,nt.dummy="edge-label",nt.labelpos=B.labelpos),Q.setEdge(R,K,{weight:B.weight},N),P===0&&(F.dummyChains||(F.dummyChains=[]),F.dummyChains.push(K)),R=K;Q.setEdge(R,C,{weight:B.weight},N)}},W=function(Q){var Z;(Z=Q.graph().dummyChains)===null||Z===void 0||Z.forEach(function(R){var L=Q.node(R),C=L.edgeLabel,A;L.edgeObj&&Q.setEdgeObj(L.edgeObj,C);for(var N=R;L.dummy;)A=Q.successors(N)[0],Q.removeNode(N),C.points.push({x:L.x,y:L.y}),L.dummy==="edge-label"&&(C.x=L.x,C.y=L.y,C.width=L.width,C.height=L.height),N=A,L=Q.node(N)})};ot.default={run:tt,undo:W}},80314:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=function(Y,tt,j){var W={},Q;j==null||j.forEach(function(Z){for(var R=Y.parent(Z),L,C;R;){if(L=Y.parent(R),L?(C=W[L],W[L]=R):(C=Q,Q=R),C&&C!==R){tt.setEdge(C,R);return}R=L}})};ot.default=$},89921:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=function(Y,tt){return tt.map(function(j){var W=Y.inEdges(j);if(!(W==null?void 0:W.length))return{v:j};{var Q={sum:0,weight:0};return W==null||W.forEach(function(Z){var R=Y.edge(Z),L=Y.node(Z.v);Q.sum+=R.weight*L.order,Q.weight+=R.weight}),{v:j,barycenter:Q.sum/Q.weight,weight:Q.weight}}})};ot.default=$},77006:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var Y=$(27652),tt=function(W,Q,Z){var R=j(W),L=new Y.Graph({compound:!0}).setGraph({root:R}).setDefaultNodeLabel(function(C){return W.node(C)});return W.nodes().forEach(function(C){var A,N=W.node(C),B=W.parent(C);(N.rank===Q||N.minRank<=Q&&Q<=N.maxRank)&&(L.setNode(C),L.setParent(C,B||R),(A=W[Z](C))===null||A===void 0||A.forEach(function(O){var F=O.v===C?O.w:O.v,K=L.edgeFromArgs(F,C),nt=K!==void 0?K.weight:0;L.setEdge(F,C,{weight:W.edge(O).weight+nt})}),N.hasOwnProperty("minRank")&&L.setNode(C,{borderLeft:N.borderLeft[Q],borderRight:N.borderRight[Q]}))}),L},j=function(W){for(var Q;W.hasNode(Q="_root".concat(Math.random())););return Q};ot.default=tt},32957:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var Y=$(69209),tt=function(W,Q,Z){for(var R=(0,Y.zipObject)(Z,Z.map(function(F,K){return K})),L=Q.map(function(F){var K,nt=(K=W.outEdges(F))===null||K===void 0?void 0:K.map(function(P){return{pos:R[P.w]||0,weight:W.edge(P).weight}});return nt==null?void 0:nt.sort(function(P,k){return P.pos-k.pos})}),C=L.flat().filter(function(F){return F!==void 0}),A=1;A<Z.length;)A<<=1;var N=2*A-1;A-=1;var B=Array(N).fill(0,0,N),O=0;return C==null||C.forEach(function(F){if(F){var K=F.pos+A;B[K]+=F.weight;for(var nt=0;K>0;)K%2&&(nt+=B[K+1]),K=K-1>>1,B[K]+=F.weight;O+=F.weight*nt}}),O},j=function(W,Q){for(var Z=0,R=1;R<(Q==null?void 0:Q.length);R+=1)Z+=tt(W,Q[R-1],Q[R]);return Z};ot.default=j},19597:function(ur,ot,$){"use strict";var Y=this&&this.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(ot,"__esModule",{value:!0});var tt=Y($(15697)),j=Y($(32957)),W=Y($(77006)),Q=Y($(80314)),Z=Y($(99455)),R=$(49784),L=$(27652),C=$(69209),A=function(F,K){for(var nt=(0,C.maxRank)(F),P=[],k=[],yt=1;yt<nt+1;yt++)P.push(yt);for(var yt=nt-1;yt>-1;yt--)k.push(yt);var st=N(F,P,"inEdges"),lt=N(F,k,"outEdges"),ht=(0,tt.default)(F);O(F,ht);for(var mt=Number.POSITIVE_INFINITY,wt,yt=0,ut=0;ut<4;++yt,++ut){B(yt%2?st:lt,yt%4>=2,!1,K),ht=(0,C.buildLayerMatrix)(F);var pt=(0,j.default)(F,ht);pt<mt&&(ut=0,wt=(0,R.clone)(ht),mt=pt)}ht=(0,tt.default)(F),O(F,ht);for(var yt=0,ut=0;ut<4;++yt,++ut){B(yt%2?st:lt,yt%4>=2,!0,K),ht=(0,C.buildLayerMatrix)(F);var pt=(0,j.default)(F,ht);pt<mt&&(ut=0,wt=(0,R.clone)(ht),mt=pt)}O(F,wt)},N=function(F,K,nt){return K.map(function(P){return(0,W.default)(F,P,nt)})},B=function(F,K,nt,P){var k=new L.Graph;F==null||F.forEach(function(yt){for(var st,lt=yt.graph().root,ht=(0,Z.default)(yt,lt,k,K,nt,P),mt=0;mt<((st=ht.vs)===null||st===void 0?void 0:st.length);mt++){var wt=yt.node(ht.vs[mt]);wt&&(wt.order=mt)}(0,Q.default)(yt,k,ht.vs)})},O=function(F,K){K==null||K.forEach(function(nt){nt==null||nt.forEach(function(P,k){F.node(P).order=k})})};ot.default=A},24956:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=function(Y,tt){for(var j=Y.nodes().filter(function(L){var C;return!((C=Y.children(L))===null||C===void 0?void 0:C.length)}),W=j.map(function(L){return Y.node(L).rank}),Q=Math.max.apply(Math,W),Z=[],R=0;R<Q+1;R++)Z[R]=[];tt==null||tt.forEach(function(L){var C=Y.node(L);!C||(C==null?void 0:C.dummy)||isNaN(C.rank)||(C.fixorder=Z[C.rank].length,Z[C.rank].push(L))})};ot.default=$},15697:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var Y=$(45603),tt=function(j){for(var W={},Q=j.nodes().filter(function(F){var K;return!((K=j.children(F))===null||K===void 0?void 0:K.length)}),Z=Q.map(function(F){return j.node(F).rank}),R=(0,Y.max)(Z),L=[],C=0;C<R+1;C++)L.push([]);var A=function(F){var K;if(!W.hasOwnProperty(F)){W[F]=!0;var nt=j.node(F);isNaN(nt.rank)||L[nt.rank].push(F),(K=j.successors(F))===null||K===void 0||K.forEach(function(P){return A(P)})}},N=Q.sort(function(F,K){return j.node(F).rank-j.node(K).rank}),B=N.filter(function(F){return j.node(F).fixorder!==void 0}),O=B.sort(function(F,K){return j.node(F).fixorder-j.node(K).fixorder});return O==null||O.forEach(function(F){isNaN(j.node(F).rank)||L[j.node(F).rank].push(F),W[F]=!0}),N==null||N.forEach(A),L};ot.default=tt},7043:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=function(j,W){var Q,Z,R,L={};j==null||j.forEach(function(A,N){L[A.v]={i:N,indegree:0,in:[],out:[],vs:[A.v]};var B=L[A.v];A.barycenter!==void 0&&(B.barycenter=A.barycenter,B.weight=A.weight)}),(Q=W.edges())===null||Q===void 0||Q.forEach(function(A){var N=L[A.v],B=L[A.w];N!==void 0&&B!==void 0&&(B.indegree++,N.out.push(L[A.w]))});var C=(R=(Z=Object.values(L)).filter)===null||R===void 0?void 0:R.call(Z,function(A){return!A.indegree});return Y(C)},Y=function(j){for(var W,Q,Z=[],R=function(B){return function(O){O.merged||(O.barycenter===void 0||B.barycenter===void 0||O.barycenter>=B.barycenter)&&tt(B,O)}},L=function(B){return function(O){O.in.push(B),--O.indegree==0&&j.push(O)}},C=function(){var B=j.pop();Z.push(B),(W=B.in.reverse())===null||W===void 0||W.forEach(function(O){return R(B)(O)}),(Q=B.out)===null||Q===void 0||Q.forEach(function(O){return L(B)(O)})};j==null?void 0:j.length;)C();var A=Z.filter(function(B){return!B.merged}),N=["vs","i","barycenter","weight"];return A.map(function(B){var O={};return N==null||N.forEach(function(F){B[F]!==void 0&&(O[F]=B[F])}),O})},tt=function(j,W){var Q,Z=0,R=0;j.weight&&(Z+=j.barycenter*j.weight,R+=j.weight),W.weight&&(Z+=W.barycenter*W.weight,R+=W.weight),j.vs=(Q=W.vs)===null||Q===void 0?void 0:Q.concat(j.vs),j.barycenter=Z/R,j.weight=R,j.i=Math.min(W.i,j.i),W.merged=!0};ot.default=$},99455:function(ur,ot,$){"use strict";var Y=this&&this.__importDefault||function(L){return L&&L.__esModule?L:{default:L}};Object.defineProperty(ot,"__esModule",{value:!0});var tt=Y($(89921)),j=Y($(7043)),W=Y($(21498)),Q=function(L,C,A,N,B,O){var F,K,nt,P,k=L.children(C),yt=L.node(C),st=yt?yt.borderLeft:void 0,lt=yt?yt.borderRight:void 0,ht={};st&&(k=k==null?void 0:k.filter(function(Ut){return Ut!==st&&Ut!==lt}));var mt=(0,tt.default)(L,k||[]);mt==null||mt.forEach(function(Ut){var ue;if((ue=L.children(Ut.v))===null||ue===void 0?void 0:ue.length){var se=Q(L,Ut.v,A,N,O);ht[Ut.v]=se,se.hasOwnProperty("barycenter")&&R(Ut,se)}});var wt=(0,j.default)(mt,A);Z(wt,ht),(F=wt.filter(function(Ut){return Ut.vs.length>0}))===null||F===void 0||F.forEach(function(Ut){var ue=L.node(Ut.vs[0]);ue&&(Ut.fixorder=ue.fixorder,Ut.order=ue.order)});var ut=(0,W.default)(wt,N,B,O);if(st&&(ut.vs=[st,ut.vs,lt].flat(),(K=L.predecessors(st))===null||K===void 0?void 0:K.length)){var pt=L.node(((nt=L.predecessors(st))===null||nt===void 0?void 0:nt[0])||""),Nt=L.node(((P=L.predecessors(lt))===null||P===void 0?void 0:P[0])||"");ut.hasOwnProperty("barycenter")||(ut.barycenter=0,ut.weight=0),ut.barycenter=(ut.barycenter*ut.weight+pt.order+Nt.order)/(ut.weight+2),ut.weight+=2}return ut},Z=function(L,C){L==null||L.forEach(function(A){var N,B=(N=A.vs)===null||N===void 0?void 0:N.map(function(O){return C[O]?C[O].vs:O});A.vs=B.flat()})},R=function(L,C){L.barycenter!==void 0?(L.barycenter=(L.barycenter*L.weight+C.barycenter*C.weight)/(L.weight+C.weight),L.weight+=C.weight):(L.barycenter=C.barycenter,L.weight=C.weight)};ot.default=Q},21498:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var Y=$(69209),tt=function(Q,Z,R,L){var C=(0,Y.partition)(Q,function(P){var k=P.hasOwnProperty("fixorder")&&!isNaN(P.fixorder);return L?!k&&P.hasOwnProperty("barycenter"):k||P.hasOwnProperty("barycenter")}),A=C.lhs,N=C.rhs.sort(function(P,k){return-P.i- -k.i}),B=[],O=0,F=0,K=0;A==null||A.sort(W(!!Z,!!R)),K=j(B,N,K),A==null||A.forEach(function(P){var k;K+=(k=P.vs)===null||k===void 0?void 0:k.length,B.push(P.vs),O+=P.barycenter*P.weight,F+=P.weight,K=j(B,N,K)});var nt={vs:B.flat()};return F&&(nt.barycenter=O/F,nt.weight=F),nt},j=function(Q,Z,R){for(var L=R,C;Z.length&&(C=Z[Z.length-1]).i<=L;)Z.pop(),Q==null||Q.push(C.vs),L++;return L},W=function(Q,Z){return function(R,L){if(R.fixorder!==void 0&&L.fixorder!==void 0)return R.fixorder-L.fixorder;if(R.barycenter<L.barycenter)return-1;if(R.barycenter>L.barycenter)return 1;if(Z&&R.order!==void 0&&L.order!==void 0){if(R.order<L.order)return-1;if(R.order>L.order)return 1}return Q?L.i-R.i:R.i-L.i}};ot.default=tt},33562:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=function(j){var W,Q={},Z=0,R=function(L){var C,A=Z;(C=j.children(L))===null||C===void 0||C.forEach(R),Q[L]={low:A,lim:Z++}};return(W=j.children())===null||W===void 0||W.forEach(R),Q},Y=function(j,W,Q,Z){var R=[],L=[],C=Math.min(W[Q].low,W[Z].low),A=Math.max(W[Q].lim,W[Z].lim),N,B;N=Q;do N=j.parent(N),R.push(N);while(N&&(W[N].low>C||A>W[N].lim));for(B=N,N=Z;N&&N!==B;)L.push(N),N=j.parent(N);return{lca:B,path:R.concat(L.reverse())}},tt=function(j){var W,Q=$(j);(W=j.graph().dummyChains)===null||W===void 0||W.forEach(function(Z){var R,L,C=Z,A=j.node(C),N=A.edgeObj;if(!!N)for(var B=Y(j,Q,N.v,N.w),O=B.path,F=B.lca,K=0,nt=O[K],P=!0;C!==N.w;){if(A=j.node(C),P){for(;nt!==F&&((R=j.node(nt))===null||R===void 0?void 0:R.maxRank)<A.rank;)K++,nt=O[K];nt===F&&(P=!1)}if(!P){for(;K<O.length-1&&((L=j.node(O[K+1]))===null||L===void 0?void 0:L.minRank)<=A.rank;)K++;nt=O[K]}j.setParent(C,nt),C=j.successors(C)[0]}})};ot.default=tt},71963:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var st=function(lt,ht){return st=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(mt,wt){mt.__proto__=wt}||function(mt,wt){for(var ut in wt)Object.prototype.hasOwnProperty.call(wt,ut)&&(mt[ut]=wt[ut])},st(lt,ht)};return function(lt,ht){if(typeof ht!="function"&&ht!==null)throw new TypeError("Class extends value "+String(ht)+" is not a constructor or null");st(lt,ht);function mt(){this.constructor=lt}lt.prototype=ht===null?Object.create(ht):(mt.prototype=ht.prototype,new mt)}}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.width=ot.sep=ot.positionX=ot.balance=ot.alignCoordinates=ot.findSmallestWidthAlignment=ot.buildBlockGraph=ot.horizontalCompaction=ot.verticalAlignment=ot.hasConflict=ot.addConflict=ot.findOtherInnerSegmentNode=ot.findType2Conflicts=ot.findType1Conflicts=void 0;var tt=$(69787),j=$(45603),W=$(69209),Q=function(st){Y(lt,st);function lt(){return st!==null&&st.apply(this,arguments)||this}return lt}(tt.Graph),Z=function(st,lt){var ht={},mt=function(wt,ut){var pt=0,Nt=0,Ut=wt.length,ue=ut==null?void 0:ut[(ut==null?void 0:ut.length)-1];return ut==null||ut.forEach(function(se,Le){var Ne,we=(0,ot.findOtherInnerSegmentNode)(st,se),At=we?st.node(we).order:Ut;(we||se===ue)&&((Ne=ut.slice(Nt,Le+1))===null||Ne===void 0||Ne.forEach(function(Qt){var de;(de=st.predecessors(Qt))===null||de===void 0||de.forEach(function(rn){var Ee,ce=st.node(rn),Oe=ce.order;(Oe<pt||At<Oe)&&!(ce.dummy&&((Ee=st.node(Qt))===null||Ee===void 0?void 0:Ee.dummy))&&(0,ot.addConflict)(ht,rn,Qt)})}),Nt=Le+1,pt=At)}),ut};return(lt==null?void 0:lt.length)&&lt.reduce(mt),ht};ot.findType1Conflicts=Z;var R=function(st,lt){var ht={};function mt(Nt,Ut,ue,se,Le){for(var Ne,we,At,Qt=Ut;Qt<ue;Qt++)At=Nt[Qt],((Ne=st.node(At))===null||Ne===void 0?void 0:Ne.dummy)&&((we=st.predecessors(At))===null||we===void 0||we.forEach(function(de){var rn=st.node(de);rn.dummy&&(rn.order<se||rn.order>Le)&&(0,ot.addConflict)(ht,de,At)}))}function wt(Nt){return JSON.stringify(Nt.slice(1))}function ut(Nt,Ut){var ue=wt(Nt);Ut.get(ue)||(mt.apply(void 0,Nt),Ut.set(ue,!0))}var pt=function(Nt,Ut){var ue=-1,se,Le=0,Ne=new Map;return Ut==null||Ut.forEach(function(we,At){var Qt;if(((Qt=st.node(we))===null||Qt===void 0?void 0:Qt.dummy)==="border"){var de=st.predecessors(we)||[];de.length&&(se=st.node(de[0]).order,ut([Ut,Le,At,ue,se],Ne),Le=At,ue=se)}ut([Ut,Le,Ut.length,se,Nt.length],Ne)}),Ut};return(lt==null?void 0:lt.length)&&lt.reduce(pt),ht};ot.findType2Conflicts=R;var L=function(st,lt){var ht,mt;if((ht=st.node(lt))===null||ht===void 0?void 0:ht.dummy)return(mt=st.predecessors(lt))===null||mt===void 0?void 0:mt.find(function(wt){return st.node(wt).dummy})};ot.findOtherInnerSegmentNode=L;var C=function(st,lt,ht){var mt=lt,wt=ht;if(mt>wt){var ut=mt;mt=wt,wt=ut}var pt=st[mt];pt||(st[mt]=pt={}),pt[wt]=!0};ot.addConflict=C;var A=function(st,lt,ht){var mt=lt,wt=ht;if(mt>wt){var ut=lt;mt=wt,wt=ut}return!!st[mt]};ot.hasConflict=A;var N=function(st,lt,ht,mt){var wt={},ut={},pt={};return lt==null||lt.forEach(function(Nt){Nt==null||Nt.forEach(function(Ut,ue){wt[Ut]=Ut,ut[Ut]=Ut,pt[Ut]=ue})}),lt==null||lt.forEach(function(Nt){var Ut=-1;Nt==null||Nt.forEach(function(ue){var se=mt(ue);if(se.length){se=se.sort(function(Qt,de){return pt[Qt]-pt[de]});for(var Le=(se.length-1)/2,Ne=Math.floor(Le),we=Math.ceil(Le);Ne<=we;++Ne){var At=se[Ne];ut[ue]===ue&&Ut<pt[At]&&!(0,ot.hasConflict)(ht,ue,At)&&(ut[At]=ue,ut[ue]=wt[ue]=wt[At],Ut=pt[At])}}})}),{root:wt,align:ut}};ot.verticalAlignment=N;var B=function(st,lt,ht,mt,wt){var ut,pt={},Nt=(0,ot.buildBlockGraph)(st,lt,ht,wt),Ut=wt?"borderLeft":"borderRight",ue=function(Ne,we){for(var At=Nt.nodes(),Qt=At.pop(),de={};Qt;)de[Qt]?Ne(Qt):(de[Qt]=!0,At.push(Qt),At=At.concat(we(Qt))),Qt=At.pop()},se=function(Ne){pt[Ne]=(Nt.inEdges(Ne)||[]).reduce(function(we,At){return Math.max(we,(pt[At.v]||0)+Nt.edge(At))},0)},Le=function(Ne){var we=(Nt.outEdges(Ne)||[]).reduce(function(Qt,de){return Math.min(Qt,(pt[de.w]||0)-Nt.edge(de))},Number.POSITIVE_INFINITY),At=st.node(Ne);we!==Number.POSITIVE_INFINITY&&At.borderType!==Ut&&(pt[Ne]=Math.max(pt[Ne],we))};return ue(se,Nt.predecessors.bind(Nt)),ue(Le,Nt.successors.bind(Nt)),(ut=Object.values(mt))===null||ut===void 0||ut.forEach(function(Ne){pt[Ne]=pt[ht[Ne]]}),pt};ot.horizontalCompaction=B;var O=function(st,lt,ht,mt){var wt=new Q,ut=st.graph(),pt=(0,ot.sep)(ut.nodesep,ut.edgesep,mt);return lt==null||lt.forEach(function(Nt){var Ut;Nt==null||Nt.forEach(function(ue){var se=ht[ue];if(wt.setNode(se),Ut){var Le=ht[Ut],Ne=wt.edgeFromArgs(Le,se);wt.setEdge(Le,se,Math.max(pt(st,ue,Ut),Ne||0))}Ut=ue})}),wt};ot.buildBlockGraph=O;var F=function(st,lt){return(0,W.minBy)(Object.values(lt),function(ht){var mt,wt=Number.NEGATIVE_INFINITY,ut=Number.POSITIVE_INFINITY;return(mt=Object.keys(ht))===null||mt===void 0||mt.forEach(function(pt){var Nt=ht[pt],Ut=(0,ot.width)(st,pt)/2;wt=Math.max(Nt+Ut,wt),ut=Math.min(Nt-Ut,ut)}),wt-ut})};ot.findSmallestWidthAlignment=F;function K(st,lt){var ht=Object.values(lt),mt=(0,j.min)(ht),wt=(0,j.max)(ht);["u","d"].forEach(function(ut){["l","r"].forEach(function(pt){var Nt=ut+pt,Ut=st[Nt],ue;if(Ut!==lt){var se=Object.values(Ut);ue=pt==="l"?mt-(0,j.min)(se):wt-(0,j.max)(se),ue&&(st[Nt]={},Object.keys(Ut).forEach(function(Le){st[Nt][Le]=Ut[Le]+ue}))}})})}ot.alignCoordinates=K;var nt=function(st,lt){var ht={};return Object.keys(st.ul).forEach(function(mt){if(lt)ht[mt]=st[lt.toLowerCase()][mt];else{var wt=Object.values(st).map(function(ut){return ut[mt]});ht[mt]=(wt[0]+wt[1])/2}}),ht};ot.balance=nt;var P=function(st){var lt=(0,W.buildLayerMatrix)(st),ht=Object.assign((0,ot.findType1Conflicts)(st,lt),(0,ot.findType2Conflicts)(st,lt)),mt={},wt;["u","d"].forEach(function(pt){wt=pt==="u"?lt:Object.values(lt).reverse(),["l","r"].forEach(function(Nt){Nt==="r"&&(wt=wt.map(function(Le){return Object.values(Le).reverse()}));var Ut=(pt==="u"?st.predecessors:st.successors).bind(st),ue=(0,ot.verticalAlignment)(st,wt,ht,Ut),se=(0,ot.horizontalCompaction)(st,wt,ue.root,ue.align,Nt==="r");Nt==="r"&&Object.keys(se).forEach(function(Le){se[Le]=-se[Le]}),mt[pt+Nt]=se})});var ut=(0,ot.findSmallestWidthAlignment)(st,mt);return K(mt,ut),(0,ot.balance)(mt,st.graph().align)};ot.positionX=P;var k=function(st,lt,ht){return function(mt,wt,ut){var pt=mt.node(wt),Nt=mt.node(ut),Ut=0,ue;if(Ut+=pt.width/2,pt.hasOwnProperty("labelpos"))switch((pt.labelpos||"").toLowerCase()){case"l":ue=-pt.width/2;break;case"r":ue=pt.width/2;break}if(ue&&(Ut+=ht?ue:-ue),ue=0,Ut+=(pt.dummy?lt:st)/2,Ut+=(Nt.dummy?lt:st)/2,Ut+=Nt.width/2,Nt.labelpos)switch((Nt.labelpos||"").toLowerCase()){case"l":ue=Nt.width/2;break;case"r":ue=-Nt.width/2;break}return ue&&(Ut+=ht?ue:-ue),ue=0,Ut}};ot.sep=k;var yt=function(st,lt){return st.node(lt).width||0};ot.width=yt},95:function(ur,ot,$){"use strict";var Y=this&&this.__spreadArray||function(R,L,C){if(C||arguments.length===2)for(var A=0,N=L.length,B;A<N;A++)(B||!(A in L))&&(B||(B=Array.prototype.slice.call(L,0,A)),B[A]=L[A]);return R.concat(B||Array.prototype.slice.call(L))};Object.defineProperty(ot,"__esModule",{value:!0});var tt=$(69209),j=$(71963),W=function(R){var L=(0,tt.buildLayerMatrix)(R),C=R.graph().ranksep,A=0;L==null||L.forEach(function(N){var B=N.map(function(F){return R.node(F).height}),O=Math.max.apply(Math,Y(Y([],B,!1),[0],!1));N==null||N.forEach(function(F){R.node(F).y=A+O/2}),A+=O+C})},Q=function(R){var L=(0,tt.buildLayerMatrix)(R),C=Object.assign((0,j.findType1Conflicts)(R,L),(0,j.findType2Conflicts)(R,L)),A={},N=[];["u","d"].forEach(function(O){N=O==="u"?L:Object.values(L).reverse(),["l","r"].forEach(function(F){F==="r"&&(N=N.map(function(k){return Object.values(k).reverse()}));var K=(O==="u"?R.predecessors:R.successors).bind(R),nt=(0,j.verticalAlignment)(R,N,C,K),P=(0,j.horizontalCompaction)(R,N,nt.root,nt.align,F==="r");F==="r"&&Object.keys(P).forEach(function(k){return P[k]=-P[k]}),A[O+F]=P})});var B=(0,j.findSmallestWidthAlignment)(R,A);return B&&(0,j.alignCoordinates)(A,B),(0,j.balance)(A,R.graph().align)},Z=function(R){var L,C=(0,tt.asNonCompoundGraph)(R);W(C);var A=Q(C);(L=Object.keys(A))===null||L===void 0||L.forEach(function(N){C.node(N).x=A[N]})};ot.default=Z},13614:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.feasibleTreeWithLayer=ot.feasibleTree=void 0;var Y=$(37323),tt=$(69209),j=$(27652),W=function(A){var N=new j.Graph({directed:!1}),B=A.nodes()[0],O=A.nodeCount();N.setNode(B,{});for(var F,K;Q(N,A)<O;)F=L(N,A),K=N.hasNode(F.v)?(0,Y.slack)(A,F):-(0,Y.slack)(A,F),C(N,A,K);return N};ot.feasibleTree=W;var Q=function(A,N){var B=function(O){N.nodeEdges(O).forEach(function(F){var K=F.v,nt=O===K?F.w:K;!A.hasNode(nt)&&!(0,Y.slack)(N,F)&&(A.setNode(nt,{}),A.setEdge(O,nt,{}),B(nt))})};return A.nodes().forEach(B),A.nodeCount()},Z=function(A){var N=new j.Graph({directed:!1}),B=A.nodes()[0],O=A.nodes().filter(function(nt){return!!A.node(nt)}).length;N.setNode(B,{});for(var F,K;R(N,A)<O;)F=L(N,A),K=N.hasNode(F.v)?(0,Y.slack)(A,F):-(0,Y.slack)(A,F),C(N,A,K);return N};ot.feasibleTreeWithLayer=Z;var R=function(A,N){var B=function(O){var F;(F=N.nodeEdges(O))===null||F===void 0||F.forEach(function(K){var nt=K.v,P=O===nt?K.w:nt;!A.hasNode(P)&&(N.node(P).layer!==void 0||!(0,Y.slack)(N,K))&&(A.setNode(P,{}),A.setEdge(O,P,{}),B(P))})};return A.nodes().forEach(B),A.nodeCount()},L=function(A,N){return(0,tt.minBy)(N.edges(),function(B){return A.hasNode(B.v)!==A.hasNode(B.w)?(0,Y.slack)(N,B):Infinity})},C=function(A,N,B){A.nodes().forEach(function(O){N.node(O).rank||(N.node(O).rank=0),N.node(O).rank+=B})};ot.default={feasibleTree:W,feasibleTreeWithLayer:Z}},76827:function(ur,ot,$){"use strict";var Y=this&&this.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(ot,"__esModule",{value:!0});var tt=$(37323),j=$(13614),W=Y($(32253)),Q=function(C){switch(C.graph().ranker){case"network-simplex":L(C);break;case"tight-tree":R(C);break;case"longest-path":Z(C);break;default:R(C)}},Z=tt.longestPath,R=function(C){(0,tt.longestPathWithLayer)(C),(0,j.feasibleTreeWithLayer)(C)},L=function(C){(0,W.default)(C)};ot.default=Q},32253:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.exchangeEdges=ot.enterEdge=ot.leaveEdge=ot.initLowLimValues=ot.calcCutValue=ot.initCutValues=void 0;var Y=$(13614),tt=$(37323),j=$(69209),W=$(69787),Q=W.algorithm.preorder,Z=W.algorithm.postorder,R=function(yt){var st=(0,j.simplify)(yt);(0,tt.longestPath)(st);var lt=(0,Y.feasibleTree)(st);(0,ot.initLowLimValues)(lt),(0,ot.initCutValues)(lt,st);for(var ht,mt;ht=(0,ot.leaveEdge)(lt);)mt=(0,ot.enterEdge)(lt,st,ht),(0,ot.exchangeEdges)(lt,st,ht,mt)},L=function(yt,st){var lt=Z(yt,yt.nodes());lt=lt==null?void 0:lt.slice(0,(lt==null?void 0:lt.length)-1),lt==null||lt.forEach(function(ht){C(yt,st,ht)})};ot.initCutValues=L;var C=function(yt,st,lt){var ht=yt.node(lt),mt=ht.parent;yt.edgeFromArgs(lt,mt).cutvalue=(0,ot.calcCutValue)(yt,st,lt)},A=function(yt,st,lt){var ht,mt=yt.node(lt),wt=mt.parent,ut=!0,pt=st.edgeFromArgs(lt,wt),Nt=0;return pt||(ut=!1,pt=st.edgeFromArgs(wt,lt)),Nt=pt.weight,(ht=st.nodeEdges(lt))===null||ht===void 0||ht.forEach(function(Ut){var ue=Ut.v===lt,se=ue?Ut.w:Ut.v;if(se!==wt){var Le=ue===ut,Ne=st.edge(Ut).weight;if(Nt+=Le?Ne:-Ne,P(yt,lt,se)){var we=yt.edgeFromArgs(lt,se).cutvalue;Nt+=Le?-we:we}}}),Nt};ot.calcCutValue=A;var N=function(yt,st){st===void 0&&(st=yt.nodes()[0]),B(yt,{},1,st)};ot.initLowLimValues=N;var B=function(yt,st,lt,ht,mt){var wt,ut=lt,pt=lt,Nt=yt.node(ht);return st[ht]=!0,(wt=yt.neighbors(ht))===null||wt===void 0||wt.forEach(function(Ut){st[Ut]||(pt=B(yt,st,pt,Ut,ht))}),Nt.low=ut,Nt.lim=pt++,mt?Nt.parent=mt:delete Nt.parent,pt},O=function(yt){return yt.edges().find(function(st){return yt.edge(st).cutvalue<0})};ot.leaveEdge=O;var F=function(yt,st,lt){var ht=lt.v,mt=lt.w;st.hasEdge(ht,mt)||(ht=lt.w,mt=lt.v);var wt=yt.node(ht),ut=yt.node(mt),pt=wt,Nt=!1;wt.lim>ut.lim&&(pt=ut,Nt=!0);var Ut=st.edges().filter(function(ue){return Nt===k(yt,yt.node(ue.v),pt)&&Nt!==k(yt,yt.node(ue.w),pt)});return(0,j.minBy)(Ut,function(ue){return(0,tt.slack)(st,ue)})};ot.enterEdge=F;var K=function(yt,st,lt,ht){var mt=lt.v,wt=lt.w;yt.removeEdge(mt,wt),yt.setEdge(ht.v,ht.w,{}),(0,ot.initLowLimValues)(yt),(0,ot.initCutValues)(yt,st),nt(yt,st)};ot.exchangeEdges=K;var nt=function(yt,st){var lt=yt.nodes().find(function(mt){var wt;return!((wt=st.node(mt))===null||wt===void 0?void 0:wt.parent)}),ht=Q(yt,lt);ht=ht==null?void 0:ht.slice(1),ht==null||ht.forEach(function(mt){var wt=yt.node(mt).parent,ut=st.edgeFromArgs(mt,wt),pt=!1;ut||(ut=st.edgeFromArgs(wt,mt),pt=!0),st.node(mt).rank=st.node(wt).rank+(pt?ut.minlen:-ut.minlen)})},P=function(yt,st,lt){return yt.hasEdge(st,lt)},k=function(yt,st,lt){return lt.low<=st.lim&&st.lim<=lt.lim};ot.default=R},37323:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.slack=ot.longestPathWithLayer=ot.longestPath=void 0;var $=function(j){var W,Q={},Z=function(R){var L,C=j.node(R);if(!C)return 0;if(Q[R])return C.rank;Q[R]=!0;var A;return(L=j.outEdges(R))===null||L===void 0||L.forEach(function(N){var B=Z(N.w),O=j.edge(N).minlen,F=B-O;F&&(A===void 0||F<A)&&(A=F)}),A||(A=0),C.rank=A,A};(W=j.sources())===null||W===void 0||W.forEach(function(R){return Z(R)})};ot.longestPath=$;var Y=function(j){var W,Q={},Z,R=function(A){var N,B=j.node(A);if(!B)return 0;if(Q[A])return B.rank;Q[A]=!0;var O;return(N=j.outEdges(A))===null||N===void 0||N.forEach(function(F){var K=R(F.w),nt=j.edge(F).minlen,P=K-nt;P&&(O===void 0||P<O)&&(O=P)}),O||(O=0),(Z===void 0||O<Z)&&(Z=O),B.rank=O,O};(W=j.sources())===null||W===void 0||W.forEach(function(A){j.node(A)&&R(A)}),Z===void 0&&(Z=0);var L={},C=function(A,N){var B,O=j.node(A),F=isNaN(O.layer)?N:O.layer;(O.rank===void 0||O.rank<F)&&(O.rank=F),!L[A]&&(L[A]=!0,(B=j.outEdges(A))===null||B===void 0||B.map(function(K){C(K.w,F+j.edge(K).minlen)}))};j.nodes().forEach(function(A){var N=j.node(A);!N||(isNaN(N.layer)?N.rank-=Z:C(A,N.layer))})};ot.longestPathWithLayer=Y;var tt=function(j,W){return j.node(W.w).rank-j.node(W.v).rank-j.edge(W).minlen};ot.slack=tt,ot.default={longestPath:$,longestPathWithLayer:Y,slack:tt}},69209:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.minBy=ot.notime=ot.time=ot.partition=ot.maxRank=ot.addBorderNode=ot.removeEmptyRanks=ot.normalizeRanks=ot.buildLayerMatrix=ot.intersectRect=ot.predecessorWeights=ot.successorWeights=ot.zipObject=ot.asNonCompoundGraph=ot.simplify=ot.addDummyNode=void 0;var Y=$(49784),tt=$(27652),j=function(st,lt){return Number(st)-Number(lt)},W=function(st,lt,ht,mt){var wt;do wt="".concat(mt).concat(Math.random());while(st.hasNode(wt));return ht.dummy=lt,st.setNode(wt,ht),wt};ot.addDummyNode=W;var Q=function(st){var lt=new tt.Graph().setGraph(st.graph());return st.nodes().forEach(function(ht){lt.setNode(ht,st.node(ht))}),st.edges().forEach(function(ht){var mt=lt.edgeFromArgs(ht.v,ht.w)||{weight:0,minlen:1},wt=st.edge(ht);lt.setEdge(ht.v,ht.w,{weight:mt.weight+wt.weight,minlen:Math.max(mt.minlen,wt.minlen)})}),lt};ot.simplify=Q;var Z=function(st){var lt=new tt.Graph({multigraph:st.isMultigraph()}).setGraph(st.graph());return st.nodes().forEach(function(ht){var mt;((mt=st.children(ht))===null||mt===void 0?void 0:mt.length)||lt.setNode(ht,st.node(ht))}),st.edges().forEach(function(ht){lt.setEdgeObj(ht,st.edge(ht))}),lt};ot.asNonCompoundGraph=Z;var R=function(st,lt){return st==null?void 0:st.reduce(function(ht,mt,wt){return ht[mt]=lt[wt],ht},{})};ot.zipObject=R;var L=function(st){var lt={};return st.nodes().forEach(function(ht){var mt,wt={};(mt=st.outEdges(ht))===null||mt===void 0||mt.forEach(function(ut){var pt;wt[ut.w]=(wt[ut.w]||0)+(((pt=st.edge(ut))===null||pt===void 0?void 0:pt.weight)||0)}),lt[ht]=wt}),lt};ot.successorWeights=L;var C=function(st){var lt=st.nodes(),ht=lt.map(function(mt){var wt,ut={};return(wt=st.inEdges(mt))===null||wt===void 0||wt.forEach(function(pt){ut[pt.v]=(ut[pt.v]||0)+st.edge(pt).weight}),ut});return(0,ot.zipObject)(lt,ht)};ot.predecessorWeights=C;var A=function(st,lt){var ht=Number(st.x),mt=Number(st.y),wt=Number(lt.x)-ht,ut=Number(lt.y)-mt,pt=Number(st.width)/2,Nt=Number(st.height)/2;if(!wt&&!ut)return{x:0,y:0};var Ut,ue;return Math.abs(ut)*pt>Math.abs(wt)*Nt?(ut<0&&(Nt=-Nt),Ut=Nt*wt/ut,ue=Nt):(wt<0&&(pt=-pt),Ut=pt,ue=pt*ut/wt),{x:ht+Ut,y:mt+ue}};ot.intersectRect=A;var N=function(st){for(var lt=[],ht=(0,ot.maxRank)(st)+1,mt=0;mt<ht;mt++)lt.push([]);st.nodes().forEach(function(wt){var ut=st.node(wt);if(!!ut){var pt=ut.rank;pt!==void 0&&lt[pt]&&lt[pt].push(wt)}});for(var mt=0;mt<ht;mt++)lt[mt]=lt[mt].sort(function(ut,pt){var Nt,Ut;return j((Nt=st.node(ut))===null||Nt===void 0?void 0:Nt.order,(Ut=st.node(pt))===null||Ut===void 0?void 0:Ut.order)});return lt};ot.buildLayerMatrix=N;var B=function(st){var lt=st.nodes().filter(function(mt){var wt;return((wt=st.node(mt))===null||wt===void 0?void 0:wt.rank)!==void 0}).map(function(mt){return st.node(mt).rank}),ht=Math.min.apply(Math,lt);st.nodes().forEach(function(mt){var wt=st.node(mt);wt.hasOwnProperty("rank")&&ht!==Infinity&&(wt.rank-=ht)})};ot.normalizeRanks=B;var O=function(st){var lt=st.nodes(),ht=lt.filter(function(ue){var se;return((se=st.node(ue))===null||se===void 0?void 0:se.rank)!==void 0}).map(function(ue){return st.node(ue).rank}),mt=Math.min.apply(Math,ht),wt=[];lt.forEach(function(ue){var se,Le=(((se=st.node(ue))===null||se===void 0?void 0:se.rank)||0)-mt;wt[Le]||(wt[Le]=[]),wt[Le].push(ue)});for(var ut=0,pt=st.graph().nodeRankFactor||0,Nt=0;Nt<wt.length;Nt++){var Ut=wt[Nt];Ut===void 0?Nt%pt!=0&&(ut-=1):ut&&(Ut==null||Ut.forEach(function(ue){var se=st.node(ue);se&&(se.rank=se.rank||0,se.rank+=ut)}))}};ot.removeEmptyRanks=O;var F=function(st,lt,ht,mt){var wt={width:0,height:0};return(0,Y.isNumber)(ht)&&(0,Y.isNumber)(mt)&&(wt.rank=ht,wt.order=mt),(0,ot.addDummyNode)(st,"border",wt,lt)};ot.addBorderNode=F;var K=function(st){var lt;return st.nodes().forEach(function(ht){var mt,wt=(mt=st.node(ht))===null||mt===void 0?void 0:mt.rank;wt!==void 0&&(lt===void 0||wt>lt)&&(lt=wt)}),lt||(lt=0),lt};ot.maxRank=K;var nt=function(st,lt){var ht={lhs:[],rhs:[]};return st==null||st.forEach(function(mt){lt(mt)?ht.lhs.push(mt):ht.rhs.push(mt)}),ht};ot.partition=nt;var P=function(st,lt){var ht=Date.now();try{return lt()}finally{console.log("".concat(st," time: ").concat(Date.now()-ht,"ms"))}};ot.time=P;var k=function(st,lt){return lt()};ot.notime=k;var yt=function(st,lt){return st.reduce(function(ht,mt){var wt=lt(ht),ut=lt(mt);return wt>ut?mt:ht})};ot.minBy=yt},77057:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var L=function(C,A){return L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,B){N.__proto__=B}||function(N,B){for(var O in B)Object.prototype.hasOwnProperty.call(B,O)&&(N[O]=B[O])},L(C,A)};return function(C,A){if(typeof A!="function"&&A!==null)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");L(C,A);function N(){this.constructor=C}C.prototype=A===null?Object.create(A):(N.prototype=A.prototype,new N)}}(),tt=this&&this.__assign||function(){return tt=Object.assign||function(L){for(var C,A=1,N=arguments.length;A<N;A++){C=arguments[A];for(var B in C)Object.prototype.hasOwnProperty.call(C,B)&&(L[B]=C[B])}return L},tt.apply(this,arguments)},j=this&&this.__spreadArray||function(L,C,A){if(A||arguments.length===2)for(var N=0,B=C.length,O;N<B;N++)(O||!(N in C))&&(O||(O=Array.prototype.slice.call(C,0,N)),O[N]=C[N]);return L.concat(O||Array.prototype.slice.call(C))};Object.defineProperty(ot,"__esModule",{value:!0}),ot.DagreCompoundLayout=void 0;var W=$(62329),Q=$(31969),Z=$(49784),R=function(L){Y(C,L);function C(A){var N=L.call(this)||this;return N.rankdir="TB",N.nodesep=50,N.edgesep=5,N.ranksep=50,N.controlPoints=!0,N.anchorPoint=!0,N.nodes=[],N.edges=[],N.combos=[],N.onLayoutEnd=function(){},N.updateCfg(A),N}return C.prototype.getDefaultCfg=function(){return{rankdir:"TB",align:void 0,begin:void 0,nodeSize:void 0,nodesep:50,ranksep:50,controlPoints:!0,anchorPoint:!0}},C.prototype.init=function(A){var N=A.hiddenNodes||[],B=A.hiddenEdges||[],O=A.hiddenCombos||[];this.nodes=this.getDataByOrder((A.nodes||[]).concat(N)),this.edges=this.getDataByOrder((A.edges||[]).concat(B)),this.combos=(A.combos||[]).concat(O.map(function(F){return tt(tt({},F),{collapsed:!0})}))},C.prototype.execute=function(){var A=this,N=A.nodes,B=A.edges;if(!!N){var O=A.getLayoutConfig(),F=O.graphDef,K=O.graphOption,nt=O.graphSettings,P=(0,Q.buildGraph)(F,K,nt),k=(0,Q.flatGraph)(P,!0);return this.updatePosition(k),A.onLayoutEnd&&A.onLayoutEnd(),{nodes:N,edges:B}}},C.prototype.getNodePath=function(A){var N=this,B=N.nodes,O=N.combos,F=B.find(function(nt){return nt.id===A}),K=function(nt,P){P===void 0&&(P=[]);var k=O.find(function(yt){return yt.id===nt});return k?(P.unshift(nt),k.parentId?K(k.parentId,P):P):P};return F&&F.comboId?K(F.comboId,[A]):[A]},C.prototype.getLayoutConfig=function(){var A,N,B,O=this,F=O.nodes,K=O.edges,nt=O.combos,P=O.nodeSize,k=O.rankdir,yt=O.align,st=O.edgesep,lt=O.nodesep,ht=O.ranksep,mt=O.settings,wt=(nt||[]).reduce(function(Oe,Ze){var fe=F.filter(function(Ye){return Ye.comboId===Ze.id}).map(function(Ye){return Ye.id}),Ae=(nt||[]).filter(function(Ye){return Ye.parentId===Ze.id}).map(function(Ye){return Ye.id});return(fe.length||Ae.length)&&(Oe[Ze.id]=j(j([],fe,!0),Ae,!0)),Oe},{}),ut;P?(0,Z.isArray)(P)?ut=function(){return P}:ut=function(){return[P,P]}:ut=function(Oe){return Oe&&Oe.size?(0,Z.isArray)(Oe.size)?Oe.size:(0,Z.isObject)(Oe.size)?[Oe.size.width||40,Oe.size.height||40]:[Oe.size,Oe.size]:[40,40]};var pt=function(Oe){return Oe&&Oe.size?(0,Z.isArray)(Oe.size)?Oe.size:[Oe.size,Oe.size]:[80,40]},Nt=pt(nt==null?void 0:nt[0]),Ut=Nt[0],ue=Nt[1],se=(N=(A=O.graphSettings)===null||A===void 0?void 0:A.subScene)===null||N===void 0?void 0:N.meta,Le=((B=nt.find(function(Oe){return!Oe.collapsed}))===null||B===void 0?void 0:B.padding)||[20,20,20,20],Ne=Le[0],we=Le[1],At=Le[2],Qt=Le[3],de={compound:wt,nodes:j([],(F||[]).map(function(Oe){var Ze=ut(Oe),fe=Ze[0],Ae=Ze[1];return tt(tt({},Oe),{width:fe,height:Ae})}),!0),edges:j([],(K||[]).map(function(Oe){return tt(tt({},Oe),{v:Oe.source,w:Oe.target})}),!0)},rn={expanded:(nt||[]).filter(function(Oe){return!Oe.collapsed}).map(function(Oe){return Oe.id})},Ee={graph:{meta:{align:yt,rankDir:k,nodeSep:lt,edgeSep:st,rankSep:ht}},subScene:{meta:{paddingTop:Ne||(se==null?void 0:se.paddingTop)||20,paddingRight:we||(se==null?void 0:se.paddingRight)||20,paddingBottom:At||(se==null?void 0:se.paddingBottom)||20,paddingLeft:Qt||(se==null?void 0:se.paddingLeft)||20,labelHeight:0}},nodeSize:{meta:{width:Ut,height:ue}}},ce=(0,Q.mergeConfig)(mt,tt({},(0,Q.mergeConfig)(Ee,Q.LAYOUT_CONFIG)));return O.graphSettings=ce,{graphDef:de,graphOption:rn,graphSettings:ce}},C.prototype.updatePosition=function(A){var N=A.nodes,B=A.edges;this.updateNodePosition(N,B),this.updateEdgePosition(N,B)},C.prototype.getBegin=function(A,N){var B=this,O=B.begin,F=[0,0];if(O){var K=Infinity,nt=Infinity;A.forEach(function(P){K>P.x&&(K=P.x),nt>P.y&&(nt=P.y)}),N.forEach(function(P){P.points.forEach(function(k){K>k.x&&(K=k.x),nt>k.y&&(nt=k.y)})}),F[0]=O[0]-K,F[1]=O[1]-nt}return F},C.prototype.updateNodePosition=function(A,N){var B=this,O=B.combos,F=B.nodes,K=B.edges,nt=B.anchorPoint,P=B.graphSettings,k=this.getBegin(A,N);A.forEach(function(yt){var st,lt=yt.x,ht=yt.y,mt=yt.id,wt=yt.type,ut=yt.coreBox;if(wt===Q.HierarchyNodeType.META&&mt!==Q.ROOT_NAME){var pt=O.findIndex(function(Le){return Le.id===mt}),Nt=(st=P==null?void 0:P.subScene)===null||st===void 0?void 0:st.meta;O[pt].offsetX=lt+k[0],O[pt].offsetY=ht+k[1],O[pt].fixSize=[ut.width,ut.height],O[pt].fixCollapseSize=[ut.width,ut.height],yt.expanded?O[pt].padding=[Nt==null?void 0:Nt.paddingTop,Nt==null?void 0:Nt.paddingRight,Nt==null?void 0:Nt.paddingBottom,Nt==null?void 0:Nt.paddingLeft]:O[pt].padding=[0,0,0,0]}else if(wt===Q.HierarchyNodeType.OP){var pt=F.findIndex(function(Ne){return Ne.id===mt});if(F[pt].x=lt+k[0],F[pt].y=ht+k[1],nt){var Ut=[],ue=N.filter(function(Ne){return Ne.v===mt}),se=N.filter(function(Ne){return Ne.w===mt});ue.length>0&&ue.forEach(function(Ne){var we=Ne.points[0],At=(we.x-lt)/yt.width+.5,Qt=(we.y-ht)/yt.height+.5;Ut.push([At,Qt]),Ne.baseEdgeList.forEach(function(de){var rn=K.find(function(Ee){return Ee.source===de.v&&Ee.target===de.w});rn&&(rn.sourceAnchor=Ut.length-1)})}),se.length>0&&se.forEach(function(Ne){var we=Ne.points[Ne.points.length-1],At=(we.x-lt)/yt.width+.5,Qt=(we.y-ht)/yt.height+.5;Ut.push([At,Qt]),Ne.baseEdgeList.forEach(function(de){var rn=K.find(function(Ee){return Ee.source===de.v&&Ee.target===de.w});rn&&(rn.targetAnchor=Ut.length-1)})}),F[pt].anchorPoints=Ut.length>0?Ut:F[pt].anchorPoints||[]}}})},C.prototype.updateEdgePosition=function(A,N){var B=this,O=B.combos,F=B.edges,K=B.controlPoints,nt=this.getBegin(A,N);K&&(O.forEach(function(P){P.inEdges=[],P.outEdges=[]}),F.forEach(function(P){var k,yt,st,lt,ht=A.find(function(Le){return Le.id===P.source}),mt=A.find(function(Le){return Le.id===P.target}),wt=[],ut=[];if(ht&&mt)ut=(0,Q.getEdges)(ht==null?void 0:ht.id,mt==null?void 0:mt.id,A);else if(!ht||!mt){var pt=B.getNodePath(P.source),Nt=B.getNodePath(P.target),Ut=pt.reverse().slice(ht?0:1).find(function(Le){return A.find(function(Ne){return Ne.id===Le})}),ue=Nt.reverse().slice(mt?0:1).find(function(Le){return A.find(function(Ne){return Ne.id===Le})});ht=A.find(function(Le){return Le.id===Ut}),mt=A.find(function(Le){return Le.id===ue}),ut=(0,Q.getEdges)(ht==null?void 0:ht.id,mt==null?void 0:mt.id,A,{v:P.source,w:P.target})}if(wt=ut.reduce(function(Le,Ne){return j(j([],Le,!0),Ne.points.map(function(we){return tt(tt({},we),{x:we.x+nt[0],y:we.y+nt[1]})}),!0)},[]),wt=wt.slice(1,-1),P.controlPoints=wt,(mt==null?void 0:mt.type)===Q.NodeType.META){var se=O.findIndex(function(Le){return Le.id===(mt==null?void 0:mt.id)});if(!O[se]||((k=O[se].inEdges)===null||k===void 0?void 0:k.some(function(Le){return Le.source===ht.id&&Le.target===mt.id})))return;(yt=O[se].inEdges)===null||yt===void 0||yt.push({source:ht.id,target:mt.id,controlPoints:wt})}if((ht==null?void 0:ht.type)===Q.NodeType.META){var se=O.findIndex(function(Ne){return Ne.id===(ht==null?void 0:ht.id)});if(!O[se]||((st=O[se].outEdges)===null||st===void 0?void 0:st.some(function(Ne){return Ne.source===ht.id&&Ne.target===mt.id})))return;(lt=O[se].outEdges)===null||lt===void 0||lt.push({source:ht.id,target:mt.id,controlPoints:wt})}}))},C.prototype.getType=function(){return"dagreCompound"},C.prototype.getDataByOrder=function(A){return A.every(function(N){return N.layoutOrder!==void 0})||A.forEach(function(N,B){N.layoutOrder=B}),A.sort(function(N,B){return N.layoutOrder-B.layoutOrder})},C}(W.Base);ot.DagreCompoundLayout=R},34015:function(ur,ot,$){"use strict";var Y=this&&this.__assign||function(){return Y=Object.assign||function(N){for(var B,O=1,F=arguments.length;O<F;O++){B=arguments[O];for(var K in B)Object.prototype.hasOwnProperty.call(B,K)&&(N[K]=B[K])}return N},Y.apply(this,arguments)},tt=this&&this.__createBinding||(Object.create?function(N,B,O,F){F===void 0&&(F=O);var K=Object.getOwnPropertyDescriptor(B,O);(!K||("get"in K?!B.__esModule:K.writable||K.configurable))&&(K={enumerable:!0,get:function(){return B[O]}}),Object.defineProperty(N,F,K)}:function(N,B,O,F){F===void 0&&(F=O),N[F]=B[O]}),j=this&&this.__setModuleDefault||(Object.create?function(N,B){Object.defineProperty(N,"default",{enumerable:!0,value:B})}:function(N,B){N.default=B}),W=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var B={};if(N!=null)for(var O in N)O!=="default"&&Object.prototype.hasOwnProperty.call(N,O)&&tt(B,N,O);return j(B,N),B},Q=this&&this.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(ot,"__esModule",{value:!0});var Z=W($(37674)),R=Q($(88221)),L=Q($(87064)),C=$(20171);function A(N,B){var O=N.nodes,F=N.edges,K=B.width,nt=B.height;if(!(O==null?void 0:O.length))return Promise.resolve();var P=[];O.forEach(function(ut){var pt=F.filter(function(Ut){return Ut.source===ut.id||Ut.target===ut.id});if(pt.length>1){var Nt=Y({},ut);delete Nt.size,P.push(Nt)}});var k=[];F.forEach(function(ut){var pt=P.find(function(Ut){return Ut.id===ut.source}),Nt=P.find(function(Ut){return Ut.id===ut.target});pt&&Nt&&k.push(ut)});var yt=new C.DagreLayout({type:"dagre",ranksep:B.nodeMinGap,nodesep:B.nodeMinGap}),st=yt.layout({nodes:P,edges:k}).nodes;O.forEach(function(ut){var pt=(st||[]).find(function(Nt){return Nt.id===ut.id});ut.x=(pt==null?void 0:pt.x)||K/2,ut.y=(pt==null?void 0:pt.y)||nt/2});var lt=JSON.parse(JSON.stringify(O)),ht=JSON.parse(JSON.stringify(F)),mt=Z.forceSimulation().nodes(lt).force("link",Z.forceLink(ht).id(function(ut){return ut.id}).distance(function(ut){var pt=k.find(function(Nt){return Nt.source===ut.source&&Nt.target===ut.target});return pt?30:20})).force("charge",Z.forceManyBody()).force("center",Z.forceCenter(K/2,nt/2)).force("x",Z.forceX(K/2)).force("y",Z.forceY(nt/2)).alpha(.3).alphaDecay(.08).alphaMin(.001),wt=new Promise(function(ut){mt.on("end",function(){O.forEach(function(Ne){var we=lt.find(function(At){return At.id===Ne.id});we&&(Ne.x=we.x,Ne.y=we.y)});var pt=Math.min.apply(Math,O.map(function(Ne){return Ne.x})),Nt=Math.max.apply(Math,O.map(function(Ne){return Ne.x})),Ut=Math.min.apply(Math,O.map(function(Ne){return Ne.y})),ue=Math.max.apply(Math,O.map(function(Ne){return Ne.y})),se=K/(Nt-pt),Le=nt/(ue-Ut);O.forEach(function(Ne){Ne.x!==void 0&&se<1&&(Ne.x=(Ne.x-pt)*se),Ne.y!==void 0&&Le<1&&(Ne.y=(Ne.y-Ut)*Le)}),O.forEach(function(Ne){Ne.sizeTemp=Ne.size,Ne.size=[10,10]}),(0,L.default)(O,F),O.forEach(function(Ne){Ne.size=Ne.sizeTemp||[],delete Ne.sizeTemp}),(0,R.default)({nodes:O,edges:F},B),ut()})});return wt}ot.default=A},88221:function(ur,ot,$){"use strict";var Y=this&&this.__importDefault||function(W){return W&&W.__esModule?W:{default:W}};Object.defineProperty(ot,"__esModule",{value:!0});var tt=Y($(28611));function j(W,Q){if(!W.nodes||W.nodes.length===0)return W;var Z=Q.width,R=Q.height,L=Q.nodeMinGap,C=1e4,A=1e4;W.nodes.forEach(function(ht){var mt=ht.size[0]||50,wt=ht.size[1]||50;C=Math.min(mt,C),A=Math.min(wt,A)});var N=new tt.default;N.init(Z,R,{CELL_H:A,CELL_W:C}),W.nodes.forEach(function(ht){var mt=N.occupyNearest(ht);mt&&(mt.node={id:ht.id,size:ht.size},ht.x=mt.x,ht.y=mt.y,ht.dx=mt.dx,ht.dy=mt.dy)});for(var B=0;B<W.nodes.length;B++){var O=W.nodes[B],F=N.findGridByNodeId(O.id);if(!F)throw new Error("can not find node cell");var K=F.column,nt=F.row;if(O.size[0]+L>C){for(var P=Math.ceil((O.size[0]+L)/C)-1,k=P,yt=0;yt<P;yt++){var st=N.additionColumn.indexOf(K+yt+1)>-1;if(st&&!N.cells[K+yt+1][nt].node)k--;else break}N.insertColumn(K,k)}if(O.size[1]+L>A){for(var P=Math.ceil((O.size[1]+L)/A)-1,k=P,yt=0;yt<P;yt++){var st=N.additionRow.indexOf(nt+yt+1)>-1;if(st&&!N.cells[K][nt+yt+1].node)k--;else break}N.insertRow(nt,k)}}for(var B=0;B<N.columnNum;B++)for(var lt=function(mt){var wt=N.cells[B][mt];if(wt.node){var ut=W.nodes.find(function(pt){var Nt;return pt.id===((Nt=wt==null?void 0:wt.node)===null||Nt===void 0?void 0:Nt.id)});ut&&(ut.x=wt.x+ut.size[0]/2,ut.y=wt.y+ut.size[1]/2)}},yt=0;yt<N.rowNum;yt++)lt(yt)}ot.default=j},28611:function(ur,ot){"use strict";var $=this&&this.__assign||function(){return $=Object.assign||function(tt){for(var j,W=1,Q=arguments.length;W<Q;W++){j=arguments[W];for(var Z in j)Object.prototype.hasOwnProperty.call(j,Z)&&(tt[Z]=j[Z])}return tt},$.apply(this,arguments)};Object.defineProperty(ot,"__esModule",{value:!0});var Y=function(){function tt(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}return tt.prototype.init=function(j,W,Q){this.cells=[],this.CELL_W=Q.CELL_W||tt.DEFAULT_CELL_W,this.CELL_H=Q.CELL_H||tt.DEFAULT_CELL_H,this.columnNum=Math.ceil(j/this.CELL_W),this.rowNum=Math.ceil(W/this.CELL_H),tt.MIN_DIST=Math.pow(j,2)+Math.pow(W,2);for(var Z=0;Z<this.columnNum;Z++){for(var R=[],L=0;L<this.rowNum;L++){var C={dx:Z,dy:L,x:Z*this.CELL_W,y:L*this.CELL_H,occupied:!1};R.push(C)}this.cells.push(R)}},tt.prototype.findGridByNodeId=function(j){for(var W,Q,Z=0;Z<this.columnNum;Z++)for(var R=0;R<this.rowNum;R++)if(this.cells[Z][R].node&&((Q=(W=this.cells[Z][R])===null||W===void 0?void 0:W.node)===null||Q===void 0?void 0:Q.id)===j)return{column:Z,row:R};return null},tt.prototype.sqdist=function(j,W){return Math.pow(j.x-W.x,2)+Math.pow(j.y-W.y,2)},tt.prototype.occupyNearest=function(j){for(var W=tt.MIN_DIST,Q,Z=null,R=0;R<this.columnNum;R++)for(var L=0;L<this.rowNum;L++)!this.cells[R][L].occupied&&(Q=this.sqdist(j,this.cells[R][L]))<W&&(W=Q,Z=this.cells[R][L]);return Z&&(Z.occupied=!0),Z},tt.prototype.insertColumn=function(j,W){if(!(W<=0)){for(var Q=0;Q<W;Q++){this.cells[Q+this.columnNum]=[];for(var Z=0;Z<this.rowNum;Z++)this.cells[Q+this.columnNum][Z]={dx:Q,dy:Z,x:Q*this.CELL_W,y:Z*this.CELL_H,occupied:!1,node:null}}for(var Q=this.columnNum-1;Q>j;Q--)for(var Z=0;Z<this.rowNum;Z++)this.cells[Q+W][Z]=$($({},this.cells[Q][Z]),{x:(Q+W)*this.CELL_W,y:Z*this.CELL_H}),this.cells[Q][Z]={x:Q*this.CELL_W,y:Z*this.CELL_H,occupied:!0,node:null};for(var Z=0;Z<this.additionColumn.length;Z++)this.additionColumn[Z]>=j&&(this.additionColumn[Z]+=W);for(var Q=0;Q<W;Q++)this.additionColumn.push(j+Q+1);this.columnNum+=W}},tt.prototype.insertRow=function(j,W){if(!(W<=0)){for(var Q=0;Q<W;Q++)for(var Z=0;Z<this.columnNum;Z++)this.cells[Z][Q+this.rowNum]={dx:Z,dy:Q,x:Z*this.CELL_W,y:Q*this.CELL_H,occupied:!1,node:null};for(var Z=0;Z<this.columnNum;Z++)for(var Q=this.rowNum-1;Q>j;Q--)this.cells[Z][Q+W]=$($({},this.cells[Z][Q]),{dx:Z,dy:Q+W,x:Z*this.CELL_W,y:(Q+W)*this.CELL_H}),this.cells[Z][Q]={dx:Z,dy:Q,x:Z*this.CELL_W,y:Q*this.CELL_H,occupied:!1,node:null};for(var Q=0;Q<this.additionRow.length;Q++)this.additionRow[Q]>=j&&(this.additionRow[Q]+=W);for(var Z=0;Z<W;Z++)this.additionRow.push(j+Z+1);this.rowNum+=W}},tt.prototype.getNodes=function(){for(var j=[],W=0;W<this.columnNum;W++)for(var Q=0;Q<this.rowNum;Q++)this.cells[W][Q].node&&j.push(this.cells[W][Q]);return j},tt.MIN_DIST=50,tt.DEFAULT_CELL_W=80,tt.DEFAULT_CELL_H=80,tt}();ot.default=Y},90441:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var Z=function(R,L){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,A){C.__proto__=A}||function(C,A){for(var N in A)Object.prototype.hasOwnProperty.call(A,N)&&(C[N]=A[N])},Z(R,L)};return function(R,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");Z(R,L);function C(){this.constructor=R}R.prototype=L===null?Object.create(L):(C.prototype=L.prototype,new C)}}(),tt=this&&this.__importDefault||function(Z){return Z&&Z.__esModule?Z:{default:Z}};Object.defineProperty(ot,"__esModule",{value:!0}),ot.ERLayout=void 0;var j=$(62329),W=tt($(34015)),Q=function(Z){Y(R,Z);function R(L){var C=Z.call(this)||this;return C.width=300,C.height=300,C.nodeMinGap=50,C.onLayoutEnd=function(){},L&&C.updateCfg(L),C}return R.prototype.getDefaultCfg=function(){return{width:300,height:300,nodeMinGap:50}},R.prototype.execute=function(){var L=this,C=L.nodes,A=L.edges;return C==null||C.forEach(function(N){N.size||(N.size=[50,50])}),(0,W.default)({nodes:C,edges:A},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then(function(){L.onLayoutEnd&&L.onLayoutEnd()})},R.prototype.getType=function(){return"er"},R}(j.Base);ot.ERLayout=Q},87064:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=1200,Y=800,tt=1e7,j=10,W=3.141592653589793,Q=1.5707963267948966,Z=W*.375,R=W*.625,L=new Map,C=10,A=10,N=.8,B=.1,O=.5;function F(lt,ht,mt){var wt=lt.x-lt.size[0]/2,ut=lt.y-lt.size[1]/2,pt=lt.x+lt.size[0]/2,Nt=lt.y+lt.size[1]/2,Ut=ht.x-ht.size[0]/2,ue=ht.y-ht.size[1]/2,se=ht.x+ht.size[0]/2,Le=ht.y+ht.size[1]/2,Ne=lt.x,we=lt.y,At=ht.x,Qt=ht.y,de=At-Ne,rn=Math.atan2(de,Qt-we),Ee=0,ce=0,Oe=0,Ze=0;rn>Q?(ce=ut-Le,Ee=Ut-pt,Oe=parseFloat(ce?(ce/Math.cos(rn)).toFixed(2):Ee.toFixed(2)),Ze=parseFloat(Ee?(Ee/Math.sin(rn)).toFixed(2):ce.toFixed(2))):0<rn&&rn<=Q?(ce=ue-Nt,Ee=Ut-pt,ce>Ee?Oe=Ze=parseFloat(ce?(ce/Math.cos(rn)).toFixed(2):Ee.toFixed(2)):Oe=Ze=parseFloat(Ee?(Ee/Math.sin(rn)).toFixed(2):ce.toFixed(2))):rn<-Q?(ce=ut-Le,Ee=-(se-wt),ce>Ee?Oe=Ze=parseFloat(ce?(ce/Math.cos(rn)).toFixed(2):Ee.toFixed(2)):Oe=Ze=parseFloat(Ee?(Ee/Math.sin(rn)).toFixed(2):ce.toFixed(2))):(ce=ue-Nt,Math.abs(de)>(pt-wt)/2?Ee=wt-se:Ee=de,ce>Ee?Oe=Ze=parseFloat(ce?(ce/Math.cos(rn)).toFixed(2):Ee.toFixed(2)):Oe=Ze=parseFloat(Ee&&rn!==0?(Ee/Math.sin(rn)).toFixed(2):ce.toFixed(2)));var fe=parseFloat(rn.toFixed(2)),Ae=mt;return mt&&(Ae=Z<fe&&fe<R),{distance:Math.abs(Oe<Ze?Oe:Ze),isHoriz:Ae}}function K(lt,ht){var mt=L.get(lt.id)||[],wt=mt.find(function(Me){return Me.source===ht.id||Me.target===ht.id}),ut=lt.size[0]*lt.size[1],pt=ht.size[0]*ht.size[1],Nt=ut>pt?ht:lt,Ut=ut>pt?lt:ht,ue=Nt.x-Nt.size[0]/2,se=Nt.y-Nt.size[1]/2,Le=Nt.x+Nt.size[0]/2,Ne=Nt.y+Nt.size[1]/2,we=Ut.x-Ut.size[0]/2,At=Ut.y-Ut.size[1]/2,Qt=Ut.x+Ut.size[0]/2,de=Ut.y+Ut.size[1]/2,rn=Nt.x,Ee=Nt.y,ce=Ut.x,Oe=Ut.y,Ze=Le>=we&&Qt>=ue&&Ne>=At&&de>=se,fe=0,Ae=0;if(Ze){Ae=Math.sqrt(Math.pow(ce-rn,2)+Math.pow(Oe-Ee,2));var Ye=ue>we?ue:we,ge=se>At?se:At,Be=Le<Qt?Le:Qt,te=Ne<de?Ne:de,ke=Be-Ye,Ve=te-ge,ee=ke*Ve;Ae===0&&(Ae=1e-7),fe=j*1/Ae*100+ee,fe*=tt}else{var Ft=!1,bt=F(Nt,Ut,Ft);Ae=bt.distance,Ft=bt.isHoriz,Ae<=j?Ae!==0?wt?fe+=j+tt*1/Ae:fe+=j+tt*j/Ae:fe+=tt:(fe+=Ae,wt&&(fe+=Ae*Ae))}return fe}function nt(lt){for(var ht=0,mt=0;mt<lt.length;mt++){var wt=lt[mt];(wt.x<0||wt.y<0||wt.x>$||wt.y>Y)&&(ht+=1e12);for(var ut=mt+1;ut<lt.length;ut++)ht+=K(wt,lt[ut])}return ht}function P(lt,ht,mt,wt){var ut=new Map;mt.forEach(function(rn,Ee){ut.set(rn.id,rn)});var pt=wt.filter(function(rn){return rn.source===lt.id||rn.target===lt.id})||[],Nt=[];pt.forEach(function(rn){var Ee=rn.source===lt.id?rn.target:rn.source,ce=ut.get(Ee);ce&&Nt.push(ce)});for(var Ut=!0,ue=0;ue<Nt.length;ue++){var se=Nt[ue],Le=Math.atan((lt.y-se.y)/(se.x-lt.y))*180,Ne=Math.atan((ht.y-se.y)/(se.x-ht.y))*180,we=Le<30||Le>150,At=Ne<30||Ne>150,Qt=Le>70&&Le<110,de=Ne>70&&Ne<110;if(we&&!At||Le*Ne<0){Ut=!1;break}else if(Qt&&!de||Le*Ne<0){Ut=!1;break}else if((se.x-lt.x)*(se.x-ht.x)<0){Ut=!1;break}else if((se.y-lt.y)*(se.y-ht.y)<0){Ut=!1;break}}return Ut}function k(lt,ht){for(var mt=!1,wt=1,ut=C*wt,pt=A*wt,Nt=[ut,-ut,0,0],Ut=[0,0,pt,-pt],ue=0;ue<lt.length;++ue)for(var se=lt[ue],Le=yt(se,lt),Ne=0;Ne<Nt.length;Ne++){var we=P(se,{x:se.x+Nt[Ne],y:se.y+Ut[Ne]},lt,ht);if(we){se.x+=Nt[Ne],se.y+=Ut[Ne];var At=yt(se,lt),Qt=Math.random();At<Le||Qt<N&&Qt>B?(Le=At,mt=!0):(se.x-=Nt[Ne],se.y-=Ut[Ne])}}return N>B&&(N*=O),mt?nt(lt):0}function yt(lt,ht){var mt=0;(lt.x<0||lt.y<0||lt.x+lt.size[0]+20>$||lt.y+lt.size[1]+20>Y)&&(mt+=1e12);for(var wt=0;wt<ht.length;++wt)lt.id!==ht[wt].id&&(mt+=K(lt,ht[wt]));return mt}function st(lt,ht){if(lt.length===0)return{nodes:lt,edges:ht};lt.forEach(function(se){var Le=ht.filter(function(Ne){return Ne.source===se.id||Ne.target===se.id});L.set(se,Le)}),lt.sort(function(se,Le){var Ne,we;return((Ne=L.get(se.id))===null||Ne===void 0?void 0:Ne.length)-((we=L.get(Le.id))===null||we===void 0?void 0:we.length)});for(var mt=nt(lt),wt=20,ut=1,pt=0,Nt=50,Ut=0;wt>0&&(Ut++,!(Ut>=Nt));){var ue=k(lt,ht);ue!==0&&(pt=ue),ut=pt-mt,mt=pt,ut===0?--wt:wt=20}return lt.forEach(function(se){se.x=se.x-se.size[0]/2,se.y=se.y-se.size[1]/2}),{nodes:lt,edges:ht}}ot.default=st},89806:function(ur,ot,$){"use strict";var Y=this&&this.__createBinding||(Object.create?function(R,L,C,A){A===void 0&&(A=C);var N=Object.getOwnPropertyDescriptor(L,C);(!N||("get"in N?!L.__esModule:N.writable||N.configurable))&&(N={enumerable:!0,get:function(){return L[C]}}),Object.defineProperty(R,A,N)}:function(R,L,C,A){A===void 0&&(A=C),R[A]=L[C]}),tt=this&&this.__setModuleDefault||(Object.create?function(R,L){Object.defineProperty(R,"default",{enumerable:!0,value:L})}:function(R,L){R.default=L}),j=this&&this.__importStar||function(R){if(R&&R.__esModule)return R;var L={};if(R!=null)for(var C in R)C!=="default"&&Object.prototype.hasOwnProperty.call(R,C)&&Y(L,R,C);return tt(L,R),L};Object.defineProperty(ot,"__esModule",{value:!0});var W=j($(37674)),Q=$(49784);function Z(){function R(te){return function(){return te}}var L=function(te){return te.cluster},C=R(1),A=R(-1),N=R(100),B=R(.1),O=[0,0],F=[],K={},nt=[],P=100,k=100,yt={none:{x:0,y:0}},st=[],lt,ht="force",mt=!0,wt=.1;function ut(te){if(!mt)return ut;lt.tick(),Le();for(var ke=0,Ve=F.length,ee=void 0,Ft=te*wt;ke<Ve;++ke)ee=F[ke],ee.vx+=(yt[L(ee)].x-ee.x)*Ft,ee.vy+=(yt[L(ee)].y-ee.y)*Ft}function pt(){!F||Nt()}function Nt(){if(!(!F||!F.length)){if(L(F[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");var te=Ut();lt=W.forceSimulation(te.nodes).force("x",W.forceX(P).strength(.1)).force("y",W.forceY(k).strength(.1)).force("collide",W.forceCollide(function(ke){return ke.r}).iterations(4)).force("charge",W.forceManyBody().strength(A)).force("links",W.forceLink(te.nodes.length?te.links:[]).distance(N).strength(B)),st=lt.nodes(),Le()}}function Ut(){var te=[],ke=[],Ve={},ee=[],Ft={},bt=[];return Ft=ue(F),bt=se(nt),ee=Object.keys(Ft),ee.forEach(function(Me,en){var fn=Ft[Me];te.push({id:Me,size:fn.count,r:Math.sqrt(fn.sumforceNodeSize/Math.PI)}),Ve[Me]=en}),bt.forEach(function(Me){var en=(0,Q.getEdgeTerminal)(Me,"source"),fn=(0,Q.getEdgeTerminal)(Me,"target"),Rt=Ve[en],Xn=Ve[fn];Rt!==void 0&&Xn!==void 0&&ke.push({source:Rt,target:Xn,count:Me.count})}),{nodes:te,links:ke}}function ue(te){var ke={};return te.forEach(function(Ve){var ee=L(Ve);ke[ee]||(ke[ee]={count:0,sumforceNodeSize:0})}),te.forEach(function(Ve){var ee=L(Ve),Ft=C(Ve),bt=ke[ee];bt.count=bt.count+1,bt.sumforceNodeSize=bt.sumforceNodeSize+Math.PI*(Ft*Ft)*1.3,ke[ee]=bt}),ke}function se(te){var ke={},Ve=[];te.forEach(function(Ft){var bt=Ne(Ft),Me=0;ke[bt]!==void 0&&(Me=ke[bt]),Me+=1,ke[bt]=Me});var ee=Object.entries(ke);return ee.forEach(function(Ft){var bt=Ft[0],Me=Ft[1],en=bt.split("~")[0],fn=bt.split("~")[1];en!==void 0&&fn!==void 0&&Ve.push({source:en,target:fn,count:Me})}),Ve}function Le(){return yt={none:{x:0,y:0}},st.forEach(function(te){yt[te.id]={x:te.x-O[0],y:te.y-O[1]}}),yt}function Ne(te){var ke=(0,Q.getEdgeTerminal)(te,"source"),Ve=(0,Q.getEdgeTerminal)(te,"target"),ee=L(K[ke]),Ft=L(K[Ve]);return ee<=Ft?"".concat(ee,"~").concat(Ft):"".concat(Ft,"~").concat(ee)}function we(te){K={},te.forEach(function(ke){K[ke.id]=ke})}function At(te){return arguments.length?(ht=te,pt(),ut):ht}function Qt(te){return arguments.length?typeof te=="string"?(L=function(ke){return ke[te]},ut):(L=te,ut):L}function de(te){return arguments.length?(mt=te,ut):mt}function rn(te){return arguments.length?(wt=te,ut):wt}function Ee(te){return arguments.length?(P=te,ut):P}function ce(te){return arguments.length?(k=te,ut):k}function Oe(te){return arguments.length?(we(te||[]),F=te||[],ut):F}function Ze(te){return arguments.length?(nt=te||[],pt(),ut):nt}function fe(te){return arguments.length?(typeof te=="function"?C=te:C=R(+te),pt(),ut):C}function Ae(te){return arguments.length?(typeof te=="function"?A=te:A=R(+te),pt(),ut):A}function Ye(te){return arguments.length?(typeof te=="function"?N=te:N=R(+te),pt(),ut):N}function ge(te){return arguments.length?(typeof te=="function"?B=te:B=R(+te),pt(),ut):B}function Be(te){return arguments.length?(O=te,ut):O}return ut.initialize=function(te){F=te,pt()},ut.template=At,ut.groupBy=Qt,ut.enableGrouping=de,ut.strength=rn,ut.centerX=Ee,ut.centerY=ce,ut.nodes=Oe,ut.links=Ze,ut.forceNodeSize=fe,ut.nodeSize=ut.forceNodeSize,ut.forceCharge=Ae,ut.forceLinkDistance=Ye,ut.forceLinkStrength=ge,ut.offset=Be,ut.getFocis=Le,ut}ot.default=Z},8810:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var F=function(K,nt){return F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,k){P.__proto__=k}||function(P,k){for(var yt in k)Object.prototype.hasOwnProperty.call(k,yt)&&(P[yt]=k[yt])},F(K,nt)};return function(K,nt){if(typeof nt!="function"&&nt!==null)throw new TypeError("Class extends value "+String(nt)+" is not a constructor or null");F(K,nt);function P(){this.constructor=K}K.prototype=nt===null?Object.create(nt):(P.prototype=nt.prototype,new P)}}(),tt=this&&this.__createBinding||(Object.create?function(F,K,nt,P){P===void 0&&(P=nt);var k=Object.getOwnPropertyDescriptor(K,nt);(!k||("get"in k?!K.__esModule:k.writable||k.configurable))&&(k={enumerable:!0,get:function(){return K[nt]}}),Object.defineProperty(F,P,k)}:function(F,K,nt,P){P===void 0&&(P=nt),F[P]=K[nt]}),j=this&&this.__setModuleDefault||(Object.create?function(F,K){Object.defineProperty(F,"default",{enumerable:!0,value:K})}:function(F,K){F.default=K}),W=this&&this.__importStar||function(F){if(F&&F.__esModule)return F;var K={};if(F!=null)for(var nt in F)nt!=="default"&&Object.prototype.hasOwnProperty.call(F,nt)&&tt(K,F,nt);return j(K,F),K},Q=this&&this.__importDefault||function(F){return F&&F.__esModule?F:{default:F}};Object.defineProperty(ot,"__esModule",{value:!0}),ot.ForceLayout=void 0;var Z=W($(37674)),R=Q($(89806)),L=$(49784),C=$(62329),A=$(16470),N=function(F){Y(K,F);function K(nt){var P=F.call(this)||this;return P.center=[0,0],P.nodeStrength=null,P.edgeStrength=null,P.preventOverlap=!1,P.clusterNodeStrength=null,P.clusterEdgeStrength=null,P.clusterEdgeDistance=null,P.clusterNodeSize=null,P.clusterFociStrength=null,P.linkDistance=50,P.alphaDecay=.028,P.alphaMin=.001,P.alpha=.3,P.collideStrength=1,P.workerEnabled=!1,P.tick=function(){},P.onLayoutEnd=function(){},P.ticking=void 0,nt&&P.updateCfg(nt),P}return K.prototype.getDefaultCfg=function(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick:function(){},onLayoutEnd:function(){},workerEnabled:!1}},K.prototype.init=function(nt){var P=this;P.nodes=nt.nodes||[];var k=nt.edges||[];P.edges=k.map(function(yt){var st={},lt=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(yt).forEach(function(ht){lt.indexOf(ht)>-1||(st[ht]=yt[ht])}),st}),P.ticking=!1},K.prototype.execute=function(nt){var P=this,k=P.nodes,yt=P.edges;if(!P.ticking){var st=P.forceSimulation,lt=P.alphaMin,ht=P.alphaDecay,mt=P.alpha;if(st){if(nt){if(P.clustering&&P.clusterForce&&(P.clusterForce.nodes(k),P.clusterForce.links(yt)),st.nodes(k),yt&&P.edgeForce)P.edgeForce.links(yt);else if(yt&&!P.edgeForce){var pt=Z.forceLink().id(function(se){return se.id}).links(yt);P.edgeStrength&&pt.strength(P.edgeStrength),P.linkDistance&&pt.distance(P.linkDistance),P.edgeForce=pt,st.force("link",pt)}}P.preventOverlap&&P.overlapProcess(st),st.alpha(mt).restart(),this.ticking=!0}else try{var wt=Z.forceManyBody();if(P.nodeStrength&&wt.strength(P.nodeStrength),st=Z.forceSimulation().nodes(k),P.clustering){var ut=(0,R.default)();ut.centerX(P.center[0]).centerY(P.center[1]).template("force").strength(P.clusterFociStrength),yt&&ut.links(yt),k&&ut.nodes(k),ut.forceLinkDistance(P.clusterEdgeDistance).forceLinkStrength(P.clusterEdgeStrength).forceCharge(P.clusterNodeStrength).forceNodeSize(P.clusterNodeSize),P.clusterForce=ut,st.force("group",ut)}if(st.force("center",Z.forceCenter(P.center[0],P.center[1])).force("charge",wt).alpha(mt).alphaDecay(ht).alphaMin(lt),P.preventOverlap&&P.overlapProcess(st),yt){var pt=Z.forceLink().id(function(ue){return ue.id}).links(yt);P.edgeStrength&&pt.strength(P.edgeStrength),P.linkDistance&&pt.distance(P.linkDistance),P.edgeForce=pt,st.force("link",pt)}if(P.workerEnabled&&!O()&&(P.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),!P.workerEnabled)st.on("tick",function(){P.tick()}).on("end",function(){P.ticking=!1,P.onLayoutEnd&&P.onLayoutEnd()}),P.ticking=!0;else{st.stop();for(var Nt=B(st),Ut=1;Ut<=Nt;Ut++)st.tick(),postMessage({nodes:k,currentTick:Ut,totalTicks:Nt,type:A.LAYOUT_MESSAGE.TICK},void 0);P.ticking=!1}P.forceSimulation=st,P.ticking=!0}catch(ue){P.ticking=!1,console.warn(ue)}}},K.prototype.overlapProcess=function(nt){var P=this,k=P.nodeSize,yt=P.nodeSpacing,st,lt,ht=P.collideStrength;if((0,L.isNumber)(yt)?lt=function(){return yt}:(0,L.isFunction)(yt)?lt=yt:lt=function(){return 0},!k)st=function(pt){if(pt.size){if((0,L.isArray)(pt.size)){var Nt=pt.size[0]>pt.size[1]?pt.size[0]:pt.size[1];return Nt/2+lt(pt)}if((0,L.isObject)(pt.size)){var Nt=pt.size.width>pt.size.height?pt.size.width:pt.size.height;return Nt/2+lt(pt)}return pt.size/2+lt(pt)}return 10+lt(pt)};else if((0,L.isFunction)(k))st=function(pt){var Nt=k(pt);return Nt+lt(pt)};else if((0,L.isArray)(k)){var mt=k[0]>k[1]?k[0]:k[1],wt=mt/2;st=function(pt){return wt+lt(pt)}}else if((0,L.isNumber)(k)){var ut=k/2;st=function(pt){return ut+lt(pt)}}else st=function(){return 10};nt.force("collisionForce",Z.forceCollide(st).strength(ht))},K.prototype.updateCfg=function(nt){var P=this;P.ticking&&(P.forceSimulation.stop(),P.ticking=!1),P.forceSimulation=null,Object.assign(P,nt)},K.prototype.destroy=function(){var nt=this;nt.ticking&&(nt.forceSimulation.stop(),nt.ticking=!1),nt.nodes=null,nt.edges=null,nt.destroyed=!0},K}(C.Base);ot.ForceLayout=N;function B(F){var K=F.alphaMin(),nt=F.alphaTarget(),P=F.alpha(),k=Math.log((K-nt)/(P-nt))/Math.log(1-F.alphaDecay()),yt=Math.ceil(k);return yt}function O(){return typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope}},85717:function(ur,ot,$){"use strict";var Y=this&&this.__createBinding||(Object.create?function(j,W,Q,Z){Z===void 0&&(Z=Q);var R=Object.getOwnPropertyDescriptor(W,Q);(!R||("get"in R?!W.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return W[Q]}}),Object.defineProperty(j,Z,R)}:function(j,W,Q,Z){Z===void 0&&(Z=Q),j[Z]=W[Q]}),tt=this&&this.__exportStar||function(j,W){for(var Q in j)Q!=="default"&&!Object.prototype.hasOwnProperty.call(W,Q)&&Y(W,j,Q)};Object.defineProperty(ot,"__esModule",{value:!0}),tt($(8810),ot)},91019:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.forceNBody=void 0;var Y=$(76749),tt=.81,j=.1;function W(L,C,A,N,B){var O=A/N,F=L.map(function(nt,P){var k=C[nt.id],yt=k.data,st=k.x,lt=k.y,ht=k.size,mt=yt.layout.force.nodeStrength;return{x:st,y:lt,size:ht,index:P,vx:0,vy:0,weight:O*mt}}),K=(0,Y.quadtree)(F,function(nt){return nt.x},function(nt){return nt.y}).visitAfter(Q);return F.forEach(function(nt){R(nt,K)}),F.map(function(nt,P){var k=C[L[P].id],yt=k.data.layout.force.mass,st=yt===void 0?1:yt;B[2*P]=nt.vx/st,B[2*P+1]=nt.vy/st}),B}ot.forceNBody=W;function Q(L){var C=0,A=0,N=0;if(L.length){for(var B=0;B<4;B++){var O=L[B];O&&O.weight&&(C+=O.weight,A+=O.x*O.weight,N+=O.y*O.weight)}L.x=A/C,L.y=N/C,L.weight=C}else{var O=L;L.x=O.data.x,L.y=O.data.y,L.weight=O.data.weight}}var Z=function(L,C,A,N,B,O){var F=O.x-L.x||j,K=O.y-L.y||j,nt=N-C,P=F*F+K*K,k=Math.sqrt(P)*P;if(nt*nt*tt<P){var yt=L.weight/k;return O.vx+=F*yt,O.vy+=K*yt,!0}if(L.length)return!1;if(L.data!==O){var yt=L.data.weight/k;O.vx+=F*yt,O.vy+=K*yt}};function R(L,C){C.visit(function(A,N,B,O,F){return Z(A,N,B,O,F,L)})}},6740:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var L=function(C,A){return L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,B){N.__proto__=B}||function(N,B){for(var O in B)Object.prototype.hasOwnProperty.call(B,O)&&(N[O]=B[O])},L(C,A)};return function(C,A){if(typeof A!="function"&&A!==null)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");L(C,A);function N(){this.constructor=C}C.prototype=A===null?Object.create(A):(N.prototype=A.prototype,new N)}}(),tt=this&&this.__assign||function(){return tt=Object.assign||function(L){for(var C,A=1,N=arguments.length;A<N;A++){C=arguments[A];for(var B in C)Object.prototype.hasOwnProperty.call(C,B)&&(L[B]=C[B])}return L},tt.apply(this,arguments)};Object.defineProperty(ot,"__esModule",{value:!0}),ot.Force2Layout=void 0;var j=$(62329),W=$(49784),Q=$(91019),Z=function(L,C){var A;return L?(0,W.isNumber)(L)?A=function(N){return L}:A=L:A=function(N){return C||1},A},R=function(L){Y(C,L);function C(A){var N=L.call(this)||this;N.maxIteration=1e3,N.workerEnabled=!1,N.edgeStrength=200,N.nodeStrength=1e3,N.coulombDisScale=.005,N.damping=.9,N.maxSpeed=500,N.minMovement=.4,N.interval=.02,N.factor=1,N.linkDistance=200,N.gravity=0,N.clusterNodeStrength=20,N.preventOverlap=!0,N.distanceThresholdMode="mean",N.tick=function(){},N.nodes=[],N.edges=[],N.width=300,N.height=300,N.nodeMap={},N.nodeIdxMap={},N.judgingDistance=0,N.centripetalOptions={leaf:2,single:2,others:1,center:function(O){return{x:N.width/2,y:N.height/2}}};var B=A.getMass;return N.propsGetMass=B,N.updateCfg(A),N}return C.prototype.getCentripetalOptions=function(){var A=this,N=A.leafCluster,B=A.clustering,O=A.nodeClusterBy,F=A.nodes,K=A.nodeMap,nt=A.clusterNodeStrength,P=function(Nt){return typeof nt=="function"?nt(Nt):nt},k={},yt;if(N){yt=this.getSameTypeLeafMap()||{};var st=Array.from(new Set(F==null?void 0:F.map(function(Nt){return Nt[O]})))||[];k={single:100,leaf:function(Nt,Ut,ue){var se=yt[Nt.id]||{},Le=se.relativeLeafNodes,Ne=se.sameTypeLeafNodes;return(Ne==null?void 0:Ne.length)===(Le==null?void 0:Le.length)||(st==null?void 0:st.length)===1?1:P(Nt)},others:1,center:function(Nt,Ut,ue){var se,Le=(((se=Nt.data)===null||se===void 0?void 0:se.layout)||{}).degree;if(!Le)return{x:100,y:100};var Ne;if(Le===1){var we=(yt[Nt.id]||{}).sameTypeLeafNodes,At=we===void 0?[]:we;At.length===1?Ne=void 0:At.length>1&&(Ne=(0,W.getAvgNodePosition)(At))}else Ne=void 0;return{x:Ne==null?void 0:Ne.x,y:Ne==null?void 0:Ne.y}}}}if(B){yt||(yt=this.getSameTypeLeafMap());var lt=Array.from(new Set(F.map(function(Nt,Ut){return Nt[O]}))).filter(function(Nt){return Nt!==void 0}),ht={};lt.forEach(function(Nt){var Ut=F.filter(function(ue){return ue[O]===Nt}).map(function(ue){return K[ue.id]});ht[Nt]=(0,W.getAvgNodePosition)(Ut)}),k={single:function(Nt){return P(Nt)},leaf:function(Nt){return P(Nt)},others:function(Nt){return P(Nt)},center:function(Nt,Ut,ue){var se=ht[Nt[O]];return{x:se==null?void 0:se.x,y:se==null?void 0:se.y}}}}this.centripetalOptions=tt(tt({},this.centripetalOptions),k);var mt=this.centripetalOptions,wt=mt.leaf,ut=mt.single,pt=mt.others;wt&&typeof wt!="function"&&(this.centripetalOptions.leaf=function(){return wt}),ut&&typeof ut!="function"&&(this.centripetalOptions.single=function(){return ut}),pt&&typeof pt!="function"&&(this.centripetalOptions.others=function(){return pt})},C.prototype.updateCfg=function(A){A&&Object.assign(this,A)},C.prototype.getDefaultCfg=function(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}},C.prototype.execute=function(){var A=this;A.stop();var N=A.nodes,B=A.edges,O=A.defSpringLen;if(A.judgingDistance=0,!N||N.length===0){A.onLayoutEnd([]);return}!A.width&&typeof window!="undefined"&&(A.width=window.innerWidth),!A.height&&typeof window!="undefined"&&(A.height=window.innerHeight),A.center||(A.center=[A.width/2,A.height/2]);var F=A.center;if(N.length===1){N[0].x=F[0],N[0].y=F[1],A.onLayoutEnd([tt({},N[0])]);return}A.degreesMap=(0,W.getDegreeMap)(N,B),A.propsGetMass?A.getMass=A.propsGetMass:A.getMass=function(lt){var ht=1;(0,W.isNumber)(lt.mass)&&(ht=lt.mass);var mt=A.degreesMap[lt.id].all;return!mt||mt<5?ht:mt*5*ht};var K=A.nodeSize,nt;if(A.preventOverlap){var P=A.nodeSpacing,k;(0,W.isNumber)(P)?k=function(){return P}:(0,W.isFunction)(P)?k=P:k=function(){return 0},K?(0,W.isArray)(K)?nt=function(lt){return Math.max(K[0],K[1])+k(lt)}:nt=function(lt){return K+k(lt)}:nt=function(lt){return lt.size?(0,W.isArray)(lt.size)?Math.max(lt.size[0],lt.size[1])+k(lt):(0,W.isObject)(lt.size)?Math.max(lt.size.width,lt.size.height)+k(lt):lt.size+k(lt):10+k(lt)}}A.nodeSize=nt,A.linkDistance=Z(A.linkDistance,1),A.nodeStrength=Z(A.nodeStrength,1),A.edgeStrength=Z(A.edgeStrength,1);var yt={},st={};N.forEach(function(lt,ht){(0,W.isNumber)(lt.x)||(lt.x=Math.random()*A.width),(0,W.isNumber)(lt.y)||(lt.y=Math.random()*A.height);var mt=A.degreesMap[lt.id];yt[lt.id]=tt(tt({},lt),{data:tt(tt({},lt.data),{size:A.nodeSize(lt)||30,layout:{inDegree:mt.in,outDegree:mt.out,degree:mt.all,tDegree:mt.in,sDegree:mt.out,force:{mass:A.getMass(lt),nodeStrength:A.nodeStrength(lt,B)}}})}),st[lt.id]=ht}),A.nodeMap=yt,A.nodeIdxMap=st,A.edgeInfos=[],B==null||B.forEach(function(lt){var ht=yt[lt.source],mt=yt[lt.target];!ht||!mt?elf.edgeInfos.push({}):A.edgeInfos.push({edgeStrength:A.edgeStrength(lt),linkDistance:O?O(tt(tt({},lt),{source:ht,target:mt}),ht,mt):A.linkDistance(lt,ht,mt)||1+(K(ht)+K(ht)||0)/2})}),this.getCentripetalOptions(),A.onLayoutEnd=A.onLayoutEnd||function(){},A.run()},C.prototype.run=function(){var A=this,N=A.maxIteration,B=A.nodes,O=A.edges,F=A.workerEnabled,K=A.minMovement,nt=A.animate,P=A.nodeMap,k=A.height;if(A.currentMinY=0,A.currentMaxY=k,!!B){var yt=[];if(B.forEach(function(pt,Nt){yt[2*Nt]=0,yt[2*Nt+1]=0}),this.defSideCoe&&typeof this.defSideCoe=="function"){var st={};O.forEach(function(pt){var Nt=pt.source,Ut=pt.target;st[Nt]=st[Nt]||[],st[Nt].push(pt),st[Ut]=st[Ut]||[],st[Ut].push(pt)}),this.relatedEdges=st}var lt=N,ht=!nt;if(F||ht){for(var mt=0,wt=0;(A.judgingDistance>K||wt<1)&&wt<lt;wt++)mt=wt,A.runOneStep(wt,yt);A.onLayoutEnd(Object.values(P))}else{if(typeof window=="undefined")return;var ut=0;this.timeInterval=window.setInterval(function(){!B||(A.runOneStep(ut,yt),ut++,(ut>=lt||A.judgingDistance<K)&&(A.onLayoutEnd(Object.values(P)),window.clearInterval(A.timeInterval)))},0)}}},C.prototype.runOneStep=function(A,N){var B,O=this,F=O.nodes,K=O.edges,nt=O.nodeMap,P=O.monitor,k=[];if(!!(F==null?void 0:F.length)){O.calRepulsive(k),K&&O.calAttractive(k),O.calGravity(k),O.attractToSide(k);var yt=O.interval;if(O.updateVelocity(k,N,yt),O.updatePosition(N,yt),(B=O.tick)===null||B===void 0||B.call(O),P){var st=this.calTotalEnergy(k);P({energy:st,nodes:F,edges:K,iterations:A})}}},C.prototype.calTotalEnergy=function(A){var N=this,B=N.nodes,O=N.nodeMap;if(!(B==null?void 0:B.length))return 0;var F=0;return B.forEach(function(K,nt){var P=A[2*nt],k=A[2*nt+1],yt=P*P+k*k,st=O[K.id].data.layout.force.mass,lt=st===void 0?1:st;F+=lt*yt*.5}),F},C.prototype.calRepulsive=function(A){var N=this,B=N.nodes,O=N.nodeMap,F=N.factor,K=N.coulombDisScale,nt=N.nodeSize;(0,Q.forceNBody)(B,O,F,K*K,A)},C.prototype.calAttractive=function(A){var N=this,B=N.edges,O=N.nodeMap,F=N.nodeIdxMap,K=N.edgeInfos,nt=N.nodeSize;B.forEach(function(P,k){var yt=(0,W.getEdgeTerminal)(P,"source"),st=(0,W.getEdgeTerminal)(P,"target"),lt=O[yt],ht=O[st];if(!(!lt||!ht)){var mt=ht.x-lt.x,wt=ht.y-lt.y;!mt&&!wt&&(mt=Math.random()*.01,wt=Math.random()*.01);var ut=Math.sqrt(mt*mt+wt*wt),pt=mt/ut,Nt=wt/ut,Ut=K[k]||{},ue=Ut.linkDistance,se=ue===void 0?200:ue,Le=Ut.edgeStrength,Ne=Le===void 0?200:Le,we=se-ut,At=we*Ne,Qt=lt.data.layout.force.mass||1,de=ht.data.layout.force.mass||1,rn=1/Qt,Ee=1/de,ce=pt*At,Oe=Nt*At,Ze=2*F[yt],fe=2*F[st];A[Ze]-=ce*rn,A[Ze+1]-=Oe*rn,A[fe]+=ce*Ee,A[fe+1]+=Oe*Ee}})},C.prototype.calGravity=function(A){var N,B=this,O=B.nodes,F=B.edges,K=F===void 0?[]:F,nt=B.nodeMap,P=B.width,k=B.height,yt=B.center,st=B.gravity,lt=B.degreesMap,ht=B.centripetalOptions;if(!!O)for(var mt=O.length,wt=0;wt<mt;wt++){var ut=2*wt,pt=nt[O[wt].id],Nt=pt.data.layout.force.mass,Ut=Nt===void 0?1:Nt,ue=0,se=0,Le=st,Ne=lt[pt.id],we=Ne.in,At=Ne.out,Qt=Ne.all,de=(N=B.getCenter)===null||N===void 0?void 0:N.call(B,pt,Qt);if(de){var rn=de[0],Ee=de[1],ce=de[2];ue=pt.x-rn,se=pt.y-Ee,Le=ce}else ue=pt.x-yt[0],se=pt.y-yt[1];if(Le&&(A[ut]-=Le*ue/Ut,A[ut+1]-=Le*se/Ut),ht){var Oe=ht.leaf,Ze=ht.single,fe=ht.others,Ae=ht.center,Ye=(Ae==null?void 0:Ae(pt,O,K,P,k))||{x:0,y:0,centerStrength:0},ge=Ye.x,Be=Ye.y,te=Ye.centerStrength;if(!(0,W.isNumber)(ge)||!(0,W.isNumber)(Be))continue;var ke=(pt.x-ge)/Ut,Ve=(pt.y-Be)/Ut;if(te&&(A[ut]-=te*ke,A[ut+1]-=te*Ve),Qt===0){var ee=Ze(pt);if(!ee)continue;A[ut]-=ee*ke,A[ut+1]-=ee*Ve;continue}if(we===0||At===0){var Ft=Oe(pt,O,K);if(!Ft)continue;A[ut]-=Ft*ke,A[ut+1]-=Ft*Ve;continue}var bt=fe(pt);if(!bt)continue;A[ut]-=bt*ke,A[ut+1]-=bt*Ve}}},C.prototype.attractToSide=function(A){var N=this,B=N.defSideCoe,O=N.height,F=N.nodes,K=N.relatedEdges,nt=N.currentMinY,P=nt===void 0?0:nt,k=N.currentMaxY,yt=k===void 0?this.height:k;!B||typeof B!="function"||!(F==null?void 0:F.length)||F.forEach(function(st,lt){var ht=B(st,K[st.id]||[]);if(ht!==0){var mt=ht<0?P:yt,wt=Math.abs(ht);A[2*lt+1]-=wt*(st.y-mt)}})},C.prototype.updateVelocity=function(A,N,B){var O=this,F=O.nodes,K=O.damping,nt=O.maxSpeed;!(F==null?void 0:F.length)||F.forEach(function(P,k){var yt=(N[2*k]+A[2*k]*B)*K||.01,st=(N[2*k+1]+A[2*k+1]*B)*K||.01,lt=Math.sqrt(yt*yt+st*st);if(lt>nt){var ht=nt/lt;yt=ht*yt,st=ht*st}N[2*k]=yt,N[2*k+1]=st})},C.prototype.updatePosition=function(A,N){var B=this,O=B.nodes,F=B.distanceThresholdMode,K=B.nodeMap;if(!(O==null?void 0:O.length)){this.judgingDistance=0;return}var nt=0;F==="max"?B.judgingDistance=-Infinity:F==="min"&&(B.judgingDistance=Infinity);var P=Infinity,k=-Infinity;O.forEach(function(yt,st){var lt=K[yt.id];if((0,W.isNumber)(yt.fx)&&(0,W.isNumber)(yt.fy)){yt.x=yt.fx,yt.y=yt.fy,lt.x=yt.x,lt.y=yt.y;return}var ht=A[2*st]*N,mt=A[2*st+1]*N;yt.x+=ht,yt.y+=mt,lt.x=yt.x,lt.y=yt.y,yt.y<P&&(P=yt.y),yt.y>k&&(k=yt.y);var wt=Math.sqrt(ht*ht+mt*mt);switch(F){case"max":B.judgingDistance<wt&&(B.judgingDistance=wt);break;case"min":B.judgingDistance>wt&&(B.judgingDistance=wt);break;default:nt=nt+wt;break}}),this.currentMinY=P,this.currentMaxY=k,(!F||F==="mean")&&(B.judgingDistance=nt/O.length)},C.prototype.stop=function(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)},C.prototype.destroy=function(){var A=this;A.stop(),A.tick=null,A.nodes=null,A.edges=null,A.destroyed=!0},C.prototype.getType=function(){return"force2"},C.prototype.getSameTypeLeafMap=function(){var A=this,N=A.nodeClusterBy,B=A.nodes,O=A.edges,F=A.nodeMap,K=A.degreesMap;if(!!(B==null?void 0:B.length)){var nt={};return B.forEach(function(P,k){var yt=K[P.id].all;yt===1&&(nt[P.id]=(0,W.getCoreNodeAndRelativeLeafNodes)("leaf",P,O,N,K,F))}),nt}},C}(j.Base);ot.Force2Layout=R},19712:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=function(){function Y(tt){this.id=tt.id||0,this.rx=tt.rx,this.ry=tt.ry,this.fx=0,this.fy=0,this.mass=tt.mass,this.degree=tt.degree,this.g=tt.g||0}return Y.prototype.distanceTo=function(tt){var j=this.rx-tt.rx,W=this.ry-tt.ry;return Math.hypot(j,W)},Y.prototype.setPos=function(tt,j){this.rx=tt,this.ry=j},Y.prototype.resetForce=function(){this.fx=0,this.fy=0},Y.prototype.addForce=function(tt){var j=tt.rx-this.rx,W=tt.ry-this.ry,Q=Math.hypot(j,W);Q=Q<1e-4?1e-4:Q;var Z=this.g*(this.degree+1)*(tt.degree+1)/Q;this.fx+=Z*j/Q,this.fy+=Z*W/Q},Y.prototype.in=function(tt){return tt.contains(this.rx,this.ry)},Y.prototype.add=function(tt){var j=this.mass+tt.mass,W=(this.rx*this.mass+tt.rx*tt.mass)/j,Q=(this.ry*this.mass+tt.ry*tt.mass)/j,Z=this.degree+tt.degree,R={rx:W,ry:Q,mass:j,degree:Z};return new Y(R)},Y}();ot.default=$},48564:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var C=function(A,N){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,O){B.__proto__=O}||function(B,O){for(var F in O)Object.prototype.hasOwnProperty.call(O,F)&&(B[F]=O[F])},C(A,N)};return function(A,N){if(typeof N!="function"&&N!==null)throw new TypeError("Class extends value "+String(N)+" is not a constructor or null");C(A,N);function B(){this.constructor=A}A.prototype=N===null?Object.create(N):(B.prototype=N.prototype,new B)}}(),tt=this&&this.__importDefault||function(C){return C&&C.__esModule?C:{default:C}};Object.defineProperty(ot,"__esModule",{value:!0}),ot.ForceAtlas2Layout=void 0;var j=$(62329),W=$(49784),Q=tt($(19712)),Z=tt($(51638)),R=tt($(62732)),L=function(C){Y(A,C);function A(N){var B=C.call(this)||this;return B.center=[0,0],B.width=300,B.height=300,B.nodes=[],B.edges=[],B.kr=5,B.kg=1,B.mode="normal",B.preventOverlap=!1,B.dissuadeHubs=!1,B.barnesHut=void 0,B.maxIteration=0,B.ks=.1,B.ksmax=10,B.tao=.1,B.onLayoutEnd=function(){},B.prune=void 0,B.updateCfg(N),B}return A.prototype.getDefaultCfg=function(){return{}},A.prototype.execute=function(){var N=this,B=N.nodes,O=N.onLayoutEnd,F=N.prune,K=N.maxIteration;!N.width&&typeof window!="undefined"&&(N.width=window.innerWidth),!N.height&&typeof window!="undefined"&&(N.height=window.innerHeight);for(var nt=[],P=B.length,k=0;k<P;k+=1){var yt=B[k],st=10,lt=10;(0,W.isNumber)(yt.size)&&(st=yt.size,lt=yt.size),(0,W.isArray)(yt.size)?(isNaN(yt.size[0])||(st=yt.size[0]),isNaN(yt.size[1])||(lt=yt.size[1])):(0,W.isObject)(yt.size)&&(st=yt.size.width,lt=yt.size.height),N.getWidth&&!isNaN(N.getWidth(yt))&&(lt=N.getWidth(yt)),N.getHeight&&!isNaN(N.getHeight(yt))&&(st=N.getHeight(yt));var ht=Math.max(st,lt);nt.push(ht)}N.barnesHut===void 0&&P>250&&(N.barnesHut=!0),N.prune===void 0&&P>100&&(N.prune=!0),this.maxIteration===0&&!N.prune?(K=250,P<=200&&P>100?K=1e3:P>200&&(K=1200),this.maxIteration=K):this.maxIteration===0&&F&&(K=100,P<=200&&P>100?K=500:P>200&&(K=950),this.maxIteration=K),N.kr||(N.kr=50,P>100&&P<=500?N.kr=20:P>500&&(N.kr=1)),N.kg||(N.kg=20,P>100&&P<=500?N.kg=10:P>500&&(N.kg=1)),this.nodes=N.updateNodesByForces(nt),O()},A.prototype.updateNodesByForces=function(N){for(var B=this,O=B.edges,F=B.maxIteration,K=B.nodes,nt=O.filter(function(Ne){var we=(0,W.getEdgeTerminal)(Ne,"source"),At=(0,W.getEdgeTerminal)(Ne,"target");return we!==At}),P=K.length,k=nt.length,yt=[],st={},lt={},ht=[],mt=0;mt<P;mt+=1)st[K[mt].id]=mt,yt[mt]=0,(K[mt].x===void 0||isNaN(K[mt].x))&&(K[mt].x=Math.random()*1e3),(K[mt].y===void 0||isNaN(K[mt].y))&&(K[mt].y=Math.random()*1e3),ht.push({x:K[mt].x,y:K[mt].y});for(var mt=0;mt<k;mt+=1){for(var wt=void 0,ut=void 0,pt=0,Nt=0,Ut=0;Ut<P;Ut+=1){var ue=(0,W.getEdgeTerminal)(nt[mt],"source"),se=(0,W.getEdgeTerminal)(nt[mt],"target");K[Ut].id===ue?(wt=K[Ut],pt=Ut):K[Ut].id===se&&(ut=K[Ut],Nt=Ut),lt[mt]={sourceIdx:pt,targetIdx:Nt}}wt&&(yt[st[wt.id]]+=1),ut&&(yt[st[ut.id]]+=1)}var Le=F;if(K=this.iterate(Le,st,lt,k,yt,N),B.prune){for(var Ut=0;Ut<k;Ut+=1)yt[lt[Ut].sourceIdx]<=1?(K[lt[Ut].sourceIdx].x=K[lt[Ut].targetIdx].x,K[lt[Ut].sourceIdx].y=K[lt[Ut].targetIdx].y):yt[lt[Ut].targetIdx]<=1&&(K[lt[Ut].targetIdx].x=K[lt[Ut].sourceIdx].x,K[lt[Ut].targetIdx].y=K[lt[Ut].sourceIdx].y);B.prune=!1,B.barnesHut=!1,Le=100,K=this.iterate(Le,st,lt,k,yt,N)}return K},A.prototype.iterate=function(N,B,O,F,K,nt){for(var P=this,k=P.nodes,yt=P.kr,st=P.preventOverlap,lt=P.barnesHut,ht=k.length,mt=0,wt=100,ut=N,pt=50,Nt=[],Ut=[],ue=[],se=0;se<ht;se+=1)if(Nt[2*se]=0,Nt[2*se+1]=0,lt){var Le={id:se,rx:k[se].x,ry:k[se].y,mass:1,g:yt,degree:K[se]};ue[se]=new Q.default(Le)}for(;ut>0;){for(var se=0;se<ht;se+=1)Ut[2*se]=Nt[2*se],Ut[2*se+1]=Nt[2*se+1],Nt[2*se]=0,Nt[2*se+1]=0;Nt=this.getAttrForces(ut,pt,F,B,O,K,nt,Nt),lt&&(st&&ut>pt||!st)?Nt=this.getOptRepGraForces(Nt,ue,K):Nt=this.getRepGraForces(ut,pt,Nt,wt,nt,K);var Ne=this.updatePos(Nt,Ut,mt,K);k=Ne.nodes,mt=Ne.sg,ut--,P.tick&&P.tick()}return k},A.prototype.getAttrForces=function(N,B,O,F,K,nt,P,k){for(var yt=this,st=yt.nodes,lt=yt.preventOverlap,ht=yt.dissuadeHubs,mt=yt.mode,wt=yt.prune,ut=0;ut<O;ut+=1){var pt=st[K[ut].sourceIdx],Nt=K[ut].sourceIdx,Ut=st[K[ut].targetIdx],ue=K[ut].targetIdx;if(!(wt&&(nt[Nt]<=1||nt[ue]<=1))){var se=[Ut.x-pt.x,Ut.y-pt.y],Le=Math.hypot(se[0],se[1]);Le=Le<1e-4?1e-4:Le,se[0]=se[0]/Le,se[1]=se[1]/Le,lt&&N<B&&(Le=Le-P[Nt]-P[ue]);var Ne=Le,we=Ne;mt==="linlog"&&(Ne=Math.log(1+Le),we=Ne),ht&&(Ne=Le/nt[Nt],we=Le/nt[ue]),lt&&N<B&&Le<=0?(Ne=0,we=0):lt&&N<B&&Le>0&&(Ne=Le,we=Le),k[2*F[pt.id]]+=Ne*se[0],k[2*F[Ut.id]]-=we*se[0],k[2*F[pt.id]+1]+=Ne*se[1],k[2*F[Ut.id]+1]-=we*se[1]}}return k},A.prototype.getRepGraForces=function(N,B,O,F,K,nt){for(var P=this,k=P.nodes,yt=P.preventOverlap,st=P.kr,lt=P.kg,ht=P.center,mt=P.prune,wt=k.length,ut=0;ut<wt;ut+=1){for(var pt=ut+1;pt<wt;pt+=1)if(!(mt&&(nt[ut]<=1||nt[pt]<=1))){var Nt=[k[pt].x-k[ut].x,k[pt].y-k[ut].y],Ut=Math.hypot(Nt[0],Nt[1]);Ut=Ut<1e-4?1e-4:Ut,Nt[0]=Nt[0]/Ut,Nt[1]=Nt[1]/Ut,yt&&N<B&&(Ut=Ut-K[ut]-K[pt]);var ue=st*(nt[ut]+1)*(nt[pt]+1)/Ut;yt&&N<B&&Ut<0?ue=F*(nt[ut]+1)*(nt[pt]+1):yt&&N<B&&Ut===0?ue=0:yt&&N<B&&Ut>0&&(ue=st*(nt[ut]+1)*(nt[pt]+1)/Ut),O[2*ut]-=ue*Nt[0],O[2*pt]+=ue*Nt[0],O[2*ut+1]-=ue*Nt[1],O[2*pt+1]+=ue*Nt[1]}var se=[k[ut].x-ht[0],k[ut].y-ht[1]],Le=Math.hypot(se[0],se[1]);se[0]=se[0]/Le,se[1]=se[1]/Le;var Ne=lt*(nt[ut]+1);O[2*ut]-=Ne*se[0],O[2*ut+1]-=Ne*se[1]}return O},A.prototype.getOptRepGraForces=function(N,B,O){for(var F=this,K=F.nodes,nt=F.kg,P=F.center,k=F.prune,yt=K.length,st=9e10,lt=-9e10,ht=9e10,mt=-9e10,wt=0;wt<yt;wt+=1)k&&O[wt]<=1||(B[wt].setPos(K[wt].x,K[wt].y),K[wt].x>=lt&&(lt=K[wt].x),K[wt].x<=st&&(st=K[wt].x),K[wt].y>=mt&&(mt=K[wt].y),K[wt].y<=ht&&(ht=K[wt].y));for(var ut=Math.max(lt-st,mt-ht),pt={xmid:(lt+st)/2,ymid:(mt+ht)/2,length:ut,massCenter:P,mass:yt},Nt=new Z.default(pt),Ut=new R.default(Nt),wt=0;wt<yt;wt+=1)k&&O[wt]<=1||B[wt].in(Nt)&&Ut.insert(B[wt]);for(var wt=0;wt<yt;wt+=1)if(!(k&&O[wt]<=1)){B[wt].resetForce(),Ut.updateForce(B[wt]),N[2*wt]-=B[wt].fx,N[2*wt+1]-=B[wt].fy;var ue=[K[wt].x-P[0],K[wt].y-P[1]],se=Math.hypot(ue[0],ue[1]);se=se<1e-4?1e-4:se,ue[0]=ue[0]/se,ue[1]=ue[1]/se;var Le=nt*(O[wt]+1);N[2*wt]-=Le*ue[0],N[2*wt+1]-=Le*ue[1]}return N},A.prototype.updatePos=function(N,B,O,F){for(var K=this,nt=K.nodes,P=K.ks,k=K.tao,yt=K.prune,st=K.ksmax,lt=nt.length,ht=[],mt=[],wt=0,ut=0,pt=0;pt<lt;pt+=1)if(!(yt&&F[pt]<=1)){var Nt=[N[2*pt]-B[2*pt],N[2*pt+1]-B[2*pt+1]],Ut=Math.hypot(Nt[0],Nt[1]),ue=[N[2*pt]+B[2*pt],N[2*pt+1]+B[2*pt+1]],se=Math.hypot(ue[0],ue[1]);ht[pt]=Ut,mt[pt]=se/2,wt+=(F[pt]+1)*ht[pt],ut+=(F[pt]+1)*mt[pt]}var Le=O;O=k*ut/wt,Le!==0&&(O=O>1.5*Le?1.5*Le:O);for(var pt=0;pt<lt;pt+=1)if(!(yt&&F[pt]<=1)&&!((0,W.isNumber)(nt[pt].fx)&&(0,W.isNumber)(nt[pt].fy))){var Ne=P*O/(1+O*Math.sqrt(ht[pt])),we=Math.hypot(N[2*pt],N[2*pt+1]);we=we<1e-4?1e-4:we;var At=st/we;Ne=Ne>At?At:Ne;var Qt=Ne*N[2*pt],de=Ne*N[2*pt+1];nt[pt].x+=Qt,nt[pt].y+=de}return{nodes:nt,sg:O}},A}(j.Base);ot.ForceAtlas2Layout=L},51638:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=function(){function Y(tt){this.xmid=tt.xmid,this.ymid=tt.ymid,this.length=tt.length,this.massCenter=tt.massCenter||[0,0],this.mass=tt.mass||1}return Y.prototype.getLength=function(){return this.length},Y.prototype.contains=function(tt,j){var W=this.length/2;return tt<=this.xmid+W&&tt>=this.xmid-W&&j<=this.ymid+W&&j>=this.ymid-W},Y.prototype.NW=function(){var tt=this.xmid-this.length/4,j=this.ymid+this.length/4,W=this.length/2,Q={xmid:tt,ymid:j,length:W},Z=new Y(Q);return Z},Y.prototype.NE=function(){var tt=this.xmid+this.length/4,j=this.ymid+this.length/4,W=this.length/2,Q={xmid:tt,ymid:j,length:W},Z=new Y(Q);return Z},Y.prototype.SW=function(){var tt=this.xmid-this.length/4,j=this.ymid-this.length/4,W=this.length/2,Q={xmid:tt,ymid:j,length:W},Z=new Y(Q);return Z},Y.prototype.SE=function(){var tt=this.xmid+this.length/4,j=this.ymid-this.length/4,W=this.length/2,Q={xmid:tt,ymid:j,length:W},Z=new Y(Q);return Z},Y}();ot.default=$},62732:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=function(){function Y(tt){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,tt!=null&&(this.quad=tt)}return Y.prototype.insert=function(tt){if(this.body==null){this.body=tt;return}this._isExternal()?(this.quad&&(this.NW=new Y(this.quad.NW()),this.NE=new Y(this.quad.NE()),this.SW=new Y(this.quad.SW()),this.SE=new Y(this.quad.SE())),this._putBody(this.body),this._putBody(tt),this.body=this.body.add(tt)):(this.body=this.body.add(tt),this._putBody(tt))},Y.prototype._putBody=function(tt){!this.quad||(tt.in(this.quad.NW())&&this.NW?this.NW.insert(tt):tt.in(this.quad.NE())&&this.NE?this.NE.insert(tt):tt.in(this.quad.SW())&&this.SW?this.SW.insert(tt):tt.in(this.quad.SE())&&this.SE&&this.SE.insert(tt))},Y.prototype._isExternal=function(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null},Y.prototype.updateForce=function(tt){if(!(this.body==null||tt===this.body))if(this._isExternal())tt.addForce(this.body);else{var j=this.quad?this.quad.getLength():0,W=this.body.distanceTo(tt);j/W<this.theta?tt.addForce(this.body):(this.NW&&this.NW.updateForce(tt),this.NE&&this.NE.updateForce(tt),this.SW&&this.SW.updateForce(tt),this.SE&&this.SE.updateForce(tt))}},Y}();ot.default=$},80374:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var Z=function(R,L){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,A){C.__proto__=A}||function(C,A){for(var N in A)Object.prototype.hasOwnProperty.call(A,N)&&(C[N]=A[N])},Z(R,L)};return function(R,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");Z(R,L);function C(){this.constructor=R}R.prototype=L===null?Object.create(L):(C.prototype=L.prototype,new C)}}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.FruchtermanLayout=void 0;var tt=$(62329),j=$(49784),W=800,Q=function(Z){Y(R,Z);function R(L){var C=Z.call(this)||this;return C.maxIteration=1e3,C.workerEnabled=!1,C.gravity=10,C.speed=5,C.clustering=!1,C.clusterGravity=10,C.nodes=[],C.edges=[],C.width=300,C.height=300,C.nodeMap={},C.nodeIdxMap={},C.onLayoutEnd=function(){},C.tick=function(){},C.animate=!0,C.updateCfg(L),C}return R.prototype.getDefaultCfg=function(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10,animate:!0}},R.prototype.execute=function(){var L=this,C,A,N=this,B=N.nodes;if(N.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(N.timeInterval),!B||B.length===0){(C=N.onLayoutEnd)===null||C===void 0||C.call(N);return}!N.width&&typeof window!="undefined"&&(N.width=window.innerWidth),!N.height&&typeof window!="undefined"&&(N.height=window.innerHeight),N.center||(N.center=[N.width/2,N.height/2]);var O=N.center;if(B.length===1){B[0].x=O[0],B[0].y=O[1],(A=N.onLayoutEnd)===null||A===void 0||A.call(N);return}var F={},K={};return B.forEach(function(nt,P){(0,j.isNumber)(nt.x)||(nt.x=Math.random()*L.width),(0,j.isNumber)(nt.y)||(nt.y=Math.random()*L.height),F[nt.id]=nt,K[nt.id]=P}),N.nodeMap=F,N.nodeIdxMap=K,N.run()},R.prototype.run=function(){var L,C=this,A=C.nodes;if(!!A){var N=C.edges,B=C.maxIteration,O=C.workerEnabled,F=C.clustering,K=C.animate,nt={};if(F&&A.forEach(function(yt){nt[yt.cluster]===void 0&&(nt[yt.cluster]={name:yt.cluster,cx:0,cy:0,count:0})}),O||!K){for(var P=0;P<B;P++)C.runOneStep(nt);(L=C.onLayoutEnd)===null||L===void 0||L.call(C)}else{if(typeof window=="undefined")return;var k=0;this.timeInterval=window.setInterval(function(){var yt;C.runOneStep(nt),k++,k>=B&&((yt=C.onLayoutEnd)===null||yt===void 0||yt.call(C),window.clearInterval(C.timeInterval))},0)}return{nodes:A,edges:N}}},R.prototype.runOneStep=function(L){var C,A=this,N=A.nodes;if(!!N){var B=A.edges,O=A.center,F=A.gravity,K=A.speed,nt=A.clustering,P=A.height*A.width,k=Math.sqrt(P)/10,yt=P/(N.length+1),st=Math.sqrt(yt),lt=[];if(N.forEach(function(wt,ut){lt[ut]={x:0,y:0}}),A.applyCalculate(N,B,lt,st,yt),nt){for(var ht in L)L[ht].cx=0,L[ht].cy=0,L[ht].count=0;N.forEach(function(wt){var ut=L[wt.cluster];(0,j.isNumber)(wt.x)&&(ut.cx+=wt.x),(0,j.isNumber)(wt.y)&&(ut.cy+=wt.y),ut.count++});for(var ht in L)L[ht].cx/=L[ht].count,L[ht].cy/=L[ht].count;var mt=A.clusterGravity||F;N.forEach(function(wt,ut){if(!(!(0,j.isNumber)(wt.x)||!(0,j.isNumber)(wt.y))){var pt=L[wt.cluster],Nt=Math.sqrt((wt.x-pt.cx)*(wt.x-pt.cx)+(wt.y-pt.cy)*(wt.y-pt.cy)),Ut=st*mt;lt[ut].x-=Ut*(wt.x-pt.cx)/Nt,lt[ut].y-=Ut*(wt.y-pt.cy)/Nt}})}N.forEach(function(wt,ut){if(!(!(0,j.isNumber)(wt.x)||!(0,j.isNumber)(wt.y))){var pt=.01*st*F;lt[ut].x-=pt*(wt.x-O[0]),lt[ut].y-=pt*(wt.y-O[1])}}),N.forEach(function(wt,ut){if((0,j.isNumber)(wt.fx)&&(0,j.isNumber)(wt.fy)){wt.x=wt.fx,wt.y=wt.fy;return}if(!(!(0,j.isNumber)(wt.x)||!(0,j.isNumber)(wt.y))){var pt=Math.sqrt(lt[ut].x*lt[ut].x+lt[ut].y*lt[ut].y);if(pt>0){var Nt=Math.min(k*(K/W),pt);wt.x+=lt[ut].x/pt*Nt,wt.y+=lt[ut].y/pt*Nt}}}),(C=A.tick)===null||C===void 0||C.call(A)}},R.prototype.applyCalculate=function(L,C,A,N,B){var O=this;O.calRepulsive(L,A,B),C&&O.calAttractive(C,A,N)},R.prototype.calRepulsive=function(L,C,A){L.forEach(function(N,B){C[B]={x:0,y:0},L.forEach(function(O,F){if(B!==F&&!(!(0,j.isNumber)(N.x)||!(0,j.isNumber)(O.x)||!(0,j.isNumber)(N.y)||!(0,j.isNumber)(O.y))){var K=N.x-O.x,nt=N.y-O.y,P=K*K+nt*nt;if(P===0){P=1;var k=B>F?1:-1;K=.01*k,nt=.01*k}var yt=A/P;C[B].x+=K*yt,C[B].y+=nt*yt}})})},R.prototype.calAttractive=function(L,C,A){var N=this;L.forEach(function(B){var O=(0,j.getEdgeTerminal)(B,"source"),F=(0,j.getEdgeTerminal)(B,"target");if(!(!O||!F)){var K=N.nodeIdxMap[O],nt=N.nodeIdxMap[F];if(K!==nt){var P=N.nodeMap[O],k=N.nodeMap[F];if(!(!(0,j.isNumber)(k.x)||!(0,j.isNumber)(P.x)||!(0,j.isNumber)(k.y)||!(0,j.isNumber)(P.y))){var yt=k.x-P.x,st=k.y-P.y,lt=Math.sqrt(yt*yt+st*st),ht=lt*lt/A;C[nt].x-=yt/lt*ht,C[nt].y-=st/lt*ht,C[K].x+=yt/lt*ht,C[K].y+=st/lt*ht}}}})},R.prototype.stop=function(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)},R.prototype.destroy=function(){var L=this;L.stop(),L.tick=null,L.nodes=null,L.edges=null,L.destroyed=!0},R.prototype.getType=function(){return"fruchterman"},R}(tt.Base);ot.FruchtermanLayout=Q},13653:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var Z=function(R,L){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,A){C.__proto__=A}||function(C,A){for(var N in A)Object.prototype.hasOwnProperty.call(A,N)&&(C[N]=A[N])},Z(R,L)};return function(R,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");Z(R,L);function C(){this.constructor=R}R.prototype=L===null?Object.create(L):(C.prototype=L.prototype,new C)}}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.GForceLayout=void 0;var tt=$(62329),j=$(49784),W=function(Z,R){var L;return Z?(0,j.isNumber)(Z)?L=function(C){return Z}:L=Z:L=function(C){return R||1},L},Q=function(Z){Y(R,Z);function R(L){var C=Z.call(this)||this;return C.maxIteration=500,C.workerEnabled=!1,C.edgeStrength=200,C.nodeStrength=1e3,C.coulombDisScale=.005,C.damping=.9,C.maxSpeed=1e3,C.minMovement=.5,C.interval=.02,C.factor=1,C.linkDistance=1,C.gravity=10,C.preventOverlap=!0,C.collideStrength=1,C.tick=function(){},C.nodes=[],C.edges=[],C.width=300,C.height=300,C.nodeMap={},C.nodeIdxMap={},C.animate=!0,C.updateCfg(L),C}return R.prototype.getDefaultCfg=function(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}},R.prototype.execute=function(){var L,C,A=this,N=A.nodes;if(A.timeInterval!==void 0&&typeof window!="undefined"&&window.clearInterval(A.timeInterval),!N||N.length===0){(L=A.onLayoutEnd)===null||L===void 0||L.call(A);return}!A.width&&typeof window!="undefined"&&(A.width=window.innerWidth),!A.height&&typeof window!="undefined"&&(A.height=window.innerHeight),A.center||(A.center=[A.width/2,A.height/2]);var B=A.center;if(N.length===1){N[0].x=B[0],N[0].y=B[1],(C=A.onLayoutEnd)===null||C===void 0||C.call(A);return}var O={},F={};N.forEach(function(st,lt){(0,j.isNumber)(st.x)||(st.x=Math.random()*A.width),(0,j.isNumber)(st.y)||(st.y=Math.random()*A.height),O[st.id]=st,F[st.id]=lt}),A.nodeMap=O,A.nodeIdxMap=F,A.linkDistance=W(A.linkDistance,1),A.nodeStrength=W(A.nodeStrength,1),A.edgeStrength=W(A.edgeStrength,1);var K=A.nodeSize,nt;if(A.preventOverlap){var P=A.nodeSpacing,k;(0,j.isNumber)(P)?k=function(){return P}:(0,j.isFunction)(P)?k=P:k=function(){return 0},K?(0,j.isArray)(K)?nt=function(st){return Math.max(K[0],K[1])+k(st)}:nt=function(st){return K+k(st)}:nt=function(st){return st.size?(0,j.isArray)(st.size)?Math.max(st.size[0],st.size[1])+k(st):(0,j.isObject)(st.size)?Math.max(st.size.width,st.size.height)+k(st):st.size+k(st):10+k(st)}}A.nodeSize=nt;var yt=A.edges;A.degrees=(0,j.getDegree)(N.length,A.nodeIdxMap,yt),A.getMass||(A.getMass=function(st){var lt=st.mass||A.degrees[A.nodeIdxMap[st.id]].all||1;return lt}),A.run()},R.prototype.run=function(){var L,C=this,A=C.maxIteration,N=C.nodes,B=C.workerEnabled,O=C.minMovement,F=C.animate;if(!!N)if(B||!F){for(var K=0;K<A;K++){var nt=C.runOneStep(K);if(C.reachMoveThreshold(N,nt,O))break}(L=C.onLayoutEnd)===null||L===void 0||L.call(C)}else{if(typeof window=="undefined")return;var P=0;this.timeInterval=window.setInterval(function(){var k,yt;if(!!N){var st=C.runOneStep(P)||[];C.reachMoveThreshold(N,st,O)&&((k=C.onLayoutEnd)===null||k===void 0||k.call(C),window.clearInterval(C.timeInterval)),P++,P>=A&&((yt=C.onLayoutEnd)===null||yt===void 0||yt.call(C),window.clearInterval(C.timeInterval))}},0)}},R.prototype.reachMoveThreshold=function(L,C,A){var N=0;return L.forEach(function(B,O){var F=B.x-C[O].x,K=B.y-C[O].y;N+=Math.sqrt(F*F+K*K)}),N/=L.length,N<A},R.prototype.runOneStep=function(L){var C,A=this,N=A.nodes,B=A.edges,O=[],F=[];if(!!N){N.forEach(function(P,k){O[2*k]=0,O[2*k+1]=0,F[2*k]=0,F[2*k+1]=0}),A.calRepulsive(O,N),B&&A.calAttractive(O,B),A.calGravity(O,N);var K=Math.max(.02,A.interval-L*.002);A.updateVelocity(O,F,K,N);var nt=[];return N.forEach(function(P){nt.push({x:P.x,y:P.y})}),A.updatePosition(F,K,N),(C=A.tick)===null||C===void 0||C.call(A),nt}},R.prototype.calRepulsive=function(L,C){var A=this,N=A.getMass,B=A.factor,O=A.coulombDisScale,F=A.preventOverlap,K=A.collideStrength,nt=K===void 0?1:K,P=A.nodeStrength,k=A.nodeSize;C.forEach(function(yt,st){var lt=N?N(yt):1;C.forEach(function(ht,mt){if(!(st>=mt)){var wt=yt.x-ht.x,ut=yt.y-ht.y;wt===0&&ut===0&&(wt=Math.random()*.01,ut=Math.random()*.01);var pt=wt*wt+ut*ut,Nt=Math.sqrt(pt),Ut=(Nt+.1)*O,ue=wt/Nt,se=ut/Nt,Le=(P(yt)+P(ht))*.5*B/(Ut*Ut),Ne=N?N(ht):1;if(L[2*st]+=ue*Le,L[2*st+1]+=se*Le,L[2*mt]-=ue*Le,L[2*mt+1]-=se*Le,F&&(k(yt)+k(ht))/2>Nt){var we=nt*(P(yt)+P(ht))*.5/pt;L[2*st]+=ue*we/lt,L[2*st+1]+=se*we/lt,L[2*mt]-=ue*we/Ne,L[2*mt+1]-=se*we/Ne}}})})},R.prototype.calAttractive=function(L,C){var A=this,N=A.nodeMap,B=A.nodeIdxMap,O=A.linkDistance,F=A.edgeStrength,K=A.nodeSize,nt=A.getMass;C.forEach(function(P,k){var yt=(0,j.getEdgeTerminal)(P,"source"),st=(0,j.getEdgeTerminal)(P,"target"),lt=N[yt],ht=N[st],mt=ht.x-lt.x,wt=ht.y-lt.y;mt===0&&wt===0&&(mt=Math.random()*.01,wt=Math.random()*.01);var ut=Math.sqrt(mt*mt+wt*wt),pt=mt/ut,Nt=wt/ut,Ut=O(P,lt,ht)||1+(K(lt)+K(ht)||0)/2,ue=Ut-ut,se=ue*F(P),Le=B[yt],Ne=B[st],we=nt?nt(lt):1,At=nt?nt(ht):1;L[2*Le]-=pt*se/we,L[2*Le+1]-=Nt*se/we,L[2*Ne]+=pt*se/At,L[2*Ne+1]+=Nt*se/At})},R.prototype.calGravity=function(L,C){for(var A=this,N=A.center,B=A.gravity,O=A.degrees,F=C.length,K=0;K<F;K++){var nt=C[K],P=nt.x-N[0],k=nt.y-N[1],yt=B;if(A.getCenter){var st=A.getCenter(nt,O[K].all);st&&(0,j.isNumber)(st[0])&&(0,j.isNumber)(st[1])&&(0,j.isNumber)(st[2])&&(P=nt.x-st[0],k=nt.y-st[1],yt=st[2])}!yt||(L[2*K]-=yt*P,L[2*K+1]-=yt*k)}},R.prototype.updateVelocity=function(L,C,A,N){var B=this,O=A*B.damping;N.forEach(function(F,K){var nt=L[2*K]*O||.01,P=L[2*K+1]*O||.01,k=Math.sqrt(nt*nt+P*P);if(k>B.maxSpeed){var yt=B.maxSpeed/k;nt=yt*nt,P=yt*P}C[2*K]=nt,C[2*K+1]=P})},R.prototype.updatePosition=function(L,C,A){A.forEach(function(N,B){if((0,j.isNumber)(N.fx)&&(0,j.isNumber)(N.fy)){N.x=N.fx,N.y=N.fy;return}var O=L[2*B]*C,F=L[2*B+1]*C;N.x+=O,N.y+=F})},R.prototype.stop=function(){this.timeInterval&&typeof window!="undefined"&&window.clearInterval(this.timeInterval)},R.prototype.destroy=function(){var L=this;L.stop(),L.tick=null,L.nodes=null,L.edges=null,L.destroyed=!0},R.prototype.getType=function(){return"gForce"},R}(tt.Base);ot.GForceLayout=Q},87745:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var N=function(B,O){return N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,K){F.__proto__=K}||function(F,K){for(var nt in K)Object.prototype.hasOwnProperty.call(K,nt)&&(F[nt]=K[nt])},N(B,O)};return function(B,O){if(typeof O!="function"&&O!==null)throw new TypeError("Class extends value "+String(O)+" is not a constructor or null");N(B,O);function F(){this.constructor=B}B.prototype=O===null?Object.create(O):(F.prototype=O.prototype,new F)}}(),tt=this&&this.__awaiter||function(N,B,O,F){function K(nt){return nt instanceof O?nt:new O(function(P){P(nt)})}return new(O||(O=Promise))(function(nt,P){function k(lt){try{st(F.next(lt))}catch(ht){P(ht)}}function yt(lt){try{st(F.throw(lt))}catch(ht){P(ht)}}function st(lt){lt.done?nt(lt.value):K(lt.value).then(k,yt)}st((F=F.apply(N,B||[])).next())})},j=this&&this.__generator||function(N,B){var O={label:0,sent:function(){if(nt[0]&1)throw nt[1];return nt[1]},trys:[],ops:[]},F,K,nt,P;return P={next:k(0),throw:k(1),return:k(2)},typeof Symbol=="function"&&(P[Symbol.iterator]=function(){return this}),P;function k(st){return function(lt){return yt([st,lt])}}function yt(st){if(F)throw new TypeError("Generator is already executing.");for(;P&&(P=0,st[0]&&(O=0)),O;)try{if(F=1,K&&(nt=st[0]&2?K.return:st[0]?K.throw||((nt=K.return)&&nt.call(K),0):K.next)&&!(nt=nt.call(K,st[1])).done)return nt;switch(K=0,nt&&(st=[st[0]&2,nt.value]),st[0]){case 0:case 1:nt=st;break;case 4:return O.label++,{value:st[1],done:!1};case 5:O.label++,K=st[1],st=[0];continue;case 7:st=O.ops.pop(),O.trys.pop();continue;default:if(nt=O.trys,!(nt=nt.length>0&&nt[nt.length-1])&&(st[0]===6||st[0]===2)){O=0;continue}if(st[0]===3&&(!nt||st[1]>nt[0]&&st[1]<nt[3])){O.label=st[1];break}if(st[0]===6&&O.label<nt[1]){O.label=nt[1],nt=st;break}if(nt&&O.label<nt[2]){O.label=nt[2],O.ops.push(st);break}nt[2]&&O.ops.pop(),O.trys.pop();continue}st=B.call(N,O)}catch(lt){st=[6,lt],K=0}finally{F=nt=0}if(st[0]&5)throw st[1];return{value:st[0]?st[1]:void 0,done:!0}}};Object.defineProperty(ot,"__esModule",{value:!0}),ot.FruchtermanGPULayout=void 0;var W=$(62329),Q=$(49784),Z=$(79984),R=$(48835),L=$(8574),C=$(16470),A=function(N){Y(B,N);function B(O){var F=N.call(this)||this;return F.maxIteration=1e3,F.gravity=10,F.speed=1,F.clustering=!1,F.clusterField="cluster",F.clusterGravity=10,F.workerEnabled=!1,F.nodes=[],F.edges=[],F.width=300,F.height=300,F.nodeMap={},F.nodeIdxMap={},F.updateCfg(O),F}return B.prototype.getDefaultCfg=function(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}},B.prototype.execute=function(){return tt(this,void 0,void 0,function(){var O,F,K,nt,P,k=this;return j(this,function(yt){switch(yt.label){case 0:return O=this,F=O.nodes,!F||F.length===0?(O.onLayoutEnd&&O.onLayoutEnd(),[2]):(!O.width&&typeof window!="undefined"&&(O.width=window.innerWidth),!O.height&&typeof window!="undefined"&&(O.height=window.innerHeight),O.center||(O.center=[O.width/2,O.height/2]),K=O.center,F.length===1?(F[0].x=K[0],F[0].y=K[1],O.onLayoutEnd&&O.onLayoutEnd(),[2]):(nt={},P={},F.forEach(function(st,lt){(0,Q.isNumber)(st.x)||(st.x=Math.random()*k.width),(0,Q.isNumber)(st.y)||(st.y=Math.random()*k.height),nt[st.id]=st,P[st.id]=lt}),O.nodeMap=nt,O.nodeIdxMap=P,[4,O.run()]));case 1:return yt.sent(),[2]}})})},B.prototype.executeWithWorker=function(O,F){return tt(this,void 0,void 0,function(){var K,nt,P,k,yt,st=this;return j(this,function(lt){switch(lt.label){case 0:return K=this,nt=K.nodes,P=K.center,!nt||nt.length===0?[2]:nt.length===1?(nt[0].x=P[0],nt[0].y=P[1],[2]):(k={},yt={},nt.forEach(function(ht,mt){(0,Q.isNumber)(ht.x)||(ht.x=Math.random()*st.width),(0,Q.isNumber)(ht.y)||(ht.y=Math.random()*st.height),k[ht.id]=ht,yt[ht.id]=mt}),K.nodeMap=k,K.nodeIdxMap=yt,[4,K.run(O,F)]);case 1:return lt.sent(),[2]}})})},B.prototype.run=function(O,F){return tt(this,void 0,void 0,function(){var K,nt,P,k,yt,st,lt,ht,mt,wt,ut,pt,Nt,Ut,ue,se,Le,Ne,we,At,Qt,de,rn,Ee,ce,Oe,Ze=this;return j(this,function(fe){switch(fe.label){case 0:for(K=this,nt=K.nodes,P=K.edges,k=K.maxIteration,yt=K.center,st=K.height*K.width,lt=Math.sqrt(st)/10,ht=st/(nt.length+1),mt=Math.sqrt(ht),wt=K.speed,ut=K.clustering,pt=(0,R.attributesToTextureData)([K.clusterField],nt),Nt=pt.array,Ut=pt.count,nt.forEach(function(Ae,Ye){var ge=0,Be=0;(0,Q.isNumber)(Ae.fx)&&(0,Q.isNumber)(Ae.fy)&&(ge=Ae.fx||.001,Be=Ae.fy||.001),Nt[4*Ye+1]=ge,Nt[4*Ye+2]=Be}),ue=nt.length,se=(0,R.buildTextureData)(nt,P),Le=se.maxEdgePerVetex,Ne=se.array,we=K.workerEnabled,we?At=Z.World.create({canvas:O,engineOptions:{supportCompute:!0}}):At=Z.World.create({engineOptions:{supportCompute:!0}}),Qt=K.onLayoutEnd,de=[],rn=0;rn<Ut;rn++)de.push(0,0,0,0);return Ee=At.createKernel(L.fruchtermanBundle).setDispatch([ue,1,1]).setBinding({u_Data:Ne,u_K:mt,u_K2:ht,u_Gravity:K.gravity,u_ClusterGravity:K.clusterGravity||K.gravity||1,u_Speed:wt,u_MaxDisplace:lt,u_Clustering:ut?1:0,u_Center:yt,u_AttributeArray:Nt,u_ClusterCenters:de,MAX_EDGE_PER_VERTEX:Le,VERTEX_COUNT:ue}),ut&&(ce=At.createKernel(L.clusterBundle).setDispatch([Ut,1,1]).setBinding({u_Data:Ne,u_NodeAttributes:Nt,u_ClusterCenters:de,VERTEX_COUNT:ue,CLUSTER_COUNT:Ut})),Oe=function(){return tt(Ze,void 0,void 0,function(){var Ae,Ye;return j(this,function(ge){switch(ge.label){case 0:Ae=0,ge.label=1;case 1:return Ae<k?[4,Ee.execute()]:[3,6];case 2:return ge.sent(),ut?(ce.setBinding({u_Data:Ee}),[4,ce.execute()]):[3,4];case 3:ge.sent(),Ee.setBinding({u_ClusterCenters:ce}),ge.label=4;case 4:Ee.setBinding({u_MaxDisplace:lt*=.99}),ge.label=5;case 5:return Ae++,[3,1];case 6:return[4,Ee.getOutput()];case 7:return Ye=ge.sent(),O?F.postMessage({type:C.LAYOUT_MESSAGE.GPUEND,vertexEdgeData:Ye}):nt.forEach(function(Be,te){var ke=Ye[4*te],Ve=Ye[4*te+1];Be.x=ke,Be.y=Ve}),Qt&&Qt(),[2]}})})},[4,Oe()];case 1:return fe.sent(),[2]}})})},B.prototype.getType=function(){return"fruchterman-gpu"},B}(W.Base);ot.FruchtermanGPULayout=A},8574:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.clusterBundle=ot.clusterCode=ot.fruchtermanBundle=ot.fruchtermanCode=void 0,ot.fruchtermanCode=`
import { globalInvocationID } from 'g-webgpu';
const MAX_EDGE_PER_VERTEX;
const VERTEX_COUNT;
@numthreads(1, 1, 1)
class Fruchterman {
  @in @out
  u_Data: vec4[];
  @in
  u_K: float;
  @in
  u_K2: float;
  
  @in
  u_Center: vec2;
  @in
  u_Gravity: float;
  @in
  u_ClusterGravity: float;
  @in
  u_Speed: float;
  @in
  u_MaxDisplace: float;
  @in
  u_Clustering: float;
  @in
  u_AttributeArray: vec4[];
  @in
  u_ClusterCenters: vec4[];
  calcRepulsive(i: int, currentNode: vec4): vec2 {
    let dx = 0, dy = 0;
    for (let j = 0; j < VERTEX_COUNT; j++) {
      if (i != j) {
        const nextNode = this.u_Data[j];
        const xDist = currentNode[0] - nextNode[0];
        const yDist = currentNode[1] - nextNode[1];
        const dist = (xDist * xDist + yDist * yDist) + 0.01;
        let param = this.u_K2 / dist;
        
        if (dist > 0.0) {
          dx += param * xDist;
          dy += param * yDist;
          if (xDist == 0 && yDist == 0) {
            const sign = i < j ? 1 : -1;
            dx += param * sign;
            dy += param * sign;
          }
        }
      }
    }
    return [dx, dy];
  }
  calcGravity(currentNode: vec4, nodeAttributes: vec4): vec2 { // 
    let dx = 0, dy = 0;
    const vx = currentNode[0] - this.u_Center[0];
    const vy = currentNode[1] - this.u_Center[1];
    const gf = 0.01 * this.u_K * this.u_Gravity;
    dx = gf * vx;
    dy = gf * vy;
    if (this.u_Clustering == 1) {
      const clusterIdx = int(nodeAttributes[0]);
      const center = this.u_ClusterCenters[clusterIdx];
      const cvx = currentNode[0] - center[0];
      const cvy = currentNode[1] - center[1];
      const dist = sqrt(cvx * cvx + cvy * cvy) + 0.01;
      const parma = this.u_K * this.u_ClusterGravity / dist;
      dx += parma * cvx;
      dy += parma * cvy;
    }
    return [dx, dy];
  }
  calcAttractive(i: int, currentNode: vec4): vec2 {
    let dx = 0, dy = 0;
    const arr_offset = int(floor(currentNode[2] + 0.5));
    const length = int(floor(currentNode[3] + 0.5));
    const node_buffer: vec4;
    for (let p = 0; p < MAX_EDGE_PER_VERTEX; p++) {
      if (p >= length) break;
      const arr_idx = arr_offset + p;
      // when arr_idx % 4 == 0 update currentNodedx_buffer
      const buf_offset = arr_idx - arr_idx / 4 * 4;
      if (p == 0 || buf_offset == 0) {
        node_buffer = this.u_Data[int(arr_idx / 4)];
      }
      const float_j = buf_offset == 0 ? node_buffer[0] :
                      buf_offset == 1 ? node_buffer[1] :
                      buf_offset == 2 ? node_buffer[2] :
                                        node_buffer[3];
      const nextNode = this.u_Data[int(float_j)];
      const xDist = currentNode[0] - nextNode[0];
      const yDist = currentNode[1] - nextNode[1];
      const dist = sqrt(xDist * xDist + yDist * yDist) + 0.01;
      let attractiveF = dist / this.u_K;
    
      if (dist > 0.0) {
        dx -= xDist * attractiveF;
        dy -= yDist * attractiveF;
        if (xDist == 0 && yDist == 0) {
          const sign = i < int(float_j) ? 1 : -1;
          dx -= sign * attractiveF;
          dy -= sign * attractiveF;
        }
      }
    }
    return [dx, dy];
  }
  @main
  compute() {
    const i = globalInvocationID.x;
    const currentNode = this.u_Data[i];
    let dx = 0, dy = 0;
    if (i >= VERTEX_COUNT) {
      this.u_Data[i] = currentNode;
      return;
    }

    // [gravity, fx, fy, 0]
    const nodeAttributes = this.u_AttributeArray[i];

    if (nodeAttributes[1] != 0 && nodeAttributes[2] != 0) {
      // the node is fixed
      this.u_Data[i] = [
        nodeAttributes[1],
        nodeAttributes[2],
        currentNode[2],
        currentNode[3]
      ];
      return;
    }

    // repulsive
    const repulsive = this.calcRepulsive(i, currentNode);
    dx += repulsive[0];
    dy += repulsive[1];
    // attractive
    const attractive = this.calcAttractive(i, currentNode);
    dx += attractive[0];
    dy += attractive[1];
    // gravity
    const gravity = this.calcGravity(currentNode, nodeAttributes);
    dx -= gravity[0];
    dy -= gravity[1];
    // speed
    dx *= this.u_Speed;
    dy *= this.u_Speed;

    // move
    const distLength = sqrt(dx * dx + dy * dy);
    if (distLength > 0.0) {
      const limitedDist = min(this.u_MaxDisplace * this.u_Speed, distLength);
      this.u_Data[i] = [
        currentNode[0] + dx / distLength * limitedDist,
        currentNode[1] + dy / distLength * limitedDist,
        currentNode[2],
        currentNode[3]
      ];
    }
  }
}
`,ot.fruchtermanBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',ot.clusterCode=`
import { globalInvocationID } from 'g-webgpu';
const VERTEX_COUNT;
const CLUSTER_COUNT;
@numthreads(1, 1, 1)
class CalcCenter {
  @in
  u_Data: vec4[];
  @in
  u_NodeAttributes: vec4[]; // [[clusterIdx, 0, 0, 0], ...]
  @in @out
  u_ClusterCenters: vec4[]; // [[cx, cy, nodeCount, clusterIdx], ...]
  @main
  compute() {
    const i = globalInvocationID.x;
    const center = this.u_ClusterCenters[i];
    let sumx = 0;
    let sumy = 0;
    let count = 0;
    for (let j = 0; j < VERTEX_COUNT; j++) {
      const attributes = this.u_NodeAttributes[j];
      const clusterIdx = int(attributes[0]);
      const vertex = this.u_Data[j];
      if (clusterIdx == i) {
        sumx += vertex.x;
        sumy += vertex.y;
        count += 1;
      }
    }
    this.u_ClusterCenters[i] = [
      sumx / count,
      sumy / count,
      count,
      i
    ];
  }
}
`,ot.clusterBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}'},85194:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var B=function(O,F){return B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(K,nt){K.__proto__=nt}||function(K,nt){for(var P in nt)Object.prototype.hasOwnProperty.call(nt,P)&&(K[P]=nt[P])},B(O,F)};return function(O,F){if(typeof F!="function"&&F!==null)throw new TypeError("Class extends value "+String(F)+" is not a constructor or null");B(O,F);function K(){this.constructor=O}O.prototype=F===null?Object.create(F):(K.prototype=F.prototype,new K)}}(),tt=this&&this.__awaiter||function(B,O,F,K){function nt(P){return P instanceof F?P:new F(function(k){k(P)})}return new(F||(F=Promise))(function(P,k){function yt(ht){try{lt(K.next(ht))}catch(mt){k(mt)}}function st(ht){try{lt(K.throw(ht))}catch(mt){k(mt)}}function lt(ht){ht.done?P(ht.value):nt(ht.value).then(yt,st)}lt((K=K.apply(B,O||[])).next())})},j=this&&this.__generator||function(B,O){var F={label:0,sent:function(){if(P[0]&1)throw P[1];return P[1]},trys:[],ops:[]},K,nt,P,k;return k={next:yt(0),throw:yt(1),return:yt(2)},typeof Symbol=="function"&&(k[Symbol.iterator]=function(){return this}),k;function yt(lt){return function(ht){return st([lt,ht])}}function st(lt){if(K)throw new TypeError("Generator is already executing.");for(;k&&(k=0,lt[0]&&(F=0)),F;)try{if(K=1,nt&&(P=lt[0]&2?nt.return:lt[0]?nt.throw||((P=nt.return)&&P.call(nt),0):nt.next)&&!(P=P.call(nt,lt[1])).done)return P;switch(nt=0,P&&(lt=[lt[0]&2,P.value]),lt[0]){case 0:case 1:P=lt;break;case 4:return F.label++,{value:lt[1],done:!1};case 5:F.label++,nt=lt[1],lt=[0];continue;case 7:lt=F.ops.pop(),F.trys.pop();continue;default:if(P=F.trys,!(P=P.length>0&&P[P.length-1])&&(lt[0]===6||lt[0]===2)){F=0;continue}if(lt[0]===3&&(!P||lt[1]>P[0]&&lt[1]<P[3])){F.label=lt[1];break}if(lt[0]===6&&F.label<P[1]){F.label=P[1],P=lt;break}if(P&&F.label<P[2]){F.label=P[2],F.ops.push(lt);break}P[2]&&F.ops.pop(),F.trys.pop();continue}lt=O.call(B,F)}catch(ht){lt=[6,ht],nt=0}finally{K=P=0}if(lt[0]&5)throw lt[1];return{value:lt[0]?lt[1]:void 0,done:!0}}};Object.defineProperty(ot,"__esModule",{value:!0}),ot.GForceGPULayout=void 0;var W=$(62329),Q=$(49784),Z=$(79984),R=$(48835),L=$(80628),C=$(49762),A=$(16470),N=function(B){Y(O,B);function O(F){var K=B.call(this)||this;return K.maxIteration=1e3,K.edgeStrength=200,K.nodeStrength=1e3,K.coulombDisScale=.005,K.damping=.9,K.maxSpeed=1e3,K.minMovement=.5,K.interval=.02,K.factor=1,K.linkDistance=1,K.gravity=10,K.workerEnabled=!1,K.nodes=[],K.edges=[],K.width=300,K.height=300,K.nodeMap={},K.nodeIdxMap={},K.updateCfg(F),K}return O.prototype.getDefaultCfg=function(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}},O.prototype.execute=function(){return tt(this,void 0,void 0,function(){var F,K,nt,P,k;return j(this,function(yt){switch(yt.label){case 0:return F=this,K=F.nodes,!K||K.length===0?(F.onLayoutEnd&&F.onLayoutEnd(),[2]):(!F.width&&typeof window!="undefined"&&(F.width=window.innerWidth),!F.height&&typeof window!="undefined"&&(F.height=window.innerHeight),F.center||(F.center=[F.width/2,F.height/2]),nt=F.center,K.length===1?(K[0].x=nt[0],K[0].y=nt[1],F.onLayoutEnd&&F.onLayoutEnd(),[2]):(P={},k={},K.forEach(function(st,lt){(0,Q.isNumber)(st.x)||(st.x=Math.random()*F.width),(0,Q.isNumber)(st.y)||(st.y=Math.random()*F.height),P[st.id]=st,k[st.id]=lt}),F.nodeMap=P,F.nodeIdxMap=k,F.nodeStrength=(0,R.proccessToFunc)(F.nodeStrength,1),F.edgeStrength=(0,R.proccessToFunc)(F.edgeStrength,1),[4,F.run()]));case 1:return yt.sent(),[2]}})})},O.prototype.executeWithWorker=function(F,K){var nt=this,P=nt.nodes,k=nt.center;if(!(!P||P.length===0)){if(P.length===1){P[0].x=k[0],P[0].y=k[1];return}var yt={},st={};P.forEach(function(lt,ht){(0,Q.isNumber)(lt.x)||(lt.x=Math.random()*nt.width),(0,Q.isNumber)(lt.y)||(lt.y=Math.random()*nt.height),yt[lt.id]=lt,st[lt.id]=ht}),nt.nodeMap=yt,nt.nodeIdxMap=st,nt.nodeStrength=(0,R.proccessToFunc)(nt.nodeStrength,1),nt.edgeStrength=(0,R.proccessToFunc)(nt.edgeStrength,1),nt.run(F,K)}},O.prototype.run=function(F,K){return tt(this,void 0,void 0,function(){var nt,P,k,yt,st,lt,ht,mt,wt,ut,pt,Nt,Ut,ue,se,Le,Ne,we,At,Qt,de,rn,Ee,ce,Oe,Ze,fe,Ae=this;return j(this,function(Ye){switch(Ye.label){case 0:for(nt=this,P=nt.nodes,k=nt.edges,yt=nt.maxIteration,!nt.width&&typeof window!="undefined"&&(nt.width=window.innerWidth),!nt.height&&typeof window!="undefined"&&(nt.height=window.innerHeight),st=P.length,nt.linkDistance=(0,R.proccessToFunc)(nt.linkDistance),nt.edgeStrength=(0,R.proccessToFunc)(nt.edgeStrength),lt=(0,R.buildTextureDataWithTwoEdgeAttr)(P,k,nt.linkDistance,nt.edgeStrength),ht=lt.maxEdgePerVetex,mt=lt.array,nt.degrees=(0,L.getDegree)(P.length,nt.nodeIdxMap,k).map(function(ge){return ge.all}),wt=[],ut=[],pt=[],Nt=[],Ut=[],ue=[],se=[],nt.getMass||(nt.getMass=function(ge){return nt.degrees[nt.nodeIdxMap[ge.id]]||1}),Le=nt.gravity,Ne=nt.center,P.forEach(function(ge,Be){wt.push(nt.getMass(ge)),ut.push(nt.nodeStrength(ge)),nt.degrees[Be]||(nt.degrees[Be]=0);var te=[Ne[0],Ne[1],Le];if(nt.getCenter){var ke=nt.getCenter(ge,nt.degrees[Be]);ke&&(0,Q.isNumber)(ke[0])&&(0,Q.isNumber)(ke[1])&&(0,Q.isNumber)(ke[2])&&(te=ke)}pt.push(te[0]),Nt.push(te[1]),Ut.push(te[2]),(0,Q.isNumber)(ge.fx)&&(0,Q.isNumber)(ge.fy)?(ue.push(ge.fx||.001),se.push(ge.fy||.001)):(ue.push(0),se.push(0))}),we=(0,R.arrayToTextureData)([wt,nt.degrees,ut,ue]),At=(0,R.arrayToTextureData)([pt,Nt,Ut,se]),Qt=nt.workerEnabled,Qt?de=Z.World.create({canvas:F,engineOptions:{supportCompute:!0}}):de=Z.World.create({engineOptions:{supportCompute:!0}}),rn=nt.onLayoutEnd,Ee=[],mt.forEach(function(ge){Ee.push(ge)}),ce=0;ce<4;ce++)Ee.push(0);return Oe=de.createKernel(C.gForceBundle).setDispatch([st,1,1]).setBinding({u_Data:mt,u_damping:nt.damping,u_maxSpeed:nt.maxSpeed,u_minMovement:nt.minMovement,u_coulombDisScale:nt.coulombDisScale,u_factor:nt.factor,u_NodeAttributeArray1:we,u_NodeAttributeArray2:At,MAX_EDGE_PER_VERTEX:ht,VERTEX_COUNT:st,u_AveMovement:Ee,u_interval:nt.interval}),Ze=de.createKernel(C.aveMovementBundle).setDispatch([1,1,1]).setBinding({u_Data:mt,VERTEX_COUNT:st,u_AveMovement:[0,0,0,0]}),fe=function(){return tt(Ae,void 0,void 0,function(){var ge,Be,te;return j(this,function(ke){switch(ke.label){case 0:ge=0,ke.label=1;case 1:return ge<yt?[4,Oe.execute()]:[3,5];case 2:return ke.sent(),Ze.setBinding({u_Data:Oe}),[4,Ze.execute()];case 3:ke.sent(),Be=Math.max(.02,nt.interval-ge*.002),Oe.setBinding({u_interval:Be,u_AveMovement:Ze}),ke.label=4;case 4:return ge++,[3,1];case 5:return[4,Oe.getOutput()];case 6:return te=ke.sent(),F?K.postMessage({type:A.LAYOUT_MESSAGE.GPUEND,vertexEdgeData:te}):P.forEach(function(Ve,ee){var Ft=te[4*ee],bt=te[4*ee+1];Ve.x=Ft,Ve.y=bt}),rn&&rn(),[2]}})})},[4,fe()];case 1:return Ye.sent(),[2]}})})},O.prototype.getType=function(){return"gForce-gpu"},O}(W.Base);ot.GForceGPULayout=N},49762:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.aveMovementBundle=ot.aveMovementCode=ot.gForceBundle=ot.gForceCode=void 0,ot.gForceCode=`
import { globalInvocationID } from 'g-webgpu';

const MAX_EDGE_PER_VERTEX;
const VERTEX_COUNT;
const SHIFT_20 = 1048576;

@numthreads(1, 1, 1)
class GGForce {
  @in @out
  u_Data: vec4[];

  @in
  u_damping: float;
  
  @in
  u_maxSpeed: float;

  @in
  u_minMovement: float;

  @in
  u_AveMovement: vec4[];

  @in
  u_coulombDisScale: float;

  @in
  u_factor: float;

  @in
  u_NodeAttributeArray1: vec4[];

  @in
  u_NodeAttributeArray2: vec4[];

  @in
  u_interval: float;

  unpack_float(packedValue: float): ivec2 {
    const packedIntValue = int(packedValue);
    const v0 = packedIntValue / SHIFT_20;
    return [v0, packedIntValue - v0 * SHIFT_20];
  }

  calcRepulsive(i: int, currentNode: vec4): vec2 {
    let ax = 0, ay = 0;
    for (let j: int = 0; j < VERTEX_COUNT; j++) {
      if (i != j) {
        const nextNode = this.u_Data[j];
        const vx = currentNode[0] - nextNode[0];
        const vy = currentNode[1] - nextNode[1];
        const dist = sqrt(vx * vx + vy * vy) + 0.01;
        const n_dist = (dist + 0.1) * this.u_coulombDisScale;
        const direx = vx / dist;
        const direy = vy / dist;
        const attributesi = this.u_NodeAttributeArray1[i];
        const attributesj = this.u_NodeAttributeArray1[j];
        const massi = attributesi[0];
        const nodeStrengthi = attributesi[2];
        const nodeStrengthj = attributesj[2];
        const nodeStrength = (nodeStrengthi + nodeStrengthj) / 2;
        // const param = nodeStrength * this.u_factor / (n_dist * n_dist * massi);
        const param = nodeStrength * this.u_factor / (n_dist * n_dist);
        ax += direx * param;
        ay += direy * param;
      }
    }
    return [ax, ay];
  }

  calcGravity(i: int, currentNode: vec4, attributes2: vec4): vec2 {
    // note: attributes2 = [centerX, centerY, gravity, 0]

    const vx = currentNode[0] - attributes2[0];
    const vy = currentNode[1] - attributes2[1];
    
    const ax = vx * attributes2[2];
    const ay = vy * attributes2[2];
    
    return [ax, ay];
  }

  calcAttractive(i: int, currentNode: vec4, attributes1: vec4): vec2 {
    // note: attributes1 = [mass, degree, nodeSterngth, 0]

    const mass = attributes1[0];
    let ax = 0, ay = 0;
    // const arr_offset = int(floor(currentNode[2] + 0.5));
    // const length = int(floor(currentNode[3] + 0.5));

    const compressed = this.unpack_float(currentNode[2]);
    const length = compressed[0];
    const arr_offset = compressed[1];

    const node_buffer: vec4;
    for (let p: int = 0; p < MAX_EDGE_PER_VERTEX; p++) {
      if (p >= length) break;
      const arr_idx = arr_offset + 4 * p; // i \u8282\u70B9\u7684\u7B2C p \u6761\u8FB9\u5F00\u59CB\u7684\u5C0F\u683C\u5B50\u4F4D\u7F6E
      const buf_offset = arr_idx - arr_idx / 4 * 4;
      if (p == 0 || buf_offset == 0) {
        node_buffer = this.u_Data[int(arr_idx / 4)]; // \u5927\u683C\u5B50\uFF0C\u5927\u683C\u5B50\u4F4D\u7F6E=\u5C0F\u4E2A\u5B50\u4F4D\u7F6E / 4\uFF0C
      }

      let float_j: float = node_buffer[0];

      const nextNode = this.u_Data[int(float_j)];
      const vx = nextNode[0] - currentNode[0];
      const vy = nextNode[1] - currentNode[1];
      const dist = sqrt(vx * vx + vy * vy) + 0.01;
      const direx = vx / dist;
      const direy = vy / dist;
      const edgeLength = node_buffer[1];
      const edgeStrength = node_buffer[2];
      const diff: float = edgeLength - dist;//edgeLength
      // const param = diff * this.u_stiffness / mass; //
      const param = diff * edgeStrength / mass; // 
      ax -= direx * param;
      ay -= direy * param;
    }
    return [ax, ay];
  }

  @main
  compute() {
    const i = globalInvocationID.x;
    const currentNode = this.u_Data[i];
    const movement = u_AveMovement[0];
    let ax = 0, ay = 0;

    if (i >= VERTEX_COUNT || movement.x < u_minMovement) {
      this.u_Data[i] = currentNode;
      return;
    }

    // \u6BCF\u4E2A\u8282\u70B9\u5C5E\u6027\u5360\u4E24\u4E2A\u6570\u7EC4\u4E2D\u5404\u4E00\u683C
    // [mass, degree, nodeStrength, fx]
    const nodeAttributes1 = this.u_NodeAttributeArray1[i];
    // [centerX, centerY, centerGravity, fy]
    const nodeAttributes2 = this.u_NodeAttributeArray2[i];

    // repulsive
    const repulsive = this.calcRepulsive(i, currentNode);
    ax += repulsive[0];
    ay += repulsive[1];

    // attractive
    const attractive = this.calcAttractive(i, currentNode, nodeAttributes1);
    ax += attractive[0];
    ay += attractive[1];

    // gravity
    const gravity = this.calcGravity(i, currentNode, nodeAttributes2);
    ax -= gravity[0];
    ay -= gravity[1];

    // speed
    const param = this.u_interval * this.u_damping;
    let vx = ax * param;
    let vy = ay * param;
    const vlength = sqrt(vx * vx + vy * vy) + 0.0001;
    if (vlength > this.u_maxSpeed) {
      const param2 = this.u_maxSpeed / vlength;
      vx = param2 * vx;
      vy = param2 * vy;
    }

    // move
    if (nodeAttributes1[3] != 0 && nodeAttributes2[3] != 0) {
      this.u_Data[i] = [
        nodeAttributes1[3],
        nodeAttributes2[3],
        currentNode[2],
        0
      ];
    } else {
      const distx = vx * this.u_interval;
      const disty = vy * this.u_interval;
      const distLength = sqrt(distx * distx + disty * disty);
      this.u_Data[i] = [
        currentNode[0] + distx,
        currentNode[1] + disty,
        currentNode[2],
        distLength
      ];
    }
    
    // the avarage move distance
    // need to share memory
    
  }
}
`,ot.gForceBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {float distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\ngl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}',ot.aveMovementCode=`
const VERTEX_COUNT;
@numthreads(1, 1, 1)
class CalcAveMovement {
  @in
  u_Data: vec4[];
  @in
  u_iter: float;
  @in @out
  u_AveMovement: vec4[];
  @main
  compute() {
    let movement = 0;
    for (let j: int = 0; j < VERTEX_COUNT; j++) {
      const vertex = this.u_Data[j];
      movement += vertex[3];
    }
    movement = movement / float(VERTEX_COUNT);
    this.u_AveMovement[0] = [movement, 0, 0, 0];
  }
}
`,ot.aveMovementBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}'},94414:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var Q=function(Z,R){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,C){L.__proto__=C}||function(L,C){for(var A in C)Object.prototype.hasOwnProperty.call(C,A)&&(L[A]=C[A])},Q(Z,R)};return function(Z,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");Q(Z,R);function L(){this.constructor=Z}Z.prototype=R===null?Object.create(R):(L.prototype=R.prototype,new L)}}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.GridLayout=void 0;var tt=$(49784),j=$(62329),W=function(Q){Y(Z,Q);function Z(R){var L=Q.call(this)||this;return L.begin=[0,0],L.preventOverlap=!0,L.preventOverlapPadding=10,L.condense=!1,L.sortBy="degree",L.nodes=[],L.edges=[],L.width=300,L.height=300,L.row=0,L.col=0,L.cellWidth=0,L.cellHeight=0,L.cellUsed={},L.id2manPos={},L.onLayoutEnd=function(){},L.updateCfg(R),L}return Z.prototype.getDefaultCfg=function(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}},Z.prototype.execute=function(){var R=this,L=R.nodes,C=R.edges,A=R.begin,N=L.length;if(N===0)return R.onLayoutEnd&&R.onLayoutEnd(),{nodes:L,edges:C};if(N===1)return L[0].x=A[0],L[0].y=A[1],R.onLayoutEnd&&R.onLayoutEnd(),{nodes:L,edges:C};var B=R.sortBy,O=R.width,F=R.height,K=R.condense,nt=R.preventOverlapPadding,P=R.preventOverlap,k=R.nodeSpacing,yt=R.nodeSize,st=[];L.forEach(function(we){st.push(we)});var lt={};if(st.forEach(function(we,At){lt[we.id]=At}),(B==="degree"||!(0,tt.isString)(B)||st[0][B]===void 0)&&(B="degree",(0,tt.isNaN)(L[0].degree))){var ht=(0,tt.getDegree)(st.length,lt,C);st.forEach(function(we,At){we.degree=ht[At].all})}st.sort(function(we,At){return At[B]-we[B]}),!O&&typeof window!="undefined"&&(O=window.innerWidth),!F&&typeof window!="undefined"&&(F=window.innerHeight);var mt=R.rows,wt=R.cols!=null?R.cols:R.columns;if(R.cells=N,mt!=null&&wt!=null?(R.rows=mt,R.cols=wt):mt!=null&&wt==null?(R.rows=mt,R.cols=Math.ceil(R.cells/R.rows)):mt==null&&wt!=null?(R.cols=wt,R.rows=Math.ceil(R.cells/R.cols)):(R.splits=Math.sqrt(R.cells*R.height/R.width),R.rows=Math.round(R.splits),R.cols=Math.round(R.width/R.height*R.splits)),R.rows=Math.max(R.rows,1),R.cols=Math.max(R.cols,1),R.cols*R.rows>R.cells){var ut=R.small(),pt=R.large();(ut-1)*pt>=R.cells?R.small(ut-1):(pt-1)*ut>=R.cells&&R.large(pt-1)}else for(;R.cols*R.rows<R.cells;){var ut=R.small(),pt=R.large();(pt+1)*ut>=R.cells?R.large(pt+1):R.small(ut+1)}if(R.cellWidth=O/R.cols,R.cellHeight=F/R.rows,K&&(R.cellWidth=0,R.cellHeight=0),P||k){var Nt=(0,tt.getFuncByUnknownType)(10,k),Ut=(0,tt.getFuncByUnknownType)(30,yt,!1);st.forEach(function(we){(!we.x||!we.y)&&(we.x=0,we.y=0);var At=Ut(we)||30,Qt,de;(0,tt.isArray)(At)?(Qt=At[0],de=At[1]):(Qt=At,de=At);var rn=Nt!==void 0?Nt(we):nt,Ee=Qt+rn,ce=de+rn;R.cellWidth=Math.max(R.cellWidth,Ee),R.cellHeight=Math.max(R.cellHeight,ce)})}R.cellUsed={},R.row=0,R.col=0,R.id2manPos={};for(var ue=0;ue<st.length;ue++){var se=st[ue],Le=void 0;if(R.position&&(Le=R.position(se)),Le&&(Le.row!==void 0||Le.col!==void 0)){var Ne={row:Le.row,col:Le.col};if(Ne.col===void 0)for(Ne.col=0;R.used(Ne.row,Ne.col);)Ne.col++;else if(Ne.row===void 0)for(Ne.row=0;R.used(Ne.row,Ne.col);)Ne.row++;R.id2manPos[se.id]=Ne,R.use(Ne.row,Ne.col)}R.getPos(se)}return R.onLayoutEnd&&R.onLayoutEnd(),{edges:C,nodes:st}},Z.prototype.small=function(R){var L=this,C,A=L.rows||5,N=L.cols||5;if(R==null)C=Math.min(A,N);else{var B=Math.min(A,N);B===L.rows?L.rows=R:L.cols=R}return C},Z.prototype.large=function(R){var L=this,C,A=L.rows||5,N=L.cols||5;if(R==null)C=Math.max(A,N);else{var B=Math.max(A,N);B===L.rows?L.rows=R:L.cols=R}return C},Z.prototype.used=function(R,L){var C=this;return C.cellUsed["c-".concat(R,"-").concat(L)]||!1},Z.prototype.use=function(R,L){var C=this;C.cellUsed["c-".concat(R,"-").concat(L)]=!0},Z.prototype.moveToNextCell=function(){var R=this,L=R.cols||5;R.col++,R.col>=L&&(R.col=0,R.row++)},Z.prototype.getPos=function(R){var L=this,C=L.begin,A=L.cellWidth,N=L.cellHeight,B,O,F=L.id2manPos[R.id];if(F)B=F.col*A+A/2+C[0],O=F.row*N+N/2+C[1];else{for(;L.used(L.row,L.col);)L.moveToNextCell();B=L.col*A+A/2+C[0],O=L.row*N+N/2+C[1],L.use(L.row,L.col),L.moveToNextCell()}R.x=B,R.y=O},Z.prototype.getType=function(){return"grid"},Z}(j.Base);ot.GridLayout=W},2584:function(ur,ot,$){"use strict";var Y=this&&this.__createBinding||(Object.create?function(ht,mt,wt,ut){ut===void 0&&(ut=wt);var pt=Object.getOwnPropertyDescriptor(mt,wt);(!pt||("get"in pt?!mt.__esModule:pt.writable||pt.configurable))&&(pt={enumerable:!0,get:function(){return mt[wt]}}),Object.defineProperty(ht,ut,pt)}:function(ht,mt,wt,ut){ut===void 0&&(ut=wt),ht[ut]=mt[wt]}),tt=this&&this.__exportStar||function(ht,mt){for(var wt in ht)wt!=="default"&&!Object.prototype.hasOwnProperty.call(mt,wt)&&Y(mt,ht,wt)};Object.defineProperty(ot,"__esModule",{value:!0}),ot.ERLayout=ot.ForceAtlas2Layout=ot.ComboCombinedLayout=ot.ComboForceLayout=ot.GForceGPULayout=ot.FruchtermanGPULayout=ot.FruchtermanLayout=ot.MDSLayout=ot.ConcentricLayout=ot.RadialLayout=ot.DagreCompoundLayout=ot.DagreLayout=ot.CircularLayout=ot.ForceLayout=ot.Force2Layout=ot.GForceLayout=ot.RandomLayout=ot.GridLayout=ot.Layouts=ot.Layout=void 0;var j=$(94414);Object.defineProperty(ot,"GridLayout",{enumerable:!0,get:function(){return j.GridLayout}});var W=$(39711);Object.defineProperty(ot,"RandomLayout",{enumerable:!0,get:function(){return W.RandomLayout}});var Q=$(13653);Object.defineProperty(ot,"GForceLayout",{enumerable:!0,get:function(){return Q.GForceLayout}});var Z=$(6740);Object.defineProperty(ot,"Force2Layout",{enumerable:!0,get:function(){return Z.Force2Layout}});var R=$(85717);Object.defineProperty(ot,"ForceLayout",{enumerable:!0,get:function(){return R.ForceLayout}});var L=$(64885);Object.defineProperty(ot,"CircularLayout",{enumerable:!0,get:function(){return L.CircularLayout}});var C=$(20171);Object.defineProperty(ot,"DagreLayout",{enumerable:!0,get:function(){return C.DagreLayout}});var A=$(77057);Object.defineProperty(ot,"DagreCompoundLayout",{enumerable:!0,get:function(){return A.DagreCompoundLayout}});var N=$(47944);Object.defineProperty(ot,"RadialLayout",{enumerable:!0,get:function(){return N.RadialLayout}});var B=$(43281);Object.defineProperty(ot,"ConcentricLayout",{enumerable:!0,get:function(){return B.ConcentricLayout}});var O=$(52899);Object.defineProperty(ot,"MDSLayout",{enumerable:!0,get:function(){return O.MDSLayout}});var F=$(80374);Object.defineProperty(ot,"FruchtermanLayout",{enumerable:!0,get:function(){return F.FruchtermanLayout}});var K=$(87745);Object.defineProperty(ot,"FruchtermanGPULayout",{enumerable:!0,get:function(){return K.FruchtermanGPULayout}});var nt=$(85194);Object.defineProperty(ot,"GForceGPULayout",{enumerable:!0,get:function(){return nt.GForceGPULayout}});var P=$(66590);Object.defineProperty(ot,"ComboForceLayout",{enumerable:!0,get:function(){return P.ComboForceLayout}});var k=$(63861);Object.defineProperty(ot,"ComboCombinedLayout",{enumerable:!0,get:function(){return k.ComboCombinedLayout}});var yt=$(48564);Object.defineProperty(ot,"ForceAtlas2Layout",{enumerable:!0,get:function(){return yt.ForceAtlas2Layout}});var st=$(90441);Object.defineProperty(ot,"ERLayout",{enumerable:!0,get:function(){return st.ERLayout}});var lt=$(42875);Object.defineProperty(ot,"Layout",{enumerable:!0,get:function(){return lt.Layout}}),Object.defineProperty(ot,"Layouts",{enumerable:!0,get:function(){return lt.Layouts}}),tt($(32867),ot)},42875:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.Layouts=ot.Layout=void 0;var Y=$(95326),tt=$(94414),j=$(39711),W=$(6740),Q=$(13653),Z=$(85717),R=$(64885),L=$(20171),C=$(47944),A=$(43281),N=$(52899),B=$(80374),O=$(87745),F=$(85194),K=$(66590),nt=$(63861),P=$(48564),k=$(90441),yt=$(77057),st=$(49784),lt=function(){function ht(mt){var wt=(0,Y.getLayoutByName)(mt.type);this.layoutInstance=new wt(mt)}return ht.prototype.layout=function(mt){return this.layoutInstance.layout(mt)},ht.prototype.updateCfg=function(mt){this.layoutInstance.updateCfg(mt)},ht.prototype.init=function(mt){this.correctLayers(mt.nodes),this.layoutInstance.init(mt)},ht.prototype.correctLayers=function(mt){if(!!(mt==null?void 0:mt.length)){var wt=Infinity,ut=[];if(mt.forEach(function(Nt){(0,st.isString)(Nt.layer)&&(Nt.layer=parseInt(Nt.layer,10)),!(Nt.layer===void 0||isNaN(Nt.layer))&&(ut.push(Nt),Nt.layer<wt&&(wt=Nt.layer))}),wt<=0){var pt=Math.abs(wt)+1;ut.forEach(function(Nt){return Nt.layer+=pt})}}},ht.prototype.execute=function(){this.layoutInstance.execute()},ht.prototype.getDefaultCfg=function(){return this.layoutInstance.getDefaultCfg()},ht.prototype.destroy=function(){return this.layoutInstance.destroy()},ht}();ot.Layout=lt,ot.Layouts={force:Z.ForceLayout,fruchterman:B.FruchtermanLayout,forceAtlas2:P.ForceAtlas2Layout,gForce:Q.GForceLayout,force2:W.Force2Layout,dagre:L.DagreLayout,dagreCompound:yt.DagreCompoundLayout,circular:R.CircularLayout,radial:C.RadialLayout,concentric:A.ConcentricLayout,grid:tt.GridLayout,mds:N.MDSLayout,comboForce:K.ComboForceLayout,comboCombined:nt.ComboCombinedLayout,random:j.RandomLayout,"gForce-gpu":F.GForceGPULayout,"fruchterman-gpu":O.FruchtermanGPULayout,er:k.ERLayout}},52899:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var Z=function(R,L){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,A){C.__proto__=A}||function(C,A){for(var N in A)Object.prototype.hasOwnProperty.call(A,N)&&(C[N]=A[N])},Z(R,L)};return function(R,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");Z(R,L);function C(){this.constructor=R}R.prototype=L===null?Object.create(L):(C.prototype=L.prototype,new C)}}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.MDSLayout=void 0;var tt=$(52710),j=$(49784),W=$(62329),Q=function(Z){Y(R,Z);function R(L){var C=Z.call(this)||this;return C.center=[0,0],C.linkDistance=50,C.nodes=[],C.edges=[],C.onLayoutEnd=function(){},C.updateCfg(L),C}return R.prototype.getDefaultCfg=function(){return{center:[0,0],linkDistance:50}},R.prototype.execute=function(){var L=this,C=L.nodes,A=L.edges,N=A===void 0?[]:A,B=L.center;if(!C||C.length===0){L.onLayoutEnd&&L.onLayoutEnd();return}if(C.length===1){C[0].x=B[0],C[0].y=B[1],L.onLayoutEnd&&L.onLayoutEnd();return}var O=L.linkDistance,F=(0,j.getAdjMatrix)({nodes:C,edges:N},!1),K=(0,j.floydWarshall)(F);L.handleInfinity(K);var nt=(0,j.scaleMatrix)(K,O);L.scaledDistances=nt;var P=L.runMDS();return L.positions=P,P.forEach(function(k,yt){C[yt].x=k[0]+B[0],C[yt].y=k[1]+B[1]}),L.onLayoutEnd&&L.onLayoutEnd(),{nodes:C,edges:N}},R.prototype.runMDS=function(){var L=this,C=2,A=L.scaledDistances,N=tt.Matrix.mul(tt.Matrix.pow(A,2),-.5),B=N.mean("row"),O=N.mean("column"),F=N.mean();N.add(F).subRowVector(B).subColumnVector(O);var K=new tt.SingularValueDecomposition(N),nt=tt.Matrix.sqrt(K.diagonalMatrix).diagonal();return K.leftSingularVectors.toJSON().map(function(P){return tt.Matrix.mul([P],[nt]).toJSON()[0].splice(0,C)})},R.prototype.handleInfinity=function(L){var C=-999999;L.forEach(function(A){A.forEach(function(N){N!==Infinity&&C<N&&(C=N)})}),L.forEach(function(A,N){A.forEach(function(B,O){B===Infinity&&(L[N][O]=C)})})},R.prototype.getType=function(){return"mds"},R}(W.Base);ot.MDSLayout=Q},47944:function(ur,ot,$){"use strict";var Y=this&&this.__createBinding||(Object.create?function(j,W,Q,Z){Z===void 0&&(Z=Q);var R=Object.getOwnPropertyDescriptor(W,Q);(!R||("get"in R?!W.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return W[Q]}}),Object.defineProperty(j,Z,R)}:function(j,W,Q,Z){Z===void 0&&(Z=Q),j[Z]=W[Q]}),tt=this&&this.__exportStar||function(j,W){for(var Q in j)Q!=="default"&&!Object.prototype.hasOwnProperty.call(W,Q)&&Y(W,j,Q)};Object.defineProperty(ot,"__esModule",{value:!0}),tt($(55974),ot)},66082:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var Y=$(52710),tt=function(){function j(W){this.distances=W.distances,this.dimension=W.dimension||2,this.linkDistance=W.linkDistance}return j.prototype.layout=function(){var W=this,Q=W.dimension,Z=W.distances,R=W.linkDistance;try{var L=Y.Matrix.mul(Y.Matrix.pow(Z,2),-.5),C=L.mean("row"),A=L.mean("column"),N=L.mean();L.add(N).subRowVector(C).subColumnVector(A);var B=new Y.SingularValueDecomposition(L),O=Y.Matrix.sqrt(B.diagonalMatrix).diagonal();return B.leftSingularVectors.toJSON().map(function(k){return Y.Matrix.mul([k],[O]).toJSON()[0].splice(0,Q)})}catch(k){for(var F=[],K=0;K<Z.length;K++){var nt=Math.random()*R,P=Math.random()*R;F.push([nt,P])}return F}},j}();ot.default=tt},55974:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var N=function(B,O){return N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,K){F.__proto__=K}||function(F,K){for(var nt in K)Object.prototype.hasOwnProperty.call(K,nt)&&(F[nt]=K[nt])},N(B,O)};return function(B,O){if(typeof O!="function"&&O!==null)throw new TypeError("Class extends value "+String(O)+" is not a constructor or null");N(B,O);function F(){this.constructor=B}B.prototype=O===null?Object.create(O):(F.prototype=O.prototype,new F)}}(),tt=this&&this.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(ot,"__esModule",{value:!0}),ot.RadialLayout=void 0;var j=$(49784),W=$(62329),Q=tt($(66082)),Z=tt($(6290));function R(N){for(var B=N.length,O=N[0].length,F=[],K=0;K<B;K++){for(var nt=[],P=0;P<O;P++)N[K][P]!==0?nt.push(1/(N[K][P]*N[K][P])):nt.push(0);F.push(nt)}return F}function L(N,B){var O=-1;return N.forEach(function(F,K){F.id===B&&(O=K)}),O}function C(N,B){return Math.sqrt((N[0]-B[0])*(N[0]-B[0])+(N[1]-B[1])*(N[1]-B[1]))}var A=function(N){Y(B,N);function B(O){var F=N.call(this)||this;return F.maxIteration=1e3,F.focusNode=null,F.unitRadius=null,F.linkDistance=50,F.preventOverlap=!1,F.strictRadial=!0,F.maxPreventOverlapIteration=200,F.sortStrength=10,F.nodes=[],F.edges=[],F.updateCfg(O),F}return B.prototype.getDefaultCfg=function(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}},B.prototype.execute=function(){var O=this,F=O.nodes,K=O.edges||[];if(!F||F.length===0){O.onLayoutEnd&&O.onLayoutEnd();return}!O.width&&typeof window!="undefined"&&(O.width=window.innerWidth),!O.height&&typeof window!="undefined"&&(O.height=window.innerHeight),O.center||(O.center=[O.width/2,O.height/2]);var nt=O.center;if(F.length===1){F[0].x=nt[0],F[0].y=nt[1],O.onLayoutEnd&&O.onLayoutEnd();return}var P=O.linkDistance,k=null;if((0,j.isString)(O.focusNode)){for(var yt=!1,st=0;st<F.length;st++)F[st].id===O.focusNode&&(k=F[st],O.focusNode=k,yt=!0,st=F.length);yt||(k=null)}else k=O.focusNode;k||(k=F[0],O.focusNode=k);var lt=L(F,k.id);lt<0&&(lt=0),O.focusIndex=lt;var ht=(0,j.getAdjMatrix)({nodes:F,edges:K},!1),mt=(0,j.floydWarshall)(ht),wt=O.maxToFocus(mt,lt);O.handleInfinity(mt,lt,wt+1),O.distances=mt;var ut=mt[lt],pt=O.width||500,Nt=O.height||500,Ut=pt-nt[0]>nt[0]?nt[0]:pt-nt[0],ue=Nt-nt[1]>nt[1]?nt[1]:Nt-nt[1];Ut===0&&(Ut=pt/2),ue===0&&(ue=Nt/2);var se=ue>Ut?Ut:ue,Le=Math.max.apply(Math,ut),Ne=[];ut.forEach(function(ge,Be){O.unitRadius||(O.unitRadius=se/Le),Ne[Be]=ge*O.unitRadius}),O.radii=Ne;var we=O.eIdealDisMatrix();O.eIdealDistances=we;var At=R(we);O.weights=At;var Qt=new Q.default({linkDistance:P,distances:we}),de=Qt.layout();de.forEach(function(ge){(0,j.isNaN)(ge[0])&&(ge[0]=Math.random()*P),(0,j.isNaN)(ge[1])&&(ge[1]=Math.random()*P)}),O.positions=de,de.forEach(function(ge,Be){F[Be].x=ge[0]+nt[0],F[Be].y=ge[1]+nt[1]}),de.forEach(function(ge){ge[0]-=de[lt][0],ge[1]-=de[lt][1]}),O.run();var rn=O.preventOverlap,Ee=O.nodeSize,ce,Oe=O.strictRadial;if(rn){var Ze=O.nodeSpacing,fe;(0,j.isNumber)(Ze)?fe=function(){return Ze}:(0,j.isFunction)(Ze)?fe=Ze:fe=function(){return 0},Ee?(0,j.isArray)(Ee)?ce=function(ge){var Be=Ee[0]>Ee[1]?Ee[0]:Ee[1];return Be+fe(ge)}:ce=function(ge){return Ee+fe(ge)}:ce=function(ge){if(ge.size){if((0,j.isArray)(ge.size)){var Be=ge.size[0]>ge.size[1]?ge.size[0]:ge.size[1];return Be+fe(ge)}if((0,j.isObject)(ge.size)){var Be=ge.size.width>ge.size.height?ge.size.width:ge.size.height;return Be+fe(ge)}return ge.size+fe(ge)}return 10+fe(ge)};var Ae={nodes:F,nodeSizeFunc:ce,adjMatrix:ht,positions:de,radii:Ne,height:Nt,width:pt,strictRadial:Oe,focusID:lt,iterations:O.maxPreventOverlapIteration||200,k:de.length/4.5},Ye=new Z.default(Ae);de=Ye.layout()}return de.forEach(function(ge,Be){F[Be].x=ge[0]+nt[0],F[Be].y=ge[1]+nt[1]}),O.onLayoutEnd&&O.onLayoutEnd(),{nodes:F,edges:K}},B.prototype.run=function(){for(var O=this,F=O.maxIteration,K=O.positions||[],nt=O.weights||[],P=O.eIdealDistances||[],k=O.radii||[],yt=0;yt<=F;yt++){var st=yt/F;O.oneIteration(st,K,k,P,nt)}},B.prototype.oneIteration=function(O,F,K,nt,P){var k=this,yt=1-O,st=k.focusIndex;F.forEach(function(lt,ht){var mt=C(lt,[0,0]),wt=mt===0?0:1/mt;if(ht!==st){var ut=0,pt=0,Nt=0;F.forEach(function(ue,se){if(ht!==se){var Le=C(lt,ue),Ne=Le===0?0:1/Le,we=nt[se][ht];Nt+=P[ht][se],ut+=P[ht][se]*(ue[0]+we*(lt[0]-ue[0])*Ne),pt+=P[ht][se]*(ue[1]+we*(lt[1]-ue[1])*Ne)}});var Ut=K[ht]===0?0:1/K[ht];Nt*=yt,Nt+=O*Ut*Ut,ut*=yt,ut+=O*Ut*lt[0]*wt,lt[0]=ut/Nt,pt*=yt,pt+=O*Ut*lt[1]*wt,lt[1]=pt/Nt}})},B.prototype.eIdealDisMatrix=function(){var O=this,F=O.nodes;if(!F)return[];var K=O.distances,nt=O.linkDistance,P=O.radii||[],k=O.unitRadius||50,yt=[];return K&&K.forEach(function(st,lt){var ht=[];st.forEach(function(mt,wt){if(lt===wt)ht.push(0);else if(P[lt]===P[wt])if(O.sortBy==="data")ht.push(mt*(Math.abs(lt-wt)*O.sortStrength)/(P[lt]/k));else if(O.sortBy){var ut=F[lt][O.sortBy]||0,pt=F[wt][O.sortBy]||0;(0,j.isString)(ut)&&(ut=ut.charCodeAt(0)),(0,j.isString)(pt)&&(pt=pt.charCodeAt(0)),ht.push(mt*(Math.abs(ut-pt)*O.sortStrength)/(P[lt]/k))}else ht.push(mt*nt/(P[lt]/k));else{var Nt=(nt+k)/2;ht.push(mt*Nt)}}),yt.push(ht)}),yt},B.prototype.handleInfinity=function(O,F,K){for(var nt=O.length,P=0;P<nt;P++)if(O[F][P]===Infinity){O[F][P]=K,O[P][F]=K;for(var k=0;k<nt;k++)O[P][k]!==Infinity&&O[F][k]===Infinity&&(O[F][k]=K+O[P][k],O[k][F]=K+O[P][k])}for(var P=0;P<nt;P++)if(P!==F){for(var k=0;k<nt;k++)if(O[P][k]===Infinity){var yt=Math.abs(O[F][P]-O[F][k]);yt=yt===0?1:yt,O[P][k]=yt}}},B.prototype.maxToFocus=function(O,F){for(var K=0,nt=0;nt<O[F].length;nt++)O[F][nt]!==Infinity&&(K=O[F][nt]>K?O[F][nt]:K);return K},B.prototype.getType=function(){return"radial"},B}(W.Base);ot.RadialLayout=A},6290:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0});var $=800,Y=function(){function tt(j){this.disp=[],this.positions=j.positions,this.adjMatrix=j.adjMatrix,this.focusID=j.focusID,this.radii=j.radii,this.iterations=j.iterations||10,this.height=j.height||10,this.width=j.width||10,this.speed=j.speed||100,this.gravity=j.gravity||10,this.nodeSizeFunc=j.nodeSizeFunc,this.k=j.k||5,this.strictRadial=j.strictRadial,this.nodes=j.nodes}return tt.prototype.layout=function(){var j=this,W=j.positions,Q=[],Z=j.iterations,R=j.width/10;j.maxDisplace=R,j.disp=Q;for(var L=0;L<Z;L++)W.forEach(function(C,A){Q[A]={x:0,y:0}}),j.getRepulsion(),j.updatePositions();return W},tt.prototype.getRepulsion=function(){var j=this,W=j.positions,Q=j.nodes,Z=j.disp,R=j.k,L=j.radii||[];W.forEach(function(C,A){Z[A]={x:0,y:0},W.forEach(function(N,B){if(A!==B&&L[A]===L[B]){var O=C[0]-N[0],F=C[1]-N[1],K=Math.sqrt(O*O+F*F);if(K===0){K=1;var nt=A>B?1:-1;O=.01*nt,F=.01*nt}if(K<j.nodeSizeFunc(Q[A])/2+j.nodeSizeFunc(Q[B])/2){var P=R*R/K;Z[A].x+=O/K*P,Z[A].y+=F/K*P}}})})},tt.prototype.updatePositions=function(){var j=this,W=j.positions,Q=j.disp,Z=j.speed,R=j.strictRadial,L=j.focusID,C=j.maxDisplace||j.width/10;R&&Q.forEach(function(N,B){var O=W[B][0]-W[L][0],F=W[B][1]-W[L][1],K=Math.sqrt(O*O+F*F),nt=F/K,P=-O/K,k=Math.sqrt(N.x*N.x+N.y*N.y),yt=Math.acos((nt*N.x+P*N.y)/k);yt>Math.PI/2&&(yt-=Math.PI/2,nt*=-1,P*=-1);var st=Math.cos(yt)*k;N.x=nt*st,N.y=P*st});var A=j.radii;W.forEach(function(N,B){if(B!==L){var O=Math.sqrt(Q[B].x*Q[B].x+Q[B].y*Q[B].y);if(O>0&&B!==L){var F=Math.min(C*(Z/$),O);if(N[0]+=Q[B].x/O*F,N[1]+=Q[B].y/O*F,R){var K=N[0]-W[L][0],nt=N[1]-W[L][1],P=Math.sqrt(K*K+nt*nt);K=K/P*A[B],nt=nt/P*A[B],N[0]=W[L][0]+K,N[1]=W[L][1]+nt}}}})},tt}();ot.default=Y},39711:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var W=function(Q,Z){return W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,L){R.__proto__=L}||function(R,L){for(var C in L)Object.prototype.hasOwnProperty.call(L,C)&&(R[C]=L[C])},W(Q,Z)};return function(Q,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");W(Q,Z);function R(){this.constructor=Q}Q.prototype=Z===null?Object.create(Z):(R.prototype=Z.prototype,new R)}}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.RandomLayout=void 0;var tt=$(62329),j=function(W){Y(Q,W);function Q(Z){var R=W.call(this)||this;return R.center=[0,0],R.width=300,R.height=300,R.nodes=[],R.edges=[],R.onLayoutEnd=function(){},R.updateCfg(Z),R}return Q.prototype.getDefaultCfg=function(){return{center:[0,0],width:300,height:300}},Q.prototype.execute=function(){var Z=this,R=Z.nodes,L=.9,C=Z.center;return!Z.width&&typeof window!="undefined"&&(Z.width=window.innerWidth),!Z.height&&typeof window!="undefined"&&(Z.height=window.innerHeight),R&&R.forEach(function(A){A.x=(Math.random()-.5)*L*Z.width+C[0],A.y=(Math.random()-.5)*L*Z.height+C[1]}),Z.onLayoutEnd&&Z.onLayoutEnd(),{nodes:R,edges:this.edges}},Q.prototype.getType=function(){return"random"},Q}(tt.Base);ot.RandomLayout=j},32867:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0})},95326:function(ur,ot,$){"use strict";var Y=this&&this.__extends||function(){var L=function(C,A){return L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,B){N.__proto__=B}||function(N,B){for(var O in B)Object.prototype.hasOwnProperty.call(B,O)&&(N[O]=B[O])},L(C,A)};return function(C,A){if(typeof A!="function"&&A!==null)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");L(C,A);function N(){this.constructor=C}C.prototype=A===null?Object.create(A):(N.prototype=A.prototype,new N)}}();Object.defineProperty(ot,"__esModule",{value:!0}),ot.getLayoutByName=ot.unRegisterLayout=ot.registerLayout=void 0;var tt=$(62329),j=$(49784),W=new Map,Q=function(L,C){if(W.get(L)&&console.warn("The layout with the name ".concat(L," exists already, it will be overridden")),(0,j.isObject)(C)){var A=function(N){Y(B,N);function B(O){var F=this,K;F=N.call(this)||this;var nt=F,P={},k=Object.assign({},nt.getDefaultCfg(),((K=C.getDefaultCfg)===null||K===void 0?void 0:K.call(C))||{});return Object.assign(P,k,C,O),Object.keys(P).forEach(function(yt){var st=P[yt];nt[yt]=st}),F}return B}(tt.Base);W.set(L,A)}else W.set(L,C);return W.get(L)};ot.registerLayout=Q;var Z=function(L){W.has(L)&&W.delete(L)};ot.unRegisterLayout=Z;var R=function(L){return W.has(L)?W.get(L):null};ot.getLayoutByName=R},85087:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.isArray=void 0,ot.isArray=Array.isArray},78732:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.getFuncByUnknownType=ot.getFunc=ot.isFunction=void 0;var Y=$(49784),tt=$(30627),j=function(Z){return typeof Z=="function"};ot.isFunction=j;var W=function(Z,R,L){var C;return L?C=L:(0,tt.isNumber)(Z)?C=function(){return Z}:C=function(){return R},C};ot.getFunc=W;var Q=function(Z,R,L){return L===void 0&&(L=!0),!R&&R!==0?function(C){return C.size?(0,Y.isArray)(C.size)?C.size[0]>C.size[1]?C.size[0]:C.size[1]:(0,Y.isObject)(C.size)?C.size.width>C.size.height?C.size.width:C.size.height:C.size:Z}:(0,ot.isFunction)(R)?R:(0,tt.isNumber)(R)?function(){return R}:(0,Y.isArray)(R)?function(){if(L){var C=Math.max.apply(Math,R);return isNaN(C)?Z:C}return R}:(0,Y.isObject)(R)?function(){if(L){var C=Math.max(R.width,R.height);return isNaN(C)?Z:C}return[R.width,R.height]}:function(){return Z}};ot.getFuncByUnknownType=Q},48835:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.arrayToTextureData=ot.attributesToTextureData=ot.buildTextureDataWithTwoEdgeAttr=ot.buildTextureData=ot.proccessToFunc=void 0;var Y=$(49784),tt=$(80628),j=function(L,C){var A;return L?(0,Y.isNumber)(L)?A=function(){return L}:A=L:A=function(){return C||1},A};ot.proccessToFunc=j;var W=function(L,C){var A=[],N=[],B={},O=0;for(O=0;O<L.length;O++){var F=L[O];B[F.id]=O,A.push(F.x),A.push(F.y),A.push(0),A.push(0),N.push([])}for(O=0;O<C.length;O++){var K=C[O],nt=(0,tt.getEdgeTerminal)(K,"source"),P=(0,tt.getEdgeTerminal)(K,"target");!isNaN(B[nt])&&!isNaN(B[P])&&(N[B[nt]].push(B[P]),N[B[P]].push(B[nt]))}var k=0;for(O=0;O<L.length;O++){var yt=A.length,st=N[O],lt=st.length;A[O*4+2]=yt,A[O*4+3]=lt,k=Math.max(k,lt);for(var ht=0;ht<lt;++ht){var mt=st[ht];A.push(+mt)}}for(;A.length%4!=0;)A.push(0);return{maxEdgePerVetex:k,array:new Float32Array(A)}};ot.buildTextureData=W;var Q=function(L,C,A,N){var B=[],O=[],F={},K=0;for(K=0;K<L.length;K++){var nt=L[K];F[nt.id]=K,B.push(nt.x),B.push(nt.y),B.push(0),B.push(0),O.push([])}for(K=0;K<C.length;K++){var P=C[K],k=(0,tt.getEdgeTerminal)(P,"source"),yt=(0,tt.getEdgeTerminal)(P,"target");O[F[k]].push(F[yt]),O[F[k]].push(A(P)),O[F[k]].push(N(P)),O[F[k]].push(0),O[F[yt]].push(F[k]),O[F[yt]].push(A(P)),O[F[yt]].push(N(P)),O[F[yt]].push(0)}var st=0;for(K=0;K<L.length;K++){var lt=B.length,ht=O[K],mt=ht.length;B[K*4+2]=lt+1048576*mt/4,B[K*4+3]=0,st=Math.max(st,mt/4);for(var wt=0;wt<mt;++wt){var ut=ht[wt];B.push(+ut)}}for(;B.length%4!=0;)B.push(0);return{maxEdgePerVetex:st,array:new Float32Array(B)}};ot.buildTextureDataWithTwoEdgeAttr=Q;var Z=function(L,C){var A=[],N=L.length,B={};return C.forEach(function(O){L.forEach(function(F,K){if(B[O[F]]===void 0&&(B[O[F]]=Object.keys(B).length),A.push(B[O[F]]),K===N-1)for(;A.length%4!=0;)A.push(0)})}),{array:new Float32Array(A),count:Object.keys(B).length}};ot.attributesToTextureData=Z;var R=function(L){for(var C=[],A=L.length,N=L[0].length,B=function(F){L.forEach(function(K,nt){if(C.push(K[F]),nt===A-1)for(;C.length%4!=0;)C.push(0)})},O=0;O<N;O++)B(O);return new Float32Array(C)};ot.arrayToTextureData=R},49784:function(ur,ot,$){"use strict";var Y=this&&this.__createBinding||(Object.create?function(j,W,Q,Z){Z===void 0&&(Z=Q);var R=Object.getOwnPropertyDescriptor(W,Q);(!R||("get"in R?!W.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return W[Q]}}),Object.defineProperty(j,Z,R)}:function(j,W,Q,Z){Z===void 0&&(Z=Q),j[Z]=W[Q]}),tt=this&&this.__exportStar||function(j,W){for(var Q in j)Q!=="default"&&!Object.prototype.hasOwnProperty.call(W,Q)&&Y(W,j,Q)};Object.defineProperty(ot,"__esModule",{value:!0}),tt($(8055),ot),tt($(85087),ot),tt($(30627),ot),tt($(80628),ot),tt($(98130),ot),tt($(78732),ot)},80628:function(ur,ot,$){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.getCoreNodeAndRelativeLeafNodes=ot.getAvgNodePosition=ot.getLayoutBBox=ot.traverseTreeUp=ot.scaleMatrix=ot.getAdjMatrix=ot.floydWarshall=ot.getDegreeMap=ot.getDegree=ot.getEdgeTerminal=void 0;var Y=$(85087),tt=$(30627),j=$(98130),W=function(k,yt){var st=k[yt];return(0,j.isObject)(st)?st.cell:st};ot.getEdgeTerminal=W;var Q=function(k,yt,st){for(var lt=[],ht=0;ht<k;ht++)lt[ht]={in:0,out:0,all:0};return st&&st.forEach(function(mt){var wt=(0,ot.getEdgeTerminal)(mt,"source"),ut=(0,ot.getEdgeTerminal)(mt,"target");wt&&lt[yt[wt]]&&(lt[yt[wt]].out+=1,lt[yt[wt]].all+=1),ut&&lt[yt[ut]]&&(lt[yt[ut]].in+=1,lt[yt[ut]].all+=1)}),lt};ot.getDegree=Q;var Z=function(k,yt){var st={};return k.forEach(function(lt){st[lt.id]={in:0,out:0,all:0}}),yt&&yt.forEach(function(lt){var ht=(0,ot.getEdgeTerminal)(lt,"source"),mt=(0,ot.getEdgeTerminal)(lt,"target");ht&&(st[ht].out+=1,st[ht].all+=1),mt&&(st[mt].in+=1,st[mt].all+=1)}),st};ot.getDegreeMap=Z;var R=function(k){for(var yt=[],st=k.length,lt=0;lt<st;lt+=1){yt[lt]=[];for(var ht=0;ht<st;ht+=1)lt===ht?yt[lt][ht]=0:k[lt][ht]===0||!k[lt][ht]?yt[lt][ht]=Infinity:yt[lt][ht]=k[lt][ht]}for(var mt=0;mt<st;mt+=1)for(var lt=0;lt<st;lt+=1)for(var ht=0;ht<st;ht+=1)yt[lt][ht]>yt[lt][mt]+yt[mt][ht]&&(yt[lt][ht]=yt[lt][mt]+yt[mt][ht]);return yt};ot.floydWarshall=R;var L=function(k,yt){var st=k.nodes,lt=k.edges,ht=[],mt={};if(!st)throw new Error("invalid nodes data!");return st&&st.forEach(function(wt,ut){mt[wt.id]=ut;var pt=[];ht.push(pt)}),lt==null||lt.forEach(function(wt){var ut=(0,ot.getEdgeTerminal)(wt,"source"),pt=(0,ot.getEdgeTerminal)(wt,"target"),Nt=mt[ut],Ut=mt[pt];Nt===void 0||Ut===void 0||(ht[Nt][Ut]=1,yt||(ht[Ut][Nt]=1))}),ht};ot.getAdjMatrix=L;var C=function(k,yt){var st=[];return k.forEach(function(lt){var ht=[];lt.forEach(function(mt){ht.push(mt*yt)}),st.push(ht)}),st};ot.scaleMatrix=C;var A=function(k,yt){if(k&&k.children){for(var st=k.children.length-1;st>=0;st--)if(!A(k.children[st],yt))return}return!!yt(k)},N=function(k,yt){typeof yt=="function"&&A(k,yt)};ot.traverseTreeUp=N;var B=function(k){var yt=Infinity,st=Infinity,lt=-Infinity,ht=-Infinity;return k.forEach(function(mt){var wt=mt.size;(0,Y.isArray)(wt)?wt.length===1&&(wt=[wt[0],wt[0]]):(0,tt.isNumber)(wt)?wt=[wt,wt]:(wt===void 0||isNaN(wt))&&(wt=[30,30]);var ut=[wt[0]/2,wt[1]/2],pt=mt.x-ut[0],Nt=mt.x+ut[0],Ut=mt.y-ut[1],ue=mt.y+ut[1];yt>pt&&(yt=pt),st>Ut&&(st=Ut),lt<Nt&&(lt=Nt),ht<ue&&(ht=ue)}),{minX:yt,minY:st,maxX:lt,maxY:ht}};ot.getLayoutBBox=B;var O=function(k){var yt={x:0,y:0};k.forEach(function(lt){yt.x+=lt.x||0,yt.y+=lt.y||0});var st=k.length||1;return{x:yt.x/st,y:yt.y/st}};ot.getAvgNodePosition=O;var F=function(k,yt,st){var lt,ht;return k==="source"?((lt=st==null?void 0:st.find(function(mt){return mt.target===yt.id}))===null||lt===void 0?void 0:lt.source)||{}:((ht=st==null?void 0:st.find(function(mt){return mt.source===yt.id}))===null||ht===void 0?void 0:ht.target)||{}},K=function(k,yt,st){var lt=[];switch(k){case"source":lt=st==null?void 0:st.filter(function(mt){return mt.source===yt.id}).map(function(mt){return mt.target});break;case"target":lt=st==null?void 0:st.filter(function(mt){return mt.target===yt.id}).map(function(mt){return mt.source});break;case"both":lt=st==null?void 0:st.filter(function(mt){return mt.source===yt.id}).map(function(mt){return mt.target}).concat(st==null?void 0:st.filter(function(mt){return mt.target===yt.id}).map(function(mt){return mt.source}));break;default:break}var ht=new Set(lt);return Array.from(ht)},nt=function(k,yt,st,lt,ht){var mt=st[yt]||"",wt=(lt==null?void 0:lt.filter(function(ut){return ut[yt]===mt}))||[];return k==="leaf"&&(wt=wt.filter(function(ut){var pt,Nt;return((pt=ht[ut.id])===null||pt===void 0?void 0:pt.in)===0||((Nt=ht[ut.id])===null||Nt===void 0?void 0:Nt.out)===0})),wt},P=function(k,yt,st,lt,ht,mt){var wt=ht[yt.id],ut=wt.in,pt=wt.out,Nt=yt,Ut=[];ut===0?(Nt=F("source",yt,st),Ut=K("both",Nt,st).map(function(se){return mt[se]})):pt===0&&(Nt=F("target",yt,st),Ut=K("both",Nt,st).map(function(se){return mt[se]})),Ut=Ut.filter(function(se){return ht[se.id]&&(ht[se.id].in===0||ht[se.id].out===0)});var ue=nt(k,lt,yt,Ut,ht);return{coreNode:Nt,relativeLeafNodes:Ut,sameTypeLeafNodes:ue}};ot.getCoreNodeAndRelativeLeafNodes=P},30627:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.toNumber=ot.isNaN=ot.isNumber=void 0;var $=function(j){return typeof j=="number"};ot.isNumber=$;var Y=function(j){return Number.isNaN(Number(j))};ot.isNaN=Y;var tt=function(j){var W=parseFloat(j);return(0,ot.isNaN)(W)?j:W};ot.toNumber=tt},98130:function(ur,ot){"use strict";var $=this&&this.__assign||function(){return $=Object.assign||function(j){for(var W,Q=1,Z=arguments.length;Q<Z;Q++){W=arguments[Q];for(var R in W)Object.prototype.hasOwnProperty.call(W,R)&&(j[R]=W[R])}return j},$.apply(this,arguments)};Object.defineProperty(ot,"__esModule",{value:!0}),ot.clone=ot.isObject=void 0;var Y=function(j){return j!==null&&typeof j=="object"};ot.isObject=Y;var tt=function(j){if(j===null)return j;if(j instanceof Date)return new Date(j.getTime());if(j instanceof Array){var W=[];return j.forEach(function(Z){W.push(Z)}),W.map(function(Z){return(0,ot.clone)(Z)})}if(typeof j=="object"&&Object.keys(j).length){var Q=$({},j);return Object.keys(Q).forEach(function(Z){Q[Z]=(0,ot.clone)(Q[Z])}),Q}return j};ot.clone=tt},8055:function(ur,ot){"use strict";Object.defineProperty(ot,"__esModule",{value:!0}),ot.camelize=ot.isString=void 0;var $=function(j){return typeof j=="string"};ot.isString=$;var Y=function(j){var W=Object.create(null);return function(Q){var Z=W[Q];return Z||(W[Q]=j(Q))}},tt=/-(\w)/g;ot.camelize=Y(function(j){return j.replace(tt,function(W,Q){return Q?Q.toUpperCase():""})})},45603:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{Cache:function(){return Ri},angleTo:function(){return wt},arcToCubic:function(){return Me},assign:function(){return We},augment:function(){return ha},clamp:function(){return Cs},clearAnimationFrame:function(){return Mn},clone:function(){return Va},clonePath:function(){return pt},contains:function(){return H},debounce:function(){return ma},deepMix:function(){return yo},difference:function(){return Vt},direction:function(){return mt},distanceSquareRoot:function(){return Rt},each:function(){return Jn},endsWith:function(){return Cu},equalizeSegments:function(){return un},every:function(){return Bi},extend:function(){return Vu},filter:function(){return xt},find:function(){return Ra},findIndex:function(){return De},firstValue:function(){return Wn},fixedBase:function(){return Tl},flatten:function(){return Kn},flattenDeep:function(){return xa},forIn:function(){return Zn},get:function(){return hh},getDrawDirection:function(){return pr},getPathArea:function(){return Sr},getPathBBox:function(){return tr},getPathBBoxTotalLength:function(){return Wr},getPointAtLength:function(){return qr},getRange:function(){return Ki},getRotatedCurve:function(){return nr},getTotalLength:function(){return zn},getType:function(){return Ys},getWrapBehavior:function(){return pa},gradient:function(){return A},group:function(){return xn},groupBy:function(){return Qs},groupToMap:function(){return Qu},has:function(){return Yt},hasKey:function(){return Ie},hasValue:function(){return In},head:function(){return ys},identity:function(){return jf},includes:function(){return H},indexOf:function(){return ju},isArguments:function(){return As},isArray:function(){return Ln},isArrayLike:function(){return Ot},isBoolean:function(){return su},isDate:function(){return Rl},isDecimal:function(){return Mu},isElement:function(){return an},isEmpty:function(){return al},isEqual:function(){return ds},isEqualWith:function(){return uu},isError:function(){return nl},isEven:function(){return Nu},isFinite:function(){return rl},isFunction:function(){return Xt},isInteger:function(){return Bs},isMatch:function(){return da},isNegative:function(){return Fu},isNil:function(){return on},isNull:function(){return Sf},isNumber:function(){return Js},isNumberEqual:function(){return Ju},isObject:function(){return Qr},isObjectLike:function(){return ki},isOdd:function(){return gc},isPlainObject:function(){return ii},isPointInPolygon:function(){return sc},isPointInStroke:function(){return ba},isPolygonsIntersect:function(){return Pl},isPositive:function(){return vl},isPrototype:function(){return T},isRegExp:function(){return Kt},isString:function(){return as},isType:function(){return Qn},isUndefined:function(){return Re},keys:function(){return na},last:function(){return is},lowerCase:function(){return Ta},lowerFirst:function(){return ja},map:function(){return tf},mapValues:function(){return wl},max:function(){return La},maxBy:function(){return Ls},memoize:function(){return Mi},min:function(){return ui},minBy:function(){return el},mix:function(){return We},mod:function(){return Ol},noop:function(){return hp},normalizePath:function(){return ee},number2color:function(){return So},omit:function(){return dh},parseRadius:function(){return fo},path2Absolute:function(){return ke},path2Curve:function(){return dr},path2String:function(){return Ut},pick:function(){return Vp},pull:function(){return Zi},pullAt:function(){return ms},reduce:function(){return To},remove:function(){return Eu},requestAnimationFrame:function(){return wn},reverseCurve:function(){return Ur},rgb2arr:function(){return Y},set:function(){return Nd},size:function(){return pf},some:function(){return os},sortBy:function(){return Su},startsWith:function(){return Du},substitute:function(){return so},throttle:function(){return kd},toArray:function(){return jp},toCSSGradient:function(){return K},toDegree:function(){return ve},toInteger:function(){return Gt},toRGB:function(){return R},toRadian:function(){return bn},toString:function(){return ar},transform:function(){return ht},union:function(){return Zo},uniq:function(){return fu},uniqueId:function(){return Rf},upperCase:function(){return Oi},upperFirst:function(){return wo},values:function(){return Fe},valuesOfKey:function(){return Wi},vertical:function(){return ut},wrapBehavior:function(){return Vi}});function Y(Dt){return[parseInt(Dt.substr(1,2),16),parseInt(Dt.substr(3,2),16),parseInt(Dt.substr(5,2),16)]}function tt(Dt){var ae=Math.round(Dt).toString(16);return ae.length===1?"0"+ae:ae}function j(Dt){return"#"+tt(Dt[0])+tt(Dt[1])+tt(Dt[2])}var W=/rgba?\(([\s.,0-9]+)\)/;function Q(){var Dt=document.createElement("i");return Dt.title="Web Colour Picker",Dt.style.display="none",document.body.appendChild(Dt),Dt}var Z;function R(Dt){if(Dt[0]==="#"&&Dt.length===7)return Dt;Z||(Z=Q()),Z.style.color=Dt;var ae=document.defaultView.getComputedStyle(Z,"").getPropertyValue("color"),xe=W.exec(ae),qe=xe[1].split(/\s*,\s*/).map(function(yn){return Number(yn)});return ae=j(qe),ae}function L(Dt,ae,xe,qe){return Dt[qe]+(ae[qe]-Dt[qe])*xe}function C(Dt,ae){var xe=isNaN(Number(ae))||ae<0?0:ae>1?1:Number(ae),qe=Dt.length-1,yn=Math.floor(qe*xe),Er=qe*xe-yn,Cr=Dt[yn],oa=yn===qe?Cr:Dt[yn+1];return j([L(Cr,oa,Er,0),L(Cr,oa,Er,1),L(Cr,oa,Er,2)])}function A(Dt){var ae=typeof Dt=="string"?Dt.split("-"):Dt,xe=ae.map(function(qe){return Y(qe.indexOf("#")===-1?R(qe):qe)});return function(qe){return C(xe,qe)}}var N=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,B=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,O=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function F(Dt){return/^[r,R,L,l]{1}[\s]*\(/.test(Dt)}function K(Dt){if(F(Dt)){var ae,xe=void 0;if(Dt[0]==="l"){var qe=N.exec(Dt),yn=+qe[1]+90;xe=qe[2],ae="linear-gradient("+yn+"deg, "}else if(Dt[0]==="r"){ae="radial-gradient(";var qe=B.exec(Dt);xe=qe[4]}var Er=xe.match(O);return Er.forEach(function(Cr,oa){var Nn=Cr.split(":");ae+=Nn[1]+" "+Number(Nn[0])*100+"%",oa!==Er.length-1&&(ae+=", ")}),ae+=")",ae}return Dt}var nt=$(35600),P=$(31437);function k(Dt,ae,xe){var qe=[0,0,0,0,0,0,0,0,0];return nt.fromTranslation(qe,xe),nt.multiply(Dt,qe,ae)}function yt(Dt,ae,xe){var qe=[0,0,0,0,0,0,0,0,0];return nt.fromRotation(qe,xe),nt.multiply(Dt,qe,ae)}function st(Dt,ae,xe){var qe=[0,0,0,0,0,0,0,0,0];return nt.fromScaling(qe,xe),nt.multiply(Dt,qe,ae)}function lt(Dt,ae,xe){return nt.multiply(Dt,xe,ae)}function ht(Dt,ae){for(var xe=Dt?[].concat(Dt):[1,0,0,0,1,0,0,0,1],qe=0,yn=ae.length;qe<yn;qe++){var Er=ae[qe];switch(Er[0]){case"t":k(xe,xe,[Er[1],Er[2]]);break;case"s":st(xe,xe,[Er[1],Er[2]]);break;case"r":yt(xe,xe,Er[1]);break;case"m":lt(xe,xe,Er[1]);break;default:break}}return xe}function mt(Dt,ae){return Dt[0]*ae[1]-ae[0]*Dt[1]}function wt(Dt,ae,xe){var qe=P.angle(Dt,ae),yn=mt(Dt,ae)>=0;return xe?yn?Math.PI*2-qe:qe:yn?qe:Math.PI*2-qe}function ut(Dt,ae,xe){return xe?(Dt[0]=ae[1],Dt[1]=-1*ae[0]):(Dt[0]=-1*ae[1],Dt[1]=ae[0]),Dt}function pt(Dt){return Dt.map(function(ae){return Array.isArray(ae)?[].concat(ae):ae})}function Nt(Dt,ae){if(ae==="off")return pt(Dt);var xe=typeof ae=="number"&&ae>=1?Math.pow(10,ae):1;return Dt.map(function(qe){var yn=qe.slice(1).map(Number).map(function(Er){return ae?Math.round(Er*xe)/xe:Math.round(Er)});return[qe[0]].concat(yn)})}function Ut(Dt,ae){return ae===void 0&&(ae="off"),Nt(Dt,ae).map(function(xe){return xe[0]+xe.slice(1).join(" ")}).join("")}var ue=$(65353),se={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Le(Dt,ae,xe){if(Dt[xe].length>7){Dt[xe].shift();for(var qe=Dt[xe],yn=xe;qe.length;)ae[xe]="A",Dt.splice(yn+=1,0,["C"].concat(qe.splice(0,6)));Dt.splice(xe,1)}}var Ne={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function we(Dt){return Array.isArray(Dt)&&Dt.every(function(ae){var xe=ae[0].toLowerCase();return Ne[xe]===ae.length-1&&"achlmqstvz".includes(xe)})}function At(Dt){return we(Dt)&&Dt.every(function(ae){var xe=ae[0];return xe===xe.toUpperCase()})}function Qt(Dt){return At(Dt)&&Dt.every(function(ae){var xe=ae[0];return"ACLMQZ".includes(xe)})}function de(Dt){for(var ae=Dt.pathValue[Dt.segmentStart],xe=ae.toLowerCase(),qe=Dt.data;qe.length>=Ne[xe]&&(xe==="m"&&qe.length>2?(Dt.segments.push([ae].concat(qe.splice(0,2))),xe="l",ae=ae==="m"?"l":"L"):Dt.segments.push([ae].concat(qe.splice(0,Ne[xe]))),!!Ne[xe]););}function rn(Dt){var ae=Dt.index,xe=Dt.pathValue,qe=xe.charCodeAt(ae);if(qe===48){Dt.param=0,Dt.index+=1;return}if(qe===49){Dt.param=1,Dt.index+=1;return}Dt.err='[path-util]: invalid Arc flag "'+xe[ae]+'", expecting 0 or 1 at index '+ae}function Ee(Dt){return Dt>=48&&Dt<=57||Dt===43||Dt===45||Dt===46}function ce(Dt){return Dt>=48&&Dt<=57}function Oe(Dt){var ae=Dt.max,xe=Dt.pathValue,qe=Dt.index,yn=qe,Er=!1,Cr=!1,oa=!1,Nn=!1,Pa;if(yn>=ae){Dt.err="[path-util]: Invalid path value at index "+yn+', "pathValue" is missing param';return}if(Pa=xe.charCodeAt(yn),(Pa===43||Pa===45)&&(yn+=1,Pa=xe.charCodeAt(yn)),!ce(Pa)&&Pa!==46){Dt.err="[path-util]: Invalid path value at index "+yn+', "'+xe[yn]+'" is not a number';return}if(Pa!==46){if(Er=Pa===48,yn+=1,Pa=xe.charCodeAt(yn),Er&&yn<ae&&Pa&&ce(Pa)){Dt.err="[path-util]: Invalid path value at index "+qe+', "'+xe[qe]+'" illegal number';return}for(;yn<ae&&ce(xe.charCodeAt(yn));)yn+=1,Cr=!0;Pa=xe.charCodeAt(yn)}if(Pa===46){for(Nn=!0,yn+=1;ce(xe.charCodeAt(yn));)yn+=1,oa=!0;Pa=xe.charCodeAt(yn)}if(Pa===101||Pa===69){if(Nn&&!Cr&&!oa){Dt.err="[path-util]: Invalid path value at index "+yn+', "'+xe[yn]+'" invalid float exponent';return}if(yn+=1,Pa=xe.charCodeAt(yn),(Pa===43||Pa===45)&&(yn+=1),yn<ae&&ce(xe.charCodeAt(yn)))for(;yn<ae&&ce(xe.charCodeAt(yn));)yn+=1;else{Dt.err="[path-util]: Invalid path value at index "+yn+', "'+xe[yn]+'" invalid integer exponent';return}}Dt.index=yn,Dt.param=+Dt.pathValue.slice(qe,yn)}function Ze(Dt){var ae=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return Dt===10||Dt===13||Dt===8232||Dt===8233||Dt===32||Dt===9||Dt===11||Dt===12||Dt===160||Dt>=5760&&ae.includes(Dt)}function fe(Dt){for(var ae=Dt.pathValue,xe=Dt.max;Dt.index<xe&&Ze(ae.charCodeAt(Dt.index));)Dt.index+=1}function Ae(Dt){switch(Dt|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function Ye(Dt){return(Dt|32)==97}function ge(Dt){var ae=Dt.max,xe=Dt.pathValue,qe=Dt.index,yn=xe.charCodeAt(qe),Er=Ne[xe[qe].toLowerCase()];if(Dt.segmentStart=qe,!Ae(yn)){Dt.err='[path-util]: Invalid path value "'+xe[qe]+'" is not a path command';return}if(Dt.index+=1,fe(Dt),Dt.data=[],!Er){de(Dt);return}for(;;){for(var Cr=Er;Cr>0;Cr-=1){if(Ye(yn)&&(Cr===3||Cr===4)?rn(Dt):Oe(Dt),Dt.err.length)return;Dt.data.push(Dt.param),fe(Dt),Dt.index<ae&&xe.charCodeAt(Dt.index)===44&&(Dt.index+=1,fe(Dt))}if(Dt.index>=Dt.max||!Ee(xe.charCodeAt(Dt.index)))break}de(Dt)}var Be=function(){function Dt(ae){this.pathValue=ae,this.segments=[],this.max=ae.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return Dt}();function te(Dt){if(we(Dt))return pt(Dt);var ae=new Be(Dt);for(fe(ae);ae.index<ae.max&&!ae.err.length;)ge(ae);return ae.err?ae.err:ae.segments}function ke(Dt){if(At(Dt))return pt(Dt);var ae=te(Dt),xe=0,qe=0,yn=0,Er=0;return ae.map(function(Cr){var oa=Cr.slice(1).map(Number),Nn=Cr[0],Pa=Nn.toUpperCase();if(Nn==="M")return xe=oa[0],qe=oa[1],yn=xe,Er=qe,["M",xe,qe];var wi;if(Nn!==Pa)switch(Pa){case"A":wi=[Pa,oa[0],oa[1],oa[2],oa[3],oa[4],oa[5]+xe,oa[6]+qe];break;case"V":wi=[Pa,oa[0]+qe];break;case"H":wi=[Pa,oa[0]+xe];break;default:{var Ui=oa.map(function(Oo,us){return Oo+(us%2?qe:xe)});wi=[Pa].concat(Ui)}}else wi=[Pa].concat(oa);var Ei=wi.length;switch(Pa){case"Z":xe=yn,qe=Er;break;case"H":xe=wi[1];break;case"V":qe=wi[1];break;default:xe=wi[Ei-2],qe=wi[Ei-1],Pa==="M"&&(yn=xe,Er=qe)}return wi})}function Ve(Dt,ae){var xe=Dt[0],qe=ae.x1,yn=ae.y1,Er=ae.x2,Cr=ae.y2,oa=Dt.slice(1).map(Number),Nn=Dt;if("TQ".includes(xe)||(ae.qx=null,ae.qy=null),xe==="H")Nn=["L",Dt[1],yn];else if(xe==="V")Nn=["L",qe,Dt[1]];else if(xe==="S"){var Pa=qe*2-Er,wi=yn*2-Cr;ae.x1=Pa,ae.y1=wi,Nn=["C",Pa,wi].concat(oa)}else if(xe==="T"){var Ui=qe*2-ae.qx,Ei=yn*2-ae.qy;ae.qx=Ui,ae.qy=Ei,Nn=["Q",Ui,Ei].concat(oa)}else if(xe==="Q"){var Oo=oa[0],us=oa[1];ae.qx=Oo,ae.qy=us}return Nn}function ee(Dt){if(Qt(Dt))return pt(Dt);for(var ae=ke(Dt),xe=(0,ue.__assign)({},se),qe=0;qe<ae.length;qe+=1){ae[qe]=Ve(ae[qe],xe);var yn=ae[qe],Er=yn.length;xe.x1=+yn[Er-2],xe.y1=+yn[Er-1],xe.x2=+yn[Er-4]||xe.x1,xe.y2=+yn[Er-3]||xe.y1}return ae}function Ft(Dt){return Qt(Dt)&&Dt.every(function(ae){var xe=ae[0];return"MC".includes(xe)})}function bt(Dt,ae,xe){var qe=Dt*Math.cos(xe)-ae*Math.sin(xe),yn=Dt*Math.sin(xe)+ae*Math.cos(xe);return{x:qe,y:yn}}function Me(Dt,ae,xe,qe,yn,Er,Cr,oa,Nn,Pa){var wi=Dt,Ui=ae,Ei=xe,Oo=qe,us=oa,Vo=Nn,uo=Math.PI*120/180,$o=Math.PI/180*(+yn||0),Si=[],ns,Xo,eo,qo,Ns;if(Pa)Xo=Pa[0],eo=Pa[1],qo=Pa[2],Ns=Pa[3];else{ns=bt(wi,Ui,-$o),wi=ns.x,Ui=ns.y,ns=bt(us,Vo,-$o),us=ns.x,Vo=ns.y;var lu=(wi-us)/2,ls=(Ui-Vo)/2,ks=lu*lu/(Ei*Ei)+ls*ls/(Oo*Oo);ks>1&&(ks=Math.sqrt(ks),Ei*=ks,Oo*=ks);var Ou=Ei*Ei,lr=Oo*Oo,ll=(Er===Cr?-1:1)*Math.sqrt(Math.abs((Ou*lr-Ou*ls*ls-lr*lu*lu)/(Ou*ls*ls+lr*lu*lu)));qo=ll*Ei*ls/Oo+(wi+us)/2,Ns=ll*-Oo*lu/Ei+(Ui+Vo)/2,Xo=Math.asin(((Ui-Ns)/Oo*Math.pow(10,9)>>0)/Math.pow(10,9)),eo=Math.asin(((Vo-Ns)/Oo*Math.pow(10,9)>>0)/Math.pow(10,9)),Xo=wi<qo?Math.PI-Xo:Xo,eo=us<qo?Math.PI-eo:eo,Xo<0&&(Xo=Math.PI*2+Xo),eo<0&&(eo=Math.PI*2+eo),Cr&&Xo>eo&&(Xo-=Math.PI*2),!Cr&&eo>Xo&&(eo-=Math.PI*2)}var mo=eo-Xo;if(Math.abs(mo)>uo){var Hf=eo,mc=us,Xc=Vo;eo=Xo+uo*(Cr&&eo>Xo?1:-1),us=qo+Ei*Math.cos(eo),Vo=Ns+Oo*Math.sin(eo),Si=Me(us,Vo,Ei,Oo,yn,0,Cr,mc,Xc,[eo,Hf,qo,Ns])}mo=eo-Xo;var Jl=Math.cos(Xo),Kl=Math.sin(Xo),Xf=Math.cos(eo),Hp=Math.sin(eo),mn=Math.tan(mo/4),Yc=4/3*Ei*mn,pp=4/3*Oo*mn,br=[wi,Ui],Yf=[wi+Yc*Kl,Ui-pp*Jl],Pf=[us+Yc*Hp,Vo-pp*Xf],Tc=[us,Vo];if(Yf[0]=2*br[0]-Yf[0],Yf[1]=2*br[1]-Yf[1],Pa)return Yf.concat(Pf,Tc,Si);Si=Yf.concat(Pf,Tc,Si);for(var yc=[],gf=0,nf=Si.length;gf<nf;gf+=1)yc[gf]=gf%2?bt(Si[gf-1],Si[gf],$o).y:bt(Si[gf],Si[gf+1],$o).x;return yc}function en(Dt,ae,xe,qe,yn,Er){var Cr=1/3,oa=2/3;return[Cr*Dt+oa*xe,Cr*ae+oa*qe,Cr*yn+oa*xe,Cr*Er+oa*qe,yn,Er]}function fn(Dt,ae,xe){var qe=Dt[0],yn=Dt[1],Er=ae[0],Cr=ae[1];return[qe+(Er-qe)*xe,yn+(Cr-yn)*xe]}function Rt(Dt,ae){return Math.sqrt((Dt[0]-ae[0])*(Dt[0]-ae[0])+(Dt[1]-ae[1])*(Dt[1]-ae[1]))}function Xn(Dt,ae,xe,qe,yn){var Er=Rt([Dt,ae],[xe,qe]),Cr={x:0,y:0};if(typeof yn=="number")if(yn<=0)Cr={x:Dt,y:ae};else if(yn>=Er)Cr={x:xe,y:qe};else{var oa=fn([Dt,ae],[xe,qe],yn/Er),Nn=oa[0],Pa=oa[1];Cr={x:Nn,y:Pa}}return{length:Er,point:Cr,min:{x:Math.min(Dt,xe),y:Math.min(ae,qe)},max:{x:Math.max(Dt,xe),y:Math.max(ae,qe)}}}function Bn(Dt,ae,xe,qe){var yn=.5,Er=[Dt,ae],Cr=[xe,qe],oa=fn(Er,Cr,yn),Nn=fn(Cr,oa,yn),Pa=fn(oa,Nn,yn),wi=fn(Nn,Pa,yn),Ui=fn(Pa,wi,yn),Ei=Xn(Er[0],Er[1],oa[0],oa[1],Pa[0]).point,Oo=Xn(Ui[0],Ui[1],wi[0],wi[1],Nn[0]).point;return[Ei.x,Ei.y,Oo.x,Oo.y,xe,qe]}function xr(Dt,ae){var xe=Dt[0],qe=Dt.slice(1).map(Number),yn=qe[0],Er=qe[1],Cr,oa=ae.x1,Nn=ae.y1,Pa=ae.x,wi=ae.y;switch("TQ".includes(xe)||(ae.qx=null,ae.qy=null),xe){case"M":return ae.x=yn,ae.y=Er,Dt;case"A":return Cr=[oa,Nn].concat(qe),["C"].concat(Me(Cr[0],Cr[1],Cr[2],Cr[3],Cr[4],Cr[5],Cr[6],Cr[7],Cr[8],Cr[9]));case"Q":return ae.qx=yn,ae.qy=Er,Cr=[oa,Nn].concat(qe),["C"].concat(en(Cr[0],Cr[1],Cr[2],Cr[3],Cr[4],Cr[5]));case"L":return["C"].concat(Bn(oa,Nn,yn,Er));case"Z":return oa===Pa&&Nn===wi?["C",oa,Nn,Pa,wi,Pa,wi]:["C"].concat(Bn(oa,Nn,Pa,wi));default:}return Dt}function dr(Dt,ae){if(ae===void 0&&(ae=!1),Ft(Dt)){var xe=pt(Dt);return ae?[xe,[]]:xe}for(var qe=ee(Dt),yn=(0,ue.__assign)({},se),Er=[],Cr="",oa=qe.length,Nn,Pa,wi=[],Ui=0;Ui<oa;Ui+=1){qe[Ui]&&(Cr=qe[Ui][0]),Er[Ui]=Cr;var Ei=xr(qe[Ui],yn);qe[Ui]=Ei,Le(qe,Er,Ui),oa=qe.length,Cr==="Z"&&wi.push(Ui),Nn=qe[Ui],Pa=Nn.length,yn.x1=+Nn[Pa-2],yn.y1=+Nn[Pa-1],yn.x2=+Nn[Pa-4]||yn.x1,yn.y2=+Nn[Pa-3]||yn.y1}return ae?[qe,wi]:qe}function Ur(Dt){var ae=Dt.slice(1).map(function(xe,qe,yn){return qe?yn[qe-1].slice(-2).concat(xe.slice(1)):Dt[0].slice(1).concat(xe.slice(1))}).map(function(xe){return xe.map(function(qe,yn){return xe[xe.length-yn-2*(1-yn%2)]})}).reverse();return[["M"].concat(ae[0].slice(0,2))].concat(ae.map(function(xe){return["C"].concat(xe.slice(2))}))}function fa(Dt,ae){var xe=Dt.x,qe=Dt.y,yn=ae.x,Er=ae.y,Cr=xe*yn+qe*Er,oa=Math.sqrt((Math.pow(xe,2)+Math.pow(qe,2))*(Math.pow(yn,2)+Math.pow(Er,2))),Nn=xe*Er-qe*yn<0?-1:1,Pa=Nn*Math.acos(Cr/oa);return Pa}function Ea(Dt,ae,xe,qe,yn,Er,Cr,oa,Nn,Pa){var wi=Math.abs,Ui=Math.sin,Ei=Math.cos,Oo=Math.sqrt,us=Math.PI,Vo=wi(xe),uo=wi(qe),$o=(yn%360+360)%360,Si=$o*(us/180);if(Dt===oa&&ae===Nn)return{x:Dt,y:ae};if(Vo===0||uo===0)return Xn(Dt,ae,oa,Nn,Pa).point;var ns=(Dt-oa)/2,Xo=(ae-Nn)/2,eo={x:Ei(Si)*ns+Ui(Si)*Xo,y:-Ui(Si)*ns+Ei(Si)*Xo},qo=Math.pow(eo.x,2)/Math.pow(Vo,2)+Math.pow(eo.y,2)/Math.pow(uo,2);qo>1&&(Vo*=Oo(qo),uo*=Oo(qo));var Ns=Math.pow(Vo,2)*Math.pow(uo,2)-Math.pow(Vo,2)*Math.pow(eo.y,2)-Math.pow(uo,2)*Math.pow(eo.x,2),lu=Math.pow(Vo,2)*Math.pow(eo.y,2)+Math.pow(uo,2)*Math.pow(eo.x,2),ls=Ns/lu;ls=ls<0?0:ls;var ks=(Er!==Cr?1:-1)*Oo(ls),Ou={x:ks*(Vo*eo.y/uo),y:ks*(-(uo*eo.x)/Vo)},lr={x:Ei(Si)*Ou.x-Ui(Si)*Ou.y+(Dt+oa)/2,y:Ui(Si)*Ou.x+Ei(Si)*Ou.y+(ae+Nn)/2},ll={x:(eo.x-Ou.x)/Vo,y:(eo.y-Ou.y)/uo},mo=fa({x:1,y:0},ll),Hf={x:(-eo.x-Ou.x)/Vo,y:(-eo.y-Ou.y)/uo},mc=fa(ll,Hf);!Cr&&mc>0?mc-=2*us:Cr&&mc<0&&(mc+=2*us),mc%=2*us;var Xc=mo+mc*Pa,Jl=Vo*Ei(Xc),Kl=uo*Ui(Xc),Xf={x:Ei(Si)*Jl-Ui(Si)*Kl+lr.x,y:Ui(Si)*Jl+Ei(Si)*Kl+lr.y};return Xf}function aa(Dt,ae,xe,qe,yn,Er,Cr,oa,Nn,Pa,wi){var Ui,Ei=wi.bbox,Oo=Ei===void 0?!0:Ei,us=wi.length,Vo=us===void 0?!0:us,uo=wi.sampleSize,$o=uo===void 0?30:uo,Si=typeof Pa=="number",ns=Dt,Xo=ae,eo=0,qo=[ns,Xo,eo],Ns=[ns,Xo],lu=0,ls={x:0,y:0},ks=[{x:ns,y:Xo}];Si&&Pa<=0&&(ls={x:ns,y:Xo});for(var Ou=0;Ou<=$o;Ou+=1){if(lu=Ou/$o,Ui=Ea(Dt,ae,xe,qe,yn,Er,Cr,oa,Nn,lu),ns=Ui.x,Xo=Ui.y,Oo&&ks.push({x:ns,y:Xo}),Vo&&(eo+=Rt(Ns,[ns,Xo])),Ns=[ns,Xo],Si&&eo>=Pa&&Pa>qo[2]){var lr=(eo-Pa)/(eo-qo[2]);ls={x:Ns[0]*(1-lr)+qo[0]*lr,y:Ns[1]*(1-lr)+qo[1]*lr}}qo=[ns,Xo,eo]}return Si&&Pa>=eo&&(ls={x:oa,y:Nn}),{length:eo,point:ls,min:{x:Math.min.apply(null,ks.map(function(ll){return ll.x})),y:Math.min.apply(null,ks.map(function(ll){return ll.y}))},max:{x:Math.max.apply(null,ks.map(function(ll){return ll.x})),y:Math.max.apply(null,ks.map(function(ll){return ll.y}))}}}function Da(Dt,ae,xe,qe,yn,Er,Cr,oa,Nn){var Pa=1-Nn;return{x:Math.pow(Pa,3)*Dt+3*Math.pow(Pa,2)*Nn*xe+3*Pa*Math.pow(Nn,2)*yn+Math.pow(Nn,3)*Cr,y:Math.pow(Pa,3)*ae+3*Math.pow(Pa,2)*Nn*qe+3*Pa*Math.pow(Nn,2)*Er+Math.pow(Nn,3)*oa}}function Lr(Dt,ae,xe,qe,yn,Er,Cr,oa,Nn,Pa){var wi,Ui=Pa.bbox,Ei=Ui===void 0?!0:Ui,Oo=Pa.length,us=Oo===void 0?!0:Oo,Vo=Pa.sampleSize,uo=Vo===void 0?10:Vo,$o=typeof Nn=="number",Si=Dt,ns=ae,Xo=0,eo=[Si,ns,Xo],qo=[Si,ns],Ns=0,lu={x:0,y:0},ls=[{x:Si,y:ns}];$o&&Nn<=0&&(lu={x:Si,y:ns});for(var ks=0;ks<=uo;ks+=1){if(Ns=ks/uo,wi=Da(Dt,ae,xe,qe,yn,Er,Cr,oa,Ns),Si=wi.x,ns=wi.y,Ei&&ls.push({x:Si,y:ns}),us&&(Xo+=Rt(qo,[Si,ns])),qo=[Si,ns],$o&&Xo>=Nn&&Nn>eo[2]){var Ou=(Xo-Nn)/(Xo-eo[2]);lu={x:qo[0]*(1-Ou)+eo[0]*Ou,y:qo[1]*(1-Ou)+eo[1]*Ou}}eo=[Si,ns,Xo]}return $o&&Nn>=Xo&&(lu={x:Cr,y:oa}),{length:Xo,point:lu,min:{x:Math.min.apply(null,ls.map(function(lr){return lr.x})),y:Math.min.apply(null,ls.map(function(lr){return lr.y}))},max:{x:Math.max.apply(null,ls.map(function(lr){return lr.x})),y:Math.max.apply(null,ls.map(function(lr){return lr.y}))}}}function _n(Dt,ae,xe,qe,yn,Er,Cr){var oa=1-Cr;return{x:Math.pow(oa,2)*Dt+2*oa*Cr*xe+Math.pow(Cr,2)*yn,y:Math.pow(oa,2)*ae+2*oa*Cr*qe+Math.pow(Cr,2)*Er}}function sr(Dt,ae,xe,qe,yn,Er,Cr,oa){var Nn,Pa=oa.bbox,wi=Pa===void 0?!0:Pa,Ui=oa.length,Ei=Ui===void 0?!0:Ui,Oo=oa.sampleSize,us=Oo===void 0?10:Oo,Vo=typeof Cr=="number",uo=Dt,$o=ae,Si=0,ns=[uo,$o,Si],Xo=[uo,$o],eo=0,qo={x:0,y:0},Ns=[{x:uo,y:$o}];Vo&&Cr<=0&&(qo={x:uo,y:$o});for(var lu=0;lu<=us;lu+=1){if(eo=lu/us,Nn=_n(Dt,ae,xe,qe,yn,Er,eo),uo=Nn.x,$o=Nn.y,wi&&Ns.push({x:uo,y:$o}),Ei&&(Si+=Rt(Xo,[uo,$o])),Xo=[uo,$o],Vo&&Si>=Cr&&Cr>ns[2]){var ls=(Si-Cr)/(Si-ns[2]);qo={x:Xo[0]*(1-ls)+ns[0]*ls,y:Xo[1]*(1-ls)+ns[1]*ls}}ns=[uo,$o,Si]}return Vo&&Cr>=Si&&(qo={x:yn,y:Er}),{length:Si,point:qo,min:{x:Math.min.apply(null,Ns.map(function(ks){return ks.x})),y:Math.min.apply(null,Ns.map(function(ks){return ks.y}))},max:{x:Math.max.apply(null,Ns.map(function(ks){return ks.x})),y:Math.max.apply(null,Ns.map(function(ks){return ks.y}))}}}function Pn(Dt,ae,xe){for(var qe,yn,Er,Cr,oa,Nn,Pa=ee(Dt),wi=typeof ae=="number",Ui,Ei=[],Oo,us=0,Vo=0,uo=0,$o=0,Si,ns=[],Xo=[],eo=0,qo={x:0,y:0},Ns=qo,lu=qo,ls=qo,ks=0,Ou=0,lr=Pa.length;Ou<lr;Ou+=1)Si=Pa[Ou],Oo=Si[0],Ui=Oo==="M",Ei=Ui?Ei:[us,Vo].concat(Si.slice(1)),Ui?(uo=Si[1],$o=Si[2],qo={x:uo,y:$o},Ns=qo,eo=0,wi&&ae<.001&&(ls=qo)):Oo==="L"?(qe=Xn(Ei[0],Ei[1],Ei[2],Ei[3],(ae||0)-ks),eo=qe.length,qo=qe.min,Ns=qe.max,lu=qe.point):Oo==="A"?(yn=aa(Ei[0],Ei[1],Ei[2],Ei[3],Ei[4],Ei[5],Ei[6],Ei[7],Ei[8],(ae||0)-ks,xe||{}),eo=yn.length,qo=yn.min,Ns=yn.max,lu=yn.point):Oo==="C"?(Er=Lr(Ei[0],Ei[1],Ei[2],Ei[3],Ei[4],Ei[5],Ei[6],Ei[7],(ae||0)-ks,xe||{}),eo=Er.length,qo=Er.min,Ns=Er.max,lu=Er.point):Oo==="Q"?(Cr=sr(Ei[0],Ei[1],Ei[2],Ei[3],Ei[4],Ei[5],(ae||0)-ks,xe||{}),eo=Cr.length,qo=Cr.min,Ns=Cr.max,lu=Cr.point):Oo==="Z"&&(Ei=[us,Vo,uo,$o],oa=Xn(Ei[0],Ei[1],Ei[2],Ei[3],(ae||0)-ks),eo=oa.length,qo=oa.min,Ns=oa.max,lu=oa.point),wi&&ks<ae&&ks+eo>=ae&&(ls=lu),Xo.push(Ns),ns.push(qo),ks+=eo,Nn=Oo!=="Z"?Si.slice(-2):[uo,$o],us=Nn[0],Vo=Nn[1];return wi&&ae>=ks&&(ls={x:us,y:Vo}),{length:ks,point:ls,min:{x:Math.min.apply(null,ns.map(function(ll){return ll.x})),y:Math.min.apply(null,ns.map(function(ll){return ll.y}))},max:{x:Math.max.apply(null,Xo.map(function(ll){return ll.x})),y:Math.max.apply(null,Xo.map(function(ll){return ll.y}))}}}function tr(Dt,ae){if(!Dt)return{x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};var xe=Pn(Dt,void 0,(0,ue.__assign)((0,ue.__assign)({},ae),{length:!1})),qe=xe.min,yn=qe.x,Er=qe.y,Cr=xe.max,oa=Cr.x,Nn=Cr.y,Pa=oa-yn,wi=Nn-Er;return{width:Pa,height:wi,x:yn,y:Er,x2:oa,y2:Nn,cx:yn+Pa/2,cy:Er+wi/2,cz:Math.max(Pa,wi)+Math.min(Pa,wi)/2}}function zn(Dt,ae){return Pn(Dt,void 0,(0,ue.__assign)((0,ue.__assign)({},ae),{bbox:!1,length:!0})).length}function Wr(Dt,ae){if(!Dt)return{length:0,x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};var xe=Pn(Dt,void 0,(0,ue.__assign)((0,ue.__assign)({},ae),{bbox:!0,length:!0})),qe=xe.length,yn=xe.min,Er=yn.x,Cr=yn.y,oa=xe.max,Nn=oa.x,Pa=oa.y,wi=Nn-Er,Ui=Pa-Cr;return{length:qe,width:wi,height:Ui,x:Er,y:Cr,x2:Nn,y2:Pa,cx:Er+wi/2,cy:Cr+Ui/2,cz:Math.max(wi,Ui)+Math.min(wi,Ui)/2}}function Yr(Dt){var ae=Dt.length,xe=ae-1;return Dt.map(function(qe,yn){return Dt.map(function(Er,Cr){var oa=yn+Cr,Nn;return Cr===0||Dt[oa]&&Dt[oa][0]==="M"?(Nn=Dt[oa],["M"].concat(Nn.slice(-2))):(oa>=ae&&(oa-=xe),Dt[oa])})})}function nr(Dt,ae){var xe=Dt.length-1,qe=[],yn=0,Er=0,Cr=Yr(Dt);return Cr.forEach(function(oa,Nn){Dt.slice(1).forEach(function(Pa,wi){Er+=Rt(Dt[(Nn+wi)%xe].slice(-2),ae[wi%xe].slice(-2))}),qe[Nn]=Er,Er=0}),yn=qe.indexOf(Math.min.apply(null,qe)),Cr[yn]}function wr(Dt,ae,xe,qe,yn,Er,Cr,oa){return 3*((oa-ae)*(xe+yn)-(Cr-Dt)*(qe+Er)+qe*(Dt-yn)-xe*(ae-Er)+oa*(yn+Dt/3)-Cr*(Er+ae/3))/20}function Sr(Dt){var ae=0,xe=0,qe=0;return dr(Dt).map(function(yn){var Er;switch(yn[0]){case"M":return ae=yn[1],xe=yn[2],0;default:var Cr=yn.slice(1),oa=Cr[0],Nn=Cr[1],Pa=Cr[2],wi=Cr[3],Ui=Cr[4],Ei=Cr[5];return qe=wr(ae,xe,oa,Nn,Pa,wi,Ui,Ei),Er=yn.slice(-2),ae=Er[0],xe=Er[1],qe}}).reduce(function(yn,Er){return yn+Er},0)}function pr(Dt){return Sr(Dt)>=0}function qr(Dt,ae,xe){return Pn(Dt,ae,(0,ue.__assign)((0,ue.__assign)({},xe),{bbox:!1,length:!0})).point}function ua(Dt,ae){var xe=te(Dt);if(typeof xe=="string")throw TypeError(xe);var qe=xe.slice(),yn=zn(qe),Er=qe.length-1,Cr=0,oa=0,Nn=xe[0],Pa=Nn.slice(-2),wi=Pa[0],Ui=Pa[1],Ei={x:wi,y:Ui};if(Er<=0||!ae||!Number.isFinite(ae))return{segment:Nn,index:0,length:oa,point:Ei,lengthAtSegment:Cr};if(ae>=yn)return qe=xe.slice(0,-1),Cr=zn(qe),oa=yn-Cr,{segment:xe[Er],index:Er,length:oa,lengthAtSegment:Cr};for(var Oo=[];Er>0;)Nn=qe[Er],qe=qe.slice(0,-1),Cr=zn(qe),oa=yn-Cr,yn=Cr,Oo.push({segment:Nn,index:Er,length:oa,lengthAtSegment:Cr}),Er-=1;return Oo.find(function(us){var Vo=us.lengthAtSegment;return Vo<=ae})}function $r(Dt,ae){for(var xe=te(Dt),qe=ee(xe),yn=zn(xe),Er=function(eo){var qo=eo.x-ae.x,Ns=eo.y-ae.y;return qo*qo+Ns*Ns},Cr=8,oa,Nn=0,Pa,wi=0,Ui=Infinity,Ei=0;Ei<=yn;Ei+=Cr)oa=qr(qe,Ei),Nn=Er(oa),Nn<Ui&&(Pa=oa,wi=Ei,Ui=Nn);Cr/=2;for(var Oo,us,Vo=0,uo=0,$o=0,Si=0;Cr>.5;)Vo=wi-Cr,Oo=qr(qe,Vo),$o=Er(Oo),uo=wi+Cr,us=qr(qe,uo),Si=Er(us),Vo>=0&&$o<Ui?(Pa=Oo,wi=Vo,Ui=$o):uo<=yn&&Si<Ui?(Pa=us,wi=uo,Ui=Si):Cr/=2;var ns=ua(xe,wi),Xo=Math.sqrt(Ui);return{closest:Pa,distance:Xo,segment:ns}}function ba(Dt,ae){var xe=$r(Dt,ae).distance;return Math.abs(xe)<.001}function gt(Dt,ae){ae===void 0&&(ae=.5);var xe=Dt.slice(0,2),qe=Dt.slice(2,4),yn=Dt.slice(4,6),Er=Dt.slice(6,8),Cr=fn(xe,qe,ae),oa=fn(qe,yn,ae),Nn=fn(yn,Er,ae),Pa=fn(Cr,oa,ae),wi=fn(oa,Nn,ae),Ui=fn(Pa,wi,ae);return[["C"].concat(Cr,Pa,Ui),["C"].concat(wi,Nn,Er)]}function Dn(Dt){return Dt.map(function(ae,xe,qe){var yn=xe&&qe[xe-1].slice(-2).concat(ae.slice(1)),Er=xe?Lr(yn[0],yn[1],yn[2],yn[3],yn[4],yn[5],yn[6],yn[7],yn[8],{bbox:!1}).length:0,Cr;return xe?Cr=Er?gt(yn):[ae,ae]:Cr=[ae],{s:ae,ss:Cr,l:Er}})}function un(Dt,ae,xe){var qe=Dn(Dt),yn=Dn(ae),Er=qe.length,Cr=yn.length,oa=qe.filter(function(uo){return uo.l}).length,Nn=yn.filter(function(uo){return uo.l}).length,Pa=qe.filter(function(uo){return uo.l}).reduce(function(uo,$o){var Si=$o.l;return uo+Si},0)/oa||0,wi=yn.filter(function(uo){return uo.l}).reduce(function(uo,$o){var Si=$o.l;return uo+Si},0)/Nn||0,Ui=xe||Math.max(Er,Cr),Ei=[Pa,wi],Oo=[Ui-Er,Ui-Cr],us=0,Vo=[qe,yn].map(function(uo,$o){return uo.l===Ui?uo.map(function(Si){return Si.s}):uo.map(function(Si,ns){return us=ns&&Oo[$o]&&Si.l>=Ei[$o],Oo[$o]-=us?1:0,us?Si.ss:[Si.s]}).flat()});return Vo[0].length===Vo[1].length?Vo:un(Vo[0],Vo[1],Ui)}var Lt=function(Dt){return Dt!==null&&typeof Dt!="function"&&isFinite(Dt.length)},Ot=Lt,it=function(Dt,ae){return Ot(Dt)?Dt.indexOf(ae)>-1:!1},H=it,X=function(Dt,ae){if(!Ot(Dt))return Dt;for(var xe=[],qe=0;qe<Dt.length;qe++){var yn=Dt[qe];ae(yn,qe)&&xe.push(yn)}return xe},xt=X,zt=function(Dt,ae){return ae===void 0&&(ae=[]),xt(Dt,function(xe){return!H(ae,xe)})},Vt=zt,Xt=function(Dt){return typeof Dt=="function"},ne=function(Dt){return Dt==null},on=ne,tn={}.toString,He=function(Dt,ae){return tn.call(Dt)==="[object "+ae+"]"},Qn=He,Ln=function(Dt){return Array.isArray?Array.isArray(Dt):Qn(Dt,"Array")},Qr=function(Dt){var ae=typeof Dt;return Dt!==null&&ae==="object"||ae==="function"};function Ia(Dt,ae){if(!!Dt){var xe;if(Ln(Dt))for(var qe=0,yn=Dt.length;qe<yn&&(xe=ae(Dt[qe],qe),xe!==!1);qe++);else if(Qr(Dt)){for(var Er in Dt)if(Dt.hasOwnProperty(Er)&&(xe=ae(Dt[Er],Er),xe===!1))break}}}var Jn=Ia,Ar=Object.keys?function(Dt){return Object.keys(Dt)}:function(Dt){var ae=[];return Jn(Dt,function(xe,qe){Xt(Dt)&&qe==="prototype"||ae.push(qe)}),ae},na=Ar;function za(Dt,ae){var xe=na(ae),qe=xe.length;if(on(Dt))return!qe;for(var yn=0;yn<qe;yn+=1){var Er=xe[yn];if(ae[Er]!==Dt[Er]||!(Er in Dt))return!1}return!0}var da=za,Ti=function(Dt){return typeof Dt=="object"&&Dt!==null},ki=Ti,vi=function(Dt){if(!ki(Dt)||!Qn(Dt,"Object"))return!1;if(Object.getPrototypeOf(Dt)===null)return!0;for(var ae=Dt;Object.getPrototypeOf(ae)!==null;)ae=Object.getPrototypeOf(ae);return Object.getPrototypeOf(Dt)===ae},ii=vi;function Di(Dt,ae){if(!Ln(Dt))return null;var xe;if(Xt(ae)&&(xe=ae),ii(ae)&&(xe=function(yn){return da(yn,ae)}),xe){for(var qe=0;qe<Dt.length;qe+=1)if(xe(Dt[qe]))return Dt[qe]}return null}var Ra=Di;function ln(Dt,ae,xe){xe===void 0&&(xe=0);for(var qe=xe;qe<Dt.length;qe++)if(ae(Dt[qe],qe))return qe;return-1}var De=ln,dn=function(Dt,ae){for(var xe=null,qe=0;qe<Dt.length;qe++){var yn=Dt[qe],Er=yn[ae];if(!on(Er)){Ln(Er)?xe=Er[0]:xe=Er;break}}return xe},Wn=dn,Gn=function(Dt){if(!Ln(Dt))return[];for(var ae=[],xe=0;xe<Dt.length;xe++)ae=ae.concat(Dt[xe]);return ae},Kn=Gn,Rr=function(Dt,ae){if(ae===void 0&&(ae=[]),!Ln(Dt))ae.push(Dt);else for(var xe=0;xe<Dt.length;xe+=1)Rr(Dt[xe],ae);return ae},xa=Rr,La=function(Dt){if(!!Ln(Dt))return Dt.reduce(function(ae,xe){return Math.max(ae,xe)},Dt[0])},ui=function(Dt){if(!!Ln(Dt))return Dt.reduce(function(ae,xe){return Math.min(ae,xe)},Dt[0])},Fi=function(Dt){var ae=Dt.filter(function(Cr){return!isNaN(Cr)});if(!ae.length)return{min:0,max:0};if(Ln(Dt[0])){for(var xe=[],qe=0;qe<Dt.length;qe++)xe=xe.concat(Dt[qe]);ae=xe}var yn=La(ae),Er=ui(ae);return{min:Er,max:yn}},Ki=Fi,xo=Array.prototype,vo=xo.splice,es=xo.indexOf,Wo=function(Dt){for(var ae=[],xe=1;xe<arguments.length;xe++)ae[xe-1]=arguments[xe];for(var qe=0;qe<ae.length;qe++)for(var yn=ae[qe],Er=-1;(Er=es.call(Dt,yn))>-1;)vo.call(Dt,Er,1);return Dt},Zi=Wo,bi=Array.prototype.splice,gi=function(ae,xe){if(!Ot(ae))return[];for(var qe=ae?xe.length:0,yn=qe-1;qe--;){var Er=void 0,Cr=xe[qe];(qe===yn||Cr!==Er)&&(Er=Cr,bi.call(ae,Cr,1))}return ae},ms=gi,Do=function(Dt,ae,xe){if(!Ln(Dt)&&!ii(Dt))return Dt;var qe=xe;return Jn(Dt,function(yn,Er){qe=ae(qe,yn,Er)}),qe},To=Do,Zs=function(Dt,ae){var xe=[];if(!Ot(Dt))return xe;for(var qe=-1,yn=[],Er=Dt.length;++qe<Er;){var Cr=Dt[qe];ae(Cr,qe,Dt)&&(xe.push(Cr),yn.push(qe))}return ms(Dt,yn),xe},Eu=Zs,as=function(Dt){return Qn(Dt,"String")};function Rs(Dt,ae){var xe;if(Xt(ae))xe=function(yn,Er){return ae(yn)-ae(Er)};else{var qe=[];as(ae)?qe.push(ae):Ln(ae)&&(qe=ae),xe=function(yn,Er){for(var Cr=0;Cr<qe.length;Cr+=1){var oa=qe[Cr];if(yn[oa]>Er[oa])return 1;if(yn[oa]<Er[oa])return-1}return 0}}return Dt.sort(xe),Dt}var Su=Rs;function fu(Dt,ae){ae===void 0&&(ae=new Map);var xe=[];if(Array.isArray(Dt))for(var qe=0,yn=Dt.length;qe<yn;qe++){var Er=Dt[qe];ae.has(Er)||(xe.push(Er),ae.set(Er,!0))}return xe}var Is=function(){for(var Dt=[],ae=0;ae<arguments.length;ae++)Dt[ae]=arguments[ae];return fu([].concat.apply([],Dt))},Zo=Is,Wi=function(Dt,ae){for(var xe=[],qe={},yn=0;yn<Dt.length;yn++){var Er=Dt[yn],Cr=Er[ae];if(!on(Cr)){Ln(Cr)||(Cr=[Cr]);for(var oa=0;oa<Cr.length;oa++){var Nn=Cr[oa];qe[Nn]||(xe.push(Nn),qe[Nn]=!0)}}}return xe};function ys(Dt){if(Ot(Dt))return Dt[0]}function is(Dt){if(Ot(Dt)){var ae=Dt;return ae[ae.length-1]}}function Us(Dt,ae){return Ln(Dt)||as(Dt)?Dt[0]===ae:!1}var Du=Us;function qs(Dt,ae){return Ln(Dt)||as(Dt)?Dt[Dt.length-1]===ae:!1}var Cu=qs,ji=function(Dt,ae){for(var xe=0;xe<Dt.length;xe++)if(!ae(Dt[xe],xe))return!1;return!0},Bi=ji,Ms=function(Dt,ae){for(var xe=0;xe<Dt.length;xe++)if(ae(Dt[xe],xe))return!0;return!1},os=Ms,Ws=Object.prototype.hasOwnProperty;function Ss(Dt,ae){if(!ae||!Ln(Dt))return{};for(var xe={},qe=Xt(ae)?ae:function(oa){return oa[ae]},yn,Er=0;Er<Dt.length;Er++){var Cr=Dt[Er];yn=qe(Cr),Ws.call(xe,yn)?xe[yn].push(Cr):xe[yn]=[Cr]}return xe}var Qs=Ss;function Qu(Dt,ae){if(!ae)return{0:Dt};if(!Xt(ae)){var xe=Ln(ae)?ae:ae.replace(/\s+/g,"").split("*");ae=function(qe){for(var yn="_",Er=0,Cr=xe.length;Er<Cr;Er++)yn+=qe[xe[Er]]&&qe[xe[Er]].toString();return yn}}return Qs(Dt,ae)}var xn=function(Dt,ae){if(!ae)return[Dt];var xe=Qu(Dt,ae),qe=[];for(var yn in xe)qe.push(xe[yn]);return qe};function Vr(Dt,ae){return Dt["_wrap_"+ae]}var pa=Vr;function Fa(Dt,ae){if(Dt["_wrap_"+ae])return Dt["_wrap_"+ae];var xe=function(qe){Dt[ae](qe)};return Dt["_wrap_"+ae]=xe,xe}var Vi=Fa,Ao={};function ao(Dt){var ae=Ao[Dt];if(!ae){for(var xe=Dt.toString(16),qe=xe.length;qe<6;qe++)xe="0"+xe;ae="#"+xe,Ao[Dt]=ae}return ae}var So=ao;function Ts(Dt){var ae=0,xe=0,qe=0,yn=0;return Ln(Dt)?Dt.length===1?ae=xe=qe=yn=Dt[0]:Dt.length===2?(ae=qe=Dt[0],xe=yn=Dt[1]):Dt.length===3?(ae=Dt[0],xe=yn=Dt[1],qe=Dt[2]):(ae=Dt[0],xe=Dt[1],qe=Dt[2],yn=Dt[3]):ae=xe=qe=yn=Dt,{r1:ae,r2:xe,r3:qe,r4:yn}}var fo=Ts,ou=function(Dt,ae,xe){return Dt<ae?ae:Dt>xe?xe:Dt},Cs=ou,Au=function(Dt,ae){var xe=ae.toString(),qe=xe.indexOf(".");if(qe===-1)return Math.round(Dt);var yn=xe.substr(qe+1).length;return yn>20&&(yn=20),parseFloat(Dt.toFixed(yn))},Tl=Au,bl=function(Dt){return Qn(Dt,"Number")},Js=bl,ul=function(Dt){return Js(Dt)&&Dt%1!=0},Mu=ul,Pu=function(Dt){return Js(Dt)&&Dt%2==0},Nu=Pu,fs=Number.isInteger?Number.isInteger:function(Dt){return Js(Dt)&&Dt%1==0},Bs=fs,gu=function(Dt){return Js(Dt)&&Dt<0},Fu=gu,Wu=1e-5;function Ju(Dt,ae,xe){return xe===void 0&&(xe=Wu),Math.abs(Dt-ae)<xe}var tu=function(Dt){return Js(Dt)&&Dt%2!=0},gc=tu,Bl=function(Dt){return Js(Dt)&&Dt>0},vl=Bl,Ls=function(Dt,ae){if(!!Ln(Dt)){for(var xe,qe=-Infinity,yn=0;yn<Dt.length;yn++){var Er=Dt[yn],Cr=Xt(ae)?ae(Er):Er[ae];Cr>qe&&(xe=Er,qe=Cr)}return xe}},el=function(Dt,ae){if(!!Ln(Dt)){for(var xe,qe=Infinity,yn=0;yn<Dt.length;yn++){var Er=Dt[yn],Cr=Xt(ae)?ae(Er):Er[ae];Cr<qe&&(xe=Er,qe=Cr)}return xe}},oc=function(Dt,ae){return(Dt%ae+ae)%ae},Ol=oc,Ic=180/Math.PI,Se=function(Dt){return Ic*Dt},ve=Se,Gt=parseInt,re=Math.PI/180,me=function(Dt){return re*Dt},bn=me,Zn=Jn,Yt=function(Dt,ae){return Dt.hasOwnProperty(ae)},Ie=Yt,Ge=Object.values?function(Dt){return Object.values(Dt)}:function(Dt){var ae=[];return Jn(Dt,function(xe,qe){Xt(Dt)&&qe==="prototype"||ae.push(xe)}),ae},Fe=Ge,In=function(Dt,ae){return H(Fe(Dt),ae)},ar=function(Dt){return on(Dt)?"":Dt.toString()},ra=function(Dt){return ar(Dt).toLowerCase()},Ta=ra,$a=function(Dt){var ae=ar(Dt);return ae.charAt(0).toLowerCase()+ae.substring(1)},ja=$a;function Oa(Dt,ae){return!Dt||!ae?Dt:Dt.replace(/\\?\{([^{}]+)\}/g,function(xe,qe){return xe.charAt(0)==="\\"?xe.slice(1):ae[qe]===void 0?"":ae[qe]})}var so=Oa,Ai=function(Dt){return ar(Dt).toUpperCase()},Oi=Ai,hs=function(Dt){var ae=ar(Dt);return ae.charAt(0).toUpperCase()+ae.substring(1)},wo=hs,ho={}.toString,Ro=function(Dt){return ho.call(Dt).replace(/^\[object /,"").replace(/]$/,"")},Ys=Ro,Ps=function(Dt){return Qn(Dt,"Arguments")},As=Ps,Vs=function(Dt){return Qn(Dt,"Boolean")},su=Vs,xl=function(Dt){return Qn(Dt,"Date")},Rl=xl,Ll=function(Dt){return Qn(Dt,"Error")},nl=Ll;function rl(Dt){return Js(Dt)&&isFinite(Dt)}var Ef=function(Dt){return Dt===null},Sf=Ef,Yl=Object.prototype,Cf=function(Dt){var ae=Dt&&Dt.constructor,xe=typeof ae=="function"&&ae.prototype||Yl;return Dt===xe},T=Cf,rt=function(Dt){return Qn(Dt,"RegExp")},Kt=rt,pe=function(Dt){return Dt===void 0},Re=pe,Je=function(Dt){return Dt instanceof Element||Dt instanceof HTMLDocument},an=Je;function wn(Dt){var ae=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(xe){return setTimeout(xe,16)};return ae(Dt)}function Mn(Dt){var ae=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;ae(Dt)}function rr(Dt,ae){for(var xe in ae)ae.hasOwnProperty(xe)&&xe!=="constructor"&&ae[xe]!==void 0&&(Dt[xe]=ae[xe])}function We(Dt,ae,xe,qe){return ae&&rr(Dt,ae),xe&&rr(Dt,xe),qe&&rr(Dt,qe),Dt}var ca=function(){for(var Dt=[],ae=0;ae<arguments.length;ae++)Dt[ae]=arguments[ae];for(var xe=Dt[0],qe=1;qe<Dt.length;qe++){var yn=Dt[qe];Xt(yn)&&(yn=yn.prototype),We(xe.prototype,yn)}},ha=ca,_r=function(Dt){if(typeof Dt!="object"||Dt===null)return Dt;var ae;if(Ln(Dt)){ae=[];for(var xe=0,qe=Dt.length;xe<qe;xe++)typeof Dt[xe]=="object"&&Dt[xe]!=null?ae[xe]=_r(Dt[xe]):ae[xe]=Dt[xe]}else{ae={};for(var yn in Dt)typeof Dt[yn]=="object"&&Dt[yn]!=null?ae[yn]=_r(Dt[yn]):ae[yn]=Dt[yn]}return ae},Va=_r;function qa(Dt,ae,xe){var qe;return function(){var yn=this,Er=arguments,Cr=function(){qe=null,xe||Dt.apply(yn,Er)},oa=xe&&!qe;clearTimeout(qe),qe=setTimeout(Cr,ae),oa&&Dt.apply(yn,Er)}}var ma=qa,Mi=function(Dt,ae){if(!Xt(Dt))throw new TypeError("Expected a function");var xe=function(){for(var qe=[],yn=0;yn<arguments.length;yn++)qe[yn]=arguments[yn];var Er=ae?ae.apply(this,qe):qe[0],Cr=xe.cache;if(Cr.has(Er))return Cr.get(Er);var oa=Dt.apply(this,qe);return Cr.set(Er,oa),oa};return xe.cache=new Map,xe},zo=5;function _o(Dt,ae,xe,qe){xe=xe||0,qe=qe||zo;for(var yn in ae)if(ae.hasOwnProperty(yn)){var Er=ae[yn];Er!==null&&ii(Er)?(ii(Dt[yn])||(Dt[yn]={}),xe<qe?_o(Dt[yn],Er,xe+1,qe):Dt[yn]=ae[yn]):Ln(Er)?(Dt[yn]=[],Dt[yn]=Dt[yn].concat(Er)):Er!==void 0&&(Dt[yn]=Er)}}var Lo=function(Dt){for(var ae=[],xe=1;xe<arguments.length;xe++)ae[xe-1]=arguments[xe];for(var qe=0;qe<ae.length;qe+=1)_o(Dt,ae[qe]);return Dt},yo=Lo,No=function(Dt,ae,xe,qe){Xt(ae)||(xe=ae,ae=Dt,Dt=function(){});var yn=Object.create?function(Cr,oa){return Object.create(Cr,{constructor:{value:oa}})}:function(Cr,oa){function Nn(){}Nn.prototype=Cr;var Pa=new Nn;return Pa.constructor=oa,Pa},Er=yn(ae.prototype,Dt);return Dt.prototype=We(Er,Dt.prototype),Dt.superclass=yn(ae.prototype,ae),We(Er,xe),We(Dt,qe),Dt},Vu=No,Bu=function(Dt,ae){if(!Ot(Dt))return-1;var xe=Array.prototype.indexOf;if(xe)return xe.call(Dt,ae);for(var qe=-1,yn=0;yn<Dt.length;yn++)if(Dt[yn]===ae){qe=yn;break}return qe},ju=Bu,tl=Object.prototype.hasOwnProperty;function Hu(Dt){if(on(Dt))return!0;if(Ot(Dt))return!Dt.length;var ae=Ys(Dt);if(ae==="Map"||ae==="Set")return!Dt.size;if(T(Dt))return!Object.keys(Dt).length;for(var xe in Dt)if(tl.call(Dt,xe))return!1;return!0}var al=Hu,il=function(Dt,ae){if(Dt===ae)return!0;if(!Dt||!ae||as(Dt)||as(ae))return!1;if(Ot(Dt)||Ot(ae)){if(Dt.length!==ae.length)return!1;for(var xe=!0,qe=0;qe<Dt.length&&(xe=il(Dt[qe],ae[qe]),!!xe);qe++);return xe}if(ki(Dt)||ki(ae)){var yn=Object.keys(Dt),Er=Object.keys(ae);if(yn.length!==Er.length)return!1;for(var xe=!0,qe=0;qe<yn.length&&(xe=il(Dt[yn[qe]],ae[yn[qe]]),!!xe);qe++);return xe}return!1},ds=il,uu=function(Dt,ae,xe){return Xt(xe)?!!xe(Dt,ae):ds(Dt,ae)},Jc=function(Dt,ae){if(!Ot(Dt))return Dt;for(var xe=[],qe=0;qe<Dt.length;qe++){var yn=Dt[qe];xe.push(ae(yn,qe))}return xe},tf=Jc,zl=function(Dt){return Dt},wl=function(Dt,ae){ae===void 0&&(ae=zl);var xe={};return Qr(Dt)&&!on(Dt)&&Object.keys(Dt).forEach(function(qe){xe[qe]=ae(Dt[qe],qe)}),xe},hh=function(Dt,ae,xe){for(var qe=0,yn=as(ae)?ae.split("."):ae;Dt&&qe<yn.length;)Dt=Dt[yn[qe++]];return Dt===void 0||qe<yn.length?xe:Dt},Nd=function(Dt,ae,xe){var qe=Dt,yn=as(ae)?ae.split("."):ae;return yn.forEach(function(Er,Cr){Cr<yn.length-1?(Qr(qe[Er])||(qe[Er]=Js(yn[Cr+1])?[]:{}),qe=qe[Er]):qe[Er]=xe}),Dt},fp=Object.prototype.hasOwnProperty,Vp=function(Dt,ae){if(Dt===null||!ii(Dt))return{};var xe={};return Jn(ae,function(qe){fp.call(Dt,qe)&&(xe[qe]=Dt[qe])}),xe},dh=function(Dt,ae){return To(Dt,function(xe,qe,yn){return ae.includes(yn)||(xe[yn]=qe),xe},{})},kd=function(Dt,ae,xe){var qe,yn,Er,Cr,oa=0;xe||(xe={});var Nn=function(){oa=xe.leading===!1?0:Date.now(),qe=null,Cr=Dt.apply(yn,Er),qe||(yn=Er=null)},Pa=function(){var wi=Date.now();!oa&&xe.leading===!1&&(oa=wi);var Ui=ae-(wi-oa);return yn=this,Er=arguments,Ui<=0||Ui>ae?(qe&&(clearTimeout(qe),qe=null),oa=wi,Cr=Dt.apply(yn,Er),qe||(yn=Er=null)):!qe&&xe.trailing!==!1&&(qe=setTimeout(Nn,Ui)),Cr};return Pa.cancel=function(){clearTimeout(qe),oa=0,qe=yn=Er=null},Pa},jp=function(Dt){return Ot(Dt)?Array.prototype.slice.call(Dt):[]},df={},Rf=function(Dt){return Dt=Dt||"g",df[Dt]?df[Dt]+=1:df[Dt]=1,Dt+df[Dt]},hp=function(){},jf=function(Dt){return Dt};function pf(Dt){return on(Dt)?0:Ot(Dt)?Dt.length:Object.keys(Dt).length}var ph=function(){function Dt(){this.map={}}return Dt.prototype.has=function(ae){return this.map[ae]!==void 0},Dt.prototype.get=function(ae,xe){var qe=this.map[ae];return qe===void 0?xe:qe},Dt.prototype.set=function(ae,xe){this.map[ae]=xe},Dt.prototype.clear=function(){this.map={}},Dt.prototype.delete=function(ae){delete this.map[ae]},Dt.prototype.size=function(){return Object.keys(this.map).length},Dt}(),Ri=ph,Lh=1e-6;function bs(Dt){return Math.abs(Dt)<Lh?0:Dt<0?-1:1}function Ph(Dt,ae,xe){return(xe[0]-Dt[0])*(ae[1]-Dt[1])==(ae[0]-Dt[0])*(xe[1]-Dt[1])&&Math.min(Dt[0],ae[0])<=xe[0]&&xe[0]<=Math.max(Dt[0],ae[0])&&Math.min(Dt[1],ae[1])<=xe[1]&&xe[1]<=Math.max(Dt[1],ae[1])}function sc(Dt,ae,xe){var qe=!1,yn=Dt.length;if(yn<=2)return!1;for(var Er=0;Er<yn;Er++){var Cr=Dt[Er],oa=Dt[(Er+1)%yn];if(Ph(Cr,oa,[ae,xe]))return!0;bs(Cr[1]-xe)>0!=bs(oa[1]-xe)>0&&bs(ae-(xe-Cr[1])*(Cr[0]-oa[0])/(Cr[1]-oa[1])-Cr[0])<0&&(qe=!qe)}return qe}var ef=function(Dt,ae,xe){return Dt>=ae&&Dt<=xe};function vf(Dt,ae,xe,qe){var yn=.001,Er={x:xe.x-Dt.x,y:xe.y-Dt.y},Cr={x:ae.x-Dt.x,y:ae.y-Dt.y},oa={x:qe.x-xe.x,y:qe.y-xe.y},Nn=Cr.x*oa.y-Cr.y*oa.x,Pa=Nn*Nn,wi=Cr.x*Cr.x+Cr.y*Cr.y,Ui=oa.x*oa.x+oa.y*oa.y,Ei=null;if(Pa>yn*wi*Ui){var Oo=(Er.x*oa.y-Er.y*oa.x)/Nn,us=(Er.x*Cr.y-Er.y*Cr.x)/Nn;ef(Oo,0,1)&&ef(us,0,1)&&(Ei={x:Dt.x+Oo*Cr.x,y:Dt.y+Oo*Cr.y})}return Ei}function vh(Dt){for(var ae=[],xe=Dt.length,qe=0;qe<xe-1;qe++){var yn=Dt[qe],Er=Dt[qe+1];ae.push({from:{x:yn[0],y:yn[1]},to:{x:Er[0],y:Er[1]}})}if(ae.length>1){var Cr=Dt[0],oa=Dt[xe-1];ae.push({from:{x:oa[0],y:oa[1]},to:{x:Cr[0],y:Cr[1]}})}return ae}function Lf(Dt,ae){var xe=!1;return Dt.forEach(function(qe){if(vf(qe.from,qe.to,ae.from,ae.to))return xe=!0,!1}),xe}function js(Dt){var ae=Dt.map(function(qe){return qe[0]}),xe=Dt.map(function(qe){return qe[1]});return{minX:Math.min.apply(null,ae),maxX:Math.max.apply(null,ae),minY:Math.min.apply(null,xe),maxY:Math.max.apply(null,xe)}}function dp(Dt,ae){return!(ae.minX>Dt.maxX||ae.maxX<Dt.minX||ae.minY>Dt.maxY||ae.maxY<Dt.minY)}function Pl(Dt,ae){if(Dt.length<2||ae.length<2)return!1;var xe=js(Dt),qe=js(ae);if(!dp(xe,qe))return!1;var yn=!1;if(ae.forEach(function(Nn){if(sc(Dt,Nn[0],Nn[1]))return yn=!0,!1}),yn||(Dt.forEach(function(Nn){if(sc(ae,Nn[0],Nn[1]))return yn=!0,!1}),yn))return!0;var Er=vh(Dt),Cr=vh(ae),oa=!1;return Cr.forEach(function(Nn){if(Lf(Er,Nn))return oa=!0,!1}),oa}},76749:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{quadtree:function(){return Y.Z}});var Y=$(88863)},88863:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return yt}});function Y(mt){const wt=+this._x.call(null,mt),ut=+this._y.call(null,mt);return tt(this.cover(wt,ut),wt,ut,mt)}function tt(mt,wt,ut,pt){if(isNaN(wt)||isNaN(ut))return mt;var Nt,Ut=mt._root,ue={data:pt},se=mt._x0,Le=mt._y0,Ne=mt._x1,we=mt._y1,At,Qt,de,rn,Ee,ce,Oe,Ze;if(!Ut)return mt._root=ue,mt;for(;Ut.length;)if((Ee=wt>=(At=(se+Ne)/2))?se=At:Ne=At,(ce=ut>=(Qt=(Le+we)/2))?Le=Qt:we=Qt,Nt=Ut,!(Ut=Ut[Oe=ce<<1|Ee]))return Nt[Oe]=ue,mt;if(de=+mt._x.call(null,Ut.data),rn=+mt._y.call(null,Ut.data),wt===de&&ut===rn)return ue.next=Ut,Nt?Nt[Oe]=ue:mt._root=ue,mt;do Nt=Nt?Nt[Oe]=new Array(4):mt._root=new Array(4),(Ee=wt>=(At=(se+Ne)/2))?se=At:Ne=At,(ce=ut>=(Qt=(Le+we)/2))?Le=Qt:we=Qt;while((Oe=ce<<1|Ee)==(Ze=(rn>=Qt)<<1|de>=At));return Nt[Ze]=Ut,Nt[Oe]=ue,mt}function j(mt){var wt,ut,pt=mt.length,Nt,Ut,ue=new Array(pt),se=new Array(pt),Le=Infinity,Ne=Infinity,we=-Infinity,At=-Infinity;for(ut=0;ut<pt;++ut)isNaN(Nt=+this._x.call(null,wt=mt[ut]))||isNaN(Ut=+this._y.call(null,wt))||(ue[ut]=Nt,se[ut]=Ut,Nt<Le&&(Le=Nt),Nt>we&&(we=Nt),Ut<Ne&&(Ne=Ut),Ut>At&&(At=Ut));if(Le>we||Ne>At)return this;for(this.cover(Le,Ne).cover(we,At),ut=0;ut<pt;++ut)tt(this,ue[ut],se[ut],mt[ut]);return this}function W(mt,wt){if(isNaN(mt=+mt)||isNaN(wt=+wt))return this;var ut=this._x0,pt=this._y0,Nt=this._x1,Ut=this._y1;if(isNaN(ut))Nt=(ut=Math.floor(mt))+1,Ut=(pt=Math.floor(wt))+1;else{for(var ue=Nt-ut||1,se=this._root,Le,Ne;ut>mt||mt>=Nt||pt>wt||wt>=Ut;)switch(Ne=(wt<pt)<<1|mt<ut,Le=new Array(4),Le[Ne]=se,se=Le,ue*=2,Ne){case 0:Nt=ut+ue,Ut=pt+ue;break;case 1:ut=Nt-ue,Ut=pt+ue;break;case 2:Nt=ut+ue,pt=Ut-ue;break;case 3:ut=Nt-ue,pt=Ut-ue;break}this._root&&this._root.length&&(this._root=se)}return this._x0=ut,this._y0=pt,this._x1=Nt,this._y1=Ut,this}function Q(){var mt=[];return this.visit(function(wt){if(!wt.length)do mt.push(wt.data);while(wt=wt.next)}),mt}function Z(mt){return arguments.length?this.cover(+mt[0][0],+mt[0][1]).cover(+mt[1][0],+mt[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function R(mt,wt,ut,pt,Nt){this.node=mt,this.x0=wt,this.y0=ut,this.x1=pt,this.y1=Nt}function L(mt,wt,ut){var pt,Nt=this._x0,Ut=this._y0,ue,se,Le,Ne,we=this._x1,At=this._y1,Qt=[],de=this._root,rn,Ee;for(de&&Qt.push(new R(de,Nt,Ut,we,At)),ut==null?ut=Infinity:(Nt=mt-ut,Ut=wt-ut,we=mt+ut,At=wt+ut,ut*=ut);rn=Qt.pop();)if(!(!(de=rn.node)||(ue=rn.x0)>we||(se=rn.y0)>At||(Le=rn.x1)<Nt||(Ne=rn.y1)<Ut))if(de.length){var ce=(ue+Le)/2,Oe=(se+Ne)/2;Qt.push(new R(de[3],ce,Oe,Le,Ne),new R(de[2],ue,Oe,ce,Ne),new R(de[1],ce,se,Le,Oe),new R(de[0],ue,se,ce,Oe)),(Ee=(wt>=Oe)<<1|mt>=ce)&&(rn=Qt[Qt.length-1],Qt[Qt.length-1]=Qt[Qt.length-1-Ee],Qt[Qt.length-1-Ee]=rn)}else{var Ze=mt-+this._x.call(null,de.data),fe=wt-+this._y.call(null,de.data),Ae=Ze*Ze+fe*fe;if(Ae<ut){var Ye=Math.sqrt(ut=Ae);Nt=mt-Ye,Ut=wt-Ye,we=mt+Ye,At=wt+Ye,pt=de.data}}return pt}function C(mt){if(isNaN(we=+this._x.call(null,mt))||isNaN(At=+this._y.call(null,mt)))return this;var wt,ut=this._root,pt,Nt,Ut,ue=this._x0,se=this._y0,Le=this._x1,Ne=this._y1,we,At,Qt,de,rn,Ee,ce,Oe;if(!ut)return this;if(ut.length)for(;;){if((rn=we>=(Qt=(ue+Le)/2))?ue=Qt:Le=Qt,(Ee=At>=(de=(se+Ne)/2))?se=de:Ne=de,wt=ut,!(ut=ut[ce=Ee<<1|rn]))return this;if(!ut.length)break;(wt[ce+1&3]||wt[ce+2&3]||wt[ce+3&3])&&(pt=wt,Oe=ce)}for(;ut.data!==mt;)if(Nt=ut,!(ut=ut.next))return this;return(Ut=ut.next)&&delete ut.next,Nt?(Ut?Nt.next=Ut:delete Nt.next,this):wt?(Ut?wt[ce]=Ut:delete wt[ce],(ut=wt[0]||wt[1]||wt[2]||wt[3])&&ut===(wt[3]||wt[2]||wt[1]||wt[0])&&!ut.length&&(pt?pt[Oe]=ut:this._root=ut),this):(this._root=Ut,this)}function A(mt){for(var wt=0,ut=mt.length;wt<ut;++wt)this.remove(mt[wt]);return this}function N(){return this._root}function B(){var mt=0;return this.visit(function(wt){if(!wt.length)do++mt;while(wt=wt.next)}),mt}function O(mt){var wt=[],ut,pt=this._root,Nt,Ut,ue,se,Le;for(pt&&wt.push(new R(pt,this._x0,this._y0,this._x1,this._y1));ut=wt.pop();)if(!mt(pt=ut.node,Ut=ut.x0,ue=ut.y0,se=ut.x1,Le=ut.y1)&&pt.length){var Ne=(Ut+se)/2,we=(ue+Le)/2;(Nt=pt[3])&&wt.push(new R(Nt,Ne,we,se,Le)),(Nt=pt[2])&&wt.push(new R(Nt,Ut,we,Ne,Le)),(Nt=pt[1])&&wt.push(new R(Nt,Ne,ue,se,we)),(Nt=pt[0])&&wt.push(new R(Nt,Ut,ue,Ne,we))}return this}function F(mt){var wt=[],ut=[],pt;for(this._root&&wt.push(new R(this._root,this._x0,this._y0,this._x1,this._y1));pt=wt.pop();){var Nt=pt.node;if(Nt.length){var Ut,ue=pt.x0,se=pt.y0,Le=pt.x1,Ne=pt.y1,we=(ue+Le)/2,At=(se+Ne)/2;(Ut=Nt[0])&&wt.push(new R(Ut,ue,se,we,At)),(Ut=Nt[1])&&wt.push(new R(Ut,we,se,Le,At)),(Ut=Nt[2])&&wt.push(new R(Ut,ue,At,we,Ne)),(Ut=Nt[3])&&wt.push(new R(Ut,we,At,Le,Ne))}ut.push(pt)}for(;pt=ut.pop();)mt(pt.node,pt.x0,pt.y0,pt.x1,pt.y1);return this}function K(mt){return mt[0]}function nt(mt){return arguments.length?(this._x=mt,this):this._x}function P(mt){return mt[1]}function k(mt){return arguments.length?(this._y=mt,this):this._y}function yt(mt,wt,ut){var pt=new st(wt==null?K:wt,ut==null?P:ut,NaN,NaN,NaN,NaN);return mt==null?pt:pt.addAll(mt)}function st(mt,wt,ut,pt,Nt,Ut){this._x=mt,this._y=wt,this._x0=ut,this._y0=pt,this._x1=Nt,this._y1=Ut,this._root=void 0}function lt(mt){for(var wt={data:mt.data},ut=wt;mt=mt.next;)ut=ut.next={data:mt.data};return wt}var ht=yt.prototype=st.prototype;ht.copy=function(){var mt=new st(this._x,this._y,this._x0,this._y0,this._x1,this._y1),wt=this._root,ut,pt;if(!wt)return mt;if(!wt.length)return mt._root=lt(wt),mt;for(ut=[{source:wt,target:mt._root=new Array(4)}];wt=ut.pop();)for(var Nt=0;Nt<4;++Nt)(pt=wt.source[Nt])&&(pt.length?ut.push({source:pt,target:wt.target[Nt]=new Array(4)}):wt.target[Nt]=lt(pt));return mt},ht.add=Y,ht.addAll=j,ht.cover=W,ht.data=Q,ht.extent=Z,ht.find=L,ht.remove=C,ht.removeAll=A,ht.root=N,ht.size=B,ht.visit=O,ht.visitAfter=F,ht.x=nt,ht.y=k},31278:function(ur,ot,$){"use strict";var Y;Y={value:!0};var tt=$(64530);function j(N,B,O){var F=[0,0,0,0,0,0,0,0,0];return tt.mat3.fromTranslation(F,O),tt.mat3.multiply(N,F,B)}Y=j;function W(N,B,O){var F=[0,0,0,0,0,0,0,0,0];return tt.mat3.fromRotation(F,O),tt.mat3.multiply(N,F,B)}Y=W;function Q(N,B,O){var F=[0,0,0,0,0,0,0,0,0];return tt.mat3.fromScaling(F,O),tt.mat3.multiply(N,F,B)}Y=Q;function Z(N,B,O){return tt.mat3.multiply(N,O,B)}function R(N,B){for(var O=N?[].concat(N):[1,0,0,0,1,0,0,0,1],F=0,K=B.length;F<K;F++){var nt=B[F];switch(nt[0]){case"t":j(O,O,[nt[1],nt[2]]);break;case"s":Q(O,O,[nt[1],nt[2]]);break;case"r":W(O,O,nt[1]);break;case"m":Z(O,O,nt[1]);break;default:break}}return O}ot.vs=R;function L(N,B){return N[0]*B[1]-B[0]*N[1]}Y=L;function C(N,B,O){var F=tt.vec2.angle(N,B),K=L(N,B)>=0;return O?K?Math.PI*2-F:F:K?F:Math.PI*2-F}Y=C;function A(N,B,O){return O?(N[0]=B[1],N[1]=-1*B[0]):(N[0]=-1*B[1],N[1]=B[0]),N}Y=A},23044:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{Cache:function(){return Zn},assign:function(){return Qs},augment:function(){return xn},clamp:function(){return Dn},clearAnimationFrame:function(){return Ws},clone:function(){return pa},contains:function(){return W},debounce:function(){return Vi},deepMix:function(){return fo},difference:function(){return L},each:function(){return nt},endsWith:function(){return Ea},every:function(){return Da},extend:function(){return Cs},filter:function(){return Z},find:function(){return pt},findIndex:function(){return Ut},firstValue:function(){return se},fixedBase:function(){return Lt},flatten:function(){return Ne},flattenDeep:function(){return At},forIn:function(){return ln},get:function(){return Wu},getEllipsisText:function(){return me},getRange:function(){return Ee},getType:function(){return ms},getWrapBehavior:function(){return nr},group:function(){return Wr},groupBy:function(){return tr},groupToMap:function(){return zn},has:function(){return De},hasKey:function(){return dn},hasValue:function(){return Kn},head:function(){return Bn},identity:function(){return Ic},includes:function(){return W},indexOf:function(){return Tl},isArguments:function(){return To},isArray:function(){return O.Z},isArrayLike:function(){return tt},isBoolean:function(){return Eu},isDate:function(){return Rs},isDecimal:function(){return X},isElement:function(){return Ms},isEmpty:function(){return ul},isEqual:function(){return Pu},isEqualWith:function(){return Nu},isError:function(){return fu},isEven:function(){return zt},isFinite:function(){return Is},isFunction:function(){return A},isInteger:function(){return Xt},isMatch:function(){return st},isNegative:function(){return on},isNil:function(){return B},isNull:function(){return Wi},isNumber:function(){return it},isNumberEqual:function(){return He},isObject:function(){return F},isObjectLike:function(){return ht},isOdd:function(){return Ln},isPlainObject:function(){return wt},isPositive:function(){return Ia},isPrototype:function(){return Us},isRegExp:function(){return qs},isString:function(){return Ft},isType:function(){return C.Z},isUndefined:function(){return ji},keys:function(){return k},last:function(){return xr},lowerCase:function(){return La},lowerFirst:function(){return Fi},map:function(){return Bs},mapValues:function(){return Fu},max:function(){return Qt},maxBy:function(){return Jn},measureTextWidth:function(){return re},memoize:function(){return Ao},min:function(){return de},minBy:function(){return Ar},mix:function(){return Qs},mod:function(){return za},noop:function(){return Ol},number2color:function(){return ua},omit:function(){return Bl},parseRadius:function(){return ba},pick:function(){return gc},pull:function(){return Ae},pullAt:function(){return Be},reduce:function(){return ke},remove:function(){return ee},requestAnimationFrame:function(){return os},set:function(){return Ju},size:function(){return Se},some:function(){return _n},sortBy:function(){return Me},startsWith:function(){return Ur},substitute:function(){return xo},throttle:function(){return vl},toArray:function(){return Ls},toDegree:function(){return ki},toInteger:function(){return vi},toRadian:function(){return Ra},toString:function(){return Rr},union:function(){return Rt},uniq:function(){return en},uniqueId:function(){return oc},upperCase:function(){return es},upperFirst:function(){return Zi},values:function(){return Gn},valuesOfKey:function(){return Xn},wrapBehavior:function(){return Sr}});var Y=function(Yt){return Yt!==null&&typeof Yt!="function"&&isFinite(Yt.length)},tt=Y,j=function(Yt,Ie){return tt(Yt)?Yt.indexOf(Ie)>-1:!1},W=j,Q=function(Yt,Ie){if(!tt(Yt))return Yt;for(var Ge=[],Fe=0;Fe<Yt.length;Fe++){var In=Yt[Fe];Ie(In,Fe)&&Ge.push(In)}return Ge},Z=Q,R=function(Yt,Ie){return Ie===void 0&&(Ie=[]),Z(Yt,function(Ge){return!W(Ie,Ge)})},L=R,C=$(57371),A=function(Yt){return(0,C.Z)(Yt,"Function")},N=function(Yt){return Yt==null},B=N,O=$(75345),F=function(Yt){var Ie=typeof Yt;return Yt!==null&&Ie==="object"||Ie==="function"};function K(Yt,Ie){if(!!Yt){var Ge;if((0,O.Z)(Yt))for(var Fe=0,In=Yt.length;Fe<In&&(Ge=Ie(Yt[Fe],Fe),Ge!==!1);Fe++);else if(F(Yt)){for(var ar in Yt)if(Yt.hasOwnProperty(ar)&&(Ge=Ie(Yt[ar],ar),Ge===!1))break}}}var nt=K,P=Object.keys?function(Yt){return Object.keys(Yt)}:function(Yt){var Ie=[];return nt(Yt,function(Ge,Fe){A(Yt)&&Fe==="prototype"||Ie.push(Fe)}),Ie},k=P;function yt(Yt,Ie){var Ge=k(Ie),Fe=Ge.length;if(B(Yt))return!Fe;for(var In=0;In<Fe;In+=1){var ar=Ge[In];if(Ie[ar]!==Yt[ar]||!(ar in Yt))return!1}return!0}var st=yt,lt=function(Yt){return typeof Yt=="object"&&Yt!==null},ht=lt,mt=function(Yt){if(!ht(Yt)||!(0,C.Z)(Yt,"Object"))return!1;if(Object.getPrototypeOf(Yt)===null)return!0;for(var Ie=Yt;Object.getPrototypeOf(Ie)!==null;)Ie=Object.getPrototypeOf(Ie);return Object.getPrototypeOf(Yt)===Ie},wt=mt;function ut(Yt,Ie){if(!(0,O.Z)(Yt))return null;var Ge;if(A(Ie)&&(Ge=Ie),wt(Ie)&&(Ge=function(In){return st(In,Ie)}),Ge){for(var Fe=0;Fe<Yt.length;Fe+=1)if(Ge(Yt[Fe]))return Yt[Fe]}return null}var pt=ut;function Nt(Yt,Ie,Ge){Ge===void 0&&(Ge=0);for(var Fe=Ge;Fe<Yt.length;Fe++)if(Ie(Yt[Fe],Fe))return Fe;return-1}var Ut=Nt,ue=function(Yt,Ie){for(var Ge=null,Fe=0;Fe<Yt.length;Fe++){var In=Yt[Fe],ar=In[Ie];if(!B(ar)){(0,O.Z)(ar)?Ge=ar[0]:Ge=ar;break}}return Ge},se=ue,Le=function(Yt){if(!(0,O.Z)(Yt))return[];for(var Ie=[],Ge=0;Ge<Yt.length;Ge++)Ie=Ie.concat(Yt[Ge]);return Ie},Ne=Le,we=function(Yt,Ie){if(Ie===void 0&&(Ie=[]),!(0,O.Z)(Yt))Ie.push(Yt);else for(var Ge=0;Ge<Yt.length;Ge+=1)we(Yt[Ge],Ie);return Ie},At=we,Qt=function(Yt){if(!!(0,O.Z)(Yt))return Yt.reduce(function(Ie,Ge){return Math.max(Ie,Ge)},Yt[0])},de=function(Yt){if(!!(0,O.Z)(Yt))return Yt.reduce(function(Ie,Ge){return Math.min(Ie,Ge)},Yt[0])},rn=function(Yt){var Ie=Yt.filter(function(ra){return!isNaN(ra)});if(!Ie.length)return{min:0,max:0};if((0,O.Z)(Yt[0])){for(var Ge=[],Fe=0;Fe<Yt.length;Fe++)Ge=Ge.concat(Yt[Fe]);Ie=Ge}var In=Qt(Ie),ar=de(Ie);return{min:ar,max:In}},Ee=rn,ce=Array.prototype,Oe=ce.splice,Ze=ce.indexOf,fe=function(Yt){for(var Ie=[],Ge=1;Ge<arguments.length;Ge++)Ie[Ge-1]=arguments[Ge];for(var Fe=0;Fe<Ie.length;Fe++)for(var In=Ie[Fe],ar=-1;(ar=Ze.call(Yt,In))>-1;)Oe.call(Yt,ar,1);return Yt},Ae=fe,Ye=Array.prototype.splice,ge=function(Ie,Ge){if(!tt(Ie))return[];for(var Fe=Ie?Ge.length:0,In=Fe-1;Fe--;){var ar=void 0,ra=Ge[Fe];(Fe===In||ra!==ar)&&(ar=ra,Ye.call(Ie,ra,1))}return Ie},Be=ge,te=function(Yt,Ie,Ge){if(!(0,O.Z)(Yt)&&!wt(Yt))return Yt;var Fe=Ge;return nt(Yt,function(In,ar){Fe=Ie(Fe,In,ar)}),Fe},ke=te,Ve=function(Yt,Ie){var Ge=[];if(!tt(Yt))return Ge;for(var Fe=-1,In=[],ar=Yt.length;++Fe<ar;){var ra=Yt[Fe];Ie(ra,Fe,Yt)&&(Ge.push(ra),In.push(Fe))}return Be(Yt,In),Ge},ee=Ve,Ft=function(Yt){return(0,C.Z)(Yt,"String")};function bt(Yt,Ie){var Ge;if(A(Ie))Ge=function(In,ar){return Ie(In)-Ie(ar)};else{var Fe=[];Ft(Ie)?Fe.push(Ie):(0,O.Z)(Ie)&&(Fe=Ie),Ge=function(In,ar){for(var ra=0;ra<Fe.length;ra+=1){var Ta=Fe[ra];if(In[Ta]>ar[Ta])return 1;if(In[Ta]<ar[Ta])return-1}return 0}}return Yt.sort(Ge),Yt}var Me=bt;function en(Yt,Ie){Ie===void 0&&(Ie=new Map);var Ge=[];if(Array.isArray(Yt))for(var Fe=0,In=Yt.length;Fe<In;Fe++){var ar=Yt[Fe];Ie.has(ar)||(Ge.push(ar),Ie.set(ar,!0))}return Ge}var fn=function(){for(var Yt=[],Ie=0;Ie<arguments.length;Ie++)Yt[Ie]=arguments[Ie];return en([].concat.apply([],Yt))},Rt=fn,Xn=function(Yt,Ie){for(var Ge=[],Fe={},In=0;In<Yt.length;In++){var ar=Yt[In],ra=ar[Ie];if(!B(ra)){(0,O.Z)(ra)||(ra=[ra]);for(var Ta=0;Ta<ra.length;Ta++){var $a=ra[Ta];Fe[$a]||(Ge.push($a),Fe[$a]=!0)}}}return Ge};function Bn(Yt){if(tt(Yt))return Yt[0]}function xr(Yt){if(tt(Yt)){var Ie=Yt;return Ie[Ie.length-1]}}function dr(Yt,Ie){return(0,O.Z)(Yt)||Ft(Yt)?Yt[0]===Ie:!1}var Ur=dr;function fa(Yt,Ie){return(0,O.Z)(Yt)||Ft(Yt)?Yt[Yt.length-1]===Ie:!1}var Ea=fa,aa=function(Yt,Ie){for(var Ge=0;Ge<Yt.length;Ge++)if(!Ie(Yt[Ge],Ge))return!1;return!0},Da=aa,Lr=function(Yt,Ie){for(var Ge=0;Ge<Yt.length;Ge++)if(Ie(Yt[Ge],Ge))return!0;return!1},_n=Lr,sr=Object.prototype.hasOwnProperty;function Pn(Yt,Ie){if(!Ie||!(0,O.Z)(Yt))return{};for(var Ge={},Fe=A(Ie)?Ie:function(Ta){return Ta[Ie]},In,ar=0;ar<Yt.length;ar++){var ra=Yt[ar];In=Fe(ra),sr.call(Ge,In)?Ge[In].push(ra):Ge[In]=[ra]}return Ge}var tr=Pn;function zn(Yt,Ie){if(!Ie)return{0:Yt};if(!A(Ie)){var Ge=(0,O.Z)(Ie)?Ie:Ie.replace(/\s+/g,"").split("*");Ie=function(Fe){for(var In="_",ar=0,ra=Ge.length;ar<ra;ar++)In+=Fe[Ge[ar]]&&Fe[Ge[ar]].toString();return In}}return tr(Yt,Ie)}var Wr=function(Yt,Ie){if(!Ie)return[Yt];var Ge=zn(Yt,Ie),Fe=[];for(var In in Ge)Fe.push(Ge[In]);return Fe};function Yr(Yt,Ie){return Yt["_wrap_"+Ie]}var nr=Yr;function wr(Yt,Ie){if(Yt["_wrap_"+Ie])return Yt["_wrap_"+Ie];var Ge=function(Fe){Yt[Ie](Fe)};return Yt["_wrap_"+Ie]=Ge,Ge}var Sr=wr,pr={};function qr(Yt){var Ie=pr[Yt];if(!Ie){for(var Ge=Yt.toString(16),Fe=Ge.length;Fe<6;Fe++)Ge="0"+Ge;Ie="#"+Ge,pr[Yt]=Ie}return Ie}var ua=qr;function $r(Yt){var Ie=0,Ge=0,Fe=0,In=0;return(0,O.Z)(Yt)?Yt.length===1?Ie=Ge=Fe=In=Yt[0]:Yt.length===2?(Ie=Fe=Yt[0],Ge=In=Yt[1]):Yt.length===3?(Ie=Yt[0],Ge=In=Yt[1],Fe=Yt[2]):(Ie=Yt[0],Ge=Yt[1],Fe=Yt[2],In=Yt[3]):Ie=Ge=Fe=In=Yt,{r1:Ie,r2:Ge,r3:Fe,r4:In}}var ba=$r,gt=function(Yt,Ie,Ge){return Yt<Ie?Ie:Yt>Ge?Ge:Yt},Dn=gt,un=function(Yt,Ie){var Ge=Ie.toString(),Fe=Ge.indexOf(".");if(Fe===-1)return Math.round(Yt);var In=Ge.substr(Fe+1).length;return In>20&&(In=20),parseFloat(Yt.toFixed(In))},Lt=un,Ot=function(Yt){return(0,C.Z)(Yt,"Number")},it=Ot,H=function(Yt){return it(Yt)&&Yt%1!=0},X=H,xt=function(Yt){return it(Yt)&&Yt%2==0},zt=xt,Vt=Number.isInteger?Number.isInteger:function(Yt){return it(Yt)&&Yt%1==0},Xt=Vt,ne=function(Yt){return it(Yt)&&Yt<0},on=ne,tn=1e-5;function He(Yt,Ie,Ge){return Ge===void 0&&(Ge=tn),Math.abs(Yt-Ie)<Ge}var Qn=function(Yt){return it(Yt)&&Yt%2!=0},Ln=Qn,Qr=function(Yt){return it(Yt)&&Yt>0},Ia=Qr,Jn=function(Yt,Ie){if(!!(0,O.Z)(Yt)){for(var Ge,Fe=-Infinity,In=0;In<Yt.length;In++){var ar=Yt[In],ra=A(Ie)?Ie(ar):ar[Ie];ra>Fe&&(Ge=ar,Fe=ra)}return Ge}},Ar=function(Yt,Ie){if(!!(0,O.Z)(Yt)){for(var Ge,Fe=Infinity,In=0;In<Yt.length;In++){var ar=Yt[In],ra=A(Ie)?Ie(ar):ar[Ie];ra<Fe&&(Ge=ar,Fe=ra)}return Ge}},na=function(Yt,Ie){return(Yt%Ie+Ie)%Ie},za=na,da=180/Math.PI,Ti=function(Yt){return da*Yt},ki=Ti,vi=parseInt,ii=Math.PI/180,Di=function(Yt){return ii*Yt},Ra=Di,ln=nt,De=function(Yt,Ie){return Yt.hasOwnProperty(Ie)},dn=De,Wn=Object.values?function(Yt){return Object.values(Yt)}:function(Yt){var Ie=[];return nt(Yt,function(Ge,Fe){A(Yt)&&Fe==="prototype"||Ie.push(Ge)}),Ie},Gn=Wn,Kn=function(Yt,Ie){return W(Gn(Yt),Ie)},Rr=function(Yt){return B(Yt)?"":Yt.toString()},xa=function(Yt){return Rr(Yt).toLowerCase()},La=xa,ui=function(Yt){var Ie=Rr(Yt);return Ie.charAt(0).toLowerCase()+Ie.substring(1)},Fi=ui;function Ki(Yt,Ie){return!Yt||!Ie?Yt:Yt.replace(/\\?\{([^{}]+)\}/g,function(Ge,Fe){return Ge.charAt(0)==="\\"?Ge.slice(1):Ie[Fe]===void 0?"":Ie[Fe]})}var xo=Ki,vo=function(Yt){return Rr(Yt).toUpperCase()},es=vo,Wo=function(Yt){var Ie=Rr(Yt);return Ie.charAt(0).toUpperCase()+Ie.substring(1)},Zi=Wo,bi={}.toString,gi=function(Yt){return bi.call(Yt).replace(/^\[object /,"").replace(/]$/,"")},ms=gi,Do=function(Yt){return(0,C.Z)(Yt,"Arguments")},To=Do,Zs=function(Yt){return(0,C.Z)(Yt,"Boolean")},Eu=Zs,as=function(Yt){return(0,C.Z)(Yt,"Date")},Rs=as,Su=function(Yt){return(0,C.Z)(Yt,"Error")},fu=Su;function Is(Yt){return it(Yt)&&isFinite(Yt)}var Zo=function(Yt){return Yt===null},Wi=Zo,ys=Object.prototype,is=function(Yt){var Ie=Yt&&Yt.constructor,Ge=typeof Ie=="function"&&Ie.prototype||ys;return Yt===Ge},Us=is,Du=function(Yt){return(0,C.Z)(Yt,"RegExp")},qs=Du,Cu=function(Yt){return Yt===void 0},ji=Cu,Bi=function(Yt){return Yt instanceof Element||Yt instanceof HTMLDocument},Ms=Bi;function os(Yt){var Ie=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(Ge){return setTimeout(Ge,16)};return Ie(Yt)}function Ws(Yt){var Ie=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;Ie(Yt)}function Ss(Yt,Ie){for(var Ge in Ie)Ie.hasOwnProperty(Ge)&&Ge!=="constructor"&&Ie[Ge]!==void 0&&(Yt[Ge]=Ie[Ge])}function Qs(Yt,Ie,Ge,Fe){return Ie&&Ss(Yt,Ie),Ge&&Ss(Yt,Ge),Fe&&Ss(Yt,Fe),Yt}var Qu=function(){for(var Yt=[],Ie=0;Ie<arguments.length;Ie++)Yt[Ie]=arguments[Ie];for(var Ge=Yt[0],Fe=1;Fe<Yt.length;Fe++){var In=Yt[Fe];A(In)&&(In=In.prototype),Qs(Ge.prototype,In)}},xn=Qu,Vr=function(Yt){if(typeof Yt!="object"||Yt===null)return Yt;var Ie;if((0,O.Z)(Yt)){Ie=[];for(var Ge=0,Fe=Yt.length;Ge<Fe;Ge++)typeof Yt[Ge]=="object"&&Yt[Ge]!=null?Ie[Ge]=Vr(Yt[Ge]):Ie[Ge]=Yt[Ge]}else{Ie={};for(var In in Yt)typeof Yt[In]=="object"&&Yt[In]!=null?Ie[In]=Vr(Yt[In]):Ie[In]=Yt[In]}return Ie},pa=Vr;function Fa(Yt,Ie,Ge){var Fe;return function(){var In=this,ar=arguments,ra=function(){Fe=null,Ge||Yt.apply(In,ar)},Ta=Ge&&!Fe;clearTimeout(Fe),Fe=setTimeout(ra,Ie),Ta&&Yt.apply(In,ar)}}var Vi=Fa,Ao=function(Yt,Ie){if(!A(Yt))throw new TypeError("Expected a function");var Ge=function(){for(var Fe=[],In=0;In<arguments.length;In++)Fe[In]=arguments[In];var ar=Ie?Ie.apply(this,Fe):Fe[0],ra=Ge.cache;if(ra.has(ar))return ra.get(ar);var Ta=Yt.apply(this,Fe);return ra.set(ar,Ta),Ta};return Ge.cache=new Map,Ge},ao=5;function So(Yt,Ie,Ge,Fe){Ge=Ge||0,Fe=Fe||ao;for(var In in Ie)if(Ie.hasOwnProperty(In)){var ar=Ie[In];ar!==null&&wt(ar)?(wt(Yt[In])||(Yt[In]={}),Ge<Fe?So(Yt[In],ar,Ge+1,Fe):Yt[In]=Ie[In]):(0,O.Z)(ar)?(Yt[In]=[],Yt[In]=Yt[In].concat(ar)):ar!==void 0&&(Yt[In]=ar)}}var Ts=function(Yt){for(var Ie=[],Ge=1;Ge<arguments.length;Ge++)Ie[Ge-1]=arguments[Ge];for(var Fe=0;Fe<Ie.length;Fe+=1)So(Yt,Ie[Fe]);return Yt},fo=Ts,ou=function(Yt,Ie,Ge,Fe){A(Ie)||(Ge=Ie,Ie=Yt,Yt=function(){});var In=Object.create?function(ra,Ta){return Object.create(ra,{constructor:{value:Ta}})}:function(ra,Ta){function $a(){}$a.prototype=ra;var ja=new $a;return ja.constructor=Ta,ja},ar=In(Ie.prototype,Yt);return Yt.prototype=Qs(ar,Yt.prototype),Yt.superclass=In(Ie.prototype,Ie),Qs(ar,Ge),Qs(Yt,Fe),Yt},Cs=ou,Au=function(Yt,Ie){if(!tt(Yt))return-1;var Ge=Array.prototype.indexOf;if(Ge)return Ge.call(Yt,Ie);for(var Fe=-1,In=0;In<Yt.length;In++)if(Yt[In]===Ie){Fe=In;break}return Fe},Tl=Au,bl=Object.prototype.hasOwnProperty;function Js(Yt){if(B(Yt))return!0;if(tt(Yt))return!Yt.length;var Ie=ms(Yt);if(Ie==="Map"||Ie==="Set")return!Yt.size;if(Us(Yt))return!Object.keys(Yt).length;for(var Ge in Yt)if(bl.call(Yt,Ge))return!1;return!0}var ul=Js,Mu=function(Yt,Ie){if(Yt===Ie)return!0;if(!Yt||!Ie||Ft(Yt)||Ft(Ie))return!1;if(tt(Yt)||tt(Ie)){if(Yt.length!==Ie.length)return!1;for(var Ge=!0,Fe=0;Fe<Yt.length&&(Ge=Mu(Yt[Fe],Ie[Fe]),!!Ge);Fe++);return Ge}if(ht(Yt)||ht(Ie)){var In=Object.keys(Yt),ar=Object.keys(Ie);if(In.length!==ar.length)return!1;for(var Ge=!0,Fe=0;Fe<In.length&&(Ge=Mu(Yt[In[Fe]],Ie[In[Fe]]),!!Ge);Fe++);return Ge}return!1},Pu=Mu,Nu=function(Yt,Ie,Ge){return A(Ge)?!!Ge(Yt,Ie):Pu(Yt,Ie)},fs=function(Yt,Ie){if(!tt(Yt))return Yt;for(var Ge=[],Fe=0;Fe<Yt.length;Fe++){var In=Yt[Fe];Ge.push(Ie(In,Fe))}return Ge},Bs=fs,gu=function(Yt){return Yt},Fu=function(Yt,Ie){Ie===void 0&&(Ie=gu);var Ge={};return F(Yt)&&!B(Yt)&&Object.keys(Yt).forEach(function(Fe){Ge[Fe]=Ie(Yt[Fe],Fe)}),Ge},Wu=function(Yt,Ie,Ge){for(var Fe=0,In=Ft(Ie)?Ie.split("."):Ie;Yt&&Fe<In.length;)Yt=Yt[In[Fe++]];return Yt===void 0||Fe<In.length?Ge:Yt},Ju=function(Yt,Ie,Ge){var Fe=Yt,In=Ft(Ie)?Ie.split("."):Ie;return In.forEach(function(ar,ra){ra<In.length-1?(F(Fe[ar])||(Fe[ar]=it(In[ra+1])?[]:{}),Fe=Fe[ar]):Fe[ar]=Ge}),Yt},tu=Object.prototype.hasOwnProperty,gc=function(Yt,Ie){if(Yt===null||!wt(Yt))return{};var Ge={};return nt(Ie,function(Fe){tu.call(Yt,Fe)&&(Ge[Fe]=Yt[Fe])}),Ge},Bl=function(Yt,Ie){return ke(Yt,function(Ge,Fe,In){return Ie.includes(In)||(Ge[In]=Fe),Ge},{})},vl=function(Yt,Ie,Ge){var Fe,In,ar,ra,Ta=0;Ge||(Ge={});var $a=function(){Ta=Ge.leading===!1?0:Date.now(),Fe=null,ra=Yt.apply(In,ar),Fe||(In=ar=null)},ja=function(){var Oa=Date.now();!Ta&&Ge.leading===!1&&(Ta=Oa);var so=Ie-(Oa-Ta);return In=this,ar=arguments,so<=0||so>Ie?(Fe&&(clearTimeout(Fe),Fe=null),Ta=Oa,ra=Yt.apply(In,ar),Fe||(In=ar=null)):!Fe&&Ge.trailing!==!1&&(Fe=setTimeout($a,so)),ra};return ja.cancel=function(){clearTimeout(Fe),Ta=0,Fe=In=ar=null},ja},Ls=function(Yt){return tt(Yt)?Array.prototype.slice.call(Yt):[]},el={},oc=function(Yt){return Yt=Yt||"g",el[Yt]?el[Yt]+=1:el[Yt]=1,Yt+el[Yt]},Ol=function(){},Ic=function(Yt){return Yt};function Se(Yt){return B(Yt)?0:tt(Yt)?Yt.length:Object.keys(Yt).length}var ve=$(65353),Gt,re=Ao(function(Yt,Ie){Ie===void 0&&(Ie={});var Ge=Ie.fontSize,Fe=Ie.fontFamily,In=Ie.fontWeight,ar=Ie.fontStyle,ra=Ie.fontVariant;return Gt||(Gt=document.createElement("canvas").getContext("2d")),Gt.font=[ar,ra,In,Ge+"px",Fe].join(" "),Gt.measureText(Ft(Yt)?Yt:"").width},function(Yt,Ie){return Ie===void 0&&(Ie={}),(0,ve.__spreadArrays)([Yt],Gn(Ie)).join("")}),me=function(Yt,Ie,Ge,Fe){Fe===void 0&&(Fe="...");var In=16,ar=re(Fe,Ge),ra=Ft(Yt)?Yt:Rr(Yt),Ta=Ie,$a=[],ja,Oa;if(re(Yt,Ge)<=Ie)return Yt;for(;ja=ra.substr(0,In),Oa=re(ja,Ge),!(Oa+ar>Ta&&Oa>Ta);)if($a.push(ja),Ta-=Oa,ra=ra.substr(In),!ra)return $a.join("");for(;ja=ra.substr(0,1),Oa=re(ja,Ge),!(Oa+ar>Ta);)if($a.push(ja),Ta-=Oa,ra=ra.substr(1),!ra)return $a.join("");return""+$a.join("")+Fe},bn=function(){function Yt(){this.map={}}return Yt.prototype.has=function(Ie){return this.map[Ie]!==void 0},Yt.prototype.get=function(Ie,Ge){var Fe=this.map[Ie];return Fe===void 0?Ge:Fe},Yt.prototype.set=function(Ie,Ge){this.map[Ie]=Ge},Yt.prototype.clear=function(){this.map={}},Yt.prototype.delete=function(Ie){delete this.map[Ie]},Yt.prototype.size=function(){return Object.keys(this.map).length},Yt}(),Zn=bn},75345:function(ur,ot,$){"use strict";var Y=$(57371);ot.Z=function(tt){return Array.isArray?Array.isArray(tt):(0,Y.Z)(tt,"Array")}},57371:function(ur,ot){"use strict";var $={}.toString,Y=function(tt,j){return $.call(tt)==="[object "+j+"]"};ot.Z=Y},18045:function(ur,ot,$){"use strict";var Y;Y={value:!0};var tt=$(42563);function j(ce){if(ce&&ce.__esModule)return ce;var Oe=Object.create(null);return ce&&Object.keys(ce).forEach(function(Ze){if(Ze!=="default"){var fe=Object.getOwnPropertyDescriptor(ce,Ze);Object.defineProperty(Oe,Ze,fe.get?fe:{enumerable:!0,get:function(){return ce[Ze]}})}}),Oe.default=ce,Object.freeze(Oe)}var W=j(tt);function Q(ce,Oe){var Ze=Object.keys(ce);if(Object.getOwnPropertySymbols){var fe=Object.getOwnPropertySymbols(ce);Oe&&(fe=fe.filter(function(Ae){return Object.getOwnPropertyDescriptor(ce,Ae).enumerable})),Ze.push.apply(Ze,fe)}return Ze}function Z(ce){for(var Oe=1;Oe<arguments.length;Oe++){var Ze=arguments[Oe]!=null?arguments[Oe]:{};Oe%2?Q(Object(Ze),!0).forEach(function(fe){B(ce,fe,Ze[fe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ce,Object.getOwnPropertyDescriptors(Ze)):Q(Object(Ze)).forEach(function(fe){Object.defineProperty(ce,fe,Object.getOwnPropertyDescriptor(Ze,fe))})}return ce}function R(ce,Oe,Ze,fe,Ae,Ye,ge){try{var Be=ce[Ye](ge),te=Be.value}catch(ke){Ze(ke);return}Be.done?Oe(te):Promise.resolve(te).then(fe,Ae)}function L(ce){return function(){var Oe=this,Ze=arguments;return new Promise(function(fe,Ae){var Ye=ce.apply(Oe,Ze);function ge(te){R(Ye,fe,Ae,ge,Be,"next",te)}function Be(te){R(Ye,fe,Ae,ge,Be,"throw",te)}ge(void 0)})}}function C(ce,Oe){if(!(ce instanceof Oe))throw new TypeError("Cannot call a class as a function")}function A(ce,Oe){for(var Ze=0;Ze<Oe.length;Ze++){var fe=Oe[Ze];fe.enumerable=fe.enumerable||!1,fe.configurable=!0,"value"in fe&&(fe.writable=!0),Object.defineProperty(ce,fe.key,fe)}}function N(ce,Oe,Ze){return Oe&&A(ce.prototype,Oe),Ze&&A(ce,Ze),ce}function B(ce,Oe,Ze){return Oe in ce?Object.defineProperty(ce,Oe,{value:Ze,enumerable:!0,configurable:!0,writable:!0}):ce[Oe]=Ze,ce}function O(ce,Oe){if(typeof Oe!="function"&&Oe!==null)throw new TypeError("Super expression must either be null or a function");ce.prototype=Object.create(Oe&&Oe.prototype,{constructor:{value:ce,writable:!0,configurable:!0}}),Oe&&K(ce,Oe)}function F(ce){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(Ze){return Ze.__proto__||Object.getPrototypeOf(Ze)},F(ce)}function K(ce,Oe){return K=Object.setPrototypeOf||function(fe,Ae){return fe.__proto__=Ae,fe},K(ce,Oe)}function nt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(ce){return!1}}function P(ce){if(ce===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ce}function k(ce,Oe){return Oe&&(typeof Oe=="object"||typeof Oe=="function")?Oe:P(ce)}function yt(ce){var Oe=nt();return function(){var fe=F(ce),Ae;if(Oe){var Ye=F(this).constructor;Ae=Reflect.construct(fe,arguments,Ye)}else Ae=fe.apply(this,arguments);return k(this,Ae)}}function st(ce,Oe){for(;!Object.prototype.hasOwnProperty.call(ce,Oe)&&(ce=F(ce),ce!==null););return ce}function lt(ce,Oe,Ze){return typeof Reflect!="undefined"&&Reflect.get?lt=Reflect.get:lt=function(Ae,Ye,ge){var Be=st(Ae,Ye);if(!!Be){var te=Object.getOwnPropertyDescriptor(Be,Ye);return te.get?te.get.call(ge):te.value}},lt(ce,Oe,Ze||ce)}function ht(ce){return mt(ce)||wt(ce)||ut(ce)||Nt()}function mt(ce){if(Array.isArray(ce))return pt(ce)}function wt(ce){if(typeof Symbol!="undefined"&&ce[Symbol.iterator]!=null||ce["@@iterator"]!=null)return Array.from(ce)}function ut(ce,Oe){if(!!ce){if(typeof ce=="string")return pt(ce,Oe);var Ze=Object.prototype.toString.call(ce).slice(8,-1);if(Ze==="Object"&&ce.constructor&&(Ze=ce.constructor.name),Ze==="Map"||Ze==="Set")return Array.from(ce);if(Ze==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ze))return pt(ce,Oe)}}function pt(ce,Oe){(Oe==null||Oe>ce.length)&&(Oe=ce.length);for(var Ze=0,fe=new Array(Oe);Ze<Oe;Ze++)fe[Ze]=ce[Ze];return fe}function Nt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ut=function(ce){O(Ze,ce);var Oe=yt(Ze);function Ze(fe){var Ae;return C(this,Ze),Ae=Oe.call(this,fe),Object.keys(fe).forEach(function(Ye){Ae[Ye]=fe[Ye]}),Ae.useBias=!0,Ae.biasInitializer=tt.initializers.zeros(),Ae.biasRegularizer=null,Ae}return N(Ze,[{key:"computeOutputShape",value:function(){return[null,this.units]}},{key:"build",value:function(){lt(F(Ze.prototype),"build",this).call(this),this.kernel=this.addWeight("kernel",[this.inputDim,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0):this.bias=null,this.built=!0}},{key:"call",value:function(Ae){var Ye=this;return tt.tidy(function(){var ge=Ae[0].shape,Be=ge[0]===1&&Ae[0].squeeze([0])||Ae[0],te=Ae[1].squeeze([0]),ke=tt.dot(te,Be);if(ke=tt.dot(ke,Ye.kernel.read()),Ye.bias&&(ke=ke.add(Ye.bias.read())),typeof Ye.activation=="string"){var Ve=W[Ye.activation];return Ye.activation==="primary"&&(Ve=function(Ft){return Ft}),Ve(ke)}return Ye.activation(ke)})}},{key:"getConfig",value:function(){var Ae=lt(F(Ze.prototype),"getConfig",this).call(this),Ye={units:this.units,support:this.support,activation:this.activation,useBias:this.useBias,inputDim:this.inputDim,kernelInitializer:this.kernelInitializer,biasInitializer:this.biasInitializer,kernelRegularizer:this.kernelRegularizer,biasRegularizer:this.biasRegularizer,activityRegularizer:this.activityRegularizer,kernelConstraint:this.kernelConstraint,biasConstraint:this.biasConstraint};return Z(Z({},Ae),Ye)}}]),Ze}(tt.layers.Layer);Ut.className="GraphConvLayer",tt.serialization.registerClass(Ut);var ue=function(ce){O(Ze,ce);var Oe=yt(Ze);function Ze(){return C(this,Ze),Oe.apply(this,arguments)}return N(Ze,[{key:"computeOutputShape",value:function(Ae){return[1,4]}},{key:"call",value:function(Ae){return tt.tidy(function(){for(var Ye=Ae[0].shape[0],ge=[],Be=0;Be<Ye;Be++)ge.push(1/Ye);var te=tt.tensor2d([ge]),ke=tt.dot(te,Ae[0]);return tt.softmax(ke)})}}]),Ze}(tt.layers.Layer);ue.className="GraphPoolingLayer",tt.serialization.registerClass(ue);var se=function(Oe,Ze,fe){for(var Ae={},Ye=Oe.length,ge=new Array(Ye),Be=new Array(Ye),te=0;te<ge.length;te++)ge[te]=new Array(Ye).fill(0);for(var ke=0;ke<Be.length;ke++)Be[ke]=new Array(fe).fill(0);for(var Ve=0;Ve<ge.length;Ve++)for(var ee=0;ee<ge.length;ee++)Ve===ee&&(ge[Ve][ee]=1);Oe.forEach(function(Rt,Xn){Ae[Rt.id]=Xn;for(var Bn=Ze.filter(function(Ur){return Ur.from===Rt.id}).length,xr=Ze.filter(function(Ur){return Ur.to===Rt.id}).length,dr=0;dr<fe;dr++)Be[Xn][dr]=(Bn+xr)/fe}),Ze.forEach(function(Rt){var Xn=Rt.to,Bn=Rt.from,xr=Ae[Xn],dr=Ae[Bn];xr===void 0||dr===void 0||(ge[dr][xr]=1,ge[xr][dr]=1)});var Ft=tt.tensor2d(ge),bt=tt.tensor2d(Be),Me=tt.diag(tt.pow(Ft.sum(1),tt.tensor(-.5)).flatten(),0),en=Ft.dot(Me).transpose().dot(Me),fn=bt.div(bt.sum(1).reshape([-1,1]).clipByValue(1e-8,Infinity));return[fn.expandDims(0),en.expandDims(0)]},Le=function(Oe){var Ze=Oe.nodes,fe=Ze===void 0?[]:Ze,Ae=Oe.edges,Ye=Ae===void 0?[]:Ae,ge=[],Be=[];return fe.forEach(function(te){ge.push({id:String(te.id)})}),Ye.forEach(function(te){Be.push({from:String(te.source||te.from),to:String(te.target||te.to)})}),{nodes:ge,edges:Be}},Ne=function(Oe,Ze,fe){console.log("%c@antv/vis-predict-engine\u56FE\u5E03\u5C40\u9884\u6D4B","color: #99CCCC;font-size: 16px;"),fe&&console.log("%c\u671F\u671B\u5E03\u5C40","background: #FFCC99;color:#fff;padding:5px;border-radius:5px;",fe),console.log("%c\u9884\u6D4B\u5E03\u5C40","background: #CCCCFF;color: #fff;padding:5px;border-radius:5px;",Oe),console.log("%c\u7F6E\u4FE1\u5EA6","background: #FF9966;color: #fff;padding:5px;border-radius:5px;",Ze)},we=["force","radial","concentric","circular"],At=null,Qt=function(){var ce=L(regeneratorRuntime.mark(function Oe(){return regeneratorRuntime.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:if(At){fe.next=3;break}return fe.next=3,tt.loadLayersModel("https://gw.alipayobjects.com/os/bmw-prod/c86b2dbb-ed03-421d-b080-2aad75cf4d47.json").then(function(Ae){At=Ae});case 3:return fe.abrupt("return",At);case 4:case"end":return fe.stop()}},Oe)}));return function(){return ce.apply(this,arguments)}}(),de=function(){var ce=L(regeneratorRuntime.mark(function Oe(){var Ze;return regeneratorRuntime.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:return Ae.next=2,Qt();case 2:return Ze=Ae.sent,Ae.abrupt("return",Ze);case 4:case"end":return Ae.stop()}},Oe)}));return function(){return ce.apply(this,arguments)}}(),rn=function(){var ce=L(regeneratorRuntime.mark(function Oe(Ze){var fe;return regeneratorRuntime.wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:if(Ze.nodes.length!==1){Ye.next=2;break}return Ye.abrupt("return",[0,0,0,1]);case 2:return fe=se(Ze.nodes,Ze.edges,32),Ye.next=5,At.predict(fe).data();case 5:return Ye.abrupt("return",Ye.sent);case 6:case"end":return Ye.stop()}},Oe)}));return function(Ze){return ce.apply(this,arguments)}}(),Ee={predict:function(Oe,Ze,fe){return L(regeneratorRuntime.mark(function Ae(){var Ye,ge,Be,te;return regeneratorRuntime.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return Ye=Le(Oe),Ve.next=3,de();case 3:if(!(Array.isArray(Oe==null?void 0:Oe.nodes)&&(Oe==null?void 0:Oe.nodes.length)>0)){Ve.next=11;break}return Ve.next=6,rn(Ye);case 6:return ge=Ve.sent,Be=we[ge.indexOf(Math.max.apply(Math,ht(ge)))],te="".concat((Math.max.apply(Math,ht(ge))*100).toFixed(2),"%"),fe&&Ne(Be,te,Ze),Ve.abrupt("return",{predictLayout:Be,confidence:te});case 11:return Ve.abrupt("return",{});case 12:case"end":return Ve.stop()}},Ae)}))()}};ot.n=Ee},87757:function(ur,ot,$){var Y=$(59591)();ur.exports=Y;try{regeneratorRuntime=Y}catch(tt){typeof globalThis=="object"?globalThis.regeneratorRuntime=Y:Function("r","regeneratorRuntime = r")(Y)}},42563:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{Abs:function(){return za},Acos:function(){return da},Acosh:function(){return Ti},AdadeltaOptimizer:function(){return sl},AdagradOptimizer:function(){return Zl},AdamOptimizer:function(){return Sl},AdamaxOptimizer:function(){return An},Add:function(){return ki},AddN:function(){return vi},All:function(){return ii},Any:function(){return Di},ArgMax:function(){return Ra},ArgMin:function(){return ln},Asin:function(){return De},Asinh:function(){return dn},Atan:function(){return Wn},Atan2:function(){return Kn},Atanh:function(){return Gn},AvgPool:function(){return Rr},AvgPool3D:function(){return La},AvgPool3DGrad:function(){return ui},AvgPoolGrad:function(){return xa},BatchMatMul:function(){return Fi},BatchToSpaceND:function(){return Ki},Bincount:function(){return xo},BroadcastTo:function(){return vo},Callback:function(){return UM},CallbackList:function(){return Ct},Cast:function(){return es},Ceil:function(){return Wo},ClipByValue:function(){return Zi},Complex:function(){return bi},ComplexAbs:function(){return gi},Concat:function(){return ms},Conv2D:function(){return Do},Conv2DBackpropFilter:function(){return To},Conv2DBackpropInput:function(){return Zs},Conv3D:function(){return Eu},Conv3DBackpropFilterV2:function(){return as},Conv3DBackpropInputV2:function(){return Rs},Cos:function(){return Su},Cosh:function(){return fu},CropAndResize:function(){return Zo},Cumsum:function(){return Is},CustomCallback:function(){return $t},DataStorage:function(){return Ae},DenseBincount:function(){return Wi},DepthToSpace:function(){return ys},DepthwiseConv2dNative:function(){return is},DepthwiseConv2dNativeBackpropFilter:function(){return Us},DepthwiseConv2dNativeBackpropInput:function(){return Du},Diag:function(){return qs},Dilation2D:function(){return Cu},Dilation2DBackpropFilter:function(){return Bi},Dilation2DBackpropInput:function(){return ji},ENV:function(){return Qn},EarlyStopping:function(){return VM},Elu:function(){return os},EluGrad:function(){return Ws},Environment:function(){return Xt},Equal:function(){return Qs},Erf:function(){return Ss},Exp:function(){return Qu},ExpandDims:function(){return xn},Expm1:function(){return Vr},FFT:function(){return pa},Fill:function(){return Fa},FlipLeftRight:function(){return Vi},Floor:function(){return Ao},FloorDiv:function(){return ao},FromPixels:function(){return ju},FusedBatchNorm:function(){return So},FusedConv2D:function(){return al},FusedDepthwiseConv2D:function(){return il},GatherNd:function(){return fo},GatherV2:function(){return Ts},GraphModel:function(){return rN},Greater:function(){return ou},GreaterEqual:function(){return Cs},History:function(){return kt},IFFT:function(){return Tl},Identity:function(){return Au},Imag:function(){return bl},InputSpec:function(){return c},IsFinite:function(){return Js},IsInf:function(){return ul},IsNan:function(){return Mu},KernelBackend:function(){return Ye},LRN:function(){return Bl},LRNGrad:function(){return vl},LayerVariable:function(){return Bp},LayersModel:function(){return Jg},LeakyRelu:function(){return Pu},Less:function(){return Nu},LessEqual:function(){return fs},LinSpace:function(){return Bs},Log:function(){return gu},Log1p:function(){return Fu},LogSoftmax:function(){return gc},LogicalAnd:function(){return Wu},LogicalNot:function(){return Ju},LogicalOr:function(){return tu},Max:function(){return Ls},MaxPool:function(){return oc},MaxPool3D:function(){return Ic},MaxPool3DGrad:function(){return Se},MaxPoolGrad:function(){return Ol},MaxPoolWithArgmax:function(){return ve},Maximum:function(){return el},Mean:function(){return Gt},Min:function(){return re},Minimum:function(){return me},MirrorPad:function(){return bn},Mod:function(){return Zn},MomentumOptimizer:function(){return hr},Multinomial:function(){return Yt},Multiply:function(){return Ie},Neg:function(){return Ge},NonMaxSuppressionV3:function(){return In},NonMaxSuppressionV4:function(){return ar},NonMaxSuppressionV5:function(){return ra},NotEqual:function(){return Fe},OP_SCOPE_SUFFIX:function(){return pp},OneHot:function(){return $a},OnesLike:function(){return Ta},Optimizer:function(){return zu},Pack:function(){return ja},PadV2:function(){return Oa},Pool:function(){return so},Pow:function(){return Ai},Prelu:function(){return Oi},Prod:function(){return hs},RMSPropOptimizer:function(){return Pr},RNN:function(){return Yv},Range:function(){return wo},Rank:function(){return wi},Real:function(){return ho},RealDiv:function(){return Ms},Reciprocal:function(){return Ro},Reduction:function(){return sh},Relu:function(){return Ys},Relu6:function(){return Rl},Reshape:function(){return Ps},ResizeBilinear:function(){return su},ResizeBilinearGrad:function(){return xl},ResizeNearestNeighbor:function(){return As},ResizeNearestNeighborGrad:function(){return Vs},Reverse:function(){return Ll},RotateWithOffset:function(){return tl},Round:function(){return nl},Rsqrt:function(){return rl},SGDOptimizer:function(){return sn},ScatterNd:function(){return Ef},Select:function(){return Sf},Selu:function(){return Yl},Sequential:function(){return O0},Sigmoid:function(){return pe},Sign:function(){return Kt},Sin:function(){return T},Sinh:function(){return rt},Slice:function(){return Cf},Softmax:function(){return rr},Softplus:function(){return Re},SpaceToBatchND:function(){return wn},SparseToDense:function(){return _r},SplitV:function(){return Mn},Sqrt:function(){return Je},Square:function(){return ca},SquaredDifference:function(){return We},Step:function(){return Bu},StridedSlice:function(){return Va},Sub:function(){return ha},Sum:function(){return an},SymbolicTensor:function(){return a},Tan:function(){return qa},Tanh:function(){return ma},Tensor:function(){return Nn},TensorBuffer:function(){return ae},Tile:function(){return Mi},TopK:function(){return zo},Transpose:function(){return _o},Unique:function(){return Lo},Unpack:function(){return yo},UnsortedSegmentSum:function(){return No},Variable:function(){return Pa},ZerosLike:function(){return Vu},_FusedMatMul:function(){return Hu},abs:function(){return fl},acos:function(){return yr},acosh:function(){return Mr},add:function(){return En},addN:function(){return fr},addStrict:function(){return Iu},all:function(){return Or},any:function(){return wa},argMax:function(){return ga},argMin:function(){return lo},asin:function(){return Qi},asinh:function(){return Mo},atan:function(){return yl},atan2:function(){return Ih},atanh:function(){return Lv},avgPool:function(){return S},avgPool3d:function(){return J},backend:function(){return gn},backend_util:function(){return F},basicLSTMCell:function(){return Ue},batchNorm:function(){return Yn},batchNorm2d:function(){return Un},batchNorm3d:function(){return Br},batchNorm4d:function(){return sa},batchToSpaceND:function(){return hn},bincount:function(){return va},booleanMaskAsync:function(){return ib},broadcastTo:function(){return ka},browser:function(){return Z},buffer:function(){return zs},callbacks:function(){return ZR},cast:function(){return qi},ceil:function(){return Li},clipByValue:function(){return fi},clone:function(){return th},complex:function(){return Pf},concat:function(){return vt},concat1d:function(){return Ja},concat2d:function(){return Po},concat3d:function(){return _s},concat4d:function(){return Co},constraints:function(){return nt},conv1d:function(){return Bo},conv2d:function(){return rs},conv2dTranspose:function(){return Nl},conv3d:function(){return nu},conv3dTranspose:function(){return Ru},copyRegisteredKernels:function(){return Vp},cos:function(){return Zh},cosh:function(){return Bc},cosineWindow:function(){return ub},cumsum:function(){return qh},customGrad:function(){return _u},data:function(){return ce},denseBincount:function(){return Cg},deprecationWarn:function(){return ea},depthToSpace:function(){return Fv},depthwiseConv2d:function(){return dv},deregisterOp:function(){return QR},device_util:function(){return j},diag:function(){return um},dilation2d:function(){return lm},disableDeprecationWarnings:function(){return Hr},dispose:function(){return M},disposeVariables:function(){return Ha},div:function(){return or},divNoNan:function(){return _g},divStrict:function(){return cg},dot:function(){return cm},dropout:function(){return yw},elu:function(){return fm},enableDebugMode:function(){return Sa},enableProdMode:function(){return ia},enclosingPowerOfTwo:function(){return bw},engine:function(){return Wa},env:function(){return He},equal:function(){return bd},equalStrict:function(){return G2},erf:function(){return H0},exp:function(){return Qh},expandDims:function(){return xd},expm1:function(){return X0},eye:function(){return jm},fft:function(){return r0},fill:function(){return Qo},findBackend:function(){return he},findBackendFactory:function(){return Te},floor:function(){return Ig},floorDiv:function(){return Dr},fused:function(){return B},gather:function(){return pv},gatherND:function(){return mw},gather_util:function(){return R},getBackend:function(){return jt},getGradient:function(){return tf},getKernel:function(){return Jc},getKernelsForBackend:function(){return zl},grad:function(){return Xu},grads:function(){return jo},greater:function(){return Ah},greaterEqual:function(){return Bv},greaterEqualStrict:function(){return U2},greaterStrict:function(){return W2},ifft:function(){return mm},imag:function(){return Z0},image:function(){return dg},inTopKAsync:function(){return iC},initializers:function(){return P},input:function(){return uM},io:function(){return W},irfft:function(){return fy},isFinite:function(){return Rx},isInf:function(){return Lx},isNaN:function(){return P1},keep:function(){return q},kernel_impls:function(){return K},layers:function(){return k},leakyRelu:function(){return Hm},less:function(){return Xm},lessEqual:function(){return Sc},lessEqualStrict:function(){return V2},lessStrict:function(){return j2},linalg:function(){return Wc},linspace:function(){return Bx},loadGraphModel:function(){return QL},loadLayersModel:function(){return lO},localResponseNormalization:function(){return F1},log:function(){return zc},log1p:function(){return q0},logSigmoid:function(){return B1},logSoftmax:function(){return Q0},logSumExp:function(){return Ym},logicalAnd:function(){return Ed},logicalNot:function(){return ag},logicalOr:function(){return Ag},logicalXor:function(){return U1},losses:function(){return g0},matMul:function(){return $s},math:function(){return Q},max:function(){return Gf},maxPool:function(){return Ng},maxPool3d:function(){return ey},maxPoolWithArgmax:function(){return ny},maximum:function(){return Jo},maximumStrict:function(){return l0},mean:function(){return nc},memory:function(){return Ga},metrics:function(){return yt},min:function(){return ig},minimum:function(){return og},minimumStrict:function(){return cw},mirrorPad:function(){return V1},mod:function(){return ry},modStrict:function(){return fw},model:function(){return sO},models:function(){return st},moments:function(){return Km},movingAverage:function(){return J2},mul:function(){return Hn},mulStrict:function(){return hw},multiRNNCell:function(){return Dp},multinomial:function(){return Xx},neg:function(){return oi},nextFrame:function(){return _y},norm:function(){return yy},notEqual:function(){return sg},notEqualStrict:function(){return H2},oneHot:function(){return Mc},ones:function(){return Op},onesLike:function(){return Jh},op:function(){return br},outerProduct:function(){return YS},pad:function(){return zv},pad1d:function(){return qS},pad2d:function(){return QS},pad3d:function(){return JS},pad4d:function(){return Zm},pool:function(){return H1},pow:function(){return po},powStrict:function(){return dw},prelu:function(){return kg},print:function(){return Kp},prod:function(){return oy},profile:function(){return Qa},rand:function(){return i2},randomGamma:function(){return l2},randomNormal:function(){return c2},randomUniform:function(){return du},range:function(){return Z1},ready:function(){return Pt},real:function(){return gm},reciprocal:function(){return q1},registerBackend:function(){return Ke},registerCallbackConstructor:function(){return cO},registerGradient:function(){return hh},registerKernel:function(){return wl},registerOp:function(){return qR},regularizers:function(){return lt},relu:function(){return td},relu6:function(){return Jm},removeBackend:function(){return ie},reshape:function(){return m},reverse:function(){return ed},reverse1d:function(){return h2},reverse2d:function(){return d2},reverse3d:function(){return v2},reverse4d:function(){return m2},rfft:function(){return a0},round:function(){return Q1},rsqrt:function(){return sy},scalar:function(){return zi},scatterND:function(){return vw},scatter_util:function(){return L},selu:function(){return Dg},separableConv2d:function(){return J1},sequential:function(){return uO},serialization:function(){return A},setBackend:function(){return _t},setPlatform:function(){return cn},setdiff1dAsync:function(){return aw},sigmoid:function(){return Bt},sign:function(){return tb},signal:function(){return WC},sin:function(){return uy},sinh:function(){return ly},slice:function(){return Zt},slice1d:function(){return cy},slice2d:function(){return eb},slice3d:function(){return t0},slice4d:function(){return e0},slice_util:function(){return C},softmax:function(){return n0},softplus:function(){return hm},spaceToBatchND:function(){return qm},sparseToDense:function(){return by},spectral:function(){return mb},split:function(){return nd},sqrt:function(){return Ci},square:function(){return _i},squaredDifference:function(){return i0},squaredDifferenceStrict:function(){return pu},squeeze:function(){return lg},stack:function(){return rd},step:function(){return ym},stridedSlice:function(){return nb},sub:function(){return pi},subStrict:function(){return pw},sum:function(){return ss},sumOutType:function(){return $o},tan:function(){return rb},tanh:function(){return be},tensor:function(){return yc},tensor1d:function(){return ad},tensor2d:function(){return Rp},tensor3d:function(){return Jp},tensor4d:function(){return wA},tensor5d:function(){return B2},tensor6d:function(){return o0},tensor_util:function(){return tt},test_util:function(){return N},tidy:function(){return Vn},tile:function(){return wd},time:function(){return dt},topk:function(){return bm},train:function(){return Pg},transpose:function(){return mu},truncatedNormal:function(){return dy},unique:function(){return py},unregisterGradient:function(){return fp},unregisterKernel:function(){return Nd},unsortedSegmentSum:function(){return vy},unstack:function(){return Sd},upcastType:function(){return uo},util:function(){return Y},valueAndGrad:function(){return Fl},valueAndGrads:function(){return ku},variable:function(){return ab},variableGrads:function(){return xs},version:function(){return X9},version_converter:function(){return aN},version_core:function(){return qn},version_layers:function(){return qg},where:function(){return Cl},whereAsync:function(){return u0},zeros:function(){return Uc},zerosLike:function(){return xi}});var Y={};$.r(Y),$.d(Y,{arraysEqual:function(){return Bn},assert:function(){return bt},assertNonNegativeIntegerDimensions:function(){return H},assertNonNull:function(){return en},assertShapesMatch:function(){return Me},bytesFromStringArray:function(){return wr},bytesPerElement:function(){return nr},checkConversionForErrors:function(){return tr},clamp:function(){return te},computeStrides:function(){return gt},createScalarValue:function(){return vf},createShuffledIndices:function(){return fa},decodeString:function(){return Dt},distSquared:function(){return Ft},encodeString:function(){return Pl},fetch:function(){return dp},flatten:function(){return fn},getArrayFromDType:function(){return Pn},getTypedArrayFromDType:function(){return sr},hasEncodingLoss:function(){return Wr},indexToLoc:function(){return xt},inferDtype:function(){return ua},inferFromImplicitShape:function(){return Da},isBoolean:function(){return pr},isFunction:function(){return $r},isInt:function(){return xr},isNumber:function(){return qr},isPromise:function(){return zt},isScalarShape:function(){return Xn},isString:function(){return Sr},isTypedArray:function(){return Yr},isValidDtype:function(){return zn},locToIndex:function(){return X},makeOnesTypedArray:function(){return Lt},makeZerosNestedTypedArray:function(){return it},makeZerosTypedArray:function(){return Ot},nearestDivisor:function(){return ba},nearestLargerEven:function(){return ke},now:function(){return js},parseAxisParam:function(){return Lr},randUniform:function(){return ee},repeatedTry:function(){return aa},rightPad:function(){return Ea},shuffle:function(){return Be},sizeFromShape:function(){return Rt},sizeToSquarishShape:function(){return Ur},squeezeShape:function(){return _n},sum:function(){return Ve},tanh:function(){return dr},toNestedArray:function(){return un},toTypedArray:function(){return Lf}});var tt={};$.r(tt),$.d(tt,{assertTypesMatch:function(){return ns},getTensorsInContainer:function(){return eo},isTensorInList:function(){return Xo},makeTypesMatch:function(){return Si}});var j={};$.r(j),$.d(j,{isBrowser:function(){return mc},isMobile:function(){return Hf}});var W={};$.r(W),$.d(W,{browserFiles:function(){return eh},browserHTTPRequest:function(){return gd},concatenateArrayBuffers:function(){return Kf},copyModel:function(){return xp},decodeWeights:function(){return tc},encodeWeights:function(){return Pc},fromMemory:function(){return Ud},getLoadHandlers:function(){return Bh},getModelArtifactsInfoForJSON:function(){return gh},getSaveHandlers:function(){return Dd},http:function(){return $d},isHTTPScheme:function(){return Tf},listModels:function(){return bp},loadWeights:function(){return Pd},moveModel:function(){return wp},registerLoadRouter:function(){return Zf},registerSaveRouter:function(){return mp},removeModel:function(){return dd},weightsLoaderFactory:function(){return Fd},withSaveHandler:function(){return Xh}});var Q={};$.r(Q),$.d(Q,{confusionMatrix:function(){return Vd}});var Z={};$.r(Z),$.d(Z,{fromPixels:function(){return nv},toPixels:function(){return ev}});var R={};$.r(R),$.d(R,{prepareAndValidate:function(){return Sh}});var L={};$.r(L),$.d(L,{calculateShapes:function(){return Gl},validateInput:function(){return tg},validateUpdateShape:function(){return rv}});var C={};$.r(C),$.d(C,{assertParamsValid:function(){return av},computeFlatOffset:function(){return sv},computeOutShape:function(){return Mf},getNormalizedAxes:function(){return ov},isSliceContinous:function(){return _p},maskToAxes:function(){return Af},parseSliceParams:function(){return uv},sliceInfo:function(){return Ip},startForAxis:function(){return Fc},startIndicesWithElidedDims:function(){return Nc},stopForAxis:function(){return jd},stopIndicesWithElidedDims:function(){return Ch},stridesForAxis:function(){return El},stridesWithElidedDims:function(){return Ov}});var A={};$.r(A),$.d(A,{Serializable:function(){return _h},SerializationMap:function(){return of},registerClass:function(){return li}});var N={};$.r(N),$.d(N,{TEST_EPSILON_FLOAT16:function(){return Tp},encodeStrings:function(){return vn},expectArrayBuffersEqual:function(){return oe},expectArraysClose:function(){return lv},expectArraysEqual:function(){return nh},expectNumbersClose:function(){return Rv},expectPromiseToFail:function(){return cv},expectValuesInRange:function(){return Np},testEpsilon:function(){return Ap}});var B={};$.r(B),$.d(B,{conv2d:function(){return lb},depthwiseConv2d:function(){return Ew},matMul:function(){return h0}});var O={};$.r(O),$.d(O,{collectGatherOpShapeInfo:function(){return bv},computeOutShape:function(){return Ib},segOpComputeOptimalWindowSize:function(){return _b}});var F={};$.r(F),$.d(F,{ERF_A1:function(){return xb},ERF_A2:function(){return wb},ERF_A3:function(){return ky},ERF_A4:function(){return Eb},ERF_A5:function(){return Zd},ERF_P:function(){return bb},PARALLELIZE_THRESHOLD:function(){return Iy},SELU_SCALE:function(){return Ny},SELU_SCALEALPHA:function(){return My},applyActivation:function(){return f0},assertAndGetBroadcastShape:function(){return Nr},assertAxesAreInnerMostDims:function(){return kf},assertParamsConsistent:function(){return yb},assignToTypedArray:function(){return Ow},axesAreInnerMostDims:function(){return z1},calculateShapes:function(){return Gl},castTensor:function(){return Lw},combineLocations:function(){return $1},complexWithEvenIndex:function(){return Cb},complexWithOddIndex:function(){return Wv},computeConv2DInfo:function(){return kc},computeConv3DInfo:function(){return Th},computeDefaultPad:function(){return im},computeDilation2DInfo:function(){return Nf},computeOptimalWindowSize:function(){return Ty},computeOutAndReduceShapes:function(){return uf},computeOutShape:function(){return mv},computePool2DInfo:function(){return mf},computePool3DInfo:function(){return Hd},convertConv2DDataFormat:function(){return hv},eitherStridesOrDilationsAreOne:function(){return Ec},expandShapeToKeepDim:function(){return $c},exponent:function(){return _m},exponents:function(){return Rw},fromStringArrayToUint8:function(){return Fw},fromUint8ToStringArray:function(){return Tb},getAxesPermutation:function(){return Gc},getBroadcastDims:function(){return $n},getComplexWithIndex:function(){return yv},getFusedBiasGradient:function(){return c0},getFusedDyActivation:function(){return xm},getImageCenter:function(){return m0},getInnerMostAxes:function(){return Qc},getPermuted:function(){return od},getReductionAxes:function(){return Jr},getReshaped:function(){return Kd},getReshapedPermuted:function(){return y0},getSliceBeginCoords:function(){return Ay},getSliceSize:function(){return Fg},getUndoAxesPermutation:function(){return dm},log:function(){return Sb},mergeRealAndImagArrays:function(){return Uv},prepareAndValidate:function(){return Sh},prepareSplitSize:function(){return Dy},reshapeTensor:function(){return Pw},segment_util:function(){return O},shouldFuse:function(){return Og},slice_util:function(){return C},splitRealAndImagArrays:function(){return Cm},tupleValuesAreOne:function(){return Kh},upcastType:function(){return uo},validateInput:function(){return tg},validateUpdateShape:function(){return rv},warn:function(){return Sm}});var K={};$.r(K),$.d(K,{nonMaxSuppressionV3Impl:function(){return wy},nonMaxSuppressionV4Impl:function(){return Ey},nonMaxSuppressionV5Impl:function(){return Sy},whereImpl:function(){return s0}});var nt={};$.r(nt),$.d(nt,{maxNorm:function(){return Q_},minMaxNorm:function(){return yE},nonNeg:function(){return mE},unitNorm:function(){return ep}});var P={};$.r(P),$.d(P,{constant:function(){return fI},glorotNormal:function(){return PE},glorotUniform:function(){return gI},heNormal:function(){return mI},heUniform:function(){return yI},identity:function(){return pI},leCunNormal:function(){return bI},leCunUniform:function(){return FE},ones:function(){return cI},orthogonal:function(){return xI},randomNormal:function(){return LE},randomUniform:function(){return hI},truncatedNormal:function(){return dI},varianceScaling:function(){return vI},zeros:function(){return lI}});var k={};$.r(k),$.d(k,{Layer:function(){return l},RNN:function(){return Yv},RNNCell:function(){return cx},activation:function(){return FO},add:function(){return HO},alphaDropout:function(){return MR},average:function(){return XO},averagePooling1d:function(){return ET},averagePooling2d:function(){return ST},averagePooling3d:function(){return CT},avgPool1d:function(){return nR},avgPool2d:function(){return aR},avgPool3d:function(){return oR},avgPooling1d:function(){return rR},avgPooling2d:function(){return iR},avgPooling3d:function(){return sR},batchNormalization:function(){return JO},bidirectional:function(){return wR},concatenate:function(){return YO},conv1d:function(){return MO},conv2d:function(){return NO},conv2dTranspose:function(){return kO},conv3d:function(){return DO},convLstm2d:function(){return mR},convLstm2dCell:function(){return yR},cropping2D:function(){return RO},dense:function(){return BO},depthwiseConv2d:function(){return PO},dot:function(){return QO},dropout:function(){return zO},elu:function(){return SO},embedding:function(){return jO},flatten:function(){return GO},gaussianDropout:function(){return AR},gaussianNoise:function(){return TR},globalAveragePooling1d:function(){return uR},globalAveragePooling2d:function(){return lR},globalMaxPool1d:function(){return SR},globalMaxPool2d:function(){return CR},globalMaxPooling1d:function(){return BM},globalMaxPooling2d:function(){return zM},gru:function(){return fR},gruCell:function(){return hR},input:function(){return uM},inputLayer:function(){return EO},layerNormalization:function(){return tR},leakyReLU:function(){return _O},lstm:function(){return dR},lstmCell:function(){return pR},masking:function(){return NR},maxPool1d:function(){return _R},maxPool2d:function(){return IR},maxPooling1d:function(){return $M},maxPooling2d:function(){return GM},maxPooling3d:function(){return cR},maximum:function(){return KO},minimum:function(){return ZO},multiply:function(){return qO},permute:function(){return VO},prelu:function(){return IO},reLU:function(){return CO},repeatVector:function(){return UO},reshape:function(){return WO},rnn:function(){return bR},separableConv2d:function(){return OO},simpleRNN:function(){return vR},simpleRNNCell:function(){return gR},softmax:function(){return TO},spatialDropout1d:function(){return $O},stackedRNNCells:function(){return xR},thresholdedReLU:function(){return AO},timeDistributed:function(){return ER},upSampling2d:function(){return LO},zeroPadding2d:function(){return eR}});var yt={};$.r(yt),$.d(yt,{MAPE:function(){return GR},MSE:function(){return VR},binaryAccuracy:function(){return kR},binaryCrossentropy:function(){return DR},categoricalAccuracy:function(){return RR},categoricalCrossentropy:function(){return LR},cosineProximity:function(){return BR},mape:function(){return UR},meanAbsoluteError:function(){return zR},meanAbsolutePercentageError:function(){return $R},meanSquaredError:function(){return WR},mse:function(){return jR},precision:function(){return PR},recall:function(){return FR},sparseCategoricalAccuracy:function(){return OR}});var st={};$.r(st),$.d(st,{modelFromJSON:function(){return rO}});var lt={};$.r(lt),$.d(lt,{l1:function(){return XR},l1l2:function(){return HR},l2:function(){return YR}});var ht={};$.r(ht),$.d(ht,{json:function(){return tL}});var mt={};$.r(mt),$.d(mt,{json:function(){return eL}});var wt={};$.r(wt),$.d(wt,{json:function(){return nL}});var ut={};$.r(ut),$.d(ut,{json:function(){return rL}});var pt={};$.r(pt),$.d(pt,{json:function(){return aL}});var Nt={};$.r(Nt),$.d(Nt,{json:function(){return iL}});var Ut={};$.r(Ut),$.d(Ut,{json:function(){return oL}});var ue={};$.r(ue),$.d(ue,{json:function(){return sL}});var se={};$.r(se),$.d(se,{json:function(){return uL}});var Le={};$.r(Le),$.d(Le,{json:function(){return lL}});var Ne={};$.r(Ne),$.d(Ne,{json:function(){return cL}});var we={};$.r(we),$.d(we,{json:function(){return fL}});var At={};$.r(At),$.d(At,{json:function(){return hL}});var Qt={};$.r(Qt),$.d(Qt,{json:function(){return dL}});var de={};$.r(de),$.d(de,{json:function(){return pL}});var rn={};$.r(rn),$.d(rn,{json:function(){return vL}});var Ee={};$.r(Ee),$.d(Ee,{json:function(){return gL}});var ce={};$.r(ce),$.d(ce,{CSVDataset:function(){return mN},Dataset:function(){return v1},FileDataSource:function(){return EN},TextLineDataset:function(){return pN},URLDataSource:function(){return SN},array:function(){return yP},csv:function(){return NP},func:function(){return kP},generator:function(){return DP},microphone:function(){return RP},version_data:function(){return CN},webcam:function(){return OP},zip:function(){return bP}});var Oe={};$.r(Oe),$.d(Oe,{addImpl:function(){return NN},bincountImpl:function(){return HT},bincountReduceImpl:function(){return PN},ceilImpl:function(){return FN},concatImpl:function(){return BN},expImpl:function(){return UN},expm1Impl:function(){return VN},floorImpl:function(){return XN},gatherV2Impl:function(){return YN},greaterImpl:function(){return KN},lessImpl:function(){return ZN},linSpaceImpl:function(){return qN},logImpl:function(){return QN},maxImpl:function(){return JN},maximumImpl:function(){return ek},minimumImpl:function(){return nk},multiplyImpl:function(){return XT},negImpl:function(){return ak},notEqualImpl:function(){return ik},prodImpl:function(){return lk},rangeImpl:function(){return ck},rsqrtImpl:function(){return fk},simpleAbsImpl:function(){return DN},sliceImpl:function(){return LN},squaredDifferenceImpl:function(){return pk},stridedSliceImpl:function(){return vk},subImpl:function(){return jN},tileImpl:function(){return gk},topKImpl:function(){return mk},transposeImpl:function(){return VT},uniqueImpl:function(){return yk}});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ze=1e-7,fe=1e-4;class Ae{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class Ye{decComplexRef(t){}time(t){return ge("time")}read(t){return ge("read")}readSync(t){return ge("readSync")}numDataIds(){return ge("numDataIds")}disposeData(t){return ge("disposeData")}write(t,n,o){return ge("write")}move(t,n,o,u){return ge("move")}memory(){return ge("memory")}floatPrecision(){return ge("floatPrecision")}epsilon(){return this.floatPrecision()===32?Ze:fe}batchMatMul(t,n,o,u){return ge("batchMatMul")}fusedBatchMatMul({a:t,b:n,transposeA:o,transposeB:u,bias:h,activation:p,preluActivationWeights:g}){return ge("fusedBatchMatMul")}slice(t,n,o){return ge("slice")}stridedSlice(t,n,o,u){return ge("stridedSlice")}unstack(t,n){return ge("unstack")}reverse(t,n){return ge("reverse")}concat(t,n){return ge("concat")}neg(t){return ge("neg")}add(t,n){return ge("add")}addN(t){return ge("addN")}subtract(t,n){return ge("subtract")}multiply(t,n){return ge("multiply")}realDivide(t,n){return ge("realDivide")}floorDiv(t,n){return ge("floorDiv")}sum(t,n){return ge("sum")}prod(t,n){return ge("prod")}unsortedSegmentSum(t,n,o){return ge("unsortedSegmentSum")}argMin(t,n){return ge("argMin")}argMax(t,n){return ge("argMax")}equal(t,n){return ge("equal")}notEqual(t,n){return ge("notEqual")}less(t,n){return ge("less")}lessEqual(t,n){return ge("lessEqual")}greater(t,n){return ge("greater")}greaterEqual(t,n){return ge("greaterEqual")}logicalNot(t){return ge("logicalNot")}logicalAnd(t,n){return ge("logicalAnd")}logicalOr(t,n){return ge("logicalOr")}where(t){return ge("where")}select(t,n,o){return ge("select")}topk(t,n,o){return ge("topk")}min(t,n){return ge("min")}minimum(t,n){return ge("minimum")}mod(t,n){return ge("mod")}max(t,n){return ge("max")}maximum(t,n){return ge("maximum")}all(t,n){return ge("all")}any(t,n){return ge("any")}squaredDifference(t,n){return ge("squaredDifference")}ceil(t){return ge("ceil")}floor(t){return ge("floor")}round(t){return ge("round")}sign(t){return ge("sign")}isNaN(t){return ge("isNaN")}isInf(t){return ge("isInf")}isFinite(t){return ge("isFinite")}pow(t,n){return ge("pow")}exp(t){return ge("exp")}expm1(t){return ge("expm1")}softmax(t,n){return ge("softmax")}log(t){return ge("log")}log1p(t){return ge("log1p")}sqrt(t){return ge("sqrt")}rsqrt(t){return ge("rsqrt")}square(t){return ge("square")}reciprocal(t){return ge("reciprocal")}relu(t){return ge("relu")}relu6(t){return ge("relu6")}prelu(t,n){return ge("prelu")}elu(t){return ge("elu")}eluDer(t,n){return ge("eluDer")}selu(t){return ge("selu")}int(t){return ge("int")}clip(t,n,o){return ge("clip")}abs(t){return ge("abs")}complexAbs(t){return ge("complexAbs")}sigmoid(t){return ge("sigmoid")}softplus(t){return ge("softplus")}sin(t){return ge("sin")}cos(t){return ge("cos")}tan(t){return ge("tan")}asin(t){return ge("asin")}acos(t){return ge("acos")}atan(t){return ge("atan")}atan2(t,n){return ge("atan2")}sinh(t){return ge("sinh")}cosh(t){return ge("cosh")}tanh(t){return ge("tanh")}asinh(t){return ge("asinh")}acosh(t){return ge("acosh")}atanh(t){return ge("atanh")}erf(t){return ge("erf")}step(t,n){return ge("step")}fusedConv2d({input:t,filter:n,convInfo:o,bias:u,activation:h,preluActivationWeights:p}){return ge("fusedConv2d")}conv2d(t,n,o){return ge("conv2d")}conv2dDerInput(t,n,o){return ge("conv2dDerInput")}conv2dDerFilter(t,n,o){return ge("conv2dDerFilter")}fusedDepthwiseConv2D({input:t,filter:n,convInfo:o,bias:u,activation:h,preluActivationWeights:p}){return ge("fusedDepthwiseConv2D")}depthwiseConv2D(t,n,o){return ge("depthwiseConv2D")}depthwiseConv2DDerInput(t,n,o){return ge("depthwiseConv2DDerInput")}depthwiseConv2DDerFilter(t,n,o){return ge("depthwiseConv2DDerFilter")}conv3d(t,n,o){return ge("conv3d")}conv3dDerInput(t,n,o){return ge("conv3dDerInput")}conv3dDerFilter(t,n,o){return ge("conv3dDerFilter")}maxPool(t,n){return ge("maxPool")}maxPoolBackprop(t,n,o,u){return ge("maxPoolBackprop")}avgPool(t,n){return ge("avgPool")}avgPoolBackprop(t,n,o){return ge("avgPoolBackprop")}avgPool3d(t,n){return ge("avgPool3d")}avgPool3dBackprop(t,n,o){return ge("avgPool3dBackprop")}maxPool3d(t,n){return ge("maxPool3d")}maxPool3dBackprop(t,n,o,u){return ge("maxPool3dBackprop")}reshape(t,n){return ge("reshape")}cast(t,n){return ge("cast")}tile(t,n){return ge("tile")}pad(t,n,o){return ge("pad")}transpose(t,n){return ge("transpose")}gather(t,n,o,u=0){return ge("gather")}gatherND(t,n){return ge("gatherND")}scatterND(t,n,o){return ge("scatterND")}batchToSpaceND(t,n,o){return ge("batchToSpaceND")}spaceToBatchND(t,n,o){return ge("spaceToBatchND")}resizeBilinear(t,n,o,u,h){return ge("resizeBilinear")}resizeBilinearBackprop(t,n,o){return ge("resizeBilinearBackprop")}resizeNearestNeighbor(t,n,o,u,h){return ge("resizeNearestNeighbor")}resizeNearestNeighborBackprop(t,n,o){return ge("resizeNearestNeighborBackprop")}batchNorm(t,n,o,u,h,p){return ge("batchNorm")}localResponseNormalization4D(t,n,o,u,h){return ge("localResponseNormalization4D")}LRNGrad(t,n,o,u,h,p,g){return ge("LRNGrad")}multinomial(t,n,o,u){return ge("multinomial")}oneHot(t,n,o,u){return ge("oneHot")}cumsum(t,n,o,u){return ge("cumsum")}nonMaxSuppression(t,n,o,u,h){return ge("nonMaxSuppression")}fft(t){return ge("fft")}ifft(t){return ge("ifft")}complex(t,n){return ge("complex")}real(t){return ge("real")}imag(t){return ge("imag")}cropAndResize(t,n,o,u,h,p){return ge("cropAndResize")}depthToSpace(t,n,o){return ge("depthToSpace")}split(t,n,o){return ge("split")}sparseToDense(t,n,o,u){return ge("sparseToDense")}diag(t){return ge("diag")}fill(t,n,o){return ge("fill")}onesLike(t){return ge("onesLike")}zerosLike(t){return ge("zerosLike")}linspace(t,n,o){return ge("linspace")}dispose(){return ge("dispose")}}function ge(r){throw new Error(`'${r}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Be(r){let t=r.length,n=0,o=0;for(;t>0;)o=Math.random()*t|0,t--,n=r[t],r[t]=r[o],r[o]=n}function te(r,t,n){return Math.max(r,Math.min(t,n))}function ke(r){return r%2==0?r:r+1}function Ve(r){let t=0;for(let n=0;n<r.length;n++)t+=r[n];return t}function ee(r,t){const n=Math.random();return t*n+(1-n)*r}function Ft(r,t){let n=0;for(let o=0;o<r.length;o++){const u=Number(r[o])-Number(t[o]);n+=u*u}return n}function bt(r,t){if(!r)throw new Error(typeof t=="string"?t:t())}function Me(r,t,n=""){bt(Bn(r,t),()=>n+` Shapes ${r} and ${t} must match`)}function en(r){bt(r!=null,()=>"The input to the tensor constructor must be a non-null value.")}function fn(r,t=[],n=!1){if(t==null&&(t=[]),Array.isArray(r)||Yr(r)&&!n)for(let o=0;o<r.length;++o)fn(r[o],t,n);else t.push(r);return t}function Rt(r){if(r.length===0)return 1;let t=r[0];for(let n=1;n<r.length;n++)t*=r[n];return t}function Xn(r){return r.length===0}function Bn(r,t){if(r===t)return!0;if(r==null||t==null||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(r[n]!==t[n])return!1;return!0}function xr(r){return r%1==0}function dr(r){if(Math.tanh!=null)return Math.tanh(r);if(r===Infinity)return 1;if(r===-Infinity)return-1;{const t=Math.exp(2*r);return(t-1)/(t+1)}}function Ur(r){const t=Math.ceil(Math.sqrt(r));return[t,Math.ceil(r/t)]}function fa(r){const t=new Uint32Array(r);for(let n=0;n<r;++n)t[n]=n;return Be(t),t}function Ea(r,t){return t<=r.length?r:r+" ".repeat(t-r.length)}function aa(r,t=o=>0,n){return new Promise((o,u)=>{let h=0;const p=()=>{if(r()){o();return}h++;const g=t(h);if(n!=null&&h>=n){u();return}setTimeout(p,g)};p()})}function Da(r,t){let n=1,o=-1;for(let h=0;h<r.length;++h)if(r[h]>=0)n*=r[h];else if(r[h]===-1){if(o!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${o} and dim ${h}`);o=h}else if(r[h]<0)throw Error(`Shapes can not be < 0. Found ${r[h]} at dim ${h}`);if(o===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${r}`);return r}if(n===0)throw Error(`Cannot infer the missing size in [${r}] when there are 0 elements`);if(t%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const u=r.slice();return u[o]=t/n,u}function Lr(r,t){const n=t.length;return r=r==null?t.map((o,u)=>u):[].concat(r),bt(r.every(o=>o>=-n&&o<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${r}`),bt(r.every(o=>xr(o)),()=>`All values in axis param must be integers but got axis ${r}`),r.map(o=>o<0?n+o:o)}function _n(r,t){const n=[],o=[],u=t!=null&&Array.isArray(t)&&t.length===0,h=t==null||u?null:Lr(t,r).sort();let p=0;for(let g=0;g<r.length;++g){if(h!=null){if(h[p]===g&&r[g]!==1)throw new Error(`Can't squeeze axis ${g} since its dim '${r[g]}' is not 1`);(h[p]==null||h[p]>g)&&r[g]===1&&(n.push(r[g]),o.push(g)),h[p]<=g&&p++}r[g]!==1&&(n.push(r[g]),o.push(g))}return{newShape:n,keptDims:o}}function sr(r,t){let n=null;if(r==null||r==="float32")n=new Float32Array(t);else if(r==="int32")n=new Int32Array(t);else if(r==="bool")n=new Uint8Array(t);else throw new Error(`Unknown data type ${r}`);return n}function Pn(r,t){let n=null;if(r==null||r==="float32")n=new Float32Array(t);else if(r==="int32")n=new Int32Array(t);else if(r==="bool")n=new Uint8Array(t);else if(r==="string")n=new Array(t);else throw new Error(`Unknown data type ${r}`);return n}function tr(r,t){for(let n=0;n<r.length;n++){const o=r[n];if(isNaN(o)||!isFinite(o))throw Error(`A tensor of type ${t} being uploaded contains ${o}.`)}}function zn(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function Wr(r,t){return!(t==="complex64"||t==="float32"&&r!=="complex64"||t==="int32"&&r!=="float32"&&r!=="complex64"||t==="bool"&&r==="bool")}function Yr(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array}function nr(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error(`Unknown dtype ${r}`)}function wr(r){if(r==null)return 0;let t=0;return r.forEach(n=>t+=n.length),t}function Sr(r){return typeof r=="string"||r instanceof String}function pr(r){return typeof r=="boolean"}function qr(r){return typeof r=="number"}function ua(r){return Array.isArray(r)?ua(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array?"int32":qr(r)?"float32":Sr(r)?"string":pr(r)?"bool":"float32"}function $r(r){return!!(r&&r.constructor&&r.call&&r.apply)}function ba(r,t){for(let n=t;n<r;++n)if(r%n==0)return n;return r}function gt(r){const t=r.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=r[t-1];for(let o=t-3;o>=0;--o)n[o]=n[o+1]*r[o+1];return n}function Dn(r,t,n){const o=new Array;if(t.length===1){const u=t[0];for(let h=0;h<u;h++)o[h]=n[r+h]}else{const u=t[0],h=t.slice(1),p=h.reduce((g,b)=>g*b);for(let g=0;g<u;g++)o[g]=Dn(r+g*p,h,n)}return o}function un(r,t){if(r.length===0)return t[0];const n=r.reduce((o,u)=>o*u);if(n===0)return[];if(n!==t.length)throw new Error(`[${r}] does not match the input size ${t.length}.`);return Dn(0,r,t)}function Lt(r,t){const n=Ot(r,t);for(let o=0;o<n.length;o++)n[o]=1;return n}function Ot(r,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool")return new Uint8Array(r);throw new Error(`Unknown data type ${t}`)}function it(r,t){const n=r.reduce((o,u)=>o*u,1);if(t==null||t==="float32")return un(r,new Float32Array(n));if(t==="int32")return un(r,new Int32Array(n));if(t==="bool")return un(r,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function H(r){r.forEach(t=>{bt(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${r}].`)})}function X(r,t,n){if(t===0)return 0;if(t===1)return r[0];let o=r[r.length-1];for(let u=0;u<r.length-1;++u)o+=n[u]*r[u];return o}function xt(r,t,n){if(t===0)return[];if(t===1)return[r];const o=new Array(t);for(let u=0;u<o.length-1;++u)o[u]=Math.floor(r/n[u]),r-=o[u]*n[u];return o[o.length-1]=r,o}function zt(r){return r&&r.then&&typeof r.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vt="tfjsflags";class Xt{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${n}.`),this.platformName=t,this.platform=n}registerFlag(t,n,o){if(this.flagRegistry[t]={evaluationFn:n,setHook:o},this.urlFlags[t]!=null){const u=this.urlFlags[t];console.warn(`Setting feature override from URL ${t}: ${u}.`),this.set(t,u)}}getAsync(t){return jr(this,null,function*(){return t in this.flags?this.flags[t]:(this.flags[t]=yield this.evaluateFlag(t),this.flags[t])})}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(zt(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")return;const t=ne(this.global.location.search);Vt in t&&t[Vt].split(",").forEach(o=>{const[u,h]=o.split(":");this.urlFlags[u]=tn(u,h)})}}function ne(r){const t={};return r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...o)=>(on(t,o[0],o[1]),o.join("="))),t}function on(r,t,n){r[decodeURIComponent(t)]=decodeURIComponent(n||"")}function tn(r,t){if(t=t.toLowerCase(),t==="true"||t==="false")return t==="true";if(`${+t}`===t)return+t;throw new Error(`Could not parse value flag value ${t} for flag ${r}.`)}function He(){return Qn}let Qn=null;function Ln(r){Qn=r}var Qr=$(34155);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ia;function Jn(){if(Ia==null){let r;if(typeof window!="undefined")r=window;else if(typeof $.g!="undefined")r=$.g;else if(typeof Qr!="undefined")r=Qr;else if(typeof self!="undefined")r=self;else throw new Error("Could not find a global object");Ia=r}return Ia}function Ar(){const r=Jn();return r._tfGlobals==null&&(r._tfGlobals=new Map),r._tfGlobals}function na(r,t){const n=Ar();if(n.has(r))return n.get(r);{const o=t();return n.set(r,o),n.get(r)}}const za="Abs",da="Acos",Ti="Acosh",ki="Add",vi="AddN",ii="All",Di="Any",Ra="ArgMax",ln="ArgMin",De="Asin",dn="Asinh",Wn="Atan",Gn="Atanh",Kn="Atan2",Rr="AvgPool",xa="AvgPoolGrad",La="AvgPool3D",ui="AvgPool3DGrad",Fi="BatchMatMul",Ki="BatchToSpaceND",xo="Bincount",vo="BroadcastTo",es="Cast",Wo="Ceil",Zi="ClipByValue",bi="Complex",gi="ComplexAbs",ms="Concat",Do="Conv2D",To="Conv2DBackpropFilter",Zs="Conv2DBackpropInput",Eu="Conv3D",as="Conv3DBackpropFilterV2",Rs="Conv3DBackpropInputV2",Su="Cos",fu="Cosh",Is="Cumsum",Zo="CropAndResize",Wi="DenseBincount",ys="DepthToSpace",is="DepthwiseConv2dNative",Us="DepthwiseConv2dNativeBackpropFilter",Du="DepthwiseConv2dNativeBackpropInput",qs="Diag",Cu="Dilation2D",ji="Dilation2DBackpropInput",Bi="Dilation2DBackpropFilter",Ms="RealDiv",os="Elu",Ws="EluGrad",Ss="Erf",Qs="Equal",Qu="Exp",xn="ExpandDims",Vr="Expm1",pa="FFT",Fa="Fill",Vi="FlipLeftRight",Ao="Floor",ao="FloorDiv",So="FusedBatchNorm",Ts="GatherV2",fo="GatherNd",ou="Greater",Cs="GreaterEqual",Au="Identity",Tl="IFFT",bl="Imag",Js="IsFinite",ul="IsInf",Mu="IsNan",Pu="LeakyRelu",Nu="Less",fs="LessEqual",Bs="LinSpace",gu="Log",Fu="Log1p",Wu="LogicalAnd",Ju="LogicalNot",tu="LogicalOr",gc="LogSoftmax",Bl="LRN",vl="LRNGrad",Ls="Max",el="Maximum",oc="MaxPool",Ol="MaxPoolGrad",Ic="MaxPool3D",Se="MaxPool3DGrad",ve="MaxPoolWithArgmax",Gt="Mean",re="Min",me="Minimum",bn="MirrorPad",Zn="Mod",Yt="Multinomial",Ie="Multiply",Ge="Neg",Fe="NotEqual",In="NonMaxSuppressionV3",ar="NonMaxSuppressionV4",ra="NonMaxSuppressionV5",Ta="OnesLike",$a="OneHot",ja="Pack",Oa="PadV2",so="Pool",Ai="Pow",Oi="Prelu",hs="Prod",wo="Range",ho="Real",Ro="Reciprocal",Ys="Relu",Ps="Reshape",As="ResizeNearestNeighbor",Vs="ResizeNearestNeighborGrad",su="ResizeBilinear",xl="ResizeBilinearGrad",Rl="Relu6",Ll="Reverse",nl="Round",rl="Rsqrt",Ef="ScatterNd",Sf="Select",Yl="Selu",Cf="Slice",T="Sin",rt="Sinh",Kt="Sign",pe="Sigmoid",Re="Softplus",Je="Sqrt",an="Sum",wn="SpaceToBatchND",Mn="SplitV",rr="Softmax",We="SquaredDifference",ca="Square",ha="Sub",_r="SparseToDense",Va="StridedSlice",qa="Tan",ma="Tanh",Mi="Tile",zo="TopK",_o="Transpose",Lo="Unique",yo="Unpack",No="UnsortedSegmentSum",Vu="ZerosLike",Bu="Step",ju="FromPixels",tl="RotateWithOffset",Hu="_FusedMatMul",al="FusedConv2D",il="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ds=na("kernelRegistry",()=>new Map),uu=na("gradRegistry",()=>new Map);function Jc(r,t){const n=dh(r,t);return ds.get(n)}function tf(r){return uu.get(r)}function zl(r){const t=ds.entries(),n=[];for(;;){const{done:o,value:u}=t.next();if(o)break;const[h,p]=u,[g]=h.split("_");g===r&&n.push(p)}return n}function wl(r){const{kernelName:t,backendName:n}=r,o=dh(t,n);ds.has(o)&&console.warn(`The kernel '${t}' for backend '${n}' is already registered`),ds.set(o,r)}function hh(r){const{kernelName:t}=r;uu.has(t)&&He().getBool("DEBUG")&&console.warn(`Overriding the gradient for '${t}'`),uu.set(t,r)}function Nd(r,t){const n=dh(r,t);if(!ds.has(n))throw new Error(`The kernel '${r}' for backend '${t}' is not registered`);ds.delete(n)}function fp(r){if(!uu.has(r))throw new Error(`The gradient '${r}' for backend is not registered`);uu.delete(r)}function Vp(r,t){zl(r).forEach(o=>{const u=Object.assign({},o,{backendName:t});wl(u)})}function dh(r,t){return`${t}_${r}`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kd{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new df)}profileKernel(t,n,o){let u;const h=()=>{u=o()},p=this.backendTimer.time(h);if(He().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let b=0;b<u.length;b++){const _=u[b];_.data().then(z=>{jp(z,_.dtype,t)})}return{kernelName:t,outputs:u,inputs:n,timeMs:p.then(b=>b.kernelMs),extraInfo:p.then(b=>b.getExtraProfileInfo!=null?b.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:o,timeMs:u,inputs:h,extraInfo:p}=t;o.forEach(g=>{Promise.all([g.data(),u,p]).then(b=>{this.logger.logKernelProfile(n,g,b[0],b[1],h,b[2])})})}}function jp(r,t,n){if(t!=="float32")return!1;for(let o=0;o<r.length;o++){const u=r[o];if(isNaN(u)||!isFinite(u))return console.warn(`Found ${u} in the result of '${n}'`),!0}return!1}class df{logKernelProfile(t,n,o,u,h,p){const g=typeof u=="number"?Ea(`${u}ms`,9):u.error,b=Ea(t,25),_=n.rank,z=n.size,V=Ea(n.shape.toString(),14);let at="";for(const Et in h){const St=h[Et];if(St!=null){const Tt=St.shape||n.shape,Wt=Tt.length;at+=`${Et}: ${Wt}D ${Wt>0?Tt:""} `}}console.log(`%c${b}	%c${g}	%c${_}D ${V}	%c${z}	%c${at}	%c${p}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rf(r,t,n){const o={},u={};for(let b=0;b<t.length;b++)o[t[b].id]=!0;for(let b=0;b<r.length;b++){const _=r[b],z=_.inputs;for(const V in z){const at=z[V];let Et=!1;for(let St=0;St<t.length;St++)if(o[at.id]){_.outputs.forEach(Tt=>o[Tt.id]=!0),Et=!0,u[_.id]=!0;break}if(Et)break}}const h={};h[n.id]=!0;const p={};for(let b=r.length-1;b>=0;b--){const _=r[b],z=_.inputs;for(let V=0;V<_.outputs.length;V++)if(h[_.outputs[V].id]){for(const at in z)h[z[at].id]=!0,p[_.id]=!0;break}}const g=[];for(let b=0;b<r.length;b++){const _=r[b];if(u[_.id]&&p[_.id]){const z={};for(const at in _.inputs){const Et=_.inputs[at];o[Et.id]&&(z[at]=Et)}const V=Object.assign({},_);V.inputs=z,V.outputs=_.outputs,g.push(V)}}return g}function hp(r,t,n,o){for(let u=t.length-1;u>=0;u--){const h=t[u],p=[];if(h.outputs.forEach(b=>{const _=r[b.id];_!=null?p.push(_):p.push(null)}),h.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${h.kernelName}.`);const g=h.gradient(p);for(const b in h.inputs){if(!(b in g))throw new Error(`Cannot backprop through input ${b}. Available gradients found: ${Object.keys(g)}.`);const _=n(()=>g[b]());if(_.dtype!=="float32")throw new Error(`Error in gradient for op ${h.kernelName}. The gradient of input ${b} must have 'float32' dtype, but has '${_.dtype}'`);const z=h.inputs[b];if(!Bn(_.shape,z.shape))throw new Error(`Error in gradient for op ${h.kernelName}. The gradient of input '${b}' has shape '${_.shape}', which does not match the shape of the input '${z.shape}'`);if(r[z.id]==null)r[z.id]=_;else{const V=r[z.id];r[z.id]=o(V,_),V.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jf=20,pf=3,ph=7;function Ri(r,t,n,o){const u=gt(t),h=Lh(r,t,n,u),p=t.length,g=sc(r,t,n,u,h),b=["Tensor"];return o&&(b.push(`  dtype: ${n}`),b.push(`  rank: ${p}`),b.push(`  shape: [${t}]`),b.push("  values:")),b.push(g.map(_=>"    "+_).join(`
`)),b.join(`
`)}function Lh(r,t,n,o){const u=Rt(t),h=o[o.length-1],p=new Array(h).fill(0),g=t.length,b=n==="complex64"?ef(r):r;if(g>1)for(let _=0;_<u/h;_++){const z=_*h;for(let V=0;V<h;V++)p[V]=Math.max(p[V],bs(b[z+V],0,n).length)}return p}function bs(r,t,n){let o;return Array.isArray(r)?o=`${parseFloat(r[0].toFixed(ph))} + ${parseFloat(r[1].toFixed(ph))}j`:Sr(r)?o=`'${r}'`:n==="bool"?o=Ph(r):o=parseFloat(r.toFixed(ph)).toString(),Ea(o,t)}function Ph(r){return r===0?"false":"true"}function sc(r,t,n,o,u,h=!0){const p=n==="complex64"?2:1,g=t[0],b=t.length;if(b===0){if(n==="complex64"){const Tt=ef(r);return[bs(Tt[0],0,n)]}return n==="bool"?[Ph(r[0])]:[r[0].toString()]}if(b===1){if(g>jf){const Wt=pf*p;let le=Array.from(r.slice(0,Wt)),ye=Array.from(r.slice((g-pf)*p,g*p));return n==="complex64"&&(le=ef(le),ye=ef(ye)),["["+le.map((Qe,$e)=>bs(Qe,u[$e],n)).join(", ")+", ..., "+ye.map((Qe,$e)=>bs(Qe,u[g-pf+$e],n)).join(", ")+"]"]}const Tt=n==="complex64"?ef(r):Array.from(r);return["["+Tt.map((Wt,le)=>bs(Wt,u[le],n)).join(", ")+"]"]}const _=t.slice(1),z=o.slice(1),V=o[0]*p,at=[];if(g>jf){for(let Tt=0;Tt<pf;Tt++){const Wt=Tt*V,le=Wt+V;at.push(...sc(r.slice(Wt,le),_,n,z,u,!1))}at.push("...");for(let Tt=g-pf;Tt<g;Tt++){const Wt=Tt*V,le=Wt+V;at.push(...sc(r.slice(Wt,le),_,n,z,u,Tt===g-1))}}else for(let Tt=0;Tt<g;Tt++){const Wt=Tt*V,le=Wt+V;at.push(...sc(r.slice(Wt,le),_,n,z,u,Tt===g-1))}const Et=b===2?",":"";at[0]="["+at[0]+Et;for(let Tt=1;Tt<at.length-1;Tt++)at[Tt]=" "+at[Tt]+Et;let St=`,
`;for(let Tt=2;Tt<b;Tt++)St+=`
`;return at[at.length-1]=" "+at[at.length-1]+"]"+(h?"":St),at}function ef(r){const t=[];for(let n=0;n<r.length;n+=2)t.push([r[n],r[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vf(r,t){return t==="string"?Pl(r):Lf([r],t)}function vh(r,t){return r instanceof Float32Array&&t==="float32"||r instanceof Int32Array&&t==="int32"||r instanceof Uint8Array&&t==="bool"}function Lf(r,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=fn(r)),He().getBool("DEBUG")&&tr(r,t),vh(r,t))return r;if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool"){const n=new Uint8Array(r.length);for(let o=0;o<n.length;++o)Math.round(r[o])!==0&&(n[o]=1);return n}else throw new Error(`Unknown data type ${t}`)}function js(){return He().platform.now()}function dp(r,t){return He().platform.fetch(r,t)}function Pl(r,t="utf-8"){return t=t||"utf-8",He().platform.encode(r,t)}function Dt(r,t="utf-8"){return t=t||"utf-8",He().platform.decode(r,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ae{constructor(t,n,o){if(this.dtype=n,this.shape=t.slice(),this.size=Rt(t),o!=null){const u=o.length;bt(u===this.size,()=>`Length of values '${u}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=o||Pn(n,this.size),this.strides=gt(t)}set(t,...n){n.length===0&&(n=[0]),bt(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const o=this.locToIndex(n);this.values[o]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const u of t){if(u<0||u>=this.shape[n]){const h=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(h)}n++}let o=t[t.length-1];for(let u=0;u<t.length-1;++u)o+=this.strides[u]*t[u];return this.values[o]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let o=0;o<t.length-1;++o)n+=this.strides[o]*t[o];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let o=0;o<n.length-1;++o)n[o]=Math.floor(t/this.strides[o]),t-=n[o]*this.strides[o];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return xe().makeTensor(this.values,this.shape,this.dtype)}}let xe=null,qe=null,yn=null;function Er(r){xe=r}function Cr(r){qe=r}function oa(r){yn=r}class Nn{constructor(t,n,o,u){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Rt(t),this.strides=gt(t),this.dataId=o,this.id=u,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}buffer(){return jr(this,null,function*(){const t=yield this.data();return qe.buffer(this.shape,this.dtype,t)})}bufferSync(){return qe.buffer(this.shape,this.dtype,this.dataSync())}array(){return jr(this,null,function*(){const t=yield this.data();return un(this.shape,t)})}arraySync(){return un(this.shape,this.dataSync())}data(){return jr(this,null,function*(){this.throwIfDisposed();const t=xe().read(this.dataId);if(this.dtype==="string"){const n=yield t;try{return n.map(o=>Dt(o))}catch(o){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t})}dataSync(){this.throwIfDisposed();const t=xe().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>Dt(n))}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}bytes(){return jr(this,null,function*(){this.throwIfDisposed();const t=yield xe().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)})}dispose(){this.isDisposed||(xe().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return qe.print(this,t)}clone(){return this.throwIfDisposed(),qe.clone(this)}toString(t=!1){const n=this.dataSync();return Ri(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),qe.cast(this,t)}variable(t=!0,n,o){return this.throwIfDisposed(),xe().makeVariable(this,t,n,o)}}Object.defineProperty(Nn,Symbol.hasInstance,{value:r=>!!r&&r.data!=null&&r.dataSync!=null&&r.throwIfDisposed!=null});class Pa extends Nn{constructor(t,n,o,u){super(t.shape,t.dtype,t.dataId,u);this.trainable=n,this.name=o}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!Bn(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);xe().disposeTensor(this),this.dataId=t.dataId,xe().incRef(this,null)}dispose(){xe().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Pa,Symbol.hasInstance,{value:r=>r instanceof Nn&&r.assign!=null&&r.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wi;(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(wi||(wi={}));var Ui;(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})(Ui||(Ui={}));var Ei;(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(Ei||(Ei={}));var Oo;(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(Oo||(Oo={}));var us;(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(us||(us={}));const Vo={float32:Oo,int32:Ui,bool:Ei,complex64:us};function uo(r,t){if(r==="string"||t==="string"){if(r==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${r} with ${t}`)}return Vo[r][t]}function $o(r){return uo(r,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Si(r,t){if(r.dtype===t.dtype)return[r,t];const n=uo(r.dtype,t.dtype);return[r.cast(n),t.cast(n)]}function ns(r,t){bt(r.dtype===t.dtype,()=>`The dtypes of the first(${r.dtype}) and second(${t.dtype}) input must match`)}function Xo(r,t){return t.some(n=>n.id===r.id)}function eo(r){const t=[],n=new Set;return qo(r,t,n),t}function qo(r,t,n){if(r==null)return;if(r instanceof Nn){t.push(r);return}if(!Ns(r))return;const o=r;for(const u in o){const h=o[u];n.has(h)||(n.add(h),qo(h,t,n))}}function Ns(r){return Array.isArray(r)||typeof r=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lu{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class ls{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new lu}ready(){return jr(this,null,function*(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const o=t[n];if(yield this.initializeBackend(o).success){yield this.setBackend(o);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")})}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,o=1){return t in this.registryFactory?(console.warn(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:o},!0)}setBackend(t){return jr(this,null,function*(){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:o}=this.initializeBackend(t);if(!(o?yield n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new kd(this.backendInstance),!0})}setupRegisteredKernels(){zl(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){zl(t).forEach(o=>{o.disposeFunc!=null&&o.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const o=n.factory();if(o&&!(o instanceof Ye)&&typeof o.then=="function"){const u=++this.pendingBackendInitId,h=o.then(p=>u<this.pendingBackendInitId?!1:(this.registry[t]=p,this.pendingBackendInit=null,!0)).catch(p=>(u<this.pendingBackendInitId||(this.pendingBackendInit=null,console.warn(`Initialization of backend ${t} failed`),console.warn(p.stack||p.message)),!1));return this.pendingBackendInit=h,{success:h,asyncInit:!0}}else return this.registry[t]=o,{success:!0,asyncInit:!1}}catch(o){return console.warn(`Initialization of backend ${t} failed`),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const o=t[n],{success:u,asyncInit:h}=this.initializeBackend(o);if(h||u)return{name:o,asyncInit:h}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const o=this.state.tensorInfo.get(n),u=o.backend,h=this.readSync(n);u.disposeData(n),o.backend=t,t.move(n,h,o.shape,o.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let o=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=t}let u;return this.scopedRun(()=>this.startScope(o),()=>this.endScope(u),()=>(u=n(),u instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),u))}scopedRun(t,n,o){t();try{const u=o();return n(),u}catch(u){throw n(),u}}nextTensorId(){return ls.nextTensorId++}nextVariableId(){return ls.nextVariableId++}clone(t){const n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),o={x:t},u=p=>({x:()=>{const g="float32",b={x:p},_={dtype:g};return lr.runKernelFunc(z=>z.cast(p,g),b,null,es,_)}}),h=[];return this.addTapeNode(this.state.activeScope.name,o,[n],u,h,{}),n}runKernel(t,n,o,u,h){const p=null,g=null;return this.runKernelFunc(p,n,g,t,o,u,h)}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,o){const u=this.backend.numDataIds();let h=0;o.forEach(b=>{h+=b.dtype==="complex64"?3:1});const p=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],g=u-n-h-p;if(g>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${g} data ids) after running '${t}'`)}runKernelFunc(t,n,o,u,h,p,g){let b,_=[];const z=this.isTapeOn();u==null&&(u=this.state.activeScope!=null?this.state.activeScope.name:"");const V=this.state.numBytes,at=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let Et;this.backendName==null&&this.backend;const St=Jc(u,this.backendName);let Tt;if(St!=null)Et=()=>{const le=this.backend.numDataIds();Tt=St.kernelFunc({inputs:n,attrs:h,backend:this.backend});const ye=Array.isArray(Tt)?Tt:[Tt];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,le,ye);const Qe=ye.map($e=>{if($e.rank!=null)return $e;const{dataId:Xe,shape:Rn,dtype:Cn}=$e;return this.makeTensorFromDataId(Xe,Rn,Cn)});if(z){let $e=this.getTensorsForGradient(u,n,Qe);if($e==null){g==null&&(g=[]);const Xe=Qe.filter((Rn,Cn)=>g[Cn]);$e=(p||[]).slice().concat(Xe)}_=this.saveTensorsForBackwardMode($e)}return Qe};else{if(t==null)throw new Error(`Error running ${u}: Neither modular kernel nor forward func passed`);const le=ye=>{!z||(_=ye.map(Qe=>this.keep(this.clone(Qe))))};Et=()=>{const ye=this.backend.numDataIds();Tt=this.tidy(()=>t(this.backend,le));const Qe=Array.isArray(Tt)?Tt:[Tt];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,ye,Qe),Qe}}let Wt;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?b=Et():(Wt=this.profiler.profileKernel(u,n,()=>Et()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(Wt),b=Wt.outputs)}),z&&this.addTapeNode(u,n,b,o,_,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-V,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-at,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(le=>n[le]!=null?n[le].shape:null),outputShapes:b.map(le=>le.shape),kernelTimeMs:Wt.timeMs,extraInfo:Wt.extraInfo}),Array.isArray(Tt)?b:b[0]}saveTensorsForBackwardMode(t){return t.map(o=>this.keep(this.clone(o)))}getTensorsForGradient(t,n,o){const u=tf(t);if(u!=null){const h=u.inputsToSave||[],p=u.outputsToSave||[];let g;u.saveAllInputs?(bt(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),g=Object.keys(n).map(_=>n[_])):g=h.map(_=>n[_]);const b=o.filter((_,z)=>p[z]);return g.concat(b)}return null}makeTensor(t,n,o,u){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");o=o||"float32",u=u||this.backend;let h=t;o==="string"&&Sr(t[0])&&(h=t.map(b=>Pl(b)));const p=u.write(h,n,o),g=new Nn(n,o,p,this.nextTensorId());if(this.incRef(g,u),o==="string"){const b=this.state.tensorInfo.get(p),_=wr(h);this.state.numBytes+=_-b.bytes,b.bytes=_}return g}makeTensorFromDataId(t,n,o,u){o=o||"float32";const h=new Nn(n,o,t,this.nextTensorId());return this.incRef(h,u),h}makeVariable(t,n=!0,o,u){o=o||this.nextVariableId().toString(),u!=null&&u!==t.dtype&&(t=t.cast(u));const h=new Pa(t,n,o,this.nextTensorId());if(this.state.registeredVariables[h.name]!=null)throw new Error(`Variable with name ${h.name} was already registered`);return this.state.registeredVariables[h.name]=h,this.incRef(h,this.backend),h}incRef(t,n){const o=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,o===0){this.state.numDataBuffers++;let u=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(u=t.size*nr(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:u,refCount:0}),this.state.numBytes+=u}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Pa||this.track(t)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;const n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):(n.backend.decComplexRef(t.dataId),this.state.tensorInfo.get(t.dataId).refCount--)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}profile(t){return jr(this,null,function*(){this.state.profiling=!0;const n=this.state.numBytes,o=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=yield t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(u=>u.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-o;for(const u of this.state.activeProfile.kernels)u.kernelTimeMs=yield u.kernelTimeMs,u.extraInfo=yield u.extraInfo;return this.state.activeProfile})}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,o,u,h,p){const g={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:o,saved:h},b=tf(t);b!=null&&(u=b.gradFunc),u!=null&&(g.gradient=_=>(_=_.map((z,V)=>{if(z==null){const at=o[V],Et=Ot(at.size,at.dtype);return this.makeTensor(Et,at.shape,at.dtype)}return z}),u(_.length>1?_:_[0],h,p))),this.state.activeTape.push(g)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=eo(t),o=new Set(n.map(h=>h.id));for(let h=0;h<this.state.activeScope.track.length;h++){const p=this.state.activeScope.track[h];!p.kept&&!o.has(p.id)&&p.dispose()}const u=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(h=>{!h.kept&&h.scopeId===u.id&&this.track(h)})}gradients(t,n,o,u=!1){if(bt(n.length>0,()=>"gradients() received an empty list of xs."),o!=null&&o.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${o.dtype}'`);const h=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));bt(h instanceof Nn,()=>"The result y returned by f() must be a tensor.");const p=Rf(this.state.activeTape,n,h);if(!u&&p.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const g={};g[h.id]=o==null?ks(h.shape):o,hp(g,p,_=>this.tidy(_),ll);const b=n.map(_=>g[_.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(_=>{for(const z of _.saved)z.dispose()}),this.state.activeTape=null),{value:h,grads:b}})}customGrad(t){return bt($r(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{bt(n.every(h=>h instanceof Nn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let o;const u={};return n.forEach((h,p)=>{u[p]=h}),this.runKernelFunc((h,p)=>(o=t(...n,p),bt(o.value instanceof Nn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),bt($r(o.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),o.value),u,(h,p)=>{const g=o.gradFunc(h,p),b=Array.isArray(g)?g:[g];bt(b.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),bt(b.every(z=>z instanceof Nn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const _={};return b.forEach((z,V)=>{_[V]=()=>z}),_})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}time(t){return jr(this,null,function*(){const n=js(),o=yield this.backend.time(t);return o.wallMs=js()-n,o})}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new lu;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}ls.nextTensorId=0,ls.nextVariableId=0;function ks(r){const t=Lt(Rt(r),"float32");return lr.makeTensor(t,r,"float32")}function Ou(){const r=Jn();if(r._tfengine==null){const t=new Xt(r);r._tfengine=new ls(t)}return Ln(r._tfengine.ENV),Er(()=>r._tfengine),r._tfengine}const lr=Ou();function ll(r,t){const n={a:r,b:t};return lr.runKernel(ki,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mo(){return typeof navigator!="undefined"&&navigator!=null}function Hf(){if(mo()){const r=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(r)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(r.substr(0,4))}return!1}function mc(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}var Xc=$(34155);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jl=He();Jl.registerFlag("DEBUG",()=>!1,r=>{r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Jl.registerFlag("IS_BROWSER",()=>mc()),Jl.registerFlag("IS_NODE",()=>typeof Xc!="undefined"&&typeof Xc.versions!="undefined"&&typeof Xc.versions.node!="undefined"),Jl.registerFlag("IS_CHROME",()=>typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),Jl.registerFlag("PROD",()=>!1),Jl.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Jl.getBool("DEBUG")),Jl.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),Jl.registerFlag("IS_TEST",()=>!1),Jl.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kl(r,t){let n=r;if(Yr(r))return t==="string"?[]:[r.length];if(!Array.isArray(r))return[];const o=[];for(;Array.isArray(n)||Yr(n)&&t!=="string";)o.push(n.length),n=n[0];return Array.isArray(r)&&He().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Xf(r,o,[]),o}function Xf(r,t,n){if(n=n||[],!Array.isArray(r)&&!Yr(r)){bt(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}bt(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${r.length} elements`),bt(r.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${r.length} elements`);const o=t.slice(1);for(let u=0;u<r.length;++u)Xf(r[u],o,n.concat(u))}function Hp(r,t,n,o){if(r!=="string_or_numeric"){if(r==null)throw new Error("Expected dtype cannot be null.");if(r!=="numeric"&&r!==t||r==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${o}' must be ${r} tensor, but got ${t} tensor`)}}function mn(r,t,n,o="numeric"){if(r instanceof Nn)return Hp(o,r.dtype,t,n),r;let u=ua(r);if(u!=="string"&&["bool","int32","float32"].indexOf(o)>=0&&(u=o),Hp(o,u,t,n),r==null||!Yr(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){const b=r==null?"null":r.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${b}'`)}const h=Kl(r,u);!Yr(r)&&!Array.isArray(r)&&(r=[r]);const g=u!=="string"?Lf(r,u):fn(r,[],!0);return lr.makeTensor(g,h,u)}function Yc(r,t,n,o="numeric"){if(!Array.isArray(r))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return r.map((h,p)=>mn(h,`${t}[${p}]`,n,o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pp="__op";function br(r){const t=Object.keys(r);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const o=r[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+pp;const u=(...h)=>{lr.startScope(n);try{const p=o(...h);return zt(p)&&console.error("Cannot return a Promise inside of tidy."),lr.endScope(p),p}catch(p){throw lr.endScope(null),p}};return Object.defineProperty(u,"name",{value:n,configurable:!0}),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yf(r,t){const n=mn(r,"real","complex"),o=mn(t,"imag","complex");Me(n.shape,o.shape,`real and imag shapes, ${n.shape} and ${o.shape}, must match in call to tf.complex().`);const u={real:n,imag:o};return lr.runKernel(bi,u)}const Pf=br({complex_:Yf});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tc(r,t,n,o){if(o==null&&(o=ua(r)),o==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Yr(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){H(t);const u=Rt(t),h=Rt(n);bt(u===h,()=>`Based on the provided shape, [${t}], the tensor should have ${u} values but has ${h}`);for(let p=0;p<n.length;++p){const g=n[p],b=p===n.length-1?g!==Rt(t.slice(p)):!0;bt(n[p]===t[p]||!b,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Yr(r)&&!Array.isArray(r)&&(r=[r]),t=t||n,r=o!=="string"?Lf(r,o):fn(r,[],!0),lr.makeTensor(r,t,o)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yc(r,t,n){const o=Kl(r,n);return Tc(r,t,o,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gf={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};var nf=$(48764).Buffer;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ol=4;function Pc(r,t){return jr(this,null,function*(){const n=[],o=[],u=Array.isArray(r)?r.map(p=>p.name):Object.keys(r);for(let p=0;p<u.length;++p){const g=u[p],b=Array.isArray(r)?r[p].tensor:r[g];if(b.dtype!=="float32"&&b.dtype!=="int32"&&b.dtype!=="bool"&&b.dtype!=="string"&&b.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${g}': ${b.dtype}`);const _={name:g,shape:b.shape,dtype:b.dtype};if(b.dtype==="string"){const z=new Promise(V=>jr(this,null,function*(){const at=yield b.bytes(),Et=at.reduce((Wt,le)=>Wt+le.length,0)+ol*at.length,St=new Uint8Array(Et);let Tt=0;for(let Wt=0;Wt<at.length;Wt++){const le=at[Wt],ye=new Uint8Array(new Uint32Array([le.length]).buffer);St.set(ye,Tt),Tt+=ol,St.set(le,Tt),Tt+=le.length}V(St)}));o.push(z)}else o.push(b.data());t!=null&&(_.group=t),n.push(_)}const h=yield Promise.all(o);return{data:Ff(h),specs:n}})}function tc(r,t){const n={};let o,u=0;for(const h of t){const p=h.name,g=h.dtype,b=h.shape,_=Rt(b);let z;if("quantization"in h){const V=h.quantization;if(V.dtype==="uint8"||V.dtype==="uint16"){if(!("min"in V&&"scale"in V))throw new Error(`Weight ${h.name} with quantization ${V.dtype} doesn't have corresponding metadata min and scale.`)}else if(V.dtype==="float16"){if(g!=="float32")throw new Error(`Weight ${h.name} is quantized with ${V.dtype} which only supports weights of type float32 not ${g}.`)}else throw new Error(`Weight ${h.name} has unknown quantization dtype ${V.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const at=gf[V.dtype],Et=r.slice(u,u+_*at),St=V.dtype==="uint8"?new Uint8Array(Et):new Uint16Array(Et);if(g==="float32")if(V.dtype==="uint8"||V.dtype==="uint16"){z=new Float32Array(St.length);for(let Tt=0;Tt<St.length;Tt++){const Wt=St[Tt];z[Tt]=Wt*V.scale+V.min}}else if(V.dtype==="float16")o===void 0&&(o=fd()),z=o(St);else throw new Error(`Unsupported quantization type ${V.dtype} for weight type float32.`);else if(g==="int32"){if(V.dtype!=="uint8"&&V.dtype!=="uint16")throw new Error(`Unsupported quantization type ${V.dtype} for weight type int32.`);z=new Int32Array(St.length);for(let Tt=0;Tt<St.length;Tt++){const Wt=St[Tt];z[Tt]=Math.round(Wt*V.scale+V.min)}}else throw new Error(`Unsupported dtype in weight '${p}': ${g}`);u+=_*at}else if(g==="string"){const V=Rt(h.shape);z=[];for(let at=0;at<V;at++){const Et=new Uint32Array(r.slice(u,u+ol))[0];u+=ol;const St=new Uint8Array(r.slice(u,u+Et));z.push(St),u+=Et}}else{const V=gf[g],at=r.slice(u,u+_*V);if(g==="float32")z=new Float32Array(at);else if(g==="int32")z=new Int32Array(at);else if(g==="bool")z=new Uint8Array(at);else if(g==="complex64"){z=new Float32Array(at);const Et=new Float32Array(z.length/2),St=new Float32Array(z.length/2);for(let le=0;le<Et.length;le++)Et[le]=z[le*2],St[le]=z[le*2+1];const Tt=yc(Et,b,"float32"),Wt=yc(St,b,"float32");n[p]=Pf(Tt,Wt),Tt.dispose(),Wt.dispose()}else throw new Error(`Unsupported dtype in weight '${p}': ${g}`);u+=_*V}g!=="complex64"&&(n[p]=yc(z,b,g))}return n}function Ff(r){if(r===null)throw new Error(`Invalid input value: ${JSON.stringify(r)}`);let t=0;const n=[];r.forEach(h=>{if(t+=h.byteLength,n.push(h.byteLength===h.buffer.byteLength?h:new h.constructor(h)),!(h instanceof Float32Array||h instanceof Int32Array||h instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${h.constructor.name}`)});const o=new Uint8Array(t);let u=0;return n.forEach(h=>{o.set(new Uint8Array(h.buffer),u),u+=h.byteLength}),o.buffer}const Ac=typeof nf!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function Av(r){return Ac?nf.byteLength(r):new Blob([r]).size}function Bf(r){if(Ac)return nf.from(r).toString("base64");const t=new Uint8Array(r);let n="";for(let o=0,u=t.length;o<u;o++)n+=String.fromCharCode(t[o]);return btoa(n)}function zf(r){if(Ac){const o=nf.from(r,"base64");return o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength)}const t=atob(r),n=new Uint8Array(t.length);for(let o=0;o<t.length;++o)n.set([t.charCodeAt(o)],o);return n.buffer}function Kf(r){if(r.length===1)return r[0];let t=0;r.forEach(u=>{t+=u.byteLength});const n=new Uint8Array(t);let o=0;return r.forEach(u=>{n.set(new Uint8Array(u),o),o+=u.byteLength}),n.buffer}function Fh(r){const t="/";for(r=r.trim();r.endsWith(t);)r=r.slice(0,r.length-1);const n=r.split(t);return n[n.length-1]}function gh(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:Av(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:Av(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}function mh(){const r=n=>{let o=n<<13,u=0;for(;(o&8388608)==0;)u-=8388608,o<<=1;return o&=~8388608,u+=947912704,o|u},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=r(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function vp(){const r=new Uint32Array(64);r[0]=0,r[31]=1199570944,r[32]=2147483648,r[63]=3347054592;for(let t=1;t<31;t++)r[t]=t<<23;for(let t=33;t<63;t++)r[t]=2147483648+(t-32<<23);return r}function gp(){const r=new Uint32Array(64);for(let t=0;t<64;t++)r[t]=1024;return r[0]=r[32]=0,r}function fd(){const r=mh(),t=vp(),n=gp();return o=>{const u=new ArrayBuffer(4*o.length),h=new Uint32Array(u);for(let p=0;p<o.length;p++){const g=o[p],b=r[n[g>>10]+(g&1023)]+t[g>>10];h[p]=b}return new Float32Array(u)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gl{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return gl.instance==null&&(gl.instance=new gl),gl.instance}static registerSaveRouter(t){gl.getInstance().saveRouters.push(t)}static registerLoadRouter(t){gl.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return gl.getHandlers(t,"save")}static getLoadHandlers(t,n){return gl.getHandlers(t,"load",n)}static getHandlers(t,n,o){const u=[];return(n==="load"?gl.getInstance().loadRouters:gl.getInstance().saveRouters).forEach(p=>{const g=p(t,o);g!==null&&u.push(g)}),u}}const mp=r=>gl.registerSaveRouter(r),Zf=r=>gl.registerLoadRouter(r),Dd=r=>gl.getSaveHandlers(r),Bh=(r,t)=>gl.getLoadHandlers(r,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zh="tensorflowjs",uc=1,ml="models_store",Al="model_info_store";function qv(){return jr(this,null,function*(){const r=ps();return new Promise((t,n)=>{const o=r.deleteDatabase(zh);o.onsuccess=()=>t(),o.onerror=u=>n(u)})})}function ps(){if(!He().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const r=typeof window=="undefined"?self:window,t=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function ec(r){const t=r.result;t.createObjectStore(ml,{keyPath:"modelPath"}),t.createObjectStore(Al,{keyPath:"modelPath"})}class ir{constructor(t){if(this.indexedDB=ps(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}save(t){return jr(this,null,function*(){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)})}load(){return jr(this,null,function*(){return this.databaseAction(this.modelPath)})}databaseAction(t,n){return new Promise((o,u)=>{const h=this.indexedDB.open(zh,uc);h.onupgradeneeded=()=>ec(h),h.onsuccess=()=>{const p=h.result;if(n==null){const g=p.transaction(ml,"readonly"),_=g.objectStore(ml).get(this.modelPath);_.onsuccess=()=>{if(_.result==null)return p.close(),u(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));o(_.result.modelArtifacts)},_.onerror=z=>(p.close(),u(_.error)),g.oncomplete=()=>p.close()}else{const g=gh(n),b=p.transaction(Al,"readwrite");let _=b.objectStore(Al);const z=_.put({modelPath:this.modelPath,modelArtifactsInfo:g});let V;z.onsuccess=()=>{V=p.transaction(ml,"readwrite");const Et=V.objectStore(ml).put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:g});Et.onsuccess=()=>o({modelArtifactsInfo:g}),Et.onerror=St=>{_=b.objectStore(Al);const Tt=_.delete(this.modelPath);Tt.onsuccess=()=>(p.close(),u(Et.error)),Tt.onerror=Wt=>(p.close(),u(Et.error))}},z.onerror=at=>(p.close(),u(z.error)),b.oncomplete=()=>{V==null?p.close():V.oncomplete=()=>p.close()}}},h.onerror=p=>u(h.error)})}}ir.URL_SCHEME="indexeddb://";const no=r=>He().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(ir.URL_SCHEME)?yh(r.slice(ir.URL_SCHEME.length)):null;gl.registerSaveRouter(no),gl.registerLoadRouter(no);function yh(r){return new ir(r)}function $h(r){return r.startsWith(ir.URL_SCHEME)?r.slice(ir.URL_SCHEME.length):r}class Xp{constructor(){this.indexedDB=ps()}listModels(){return jr(this,null,function*(){return new Promise((t,n)=>{const o=this.indexedDB.open(zh,uc);o.onupgradeneeded=()=>ec(o),o.onsuccess=()=>{const u=o.result,h=u.transaction(Al,"readonly"),g=h.objectStore(Al).getAll();g.onsuccess=()=>{const b={};for(const _ of g.result)b[_.modelPath]=_.modelArtifactsInfo;t(b)},g.onerror=b=>(u.close(),n(g.error)),h.oncomplete=()=>u.close()},o.onerror=u=>n(o.error)})})}removeModel(t){return jr(this,null,function*(){return t=$h(t),new Promise((n,o)=>{const u=this.indexedDB.open(zh,uc);u.onupgradeneeded=()=>ec(u),u.onsuccess=()=>{const h=u.result,p=h.transaction(Al,"readwrite"),g=p.objectStore(Al),b=g.get(t);let _;b.onsuccess=()=>{if(b.result==null)return h.close(),o(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const z=g.delete(t),V=()=>{_=h.transaction(ml,"readwrite");const Et=_.objectStore(ml).delete(t);Et.onsuccess=()=>n(b.result.modelArtifactsInfo),Et.onerror=St=>o(b.error)};z.onsuccess=V,z.onerror=at=>(V(),h.close(),o(b.error))}},b.onerror=z=>(h.close(),o(b.error)),p.oncomplete=()=>{_==null?h.close():_.oncomplete=()=>h.close()}},u.onerror=h=>o(u.error)})})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $l="/",qf="tensorflowjs_models",Od="info",Gh="model_topology",Qf="weight_specs",Uh="weight_data",yp="model_metadata";function Ml(){if(!env().getBool("IS_BROWSER")||typeof window=="undefined"||typeof window.localStorage=="undefined")throw new Error("purgeLocalStorageModels() cannot proceed because local storage is unavailable in the current environment.");const r=window.localStorage,t=[];for(let n=0;n<r.length;++n){const o=r.key(n),u=qf+$l;if(o.startsWith(u)&&o.length>u.length){r.removeItem(o);const h=hd(o);t.indexOf(h)===-1&&t.push(h)}}return t}function bc(r){return{info:[qf,r,Od].join($l),topology:[qf,r,Gh].join($l),weightSpecs:[qf,r,Qf].join($l),weightData:[qf,r,Uh].join($l),modelMetadata:[qf,r,yp].join($l)}}function hd(r){const t=r.split($l);if(t.length<3)throw new Error(`Invalid key format: ${r}`);return t.slice(1,t.length-1).join($l)}function Rd(r){return r.startsWith(xc.URL_SCHEME)?r.slice(xc.URL_SCHEME.length):r}class xc{constructor(t){if(!He().getBool("IS_BROWSER")||typeof window=="undefined"||typeof window.localStorage=="undefined")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=bc(this.modelPath)}save(t){return jr(this,null,function*(){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),o=JSON.stringify(t.weightSpecs),u=gh(t);try{this.LS.setItem(this.keys.info,JSON.stringify(u)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,o),this.LS.setItem(this.keys.weightData,Bf(t.weightData));const h={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};return t.signature!=null&&(h.signature=t.signature),t.userDefinedMetadata!=null&&(h.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(h.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(h)),{modelArtifactsInfo:u}}catch(h){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${u.modelTopologyBytes}, weightSpecsBytes=${u.weightSpecsBytes}, weightDataBytes=${u.weightDataBytes}.`)}}})}load(){return jr(this,null,function*(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},o=JSON.parse(this.LS.getItem(this.keys.topology));if(o==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=o;const u=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(u==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=u;const h=this.LS.getItem(this.keys.modelMetadata);if(h!=null){const g=JSON.parse(h);n.format=g.format,n.generatedBy=g.generatedBy,n.convertedBy=g.convertedBy,g.signature!=null&&(n.signature=g.signature),g.userDefinedMetadata!=null&&(n.userDefinedMetadata=g.userDefinedMetadata),g.modelInitializer!=null&&(n.modelInitializer=g.modelInitializer)}const p=this.LS.getItem(this.keys.weightData);if(p==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=zf(p),n})}}xc.URL_SCHEME="localstorage://";const Wh=r=>He().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(xc.URL_SCHEME)?Vh(r.slice(xc.URL_SCHEME.length)):null;gl.registerSaveRouter(Wh),gl.registerLoadRouter(Wh);function Vh(r){return new xc(r)}class Kc{constructor(){bt(He().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),bt(typeof window=="undefined"||typeof window.localStorage!="undefined",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}listModels(){return jr(this,null,function*(){const t={},n=qf+$l,o=$l+Od;for(let u=0;u<this.LS.length;++u){const h=this.LS.key(u);if(h.startsWith(n)&&h.endsWith(o)){const p=hd(h);t[p]=JSON.parse(this.LS.getItem(h))}}return t})}removeModel(t){return jr(this,null,function*(){t=Rd(t);const n=bc(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const o=JSON.parse(this.LS.getItem(n.info));return this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),o})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _f="://";class lc{constructor(){this.managers={}}static getInstance(){return lc.instance==null&&(lc.instance=new lc),lc.instance}static registerManager(t,n){bt(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(_f)&&(t=t.slice(0,t.indexOf(_f))),bt(t.length>0,()=>"scheme must not be an empty string.");const o=lc.getInstance();bt(o.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),o.managers[t]=n}static getManager(t){const n=this.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(this.getInstance().managers)}}function If(r){if(r.indexOf(_f)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${lc.getSchemes().join(",")}`);return{scheme:r.split(_f)[0],path:r.split(_f)[1]}}function Jf(r,t,n=!1){return jr(this,null,function*(){bt(r!==t,()=>`Old path and new path are the same: '${r}'`);const o=gl.getLoadHandlers(r);bt(o.length>0,()=>`Copying failed because no load handler is found for source URL ${r}.`),bt(o.length<2,()=>`Copying failed because more than one (${o.length}) load handlers for source URL ${r}.`);const u=o[0],h=gl.getSaveHandlers(t);bt(h.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),bt(h.length<2,()=>`Copying failed because more than one (${o.length}) save handlers for destination URL ${t}.`);const p=h[0],g=If(r).scheme,b=If(r).path,_=g===If(r).scheme,z=yield u.load();n&&_&&(yield lc.getManager(g).removeModel(b));const V=yield p.save(z);return n&&!_&&(yield lc.getManager(g).removeModel(b)),V.modelArtifactsInfo})}function bp(){return jr(this,null,function*(){const r=lc.getSchemes(),t={};for(const n of r){const o=yield lc.getManager(n).listModels();for(const u in o){const h=n+_f+u;t[h]=o[u]}}return t})}function dd(r){return jr(this,null,function*(){const t=If(r);return lc.getManager(t.scheme).removeModel(t.path)})}function xp(r,t){return jr(this,null,function*(){return Jf(r,t,!1)})}function wp(r,t){return jr(this,null,function*(){return Jf(r,t,!0)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yp{fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}}if(He().get("IS_BROWSER")){He().setPlatform("browser",new Yp);try{lc.registerManager(xc.URL_SCHEME,new Kc)}catch(r){}try{lc.registerManager(ir.URL_SCHEME,new Xp)}catch(r){}}var bh=$(34155);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rf={importFetch:()=>$(75410)};let wc;function Mv(){wc=null}function $f(r){wc=r}function jh(){return wc}class Nv{constructor(){this.util=$(48628),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return He().global.fetch!=null?He().global.fetch(t,n):(wc==null&&(wc=rf.importFetch()),wc(t,n))}now(){const t=bh.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}}He().get("IS_NODE")&&He().setPlatform("node",new Nv);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zs(r,t="float32",n){return t=t||"float32",H(r),new ae(r,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function af(r,t){const n=mn(r,"x","cast");if(!zn(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const o={x:n},u={dtype:t};return lr.runKernel(es,o,u)}const qi=br({cast_:af});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pd(r){const n={x:mn(r,"x","clone","string_or_numeric")};return lr.runKernel(Au,n)}const th=br({clone_:pd});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kp(r,t=!1){console.log(r.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ou(),Cr({buffer:zs,cast:qi,clone:th,print:Kp});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sg="model",Qv=".json",Ld=".weights.bin";function Zp(r){return new Promise(t=>setTimeout(t)).then(r)}class xh{constructor(t){if(!He().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(xh.URL_SCHEME)&&(t=t.slice(xh.URL_SCHEME.length)),(t==null||t.length===0)&&(t=Sg),this.modelTopologyFileName=t+Qv,this.weightDataFileName=t+Ld}save(t){return jr(this,null,function*(){if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const o=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],u={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:o};t.signature!=null&&(u.signature=t.signature),t.userDefinedMetadata!=null&&(u.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(u.modelInitializer=t.modelInitializer);const h=window.URL.createObjectURL(new Blob([JSON.stringify(u)],{type:"application/json"})),p=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor;if(p.download=this.modelTopologyFileName,p.href=h,yield Zp(()=>p.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){const g=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;g.download=this.weightDataFileName,g.href=n,yield Zp(()=>g.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:gh(t)}}})}}xh.URL_SCHEME="downloads://";class kv{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.files=t}load(){return jr(this,null,function*(){const t=this.files[0],n=this.files.slice(1);return new Promise((o,u)=>{const h=new FileReader;h.onload=p=>{const g=JSON.parse(p.target.result),b=g.modelTopology;if(b==null){u(new Error(`modelTopology field is missing from file ${t.name}`));return}n.length===0&&o({modelTopology:b});const _=g.weightsManifest;if(_==null){u(new Error(`weightManifest field is missing from file ${t.name}`));return}let z;try{z=this.checkManifestAndWeightFiles(_,n)}catch(St){u(St);return}const V=[],at=[],Et=[];_.forEach(St=>{St.paths.forEach(Tt=>{at.push(Tt),Et.push(null)}),V.push(...St.weights)}),_.forEach(St=>{St.paths.forEach(Tt=>{const Wt=new FileReader;Wt.onload=le=>{const ye=le.target.result,Qe=at.indexOf(Tt);if(Et[Qe]=ye,Et.indexOf(null)===-1){const $e={modelTopology:b,weightSpecs:V,weightData:Kf(Et),format:g.format,generatedBy:g.generatedBy,convertedBy:g.convertedBy};g.signature!=null&&($e.signature=g.signature),g.userDefinedMetadata!=null&&($e.userDefinedMetadata=g.userDefinedMetadata),g.modelInitializer!=null&&($e.modelInitializer=g.modelInitializer),o($e)}},Wt.onerror=le=>u(`Failed to weights data from file of path '${Tt}'.`),Wt.readAsArrayBuffer(z[Tt])})})},h.onerror=p=>u(`Failed to read model topology and weights manifest JSON from file '${t.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),h.readAsText(t)})})}checkManifestAndWeightFiles(t,n){const o=[],u=n.map(p=>Fh(p.name)),h={};for(const p of t)p.paths.forEach(g=>{const b=Fh(g);if(o.indexOf(b)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${b}'`);if(o.push(b),u.indexOf(b)===-1)throw new Error(`Weight file with basename '${b}' is not provided.`);h[g]=n[u.indexOf(b)]});if(o.length!==n.length)throw new Error(`Mismatch in the number of files in weights manifest (${o.length}) and the number of weight files provided (${n.length}).`);return h}}const qp=r=>He().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(xh.URL_SCHEME)?Qp(r.slice(xh.URL_SCHEME.length)):null;gl.registerSaveRouter(qp);function Qp(r="model"){return new xh(r)}function eh(r){return new kv(r)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vd(r,t,n,o){p(r),n=n==null?0:n,o=o==null?1:o,g(n,o);let u=0;const h=b=>(b.then(_=>{const z=n+ ++u/r.length*(o-n);return t(z),_}),b);function p(b){bt(b!=null&&Array.isArray(b)&&b.length>0,()=>"promises must be a none empty array")}function g(b,_){bt(b>=0&&b<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${b}`),bt(_>=0&&_<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${_}`),bt(_>=b,()=>`startFraction must be no more than endFraction, but got startFraction ${b} and endFraction ${_}`)}return Promise.all(r.map(h))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hh(r,t){return jr(this,null,function*(){t==null&&(t={});const n=t.fetchFunc==null?He().platform.fetch:t.fetchFunc,o=r.map(V=>n(V,t.requestInit,{isBinary:!0})),u=0,h=.5,g=(t.onProgress==null?yield Promise.all(o):yield vd(o,t.onProgress,u,h)).map(V=>V.arrayBuffer()),b=.5,_=1;return t.onProgress==null?yield Promise.all(g):yield vd(g,t.onProgress,b,_)})}function Pd(r,t="",n,o){return jr(this,null,function*(){return Fd(p=>Hh(p,{requestInit:o}))(r,t,n)})}function Fd(r){return(t,n="",o)=>jr(this,null,function*(){const u=t.map(()=>!1),h={},p=o!=null?o.map(()=>!1):[],g=[];if(t.forEach((Et,St)=>{let Tt=0;Et.weights.forEach(Wt=>{const le="quantization"in Wt?Wt.quantization.dtype:Wt.dtype,ye=gf[le]*Rt(Wt.shape),Qe=()=>{u[St]=!0,h[St]==null&&(h[St]=[]),h[St].push({manifestEntry:Wt,groupOffset:Tt,sizeBytes:ye})};o!=null?o.forEach(($e,Xe)=>{$e===Wt.name&&(Qe(),p[Xe]=!0)}):Qe(),g.push(Wt.name),Tt+=ye})}),!p.every(Et=>Et)){const Et=o.filter((St,Tt)=>!p[Tt]);throw new Error(`Could not find weights in manifest with names: ${Et.join(", ")}. 
Manifest JSON has weights with names: ${g.join(", ")}.`)}const b=u.reduce((Et,St,Tt)=>(St&&Et.push(Tt),Et),[]),_=[];b.forEach(Et=>{t[Et].paths.forEach(St=>{const Tt=n+(n.endsWith("/")?"":"/")+St;_.push(Tt)})});const z=yield r(_),V={};let at=0;return b.forEach(Et=>{const St=t[Et].paths.length;let Tt=0;for(let $e=0;$e<St;$e++)Tt+=z[at+$e].byteLength;const Wt=new ArrayBuffer(Tt),le=new Uint8Array(Wt);let ye=0;for(let $e=0;$e<St;$e++){const Xe=new Uint8Array(z[at+$e]);le.set(Xe,ye),ye+=Xe.byteLength}h[Et].forEach($e=>{const Xe=Wt.slice($e.groupOffset,$e.groupOffset+$e.sizeBytes),Rn=tc(Xe,[$e.manifestEntry]);for(const Cn in Rn)V[Cn]=Rn[Cn]}),at+=St}),V})}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sp="application/octet-stream",Bd="application/json";class wh{constructor(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(bt(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=He().platform.fetch,bt(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&bt(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}save(t){return jr(this,null,function*(){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const o=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],u={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:o};t.signature!=null&&(u.signature=t.signature),t.userDefinedMetadata!=null&&(u.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(u.modelInitializer=t.modelInitializer),n.body.append("model.json",new Blob([JSON.stringify(u)],{type:Bd}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:Sp}),"model.weights.bin");const h=yield this.fetch(this.path,n);if(h.ok)return{modelArtifactsInfo:gh(t),responses:[h]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${h.status}.`)})}load(){return jr(this,null,function*(){const t=yield this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=yield t.json()}catch(St){let Tt=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?Tt+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":Tt+=" Please make sure the server is serving valid JSON for this request.",new Error(Tt)}const o=n.modelTopology,u=n.weightsManifest,h=n.generatedBy,p=n.convertedBy,g=n.format,b=n.signature,_=n.userDefinedMetadata;if(o==null&&u==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);let z,V;u!=null&&([z,V]=yield this.loadWeights(u));const at={modelTopology:o,weightSpecs:z,weightData:V,generatedBy:h,convertedBy:p,format:g};b!=null&&(at.signature=b),_!=null&&(at.userDefinedMetadata=_);const Et=n.modelInitializer;return Et&&(at.modelInitializer=Et),at})}loadWeights(t){return jr(this,null,function*(){const n=Array.isArray(this.path)?this.path[1]:this.path,[o,u]=Cp(n),h=this.weightPathPrefix||o,p=[];for(const z of t)p.push(...z.weights);const g=[],b=[];for(const z of t)for(const V of z.paths)this.weightUrlConverter!=null?b.push(this.weightUrlConverter(V)):g.push(h+V+u);this.weightUrlConverter&&g.push(...yield Promise.all(b));const _=yield Hh(g,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[p,Kf(_)]})}}wh.URL_SCHEME_REGEX=/^https?:\/\//;function Cp(r){const t=r.lastIndexOf("/"),n=r.lastIndexOf("?"),o=r.substring(0,t),u=n>t?r.substring(n):"";return[o+"/",u]}function Tf(r){return r.match(wh.URL_SCHEME_REGEX)!=null}const zd=(r,t)=>{if(typeof fetch=="undefined"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(r)?n=r.every(o=>Tf(o)):n=Tf(r),n)return $d(r,t)}return null};gl.registerSaveRouter(zd),gl.registerLoadRouter(zd);function $d(r,t){return new wh(r,t)}function gd(r,t){return $d(r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eh{constructor(t){this.modelArtifacts=t}load(){return jr(this,null,function*(){return this.modelArtifacts})}}class Gd{constructor(t){this.saveHandler=t}save(t){return jr(this,null,function*(){return this.saveHandler(t)})}}function Ud(r,t,n,o){return arguments.length===1?r.modelTopology!=null||r.weightSpecs!=null?new Eh(r):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Eh({modelTopology:r})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Eh({modelTopology:r,weightSpecs:t,weightData:n,trainingConfig:o}))}function Xh(r){return new Gd(r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wd(r,t,n=!1,o=!1){let u=mn(r,"a","matMul"),h=mn(t,"b","matMul");[u,h]=Si(u,h);const p={a:u,b:h},g={transposeA:n,transposeB:o};return lr.runKernel(Fi,p,g)}const $s=br({matMul_:Wd});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function md(r,t,n=1,o=0){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const h={indices:mn(r,"indices","oneHot","int32")},p={depth:t,onValue:n,offValue:o};return lr.runKernel($a,h,p)}const Mc=br({oneHot_:md});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jv(r,t){const n=mn(r,"x","transpose");if(t==null&&(t=n.shape.map((h,p)=>p).reverse()),bt(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of perm ${t}.`),t.forEach(h=>{bt(h>=0&&h<n.rank,()=>`All entries in 'perm' must be between 0 and ${n.rank-1} but got ${t}`)}),n.rank<=1)return n.clone();const o={x:n},u={perm:t};return lr.runKernel(_o,o,u)}const mu=br({transpose_:Jv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dv(r,t,n){const o=mn(r,"labels","confusionMatrix"),u=mn(t,"predictions","confusionMatrix");bt(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),bt(o.rank===1,()=>`Expected the rank of labels to be 1, but got ${o.rank}`),bt(u.rank===1,()=>`Expected the rank of predictions to be 1, but got ${u.rank}`),bt(o.shape[0]===u.shape[0],()=>`Mismatch in the number of examples: ${o.shape[0]} vs. ${u.shape[0]}. Labels and predictions should have the same number of elements.`),bt(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const h=Mc(qi(o,"int32"),n),p=Mc(qi(u,"int32"),n),g=mu(h),b=$s(g,p);return qi(b,"int32")}const Vd=br({confusionMatrix_:Dv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jp(r,t,n){if(en(r),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const o=Kl(r,n);if(o.length!==3&&o.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(o.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Tc(r,t,o,n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Zc;function tv(r,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(r==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,o=!1,u=!1,h=!1,p=!1,g=!1;if(r.data instanceof Uint8Array)n=!0;else if(typeof ImageData!="undefined"&&r instanceof ImageData)o=!0;else if(typeof HTMLVideoElement!="undefined"&&r instanceof HTMLVideoElement)u=!0;else if(typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement)h=!0;else if(r.getContext!=null)p=!0;else if(typeof ImageBitmap!="undefined"&&r instanceof ImageBitmap)g=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${r.constructor.name}`);if(u){const St=2;if(u&&r.readyState<St)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(Jc(ju,lr.backendName)!=null){const St={pixels:r},Tt={numChannels:t};return lr.runKernel(ju,St,Tt)}const[_,z]=u?[r.videoWidth,r.videoHeight]:[r.width,r.height];let V;p?V=r.getContext("2d").getImageData(0,0,_,z).data:o||n?V=r.data:(h||u||g)&&(Zc==null&&(Zc=document.createElement("canvas").getContext("2d")),Zc.canvas.width=_,Zc.canvas.height=z,Zc.drawImage(r,0,0,_,z),V=Zc.getImageData(0,0,_,z).data);let at;if(t===4)at=new Int32Array(V);else{const St=_*z;at=new Int32Array(St*t);for(let Tt=0;Tt<St;Tt++)for(let Wt=0;Wt<t;++Wt)at[Tt*t+Wt]=V[Tt*4+Wt]}return Jp(at,[z,_,t],"int32")}function ev(r,t){return jr(this,null,function*(){let n=mn(r,"img","toPixels");if(!(r instanceof Nn)){const _=n;n=qi(_,"int32"),_.dispose()}if(n.rank!==2&&n.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const[o,u]=n.shape.slice(0,2),h=n.rank===2?1:n.shape[2];if(h>4||h===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${h}`);if(n.dtype!=="float32"&&n.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`);const p=yield n.data(),g=n.dtype==="float32"?255:1,b=new Uint8ClampedArray(u*o*4);for(let _=0;_<o*u;++_){const z=[0,0,0,255];for(let at=0;at<h;at++){const Et=p[_*h+at];if(n.dtype==="float32"){if(Et<0||Et>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${Et}.`)}else if(n.dtype==="int32"&&(Et<0||Et>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${Et}.`);h===1?(z[0]=Et*g,z[1]=Et*g,z[2]=Et*g):z[at]=Et*g}const V=_*4;b[V+0]=Math.round(z[0]),b[V+1]=Math.round(z[1]),b[V+2]=Math.round(z[2]),b[V+3]=Math.round(z[3])}if(t!=null){t.width=u,t.height=o;const _=t.getContext("2d"),z=new ImageData(b,u,o);_.putImageData(z,0,0)}return n!==r&&n.dispose(),b})}const nv=br({fromPixels_:tv});function Sh(r,t){const n=r.shape.length,o=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(o<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${o}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[o-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[o-1]} vs. ${n}`);if(Rt(r.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${r.shape}.`);const u=t.shape,h=u[u.length-1];let p=1;for(let V=0;V<u.length-1;++V)p*=u[V];const g=r.shape,b=u.slice();b.pop();let _=1;for(let V=h;V<n;++V)_*=g[V],b.push(g[V]);const z=[...gt(r.shape).map(V=>V/_),1].slice(0,h);return[b,p,_,z]}function rv(r,t,n){const o=t.rank>1?t.shape[t.rank-1]:1,u=t.rank>1?t.rank-1:1,h=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${r}, sliceDim: ${o}, and batchDim: ${u}.`;if(n.rank<u)throw new Error(h+` update.rank < ${u}. `);if(r.length<o+(n.rank-u))throw new Error(h+` Output shape length < ${o+(n.rank-u)}`);if(n.rank!==u+r.length-o)throw new Error(h+` update.rank != ${u+r.length-o}`);for(let p=0;p<u;++p)if(n.shape[p]!==t.shape[p])throw new Error(h+` updates.shape[${p}] (${n.shape[p]}) != indices.shape[${p}] (${t.shape[p]}).`);for(let p=0;p<n.rank-u;++p)if(n.shape[p+u]!==r[p+o])throw new Error(h+` updates.shape[${p+u}] (${n.shape[p+u]}) != shape[${p+u}] (${r[p+u]})`)}function tg(r,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(r.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${r.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(r.size===0)throw new Error(`Updates specified for empty output. updates shape: ${r.shape}`)}rv(n,t,r)}function Gl(r,t,n){const o=t.shape.length,u=o>1?t.shape[o-1]:1,h=n.length;let p=1;for(let V=u;V<h;++V)p*=n[V];const g=u<1?1:u,b=Rt(t.shape)/g,_=[...gt(n.slice(0,u)),1],z=Rt(n);return{sliceRank:u,numUpdates:b,sliceSize:p,strides:_,outputSize:z}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function av(r,t,n){const o=r.shape.length;bt(o===t.length,()=>`Error in slice${o}D: Length of begin ${t} must match the rank of the array (${o}).`),bt(o===n.length,()=>`Error in slice${o}D: Length of size ${n} must match the rank of the array (${o}).`);for(let u=0;u<o;++u)bt(t[u]+n[u]<=r.shape[u],()=>`Error in slice${o}D: begin[${u}] + size[${u}] (${t[u]+n[u]}) would overflow input.shape[${u}] (${r.shape[u]})`)}function Af(r){const t=[];let n=0;for(;r>0;)r&1&&t.push(n),r/=2,n++;return t}function Mf(r,t,n){const o=[];for(let u=0;u<r.length;u++)o[u]=Math.ceil((t[u]-r[u])/n[u]);return o}function Ov(r,t,n,o){const u=[...r];for(let h=u.length;h<o.length;h++)u.push(1);for(let h=0;h<n;h++)h===0?u[t]=1:(u.splice(t,0,1),u.pop());return u}function iv(r,t,n){return n<=r?n:n-(t-1)}function Yh(r,t){const n=[];for(let o=0;o<r;o++)n.push(t+o);return n}function ov(r,t,n,o,u,h,p,g,b){const _=r.length;let z=new Array(_),V=new Array(_),at=new Array(_);if(t.length&&n>0){const Et=t[0],St=n+1;z=Nc(p,Et,St,o,r),V=Ch(g,Et,St,u,r),at=Ov(h,Et,St,r)}else for(let Et=0;Et<_;Et++)z[Et]=Fc(p,o,h,r,Et,b),V[Et]=jd(g,u,h,r,Et,b),at[Et]=El(h,Et,b);return{begin:z,end:V,strides:at}}function Nc(r,t,n,o,u){const h=[...u],p=Yh(n,t);for(let g=0;g<h.length;g++)if(p.indexOf(g)>-1)h[g]=0;else{const b=iv(t,n,g);let _=o[b];r&1<<b&&(_=0),h[g]=_}return h}function Ch(r,t,n,o,u){const h=[...u],p=Yh(n,t);for(let g=0;g<h.length;g++)if(p.indexOf(g)>-1)h[g]=Number.MAX_SAFE_INTEGER;else{const b=iv(t,n,g);let _=o[b];r&1<<b&&(_=Number.MAX_SAFE_INTEGER),h[g]=_}for(let g=0;g<h.length;g++){const b=u[g];h[g]<0&&(h[g]+=b),h[g]=te(0,h[g],u[g])}return h}function El(r,t,n){let o=r[t];return(n&1<<t||o==null)&&(o=1),o}function Fc(r,t,n,o,u,h){let p=t[u];const g=n[u]||1;(r&1<<u||h&1<<u||p==null)&&(g>0?p=Number.MIN_SAFE_INTEGER:p=Number.MAX_SAFE_INTEGER);const b=o[u];return p<0&&(p+=b),p=te(0,p,b-1),p}function jd(r,t,n,o,u,h){let p=t[u];const g=n[u]||1;(r&1<<u||h&1<<u||p==null)&&(g>0?p=Number.MAX_SAFE_INTEGER:p=Number.MIN_SAFE_INTEGER);const b=o[u];return p<0&&(p+=b),g>0?p=te(0,p,b):p=te(-1,p,b-1),p}function _p(r,t,n){let o=n.length;for(let u=0;u<n.length;u++)if(n[u]>1){o=u;break}for(let u=o+1;u<n.length;u++)if(t[u]>0||n[u]!==r[u])return!1;return!0}function sv(r,t){let n=r.length>0?r[r.length-1]:1;for(let o=0;o<r.length-1;o++)n+=r[o]*t[o];return n}function uv(r,t,n){let o;const u=r.shape.length;typeof t=="number"?o=[t,...new Array(u-1).fill(0)]:t.length<u?o=t.concat(new Array(u-t.length).fill(0)):o=t.slice(),o.forEach(p=>{bt(p!==-1,()=>"slice() does not support negative begin indexing.")});let h;return n==null?h=new Array(u).fill(-1):typeof n=="number"?h=[n,...new Array(u-1).fill(-1)]:n.length<u?h=n.concat(new Array(u-n.length).fill(-1)):h=n,h=h.map((p,g)=>p>=0?p:(bt(p===-1,()=>`Negative size values should be exactly -1 but got ${p} for the slice() size at index ${g}.`),r.shape[g]-o[g])),[o,h]}function Ip(r,t,n,o,u,h,p,g,b){let _=t.slice(),z=n.slice(),V=o;o==null&&(V=new Array(_.length));const at=Af(p);if(at.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(p!==0&&g!==0)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(p!==0&&b!==0)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");const Et=r.length-_.length,St=Af(g),Tt=r.slice();St.forEach(Cn=>{_[Cn]=0,z[Cn]=1,Tt.splice(Cn,0,1)});const{begin:Wt,end:le,strides:ye}=ov(Tt,at,Et,_,z,V,u,h,p);_=Wt,z=le,V=ye;const Qe=Af(b);Qe.forEach(Cn=>{z[Cn]=_[Cn]+1,V[Cn]=1});const $e=Mf(_,z,V),Xe=$e.filter((Cn,mr)=>Qe.indexOf(mr)===-1);return{nonStrided:V.every(Cn=>Cn===1),$begin:_,$end:z,$strides:V,size:$e,newShape:Tt,outShape:Xe}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _h{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class of{constructor(){this.classNameMap={}}static getMap(){return of.instance==null&&(of.instance=new of),of.instance}static register(t){of.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function li(r){bt(r.className!=null,()=>"Class being registered does not have the static className property defined."),bt(typeof r.className=="string",()=>"className is required to be a string, but got type "+typeof r.className),bt(r.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),of.register(r)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eg=.001,Tp=.1;function lv(r,t,n){return n==null&&(n=Ap()),yd(r,t,(o,u)=>Mp(o,u,n))}function Ap(){return lr.backend.floatPrecision()===32?eg:Tp}function yd(r,t,n){let o=!0;if((Yr(r)||Yr(t))&&(o=!1),Yr(r)&&Yr(t)&&(o=!0),o){const p=r.constructor.name,g=t.constructor.name;if(p!==g)throw new Error(`Arrays are of different type. Actual: ${p}. Expected: ${g}`)}if(Array.isArray(r)&&Array.isArray(t)){const p=Kl(r),g=Kl(t);if(!Bn(p,g))throw new Error(`Arrays have different shapes. Actual: [${p}]. Expected: [${g}]`)}const u=Yr(r)?r:fn(r),h=Yr(t)?t:fn(t);if(u.length!==h.length)throw new Error(`Arrays have different lengths actual: ${u.length} vs expected: ${h.length}.
Actual:   ${u}.
Expected: ${h}.`);for(let p=0;p<h.length;++p){const g=u[p],b=h[p];if(!n(g,b))throw new Error(`Arrays differ: actual[${p}] = ${g}, expected[${p}] = ${b}.
Actual:   ${u}.
Expected: ${h}.`)}}function cv(r,t){r().then(()=>t.fail(),()=>t())}function nh(r,t){const n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return Sr(r)||Sr(r[0])||Sr(t)||Sr(t[0])?yd(r,n,(o,u)=>o==u):yd(r,t,(o,u)=>Mp(o,u,0))}function Rv(r,t,n){if(n==null&&(n=Ap()),!Mp(r,t,n))throw new Error(`Numbers differ: actual === ${r}, expected === ${t}`)}function Mp(r,t,n){return!isFinite(r)&&!isFinite(t)?!0:!(isNaN(r)||isNaN(t)||Math.abs(r-t)>n)}function Np(r,t,n){for(let o=0;o<r.length;o++)if(r[o]<t||r[o]>n)throw new Error(`Value out of range:${r[o]} low: ${t}, high: ${n}`)}function oe(r,t){expect(new Float32Array(r)).toEqual(new Float32Array(t))}function vn(r){for(let t=0;t<r.length;t++){const n=r[t];Array.isArray(n)?vn(n):r[t]=Pl(n)}return r}/** @license See the LICENSE file. */const qn="2.8.6";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ia(){He().set("PROD",!0)}function Sa(){He().set("DEBUG",!0)}function Hr(){He().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function ea(r){He().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}oa(ea);function Ha(){lr.disposeVariables()}function Wa(){return lr}function Ga(){return lr.memory()}function Qa(r){return lr.profile(r)}function Vn(r,t){return lr.tidy(r,t)}function M(r){eo(r).forEach(n=>n.dispose())}function q(r){return lr.keep(r)}function dt(r){return lr.time(r)}function _t(r){return lr.setBackend(r)}function Pt(){return lr.ready()}function jt(){return lr.backendName}function ie(r){lr.removeBackend(r)}function he(r){return lr.findBackend(r)}function Te(r){return lr.findBackendFactory(r)}function Ke(r,t,n=1){return lr.registerBackend(r,t,n)}function gn(){return lr.backend}function cn(r,t){He().setPlatform(r,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jn(r,t){let n=mn(r,"a","add"),o=mn(t,"b","add");[n,o]=Si(n,o);const u={a:n,b:o};return lr.runKernel(ki,u)}const En=br({add_:jn});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ya(r,t){let n=mn(r,"a","floorDiv"),o=mn(t,"b","floorDiv");[n,o]=Si(n,o);const u={a:n,b:o};return lr.runKernel(ao,u)}const Dr=br({floorDiv_:ya});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fr(r,t){let n=mn(r,"a","div"),o=mn(t,"b","div");if([n,o]=Si(n,o),n.dtype==="int32"&&o.dtype==="int32")return Dr(n,o);const u={a:n,b:o},h={};return lr.runKernel(Ms,u,h)}const or=br({div_:Fr});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xa(r,t){let n=mn(r,"a","mul"),o=mn(t,"b","mul");[n,o]=Si(n,o);const u={a:n,b:o};return lr.runKernel(Ie,u)}const Hn=br({mul_:Xa});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function si(r){const n={x:mn(r,"x","sqrt")};return lr.runKernel(Je,n)}const Ci=br({sqrt_:si});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yi(r){const t=mn(r,"x","square"),n={};return lr.runKernel("Square",{x:t},n)}const _i=br({square_:Yi});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yo(r){const n={x:mn(r,"x","zerosLike")};return lr.runKernel(Vu,n)}const xi=br({zerosLike_:Yo});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xu(r){return bt($r(r),()=>"The f passed in grad(f) must be a function"),(t,n)=>{const o=mn(t,"x","tf.grad","string_or_numeric"),u=n!=null?mn(n,"dy","tf.grad"):null;return lr.tidy(()=>{const{value:h,grads:p}=lr.gradients(()=>r(o),[o],u);return u!=null&&Me(h.shape,u.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),cl(p),p[0]})}}function jo(r){return bt($r(r),()=>"The f passed in grads(f) must be a function"),(t,n)=>{bt(Array.isArray(t),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const o=Yc(t,"args","tf.grads","string_or_numeric"),u=n!=null?mn(n,"dy","tf.grads"):null;return lr.tidy(()=>{const{value:h,grads:p}=lr.gradients(()=>r(...o),o,u);return u!=null&&Me(h.shape,u.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),cl(p),p})}}function Fl(r){return bt($r(r),()=>"The f passed in valueAndGrad(f) must be a function"),(t,n)=>{bt(t instanceof Nn,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),bt(n==null||n instanceof Nn,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:o,value:u}=lr.gradients(()=>r(t),[t],n);return cl(o),{grad:o[0],value:u}}}function ku(r){return bt($r(r),()=>"The f passed in valueAndGrads(f) must be a function"),(t,n)=>{bt(Array.isArray(t)&&t.every(u=>u instanceof Nn),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),bt(n==null||n instanceof Nn,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const o=lr.gradients(()=>r(...t),t,n);return n!=null&&Me(o.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),cl(o.grads),o}}function xs(r,t){bt($r(r),()=>"The f passed in variableGrads(f) must be a function"),bt(t==null||Array.isArray(t)&&t.every(_=>_ instanceof Pa),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const _ in lr.registeredVariables)t.push(lr.registeredVariables[_])}const o=n?t.filter(_=>!_.trainable):null,u=t.length;t=t.filter(_=>_.trainable),bt(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${u} variables is trainable.`);const h=!0,{value:p,grads:g}=lr.gradients(r,t,null,h);bt(g.some(_=>_!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),bt(p.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${p.rank} tensor`);const b={};return t.forEach((_,z)=>{g[z]!=null&&(b[_.name]=g[z])}),o!=null&&o.forEach(_=>b[_.name]=null),{value:p,grads:b}}function _u(r){return lr.customGrad(r)}function cl(r){if(r.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zi(r,t){if((Yr(r)&&t!=="string"||Array.isArray(r))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Yr(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Tc(r,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zu extends _h{minimize(t,n=!1,o){const{value:u,grads:h}=this.computeGradients(t,o);if(o!=null){const p=o.map(g=>({name:g.name,tensor:h[g.name]}));this.applyGradients(p)}else this.applyGradients(h);return M(h),n?u:(u.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return xs(t,n)}dispose(){this.iterations_!=null&&M(this.iterations_)}saveIterations(){return jr(this,null,function*(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:zi(this.iterations_,"int32")}})}getWeights(){return jr(this,null,function*(){throw new Error("getWeights() is not implemented for this optimizer yet.")})}setWeights(t){return jr(this,null,function*(){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)})}extractIterations(t){return jr(this,null,function*(){return this.iterations_=(yield t[0].tensor.data())[0],t.slice(1)})}}Object.defineProperty(zu,Symbol.hasInstance,{value:r=>r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sl extends zu{constructor(t,n,o=null){super();this.learningRate=t,this.rho=n,this.epsilon=o,this.accumulatedGrads=[],this.accumulatedUpdates=[],o==null&&(this.epsilon=lr.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(o=>o.name):Object.keys(t)).forEach((o,u)=>{const h=lr.registeredVariables[o],p=!1;this.accumulatedGrads[u]==null&&(this.accumulatedGrads[u]={originalName:`${o}/accum_grad`,variable:Vn(()=>xi(h).variable(p))}),this.accumulatedUpdates[u]==null&&(this.accumulatedUpdates[u]={originalName:`${o}/accum_var`,variable:Vn(()=>xi(h).variable(p))});const g=Array.isArray(t)?t[u].tensor:t[o];if(g==null)return;const b=this.accumulatedGrads[u].variable,_=this.accumulatedUpdates[u].variable;Vn(()=>{const z=En(Hn(b,this.rho),Hn(_i(g),1-this.rho)),V=Hn(or(Ci(En(_,this.epsilon)),Ci(En(b,this.epsilon))),g),at=En(Hn(_,this.rho),Hn(_i(V),1-this.rho));b.assign(z),_.assign(at);const Et=En(Hn(V,-this.learningRate),h);h.assign(Et)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(M(this.accumulatedGrads.map(t=>t.variable)),M(this.accumulatedUpdates.map(t=>t.variable)))}getWeights(){return jr(this,null,function*(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[yield this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(t){return jr(this,null,function*(){t=yield this.extractIterations(t);const n=t.length/2,o=!1;this.accumulatedGrads=t.slice(0,n).map(u=>({originalName:u.name,variable:u.tensor.variable(o)})),this.accumulatedUpdates=t.slice(n,n*2).map(u=>({originalName:u.name,variable:u.tensor.variable(o)}))})}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}sl.className="Adadelta",li(sl);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qo(r,t,n){const o={shape:r,value:t,dtype:n};return lr.runKernel(Fa,{},o)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zl extends zu{constructor(t,n=.1){super();this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(o=>o.name):Object.keys(t)).forEach((o,u)=>{const h=lr.registeredVariables[o];if(this.accumulatedGrads[u]==null){const b=!1;this.accumulatedGrads[u]={originalName:`${o}/accumulator`,variable:Vn(()=>Qo(h.shape,this.initialAccumulatorValue).variable(b))}}const p=Array.isArray(t)?t[u].tensor:t[o];if(p==null)return;const g=this.accumulatedGrads[u].variable;Vn(()=>{const b=En(g,_i(p));g.assign(b);const _=En(Hn(or(p,Ci(En(b,lr.backend.epsilon()))),-this.learningRate),h);h.assign(_)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&M(this.accumulatedGrads.map(t=>t.variable))}getWeights(){return jr(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))})}setWeights(t){return jr(this,null,function*(){t=yield this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(o=>({originalName:o.name,variable:o.tensor.variable(n)}))})}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}Zl.className="Adagrad",li(Zl);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yu(r,t){let n=mn(r,"base","pow"),o=mn(t,"exp","pow");[n,o]=Si(n,o);const u={a:n,b:o};return lr.runKernel(Ai,u)}const po=br({pow_:yu});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ds(r,t){let n=mn(r,"a","sub"),o=mn(t,"b","sub");[n,o]=Si(n,o);const u={a:n,b:o};return lr.runKernel(ha,u)}const pi=br({sub_:Ds});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sl extends zu{constructor(t,n,o,u=null){super();this.learningRate=t,this.beta1=n,this.beta2=o,this.epsilon=u,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Vn(()=>{this.accBeta1=zi(n).variable(),this.accBeta2=zi(o).variable()}),u==null&&(this.epsilon=lr.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);Vn(()=>{const o=pi(1,this.accBeta1),u=pi(1,this.accBeta2);n.forEach((h,p)=>{const g=lr.registeredVariables[h],b=!1;this.accumulatedFirstMoment[p]==null&&(this.accumulatedFirstMoment[p]={originalName:`${h}/m`,variable:Vn(()=>xi(g).variable(b))}),this.accumulatedSecondMoment[p]==null&&(this.accumulatedSecondMoment[p]={originalName:`${h}/v`,variable:Vn(()=>xi(g).variable(b))});const _=Array.isArray(t)?t[p].tensor:t[h];if(_==null)return;const z=this.accumulatedFirstMoment[p].variable,V=this.accumulatedSecondMoment[p].variable,at=En(Hn(z,this.beta1),Hn(_,1-this.beta1)),Et=En(Hn(V,this.beta2),Hn(_i(_),1-this.beta2)),St=or(at,o),Tt=or(Et,u);z.assign(at),V.assign(Et);const Wt=En(Hn(or(St,En(Ci(Tt),this.epsilon)),-this.learningRate),g);g.assign(Wt)}),this.accBeta1.assign(Hn(this.accBeta1,this.beta1)),this.accBeta2.assign(Hn(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&M(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&M(this.accumulatedSecondMoment.map(t=>t.variable))}getWeights(){return jr(this,null,function*(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[yield this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(t){return jr(this,null,function*(){t=yield this.extractIterations(t),Vn(()=>{this.accBeta1.assign(po(this.beta1,this.iterations_+1)),this.accBeta2.assign(po(this.beta2,this.iterations_+1))});const n=t.length/2,o=!1;this.accumulatedFirstMoment=t.slice(0,n).map(u=>({originalName:u.name,variable:u.tensor.variable(o)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(u=>({originalName:u.name,variable:u.tensor.variable(o)}))})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}Sl.className="Adam",li(Sl);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rh(r){const t=mn(r,"x","abs");if(t.dtype==="complex64"){const n={x:t};return lr.runKernel(gi,n)}else{const n={x:t};return lr.runKernel(za,n)}}const fl=br({abs_:rh});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $n(r,t){const n=r.length,o=[];for(let u=0;u<n;u++){const h=n-1-u,p=r[h]||1;(t[t.length-1-u]||1)>1&&p===1&&o.unshift(h)}return o}function Jr(r,t){const n=[];for(let o=0;o<t.length;o++){const u=r[r.length-o-1],h=t.length-o-1,p=t[h];(u==null||u===1&&p>1)&&n.unshift(h)}return n}function Nr(r,t){const n=[],o=Math.max(r.length,t.length);for(let u=0;u<o;u++){let h=r[r.length-u-1];h==null&&(h=1);let p=t[t.length-u-1];if(p==null&&(p=1),h===1)n.unshift(p);else if(p===1)n.unshift(h);else if(h!==p){const g=`Operands could not be broadcast together with shapes ${r} and ${t}.`;throw Error(g)}else n.unshift(h)}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hi(r,t){let n=mn(r,"a","maximum"),o=mn(t,"b","maximum");[n,o]=Si(n,o),n.dtype==="bool"&&(n=qi(n,"int32"),o=qi(o,"int32")),Nr(n.shape,o.shape);const u={a:n,b:o};return lr.runKernel(el,u)}const Jo=br({maximum_:Hi});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class An extends zu{constructor(t,n,o,u=null,h=0){super();this.learningRate=t,this.beta1=n,this.beta2=o,this.epsilon=u,this.decay=h,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Vn(()=>{this.iteration=zi(0).variable(),this.accBeta1=zi(n).variable()}),u==null&&(this.epsilon=lr.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);Vn(()=>{const o=pi(1,this.accBeta1),u=or(-this.learningRate,En(Hn(this.iteration,this.decay),1));n.forEach((h,p)=>{const g=lr.registeredVariables[h],b=!1;this.accumulatedFirstMoment[p]==null&&(this.accumulatedFirstMoment[p]={originalName:`${h}/m`,variable:xi(g).variable(b)}),this.accumulatedWeightedInfNorm[p]==null&&(this.accumulatedWeightedInfNorm[p]={originalName:`${h}/v`,variable:xi(g).variable(b)});const _=Array.isArray(t)?t[p].tensor:t[h];if(_==null)return;const z=this.accumulatedFirstMoment[p].variable,V=this.accumulatedWeightedInfNorm[p].variable,at=En(Hn(z,this.beta1),Hn(_,1-this.beta1)),Et=Hn(V,this.beta2),St=fl(_),Tt=Jo(Et,St);z.assign(at),V.assign(Tt);const Wt=En(Hn(or(u,o),or(at,En(Tt,this.epsilon))),g);g.assign(Wt)}),this.iteration.assign(En(this.iteration,1)),this.accBeta1.assign(Hn(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&M(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&M(this.accumulatedWeightedInfNorm.map(t=>t.variable))}getWeights(){return jr(this,null,function*(){throw new Error("getWeights() is not implemented for Adamax yet.")})}setWeights(t){return jr(this,null,function*(){throw new Error("setWeights() is not implemented for Adamax yet.")})}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}An.className="Adamax",li(An);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sn extends zu{constructor(t){super();this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(o=>o.name):Object.keys(t)).forEach((o,u)=>{const h=Array.isArray(t)?t[u].tensor:t[o];if(h==null)return;const p=lr.registeredVariables[o];Vn(()=>{const g=En(Hn(this.c,h),p);p.assign(g)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=q(zi(-t))}dispose(){this.c.dispose()}getWeights(){return jr(this,null,function*(){return[yield this.saveIterations()]})}setWeights(t){return jr(this,null,function*(){if(t=yield this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")})}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}sn.className="SGD",li(sn);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hr extends sn{constructor(t,n,o=!1){super(t);this.learningRate=t,this.momentum=n,this.useNesterov=o,this.accumulations=[],this.m=zi(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(o=>o.name):Object.keys(t)).forEach((o,u)=>{const h=lr.registeredVariables[o];if(this.accumulations[u]==null){const b=!1;this.accumulations[u]={originalName:`${o}/momentum`,variable:Vn(()=>xi(h).variable(b))}}const p=this.accumulations[u].variable,g=Array.isArray(t)?t[u].tensor:t[o];g!=null&&Vn(()=>{let b;const _=En(Hn(this.m,p),g);this.useNesterov?b=En(Hn(this.c,En(g,Hn(_,this.m))),h):b=En(Hn(this.c,_),h),p.assign(_),h.assign(b)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&M(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}getWeights(){return jr(this,null,function*(){return[yield this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))})}setWeights(t){return jr(this,null,function*(){t=yield this.extractIterations(t);const n=!1;this.accumulations=t.map(o=>({originalName:o.name,variable:o.tensor.variable(n)}))})}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}hr.className="Momentum",li(hr);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pr extends zu{constructor(t,n=.9,o=0,u=null,h=!1){super();if(this.learningRate=t,this.decay=n,this.momentum=o,this.epsilon=u,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=h,u==null&&(this.epsilon=lr.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(o=>o.name):Object.keys(t)).forEach((o,u)=>{const h=lr.registeredVariables[o],p=!1;this.accumulatedMeanSquares[u]==null&&(this.accumulatedMeanSquares[u]={originalName:`${o}/rms`,variable:Vn(()=>xi(h).variable(p))}),this.accumulatedMoments[u]==null&&(this.accumulatedMoments[u]={originalName:`${o}/momentum`,variable:Vn(()=>xi(h).variable(p))}),this.accumulatedMeanGrads[u]==null&&this.centered&&(this.accumulatedMeanGrads[u]={originalName:`${o}/mg`,variable:Vn(()=>xi(h).variable(p))});const g=Array.isArray(t)?t[u].tensor:t[o];if(g==null)return;const b=this.accumulatedMeanSquares[u].variable,_=this.accumulatedMoments[u].variable;Vn(()=>{const z=En(Hn(b,this.decay),Hn(_i(g),1-this.decay));if(this.centered){const V=this.accumulatedMeanGrads[u].variable,at=En(Hn(V,this.decay),Hn(g,1-this.decay)),Et=or(Hn(g,this.learningRate),Ci(pi(z,En(_i(at),this.epsilon)))),St=En(Hn(_,this.momentum),Et);b.assign(z),V.assign(at),_.assign(St);const Tt=pi(h,St);h.assign(Tt)}else{const V=En(Hn(b,this.decay),Hn(_i(g),1-this.decay)),at=En(Hn(_,this.momentum),or(Hn(g,this.learningRate),Ci(En(V,this.epsilon))));b.assign(V),_.assign(at);const Et=pi(h,at);h.assign(Et)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&M(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&M(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&M(this.accumulatedMoments.map(t=>t.variable))}getWeights(){return jr(this,null,function*(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[yield this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))})}setWeights(t){return jr(this,null,function*(){t=yield this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,o=!1;this.accumulatedMeanSquares=t.slice(0,n).map(u=>({originalName:u.name,variable:u.tensor.variable(o)})),this.accumulatedMoments=t.slice(n,n*2).map(u=>({originalName:u.name,variable:u.tensor.variable(o)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(u=>({originalName:u.name,variable:u.tensor.variable(o)})))})}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}Pr.className="RMSProp",li(Pr);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xr(r){const n={x:mn(r,"x","acos")};return lr.runKernel(da,n)}const yr=br({acos_:Xr});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vr(r){const n={x:mn(r,"x","acosh")};return lr.runKernel(Ti,n)}const Mr=br({acosh_:vr});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kn(r){bt(Array.isArray(r),()=>"The argument passed to tf.addN() must be a list of tensors"),bt(r.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${r.length}`);const t=r.map((u,h)=>mn(u,`tensors${h}`,"addN")),n=t[0];t.forEach(u=>{if(u.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(u=>{if(!Bn(u.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const o=t;return lr.runKernel(vi,o)}const fr=br({addN_:kn});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sn(r,t=null,n=!1){const u={x:mn(r,"x","all","bool")},h={axis:t,keepDims:n};return lr.runKernel(ii,u,h)}const Or=br({all_:Sn});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zr(r,t=null,n=!1){const u={x:mn(r,"x","any","bool")},h={axis:t,keepDims:n};return lr.runKernel(Di,u,h)}const wa=br({any_:Zr});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Na(r,t=0){const o={x:mn(r,"x","argMax")},u={axis:t};return lr.runKernel(Ra,o,u)}const ga=br({argMax_:Na});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ai(r,t=0){const o={x:mn(r,"x","argMin")},u={axis:t};return lr.runKernel(ln,o,u)}const lo=br({argMin_:ai});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(r){const n={x:mn(r,"x","asin")};return lr.runKernel(De,n)}const Qi=br({asin_:cs});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Io(r){const n={x:mn(r,"x","asinh")};return lr.runKernel(dn,n)}const Mo=br({asinh_:Io});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Os(r){const n={x:mn(r,"x","atan")};return lr.runKernel(Wn,n)}const yl=br({atan_:Os});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sf(r,t){let n=mn(r,"a","atan2"),o=mn(t,"b","atan2");[n,o]=Si(n,o);const u={a:n,b:o};return lr.runKernel(Kn,u)}const Ih=br({atan2_:sf});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ah(r){const n={x:mn(r,"x","atanh")};return lr.runKernel(Gn,n)}const Lv=br({atanh_:ah});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nf(r,t,n,o,u="NHWC",h){const p=r[3],g=[...t,p],b=hv(u);return kc(r,g,n,h,o,null,null,b)}function mf(r,t,n,o,u,h,p="channelsLast"){const[g,b]=ng(t);let _;if(p==="channelsLast")_=[g,b,r[3],r[3]];else if(p==="channelsFirst")_=[g,b,r[1],r[1]];else throw new Error(`Unknown dataFormat ${p}`);return kc(r,_,n,o,u,h,!1,p)}function Hd(r,t,n,o,u,h,p="NDHWC"){const[g,b,_]=Um(t);let z,V;if(p==="NDHWC")V="channelsLast",z=[g,b,_,r[4],r[4]];else if(p==="NCDHW")V="channelsFirst",z=[g,b,_,r[1],r[1]];else throw new Error(`Unknown dataFormat ${p}`);return Th(r,z,n,o,u,!1,V,h)}function kc(r,t,n,o,u,h,p=!1,g="channelsLast"){let[b,_,z,V]=[-1,-1,-1,-1];if(g==="channelsLast")[b,_,z,V]=r;else if(g==="channelsFirst")[b,V,_,z]=r;else throw new Error(`Unknown dataFormat ${g}`);const[at,Et,,St]=t,[Tt,Wt]=ng(n),[le,ye]=ng(o),Qe=Pv(at,le),$e=Pv(Et,ye),{padInfo:Xe,outHeight:Rn,outWidth:Cn}=U0(u,_,z,Tt,Wt,Qe,$e,h,g),mr=p?St*V:St;let zr;return g==="channelsFirst"?zr=[b,mr,Rn,Cn]:g==="channelsLast"&&(zr=[b,Rn,Cn,mr]),{batchSize:b,dataFormat:g,inHeight:_,inWidth:z,inChannels:V,outHeight:Rn,outWidth:Cn,outChannels:mr,padInfo:Xe,strideHeight:Tt,strideWidth:Wt,filterHeight:at,filterWidth:Et,effectiveFilterHeight:Qe,effectiveFilterWidth:$e,dilationHeight:le,dilationWidth:ye,inShape:r,outShape:zr,filterShape:t}}function Th(r,t,n,o,u,h=!1,p="channelsLast",g){let[b,_,z,V,at]=[-1,-1,-1,-1,-1];if(p==="channelsLast")[b,_,z,V,at]=r;else if(p==="channelsFirst")[b,at,_,z,V]=r;else throw new Error(`Unknown dataFormat ${p}`);const[Et,St,Tt,,Wt]=t,[le,ye,Qe]=Um(n),[$e,Xe,Rn]=Um(o),Cn=Pv(Et,$e),mr=Pv(St,Xe),zr=Pv(Tt,Rn),{padInfo:ta,outDepth:Ma,outHeight:Za,outWidth:Ka}=k1(u,_,z,V,le,ye,Qe,Cn,mr,zr,g),ni=h?Wt*at:Wt;let Ua;return p==="channelsFirst"?Ua=[b,ni,Ma,Za,Ka]:p==="channelsLast"&&(Ua=[b,Ma,Za,Ka,ni]),{batchSize:b,dataFormat:p,inDepth:_,inHeight:z,inWidth:V,inChannels:at,outDepth:Ma,outHeight:Za,outWidth:Ka,outChannels:ni,padInfo:ta,strideDepth:le,strideHeight:ye,strideWidth:Qe,filterDepth:Et,filterHeight:St,filterWidth:Tt,effectiveFilterDepth:Cn,effectiveFilterHeight:mr,effectiveFilterWidth:zr,dilationDepth:$e,dilationHeight:Xe,dilationWidth:Rn,inShape:r,outShape:Ua,filterShape:t}}function G0(r,t,n,o,u){o==null&&(o=im(r,t,n));const h=r[0],p=r[1],g=fv((h-t+2*o)/n+1,u),b=fv((p-t+2*o)/n+1,u);return[g,b]}function Gm(r,t,n,o,u,h){u==null&&(u=im(r,t,o));const p=r[0],g=r[1],b=r[2],_=fv((p-t+2*u)/o+1,h),z=fv((g-t+2*u)/o+1,h),V=fv((b-t+2*u)/o+1,h);return[_,z,V,n]}function im(r,t,n,o=1){const u=Pv(t,o);return Math.floor((r[0]*(n-1)-n+u)/2)}function ng(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function Um(r){return typeof r=="number"?[r,r,r]:r}function Pv(r,t){return t<=1?r:r+(r-1)*(t-1)}function U0(r,t,n,o,u,h,p,g,b){let _,z,V;if(typeof r=="number"){_={top:r,bottom:r,left:r,right:r,type:r===0?"VALID":"NUMBER"};const Et=G0([t,n],h,o,r,g);z=Et[0],V=Et[1]}else if(r==="same"){z=Math.ceil(t/o),V=Math.ceil(n/u);const at=Math.max(0,(z-1)*o+h-t),Et=Math.max(0,(V-1)*u+p-n),St=Math.floor(at/2),Tt=at-St,Wt=Math.floor(Et/2),le=Et-Wt;_={top:St,bottom:Tt,left:Wt,right:le,type:"SAME"}}else if(r==="valid")_={top:0,bottom:0,left:0,right:0,type:"VALID"},z=Math.ceil((t-h+1)/o),V=Math.ceil((n-p+1)/u);else if(typeof r=="object"){const at=b==="channelsLast"?r[1][0]:r[2][0],Et=b==="channelsLast"?r[1][1]:r[2][1],St=b==="channelsLast"?r[2][0]:r[3][0],Tt=b==="channelsLast"?r[2][1]:r[3][1];_={top:at,bottom:Et,left:St,right:Tt,type:at===0&&Et===0&&St===0&&Tt===0?"VALID":"EXPLICIT"},z=fv((t-h+at+Et)/o+1,g),V=fv((n-p+St+Tt)/u+1,g)}else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:_,outHeight:z,outWidth:V}}function k1(r,t,n,o,u,h,p,g,b,_,z){let V,at,Et,St;if(typeof r=="number"){V={top:r,bottom:r,left:r,right:r,front:r,back:r,type:r===0?"VALID":"NUMBER"};const Wt=Gm([t,n,o,1],g,1,u,r,z);at=Wt[0],Et=Wt[1],St=Wt[2]}else if(r==="same"){at=Math.ceil(t/u),Et=Math.ceil(n/h),St=Math.ceil(o/p);const Tt=(at-1)*u+g-t,Wt=(Et-1)*h+b-n,le=(St-1)*p+_-o,ye=Math.floor(Tt/2),Qe=Tt-ye,$e=Math.floor(Wt/2),Xe=Wt-$e,Rn=Math.floor(le/2),Cn=le-Rn;V={top:$e,bottom:Xe,left:Rn,right:Cn,front:ye,back:Qe,type:"SAME"}}else if(r==="valid")V={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},at=Math.ceil((t-g+1)/u),Et=Math.ceil((n-b+1)/h),St=Math.ceil((o-_+1)/p);else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:V,outDepth:at,outHeight:Et,outWidth:St}}function fv(r,t){if(!t)return Math.trunc(r);switch(t){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error(`Unknown roundingMode ${t}`)}}function Kh(r){const[t,n,o]=ng(r);return t===1&&n===1&&o===1}function Ec(r,t){return Kh(r)||Kh(t)}function hv(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y(r,t){const o={x:mn(r,"x","reshape","string_or_numeric")},u={shape:t};return lr.runKernel(Ps,o,u)}const m=br({reshape_:y});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E(r,t,n,o,u){const h=mn(r,"x","avgPool","float32"),p=1;bt(Ec(n,p),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${p}'`);let g=h,b=!1;h.rank===3&&(b=!0,g=m(h,[1,h.shape[0],h.shape[1],h.shape[2]])),bt(g.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${g.rank}.`),u!=null&&bt(xr(o),()=>`Error in avgPool: pad must be an integer when using, dimRoundingMode ${u} but got pad ${o}.`);const _={x:g},z={filterSize:t,strides:n,pad:o,dimRoundingMode:u};let V=lr.runKernel(Rr,_,z);return V=qi(V,h.dtype),b?m(V,[V.shape[1],V.shape[2],V.shape[3]]):V}const S=br({avgPool_:E});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D(r,t,n,o,u,h="NDHWC",p){p==null?p=[1,1,1]:ea("dilations is deprecated, this field will be gone in v3.0.0.");const g=mn(r,"x","avgPool3d","float32");let b=g,_=!1;g.rank===4&&(_=!0,b=m(g,[1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]])),bt(b.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${b.rank}.`),bt(h==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${h}`),bt(Ec(n,p),()=>`Error in avgPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${p}'`),u!=null&&bt(xr(o),()=>`Error in avgPool3d: pad must be an integer when using, dimRoundingMode ${u} but got pad ${o}.`);const z={x:b},V={filterSize:t,strides:n,pad:o,dimRoundingMode:u,dataFormat:h,dilations:p};let at=lr.runKernel(La,z,V);return at=qi(at,b.dtype),_?m(at,[at.shape[1],at.shape[2],at.shape[3],at.shape[4]]):at}const J=br({avgPool3d_:D});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ct(r,t=0){bt(r.length>=1,()=>"Pass at least one tensor to concat");const n=Yc(r,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(h=>{if(h.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${h.dtype}. `)}),n.length===1)return th(n[0]);const o=n,u={axis:t};return lr.runKernel(ms,o,u)}const vt=br({concat_:ct});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function It(r){const n={x:mn(r,"x","sigmoid")};return lr.runKernel(pe,n)}const Bt=br({sigmoid_:It});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qt(r,t,n){const o=mn(r,"x","slice","string_or_numeric");if(o.rank===0)throw new Error("Slicing scalar is not possible");const u={x:o},h={begin:t,size:n};return lr.runKernel(Cf,u,h)}const Zt=br({slice_:qt});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(r){const n={x:mn(r,"x","tanh")};return lr.runKernel(ma,n)}const be=br({tanh_:Ht});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _e(r,t,n,o,u,h){const p=mn(r,"forgetBias","basicLSTMCell"),g=mn(t,"lstmKernel","basicLSTMCell"),b=mn(n,"lstmBias","basicLSTMCell"),_=mn(o,"data","basicLSTMCell"),z=mn(u,"c","basicLSTMCell"),V=mn(h,"h","basicLSTMCell"),at=vt([_,V],1),Et=$s(at,g),St=En(Et,b),Tt=St.shape[0],Wt=St.shape[1]/4,le=[Tt,Wt],ye=Zt(St,[0,0],le),Qe=Zt(St,[0,Wt],le),$e=Zt(St,[0,Wt*2],le),Xe=Zt(St,[0,Wt*3],le),Rn=En(Hn(Bt(ye),be(Qe)),Hn(z,Bt(En(p,$e)))),Cn=Hn(be(Rn),Bt(Xe));return[Rn,Cn]}const Ue=br({basicLSTMCell_:_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nn(r,t,n){const o=mn(r,"x","batchToSpaceND"),u=t.reduce((g,b)=>g*b);bt(o.rank>=1+t.length,()=>`input rank is ${o.rank} but should be > than blockShape.length ${t.length}`),bt(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),bt(o.shape[0]%u==0,()=>`input tensor batch is ${o.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${u}`);const h={x:o},p={blockShape:t,crops:n};return lr.runKernel(Ki,h,p)}const hn=br({batchToSpaceND_:nn});function On(r){let t;return r.rank===0||r.rank===1?t=m(r,[1,1,1,r.size]):r.rank===2?t=m(r,[1,1,r.shape[0],r.shape[1]]):r.rank===3?t=m(r,[1,r.shape[0],r.shape[1],r.shape[2]]):t=r,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function er(r,t,n,o,u,h){h==null&&(h=.001);const p=mn(r,"x","batchNorm"),g=mn(t,"mean","batchNorm"),b=mn(n,"variance","batchNorm");let _;u!=null&&(_=mn(u,"scale","batchNorm"));let z;o!=null&&(z=mn(o,"offset","batchNorm")),bt(g.rank===b.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),bt(z==null||g.rank===z.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),bt(_==null||g.rank===_.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const at={x:On(p),scale:_,offset:z,mean:g,variance:b},Et={varianceEpsilon:h},St=lr.runKernel(So,at,Et);return m(St,p.shape)}const Yn=br({batchNorm_:er});function Ir(r,t,n,o,u,h){const p=mn(r,"x","batchNorm"),g=mn(t,"mean","batchNorm"),b=mn(n,"variance","batchNorm");let _;u!=null&&(_=mn(u,"scale","batchNorm"));let z;return o!=null&&(z=mn(o,"offset","batchNorm")),bt(p.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${p.rank}.`),bt(g.rank===2||g.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${g.rank}.`),bt(b.rank===2||b.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${b.rank}.`),_!=null&&bt(_.rank===2||_.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${_.rank}.`),z!=null&&bt(z.rank===2||z.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${z.rank}.`),Yn(p,g,b,z,_,h)}const Un=br({batchNorm2d_:Ir});function gr(r,t,n,o,u,h){const p=mn(r,"x","batchNorm"),g=mn(t,"mean","batchNorm"),b=mn(n,"variance","batchNorm");let _;u!=null&&(_=mn(u,"scale","batchNorm"));let z;return o!=null&&(z=mn(o,"offset","batchNorm")),bt(p.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${p.rank}.`),bt(g.rank===3||g.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${g.rank}.`),bt(b.rank===3||b.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${b.rank}.`),_!=null&&bt(_.rank===3||_.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${_.rank}.`),z!=null&&bt(z.rank===3||z.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${z.rank}.`),Yn(p,g,b,z,_,h)}const Br=br({batchNorm3d_:gr});function Tr(r,t,n,o,u,h){const p=mn(r,"x","batchNorm"),g=mn(t,"mean","batchNorm"),b=mn(n,"variance","batchNorm");let _;u!=null&&(_=mn(u,"scale","batchNorm"));let z;return o!=null&&(z=mn(o,"offset","batchNorm")),bt(p.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${p.rank}.`),bt(g.rank===4||g.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${g.rank}.`),bt(b.rank===4||b.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${b.rank}.`),_!=null&&bt(_.rank===4||_.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${_.rank}.`),z!=null&&bt(z.rank===4||z.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${z.rank}.`),Yn(p,g,b,z,_,h)}const sa=br({batchNorm4d_:Tr});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gr(r,t,n){const o=mn(r,"x","bincount"),u=mn(t,"weights","bincount");bt(o.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${o.dtype}`),bt(n>=0,()=>`size must be non-negative, but got ${n}.`),bt(u.size===o.size||u.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${o.shape}, weights shape: ${u.shape}.`);const h={x:o,weights:u},p={size:n};return lr.runKernel(xo,h,p)}const va=br({bincount_:Gr});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function la(r,t){let n=mn(r,"broadcastTo","x");const o=n.shape;if(t.some(_=>!(_>0)||_%1!=0))throw new Error(`broadcastTo(): Invalid broadcast shape [${t}].`);if(t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const _=n.shape.slice();for(;_.length<t.length;)_.unshift(1);n=m(n,_)}const u=n.shape,h=Array.from(t);for(let _=t.length-1;_>=0;_--)if(u[_]===t[_])h[_]=1;else if(n.shape[_]!==1)throw new Error(`broadcastTo(): [${o}] cannot be broadcast to [${t}].`);if(h.map((_,z)=>_>1?z:-1).filter(_=>_>=0).length===0)return th(n);const g={x:n},b={reps:h};return lr.runKernel(Mi,g,b)}const ka=br({broadcastTo_:la});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ri(r){const n={x:mn(r,"x","ceil")};return lr.runKernel(Wo,n)}const Li=br({ceil_:ri});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function to(r,t,n){const o=mn(r,"x","clipByValue");bt(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`);const u={x:o},h={clipValueMin:t,clipValueMax:n};return lr.runKernel(Zi,u,h)}const fi=br({clipByValue_:to});function Ii(r){return vt(r,0)}const Ja=br({concat1d_:Ii});function oo(r,t){return vt(r,t)}const Po=br({concat2d_:oo});function Fo(r,t){return vt(r,t)}const _s=br({concat3d_:Fo});function Eo(r,t){return vt(r,t)}const Co=br({concat4d_:Eo});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ws(r,t,n,o,u="NHWC",h=[1,1],p){const g=mn(r,"x","conv2d"),b=mn(t,"filter","conv2d");let _=g,z=!1;g.rank===3&&(z=!0,_=m(g,[1,g.shape[0],g.shape[1],g.shape[2]])),bt(_.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${_.rank}.`),bt(b.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${b.rank}.`),p!=null&&bt(xr(o),()=>`Error in conv2d: pad must be an integer when using, dimRoundingMode ${p} but got pad ${o}.`);const V=u==="NHWC"?_.shape[3]:_.shape[1];bt(V===b.shape[2],()=>`Error in conv2d: depth of input (${V}) must match input depth for filter ${b.shape[2]}.`),bt(Ec(n,h),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${h}'`);const at={x:_,filter:b},Et={strides:n,pad:o,dataFormat:u,dilations:h,dimRoundingMode:p},St=lr.runKernel(Do,at,Et);return z?m(St,[St.shape[1],St.shape[2],St.shape[3]]):St}const rs=br({conv2d_:ws});function $u(r,t,n,o,u="NWC",h=1,p){const g=mn(r,"x","conv1d"),b=mn(t,"filter","conv1d");let _=g,z=!1;g.rank===2&&(z=!0,_=m(g,[1,g.shape[0],g.shape[1]])),bt(_.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${_.rank}.`),bt(b.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${b.rank}.`),p!=null&&bt(xr(o),()=>`Error in conv1d: pad must be an integer when using, dimRoundingMode ${p} but got pad ${o}.`),bt(_.shape[2]===b.shape[1],()=>`Error in conv1d: depth of input (${_.shape[2]}) must match input depth for filter ${b.shape[1]}.`),bt(Ec(n,h),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${h}'`),bt(u==="NWC",()=>`Error in conv1d: got dataFormat of ${u} but only NWC is currently supported.`);const V=m(b,[1,b.shape[0],b.shape[1],b.shape[2]]),at=m(_,[_.shape[0],1,_.shape[1],_.shape[2]]),Wt=rs(at,V,[1,n],o,"NHWC",[1,h],p);return z?m(Wt,[Wt.shape[2],Wt.shape[3]]):m(Wt,[Wt.shape[0],Wt.shape[2],Wt.shape[3]])}const Bo=br({conv1d_:$u});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ts(r,t,n,o,u,h="NHWC",p){bt(r.length===t.rank,()=>`Length of inShape (${r.length}) and rank of dy (${t.rank}) must match`);let g=r,b=t,_=!1;t.rank===3&&(_=!0,b=m(t,[1,t.shape[0],t.shape[1],t.shape[2]]),g=[1,r[0],r[1],r[2]]),bt(g.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${g.length}.`),bt(b.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${b.rank}`),bt(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const z=h==="NHWC"?g[3]:g[1],V=h==="NHWC"?b.shape[3]:b.shape[1];bt(z===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${z}) must match input depth for filter ${n.shape[2]}.`),bt(V===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${V}) must match output depth for filter ${n.shape[3]}.`),p!=null&&bt(xr(u),()=>`Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode ${p} but got pad ${u}.`);const at={dy:b,filter:n},Et={strides:o,pad:u,dataFormat:h,dimRoundingMode:p,inputShape:g},St=lr.runKernel(Zs,at,Et);return _?m(St,[St.shape[1],St.shape[2],St.shape[3]]):St}const hu=br({conv2DBackpropInput_:ts});function eu(r,t,n,o,u,h){const p=mn(r,"x","conv2dTranspose"),g=mn(t,"filter","conv2dTranspose");return hu(n,p,g,o,u,"NHWC",h)}const Nl=br({conv2dTranspose_:eu});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gu(r,t,n,o,u="NDHWC",h=[1,1,1]){const p=mn(r,"x","conv3d"),g=mn(t,"filter","conv3d");let b=p,_=!1;p.rank===4&&(_=!0,b=m(p,[1,p.shape[0],p.shape[1],p.shape[2],p.shape[3]])),bt(b.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${b.rank}.`),bt(g.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${g.rank}.`),bt(b.shape[4]===g.shape[3],()=>`Error in conv3d: depth of input (${b.shape[4]}) must match input depth for filter ${g.shape[3]}.`),bt(Ec(n,h),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${h}'`),bt(u==="NDHWC",()=>`Error in conv3d: got dataFormat of ${u} but only NDHWC is currently supported.`);const z={x:b,filter:g},V={strides:n,pad:o,dataFormat:u,dilations:h},at=lr.runKernel(Eu,z,V);return _?m(at,[at.shape[1],at.shape[2],at.shape[3],at.shape[4]]):at}const nu=br({conv3d_:Gu});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kl(r,t,n,o,u){bt(r.length===t.rank,()=>`Length of inShape (${r.length}) and rank of dy (${t.rank}) must match`);let h=r,p=t,g=!1;t.rank===4&&(g=!0,p=m(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),h=[1,r[0],r[1],r[2],r[3]]);const b=h[4],_=p.shape[4];bt(h.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${h.length}.`),bt(p.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${p.rank}`),bt(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),bt(b===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${b}) must match input depth for filter ${n.shape[3]}.`),bt(_===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${_}) must match output depth for filter ${n.shape[4]}.`);const z={dy:p,filter:n},V={pad:u,strides:o,inputShape:h},at=lr.runKernel(Rs,z,V);return g?m(at,[at.shape[1],at.shape[2],at.shape[3],at.shape[4]]):at}const cu=br({conv3DBackpropInput_:kl});function Hs(r,t,n,o,u){const h=mn(r,"x","conv3dTranspose"),p=mn(t,"filter","conv3dTranspose");return cu(n,h,p,o,u)}const Ru=br({conv3dTranspose_:Hs});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ih(r){const n={x:mn(r,"x","cos")};return lr.runKernel(Su,n)}const Zh=br({cos_:ih});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qc(r){const n={x:mn(r,"x","cosh")};return lr.runKernel(fu,n)}const Bc=br({cosh_:qc});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kp(r,t=0,n=!1,o=!1){const h={x:mn(r,"x","cumsum")},p={axis:t,exclusive:n,reverse:o};return lr.runKernel(Is,h,p)}const qh=br({cumsum_:kp});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0(r,t,n,o=!1){const u=mn(r,"x","denseBincount"),h=mn(t,"weights","denseBincount");bt(u.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${u.dtype}`),bt(u.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${u.rank}.`),bt(n>=0,()=>`size must be non-negative, but got ${n}.`),bt(h.size===u.size||h.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${u.shape}, weights shape: ${h.shape}.`);const p={x:u,weights:h},g={size:n,binaryOutput:o};return lr.runKernel(Wi,p,g)}const Cg=br({denseBincount_:W0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wm(r,t,n="NHWC"){const o=mn(r,"x","depthToSpace"),u=n==="NHWC"?o.shape[1]:o.shape[2],h=n==="NHWC"?o.shape[2]:o.shape[3],p=n==="NHWC"?o.shape[3]:o.shape[1];bt(u*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${u} and ${t}  for depthToSpace with input shape
    ${o.shape}`),bt(h*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${h} and ${t} for depthToSpace with input shape
        ${o.shape}`),bt(p%(t*t)==0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${p} for depthToSpace with input shape ${o.shape}`);const g={x:o},b={blockSize:t,dataFormat:n};return lr.runKernel(ys,g,b)}const Fv=br({depthToSpace_:Wm});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function om(r,t,n,o,u="NHWC",h=[1,1],p){const g=mn(r,"x","depthwiseConv2d"),b=mn(t,"filter","depthwiseConv2d");let _=g,z=!1;g.rank===3&&(z=!0,_=m(g,[1,g.shape[0],g.shape[1],g.shape[2]])),bt(_.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${_.rank}.`),bt(b.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${b.rank}.`),bt(_.shape[3]===b.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${_.shape[3]}) must match the inChannels dimension in filter ${b.shape[2]}.`),p!=null&&bt(xr(o),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${p} but got pad ${o}.`);const V={x:_,filter:b},at={strides:n,pad:o,dataFormat:u,dilations:h,dimRoundingMode:p},Et=lr.runKernel(is,V,at);return z?m(Et,[Et.shape[1],Et.shape[2],Et.shape[3]]):Et}const dv=br({depthwiseConv2d_:om});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sm(r){const n={x:mn(r,"x","diag")};return lr.runKernel(qs,n)}const um=br({diag_:sm});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1(r,t,n,o,u=[1,1],h="NHWC"){const p=mn(r,"x","dilation2d"),g=mn(t,"filter","dilation2d");bt(p.rank===3||p.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${p.rank}.`),bt(g.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${g.rank}.`),bt(h==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${h}`);let b=p,_=!1;p.rank===3&&(b=m(p,[1,p.shape[0],p.shape[1],p.shape[2]]),_=!0);const z={x:b,filter:g},V={strides:n,pad:o,dilations:u},at=lr.runKernel(Cu,z,V);return _?m(at,[at.shape[1],at.shape[2],at.shape[3]]):at}const lm=br({dilation2d_:D1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0(r,t){let n=mn(r,"a","equal"),o=mn(t,"b","equal");[n,o]=Si(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return lr.runKernel(Qs,u)}const bd=br({equal_:V0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ul(r,t,n){const o=mn(t,"a","where"),u=mn(n,"b","where"),h=mn(r,"condition","where","bool"),p=Nr(o.shape,u.shape),g=ka(o,p),b=ka(u,p);h.rank===1&&bt(h.shape[0]===o.shape[0],()=>"The first dimension of `a` must match the size of `condition`."),h.rank!==1&&Me(h.shape,b.shape,"Error in where: ");const _={condition:h,t:g,e:b};return lr.runKernel(Sf,_)}const Cl=br({where_:Ul});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j0(r,t){let n=mn(r,"a","div"),o=mn(t,"b","div");[n,o]=Si(n,o);const u=or(n,o),h=xi(u),p=bd(o,h);return Cl(p,h,u)}const _g=br({divNoNan_:j0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O1(r,t){const n=mn(r,"t1","dot"),o=mn(t,"t2","dot");bt((n.rank===1||n.rank===2)&&(o.rank===1||o.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${o.rank}.`);const u=n.rank===1?n.size:n.shape[1],h=o.rank===1?o.size:o.shape[0];if(bt(u===h,()=>`Error in dot: inner dimensions of inputs must match, but got ${u} and ${h}.`),n.rank===1&&o.rank===1){const p=m(n,[1,-1]),g=m(o,[-1,1]),b=$s(p,g);return m(b,[])}else if(n.rank===1&&o.rank===2){const p=m(n,[1,-1]),g=m(o,[o.shape[0],o.shape[1]]),b=$s(p,g);return m(b,[b.size])}else if(n.rank===2&&o.rank===1){const p=m(o,[-1,1]),g=$s(n,p);return m(g,[g.size])}else{const p=m(o,[o.shape[0],o.shape[1]]);return $s(n,p)}}const cm=br({dot_:O1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MS(r){const n={x:mn(r,"x","elu")};return lr.runKernel(os,n)}const fm=br({elu_:MS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NS(r){let t=mn(r,"x","erf");bt(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=qi(t,"float32"));const n={x:t};return lr.runKernel(Ss,n)}const H0=br({erf_:NS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kS(r){const n={x:mn(r,"x","exp")};return lr.runKernel(Qu,n)}const Qh=br({exp_:kS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vm(r,t=0){const n=mn(r,"x","expandDims","string_or_numeric");bt(t<=n.rank,()=>"Axis must be <= rank of the tensor");const o={input:n},u={dim:t};return lr.runKernel(xn,o,u)}const xd=br({expandDims_:Vm});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DS(r){const n={x:mn(r,"x","expm1")};return lr.runKernel(Vr,n)}const X0=br({expm1_:DS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R1(r,t){const n=mn(r,"x","tile","string_or_numeric");bt(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const o={x:n},u={reps:t};return lr.runKernel(Mi,o,u)}const wd=br({tile_:R1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ox(r,t,n,o="float32"){t==null&&(t=r);const u=zs([r,t],o),h=r<=t?r:t;for(let g=0;g<h;++g)u.set(1,g,g);const p=m(u.toTensor(),[r,t]);if(n==null)return p;if(n.length===1)return wd(xd(p,0),[n[0],1,1]);if(n.length===2)return wd(xd(xd(p,0),0),[n[0],n[1],1,1]);if(n.length===3)return wd(xd(xd(xd(p,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const jm=br({eye_:Ox});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y0(r){const n={x:mn(r,"x","floor")};return lr.runKernel(Ao,n)}const Ig=br({floor_:Y0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OS(r,t,n=0,o=0){const u=mn(r,"x","gather"),h=mn(t,"indices","gather","int32"),p={x:u,indices:h},g={axis:n,batchDims:o};return lr.runKernel(Ts,p,g)}const pv=br({gather_:OS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L1(r,t){let n=mn(r,"a","greater"),o=mn(t,"b","greater");[n,o]=Si(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return lr.runKernel(ou,u)}const Ah=br({greater_:L1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RS(r,t){let n=mn(r,"a","greaterEqual"),o=mn(t,"b","greaterEqual");[n,o]=Si(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return lr.runKernel(Cs,u)}const Bv=br({greaterEqual_:RS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K0(r){const n={input:mn(r,"input","imag")};return lr.runKernel(bl,n)}const Z0=br({imag_:K0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LS(r){const n={x:mn(r,"x","isFinite")};return lr.runKernel(Js,n)}const Rx=br({isFinite_:LS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PS(r){const n={x:mn(r,"x","isInf")};return lr.runKernel(ul,n)}const Lx=br({isInf_:PS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Px(r){const n={x:mn(r,"x","isNaN")};return lr.runKernel(Mu,n)}const P1=br({isNaN_:Px});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rg(r,t=.2){const o={x:mn(r,"x","leakyRelu")},u={alpha:t};return lr.runKernel(Pu,o,u)}const Hm=br({leakyRelu_:rg});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fx(r,t){let n=mn(r,"a","less"),o=mn(t,"b","less");[n,o]=Si(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return lr.runKernel(Nu,u)}const Xm=br({less_:Fx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FS(r,t){let n=mn(r,"a","lessEqual"),o=mn(t,"b","lessEqual");[n,o]=Si(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return lr.runKernel(fs,u)}const Sc=br({lessEqual_:FS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bx(r,t,n){if(n<=0)throw new Error("The number of values should be positive.");const o={start:r,stop:t,num:n};return lr.runKernel(Bs,{},o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zx(r,t=5,n=1,o=1,u=.5){const h=mn(r,"x","localResponseNormalization");bt(h.rank===4||h.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${h.rank}.`),bt(xr(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let p=h,g=!1;h.rank===3&&(g=!0,p=m(h,[1,h.shape[0],h.shape[1],h.shape[2]]));const b={x:p},_={depthRadius:t,bias:n,alpha:o,beta:u},z=lr.runKernel(Bl,b,_);return g?m(z,[z.shape[1],z.shape[2],z.shape[3]]):z}const F1=br({localResponseNormalization_:zx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $x(r){const n={x:mn(r,"x","log")};return lr.runKernel(gu,n)}const zc=br({log_:$x});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gx(r){const n={x:mn(r,"x","log1p")};return lr.runKernel(Fu,n)}const q0=br({log1p_:Gx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ux(r){const n={x:mn(r,"x","neg")};return lr.runKernel(Ge,n)}const oi=br({neg_:Ux});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mA(r){const n={x:mn(r,"x","softplus")};return lr.runKernel(Re,n)}const hm=br({softplus_:mA});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BS(r){const t=mn(r,"x","logSigmoid");return _u(o=>({value:oi(hm(oi(o))),gradFunc:p=>Hn(p,Bt(oi(o)))}))(t)}const B1=br({logSigmoid_:BS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tg(r,t=null,n=!1){const u={x:mn(r,"x","max")},h={reductionIndices:t,keepDims:n};return lr.runKernel(Ls,u,h)}const Gf=br({max_:Tg});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zS(r,t=null,n=!1){let o=mn(r,"x","sum");o.dtype==="bool"&&(o=qi(o,"int32"));const u={x:o},h={axis:t,keepDims:n};return lr.runKernel(an,u,h)}const ss=br({sum_:zS});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $S(r,t=-1){const n=mn(r,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return _u((u,h)=>{const p=!0,g=Gf(u,t,!0),b=pi(u,g),_=pi(qi(b,"float32"),zc(ss(Qh(b),t,p)));return h([_]),{value:_,gradFunc:(V,at)=>{const[Et]=at,St=!0,Tt=Qh(Et);return pi(V,Hn(ss(V,t,St),Tt))}}})(n)}const Q0=br({logSoftmax_:$S});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z1(r,t){for(let n=0;n<r.length;++n)if(r[r.length-n-1]!==t-1-n)return!1;return!0}function $1(r,t,n){const o=r.length+t.length,u=[];let h=0,p=0;for(let g=0;g<o;g++)n.indexOf(g)===-1?u.push(r[h++]):u.push(t[p++]);return u}function uf(r,t){const n=[],o=r.length;for(let h=0;h<o;h++)t.indexOf(h)===-1&&n.push(r[h]);const u=t.map(h=>r[h]);return[n,u]}function $c(r,t){const n=t.map(o=>1);return $1(r,n,t)}function kf(r,t,n){bt(z1(t,n),()=>`${r} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function Gc(r,t){if(z1(r,t))return null;const n=[];for(let o=0;o<t;++o)r.indexOf(o)===-1&&n.push(o);return r.forEach(o=>n.push(o)),n}function dm(r){return r.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function Qc(r,t){const n=[];for(let o=t-r;o<t;++o)n.push(o);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J0(r,t=null,n=!1){const o=mn(r,"x","logSumExp"),u=Lr(t,o.shape),h=Gf(o,u,!0),p=pi(o,h),g=Qh(p),b=ss(g,u),_=zc(b),z=En(m(h,_.shape),_);if(n){const V=$c(z.shape,u);return m(z,V)}return z}const Ym=br({logSumExp_:J0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wx(r,t){const n=mn(r,"a","logicalAnd","bool"),o=mn(t,"b","logicalAnd","bool");Nr(n.shape,o.shape);const u={a:n,b:o};return lr.runKernel(Wu,u)}const Ed=br({logicalAnd_:Wx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ty(r){const n={x:mn(r,"x","logicalNot","bool")};return lr.runKernel(Ju,n)}const ag=br({logicalNot_:ty});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G1(r,t){const n=mn(r,"a","logicalOr","bool"),o=mn(t,"b","logicalOr","bool");Nr(n.shape,o.shape);const u={a:n,b:o};return lr.runKernel(tu,u)}const Ag=br({logicalOr_:G1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vx(r,t){const n=mn(r,"a","logicalXor","bool"),o=mn(t,"b","logicalXor","bool");return Nr(n.shape,o.shape),Ed(Ag(r,t),ag(Ed(r,t)))}const U1=br({logicalXor_:Vx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mg(r,t,n,o,u){const h=mn(r,"x","maxPool"),p=1;let g=h,b=!1;h.rank===3&&(b=!0,g=m(h,[1,h.shape[0],h.shape[1],h.shape[2]])),bt(g.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${g.rank}.`),bt(Ec(n,p),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${p}'`),u!=null&&bt(xr(o),()=>`Error in maxPool: pad must be an integer when using, dimRoundingMode ${u} but got pad ${o}.`);const _={x:g},z={filterSize:t,strides:n,pad:o,dimRoundingMode:u},V=lr.runKernel(oc,_,z);return b?m(V,[V.shape[1],V.shape[2],V.shape[3]]):V}const Ng=br({maxPool_:Mg});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W1(r,t=[1,1,1],n,o,u,h="NDHWC",p){p==null?p=[1,1,1]:ea("dilations is deprecated, this field will be gone in v3.0.0.");const g=mn(r,"x","maxPool3d");let b=g,_=!1;g.rank===4&&(_=!0,b=m(g,[1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]])),bt(b.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${b.rank}.`),bt(h==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${h}`),bt(Ec(n,p),()=>`Error in maxPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${p}'`),u!=null&&bt(xr(o),()=>`Error in maxPool3d: pad must be an integer when using, dimRoundingMode ${u} but got pad ${o}.`);const z={x:b},V={filterSize:t,strides:n,pad:o,dimRoundingMode:u,dataFormat:h,dilations:p},at=lr.runKernel(Ic,z,V);return _?m(at,[at.shape[1],at.shape[2],at.shape[3],at.shape[4]]):at}const ey=br({maxPool3d_:W1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pm(r,t,n,o,u=!1){const p={x:mn(r,"x","maxPoolWithArgmax")},g={filterSize:t,strides:n,pad:o,includeBatchInIndex:u},b=lr.runKernel(ve,p,g);return{result:b[0],indexes:b[1]}}const ny=br({maxPoolWithArgmax_:pm});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GS(r,t=null,n=!1){const u={x:mn(r,"x","mean")},h={axis:t,keepDims:n};return lr.runKernel(Gt,u,h)}const nc=br({mean_:GS});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jx(r,t=null,n=!1){const u={x:mn(r,"x","min")},h={axis:t,keepDims:n};return lr.runKernel(re,u,h)}const ig=br({min_:jx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function US(r,t){let n=mn(r,"a","minimum"),o=mn(t,"b","minimum");[n,o]=Si(n,o),n.dtype==="bool"&&(n=qi(n,"int32"),o=qi(o,"int32")),Nr(n.shape,o.shape);const u={a:n,b:o};return lr.runKernel(me,u)}const og=br({minimum_:US});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hx(r,t,n){bt(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const o=mn(r,"x","mirrorPad");if(o.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");bt(t.length===o.rank,()=>`Padding doesn't match input. Must be ${o.rank}. Got ${t.length}.`);const u=n==="reflect"?1:0;for(let g=0;g<o.rank;g++)bt(t[g].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),bt(t[g][0]>=0&&t[g][0]<=o.shape[g]-u&&t[g][1]>=0&&t[g][1]<=o.shape[g]-u,()=>`Padding in dimension ${g} cannot be greater than or equal to ${o.shape[g]-u} or less than 0 for input of shape ${o.shape}`);const h={paddings:t,mode:n},p={x:o};return lr.runKernel(bn,p,h)}const V1=br({mirrorPad_:Hx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WS(r,t){let n=mn(r,"a","mod"),o=mn(t,"b","mod");[n,o]=Si(n,o);const u={a:n,b:o};return lr.runKernel(Zn,u)}const ry=br({mod_:WS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VS(r,t=null,n=!1){r=mn(r,"x","moments");const o=Lr(t,r.shape),u=nc(r,o,n);let h=u.shape;n||(h=$c(u.shape,o));const p=_i(pi(qi(r,"float32"),m(u,h))),g=nc(p,o,n);return{mean:u,variance:g}}const Km=br({moments_:VS});function jS(r,t,n,o){const u=mn(t,"data","multiRNNCell"),h=Yc(n,"c","multiRNNCell"),p=Yc(o,"h","multiRNNCell");let g=u;const b=[];for(let V=0;V<r.length;V++){const at=r[V](g,h[V],p[V]);b.push(at[0]),b.push(at[1]),g=at[1]}const _=[],z=[];for(let V=0;V<b.length;V+=2)_.push(b[V]),z.push(b[V+1]);return[_,z]}const Dp=br({multiRNNCell_:jS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HS(r,t,n,o=!1){const u=mn(r,"logits","multinomial"),h=u.size,p=u.rank;if(h<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${h}.`);if(p>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${p}`);n=n||Math.random();const b={logits:p===1?m(u,[1,-1]):u},_={numSamples:t,seed:n,normalized:o},z=lr.runKernel(Yt,b,_);return p===1?m(z,[z.size]):z}const Xx=br({multinomial_:HS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ay(r,t){let n=mn(r,"a","notEqual"),o=mn(t,"b","notEqual");[n,o]=Si(n,o),Nr(n.shape,o.shape);const u={a:n,b:o};return lr.runKernel(Fe,u)}const sg=br({notEqual_:ay});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uc(r,t="float32"){if(t==="complex64"){const o=Uc(r,"float32"),u=Uc(r,"float32");return Pf(o,u)}const n=Ot(Rt(r),t);return lr.makeTensor(n,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Op(r,t="float32"){if(t==="complex64"){const o=Op(r,"float32"),u=Uc(r,"float32");return Pf(o,u)}const n=Lt(Rt(r),t);return lr.makeTensor(n,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XS(r){const n={x:mn(r,"x","onesLike")};return lr.runKernel(Ta,n)}const Jh=br({onesLike_:XS});function ug(r,t){const n=mn(r,"v1","outerProduct"),o=mn(t,"v2","outerProduct");bt(n.rank===1&&o.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${o.rank}.`);const u=m(n,[-1,1]),h=m(o,[1,-1]);return $s(u,h)}const YS=br({outerProduct_:ug});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KS(r,t,n=0){const o=mn(r,"x","pad");if(o.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const u={paddings:t,constantValue:n},h={x:o};return lr.runKernel(Oa,h,u)}const zv=br({pad_:KS});function ZS(r,t,n=0){return bt(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),zv(r,[t],n)}const qS=br({pad1d_:ZS});function Yx(r,t,n=0){return bt(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),zv(r,t,n)}const QS=br({pad2d_:Yx});function j1(r,t,n=0){return bt(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),zv(r,t,n)}const JS=br({pad3d_:j1});function Kx(r,t,n=0){return bt(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),zv(r,t,n)}const Zm=br({pad4d_:Kx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t2(r,t,n){const o=mn(r,"x","spaceToBatchND");bt(o.rank>=1+t.length,()=>`input rank ${o.rank} should be > than [blockShape] ${t.length}`),bt(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),bt(o.shape.reduce((p,g,b)=>b>0&&b<=t.length?p&&(g+n[b-1][0]+n[b-1][1])%t[b-1]==0:p,!0),()=>`input spatial dimensions ${o.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const u={x:o},h={blockShape:t,paddings:n};return lr.runKernel(wn,u,h)}const qm=br({spaceToBatchND_:t2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e2(r,t,n,o,u,h){u==null&&(u=[1,1]),h==null&&(h=1),o===0&&(o="valid");const p=mn(r,"x","maxPool");let g=p,b=!1;p.rank===3&&(b=!0,g=m(p,[1,p.shape[0],p.shape[1],p.shape[2]])),bt(Ec(h,u),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${h} and dilations '${u}'`);const _=mf(g.shape,t,h,u,o),z=[_.dilationHeight,_.dilationWidth];let V;o==="same"?V=iy([_.filterHeight,_.filterWidth],z):V=[[0,0],[0,0]];const at=z[0]===1&&z[1]===1,[Et,St]=n2([_.inHeight,_.inWidth],z,V),Tt=at?o:"valid",Wt=at?g:qm(g,z,Et),ye=(n==="avg"?()=>S(Wt,t,h,Tt):()=>Ng(Wt,t,h,Tt))(),Qe=at?ye:hn(ye,z,St);return b?m(Qe,[Qe.shape[1],Qe.shape[2],Qe.shape[3]]):Qe}function n2(r,t,n){const o=n.map(z=>z[0]),u=n.map(z=>z[1]),h=r.concat(o,u),p=t.map((z,V)=>(z-h[V]%z)%z),g=u.map((z,V)=>z+p[V]),b=t.map((z,V)=>[o[V],g[V]]),_=t.map((z,V)=>[0,p[V]]);return[b,_]}function iy(r,t){const o=r.map((p,g)=>p+(p-1)*(t[g]-1)).map(p=>p-1),u=o.map(p=>Math.floor(p/2)),h=o.map((p,g)=>p-u[g]);return o.map((p,g)=>[u[g],h[g]])}const H1=br({pool_:e2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r2(r,t){const n=mn(r,"x","prelu"),o=mn(t,"alpha","prelu"),u={x:n,alpha:o};return lr.runKernel(Oi,u)}const kg=br({prelu_:r2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zx(r,t=null,n=!1){let o=mn(r,"x","prod");o.dtype==="bool"&&(o=qi(o,"int32"));const u={x:o},h={axis:t,keepDims:n};return lr.runKernel(hs,u,h)}const oy=br({prod_:Zx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a2(r,t,n){const o=Rt(r);let u=null;if(n==null||n==="float32")u=new Float32Array(o);else if(n==="int32")u=new Int32Array(o);else if(n==="bool")u=new Uint8Array(o);else throw new Error(`Unknown data type ${n}`);for(let h=0;h<o;h++)u[h]=t();return lr.makeTensor(u,r,n)}const i2=br({rand_:a2});var vm=$(36377);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X1{constructor(t,n,o,u,h){this.mean=t,this.stdDev=n,this.dtype=o,this.nextVal=NaN,this.truncated=u,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const p=h||Math.random();this.random=vm.alea(p.toString())}nextValue(){if(!isNaN(this.nextVal)){const u=this.nextVal;return this.nextVal=NaN,u}let t,n,o=!1;for(;!o;){let u,h,p;do u=2*this.random()-1,h=2*this.random()-1,p=u*u+h*h;while(p>=1||p===0);const g=Math.sqrt(-2*Math.log(p)/p);t=this.mean+this.stdDev*u*g,n=this.mean+this.stdDev*h*g,(!this.truncated||this.isValidTruncated(t))&&(o=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class o2{constructor(t,n,o,u){this.alpha=t,this.beta=1/n,this.dtype=o;const h=u||Math.random();this.randu=vm.alea(h.toString()),this.randn=new X1(0,1,o,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,n,o,u,h,p;for(;;){do u=this.randn.nextValue(),p=1+this.c*u;while(p<=0);if(p*=p*p,t=u*u,n=1-.331*t*t,o=.5*t+this.d*(1-p+Math.log(p)),h=this.randu(),h<n||Math.log(h)<o)break}return p=1/this.beta*this.d*p,this.alpha<1&&(p*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(p)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}}class s2{constructor(t=0,n=1,o,u){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=o,u==null&&(u=Math.random()),typeof u=="number"&&(u=u.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=vm.alea(u)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}function yA(r){const t=r.length,n=Qx(r),o=qx(r),u=t/6*(Math.pow(n,2)+.25*Math.pow(o-3,2));if(u>5.991)throw new Error(`Invalid p-value for JB: ${u}`)}function bA(r,t,n,o){o==null&&(o=testEpsilon());const u=Y1(r);expectNumbersClose(u,t,o),expectNumbersClose(u2(r,u),n,o)}function Y1(r){let t=0;for(let n=0;n<r.length;n++)t+=r[n];return t/r.length}function u2(r,t){let n=0;for(let o=0;o<r.length;o++){const u=r[o]-t;n+=u*u}return Math.sqrt(n/r.length)}function qx(r){const t=Y1(r),n=r.length;let o=0,u=0;for(let h=0;h<n;h++){const p=r[h]-t;o+=Math.pow(p,2),u+=Math.pow(p,4)}return 1/n*u/Math.pow(1/n*o,2)}function Qx(r){const t=Y1(r),n=r.length;let o=0,u=0;for(let h=0;h<n;h++){const p=r[h]-t;o+=Math.pow(p,2),u+=Math.pow(p,3)}return 1/n*u/Math.pow(1/(n-1)*o,3/2)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jx(r,t,n=1,o="float32",u){if(n==null&&(n=1),o==null&&(o="float32"),o!=="float32"&&o!=="int32")throw new Error(`Unsupported data type ${o}`);const h=new o2(t,n,o,u),p=zs(r,o);for(let g=0;g<p.values.length;g++)p.values[g]=h.nextValue();return p.toTensor()}const l2=br({randomGamma_:Jx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $v(r,t=0,n=1,o,u){if(o!=null&&o==="bool")throw new Error(`Unsupported data type ${o}`);const h=new X1(t,n,o,!1,u),p=zs(r,o);for(let g=0;g<p.values.length;g++)p.values[g]=h.nextValue();return p.toTensor()}const c2=br({randomNormal_:$v});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K1(r,t=0,n=1,o="float32",u){const h=zs(r,o),p=new s2(t,n,null,u);for(let g=0;g<h.values.length;g++)h.values[g]=p.nextValue();return h.toTensor()}const du=br({randomUniform_:K1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z1(r,t,n=1,o="float32"){if(n===0)throw new Error("Cannot have a step of zero");const u={start:r,stop:t,step:n,dtype:o};return lr.runKernel(wo,{},u)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xd(r){const n={input:mn(r,"input","real")};return lr.runKernel(ho,n)}const gm=br({real_:Xd});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tw(r){const n={x:mn(r,"x","reciprocal")};return lr.runKernel(Ro,n)}const q1=br({reciprocal_:tw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f2(r){const n={x:mn(r,"x","relu")};return lr.runKernel(Ys,n)}const td=br({relu_:f2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qm(r){const n={x:mn(r,"x","relu6")};return lr.runKernel(Rl,n)}const Jm=br({relu6_:Qm});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ew(r,t){const o={x:mn(r,"x","reverse")},u={dims:t};return lr.runKernel(Ll,o,u)}const ed=br({reverse_:ew});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nw(r){const t=mn(r,"x","reverse");return bt(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),ed(t,0)}const h2=br({reverse1d_:nw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yd(r,t){const n=mn(r,"x","reverse");return bt(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),ed(n,t)}const d2=br({reverse2d_:Yd});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p2(r,t){const n=mn(r,"x","reverse");return bt(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),ed(n,t)}const v2=br({reverse3d_:p2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g2(r,t){const n=mn(r,"x","reverse");return bt(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),ed(n,t)}const m2=br({reverse4d_:g2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y2(r){const n={x:mn(r,"x","round")};return lr.runKernel(nl,n)}const Q1=br({round_:y2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b2(r){const n={x:mn(r,"x","rsqrt")};return lr.runKernel(rl,n)}const sy=br({rsqrt_:b2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x2(r){const n={x:mn(r,"x","selu")};return lr.runKernel(Yl,n)}const Dg=br({selu_:x2});function rw(r,t,n,o,u,h=[1,1],p="NHWC"){const g=mn(r,"x","separableConv2d"),b=mn(t,"depthwiseFilter","separableConv2d"),_=mn(n,"pointwiseFilter","separableConv2d");let z=g,V=!1;if(g.rank===3&&(V=!0,z=m(g,[1,g.shape[0],g.shape[1],g.shape[2]])),p==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");bt(z.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${z.rank}.`),bt(b.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${b.rank}.`),bt(_.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${b.rank}.`),bt(_.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${_.shape[0]}.`),bt(_.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${_.shape[1]}.`);const at=b.shape[2],Et=b.shape[3];bt(_.shape[2]===at*Et,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${at*Et}, but got ${_.shape[2]}.`);const St=dv(z,b,o,u,p,h),Wt=rs(St,_,1,"valid",p);return V?m(Wt,[Wt.shape[1],Wt.shape[2],Wt.shape[3]]):Wt}const J1=br({separableConv2d_:rw});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w2(r,t){return jr(this,null,function*(){const n=mn(r,"x","setdiff1d"),o=mn(t,"y","setdiff1d");bt(n.dtype===o.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${o.dtype}).`),bt(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),bt(o.rank===1,()=>`y should be 1D tensor, but got y (${o.shape}).`);const u=yield n.data(),h=yield o.data(),p=new Set(h);let g=0;for(let z=0;z<u.length;z++)p.has(u[z])||g++;const b=new ae([g],n.dtype),_=new ae([g],"int32");for(let z=0,V=0;z<u.length;z++)p.has(u[z])||(b.values[V]=u[z],_.values[V]=z,V++);return[b.toTensor(),_.toTensor()]})}const aw=w2;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E2(r){const n={x:mn(r,"x","sign")};return lr.runKernel(Kt,n)}const tb=br({sign_:E2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S2(r){const n={x:mn(r,"x","sin")};return lr.runKernel(T,n)}const uy=br({sin_:S2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C2(r){const n={x:mn(r,"x","sinh")};return lr.runKernel(rt,n)}const ly=br({sinh_:C2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _2(r,t,n){const o=mn(r,"x","slice1d");return bt(o.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${o.rank} tensor`),Zt(o,[t],[n])}const cy=br({slice1d_:_2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xA(r,t,n){const o=mn(r,"x","slice2d");return bt(o.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${o.rank} tensor`),Zt(o,t,n)}const eb=br({slice2d_:xA});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2(r,t,n){const o=mn(r,"x","slice3d");return bt(o.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${o.rank} tensor`),Zt(o,t,n)}const t0=br({slice3d_:I2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T2(r,t,n){const o=mn(r,"x","slice4d");return bt(o.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${o.rank} tensor`),Zt(o,t,n)}const e0=br({slice4d_:T2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A2(r,t=-1){const n=mn(r,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const o={logits:n},u={dim:t};return lr.runKernel(rr,o,u)}const n0=br({softmax_:A2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2(r){bt(r.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${r.dtype}.`);const t={input:r};return lr.runKernel(pa,t)}const r0=br({fft_:M2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N2(r){bt(r.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${r.dtype}.`);const t={input:r};return lr.runKernel(Tl,t)}const mm=br({ifft_:N2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iw(r){const t=r.shape[r.shape.length-1],n=r.size/t;let o;if(t<=2){const u=m(r,[n,t]);o=mm(u)}else{const u=[n,2*(t-1)],h=m(gm(r),[n,t]),p=m(Z0(r),[n,t]),g=ed(Zt(h,[0,1],[n,t-2]),1),b=Hn(ed(Zt(p,[0,1],[n,t-2]),1),zi(-1)),_=vt([h,g],1),z=vt([p,b],1),V=m(Pf(_,z),[u[0],u[1]]);o=mm(V)}if(o=gm(o),r.rank===3&&r.shape[0]!==0){const u=o,h=r.shape[0];o=m(o,[h,o.shape[0]/h,o.shape[1]]),u.dispose()}return o}const fy=br({irfft_:iw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2(r,t,n=0){const u={x:mn(r,"x","split")},h={numOrSizeSplits:t,axis:n};return lr.runKernel(Mn,u,h)}const nd=br({split_:k2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D2(r,t){bt(r.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${r.dtype}`);let n=r.shape[r.shape.length-1];const o=r.size/n;let u;if(t!=null&&t<n){const St=r.shape.map(Wt=>0),Tt=r.shape.map(Wt=>Wt);Tt[r.shape.length-1]=t,u=Zt(r,St,Tt),n=t}else if(t!=null&&t>n){const St=r.shape.map(Tt=>Tt);St[r.shape.length-1]=t-n,u=vt([r,Uc(St)],r.shape.length-1),n=t}else u=r;const h=xi(u),p=m(Pf(u,h),[o,n]),g=r0(p),b=Math.floor(n/2)+1,_=gm(g),z=Z0(g),V=nd(_,[b,n-b],_.shape.length-1),at=nd(z,[b,n-b],z.shape.length-1),Et=u.shape.slice();return Et[u.shape.length-1]=b,m(Pf(V[0],at[0]),Et)}const a0=br({rfft_:D2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O2(r,t){let n=mn(r,"a","squaredDifference"),o=mn(t,"b","squaredDifference");[n,o]=Si(n,o),Nr(n.shape,o.shape);const u={a:n,b:o},h={};return lr.runKernel(We,u,h)}const i0=br({squaredDifference_:O2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R2(r,t){const n=mn(r,"x","squeeze");return m(n,_n(n.shape,t).newShape)}const lg=br({squeeze_:R2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ow(r,t=0){const n=Yc(r,"tensors","stack","string_or_numeric");bt(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&bt(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const o=n,u={axis:t};return lr.runKernel(ja,o,u)}const rd=br({stack_:ow});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L2(r,t=0){const o={x:mn(r,"x","step")},u={alpha:t};return lr.runKernel(Bu,o,u)}const ym=br({step_:L2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2(r,t,n,o,u=0,h=0,p=0,g=0,b=0){const z={x:mn(r,"x","stridedSlice")},V={begin:t,end:n,strides:o,beginMask:u,endMask:h,ellipsisMask:p,newAxisMask:g,shrinkAxisMask:b};return lr.runKernel(Va,z,V)}const nb=br({stridedSlice_:P2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F2(r){const n={x:mn(r,"x","tan")};return lr.runKernel(qa,n)}const rb=br({tan_:F2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ad(r,t){en(r);const n=Kl(r,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Tc(r,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rp(r,t,n){if(en(r),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const o=Kl(r,n);if(o.length!==2&&o.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(o.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Tc(r,t,o,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wA(r,t,n){if(en(r),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const o=Kl(r,n);if(o.length!==4&&o.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(o.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Tc(r,t,o,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B2(r,t,n){if(en(r),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const o=Kl(r,n);if(o.length!==5&&o.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(o.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Tc(r,t,o,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o0(r,t,n){if(en(r),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const o=Kl(r,n);if(o.length!==6&&o.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(o.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||o,Tc(r,t,o,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hy(r,t=1,n=!0){const o=mn(r,"x","topk");if(o.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const u=o.shape[o.shape.length-1];if(t>u)throw new Error(`'k' passed to topk() must be <= the last dimension (${u}) but got ${t}`);const h={x:o},p={k:t,sorted:n},[g,b]=lr.runKernel(zo,h,p);return{values:g,indices:b}}const bm=br({topk_:hy});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sw(r,t=0,n=1,o,u){if(o!=null&&o==="bool")throw new Error("Unsupported data type $ { dtype }");const h=new X1(t,n,o,!0,u),p=zs(r,o);for(let g=0;g<p.values.length;g++)p.values[g]=h.nextValue();return p.toTensor()}const dy=br({truncatedNormal_:sw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2(r,t=0){const n=mn(r,"x","unique","string_or_numeric");bt(n.rank>0,()=>"The input tensor must be at least 1D");const o={x:n},u={axis:t},[h,p]=lr.runKernel(Lo,o,u);return{values:h,indices:p}}const py=br({unique_:z2});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uw(r,t,n){const o=mn(r,"x","unsortedSegmentSum"),u=mn(t,"segmentIds","unsortedSegmentSum","int32");bt(xr(n),()=>"numSegments must be of dtype int");const h={x:o,segmentIds:u},p={numSegments:n};return lr.runKernel(No,h,p)}const vy=br({unsortedSegmentSum_:uw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $2(r,t=0){const n=mn(r,"x","unstack","string_or_numeric");bt(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const o={value:n},u={axis:t};return lr.runKernel(yo,o,u)}const Sd=br({unstack_:$2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ab(r,t=!0,n,o){return lr.makeVariable(r,t,n,o)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0(r,t){const n=[];for(let h=0;h<t.length;h++)t[h]&&n.push(h);const o=zs(r,"int32"),u=zs([n.length,r.length],"int32");for(let h=0;h<n.length;h++){const p=o.indexToLoc(n[h]),g=h*r.length;u.values.set(p,g)}return u.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gy(r){return jr(this,null,function*(){const t=mn(r,"condition","whereAsync","bool"),n=yield t.data(),o=s0(t.shape,n);return r!==t&&t.dispose(),o})}const u0=gy;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oh(r,t,n){return jr(this,null,function*(){const o=mn(r,"tensor","boolMask"),u=mn(t,"mask","boolMask","bool"),h=n==null?0:n,p=u.rank,g=o.shape;bt(p>0,()=>"mask cannot be scalar"),Me(g.slice(h,h+p),u.shape,"mask's shape must match the first K dimensions of tensor's shape,");let b=1;for(let Tt=h;Tt<h+p;Tt++)b*=g[Tt];const _=g.slice(0,h).concat([b],g.slice(h+p)),z=m(o,_),V=m(u,[-1]),at=yield u0(V),Et=lg(at,[1]),St=pv(z,Et,h);return r!==o&&o.dispose(),t!==u&&u.dispose(),Et.dispose(),z.dispose(),V.dispose(),at.dispose(),St})}const ib=oh;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EA(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","notEqualStrict"),o=mn(t,"b","notEqualStrict");return Me(n.shape,o.shape,"Error in notEqualStrict: "),sg(n,o)}function SA(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","lessStrict"),o=mn(t,"b","lessStrict");return Me(n.shape,o.shape,"Error in lessStrict: "),Xm(n,o)}function CA(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","equalStrict"),o=mn(t,"b","equalStrict");return Me(n.shape,o.shape,"Error in equalStrict: "),bd(n,o)}function _A(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","lessEqualStrict"),o=mn(t,"b","lessEqualStrict");return Me(n.shape,o.shape,"Error in lessEqualStrict: "),Sc(n,o)}function IA(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","greaterStrict"),o=mn(t,"b","greaterStrict");return Me(n.shape,o.shape,"Error in greaterStrict: "),Ah(n,o)}function TA(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","greaterEqualStrict"),o=mn(t,"b","greaterEqualStrict");return Me(n.shape,o.shape,"Error in greaterEqualStrict: "),Bv(n,o)}const G2=br({equalStrict_:CA}),U2=br({greaterEqualStrict_:TA}),W2=br({greaterStrict_:IA}),V2=br({lessEqualStrict_:_A}),j2=br({lessStrict_:SA}),H2=br({notEqualStrict_:EA});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AA(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","addStrict"),o=mn(t,"b","addStrict");return Me(n.shape,o.shape,"Error in addStrict: "),En(n,o)}function yf(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","subStrict"),o=mn(t,"b","subStrict");return Me(n.shape,o.shape,"Error in subStrict: "),pi(n,o)}function X2(r,t){return ea("strict variants of ops have been deprecated and will be removed in future"),Me(r.shape,t.shape,"Error in powStrict: "),po(r,t)}function Y2(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","mul"),o=mn(t,"b","mul");return Me(n.shape,o.shape,"Error in multiplyStrict: "),Hn(n,o)}function ob(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","div"),o=mn(t,"b","div");return Me(n.shape,o.shape,"Error in divideStrict: "),or(n,o)}function K2(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","modStrict"),o=mn(t,"b","modStrict");return Me(n.shape,o.shape,"Error in modStrict: "),ry(n,o)}function Z2(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","minimumStrict"),o=mn(t,"b","minimumStrict");return Me(n.shape,o.shape,"Error in minimumStrict: "),og(n,o)}function q2(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","maximumStrict"),o=mn(t,"b","maximumStrict");return Me(n.shape,o.shape,"Error in maximumStrict: "),Jo(n,o)}function lw(r,t){ea("strict variants of ops have been deprecated and will be removed in future");const n=mn(r,"a","squaredDifferenceStrict"),o=mn(t,"b","squaredDifferenceStrict");return Me(n.shape,o.shape,"Error in squaredDifferenceStrict: "),i0(n,o)}const Iu=br({addStrict_:AA}),cg=br({divStrict_:ob}),l0=br({maximumStrict_:q2}),cw=br({minimumStrict_:Z2}),fw=br({modStrict_:K2}),hw=br({mulStrict_:Y2}),dw=br({powStrict_:X2}),pu=br({squaredDifferenceStrict_:lw}),pw=br({subStrict_:yf});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function my(r,t="euclidean",n=null,o=!1){r=mn(r,"x","norm");const u=sb(r,t,n);let h=u.shape;if(o){const p=Lr(n,r.shape);h=$c(u.shape,p)}return m(u,h)}function sb(r,t,n=null){if(r.rank===0)return fl(r);if(r.rank!==1&&n===null)return sb(m(r,[-1]),t,n);if(r.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return ss(fl(r),n);if(t===Infinity)return Gf(fl(r),n);if(t===-Infinity)return ig(fl(r),n);if(t==="euclidean"||t===2)return Ci(ss(po(fl(r),zi(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return Gf(ss(fl(r),n[0]),n[1]-1);if(t===Infinity)return Gf(ss(fl(r),n[1]),n[0]);if(t===-Infinity)return ig(ss(fl(r),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Ci(ss(_i(r),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const yy=br({norm_:my});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2(r,t,n,o,u=!0){const h=mn(r,"v","movingAverage"),p=mn(t,"x","movingAverage"),g=mn(n,"decay","movingAverage");ns(h,p),bt(Bn(h.shape,p.shape),()=>"Shape mismatch in v and x");const b=zi(1),_=pi(b,g);let z=Hn(pi(p,h),_);if(u){bt(o!=null,()=>"When using zeroDebias: true, step is required.");const V=mn(o,"step","movingAverage");z=or(z,pi(b,po(g,V)))}return En(h,z)}const J2=br({movingAverage_:Q2});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tC(r,t,n){const o=mn(r,"indices","scatterND","int32"),u=mn(t,"updates","scatterND");tg(u,o,n);const h={indices:o,updates:u},p={shape:n};return lr.runKernel(Ef,h,p)}const vw=br({scatterND_:tC});function eC(r,t,n,o){if(r.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${r.dtype}.`);if(r.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${r.shape}.`);const u=r.rank>0?r.shape[0]:1,h=r.rank>1?r.shape[1]:1;if(n.length!==h)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${h}.`);const p=t.size;if(!(t.rank===0||t.rank===1&&p===u))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${u}]`);if(t.dtype!==o.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nC(r,t,n,o=0){const u=mn(r,"sparseIndices","sparseToDense","int32"),h=mn(t,"sparseValues","sparseToDense"),p=mn(o,"defaultValue","sparseToDense",h.dtype);eC(u,h,n,p);const g={sparseIndices:u,sparseValues:h,defaultValue:p},b={outputShape:n};return lr.runKernel(_r,g,b)}const by=br({sparseToDense_:nC});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gw(r,t){const n=mn(t,"indices","gatherND","int32"),u={params:mn(r,"x","gatherND"),indices:n};return lr.runKernel(fo,u)}const mw=br({gatherND_:gw});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gv(r,t){if(t==null)return r.shape.slice();if(Bn(r.shape,t))return t;if(r.shape.length===t.length){const n=[];for(let o=0;o<r.shape.length;o++)t[o]==null&&r.shape[o]!=null?n.push(r.shape[o]):n.push(t[o]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rC(r,t,n,o){const u=mn(r,"x","dropout");if(bt(u.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${u.dtype} tensor instead.`),bt(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return r instanceof Nn?u.clone():u;const h=Gv(u,n),p=1-t,g=or(Ig(En(du(h,0,1,"float32",o),p)),p);return Hn(u,g)}const yw=br({dropout_:rC});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bw(r){return Math.floor(Math.pow(2,Math.ceil(Math.log(r)/Math.log(2))))}function ub(r,t,n){const o=1-r%2,u=new Float32Array(r);for(let h=0;h<r;++h){const p=2*Math.PI*h/(r+o-1);u[h]=t-n*Math.cos(p)}return ad(u,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aC(r,t,n=1){return jr(this,null,function*(){const o=mn(r,"predictions","inTopK"),u=mn(t,"targets","inTopK");bt(o.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${o.rank}`),bt(o.rank-1===u.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${o.rank} and targets rank ${u.rank}`),Me(o.shape.slice(0,o.shape.length-1),u.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const h=o.shape[o.shape.length-1];bt(n>0&&n<=h,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${h}), but got ${n}`);const p=yield o.data(),g=yield u.data(),[b,_]=[p.length/h,h],z=sr("bool",b);for(let V=0;V<b;V++){const at=V*_,Et=p.subarray(at,at+_),St=[];for(let Tt=0;Tt<Et.length;Tt++)St.push({value:Et[Tt],index:Tt});St.sort((Tt,Wt)=>Wt.value-Tt.value),z[V]=0;for(let Tt=0;Tt<n;Tt++)if(St[Tt].index===g[V]){z[V]=1;break}}return r!==o&&o.dispose(),t!==u&&u.dispose(),yc(z,u.shape,"bool")})}const iC=aC;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oC(r,t,n,o,u,h="NHWC",p){let g=r;r.rank===3&&(g=m(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let b=t;b.rank===3&&(b=m(t,[1,t.shape[0],t.shape[1],t.shape[2]])),bt(g.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${g.shape}.`),bt(b.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${b.shape}.`),bt(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const _=h==="NHWC"?g.shape[3]:g.shape[1],z=h==="NHWC"?b.shape[3]:b.shape[1];bt(_===n[2],()=>`Error in conv2dDerFilter: depth of input ${_}) must match input depth in filter (${n[2]}.`),bt(z===n[3],()=>`Error in conv2dDerFilter: depth of dy (${z}) must match output depth for filter (${n[3]}).`),p!=null&&bt(xr(u),()=>`Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode ${p} but got pad ${u}.`);const V={x:g,dy:b},at={strides:o,pad:u,dataFormat:h,dimRoundingMode:p,filterShape:n};return lr.runKernel(To,V,at)}const fg=br({conv2DBackpropFilter_:oC});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xm(r,t,n){if(n==null||n==="linear")return r;if(n==="relu")return Hn(r,ym(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function c0(r,t){let n=t;const o=Jr(r.shape,t.shape);return o.length>0&&(n=ss(n,o)),m(n,r.shape)}function f0(r,t,n,o){if(t==="linear")return r;if(t==="relu")return td(r);if(t==="elu")return fm(r);if(t==="relu6")return Jm(r);if(t==="prelu")return kg(r,n);if(t==="leakyrelu")return Hm(r,o);throw new Error(`Unknown fused activation ${t}.`)}const Og=(r,t)=>!(r>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sC({x:r,filter:t,strides:n,pad:o,dataFormat:u="NHWC",dilations:h=[1,1],dimRoundingMode:p,bias:g,activation:b="linear",preluActivationWeights:_,leakyreluAlpha:z}){if(b=b||"linear",Og(lr.state.gradientDepth,b)===!1){let Xe=rs(r,t,n,o,u,h,p);return g!=null&&(Xe=En(Xe,g)),f0(Xe,b,_,z)}const V=mn(r,"x","conv2d"),at=mn(t,"filter","conv2d");let Et=V,St=!1;V.rank===3&&(St=!0,Et=m(V,[1,V.shape[0],V.shape[1],V.shape[2]])),bt(Et.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${Et.rank}.`),bt(at.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${at.rank}.`),p!=null&&bt(xr(o),()=>`Error in fused conv2d: pad must be an integer when using, dimRoundingMode ${p} but got pad ${o}.`),bt(Et.shape[3]===at.shape[2],()=>`Error in conv2d: depth of input (${Et.shape[3]}) must match input depth for filter ${at.shape[2]}.`),bt(Ec(n,h),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${h}'`),bt(u==="NHWC",()=>`Error in conv2d: got dataFormat of ${u} but only NHWC is currently supported.`);const Tt=kc(Et.shape,at.shape,n,h,o,p);let Wt;g!=null&&(Wt=mn(g,"bias","fused conv2d"),[Wt]=Si(Wt,V),Nr(Tt.outShape,Wt.shape));let le;_!=null&&(le=mn(_,"prelu weights","fused conv2d"));const ye=(Xe,Rn)=>{const[Cn,mr,zr,ta]=Rn,Ma=xm(Xe,zr,b);bt(Kh(h),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${h}'`);const Za=hu(mr.shape,Ma,Cn,n,o),Ka=fg(mr,Ma,Cn.shape,n,o),ni=[Za,Ka];if(ta!=null){const Ua=c0(ta,Ma);ni.push(Ua)}return ni},Qe={x:Et,filter:at,bias:Wt,preluActivationWeights:le},$e={strides:n,pad:o,dataFormat:u,dilations:h,dimRoundingMode:p,activation:b,leakyreluAlpha:z};return g==null?_u((Rn,Cn,mr)=>{let zr=lr.runKernel(al,Qe,$e);return mr([Cn,Rn,zr]),St&&(zr=m(zr,[zr.shape[1],zr.shape[2],zr.shape[3]])),{value:zr,gradFunc:ye}})(Et,at):_u((Rn,Cn,mr,zr)=>{let ta=lr.runKernel(al,Qe,$e);return zr([Cn,Rn,ta,mr]),St&&(ta=m(ta,[ta.shape[1],ta.shape[2],ta.shape[3]])),{value:ta,gradFunc:ye}})(Et,at,Wt)}const lb=br({fusedConv2d_:sC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uC(r,t,n,o,u,h=[1,1],p){let g=r;r.rank===3&&(g=m(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let b=t;b.rank===3&&(b=m(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const _={x:g,dy:b},z={strides:o,pad:u,dimRoundingMode:p,dilations:h,filterShape:n};return lr.runKernel(Us,_,z)}const xw=br({depthwiseConv2dNativeBackpropFilter_:uC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cb(r,t,n,o,u,h=[1,1],p){let g=t,b=!1;t.rank===3&&(b=!0,g=m(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const _={dy:g,filter:n},z={strides:o,pad:u,dimRoundingMode:p,dilations:h,inputShape:r},V=lr.runKernel(Du,_,z);return b?m(V,[V.shape[1],V.shape[2],V.shape[3]]):V}const ww=br({depthwiseConv2dNativeBackpropInput_:cb});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lC({x:r,filter:t,strides:n,pad:o,dataFormat:u="NHWC",dilations:h=[1,1],dimRoundingMode:p,bias:g,activation:b="linear",preluActivationWeights:_,leakyreluAlpha:z}){if(Og(lr.state.gradientDepth,b)===!1){let Xe=dv(r,t,n,o,u,h,p);return g!=null&&(Xe=En(Xe,g)),f0(Xe,b,_,z)}const V=mn(r,"x","depthwiseConv2d"),at=mn(t,"filter","depthwiseConv2d");let Et=V,St=!1;V.rank===3&&(St=!0,Et=m(V,[1,V.shape[0],V.shape[1],V.shape[2]])),bt(Et.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${Et.rank}.`),bt(at.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${at.rank}.`),bt(Et.shape[3]===at.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${Et.shape[3]}) must match the inChannels dimension in filter ${at.shape[2]}.`),h==null&&(h=[1,1]),bt(Ec(n,h),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${h}'`),p!=null&&bt(xr(o),()=>`Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode ${p} but got pad ${o}.`);const Tt=kc(Et.shape,at.shape,n,h,o,p,!0);let Wt;g!=null&&(Wt=mn(g,"bias","fused conv2d"),[Wt]=Si(Wt,V),Nr(Tt.outShape,Wt.shape));let le;_!=null&&(le=mn(_,"prelu weights","fused depthwiseConv2d"));const ye=(Xe,Rn)=>{bt(Kh(h),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${h}'`);const[Cn,mr,zr,ta]=Rn,Ma=xm(Xe,zr,b),Za=ww(mr.shape,Ma,Cn,n,o,h,p),Ka=xw(mr,Ma,Cn.shape,n,o,h,p);if(ta!=null){const ni=c0(Wt,Ma);return[Za,Ka,ni]}return[Za,Ka]},Qe={x:Et,filter:at,bias:Wt,preluActivationWeights:le},$e={strides:n,pad:o,dataFormat:u,dilations:h,dimRoundingMode:p,activation:b,leakyreluAlpha:z};return g==null?_u((Rn,Cn,mr)=>{let zr=lr.runKernel(il,Qe,$e);return mr([Cn,Rn,zr]),St&&(zr=m(zr,[zr.shape[1],zr.shape[2],zr.shape[3]])),{value:zr,gradFunc:ye}})(Et,at):_u((Rn,Cn,mr,zr)=>{let ta=lr.runKernel(il,Qe,$e);return zr([Cn,Rn,ta,mr]),St&&(ta=m(ta,[ta.shape[1],ta.shape[2],ta.shape[3]])),{value:ta,gradFunc:ye}})(Et,at,Wt)}const Ew=br({fusedDepthwiseConv2d_:lC});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sw({a:r,b:t,transposeA:n=!1,transposeB:o=!1,bias:u,activation:h="linear",preluActivationWeights:p,leakyreluAlpha:g}){if(Og(lr.state.gradientDepth,h)===!1){let ta=$s(r,t,n,o);return u!=null&&(ta=En(ta,u)),f0(ta,h,p,g)}let b=mn(r,"a","fused matMul"),_=mn(t,"b","fused matMul");[b,_]=Si(b,_);const z=n?b.shape[b.rank-2]:b.shape[b.rank-1],V=o?_.shape[_.rank-1]:_.shape[_.rank-2],at=n?b.shape[b.rank-1]:b.shape[b.rank-2],Et=o?_.shape[_.rank-2]:_.shape[_.rank-1],St=b.shape.slice(0,-2),Tt=_.shape.slice(0,-2),Wt=Rt(St),le=Rt(Tt);bt(b.rank>=2&&_.rank>=2&&b.rank===_.rank,()=>`Error in fused matMul: inputs must have the same rank of at least 2, got ranks ${b.rank} and ${_.rank}.`),bt(Bn(St,Tt),()=>`Error in fused matMul: outer dimensions (${St}) and (${Tt}) of Tensors with shapes ${b.shape} and ${_.shape} must match.`),bt(z===V,()=>`Error in fused matMul: inner shapes (${z}) and (${V}) of Tensors with shapes ${b.shape} and ${_.shape} and transposeA=${n} and transposeB=${o} must match.`);const ye=b.shape.slice(0,-2).concat([at,Et]),Qe=n?m(b,[Wt,z,at]):m(b,[Wt,at,z]),$e=o?m(_,[le,Et,V]):m(_,[le,V,Et]);let Xe;u!=null&&(Xe=mn(u,"bias","fused matMul"),[Xe]=Si(Xe,b),Nr(ye,Xe.shape));let Rn;p!=null&&(Rn=mn(p,"prelu weights","fused matMul"));const Cn=(ta,Ma)=>{const[Za,Ka,ni,Ua]=Ma,Ba=xm(m(ta,ni.shape),ni,h);let mi,ti;if(!n&&!o?(mi=$s(Ba,Ka,!1,!0),ti=$s(Za,Ba,!0,!1)):!n&&o?(mi=$s(Ba,Ka,!1,!1),ti=$s(Ba,Za,!0,!1)):n&&!o?(mi=$s(Ka,Ba,!1,!0),ti=$s(Za,Ba,!1,!1)):(mi=$s(Ka,Ba,!0,!0),ti=$s(Ba,Za,!0,!0)),u!=null){const yi=c0(Ua,Ba);return[mi,ti,yi]}else return[mi,ti]},mr={a:Qe,b:$e,bias:Xe,preluActivationWeights:Rn},zr={transposeA:n,transposeB:o,activation:h,leakyreluAlpha:g};return u==null?_u((Ma,Za,Ka)=>{const ni=lr.runKernel(Hu,mr,zr);return Ka([Ma,Za,ni]),{value:m(ni,ye),gradFunc:Cn}})(Qe,$e):_u((Ma,Za,Ka,ni)=>{const Ua=lr.runKernel(Hu,mr,zr);return ni([Ma,Za,Ua,Ka]),{value:m(Ua,ye),gradFunc:Cn}})(Qe,$e,Xe)}const h0=br({fusedMatMul_:Sw});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d0(r){return ub(r,.54,.46)}const fb=br({hammingWindow_:d0});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cw(r){return ub(r,.5,.5)}const xy=br({hannWindow_:Cw});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cC(r,t,n,o=!1,u=0){let h=0;const p=[];for(;h+t<=r.size;)p.push(Zt(r,h,t)),h+=n;if(o)for(;h<r.size;){const g=h+t-r.size,b=vt([Zt(r,h,t-g),Qo([g],u)]);p.push(b),h+=n}return p.length===0?Rp([],[0,t]):m(vt(p),[p.length,t])}const ql=br({frame_:cC});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fC(r,t,n,o,u=xy){o==null&&(o=bw(t));const h=ql(r,t,n),p=Hn(h,u(t)),g=[];for(let b=0;b<h.shape[0];b++)g.push(a0(Zt(p,[b,0],[1,t]),o));return vt(g)}const hC=br({stft_:fC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _w(r,t,n,o,u="bilinear",h=0){const p=mn(r,"image","cropAndResize"),g=mn(t,"boxes","cropAndResize","float32"),b=mn(n,"boxInd","cropAndResize","int32"),_=g.shape[0];bt(p.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${p.rank}.`),bt(g.rank===2&&g.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${_},4] but had shape ${g.shape}.`),bt(b.rank===1&&b.shape[0]===_,()=>`Error in cropAndResize: boxInd must be have size [${_}] but had shape ${g.shape}.`),bt(o.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${o.length}.`),bt(o[0]>=1&&o[1]>=1,()=>`cropSize must be atleast [1,1], but was ${o}`),bt(u==="bilinear"||u==="nearest",()=>`method must be bilinear or nearest, but was ${u}`);const z={image:p,boxes:g,boxInd:b},V={method:u,extrapolationValue:h,cropSize:o};return lr.runKernel(Zo,z,V)}const dC=br({cropAndResize_:_w});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pC(r){const t=mn(r,"image","flipLeftRight","float32");bt(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return lr.runKernel(Vi,n,{})}const Iw=br({flipLeftRight_:pC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vC(r,t,n=0,o=.5){const u=mn(r,"image","rotateWithOffset","float32");bt(u.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${u.rank}.`);const h={image:u},p={radians:t,fillValue:n,center:o};return lr.runKernel(tl,h,p)}const hb=br({rotateWithOffset_:vC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wm(r,t,n,o,u,h){o==null&&(o=.5),u==null&&(u=Number.NEGATIVE_INFINITY),h==null&&(h=0);const p=r.shape[0];return n=Math.min(n,p),bt(0<=o&&o<=1,()=>`iouThreshold must be in [0, 1], but was '${o}'`),bt(r.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${r.rank}'`),bt(r.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${r.shape[1]}`),bt(t.rank===1,()=>"scores must be a 1D tensor"),bt(t.shape[0]===p,()=>`scores has incompatible shape with boxes. Expected ${p}, but was ${t.shape[0]}`),bt(0<=h&&h<=1,()=>`softNmsSigma must be in [0, 1], but was '${h}'`),{maxOutputSize:n,iouThreshold:o,scoreThreshold:u,softNmsSigma:h}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gC(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY){const h=mn(r,"boxes","nonMaxSuppression"),p=mn(t,"scores","nonMaxSuppression"),g=wm(h,p,n,o,u);n=g.maxOutputSize,o=g.iouThreshold,u=g.scoreThreshold;const b={maxOutputSize:n,iouThreshold:o,scoreThreshold:u};return lr.runKernel(In,{boxes:h,scores:p},b)}const ru=br({nonMaxSuppression_:gC});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mC(r,t,n){const o=id(r,t,n),u=o<0?-(o+1):o;r.splice(u,0,t)}function id(r,t,n){return Tw(r,t,n||yC)}function yC(r,t){return r>t?1:r<t?-1:0}function Tw(r,t,n){let o=0,u=r.length,h=0,p=!1;for(;o<u;){h=o+(u-o>>>1);const g=n(t,r[h]);g>0?o=h+1:(u=h,p=!g)}return p?o:-o-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wy(r,t,n,o,u){return Em(r,t,n,o,u,0)}function Ey(r,t,n,o,u,h){return Em(r,t,n,o,u,0,!1,h,!0)}function Sy(r,t,n,o,u,h){return Em(r,t,n,o,u,h,!0)}function Em(r,t,n,o,u,h,p=!1,g=!1,b=!1){const _=[];for(let Wt=0;Wt<t.length;Wt++)t[Wt]>u&&_.push({score:t[Wt],boxIndex:Wt,suppressBeginIndex:0});_.sort(Aw);const z=h>0?-.5/h:0,V=[],at=[];for(;V.length<n&&_.length>0;){const Wt=_.pop(),{score:le,boxIndex:ye,suppressBeginIndex:Qe}=Wt;if(le<u)break;let $e=!1;for(let Xe=V.length-1;Xe>=Qe;--Xe){const Rn=bC(r,ye,V[Xe]);if(Rn>=o){$e=!0;break}if(Wt.score=Wt.score*xC(o,z,Rn),Wt.score<=u)break}Wt.suppressBeginIndex=V.length,$e||(Wt.score===le?(V.push(ye),at.push(Wt.score)):Wt.score>u&&mC(_,Wt,Aw))}const Et=V.length,St=n-Et;g&&St>0&&(V.push(...new Array(St).fill(0)),at.push(...new Array(St).fill(0)));const Tt={selectedIndices:V};return p&&(Tt.selectedScores=at),b&&(Tt.validOutputs=Et),Tt}function bC(r,t,n){const o=r.subarray(t*4,t*4+4),u=r.subarray(n*4,n*4+4),h=Math.min(o[0],o[2]),p=Math.min(o[1],o[3]),g=Math.max(o[0],o[2]),b=Math.max(o[1],o[3]),_=Math.min(u[0],u[2]),z=Math.min(u[1],u[3]),V=Math.max(u[0],u[2]),at=Math.max(u[1],u[3]),Et=(g-h)*(b-p),St=(V-_)*(at-z);if(Et<=0||St<=0)return 0;const Tt=Math.max(h,_),Wt=Math.max(p,z),le=Math.min(g,V),ye=Math.min(b,at),Qe=Math.max(le-Tt,0)*Math.max(ye-Wt,0);return Qe/(Et+St-Qe)}function xC(r,t,n){const o=Math.exp(t*n*n);return n<=r?o:0}function Aw(r,t){return r.score-t.score||r.score===t.score&&t.boxIndex-r.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wC(h,p,g){return jr(this,arguments,function*(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY){const b=mn(r,"boxes","nonMaxSuppressionAsync"),_=mn(t,"scores","nonMaxSuppressionAsync"),z=wm(b,_,n,o,u);n=z.maxOutputSize,o=z.iouThreshold,u=z.scoreThreshold;const V=yield Promise.all([b.data(),_.data()]),at=V[0],Et=V[1],{selectedIndices:St}=wy(at,Et,n,o,u);return b!==r&&b.dispose(),_!==t&&_.dispose(),ad(St,"int32")})}const db=wC;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mw(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY,h=0){const p=mn(r,"boxes","nonMaxSuppression"),g=mn(t,"scores","nonMaxSuppression"),b=wm(p,g,n,o,u,h);n=b.maxOutputSize,o=b.iouThreshold,u=b.scoreThreshold,h=b.softNmsSigma;const _={boxes:p,scores:g},z={maxOutputSize:n,iouThreshold:o,scoreThreshold:u,softNmsSigma:h},V=lr.runKernel(ra,_,z);return{selectedIndices:V[0],selectedScores:V[1]}}const EC=br({nonMaxSuppressionWithScore_:Mw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SC(p,g,b){return jr(this,arguments,function*(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY,h=0){const _=mn(r,"boxes","nonMaxSuppressionAsync"),z=mn(t,"scores","nonMaxSuppressionAsync"),V=wm(_,z,n,o,u,h);n=V.maxOutputSize,o=V.iouThreshold,u=V.scoreThreshold,h=V.softNmsSigma;const at=yield Promise.all([_.data(),z.data()]),Et=at[0],St=at[1],{selectedIndices:Tt,selectedScores:Wt}=Sy(Et,St,n,o,u,h);return _!==r&&_.dispose(),z!==t&&z.dispose(),{selectedIndices:ad(Tt,"int32"),selectedScores:ad(Wt)}})}const CC=SC;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _C(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY,h=!1){const p=mn(r,"boxes","nonMaxSuppression"),g=mn(t,"scores","nonMaxSuppression"),b=wm(p,g,n,o,u,null),_=b.maxOutputSize,z=b.iouThreshold,V=b.scoreThreshold,at={boxes:p,scores:g},Et={maxOutputSize:_,iouThreshold:z,scoreThreshold:V,padToMaxOutputSize:h},St=lr.runKernel(ar,at,Et);return{selectedIndices:St[0],validOutputs:St[1]}}const Nw=br({nonMaxSuppressionPadded_:_C});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IC(p,g,b){return jr(this,arguments,function*(r,t,n,o=.5,u=Number.NEGATIVE_INFINITY,h=!1){const _=mn(r,"boxes","nonMaxSuppressionAsync"),z=mn(t,"scores","nonMaxSuppressionAsync"),V=wm(_,z,n,o,u,null),at=V.maxOutputSize,Et=V.iouThreshold,St=V.scoreThreshold,[Tt,Wt]=yield Promise.all([_.data(),z.data()]),{selectedIndices:le,validOutputs:ye}=Ey(Tt,Wt,at,Et,St,h);return _!==r&&_.dispose(),z!==t&&z.dispose(),{selectedIndices:ad(le,"int32"),validOutputs:zi(ye,"int32")}})}const TC=IC;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AC(r,t,n=!1,o=!1){const u=mn(r,"images","resizeBilinear");bt(u.rank===3||u.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${u.rank}.`),bt(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),bt(o===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let h=u,p=!1;u.rank===3&&(p=!0,h=m(u,[1,u.shape[0],u.shape[1],u.shape[2]]));const[]=t,g={images:h},b={alignCorners:n,halfPixelCenters:o,size:t},_=lr.runKernel(su,g,b);return p?m(_,[_.shape[1],_.shape[2],_.shape[3]]):_}const Lp=br({resizeBilinear_:AC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MC(r,t,n=!1,o=!1){const u=mn(r,"images","resizeNearestNeighbor");bt(u.rank===3||u.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${u.rank}.`),bt(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),bt(u.dtype==="float32"||u.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),bt(o===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let h=u,p=!1;u.rank===3&&(p=!0,h=m(u,[1,u.shape[0],u.shape[1],u.shape[2]]));const[]=t,g={images:h},b={alignCorners:n,halfPixelCenters:o,size:t},_=lr.runKernel(As,g,b);return p?m(_,[_.shape[1],_.shape[2],_.shape[3]]):_}const pb=br({resizeNearestNeighbor_:MC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NC(r,t,n){bt(t%1==0,()=>`bandPart(): numLower must be an integer, got ${t}.`),bt(n%1==0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const o=mn(r,"a","bandPart");bt(o.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${o.rank}.`);const u=o.shape,[h,p]=o.shape.slice(-2);if(!(t<=h))throw new Error(`bandPart(): numLower (${t}) must not be greater than the number of rows (${h}).`);if(!(n<=p))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${p}).`);t<0&&(t=h),n<0&&(n=p);const g=m(Z1(0,h,1,"int32"),[-1,1]),b=Z1(0,p,1,"int32"),_=pi(g,b),z=Ed(Sc(_,zi(+t,"int32")),Bv(_,zi(-n,"int32"))),V=Uc([h,p],o.dtype);return m(rd(Sd(m(o,[-1,h,p])).map(at=>Cl(z,at,V))),u)}const kC=br({bandPart_:NC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DC(r){let t;if(Array.isArray(r)){t=!1,bt(r!=null&&r.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const u=r[0].shape[0];for(let h=1;h<r.length;++h)bt(r[h].shape[0]===u,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${r[h].shape[0]} vs. ${u})`)}else t=!0,r=nd(r,r.shape[0],0).map(u=>lg(u,[0]));bt(r.length<=r[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${r.length}) exceeds number of dimensions (${r[0].shape[0]}).`);const n=[],o=r;for(let u=0;u<r.length;++u)n.push(lr.tidy(()=>{let h=o[u];if(u>0)for(let p=0;p<u;++p){const g=Hn(ss(Hn(n[p],h)),n[p]);h=pi(h,g)}return or(h,yy(h,"euclidean"))}));return t?rd(n,0):n}const vb=br({gramSchmidt_:DC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cy(r,t=!1){if(bt(r.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${r.rank}`),r.rank===2)return gb(r,t);{const n=r.shape.slice(0,r.shape.length-2).reduce((b,_)=>b*_),o=Sd(m(r,[n,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),u=[],h=[];o.forEach(b=>{const[_,z]=gb(b,t);u.push(_),h.push(z)});const p=m(rd(u,0),r.shape),g=m(rd(h,0),r.shape);return[p,g]}}function gb(r,t=!1){return lr.tidy(()=>{bt(r.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${r.shape.length}D Tensor.`);const n=r.shape[0],o=r.shape[1];let u=jm(n),h=th(r);const p=Rp([[1]],[1,1]);let g=th(p);const b=n>=o?o:n;for(let _=0;_<b;++_){const z=h,V=g,at=u;[g,h,u]=lr.tidy(()=>{const Et=Zt(h,[_,_],[n-_,1]),St=yy(Et),Tt=Zt(h,[_,_],[1,1]),Wt=Cl(Ah(Tt,0),Rp([[-1]]),Rp([[1]])),le=pi(Tt,Hn(Wt,St)),ye=or(Et,le);ye.shape[0]===1?g=th(p):g=vt([p,Zt(ye,[1,0],[ye.shape[0]-1,ye.shape[1]])],0);const Qe=oi(or($s(Wt,le),St)),$e=Zt(h,[_,0],[n-_,o]),Xe=Hn(Qe,g),Rn=mu(g);if(_===0)h=pi($e,$s(Xe,$s(Rn,$e)));else{const zr=pi($e,$s(Xe,$s(Rn,$e)));h=vt([Zt(h,[0,0],[_,o]),zr],0)}const Cn=mu(Xe),mr=Zt(u,[0,_],[n,u.shape[1]-_]);if(_===0)u=pi(mr,$s($s(mr,g),Cn));else{const zr=pi(mr,$s($s(mr,g),Cn));u=vt([Zt(u,[0,0],[n,_]),zr],1)}return[g,h,u]}),M([z,V,at])}return!t&&n>o&&(u=Zt(u,[0,0],[n,o]),h=Zt(h,[0,0],[o,o])),[u,h]})}const OC=br({qr_:Cy});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var sh;(function(r){r[r.NONE=0]="NONE",r[r.MEAN=1]="MEAN",r[r.SUM=2]="SUM",r[r.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(sh||(sh={}));function RC(r,t,n=sh.SUM_BY_NONZERO_WEIGHTS){const o=mn(r,"losses","computeWeightedLoss");let u=null;t!=null&&(u=mn(t,"weights","computeWeightedLoss"));const h=u==null?o:Hn(o,u);if(n===sh.NONE)return h;if(n===sh.SUM)return ss(h);if(n===sh.MEAN){if(u==null)return nc(h);{const p=o.size/u.size,g=or(ss(h),ss(u));return p>1?or(g,zi(p)):g}}if(n===sh.SUM_BY_NONZERO_WEIGHTS){if(u==null)return or(ss(h),zi(o.size));{const p=Hn(u,Op(o.shape)),g=qi(ss(sg(p,zi(0))),"float32");return or(ss(h),g)}}throw Error(`Unknown reduction: ${n}`)}const vv=br({computeWeightedLoss_:RC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LC(r,t,n,o=sh.SUM_BY_NONZERO_WEIGHTS){const u=mn(r,"labels","absoluteDifference"),h=mn(t,"predictions","absoluteDifference");let p=null;n!=null&&(p=mn(n,"weights","absoluteDifference")),Me(u.shape,h.shape,"Error in absoluteDifference: ");const g=fl(pi(u,h));return vv(g,p,o)}const PC=br({absoluteDifference_:LC});function FC(r,t,n,o,u=sh.SUM_BY_NONZERO_WEIGHTS){const h=mn(r,"labels","cosineDistance"),p=mn(t,"predictions","cosineDistance");let g=null;o!=null&&(g=mn(o,"weights","cosineDistance")),Me(h.shape,p.shape,"Error in cosineDistance: ");const b=zi(1),_=pi(b,ss(Hn(h,p),n,!0));return vv(_,g,u)}const BC=br({cosineDistance_:FC});function zC(r,t,n,o=sh.SUM_BY_NONZERO_WEIGHTS){let u=mn(r,"labels","hingeLoss");const h=mn(t,"predictions","hingeLoss");let p=null;n!=null&&(p=mn(n,"weights","hingeLoss")),Me(u.shape,h.shape,"Error in hingeLoss: ");const g=zi(1);u=pi(Hn(zi(2),u),g);const b=td(pi(g,Hn(u,h)));return vv(b,p,o)}const $C=br({hingeLoss_:zC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kw(r,t,n,o=1,u=sh.SUM_BY_NONZERO_WEIGHTS){const h=mn(r,"labels","huberLoss"),p=mn(t,"predictions","huberLoss");let g=null;n!=null&&(g=mn(n,"weights","huberLoss")),Me(h.shape,p.shape,"Error in huberLoss: ");const b=zi(o),_=fl(pi(p,h)),z=og(_,b),V=pi(_,z),at=En(Hn(zi(.5),_i(z)),Hn(b,V));return vv(at,g,u)}const Dw=br({huberLoss_:kw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gv(r,t,n,o=1e-7,u=sh.SUM_BY_NONZERO_WEIGHTS){const h=mn(r,"labels","logLoss"),p=mn(t,"predictions","logLoss");let g=null;n!=null&&(g=mn(n,"weights","logLoss")),Me(h.shape,p.shape,"Error in logLoss: ");const b=zi(1),_=zi(o),z=oi(Hn(h,zc(En(p,_)))),V=Hn(pi(b,h),zc(En(pi(b,p),_))),at=pi(z,V);return vv(at,g,u)}const Rg=br({logLoss_:gv});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hg(r,t,n,o=sh.SUM_BY_NONZERO_WEIGHTS){const u=mn(r,"labels","meanSquaredError"),h=mn(t,"predictions","meanSquaredError");let p=null;n!=null&&(p=mn(n,"weights","meanSquaredError")),Me(u.shape,h.shape,"Error in meanSquaredError: ");const g=i0(u,h);return vv(g,p,o)}const p0=br({meanSquaredError_:hg});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v0(r,t){const n=mn(r,"labels","sigmoidCrossEntropyWithLogits"),o=mn(t,"logits","sigmoidCrossEntropyWithLogits");Me(n.shape,o.shape,"Error in sigmoidCrossEntropyWithLogits: ");const u=td(o),h=Hn(o,n),p=q0(Qh(oi(fl(o))));return En(pi(u,h),p)}function MA(r,t,n,o=0,u=sh.SUM_BY_NONZERO_WEIGHTS){let h=mn(r,"multiClassLabels","sigmoidCrossEntropy");const p=mn(t,"logits","sigmoidCrossEntropy");let g=null;if(n!=null&&(g=mn(n,"weights","sigmoidCrossEntropy")),Me(h.shape,p.shape,"Error in sigmoidCrossEntropy: "),o>0){const _=zi(o),z=zi(1),V=zi(.5);h=En(Hn(h,pi(z,_)),Hn(V,_))}const b=v0(h,p);return vv(b,g,u)}const NA=br({sigmoidCrossEntropy_:MA});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kA(r,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return _u((u,h,p)=>{const b=Ym(h,[n],!0),_=pi(qi(h,"float32"),b);p([u,_]);const z=oi(Hn(_,u));return{value:ss(z,[n]),gradFunc:(Et,St)=>{const[Tt,Wt]=St,le=$c(Et.shape,[n]);return[Hn(m(Et,le),pi(qi(Tt,"float32"),Qh(Wt))),Hn(m(Et,le),pi(Qh(Wt),qi(Tt,"float32")))]}}})(r,t)}function GC(r,t,n,o=0,u=sh.SUM_BY_NONZERO_WEIGHTS){let h=mn(r,"onehotLabels","softmaxCrossEntropy");const p=mn(t,"logits","softmaxCrossEntropy");let g=null;if(n!=null&&(g=mn(n,"weights","softmaxCrossEntropy")),Me(h.shape,p.shape,"Error in softmaxCrossEntropy: "),o>0){const _=zi(o),z=zi(1),V=zi(h.shape[1]);h=En(Hn(h,pi(z,_)),or(_,V))}const b=kA(h,p);return vv(b,g,u)}const UC=br({softmaxCrossEntropy_:GC});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mb={fft:r0,ifft:mm,rfft:a0,irfft:fy},WC={hammingWindow:fb,hannWindow:xy,frame:ql,stft:hC},dg={flipLeftRight:Iw,resizeNearestNeighbor:pb,resizeBilinear:Lp,rotateWithOffset:hb,cropAndResize:dC,nonMaxSuppression:ru,nonMaxSuppressionAsync:db,nonMaxSuppressionWithScore:EC,nonMaxSuppressionWithScoreAsync:CC,nonMaxSuppressionPadded:Nw,nonMaxSuppressionPaddedAsync:TC},Wc={bandPart:kC,gramSchmidt:vb,qr:OC},g0={absoluteDifference:PC,computeWeightedLoss:vv,cosineDistance:BC,hingeLoss:$C,huberLoss:Dw,logLoss:Rg,meanSquaredError:p0,sigmoidCrossEntropy:NA,softmaxCrossEntropy:UC};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lg{static sgd(t){return new sn(t)}static momentum(t,n,o=!1){return new hr(t,n,o)}static rmsprop(t,n=.9,o=0,u=null,h=!1){return new Pr(t,n,o,u,h)}static adam(t=.001,n=.9,o=.999,u=null){return new Sl(t,n,o,u)}static adadelta(t=.001,n=.95,o=null){return new sl(t,n,o)}static adamax(t=.002,n=.9,o=.999,u=null,h=0){return new An(t,n,o,u,h)}static adagrad(t,n=.1){return new Zl(t,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pg={sgd:Lg.sgd,momentum:Lg.momentum,adadelta:Lg.adadelta,adagrad:Lg.adagrad,rmsprop:Lg.rmsprop,adamax:Lg.adamax,adam:Lg.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VC=(()=>typeof requestAnimationFrame!="undefined"?requestAnimationFrame:typeof setImmediate!="undefined"?setImmediate:r=>r())();function _y(){return new Promise(r=>VC(()=>r()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yb(r,t){const n=r[0].length;r.forEach((u,h)=>{bt(u.length===n,()=>`Error in concat${n}D: rank of tensors[${h}] must be the same as the rank of the rest (${n})`)}),bt(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const o=r[0];r.forEach((u,h)=>{for(let p=0;p<n;p++)bt(p===t||u[p]===o[p],()=>`Error in concat${n}D: Shape of tensors[${h}] (${u}) does not match the shape of the rest (${o}) along the non-concatenated axis ${h}.`)})}function mv(r,t){const n=r[0].slice();for(let o=1;o<r.length;o++)n[t]+=r[o][t];return n}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iy=30;function Ty(r){return r<=Iy?r:ba(r,Math.floor(Math.sqrt(r)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m0(r,t,n){const o=n*(typeof r=="number"?r:r[0]),u=t*(typeof r=="number"?r:r[1]);return[o,u]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kd(r,t,n,o=!0){let u=[];if(o)u=u.concat(t.slice(0)),u.push(r[0]/n),u=u.concat(r.slice(1));else{u=u.concat(r[0]);const h=t.length;for(let p=0;p<h;++p)u=u.concat([r[p+1]/t[p],t[p]]);u=u.concat(r.slice(h+1))}return u}function od(r,t,n=!0){const o=[];if(n){o.push(t);for(let u=t+1;u<r;++u)u<=2*t?(o.push(u),o.push(u-(t+1))):o.push(u)}else{const u=[],h=[];for(let p=1;p<r;++p)p>=t*2+1||p%2==1?h.push(p):u.push(p);o.push(...u),o.push(0),o.push(...h)}return o}function y0(r,t,n,o=!0){const u=[];o?u.push(r[0]/n):u.push(r[0]*n);for(let h=1;h<r.length;++h)h<=t.length?o?u.push(t[h-1]*r[h]):u.push(r[h]/t[h-1]):u.push(r[h]);return u}function Ay(r,t){const n=[0];for(let o=0;o<t;++o)n.push(r[o][0]);return n}function Fg(r,t,n){const o=r.slice(0,1);for(let u=0;u<n;++u)o.push(r[u+1]-t[u][0]-t[u][1]);return o}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const My=1.7580993408473768,Ny=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bb=.3275911,xb=.254829592,wb=-.284496736,ky=1.421413741,Eb=-1.453152027,Zd=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sm(...r){He().getBool("IS_TEST")||console.warn(...r)}function Sb(...r){He().getBool("IS_TEST")||console.log(...r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uv(r,t){if(r.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${r.length}, imag: ${t.length}.`);const n=new Float32Array(r.length*2);for(let o=0;o<n.length;o+=2)n[o]=r[o/2],n[o+1]=t[o/2];return n}function Cm(r){const t=new Float32Array(r.length/2),n=new Float32Array(r.length/2);for(let o=0;o<r.length;o+=2)t[o/2]=r[o],n[o/2]=r[o+1];return{real:t,imag:n}}function Cb(r){const t=Math.ceil(r.length/4),n=new Float32Array(t),o=new Float32Array(t);for(let u=0;u<r.length;u+=4)n[Math.floor(u/4)]=r[u],o[Math.floor(u/4)]=r[u+1];return{real:n,imag:o}}function Wv(r){const t=Math.floor(r.length/4),n=new Float32Array(t),o=new Float32Array(t);for(let u=2;u<r.length;u+=4)n[Math.floor(u/4)]=r[u],o[Math.floor(u/4)]=r[u+1];return{real:n,imag:o}}function yv(r,t){const n=r[t*2],o=r[t*2+1];return{real:n,imag:o}}function Ow(r,t,n,o){r[o*2]=t,r[o*2+1]=n}function Rw(r,t){const n=new Float32Array(r/2),o=new Float32Array(r/2);for(let u=0;u<Math.ceil(r/2);u++){const h=(t?2:-2)*Math.PI*(u/r);n[u]=Math.cos(h),o[u]=Math.sin(h)}return{real:n,imag:o}}function _m(r,t,n){const o=(n?2:-2)*Math.PI*(r/t),u=Math.cos(o),h=Math.sin(o);return{real:u,imag:h}}function Dy(r,t,n=0){let o=[];if(typeof t=="number")bt(r.shape[n]%t==0,()=>"Number of splits must evenly divide the axis."),o=new Array(t).fill(r.shape[n]/t);else{const u=t.reduce((p,g)=>(g===-1&&(p+=1),p),0);bt(u<=1,()=>"There should be only one negative value in split array.");const h=t.indexOf(-1);if(h!==-1){const p=t.reduce((g,b)=>b>0?g+b:g);t[h]=r.shape[n]-p}bt(r.shape[n]===t.reduce((p,g)=>p+g),()=>"The sum of sizes must match the size of the axis dimension."),o=t}return o}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _b(r,t){let n=!1,o;for(r<=Iy?(o=r,n=!0):o=ba(r,Math.floor(Math.sqrt(r)));!n;)o>t||o===r?n=!0:o=ba(r,o+1);return o}function Ib(r,t,n){const o=[],u=r.length;for(let h=0;h<u;h++)h!==t?o.push(r[h]):o.push(n);return o}function bv(r,t,n,o){const u=t.shape.length,h=r.shape.length;if(o!==0&&(o<-u||o>u))throw new Error(`Expect batchDims in the range of [-${u}, ${u}], but got ${o}`);if(o<0&&(o+=u),o>h)throw new Error(`batchDims (${o}) must be less than rank(x) (
    ${h}).`);if(n<o)throw new Error(`batchDims (${o}) must be less than or equal to axis (${n}).`);for(let V=0;V<o;++V)if(r.shape[V]!==t.shape[V])throw new Error(`x.shape[${V}]: ${r.shape[V]} should be equal to indices.shape[${V}]: ${t.shape[V]}.`);const p=r.shape[n],g=[];let b=1,_=1,z=1;for(let V=0;V<o;++V)g.push(r.shape[V]),b*=r.shape[V];for(let V=o;V<n;V++)g.push(r.shape[V]),_*=r.shape[V];for(let V=o;V<u;V++)g.push(t.shape[V]);for(let V=n+1;V<h;V++)g.push(r.shape[V]),z*=r.shape[V];return{batchSize:b,sliceSize:z,outerSize:_,dimSize:p,outputShape:g}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lw(r,t,n){if(t==="complex64"){if(r.dtype==="complex64")return r.clone();const o=Uc(r.shape),u=qi(r,"float32"),h=n.complex(u,o);return o.dispose(),u.dispose(),h}if(!Wr(r.dtype,t))return lr.makeTensorFromDataId(r.dataId,r.shape,t);if(r.dtype==="complex64"){const o=n.real(r),u=qi(o,t);return o.dispose(),u}if(t==="int32")return n.int(r);if(t==="bool"){const o=zi(0,r.dtype),u=n.notEqual(r,o);return o.dispose(),u}else throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${t}`)}function Pw(r,t){return lr.makeTensorFromDataId(r.dataId,t,r.dtype)}function Tb(r){try{return r.map(t=>Dt(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function Fw(r){return r.map(t=>Pl(t))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oy={kernelName:za,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(r,ym(qi(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ry={kernelName:da,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const o=_i(qi(n,"float32")),u=Ci(pi(zi(1),o));return oi(or(r,u))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bw={kernelName:Ti,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const o=Ci(pi(_i(qi(n,"float32")),1));return or(r,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zw={kernelName:ki,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{let g=r;const b=Jr(n.shape,u);return b.length>0&&(g=ss(g,b)),m(g,n.shape)},b:()=>{let g=r;const b=Jr(o.shape,u);return b.length>0&&(g=ss(g,b)),m(g,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sd={kernelName:vi,saveAllInputs:!0,gradFunc:(r,t)=>{const n={};return t.forEach((o,u)=>{n[u]=()=>r.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jC={kernelName:Ra,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xi(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $w={kernelName:ln,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xi(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gw={kernelName:De,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>or(r,Ci(pi(zi(1),_i(qi(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uw={kernelName:dn,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const o=Ci(En(zi(1),_i(qi(n,"float32"))));return or(r,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ww={kernelName:Kn,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{const g=En(_i(n),_i(o));let b=Hn(r,or(o,g));const _=Jr(n.shape,u);return _.length>0&&(b=ss(b,_)),m(b,n.shape)},b:()=>{const g=En(_i(n),_i(o));let b=oi(Hn(r,or(n,g)));const _=Jr(o.shape,u);return _.length>0&&(b=ss(b,_)),m(b,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vw={kernelName:Wn,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>or(r,En(_i(qi(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HC={kernelName:Gn,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>or(r,pi(zi(1),_i(qi(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ly(r,t,n,o,u=[1,1,1],h,p){const g=mn(r,"dy","avgPool3dGrad"),b=mn(t,"input","avgPool3dGrad");let _=g,z=b,V=!1;b.rank===4&&(V=!0,_=m(g,[1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]]),z=m(b,[1,b.shape[0],b.shape[1],b.shape[2],b.shape[3]])),bt(_.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${_.rank}.`),bt(z.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${z.rank}.`),bt(Ec(o,u),()=>`Error in avgPool3dGrad: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`),p!=null&&bt(xr(h),()=>`Error in avgPool3dGrad: pad must be an integer when using, dimRoundingMode ${p} but got pad ${h}.`);const at={dy:_,input:z},Et={filterSize:n,strides:o,dilations:u,pad:h,dimRoundingMode:p},St=lr.runKernel(ui,at,Et);return V?m(St,[St.shape[1],St.shape[2],St.shape[3],St.shape[4]]):St}const jw=br({avgPool3dGrad_:Ly});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hw={kernelName:La,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{filterSize:u,strides:h,dilations:p,pad:g,dimRoundingMode:b}=n,_=p==null?[1,1,1]:p;return{x:()=>jw(r,o,u,h,_,g,b)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xw(r,t,n,o,u){const h=mn(r,"dy","avgPoolGrad"),p=mn(t,"input","avgPoolGrad");bt(p.rank===h.rank,()=>`Rank of input (${p.rank}) does not match rank of dy (${h.rank})`);let g=p,b=h,_=!1;p.rank===3&&(_=!0,g=m(p,[1,p.shape[0],p.shape[1],p.shape[2]]),b=m(h,[1,h.shape[0],h.shape[1],h.shape[2]])),bt(b.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${b.rank}.`),bt(g.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${g.rank}.`);const z={dy:b,input:g},V={filterSize:n,strides:o,pad:u},at=lr.runKernel(xa,z,V);return _?m(at,[at.shape[1],at.shape[2],at.shape[3]]):at}const XC=br({avgPoolGrad_:Xw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yw={kernelName:Rr,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{filterSize:u,strides:h,pad:p}=n;return{x:()=>XC(r,o,u,h,p)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YC={kernelName:Fi,inputsToSave:["a","b"],gradFunc:(r,t,n)=>{const[o,u]=t,{transposeA:h,transposeB:p}=n;return!h&&!p?{a:()=>$s(r,u,!1,!0),b:()=>$s(o,r,!0,!1)}:!h&&p?{a:()=>$s(r,u,!1,!1),b:()=>$s(r,o,!0,!1)}:h&&!p?{a:()=>$s(u,r,!1,!0),b:()=>$s(o,r,!1,!1)}:{a:()=>$s(u,r,!0,!0),b:()=>$s(r,o,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kw={kernelName:Ki,gradFunc:(r,t,n)=>{const{blockShape:o,crops:u}=n;return{x:()=>qm(r,o,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zw={kernelName:vo,gradFunc:(r,t,n)=>{const o=n,u=o.inputShape,h=o.shape,p=Array.from(h);for(let b=u.length-1;b>=0;b--)if(u[b]===h[b])p[b]=1;else if(u[b]!==1)throw new Error(`broadcastTo(): [${u}] cannot be broadcast to [${h}].`);const g=[];for(let b=0;b<p.length;b++)p[b]>1&&g.push(b);return{x:()=>ss(r,g,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Py={kernelName:es,gradFunc:r=>({x:()=>r.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pp={kernelName:Wo,gradFunc:r=>({x:()=>xi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bg={kernelName:Zi,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{clipValueMin:u,clipValueMax:h}=n;return{x:()=>Cl(Ed(Bv(o,u),Sc(o,h)),r,xi(r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zg={kernelName:gi,inputsToSave:["x"],gradFunc:Oy.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vv={kernelName:ms,saveAllInputs:!0,gradFunc:(r,t,n)=>{const o=t.map(b=>b.shape),{axis:u}=n,h=Lr(u,t[0].shape)[0],p=o.map(b=>b[h]);return nd(r,p,h).map(b=>()=>b)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b0={kernelName:Do,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const[o,u]=t,{dilations:h,strides:p,pad:g,dataFormat:b}=n;return bt(Kh(h),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${h}'`),{x:()=>hu(o.shape,r,u,p,g,b),filter:()=>fg(o,r,u.shape,p,g,b)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qw={kernelName:Zs,inputsToSave:["dy","filter"],gradFunc:(r,t,n)=>{const[o,u]=t,{strides:h,pad:p,dataFormat:g,dimRoundingMode:b}=n;return{dy:()=>rs(r,u,h,p,g,1,b),filter:()=>fg(r,o,u.shape,h,p,g,b)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x0(r,t,n,o,u){let h=r;r.rank===4&&(h=m(r,[1,r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));let p=t;p.rank===4&&(p=m(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),bt(h.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${h.shape}.`),bt(p.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${p.shape}.`),bt(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),bt(h.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${h.shape[4]}) must match input depth in filter (${n[3]}.`),bt(p.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${p.shape[4]}) must match output depth for filter (${n[4]}).`);const g={x:h,dy:p},b={strides:o,pad:u,filterShape:n};return lr.runKernel(as,g,b)}const KC=br({conv3DBackpropFilter_:x0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZC={kernelName:Eu,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const{dilations:o,strides:u,pad:h}=n;bt(Kh(o),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const[p,g]=t;return{x:()=>cu(p.shape,r,g,u,h),filter:()=>KC(p,r,g.shape,u,h)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qC={kernelName:Su,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(oi(uy(qi(n,"float32"))),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QC={kernelName:fu,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(ly(qi(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fy={kernelName:Is,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{axis:u,exclusive:h,reverse:p}=n;return{x:()=>{const g=Gc([u],o.rank);let b=qh(r,u,h,!p);return g!=null&&(b=mu(b,g)),b}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JC={kernelName:is,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const{dilations:o,strides:u,pad:h,dimRoundingMode:p}=n,g=o==null?[1,1]:o;bt(Kh(g),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${g}'`);const[b,_]=t;return bt(b.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${b.rank}.`),bt(_.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${_.rank}.`),bt(b.shape[3]===_.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${b.shape[3]}) must match the inChannels dimension in filter ${_.shape[2]}.`),bt(Ec(u,g),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${u} and dilations '${g}'.`),p!=null&&bt(xr(h),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${p} but got pad ${h}.`),{x:()=>ww(b.shape,r,_,u,h,o,p),filter:()=>xw(b,r,_.shape,u,h,o,p)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w0={kernelName:Cu,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const[o,u]=t,h={x:o,filter:u,dy:r},p={x:o,filter:u,dy:r};return{x:()=>lr.runKernel(ji,h,n),filter:()=>lr.runKernel(Bi,p,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pg={kernelName:os,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t,o={dy:r,y:n};return{x:()=>lr.runKernel(Ws,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qd={kernelName:Ss,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t,o=Hn(Qh(oi(_i(n))),2/Math.sqrt(Math.PI));return{x:()=>Hn(r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qw={kernelName:Qu,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jw={kernelName:xn,inputsToSave:["input"],gradFunc:(r,t)=>{const[n]=t;return{input:()=>m(r,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DA={kernelName:Vr,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(r,Qh(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t_={kernelName:Ao,gradFunc:r=>({x:()=>xi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e_={kernelName:ao,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{const g=or(r,qi(o,"float32")),b=Jr(n.shape,u);return b.length>0?m(ss(g,b),n.shape):g},b:()=>{let g=Hn(r,qi(n,"float32"));const b=Jr(o.shape,u);b.length>0&&(g=m(ss(g,b),o.shape));const _=_i(o);return oi(or(g,qi(_,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n_={kernelName:So,inputsToSave:["x","mean","variance","scale"],gradFunc:(r,t,n)=>{const{varianceEpsilon:o}=n,[u,h,p,g]=t,b=g==null?zi(1):g,_=Jr(h.shape,u.shape),z=[];if(h.rank===1){for(let $e=0;$e<u.shape.length-1;++$e)z.push(u.shape[$e]);z.push(1)}const V=pi(u,h),at=Hn(r,b),Et=sy(En(p,zi(o))),St=Hn(Hn(Hn(Et,Et),Et),zi(-.5));return{x:()=>h.rank===1?m(Hn(Hn(r,wd(m(Et,[1,1,1,h.shape[0]]),z)),b),u.shape):m(Hn(Hn(r,Et),b),u.shape),mean:()=>{let $e=Hn(Hn(Et,zi(-1)),at);return h.rank===1&&($e=ss($e,_)),m($e,h.shape)},variance:()=>{let $e=Hn(Hn(St,V),at);return h.rank===1&&($e=ss($e,_)),m($e,h.shape)},scale:()=>{const $e=Hn(V,Et);let Xe=Hn(r,$e);return h.rank===1&&(Xe=ss(Xe,_)),m(Xe,h.shape)},offset:()=>{let $e=r;return h.rank===1&&($e=ss($e,_)),m($e,h.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r_={kernelName:Ts,inputsToSave:["x","indices"],gradFunc:(r,t,n)=>{const[o,u]=t,{axis:h}=n,p=Lr(h,o.shape)[0];return{x:()=>{const b=o.shape,_=u.size,z=b.slice(0,p),V=z.length,at=b.slice(h,b.length).slice(1),Et=at.length,St=tE(0,V),Tt=tE(V+1,V+1+Et),Wt=eE([z,[_],at]),le=m(r,Wt),ye=m(u,[_]),Qe=eE([[V],St,Tt]),$e=mu(le,Qe);let Xe=vy($e,ye,o.shape[p]);const Rn=dm(Qe);return Xe=mu(Xe,Rn),Xe},indices:()=>u}}};function tE(r,t){const n=[];for(let o=r;o<t;++o)n.push(o);return n}function eE(r){const t=[];for(let n=0;n<r.length;++n)for(let o=0;o<r[n].length;++o)t.push(r[n][o]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a_={kernelName:Cs,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t;return{a:()=>xi(n),b:()=>xi(o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nE={kernelName:Au,gradFunc:r=>({x:()=>qi(r,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i_={kernelName:Js,gradFunc:r=>({x:()=>xi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o_={kernelName:ul,gradFunc:r=>({x:()=>xi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rE={kernelName:Mu,gradFunc:r=>({x:()=>xi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s_={kernelName:Pu,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{alpha:u}=n,h=Ah(o,0);return{x:()=>Cl(h,r,Hn(r,u))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xv={kernelName:Fu,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>or(r,En(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u_={kernelName:gu,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>or(r,qi(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l_={kernelName:gc,inputsToSave:[],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[o]=t,{axis:u}=n;return{logits:()=>{const h=!0,p=Qh(o);return pi(r,Hn(ss(r,u,h),p))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aE(r,t,n,o=5,u=1,h=1,p=.5){const g={x:r,y:t,dy:n},b={depthRadius:o,bias:u,alpha:h,beta:p};return lr.runKernel(vl,g,b)}const c_=br({localResponseNormalizationBackprop_:aE});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ab={kernelName:Bl,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[o,u]=t,{depthRadius:h,bias:p,alpha:g,beta:b}=n;return{x:()=>c_(o,u,r,h,p,g,b)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mb(r,t,n,o){return t.rank<n.rank&&(t=m(t,$c(t.shape,o))),r.rank<n.rank&&(r=m(r,$c(r.shape,o))),{x:()=>Hn(r,qi(bd(n,t),r.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nb={kernelName:Ls,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const o=n,{reductionIndices:u}=o,h=t[0],p=t[1],g=Lr(u,h.shape),b=Mb(r,p,h,g);return{x:()=>b.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iE={kernelName:el,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t;return{a:()=>Hn(r,qi(Bv(n,o),"float32")),b:()=>Hn(r,qi(Xm(n,o),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_(r,t,n,o,u,h=[1,1,1],p,g){const b=mn(r,"dy","maxPool3dGrad"),_=mn(t,"input","maxPool3dGrad"),z=mn(n,"output","maxPool3dGrad");let V=b,at=_,Et=z,St=!1;_.rank===4&&(St=!0,V=m(b,[1,b.shape[0],b.shape[1],b.shape[2],b.shape[3]]),at=m(_,[1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]]),Et=m(z,[1,z.shape[0],z.shape[1],z.shape[2],z.shape[3]])),bt(V.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${V.rank}.`),bt(at.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${at.rank}.`),bt(Et.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${Et.rank}.`),bt(Ec(u,h),()=>`Error in maxPool3dGrad: Either strides or dilations must be 1. Got strides ${u} and dilations '${h}'`),g!=null&&bt(xr(p),()=>`Error in maxPool3dGrad: pad must be an integer when using, dimRoundingMode ${g} but got pad ${p}.`);const Tt={dy:V,input:at,output:Et},Wt={filterSize:o,strides:u,dilations:h,pad:p,dimRoundingMode:g},le=lr.runKernel(Se,Tt,Wt);return St?m(le,[le.shape[1],le.shape[2],le.shape[3],le.shape[4]]):le}const h_=br({maxPool3dGrad_:f_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const By={kernelName:Ic,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[o,u]=t,{filterSize:h,strides:p,dilations:g,pad:b,dimRoundingMode:_}=n,z=g==null?[1,1,1]:g;return{x:()=>h_(r,o,u,h,p,z,b,_)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oE(r,t,n,o,u,h,p){const g=mn(r,"dy","maxPoolGrad"),b=mn(t,"input","maxPoolGrad"),_=mn(n,"output","maxPoolGrad");bt(b.rank===g.rank,()=>`Rank of input (${b.rank}) does not match rank of dy (${g.rank})`),bt(g.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${g.rank}.`),bt(b.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${b.rank}.`),p!=null&&bt(xr(h),()=>`Error in maxPoolGrad: pad must be an integer when using, dimRoundingMode ${p} but got pad ${h}.`);const z={dy:g,input:b,output:_},V={filterSize:o,strides:u,pad:h,dimRoundingMode:p};return lr.runKernel(Ol,z,V)}const kb=br({maxPoolGrad_:oE});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Db={kernelName:oc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[o,u]=t,{filterSize:h,strides:p,pad:g}=n;return{x:()=>kb(r,o,u,h,p,g)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d_={kernelName:Gt,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{axis:u}=n,h=Lr(u,o.shape),g=uf(o.shape,h)[1],b=Rt(g);return{x:()=>{const z=o.shape.slice();h.forEach(Et=>{z[Et]=1});const V=m(r,z);return or(Hn(V,Op(o.shape,"float32")),b)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $g={kernelName:re,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const o=n,{axis:u}=o,[h,p]=t,g=Lr(u,h.shape),b=Mb(r,p,h,g);return{x:()=>b.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p_={kernelName:me,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t;return{a:()=>Hn(r,qi(Sc(n,o),"float32")),b:()=>Hn(r,qi(Ah(n,o),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OA={kernelName:bn,inputsToSave:["x"],gradFunc:(r,t,n)=>{const o=t[0],{paddings:u}=n,h=u.map(p=>p[0]);return{x:()=>Zt(r,h,o.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sE={kernelName:Zn,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{const g=Jr(n.shape,u);return g.length>0?m(ss(r,g),n.shape):r},b:()=>{const g=Hn(r,oi(Ig(or(n,o)))),b=Jr(o.shape,u);return b.length>0?m(ss(g,b),o.shape):g}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v_={kernelName:Ie,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{const g=Hn(r,qi(o,"float32")),b=Jr(n.shape,u);return b.length>0?m(ss(g,b),n.shape):g},b:()=>{const g=Hn(r,qi(n,"float32")),b=Jr(o.shape,u);return b.length>0?m(ss(g,b),o.shape):g}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g_={kernelName:Ge,gradFunc:r=>({x:()=>oi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m_={kernelName:$a,inputsToSave:["indices"],gradFunc:(r,t)=>{const n=t[0];return{indices:()=>Uc(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y_={kernelName:Ta,gradFunc:r=>({x:()=>xi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b_={kernelName:ja,saveAllInputs:!0,gradFunc:(r,t,n)=>{const{axis:o}=n;return Sd(r,o).map(h=>()=>h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uE={kernelName:Oa,inputsToSave:["x"],gradFunc:(r,t,n)=>{const o=t[0],{paddings:u}=n,h=u.map(p=>p[0]);return{x:()=>Zt(r,h,o.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x_={kernelName:Ai,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(r,t)=>{const[n,o,u]=t,h=n,p=o,g=Nr(h.shape,p.shape);return{a:()=>{const z=qi(p,"float32");let V=Hn(r,Hn(z,po(h,pi(z,zi(1)))));const at=Jr(h.shape,g);return at.length>0&&(V=ss(V,at)),m(V,h.shape)},b:()=>{const z=Ah(h,0),V=Cl(z,zc(h),xi(h));let at=Hn(r,Hn(u,V));const Et=Jr(p.shape,g);return Et.length>0&&(at=ss(at,Et)),m(at,p.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w_={kernelName:Oi,inputsToSave:["x","alpha"],gradFunc:(r,t)=>{const[n,o]=t,u=Ah(n,0);return{x:()=>Cl(u,r,Hn(r,o)),alpha:()=>{let h=Cl(u,xi(r),Hn(r,n));const p=Jr(o.shape,r.shape);return p.length>0&&(h=ss(h,p)),m(h,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E_={kernelName:Ms,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{const g=or(r,qi(o,"float32")),b=Jr(n.shape,u);return b.length>0?m(ss(g,b),n.shape):g},b:()=>{let g=Hn(r,qi(n,"float32"));const b=Jr(o.shape,u);b.length>0&&(g=m(ss(g,b),o.shape));const _=_i(o);return oi(or(g,qi(_,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S_={kernelName:Ro,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>or(r,oi(_i(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C_={kernelName:Rl,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t,o=Hn(Sc(n,6),ym(n));return{x:()=>Hn(r,qi(o,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const __={kernelName:Ys,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(r,qi(ym(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lE={kernelName:Ps,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>m(r,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I_={kernelName:su,inputsToSave:["images"],gradFunc:(r,t,n)=>{const[o]=t,u={dy:r,images:o};return{images:()=>lr.runKernel(xl,u,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T_={kernelName:As,inputsToSave:["images"],gradFunc:(r,t,n)=>{const[o]=t,u={dy:r,images:o};return{images:()=>lr.runKernel(Vs,u,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A_={kernelName:Ll,gradFunc:(r,t,n)=>{const{dims:o}=n,u=Lr(o,r.shape);return{x:()=>ed(r,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M_={kernelName:nl,gradFunc:r=>({x:()=>xi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N_={kernelName:rl,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>oi(or(r,Hn(po(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k_={kernelName:Sf,inputsToSave:["condition"],gradFunc:(r,t)=>{const[n]=t;return{condition:()=>qi(xi(n),"float32"),t:()=>Hn(r,qi(n,r.dtype)),e:()=>Hn(r,qi(ag(n),r.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zy={kernelName:Yl,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const o=Ah(n,zi(0)),u=zi(My),h=zi(Ny),p=Hn(r,h),g=Hn(Hn(r,u),Qh(qi(n,"float32")));return Cl(o,p,g)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D_={kernelName:pe,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(r,Hn(n,pi(zi(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ob={kernelName:Kt,gradFunc:r=>({x:()=>xi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O_={kernelName:T,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(Zh(qi(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R_={kernelName:rt,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(Bc(qi(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L_={kernelName:Cf,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{begin:u,size:h}=n,p=o.shape,[g,b]=uv(o,u,h),_=[];for(let z=0;z<r.rank;z++)_.push([g[z],p[z]-g[z]-b[z]]);return{x:()=>zv(r,_)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P_={kernelName:rr,outputsToSave:[!0],gradFunc:(r,t,n)=>{const[o]=t,{dim:u}=n,h=!0,p=Hn(r,o);return{logits:()=>pi(p,Hn(ss(p,[u],h),o))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F_={kernelName:Re,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(r,Bt(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cE={kernelName:wn,gradFunc:(r,t,n)=>{const{blockShape:o,paddings:u}=n;return{x:()=>hn(r,o,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fE={kernelName:Mn,gradFunc:(r,t,n)=>{const{axis:o}=n;return{x:()=>vt(r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B_={kernelName:Je,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>or(r,Hn(Ci(qi(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hE={kernelName:ca,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(r,Hn(qi(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z_={kernelName:We,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=zi(2);return{a:()=>Hn(r,Hn(u,pi(n,o))),b:()=>Hn(r,Hn(u,pi(o,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $_={kernelName:Bu,gradFunc:r=>({x:()=>xi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G_={kernelName:ha,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,o]=t,u=Nr(n.shape,o.shape);return{a:()=>{let g=r;const b=Jr(n.shape,u);return b.length>0&&(g=ss(g,b)),m(g,n.shape)},b:()=>{let g=r;const b=Jr(o.shape,u);return b.length>0&&(g=ss(g,b)),m(oi(g),o.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U_={kernelName:an,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,u=o.shape.slice(),{axis:h}=n;Lr(h,o.shape).forEach(_=>{u[_]=1});const g=m(r,u),b=Hn(g,Op(o.shape,"float32"));return{x:()=>b}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W_={kernelName:qa,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>or(r,_i(Zh(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V_={kernelName:ma,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Hn(pi(zi(1),_i(n)),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j_={kernelName:Mi,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[o]=t,{reps:u}=n;return{x:()=>{let p=xi(o);if(o.rank===1)for(let g=0;g<u[0];++g)p=En(p,Zt(r,[g*o.shape[0]],[o.shape[0]]));else if(o.rank===2)for(let g=0;g<u[0];++g)for(let b=0;b<u[1];++b)p=En(p,Zt(r,[g*o.shape[0],b*o.shape[1]],[o.shape[0],o.shape[1]]));else if(o.rank===3)for(let g=0;g<u[0];++g)for(let b=0;b<u[1];++b)for(let _=0;_<u[2];++_)p=En(p,Zt(r,[g*o.shape[0],b*o.shape[1],_*o.shape[2]],[o.shape[0],o.shape[1],o.shape[2]]));else if(o.rank===4)for(let g=0;g<u[0];++g)for(let b=0;b<u[1];++b)for(let _=0;_<u[2];++_)for(let z=0;z<u[3];++z)p=En(p,Zt(r,[g*o.shape[0],b*o.shape[1],_*o.shape[2],z*o.shape[3]],[o.shape[0],o.shape[1],o.shape[2],o.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${o.rank} tensors yet.`);return p}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E0={kernelName:_o,gradFunc:(r,t,n)=>{const o=n,{perm:u}=o,h=dm(u);return{x:()=>mu(r,h)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H_={kernelName:yo,gradFunc:(r,t,n)=>{const o=n,{axis:u}=o;return{value:()=>rd(r,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X_={kernelName:No,inputsToSave:["segmentIds"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Y_(r,n)}}};function Y_(r,t){const n=Jo(t,xi(t)),o=pv(r,n);let u=Bv(t,zi(0,"int32"));const h=o.rank-u.rank;for(let g=0;g<h;++g)u=xd(u,g+1);u=Ed(u,Op(o.shape,"bool"));const p=xi(o);return Cl(u,o,p)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K_={kernelName:Vu,gradFunc:r=>({x:()=>xi(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Im=[Oy,Ry,Bw,zw,sd,jC,$w,Gw,Uw,Ww,Vw,HC,Hw,Yw,YC,Kw,Zw,Py,Pp,Bg,zg,Vv,qw,b0,ZC,qC,QC,Fy,JC,w0,E_,pg,qd,Qw,Jw,DA,e_,t_,n_,r_,a_,nE,i_,o_,rE,s_,xv,u_,l_,Ab,Nb,Nb,iE,By,Db,d_,$g,p_,OA,sE,v_,g_,m_,y_,b_,uE,uE,x_,w_,S_,C_,__,lE,I_,T_,A_,M_,N_,k_,zy,D_,Ob,O_,R_,L_,P_,F_,cE,cE,fE,fE,B_,z_,hE,$_,G_,U_,W_,V_,j_,E0,H_,X_,K_];for(const r of Im)hh(r);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.abs=function(){return this.throwIfDisposed(),fl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.acos=function(){return this.throwIfDisposed(),yr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.acosh=function(){return this.throwIfDisposed(),Mr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.addStrict=function(r){return this.throwIfDisposed(),Iu(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.add=function(r){return this.throwIfDisposed(),En(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.all=function(r,t){return this.throwIfDisposed(),Or(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.any=function(r,t){return this.throwIfDisposed(),wa(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.argMax=function(r){return this.throwIfDisposed(),ga(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.argMin=function(r){return this.throwIfDisposed(),lo(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.asScalar=function(){return this.throwIfDisposed(),bt(this.size===1,()=>"The array must have only 1 element."),m(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.asType=function(r){return this.throwIfDisposed(),qi(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.as1D=function(){return this.throwIfDisposed(),m(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.as2D=function(r,t){return this.throwIfDisposed(),m(this,[r,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.as3D=function(r,t,n){return this.throwIfDisposed(),m(this,[r,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.as4D=function(r,t,n,o){return this.throwIfDisposed(),m(this,[r,t,n,o])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.as5D=function(r,t,n,o,u){return this.throwIfDisposed(),m(this,[r,t,n,o,u])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.asin=function(){return this.throwIfDisposed(),Qi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.asinh=function(){return this.throwIfDisposed(),Mo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.atan=function(){return this.throwIfDisposed(),yl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.atan2=function(r){return this.throwIfDisposed(),Ih(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.atanh=function(){return this.throwIfDisposed(),Lv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.avgPool=function(r,t,n,o){return this.throwIfDisposed(),S(this,r,t,n,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.batchToSpaceND=function(r,t){return this.throwIfDisposed(),hn(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.batchNorm=function(r,t,n,o,u){return this.throwIfDisposed(),Yn(this,r,t,n,o,u)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.broadcastTo=function(r){return this.throwIfDisposed(),ka(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.cast=function(r){return this.throwIfDisposed(),qi(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.ceil=function(){return this.throwIfDisposed(),Li(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.clipByValue=function(r,t){return this.throwIfDisposed(),fi(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.concat=function(r,t){return this.throwIfDisposed(),r instanceof Nn&&(r=[r]),vt([this,...r],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.conv1d=function(r,t,n,o,u,h){return this.throwIfDisposed(),Bo(this,r,t,n,o,u,h)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.conv2dTranspose=function(r,t,n,o,u){return this.throwIfDisposed(),Nl(this,r,t,n,o,u)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.conv2d=function(r,t,n,o,u,h){return this.throwIfDisposed(),rs(this,r,t,n,o,u,h)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.cos=function(){return this.throwIfDisposed(),Zh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.cosh=function(){return this.throwIfDisposed(),Bc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.cumsum=function(r,t,n){return this.throwIfDisposed(),qh(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.depthToSpace=function(r,t){return this.throwIfDisposed(),Fv(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.depthwiseConv2D=function(r,t,n,o,u,h){return ea("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),dv(this,r,t,n,o,u,h)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.depthwiseConv2d=function(r,t,n,o,u,h){return this.throwIfDisposed(),dv(this,r,t,n,o,u,h)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.dilation2d=function(r,t,n,o,u){return this.throwIfDisposed(),lm(this,r,t,n,o,u)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.divNoNan=function(r){return this.throwIfDisposed(),_g(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.divStrict=function(r){return this.throwIfDisposed(),cg(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.div=function(r){return this.throwIfDisposed(),or(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.dot=function(r){return this.throwIfDisposed(),cm(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.elu=function(){return this.throwIfDisposed(),fm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.equalStrict=function(r){return this.throwIfDisposed(),G2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.equal=function(r){return this.throwIfDisposed(),bd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.erf=function(){return this.throwIfDisposed(),H0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.exp=function(){return this.throwIfDisposed(),Qh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.expandDims=function(r){return this.throwIfDisposed(),xd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.expm1=function(){return this.throwIfDisposed(),X0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.fft=function(){return this.throwIfDisposed(),r0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.flatten=function(){return this.throwIfDisposed(),m(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.floor=function(){return this.throwIfDisposed(),Ig(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.floorDiv=function(r){return this.throwIfDisposed(),Dr(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.gather=function(r,t){return this.throwIfDisposed(),pv(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.greaterEqualStrict=function(r){return this.throwIfDisposed(),U2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.greaterEqual=function(r){return this.throwIfDisposed(),Bv(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.greaterStrict=function(r){return this.throwIfDisposed(),W2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.greater=function(r){return this.throwIfDisposed(),Ah(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.ifft=function(){return this.throwIfDisposed(),mm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.irfft=function(){return this.throwIfDisposed(),fy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.isFinite=function(){return this.throwIfDisposed(),Rx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.isInf=function(){return this.throwIfDisposed(),Lx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.isNaN=function(){return this.throwIfDisposed(),P1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.leakyRelu=function(r){return this.throwIfDisposed(),Hm(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.lessEqualStrict=function(r){return this.throwIfDisposed(),V2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.lessEqual=function(r){return this.throwIfDisposed(),Sc(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.lessStrict=function(r){return this.throwIfDisposed(),j2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.less=function(r){return this.throwIfDisposed(),Xm(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.localResponseNormalization=function(r,t,n,o){return this.throwIfDisposed(),F1(this,r,t,n,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.logSigmoid=function(){return this.throwIfDisposed(),B1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.logSoftmax=function(r){return this.throwIfDisposed(),Q0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.logSumExp=function(r,t){return this.throwIfDisposed(),Ym(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.log=function(){return this.throwIfDisposed(),zc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.log1p=function(){return this.throwIfDisposed(),q0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.logicalAnd=function(r){return this.throwIfDisposed(),Ed(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.logicalNot=function(){return this.throwIfDisposed(),ag(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.logicalOr=function(r){return this.throwIfDisposed(),Ag(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.logicalXor=function(r){return this.throwIfDisposed(),U1(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.matMul=function(r,t,n){return this.throwIfDisposed(),$s(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.maxPool=function(r,t,n,o){return this.throwIfDisposed(),Ng(this,r,t,n,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.max=function(r,t){return this.throwIfDisposed(),Gf(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.maximumStrict=function(r){return this.throwIfDisposed(),l0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.maximum=function(r){return this.throwIfDisposed(),Jo(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.mean=function(r,t){return this.throwIfDisposed(),nc(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.min=function(r,t){return this.throwIfDisposed(),ig(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.minimumStrict=function(r){return this.throwIfDisposed(),cw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.minimum=function(r){return this.throwIfDisposed(),og(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.mirrorPad=function(r,t){return this.throwIfDisposed(),V1(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.modStrict=function(r){return this.throwIfDisposed(),fw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.mod=function(r){return this.throwIfDisposed(),ry(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.mulStrict=function(r){return this.throwIfDisposed(),hw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.mul=function(r){return this.throwIfDisposed(),Hn(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.neg=function(){return this.throwIfDisposed(),oi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.norm=function(r,t,n){return this.throwIfDisposed(),yy(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.notEqualStrict=function(r){return this.throwIfDisposed(),H2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.notEqual=function(r){return this.throwIfDisposed(),sg(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.oneHot=function(r,t=1,n=0){return this.throwIfDisposed(),Mc(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.onesLike=function(){return this.throwIfDisposed(),Jh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.pad=function(r,t){return this.throwIfDisposed(),zv(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.pool=function(r,t,n,o,u){return this.throwIfDisposed(),H1(this,r,t,n,o,u)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.powStrict=function(r){return this.throwIfDisposed(),dw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.pow=function(r){return this.throwIfDisposed(),po(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.prelu=function(r){return this.throwIfDisposed(),kg(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.prod=function(r,t){return this.throwIfDisposed(),oy(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.reciprocal=function(){return this.throwIfDisposed(),q1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.relu=function(){return this.throwIfDisposed(),td(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.relu6=function(){return this.throwIfDisposed(),Jm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.reshapeAs=function(r){return this.throwIfDisposed(),m(this,r.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.reshape=function(r){return this.throwIfDisposed(),m(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.resizeBilinear=function(r,t,n){return this.throwIfDisposed(),Lp(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.resizeNearestNeighbor=function(r,t,n){return this.throwIfDisposed(),pb(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.reverse=function(r){return this.throwIfDisposed(),ed(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.rfft=function(){return this.throwIfDisposed(),a0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.round=function(){return this.throwIfDisposed(),Q1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.rsqrt=function(){return this.throwIfDisposed(),sy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.selu=function(){return this.throwIfDisposed(),Dg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.separableConv2d=function(r,t,n,o,u,h){return this.throwIfDisposed(),J1(this,r,t,n,o,u,h)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.sigmoid=function(){return this.throwIfDisposed(),Bt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.sign=function(){return this.throwIfDisposed(),tb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.sin=function(){return this.throwIfDisposed(),uy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.sinh=function(){return this.throwIfDisposed(),ly(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.slice=function(r,t){return this.throwIfDisposed(),Zt(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.softmax=function(r){return this.throwIfDisposed(),n0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.softplus=function(){return this.throwIfDisposed(),hm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.spaceToBatchND=function(r,t){return this.throwIfDisposed(),qm(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.split=function(r,t){return this.throwIfDisposed(),nd(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.sqrt=function(){return this.throwIfDisposed(),Ci(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.square=function(){return this.throwIfDisposed(),_i(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.squaredDifference=function(r){return this.throwIfDisposed(),i0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.squaredDifferenceStrict=function(r){return this.throwIfDisposed(),pu(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.squeeze=function(r){return this.throwIfDisposed(),lg(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.stack=function(r,t){this.throwIfDisposed();const n=r instanceof Nn?[this,r]:[this,...r];return rd(n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.step=function(r){return this.throwIfDisposed(),ym(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.stridedSlice=function(r,t,n,o,u,h,p,g){return this.throwIfDisposed(),nb(this,r,t,n,o,u,h,p,g)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.subStrict=function(r){return this.throwIfDisposed(),pw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.sub=function(r){return this.throwIfDisposed(),pi(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.sum=function(r,t){return this.throwIfDisposed(),ss(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.tan=function(){return this.throwIfDisposed(),rb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.tanh=function(){return this.throwIfDisposed(),be(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.tile=function(r){return this.throwIfDisposed(),wd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.toBool=function(){return this.throwIfDisposed(),qi(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.toFloat=function(){return this.throwIfDisposed(),qi(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.toInt=function(){return this.throwIfDisposed(),qi(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.topk=function(r,t){return this.throwIfDisposed(),bm(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.transpose=function(r){return this.throwIfDisposed(),mu(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.unique=function(r){return this.throwIfDisposed(),py(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.unsortedSegmentSum=function(r,t){return this.throwIfDisposed(),vy(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.unstack=function(r){return this.throwIfDisposed(),Sd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.where=function(r,t){return this.throwIfDisposed(),Cl(r,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Nn.prototype.zerosLike=function(){return this.throwIfDisposed(),xi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let $y;function lf(){return $y==null&&($y=gn().epsilon()),$y}function RA(r){$y=r}function Qd(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Yu extends Error{constructor(t){super(t);Object.setPrototypeOf(this,Yu.prototype)}}class Jd extends Error{constructor(t){super(t);Object.setPrototypeOf(this,Jd.prototype)}}class Kr extends Error{constructor(t){super(t);Object.setPrototypeOf(this,Kr.prototype)}}class Xs extends Error{constructor(t){super(t);Object.setPrototypeOf(this,Xs.prototype)}}class Rb extends Error{constructor(t){super(t);Object.setPrototypeOf(this,Rb.prototype)}}class Gy extends Error{constructor(t){super(t);Object.setPrototypeOf(this,Gy.prototype)}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gg(r,t){if(Array.isArray(r)){let n=[];for(let o=0;o<t;o++)n=n.concat(r);return n}else{const n=new Array(t);return n.fill(r),n}}function Cd(r,t){if(!r)throw new Rb(t)}function dE(r,t){let n=0;for(const o of r)o===t&&n++;return n}function Mh(r){return r.length===1?r[0]:r}function Ql(r){return Array.isArray(r)?r:[r]}function LA(r){const t=Ql(r);let n="";for(const o of t){if(o.id==null)throw new ValueError(`Object ${o} passed to objectListUid without an id`);n!==""&&(n=n+", "),n=`${n}${Math.abs(o.id)}`}return n}function jv(r){const n=r.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Nh(r){return r.length<=1||r.indexOf("_")===-1?r:r.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}let tp={};function Lb(r){if(r==null)return null;const t={};return t.className=r.getClassName(),t.config=r.getConfig(),t}function Pb(r){if(!(r==null||typeof r!="object"))if(Array.isArray(r))r.forEach(t=>Pb(t));else{const t=Object.keys(r);for(const n of t){const o=r[n];o!=null&&typeof o=="object"&&(!Array.isArray(o)&&o.type==="ndarray"&&typeof o.value=="number"?r[n]=o.value:Pb(o))}}}function S0(r,t={},n={},o="object",u=!1){if(typeof r=="string"){const h=r;let p;if(h in n)p=n[h];else if(h in tp)p=tp[h];else if(p=t[h],p==null)throw new Kr(`Unknown ${o}: ${r}. This may be due to one of the following reasons:
1. The ${o} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${o} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return p}else{const h=r;if(h.className==null||h.config==null)throw new Kr(`${o}: Improper config format: ${JSON.stringify(h)}.
'className' and 'config' must set.`);const p=h.className;let g,b;if(p in n?[g,b]=n[p]:p in tp?[g,b]=tp.className:p in t&&([g,b]=t[p]),g==null)throw new Kr(`Unknown ${o}: ${p}. This may be due to one of the following reasons:
1. The ${o} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${o} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(b!=null){const _={};for(const Et of Object.keys(tp))_[Et]=tp[Et];for(const Et of Object.keys(n))_[Et]=n[Et];const z=h.config;z.customObjects=_;const V=Object.assign({},tp);for(const Et of Object.keys(n))tp[Et]=n[Et];Pb(h.config);const at=b(g,h.config,n,u);return tp=Object.assign({},V),at}else{const _=Object.assign({},tp);for(const V of Object.keys(n))tp[V]=n[V];const z=new g(h.config);return tp=Object.assign({},_),z}}}function Z_(r,t){return r<t?-1:r>t?1:0}function Uy(r,t){return-1*Z_(r,t)}function PA(r){switch(r){case"float32":return"float32";default:throw new ValueError(`Invalid dtype: ${r}`)}}function FA(r,t){if(r==null||t==null)return r===t;if(r.length!==t.length)return!1;for(let n=0;n<r.length;++n)if(r[n]!==t[n])return!1;return!0}function vg(r){if(r==null)return r;const t=[];for(const n of r)t.indexOf(n)===-1&&t.push(n);return t}function q_(r){if(r==null)throw new Kr(`Invalid value in obj: ${JSON.stringify(r)}`);for(const t in r)if(r.hasOwnProperty(t))return!1;return!0}function Ug(r,t,n){if(n!=null&&r.indexOf(n)<0)throw new Kr(`${n} is not a valid ${t}.  Valid values are ${r} or null/undefined.`)}function C0(r,t,n=0,o=Infinity){return Cd(n>=0),Cd(o>=n),Array.isArray(r)&&r.length>=n&&r.length<=o&&r.every(u=>typeof u===t)}function bf(r,t){Array.isArray(r)?(bt(r.length>0,()=>`${t} is unexpectedly an empty array.`),r.forEach((n,o)=>bf(n,`element ${o+1} of ${t}`))):bt(Number.isInteger(r)&&r>0,()=>`Expected ${t} to be a positive integer, but got ${Fb(r)}.`)}function Fb(r){return r===null?"null":Array.isArray(r)?"["+r.map(t=>Fb(t)).join(",")+"]":typeof r=="string"?`"${r}"`:`${r}`}function pE(r,t){let n=js(),o;return(...h)=>{const p=js();return p-n<t||(n=p,o=r(...h)),o}}function vE(r){return r==="relu"?"relu":r==="linear"?"linear":r==="elu"?"elu":null}function BA(...r){Cd(r.length>0,"arrayOfValues is empty");for(const t of r)Cd(Array.isArray(t),"one of the values is not an array"),Cd(t.length>0,"one of the values is empty");return r.reduce((t,n)=>t.length===0?n.map(o=>[o]):n.map(o=>t.map(u=>[...u,o])).reduce((o,u)=>o.concat(u),[]),[])}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bb(r,t){return Vn(()=>Ci(ss(Hn(r,r),t,!0)))}class _0 extends _h{getConfig(){return{}}}class zb extends _0{constructor(t){super();this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return Vn(()=>{const n=Bb(t,this.axis),o=fi(n,0,this.maxValue);return Hn(t,or(o,En(lf(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}zb.className="MaxNorm",li(zb);class $b extends _0{constructor(t){super();this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return Vn(()=>or(t,En(lf(),Bb(t,this.axis))))}getConfig(){return{axis:this.axis}}}$b.className="UnitNorm",li($b);class Gb extends _0{apply(t){return td(t)}}Gb.className="NonNeg",li(Gb);class Ub extends _0{constructor(t){super();this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return Vn(()=>{const n=Bb(t,this.axis),o=En(Hn(this.rate,fi(n,this.minValue,this.maxValue)),Hn(1-this.rate,n));return Hn(t,or(o,En(lf(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}Ub.className="MinMaxNorm",li(Ub);const cc={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function cf(r){return Lb(r)}function gE(r,t={}){return S0(r,of.getMap().classNameMap,t,"constraint")}function ff(r){if(r==null)return null;if(typeof r=="string"){const n={className:r in cc?cc[r]:r,config:{}};return gE(n)}else return r instanceof _0?r:gE(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Q_(r){return new zb(r)}function ep(r){return new $b(r)}function mE(){return new Gb}function yE(r){return new Ub(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const J_=["channelsFirst","channelsLast"],tI=["nearest","bilinear"],eI=["valid","same","causal"],Wb=["max","avg"],Wg=["sum","mul","concat","ave"],zA=null;/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Tm=new Map;function bu(r){Ug(J_,"DataFormat",r)}function bE(r){Ug(tI,"InterpolationFormat",r)}function Uf(r){Ug(eI,"PaddingMode",r)}function xE(r){Ug(Wb,"PoolMode",r)}const Vg=[],wE="/";function gg(r,t){Vg.push(r);try{const n=t();return Vg.pop(),n}catch(n){throw Vg.pop(),n}}function EE(){return Vg.length===0?"":Vg.join(wE)+wE}function I0(r){if(!Wy(r))throw new Error("Not a valid tensor name: '"+r+"'");return EE()+r}function SE(r){if(!Wy(r))throw new Error("Not a valid tensor name: '"+r+"'");Tm.has(r)||Tm.set(r,0);const t=Tm.get(r);if(Tm.set(r,Tm.get(r)+1),t>0){const n=`${r}_${t}`;return Tm.set(n,1),n}else return r}const $A=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Wy(r){return!!r.match($A)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function CE(r){return r===parseInt(r.toString(),10)}function jg(r,t,n){t==null&&(t=0),n==null&&(n=r.length);let o=1;for(let u=t;u<n;++u)o*=r[u];return o}function Hg(r){return r=Array.isArray(r)?new Float32Array(r):r,ad(r)}function Am(r){return ig(Hg(r)).dataSync()[0]}function wv(r){return Gf(Hg(r)).dataSync()[0]}function _E(r){return tfc.sum(Hg(r)).dataSync()[0]}function Vb(r){return _E(r)/r.length}function jb(r){const t=tfc.sub(Hg(r),scalar(Vb(r)));return tfc.sum(tfc.mul(t,t)).dataSync()[0]/r.length}function GA(r){const t=r.slice().sort((u,h)=>u-h),n=Math.floor((t.length-1)/2),o=Math.ceil((t.length-1)/2);return n===o?t[n]:(t[n]+t[o])/2}function Fp(r,t){if(t<r)throw new Kr(`end (${t}) < begin (${r}) is forbidden.`);const n=[];for(let o=r;o<t;++o)n.push(o);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let IE="webgl";function Vy(r){tfc.setBackend(r),IE=r}function UA(){return IE}function nI(){return!1}function WA(r){const t=r.shape;return t.length>0?t.reduce((n,o)=>n*o):1}function jy(r,t){return r.asType(t)}function mg(r,t=-1){const n=r.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),r.reshape(n)}function Hb(r,t){return Vn(()=>{if(r.shape.length!==2)throw new Kr(`repeat() expects a rank-2 tensor, but received a rank-${r.shape.length} tensor.`);const n=mg(r,1);return Xy(n,[1,t,1])})}function rI(r){const t=[jg(r.shape)];return r.reshape(t)}function aI(r){if(r.rank<=1)throw new Kr(`batchFlatten requires a minimum rank of 2. Got rank: ${r.rank}.`);const t=[r.shape[0],jg(r.shape,1)];return r.reshape(t)}function Xg(r,t,n){return Vn(()=>{switch(r.rank){case 1:return cy(r,t,n);case 2:return eb(r,[t,0],[n,r.shape[1]]);case 3:return t0(r,[t,0,0],[n,r.shape[1],r.shape[2]]);case 4:return e0(r,[t,0,0,0],[n,r.shape[1],r.shape[2],r.shape[3]]);case 5:return Zt(r,[t,0,0,0,0],[n,r.shape[1],r.shape[2],r.shape[3],r.shape[4]]);case 6:return Zt(r,[t,0,0,0,0,0],[n,r.shape[1],r.shape[2],r.shape[3],r.shape[4],r.shape[5]]);default:throw new Kr(`sliceAlongFirstAxis() received an unsupported tensor rank: ${r.rank}`)}})}function Xb(r,t,n){return Vn(()=>{switch(r.rank){case 1:return cy(r,t,n);case 2:return eb(r,[0,t],[r.shape[0],n]);case 3:return t0(r,[0,0,t],[r.shape[0],r.shape[1],n]);case 4:return e0(r,[0,0,0,t],[r.shape[0],r.shape[1],r.shape[2],n]);default:throw new Kr(`sliceAlongLastAxis() received an unsupported tensor rank: ${r.rank}`)}})}function T0(r,t,n,o){return Vn(()=>{switch(r.rank){case 1:return cy(r,t,n);case 2:switch(o){case 1:return Xg(r,t,n);case 2:return Xb(r,t,n);default:throw new Kr(`The axis is not within the rank of the tensor ${o}`)}case 3:switch(o){case 1:return Xg(r,t,n);case 2:return t0(r,[0,t,0],[r.shape[0],n,r.shape[2]]);case 3:return Xb(r,t,n);default:throw new Kr(`The axis is not within the rank of the tensor ${o}`)}case 4:switch(o){case 1:return Xg(r,t,n);case 2:return e0(r,[0,t,0,0],[r.shape[0],n,r.shape[2],r.shape[3]]);case 3:return e0(r,[0,0,t,0],[r.shape[0],r.shape[1],n,r.shape[3]]);case 4:return Xb(r,t,n);default:throw new Kr(`The axis is not within the rank of the tensor ${o}`)}default:throw new Kr(`sliceAlongLastAxis() received an unsupported tensor rank: ${r.rank}`)}})}function Hy(r,t=-1){let n;return t<0&&(n=r[0].rank,n!==0?t=n:t=0),t===r[0].rank&&(t=-1),vt(r,t)}function TE(r,t){switch(r.rank){case 1:return Ja([r,t]);case 2:return Po([r,t],0);case 3:return _s([r,t],0);case 4:return Co([r,t],0);default:throw new Kr(`concatAlongFirstAxis() received an unsupported tensor rank: ${r.rank}`)}}function Xy(r,t){if(Array.isArray(t)||(t=[t]),r.rank!==t.length)throw new Kr(`The length of input n (${t.length}) does not match the number of dimensions in input x (${r.rank})`);return wd(r,t)}function Yy(r,t=0,n=1,o,u){return c2(r,t,n,o,u)}function Ev(r,t,n,o){if(r.rank<2||t.rank<2)throw new Xs(`dot requires both inputs to be rank >= 2 but got x shape = ${r.shape} and y shape = ${t.shape}`);if(t.rank>=3){const u=r.shape.slice(-1)[0],h=t.shape.slice(-2)[0];if(u!==h)throw new Xs(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${r.shape} and  y shape = ${t.shape}`)}if(r.rank===2&&t.rank===2)return h0({a:r,b:t,transposeA:!1,transposeB:!1,bias:o?Yb(r.rank,o,Qd()):null,activation:n});{const u=r.shape.slice(),h=u.pop();r=r.reshape([-1,h]);const p=t.shape.slice(),g=p.pop(),b=p.pop(),_=[...p,g],z=Array.from({length:t.rank},(St,Tt)=>Tt===0?t.rank-2:Tt<=t.rank-2?Tt-1:Tt);t=t.transpose(z).reshape([b,-1]);const V=[...u,..._];return h0({a:r,b:t,transposeA:!1,transposeB:!1,bias:o?Yb(r.rank,o,Qd()):null,activation:n}).reshape(V)}}function VA(r){return tidy(()=>{const t=coreZerosLike(r),n=coreOnesLike(r);return where(tfc.equal(r,t),t,where(tfc.greater(r,coreZerosLike(r)),n,tfc.mul(-1,n)))})}function jA(r,t){return tidy(()=>{if(r.rank!==1)throw new Error("Only 1D one-hot tensors are supported in the deeplearn backend, at present.");return r=r.toInt(),tfc.oneHot(r,t).toFloat()})}function AE(r,t,n){return Vn(()=>(Array.isArray(t)?t=ad(t,"int32"):t=t.toInt(),pv(r,t,n)))}function Ky(r){return Hn(r,r)}function yg(r,t){return tidy(()=>{if(typeof t=="number"&&(t=scalar(Math.round(t),"int32")),t.dtype!=="int32")throw new NotImplementedError(`Non-int32 dtype (${t.dtype}) is not supported by pow() yet`);return tfc.pow(r,t)})}function Yb(r,t,n){const o=t.shape;if(t.rank!==1&&t.rank!==r)throw new Kr(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${r}`);if(r===5){if(n==="channelsFirst")return o.length===1?t.reshape([1,o[0],1,1,1]):t.reshape([1,o[3],o[0],o[1],o[2]]);if(n==="channelsLast")return o.length===1?t.reshape([1,1,1,1,o[0]]):t.reshape([1].concat(o))}else if(r===4){if(n==="channelsFirst")return o.length===1?t.reshape([1,o[0],1,1]):t.reshape([1,o[2],o[0],o[1]]);if(n==="channelsLast")return o.length===1?t.reshape([1,1,1,o[0]]):t.reshape([1].concat(o))}else if(r===3){if(n==="channelsFirst")return o.length===1?t.reshape([1,o[0],1]):t.reshape([1,o[1],o[0]]);if(n==="channelsLast")return o.length===1?t.reshape([1,1,o[0]]):t.reshape([1].concat(o))}else if(r<3)return t;throw new Kr(`Unsupported input rank by biasAdd: ${t.rank}`)}function np(r,t,n){return Vn(()=>(n==null&&(n=Qd()),bu(n),r.add(Yb(r.rank,t,n))))}function ME(r,t=1){if(t!==1)throw new Xs(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return fm(r)}function NE(r){return Vn(()=>or(r,fl(r).add(1)))}function Kb(r,t,n,o){return Vn(()=>yw(r,t,n,o))}function Zb(r){return Vn(()=>{const t=En(.5,Hn(.2,r));return fi(t,0,1)})}function A0(r,t,n=!1){return n?r():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const iI=["fanIn","fanOut","fanAvg"],kE=["normal","uniform","truncatedNormal"],oI=null;/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DE(r){Ug(iI,"FanMode",r)}function sI(r){Ug(kE,"Distribution",r)}class rp extends _h{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class qb extends rp{apply(t,n){return Uc(t,n)}}qb.className="Zeros",li(qb);class Zy extends rp{apply(t,n){return Op(t,n)}}Zy.className="Ones",li(Zy);class Qb extends rp{constructor(t){super();if(typeof t!="object")throw new Kr(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new Kr(`config must have value set but got ${t}`);this.value=t.value}apply(t,n){return Vn(()=>Hn(zi(this.value),Op(t,n)))}getConfig(){return{value:this.value}}}Qb.className="Constant",li(Qb);class Mm extends rp{constructor(t){super();this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,n){return du(t,this.minval,this.maxval,n)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}Mm.className="RandomUniform",li(Mm);class qy extends rp{constructor(t){super();this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Xs(`randomNormal does not support dType ${n}.`);return Yy(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}qy.className="RandomNormal",li(qy);class Qy extends rp{constructor(t){super();this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Xs(`truncatedNormal does not support dType ${n}.`);return dy(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Qy.className="TruncatedNormal",li(Qy);class Jy extends rp{constructor(t){super();this.gain=t.gain!=null?t.gain:1}apply(t,n){return Vn(()=>{if(t.length!==2||t[0]!==t[1])throw new Kr("Identity matrix initializer can only be used for 2D square matrices.");return Hn(this.gain,jm(t[0]))})}getConfig(){return{gain:this.gain}}}Jy.className="Identity",li(Jy);function uI(r,t="channelsLast"){let n,o;if(bu(t),r.length===2)n=r[0],o=r[1];else if([3,4,5].indexOf(r.length)!==-1){if(t==="channelsFirst"){const u=jg(r,2);n=r[1]*u,o=r[0]*u}else if(t==="channelsLast"){const u=jg(r,0,r.length-2);n=r[r.length-2]*u,o=r[r.length-1]*u}}else{const u=jg(r);n=Math.sqrt(u),o=Math.sqrt(u)}return[n,o]}class kh extends rp{constructor(t){super();if(t.scale<0)throw new Kr(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,DE(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,sI(this.distribution),this.seed=t.seed}apply(t,n){const o=uI(t),u=o[0],h=o[1];let p=this.scale;if(this.mode==="fanIn"?p/=Math.max(1,u):this.mode==="fanOut"?p/=Math.max(1,h):p/=Math.max(1,(u+h)/2),this.distribution==="normal"){const g=Math.sqrt(p);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Xs(`${this.getClassName()} does not support dType ${n}.`);return dy(t,0,g,n,this.seed)}else{const g=Math.sqrt(3*p);return du(t,-g,g,n)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}kh.className="VarianceScaling",li(kh);class M0 extends kh{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return kh.className}}M0.className="GlorotUniform",li(M0);class t1 extends kh{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return kh.className}}t1.className="GlorotNormal",li(t1);class e1 extends kh{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return kh.className}}e1.className="HeNormal",li(e1);class n1 extends kh{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return kh.className}}n1.className="HeUniform",li(n1);class Yg extends kh{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return kh.className}}Yg.className="LeCunNormal",li(Yg);class r1 extends kh{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return kh.className}}r1.className="LeCunNormal",li(r1);class a1 extends rp{constructor(t){super();if(this.DEFAULT_GAIN=1,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,this.seed!=null)throw new Xs("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,n){return Vn(()=>{if(t.length<2)throw new Xs("Shape must be at least 2D.");t[0]*t[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${t[0]*t[1]}) elements: Slowness may result.`);const o=t[0]>t[1]?[t[1],t[0]]:t,u=Yy(o,0,1,"float32");let h=Wc.gramSchmidt(u);return t[0]>t[1]&&(h=h.transpose()),Hn(this.gain,h)})}getConfig(){return{gain:this.gain,seed:this.seed}}}a1.className="Orthogonal",li(a1);const OE={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function RE(r,t={}){return S0(r,of.getMap().classNameMap,t,"initializer")}function fc(r){return Lb(r)}function hc(r){if(typeof r=="string"){const t=r in OE?OE[r]:r;if(t==="GlorotNormal")return new t1;if(t==="GlorotUniform")return new M0;if(t==="HeNormal")return new e1;if(t==="HeUniform")return new n1;if(t==="LeCunNormal")return new Yg;if(t==="LeCunUniform")return new r1;{const n={};return n.className=t,n.config={},RE(n)}}else return r instanceof rp?r:RE(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lI(){return new qb}function cI(){return new Zy}function fI(r){return new Qb(r)}function hI(r){return new Mm(r)}function LE(r){return new qy(r)}function dI(r){return new Qy(r)}function pI(r){return new Jy(r)}function vI(r){return new kh(r)}function gI(r){return new M0(r)}function PE(r){return new t1(r)}function mI(r){return new e1(r)}function yI(r){return new n1(r)}function bI(r){return new Yg(r)}function FE(r){return new r1(r)}function xI(r){return new a1(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let BE=0;function zE(){return BE++}const i1={};function N0(r=""){return r in i1||(i1[r]=0),i1[r]+=1,r+i1[r].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jb(r){return Array.isArray(r)&&Array.isArray(r[0])}function o1(r){return r.length===0?[]:Array.isArray(r[0])?r:[r]}function vu(r){let t;if(Array.isArray(r)){if(r.length!==1)throw new Kr(`Expected Tensor length to be 1; got ${r.length}`);t=r[0]}else t=r;return t}function Wl(r){if(Array.isArray(r)&&Array.isArray(r[0])){if(r.length===1)return r=r,r[0];throw new Kr(`Expected exactly 1 Shape; got ${r.length}`)}else return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function s1(r){let t=0;for(const n of r)n.shape.length===0?t+=1:t+=n.shape.reduce((o,u)=>o*u);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const $E="Variable";class Bp{constructor(t,n="float32",o=$E,u=!0,h=null){this.dtype=n==null?"float32":n,this.shape=t.shape,this.id=zE(),o=o==null?$E:o,this.originalName=I0(o),this.name=SE(this.originalName),this.trainable_=u,this.constraint=h,this.val=ab(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),HA(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function HA(r,t){if(r.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(r.shape)+" vs. "+JSON.stringify(t.shape))}function PD(r,t,n,o){return new Bp(r,t,n,!0,o)}function FD(r,t,n){return new Bp(tfc.zeros(r),t,n)}function BD(r,t,n){return new Bp(tfc.zerosLike(r),t,n)}function XA(r,t,n){const o=tfc.ones(r);return new Bp(o,t,n)}function zD(r,t,n){const o=tfc.onesLike(r);return new Bp(o,t,n)}function $D(r,t,n){return new Bp(tfc.eye(r),t,n)}function YA(r,t,n,o,u,h="randomUniform"){return new Bp(tfc.randomUniform(r,t,n,o),o,h)}function KA(r,t=0,n=1,o,u,h="truncatedNormal"){if(o=o||"float32",o!=="float32"&&o!=="int32")throw new NotImplementedError(`randomNormal does not support dType ${o}.`);return new Bp(tfc.truncatedNormal(r,t,n,o,u),o,h)}function ZA(r,t=0,n=1,o,u,h="randomNormal"){if(o=o||"float32",o!=="float32"&&o!=="int32")throw new NotImplementedError(`randomNormalVariable does not support dType ${o}.`);return new Bp(tfc.randomNormal(r,t,n,o,u),o,h)}function qA(r,t){return r.write(t)}function GD(r,t){return r.write(tfc.add(r.read(),t))}function QA(r,t){return r.write(tfc.sub(r.read(),t))}function u1(r){return r.map(t=>t.read())}function tx(r){r.forEach(t=>{t[0].write(t[1])})}function UD(r,t){const n=t.map(u=>u.read()),o=variableGrads(r,n);return t.map(u=>o.grads[u.name])}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class c{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class a{constructor(t,n,o,u,h,p,g){this.dtype=t,this.shape=n,this.sourceLayer=o,this.inputs=u,this.callArgs=h,this.outputTensorIndex=g,this.id=zE(),p!=null&&(this.originalName=I0(p),this.name=SE(this.originalName)),this.rank=n.length}}let e=0;class i{constructor(t,n){this.callArgs=n,this.id=e++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const o of t.inboundLayers)o!=null&&o.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const n of this.inboundLayers)n!=null?t.push(n.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let s=0;class l extends _h{constructor(t={}){super();this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=s++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=t.name;if(!n){const o=this.getClassName();n=jv(o)+"_"+N0(o)}if(this.name=n,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let o;if(t.batchInputShape!=null)o=t.batchInputShape;else if(t.inputShape!=null){let h=null;t.batchSize!=null&&(h=t.batchSize),o=[h].concat(t.inputShape)}this.batchInputShape=o;let u=t.dtype;u==null&&(u=t.inputDType),u==null&&(u="float32"),this.dtype=u}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,n){return t.name+"_ib-"+n.toString()}getNodeAtIndex(t,n){if(this.inboundNodes.length===0)throw new Jd(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=t)throw new Kr(`Asked to get ${n} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return Mh(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return Mh(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Yu(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Yu(`Layer ${this.name} is not connected, no input to return.`);return Mh(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Yu(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Yu(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Mh(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(n=>n.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=Ql(t),this.inputSpec==null||this.inputSpec.length===0)return;const n=Ql(this.inputSpec);if(t.length!==n.length)throw new Kr(`Layer ${this.name} expects ${n.length} inputs, but it received ${t.length} input tensors. Input received: ${t}`);for(let o=0;o<t.length;o++){const u=t[o],h=n[o];if(h==null)continue;const p=u.rank;if(h.ndim!=null&&p!==h.ndim)throw new Kr(`Input ${o} is incompatible with layer ${this.name}: expected ndim=${h.ndim}, found ndim=${p}`);if(h.maxNDim!=null&&p>h.maxNDim)throw new Kr(`Input ${o} is incompatible with layer ${this.name}: expected max_ndim=${h.maxNDim}, found ndim=${p}`);if(h.minNDim!=null&&p<h.minNDim)throw new Kr(`Input ${o} is incompatible with layer ${this.name}: expected min_ndim=${h.minNDim}, found ndim=${p}.`);if(h.dtype!=null&&u.dtype!==h.dtype)throw new Kr(`Input ${o} is incompatible with layer ${this.name} : expected dtype=${h.dtype}, found dtype=${u.dtype}.`);if(h.axes){const g=u.shape;for(const b in h.axes){const _=Number(b),z=h.axes[b],V=_>=0?g[_]:g[g.length+_];if(z!=null&&[z,null].indexOf(V)===-1)throw new Kr(`Input ${o} is incompatible with layer ${this.name}: expected axis ${_} of input shape to have value ${z} but got shape ${g}.`)}}if(h.shape!=null)for(let g=0;g<h.shape.length;++g){const b=h.shape[g],_=u.shape[g];if(b!=null&&_!=null&&b!==_)throw new Kr(`Input ${o} is incompatible with layer ${this.name}: expected shape=${h.shape}, found shape=${u.shape}.`)}}}call(t,n){return t}invokeCallHook(t,n){this._callHook!=null&&this._callHook(t,n)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,n){n=n||{},this.assertNotDisposed();const o=Ql(t);let u=!0;for(const p of o)if(!(p instanceof a)){u=!1;break}let h=!0;for(const p of o)if(p instanceof a){h=!1;break}if(u===h)throw new Kr("Arguments to apply() must be all SymbolicTensors or all Tensors");return gg(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const p=[];for(const g of Ql(t))p.push(g.shape);this.build(Mh(p)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&h&&(this._refCount=1)}if(this.assertInputCompatibility(t),h){let p=this.call(t,n);const g=Ql(p),b=[];for(let _ of g)o.indexOf(_)!==-1&&(_=_.clone()),b.push(_);if(p=Mh(b),this.activityRegularizer!=null)throw new Xs("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return p}else{const p=f(t),g=this.computeOutputShape(p);let b;const _=d(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?p[0]:p),g!=null&&g.length>0&&Array.isArray(g[0])?b=g.map((z,V)=>new a(_,z,this,Ql(t),n,this.name,V)):b=new a(_,g,this,Ql(t),n,this.name),this.addInboundNode(t,b,null,null,p,g,n),this._refCount++,this.activityRegularizer!=null)throw new Xs("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return b}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((o,u)=>{o!=null&&t[u]!=null&&t[u]!==o&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Yu(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const n of this.inboundNodes){const o=JSON.stringify(n.outputShapes);t.indexOf(o)===-1&&t.push(o)}if(t.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Yu(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Jd(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return s1(this.weights)}build(t){this.built=!0}getWeights(t=!1){return u1(t?this.trainableWeights:this.weights)}setWeights(t){Vn(()=>{const n=this.weights;if(n.length!==t.length)throw new Kr(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${n.length} weights. Provided weights: ${t}...`);if(n.length===0)return;const o=[],u=u1(n);for(let h=0;h<u.length;++h){const p=u[h],g=n[h],b=t[h];if(!Bn(p.shape,b.shape))throw new Kr(`Layer weight shape ${p.shape} not compatible with provided weight shape ${b.shape}`);o.push([g,b])}tx(o)})}addWeight(t,n,o,u,h,p,g){if(this._addedWeightNames.indexOf(t)!==-1)throw new Kr(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),o==null&&(o="float32"),this.fastWeightInitDuringBuild&&(u=hc("zeros"));const b=u.apply(n,o),_=new Bp(b,o,t,p,g);return b.dispose(),h!=null&&this.addLoss(()=>h.apply(_.read())),p==null&&(p=!0),p?this._trainableWeights.push(_):this._nonTrainableWeights.push(_),_}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=Ql(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(o=>{if(o!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}addInboundNode(t,n,o,u,h,p,g=null){const b=Ql(t);n=Ql(n),o=Ql(o),u=Ql(u),h=o1(h),p=o1(p);const _=[],z=[],V=[];for(const at of b)_.push(at.sourceLayer),z.push(at.nodeIndex),V.push(at.tensorIndex);new i({outboundLayer:this,inboundLayers:_,nodeIndices:z,tensorIndices:V,inputTensors:b,outputTensors:n,inputMasks:o,outputMasks:u,inputShapes:h,outputShapes:p},g);for(let at=0;at<n.length;at++)n[at].sourceLayer=this,n[at].nodeIndex=this.inboundNodes.length-1,n[at].tensorIndex=at}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount==0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function f(r){r=Ql(r);const t=[];for(const n of r)t.push(n.shape);return Mh(t)}function d(r){return"float32"}function v(r,t,n){if((t==null||n!=null&&n>0)&&(t=r.sourceLayer,n=r.nodeIndex),t.inboundNodes.length===0)return[r];{const o=t.inboundNodes[n];if(o.inboundLayers.length===0)return o.inputTensors;{const u=[];for(let h=0;h<o.inboundLayers.length;h++){const p=o.inputTensors[h],g=o.inboundLayers[h],b=o.nodeIndices[h],_=v(p,g,b);for(const z of _)u.indexOf(z)===-1&&u.push(z)}return u}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class x extends l{constructor(t){super({dtype:t.dtype,name:t.name!=null?t.name:N0("input").toString()});if(t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new Kr("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=t.batchInputShape;if(n==null){if(t.inputShape==null)throw new Kr("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new Kr("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const o=t.dtype||"float32";this.batchInputShape=n,this.dtype=o,this.inputSpec=[{shape:n}];const u=new a(this.dtype,this.batchInputShape,this,[],{},this.name);u.nodeIndex=0,u.tensorIndex=0,new i({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[u],outputTensors:[u],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(t,n){throw new Kr(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}x.className="InputLayer",li(x);function w(r){if(r.batchShape==null&&r.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(r.batchShape!=null&&r.shape!=null)throw new Kr("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=r.batchShape;r.shape!=null&&t==null&&(t=[null].concat(r.shape));let n=r.dtype;return n==null&&(n="float32"),new x({batchInputShape:t,name:r.name,dtype:n,sparse:r.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function I(r){return jr(this,null,function*(){if(r==null)return;const t=[],n=[],o=[];for(const u in r){const h=r[u];if(typeof h!="number"){const p=h;t.push(p.data()),n.push(u),o.push(p)}}if(t.length>0){const u=yield Promise.all(t);for(let h=0;h<u.length;++h)r[n[h]]=u[h][0];M(o)}})}function G(r){if(r!=null)for(const t in r){const n=r[t];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var U;(function(r){r[r.SILENT=0]="SILENT",r[r.VERBOSE=1]="VERBOSE"})(U||(U={}));const et=125;class ft{constructor(){this.validationData=null}setParams(t){this.params=t}onEpochBegin(t,n){return jr(this,null,function*(){})}onEpochEnd(t,n){return jr(this,null,function*(){})}onBatchBegin(t,n){return jr(this,null,function*(){})}onBatchEnd(t,n){return jr(this,null,function*(){})}onTrainBegin(t){return jr(this,null,function*(){})}onTrainEnd(t){return jr(this,null,function*(){})}setModel(t){}}class Ct{constructor(t,n=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=n}append(t){this.callbacks.push(t)}setParams(t){for(const n of this.callbacks)n.setParams(t)}setModel(t){for(const n of this.callbacks)n.setModel(t)}onEpochBegin(t,n){return jr(this,null,function*(){n==null&&(n={});for(const o of this.callbacks)yield o.onEpochBegin(t,n)})}onEpochEnd(t,n){return jr(this,null,function*(){n==null&&(n={});for(const o of this.callbacks)yield o.onEpochEnd(t,n)})}onBatchBegin(t,n){return jr(this,null,function*(){n==null&&(n={});for(const o of this.callbacks)yield o.onBatchBegin(t,n)})}onBatchEnd(t,n){return jr(this,null,function*(){n==null&&(n={});for(const o of this.callbacks)yield o.onBatchEnd(t,n)})}onTrainBegin(t){return jr(this,null,function*(){t==null&&(t={});for(const n of this.callbacks)yield n.onTrainBegin(t)})}onTrainEnd(t){return jr(this,null,function*(){t==null&&(t={});for(const n of this.callbacks)yield n.onTrainEnd(t)})}}class Mt extends ft{constructor(){super()}onEpochBegin(t){return jr(this,null,function*(){this.seen=0,this.totals={}})}onBatchEnd(t,n){return jr(this,null,function*(){n==null&&(n={});const o=n.size==null?0:n.size;this.seen+=o;for(const u in n){const h=n[u];if(typeof h=="number")this.totals.hasOwnProperty(u)||(this.totals[u]=0),this.totals[u]=this.totals[u]+h*o;else{let p;u in this.totals?p=this.totals[u]:this.totals[u]=0;const g=Vn(()=>En(this.totals[u],Hn(h,o)));this.totals[u]=g,p!=null&&p.dispose()}}})}onEpochEnd(t,n){return jr(this,null,function*(){if(n!=null)for(const o of this.params.metrics)this.totals[o]!=null&&(typeof this.totals[o]=="number"?n[o]=this.totals[o]/this.seen:Vn(()=>{const u=Hn(or(1,this.seen),this.totals[o]);n[o]=u,this.totals[o].dispose(),q(n[o])}))})}}class kt extends ft{onTrainBegin(t){return jr(this,null,function*(){this.epoch=[],this.history={}})}onEpochEnd(t,n){return jr(this,null,function*(){n==null&&(n={}),this.epoch.push(t);for(const o in n)this.history[o]==null&&(this.history[o]=[]),this.history[o].push(n[o])})}syncData(){return jr(this,null,function*(){const t=[],n=[],o=[];for(const h in this.history){const p=this.history[h];for(let g=0;g<p.length;++g)if(typeof p[g]!="number"){const b=p[g];t.push(b.data()),n.push(h),o.push(g)}}const u=yield Promise.all(t);for(let h=0;h<u.length;++h)this.history[n[h]][o[h]].dispose(),this.history[n[h]][o[h]]=u[h][0]})}}class $t extends ft{constructor(t,n){super();if(this.currentEpoch=0,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=et),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");qr(this.yieldEvery)&&(this.maybeWait=pE(this.maybeWait.bind(this),this.yieldEvery)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}maybeWait(t,n,o){return jr(this,null,function*(){const u=[];this.yield!=null&&(yield I(o),u.push(this.yield(t,n,o))),u.push(_y()),yield Promise.all(u)})}onEpochBegin(t,n){return jr(this,null,function*(){this.currentEpoch=t,this.epochBegin!=null&&(yield I(n),yield this.epochBegin(t,n))})}onEpochEnd(t,n){return jr(this,null,function*(){const o=[];this.epochEnd!=null&&(yield I(n),o.push(this.epochEnd(t,n))),this.yieldEvery==="epoch"&&o.push(_y()),yield Promise.all(o)})}onBatchBegin(t,n){return jr(this,null,function*(){this.batchBegin!=null&&(yield I(n),yield this.batchBegin(t,n))})}onBatchEnd(t,n){return jr(this,null,function*(){const o=[];this.batchEnd!=null&&(yield I(n),o.push(this.batchEnd(t,n))),this.yieldEvery==="batch"?o.push(_y()):qr(this.yieldEvery)&&o.push(this.maybeWait(this.currentEpoch,t,n)),yield Promise.all(o)})}onTrainBegin(t){return jr(this,null,function*(){this.trainBegin!=null&&(yield I(t),yield this.trainBegin(t))})}onTrainEnd(t){return jr(this,null,function*(){this.trainEnd!=null&&(yield I(t),yield this.trainEnd(t))})}}function Jt(r,t){return r==null&&(r={}),r instanceof ft?[r]:Array.isArray(r)&&r[0]instanceof ft?r:Ql(r).map(o=>new $t(o,t))}class Ce{constructor(){}static registerCallbackConstructor(t,n){bt(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),Ce.checkForDuplicate(n),Ce.constructors[t]==null&&(Ce.constructors[t]=[]),Ce.constructors[t].push(n)}static checkForDuplicate(t){for(const n in Ce.constructors)Ce.constructors[+n].forEach(u=>{if(u===t)throw new Kr("Duplicate callback constructor.")})}static clear(){Ce.constructors={}}static createCallbacks(t){const n=[];for(const o in Ce.constructors){const u=+o;t>=u&&n.push(...Ce.constructors[u])}return n.map(o=>new o)}}Ce.constructors={};function je(r,t,n,o,u,h,p,g,b){const _=new kt,z=[new Mt,...Ce.createCallbacks(t)];r!=null&&z.push(...r),z.push(_);const V=new Ct(z);return V.setParams({epochs:n,initialEpoch:o,samples:u,steps:h,batchSize:p,verbose:t,doValidation:g,metrics:b}),{callbackList:V,history:_}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ze(r,t={},n=!1){return S0(r,of.getMap().classNameMap,t,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pn(r,t){return Vn(()=>{r.dtype!=="float32"&&(r=r.asType("float32"));const n=ss(Ky(r),t,!0),o=Qo(n.shape,lf()),u=Ci(Jo(n,o));return or(r,u)})}function Fn(r,t){return Vn(()=>nc(Ky(pi(t,r)),-1))}function Tn(r,t){return Vn(()=>nc(fl(pi(t,r)),-1))}function cr(r,t){return Vn(()=>{const n=pi(r,t),o=fi(fl(r),lf(),Number.MAX_VALUE),u=fl(or(n,o));return Hn(100,nc(u,-1))})}function kr(r,t){return Vn(()=>{const n=fi(t,lf(),Number.MAX_VALUE),o=zc(En(1,n)),u=fi(r,lf(),Number.MAX_VALUE),h=zc(En(1,u));return nc(Ky(pi(o,h)),-1)})}function Aa(r,t){return Vn(()=>{const n=Jo(0,pi(1,Hn(r,t)));return nc(Ky(n),-1)})}function ci(r,t){return Vn(()=>{const n=Jo(0,pi(1,Hn(r,t)));return nc(n,-1)})}function ei(r,t){return Vn(()=>{const n=ss(Hn(r,t),-1),o=Gf(Hn(pi(1,r),t),-1);return Jo(0,En(1,pi(o,n)))})}function Ca(r,t){return Vn(()=>{const n=Math.log(2),o=pi(t,r),u=pi(En(o,hm(Hn(-2,o))),n);return nc(u,-1)})}function Pi(r,t,n=!1){return Vn(()=>{if(n)t=n0(t);else{const o=ss(t,t.shape.length-1,!0);t=or(t,o)}return t=fi(t,lf(),1-lf()),oi(ss(Hn(r.toFloat(),zc(t)),t.shape.length-1))})}function Ni(r,t,n=!1){return Vn(()=>{const o=Ig(rI(r)).toInt();t=fi(t,lf(),1-lf());const u=t.shape,h=Mc(o,u[u.length-1]).reshape(u);return Pi(h,t,n)})}function _a(r,t){if(!Bn(r.shape,t.shape))throw new Kr(`logits and labels must have the same shape, but got shapes ${JSON.stringify(r.shape)} and ${JSON.stringify(t.shape)}`);return Vn(()=>{const n=t.relu(),o=t.abs().neg();return n.sub(t.mul(r)).add(o.exp().log1p())})}function Ya(r,t){return Vn(()=>{let n;return n=fi(t,lf(),1-lf()),n=zc(or(n,pi(1,n))),nc(_a(r,n),-1)})}function hi(r,t){return Vn(()=>{const n=fi(r,lf(),1),o=fi(t,lf(),1);return ss(Hn(r,zc(or(n,o))),-1)})}function di(r,t){return Vn(()=>{const n=zc(En(lf(),t));return nc(pi(t,Hn(r,n)),-1)})}function Xi(r,t){return Vn(()=>{const n=pn(r,-1),o=pn(t,-1),u=Hn(n,o);return oi(ss(u,-1))})}const go=null,vs=null,Fs=null,hl=null,Lu=null,dl=null,_l=null,rc=null,Vl=null,zp=null,xf=null,Dh={meanSquaredError:Fn,meanAbsoluteError:Tn,meanAbsolutePercentageError:cr,meanSquaredLogarithmicError:kr,squaredHinge:Aa,hinge:ci,categoricalHinge:ei,logcosh:Ca,categoricalCrossentropy:Pi,sparseCategoricalCrossentropy:Ni,binaryCrossentropy:Ya,kullbackLeiblerDivergence:hi,poisson:di,cosineProximity:Xi};function Vc(r){if(typeof r=="string"){if(r in Dh)return Dh[r];let t=`Unknown loss ${r}`;throw r.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${r}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Kr(t)}else return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jc(r,t){return Vn(()=>{const n=Hn(.5,Jh(t)),o=jy(Ah(t,n),r.dtype);return nc(bd(r,o),-1)})}function Oh(r,t){return Vn(()=>jy(bd(ga(r,-1),ga(t,-1)),"float32"))}function Df(r,t){return Vn(()=>Ed(r.equal(1),t.equal(1)).sum().cast("float32"))}function Rh(r,t){return Vn(()=>Ed(r.equal(1),t.equal(0)).sum().cast("float32"))}function au(r,t){return Vn(()=>Ed(r.equal(0),t.equal(1)).sum().cast("float32"))}function Ku(r,t){return Vn(()=>{const n=Df(r,t),o=au(r,t),u=n.add(o);return Cl(Ah(u,0),n.div(u),0).cast("float32")})}function Ks(r,t){return Vn(()=>{const n=Df(r,t),o=Rh(r,t),u=n.add(o);return Cl(Ah(u,0),n.div(u),0).cast("float32")})}function Zu(r,t){return Ya(r,t)}function Il(r,t){return r.rank===t.rank&&(r=r.squeeze([r.rank-1])),t=t.argMax(-1),t.dtype!==r.dtype&&(t=t.asType(r.dtype)),bd(r,t).asType("float32")}function Ho(r,t){throw new NotImplementedError}function xu(r,t){throw new NotImplementedError}const wu=Fn,Dl=Fn,Tu=Tn,Uu=Tn,dc=cr,_d=cr,Dc=Pi,Kg=Xi,Zg=Ni,Of={binaryAccuracy:jc,categoricalAccuracy:Oh,precision:Ku,categoricalCrossentropy:Dc,sparseCategoricalCrossentropy:Zg,mse:wu,MSE:Dl,mae:Tu,MAE:Uu,mape:dc,MAPE:_d,cosine:Kg};function ap(r){if(typeof r=="string"&&r in Of)return Of[r];if(typeof r!="string"&&r!=null)return r;throw new Kr(`Unknown metric ${r}`)}function Id(r){if(Cd(r!==null,`Unknown LossOrMetricFn ${r}`),typeof r=="string")return r;{let t;for(const n of Object.keys(Dh))if(Dh[n]===r){t=n;break}if(t!==void 0)return t;for(const n of Object.keys(Of))if(Of[n]===r){t=n;break}return t!==void 0?t:r.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bg(r){const t={Adagrad:()=>Pg.adagrad(.01),Adadelta:()=>Pg.adadelta(1,.95,lf()),Adam:()=>Pg.adam(.001,.9,.999,lf()),Adamax:()=>Pg.adamax(.002,.9,.999,lf(),0),RMSProp:()=>Pg.rmsprop(.001,.9,0,lf()),SGD:()=>Pg.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,r in t)return t[r]();throw new Kr(`Unknown Optimizer ${r}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const uh=1*1024*1024;function ip(r,t,n=!1){if(r==null||typeof r!="object"||Object.getPrototypeOf(r)!==Object.prototype||!$p(r))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const o=JSON.stringify(r);o.length>uh&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${o.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${uh}.`)}}function $p(r){if(r===null)return!0;if(typeof r=="object")if(Object.getPrototypeOf(r)===Object.prototype){const t=Object.keys(r);for(const n of t)if(typeof n!="string"||!$p(r[n]))return!1;return!0}else if(Array.isArray(r)){for(const t of r)if(!$p(t))return!1;return!0}else return!1;else{const t=typeof r;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function GE(r,t,n,o=console.log){const u=EI(r),h=["Layer (type)","Output shape","Param #"];u?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(z=>Math.floor(t*z)));let p;if(!u){h.push("Receives inputs"),p=[];for(const z in r.nodesByDepth)p.push(...r.nodesByDepth[z])}o("_".repeat(t)),l1(h,n,o),o("=".repeat(t));const g=r.layers;for(let z=0;z<g.length;++z)u?ex(g[z],n,o):UE(g[z],n,p,o),o((z===g.length-1?"=":"_").repeat(t));r.checkTrainableWeightsConsistency();const b=wI(r),_=s1(r.nonTrainableWeights);o(`Total params: ${b+_}`),o(`Trainable params: ${b}`),o(`Non-trainable params: ${_}`),o("_".repeat(t))}function wI(r){let t;return r.collectedTrainableWeights!=null?t=s1(r.collectedTrainableWeights):t=s1(r.trainableWeights),t}function EI(r){let t=!0;const n=[],o=[];for(const u in r.nodesByDepth)n.push(r.nodesByDepth[u]);for(const u of n){if(u.length>1||u.length===1&&u[0].inboundLayers.length>1){t=!1;break}o.push(...u)}if(t)for(const u of r.layers){let h=!1;for(const p of u.inboundNodes)if(o.indexOf(p)!==-1)if(h){t=!1;break}else h=!0;if(!t)break}return t}function l1(r,t,n=console.log){let o="";for(let u=0;u<r.length;++u)u>0&&(o=o.slice(0,o.length-1)+" "),o+=r[u],o=o.slice(0,t[u]),o+=" ".repeat(t[u]-o.length);n(o)}function ex(r,t,n){let o;try{o=JSON.stringify(r.outputShape)}catch(g){o="multiple"}const u=r.name,h=r.getClassName(),p=[`${u} (${h})`,o,r.countParams().toString()];l1(p,t,n)}function UE(r,t,n,o){let u;try{u=JSON.stringify(r.outputShape)}catch(z){u="multiple"}const h=[];for(const z of r.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(z)===-1))for(let V=0;V<z.inboundLayers.length;++V){const at=z.inboundLayers[V].name,Et=z.nodeIndices[V],St=z.tensorIndices[V];h.push(`${at}[${Et}][${St}]`)}const p=r.name,g=r.getClassName(),b=h.length===0?"":h[0],_=[`${p} (${g})`,u,r.countParams().toString(),b];l1(_,t,o);for(let z=1;z<h.length;++z)l1(["","","",h[z]],t,o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function WE(r,t,n){return(r==="inboundNodes"||r==="outputLayers"||r==="inputLayers")&&t===0&&typeof n=="string"}function k0(r,t){if(r===null)return null;if(typeof r=="string")return Nh(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){const n=[],o=r.length;for(let u=0;u<o;++u){const h=r[u];WE(t,u,h)?n.push(h):n.push(k0(h,t))}return n}else{const n={};for(const o of Object.keys(r)){const u=r[o];if(o==="name"&&typeof u=="string")n[o]=u;else{const h=Nh(o);n[h]=k0(u,h)}}return n}}function nx(r,t){if(r==null)return null;if(typeof r=="string")return jv(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){const n=[],o=r.length;for(let u=0;u<o;++u){const h=r[u];WE(t,u,h)?n.push(h):n.push(nx(h,t))}return n}else{const n={};for(const o of Object.keys(r)){const u=r[o],h=jv(o);(o==="name"||o==="className")&&typeof u=="string"?n[h]=u:n[h]=nx(u,o)}return n}}/** @license See the LICENSE file. */const qg="2.8.6";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Hv(r,t){if(r.dtype==null||r.dtype===t.dtype)return t;try{return qi(t,r.dtype)}catch(n){throw new Kr(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${r.name}' (${r.dtype}).`)}}class Gp{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof Gp)for(const n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(const n of t)this.add(n.key,n.value)}}add(t,n,o){if(this.id2Value[t.id]==null)this.id2Value[t.id]=Hv(t,n),this.name2Id[t.name]=t.id,o!=null&&(this.id2Mask[t.id]=o);else throw new Kr(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof a){if(this.id2Value[t.id]==null)throw new Kr(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const n=this.name2Id[t];if(n==null)throw new Kr(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof a){if(this.id2Value[t.id]==null)throw new Kr(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const n=this.name2Id[t];if(n==null)throw new Kr(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&M(this.id2Mask)}}const jl={},ud={};function Oc(r,t,n,o){const u=n==null?!1:n.training,h=Array.isArray(r),p=h?r:[r],g=p.map(St=>St.name),b=[],_=t.names();for(const St of g)_.indexOf(St)!==-1?b.push(t.getValue(St)):b.push(null);o!=null&&(o.maxNumTensors=-Infinity,o.minNumTensors=Infinity);const z=g.join(",")+"|"+t.names().join(",");let V,at;if(jl[z]==null){const St=Sv(p,t);V=St.sorted,at=St.recipientCounts,jl[z]=V,ud[z]=at}V=jl[z],at={},u||Object.assign(at,ud[z]);const Et=new Gp(t);for(let St=0;St<V.length;++St){if(o!=null){const zr=Ga().numTensors;zr>o.maxNumTensors&&(o.maxNumTensors=zr),zr<o.minNumTensors&&(o.minNumTensors=zr)}const Tt=V[St],Wt=Tt.sourceLayer;if(Wt instanceof x)continue;const le=[],ye=[],Qe=[];let $e=!1;for(const zr of Tt.inputs){const ta=Et.getValue(zr),Ma=Et.getMask(zr);le.push(ta),ye.push(Ma),Ma!=null&&($e=!0),u||(at[zr.name]--,at[zr.name]===0&&!t.hasKey(zr)&&g.indexOf(zr.name)===-1&&!ta.isDisposed&&zr.sourceLayer.stateful!==!0&&Qe.push(ta))}$e&&(n=n||{},n.mask=ye[0]);const Xe=Ql(Wt.apply(le,n));let Rn=null;Wt.supportsMasking&&(Rn=Wt.computeMask(le,ye));const Cn=VE(Tt),mr=Array.isArray(Cn)?Cn:[Cn];for(let zr=0;zr<mr.length;++zr){Et.hasKey(mr[zr])||Et.add(mr[zr],Xe[zr],Array.isArray(Rn)?Rn[0]:Rn);const ta=g.indexOf(mr[zr].name);ta!==-1&&(b[ta]=Xe[zr])}u||M(Qe)}return Et.disposeMasks(),h?b:b[0]}function Sv(r,t){bt(r!=null&&r.length>0,()=>"Expected at least one fetch, got none");let n=[],o={};if(r.length===1){const u=rx(r[0],t);n=u.sorted,o=u.recipientMap}else{const u=new Set;for(const h of r){const{sorted:p,recipientMap:g}=rx(h,t);for(const b of p)u.has(b.name)||(n.push(b),u.add(b.name));for(const b in g)o[b]==null&&(o[b]=new Set),g[b].forEach(_=>o[b].add(_))}}return{sorted:n,recipientCounts:Qg(o)}}function Qg(r){const t={};for(const n in r)t[n]=r[n].size;return t}function rx(r,t){const n=new Set,o=[],u={};for(const g of t.names())n.add(g);const h=[],p=[];for(h.push(r);h.length>0;){const g=h[h.length-1];if(n.has(g.name)){h.pop();continue}const b=p[p.length-1]===h.length-1;if(g.inputs.length===0||b)h.pop(),o.push(g),n.add(g.name),b&&p.pop();else{p.push(h.length-1);for(const _ of g.inputs)u[_.name]==null&&(u[_.name]=new Set),u[_.name].add(g.name),!n.has(_.name)&&h.push(_)}}return{sorted:o,recipientMap:u}}function VE(r){let t;if(r.sourceLayer.inboundNodes.length===1)t=r.sourceLayer.output;else{let n=null;for(let o=0;o<r.sourceLayer.inboundNodes.length;++o)for(const u of r.sourceLayer.inboundNodes[o].outputTensors)if(u.id===r.id){n=o;break}t=r.sourceLayer.getOutputAt(n)}return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Td extends l{constructor(t){super({});if(this.containerNodes=new Set,this.name=t.name,this.name==null){const ye=this.getClassName().toLowerCase();this.name=N0(ye)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],vg(this.inputs).length!==this.inputs.length)throw new Kr(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(ye=>ye.name)}`);vg(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(ye=>ye.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const ye of this.outputs){const Qe=ye.sourceLayer,$e=ye.nodeIndex,Xe=ye.tensorIndex;this.outputLayers.push(Qe),this.outputLayersNodeIndices.push($e),this.outputLayersTensorIndices.push(Xe)}for(const ye of this.inputs){const Qe=ye.sourceLayer,$e=ye.nodeIndex,Xe=ye.tensorIndex;Cd($e===0,"input layer has >1 nodes"),Cd(Xe===0,"input layer has >1 tensors"),this.inputLayers.push(Qe),this.inputLayersNodeIndices.push($e),this.inputLayersTensorIndices.push(Xe)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let ye=0;ye<this.inputLayers.length;ye++){const Qe=this.inputLayers[ye];if(!(Qe instanceof x))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${ye} (0-based) originates from layer type ${Qe.getClassName()}.`);this.inputNames.push(Qe.name),this.feedInputShapes.push(Qe.batchInputShape),this.feedInputNames.push(Qe.name)}for(const ye of this.outputLayers)this.outputNames.push(ye.name);this.internalInputShapes=this.inputs.map(ye=>ye.shape),this.internalOutputShapes=this.outputs.map(ye=>ye.shape);const n={},o={},u={},h={},p={},g=[],b=(ye,Qe,$e,Xe,Rn,Cn)=>{(Xe==null||Rn==null||Cn==null)&&(Xe=ye.sourceLayer,Rn=ye.nodeIndex,Cn=ye.tensorIndex);const mr=Xe.inboundNodes[Rn];if($e.indexOf(mr)!==-1)throw new Jd(`The tensor ${ye.name} at layer "${Xe.name}" is part of a cycle.`);if(Qe.indexOf(mr)!==-1)return;this.containerNodes.add(Td.nodeKey(Xe,Rn)),Xe.id in p||(p[Xe.id]=Object.keys(p).length),$e.indexOf(mr)===-1&&$e.push(mr);const zr=mr.inboundLayers.length;for(let ta=0;ta<zr;ta++){const Ma=mr.inputTensors[ta],Za=mr.inboundLayers[ta],Ka=mr.nodeIndices[ta],ni=mr.tensorIndices[ta];b(Ma,Qe,$e,Za,Ka,ni)}for(Qe.push(mr);$e.indexOf(mr)>=0;)$e.splice($e.indexOf(mr),1);g.push(mr)},_=[],z=[];for(const ye of this.outputs)b(ye,_,z);const V=g.slice().reverse();for(const ye of V){o[ye.id]=ye,ye.id in n||(n[ye.id]=0);let Qe=n[ye.id];const $e=u[ye.outboundLayer.id]==null?0:u[ye.outboundLayer.id];Qe=Math.max(Qe,$e),u[ye.outboundLayer.id]=Qe,h[ye.outboundLayer.id]=ye.outboundLayer,n[ye.id]=Qe;for(let Xe=0;Xe<ye.inboundLayers.length;Xe++){const Rn=ye.inboundLayers[Xe],Cn=ye.nodeIndices[Xe],mr=Rn.inboundNodes[Cn],zr=n[mr.id]==null?0:n[mr.id];n[mr.id]=Math.max(Qe+1,zr),o[mr.id]=mr}}const at={};for(const ye in n){const Qe=n[ye];Qe in at||(at[Qe]=[]),at[Qe].push(o[ye])}const Et={};for(const ye in u){const Qe=u[ye];Qe in Et||(Et[Qe]=[]),Et[Qe].push(h[ye])}let St=Object.keys(Et).map(ye=>parseInt(ye,10)).sort(Uy);this.layers=[];for(const ye of St){const Qe=Et[ye];Qe.sort(($e,Xe)=>{const Rn=p[$e.id],Cn=p[Xe.id];return Rn<Cn?-1:Rn>Cn?1:0});for(const $e of Qe)$e instanceof Td&&this.internalContainerRefs.push($e),this.layers.push($e)}this.layersByDepth=Et,St=Object.keys(at).map(ye=>parseInt(ye,10)).sort(Uy);const Tt=this.inputs.slice(),Wt=[];for(const ye of St)for(const Qe of at[ye]){const $e=Qe.outboundLayer;if($e!=null){for(const Xe of Qe.inputTensors)if(Tt.indexOf(Xe)===-1)throw new Jd(`Graph disconnected: cannot obtain value for tensor ${Xe} at layer "${$e.name}". The following previous layers were accessed without issue: ${Wt}`);for(const Xe of Qe.outputTensors)Tt.push(Xe);Wt.push($e.name)}}this.nodesByDepth=at;const le=this.layers.map(ye=>ye.name);for(const ye of le){const Qe=le.filter($e=>$e===ye).length;if(Qe!==1)throw new Jd(`The name "${ye}" is used ${Qe} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(le))}this.outboundNodes=[],this.inboundNodes=[],new i({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(ye=>null),outputMasks:this.outputs.map(ye=>null),inputShapes:this.inputs.map(ye=>ye.shape),outputShapes:this.outputs.map(ye=>ye.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(const n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(o=>o.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new Kr("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const o of this.layers)n.push(...o.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){const o={};let u=0;for(const p of this.layers)for(const g of p.weights){if(o[g.originalName]!=null)throw new Kr(`Duplicate weight name: ${g.originalName}`);o[g.originalName]=g,u++}const h=[];for(const p in t){let g=p;if(o[p]==null){const b=p.split("/");g=b.slice(0,-2).concat([b[b.length-1]]).join("/")}if(o[g]!=null)h.push([o[g],t[p]]);else if(n)throw new Kr(`Provided weight data has no target variable: ${p}`);delete o[g]}if(n){const p=[];for(const g in o)p.push(g);if(p.length>0)throw new Kr(`${p.length} of ${u} weights are not set: ${p}`)}tx(h)}updatedConfig(){const t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${qg}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){const o=nx(this.updatedConfig());return n?JSON.stringify(o):o}call(t,n){return Vn(()=>{t=Ql(t);const o=new Gp;for(let u=0;u<this.inputs.length;++u)o.add(this.inputs[u],t[u]);return Oc(this.outputs,o,n)})}computeMask(t,n){return Vn(()=>{t=Ql(t);let o;return n==null?o=Gg(null,t.length):o=Ql(n),this.runInternalGraph(t,o)[1]})}computeOutputShape(t){const n=o1(t);if(n.length!==this.inputLayers.length)throw new Kr(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const o={};for(let g=0;g<n.length;g++){const b=this.inputLayers[g],_=n[g],z=b.name+"_0_0";o[z]=_}const u=Object.keys(this.nodesByDepth).map(g=>parseInt(g,10)).sort(Uy);if(u.length>1)for(const g of u){const b=this.nodesByDepth[g];for(const _ of b){const z=_.outboundLayer;if(this.inputLayers.map(Tt=>Tt.id).indexOf(z.id)!==-1)continue;const V=[];for(let Tt=0;Tt<_.inboundLayers.length;Tt++){const Wt=_.inboundLayers[Tt],le=_.nodeIndices[Tt],ye=_.tensorIndices[Tt],Qe=`${Wt.name}_${le}_${ye}`,$e=o[Qe];V.push($e)}const at=z.computeOutputShape(Mh(V)),Et=o1(at),St=z.inboundNodes.indexOf(_);for(let Tt=0;Tt<Et.length;Tt++){const Wt=`${z.name}_${St}_${Tt}`;o[Wt]=Et[Tt]}}}const h=[],p=[];for(let g=0;g<this.outputLayers.length;g++){const b=this.outputLayers[g],_=this.outputLayersNodeIndices[g],z=this.outputLayersTensorIndices[g],V=`${b.name}_${_}_${z}`;p.push(V)}for(let g=0;g<p.length;g++){const b=p[g];Cd(b in o),h.push(o[b])}return Mh(h)}runInternalGraph(t,n){n==null&&(n=Gg(null,t.length));const o={};for(let b=0;b<this.inputs.length;++b){const _=this.inputs[b],z=t[b],V=n[b];o[_.id]=[z,V]}const u=Object.keys(this.nodesByDepth).map(b=>parseInt(b,10)).sort(Uy);for(const b of u){const _=this.nodesByDepth[b];for(const z of _){const V=z.outboundLayer,at=z.inputTensors,Et=z.outputTensors,St=new Array;for(const Tt of at)Tt.id in o&&St.push(o[Tt.id]);if(St.length===at.length){let Tt={},Wt,le,ye,Qe;if(z.callArgs!=null&&(Tt=z.callArgs),St.length===1){const[$e,Xe]=St[0];Tt.mask==null&&(Tt.mask=Xe),ye=Ql(V.call($e,Tt)),Qe=Ql(V.computeMask($e,Xe)),Wt=[$e],le=[Xe]}else Wt=St.map($e=>$e[0]),le=St.map($e=>$e[1]),Tt.mask==null&&(Tt.mask=le),ye=Ql(V.call(Wt,Tt)),Qe=Ql(V.computeMask(Wt,le));if(V.activityRegularizer)throw new Xs("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let $e=0;$e<Et.length;++$e){const Xe=Et[$e],Rn=ye[$e],Cn=Qe[$e];o[Xe.id]=[Rn,Cn]}}}}const h=[],p=[],g=[];for(const b of this.outputs){Cd(b.id in o,`Could not compute output ${b.name} : ${b.id}`);const[_,z]=o[b.id];g.push(_.shape),h.push(_),p.push(z)}return[h,p,g]}buildNodeConversionMap(t){const n={};let o;for(const u of this.layers){o=u instanceof Td?1:0;for(let h=0;h<u.inboundNodes.length;h++){const p=Td.nodeKey(u,h);this.containerNodes.has(p)&&(n[p]=o,o+=1)}}return n}getLayer(t,n){if(n!=null){if(this.layers.length<=n)throw new Kr(`Was asked to retrieve layer at index ${n}, but model only has ${this.layers.length} layer(s).`);return this.layers[n]}else if(t==null)throw new Kr("Provide either a layer name or layer index");for(const o of this.layers)if(o.name===t)return o;throw new Kr(`No such layer: ${t}`)}calculateLosses(){return Vn(()=>{const t=[];for(const n of this.layers)for(let o=0;o<n.inboundNodes.length;++o){const u=Td.nodeKey(n,o);this.containerNodes.has(u)&&t.push(...n.calculateLosses())}return t})}getConfig(){const t={name:this.name},n=this.buildNodeConversionMap(this.layers),o=[];for(const p of this.layers){const g=p.getClassName(),b=p.getConfig(),_=[];for(let V=0;V<p.inboundNodes.length;V++){const at=p.inboundNodes[V],Et=Td.nodeKey(p,V);let St={};if(this.containerNodes.has(Et)){if(at.callArgs)try{JSON.stringify(at.callArgs),St=at.callArgs}catch(Tt){console.warn(`Layer ${p.name} was passed non-serializable keyword arguments: ${at.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),St={}}if(at.inboundLayers.length>0){const Tt=[];for(let Wt=0;Wt<at.inboundLayers.length;Wt++){const le=at.inboundLayers[Wt],ye=at.nodeIndices[Wt],Qe=at.tensorIndices[Wt],$e=Td.nodeKey(le,ye);let Xe=n[$e];Xe==null&&(Xe=0),Tt.push([le.name,Xe,Qe,St])}_.push(Tt)}}}const z={};z.name=p.name,z.className=g,z.config=b,z.inboundNodes=_,o.push(z)}t.layers=o;const u=[];for(let p=0;p<this.inputLayers.length;p++){const g=this.inputLayers[p],b=this.inputLayersNodeIndices[p],_=Td.nodeKey(g,b);if(!this.containerNodes.has(_))continue;let z=n[_];z==null&&(z=0);const V=this.inputLayersTensorIndices[p];u.push([g.name,z,V])}t.inputLayers=u;const h=[];for(let p=0;p<this.outputLayers.length;p++){const g=this.outputLayers[p],b=this.outputLayersNodeIndices[p],_=Td.nodeKey(g,b);if(!this.containerNodes.has(_))continue;let z=n[_];z==null&&(z=0);const V=this.outputLayersTensorIndices[p];h.push([g.name,z,V])}return t.outputLayers=h,t}static fromConfig(t,n,o={},u=!1){const h={},p={};function g(Wt,le){Wt.name in p?p[Wt.name].push(le):p[Wt.name]=[le]}function b(Wt,le){const ye=[];let Qe;for(const $e of le){const Xe=$e[0],Rn=$e[1],Cn=$e[2];if(Qe=$e[3]==null?{}:$e[3],!(Xe in h)){g(Wt,le);return}const mr=h[Xe];if(mr.inboundNodes.length<=Rn){g(Wt,le);return}const zr=mr.inboundNodes[Rn];ye.push(zr.outputTensors[Cn])}ye.length>0&&Wt.apply(Mh(ye),Qe)}function _(Wt){const le=Wt.name,ye=ze(Wt,n.customObjects!=null?n.customObjects:{});ye.setFastWeightInitDuringBuild(u),h[le]=ye,Wt.inboundNodes.forEach($e=>{if(!($e instanceof Array))throw new Kr(`Corrupted configuration, expected array for nodeData: ${$e}`);g(ye,$e)})}const z=n.name,V=n.layers;for(const Wt of V)_(Wt);for(;!q_(p);)for(const Wt of V){const le=h[Wt.name];if(le.name in p){const ye=p[le.name];delete p[le.name];for(const Qe of ye)b(le,Qe)}}const at=[],Et=[],St=n.inputLayers;for(const Wt of St){const le=Wt[0],ye=Wt[1],Qe=Wt[2];Cd(le in h);const Xe=h[le].inboundNodes[ye].outputTensors;at.push(Xe[Qe])}const Tt=n.outputLayers;for(const Wt of Tt){const le=Wt[0],ye=Wt[1],Qe=Wt[2];Cd(le in h);const Xe=h[le].inboundNodes[ye].outputTensors;Et.push(Xe[Qe])}return new t({inputs:at,outputs:Et,name:z})}get stateful(){if(this._stateful)throw new Kr("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){Vn(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ax(r,t,n){const o=t.length;if(r==null||Array.isArray(r)&&r.length===0)return t.map(u=>null);if(o===1)return Array.isArray(r)&&r.length===1?r:typeof r=="object"&&t[0]in r?[r[t[0]]]:[r];if(Array.isArray(r)){if(r.length!==o)throw new Error(`Provided ${n} is an array of ${r.length} element(s), but the model has ${o} outputs. Make sure a set of weights is provided for each model output.`);return r}else if(typeof r=="object"&&Object.keys(r).length>0&&typeof r[Object.keys(r)[0]]=="object"){const u=[];return t.forEach(h=>{h in r?u.push(r[h]):u.push(null)}),u}else throw new Error(`The model has multiple (${o}) outputs, so ${n} must be either an array with ${o} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(r)}`)}function ix(r,t){return ax(r,t,"classWeight")}function SI(r,t){return ax(r,t,"sampleWeight")}function JA(r,t,n,o){return jr(this,null,function*(){if(t!=null||o!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const u=Vn(()=>{if(r.shape.length===1)return r.clone();if(r.shape.length===2)if(r.shape[1]>1){const g=1;return r.argMax(g)}else{if(r.shape[1]===1)return r.reshape([r.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${r.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${r.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),h=Array.from(yield u.data());M(u);const p=[];return h.forEach(g=>{if(n[g]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${g} exists in the data but not in classWeight`);p.push(n[g])}),ad(p,"float32")}else return null})}function WD(r,t){return Hn(r,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const VD=32;function tM(r,t){let n,o;const u=t;n=u.xs,o=u.ys,bt(n!=null&&o!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const h=eM("input",r.inputNames,n),p=eM("output",r.outputNames,o),g=h[0].shape[0];bt(h.length===r.inputs.length,()=>`LayersModel has ${r.inputs.length} inputs, but the dataset provides ${h.length} inputs.  (Expected input keys: ${JSON.stringify(r.inputNames)})`),bt(p.length===r.outputs.length,()=>`LayersModel has ${r.outputs.length} outputs, but the dataset provides ${p.length} outputs.  (Expected output keys: ${JSON.stringify(r.outputNames)})`);for(let b=0;b<h.length;b++)bt(h[b].shape[0]===g,()=>`Batch size mismatch: input ${r.inputNames[b]} has ${h[b].shape[0]}; expected  ${g} based on input ${r.inputNames[0]}.`);for(let b=0;b<p.length;b++)bt(p[b].shape[0]===g,()=>`Batch size mismatch: output ${r.outputNames[b]} has ${p[b].shape[0]}; expected  ${g} based on input ${r.inputNames[0]}.`);return{xs:h,ys:p}}function eM(r,t,n){if(n instanceof Nn)return[n];if(Array.isArray(n))return bt(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${r} keys ${t}.`),n;{const o=[];for(const u of t){if(n[u]==null)throw new Kr(`The feature data generated by the dataset lacks the required ${r} key '${u}'.`);o.push(n[u])}return o}}function jD(r){if(r.length===3)throw new Xs("Validation with sample weights is not implemented yet.");return{xs:r[0],ys:r[1]}}function HD(r,t,n){return jr(this,null,function*(){const o=n.batchesPerEpoch!=null;if(bt(r.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),bt(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),bt(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),bt(!o||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),bt(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0;try{const u=n.validationData!=null;let h,p;if(u)if(nM(n.validationData))bt(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const Wt=jD(n.validationData);h=Wt.xs,p=Wt.ys}const g=r.makeTrainFunction(),b=r.getDedupedMetricsNames();let _;u?_=b.slice().concat(b.map(Wt=>"val_"+Wt)):_=b.slice();const z=Jt(n.callbacks,n.yieldEvery),V=n.verbose==null?1:n.verbose,{callbackList:at,history:Et}=je(z,V,n.epochs,null,null,XD(t,n),null,u,_);at.setModel(r),r.history=Et,yield at.onTrainBegin(),r.stopTraining_=!1;let St=n.initialEpoch==null?0:n.initialEpoch,Tt=yield t.iterator();for(;St<n.epochs;){const Wt={};yield at.onEpochBegin(St);let le=0,ye=0;for(o||(Tt=yield t.iterator());o?le<n.batchesPerEpoch:!0;){const Qe=yield Tt.next();if(o&&Qe.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${le} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(Qe.value!=null){const{xs:$e,ys:Xe}=tM(r,Qe.value),Rn={};Rn.batch=ye,Rn.size=$e[0].shape[0],yield at.onBatchBegin(ye,Rn);const Cn=[];if(n.classWeight!=null){const ta=ix(n.classWeight,r.outputNames);for(let Ma=0;Ma<ta.length;++Ma)Cn.push(yield JA(Xe[Ma],null,ta[Ma]))}const mr=$e.concat(Xe).concat(Cn),zr=g(mr);M(mr);for(let ta=0;ta<b.length;++ta){const Ma=b[ta],Za=zr[ta];Rn[Ma]=Za,q(Za)}yield at.onBatchEnd(ye,Rn),G(Rn),ye++,le++}if(o?le>=n.batchesPerEpoch:Qe.done){if(u){let $e;nM(n.validationData)?$e=Ql(yield r.evaluateDataset(n.validationData,{batches:n.validationBatches})):$e=Ql(r.evaluate(h,p,{batchSize:n.validationBatchSize==null?VD:n.validationBatchSize,verbose:0}));for(let Xe=0;Xe<r.metricsNames.length;++Xe)Wt[`val_${r.metricsNames[Xe]}`]=$e[Xe]}break}if(r.stopTraining_)break}if(yield at.onEpochEnd(St,Wt),St++,r.stopTraining_)break}return yield at.onTrainEnd(),yield r.history.syncData(),r.history}finally{r.isTraining=!1}})}function XD(r,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(r.size)&&(n=r.size),n}function nM(r){return typeof r.iterator=="function"}function YD(r){return typeof r.next=="function"}function KD(r,t,n){return jr(this,null,function*(){n=n||{};const o=n.batches!=null,u=r.testFunction;let h=[];if(n.verbose>0)throw new Xs("Verbose mode is not implemented yet.");bt(!o||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const p=YD(t)?t:yield t.iterator();let g=0,b=0;for(;o?b<n.batches:!0;){const _=yield p.next();if(h=Vn(()=>{if(_.value){const{xs:z,ys:V}=tM(r,_.value),at=z.concat(V),Et=Vn(()=>u(at));if(M(at),b===0)for(let Tt=0;Tt<Et.length;++Tt)h.push(zi(0));const St=at[0].shape[0];for(let Tt=0;Tt<Et.length;++Tt){const Wt=Et[Tt],le=h[Tt];h[Tt]=Vn(()=>En(h[Tt],Hn(St,Wt))),b>0&&M(le)}M(Et),g+=St,++b}return h}),_.done){o&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let _=0;_<h.length;++_){const z=h[_];h[_]=or(h[_],g),M(z)}return Mh(h)})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function CI(r){bt(r>0&&Number.isInteger(r),()=>`batchSize is required to be a positive integer, but got ${r}`)}function ox(r,t,n){return r==null?[null]:Array.isArray(r)?r.map(o=>Xg(o,t,n-t)):Xg(r,t,n-t)}function _I(r,t){return Vn(()=>r==null?null:Array.isArray(r)?r.map(n=>_I(n,t)):AE(r,t.dtype==="int32"?t:t.toInt()))}function II(r,t){const n=[];let o=0,u=null;for(;o<r;)u=o+t,u>=r&&(u=r),n.push([o,u]),o=u;return n}function ZD(r,t,n,o,u,h,p,g,b,_,z,V,at,Et,St){return jr(this,null,function*(){u==null&&(u=32),h==null&&(h=1),z==null&&(z=!0),at==null&&(at=0);let Tt=!1;if(b!=null&&_!=null&&(Tt=!0),St!=null&&(Tt=!0,Et==null))throw new Kr("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const Wt=r.checkNumSamples(n,u,Et,"steps_per_epoch");let le;Wt!=null&&(le=Fp(0,Wt)),p==null&&(p=1);const{callbackList:ye,history:Qe}=je(g,p,h,at,Wt,Et,u,Tt,V);ye.setModel(r),r.history=Qe,yield ye.onTrainBegin(),r.stopTraining_=!1;for(let $e=at;$e<h;++$e){yield ye.onEpochBegin($e);const Xe={};if(Et!=null)throw new Xs("stepsPerEpoch mode is not implemented yet.");{if(z==="batch")throw new Xs("batch shuffling is not implemneted yet");z&&Be(le);const Rn=ad(le),Cn=II(Wt,u);for(let mr=0;mr<Cn.length;++mr){const zr={};if(yield ye.onBatchBegin(mr,zr),Vn(()=>{const ta=Cn[mr][0],Ma=Cn[mr][1],Za=Xg(Rn,ta,Ma-ta);zr.batch=mr,zr.size=Ma-ta;const Ka=_I(n,Za),ni=t(Ka);for(let Ua=0;Ua<o.length;++Ua){const Ba=o[Ua],mi=ni[Ua];zr[Ba]=mi,q(mi)}if(mr===Cn.length-1&&Tt){const Ua=r.testLoop(b,_,u);for(let Ba=0;Ba<o.length;++Ba){const mi=o[Ba],ti=Ua[Ba];q(ti),Xe["val_"+mi]=ti}}}),yield ye.onBatchEnd(mr,zr),G(zr),r.stopTraining_)break}Rn.dispose()}if(yield ye.onEpochEnd($e,Xe),r.stopTraining_)break}return yield ye.onTrainEnd(),yield r.history.syncData(),r.history})}function qD(u,h,p){return jr(this,arguments,function*(r,t,n,o={}){if(r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0;let g,b,_,z,V,at,Et;try{const St=o.batchSize==null?32:o.batchSize;CI(St);const Tt=!1,Wt=yield r.standardizeUserData(t,n,o.sampleWeight,o.classWeight,Tt,St);g=Wt[0],b=Wt[1],Et=Wt[2];let le=!1,ye;if(o.validationData!=null&&o.validationData.length>0){if(le=!0,o.validationData.length===2)_=o.validationData[0],z=o.validationData[1];else throw o.validationData.length===3?new Xs("validationData including sample weights is not supported yet."):new Kr(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${o.validationData} is invalid.`);const ta=!0,Ma=yield r.standardizeUserData(_,z,null,null,ta,St);V=Ma[0],at=Ma[1],ye=V.concat(at)}else if(o.validationSplit!=null&&o.validationSplit>0&&o.validationSplit<1){le=!0;const ta=Math.floor(g[0].shape[0]*(1-o.validationSplit)),Ma=g[0].shape[0];V=ox(g,ta,Ma),g=ox(g,0,ta),at=ox(b,ta,Ma),b=ox(b,0,ta),ye=V.concat(at)}else o.validationSteps!=null&&(le=!0);const Qe=g.concat(b).concat(Et);r.checkTrainableWeightsConsistency();const $e=r.makeTrainFunction(),Xe=r.getDedupedMetricsNames();let Rn,Cn;le?(r.makeTestFunction(),Rn=r.testFunction,Cn=Xe.slice().concat(Xe.map(ta=>"val_"+ta))):(Rn=null,ye=[],Cn=Xe.slice());const mr=Jt(o.callbacks,o.yieldEvery);return yield ZD(r,$e,Qe,Xe,St,o.epochs,o.verbose,mr,Rn,ye,o.shuffle,Cn,o.initialEpoch,null,null)}finally{r.isTraining=!1,D0(g,t),D0(b,n),D0(V,_),D0(at,z),Et!=null&&M(Et)}})}function rM(r){const t=[];r instanceof Nn&&(r=[r]);for(let n=0;n<r.length;++n){const o=r[n];if(o.rank===1)t.push(mg(o,1));else{if(o.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(o)}}return t}function D0(r,t){if(r==null)return;const n=[];if(t instanceof Nn)n.push(t.id);else if(Array.isArray(t))t.forEach(u=>n.push(u.id));else if(t!=null)for(const u in t){const h=t[u];n.push(h.id)}const o=[];if(r instanceof Nn)n.indexOf(r.id)===-1&&o.push(r);else if(Array.isArray(r))r.forEach(u=>{n.indexOf(u.id)===-1&&o.push(u)});else if(r!=null)for(const u in r){const h=r[u];n.indexOf(h.id)===-1&&o.push(h)}o.forEach(u=>{u.isDisposed||u.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function QD(r){return r instanceof Nn}function TI(r){return Array.isArray(r)}function aM(r){return!QD(r)&&!TI(r)}function iM(r,t,n,o=!0,u=""){if(t==null||t.length===0){if(r!=null){let p=!1;if(TI(r)&&r.length>0)p=!0;else if(aM(r)){for(const g in r)if(r.hasOwnProperty(g)){p=!0;break}}else p=!0;if(p)throw new Kr(`Error when checking model ${u} expected no data, but got ${r}`)}return[]}if(r==null)return t.map(p=>null);let h;if(aM(r)){r=r,h=[];for(const p of t){if(r[p]==null)throw new Kr(`No data provided for "${p}". Need data for each key in: ${t}`);h.push(r[p])}}else if(TI(r)){if(r=r,r.length!==t.length)throw new Kr(`Error when checking model ${u}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${r}`);h=r}else{if(r=r,t.length>1)throw new Kr(`The model ${u} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${r.shape}`);h=[r]}if(h=rM(h),n!=null)for(let p=0;p<t.length;++p){if(n[p]==null)continue;const g=h[p];if(g.shape.length!==n[p].length)throw new Kr(`Error when checking ${u}: expected ${t[p]} to have ${n[p].length} dimension(s). but got array with shape ${g.shape}`);for(let b=0;b<n[p].length;++b){if(b===0&&!o)continue;const _=g.shape[b],z=n[p][b];if(z!=null&&z>=0&&_!==z)throw new Kr(`Error when checking ${u}: expected ${t[p]} to have shape [${n[p]}], but got array with shape [${g.shape}].`)}}return h}function JD(r,t,n){const o=vg(r.map(h=>h.shape[0]));o.sort();const u=vg(t.map(h=>h.shape[0]));if(u.sort(),o.length>1)throw new Kr(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(r.map(h=>h.shape))}`);if(u.length>1)throw new Kr(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(h=>h.shape))}`);if(o.length>0&&u.length>0&&!Bn(o,u))throw new Kr(`Input Tensors should have the same number of samples as target Tensors. Found ${o[0]} input sample(s) and ${u[0]} target sample(s).`)}function tO(r,t,n){const o=[Fn,Ya,Pi];for(let u=0;u<r.length;++u){const h=r[u],p=t[u],g=n[u];if(p!=null){if(p===Pi&&h.shape[h.shape.length-1]===1)throw new Kr(`You are passing a target array of shape ${h.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(o.indexOf(p)!==-1){const b=h.shape.slice(1),_=g.slice(1);for(let z=0;z<b.length;++z){const V=b[z],at=_[z];if(at!=null&&V!==at)throw new Kr(`A target Tensor with shape ${h.shape} was passed for an output of shape ${g}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function oM(r,t,n,o=!0,u=""){let h;if(Array.isArray(r)){if(r.length!==t.length)throw new Kr(`Error when checking model ${u}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${r.length} Tensors(s).`);h=r}else{if(t.length>1)throw new Kr(`The model expects ${t.length} ${u} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(r.shape)}.`);h=[r]}if(n!=null)for(let p=0;p<t.length;++p){if(n[p]==null)continue;const g=h[p];if(g.shape.length!==n[p].length)throw new Kr(`Error when checking ${u}: expected ${t[p]} to have ${n[p].length} dimension(s), but got array with shape ${JSON.stringify(g.shape)}`);for(let b=0;b<n[p].length;++b){if(b===0&&!o)continue;const _=g.shape[b],z=n[p][b];if(z!=null&&z!==_)throw new Kr(`Error when checking ${u}: expected ${t[p]} to have shape ${JSON.stringify(n[p])} but got array with shape ${JSON.stringify(g.shape)}.`)}}}function eO(r,t){if(r==null||Array.isArray(r)&&r.length===0)return t.map(o=>[]);let n;if(typeof r=="string"||typeof r=="function")n=[r];else if(Array.isArray(r)||typeof r=="object")n=r;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${r}`);if(Array.isArray(n))return t.map(o=>n);{const o=[];for(const u of t){let h=n.hasOwnProperty(u)?n[u]:[];Array.isArray(h)||(h=[h]),o.push(h)}return o}}const nO="layers-model";class Jg extends Td{constructor(t){super(t);this.isTraining=!1}summary(t,n,o=console.log){if(!this.built)throw new Kr("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");GE(this,t,n,o)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=bg(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof zu))throw new Kr("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const p in t.loss)if(this.outputNames.indexOf(p)===-1)throw new Kr(`Unknown entry in loss dictionary: "${p}". Only expected the following keys: ${this.outputNames}`);for(const p of this.outputNames)t.loss[p]==null&&console.warn(`Output "${p}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${p} during training`),n.push(Vc(t.loss[p]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new Kr(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);n=t.loss.map(g=>Vc(g))}else{const p=Vc(t.loss);this.outputs.forEach(g=>{n.push(p)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let p=0;p<this.outputs.length;++p){const g=this.internalOutputShapes[p],b=this.outputNames[p];this.feedOutputNames.push(b),this.feedOutputShapes.push(g),this.feedLossFns.push(this.lossFunctions[p])}const o=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],gg("loss",()=>{for(let p=0;p<this.outputs.length;++p){if(o.indexOf(p)!==-1)continue;const g=this.lossFunctions[p];this.outputs.length>1&&(this.metricsTensors.push([g,p]),this.metricsNames.push(this.outputNames[p]+"_loss"))}});const u=eO(t.metrics,this.outputNames),h=(p,g,b)=>{this.outputNames.length>1&&(g=this.outputNames[p]+"_"+g),this.metricsNames.push(g),this.metricsTensors.push([b,p])};gg("metric",()=>{for(let p=0;p<this.outputs.length;++p){if(o.indexOf(p)!==-1)continue;const g=u[p];(_=>{const z="";let V,at,Et;for(const St of _){if(typeof St=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(St)!==-1){const Wt=this.internalOutputShapes[p];Wt[Wt.length-1]===1||this.lossFunctions[p]===Ya?["accuracy","acc"].indexOf(St)!==-1?at=jc:["crossentropy","ce"].indexOf(St)!==-1&&(at=Zu):this.lossFunctions[p]===Ni?["accuracy","acc"].indexOf(St)!==-1?at=Il:["crossentropy","ce"].indexOf(St)!==-1&&(at=Zg):["accuracy","acc"].indexOf(St)!==-1?at=Oh:["crossentropy","ce"].indexOf(St)!==-1&&(at=Dc);let le;["accuracy","acc"].indexOf(St)!==-1?le="acc":["crossentropy","ce"].indexOf(St)!==-1&&(le="ce"),Et=at,V=z+le}else Et=ap(St),V=z+Id(St);let Tt;gg(V,()=>{Tt=Et}),h(p,V,Tt)}})(g)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,n,o={}){const u=o.batchSize==null?32:o.batchSize;CI(u);const h=!0,p=this.standardizeUserDataXY(t,n,h,u);try{const g=p[0].concat(p[1]);this.makeTestFunction();const b=this.testFunction,_=this.testLoop(b,g,u,o.verbose,o.steps);return Mh(_)}finally{D0(p[0],t),D0(p[1],n)}}evaluateDataset(t,n){return jr(this,null,function*(){return this.makeTestFunction(),KD(this,t,n)})}checkNumSamples(t,n,o,u="steps"){let h;if(o!=null){if(h=null,n!=null)throw new Kr(`If ${u} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(t!=null)Array.isArray(t)?h=t[0].shape[0]:h=t.shape[0];else throw new Kr(`Either the input data should have a defined shape, or ${u} shoud be specified.`);return h}execute(t,n){if(Array.isArray(n)&&n.length===0)throw new Kr("`outputs` is an empty Array, which is not allowed.");const o=Array.isArray(n),u=o?n:[n],h=this.retrieveSymbolicTensors(u),p=new Gp;if(t instanceof Nn&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new Kr(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let b=0;b<this.inputs.length;++b)p.add(this.inputs[b],t[b])}else for(const b of this.inputs){const _=t[b.name];if(_==null)throw new Kr(`No value is provided for the model's input ${b.name}`);p.add(b,_)}const g=Oc(h,p);return o?g:g[0]}retrieveSymbolicTensors(t){const n=Gg(null,t.length);let o=t.length;for(const u of this.layers){const h=Array.isArray(u.output)?u.output:[u.output],p=h.map(g=>g.name);for(let g=0;g<t.length;++g){const b=p.indexOf(t[g]);if(b!==-1&&(n[g]=h[b],o--),o===0)break}if(o===0)break}if(o>0){const u=[];throw n.forEach((h,p)=>{h==null&&u.push(t[p])}),new Kr(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(u)}`)}return n}predictLoop(t,n=32,o=!1){return Vn(()=>{const u=this.checkNumSamples(t);if(o)throw new Xs("Verbose predictLoop() is not implemented yet.");const h=II(u,n),p=this.outputs.map(g=>[]);for(let g=0;g<h.length;++g)Vn(()=>{const _=h[g][0],z=h[g][1],V=ox(t,_,z),at=[];if(Array.isArray(V))for(let St=0;St<V.length;++St)at.push({key:this.inputs[St],value:V[St]});else at.push({key:this.inputs[0],value:V});const Et=new Gp(at);return Oc(this.outputs,Et)}).forEach((_,z)=>p[z].push(_));return Mh(p.map(g=>vt(g,0)))})}predict(t,n={}){const o=rM(t);oM(o,this.inputNames,this.feedInputShapes,!1);try{const u=n.batchSize==null?32:n.batchSize;return CI(u),this.predictLoop(o,u)}finally{D0(o,t)}}predictOnBatch(t){oM(t,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,n)}standardizeUserDataXY(t,n,o=!0,u){if(this.optimizer_==null)throw new Jd("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const h=[];for(let p=0;p<this.feedOutputShapes.length;++p){const g=this.feedOutputShapes[p];this.feedLossFns[p]===Ni?h.push(g.slice(0,g.length-1).concat([1])):h.push(g)}if(t=iM(t,this.feedInputNames,this.feedInputShapes,!1,"input"),n=iM(n,this.feedOutputNames,h,!1,"target"),JD(t,n,null),tO(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&u!=null&&u>0&&t[0].shape[0]%u!=0)throw new Kr(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${u}. Found: ${t[0].shape[0]} sample(s).`);return[t,n]}standardizeUserData(t,n,o,u,h=!0,p){return jr(this,null,function*(){const[g,b]=this.standardizeUserDataXY(t,n,h,p);if(o!=null)throw new Error("sample weight is not supported yet.");let _=null;if(u!=null){const z=ix(u,this.outputNames);_=[];for(let V=0;V<z.length;++V)_.push(yield JA(b[V],null,z[V]))}return[g,b,_]})}testLoop(t,n,o,u=0,h){return Vn(()=>{const p=this.checkNumSamples(n,o,h,"steps"),g=[];if(u>0)throw new Xs("Verbose mode is not implemented yet.");if(h!=null)throw new Xs("steps mode in testLoop() is not implemented yet");{const b=II(p,o),_=ad(Fp(0,p));for(let z=0;z<b.length;++z){const V=b[z][0],at=b[z][1],Et=Xg(_,V,at-V),St=_I(n,Et),Tt=t(St);if(z===0)for(let Wt=0;Wt<Tt.length;++Wt)g.push(zi(0));for(let Wt=0;Wt<Tt.length;++Wt){const le=Tt[Wt];g[Wt]=En(g[Wt],Hn(at-V,le))}}for(let z=0;z<g.length;++z)g[z]=or(g[z],p)}return g})}getDedupedMetricsNames(){const t=this.metricsNames,n=[];for(let o=0;o<t.length;++o){const u=t[o];let h=u;dE(t,u)>1&&(h+=`_${dE(t.slice(0,o),u)}`),n.push(h)}return n}makeTrainFunction(){return t=>{const n=[],o=t.slice(0,this.inputs.length),u=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),h=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),p=[],g=()=>{const V=[];for(let Tt=0;Tt<this.inputs.length;++Tt)V.push({key:this.inputs[Tt],value:o[Tt]});const at=new Gp(V),Et=Oc(this.outputs,at,{training:!0});let St;for(let Tt=0;Tt<this.lossFunctions.length;++Tt){let le=this.lossFunctions[Tt](u[Tt],Et[Tt]);h[Tt]!=null&&(le=WD(le,h[Tt]));const ye=nc(le);n.push(ye),Tt===0?St=le:St=En(St,le)}for(let Tt=0;Tt<this.metricsTensors.length;++Tt){let Wt;if(this.outputs.length>1&&Tt<this.outputs.length)Wt=n[Tt];else{const le=this.metricsTensors[Tt][0],ye=this.metricsTensors[Tt][1];Wt=nc(le(u[ye],Et[ye]))}q(Wt),p.push(Wt)}return St=nc(St),this.calculateLosses().forEach(Tt=>{St=En(St,Tt)}),St},b=this.collectedTrainableWeights.map(V=>V.read()),_=!0;return[this.optimizer_.minimize(g,_,b)].concat(p)}}makeTestFunction(){this.testFunction=t=>Vn(()=>{const n=[];let o;const u=t.slice(0,this.inputs.length),h=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),p=[];for(let _=0;_<this.inputs.length;++_)p.push({key:this.inputs[_],value:u[_]});const g=new Gp(p),b=Oc(this.outputs,g);for(let _=0;_<this.lossFunctions.length;++_){const z=this.lossFunctions[_],V=nc(z(h[_],b[_]));_===0?o=V:o=En(o,V),n.push(o)}for(let _=0;_<this.metricsTensors.length;++_){const z=this.metricsTensors[_][0],V=this.metricsTensors[_][1],at=nc(z(h[V],b[V]));n.push(at)}return n})}fit(u,h){return jr(this,arguments,function*(t,n,o={}){return qD(this,t,n,o)})}fitDataset(t,n){return jr(this,null,function*(){return HD(this,t,n)})}trainOnBatch(t,n){return jr(this,null,function*(){const o=yield this.standardizeUserData(t,n),u=o[0],h=o[1],g=this.makeTrainFunction()(u.concat(h)),b=[];for(const _ of g){const z=yield _.data();b.push(z[0])}return M(g),Mh(b)})}getNamedWeights(t){const n=[],o=t!=null&&t.trainableOnly,u=o?this.trainableWeights:this.weights,h=this.getWeights(o);for(let p=0;p<u.length;++p)o&&!u[p].trainable||n.push({name:u[p].originalName,tensor:h[p]});return n}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=Ga().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=n-Ga().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=jv(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(n=>jv(n))}else{const n=Object.keys(this.loss);t={};const o=this.loss;for(const u of n)if(typeof o[u]=="string")t[u]=jv(o[u]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[jv(Id(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>jv(Id(t)));{const t={};for(const n in this.metrics)t[n]=jv(Id(this.metrics[n]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=k0(t.optimizer_config),o=ze(n);let u;if(typeof t.loss=="string")u=Nh(t.loss);else if(Array.isArray(t.loss))u=t.loss.map(p=>Nh(p));else if(t.loss!=null){u={};for(const p in t.loss)u[p]=Nh(t.loss[p])}let h;if(Array.isArray(t.metrics))h=t.metrics.map(p=>Nh(p));else if(t.metrics!=null){h={};for(const p in t.metrics)h[p]=Nh(t.metrics[p])}this.compile({loss:u,metrics:h,optimizer:o})}save(t,n){return jr(this,null,function*(){if(typeof t=="string"){const _=Dd(t);if(_.length===0)throw new Kr(`Cannot find any save handlers for URL '${t}'`);if(_.length>1)throw new Kr(`Found more than one (${_.length}) save handlers for URL '${t}'`);t=_[0]}if(t.save==null)throw new Kr("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const o=yield Pc(this.getNamedWeights(n)),u=!1,h=null,g={modelTopology:this.toJSON(h,u),format:nO,generatedBy:`TensorFlow.js tfjs-layers v${qg}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){g.trainingConfig=this.getTrainingConfig();const _="optimizer",{data:z,specs:V}=yield Pc(yield this.optimizer.getWeights(),_);o.specs.push(...V),o.data=Kf([o.data,z])}if(this.userDefinedMetadata!=null){const _=!0;ip(this.userDefinedMetadata,this.name,_),g.userDefinedMetadata=this.userDefinedMetadata}return g.weightData=o.data,g.weightSpecs=o.specs,t.save(g)})}setUserDefinedMetadata(t){ip(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}Jg.className="Model",li(Jg);class sM extends Jg{}sM.className="Functional",li(sM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rO(r,t){return jr(this,null,function*(){"modelTopology"in r||(r={modelTopology:r}),r=r;let n=r.modelTopology;n.model_config!=null&&(n=n.model_config);const o=k0(n),u=ze(o,t);if(r.weightsManifest!=null){const h=yield Pd(r.weightsManifest,r.pathPrefix,u.weights.map(g=>g.originalName)),p={};for(const g of u.weights)p[g.originalName]=h[g.originalName];u.loadWeights(p),M(h)}return u})}function aO(r,t){return jr(this,null,function*(){if(t==null&&(t={}),typeof r=="string"){const n=Bh(r,t);if(n.length===0)n.push(gd(r,t));else if(n.length>1)throw new Kr(`Found more than one (${n.length}) load handlers for URL '${r}'`);r=n[0]}return iO(r,void 0,t)})}function iO(r,t,n){return jr(this,null,function*(){if(n==null&&(n={}),r.load==null)throw new Kr("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const o=yield r.load();let u=o.modelTopology;u.model_config!=null&&(u=u.model_config);const h=n.strict==null?!0:n.strict,p=o.weightData!=null&&o.weightSpecs!=null&&h,g=ze(k0(u),t,p),b=o.trainingConfig;if(b!=null&&g.loadTrainingConfig(b),o.userDefinedMetadata!=null&&g.setUserDefinedMetadata(o.userDefinedMetadata),o.weightData!=null){if(o.weightSpecs==null)throw new Kr("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:_,optimizerWeights:z}=oO(o.weightData,o.weightSpecs);g.loadWeights(_,h),g.optimizer!=null&&z.length>0&&(yield g.optimizer.setWeights(z)),M(_),M(z.map(V=>V.tensor))}return g})}function oO(r,t){const n=tc(r,t),o={},u=[];return t.forEach(h=>{h.group==="optimizer"?u.push({name:h.name,tensor:n[h.name]}):o[h.name]=n[h.name]}),{modelWeights:o,optimizerWeights:u}}class O0 extends Jg{constructor(t){super({inputs:[],outputs:[]});if(t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:N0("sequential_"),t.layers!=null)for(const n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(o=>o<0))throw new Kr(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const n=t instanceof O0||t instanceof Jg;let o;if(n){if(o=t,o.outputs.length!==1)throw new Kr("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(o.inputs.length!==1)throw new Kr("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new Kr("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const u=w({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(u)}if(n)this.outputs=o.outputs,this.inputs=o.inputs;else{if(t.inboundNodes.length!==1)throw new Kr(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new Kr("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=v(this.outputs[0])}this.inboundNodes=[],new i({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Gg(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(u=>u.shape),outputShapes:this.outputs[0].shape})}else{const u=t.apply(this.outputs[0]);if(Array.isArray(u))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[u],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if(Wl(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Jg({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,o=console.log){this.built||this.build(),super.summary(t,n,o)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,o={}){if(!this.built)throw new Jd("The model needs to be compiled before being used.");return this.model.evaluate(t,n,o)}evaluateDataset(t,n){return jr(this,null,function*(){if(!this.built)throw new Jd("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)})}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}fit(u,h){return jr(this,arguments,function*(t,n,o={}){if(!this.built)throw new Jd("The model needs to be compiled before being used.");return this.model.fit(t,n,o)})}fitDataset(t,n){return jr(this,null,function*(){if(!this.built)throw new Jd("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)})}trainOnBatch(t,n){return jr(this,null,function*(){return this.model.trainOnBatch(t,n)})}static fromConfig(t,n,o={},u=!1){let h,p={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new Kr("Legacy serialization format not supported yet.");h=n}else bt(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),h=n.layers,delete n.layers,p=n;const g=new t(p);if(!(g instanceof O0))throw new Xs(`Sequential.fromConfig called on non-Sequential input: ${g}`);for(const b of h){const z=ze(b,void 0,u);u&&z.setFastWeightInitDuringBuild(!0),g.add(z)}return g}set stopTraining(t){if(this.model==null)throw new Kr("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new Kr("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const n of this.layers){const o={};o.className=n.getClassName(),o.config=n.getConfig(),t.push(o)}return{name:this.name,layers:t}}}O0.className="Sequential",li(O0);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sO(r){return new Jg(r)}function uO(r){return new O0(r)}function lO(r,t){return t==null&&(t={}),aO(r,t)}function uM(r){return w(r)}function cO(r,t){Ce.registerCallbackConstructor(r,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class op extends _h{getConfig(){return{}}}class lM extends op{apply(t,n=1){return ME(t,n)}}lM.className="elu",li(lM);class cM extends op{apply(t){return Dg(t)}}cM.className="selu",li(cM);class fM extends op{apply(t){return td(t)}}fM.className="relu",li(fM);class hM extends op{apply(t){return Vn(()=>og(6,td(t)))}}hM.className="relu6",li(hM);class dM extends op{apply(t){return t}}dM.className="linear",li(dM);class pM extends op{apply(t){return Bt(t)}}pM.className="sigmoid",li(pM);class vM extends op{apply(t){return Zb(t)}}vM.className="hardSigmoid",li(vM);class gM extends op{apply(t){return hm(t)}}gM.className="softplus",li(gM);class mM extends op{apply(t){return NE(t)}}mM.className="softsign",li(mM);class yM extends op{apply(t){return be(t)}}yM.className="tanh",li(yM);class AI extends op{apply(t,n=-1){return n0(t,n)}}AI.className="softmax",li(AI);class bM extends op{apply(t,n=-1){return Q0(t,n)}}bM.className="logSoftmax",li(bM);class xM extends op{apply(t,n=1){return Vn(()=>Bt(t.mul(n)).mul(t))}}xM.className="swish",li(xM);function Nm(r){return r.getClassName()}function MI(r,t={}){return S0(r,of.getMap().classNameMap,t,"activation")}function km(r){if(r==null){const t={};return t.className="linear",t.config={},MI(t)}if(typeof r=="string"){const t={};return t.className=r,t.config={},MI(t)}else return r instanceof op?r:MI(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function NI(r){if(r!=null&&typeof r!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${r}`)}class wM extends _h{}class sx extends wM{constructor(t){super();NI(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return Vn(()=>{let n=Uc([1]);return this.hasL1&&(n=En(n,ss(Hn(this.l1,fl(t))))),this.hasL2&&(n=En(n,ss(Hn(this.l2,Ky(t))))),n.asScalar()})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,n){return new t({l1:n.l1,l2:n.l2})}}sx.className="L1L2",li(sx);function fO(r){return NI(r),new sx({l1:r!=null?r.l1:null,l2:0})}function hO(r){return NI(r),new sx({l2:r!=null?r.l2:null,l1:0})}const EM={l1l2:"L1L2"};function ac(r){return Lb(r)}function SM(r,t={}){return S0(r,of.getMap().classNameMap,t,"regularizer")}function Rc(r){if(r==null)return null;if(typeof r=="string"){const n={className:r in EM?EM[r]:r,config:{}};return SM(n)}else return r instanceof wM?r:SM(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kI extends l{constructor(t){super(t==null?{}:t);this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,n){t=vu(t);let o=td(t);return this.maxValue!=null&&(o=fi(o,0,this.maxValue)),o}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},n=super.getConfig();return Object.assign(t,n),t}}kI.className="ReLU",li(kI);class DI extends l{constructor(t){super(t==null?{}:t);this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const o=vu(t);return Hm(o,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}DI.className="LeakyReLU",li(DI);class OI extends l{constructor(t){super(t==null?{}:t);if(this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=hc(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Rc(t.alphaRegularizer),this.alphaConstraint=ff(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new Kr(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=Wl(t);const n=t.slice(1);if(this.sharedAxes!=null)for(const u of this.sharedAxes)n[u-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const o={};if(this.sharedAxes!=null)for(let u=1;u<t.length;++u)o[u]=t[u];this.inputSpec=[new c({ndim:t.length,axes:o})],this.built=!0}call(t,n){return t=vu(t),kg(t,this.alpha.read())}getConfig(){const t={alphaInitializer:fc(this.alphaInitializer),alphaRegularizer:ac(this.alphaRegularizer),alphaConstraint:cf(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(t,n),t}}OI.className="PReLU",li(OI);class RI extends l{constructor(t){super(t==null?{}:t);if(this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new Xs(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const o=vu(t);return fm(o)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}RI.className="ELU",li(RI);class LI extends l{constructor(t){super(t==null?{}:t);this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,n){const o=vu(t);return o.mul(jy(o.greater(this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},n=super.getConfig();return Object.assign(t,n),t}}LI.className="ThresholdedReLU",li(LI);class PI extends l{constructor(t){super(t==null?{}:t);this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new AI().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,n){const o=vu(t);return this.softmax(o,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}PI.className="Softmax",li(PI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function c1(r,t,n){if(typeof r=="number")return Gg(r,t);if(r.length!==t)throw new Kr(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${r.length} elements.`);for(let o=0;o<t;++o){const u=r[o];if(!CE(u))throw new Kr(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(r)} including a non-integer number ${u}`)}return r}function Xv(r,t,n,o,u=1){if(r==null)return r;const h=t+(t-1)*(u-1);let p;return n==="same"?p=r:p=r-h+1,Math.floor((p+o-1)/o)}function jE(r,t,n,o){if(r==null)return null;if(o==="valid")r=r*t+wv([n-t,0]);else if(o==="same")r=r*t;else throw new Kr(`Unsupport padding mode: ${o}.`);return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function FI(r,t){return Vn(()=>(bu(t),t==="channelsFirst"?mu(r,[0,2,3,1]):r))}function CM(r,t){return Vn(()=>(bu(t),t==="channelsFirst"?mu(r,[0,2,3,4,1]):r))}function _M(r,t,n,o=1,u="valid",h,p=1){return Vn(()=>{if(h==null&&(h=Qd()),bu(h),r.shape.length!==3)throw new Kr(`The input of a conv1dWithBias operation should be 3, but is ${r.shape.length} instead.`);if(t.shape.length!==3)throw new Kr(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new Kr(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(h==="channelsFirst"&&(r=mu(r,[0,2,1])),u==="causal")throw new Xs("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let g=Bo(r,t,o,u==="same"?"same":"valid","NWC",p);return n!=null&&(g=np(g,n)),g})}function q9(r,t,n=1,o="valid",u,h=1){return tidy(()=>(checkDataFormat(u),_M(r,t,null,n,o,u,h)))}function Q9(r,t,n=[1,1],o="valid",u,h){return tidy(()=>(checkDataFormat(u),BI(r,t,null,n,o,u,h)))}function BI(r,t,n,o=[1,1],u="valid",h,p,g=null){return Vn(()=>{if(h==null&&(h=Qd()),bu(h),r.rank!==3&&r.rank!==4)throw new Kr(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${r.rank}.`);if(t.rank!==3&&t.rank!==4)throw new Kr(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${r.rank}.`);let b=FI(r,h);if(u==="causal")throw new Xs("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return b=lb({x:b,filter:t,strides:o,pad:u==="same"?"same":"valid",dilations:p,dataFormat:"NHWC",bias:n,activation:g}),h==="channelsFirst"&&(b=mu(b,[0,3,1,2])),b})}function J9(r,t,n=[1,1,1],o="valid",u,h){return tidy(()=>(checkDataFormat(u),IM(r,t,null,n,o,u,h)))}function IM(r,t,n,o=[1,1,1],u="valid",h,p){return Vn(()=>{if(h==null&&(h=Qd()),bu(h),r.rank!==4&&r.rank!==5)throw new Kr(`conv3dWithBias expects input to be of rank 4 or 5, but received ${r.rank}.`);if(t.rank!==4&&t.rank!==5)throw new Kr(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${r.rank}.`);let g=CM(r,h);if(u==="causal")throw new Xs("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return g=nu(g,t,o,u==="same"?"same":"valid","NDHWC",p),n!=null&&(g=np(g,n)),h==="channelsFirst"&&(g=mu(g,[0,4,1,2,3])),g})}class HE extends l{constructor(t,n){super(n);if(this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",HE.verifyArgs(n),this.rank=t,bf(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Xs(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=c1(n.kernelSize,t,"kernelSize"),this.strides=c1(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,Uf(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,bu(this.dataFormat),this.activation=km(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=hc(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=ff(n.biasConstraint),this.biasRegularizer=Rc(n.biasRegularizer),this.activityRegularizer=Rc(n.activityRegularizer),this.dilationRate=c1(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new Kr(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new Kr(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new Kr(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(Cd("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!C0(t.kernelSize,"number",1,3))throw new Kr(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Nm(this.activation),useBias:this.useBias,biasInitializer:fc(this.biasInitializer),biasRegularizer:ac(this.biasRegularizer),activityRegularizer:ac(this.activityRegularizer),biasConstraint:cf(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}class f1 extends HE{constructor(t,n){super(t,n);this.kernel=null,f1.verifyArgs(n),this.filters=n.filters,bf(this.filters,"filters"),this.kernelInitializer=hc(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=ff(n.kernelConstraint),this.kernelRegularizer=Rc(n.kernelRegularizer)}build(t){t=Wl(t);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new Kr(`The channel dimension of the input should be defined. Found ${t[n]}`);const o=t[n],u=this.kernelSize.concat([o,this.filters]);this.kernel=this.addWeight("kernel",u,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:o}}],this.built=!0}call(t,n){return Vn(()=>{t=vu(t);let o;const u=this.bias==null?null:this.bias.read(),h=vE(this.activation.getClassName());if(h!=null&&this.rank===2)o=BI(t,this.kernel.read(),u,this.strides,this.padding,this.dataFormat,this.dilationRate,h);else{if(this.rank===1)o=_M(t,this.kernel.read(),u,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)o=BI(t,this.kernel.read(),u,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)o=IM(t,this.kernel.read(),u,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Xs("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(o=this.activation.apply(o))}return o})}computeOutputShape(t){t=Wl(t);const n=[],o=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let h=0;h<o.length;++h){const p=Xv(o[h],this.kernelSize[h],this.padding,this.strides[h],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[h]);n.push(p)}let u=[t[0]];return this.dataFormat==="channelsLast"?(u=u.concat(n),u.push(this.filters)):(u.push(this.filters),u=u.concat(n)),u}getConfig(){const t={filters:this.filters,kernelInitializer:fc(this.kernelInitializer),kernelRegularizer:ac(this.kernelRegularizer),kernelConstraint:cf(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new Kr(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class h1 extends f1{constructor(t){super(2,t);h1.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!C0(t.kernelSize,"number",1,2))throw new Kr(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}h1.className="Conv2D",li(h1);class ux extends f1{constructor(t){super(3,t);ux.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new Kr(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}ux.className="Conv3D",li(ux);class zI extends h1{constructor(t){super(t);if(this.inputSpec=[new c({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new Kr(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=Wl(t),t.length!==4)throw new Kr("Input should have rank 4; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new Kr("The channel dimension of the inputs should be defined. Found `None`.");const o=t[n],u=this.kernelSize.concat([this.filters,o]);this.kernel=this.addWeight("kernel",u,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new c({ndim:4,axes:{[n]:o}})],this.built=!0}call(t,n){return Vn(()=>{let o=vu(t);if(o.shape.length!==4)throw new Kr(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${o.shape.length}`);const u=o.shape,h=u[0];let p,g;this.dataFormat==="channelsFirst"?(p=2,g=3):(p=1,g=2);const b=u[p],_=u[g],z=this.kernelSize[0],V=this.kernelSize[1],at=this.strides[0],Et=this.strides[1],St=jE(b,at,z,this.padding),Tt=jE(_,Et,V,this.padding),Wt=[h,St,Tt,this.filters];this.dataFormat!=="channelsLast"&&(o=mu(o,[0,2,3,1]));let le=Nl(o,this.kernel.read(),Wt,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(le=mu(le,[0,3,1,2])),this.bias!=null&&(le=np(le,this.bias.read(),this.dataFormat)),this.activation!=null&&(le=this.activation.apply(le)),le})}computeOutputShape(t){t=Wl(t);const n=t.slice();let o,u,h;this.dataFormat==="channelsFirst"?(o=1,u=2,h=3):(o=3,u=1,h=2);const p=this.kernelSize[0],g=this.kernelSize[1],b=this.strides[0],_=this.strides[1];return n[o]=this.filters,n[u]=jE(n[u],b,p,this.padding),n[h]=jE(n[h],_,g,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}zI.className="Conv2DTranspose",li(zI);class TM extends f1{constructor(t,n){super(t,n);if(this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new Kr("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new Kr("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new Kr(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=hc(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Rc(n.depthwiseRegularizer),this.depthwiseConstraint=ff(n.depthwiseConstraint),this.pointwiseInitializer=hc(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Rc(n.pointwiseRegularizer),this.pointwiseConstraint=ff(n.pointwiseConstraint)}build(t){if(t=Wl(t),t.length<this.rank+2)throw new Kr(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null||t[n]<0)throw new Kr(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[n])}`);const o=t[n],u=this.kernelSize.concat([o,this.depthMultiplier]),h=[];for(let g=0;g<this.rank;++g)h.push(1);h.push(o*this.depthMultiplier,this.filters);const p=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",u,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,p,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",h,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,p,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,p,this.biasConstraint):this.bias=null,this.inputSpec=[new c({ndim:this.rank+2,axes:{[n]:o}})],this.built=!0}call(t,n){return Vn(()=>{t=vu(t);let o;if(this.rank===1)throw new Xs("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=mu(t,[0,2,3,1])),o=J1(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(o=np(o,this.bias.read(),this.dataFormat)),this.activation!=null&&(o=this.activation.apply(o)),this.dataFormat==="channelsFirst"&&(o=mu(o,[0,3,1,2])),o})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=fc(this.depthwiseInitializer),t.pointwiseInitializer=fc(this.pointwiseInitializer),t.depthwiseRegularizer=ac(this.depthwiseRegularizer),t.pointwiseRegularizer=ac(this.pointwiseRegularizer),t.depthwiseConstraint=cf(this.depthwiseConstraint),t.pointwiseConstraint=cf(this.pointwiseConstraint),t}}TM.className="SeparableConv";class $I extends TM{constructor(t){super(2,t)}}$I.className="SeparableConv2D",li($I);class lx extends f1{constructor(t){super(1,t);lx.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!C0(t.kernelSize,"number",1,1))throw new Kr(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}lx.className="Conv1D",li(lx);class GI extends l{constructor(t){super(t);typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,n){return Vn(()=>{if(t=vu(t),this.dataFormat==="channelsLast"){const o=T0(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return T0(o,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const o=T0(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return T0(o,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}GI.className="Cropping2D",li(GI);class UI extends l{constructor(t){super(t);this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,bu(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,bE(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const n=t[2]==null?null:this.size[0]*t[2],o=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],n,o]}else{const n=t[1]==null?null:this.size[0]*t[1],o=t[2]==null?null:this.size[1]*t[2];return[t[0],n,o,t[3]]}}call(t,n){return Vn(()=>{let o=vu(t);const u=o.shape;if(this.dataFormat==="channelsFirst"){o=mu(o,[0,2,3,1]);const h=this.size[0]*u[2],p=this.size[1]*u[3],g=this.interpolation==="nearest"?o.resizeNearestNeighbor([h,p]):o.resizeBilinear([h,p]);return mu(g,[0,3,1,2])}else{const h=this.size[0]*u[1],p=this.size[1]*u[2];return this.interpolation==="nearest"?o.resizeNearestNeighbor([h,p]):o.resizeBilinear([h,p])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}UI.className="UpSampling2D",li(UI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dO(r,t,n=[1,1],o="valid",u,h){return Vn(()=>{u==null&&(u=Qd()),bu(u);let p=FI(r,u);if(r.rank!==4)throw new Kr(`Input for depthwiseConv2d is required to be 4-D, but is instead ${r.rank}-D`);if(t.rank!==4)throw new Kr(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return p=dv(p,t,n,o==="same"?"same":"valid","NHWC",h),u==="channelsFirst"&&(p=mu(p,[0,3,1,2])),p})}class WI extends HE{constructor(t){super(2,t);this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=hc(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=ff(t.depthwiseConstraint),this.depthwiseRegularizer=Rc(t.depthwiseRegularizer)}build(t){if(t=Wl(t),t.length<4)throw new Kr(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(t[n]==null||t[n]<0)throw new Kr(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[n]}).`);const o=t[n],u=[this.kernelSize[0],this.kernelSize[1],o,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",u,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[o*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return Vn(()=>{t=vu(t);let o=dO(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(o=np(o,this.bias.read(),this.dataFormat)),this.activation!=null&&(o=this.activation.apply(o)),o})}computeOutputShape(t){t=Wl(t);const n=this.dataFormat==="channelsFirst"?t[2]:t[1],o=this.dataFormat==="channelsFirst"?t[3]:t[2],u=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,h=Xv(n,this.kernelSize[0],this.padding,this.strides[0]),p=Xv(o,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],u,h,p]:[t[0],h,p,u]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=fc(this.depthwiseInitializer),t.depthwiseRegularizer=ac(this.depthwiseRegularizer),t.depthwiseConstraint=cf(this.depthwiseRegularizer),t}}WI.className="DepthwiseConv2D",li(WI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function AM(r,t,n,o){if(Array.isArray(r)){if(t!=null||n!=null)throw new Kr("When inputs is an array, neither initialState or constants should be provided");o!=null&&(n=r.slice(r.length-o,r.length),r=r.slice(0,r.length-o)),r.length>1&&(t=r.slice(1,r.length)),r=r[0]}function u(h){return h==null||Array.isArray(h)?h:[h]}return t=u(t),n=u(n),{inputs:r,initialState:t,constants:n}}function MM(r,t,n,o=!1,u,h,p=!1,g=!1){return Vn(()=>{const b=t.shape.length;if(b<3)throw new Kr(`Input should be at least 3D, but is ${b}D.`);const _=[1,0].concat(Fp(2,b));if(t=mu(t,_),h!=null)throw new Xs("The rnn() functoin of the deeplearn.js backend does not support constants yet.");p&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),u!=null&&(u=u.asType("bool").asType("float32"),u.rank===b-1&&(u=xd(u,-1)),u=mu(u,_)),o&&(t=ed(t,0),u!=null&&(u=ed(u,0)));const z=[];let V,at=n;const Et=t.shape[0],St=Sd(t);let Tt;u!=null&&(Tt=Sd(u));for(let le=0;le<Et;++le){const ye=St[le],Qe=Vn(()=>r(ye,at));if(u==null)V=Qe[0],at=Qe[1];else{const $e=Vn(()=>{const Xe=Tt[le],Rn=Jh(Xe).sub(Xe),Cn=Qe[0].mul(Xe).add(at[0].mul(Rn)),mr=at.map((zr,ta)=>Qe[1][ta].mul(Xe).add(zr.mul(Rn)));return{output:Cn,newStates:mr}});V=$e.output,at=$e.newStates}g&&z.push(V)}let Wt;return g&&(Wt=rd(z,1)),[V,Wt,at]})}class Yv extends l{constructor(t){super(t);let n;if(t.cell==null)throw new Kr("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new KE({cells:t.cell}):n=t.cell,n.stateSize==null)throw new Kr("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new c({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Fp(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){Jb(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const o=n[0];let u;if(this.returnSequences?u=[t[0],t[1],o]:u=[t[0],o],this.returnState){const h=[];for(const p of n)h.push([t[0],p]);return[u].concat(h)}else return u}computeMask(t,n){return Vn(()=>{Array.isArray(n)&&(n=n[0]);const o=this.returnSequences?n:null;if(this.returnState){const u=this.states.map(h=>null);return[o].concat(u)}else return o})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let o=0;o<t;++o)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){const n=null;if(this.numConstants!=null)throw new Xs("Constants support is not implemented in RNN yet.");Jb(t)&&(t=t[0]),t=t;const o=this.stateful?t[0]:null,u=t.slice(2);this.inputSpec[0]=new c({shape:[o,null,...u]});const h=[t[0]].concat(t.slice(2));if(n!=null)throw new Xs("Constants support is not implemented in RNN yet.");this.cell.build(h);let p;if(Array.isArray(this.cell.stateSize)?p=this.cell.stateSize:p=[this.cell.stateSize],this.stateSpec!=null){if(!Bn(this.stateSpec.map(g=>g.shape[g.shape.length-1]),p))throw new Kr(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=p.map(g=>new c({shape:[null,g]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){Vn(()=>{if(!this.stateful)throw new Yu("Cannot call resetStates() on an RNN Layer that is not stateful.");const o=this.inputSpec[0].shape[0];if(o==null)throw new Kr("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(u=>Uc([o,u])):this.states_=[Uc([o,this.cell.stateSize])];else if(t==null)M(this.states_),this.keptStates!=null&&(M(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(u=>Uc([o,u])):this.states_[0]=Uc([o,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Kr(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):M(this.states_);for(let u=0;u<this.states_.length;++u){const h=t[u],p=Array.isArray(this.cell.stateSize)?this.cell.stateSize[u]:this.cell.stateSize,g=[o,p];if(!Bn(h.shape,g))throw new Kr(`State ${u} is incompatible with layer ${this.name}: expected shape=${g}, received shape=${h.shape}`);this.states_[u]=h}}this.states_=this.states_.map(u=>q(u.clone()))})}apply(t,n){let o=n==null?null:n.initialState,u=n==null?null:n.constants;n==null&&(n={});const h=AM(t,o,u,this.numConstants);t=h.inputs,o=h.initialState,u=h.constants;let p=[],g=[];if(o!=null){n.initialState=o,p=p.concat(o),this.stateSpec=[];for(const _ of o)this.stateSpec.push(new c({shape:_.shape}));g=g.concat(this.stateSpec)}if(u!=null&&(n.constants=u,p=p.concat(u),this.numConstants=u.length),p[0]instanceof a){const _=[t].concat(p),z=this.inputSpec.concat(g),V=this.inputSpec;this.inputSpec=z;const at=super.apply(_,n);return this.inputSpec=V,at}else return super.apply(t,n)}call(t,n){return Vn(()=>{const o=n==null?null:n.mask,u=n==null?null:n.training;let h=n==null?null:n.initialState;t=vu(t),h==null&&(this.stateful?h=this.states_:h=this.getInitialState(t));const p=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(h.length!==p)throw new Kr(`RNN Layer has ${p} state(s) but was passed ${h.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const g={training:u},_=MM((St,Tt)=>{const Wt=this.cell.call([St].concat(Tt),g);return[Wt[0],Wt.slice(1)]},t,h,this.goBackwards,o,null,this.unroll,this.returnSequences),z=_[0],V=_[1],at=_[2];this.stateful&&this.resetStates(at,u);const Et=this.returnSequences?V:z;return this.returnState?[Et].concat(at):Et})}getInitialState(t){return Vn(()=>{let n=Uc(t.shape);return n=ss(n,[1,2]),n=mg(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(o=>o>1?Xy(n,[1,o]):n):this.cell.stateSize>1?[Xy(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const o=this.cell.getConfig();return this.getClassName()===Yv.className&&(n.cell={className:this.cell.getClassName(),config:o}),Object.assign({},o,t,n)}static fromConfig(t,n,o={}){const u=n.cell,h=ze(u,o);return new t(Object.assign(n,{cell:h}))}}Yv.className="RNN",li(Yv);class cx extends l{}class XE extends cx{constructor(t){super(t);this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,bf(this.units,"units"),this.activation=km(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=hc(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=hc(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=hc(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Rc(t.kernelRegularizer),this.recurrentRegularizer=Rc(t.recurrentRegularizer),this.biasRegularizer=Rc(t.biasRegularizer),this.kernelConstraint=ff(t.kernelConstraint),this.recurrentConstraint=ff(t.recurrentConstraint),this.biasConstraint=ff(t.biasConstraint),this.dropout=Am([1,wv([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Am([1,wv([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Wl(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return Vn(()=>{if(t=t,t.length!==2)throw new Kr(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let o=t[1];t=t[0];const u=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Dm({ones:()=>Jh(t),rate:this.dropout,training:u})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Dm({ones:()=>Jh(o),rate:this.recurrentDropout,training:u}));let h;const p=this.dropoutMask,g=this.recurrentDropoutMask;p!=null?h=Ev(Hn(t,p),this.kernel.read()):h=Ev(t,this.kernel.read()),this.bias!=null&&(h=np(h,this.bias.read())),g!=null&&(o=Hn(o,g));let b=En(h,Ev(o,this.recurrentKernel.read()));return this.activation!=null&&(b=this.activation.apply(b)),[b,b]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Nm(this.activation),useBias:this.useBias,kernelInitializer:fc(this.kernelInitializer),recurrentInitializer:fc(this.recurrentInitializer),biasInitializer:fc(this.biasInitializer),kernelRegularizer:ac(this.kernelRegularizer),recurrentRegularizer:ac(this.recurrentRegularizer),biasRegularizer:ac(this.biasRegularizer),activityRegularizer:ac(this.activityRegularizer),kernelConstraint:cf(this.kernelConstraint),recurrentConstraint:cf(this.recurrentConstraint),biasConstraint:cf(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},t,n)}}XE.className="SimpleRNNCell",li(XE);class VI extends Yv{constructor(t){t.cell=new XE(t),super(t)}call(t,n){return Vn(()=>{this.cell.dropoutMask!=null&&(M(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(M(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const o=n==null?null:n.mask,u=n==null?null:n.training,h=n==null?null:n.initialState;return super.call(t,{mask:o,training:u,initialState:h})})}static fromConfig(t,n){return new t(n)}}VI.className="SimpleRNN",li(VI);class YE extends cx{constructor(t){super(t);if(this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new Kr("GRUCell does not support reset_after parameter set to true.");this.units=t.units,bf(this.units,"units"),this.activation=km(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=km(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=hc(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=hc(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=hc(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Rc(t.kernelRegularizer),this.recurrentRegularizer=Rc(t.recurrentRegularizer),this.biasRegularizer=Rc(t.biasRegularizer),this.kernelConstraint=ff(t.kernelConstraint),this.recurrentConstraint=ff(t.recurrentConstraint),this.biasConstraint=ff(t.biasConstraint),this.dropout=Am([1,wv([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Am([1,wv([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Wl(t);const n=t[t.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return Vn(()=>{if(t=t,t.length!==2)throw new Kr(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const o=n.training==null?!1:n.training;let u=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Dm({ones:()=>Jh(t),rate:this.dropout,training:o,count:3})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Dm({ones:()=>Jh(u),rate:this.recurrentDropout,training:o,count:3}));const h=this.dropoutMask,p=this.recurrentDropoutMask;let g,b,_;0<this.dropout&&this.dropout<1&&(t=Hn(t,h[0]));let z=Ev(t,this.kernel.read());this.useBias&&(z=np(z,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(u=Hn(u,p[0]));const V=this.recurrentKernel.read(),[at,Et]=nd(V,[2*this.units,this.units],V.rank-1),St=Ev(u,at),[Tt,Wt,le]=nd(z,3,z.rank-1),[ye,Qe]=nd(St,2,St.rank-1);g=this.recurrentActivation.apply(En(Tt,ye)),b=this.recurrentActivation.apply(En(Wt,Qe));const $e=Ev(Hn(b,u),Et);_=this.activation.apply(En(le,$e));const Xe=En(Hn(g,u),Hn(En(1,oi(g)),_));return[Xe,Xe]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Nm(this.activation),recurrentActivation:Nm(this.recurrentActivation),useBias:this.useBias,kernelInitializer:fc(this.kernelInitializer),recurrentInitializer:fc(this.recurrentInitializer),biasInitializer:fc(this.biasInitializer),kernelRegularizer:ac(this.kernelRegularizer),recurrentRegularizer:ac(this.recurrentRegularizer),biasRegularizer:ac(this.biasRegularizer),activityRegularizer:ac(this.activityRegularizer),kernelConstraint:cf(this.kernelConstraint),recurrentConstraint:cf(this.recurrentConstraint),biasConstraint:cf(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},t,n)}}YE.className="GRUCell",li(YE);class jI extends Yv{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new YE(t),super(t)}call(t,n){return Vn(()=>{this.cell.dropoutMask!=null&&(M(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(M(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const o=n==null?null:n.mask,u=n==null?null:n.training,h=n==null?null:n.initialState;return super.call(t,{mask:o,training:u,initialState:h})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}jI.className="GRU",li(jI);class fx extends cx{constructor(t){super(t);this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,bf(this.units,"units"),this.activation=km(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=km(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=hc(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=hc(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=hc(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=Rc(t.kernelRegularizer),this.recurrentRegularizer=Rc(t.recurrentRegularizer),this.biasRegularizer=Rc(t.biasRegularizer),this.kernelConstraint=ff(t.kernelConstraint),this.recurrentConstraint=ff(t.recurrentConstraint),this.biasConstraint=ff(t.biasConstraint),this.dropout=Am([1,wv([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Am([1,wv([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var n;t=Wl(t);const o=t[t.length-1];this.kernel=this.addWeight("kernel",[o,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let u;if(this.useBias){if(this.unitForgetBias){const h=this.biasInitializer,p=this.units;u=new(n=class extends rp{apply(b,_){const z=h.apply([p]),V=new Zy().apply([p]),at=h.apply([p*2]);return TE(TE(z,V),at)}},n.className="CustomInit",n)}else u=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,u,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,n){return Vn(()=>{const o=n.training==null?!1:n.training;if(t=t,t.length!==3)throw new Kr(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let u=t[1];const h=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Dm({ones:()=>Jh(t),rate:this.dropout,training:o,count:4})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Dm({ones:()=>Jh(u),rate:this.recurrentDropout,training:o,count:4}));const p=this.dropoutMask,g=this.recurrentDropoutMask;let b,_,z,V;0<this.dropout&&this.dropout<1&&(t=Hn(t,p[0]));let at=Ev(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(u=Hn(u,g[0])),at=En(at,Ev(u,this.recurrentKernel.read())),this.useBias&&(at=np(at,this.bias.read()));const[Et,St,Tt,Wt]=nd(at,4,at.rank-1);b=this.recurrentActivation.apply(Et),_=this.recurrentActivation.apply(St),z=En(Hn(_,h),Hn(b,this.activation.apply(Tt))),V=this.recurrentActivation.apply(Wt);const le=Hn(V,this.activation.apply(z));return[le,le,z]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Nm(this.activation),recurrentActivation:Nm(this.recurrentActivation),useBias:this.useBias,kernelInitializer:fc(this.kernelInitializer),recurrentInitializer:fc(this.recurrentInitializer),biasInitializer:fc(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ac(this.kernelRegularizer),recurrentRegularizer:ac(this.recurrentRegularizer),biasRegularizer:ac(this.biasRegularizer),activityRegularizer:ac(this.activityRegularizer),kernelConstraint:cf(this.kernelConstraint),recurrentConstraint:cf(this.recurrentConstraint),biasConstraint:cf(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},t,n)}}fx.className="LSTMCell",li(fx);class HI extends Yv{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new fx(t),super(t)}call(t,n){return Vn(()=>{this.cell.dropoutMask!=null&&(M(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(M(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const o=n==null?null:n.mask,u=n==null?null:n.training,h=n==null?null:n.initialState;return super.call(t,{mask:o,training:u,initialState:h})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}HI.className="LSTM",li(HI);class KE extends cx{constructor(t){super(t);this.cells=t.cells}get stateSize(){const t=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?t.push(...n.stateSize):t.push(n.stateSize);return t}call(t,n){return Vn(()=>{t=t;let o=t.slice(1);const u=[];for(const g of this.cells.slice().reverse())Array.isArray(g.stateSize)?u.push(o.splice(0,g.stateSize.length)):u.push(o.splice(0,1));u.reverse();const h=[];let p;for(let g=0;g<this.cells.length;++g){const b=this.cells[g];o=u[g],g===0?p=[t[0]].concat(o):p=[p[0]].concat(o),p=b.call(p,n),h.push(p.slice(1))}o=[];for(const g of h.slice().reverse())o.push(...g);return[p[0]].concat(o)})}build(t){Jb(t)&&(t=t[0]),t=t;let n;this.cells.forEach((o,u)=>{gg(`RNNCell_${u}`,()=>{o.build(t),Array.isArray(o.stateSize)?n=o.stateSize[0]:n=o.stateSize,t=[t[0],n]})}),this.built=!0}getConfig(){const t=super.getConfig(),n=h=>({className:h.getClassName(),config:h.getConfig()}),u={cells:this.cells.map(n)};return Object.assign({},t,u)}static fromConfig(t,n,o={}){const u=[];for(const h of n.cells)u.push(ze(h,o));return new t({cells:u})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.cells)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const o of this.cells)n.push(...o.trainableWeights);return n.concat(t)}return t}getWeights(){const t=[];for(const n of this.cells)t.push(...n.weights);return u1(t)}setWeights(t){const n=[];for(const o of this.cells){const u=o.weights.length,h=t.splice(u);for(let p=0;p<o.weights.length;++p)n.push([o.weights[p],h[p]])}tx(n)}}KE.className="StackedRNNCells",li(KE);function Dm(r){const{ones:t,rate:n,training:o=!1,count:u=1}=r,h=()=>Kb(t(),n),p=()=>A0(h,t,o);return!u||u<=1?q(p().clone()):Array(u).fill(void 0).map(p).map(b=>q(b.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var pO=function(r,t){var n={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&t.indexOf(o)<0&&(n[o]=r[o]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,o=Object.getOwnPropertySymbols(r);u<o.length;u++)t.indexOf(o[u])<0&&Object.prototype.propertyIsEnumerable.call(r,o[u])&&(n[o[u]]=r[o[u]]);return n};class tj extends null{}class NM extends Yv{constructor(t){if(t.unroll)throw new Xs("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new Xs("It is not possible at the moment to stack convolutional cells.");super(t);this.inputSpec=[new c({ndim:5})]}call(t,n){return Vn(()=>{if(this.cell.dropoutMask!=null&&(M(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(M(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new Kr("ConvRNN2D cell does not support constants");const o=n==null?null:n.mask,u=n==null?null:n.training,h=n==null?null:n.initialState;return super.call(t,{mask:o,training:u,initialState:h})})}computeOutputShape(t){let n=this.computeSingleOutputShape(t);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([t[0],...n.slice(-3)])]),n}getInitialState(t){return Vn(()=>{const{stateSize:n}=this.cell,o=t.shape,u=this.computeSingleOutputShape(o),h=[u[0],...u.slice(2)],p=Uc(h);return Array.isArray(n)?Array(n.length).fill(p):[p]})}resetStates(t,n=!1){Vn(()=>{if(!this.stateful)throw new Yu("Cannot call resetStates() on an RNN Layer that is not stateful.");const o=this.inputSpec[0].shape,u=this.computeSingleOutputShape(o),h=[u[0],...u.slice(2)];if(o[0]==null)throw new Kr("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Uc(h)):this.states_=[Uc(h)];else if(t==null)M(this.states_),this.keptStates!=null&&(M(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Uc(h)):this.states_[0]=Uc(h);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Kr(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n?this.keptStates.push(this.states_.slice()):M(this.states_);for(let g=0;g<this.states_.length;++g){const b=t[g],_=h;if(!Bn(b.shape,_))throw new Kr(`State ${g} is incompatible with layer ${this.name}: expected shape=${_}, received shape=${b.shape}`);this.states_[g]=b}}this.states_=this.states_.map(g=>q(g.clone()))})}computeSingleOutputShape(t){const{dataFormat:n,filters:o,kernelSize:u,padding:h,strides:p,dilationRate:g}=this.cell,b=n==="channelsFirst",_=t[b?3:2],z=t[b?4:3],V=Xv(_,u[0],h,p[0],g[0]),at=Xv(z,u[1],h,p[1],g[1]);return[...t.slice(0,2),...b?[o,V,at]:[V,at,o]]}}NM.className="ConvRNN2D";class ZE extends fx{constructor(t){const{filters:n,kernelSize:o,strides:u,padding:h,dataFormat:p,dilationRate:g}=t;super(Object.assign({},t,{units:n}));this.filters=n,bf(this.filters,"filters"),this.kernelSize=c1(o,2,"kernelSize"),this.kernelSize.forEach(b=>bf(b,"kernelSize")),this.strides=c1(u||1,2,"strides"),this.strides.forEach(b=>bf(b,"strides")),this.padding=h||"valid",Uf(this.padding),this.dataFormat=p||"channelsLast",bu(this.dataFormat),this.dilationRate=c1(g||1,2,"dilationRate"),this.dilationRate.forEach(b=>bf(b,"dilationRate"))}build(t){var n;t=Wl(t);const o=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[o]==null)throw new Kr(`The channel dimension of the input should be defined. Found ${t[o]}`);const u=t[o],h=4,p=this.kernelSize.concat([u,this.filters*h]);this.kernel=this.addWeight("kernel",p,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const g=this.kernelSize.concat([this.filters,this.filters*h]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",g,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let b;if(this.unitForgetBias){const _=this.biasInitializer,z=this.filters;b=new(n=class extends rp{apply(at,Et){const St=_.apply([z]),Tt=Op([z]),Wt=_.apply([z*2]);return Hy([St,Tt,Wt])}},n.className="CustomInit",n)}else b=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*h],null,b,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,n){return Vn(()=>{if(t.length!==3)throw new Kr(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const o=n.training||!1,u=t[0],h=t[1],p=t[2],g=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Dm({ones:()=>Jh(u),rate:this.dropout,training:o,count:g}));const b=this.dropoutMask,_=($i,Gi,Ji)=>!Gi||!Gi[Ji]?$i:Hn(Gi[Ji],$i);let z=_(u,b,0),V=_(u,b,1),at=_(u,b,2),Et=_(u,b,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Dm({ones:()=>Jh(h),rate:this.recurrentDropout,training:o,count:g}));const St=this.recurrentDropoutMask;let Tt=_(h,St,0),Wt=_(h,St,1),le=_(h,St,2),ye=_(h,St,3);const Qe=3,[$e,Xe,Rn,Cn]=nd(this.kernel.read(),g,Qe),[mr,zr,ta,Ma]=this.useBias?nd(this.bias.read(),g):[null,null,null,null];z=this.inputConv(z,$e,mr,this.padding),V=this.inputConv(V,Xe,zr,this.padding),at=this.inputConv(at,Rn,ta,this.padding),Et=this.inputConv(Et,Cn,Ma,this.padding);const[Za,Ka,ni,Ua]=nd(this.recurrentKernel.read(),g,Qe);Tt=this.recurrentConv(Tt,Za),Wt=this.recurrentConv(Wt,Ka),le=this.recurrentConv(le,ni),ye=this.recurrentConv(ye,Ua);const Ba=this.recurrentActivation.apply(En(z,Tt)),mi=this.recurrentActivation.apply(En(V,Wt)),ti=En(Hn(mi,p),Hn(Ba,this.activation.apply(En(at,le)))),yi=Hn(this.recurrentActivation.apply(En(Et,ye)),this.activation.apply(ti));return[yi,yi,ti]})}getConfig(){const t=super.getConfig(),{units:n}=t,o=pO(t,["units"]),u={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},o,u)}inputConv(t,n,o,u){const h=rs(t,n,this.strides,u||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return o?np(h,o,this.dataFormat):h}recurrentConv(t,n){return rs(t,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}ZE.className="ConvLSTM2DCell",li(ZE);class XI extends NM{constructor(t){const n=new ZE(t);super(Object.assign({},t,{cell:n}))}static fromConfig(t,n){return new t(n)}}XI.className="ConvLSTM2D",li(XI);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class qE extends l{constructor(t){super(t);this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const n=t.shape,o=[];for(let u=0;u<this.noiseShape.length;++u)o.push(this.noiseShape[u]==null?n[u]:this.noiseShape[u]);return o}call(t,n){return Vn(()=>{this.invokeCallHook(t,n);const o=vu(t);if(0<this.rate&&this.rate<1){const u=n.training==null?!1:n.training,h=this.getNoiseShape(o);return A0(()=>Kb(o,this.rate,h,this.seed),()=>o,u)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(t,n),t}dispose(){return super.dispose()}}qE.className="Dropout",li(qE);class YI extends qE{constructor(t){super(t);this.inputSpec=[{ndim:3}]}getNoiseShape(t){const n=t.shape;return[n[0],1,n[2]]}}YI.className="SpatialDropout1D",li(YI);class KI extends l{constructor(t){super(t);if(this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let n=null;t.batchSize!=null&&(n=t.batchSize),this.batchInputShape=[n,t.inputDim]}this.units=t.units,bf(this.units,"units"),this.activation=km(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=hc(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=hc(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=ff(t.kernelConstraint),this.biasConstraint=ff(t.biasConstraint),this.kernelRegularizer=Rc(t.kernelRegularizer),this.biasRegularizer=Rc(t.biasRegularizer),this.activityRegularizer=Rc(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=Wl(t);const n=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(t){t=Wl(t);const n=t.slice();return n[n.length-1]=this.units,n}call(t,n){return Vn(()=>{this.invokeCallHook(t,n);const o=vu(t),u=vE(this.activation.getClassName());let h;return u!=null?h=Ev(o,this.kernel.read(),u,this.bias?this.bias.read():null):(h=Ev(o,this.kernel.read()),this.bias!=null&&(h=np(h,this.bias.read())),this.activation!=null&&(h=this.activation.apply(h))),h})}getConfig(){const t={units:this.units,activation:Nm(this.activation),useBias:this.useBias,kernelInitializer:fc(this.kernelInitializer),biasInitializer:fc(this.biasInitializer),kernelRegularizer:ac(this.kernelRegularizer),biasRegularizer:ac(this.biasRegularizer),activityRegularizer:ac(this.activityRegularizer),kernelConstraint:cf(this.kernelConstraint),biasConstraint:cf(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}KI.className="Dense",li(KI);class ZI extends l{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=Wl(t);for(const n of t.slice(1))if(n==null)throw new Kr(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],jg(t,1)]}call(t,n){return Vn(()=>{this.invokeCallHook(t,n);let o=vu(t);if(this.dataFormat==="channelsFirst"&&o.rank>1){const u=[0];for(let h=2;h<o.rank;++h)u.push(h);u.push(1),o=o.transpose(u)}return aI(o)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(t,n),t}}ZI.className="Flatten",li(ZI);class qI extends l{constructor(t){super(t);this.supportsMasking=!0,this.activation=km(t.activation)}call(t,n){return Vn(()=>{this.invokeCallHook(t,n);const o=vu(t);return this.activation.apply(o)})}getConfig(){const t={activation:Nm(this.activation)},n=super.getConfig();return Object.assign(t,n),t}}qI.className="Activation",li(qI);class QI extends l{constructor(t){super(t);this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,n){return Vn(()=>(t=vu(t),Hb(t,this.n)))}getConfig(){const t={n:this.n},n=super.getConfig();return Object.assign(t,n),t}}QI.className="RepeatVector",li(QI);class JI extends l{constructor(t){super(t);this.targetShape=t.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,n){const o="Total size of new array must be unchanged.",u=n.slice();let h=1,p=null;for(let b=0;b<u.length;++b){const _=u[b];if(this.isUnknown(_))if(p===null)p=b;else throw new Kr("Can only specifiy one unknown dimension.");else h*=_}const g=jg(t);if(p!==null){if(h===0||g%h!=0)throw new Kr(o);u[p]=g/h}else if(g!==h)throw new Kr(o);return u}computeOutputShape(t){let n=!1;for(let o=0;o<t.length;++o)if(this.isUnknown(t[o])){n=!0;break}return n?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,n){return Vn(()=>{this.invokeCallHook(t,n);const o=vu(t),u=o.shape,h=u.slice(0,1).concat(this.fixUnknownDimension(u.slice(1),this.targetShape));return o.reshape(h)})}getConfig(){const t={targetShape:this.targetShape},n=super.getConfig();return Object.assign(t,n),t}}JI.className="Reshape",li(JI);class tT extends l{constructor(t){super(t);if(t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const n=Fp(1,t.dims.length+1);if(!Bn(t.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new c({ndim:this.dims.length+1})]}computeOutputShape(t){t=Wl(t);const n=t.slice();return this.dims.forEach((o,u)=>{n[u+1]=t[o]}),n}call(t,n){return mu(vu(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},n=super.getConfig();return Object.assign(t,n),t}}tT.className="Permute",li(tT);class eT extends l{constructor(t){super(t==null?{}:t);this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,t),n}computeMask(t,n){const o=vu(t),u=-1;return wa(sg(o,this.maskValue),u)}call(t,n){return Vn(()=>{this.invokeCallHook(t,n);const o=vu(t),u=-1,h=!0,p=wa(sg(o,this.maskValue),u,h);return o.mul(p.asType(o.dtype))})}}eT.className="Masking",li(eT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class nT extends l{constructor(t){super(t);if(this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let n=null;t.batchSize!=null&&(n=t.batchSize),t.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Ql(t.inputLength))}this.inputDim=t.inputDim,bf(this.inputDim,"inputDim"),this.outputDim=t.outputDim,bf(this.outputDim,"outputDim"),this.embeddingsInitializer=hc(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Rc(t.embeddingsRegularizer),this.activityRegularizer=Rc(t.activityRegularizer),this.embeddingsConstraint=ff(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,n){return Vn(()=>this.maskZero?(t=vu(t),sg(t,xi(t))):null)}computeOutputShape(t){if(t=Wl(t),this.inputLength==null)return[...t,this.outputDim];const n=Ql(this.inputLength);if(n.length!==t.length-1)throw new Kr(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let o=0;for(let u=0;u<n.length;++u){const h=n[u],p=t[u+1];if(h!=null&&p!=null&&h!==p)throw new Kr(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);h==null&&(n[o]=p),o++}}return[t[0],...n,this.outputDim]}call(t,n){return Vn(()=>{this.invokeCallHook(t,n);let o=vu(t);return o.dtype!=="int32"&&(o=jy(o,"int32")),AE(this.embeddings.read(),o.as1D()).reshape(Wl(this.computeOutputShape(o.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:fc(this.embeddingsInitializer),embeddingsRegularizer:ac(this.embeddingsRegularizer),activityRegularizer:ac(this.activityRegularizer),embeddingsConstraint:cf(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(t,n),t}}nT.className="Embedding",li(nT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class R0 extends l{constructor(t){super(t||{});this.supportsMasking=!0}mergeFunction(t){throw new Xs}computeElementwiseOpOutputShape(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;const o=t.slice(0,t.length-n.length);for(let u=0;u<n.length;++u){const h=t[t.length-n.length+u],p=n[u];if(h==null||p==null||h<0||p<0)o.push(null);else if(h===1)o.push(p);else if(p===1)o.push(h);else{if(h!==p)throw new Kr("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));o.push(h)}}return o}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Wl(t)]),t=t,t.length<2)throw new Kr(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let n=[];for(const h of t)h!=null&&h[0]!==null&&n.push(h[0]);if(n=vg(n),n.length>1)throw new Kr(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let o=t[0]==null?null:t[0].slice(1);for(let h=1;h<t.length;++h){const p=t[h]==null?null:t[h].slice(1);o=this.computeElementwiseOpOutputShape(o,p)}const u=t.map(h=>h.length);t.indexOf(null)===-1&&vg(u).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,n){return Vn(()=>{if(t=t,this.reshapeRequired){const o=[],u=t.map(h=>h.rank);if(u.indexOf(null)===-1){const h=wv(u);for(let p of t){const g=p.rank;for(let b=0;b<h-g;++b)p=mg(p,1);o.push(p)}return this.mergeFunction(o)}else{let h=!1;for(const b of t){const _=b.rank;if(_==null){const z=b.shape,V=z[0],at=z.slice(1).concat([V]);let Et=b.reshape([V].concat(jg(z.slice(1))));Et=mu(Et,[1,0]),Et=Et.reshape(at),o.push(Et),h=!0}else if(_>1){const z=Fp(1,_).concat([0]);o.push(mu(b,z)),h=!0}else o.push(b)}let p=this.mergeFunction(o);const g=p.rank;if(h){if(g==null){const b=p.shape,_=b.length,z=b[_-1],V=[z].concat(b.slice(0,b.length-1));p=mu(p.reshape([-1,z]),[1,0]).reshape(V)}else if(g>1){const b=[g-1].concat(Fp(0,g-1));p=mu(p,b)}}return p}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let n;t[0]==null?n=null:n=t[0].slice(1);for(let u=1;u<t.length;++u){const h=t[u]==null?null:t[u].slice(1);n=this.computeElementwiseOpOutputShape(n,h)}let o=[];for(const u of t)u!=null&&u[0]!==null&&o.push(u[0]);return o=vg(o),o.length===1?n=o.concat(n):n=[null].concat(n),n}computeMask(t,n){return Vn(()=>{if(n==null)return null;if(!Array.isArray(n))throw new Kr("`mask` should be an Array");if(!Array.isArray(t))throw new Kr("`inputs` should be an Array");if(n.length!==t.length)throw new Kr(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${n.length})`);if(n.every(u=>u==null))return null;n=n.map(u=>u==null?u:xd(u,0));let o=n[0];for(let u=1;u<n.length-1;++u)o=Ed(o,n[u]);return o})}}class hx extends R0{constructor(t){super(t)}mergeFunction(t){return Vn(()=>{let n=t[0].clone();for(let o=1;o<t.length;++o)n=En(n,t[o]);return n})}}hx.className="Add",li(hx);function ej(r){return Array.isArray(r)?new hx({}).apply(r):new hx(r)}class dx extends R0{constructor(t){super(t)}mergeFunction(t){return Vn(()=>{let n=t[0].clone();for(let o=1;o<t.length;++o)n=Hn(n,t[o]);return n})}}dx.className="Multiply",li(dx);function nj(r){return Array.isArray(r)?new dx({}).apply(r):new dx(r)}class px extends R0{constructor(t){super(t)}mergeFunction(t){return Vn(()=>{let n=t[0].clone();for(let o=1;o<t.length;++o)n=En(n,t[o]);return Hn(1/t.length,n)})}}px.className="Average",li(px);function rj(r){return Array.isArray(r)?new px({}).apply(r):new px(r)}class vx extends R0{constructor(t){super(t)}mergeFunction(t){return Vn(()=>{let n=t[0];for(let o=1;o<t.length;++o)n=Jo(n,t[o]);return n})}}vx.className="Maximum",li(vx);function aj(r){return Array.isArray(r)?new vx({}).apply(r):new vx(r)}class gx extends R0{constructor(t){super(t)}mergeFunction(t){return Vn(()=>{let n=t[0];for(let o=1;o<t.length;++o)n=og(n,t[o]);return n})}}gx.className="Minimum",li(gx);function ij(r){return Array.isArray(r)?new gx({}).apply(r):new gx(r)}class mx extends R0{constructor(t){super(t);this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new Kr("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let n=!0;for(const u of t)if(u!=null){n=!1;break}if(n)return;const o=[];for(let u=0;u<t.length;++u){const h=t[u].slice();h.splice(this.axis,1);let p=!1;for(const g of o)if(Bn(g,h)){p=!0;break}p||o.push(h)}if(o.length>1)throw new Kr("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return Vn(()=>Hy(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new Kr("A `Concatenate` layer should be called on a list of inputs.");const n=t,o=n[0].slice(),u=this.axis<0?o.length+this.axis:this.axis;for(const h of n.slice(1)){if(o[u]==null||h[u]==null){o[u]=null;break}o[u]+=h[u]}return o}computeMask(t,n){if(n==null)return null;if(!Array.isArray(n))throw new Kr("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new Kr("`inputs` should be an array for Concatenate");if(n.length!==t.length)throw new Kr(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${t.length})`);return Vn(()=>{let o=!0;if(n.forEach(p=>{if(p!=null){o=!1;return}}),o)return null;const u=[];for(let p=0;p<t.length;++p)n[p]==null?u.push(Jh(t[p]).asType("bool")):n[p].rank<t[p].rank?u.push(xd(n[p],-1)):u.push(n[p]);const h=vt(u,this.axis);return Or(h,-1,!1)})}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}mx.className="Concatenate",li(mx);function oj(r){return Array.isArray(r)?new mx({}).apply(r):new mx(r)}function yx(r,t){for(;r<0;)r+=t;return r}function vO(r,t,n){if(r.shape.length>3||t.shape.length>3)throw new Xs("batchDot is not implemented for tensors of 4D or higher rank yet");if(bt(r.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${r.shape.length}`),bt(r.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),r.dtype==="complex64"||t.dtype==="complex64")throw new Xs("batchDot is not implemented for complex64-type Tensors yet.");const o=r.shape.length,u=t.shape.length;n==null&&(n=[o-1,u-2]);const h=n;return Vn(()=>{let p;if(o>u){p=o-u;const b=[];for(let _=0;_<p;++_)b.push(1);t=t.reshape(t.shape.concat(b))}else if(u>o){p=u-o;const b=[];for(let _=0;_<p;++_)b.push(1);r=r.reshape(r.shape.concat(b))}else p=0;let g;if(r.shape.length===2&&t.shape.length===2)h[0]===h[1]?g=r.mul(t).sum(h[0]):g=r.transpose([1,0]).mul(t).sum(h[1]);else{const b=h[0]!==r.shape.length-1,_=h[1]===t.shape.length-1;g=r.matMul(t,b,_)}if(p>0){let b;o>u?b=o+u-3:b=o-1;const _=[];for(let z=b;z<b+p;++z)_.push(z);g=g.squeeze(_)}return g.shape.length===1&&(g=g.expandDims(1)),g})}class rT extends R0{constructor(t){super(t);this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){bt(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0],o=t[1];if(n.length>3||o.length>3)throw new Xs("Dot layer does not support tensors of 4D or higher rank yet.");const u=this.interpretAxes(n,o);if(n[u[0]]!==o[u[1]])throw new Kr(`Dimension incompatibility: ${n[u[0]]} !== ${o[u[1]]}`)}mergeFunction(t){if(t.length!==2)throw new Kr(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let n=t[0],o=t[1],u;return Array.isArray(this.axes)?u=this.axes.map((h,p)=>yx(h,t[p].shape.length)):u=[yx(this.axes,n.shape.length),yx(this.axes,o.shape.length)],this.normalize&&(n=pn(n,u[0]),o=pn(o,u[1])),vO(n,o,u)}interpretAxes(t,n){let o;return Array.isArray(this.axes)?o=this.axes:o=[yx(this.axes,t.length),yx(this.axes,n.length)],o}computeOutputShape(t){bt(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0].slice(),o=t[1].slice();if(n.length>3||o.length>3)throw new Xs("Dot layer does not support tensors of 4D or higher rank yet.");const u=this.interpretAxes(n,o);n.splice(u[0],1),o.splice(u[1],1),o.splice(0,1);const h=n.concat(o);return h.length===1&&h.push(1),h}computeMask(t,n){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(t,n),t}}rT.className="Dot",li(rT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class aT extends l{constructor(t){super(t);this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,t),n}call(t,n){return Vn(()=>{this.invokeCallHook(t,n);const o=vu(t);return A0(()=>Yy(o.shape,0,this.stddev).add(o),()=>o,n.training||!1)})}}aT.className="GaussianNoise",li(aT);class iT extends l{constructor(t){super(t);this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return Vn(()=>{this.invokeCallHook(t,n);const o=vu(t);return this.rate>0&&this.rate<1?A0(()=>{const h=Math.sqrt(this.rate/(1-this.rate));return o.mul(Yy(o.shape,1,h))},()=>o,n.training||!1):o})}}iT.className="GaussianDropout",li(iT);class oT extends l{constructor(t){super(t);this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||vu(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return Vn(()=>{if(this.rate<1&&this.rate>0){const o=this._getNoiseShape(t);return A0(()=>{const h=vu(t),p=1.6732632423543772,g=1.0507009873554805,b=-p*g;let _=Bv(du(o),this.rate);_=jy(_,"float32");const z=gA((1-this.rate)*(1+this.rate*gA(b,2)),-.5),V=-z*b*this.rate;return h.mul(_).add(_.add(-1).mul(b)).mul(z).add(V)},()=>vu(t),n.training||!1)}return t})}}oT.className="AlphaDropout",li(oT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bx(r,t,n,o,u,h=.001){let p;if(r.rank===2)p=Un(r,t,n,o,u,h);else if(r.rank===3)p=Br(r,t,n,o,u,h);else if(r.rank===4)p=sa(r,t,n,o,u,h);else throw new Xs(`batchNormalization is not implemented for array of rank ${r.rank} yet`);return p}function gO(r,t,n,o,u=.001){return Vn(()=>{const h=Km(r,o),p=h.mean,g=h.variance;return[bx(r,p,g,n,t,u),p,g]})}function mO(r,t,n,o,u=.001){return Vn(()=>{const h=Km(r,o),p=h.mean,g=h.variance,b=[];for(const St of Fp(0,r.rank))o.indexOf(St)!==-1?b.push(1):b.push(r.shape[St]);const _=p.reshape(b),z=g.reshape(b),V=t==null?null:t.reshape(b),at=n==null?null:n.reshape(b);return[bx(r,_,z,at,V,u),p,g]})}function yO(r,t,n,o,u=.001){return Bn(o.slice().sort(),Fp(0,r.rank-1))?gO(r,t,n,o,u):mO(r,t,n,o,u)}class sT extends l{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=hc(t.betaInitializer||"zeros"),this.gammaInitializer=hc(t.gammaInitializer||"ones"),this.movingMeanInitializer=hc(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=hc(t.movingVarianceInitializer||"ones"),this.betaConstraint=ff(t.betaConstraint),this.gammaConstraint=ff(t.gammaConstraint),this.betaRegularizer=Rc(t.betaRegularizer),this.gammaRegularizer=Rc(t.gammaRegularizer)}build(t){t=Wl(t);const n=this.axis>=0?this.axis:this.axis+t.length,o=t[n];if(o==null)throw new Kr(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new c({ndim:t.length,axes:{[n]:o}})];const u=[o];this.scale&&(this.gamma=this.addWeight("gamma",u,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",u,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",u,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",u,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,n){return Vn(()=>{const o=n.training==null?!1:n.training,u=vu(t),h=u.shape,p=h.length,g=Fp(0,p),b=this.axis>=0?this.axis:this.axis+p;g.splice(b,1);const _=Gg(1,p);_[b]=h[b];const z=g.slice();z.sort();const V=!Bn(z,Fp(0,p).slice(0,p-1)),at=()=>{if(V){const ye=this.movingMean.read().reshape(_),Qe=this.movingVariance.read().reshape(_),$e=this.center?this.beta.read().reshape(_):null,Xe=this.scale?this.gamma.read().reshape(_):null;return bx(u,ye,Qe,$e,Xe,this.epsilon)}else return bx(u,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!o)return at();const[Et,St,Tt]=yO(u,this.gamma.read(),this.beta.read(),g,this.epsilon),Wt=(ye,Qe,$e)=>{Vn(()=>{const Xe=1-$e,Rn=ye.read(),Cn=Rn.sub(Qe).mul(Xe);ye.write(Rn.sub(Cn))})};return(()=>{Wt(this.movingMean,St,this.momentum),Wt(this.movingVariance,Tt,this.momentum)})(),Et})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:fc(this.betaInitializer),gammaInitializer:fc(this.gammaInitializer),movingMeanInitializer:fc(this.movingMeanInitializer),movingVarianceInitializer:fc(this.movingVarianceInitializer),betaRegularizer:ac(this.betaRegularizer),gammaRegularizer:ac(this.gammaRegularizer),betaConstraint:cf(this.betaConstraint),gammaConstraint:cf(this.gammaConstraint)},n=super.getConfig();return Object.assign(t,n),t}}sT.className="BatchNormalization",li(sT);class uT extends l{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=hc(t.betaInitializer||"zeros"),this.gammaInitializer=hc(t.gammaInitializer||"ones"),this.betaRegularizer=Rc(t.betaRegularizer),this.gammaRegularizer=Rc(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=Wl(t);const n=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let h=0;h<this.axis.length;++h)this.axis[h]<0&&(this.axis[h]+=n);for(const h of this.axis)if(h<0||h>=n)throw new Error(`Invalid axis: ${h}`);if(this.axis.length!==vg(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const o=this.axis.map(h=>t[h]),u=!0;this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,u):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,u):this.beta=null,this.built=!0}call(t,n){const o=vu(t),u=o.shape,h=u.length;return Vn(()=>{const p=!0;let{mean:g,variance:b}=Km(o,this.axis,p);const _=Gg(1,h);for(const Tt of this.axis)_[Tt]=u[Tt];const z=Tt=>Tt!=null&&Tt.shape.length!==h&&this.axis!==[h-1]?Tt.reshape(_):Tt;let V=z(this.gamma.read()),at=z(this.beta.read());const Et=[],St=[];for(let Tt=0;Tt<h;++Tt)this.axis.indexOf(Tt)!==-1?(Et.push(u[Tt]),St.push(1)):(Et.push(1),St.push(u[Tt]));return g=g.tile(Et),b=b.tile(Et),V=V.tile(St),at=at.tile(St),bx(o,g,b,at,V,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:fc(this.betaInitializer),gammaInitializer:fc(this.gammaInitializer),betaRegularizer:ac(this.betaRegularizer),gammaRegularizer:ac(this.gammaRegularizer)},n=super.getConfig();return Object.assign(t,n),t}}uT.className="LayerNormalization",li(uT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sj(r,t){return tidy(()=>{if(r.rank!==3)throw new ValueError(`temporalPadding expects input tensor to be 3-D, but received a ${r.rank}-D tensor.`);if(t==null&&(t=[1,1]),t.length!==2)throw new ValueError(`temporalPadding expects input padding pattern to be a length-2 array, but received a length-${t.length} array.`);const n=[[0,0],t,[0,0]];return tfc.pad(r,n)})}function bO(r,t,n){return Vn(()=>{if(r.rank!==4)throw new Kr(`temporalPadding expects input tensor to be 4-D, but received a ${r.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new Kr("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Qd()),n!=="channelsLast"&&n!=="channelsFirst")throw new Kr(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let o;return n==="channelsFirst"?o=[[0,0],[0,0],t[0],t[1]]:o=[[0,0],t[0],t[1],[0,0]],zv(r,o)})}class lT extends l{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?Qd():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new Kr(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let n,o;if(typeof t.padding[0]=="number")n=[t.padding[0],t.padding[0]],o=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new Kr(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(n=t.padding[0],t.padding[1].length!==2)throw new Kr(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);o=t.padding[1]}this.padding=[n,o]}this.inputSpec=[new c({ndim:4})]}computeOutputShape(t){t=Wl(t);let n,o;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?n=t[2]+this.padding[0][0]+this.padding[0][1]:n=null,t[3]!=null&&t[3]>=0?o=t[3]+this.padding[1][0]+this.padding[1][1]:o=null,[t[0],t[1],n,o]):(t[1]!=null&&t[1]>=0?n=t[1]+this.padding[0][0]+this.padding[0][1]:n=null,t[2]!=null&&t[2]>=0?o=t[2]+this.padding[1][0]+this.padding[1][1]:o=null,[t[0],n,o,t[3]])}call(t,n){return Vn(()=>bO(vu(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}lT.className="ZeroPadding2D",li(lT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function QE(r,t,n,o,u,h){return Vn(()=>{bu(u),xE(h),Uf(o),n==null&&(n=[1,1]),o==null&&(o="valid"),u==null&&(u=Qd()),h==null&&(h="max"),r=FI(r,u);let p;const g=o==="same"?"same":"valid";return h==="max"?p=Ng(r,t,n,g):p=S(r,t,n,g),u==="channelsFirst"&&(p=mu(p,[0,3,1,2])),p})}function kM(r,t,n,o,u,h){return Vn(()=>{bu(u),xE(h),Uf(o),n==null&&(n=[1,1,1]),o==null&&(o="valid"),u==null&&(u=Qd()),h==null&&(h="max"),r=CM(r,u);let p;const g=o==="same"?"same":"valid";return h==="max"?p=ey(r,t,n,g):p=J(r,t,n,g),u==="channelsFirst"&&(p=mu(p,[0,4,1,2,3])),p})}class DM extends l{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new Kr(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(bf(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new Kr(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);bf(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,Uf(this.padding),this.inputSpec=[new c({ndim:3})]}computeOutputShape(t){t=Wl(t);const n=Xv(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]}call(t,n){return Vn(()=>{this.invokeCallHook(t,n),t=mg(vu(t),2);const o=this.poolingFunction(vu(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return lg(o,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(t,n),t}}class cT extends DM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return bu(h),Uf(u),QE(t,n,o,u,h,"max")}}cT.className="MaxPooling1D",li(cT);class fT extends DM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return bu(h),Uf(u),QE(t,n,o,u,h,"avg")}}fT.className="AveragePooling1D",li(fT);class OM extends l{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new Kr(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];bf(this.poolSize,"poolSize"),bf(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,bu(this.dataFormat),Uf(this.padding),this.inputSpec=[new c({ndim:4})]}computeOutputShape(t){t=Wl(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],o=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=Xv(n,this.poolSize[0],this.padding,this.strides[0]),o=Xv(o,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,o]:[t[0],n,o,t[3]]}call(t,n){return Vn(()=>(this.invokeCallHook(t,n),this.poolingFunction(vu(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class hT extends OM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return bu(h),Uf(u),QE(t,n,o,u,h,"max")}}hT.className="MaxPooling2D",li(hT);class dT extends OM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return bu(h),Uf(u),QE(t,n,o,u,h,"avg")}}dT.className="AveragePooling2D",li(dT);class RM extends l{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new Kr(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];bf(this.poolSize,"poolSize"),bf(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,bu(this.dataFormat),Uf(this.padding),this.inputSpec=[new c({ndim:5})]}computeOutputShape(t){t=Wl(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],o=this.dataFormat==="channelsFirst"?t[3]:t[2],u=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=Xv(n,this.poolSize[0],this.padding,this.strides[0]),o=Xv(o,this.poolSize[1],this.padding,this.strides[1]),u=Xv(u,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,o,u]:[t[0],n,o,u,t[4]]}call(t,n){return Vn(()=>(this.invokeCallHook(t,n),this.poolingFunction(vu(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class pT extends RM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return bu(h),Uf(u),kM(t,n,o,u,h,"max")}}pT.className="MaxPooling3D",li(pT);class vT extends RM{constructor(t){super(t)}poolingFunction(t,n,o,u,h){return bu(h),Uf(u),kM(t,n,o,u,h,"avg")}}vT.className="AveragePooling3D",li(vT);class LM extends l{constructor(t){super(t);this.inputSpec=[new c({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,n){throw new Xs}}class gT extends LM{constructor(t){super(t||{})}call(t,n){return Vn(()=>{const o=vu(t);return nc(o,1)})}}gT.className="GlobalAveragePooling1D",li(gT);class mT extends LM{constructor(t){super(t||{})}call(t,n){return Vn(()=>{const o=vu(t);return Gf(o,1)})}}mT.className="GlobalMaxPooling1D",li(mT);class PM extends l{constructor(t){super(t);this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,bu(this.dataFormat),this.inputSpec=[new c({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,n){throw new Xs}getConfig(){const t={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class yT extends PM{call(t,n){return Vn(()=>{const o=vu(t);return this.dataFormat==="channelsLast"?nc(o,[1,2]):nc(o,[2,3])})}}yT.className="GlobalAveragePooling2D",li(yT);class bT extends PM{call(t,n){return Vn(()=>{const o=vu(t);return this.dataFormat==="channelsLast"?Gf(o,[1,2]):Gf(o,[2,3])})}}bT.className="GlobalMaxPooling2D",li(bT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class FM extends l{constructor(t){super(t);this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(t,n),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,n,o={}){const u=n.layer,h=ze(u,o);delete n.layer;const p={layer:h};return Object.assign(p,n),new t(p)}}class xT extends FM{constructor(t){super(t);this.supportsMasking=!0}build(t){if(t=Wl(t),t.length<3)throw new Kr(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=Wl(t);const n=[t[0]].concat(t.slice(2)),o=this.layer.computeOutputShape(n),u=t[1];return[o[0],u].concat(o.slice(1))}call(t,n){return Vn(()=>(t=vu(t),MM((p,g)=>[vu(this.layer.call(p,n)),[]],t,[],!1,null,null,!1,!0)[1]))}}xT.className="TimeDistributed",li(xT);function xO(r){Ug(Wg,"BidirectionalMergeMode",r)}const wO="concat";class wT extends FM{constructor(t){super(t);const n=t.layer.getConfig(),o={};o.className=t.layer.getClassName(),o.config=n,this.forwardLayer=ze(o),n.goBackwards=n.goBackwards!==!0;const u={};if(u.className=t.layer.getClassName(),u.config=n,this.backwardLayer=ze(u),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?wO:t.mergeMode,xO(this.mergeMode),t.weights)throw new Xs("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const n=t.length,o=Math.floor(n/2);this.forwardLayer.setWeights(t.slice(0,o)),this.backwardLayer.setWeights(t.slice(o))}computeOutputShape(t){let n=this.forwardLayer.computeOutputShape(t);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let o,u,h;return this.returnState&&(h=n.slice(1)),o=n[0],o=o,this.mergeMode==="concat"?(o[o.length-1]*=2,u=[o]):this.mergeMode==null?u=[o,o.slice()]:u=[o],this.returnState?this.mergeMode==null?u.concat(h).concat(h.slice()):[o].concat(h).concat(h.slice()):Mh(u)}apply(t,n){let o=n==null?null:n.initialState,u=n==null?null:n.constants;n==null&&(n={});const h=AM(t,o,u,this.numConstants);if(t=h.inputs,o=h.initialState,u=h.constants,Array.isArray(t)&&(o=t.slice(1),t=t[0]),(o==null||o.length===0)&&u==null)return super.apply(t,n);const p=[],g=[];if(o!=null){const _=o.length;if(_%2>0)throw new Kr("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=o,p.push(...o);const z=o.map(V=>new c({shape:V.shape}));this.forwardLayer.stateSpec=z.slice(0,_/2),this.backwardLayer.stateSpec=z.slice(_/2),g.push(...z)}if(u!=null)throw new Xs("Support for constants in Bidirectional layers is not implemented yet.");const b=p[0]instanceof a;for(const _ of p)if(_ instanceof a!==b)throw new Kr("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(b){const _=[t].concat(p),z=this.inputSpec.concat(g),V=this.inputSpec;this.inputSpec=z;const at=super.apply(_,n);return this.inputSpec=V,at}else return super.apply(t,n)}call(t,n){return Vn(()=>{const o=n.initialState;let u,h;if(o==null)u=this.forwardLayer.call(t,n),h=this.backwardLayer.call(t,n);else{const b=o.slice(0,o.length/2),_=o.slice(o.length/2);u=this.forwardLayer.call(t,Object.assign(n,{initialState:b})),h=this.backwardLayer.call(t,Object.assign(n,{initialState:_}))}let p;this.returnState&&(Array.isArray(u)&&(p=u.slice(1).concat(h.slice(1))),u=u[0],h=h[0]),this.returnSequences&&(h=ed(h,1));let g;return this.mergeMode==="concat"?g=Hy([u,h]):this.mergeMode==="sum"?g=En(u,h):this.mergeMode==="ave"?g=Hn(.5,En(u,h)):this.mergeMode==="mul"?g=Hn(u,h):this.mergeMode==null&&(g=[u,h]),this.returnState?this.mergeMode==null?g.concat(p):[g].concat(p):g})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){gg(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),gg(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,n){Array.isArray(n)&&(n=n[0]);let o;if(this.returnSequences?this.mergeMode==null?o=[n,n]:o=n:this.mergeMode==null?o=[null,null]:o=null,this.returnState){const h=this.forwardLayer.states.map(p=>null);return Array.isArray(o)?o.concat(h).concat(h):[o].concat(h).concat(h)}else return o}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,n){const o=ze(n.layer);if(delete n.layer,n.numConstants!=null)throw new Xs("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const u=n;return u.layer=o,new t(u)}}wT.className="Bidirectional",li(wT);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function EO(r){return new x(r)}function SO(r){return new RI(r)}function CO(r){return new kI(r)}function _O(r){return new DI(r)}function IO(r){return new OI(r)}function TO(r){return new PI(r)}function AO(r){return new LI(r)}function MO(r){return new lx(r)}function NO(r){return new h1(r)}function kO(r){return new zI(r)}function DO(r){return new ux(r)}function OO(r){return new $I(r)}function RO(r){return new GI(r)}function LO(r){return new UI(r)}function PO(r){return new WI(r)}function FO(r){return new qI(r)}function BO(r){return new KI(r)}function zO(r){return new qE(r)}function $O(r){return new YI(r)}function GO(r){return new ZI(r)}function UO(r){return new QI(r)}function WO(r){return new JI(r)}function VO(r){return new tT(r)}function jO(r){return new nT(r)}function HO(r){return new hx(r)}function XO(r){return new px(r)}function YO(r){return new mx(r)}function KO(r){return new vx(r)}function ZO(r){return new gx(r)}function qO(r){return new dx(r)}function QO(r){return new rT(r)}function JO(r){return new sT(r)}function tR(r){return new uT(r)}function eR(r){return new lT(r)}function ET(r){return new fT(r)}function nR(r){return ET(r)}function rR(r){return ET(r)}function ST(r){return new dT(r)}function aR(r){return ST(r)}function iR(r){return ST(r)}function CT(r){return new vT(r)}function oR(r){return CT(r)}function sR(r){return CT(r)}function uR(r){return new gT(r)}function lR(r){return new yT(r)}function BM(r){return new mT(r)}function zM(r){return new bT(r)}function $M(r){return new cT(r)}function GM(r){return new hT(r)}function cR(r){return new pT(r)}function fR(r){return new jI(r)}function hR(r){return new YE(r)}function dR(r){return new HI(r)}function pR(r){return new fx(r)}function vR(r){return new VI(r)}function gR(r){return new XE(r)}function mR(r){return new XI(r)}function yR(r){return new ZE(r)}function bR(r){return new Yv(r)}function xR(r){return new KE(r)}function wR(r){return new wT(r)}function ER(r){return new xT(r)}const SR=BM,CR=zM,_R=$M,IR=GM;function TR(r){return new aT(r)}function AR(r){return new iT(r)}function MR(r){return new oT(r)}function NR(r){return new eT(r)}function kR(r,t){return jc(r,t)}function DR(r,t){return Zu(r,t)}function OR(r,t){return Il(r,t)}function RR(r,t){return Oh(r,t)}function LR(r,t){return Dc(r,t)}function PR(r,t){return Ku(r,t)}function FR(r,t){return Ks(r,t)}function BR(r,t){return Xi(r,t)}function zR(r,t){return Tn(r,t)}function $R(r,t){return cr(r,t)}function GR(r,t){return cr(r,t)}function UR(r,t){return cr(r,t)}function WR(r,t){return Fn(r,t)}function VR(r,t){return Fn(r,t)}function jR(r,t){return Fn(r,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 *//**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function HR(r){return new sx(r)}function XR(r){return fO(r)}function YR(r){return hO(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class UM extends ft{constructor(){super(...arguments);this.model=null}setModel(t){if(!(t instanceof Jg))throw new Error("model must be a LayersModel, not some other Container");this.model=t}}function JE(r,t){return r<t}function WM(r,t){return r>t}class VM extends UM{constructor(t){super();if(t==null&&(t={}),t.restoreBestWeights)throw new Xs("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=t.monitor||"val_loss",this.minDelta=Math.abs(t.minDelta||0),this.patience=t.patience||0,this.verbose=t.verbose||0,this.mode=t.mode||"auto",this.baseline=t.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=JE:this.mode==="max"?this.monitorFunc=WM:this.monitor.indexOf("acc")!==-1?this.monitorFunc=WM:this.monitorFunc=JE,this.monitorFunc===JE&&(this.minDelta*=-1)}onTrainBegin(t){return jr(this,null,function*(){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===JE?Infinity:-Infinity})}onEpochEnd(t,n){return jr(this,null,function*(){yield I(n);const o=this.getMonitorValue(n);o!=null&&(this.monitorFunc(o-this.minDelta,this.best)?(this.best=o,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)))})}onTrainEnd(t){return jr(this,null,function*(){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)})}getMonitorValue(t){t==null&&(t={});const n=t[this.monitor];return n==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(t)}`),n}}function KR(r){return new VM(r)}const ZR={earlyStopping:KR};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Kv;(function(r){r[r.DT_INVALID=0]="DT_INVALID",r[r.DT_FLOAT=1]="DT_FLOAT",r[r.DT_DOUBLE=2]="DT_DOUBLE",r[r.DT_INT32=3]="DT_INT32",r[r.DT_UINT8=4]="DT_UINT8",r[r.DT_INT16=5]="DT_INT16",r[r.DT_INT8=6]="DT_INT8",r[r.DT_STRING=7]="DT_STRING",r[r.DT_COMPLEX64=8]="DT_COMPLEX64",r[r.DT_INT64=9]="DT_INT64",r[r.DT_BOOL=10]="DT_BOOL",r[r.DT_QINT8=11]="DT_QINT8",r[r.DT_QUINT8=12]="DT_QUINT8",r[r.DT_QINT32=13]="DT_QINT32",r[r.DT_BFLOAT16=14]="DT_BFLOAT16",r[r.DT_FLOAT_REF=101]="DT_FLOAT_REF",r[r.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",r[r.DT_INT32_REF=103]="DT_INT32_REF",r[r.DT_UINT8_REF=104]="DT_UINT8_REF",r[r.DT_INT16_REF=105]="DT_INT16_REF",r[r.DT_INT8_REF=106]="DT_INT8_REF",r[r.DT_STRING_REF=107]="DT_STRING_REF",r[r.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",r[r.DT_INT64_REF=109]="DT_INT64_REF",r[r.DT_BOOL_REF=110]="DT_BOOL_REF",r[r.DT_QINT8_REF=111]="DT_QINT8_REF",r[r.DT_QUINT8_REF=112]="DT_QUINT8_REF",r[r.DT_QINT32_REF=113]="DT_QINT32_REF",r[r.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(Kv||(Kv={}));var jM;(function(r){let t;(function(n){n[n.LEGACY=0]="LEGACY",n[n.V1=1]="V1",n[n.V2=2]="V2"})(t=r.CheckpointFormatVersion||(r.CheckpointFormatVersion={}))})(jM||(jM={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _T={};function qR(r,t){const n={tfOpName:r,category:"custom",inputs:[],attrs:[],customExecutor:t};_T[r]=n}function HM(r){return _T[r]}function QR(r){delete _T[r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pe(r,t,n,o,u){const h=t.inputParams[r];if(h&&h.inputIndexStart!==void 0){const g=h.inputIndexStart,b=h.inputIndexEnd===0?void 0:h.inputIndexEnd===void 0?g+1:h.inputIndexEnd;if(h.type==="tensor")return Ad(t.inputNames[h.inputIndexStart],n,o,u);if(h.type==="tensors")return t.inputNames.slice(g,b).map(at=>Ad(at,n,o,u));const _=Ad(t.inputNames.slice(g)[0],n,o,u),z=_.dataSync();return h.type==="number"?z[0]:un(_.shape,z)}const p=t.attrParams[r];return p&&p.value}function Ad(r,t,n,o){const[u,h]=sp(r);if(o!=null){const g=o.getHashTableHandleByName(u);if(g!=null)return g}const p=n.currentContextIds.find(g=>!!t[tS(u,g)]);return p!==void 0?t[tS(u,p)][h]:void 0}function JR(r,t,n){return t[tS(r,n.currentContextId)]}function tm(r,t){const[n,o]=sp(r);return[tS(n,t&&t.currentContextId),o]}function tS(r,t){return t?`${r}-${t}`:r}function sp(r){const t=r.split(":");return t.length===1?[r,0]:[t[0],Number(t[t.length-1])]}function uj(r,t){const n=[];for(let o=0;o<r.length;o+=t)n.push(r.slice(o,o+t));return n}function eS(r,t,n){let o=Pe("pad",r,t,n);if(o==="explicit"){o=Pe("explicitPaddings",r,t,n);const u=[[0,0],[0,0],[0,0],[0,0]];for(let h=0;h<4;h++)u[h][0]=o[h*2],u[h][1]=o[h*2+1];return u}return o}function em(r){return r.kept?r:th(r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tL=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eL=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],nL=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}];/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rL=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aL=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iL=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oL=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sL=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],uL=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lL=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cL=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fL=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hL=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dL=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pL=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vL=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}];/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gL=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}];var XM=$(48764).Buffer;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YM{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[ht,mt,wt,ut,pt,Nt,Ut,Ne,Le,ue,we,At,Qt,de,rn,Ee,se],n=[].concat(...t.map(o=>o.json));this.opMappers=n.reduce((o,u)=>(o[u.tfOpName]=u,o),{})}transformGraph(t,n={}){const o=t.node,u=[],h=[],p=[],g=o.reduce((Tt,Wt)=>(Tt[Wt.name]=this.mapNode(Wt),Wt.op.startsWith("Placeholder")?u.push(Tt[Wt.name]):Wt.op==="Const"?h.push(Tt[Wt.name]):(Wt.input==null||Wt.input.length===0)&&p.push(Tt[Wt.name]),Tt),{});let b=[];const _=[];let z={},V={};n!=null&&(z=this.mapSignatureEntries(n.inputs),V=this.mapSignatureEntries(n.outputs));const at=Object.keys(g);at.forEach(Tt=>{const Wt=g[Tt];Wt.inputNames.forEach(le=>{const[ye]=tm(le);Wt.inputs.push(g[ye]),g[ye].children.push(Wt)})}),Object.keys(V).length===0?at.forEach(Tt=>{const Wt=g[Tt];Wt.children.length===0&&_.push(Wt)}):Object.keys(V).forEach(Tt=>{const[Wt]=tm(Tt),le=g[Wt];le!=null&&(le.signatureKey=V[Tt],_.push(le))}),Object.keys(z).length>0?Object.keys(z).forEach(Tt=>{const[Wt]=tm(Tt),le=g[Wt];le&&(le.signatureKey=z[Tt],b.push(le))}):b=u;let Et={};t.library!=null&&t.library.function!=null&&(Et=t.library.function.reduce((Tt,Wt)=>(Tt[Wt.signature.name]=this.mapFunction(Wt),Tt),{}));const St={nodes:g,inputs:b,outputs:_,weights:h,placeholders:u,signature:n,functions:Et};return p.length>0&&(St.initNodes=p),St}mapSignatureEntries(t){return Object.keys(t||{}).reduce((n,o)=>(n[t[o].name]=o,n),{})}mapNode(t){const n=HM(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});const o={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(u=>u.startsWith("^")?u.substr(1):u),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return n.inputs!=null&&(o.inputParams=n.inputs.reduce((u,h)=>(u[h.name]={type:h.type,inputIndexStart:h.start,inputIndexEnd:h.end},u),{})),n.attrs!=null&&(o.attrParams=n.attrs.reduce((u,h)=>{const p=h.type;let g;switch(h.type){case"string":g=IT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=IT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"string[]":g=RT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=RT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"number":g=AT(t.attr,h.tfName,h.defaultValue||0),g===void 0&&!!h.tfDeprecatedName&&(g=AT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"number[]":g=OT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=OT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"bool":g=TT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=TT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"bool[]":g=PT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=PT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"shape":g=DT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=DT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"shape[]":g=LT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=LT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"dtype":g=NT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=NT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"dtype[]":g=kT(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=kT(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"func":g=ZM(t.attr,h.tfName,h.defaultValue),g===void 0&&!!h.tfDeprecatedName&&(g=ZM(t.attr,h.tfDeprecatedName,h.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${h.type} for op: ${t.op}`)}return u[h.name]={value:g,type:p},u},{})),o}mapFunction(t){const n=t.nodeDef,o=[],u=[];let h={};n!=null&&(h=n.reduce((V,at)=>(V[at.name]=this.mapNode(at),at.op==="Const"&&u.push(V[at.name]),V),{}));const p=[],g=[];t.signature.inputArg.forEach(V=>{const[at]=tm(V.name),Et={name:at,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:MT(V.type),type:"dtype"}},children:[]};Et.signatureKey=V.name,p.push(Et),h[at]=Et}),Object.keys(h).forEach(V=>{const at=h[V];at.inputNames.forEach(Et=>{const[St]=tm(Et);at.inputs.push(h[St]),h[St].children.push(at)})});const _=t.ret;t.signature.outputArg.forEach(V=>{const[at,Et]=tm(_[V.name]),St=h[at];St!=null&&(St.defaultOutput=Et,g.push(St))});const z=this.mapArgsToSignature(t);return{nodes:h,inputs:p,outputs:g,weights:u,placeholders:o,signature:z}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((n,o)=>(n[o.name]=this.mapArgToTensorInfo(o),n),{}),outputs:t.signature.outputArg.reduce((n,o)=>(n[o.name]=this.mapArgToTensorInfo(o,t.ret),n),{})}}mapArgToTensorInfo(t,n){let o=t.name;return n!=null&&(o=n[o]),{name:o,dtype:t.type}}}function mL(r){const t=He().global;if(typeof t.atob!="undefined")return t.atob(r);if(typeof XM!="undefined")return new XM(r,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function KM(r,t){const n=Array.isArray(r)?String.fromCharCode.apply(null,r):mL(r);return t?n:n.toLowerCase()}function IT(r,t,n,o=!1){const u=r[t];return u!=null?KM(u.s,o):n}function TT(r,t,n){const o=r[t];return o?o.b:n}function AT(r,t,n){const o=r[t]||{},u=o.i!=null?o.i:o.f!=null?o.f:n;return typeof u=="number"?u:parseInt(u,10)}function MT(r){switch(typeof r=="string"&&(r=Kv[r]),r){case Kv.DT_FLOAT:return"float32";case Kv.DT_INT32:case Kv.DT_INT64:case Kv.DT_INT8:case Kv.DT_UINT8:return"int32";case Kv.DT_BOOL:return"bool";case Kv.DT_DOUBLE:return"float32";case Kv.DT_STRING:return"string";default:return null}}function ZM(r,t,n){const o=r[t];return o&&o.func?o.func.name:n}function NT(r,t,n){const o=r[t];return o&&o.type?MT(o.type):n}function kT(r,t,n){const o=r[t];return o&&o.list&&o.list.type?o.list.type.map(u=>MT(u)):n}function qM(r){if(!r.unknownRank)return r.dim!=null?r.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function DT(r,t,n){const o=r[t];return o&&o.shape?qM(o.shape):n}function OT(r,t,n){const o=r[t];return o?((o.list.f&&o.list.f.length?o.list.f:o.list.i)||[]).map(u=>typeof u=="number"?u:parseInt(u,10)):n}function RT(r,t,n,o=!1){const u=r[t];return u&&u.list&&u.list.s?u.list.s.map(h=>KM(h,o)):n}function LT(r,t,n){const o=r[t];return o&&o.list&&o.list.shape?o.list.shape.map(u=>qM(u)):n}function PT(r,t,n){const o=r[t];return o&&o.list&&o.list.b?o.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yL{constructor(t,n,o){this.node=t,this.tensorMap=n,this.context=o,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(u=>this.getInput(u)),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce((u,h)=>(u[h]=this.getAttr(h),u),{}))}getInput(t){return Ad(t,this.tensorMap,this.context)}getAttr(t,n){const o=this.node.rawAttrs[t];if(o.tensor!=null)return Ad(t,this.tensorMap,this.context);if(o.i!=null||o.f!=null)return AT(this.node.rawAttrs,t,n);if(o.s!=null)return IT(this.node.rawAttrs,t,n);if(o.b!=null)return TT(this.node.rawAttrs,t,n);if(o.shape!=null)return DT(this.node.rawAttrs,t,n);if(o.type!=null)return NT(this.node.rawAttrs,t,n);if(o.list!=null){if(o.list.i!=null||o.list.f!=null)return OT(this.node.rawAttrs,t,n);if(o.list.s!=null)return RT(this.node.rawAttrs,t,n);if(o.list.shape!=null)return LT(this.node.rawAttrs,t,n);if(o.list.b!=null)return PT(this.node.rawAttrs,t,n);if(o.list.type!=null)return kT(this.node.rawAttrs,t,n)}return n}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bL=(r,t,n)=>{switch(r.op){case"BiasAdd":case"AddV2":case"Add":return[En(Pe("a",r,t,n),Pe("b",r,t,n))];case"AddN":return[fr(Pe("tensors",r,t,n))];case"FloorMod":case"Mod":return[ry(Pe("a",r,t,n),Pe("b",r,t,n))];case"Mul":return[Hn(Pe("a",r,t,n),Pe("b",r,t,n))];case"RealDiv":case"Div":return[or(Pe("a",r,t,n),Pe("b",r,t,n))];case"DivNoNan":return[_g(Pe("a",r,t,n),Pe("b",r,t,n))];case"FloorDiv":return[Dr(Pe("a",r,t,n),Pe("b",r,t,n))];case"Sub":return[pi(Pe("a",r,t,n),Pe("b",r,t,n))];case"Minimum":return[og(Pe("a",r,t,n),Pe("b",r,t,n))];case"Maximum":return[Jo(Pe("a",r,t,n),Pe("b",r,t,n))];case"Pow":return[po(Pe("a",r,t,n),Pe("b",r,t,n))];case"SquaredDifference":return[i0(Pe("a",r,t,n),Pe("b",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},lj="arithmetic";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xL=(r,t,n)=>{switch(r.op){case"Abs":case"ComplexAbs":return[fl(Pe("x",r,t,n))];case"Acos":return[yr(Pe("x",r,t,n))];case"Acosh":return[Mr(Pe("x",r,t,n))];case"Asin":return[Qi(Pe("x",r,t,n))];case"Asinh":return[Mo(Pe("x",r,t,n))];case"Atan":return[yl(Pe("x",r,t,n))];case"Atan2":return[Ih(Pe("x",r,t,n),Pe("y",r,t,n))];case"Atanh":return[Lv(Pe("x",r,t,n))];case"Ceil":return[Li(Pe("x",r,t,n))];case"Complex":return[Pf(Pe("real",r,t,n),Pe("imag",r,t,n))];case"Cos":return[Zh(Pe("x",r,t,n))];case"Cosh":return[Bc(Pe("x",r,t,n))];case"Elu":return[fm(Pe("x",r,t,n))];case"Erf":return[H0(Pe("x",r,t,n))];case"Exp":return[Qh(Pe("x",r,t,n))];case"Expm1":return[X0(Pe("x",r,t,n))];case"Floor":return[Ig(Pe("x",r,t,n))];case"Log":return[zc(Pe("x",r,t,n))];case"Log1p":return[q0(Pe("x",r,t,n))];case"Imag":return[Z0(Pe("x",r,t,n))];case"Neg":return[oi(Pe("x",r,t,n))];case"Reciprocal":return[q1(Pe("x",r,t,n))];case"Real":return[gm(Pe("x",r,t,n))];case"Relu":return[td(Pe("x",r,t,n))];case"Round":return[Q1(Pe("x",r,t,n))];case"Selu":return[Dg(Pe("x",r,t,n))];case"Sigmoid":return[Bt(Pe("x",r,t,n))];case"Sin":return[uy(Pe("x",r,t,n))];case"Sign":return[tb(Pe("x",r,t,n))];case"Sinh":return[ly(Pe("x",r,t,n))];case"Softplus":return[hm(Pe("x",r,t,n))];case"Sqrt":return[Ci(Pe("x",r,t,n))];case"Square":return[_i(Pe("x",r,t,n))];case"Tanh":return[be(Pe("x",r,t,n))];case"Tan":return[rb(Pe("x",r,t,n))];case"ClipByValue":return[fi(Pe("x",r,t,n),Pe("clipValueMin",r,t,n),Pe("clipValueMax",r,t,n))];case"Relu6":return[Jm(Pe("x",r,t,n))];case"Rsqrt":return[sy(Ad(r.inputNames[0],t,n))];case"Prod":return[oy(Pe("x",r,t,n),Pe("axes",r,t,n))];case"LeakyRelu":return[Hm(Pe("x",r,t,n),Pe("alpha",r,t,n))];case"Prelu":return[kg(Pe("x",r,t,n),Pe("alpha",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},cj="basic_math";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cv(r,t,n=""){bt(wL(r,t),()=>n+` Shapes ${r} and ${t} must match`)}function wL(r,t){if(r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(r[n]!==-1&&t[n]!==-1&&r[n]!==t[n])return!1;return!0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EL{constructor(t,n,o,u,h,p,g){this.name=t,this.dtype=n,this.maxSize=o,this.elementShape=u,this.identicalElementShapes=h,this.dynamicSize=p,this.clearAfterRead=g,this.tensors=[],this.closed_=!1,this.idTensor=zi(0),q(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const n=this.tensors[t];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(t){return t.map(n=>this.read(n))}write(t,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const o=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Cv(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),o.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(o.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);o.tensor=n,q(n),o.written=!0,this.tensors[t]=o}writeMany(t,n){if(t.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${n.length}.`);t.forEach((o,u)=>this.write(o,n[u]))}gather(t,n){if(!!n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(t)t=t.slice(0,this.size());else{t=[];for(let u=0;u<this.size();u++)t.push(u)}if(t.length===0)return yc([],[0].concat(this.elementShape));const o=this.readMany(t);return Cv(this.elementShape,o[0].shape,"TensorArray shape mismatch: "),rd(o,0)}concat(t){if(!!t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(this.size()===0)return yc([],[0].concat(this.elementShape));const n=[];for(let u=0;u<this.size();u++)n.push(u);const o=this.readMany(n);return Cv(this.elementShape,o[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${o[0].shape})`),vt(o,0)}scatter(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);const o=Math.max(...t);if(!this.dynamicSize&&o>=this.maxSize)throw new Error(`Max index must be < array size (${o}  vs. ${this.maxSize})`);this.writeMany(t,Sd(n,0))}split(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let o=0;const u=t.map(b=>(o+=b,o));if(o!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${o}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const h=o===0?0:n.size/o,p=[];Vn(()=>{n=m(n,[1,o,h]);for(let b=0;b<t.length;++b){const _=b===0?0:u[b-1],z=[0,_,0],V=[1,t[b],h];p[b]=m(Zt(n,z,V),this.elementShape)}return p});const g=[];for(let b=0;b<t.length;b++)g[b]=b;this.writeMany(g,p)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d1{constructor(t,n,o,u=-1){this.tensors=t,this.elementShape=n,this.elementDtype=o,t!=null&&t.forEach(h=>{if(o!==h.dtype)throw new Error(`Invalid data types; op elements ${o}, but list elements ${h.dtype}`);Cv(n,h.shape,"TensorList shape mismatch: "),q(h)}),this.idTensor=zi(0),this.maxNumElements=u,q(this.idTensor)}get id(){return this.idTensor.id}copy(){return new d1([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,n,o=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(o!==-1&&this.tensors.length!==o)throw new Error(`Operation expected a list with ${o} elements but got a list with ${this.tensors.length} elements.`);return Cv(t,this.elementShape,"TensorList shape mismatch: "),Vn(()=>{const u=this.tensors.map(h=>m(h,t));return rd(u,0)})}popBack(t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const o=this.tensors.pop();return Cv(o.shape,t,"TensorList shape mismatch: "),m(o,t)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(Cv(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");q(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);this.tensors.length=t}getItem(t,n,o){if(o!==this.elementDtype)throw new Error(`Invalid data types; op elements ${o}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);return Cv(this.tensors[t].shape,n,"TensorList shape mismatch: "),this.tensors[t]}setItem(t,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);Cv(this.elementShape,n.shape,"TensorList shape mismatch: "),q(n),this.tensors[t]=n}gather(t,n,o){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);return Cv(this.elementShape,o,"TensorList shape mismatch: "),t=t.slice(0,this.size()),t.length===0?yc([],[0].concat(this.elementShape)):Vn(()=>{const u=t.map(h=>m(this.tensors[h],o));return rd(u,0)})}concat(t,n){if(!!t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);return Cv(this.elementShape,n,"TensorList shape mismatch: "),this.size()===0?yc([],[0].concat(this.elementShape)):Vn(()=>{const o=this.tensors.map(u=>m(u,n));return vt(o,0)})}}function SL(r,t,n){const o=r.dtype;if(r.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${r.shape}`);if(r.dtype!==n)throw new Error(`Invalid data types; op elements ${r.dtype}, but list elements ${n}`);const u=r.shape.slice(1);Cv(u,t,"TensorList shape mismatch: ");const h=Sd(r);return new d1(h,t,o)}function CL(r,t,n){return new d1([],r,t,n)}function _L(r,t,n,o){if(t.length!==r.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${r.shape[0]}`);const u=Math.max(...t);if(o!=null&&o!==-1&&u>=o)throw new Error(`Max index must be < array size (${u}  vs. ${o})`);const h=new d1([],n,r.dtype,o),p=Sd(r,0);return t.forEach((g,b)=>{h.setItem(g,p[b])}),h}function IL(r,t,n){let o=0;const u=t.map(b=>(o+=b,o));if(o!==r.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${o}, and tensor's shape is: ${r.shape}`);const h=o===0?0:r.size/o,p=Vn(()=>{const b=[];r=m(r,[1,o,h]);for(let _=0;_<t.length;++_){const z=_===0?0:u[_-1],V=[0,z,0],at=[1,t[_],h];b[_]=m(Zt(r,V,at),n)}return r.dispose(),b}),g=new d1([],n,r.dtype,t.length);for(let b=0;b<p.length;b++)g.setItem(b,p[b]);return g}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TL=(r,t,n)=>jr(this,null,function*(){switch(r.op){case"If":case"StatelessIf":{const o=Pe("thenBranch",r,t,n),u=Pe("elseBranch",r,t,n),h=Pe("cond",r,t,n),p=Pe("args",r,t,n);return(yield h.data())[0]?n.functionMap[o].executeFunctionAsync(p,n.tensorArrayMap,n.tensorListMap):n.functionMap[u].executeFunctionAsync(p,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const o=Pe("body",r,t,n),u=Pe("cond",r,t,n),h=Pe("args",r,t,n),p=yield n.functionMap[u].executeFunctionAsync(h,n.tensorArrayMap,n.tensorListMap),g=h.map(z=>z.id);let b=yield p[0].data();p.forEach(z=>{!z.kept&&g.indexOf(z.id)===-1&&z.dispose()});let _=h;for(;b[0];){const z=_;_=yield n.functionMap[o].executeFunctionAsync(_,n.tensorArrayMap,n.tensorListMap);const V=_.map(Et=>Et.id);z.forEach(Et=>{!Et.kept&&g.indexOf(Et.id)===-1&&V.indexOf(Et.id)===-1&&Et.dispose()});const at=yield n.functionMap[u].executeFunctionAsync(_,n.tensorArrayMap,n.tensorListMap);b=yield at[0].data(),at.forEach(Et=>{!Et.kept&&g.indexOf(Et.id)===-1&&V.indexOf(Et.id)===-1&&Et.dispose()})}return _}case"LoopCond":{const o=Pe("pred",r,t,n);return[em(o)]}case"Switch":{const o=Pe("pred",r,t,n);let u=Pe("data",r,t,n);return u.kept||(u=em(u)),(yield o.data())[0]?[void 0,u]:[u,void 0]}case"Merge":{const o=r.inputNames.find(u=>Ad(u,t,n)!==void 0);if(o){const u=Ad(o,t,n);return[em(u)]}return}case"Enter":{const o=Pe("frameName",r,t,n),u=Pe("tensor",r,t,n);return n.enterFrame(o),[em(u)]}case"Exit":{const o=Pe("tensor",r,t,n);return n.exitFrame(),[em(o)]}case"NextIteration":{const o=Pe("tensor",r,t,n);return n.nextIteration(),[em(o)]}case"TensorArrayV3":{const o=Pe("size",r,t,n),u=Pe("dtype",r,t,n),h=Pe("elementShape",r,t,n),p=Pe("dynamicSize",r,t,n),g=Pe("clearAfterRead",r,t,n),b=Pe("identicalElementShapes",r,t,n),_=Pe("name",r,t,n),z=new EL(_,u,o,h,b,p,g);return n.addTensorArray(z),[z.idTensor,zi(1)]}case"TensorArrayWriteV3":{const o=Pe("tensorArrayId",r,t,n),u=Pe("index",r,t,n),h=Pe("tensor",r,t,n),p=n.getTensorArray(o.id);return p.write(u,h),[p.idTensor]}case"TensorArrayReadV3":{const o=Pe("tensorArrayId",r,t,n),u=Pe("index",r,t,n);return[n.getTensorArray(o.id).read(u)]}case"TensorArrayGatherV3":{const o=Pe("tensorArrayId",r,t,n),u=Pe("indices",r,t,n),h=Pe("dtype",r,t,n);return[n.getTensorArray(o.id).gather(u,h)]}case"TensorArrayScatterV3":{const o=Pe("tensorArrayId",r,t,n),u=Pe("indices",r,t,n),h=Pe("tensor",r,t,n),p=n.getTensorArray(o.id);return p.scatter(u,h),[p.idTensor]}case"TensorArrayConcatV3":{const o=Pe("tensorArrayId",r,t,n),u=n.getTensorArray(o.id),h=Pe("dtype",r,t,n);return[u.concat(h)]}case"TensorArraySplitV3":{const o=Pe("tensorArrayId",r,t,n),u=Pe("tensor",r,t,n),h=Pe("lengths",r,t,n),p=n.getTensorArray(o.id);return p.split(h,u),[p.idTensor]}case"TensorArraySizeV3":{const o=Pe("tensorArrayId",r,t,n),u=n.getTensorArray(o.id);return[zi(u.size(),"int32")]}case"TensorArrayCloseV3":{const o=Pe("tensorArrayId",r,t,n),u=n.getTensorArray(o.id);return u.clearAndClose(),[u.idTensor]}case"TensorListSetItem":{const o=Pe("tensorListId",r,t,n),u=Pe("index",r,t,n),h=Pe("tensor",r,t,n),p=n.getTensorList(o.id);return p.setItem(u,h),[p.idTensor]}case"TensorListGetItem":{const o=Pe("tensorListId",r,t,n),u=Pe("index",r,t,n),h=Pe("elementShape",r,t,n),p=Pe("elementDType",r,t,n);return[n.getTensorList(o.id).getItem(u,h,p)]}case"TensorListScatterV2":case"TensorListScatter":{const o=Pe("indices",r,t,n),u=Pe("tensor",r,t,n),h=Pe("elementShape",r,t,n),p=Pe("numElements",r,t,n),g=_L(u,o,h,p);return n.addTensorList(g),[g.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const o=Pe("elementShape",r,t,n),u=Pe("elementDType",r,t,n);let h;r.op==="TensorListReserve"?h="numElements":h="maxNumElements";const p=Pe(h,r,t,n),g=CL(o,u,p);return n.addTensorList(g),[g.idTensor]}case"TensorListGather":{const o=Pe("tensorListId",r,t,n),u=Pe("indices",r,t,n),h=Pe("elementShape",r,t,n),p=Pe("elementDType",r,t,n);return[n.getTensorList(o.id).gather(u,p,h)]}case"TensorListStack":{const o=Pe("tensorListId",r,t,n),u=Pe("elementShape",r,t,n),h=Pe("elementDType",r,t,n),p=Pe("numElements",r,t,n);return[n.getTensorList(o.id).stack(u,h,p)]}case"TensorListFromTensor":{const o=Pe("tensor",r,t,n),u=Pe("elementShape",r,t,n),h=Pe("elementDType",r,t,n),p=SL(o,u,h);return n.addTensorList(p),[p.idTensor]}case"TensorListConcat":{const o=Pe("tensorListId",r,t,n),u=n.getTensorList(o.id),h=Pe("dtype",r,t,n),p=Pe("elementShape",r,t,n);return[u.concat(h,p)]}case"TensorListPushBack":{const o=Pe("tensorListId",r,t,n),u=Pe("tensor",r,t,n),h=n.getTensorList(o.id);return h.pushBack(u),[h.idTensor]}case"TensorListPopBack":{const o=Pe("tensorListId",r,t,n),u=Pe("elementShape",r,t,n),h=Pe("elementDType",r,t,n);return[n.getTensorList(o.id).popBack(u,h)]}case"TensorListSplit":{const o=Pe("tensor",r,t,n),u=Pe("elementShape",r,t,n),h=Pe("lengths",r,t,n),p=IL(o,h,u);return n.addTensorList(p),[p.idTensor]}default:throw TypeError(`Node type ${r.op} is not implemented`)}}),fj="control";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QM(r,t,n){const[o,u]=Pe("fusedOps",r,t,n),h=o==="biasadd",p=u==="prelu",g=o==="fusedbatchnorm",b=Pe("numArgs",r,t,n);if(h){if(p&&b!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!p&&b!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(g)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");const _=Pe("strides",r,t,n),z=eS(r,t,n),V=Pe("dataFormat",r,t,n).toUpperCase(),at=Pe("dilations",r,t,n),[Et,St]=Pe("args",r,t,n),Tt=Pe("leakyreluAlpha",r,t,n);return{stride:_,pad:z,dataFormat:V,dilations:at,biasArg:Et,preluArg:St,activationFunc:u,leakyreluAlpha:Tt}}const AL=(r,t,n)=>{switch(r.op){case"Conv1D":{const o=Pe("stride",r,t,n),u=Pe("pad",r,t,n),h=Pe("dataFormat",r,t,n).toUpperCase(),p=Pe("dilation",r,t,n);return[Bo(Pe("x",r,t,n),Pe("filter",r,t,n),o,u,h,p)]}case"Conv2D":{const o=Pe("strides",r,t,n),u=eS(r,t,n),h=Pe("dataFormat",r,t,n).toUpperCase(),p=Pe("dilations",r,t,n);return[rs(Pe("x",r,t,n),Pe("filter",r,t,n),[o[1],o[2]],u,h,[p[1],p[2]])]}case"_FusedConv2D":{const{stride:o,pad:u,dataFormat:h,dilations:p,biasArg:g,preluArg:b,activationFunc:_,leakyreluAlpha:z}=QM(r,t,n);return[lb({x:Pe("x",r,t,n),filter:Pe("filter",r,t,n),strides:[o[1],o[2]],pad:u,dataFormat:h,dilations:[p[1],p[2]],bias:g,activation:_,preluActivationWeights:b,leakyreluAlpha:z})]}case"FusedDepthwiseConv2dNative":{const{stride:o,pad:u,dataFormat:h,dilations:p,biasArg:g,preluArg:b,activationFunc:_,leakyreluAlpha:z}=QM(r,t,n);return[Ew({x:Pe("x",r,t,n),filter:Pe("filter",r,t,n),strides:[o[1],o[2]],pad:u,dataFormat:h,dilations:[p[1],p[2]],bias:g,activation:_,preluActivationWeights:b,leakyreluAlpha:z})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const o=Pe("outputShape",r,t,n),u=Pe("strides",r,t,n),h=eS(r,t,n);return[Nl(Pe("x",r,t,n),Pe("filter",r,t,n),o,[u[1],u[2]],h)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const o=Pe("strides",r,t,n),u=eS(r,t,n),h=Pe("dilations",r,t,n),p=Pe("dataFormat",r,t,n).toUpperCase();return[dv(Pe("input",r,t,n),Pe("filter",r,t,n),[o[1],o[2]],u,p,[h[1],h[2]])]}case"Conv3D":{const o=Pe("strides",r,t,n),u=Pe("pad",r,t,n),h=Pe("dataFormat",r,t,n).toUpperCase(),p=Pe("dilations",r,t,n);return[nu(Pe("x",r,t,n),Pe("filter",r,t,n),[o[1],o[2],o[3]],u,h,[p[1],p[2],p[3]])]}case"AvgPool":{const o=Pe("strides",r,t,n),u=Pe("pad",r,t,n),h=Pe("kernelSize",r,t,n);return[S(Pe("x",r,t,n),[h[1],h[2]],[o[1],o[2]],u)]}case"MaxPool":{const o=Pe("strides",r,t,n),u=Pe("pad",r,t,n),h=Pe("kernelSize",r,t,n);return[Ng(Pe("x",r,t,n),[h[1],h[2]],[o[1],o[2]],u)]}case"MaxPoolWithArgmax":{const o=Pe("strides",r,t,n),u=Pe("pad",r,t,n),h=Pe("kernelSize",r,t,n),p=Pe("includeBatchInIndex",r,t,n),{result:g,indexes:b}=ny(Pe("x",r,t,n),[h[1],h[2]],[o[1],o[2]],u,p);return[g,b]}case"AvgPool3D":{const o=Pe("strides",r,t,n),u=Pe("pad",r,t,n),h=Pe("kernelSize",r,t,n);return[J(Pe("x",r,t,n),[h[1],h[2],h[3]],[o[1],o[2],o[3]],u)]}case"MaxPool3D":{const o=Pe("strides",r,t,n),u=Pe("pad",r,t,n),h=Pe("kernelSize",r,t,n);return[ey(Pe("x",r,t,n),[h[1],h[2],h[3]],[o[1],o[2],o[3]],u)]}case"Dilation2D":{const o=Pe("strides",r,t,n),u=Pe("pad",r,t,n),h=Pe("dilations",r,t,n),p=o[1],g=o[2],b=h[1],_=h[2];return[lm(Pe("x",r,t,n),Pe("filter",r,t,n),[p,g],u,[b,_],"NHWC")]}default:throw TypeError(`Node type ${r.op} is not implemented`)}},hj="convolution";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ML=(r,t,n)=>{switch(r.op){case"Fill":{const o=Pe("shape",r,t,n),u=Pe("dtype",r,t,n),h=Pe("value",r,t,n);return[Qo(o,h,u)]}case"LinSpace":{const o=Pe("start",r,t,n),u=Pe("stop",r,t,n),h=Pe("num",r,t,n);return[Bx(o,u,h)]}case"Multinomial":{const o=Pe("logits",r,t,n),u=Pe("numSamples",r,t,n),h=Pe("seed",r,t,n);return[Xx(o,u,h)]}case"OneHot":{const o=Pe("indices",r,t,n),u=Pe("depth",r,t,n),h=Pe("onValue",r,t,n),p=Pe("offValue",r,t,n);return[Mc(o,u,h,p)]}case"Ones":return[Op(Pe("shape",r,t,n),Pe("dtype",r,t,n))];case"OnesLike":return[Jh(Pe("x",r,t,n))];case"RandomUniform":return[du(Pe("shape",r,t,n),Pe("minval",r,t,n),Pe("maxval",r,t,n),Pe("dtype",r,t,n))];case"Range":{const o=Pe("start",r,t,n),u=Pe("stop",r,t,n),h=Pe("step",r,t,n);return[Z1(o,u,h,Pe("dtype",r,t,n))]}case"TruncatedNormal":{const o=Pe("shape",r,t,n),u=Pe("mean",r,t,n),h=Pe("stdDev",r,t,n),p=Pe("seed",r,t,n);return[dy(o,u,h,Pe("dtype",r,t,n),p)]}case"Zeros":return[Uc(Pe("shape",r,t,n),Pe("dtype",r,t,n))];case"ZerosLike":return[xi(Pe("x",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},dj="creation";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FT(r,t,n){const o=Pe("boxes",r,t,n),u=Pe("scores",r,t,n),h=Pe("maxOutputSize",r,t,n),p=Pe("iouThreshold",r,t,n),g=Pe("scoreThreshold",r,t,n),b=Pe("softNmsSigma",r,t,n);return{boxes:o,scores:u,maxOutputSize:h,iouThreshold:p,scoreThreshold:g,softNmsSigma:b}}const NL=(r,t,n)=>jr(this,null,function*(){switch(r.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:u,maxOutputSize:h,iouThreshold:p,scoreThreshold:g,softNmsSigma:b}=FT(r,t,n),_=yield dg.nonMaxSuppressionWithScoreAsync(o,u,h,p,g,b);return[_.selectedIndices,_.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:u,maxOutputSize:h,iouThreshold:p,scoreThreshold:g}=FT(r,t,n),b=Pe("padToMaxOutputSize",r,t,n),_=yield dg.nonMaxSuppressionPaddedAsync(o,u,h,p,g,b);return[_.selectedIndices,_.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:u,maxOutputSize:h,iouThreshold:p,scoreThreshold:g}=FT(r,t,n);return[yield dg.nonMaxSuppressionAsync(o,u,h,p,g)]}case"Where":{const o=qi(Pe("condition",r,t,n),"bool"),u=[yield u0(o)];return o.dispose(),u}case"ListDiff":return aw(Pe("x",r,t,n),Pe("y",r,t,n));default:throw TypeError(`Node type ${r.op} is not implemented`)}}),pj="dynamic";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kL=(r,t,n)=>{switch(r.op){case"TopKV2":{const o=Pe("x",r,t,n),u=Pe("k",r,t,n),h=Pe("sorted",r,t,n),p=bm(o,u,h);return[p.values,p.indices]}case"Unique":{const o=Pe("x",r,t,n),u=py(o);return[u.values,u.indices]}case"UniqueV2":{const o=Pe("x",r,t,n),u=Pe("axis",r,t,n),h=py(o,u);return[h.values,h.indices]}default:throw TypeError(`Node type ${r.op} is not implemented`)}},vj="evaluation";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DL=(r,t,n)=>{switch(r.op){case"Const":return t[r.name];case"PlaceholderWithDefault":const o=Pe("default",r,t,n);return[Ad(r.name,t,n)||o];case"Placeholder":return[Ad(r.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const _=Pe("x",r,t,n);return[em(_)]}case"IdentityN":return Pe("x",r,t,n).map(_=>em(_));case"Snapshot":const u=Pe("x",r,t,n);return[em(u)];case"Shape":return[ad(Pe("x",r,t,n).shape,"int32")];case"ShapeN":return Pe("x",r,t,n).map(_=>ad(_.shape));case"Size":return[zi(Pe("x",r,t,n).size,"int32")];case"Rank":return[zi(Pe("x",r,t,n).rank,"int32")];case"NoOp":return[zi(1)];case"Print":const h=Pe("x",r,t,n),p=Pe("data",r,t,n),g=Pe("message",r,t,n),b=Pe("summarize",r,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(g);for(let _=0;_<p.length;_++)console.log(Array.prototype.slice.call(p[_].dataSync()).slice(0,b));return[h];default:throw TypeError(`Node type ${r.op} is not implemented`)}},gj="graph";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OL{constructor(t,n){this.keyDType=t,this.valueDType=n,this.handle=zi(0),this.tensorMap=new Map,q(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}import(t,n){return jr(this,null,function*(){this.checkKeyAndValueTensor(t,n);const o=yield t.data();return this.tensorMap.forEach(u=>u.dispose()),this.tensorMap.clear(),Vn(()=>{const u=Sd(n),h=o.length,p=u.length;bt(h===p,()=>`The number of elements doesn't match, keys has ${h} elements, the values has ${p} elements.`);for(let g=0;g<h;g++){const b=o[g],_=u[g];q(_),this.tensorMap.set(b,_)}return this.handle})})}find(t,n){return jr(this,null,function*(){this.checkKeyAndValueTensor(t,n);const o=yield t.data();return Vn(()=>{const u=[];for(let h=0;h<o.length;h++){const p=o[h],g=this.findWithDefault(p,n);u.push(g)}return rd(u)})})}findWithDefault(t,n){const o=this.tensorMap.get(t);return o!=null?o:n}checkKeyAndValueTensor(t,n){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RL=(r,t,n,o)=>jr(this,null,function*(){switch(r.op){case"HashTable":case"HashTableV2":{const u=Pe("keyDType",r,t,n),h=Pe("valueDType",r,t,n),p=new OL(u,h);return o.addHashTable(r.name,p),[p.handle]}case"LookupTableImport":case"LookupTableImportV2":{const u=Pe("tableHandle",r,t,n,o),h=Pe("keys",r,t,n),p=Pe("values",r,t,n);return[yield o.getHashTableById(u.id).import(h,p)]}case"LookupTableFind":case"LookupTableFindV2":{const u=Pe("tableHandle",r,t,n,o),h=Pe("keys",r,t,n),p=Pe("defaultValue",r,t,n);return[yield o.getHashTableById(u.id).find(h,p)]}default:throw TypeError(`Node type ${r.op} is not implemented`)}}),mj="hash_table";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LL=(r,t,n)=>{switch(r.op){case"ResizeBilinear":{const o=Pe("images",r,t,n),u=Pe("size",r,t,n),h=Pe("alignCorners",r,t,n),p=Pe("halfPixelCenters",r,t,n);return[dg.resizeBilinear(o,[u[0],u[1]],h,p)]}case"ResizeNearestNeighbor":{const o=Pe("images",r,t,n),u=Pe("size",r,t,n),h=Pe("alignCorners",r,t,n),p=Pe("halfPixelCenters",r,t,n);return[dg.resizeNearestNeighbor(o,[u[0],u[1]],h,p)]}case"CropAndResize":{const o=Pe("image",r,t,n),u=Pe("boxes",r,t,n),h=Pe("boxInd",r,t,n),p=Pe("cropSize",r,t,n),g=Pe("method",r,t,n),b=Pe("extrapolationValue",r,t,n);return[dg.cropAndResize(o,u,h,p,g,b)]}default:throw TypeError(`Node type ${r.op} is not implemented`)}},yj="image";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PL=(r,t,n)=>{switch(r.op){case"Equal":return[bd(Pe("a",r,t,n),Pe("b",r,t,n))];case"NotEqual":return[sg(Pe("a",r,t,n),Pe("b",r,t,n))];case"Greater":return[Ah(Pe("a",r,t,n),Pe("b",r,t,n))];case"GreaterEqual":return[Bv(Pe("a",r,t,n),Pe("b",r,t,n))];case"Less":return[Xm(Pe("a",r,t,n),Pe("b",r,t,n))];case"LessEqual":return[Sc(Pe("a",r,t,n),Pe("b",r,t,n))];case"LogicalAnd":return[Ed(Pe("a",r,t,n),Pe("b",r,t,n))];case"LogicalNot":return[ag(Pe("a",r,t,n))];case"LogicalOr":return[Ag(Pe("a",r,t,n),Pe("b",r,t,n))];case"Select":case"SelectV2":return[Cl(Pe("condition",r,t,n),Pe("a",r,t,n),Pe("b",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},bj="logical";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FL=(r,t,n)=>{switch(r.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[$s(Pe("a",r,t,n),Pe("b",r,t,n),Pe("transposeA",r,t,n),Pe("transposeB",r,t,n))];case"Transpose":return[mu(Pe("x",r,t,n),Pe("perm",r,t,n))];case"_FusedMatMul":const[o,u]=Pe("fusedOps",r,t,n),h=o==="biasadd",p=u==="prelu",g=Pe("numArgs",r,t,n),b=Pe("leakyreluAlpha",r,t,n);if(h){if(p&&g!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!p&&g!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[_,z]=Pe("args",r,t,n);return[h0({a:Pe("a",r,t,n),b:Pe("b",r,t,n),transposeA:Pe("transposeA",r,t,n),transposeB:Pe("transposeB",r,t,n),bias:_,activation:u,preluActivationWeights:z,leakyreluAlpha:b})];default:throw TypeError(`Node type ${r.op} is not implemented`)}},xj="matrices";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BL=(r,t,n)=>{switch(r.op){case"FusedBatchNorm":case"FusedBatchNormV2":return[Yn(Pe("x",r,t,n),Pe("mean",r,t,n),Pe("variance",r,t,n),Pe("offset",r,t,n),Pe("scale",r,t,n),Pe("epsilon",r,t,n))];case"FusedBatchNormV3":return[Yn(Pe("x",r,t,n),Pe("mean",r,t,n),Pe("variance",r,t,n),Pe("offset",r,t,n),Pe("scale",r,t,n),Pe("epsilon",r,t,n))];case"LRN":return[F1(Pe("x",r,t,n),Pe("radius",r,t,n),Pe("bias",r,t,n),Pe("alpha",r,t,n),Pe("beta",r,t,n))];case"Softmax":return[n0(Pe("x",r,t,n))];case"LogSoftmax":return[Q0(Pe("x",r,t,n))];case"SparseToDense":return[by(Pe("sparseIndices",r,t,n),Pe("outputShape",r,t,n),Pe("sparseValues",r,t,n),Pe("defaultValue",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},wj="normalization";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zL=(r,t,n)=>{switch(r.op){case"Max":{const p=Pe("axis",r,t,n),g=Pe("keepDims",r,t,n);return[Gf(Pe("x",r,t,n),p,g)]}case"Mean":{const p=Pe("axis",r,t,n),g=Pe("keepDims",r,t,n);return[nc(Pe("x",r,t,n),p,g)]}case"Min":{const p=Pe("axis",r,t,n),g=Pe("keepDims",r,t,n);return[ig(Pe("x",r,t,n),p,g)]}case"Sum":{const p=Pe("axis",r,t,n),g=Pe("keepDims",r,t,n);return[ss(Pe("x",r,t,n),p,g)]}case"All":{const p=Pe("axis",r,t,n),g=Pe("keepDims",r,t,n);return[Or(Pe("x",r,t,n),p,g)]}case"Any":{const p=Pe("axis",r,t,n),g=Pe("keepDims",r,t,n);return[wa(Pe("x",r,t,n),p,g)]}case"ArgMax":{const p=Pe("axis",r,t,n);return[ga(Pe("x",r,t,n),p)]}case"ArgMin":{const p=Pe("axis",r,t,n);return[lo(Pe("x",r,t,n),p)]}case"Prod":{const p=Pe("axis",r,t,n),g=Pe("keepDims",r,t,n);return[oy(Pe("x",r,t,n),p,g)]}case"Cumsum":{const p=Pe("axis",r,t,n),g=Pe("exclusive",r,t,n),b=Pe("reverse",r,t,n);return[qh(Pe("x",r,t,n),p,g,b)]}case"Bincount":const o=Pe("x",r,t,n),u=Pe("weights",r,t,n),h=Pe("size",r,t,n);return[va(o,u,h)];case"DenseBincount":{const p=Pe("x",r,t,n),g=Pe("weights",r,t,n),b=Pe("size",r,t,n),_=Pe("binaryOutput",r,t,n);return[Cg(p,g,b,_)]}default:throw TypeError(`Node type ${r.op} is not implemented`)}},Ej="reduction";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $L=(r,t,n)=>{switch(r.op){case"ConcatV2":case"Concat":{const o=Pe("n",r,t,n),u=Pe("axis",r,t,n);let h=Pe("tensors",r,t,n);return h=h.slice(0,o),[vt(h,u)]}case"Gather":{const o=Pe("x",r,t,n),u=Pe("indices",r,t,n);return[pv(o,qi(u,"int32"),0)]}case"GatherV2":{const o=Pe("axis",r,t,n),u=Pe("batchDims",r,t,n),h=Pe("x",r,t,n),p=Pe("indices",r,t,n);return[pv(h,qi(p,"int32"),o,u)]}case"Reverse":{const o=Pe("dims",r,t,n),u=[];for(let p=0;p<o.length;p++)o[p]&&u.push(p);const h=Pe("x",r,t,n);return[ed(h,u)]}case"ReverseV2":{const o=Pe("axis",r,t,n),u=Pe("x",r,t,n);return[ed(u,o)]}case"Slice":{const o=Pe("begin",r,t,n),u=Pe("size",r,t,n);return[Zt(Pe("x",r,t,n),o,u)]}case"StridedSlice":{const o=Pe("begin",r,t,n),u=Pe("end",r,t,n),h=Pe("strides",r,t,n),p=Pe("beginMask",r,t,n),g=Pe("endMask",r,t,n),b=Pe("ellipsisMask",r,t,n),_=Pe("newAxisMask",r,t,n),z=Pe("shrinkAxisMask",r,t,n),V=Pe("x",r,t,n);return[nb(V,o,u,h,p,g,b,_,z)]}case"Pack":return Vn(()=>{const o=Pe("axis",r,t,n),u=Pe("tensors",r,t,n),h=u[0].shape,p=lg(u[0]).shape,g=u.map(b=>{const _=Bn(b.shape,h);if(!_&&!Bn(lg(b).shape,p))throw new Error("the input tensors shape does not match");return _?b:m(b,h)});return[rd(g,o)]});case"Unpack":{const o=Pe("axis",r,t,n),u=Pe("tensor",r,t,n);return Sd(u,o)}case"Tile":{const o=Pe("reps",r,t,n);return[wd(Pe("x",r,t,n),o)]}case"Split":case"SplitV":{const o=Pe("axis",r,t,n),u=Pe("numOrSizeSplits",r,t,n),h=Pe("x",r,t,n);return nd(h,u,o)}case"ScatterNd":{const o=Pe("indices",r,t,n),u=Pe("values",r,t,n),h=Pe("shape",r,t,n);return[vw(o,u,h)]}case"GatherNd":{const o=Pe("x",r,t,n),u=Pe("indices",r,t,n);return[mw(o,u)]}case"SparseToDense":{const o=Pe("sparseIndices",r,t,n),u=Pe("outputShape",r,t,n),h=Pe("sparseValues",r,t,n),p=Pe("defaultValue",r,t,n);return[by(o,h,u,h.dtype===p.dtype?p:qi(p,h.dtype))]}default:throw TypeError(`Node type ${r.op} is not implemented`)}},Sj="slice_join";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GL=(r,t,n)=>{switch(r.op){case"FFT":return[r0(Pe("x",r,t,n))];case"IFFT":return[mm(Pe("x",r,t,n))];case"RFFT":return[a0(Pe("x",r,t,n))];case"IRFFT":return[fy(Pe("x",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},Cj="spectral";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UL=(r,t,n)=>{switch(r.op){case"Cast":return[qi(Pe("x",r,t,n),Pe("dtype",r,t,n))];case"ExpandDims":{const o=Pe("axis",r,t,n);return[xd(Pe("x",r,t,n),o)]}case"Squeeze":{const o=Pe("axis",r,t,n);return[lg(Pe("x",r,t,n),o)]}case"Reshape":return[m(Pe("x",r,t,n),Pe("shape",r,t,n))];case"MirrorPad":return[V1(Pe("x",r,t,n),Pe("padding",r,t,n),Pe("mode",r,t,n))];case"PadV2":case"Pad":return[zv(Pe("x",r,t,n),Pe("padding",r,t,n),Pe("constantValue",r,t,n))];case"SpaceToBatchND":{const o=Pe("blockShape",r,t,n),u=Pe("paddings",r,t,n);return[qm(Pe("x",r,t,n),o,u)]}case"BatchToSpaceND":{const o=Pe("blockShape",r,t,n),u=Pe("crops",r,t,n);return[hn(Pe("x",r,t,n),o,u)]}case"DepthToSpace":{const o=Pe("blockSize",r,t,n),u=Pe("dataFormat",r,t,n).toUpperCase();return[Fv(Pe("x",r,t,n),o,u)]}case"BroadcastTo":return[ka(Pe("x",r,t,n),Pe("shape",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}},_j="transformation";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JM(r,t,n,o){const u=((h,p,g)=>{switch(h.category){case"arithmetic":return Vn(()=>bL(h,p,g));case"basic_math":return Vn(()=>xL(h,p,g));case"control":return TL(h,p,g);case"convolution":return Vn(()=>AL(h,p,g));case"creation":return Vn(()=>ML(h,p,g));case"dynamic":return NL(h,p,g);case"evaluation":return Vn(()=>kL(h,p,g));case"image":return Vn(()=>LL(h,p,g));case"graph":return Vn(()=>DL(h,p,g));case"logical":return Vn(()=>PL(h,p,g));case"matrices":return Vn(()=>FL(h,p,g));case"normalization":return Vn(()=>BL(h,p,g));case"reduction":return Vn(()=>zL(h,p,g));case"slice_join":return Vn(()=>$L(h,p,g));case"spectral":return Vn(()=>GL(h,p,g));case"transformation":return Vn(()=>UL(h,p,g));case"hash_table":return RL(h,p,g,o);case"custom":const b=HM(h.op);if(b&&b.customExecutor)return b.customExecutor(new yL(h,p,g));throw TypeError(`Custom op ${h.op} is not registered.`);default:throw TypeError(`Unknown op '${h.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(r,t,n);return zt(u)?u.then(h=>[].concat(h)):[].concat(u)}class tN{constructor(t={},n={},o={},u={}){this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=o,this.functionMap=u,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,n){return{id:t,frameName:n,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let n=0;n<this.contexts.length-1;n++){const o=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(o))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(t);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(t)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eN(r,t,n,o){const u=new Set,h=[];let p=null,g=null;const b=new Set,_=Object.keys(r).map(at=>sp(at)[0]);let z=[];o!=null&&(z=o.map(at=>sp(at.name)[0]));const V=[...t];for(;V.length>0;){const at=V.pop();if((nN(at)||XL(at)||YL(at))&&p==null&&(p=at,g=p.children.map(Et=>Et.name).filter(Et=>u.has(Et))),u.add(at.name),n[at.name]==null&&_.indexOf(at.name)===-1&&z.indexOf(at.name)===-1){if(at.inputs.length===0){h.push(at.name);continue}at.inputs.forEach(Et=>{b.has(Et.name)||(b.add(Et.name),V.push(Et))})}}return{inputs:r,outputs:t,usedNodes:u,missingInputs:h,dynamicNode:p,syncInputs:g}}function WL(r,t,n){const{usedNodes:o,inputs:u}=n,h=[],p=Object.keys(u).map(z=>sp(z)[0]).map(z=>r.nodes[z]),g=r.initNodes;p.forEach(z=>{o.has(z.name)&&h.push(z)}),r.weights.forEach(z=>{o.has(z.name)&&h.push(z)}),g!=null&&g.forEach(z=>{o.has(z.name)&&h.push(z)});const b=new Set,_=[];for(;h.length>0;){const z=h.pop();b.add(z.name),t[z.name]||_.push(z),z.children.forEach(V=>{!b.has(V.name)&&o.has(V.name)&&V.inputs.every(at=>b.has(at.name))&&h.push(V)})}return _}const VL=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],jL=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],HL=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2"];function nN(r){return VL.indexOf(r.op)>=0}function XL(r){return jL.indexOf(r.op)>=0}function YL(r){return HL.indexOf(r.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nS{constructor(t,n){this.graph=t,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(o=>{this._functionExecutorMap[o]=new nS(t.functions[o],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const n=Object.keys(t).map(o=>t[o].map(u=>u.id));this._weightIds=[].concat(...n),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const n=t.signatureKey||t.name;return t.defaultOutput?`${n}:${t.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((t,n)=>(t[n]=this._functions[n].signature,t),{})}getCompilationKey(t,n){const o=t.map(h=>h.name).sort(),u=n.map(h=>h.name).sort();return o.join(this.SEPERATOR)+"--"+u.join(this.SEPERATOR)}compile(t,n){const o=eN(t,n,this.weightMap,this._initNodes),{missingInputs:u,dynamicNode:h,syncInputs:p}=o;if(h!=null)throw new Error(`This execution contains the node '${h.name}', which has the dynamic op '${h.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${p}]`);if(u.length>0){const g=n.map(_=>_.name),b=Object.keys(t);throw new Error(`Cannot compute the outputs [${g}] from the provided inputs [${b}]. Missing the following inputs: [${u}]`)}return WL(this.graph,this.weightMap,o)}execute(t,n){t=this.mapInputs(t);const o=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);const u=o.map(V=>this.graph.nodes[sp(V)[0]]),h=n.map(V=>sp(V)[0]);let p=h.map(V=>this.graph.nodes[V]);p.length===0&&(p=this._outputs);const g=this.getCompilationKey(u,p);let b=this.compiledMap.get(g);b==null&&(b=this.compile(t,p),this.compiledMap.set(g,b));const _={},z={};return Vn(()=>{const V=new tN(this.weightMap,_,z,this.functionExecutorMap),at=Object.assign({},this.weightMap);Object.keys(t).forEach(Tt=>{const[Wt,le]=sp(Tt),ye=[];ye[le]=t[Tt],at[Wt]=ye});const Et=this.getFrozenTensorIds(at),St={};for(let Tt=0;Tt<b.length;Tt++){const Wt=b[Tt];if(!at[Wt.name]){const le=JM(Wt,at,V,this._resourceManager);if(zt(le))throw new Error(`The execution of the op '${Wt.op}' returned a promise. Please use model.executeAsync() instead.`);at[Wt.name]=le,this.checkTensorForDisposal(Wt.name,Wt,at,V,Et,h,St)}}return this.parent==null&&V.dispose(Et),n.map(Tt=>Ad(Tt,at,V))})}getFrozenTensorIds(t){const n=[].concat.apply([],Object.keys(t).map(o=>t[o]).map(o=>o.map(u=>u.id)));return new Set(n)}checkTensorForDisposal(t,n,o,u,h,p,g){n.category==="control"||p.indexOf(t)!==-1||(o[t].forEach(b=>{b!=null&&(g[b.id]=(g[b.id]||0)+n.children.length)}),n.inputs.forEach(b=>{if(b.category!=="control"){const _=JR(b.name,o,u);_!=null&&_.forEach(z=>{if(z&&!h.has(z.id)){const V=g[z.id];V===1?(z.dispose(),delete g[z.id]):V!=null&&g[z.id]--}})}}))}executeAsync(t,n){return jr(this,null,function*(){return this._executeAsync(t,n)})}_executeAsync(p,g){return jr(this,arguments,function*(t,n,o=!1,u={},h={}){o||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));const b=new tN(this.weightMap,u,h,this.functionExecutorMap),_=yield this.executeWithControlFlow(t,b,n,o),z=n.map(St=>Ad(St,_,b)),V=z.map(St=>St.id),at=Object.keys(t).map(St=>t[St].id),Et=new Set([...V,...at,...this.weightIds]);return Object.keys(_).forEach(St=>{_[St].forEach(Wt=>{Wt&&!Wt.isDisposed&&!Et.has(Wt.id)&&Wt.dispose()})}),this.parent==null&&b.dispose(Et),z})}executeFunctionAsync(t,n,o){return jr(this,null,function*(){const u=t.reduce((h,p,g)=>(h[this.inputs[g].name]=p,h),{});return this._executeAsync(u,this.outputNodes,!0,n,o)})}executeWithControlFlow(t,n,o,u){return jr(this,null,function*(){const h=Object.keys(t),p=h.map(Qe=>this.graph.nodes[sp(Qe)[0]]),g=o.map(Qe=>sp(Qe)[0]);let b=g.map(Qe=>this.graph.nodes[Qe]);b.length===0&&(b=this._outputs);const{usedNodes:_,missingInputs:z,dynamicNode:V,syncInputs:at}=eN(t,b,this.weightMap,this._initNodes),Et=[...p,...this.graph.weights,...this._initNodes||[]].map(Qe=>({node:Qe,contexts:n.currentContext})),St=Object.assign({},this.weightMap);Object.keys(t).forEach(Qe=>{const[$e,Xe]=sp(Qe),Rn=[];Rn[Xe]=t[Qe],St[$e]=Rn});const Tt={},Wt=this.getFrozenTensorIds(St),le={};for(;Et.length>0;){const Qe=this.processStack(p,Et,n,St,le,Wt,g,Tt,_);yield Promise.all(Qe)}V==null&&!u&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const ye=b.filter(Qe=>!nN(Qe)&&!Ad(Qe.name,St,n)).map(Qe=>Qe.name);if(ye.length>0){let Qe="";throw V!=null&&(Qe=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${at}]`),new Error(`Cannot compute the outputs [${ye}] from the provided inputs [${h}]. Consider providing the following inputs: [${z}]. ${Qe}`)}return St})}processStack(t,n,o,u,h,p,g,b,_){const z=[];for(;n.length>0;){const V=n.pop();o.currentContext=V.contexts;let at="";if(V.node.op==="Enter"&&Pe("isConstant",V.node,u,o)&&([at]=tm(V.node.name,o)),u[V.node.name]==null){const Et=JM(V.node,u,o,this._resourceManager);at||([at]=tm(V.node.name,o));const St=o.currentContext;zt(Et)?z.push(Et.then(Tt=>(u[at]=Tt,o.currentContext=St,this.checkTensorForDisposal(at,V.node,u,o,p,g,b),this.processChildNodes(V.node,n,o,u,h,_),Tt))):(u[at]=Et,this.checkTensorForDisposal(at,V.node,u,o,p,g,b),this.processChildNodes(V.node,n,o,u,h,_))}else this.processChildNodes(V.node,n,o,u,h,_)}return z}processChildNodes(t,n,o,u,h,p){t.children.forEach(g=>{const[b]=tm(g.name,o);h[b]||!p.has(g.name)||(g.op==="Merge"?g.inputNames.some(_=>!!Ad(_,u,o))&&(h[b]=!0,n.push({contexts:o.currentContext,node:g})):g.inputNames.every(_=>!!Ad(_,u,o))&&(h[b]=!0,n.push({contexts:o.currentContext,node:g})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(n=>n.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(n=>{const o=t[n],[u]=sp(n),h=this.graph.nodes[u];if(h.attrParams.shape&&h.attrParams.shape.value){const p=h.attrParams.shape.value,g=p.length===o.shape.length&&o.shape.every((b,_)=>p[_]===-1||p[_]===b);bt(g,()=>`The shape of dict['${h.name}'] provided in model.execute(dict) must be [${p}], but was [${o.shape}]`)}h.attrParams.dtype&&h.attrParams.dtype.value&&bt(o.dtype===h.attrParams.dtype.value,()=>`The dtype of dict['${h.name}'] provided in model.execute(dict) must be ${h.attrParams.dtype.value}, but was ${o.dtype}`)})}mapInputs(t){const n={};for(const o in t)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[o]!=null){const u=this._signature.inputs[o];n[u.name]=t[o]}else n[o]=t[o];return n}checkInputs(t){const n=Object.keys(t).filter(o=>{const[u]=sp(o);return this.graph.nodes[u]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(t){return t.map(n=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[n]!=null?this._signature.outputs[n].name:n,{})}checkOutputs(t){t.forEach(n=>{const[o]=sp(n);if(!this.graph.nodes[o])throw new Error(`The output '${n}' is not found in the graph`)})}}class KL{constructor(t={},n={}){this.hashTableNameToHandle=t,this.hashTableMap=n}addHashTable(t,n){this.hashTableNameToHandle[t]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZL="?tfjs-format=file",qL="model.json";class rN{constructor(t,n={}){this.modelUrl=t,this.loadOptions=n,this.version="n/a",n==null&&(this.loadOptions={}),this.resourceManager=new KL}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}findIOHandler(){const t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=gd(t,this.loadOptions);else{const n=Bh(t,this.loadOptions);if(n.length===0)n.push(gd(t,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[t]}'`);this.handler=n[0]}}load(){return jr(this,null,function*(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=yield this.handler.load();return this.loadSync(t)})}loadSync(t){this.artifacts=t;const n=this.artifacts.modelTopology;let o;this.artifacts.userDefinedMetadata!=null&&this.artifacts.userDefinedMetadata.signature!=null?o=this.artifacts.userDefinedMetadata.signature:o=this.artifacts.signature,this.signature=o,this.version=`${n.versions.producer}.${n.versions.minConsumer}`;const u=tc(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new nS(YM.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(u),this.executor.resourceManager=this.resourceManager,t.modelInitializer!=null&&t.modelInitializer.node!=null){const h=YM.Instance.transformGraph(t.modelInitializer);this.initializer=new nS(h),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}save(t,n){return jr(this,null,function*(){if(typeof t=="string"){const o=Dd(t);if(o.length===0)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(o.length>1)throw new Error(`Found more than one (${o.length}) save handlers for URL '${t}'`);t=o[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)})}predict(t,n){return this.execute(t,this.outputNodes)}normalizeInputs(t){if(!(t instanceof Nn)&&!Array.isArray(t))return t;if(t=Array.isArray(t)?t:[t],t.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${t.length} input tensors.`);return this.inputNodes.reduce((n,o,u)=>(n[o]=t[u],n),{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}execute(t,n){t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const o=this.executor.execute(t,n);return o.length>1?o:o[0]}executeAsync(t,n){return jr(this,null,function*(){t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const o=yield this.executor.executeAsync(t,n);return o.length>1?o:o[0]})}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((n,o)=>(n[o]=[t[o]],n),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}function QL(n){return jr(this,arguments,function*(r,t={}){if(r==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&r.load==null&&(r.endsWith("/")||(r=r+"/"),r=`${r}${qL}${ZL}`);const o=new rN(r,t);return yield o.load(),o})}/** @license See the LICENSE file. */const aN="2.8.6";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function JL(r,t){return rS(r,t)}function rS(r,t,n=new Map,o=new Set){if(r==null)return null;if(o.has(r))throw new Error("Circular references are not supported.");if(n.has(r))return n.get(r);const u=t(r);if(u.recurse&&u.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(u.recurse)if(p1(r)){const h=Array.isArray(r)?[]:{};o.add(r);for(const p in r){const g=r[p],b=rS(g,t,n,o);h[p]=b}return o.delete(r),h}else throw new Error(`Can't recurse into non-iterable type: ${r}`);else return n.set(r,u.value),u.value}function tP(r,t=oN){return iN(r,t)}function iN(r,t,n=new Set){const o=r[0];if(n.has(o))throw new Error("Circular references are not supported.");const u=t(r);if(u.recurse&&u.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(u.recurse)if(p1(o)){const h=Array.isArray(o)?[]:{};n.add(o);for(const p in o){const g=r.map(_=>_[p]),b=iN(g,t,n);h[p]=b}return n.delete(o),h}else throw new Error(`Can't recurse into non-iterable type: ${o}`);else return u.value}function oN(r){return r===null?null:p1(r[0])?{value:null,recurse:!0}:{value:r,recurse:!1}}function sN(r,t){return jr(this,null,function*(){const n=new Map;rS(r,t,n);for(const u of Array.from(n.keys())){const h=n.get(u);if(zt(h)){const p=yield h;n.set(u,p)}}return rS(r,t,n)})}function p1(r){return r!=null&&!ArrayBuffer.isView(r)&&(Array.isArray(r)||typeof r=="object"&&!(r instanceof Nn))}function eP(r){return r==null||nP(r)||Array.isArray(r)||typeof r=="object"&&r instanceof Nn||Yr(r)}function nP(r){return r===null||typeof r!="object"&&typeof r!="function"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function rP(r){return JL(r,aP)}function aP(r){return r instanceof Nn?{value:r.clone(),recurse:!1}:p1(r)?{value:null,recurse:!0}:{value:r,recurse:!1}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class uN{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,n){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=n}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const n of t)this.push(n)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const n=this.wrap(this.begin+t),o=this.get(n);return this.set(n,this.pop()),o}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class aS extends uN{constructor(){super(aS.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=this.capacity*2,n=new Array(t),o=this.length();for(let u=0;u<o;u++)n[u]=this.get(this.wrap(this.begin+u));this.data=n,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=o}}aS.INITIAL_CAPACITY=32;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function lN(r){return new oP(r)}function Ij(r){let t=r;return xx(()=>({value:t++,done:!1}))}function xx(r){return new sP(r)}function cN(r,t){return new hN(r,t)}function Tj(r,t,n){return cN(xx(r).take(t),n)}function iP(r,t=Om.FAIL){return new gP(r,t)}class Wf{toArray(){return jr(this,null,function*(){const t=[];let n=yield this.next();for(;!n.done;)t.push(n.value),n=yield this.next();return t})}toArrayForTest(){return jr(this,null,function*(){const t=this.prefetch(100),n=[];let o=yield t.next();for(;!o.done;)n.push(o.value),o=yield t.next();return n})}resolveFully(){return jr(this,null,function*(){let t=yield this.next();for(;!t.done;)t=yield this.next()})}resolveWhile(t){return jr(this,null,function*(){let n=yield this.next(),o=t(n.value);for(;!n.done&&o;)n=yield this.next(),o=t(n.value)})}handleErrors(t){return new pP(this,t)}filter(t){return new hP(this,t)}map(t){return new dP(this,t)}mapAsync(t){return new fN(this,t)}serialMapAsync(t){return new fN(this,t).serial()}flatmap(t){return new vP(this,t)}forEachAsync(t){return jr(this,null,function*(){return this.map(t).resolveFully()})}serialForEach(t){return jr(this,null,function*(){return this.serialMapAsync(t).resolveWhile(n=>n===!0)})}rowMajorBatch(t,n=!0){return new fP(this,t,n)}columnMajorBatch(t,n=!0,o=oN){return this.rowMajorBatch(t,n).map(h=>tP(h,o))}concatenate(t,n){return new hN(lN([this,t]),n)}take(t){return t<0||t==null?this:new cP(this,t)}skip(t){return t<0||t==null?this:new lP(this,t)}prefetch(t){return new dN(this,t)}shuffle(t,n){return new mP(this,t,n)}serial(){return new uP(this)}}class oP extends Wf{constructor(t){super();this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}next(){return jr(this,null,function*(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:rP(t),done:!1}})}}class sP extends Wf{constructor(t){super();this.nextFn=t}summary(){return"Function call"}next(){return jr(this,null,function*(){try{return this.nextFn()}catch(t){throw t.message=`Error thrown while iterating through a dataset: ${t.message}`,t}})}}class uP extends Wf{constructor(t){super();this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}next(){return jr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return jr(this,null,function*(){return this.upstream.next()})}}class lP extends Wf{constructor(t,n){super();this.upstream=t,this.maxCount=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}next(){return jr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return jr(this,null,function*(){for(;this.count++<this.maxCount;){const t=yield this.upstream.next();if(t.done)return t;M(t.value)}return this.upstream.next()})}}class cP extends Wf{constructor(t,n){super();this.upstream=t,this.maxCount=n,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}next(){return jr(this,null,function*(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()})}}class fP extends Wf{constructor(t,n,o=!0){super();this.upstream=t,this.batchSize=n,this.enableSmallLastBatch=o,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}next(){return jr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return jr(this,null,function*(){const t=[];for(;t.length<this.batchSize;){const n=yield this.upstream.next();if(n.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(n.value)}return{value:t,done:!1}})}}class hP extends Wf{constructor(t,n){super();this.upstream=t,this.predicate=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}next(){return jr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return jr(this,null,function*(){for(;;){const t=yield this.upstream.next();if(t.done||this.predicate(t.value))return t;M(t.value)}})}}class dP extends Wf{constructor(t,n){super();this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> Map`}next(){return jr(this,null,function*(){const t=yield this.upstream.next();if(t.done)return{value:null,done:!0};const n=eo(t.value),o=this.transform(t.value),u=eo(o);for(const h of n)Xo(h,u)||h.dispose();return{value:o,done:!1}})}}class pP extends Wf{constructor(t,n){super();this.upstream=t,this.handler=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}next(){return jr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return jr(this,null,function*(){for(;;)try{return yield this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}})}}class fN extends Wf{constructor(t,n){super();this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> AsyncMap`}next(){return jr(this,null,function*(){const t=yield this.upstream.next();if(t.done)return{value:null,done:!0};const n=eo(t.value),o=yield this.transform(t.value),u=eo(o);for(const h of n)Xo(h,u)||h.dispose();return{value:o,done:!1}})}}class BT extends Wf{constructor(){super();this.outputQueue=new aS,this.lastRead=Promise.resolve({value:null,done:!1})}next(){return jr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}serialNext(){return jr(this,null,function*(){for(;this.outputQueue.length()===0;)if(!(yield this.pump()))return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}})}}class vP extends BT{constructor(t,n){super();this.upstream=t,this.transform=n}summary(){return`${this.upstream.summary()} -> Flatmap`}pump(){return jr(this,null,function*(){const t=yield this.upstream.next();if(t.done)return!1;const n=eo(t.value),o=this.transform(t.value),u=eo(o);this.outputQueue.pushAll(o);for(const h of n)Xo(h,u)||h.dispose();return!0})}}class hN extends Wf{constructor(t,n){super();this.baseErrorHandler=n,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}next(){return jr(this,null,function*(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead})}readFromChain(t){return jr(this,null,function*(){if(yield t,this.iterator==null){const o=yield this.moreIterators.next();if(o.done)return{value:null,done:!0};this.iterator=o.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const n=yield this.iterator.next();return n.done?(this.iterator=null,this.readFromChain(t)):n})}}var Om;(function(r){r[r.FAIL=0]="FAIL",r[r.SHORTEST=1]="SHORTEST",r[r.LONGEST=2]="LONGEST"})(Om||(Om={}));class gP extends Wf{constructor(t,n=Om.FAIL){super();this.iterators=t,this.mismatchMode=n,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}nextState(t){return jr(this,null,function*(){yield t;let n=0,o=0;function u(p){return p instanceof Wf?{value:p.next().then(b=>(n++,b.done&&o++,b.value)),recurse:!1}:{value:null,recurse:!0}}const h=yield sN(this.iterators,u);if(n===o)return{value:null,done:!0};if(o>0)switch(this.mismatchMode){case Om.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case Om.SHORTEST:return{value:null,done:!0};case Om.LONGEST:default:}return this.count++,{value:h,done:!1}})}next(){return jr(this,null,function*(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise})}}class dN extends Wf{constructor(t,n){super();this.upstream=t,this.bufferSize=n,this.buffer=new uN(n)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class mP extends dN{constructor(t,n,o){super(t,n);this.upstream=t,this.windowSize=n,this.upstreamExhausted=!1,this.random=vm.alea(o||js().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}next(){return jr(this,null,function*(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead})}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}serialNext(){return jr(this,null,function*(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),n=yield this.buffer.shuffleExcise(t);if(n.done)this.upstreamExhausted=!0;else return this.refill(),n}return{value:null,done:!0}})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class v1{constructor(){this.size=null}batch(t,n=!0){const o=this;bt(t>0,()=>`batchSize needs to be positive, but it is
      ${t}`);let u;return this.size===Infinity||this.size==null?u=this.size:n?u=Math.ceil(this.size/t):u=Math.floor(this.size/t),up(()=>jr(this,null,function*(){return(yield o.iterator()).columnMajorBatch(t,n,xP)}),u)}concatenate(t){const n=this;let o;return this.size===Infinity||t.size===Infinity?o=Infinity:this.size!=null&&t.size!=null?o=this.size+t.size:o=null,up(()=>jr(this,null,function*(){return(yield n.iterator()).concatenate(yield t.iterator())}),o)}filter(t){const n=this;let o;return this.size===Infinity?o=Infinity:o=null,up(()=>jr(this,null,function*(){return(yield n.iterator()).filter(u=>Vn(()=>t(u)))}),o)}forEachAsync(t){return jr(this,null,function*(){return(yield this.iterator()).forEachAsync(t)})}map(t){const n=this;return up(()=>jr(this,null,function*(){return(yield n.iterator()).map(o=>Vn(()=>t(o)))}),this.size)}mapAsync(t){const n=this;return up(()=>jr(this,null,function*(){return(yield n.iterator()).mapAsync(t)}),this.size)}prefetch(t){if(t==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const n=this;return up(()=>jr(this,null,function*(){return(yield n.iterator()).prefetch(t)}),this.size)}repeat(t){const n=this;let o;return this.size!=null&&t>0?o=this.size*t:t===0?o=0:this.size!=null&&(t===void 0||t<0)?o=Infinity:o=null,up(()=>jr(this,null,function*(){const u=xx(()=>jr(this,null,function*(){return{value:yield n.iterator(),done:!1}}));return cN(u.take(t))}),o)}skip(t){const n=this;let o;return this.size!=null&&t>=0&&this.size>=t?o=this.size-t:this.size!=null&&(this.size<t||t===void 0||t<0)?o=0:o=null,up(()=>jr(this,null,function*(){return(yield n.iterator()).skip(t)}),o)}shuffle(t,n,o=!0){if(t==null||t<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const u=this,h=vm.alea(n||js().toString());return up(()=>jr(this,null,function*(){let p=h.int32();return o&&(p+=h.int32()),(yield u.iterator()).shuffle(t,p.toString())}),this.size)}take(t){const n=this;let o;return this.size!=null&&this.size>t?o=t:this.size!=null&&this.size<=t?o=this.size:o=null,up(()=>jr(this,null,function*(){return(yield n.iterator()).take(t)}),o)}toArray(){return jr(this,null,function*(){if(this.size===Infinity)throw new Error("Can not convert infinite data stream to array.");return(yield this.iterator()).toArray()})}toArrayForTest(){return jr(this,null,function*(){if(this.size===Infinity)throw new Error("Can not convert infinite data stream to array.");return(yield this.iterator()).toArrayForTest()})}}v1.MAX_BUFFER_SIZE=1e4;function up(r,t=null){return new class extends v1{constructor(){super(...arguments);this.size=t}iterator(){return jr(this,null,function*(){return r()})}}}function yP(r){return up(()=>jr(this,null,function*(){return lN(r)}),r.length)}function bP(r){if(!p1(r))throw new Error("The argument to zip() must be an object or array.");let t;if(Array.isArray(r))for(let n=0;n<r.length;n++)t=t==null?r[n].size:Math.min(t,r[n].size);else if(r instanceof Object)for(const n in r)t=t==null?r[n].size:Math.min(t,r[n].size);return up(()=>jr(this,null,function*(){const n=yield sN(r,o=>{if(o instanceof v1)return{value:o.iterator(),recurse:!1};if(p1(o))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return iP(n,Om.SHORTEST)}),t)}function xP(r){if(r===null)return null;const t=r[0];return eP(t)?{value:wP(r),recurse:!1}:{value:null,recurse:!0}}function wP(r){if(r.length===0)throw new Error("Can't make a batch of zero elements.");return r[0]instanceof Nn?rd(r):yc(r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class pN extends v1{constructor(t){super();this.input=t}iterator(){return jr(this,null,function*(){return(yield this.input.iterator()).decodeUTF8().split(`
`).map(u=>(u.endsWith("\r")&&(u=u.slice(0,-1)),u))})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const iS='"',wx=Symbol("out"),vN=Symbol("field"),oS=Symbol("quote"),zT=Symbol("quoteafterquote"),gN=Symbol("quoteinquote");class mN extends v1{constructor(t,n){super();this.input=t,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new pN(t),n||(n={}),this.hasHeader=n.hasHeader!==!1,this.fullColumnNames=n.columnNames,this.columnConfigs=n.columnConfigs,this.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(bt(n.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=n.delimiter?n.delimiter:","}columnNames(){return jr(this,null,function*(){return this.columnNamesValidated||(yield this.setColumnNames()),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames})}setColumnNames(){return jr(this,null,function*(){const t=yield this.maybeReadHeaderLine();if(!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&t&&bt(t.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=t);const n=this.fullColumnNames.reduce((u,h)=>(u[h]=u[h]+1||1,u),{}),o=Object.keys(n).filter(u=>n[u]>1);if(bt(o.length===0,()=>"Duplicate column names found: "+o.toString()),this.columnConfigs){for(const u of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(u)===-1)throw new Error('The key "'+u+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0})}maybeReadHeaderLine(){return jr(this,null,function*(){if(this.hasHeader){const n=yield(yield this.base.iterator()).next();if(n.done)throw new Error("No data was found for CSV parsing.");const o=n.value;return this.parseRow(o,!1)}else return null})}iterator(){return jr(this,null,function*(){this.columnNamesValidated||(yield this.setColumnNames());let t=yield this.base.iterator();return this.hasHeader&&(t=t.skip(1)),t.map(n=>this.makeDataElement(n))})}makeDataElement(t){const n=this.parseRow(t),o={},u={};for(let h=0;h<this.fullColumnNames.length;h++){const p=this.fullColumnNames[h],g=this.columnConfigs?this.columnConfigs[p]:null;if(!(this.configuredColumnsOnly&&!g)){const b=n[h];let _=null;if(b==="")if(g&&g.default!==void 0)_=g.default;else{if(g&&(g.required||g.isLabel))throw new Error(`Required column ${p} is empty in this line: ${t}`);_=void 0}else{const z=Number(b);if(isNaN(z))g&&g.dtype==="bool"?_=this.getBoolean(b):_=b;else if(!g||!g.dtype)_=z;else switch(g.dtype){case"float32":_=z;break;case"int32":_=Math.floor(z);break;case"bool":_=this.getBoolean(b);break;default:_=z}}g&&g.isLabel?u[p]=_:o[p]=_}}return Object.keys(u).length===0?o:{xs:o,ys:u}}getBoolean(t){return t==="1"||t.toLowerCase()==="true"?1:0}parseRow(t,n=!0){const o=[];let u=0;const h=t.length;let p=wx;for(let g=0;g<h;g++)switch(p){case wx:switch(t.charAt(g)){case iS:u=g+1,p=oS;break;case this.delimiter:if(u=g+1,this.delimiter===" "&&this.delimWhitespace)break;o.push(""),p=wx;break;default:p=vN,u=g;break}break;case vN:switch(t.charAt(g)){case this.delimiter:o.push(t.substring(u,g)),p=wx,u=g+1;break;default:}break;case oS:switch(t.charAt(g)){case iS:p=zT;break;default:}break;case zT:switch(t.charAt(g)){case this.delimiter:o.push(t.substring(u,g-1)),p=wx,u=g+1;break;case iS:p=oS;break;default:p=gN;break}break;case gN:switch(t.charAt(g)){case iS:p=oS;break;default:}break;default:}if(p===zT?o.push(t.substring(u,h-1)):o.push(t.substring(u)),n&&o.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${o}`);return o}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class $T extends Wf{constructor(t){super();this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;const n=Math.log2(this.fftSize);if(this.fftSize<0||n<4||n>14||!Number.isInteger(n))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=t.includeSpectrogram!==!1,this.includeWaveform=t.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static create(){return jr(this,arguments,function*(t={}){if(He().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");const n=new $T(t);return yield n.start(),n})}start(){return jr(this,null,function*(){try{this.stream=yield navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(o){throw new Error(`Error thrown while initializing video stream: ${o.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);const n=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,n.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)})}next(){return jr(this,null,function*(){if(this.isClosed)return{value:null,done:!0};let t,n;const o=yield this.getAudioData();if(this.includeSpectrogram){const u=this.flattenQueue(o.freqDataQueue);t=this.getTensorFromAudioDataArray(u,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const u=this.flattenQueue(o.timeDataQueue);n=this.getTensorFromAudioDataArray(u,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:n},done:!1}})}capture(){return jr(this,null,function*(){return(yield this.next()).value})}getAudioData(){return jr(this,null,function*(){const t=[],n=[];let o=0;return new Promise(u=>{const h=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-Infinity&&u({freqDataQueue:t,timeDataQueue:n}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),n.push(this.timeData.slice())),++o===this.numFrames&&(clearInterval(h),u({freqDataQueue:t,timeDataQueue:n}))},this.fftSize/this.sampleRateHz*1e3)})})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){const n=t[0].length,o=new Float32Array(t.length*n);return t.forEach((u,h)=>o.set(u,h*n)),o}getTensorFromAudioDataArray(t,n){const o=new Float32Array(Rt(n));return o.set(t,o.length-t.length),yc(o,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class GT extends Wf{constructor(t,n){super();if(this.webcamVideoElement=t,this.webcamConfig=n,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=ad([0],"int32"),this.webcamConfig.centerCrop){const o=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,u=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,h=(1-o)/2,p=(1-u)/2,g=h+o,b=u+p;this.cropBox=Rp([p,h,b,g],[1,4])}else this.cropBox=Rp([0,0,1,1],[1,4])}summary(){return"webcam"}static create(o){return jr(this,arguments,function*(t,n={}){if(He().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}const u=new GT(t,n);return yield u.start(),u})}start(){return jr(this,null,function*(){this.webcamConfig.facingMode&&bt(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=yield navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message=`Error thrown while initializing video stream: ${t.message}`,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})})}next(){return jr(this,null,function*(){if(this.isClosed)return{value:null,done:!0};let t;try{t=nv(this.webcamVideoElement)}catch(n){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(n)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(n){throw new Error(`Error thrown cropping the video: ${n.message}`)}finally{t.dispose()}else return{value:t,done:!1}})}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(t){return Vn(()=>{const n=t.toFloat().expandDims(0);let o;o=dg.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const u=o.shape;return o.reshape(u.slice(1))})}capture(){return jr(this,null,function*(){return(yield this.next()).value})}stop(){this.stream.getTracks().forEach(n=>n.stop());try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class yN{}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class bN extends Wf{split(t){return new EP(this,t)}}class EP extends bN{constructor(t,n){super();this.upstream=t,this.impl=new SP(t,n)}summary(){return this.impl.summary()}next(){return jr(this,null,function*(){return this.impl.next()})}}class SP extends BT{constructor(t,n){super();this.upstream=t,this.separator=n,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}pump(){return jr(this,null,function*(){const t=yield this.upstream.next();if(t.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);const n=t.value.split(this.separator);n[0]=this.carryover+n[0];for(const o of n.slice(0,-1))this.outputQueue.push(o);return this.carryover=n[n.length-1],!0})}}var CP=$(48764).Buffer;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class _P extends Wf{decodeUTF8(){return new IP(this)}}class IP extends bN{constructor(t){super();this.upstream=t,this.impl=new TP(t)}summary(){return this.impl.summary()}next(){return jr(this,null,function*(){return this.impl.next()})}}class TP extends BT{constructor(t){super();if(this.upstream=t,He().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:n}=$(31601);this.decoder=new n("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}pump(){return jr(this,null,function*(){const t=yield this.upstream.next();let n;if(t.done)return!1;n=t.value;let o;return He().get("IS_BROWSER")?o=this.decoder.decode(n,{stream:!0}):o=this.decoder.write(CP.from(n.buffer)),this.outputQueue.push(o),!0})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class xN extends _P{constructor(t,n={}){super();this.file=t,this.options=n,bt(t instanceof Uint8Array||(He().get("IS_BROWSER")?t instanceof File||t instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=n.offset||0,this.chunkSize=n.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}next(){return jr(this,null,function*(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:yield new Promise((n,o)=>{const u=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)n(new Uint8Array(this.file.slice(this.offset,u)));else{const h=new FileReader;h.onload=g=>{let b=h.result;if(b instanceof ArrayBuffer&&(b=new Uint8Array(b)),!(b instanceof Uint8Array))return o(new TypeError("FileReader returned unknown type."));n(b)},h.onabort=g=>o(new Error("Aborted")),h.onerror=g=>o(new Error(g.type));const p=this.file.slice(this.offset,u);h.readAsArrayBuffer(p)}this.offset=u}),done:!1}})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function AP(n){return jr(this,arguments,function*(r,t={}){let o,u;typeof r=="string"?o=r:(o=r.url,u=MP(r));const h=yield dp(o,u);if(h.ok){const p=new Uint8Array(yield h.arrayBuffer());return new xN(p,t)}else throw new Error(h.statusText)})}const MP=r=>({method:r.method,headers:r.headers,body:r.body,mode:r.mode,credentials:r.credentials,cache:r.cache,redirect:r.redirect,referrer:r.referrer,integrity:r.integrity});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function wN(r){return typeof r=="string"&&r.substr(0,7)==="file://"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class EN extends yN{constructor(t,n={}){super();this.input=t,this.options=n}iterator(){return jr(this,null,function*(){if(wN(this.input)&&He().get("IS_NODE")){const t=$(67792);this.input=t.readFileSync(this.input.substr(7))}return new xN(this.input,this.options)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class SN extends yN{constructor(t,n={}){super();this.url=t,this.fileOptions=n}iterator(){return jr(this,null,function*(){return wN(this.url)?new EN(this.url,this.fileOptions).iterator():AP(this.url,this.fileOptions)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function NP(r,t={}){return new mN(new SN(r),t)}function kP(r){const t=xx(r);return up(()=>jr(this,null,function*(){return t}))}function DP(r){return up(()=>jr(this,null,function*(){const t=yield r();return xx(()=>t.next())}))}function OP(r,t){return jr(this,null,function*(){return GT.create(r,t)})}function RP(r){return jr(this,null,function*(){return $T.create(r)})}/** @license See the LICENSE file. */const CN="2.8.6";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Go(r,t){Array.isArray(r)||(r=[r]),r.forEach(n=>{n!=null&&bt(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LP=s0;class PP extends Ye{constructor(){super();this.blockSize=48,this.firstUse=!0,this.data=new Ae(this,Wa())}write(t,n,o){this.firstUse&&(this.firstUse=!1,He().get("IS_NODE")&&Sm(`
============================
Hi there \u{1F44B}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));const u={};return this.data.set(u,{values:t,dtype:o,refCount:1}),u}makeTensorInfo(t,n,o){let u;if(n==="string"&&o!=null&&o.length>0&&Sr(o[0])){const h=o.map(p=>Pl(p));u=this.write(h,t,n)}else u=this.write(o,t,n);return{dataId:u,shape:t,dtype:n}}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,o,u){this.data.set(t,{values:n,dtype:u,refCount:1})}numDataIds(){return this.data.numDataIds()}read(t){return jr(this,null,function*(){return this.readSync(t)})}readSync(t){const{dtype:n,complexTensorInfos:o}=this.data.get(t);if(n==="complex64"){const u=this.readSync(o.real.dataId),h=this.readSync(o.imag.dataId);return Uv(u,h)}return this.data.get(t).values}bufferSync(t){const n=this.readSync(t.dataId);let o=n;if(t.dtype==="string")try{o=n.map(u=>Dt(u))}catch(u){throw new Error("Failed to decode encoded string bytes into utf-8")}return zs(t.shape,t.dtype,o)}makeOutput(t,n,o){const u=this.write(t,n,o);return Wa().makeTensorFromDataId(u,n,o,this)}disposeData(t){if(this.data.has(t)){const{complexTensorInfos:n}=this.data.get(t);n!=null&&(this.disposeData(n.real.dataId),this.disposeData(n.imag.dataId)),this.data.delete(t)}}disposeIntermediateTensorInfo(t){const n=t.dataId;if(this.data.has(n)){const o=this.data.get(n);o.refCount--,o.refCount<1&&this.disposeData(n)}}time(t){return jr(this,null,function*(){const n=js();return t(),{kernelMs:js()-n}})}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Go([t],"where");const n=this.readSync(t.dataId);return LP(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}/** @license See the LICENSE file. */const FP="2.8.6";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke("cpu",()=>new PP,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hl(r,t,n){return({inputs:o,attrs:u,backend:h})=>{const{x:p}=o;if(Go(p,r),p.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const g=h,b=g.data.get(p.dataId).values,_=Rt(p.shape),z=n||p.dtype,V=Pn(z,_);for(let at=0;at<_;++at)V[at]=t(b[at],u);return g.makeTensorInfo(p.shape,z,V)}}function g1(r,t,n){return({inputs:o,attrs:u,backend:h})=>{const{x:p}=o;if(Go(p,r),p.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const g=h,b=g.data.get(p.dataId).values,_=n||p.dtype,z=t(b,_,u);return g.makeTensorInfo(p.shape,_,z)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _N=Hl(os,r=>r>=0?r:Math.exp(r)-1),BP={kernelName:os,backendName:"cpu",kernelFunc:_N};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xg(r){const{inputs:t,backend:n}=r,{x:o}=t;return n.incRef(o.dataId),{dataId:o.dataId,shape:o.shape,dtype:o.dtype}}const zP={kernelName:Au,backendName:"cpu",kernelFunc:xg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IN(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{alpha:h}=o;Go([u],"leakyRelu");const p=Rt(u.shape),g=n.data.get(u.dataId).values,b=sr("float32",p);for(let _=0;_<g.length;_++)b[_]=g[_]<0?h*g[_]:g[_];return n.makeTensorInfo(u.shape,"float32",b)}const $P={kernelName:Pu,backendName:"cpu",kernelFunc:IN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wf(r){return(t,n,o,u,h)=>{const p=Nr(t,n),g=p.length,b=gt(p),_=Rt(p),z=sr(h,_),V=t.length,at=n.length,Et=gt(t),St=gt(n),Tt=$n(t,p),Wt=$n(n,p);if(Tt.length+Wt.length===0)for(let le=0;le<z.length;++le)z[le]=r(o[le%o.length],u[le%u.length]);else for(let le=0;le<z.length;++le){const ye=xt(le,g,b),Qe=ye.slice(-V);Tt.forEach(Cn=>Qe[Cn]=0);const $e=X(Qe,V,Et),Xe=ye.slice(-at);Wt.forEach(Cn=>Xe[Cn]=0);const Rn=X(Xe,at,St);z[le]=r(o[$e],u[Rn])}return[z,p]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GP=wf((r,t)=>r<0?t*r:r);function TN(r){const{inputs:t,backend:n}=r,{x:o,alpha:u}=t;Go([o,u],"prelu");const h=n.data.get(o.dataId).values,p=n.data.get(u.dataId).values,[g,b]=GP(o.shape,u.shape,h,p,o.dtype);return n.makeTensorInfo(b,o.dtype,g)}const UP={kernelName:Oi,backendName:"cpu",kernelFunc:TN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AN=Hl(Ys,r=>Math.max(0,r)),WP={kernelName:Ys,backendName:"cpu",kernelFunc:AN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MN=Hl(Rl,r=>Math.min(Math.max(0,r),6)),VP={kernelName:Rl,backendName:"cpu",kernelFunc:MN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UT(r,t,n,o,u){if(n==="linear")return xg({inputs:{x:t},backend:r});if(n==="relu")return AN({inputs:{x:t},backend:r});if(n==="elu")return _N({inputs:{x:t},backend:r});if(n==="relu6")return MN({inputs:{x:t},backend:r});if(n==="prelu")return TN({inputs:{x:t,alpha:o},backend:r});if(n==="leakyrelu")return IN({inputs:{x:t},backend:r,attrs:{alpha:u}});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lp(r){const{inputs:t,backend:n}=r,{real:o,imag:u}=t,h=n.data.get(o.dataId).values,p=n.data.get(u.dataId).values,g=n.makeTensorInfo(o.shape,"complex64"),b=n.data.get(g.dataId);return b.complexTensorInfos={real:n.makeTensorInfo(o.shape,"float32",h),imag:n.makeTensorInfo(u.shape,"float32",p)},g}const jP={kernelName:bi,backendName:"cpu",kernelFunc:lp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sS(r,t,n="float32"){if(n==="complex64"){const u=sS(r,t,"float32"),h=sS(r,t,"float32");return lp({inputs:{real:u,imag:h},backend:r})}const o=Ot(Rt(t),n);return r.makeTensorInfo(t,n,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L0(r){const{inputs:t,backend:n}=r,{input:o}=t,u=n.data.get(o.dataId).complexTensorInfos.real,h=n.data.get(u.dataId).values;return n.makeTensorInfo(u.shape,u.dtype,h)}const HP={kernelName:ho,backendName:"cpu",kernelFunc:L0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rm(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{dtype:h}=o;if(h==="complex64"){if(u.dtype==="complex64")return xg({inputs:{x:u},backend:n});const p=sS(n,u.shape,u.dtype),g=Rm({inputs:{x:u},backend:n,attrs:{dtype:"float32"}}),b=lp({inputs:{real:g,imag:p},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),b}if(u.dtype==="complex64"){const p=L0({inputs:{input:u},backend:n}),g=Rm({inputs:{x:p},backend:n,attrs:{dtype:h}});return n.disposeIntermediateTensorInfo(p),g}if(!Wr(u.dtype,h)){const p=xg({inputs:{x:u},backend:n});return{dataId:p.dataId,shape:p.shape,dtype:h}}if(h==="int32"){const p=n.data.get(u.dataId).values,g=Int32Array.from(p);return n.makeTensorInfo(u.shape,"int32",g)}if(h==="bool"){const p=n.data.get(u.dataId).values,g=Lf([0],u.dtype),[b,_]=wf((z,V)=>z!==V?1:0)(u.shape,[],p,g,"bool");return n.makeTensorInfo(_,"bool",b)}throw new Error(`Error in Cast: failed to cast ${u.dtype} to ${h}`)}const XP={kernelName:es,backendName:"cpu",kernelFunc:Rm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vf(r,t,n,o){return n==null?({inputs:u,backend:h})=>{const{a:p,b:g}=u,b=h;Go([p,g],r);const _=b.data.get(p.dataId).values,z=b.data.get(g.dataId).values,V=o||p.dtype,[at,Et]=t(p.shape,g.shape,_,z,V);return b.makeTensorInfo(Et,V,at)}:({inputs:u,backend:h})=>{const{a:p,b:g}=u,b=h;if(p.dtype==="complex64"||g.dtype==="complex64"){const _=Rm({inputs:{x:p},backend:b,attrs:{dtype:"complex64"}}),z=b.data.get(_.dataId),V=z.complexTensorInfos.real,at=z.complexTensorInfos.imag,Et=b.data.get(V.dataId).values,St=b.data.get(at.dataId).values,Tt=Rm({inputs:{x:g},backend:b,attrs:{dtype:"complex64"}}),Wt=b.data.get(Tt.dataId),le=Wt.complexTensorInfos.real,ye=Wt.complexTensorInfos.imag,Qe=b.data.get(le.dataId).values,$e=b.data.get(ye.dataId).values,[Xe,Rn,Cn]=n(p.shape,g.shape,Et,St,Qe,$e),mr=b.makeTensorInfo(Cn,"float32",Xe),zr=b.makeTensorInfo(Cn,"float32",Rn),ta=lp({inputs:{real:mr,imag:zr},backend:b});return b.disposeIntermediateTensorInfo(_),b.disposeIntermediateTensorInfo(Tt),b.disposeIntermediateTensorInfo(mr),b.disposeIntermediateTensorInfo(zr),ta}else{const _=b.data.get(p.dataId).values,z=b.data.get(g.dataId).values,V=o||p.dtype,[at,Et]=t(p.shape,g.shape,_,z,V);return b.makeTensorInfo(Et,V,at)}}}function WT(r){return(t,n,o,u,h,p)=>{const g=Nr(t,n),b=Rt(g),_=g.length,z=gt(g),V=sr("float32",b),at=sr("float32",b),Et=$n(t,g),St=$n(n,g),Tt=Uv(o,u),Wt=Uv(h,p),le=t.length,ye=gt(t),Qe=n.length,$e=gt(n);if(Et.length+St.length===0)for(let Xe=0;Xe<V.length;Xe++){const Rn=Xe%Tt.length,Cn=Xe%Wt.length,mr=r(Tt[Rn*2],Tt[Rn*2+1],Wt[Cn*2],Wt[Cn*2+1]);V[Xe]=mr.real,at[Xe]=mr.imag}else for(let Xe=0;Xe<V.length;Xe++){const Rn=xt(Xe,_,z),Cn=Rn.slice(-le);Et.forEach(Za=>Cn[Za]=0);const mr=X(Cn,le,ye),zr=Rn.slice(-Qe);St.forEach(Za=>zr[Za]=0);const ta=X(zr,Qe,$e),Ma=r(Tt[mr*2],Tt[mr*2+1],Wt[ta*2],Wt[ta*2+1]);V[Xe]=Ma.real,at[Xe]=Ma.imag}return[V,at,g]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NN=wf((r,t)=>r+t),YP=WT((r,t,n,o)=>({real:r+n,imag:t+o})),Ex=Vf(ki,NN,YP),KP={kernelName:ki,backendName:"cpu",kernelFunc:Ex};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lc(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{shape:h}=o,p=Rt(u.shape),g=Da(h,p),b=Rt(g);bt(p===b,()=>`The new shape (${g}) has ${b} elements and the old shape (${u.shape}) has ${p} elements. The new shape and old shape must have the same number of elements.`),n.incRef(u.dataId);const _=n.data.get(u.dataId);if(_.complexTensorInfos!=null){const z=_.complexTensorInfos.real,V=_.complexTensorInfos.imag;z.shape=g,V.shape=g}return{dataId:u.dataId,shape:g,dtype:u.dtype}}const ZP={kernelName:Ps,backendName:"cpu",kernelFunc:Lc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kN(r){const{inputs:t,backend:n,attrs:o}=r,{a:u,b:h}=t,{transposeA:p,transposeB:g}=o;Go([u,h],"matMul");const b=u.shape.length,_=h.shape.length,z=p?u.shape[b-2]:u.shape[b-1],V=g?h.shape[_-1]:h.shape[_-2],at=p?u.shape[b-1]:u.shape[b-2],Et=g?h.shape[_-2]:h.shape[_-1],St=u.shape.slice(0,-2),Tt=h.shape.slice(0,-2),Wt=Rt(St),le=Rt(Tt),ye=Wt===le||Wt===1||le===1;bt(b>=2&&_>=2&&ye,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${St}) and (${Tt}).`);const $e=(Wt>le?u.shape.slice(0,-2):h.shape.slice(0,-2)).concat([at,Et]);bt(z===V,()=>`Error in matMul: inner shapes (${z}) and (${V}) of Tensors with shapes ${u.shape} and ${h.shape} and transposeA=${p} and transposeB=${g} must match.`);const Xe=p?[Wt,z,at]:[Wt,at,z],Rn=g?[le,Et,V]:[le,V,Et],Cn=Lc({inputs:{x:u},backend:n,attrs:{shape:Xe}}),mr=Lc({inputs:{x:h},backend:n,attrs:{shape:Rn}}),zr=p?Cn.shape[1]:Cn.shape[2],ta=p?Cn.shape[2]:Cn.shape[1],Ma=g?mr.shape[1]:mr.shape[2],Za=Math.max(Wt,le),Ka=n.data.get(Cn.dataId).values,ni=n.data.get(mr.dataId).values,Ua=gt(Cn.shape),Ba=gt(mr.shape),[mi,ti,yi]=p?[Ua[0],1,Ua[1]]:[Ua[0],Ua[1],1],[$i,Gi,Ji]=g?[1,Ba[1],Ba[0]]:[Ba[1],1,Ba[0]],ro=ta*Ma,io=zs([Za,ta,Ma],Cn.dtype),bo=io.values,co=n.blockSize;for(let Ko=0;Ko<Za;Ko++)for(let gs=0;gs<ta;gs+=co)for(let Es=0;Es<Ma;Es+=co)for(let iu=0;iu<zr;iu+=co){const qu=Math.min(gs+co,ta),Xl=Math.min(Es+co,Ma),Hc=Math.min(iu+co,zr);for(let Cc=gs;Cc<qu;Cc++)for(let pc=Es;pc<Xl;pc++){let vc=0;for(let _c=iu;_c<Hc;_c++){const hf=Math.min(Ko,Wt-1)*mi,rm=Math.min(Ko,le-1)*Ji,fh=Ka[hf+Cc*ti+_c*yi],Eg=ni[_c*$i+pc*Gi+rm];vc+=fh*Eg}bo[Ko*ro+(Cc*Ma+pc)]+=vc}}return n.disposeIntermediateTensorInfo(Cn),n.disposeIntermediateTensorInfo(mr),n.makeTensorInfo($e,io.dtype,io.values)}const qP={kernelName:Fi,backendName:"cpu",kernelFunc:kN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QP(r){const{inputs:t,backend:n,attrs:o}=r,{a:u,b:h,bias:p,preluActivationWeights:g}=t,{transposeA:b,transposeB:_,activation:z,leakyreluAlpha:V}=o;let at,Et,St;const Tt=[];at=kN({inputs:{a:u,b:h},attrs:{transposeA:b,transposeB:_},backend:n}),p&&(Et=Ex({inputs:{a:at,b:p},backend:n}),Tt.push(at),at=Et),z&&(St=UT(n,at,z,g,V),Tt.push(at),at=St);for(const le of Tt)n.disposeIntermediateTensorInfo(le);return at}const JP={kernelName:Hu,backendName:"cpu",kernelFunc:QP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DN(r){const t=new Float32Array(r.length);for(let n=0;n<r.length;++n)t[n]=Math.abs(r[n]);return t}const t3={kernelName:za,backendName:"cpu",kernelFunc:r=>{const{x:t}=r.inputs,n=r.backend;Go(t,"abs");let o=new Float32Array(Rt(t.shape));const u=n.data.get(t.dataId).values;return o=DN(u),n.makeOutput(o,t.shape,"float32")}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e3=Hl(da,r=>Math.acos(r)),n3={kernelName:da,backendName:"cpu",kernelFunc:e3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r3=Hl(Ti,r=>Math.acosh(r)),a3={kernelName:Ti,backendName:"cpu",kernelFunc:r3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i3(r){const{inputs:t,backend:n}=r,o=t;Go(t,"addN");const u=o.map(g=>n.data.get(g.dataId).values),h=zs(o[0].shape,o[0].dtype),p=h.values;for(let g=0;g<o.length;g++){const b=u[g];for(let _=0;_<p.length;_++)p[_]+=b[_]}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const o3={kernelName:vi,backendName:"cpu",kernelFunc:i3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VT(r,t,n,o,u){const h=t.length,p=Rt(t),g=gt(t),b=gt(u),_=sr(n,Rt(u));for(let z=0;z<p;++z){const V=xt(z,h,g),at=new Array(V.length);for(let St=0;St<at.length;St++)at[St]=V[o[St]];const Et=X(at,h,b);_[Et]=r[z]}return _}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _v(r){const{inputs:t,attrs:n,backend:o}=r,{x:u}=t,{perm:h}=n;Go(u,"transpose");const p=u.shape.length,g=new Array(p);for(let V=0;V<g.length;V++)g[V]=u.shape[h[V]];const b=o.data.get(u.dataId).values,_=VT(b,u.shape,u.dtype,h,g);return{dataId:o.write(_,g,u.dtype),shape:g,dtype:u.dtype}}const s3={kernelName:_o,backendName:"cpu",kernelFunc:_v};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;Go(u,"all");const g=Lr(h,u.shape);let b=g;const _=Gc(b,u.shape.length);let z=u;_!=null&&(z=_v({inputs:{x:u},backend:n,attrs:{perm:_}}),b=Qc(b.length,u.shape.length)),kf("all",b,z.shape.length);const[V,at]=uf(z.shape,b),Et=Rt(at),St=Ot(Rt(V),z.dtype),Tt=n.data.get(z.dataId).values;for(let le=0;le<St.length;++le){const ye=le*Et;let Qe=Tt[ye];for(let $e=0;$e<Et;++$e){const Xe=Tt[ye+$e];Qe=Qe&&Xe}St[le]=Qe}_!=null&&n.disposeIntermediateTensorInfo(z);const Wt=n.makeTensorInfo(V,z.dtype,St);if(p){const le=$c(V,g),ye=Lc({inputs:{x:Wt},backend:n,attrs:{shape:le}});return n.disposeIntermediateTensorInfo(Wt),ye}return Wt}const l3={kernelName:ii,backendName:"cpu",kernelFunc:u3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;Go(u,"any");const g=Lr(h,u.shape);let b=g;const _=Gc(b,u.shape.length);let z=u;_!=null&&(z=_v({inputs:{x:u},backend:n,attrs:{perm:_}}),b=Qc(b.length,u.shape.length)),kf("any",b,z.shape.length);const[V,at]=uf(z.shape,b),Et=Rt(at),St=Ot(Rt(V),z.dtype),Tt=n.data.get(z.dataId).values;for(let le=0;le<St.length;++le){const ye=le*Et;let Qe=Tt[ye];for(let $e=0;$e<Et;++$e){const Xe=Tt[ye+$e];Qe=Qe||Xe}St[le]=Qe}_!=null&&n.disposeIntermediateTensorInfo(z);const Wt=n.makeTensorInfo(V,z.dtype,St);if(p){const le=$c(V,g),ye=Lc({inputs:{x:Wt},backend:n,attrs:{shape:le}});return n.disposeIntermediateTensorInfo(Wt),ye}return Wt}const f3={kernelName:Di,backendName:"cpu",kernelFunc:c3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h}=o;Go(u,"argMax");let p=Lr(h,u.shape);const g=Gc(p,u.shape.length);let b=u;const _=[];g!=null&&(b=_v({inputs:{x:u},backend:n,attrs:{perm:g}}),_.push(b),p=Qc(p.length,b.shape.length)),p=[p[0]],kf("argMax",p,b.shape.length);const[z,V]=uf(b.shape,p),at=Rt(z),Et=Ot(at,"int32"),St=Rt(V),Tt=n.data.get(b.dataId).values;for(let Wt=0;Wt<Et.length;++Wt){const le=Wt*St;let ye=Tt[le],Qe=0;for(let $e=0;$e<St;++$e){const Xe=Tt[le+$e];Xe>ye&&(ye=Xe,Qe=$e)}Et[Wt]=Qe}return _.forEach(Wt=>n.disposeIntermediateTensorInfo(Wt)),n.makeTensorInfo(z,"int32",Et)}const d3={kernelName:Ra,backendName:"cpu",kernelFunc:h3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h}=o;Go(u,"argMin");let p=Lr(h,u.shape);const g=Gc(p,u.shape.length);let b=u;const _=[];g!=null&&(b=_v({inputs:{x:u},backend:n,attrs:{perm:g}}),_.push(b),p=Qc(p.length,b.shape.length)),p=[p[0]],kf("argMin",p,b.shape.length);const[z,V]=uf(b.shape,p),at=Rt(z),Et=Ot(at,"int32"),St=Rt(V),Tt=n.data.get(b.dataId).values;for(let Wt=0;Wt<Et.length;++Wt){const le=Wt*St;let ye=Tt[le],Qe=0;for(let $e=0;$e<St;++$e){const Xe=Tt[le+$e];Xe<ye&&(ye=Xe,Qe=$e)}Et[Wt]=Qe}return _.forEach(Wt=>n.disposeIntermediateTensorInfo(Wt)),n.makeTensorInfo(z,"int32",Et)}const v3={kernelName:ln,backendName:"cpu",kernelFunc:p3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g3=Hl(De,r=>Math.asin(r)),m3={kernelName:De,backendName:"cpu",kernelFunc:g3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y3=Hl(dn,r=>Math.asinh(r)),b3={kernelName:dn,backendName:"cpu",kernelFunc:y3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x3=Hl(Wn,r=>Math.atan(r)),w3={kernelName:Wn,backendName:"cpu",kernelFunc:x3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E3=wf((r,t)=>Math.atan2(r,t)),S3=Vf(Kn,E3),C3={kernelName:Kn,backendName:"cpu",kernelFunc:S3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _3=Hl(Gn,r=>Math.atanh(r)),I3={kernelName:Gn,backendName:"cpu",kernelFunc:_3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jT(r,t,n,o,u,h){const p=u.strideHeight,g=u.strideWidth,b=u.dilationHeight,_=u.dilationWidth,z=u.effectiveFilterHeight,V=u.effectiveFilterWidth,at=u.padInfo.top,Et=u.padInfo.left,St=h==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,Tt=zs(u.outShape,n),Wt=Tt.values,le=u.outShape[1]*u.outShape[2]*u.outShape[3],ye=u.outShape[2]*u.outShape[3],Qe=u.outShape[3];for(let $e=0;$e<u.batchSize;++$e){const Xe=$e*le,Rn=$e*o[0];for(let Cn=0;Cn<u.inChannels;++Cn)for(let mr=0;mr<u.outHeight;++mr){const zr=mr*p-at,ta=Math.max(0,zr),Ma=Math.min(u.inHeight,z+zr),Za=Xe+mr*ye;for(let Ka=0;Ka<u.outWidth;++Ka){const ni=Ka*g-Et,Ua=Math.max(0,ni),Ba=Math.min(u.inWidth,V+ni);let mi=St,ti=0,yi=0;for(let Gi=ta;Gi<Ma;Gi+=b){const Ji=Rn+Gi*o[1];for(let ro=Ua;ro<Ba;ro+=_){const io=Ji+ro*o[2],bo=r[io+Cn];h==="max"&&bo>mi?mi=bo:h==="avg"&&(ti+=bo,yi++)}if(isNaN(mi))break}const $i=Za+Ka*Qe+Cn;Wt[$i]=h==="avg"?ti/yi:mi}}}return Tt}function ON(r,t,n,o,u=!1,h=!1){const p=zs(o.outShape,"int32"),g=o.strideHeight,b=o.strideWidth,_=o.dilationHeight,z=o.dilationWidth,V=o.effectiveFilterHeight,at=o.effectiveFilterWidth,Et=o.padInfo.top,St=o.padInfo.left,Tt=zs(t,n,r);for(let Wt=0;Wt<o.batchSize;++Wt)for(let le=0;le<o.inChannels;++le)for(let ye=0;ye<o.outHeight;++ye){const Qe=ye*g-Et;let $e=Qe;for(;$e<0;)$e+=_;const Xe=Math.min(o.inHeight,V+Qe);for(let Rn=0;Rn<o.outWidth;++Rn){const Cn=Rn*b-St;let mr=Cn;for(;mr<0;)mr+=z;const zr=Math.min(o.inWidth,at+Cn);let ta=Number.NEGATIVE_INFINITY,Ma=-1;for(let Za=$e;Za<Xe;Za+=_){const Ka=Za-Qe;for(let ni=mr;ni<zr;ni+=z){const Ua=ni-Cn,Ba=Tt.get(Wt,Za,ni,le);Ba>ta&&(ta=Ba,u?Ma=h?((Wt*o.inHeight+Za)*o.inWidth+ni)*o.inChannels+le:(Za*o.inWidth+ni)*o.inChannels+le:Ma=Ka*at+Ua)}}p.set(Ma,Wt,ye,Rn,le)}}return p}function RN(r,t,n,o,u,h){const p=u.strideDepth,g=u.strideHeight,b=u.strideWidth,_=u.dilationDepth,z=u.dilationHeight,V=u.dilationWidth,at=u.effectiveFilterDepth,Et=u.effectiveFilterHeight,St=u.effectiveFilterWidth,Tt=u.padInfo.front,Wt=u.padInfo.top,le=u.padInfo.left,ye=h==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,Qe=zs(u.outShape,n),$e=Qe.values,Xe=u.outShape[1]*u.outShape[2]*u.outShape[3]*u.outShape[4],Rn=u.outShape[2]*u.outShape[3]*u.outShape[4],Cn=u.outShape[3]*u.outShape[4],mr=u.outShape[4];for(let zr=0;zr<u.batchSize;++zr){const ta=zr*Xe,Ma=zr*o[0];for(let Za=0;Za<u.inChannels;++Za)for(let Ka=0;Ka<u.outDepth;++Ka){const ni=Ka*p-Tt;let Ua=ni;for(;Ua<0;)Ua+=_;const Ba=Math.min(u.inDepth,at+ni),mi=ta+Ka*Rn;for(let ti=0;ti<u.outHeight;++ti){const yi=ti*g-Wt;let $i=yi;for(;$i<0;)$i+=z;const Gi=Math.min(u.inHeight,Et+yi),Ji=mi+ti*Cn;for(let ro=0;ro<u.outWidth;++ro){const io=ro*b-le;let bo=io;for(;bo<0;)bo+=V;const co=Math.min(u.inWidth,St+io),Ko=Ji+ro*mr;let gs=ye,Es=0,iu=0;for(let Xl=Ua;Xl<Ba;Xl+=_){const Hc=Ma+Xl*o[1];for(let Cc=$i;Cc<Gi;Cc+=z){const pc=Hc+Cc*o[2];for(let vc=bo;vc<co;vc+=V){const _c=pc+vc*o[3],hf=r[_c+Za];if(h==="max"&&hf>gs?gs=hf:h==="avg"&&(Es+=hf,iu++),isNaN(gs))break}if(isNaN(gs))break}if(isNaN(gs))break}const qu=Ko+Za;$e[qu]=h==="avg"?Es/iu:gs}}}}return Qe}function T3(r,t){const n=zs(t.outShape,"int32"),o=t.strideDepth,u=t.strideHeight,h=t.strideWidth,p=t.dilationDepth,g=t.dilationHeight,b=t.dilationWidth,_=t.effectiveFilterDepth,z=t.effectiveFilterHeight,V=t.effectiveFilterWidth,at=t.padInfo.front,Et=t.padInfo.top,St=t.padInfo.left;for(let Tt=0;Tt<t.batchSize;++Tt)for(let Wt=0;Wt<t.inChannels;++Wt)for(let le=0;le<t.outDepth;++le){const ye=le*o-at;let Qe=ye;for(;Qe<0;)Qe+=p;const $e=Math.min(t.inDepth,_+ye);for(let Xe=0;Xe<t.outHeight;++Xe){const Rn=Xe*u-Et;let Cn=Rn;for(;Cn<0;)Cn+=g;const mr=Math.min(t.inHeight,z+Rn);for(let zr=0;zr<t.outWidth;++zr){const ta=zr*h-St;let Ma=ta;for(;Ma<0;)Ma+=b;const Za=Math.min(t.inWidth,V+ta);let Ka=Number.NEGATIVE_INFINITY,ni=-1;for(let Ua=Qe;Ua<$e;Ua+=p){const Ba=Ua-ye;for(let mi=Cn;mi<mr;mi+=g){const ti=mi-Rn;for(let yi=Ma;yi<Za;yi+=b){const $i=yi-ta,Gi=r.get(Tt,Ua,mi,yi,Wt);Gi>=Ka&&(Ka=Gi,ni=Ba*z*V+ti*z+$i)}}}n.set(ni,Tt,le,Xe,zr,Wt)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t;Go(u,"avgPool");const{filterSize:h,strides:p,pad:g,dimRoundingMode:b}=o,_=1;bt(Ec(p,_),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${p} and dilations '${_}'`);const z=mf(u.shape,h,p,_,g,b);let V;if(z.filterWidth===1&&z.filterHeight===1&&Bn(z.inShape,z.outShape))V=xg({inputs:{x:u},backend:n});else{const at=n.data.get(u.dataId).values,Et=gt(u.shape),St=jT(at,u.shape,u.dtype,Et,z,"avg");V=n.makeTensorInfo(z.outShape,u.dtype,St.values)}return V}const M3={kernelName:Rr,backendName:"cpu",kernelFunc:A3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{filterSize:h,strides:p,pad:g,dimRoundingMode:b,dataFormat:_,dilations:z}=o;Go(u,"avgPool3d");let V=z;V==null&&(V=[1,1,1]);const at=Hd(u.shape,h,p,V,g,b,_),Et=n.data.get(u.dataId).values,St=RN(Et,u.shape,u.dtype,gt(u.shape),at,"avg");return n.makeTensorInfo(St.shape,"float32",St.values)}const k3={kernelName:La,backendName:"cpu",kernelFunc:N3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D3(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,{filterSize:p,strides:g,pad:b,dilations:_,dimRoundingMode:z}=o;Go([u,h],"avgPool3DGrad");const V=Hd(h.shape,p,g,_,b,z),at=V.strideDepth,Et=V.strideHeight,St=V.strideWidth,Tt=V.filterDepth,Wt=V.filterHeight,le=V.filterWidth,ye=V.dilationDepth,Qe=V.dilationHeight,$e=V.dilationWidth,Xe=V.effectiveFilterDepth,Rn=V.effectiveFilterHeight,Cn=V.effectiveFilterWidth,mr=Xe-1-V.padInfo.front,zr=Cn-1-V.padInfo.left,ta=Rn-1-V.padInfo.top,Ma=zs(h.shape,"float32"),Za=1/(Tt*Wt*le),Ka=n.bufferSync(u);for(let ni=0;ni<V.batchSize;++ni)for(let Ua=0;Ua<V.inChannels;++Ua)for(let Ba=0;Ba<V.inDepth;++Ba)for(let mi=0;mi<V.inHeight;++mi)for(let ti=0;ti<V.inWidth;++ti){const yi=Ba-mr,$i=mi-ta,Gi=ti-zr;let Ji=0;for(let ro=0;ro<Xe;ro+=ye){const io=(yi+ro)/at;if(!(io<0||io>=V.outDepth||Math.floor(io)!==io))for(let bo=0;bo<Rn;bo+=Qe){const co=($i+bo)/Et;if(!(co<0||co>=V.outHeight||Math.floor(co)!==co))for(let Ko=0;Ko<Cn;Ko+=$e){const gs=(Gi+Ko)/St;if(gs<0||gs>=V.outWidth||Math.floor(gs)!==gs)continue;Ji+=Ka.get(ni,io,co,gs,Ua)}}}Ma.set(Ji*Za,ni,Ba,mi,ti,Ua)}return n.makeTensorInfo(Ma.shape,Ma.dtype,Ma.values)}const O3={kernelName:ui,backendName:"cpu",kernelFunc:D3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R3(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,p=h;Go([u,h],"avgPoolGrad");const{filterSize:g,strides:b,pad:_}=o,z=mf(p.shape,g,b,1,_),V=z.strideHeight,at=z.strideWidth,Et=z.filterHeight,St=z.filterWidth,Tt=z.dilationHeight,Wt=z.dilationWidth,le=z.effectiveFilterHeight,ye=z.effectiveFilterWidth,Qe=ye-1-z.padInfo.left,$e=le-1-z.padInfo.top,Xe=zs(p.shape,"float32"),Rn=1/(Et*St),Cn=n.data.get(u.dataId).values,mr=zs(u.shape,"float32",Cn);for(let zr=0;zr<z.batchSize;++zr)for(let ta=0;ta<z.inChannels;++ta)for(let Ma=0;Ma<z.inHeight;++Ma)for(let Za=0;Za<z.inWidth;++Za){const Ka=Ma-$e,ni=Za-Qe;let Ua=0;for(let Ba=0;Ba<le;Ba+=Tt){const mi=(Ka+Ba)/V;if(!(mi<0||mi>=z.outHeight||Math.floor(mi)!==mi))for(let ti=0;ti<ye;ti+=Wt){const yi=(ni+ti)/at;if(yi<0||yi>=z.outWidth||Math.floor(yi)!==yi)continue;Ua+=mr.get(zr,mi,yi,ta)}}Xe.set(Ua*Rn,zr,Ma,Za,ta)}return n.makeTensorInfo(Xe.shape,Xe.dtype,Xe.values)}const L3={kernelName:xa,backendName:"cpu",kernelFunc:R3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,scale:h,offset:p,mean:g,variance:b}=t;bt(g.shape.length===b.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),bt(p==null||g.shape.length===p.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),bt(h==null||g.shape.length===h.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Go([u,g,b,h,p],"batchNorm");let{varianceEpsilon:_}=o;_==null&&(_=.001);const z=n.data.get(u.dataId).values,V=n.data.get(g.dataId).values,at=n.data.get(b.dataId).values,Et=h?n.data.get(h.dataId).values:new Float32Array([1]),St=p?n.data.get(p.dataId).values:new Float32Array([0]),Tt=new Float32Array(z.length),Wt=St.length,le=Et.length,ye=at.length,Qe=V.length;let $e=0,Xe=0,Rn=0,Cn=0;for(let mr=0;mr<z.length;++mr)Tt[mr]=St[$e++]+(z[mr]-V[Xe++])*Et[Rn++]/Math.sqrt(at[Cn++]+_),$e>=Wt&&($e=0),Xe>=Qe&&(Xe=0),Rn>=le&&(Rn=0),Cn>=ye&&(Cn=0);return n.makeTensorInfo(u.shape,u.dtype,Tt)}const F3={kernelName:So,backendName:"cpu",kernelFunc:P3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LN(r,t,n,o,u){const h=_p(o,t,n),p=Rt(n),g=gt(o);if(h){const V=sv(t,g);return u==="string"?r.slice(V,V+p):r.subarray(V,V+p)}const b=u==="string"?Tb(r):r,_=zs(o,u,b),z=zs(n,u);for(let V=0;V<z.size;++V){const at=z.indexToLoc(V),Et=at.map((St,Tt)=>St+t[Tt]);z.set(_.get(...Et),...at)}return u==="string"?Fw(z.values):z.values}function P0(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{begin:h,size:p}=o;Go(u,"slice");const[g,b]=uv(u,h,p);av(u,g,b);const _=n.data.get(u.dataId).values,z=LN(_,g,b,u.shape,u.dtype);return n.makeTensorInfo(b,u.dtype,z)}const B3={kernelName:Cf,backendName:"cpu",kernelFunc:P0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockShape:h,crops:p}=o;Go([u],"batchToSpaceND");const g=h.reduce((le,ye)=>le*ye),b=Kd(u.shape,h,g),_=od(b.length,h.length),z=y0(u.shape,h,g),V=Ay(p,h.length),at=Fg(z,p,h.length),Et=Lc({inputs:{x:u},backend:n,attrs:{shape:b}}),St=_v({inputs:{x:Et},backend:n,attrs:{perm:_}}),Tt=Lc({inputs:{x:St},backend:n,attrs:{shape:z}}),Wt=P0({inputs:{x:Tt},backend:n,attrs:{begin:V,size:at}});return n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(St),n.disposeIntermediateTensorInfo(Tt),Wt}const $3={kernelName:Ki,backendName:"cpu",kernelFunc:z3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HT(r,t,n,o,u){const h=Rt(o),p=Ot(u,n);for(let g=0;g<r.length;g++){const b=r[g];if(b<0)throw new Error("Input x must be non-negative!");b>=u||(h>0?p[b]+=t[g]:p[b]+=1)}return p}function PN(r,t,n,o=!1){const u=r.shape[0],h=r.shape[1],p=zs([u,n],t.dtype);for(let g=0;g<u;g++)for(let b=0;b<h;b++){const _=r.get(g,b);if(_<0)throw new Error("Input x must be non-negative!");_>=n||(o?p.set(1,g,_):t.size>0?p.set(p.get(g,_)+t.get(g,b),g,_):p.set(p.get(g,_)+1,g,_))}return p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,weights:h}=t,{size:p}=o,g=n.data.get(u.dataId).values,b=n.data.get(h.dataId).values,_=HT(g,b,h.dtype,h.shape,p);return n.makeTensorInfo([p],h.dtype,_)}const U3={kernelName:xo,backendName:"cpu",kernelFunc:G3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m1(r){return(t,n,o)=>{const u=sr(n,t.length);for(let h=0;h<t.length;++h)u[h]=r(t[h],o);return u}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FN=m1(r=>Math.ceil(r)),W3=g1(Wo,FN),V3={kernelName:Wo,backendName:"cpu",kernelFunc:W3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j3=Hl(Zi,(r,t)=>{const n=t;return r>n.clipValueMax?n.clipValueMax:r<n.clipValueMin?n.clipValueMin:r}),H3={kernelName:Zi,backendName:"cpu",kernelFunc:j3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X3={kernelName:gi,backendName:"cpu",kernelFunc:r=>{const{x:t}=r.inputs,n=r.backend,o=new Float32Array(Rt(t.shape)),u=n.data.get(t.dataId),h=u.complexTensorInfos.real,p=u.complexTensorInfos.imag,g=n.data.get(h.dataId).values,b=n.data.get(p.dataId).values;for(let _=0;_<g.length;_++){const z=g[_],V=b[_];o[_]=Math.hypot(z,V)}return n.makeOutput(o,t.shape,"float32")}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BN(r,t,n,o){const u=Pn(n,Rt(t));if(o&&n!=="string"){let h=0;r.forEach(p=>{const g=Rt(p.shape);u.set(p.vals,h),h+=g})}else{let h=0;r.forEach(p=>{const g=n==="string"?Tb(p.vals):p.vals;let b=0;for(let _=0;_<p.shape[0];++_){const z=_*t[1]+h;for(let V=0;V<p.shape[1];++V)u[z+V]=g[b++]}h+=p.shape[1]})}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y1(r){const{inputs:t,backend:n}=r,{input:o}=t,u=n.data.get(o.dataId).complexTensorInfos.imag,h=n.data.get(u.dataId).values;return n.makeTensorInfo(u.shape,u.dtype,h)}const Y3={kernelName:bl,backendName:"cpu",kernelFunc:y1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1(r){const{inputs:t,backend:n,attrs:o}=r,{axis:u}=o,h=Lr(u,t[0].shape)[0];let p=mv(t.map(Tt=>Tt.shape),h);if(Rt(p)===0)return n.makeTensorInfo(p,t[0].dtype,[]);const g=t.filter(Tt=>Rt(Tt.shape)>0);if(g.length===1)return xg({inputs:{x:g[0]},backend:n});const b=g.map(Tt=>Tt.shape);if(yb(b,h),g[0].dtype==="complex64"){const Tt=g.map($e=>L0({inputs:{input:$e},backend:n})),Wt=g.map($e=>y1({inputs:{input:$e},backend:n})),le=b1({inputs:Tt,backend:n,attrs:{axis:h}}),ye=b1({inputs:Wt,backend:n,attrs:{axis:h}}),Qe=lp({inputs:{real:le,imag:ye},backend:n});return Tt.forEach($e=>n.disposeIntermediateTensorInfo($e)),Wt.forEach($e=>n.disposeIntermediateTensorInfo($e)),n.disposeIntermediateTensorInfo(le),n.disposeIntermediateTensorInfo(ye),Qe}const _=g.map(Tt=>{const Wt=Rt(Tt.shape.slice(h));return Lc({inputs:{x:Tt},backend:n,attrs:{shape:[-1,Wt]}})}),z=_.map(Tt=>({vals:n.data.get(Tt.dataId).values,shape:Tt.shape}));p=mv(_.map(Tt=>Tt.shape),1);const V=_[0].shape[0]===1,at=BN(z,p,t[0].dtype,V),Et=mv(g.map(Tt=>Tt.shape),h),St=n.makeTensorInfo(Et,t[0].dtype,at);return _.forEach(Tt=>n.disposeIntermediateTensorInfo(Tt)),St}const K3={kernelName:ms,backendName:"cpu",kernelFunc:b1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zN(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dataFormat:b,dilations:_,dimRoundingMode:z}=o;Go([u,h],"conv2d");const V=hv(b),at=kc(u.shape,h.shape,p,_,g,z,!1,V),Et=at.filterHeight,St=at.filterWidth,Tt=at.dilationHeight,Wt=at.dilationWidth,le=at.padInfo.left,ye=at.padInfo.top,Qe=at.dataFormat==="channelsLast",$e=new ae(at.outShape,u.dtype),Xe=gt(u.shape),Rn=gt(h.shape),Cn=Xe[0],mr=Qe?Xe[1]:Xe[2],zr=Qe?Xe[2]:1,ta=Qe?1:Xe[1],Ma=$e.strides[0],Za=Qe?$e.strides[1]:$e.strides[2],Ka=Qe?$e.strides[2]:1,ni=Qe?1:$e.strides[1],Ua=n.data.get(u.dataId).values,Ba=n.data.get(h.dataId).values,mi=$e.values;for(let ti=0;ti<at.batchSize;++ti){const yi=ti*Cn,$i=ti*Ma;for(let Gi=0;Gi<at.outHeight;++Gi){const Ji=$i+Gi*Za,ro=Gi*at.strideHeight-ye;for(let io=0;io<Et;++io){const bo=ro+io*Tt;if(bo<0||bo>=at.inHeight)continue;const co=io*Rn[0],Ko=yi+bo*mr;for(let gs=0;gs<at.outWidth;++gs){const Es=Ji+gs*Ka,iu=gs*at.strideWidth-le;for(let qu=0;qu<St;++qu){const Xl=iu+qu*Wt;if(Xl<0||Xl>=at.inWidth)continue;const Hc=co+qu*Rn[1],Cc=Ko+Xl*zr;let pc=Hc;for(let vc=0;vc<at.inChannels;++vc){const _c=Ua[Cc+vc*ta];for(let hf=0;hf<at.outChannels;++hf)mi[Es+hf*ni]+=_c*Ba[pc+hf];pc+=at.outChannels}}}}}}return n.makeTensorInfo($e.shape,$e.dtype,mi)}const Z3={kernelName:Do,backendName:"cpu",kernelFunc:zN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q3(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,pad:g,dataFormat:b,dimRoundingMode:_,filterShape:z}=o;Go([u,h],"conv2dBackpropFilter");const V=hv(b),at=kc(u.shape,z,p,1,g,_,!1,V),{strideHeight:Et,strideWidth:St,filterHeight:Tt,filterWidth:Wt}=at,le=at.dataFormat==="channelsLast",ye=new ae(at.filterShape,"float32"),Qe=at.padInfo.left,$e=at.padInfo.top,Xe=n.data.get(u.dataId).values,Rn=n.data.get(h.dataId).values,Cn=new ae(u.shape,u.dtype,Xe),mr=new ae(h.shape,h.dtype,Rn);for(let zr=0;zr<Tt;++zr){const ta=Math.max(0,Math.ceil(($e-zr)/Et)),Ma=Math.min(at.outHeight,(at.inHeight+$e-zr)/Et);for(let Za=0;Za<Wt;++Za){const Ka=Math.max(0,Math.ceil((Qe-Za)/St)),ni=Math.min(at.outWidth,(at.inWidth+Qe-Za)/St);for(let Ua=0;Ua<at.inChannels;++Ua)for(let Ba=0;Ba<at.outChannels;++Ba){let mi=0;for(let ti=0;ti<at.batchSize;++ti)for(let yi=ta;yi<Ma;++yi){const $i=zr+yi*Et-$e;for(let Gi=Ka;Gi<ni;++Gi){const Ji=Za+Gi*St-Qe;le?mi+=Cn.get(ti,$i,Ji,Ua)*mr.get(ti,yi,Gi,Ba):mi+=Cn.get(ti,Ua,$i,Ji)*mr.get(ti,Ba,yi,Gi)}}ye.set(mi,zr,Za,Ua,Ba)}}}return n.makeTensorInfo(ye.shape,ye.dtype,ye.values)}const Q3={kernelName:To,backendName:"cpu",kernelFunc:q3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J3(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{inputShape:p,strides:g,pad:b,dataFormat:_,dimRoundingMode:z}=o;Go([u,h],"conv2dBackpropInput");const V=gt(h.shape),at=gt(u.shape);let Et=hv(_);const St=kc(p,h.shape,g,1,b,z,!1,Et),Tt=new ae(St.inShape,"float32"),Wt=Tt.values,le=n.data.get(u.dataId).values,ye=n.data.get(h.dataId).values,[Qe,$e,Xe]=V,{batchSize:Rn,filterHeight:Cn,filterWidth:mr,inChannels:zr,inHeight:ta,inWidth:Ma,outChannels:Za,outHeight:Ka,outWidth:ni,strideHeight:Ua,strideWidth:Ba}=St;Et=St.dataFormat;const mi=Cn-1-St.padInfo.top,ti=mr-1-St.padInfo.left,yi=Et==="channelsLast",$i=Tt.strides[0],Gi=yi?Tt.strides[1]:Tt.strides[2],Ji=yi?Tt.strides[2]:1,ro=yi?1:Tt.strides[1],io=at[0],bo=yi?at[1]:at[2],co=yi?at[2]:1,Ko=yi?1:at[1];for(let gs=0;gs<Rn;++gs)for(let Es=0;Es<zr;++Es)for(let iu=0;iu<ta;++iu){const qu=iu-mi,Xl=Math.max(0,Math.ceil(qu/Ua)),Hc=Math.min(Ka,(Cn+qu)/Ua);for(let Cc=0;Cc<Ma;++Cc){const pc=Cc-ti,vc=Math.max(0,Math.ceil(pc/Ba)),_c=Math.min(ni,(mr+pc)/Ba);let hf=0;for(let fh=Xl;fh<Hc;++fh){const Eg=fh*Ua-qu;for(let Wp=vc;Wp<_c;++Wp){const $0=Wp*Ba-pc,Zv=io*gs+bo*fh+co*Wp,am=Qe*(Cn-1-Eg)+$e*(mr-1-$0)+Xe*Es;for(let Bm=0;Bm<Za;++Bm){const zm=le[Zv+Ko*Bm],$m=ye[am+Bm];hf+=zm*$m}}}const rm=$i*gs+Gi*iu+Ji*Cc+ro*Es;Wt[rm]=hf}}return n.makeTensorInfo(Tt.shape,Tt.dtype,Tt.values)}const tF={kernelName:Zs,backendName:"cpu",kernelFunc:J3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dilations:b}=o;Go([u,h],"conv3d");const _=Th(u.shape,h.shape,p,b,g),{filterDepth:z,filterHeight:V,filterWidth:at,dilationDepth:Et,dilationHeight:St,dilationWidth:Tt,padInfo:Wt}=_,le=Wt.front,ye=Wt.left,Qe=Wt.top,$e=new ae(_.outShape,u.dtype),Xe=n.data.get(u.dataId).values,Rn=n.data.get(h.dataId).values,Cn=$e.values,mr=gt(u.shape),zr=gt(h.shape);for(let ta=0;ta<_.batchSize;++ta){const Ma=ta*mr[0],Za=ta*$e.strides[0];for(let Ka=0;Ka<_.outDepth;++Ka){const ni=Za+Ka*$e.strides[1],Ua=Ka*_.strideDepth-le;for(let Ba=0;Ba<z;++Ba){const mi=Ua+Ba*Et;if(mi<0||mi>=_.inDepth)continue;const ti=Ba*zr[0],yi=Ma+mi*mr[1];for(let $i=0;$i<_.outHeight;++$i){const Gi=ni+$i*$e.strides[2],Ji=$i*_.strideHeight-Qe;for(let ro=0;ro<V;++ro){const io=Ji+ro*St;if(io<0||io>=_.inHeight)continue;const bo=ti+ro*zr[1],co=yi+io*mr[2];for(let Ko=0;Ko<_.outWidth;++Ko){const gs=Gi+Ko*_.outChannels,Es=Ko*_.strideWidth-ye;for(let iu=0;iu<at;++iu){const qu=Es+iu*Tt;if(qu<0||qu>=_.inWidth)continue;const Xl=bo+iu*zr[2],Hc=co+qu*_.inChannels;let Cc=Xl;for(let pc=0;pc<_.inChannels;++pc){const vc=Xe[Hc+pc];for(let _c=0;_c<_.outChannels;++_c)Cn[gs+_c]+=vc*Rn[Cc+_c];Cc+=_.outChannels}}}}}}}}return n.makeTensorInfo($e.shape,$e.dtype,$e.values)}const nF={kernelName:Eu,backendName:"cpu",kernelFunc:eF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,pad:g,filterShape:b}=o;Go([u,h],"conv3dBackpropFilterV2");const _=gt(u.shape),z=gt(h.shape),V=Th(u.shape,b,p,1,g),at=V.strideDepth,Et=V.strideHeight,St=V.strideWidth,Tt=V.filterDepth,Wt=V.filterHeight,le=V.filterWidth,ye=new ae(V.filterShape,"float32"),Qe=ye.values,[$e,Xe,Rn,Cn]=ye.strides,mr=n.data.get(h.dataId).values,[zr,ta,Ma,Za]=z,Ka=n.data.get(u.dataId).values,[ni,Ua,Ba,mi]=_,ti=V.padInfo.front,yi=V.padInfo.left,$i=V.padInfo.top;for(let Gi=0;Gi<Tt;++Gi){const Ji=Math.max(0,Math.ceil((ti-Gi)/at)),ro=Math.min(V.outDepth,(V.inDepth+ti-Gi)/at),io=Gi*$e;for(let bo=0;bo<Wt;++bo){const co=Math.max(0,Math.ceil(($i-bo)/Et)),Ko=Math.min(V.outHeight,(V.inHeight+$i-bo)/Et),gs=bo*Xe+io;for(let Es=0;Es<le;++Es){const iu=Math.max(0,Math.ceil((yi-Es)/St)),qu=Math.min(V.outWidth,(V.inWidth+yi-Es)/St),Xl=Es*Rn+gs;for(let Hc=0;Hc<V.inChannels;++Hc){const Cc=Hc*Cn+Xl;for(let pc=0;pc<V.outChannels;++pc){let vc=0;for(let _c=0;_c<V.batchSize;++_c){const hf=_c*ni,rm=_c*zr;for(let fh=Ji;fh<ro;++fh){const Wp=(Gi+fh*at-ti)*Ua+hf,$0=fh*ta+rm;for(let Zv=co;Zv<Ko;++Zv){const Bm=(bo+Zv*Et-$i)*Ba+Wp,zm=Zv*Ma+$0;for(let $m=iu;$m<qu;++$m){const pA=(Es+$m*St-yi)*mi+Bm,vA=$m*Za+zm;vc+=Ka[pA+Hc]*mr[vA+pc]}}}}Qe[Cc+pc]=vc}}}}}return n.makeTensorInfo(ye.shape,ye.dtype,ye.values)}const aF={kernelName:as,backendName:"cpu",kernelFunc:rF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iF(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{pad:p,strides:g,inputShape:b}=o;Go([u],"conv3dBackpropInputV2");const _=gt(u.shape),z=gt(h.shape),V=Th(b,h.shape,g,1,p),at=new ae(V.inShape,"float32"),Et=at.values,[St,Tt,Wt,le]=at.strides,ye=n.data.get(u.dataId).values,[Qe,$e,Xe,Rn]=_,Cn=n.data.get(h.dataId).values,[mr,zr,ta,Ma]=z,{batchSize:Za,filterDepth:Ka,filterHeight:ni,filterWidth:Ua,inChannels:Ba,inDepth:mi,inHeight:ti,inWidth:yi,outChannels:$i,outDepth:Gi,outHeight:Ji,outWidth:ro,strideDepth:io,strideHeight:bo,strideWidth:co}=V,Ko=Ka-1-V.padInfo.front,gs=ni-1-V.padInfo.top,Es=Ua-1-V.padInfo.left;for(let iu=0;iu<Za;++iu)for(let qu=0;qu<Ba;++qu)for(let Xl=0;Xl<mi;++Xl){const Hc=Xl-Ko,Cc=Math.max(0,Math.ceil(Hc/io)),pc=Math.min(Gi,(Ka+Hc)/io);for(let vc=0;vc<ti;++vc){const _c=vc-gs,hf=Math.max(0,Math.ceil(_c/bo)),rm=Math.min(Ji,(ni+_c)/bo);for(let fh=0;fh<yi;++fh){const Eg=fh-Es,Wp=Math.max(0,Math.ceil(Eg/co)),$0=Math.min(ro,(Ua+Eg)/co);let Zv=0;for(let am=Cc;am<pc;++am){const Bm=am*io-Hc;for(let zm=hf;zm<rm;++zm){const $m=zm*bo-_c;for(let Dx=Wp;Dx<$0;++Dx){const pA=Dx*co-Eg,vA=Qe*iu+$e*am+Xe*zm+Rn*Dx,Y9=mr*(Ka-1-Bm)+zr*(ni-1-$m)+ta*(Ua-1-pA)+Ma*qu;for(let AS=0;AS<$i;++AS){const K9=ye[vA+AS],Z9=Cn[Y9+AS];Zv+=K9*Z9}}}}Et[St*iu+Tt*Xl+Wt*vc+le*fh+qu]=Zv}}}return n.makeTensorInfo(at.shape,at.dtype,at.values)}const oF={kernelName:Rs,backendName:"cpu",kernelFunc:iF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sF=Hl(Su,r=>Math.cos(r)),uF={kernelName:Su,backendName:"cpu",kernelFunc:sF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lF=Hl(fu,r=>Math.cosh(r)),cF={kernelName:fu,backendName:"cpu",kernelFunc:lF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fF(r){const{inputs:t,backend:n,attrs:o}=r,{image:u,boxes:h,boxInd:p}=t,{cropSize:g,method:b,extrapolationValue:_}=o,[z,V,at,Et]=u.shape,St=h.shape[0],[Tt,Wt]=g,le=zs([St,Tt,Wt,Et],"float32"),ye=n.data.get(h.dataId).values,Qe=n.data.get(p.dataId).values,$e=n.data.get(u.dataId).values,Xe=gt(u.shape),Rn=gt(le.shape);for(let Cn=0;Cn<St;Cn++){const mr=Cn*4,zr=ye[mr],ta=ye[mr+1],Ma=ye[mr+2],Za=ye[mr+3],Ka=Qe[Cn];if(Ka>=z)continue;const ni=Tt>1?(Ma-zr)*(V-1)/(Tt-1):0,Ua=Wt>1?(Za-ta)*(at-1)/(Wt-1):0;for(let Ba=0;Ba<Tt;Ba++){const mi=Tt>1?zr*(V-1)+Ba*ni:.5*(zr+Ma)*(V-1);if(mi<0||mi>V-1){for(let ti=0;ti<Wt;ti++)for(let yi=0;yi<Et;yi++){const $i=yi+ti*Rn[2]+Ba*Rn[1]+Cn*Rn[0];le.values[$i]=_}continue}if(b==="bilinear"){const ti=Math.floor(mi),yi=Math.ceil(mi),$i=mi-ti;for(let Gi=0;Gi<Wt;Gi++){const Ji=Wt>1?ta*(at-1)+Gi*Ua:.5*(ta+Za)*(at-1);if(Ji<0||Ji>at-1){for(let co=0;co<Et;co++){const Ko=co+Gi*Rn[2]+Ba*Rn[1]+Cn*Rn[0];le.values[Ko]=_}continue}const ro=Math.floor(Ji),io=Math.ceil(Ji),bo=Ji-ro;for(let co=0;co<Et;co++){let Ko=co+ro*Xe[2]+ti*Xe[1]+Ka*Xe[0];const gs=$e[Ko];Ko=co+io*Xe[2]+ti*Xe[1]+Ka*Xe[0];const Es=$e[Ko];Ko=co+ro*Xe[2]+yi*Xe[1]+Ka*Xe[0];const iu=$e[Ko];Ko=co+io*Xe[2]+yi*Xe[1]+Ka*Xe[0];const qu=$e[Ko],Xl=gs+(Es-gs)*bo,Hc=iu+(qu-iu)*bo;Ko=co+Gi*Rn[2]+Ba*Rn[1]+Cn*Rn[0],le.values[Ko]=Xl+(Hc-Xl)*$i}}}else for(let ti=0;ti<Wt;++ti){const yi=Wt>1?ta*(at-1)+ti*Ua:.5*(ta+Za)*(at-1);if(yi<0||yi>at-1){for(let Ji=0;Ji<Et;Ji++){const ro=Ji+ti*Rn[2]+Ba*Rn[1]+Cn*Rn[0];le.values[ro]=_}continue}const $i=Math.round(yi),Gi=Math.round(mi);for(let Ji=0;Ji<Et;Ji++){const ro=Ji+$i*Xe[2]+Gi*Xe[1]+Ka*Xe[0],io=Ji+ti*Rn[2]+Ba*Rn[1]+Cn*Rn[0];le.values[io]=$e[ro]}}}}return n.makeTensorInfo(le.shape,le.dtype,le.values)}const hF={kernelName:Zo,backendName:"cpu",kernelFunc:fF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,exclusive:p,reverse:g}=o;Go(u,"cumsum");const b=Gc([h],u.shape.length);let _=u;b!=null&&(_=_v({inputs:{x:u},backend:n,attrs:{perm:b}}));const z=Qc(1,u.shape.length)[0];if(z!==_.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${_.shape.length-1} but got axis=${z}`);const V=uo(_.dtype,"int32"),at=Ot(Rt(_.shape),V),Et=n.data.get(_.dataId).values,St=_.shape[_.shape.length-1],Tt=g?(le,ye)=>le+St-ye-1:(le,ye)=>le+ye;for(let le=0;le<Et.length;le+=St)for(let ye=0;ye<St;ye++){const Qe=Tt(le,ye);if(ye===0)at[Qe]=p?0:Et[Qe];else{const $e=Tt(le,ye-1);at[Qe]=p?Et[$e]+at[$e]:Et[Qe]+at[$e]}}const Wt=n.makeTensorInfo(_.shape,V,at);if(b!=null){const le=dm(b),ye=_v({inputs:{x:Wt},backend:n,attrs:{perm:le}});return n.disposeIntermediateTensorInfo(Wt),n.disposeIntermediateTensorInfo(_),ye}return Wt}const pF={kernelName:Is,backendName:"cpu",kernelFunc:dF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,weights:h}=t,{size:p,binaryOutput:g}=o;if(u.shape.length===1){const b=n.data.get(u.dataId).values,_=n.data.get(h.dataId).values,z=HT(b,_,h.dtype,h.shape,p);return n.makeTensorInfo([p],h.dtype,z)}else if(u.shape.length===2){const b=n.bufferSync(u),_=n.bufferSync(h),z=PN(b,_,p,g);return n.makeTensorInfo(z.shape,h.dtype,z.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${u.shape.length}.`)}const gF={kernelName:Wi,backendName:"cpu",kernelFunc:vF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockSize:h,dataFormat:p}=o;bt(p==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${p}`),bt(h>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${h}`);const g=u.shape[0],b=u.shape[1],_=u.shape[2],z=u.shape[3],V=b*h,at=_*h,Et=z/(h*h),St=n.data.get(u.dataId).values,Tt=new Float32Array(g*V*at*Et);let Wt=0;for(let le=0;le<g;++le)for(let ye=0;ye<V;++ye){const Qe=Math.floor(ye/h),$e=ye%h;for(let Xe=0;Xe<at;++Xe){const Rn=Math.floor(Xe/h),Cn=Xe%h,mr=($e*h+Cn)*Et;for(let zr=0;zr<Et;++zr){const Ma=zr+mr+z*(Rn+_*(Qe+b*le));Tt[Wt++]=St[Ma]}}}return n.makeTensorInfo([g,V,at,Et],u.dtype,Tt)}const yF={kernelName:ys,backendName:"cpu",kernelFunc:mF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $N(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dilations:b,dimRoundingMode:_}=o;Go([u,h],"depthwiseConv2DNative");const z=gt(u.shape),V=gt(h.shape);let at=b;at==null&&(at=[1,1]),bt(Ec(p,at),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${p} and dilations '${at}'`);const Et=kc(u.shape,h.shape,p,at,g,_,!0),{filterHeight:St,filterWidth:Tt,dilationHeight:Wt,dilationWidth:le,padInfo:ye}=Et,Qe=ye.left,$e=ye.top,Xe=Et.outChannels/Et.inChannels,Rn=new ae(Et.outShape,u.dtype),Cn=n.data.get(u.dataId).values,mr=n.data.get(h.dataId).values,zr=Rn.values;for(let ta=0;ta<Et.batchSize;++ta){const Ma=ta*z[0],Za=ta*Rn.strides[0];for(let Ka=0;Ka<Et.outHeight;++Ka){const ni=Za+Ka*Rn.strides[1],Ua=Ka*Et.strideHeight-Qe;for(let Ba=0;Ba<St;++Ba){const mi=Ua+Ba*Wt;if(mi<0||mi>=Et.inHeight)continue;const ti=Ba*V[0],yi=Ma+mi*z[1];for(let $i=0;$i<Et.outWidth;++$i){const Gi=ni+$i*Rn.strides[2],Ji=$i*Et.strideWidth-$e;for(let ro=0;ro<Tt;++ro){const io=Ji+ro*le;if(io<0||io>=Et.inWidth)continue;const bo=ti+ro*V[1],co=yi+io*Et.inChannels;let Ko=Gi,gs=bo;for(let Es=0;Es<Et.inChannels;++Es){const iu=Cn[co+Es];for(let qu=0;qu<Xe;++qu)zr[Ko+qu]+=iu*mr[gs+qu];Ko+=Xe,gs+=Xe}}}}}}return n.makeTensorInfo(Rn.shape,Rn.dtype,Rn.values)}const bF={kernelName:is,backendName:"cpu",kernelFunc:$N};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xF(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,dilations:g,pad:b,dimRoundingMode:_,filterShape:z}=o;Go([u,h],"depthwiseConv2dNativeBackpropFilter");const V=kc(u.shape,z,p,g,b,_,!0),{strideHeight:at,strideWidth:Et,filterHeight:St,filterWidth:Tt}=V,Wt=new ae(V.filterShape,"float32"),le=V.padInfo.left,ye=V.padInfo.top,Qe=V.outChannels/V.inChannels,$e=n.data.get(u.dataId).values,Xe=new ae(u.shape,u.dtype,$e),Rn=n.data.get(h.dataId).values,Cn=new ae(h.shape,h.dtype,Rn);for(let mr=0;mr<St;++mr){const zr=Math.max(0,Math.ceil((ye-mr)/at)),ta=Math.min(V.outHeight,(V.inHeight+ye-mr)/at);for(let Ma=0;Ma<Tt;++Ma){const Za=Math.max(0,Math.ceil((le-Ma)/Et)),Ka=Math.min(V.outWidth,(V.inWidth+le-Ma)/Et);for(let ni=0;ni<V.outChannels;++ni){const Ua=Math.trunc(ni/Qe),Ba=ni%Qe;let mi=0;for(let ti=0;ti<V.batchSize;++ti)for(let yi=zr;yi<ta;++yi){const $i=mr+yi*at-ye;for(let Gi=Za;Gi<Ka;++Gi){const Ji=Ma+Gi*Et-le;mi+=Xe.get(ti,$i,Ji,Ua)*Cn.get(ti,yi,Gi,ni)}}Wt.set(mi,mr,Ma,Ua,Ba)}}}return n.makeTensorInfo(Wt.shape,Wt.dtype,Wt.values)}const wF={kernelName:Us,backendName:"cpu",kernelFunc:xF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EF(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{strides:p,dilations:g,pad:b,dimRoundingMode:_,inputShape:z}=o;Go([u,h],"depthwiseConv2DNativeBackpropInput");const V=gt(u.shape),at=gt(h.shape),Et=kc(z,h.shape,p,g,b,_,!0),St=new ae(Et.inShape,"float32"),Tt=St.values,[Wt,le,ye]=St.strides,Qe=n.data.get(u.dataId).values,[$e,Xe,Rn]=V,Cn=n.data.get(h.dataId).values,[mr,zr,ta]=at,{batchSize:Ma,filterHeight:Za,filterWidth:Ka,inChannels:ni,inHeight:Ua,inWidth:Ba,outChannels:mi,outHeight:ti,outWidth:yi,strideHeight:$i,strideWidth:Gi}=Et,Ji=Za-1-Et.padInfo.top,ro=Ka-1-Et.padInfo.left,io=mi/ni;for(let bo=0;bo<Ma;++bo)for(let co=0;co<ni;++co)for(let Ko=0;Ko<Ua;++Ko){const gs=Ko-Ji,Es=Math.max(0,Math.ceil(gs/$i)),iu=Math.min(ti,(Za+gs)/$i);for(let qu=0;qu<Ba;++qu){const Xl=qu-ro,Hc=Math.max(0,Math.ceil(Xl/Gi)),Cc=Math.min(yi,(Ka+Xl)/Gi);let pc=0;for(let vc=Es;vc<iu;++vc){const _c=vc*$i-gs;for(let hf=Hc;hf<Cc;++hf){const rm=hf*Gi-Xl,fh=$e*bo+Xe*vc+Rn*hf,Eg=mr*(Za-1-_c)+zr*(Ka-1-rm)+ta*co;for(let Wp=0;Wp<io;++Wp){const $0=co*io+Wp,Zv=Qe[fh+$0],am=Cn[Eg+Wp];pc+=Zv*am}}}Tt[Wt*bo+le*Ko+ye*qu+co]=pc}}return n.makeTensorInfo(St.shape,St.dtype,St.values)}const SF={kernelName:Du,backendName:"cpu",kernelFunc:EF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CF(r){const{inputs:t,backend:n}=r,{x:o}=t,u=Rt(o.shape),h=n.data.get(o.dataId).values,p=zs([u,u],o.dtype),g=p.values;for(let _=0;_<h.length;_++)g[_*u+_]=h[_];const b=[...o.shape,...o.shape];return n.makeTensorInfo(b,p.dtype,p.values)}const _F={kernelName:qs,backendName:"cpu",kernelFunc:CF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IF={kernelName:Cu,backendName:"cpu",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:o,filter:u}=r,{strides:h,pad:p,dilations:g}=n,b=t,_=b.data.get(o.dataId).values,z=o.shape.length,V=b.data.get(u.dataId).values,at=u.shape.length,{batchSize:Et,inHeight:St,inWidth:Tt,inChannels:Wt,outHeight:le,outWidth:ye,padInfo:Qe,strideHeight:$e,strideWidth:Xe,filterHeight:Rn,filterWidth:Cn,dilationHeight:mr,dilationWidth:zr,outShape:ta}=Nf(o.shape,u.shape,h,p,"NHWC",g),Ma=Rt(ta),Za=ta.length,Ka=Pn(o.dtype,Ma);for(let Ua=0;Ua<Et;++Ua)for(let Ba=0;Ba<le;++Ba){const mi=Ba*$e-Qe.top;for(let ti=0;ti<ye;++ti){const yi=ti*Xe-Qe.left;for(let $i=0;$i<Wt;++$i){let Gi=Number.MIN_SAFE_INTEGER;for(let ro=0;ro<Rn;++ro){const io=mi+ro*mr;if(io>=0&&io<St)for(let bo=0;bo<Cn;++bo){const co=yi+bo*zr;if(co>=0&&co<Tt){const Ko=X([Ua,io,co,$i],z,gt(o.shape)),gs=X([ro,bo,$i],at,gt(u.shape)),Es=_[Ko]+V[gs];Es>Gi&&(Gi=Es)}}}const Ji=X([Ua,Ba,ti,$i],Za,gt(ta));Ka[Ji]=Gi}}}return{dataId:b.write(Lf(Ka,o.dtype),ta,o.dtype),shape:ta,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TF={kernelName:Bi,backendName:"cpu",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:o,filter:u,dy:h}=r,{strides:p,pad:g,dilations:b}=n,_=t,z=un(o.shape,_.data.get(o.dataId).values),V=un(u.shape,_.data.get(u.dataId).values),{batchSize:at,inHeight:Et,inWidth:St,inChannels:Tt,outHeight:Wt,outWidth:le,padInfo:ye,strideHeight:Qe,strideWidth:$e,filterHeight:Xe,filterWidth:Rn,dilationHeight:Cn,dilationWidth:mr,outShape:zr}=Nf(o.shape,u.shape,p,g,"NHWC",b);bt(h.rank===zr.length,()=>`Error in ${Bi}, dy must have the same rank as output ${zr.length}, but got ${h.rank}`);const ta=un(zr,_.data.get(h.dataId).values),Ma=it(u.shape,u.dtype);for(let Ka=0;Ka<at;++Ka)for(let ni=0;ni<Wt;++ni){const Ua=ni*Qe-ye.top;for(let Ba=0;Ba<le;++Ba){const mi=Ba*$e-ye.left;for(let ti=0;ti<Tt;++ti){let yi=Number.MIN_SAFE_INTEGER,$i=0,Gi=0;for(let Ji=0;Ji<Xe;++Ji){const ro=Ua+Ji*Cn;if(ro>=0&&ro<Et)for(let io=0;io<Rn;++io){const bo=mi+io*mr;if(bo>=0&&bo<St){const co=z[Ka][ro][bo][ti]+V[Ji][io][ti];co>yi&&(yi=co,$i=Ji,Gi=io)}}}Ma[$i][Gi][ti]+=ta[Ka][ni][Ba][ti]}}}return{dataId:_.write(Lf(Ma,o.dtype),u.shape,u.dtype),shape:u.shape,dtype:u.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AF={kernelName:ji,backendName:"cpu",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:o,filter:u,dy:h}=r,{strides:p,pad:g,dilations:b}=n,_=t,z=un(o.shape,_.data.get(o.dataId).values),V=un(u.shape,_.data.get(u.dataId).values),{batchSize:at,inHeight:Et,inWidth:St,inChannels:Tt,outHeight:Wt,outWidth:le,padInfo:ye,strideHeight:Qe,strideWidth:$e,filterHeight:Xe,filterWidth:Rn,dilationHeight:Cn,dilationWidth:mr,outShape:zr}=Nf(o.shape,u.shape,p,g,"NHWC",b);bt(h.rank===zr.length,()=>`Error in ${ji}, dy must have the same rank as output ${zr.length}, but got ${h.rank}`);const ta=un(zr,_.data.get(h.dataId).values),Ma=it(o.shape,o.dtype);for(let Ka=0;Ka<at;++Ka)for(let ni=0;ni<Wt;++ni){const Ua=ni*Qe-ye.top;for(let Ba=0;Ba<le;++Ba){const mi=Ba*$e-ye.left;for(let ti=0;ti<Tt;++ti){let yi=Number.MIN_SAFE_INTEGER,$i=Ua<0?0:Ua,Gi=mi<0?0:mi;for(let Ji=0;Ji<Xe;++Ji){const ro=Ua+Ji*Cn;if(ro>=0&&ro<Et)for(let io=0;io<Rn;++io){const bo=mi+io*mr;if(bo>=0&&bo<St){const co=z[Ka][ro][bo][ti]+V[Ji][io][ti];co>yi&&(yi=co,$i=ro,Gi=bo)}}}Ma[Ka][$i][Gi][ti]+=ta[Ka][ni][Ba][ti]}}}return{dataId:_.write(Lf(Ma,o.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MF(r){const{inputs:t,backend:n}=r,{dy:o,y:u}=t;Go([o,u],"eluGrad");const h=new Float32Array(Rt(u.shape)),p=n.data.get(u.dataId).values,g=n.data.get(o.dataId).values;for(let b=0;b<p.length;++b){const _=p[b];_>=1?h[b]=g[b]:h[b]=g[b]*(_+1)}return n.makeTensorInfo(u.shape,"float32",h)}const NF={kernelName:Ws,backendName:"cpu",kernelFunc:MF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kF=wf((r,t)=>r===t?1:0),GN=Vf(Qs,kF,null,"bool"),DF={kernelName:Qs,backendName:"cpu",kernelFunc:GN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OF=bb,RF=xb,LF=wb,PF=ky,FF=Eb,BF=Zd,zF=Hl(Ss,r=>{const t=Math.sign(r),n=Math.abs(r),o=1/(1+OF*n);return t*(1-((((BF*o+FF)*o+PF)*o+LF)*o+RF)*o*Math.exp(-n*n))}),$F={kernelName:Ss,backendName:"cpu",kernelFunc:zF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UN=m1(r=>Math.exp(r)),WN=g1(Qu,UN),GF={kernelName:Qu,backendName:"cpu",kernelFunc:WN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uS(r){const{inputs:t,backend:n,attrs:o}=r,{input:u}=t,{dim:h}=o,p=u.shape.length,g=u.shape.slice();let b=h;return h<0&&(bt(-(p+1)<=h,()=>`Axis must be in the interval [${-(p+1)}, ${p}]`),b=p+h+1),g.splice(b,0,1),Lc({inputs:{x:u},backend:n,attrs:{shape:g}})}const UF={kernelName:xn,backendName:"cpu",kernelFunc:uS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VN=m1(r=>Math.expm1(r)),WF=g1(Vr,VN),VF={kernelName:Vr,backendName:"cpu",kernelFunc:WF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XT=wf((r,t)=>r*t),jF=WT((r,t,n,o)=>({real:r*n-t*o,imag:r*o+t*n})),YT=Vf(Ie,XT,jF),HF={kernelName:Ie,backendName:"cpu",kernelFunc:YT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XF=wf((r,t)=>r/t),KT=Vf(Ms,XF),ZT={kernelName:Ms,backendName:"cpu",kernelFunc:KT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jN=wf((r,t)=>r-t),YF=WT((r,t,n,o)=>({real:r-n,imag:t-o})),qT=Vf(ha,jN,YF),KF={kernelName:ha,backendName:"cpu",kernelFunc:qT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HN(r,t,n){const o=r.shape,u=o[0],h=o[1],p=n.data.get(r.dataId),g=p.complexTensorInfos.real,b=p.complexTensorInfos.imag,_=[u,h],z=Rt(_),V=sr("float32",z),at=sr("float32",z);for(let Wt=0;Wt<u;Wt++){const le=P0({inputs:{x:g},backend:n,attrs:{begin:[Wt,0],size:[1,h]}}),ye=P0({inputs:{x:b},backend:n,attrs:{begin:[Wt,0],size:[1,h]}}),Qe=lp({inputs:{real:le,imag:ye},backend:n}),{real:$e,imag:Xe}=ZF(Qe,t,n),Rn=Uv($e,Xe);for(let Cn=0;Cn<h;Cn++){const mr=yv(Rn,Cn);V[Wt*h+Cn]=mr.real,at[Wt*h+Cn]=mr.imag}n.disposeIntermediateTensorInfo(le),n.disposeIntermediateTensorInfo(ye),n.disposeIntermediateTensorInfo(Qe)}const Et=n.makeTensorInfo(_,"float32",V),St=n.makeTensorInfo(_,"float32",at),Tt=lp({inputs:{real:Et,imag:St},backend:n});return n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(St),Tt}function ZF(r,t,n){const o=Rt(r.shape),u=n.data.get(r.dataId),h=n.data.get(u.complexTensorInfos.real.dataId).values,p=n.data.get(u.complexTensorInfos.imag.dataId).values;if(qF(o)){const g=QT(h,p,o,t,n),b=[r.shape[0],r.shape[1]];if(t){const _=n.makeTensorInfo(b,"float32",g.real),z=n.makeTensorInfo(b,"float32",g.imag),V=n.makeTensorInfo([],"float32",vf(o,"float32")),at=xg({inputs:{x:V},backend:n}),Et=ZT.kernelFunc({inputs:{a:_,b:V},backend:n}),St=ZT.kernelFunc({inputs:{a:z,b:at},backend:n}),Tt=n.data.get(Et.dataId).values,Wt=n.data.get(St.dataId).values;return n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(z),n.disposeIntermediateTensorInfo(V),n.disposeIntermediateTensorInfo(at),n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(St),{real:Tt,imag:Wt}}return g}else{const g=Uv(h,p),b=QF(g,o,t);return Cm(b)}}function qF(r){return(r&r-1)==0}function QT(r,t,n,o,u){if(n===1)return{real:r,imag:t};const h=Uv(r,t),p=n/2,g=Cb(h),b=g.real,_=g.imag,z=[b.length],V=u.makeTensorInfo(z,"float32",b),at=u.makeTensorInfo(z,"float32",_),Et=lp({inputs:{real:V,imag:at},backend:u}),St=Wv(h),Tt=St.real,Wt=St.imag,le=[Tt.length],ye=u.makeTensorInfo(le,"float32",Tt),Qe=u.makeTensorInfo(le,"float32",Wt),$e=lp({inputs:{real:ye,imag:Qe},backend:u}),Xe=QT(b,_,p,o,u),Rn=Xe.real,Cn=Xe.imag,mr=[Rn.length],zr=u.makeTensorInfo(mr,"float32",Rn),ta=u.makeTensorInfo(mr,"float32",Cn),Ma=lp({inputs:{real:zr,imag:ta},backend:u}),Za=QT(Tt,Wt,p,o,u),Ka=Za.real,ni=Za.imag,Ua=[Ka.length],Ba=u.makeTensorInfo(Ua,"float32",Ka),mi=u.makeTensorInfo(Ua,"float32",ni),ti=lp({inputs:{real:Ba,imag:mi},backend:u}),yi=Rw(n,o),$i=[yi.real.length],Gi=u.makeTensorInfo($i,"float32",yi.real),Ji=u.makeTensorInfo($i,"float32",yi.imag),ro=lp({inputs:{real:Gi,imag:Ji},backend:u}),io=YT({inputs:{a:ro,b:ti},backend:u}),bo=Ex({inputs:{a:Ma,b:io},backend:u}),co=qT({inputs:{a:Ma,b:io},backend:u}),Ko=L0({inputs:{input:bo},backend:u}),gs=L0({inputs:{input:co},backend:u}),Es=y1({inputs:{input:bo},backend:u}),iu=y1({inputs:{input:co},backend:u}),qu=b1({inputs:[Ko,gs],backend:u,attrs:{axis:0}}),Xl=b1({inputs:[Es,iu],backend:u,attrs:{axis:0}}),Hc=u.data.get(qu.dataId).values,Cc=u.data.get(Xl.dataId).values;return u.disposeIntermediateTensorInfo(V),u.disposeIntermediateTensorInfo(at),u.disposeIntermediateTensorInfo(Et),u.disposeIntermediateTensorInfo(ye),u.disposeIntermediateTensorInfo(Qe),u.disposeIntermediateTensorInfo($e),u.disposeIntermediateTensorInfo(zr),u.disposeIntermediateTensorInfo(ta),u.disposeIntermediateTensorInfo(Ma),u.disposeIntermediateTensorInfo(Ba),u.disposeIntermediateTensorInfo(mi),u.disposeIntermediateTensorInfo(ti),u.disposeIntermediateTensorInfo(Gi),u.disposeIntermediateTensorInfo(Ji),u.disposeIntermediateTensorInfo(ro),u.disposeIntermediateTensorInfo(io),u.disposeIntermediateTensorInfo(bo),u.disposeIntermediateTensorInfo(co),u.disposeIntermediateTensorInfo(Ko),u.disposeIntermediateTensorInfo(Es),u.disposeIntermediateTensorInfo(gs),u.disposeIntermediateTensorInfo(iu),u.disposeIntermediateTensorInfo(qu),u.disposeIntermediateTensorInfo(Xl),{real:Hc,imag:Cc}}function QF(r,t,n){const o=new Float32Array(t*2);for(let u=0;u<t;u++){let h=0,p=0;for(let g=0;g<t;g++){const b=_m(u*g,t,n),_=yv(r,g);h+=_.real*b.real-_.imag*b.imag,p+=_.real*b.imag+_.imag*b.real}n&&(h/=t,p/=t),Ow(o,h,p,u)}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JF(r){const{inputs:t,backend:n}=r,{input:o}=t,u=Rt(o.shape),h=o.shape[o.shape.length-1],p=u/h,g=Lc({inputs:{x:o},backend:n,attrs:{shape:[p,h]}}),b=HN(g,!1,n),_=Lc({inputs:{x:b},backend:n,attrs:{shape:o.shape}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),_}const tB={kernelName:pa,backendName:"cpu",kernelFunc:JF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JT(r){const{backend:t,attrs:n}=r,{shape:o,value:u,dtype:h}=n,p=h||ua(u),g=Pn(p,Rt(o));return nB(g,u,p),t.makeTensorInfo(o,p,g)}const eB={kernelName:Fa,backendName:"cpu",kernelFunc:JT};function nB(r,t,n){r.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rB={kernelName:Vi,backendName:"cpu",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{image:o}=r,u=n,h=sr(o.dtype,Rt(o.shape)),[p,g,b,_]=o.shape,z=u.data.get(o.dataId).values;for(let at=0;at<p;at++){const Et=at*b*g*_;for(let St=0;St<g;St++){const Tt=St*(b*_);for(let Wt=0;Wt<b;Wt++){const le=Wt*_;for(let ye=0;ye<_;ye++){const $e=[p,St,Wt,ye][2],Xe=Math.round(b-$e),Rn=Et+Tt+le+ye;let Cn=z[Rn];if(Xe>=0&&Xe<b){const mr=Xe*_,zr=Et+Tt+mr+ye;Cn=z[zr]}h[Rn]=Cn}}}}return{dataId:u.write(h,o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XN=m1(r=>Math.floor(r)),aB=g1(Ao,XN),iB={kernelName:Ao,backendName:"cpu",kernelFunc:aB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oB=wf((r,t)=>Math.floor(r/t)),sB=Vf(ao,oB,null,"int32"),uB={kernelName:ao,backendName:"cpu",kernelFunc:sB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lB(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h,bias:p,preluActivationWeights:g}=t,{strides:b,pad:_,dataFormat:z,dilations:V,dimRoundingMode:at,activation:Et,leakyreluAlpha:St}=o;let Tt=zN({inputs:{x:u,filter:h},backend:n,attrs:{strides:b,pad:_,dataFormat:z,dilations:V,dimRoundingMode:at}});if(p){const Wt=Tt;Tt=Ex({inputs:{a:Tt,b:p},backend:n}),n.disposeIntermediateTensorInfo(Wt)}if(Et){const Wt=Tt;Tt=UT(n,Tt,Et,g,St),n.disposeIntermediateTensorInfo(Wt)}return Tt}const cB={kernelName:al,backendName:"cpu",kernelFunc:lB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fB(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h,bias:p,preluActivationWeights:g}=t,{strides:b,pad:_,dataFormat:z,dilations:V,dimRoundingMode:at,activation:Et,leakyreluAlpha:St}=o;let Tt=$N({inputs:{x:u,filter:h},backend:n,attrs:{strides:b,pad:_,dataFormat:z,dilations:V,dimRoundingMode:at}});if(p){const Wt=Tt;Tt=Ex({inputs:{a:Tt,b:p},backend:n}),n.disposeIntermediateTensorInfo(Wt)}if(Et){const Wt=Tt;Tt=UT(n,Tt,Et,g,St),n.disposeIntermediateTensorInfo(Wt)}return Tt}const hB={kernelName:il,backendName:"cpu",kernelFunc:fB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dB(r){const{inputs:t,backend:n}=r,{params:o,indices:u}=t,h=Rt(o.shape),p=u.shape,g=p[p.length-1],[b,_,z,V]=Sh(o,u);if(_===0)return n.makeTensorInfo(b,o.dtype,[]);const at=zs([_,z],o.dtype),Et=n.data.get(u.dataId).values,St=n.data.get(o.dataId).values;for(let Tt=0;Tt<_;Tt++){const Wt=[];let le=0;for(let ye=0;ye<g;ye++){const Qe=Et[Tt*g+ye];le+=Qe*V[ye],Wt.push(Qe)}if(le<0||le>=h/z)throw new Error(`Invalid indices: ${Wt} does not index into ${o.shape}`);for(let ye=0;ye<z;ye++)at.values[Tt*z+ye]=St[le*z+ye]}return n.makeTensorInfo(b,at.dtype,at.values)}const pB={kernelName:fo,backendName:"cpu",kernelFunc:dB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YN(r,t,n){const o=zs(n,r.dtype);for(let u=0;u<o.size;++u){const p=o.indexToLoc(u).slice(),g=p[0],b=p[2],_=t.locToIndex([g,b]);p[2]=t.values[_];const z=r.locToIndex(p);o.values[u]=r.values[z]}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vB(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,indices:h}=t,{axis:p,batchDims:g}=o;Go([u,h],"gatherV2");let b=g;g==null&&(b=0);const _=Rt(h.shape),z=Lr(p,u.shape)[0],V=bv(u,h,z,b),at=Lc({inputs:{x:u},backend:n,attrs:{shape:[V.batchSize,V.outerSize,V.dimSize,V.sliceSize]}}),Et=Lc({inputs:{x:h},backend:n,attrs:{shape:[V.batchSize,_/V.batchSize]}}),St=[V.batchSize,V.outerSize,_/V.batchSize,V.sliceSize],Tt=n.bufferSync(Et),Wt=n.bufferSync(at),le=YN(Wt,Tt,St);return n.disposeIntermediateTensorInfo(at),n.disposeIntermediateTensorInfo(Et),n.makeTensorInfo(V.outputShape,le.dtype,le.values)}const gB={kernelName:Ts,backendName:"cpu",kernelFunc:vB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KN=wf((r,t)=>r>t?1:0),mB=Vf(ou,KN,null,"bool"),yB={kernelName:ou,backendName:"cpu",kernelFunc:mB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bB=wf((r,t)=>r>=t?1:0),xB=Vf(Cs,bB,null,"bool"),wB={kernelName:Cs,backendName:"cpu",kernelFunc:xB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EB(r){const{inputs:t,backend:n}=r,{input:o}=t,u=Rt(o.shape),h=o.shape[o.shape.length-1],p=u/h,g=Lc({inputs:{x:o},backend:n,attrs:{shape:[p,h]}}),b=HN(g,!0,n),_=Lc({inputs:{x:b},backend:n,attrs:{shape:o.shape}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),_}const SB={kernelName:Tl,backendName:"cpu",kernelFunc:EB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CB=Hl(Js,r=>Number.isFinite(r)?1:0,"bool"),_B={kernelName:Js,backendName:"cpu",kernelFunc:CB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IB=Hl(ul,r=>Math.abs(r)===Infinity?1:0,"bool"),TB={kernelName:ul,backendName:"cpu",kernelFunc:IB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AB=Hl(Mu,r=>Number.isNaN(r)?1:0,"bool"),MB={kernelName:Mu,backendName:"cpu",kernelFunc:AB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZN=wf((r,t)=>r<t?1:0),NB=Vf(Nu,ZN,null,"bool"),kB={kernelName:Nu,backendName:"cpu",kernelFunc:NB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DB=wf((r,t)=>r<=t?1:0),OB=Vf(fs,DB,null,"bool"),RB={kernelName:fs,backendName:"cpu",kernelFunc:OB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qN(r,t,n){const o=(t-r)/(n-1),u=Ot(n,"float32");u[0]=r;for(let h=1;h<u.length;h++)u[h]=u[h-1]+o;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LB(r){const{backend:t,attrs:n}=r,{start:o,stop:u,num:h}=n,p=qN(o,u,h);return t.makeTensorInfo([p.length],"float32",p)}const PB={kernelName:Bs,backendName:"cpu",kernelFunc:LB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QN=m1(r=>Math.log(r)),FB=g1(gu,QN),BB={kernelName:gu,backendName:"cpu",kernelFunc:FB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zB=Hl(Fu,r=>Math.log1p(r)),$B={kernelName:Fu,backendName:"cpu",kernelFunc:zB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GB=wf((r,t)=>r&&t),UB=Vf(Wu,GB,null,"bool"),WB={kernelName:Wu,backendName:"cpu",kernelFunc:UB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VB=Hl(Ju,r=>r?0:1,"bool"),jB={kernelName:Ju,backendName:"cpu",kernelFunc:VB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HB=wf((r,t)=>r||t),XB=Vf(tu,HB,null,"bool"),YB={kernelName:tu,backendName:"cpu",kernelFunc:XB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KB(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{depthRadius:h,bias:p,alpha:g,beta:b}=o;Go(u,"LRN");const _=u.shape[3],z=_-1,V=n.data.get(u.dataId).values,at=Rt(u.shape),Et=new Float32Array(at);function St(Tt){const Wt=Tt%_;let le=Tt-Wt+Math.max(0,Wt-h);const ye=Tt-Wt+Math.min(Wt+h,z);let Qe=0;for(;le<=ye;le++){const $e=V[le];Qe+=$e*$e}return Qe}for(let Tt=0;Tt<at;Tt++){const Wt=St(Tt),le=V[Tt]*Math.pow(p+g*Wt,-b);Et[Tt]=le}return n.makeTensorInfo(u.shape,u.dtype,Et)}const ZB={kernelName:Bl,backendName:"cpu",kernelFunc:KB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qB(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,y:h,dy:p}=t,{depthRadius:g,bias:b,alpha:_,beta:z}=o;Go(p,"LRNGrad");const V=Rt(p.shape),at=p.shape[3],Et=n.data.get(p.dataId).values,St=n.data.get(u.dataId).values,Tt=n.data.get(h.dataId).values,Wt=new Float32Array(V),le=V;for(let ye=0;ye<le;ye++){const Qe=ye%at,$e=ye-Qe+Math.max(0,Qe-g),Xe=ye-Qe+Math.min(at,Qe+g+1);let Rn=0;for(let Cn=$e;Cn<Xe;Cn++)Rn+=Math.pow(St[Cn],2);Rn=_*Rn+b;for(let Cn=$e;Cn<Xe;Cn++){let mr=-2*_*z*St[Cn]*Tt[ye]/Rn;ye===Cn&&(mr+=Math.pow(Rn,-z)),mr*=Et[ye],Wt[Cn]+=mr}}return n.makeTensorInfo(p.shape,u.dtype,Wt)}const QB={kernelName:vl,backendName:"cpu",kernelFunc:qB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JN(r,t,n,o){const u=sr(o,Rt(n));for(let h=0;h<u.length;++h){const p=h*t;let g=r[p];for(let b=0;b<t;++b){const _=r[p+b];_>g&&(g=_)}u[h]=g}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tk(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{reductionIndices:h,keepDims:p}=o,g=n;let b=u.shape;const _=b.length,z=Lr(h,b);let V=z;const at=Gc(V,_);let Et=g.data.get(u.dataId).values;if(at!=null){const $e=new Array(_);for(let Xe=0;Xe<$e.length;Xe++)$e[Xe]=b[at[Xe]];Et=VT(Et,b,u.dtype,at,$e),V=Qc(V.length,_),b=$e}Go(u,"max"),kf("max",V,_);const[St,Tt]=uf(b,V),Wt=Rt(Tt),le=JN(Et,Wt,St,u.dtype),ye=g.write(le,St,u.dtype);let Qe=St;return p&&(Qe=$c(St,z)),{dataId:ye,shape:Qe,dtype:u.dtype}}const JB={kernelName:Ls,backendName:"cpu",kernelFunc:tk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ek=wf((r,t)=>Math.max(r,t)),t4=Vf(el,ek),e4={kernelName:el,backendName:"cpu",kernelFunc:t4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t;Go(u,"maxPool");const{filterSize:h,strides:p,pad:g,dimRoundingMode:b}=o,_=1;bt(Ec(p,_),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${p} and dilations '${_}'`);const z=mf(u.shape,h,p,_,g,b);let V;if(z.filterWidth===1&&z.filterHeight===1&&Bn(z.inShape,z.outShape))V=xg({inputs:{x:u},backend:n});else{const at=n.data.get(u.dataId).values,Et=gt(u.shape),St=jT(at,u.shape,u.dtype,Et,z,"max");V=n.makeTensorInfo(z.outShape,u.dtype,St.values)}return V}const r4={kernelName:oc,backendName:"cpu",kernelFunc:n4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{filterSize:h,strides:p,pad:g,dimRoundingMode:b,dataFormat:_,dilations:z}=o;Go(u,"maxPool3d");let V=z;V==null&&(V=[1,1,1]);const at=Hd(u.shape,h,p,V,g,b,_),Et=n.data.get(u.dataId).values,St=RN(Et,u.shape,u.dtype,gt(u.shape),at,"max");return n.makeTensorInfo(St.shape,"float32",St.values)}const i4={kernelName:Ic,backendName:"cpu",kernelFunc:a4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o4(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,{filterSize:p,strides:g,pad:b,dilations:_,dimRoundingMode:z}=o;Go([u,h],"maxPool3DGrad");const V=Hd(h.shape,p,g,_,b,z),at=n.bufferSync(h),Et=T3(at,V),St=V.strideDepth,Tt=V.strideHeight,Wt=V.strideWidth,le=V.dilationDepth,ye=V.dilationHeight,Qe=V.dilationWidth,$e=V.effectiveFilterDepth,Xe=V.effectiveFilterHeight,Rn=V.effectiveFilterWidth,Cn=$e-1-V.padInfo.front,mr=Rn-1-V.padInfo.left,zr=Xe-1-V.padInfo.top,ta=zs(h.shape,"float32"),Ma=n.bufferSync(u);for(let Za=0;Za<V.batchSize;++Za)for(let Ka=0;Ka<V.inChannels;++Ka)for(let ni=0;ni<V.inDepth;++ni)for(let Ua=0;Ua<V.inHeight;++Ua)for(let Ba=0;Ba<V.inWidth;++Ba){const mi=ni-Cn,ti=Ua-zr,yi=Ba-mr;let $i=0;for(let Gi=0;Gi<$e;Gi+=le){const Ji=(mi+Gi)/St;if(!(Ji<0||Ji>=V.outDepth||Math.floor(Ji)!==Ji))for(let ro=0;ro<Xe;ro+=ye){const io=(ti+ro)/Tt;if(!(io<0||io>=V.outHeight||Math.floor(io)!==io))for(let bo=0;bo<Rn;bo+=Qe){const co=(yi+bo)/Wt;if(co<0||co>=V.outWidth||Math.floor(co)!==co)continue;const Ko=$e*Xe*Rn-1-Et.get(Za,Ji,io,co,Ka),gs=Gi*Xe*Rn+ro*Rn+bo,Es=Ko===gs?1:0;if(Es===0)continue;$i+=Ma.get(Za,Ji,io,co,Ka)*Es}}}ta.set($i,Za,ni,Ua,Ba,Ka)}return n.makeTensorInfo(ta.shape,ta.dtype,ta.values)}const s4={kernelName:Se,backendName:"cpu",kernelFunc:o4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u4(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h,output:p}=t,g=h;Go([h,p],"maxPoolGrad");const{filterSize:b,strides:_,pad:z,dimRoundingMode:V}=o,at=mf(g.shape,b,_,1,z,V),Et=n.data.get(g.dataId).values,St=zs(at.outShape,g.dtype,ON(Et,g.shape,g.dtype,at).values),Tt=at.strideHeight,Wt=at.strideWidth,le=at.dilationHeight,ye=at.dilationWidth,Qe=at.effectiveFilterHeight,$e=at.effectiveFilterWidth,Xe=$e-1-at.padInfo.left,Rn=Qe-1-at.padInfo.top,Cn=zs(g.shape,"float32"),mr=n.data.get(u.dataId).values,zr=zs(u.shape,"float32",mr);for(let ta=0;ta<at.batchSize;++ta)for(let Ma=0;Ma<at.inChannels;++Ma)for(let Za=0;Za<at.inHeight;++Za)for(let Ka=0;Ka<at.inWidth;++Ka){const ni=Za-Rn,Ua=Ka-Xe;let Ba=0;for(let mi=0;mi<Qe;mi+=le){const ti=(ni+mi)/Tt;if(!(ti<0||ti>=at.outHeight||Math.floor(ti)!==ti))for(let yi=0;yi<$e;yi+=ye){const $i=(Ua+yi)/Wt;if($i<0||$i>=at.outWidth||Math.floor($i)!==$i)continue;const Gi=Qe*$e-1-St.get(ta,ti,$i,Ma),Ji=mi*$e+yi,ro=Gi===Ji?1:0;if(ro===0)continue;Ba+=zr.get(ta,ti,$i,Ma)*ro}}Cn.set(Ba,ta,Za,Ka,Ma)}return n.makeTensorInfo(Cn.shape,Cn.dtype,Cn.values)}const l4={kernelName:Ol,backendName:"cpu",kernelFunc:u4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c4(r,t,n,o,u){const h=gt(t),p=jT(r,t,n,h,u,"max"),g=ON(r,t,n,u,!0,o);return[p.values,g.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f4={kernelName:ve,backendName:"cpu",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{x:o}=r,{filterSize:u,strides:h,pad:p,includeBatchInIndex:g}=t,b=n;Go(o,"MaxPoolWithArgmax");const _=b.data.get(o.dataId).values,z=mf(o.shape,u,h,[1,1],p),[V,at]=c4(_,o.shape,o.dtype,g,z),Et=b.write(V,z.outShape,o.dtype),St=b.write(at,z.outShape,o.dtype);return[{dataId:Et,shape:z.outShape,dtype:o.dtype},{dataId:St,shape:z.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lS(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;Go(u,"sum");let g;u.dtype==="bool"?g=Rm({inputs:{x:u},backend:n,attrs:{dtype:"int32"}}):g=xg({inputs:{x:u},backend:n});const b=g.shape.length,_=Lr(h,g.shape),z=Gc(_,b);let V=_,at=g;z!=null&&(at=_v({inputs:{x:g},backend:n,attrs:{perm:z}}),V=Qc(V.length,b)),kf("sum",V,at.shape.length);const[Et,St]=uf(at.shape,V),Tt=uo(at.dtype,"int32");let Wt=sS(n,Et,Tt);const le=Rt(St),ye=n.data.get(Wt.dataId).values,Qe=n.data.get(at.dataId).values;for(let $e=0;$e<ye.length;++$e){const Xe=$e*le;let Rn=0;for(let Cn=0;Cn<le;++Cn)Rn+=Qe[Xe+Cn];ye[$e]=Rn}if(p){const $e=$c(Wt.shape,_),Xe=Wt;Wt=Lc({inputs:{x:Wt},backend:n,attrs:{shape:$e}}),n.disposeIntermediateTensorInfo(Xe)}return n.disposeIntermediateTensorInfo(g),z!=null&&n.disposeIntermediateTensorInfo(at),Wt}const h4={kernelName:an,backendName:"cpu",kernelFunc:lS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o,g=Lr(h,u.shape),_=uf(u.shape,g)[1],z=Rt(_),V=[],at=n.makeTensorInfo([],"float32",new Float32Array([z]));V.push(at);const Et=Rm({inputs:{x:u},backend:n,attrs:{dtype:"float32"}});V.push(Et);const St=KT({inputs:{a:Et,b:at},backend:n});V.push(St);const Tt=lS({inputs:{x:St},backend:n,attrs:{axis:h,keepDims:p}});return V.forEach(Wt=>n.disposeIntermediateTensorInfo(Wt)),Tt}const p4={kernelName:Gt,backendName:"cpu",kernelFunc:d4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;Go(u,"min");const g=Lr(h,u.shape);let b=g;const _=Gc(b,u.shape.length);let z=u;_!=null&&(z=_v({inputs:{x:u},backend:n,attrs:{perm:_}}),b=Qc(b.length,u.shape.length)),kf("min",b,z.shape.length);const[V,at]=uf(z.shape,b),Et=Rt(at),St=Ot(Rt(V),z.dtype),Tt=n.data.get(z.dataId).values;for(let le=0;le<St.length;++le){const ye=le*Et;let Qe=Tt[ye];for(let $e=0;$e<Et;++$e){const Xe=Tt[ye+$e];Xe<Qe&&(Qe=Xe)}St[le]=Qe}_!=null&&n.disposeIntermediateTensorInfo(z);const Wt=n.makeTensorInfo(V,z.dtype,St);if(p){const le=$c(V,g),ye=Lc({inputs:{x:Wt},backend:n,attrs:{shape:le}});return n.disposeIntermediateTensorInfo(Wt),ye}return Wt}const g4={kernelName:re,backendName:"cpu",kernelFunc:v4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nk=wf((r,t)=>Math.min(r,t)),m4=Vf(me,nk),y4={kernelName:me,backendName:"cpu",kernelFunc:m4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{paddings:h,mode:p}=o;Go(u,"mirrorPad");const g=h.map((Qe,$e)=>Qe[0]+u.shape[$e]+Qe[1]),b=h.map(Qe=>Qe[0]),_=h.map((Qe,$e)=>Qe[0]+u.shape[$e]),z=p==="reflect"?0:1,V=n.data.get(u.dataId).values,at=u.shape.length,Et=gt(u.shape),St=Rt(g),Tt=g.length,Wt=gt(g),le=sr(u.dtype,St);for(let Qe=0;Qe<St;Qe++){let $e=xt(Qe,Tt,Wt);for(let Rn=0;Rn<Tt;Rn++)$e[Rn]<b[Rn]?$e[Rn]=b[Rn]*2-$e[Rn]-z:$e[Rn]>=_[Rn]&&($e[Rn]=(_[Rn]-1)*2-$e[Rn]+z);$e=$e.map((Rn,Cn)=>Rn-b[Cn]);const Xe=X($e,at,Et);le[Qe]=V[Xe]}return{dataId:n.write(le,g,u.dtype),shape:g,dtype:u.dtype}}const x4={kernelName:bn,backendName:"cpu",kernelFunc:b4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w4=wf((r,t)=>{const n=r%t;return r<0&&t<0||r>=0&&t>=0?n:(n+t)%t}),E4=Vf(Zn,w4),S4={kernelName:Zn,backendName:"cpu",kernelFunc:E4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rk(r){const{inputs:t,backend:n,attrs:o}=r,{logits:u}=t,{dim:h}=o,p=u.shape.length;let g=h;if(g===-1&&(g=p-1),g!==p-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${p} and dim was ${g}`);const b=Lr([g],u.shape),_=tk({inputs:{x:u},backend:n,attrs:{reductionIndices:b,keepDims:!1}}),z=$c(_.shape,b),V=Lc({inputs:{x:_},backend:n,attrs:{shape:z}}),at=qT({inputs:{a:u,b:V},backend:n}),Et=WN({inputs:{x:at},backend:n}),St=lS({inputs:{x:Et},backend:n,attrs:{axis:b,keepDims:!1}}),Tt=Lc({inputs:{x:St},backend:n,attrs:{shape:z}}),Wt=KT({inputs:{a:Et,b:Tt},backend:n});return n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(V),n.disposeIntermediateTensorInfo(at),n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(St),n.disposeIntermediateTensorInfo(Tt),Wt}const C4={kernelName:rr,backendName:"cpu",kernelFunc:rk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4(r){const{inputs:t,backend:n,attrs:o}=r,{logits:u}=t,{numSamples:h,seed:p,normalized:g}=o;Go(u,"multinomial");const b=g?u:rk({inputs:{logits:u},backend:n,attrs:{dim:-1}}),_=b.shape[0],z=b.shape[1],V=n.data.get(b.dataId).values,at=[_,h],Et=Ot(Rt(at),"int32");for(let St=0;St<_;++St){const Tt=St*z,Wt=new Float32Array(z-1);Wt[0]=V[Tt];for(let Qe=1;Qe<Wt.length;++Qe)Wt[Qe]=Wt[Qe-1]+V[Tt+Qe];const le=vm.alea(p.toString()),ye=St*h;for(let Qe=0;Qe<h;++Qe){const $e=le();Et[ye+Qe]=Wt.length;for(let Xe=0;Xe<Wt.length;Xe++)if($e<Wt[Xe]){Et[ye+Qe]=Xe;break}}}return g||n.disposeIntermediateTensorInfo(b),n.makeTensorInfo(at,"int32",Et)}const I4={kernelName:Yt,backendName:"cpu",kernelFunc:_4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ak(r,t,n){const o=vf(-1,n);return XT([],t,o,r,n)}function T4(r){const{inputs:t,backend:n}=r,{x:o}=t;Go(o,"neg");const u=n.data.get(o.dataId).values,[h,p]=ak(u,o.shape,o.dtype);return n.makeTensorInfo(p,o.dtype,h)}const A4={kernelName:Ge,backendName:"cpu",kernelFunc:T4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M4=wy;function N4(r){const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:b}=o;Go(u,"NonMaxSuppression");const _=n.data.get(u.dataId).values,z=n.data.get(h.dataId).values,{selectedIndices:V}=M4(_,z,p,g,b);return n.makeTensorInfo([V.length],"int32",new Int32Array(V))}const k4={kernelName:In,backendName:"cpu",kernelFunc:N4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D4=Ey;function O4(r){const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:b,padToMaxOutputSize:_}=o;Go(u,"NonMaxSuppressionPadded");const z=n.data.get(u.dataId).values,V=n.data.get(h.dataId).values,{selectedIndices:at,validOutputs:Et}=D4(z,V,p,g,b,_);return[n.makeTensorInfo([at.length],"int32",new Int32Array(at)),n.makeTensorInfo([],"int32",new Int32Array([Et]))]}const R4={kernelName:ar,backendName:"cpu",kernelFunc:O4};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L4=Sy;function P4(r){const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:b,softNmsSigma:_}=o;Go(u,"NonMaxSuppressionWithScore");const z=n.data.get(u.dataId).values,V=n.data.get(h.dataId).values,at=p,Et=g,St=b,Tt=_,{selectedIndices:Wt,selectedScores:le}=L4(z,V,at,Et,St,Tt);return[n.makeTensorInfo([Wt.length],"int32",new Int32Array(Wt)),n.makeTensorInfo([le.length],"float32",new Float32Array(le))]}const F4={kernelName:ra,backendName:"cpu",kernelFunc:P4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ik=wf((r,t)=>r!==t?1:0),B4=Vf(Fe,ik,null,"bool"),z4={kernelName:Fe,backendName:"cpu",kernelFunc:B4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4(r){const{inputs:t,backend:n,attrs:o}=r,{indices:u}=t,{depth:h,onValue:p,offValue:g}=o;Go(u,"oneHot");const b=Rt(u.shape),_=new Float32Array(b*h);_.fill(g);const z=n.data.get(u.dataId).values;for(let V=0;V<b;++V)z[V]>=0&&z[V]<h&&(_[V*h+z[V]]=p);return n.makeTensorInfo([...u.shape,h],"int32",_)}const G4={kernelName:$a,backendName:"cpu",kernelFunc:$4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cS(r){const{inputs:t,backend:n}=r,{x:o}=t;if(o.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(o.dtype==="complex64"){const u=L0({inputs:{input:o},backend:n}),h=cS({inputs:{x:u},backend:n}),p=y1({inputs:{input:o},backend:n}),g=cS({inputs:{x:p},backend:n}),b=lp({inputs:{real:h,imag:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),b}else return JT({backend:n,attrs:{shape:o.shape,value:0,dtype:o.dtype}})}const U4={kernelName:Vu,backendName:"cpu",kernelFunc:cS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ok(r){const{inputs:t,backend:n}=r,{x:o}=t;if(o.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(o.dtype==="complex64"){const u=L0({inputs:{input:o},backend:n}),h=ok({inputs:{x:u},backend:n}),p=y1({inputs:{input:o},backend:n}),g=cS({inputs:{x:p},backend:n}),b=lp({inputs:{real:h,imag:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),b}else return JT({backend:n,attrs:{shape:o.shape,value:1,dtype:o.dtype}})}const W4={kernelName:Ta,backendName:"cpu",kernelFunc:ok};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sk(r){const{inputs:t,backend:n,attrs:o}=r,{axis:u}=o;if(t.length===1)return uS({inputs:{input:t[0]},backend:n,attrs:{dim:u}});const h=t[0].shape,p=t[0].dtype;t.forEach(z=>{Me(h,z.shape,"All tensors passed to stack must have matching shapes"),bt(p===z.dtype,()=>"All tensors passed to stack must have matching dtypes")});const g=[],b=t.map(z=>{const V=uS({inputs:{input:z},backend:n,attrs:{dim:u}});return g.push(V),V}),_=b1({inputs:b,backend:n,attrs:{axis:u}});return g.forEach(z=>n.disposeIntermediateTensorInfo(z)),_}const V4={kernelName:ja,backendName:"cpu",kernelFunc:sk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{paddings:h,constantValue:p}=o;Go(u,"pad");const g=h.map((ye,Qe)=>ye[0]+u.shape[Qe]+ye[1]),b=h.map(ye=>ye[0]),_=n.data.get(u.dataId).values,z=Rt(u.shape),V=u.shape.length,at=gt(u.shape),Et=Rt(g),St=g.length,Tt=gt(g),Wt=sr(u.dtype,Et);p!==0&&Wt.fill(p);for(let ye=0;ye<z;ye++){const $e=xt(ye,V,at).map((Rn,Cn)=>Rn+b[Cn]),Xe=X($e,St,Tt);Wt[Xe]=_[ye]}return{dataId:n.write(Wt,g,u.dtype),shape:g,dtype:u.dtype}}const uk={kernelName:Oa,backendName:"cpu",kernelFunc:j4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H4=wf((r,t)=>Math.pow(r,t)),X4=Vf(Ai,H4),Y4={kernelName:Ai,backendName:"cpu",kernelFunc:X4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lk(r,t,n,o){const[u,h]=uf(r,o),p=uo(t,"int32"),g=Ot(Rt(u),p),b=Rt(h);for(let _=0;_<g.length;++_){const z=_*b;let V=1;for(let at=0;at<b;++at)V*=n[z+at];g[_]=V}return{outVals:g,outShape:u,outDtype:p}}function K4(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;Go(u,"prod");const g=u.shape.length,b=Lr(h,u.shape),_=Gc(b,g);let z=b,V=u;const at=[];_!=null&&(V=_v({inputs:{x:u},backend:n,attrs:{perm:_}}),at.push(V),z=Qc(z.length,g));const Et=n.data.get(V.dataId).values,{outVals:St,outShape:Tt,outDtype:Wt}=lk(V.shape,V.dtype,Et,z);let le=Tt;return p&&(le=$c(Tt,b)),at.forEach(ye=>n.disposeIntermediateTensorInfo(ye)),n.makeTensorInfo(le,Wt,St)}const Z4={kernelName:hs,backendName:"cpu",kernelFunc:K4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ck(r,t,n,o){const u=r===t,h=r<t&&n<0,p=t<r&&n>1;if(u||h||p)return Ot(0,o);const g=Math.abs(Math.ceil((t-r)/n)),b=Ot(g,o);t<r&&n===1&&(n=-1),b[0]=r;for(let _=1;_<b.length;_++)b[_]=b[_-1]+n;return b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q4(r){const{backend:t,attrs:n}=r,{start:o,stop:u,dtype:h,step:p}=n,g=ck(o,u,p,h);return t.makeTensorInfo([g.length],h,g)}const Q4={kernelName:wo,backendName:"cpu",kernelFunc:q4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J4=Hl(Ro,r=>1/r),tz={kernelName:Ro,backendName:"cpu",kernelFunc:J4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ez(r){const{inputs:t,backend:n,attrs:o}=r,{images:u}=t,{alignCorners:h,halfPixelCenters:p,size:g}=o;Go(u,"resizeBilinear");const b=gt(u.shape),[_,z]=g,[V,at,Et,St]=u.shape,Tt=n.data.get(u.dataId).values,Wt=new Float32Array(Rt([V,_,z,St])),le=[h&&_>1?at-1:at,h&&z>1?Et-1:Et],ye=[h&&_>1?_-1:_,h&&z>1?z-1:z];let Qe=0;const $e=le[0]/ye[0],Xe=le[1]/ye[1];for(let Rn=0;Rn<V;Rn++)for(let Cn=0;Cn<_;Cn++){let mr;p?mr=$e*(Cn+.5)-.5:mr=$e*Cn;const zr=Math.max(0,Math.floor(mr)),ta=mr-zr,Ma=Math.min(at-1,Math.ceil(mr)),Za=Rn*b[0]+zr*b[1],Ka=Rn*b[0]+Ma*b[1];for(let ni=0;ni<z;ni++){let Ua;p?Ua=Xe*(ni+.5)-.5:Ua=Xe*ni;const Ba=Math.max(0,Math.floor(Ua)),mi=Ua-Ba,ti=Math.min(Et-1,Math.ceil(Ua)),yi=Za+Ba*b[2],$i=Ka+Ba*b[2],Gi=Za+ti*b[2],Ji=Ka+ti*b[2];for(let ro=0;ro<St;ro++){const io=Tt[yi+ro],bo=Tt[$i+ro],co=Tt[Gi+ro],Ko=Tt[Ji+ro],gs=io+(co-io)*mi,Es=bo+(Ko-bo)*mi,iu=gs+(Es-gs)*ta;Wt[Qe++]=iu}}}return n.makeTensorInfo([V,_,z,St],"float32",Wt)}const nz={kernelName:su,backendName:"cpu",kernelFunc:ez};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(r){const{inputs:t,backend:n,attrs:o}=r,{images:u,dy:h}=t,{alignCorners:p}=o;Go([h,u],"resizeBilinearGrad");const g=gt(u.shape),[b,_,z,V]=u.shape,[,at,Et]=h.shape,St=new Float32Array(b*_*z*V),Tt=[p&&at>1?_-1:_,p&&Et>1?z-1:z],Wt=[p&&at>1?at-1:at,p&&Et>1?Et-1:Et],le=Tt[0]/Wt[0],ye=Tt[1]/Wt[1],Qe=n.data.get(h.dataId).values;let $e=0;for(let Xe=0;Xe<b;Xe++){const Rn=Xe*g[0];for(let Cn=0;Cn<at;Cn++){const mr=Cn*le,zr=Math.floor(mr),ta=Math.min(Math.ceil(mr),_-1),Ma=Rn+zr*g[1],Za=Rn+ta*g[1],Ka=mr-zr,ni=1-Ka;for(let Ua=0;Ua<Et;Ua++){const Ba=Ua*ye,mi=Math.floor(Ba),ti=Math.min(Math.ceil(Ba),z-1),yi=Ba-mi,$i=1-yi,Gi=Ma+mi*g[2],Ji=Ma+ti*g[2],ro=Za+mi*g[2],io=Za+ti*g[2],bo=ni*$i,co=ni*yi,Ko=Ka*$i,gs=Ka*yi;for(let Es=0;Es<V;Es++){const iu=Qe[$e++];St[Gi+Es]+=iu*bo,St[Ji+Es]+=iu*co,St[ro+Es]+=iu*Ko,St[io+Es]+=iu*gs}}}}return n.makeTensorInfo([b,z,_,V],"float32",St)}const az={kernelName:xl,backendName:"cpu",kernelFunc:rz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iz(r){const{inputs:t,backend:n,attrs:o}=r,{images:u}=t,{alignCorners:h,halfPixelCenters:p,size:g}=o;Go(u,"resizeNearestNeighbor");const b=gt(u.shape),[_,z]=g,[V,at,Et,St]=u.shape,Tt=n.data.get(u.dataId).values,Wt=new Float32Array(V*_*z*St),le=[h&&_>1?at-1:at,h&&z>1?Et-1:Et],ye=[h&&_>1?_-1:_,h&&z>1?z-1:z],Qe=le[0]/ye[0],$e=le[1]/ye[1];let Xe=0;for(let Rn=0;Rn<V;Rn++){const Cn=Rn*b[0];for(let mr=0;mr<_;mr++){const zr=p?Qe*(mr+.5):Qe*mr;let ta=Math.min(at-1,h?Math.round(zr):Math.floor(zr));p&&(ta=Math.max(0,ta));const Ma=Cn+ta*b[1];for(let Za=0;Za<z;Za++){const Ka=p?$e*(Za+.5):$e*Za;let ni=Math.min(Et-1,h?Math.round(Ka):Math.floor(Ka));p&&(ni=Math.max(0,ni));const Ua=Ma+ni*b[2];for(let Ba=0;Ba<St;Ba++){const mi=Tt[Ua+Ba];Wt[Xe++]=mi}}}}return n.makeTensorInfo([V,_,z,St],u.dtype,Wt)}const oz={kernelName:As,backendName:"cpu",kernelFunc:iz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sz(r){const{inputs:t,backend:n,attrs:o}=r,{images:u,dy:h}=t,{alignCorners:p}=o;Go([h,u],"resizeNearestNeighborGrad");const g=gt(u.shape),b=gt(h.shape),[_,z,V,at]=u.shape,[,Et,St]=h.shape,Tt=new Float32Array(_*z*V*at),Wt=n.data.get(h.dataId).values,le=[p&&Et>1?z-1:z,p&&St>1?V-1:V],ye=[p&&Et>1?Et-1:Et,p&&St>1?St-1:St],Qe=le[0]/ye[0],$e=le[1]/ye[1],Xe=1/Qe,Rn=1/$e,Cn=Math.ceil(Xe)*2+2,mr=Math.ceil(Rn)*2+2;for(let zr=0;zr<_;zr++){const ta=zr*g[0];for(let Ma=0;Ma<z;Ma++){const Za=ta+Ma*g[1],Ka=Math.floor(Ma*Xe),ni=Math.floor(Ka-Cn/2);for(let Ua=0;Ua<V;Ua++){const Ba=Za+Ua*g[2],mi=Math.floor(Ua*Rn),ti=Math.floor(mi-mr/2);for(let yi=0;yi<at;yi++){let $i=0;for(let Gi=0;Gi<Cn;Gi++){const Ji=Gi+ni;if(Ji<0||Ji>=Et)continue;const ro=ta+Ji*b[1],io=Ji*Qe,bo=Math.min(z-1,p?Math.round(io):Math.floor(io));if(Ma===bo)for(let co=0;co<mr;co++){const Ko=co+ti;if(Ko<0||Ko>=St)continue;const gs=ro+Ko*b[2],Es=Ko*$e,iu=Math.min(V-1,p?Math.round(Es):Math.floor(Es));Ua===iu&&($i+=Wt[gs+yi])}}Tt[Ba+yi]=$i}}}}return n.makeTensorInfo(u.shape,u.dtype,Tt)}const uz={kernelName:Vs,backendName:"cpu",kernelFunc:sz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lz(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{dims:h}=o;Go(u,"reverse");const p=u.shape.length,g=Lr(h,u.shape);if(p===0)return xg({inputs:{x:u},backend:n});const b=new ae(u.shape,u.dtype),_=n.bufferSync(u);for(let z=0;z<b.size;z++){const V=b.indexToLoc(z),at=V.slice();g.forEach(Et=>at[Et]=u.shape[Et]-1-at[Et]),b.set(_.get(...at),...V)}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const cz={kernelName:Ll,backendName:"cpu",kernelFunc:lz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fz={kernelName:tl,backendName:"cpu",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{image:o}=r,{radians:u,fillValue:h,center:p}=t,g=n,b=sr(o.dtype,Rt(o.shape)),[_,z,V,at]=o.shape,[Et,St]=m0(p,z,V),Tt=255,Wt=Math.sin(u),le=Math.cos(u),ye=g.data.get(o.dataId).values;for(let $e=0;$e<_;$e++){const Xe=$e*V*z*at;for(let Rn=0;Rn<z;Rn++){const Cn=Rn*(V*at);for(let mr=0;mr<V;mr++){const zr=mr*at;for(let ta=0;ta<at;ta++){const Ma=[_,Rn,mr,ta],Za=Ma[2],Ka=Ma[1];let ni=(Za-Et)*le-(Ka-St)*Wt,Ua=(Za-Et)*Wt+(Ka-St)*le;ni=Math.round(ni+Et),Ua=Math.round(Ua+St);let Ba=h;if(typeof h!="number"&&(ta===3?Ba=Tt:Ba=h[ta]),ni>=0&&ni<V&&Ua>=0&&Ua<z){const ti=Ua*(V*at),yi=ni*at,$i=Xe+ti+yi+ta;Ba=ye[$i]}const mi=Xe+Cn+zr+ta;b[mi]=Ba}}}}return{dataId:g.write(b,o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hz=Hl(nl,r=>{const t=Math.floor(r);return r-t<.5?Math.floor(r):r-t>.5?Math.ceil(r):t%2==0?t:t+1}),dz={kernelName:nl,backendName:"cpu",kernelFunc:hz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fk=m1(r=>1/Math.sqrt(r)),pz=g1(rl,fk),vz={kernelName:rl,backendName:"cpu",kernelFunc:pz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hk(r,t,n,o,u,h,p,g,b,_){const z=[o/u,u],V=r.values,at=t.values;if(o===0)return zs(n,t.dtype);const Et=zs(z,t.dtype);Et.values.fill(b);for(let St=0;St<h;St++){const Tt=[];let Wt=0;for(let le=0;le<p;le++){const ye=V[St*p+le];Tt.push(ye),Wt+=ye*g[le]}if(Wt<0||Wt>=o/u)throw new Error(`Invalid indices: ${Tt} does not index into ${n}`);for(let le=0;le<u;le++)_?Et.values[Wt*u+le]+=at[St*u+le]:Et.values[Wt*u+le]=t.rank===0?at[0]:at[St*u+le]}return Et}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gz(r){const{inputs:t,backend:n,attrs:o}=r,{indices:u,updates:h}=t,{shape:p}=o,{sliceRank:g,numUpdates:b,sliceSize:_,strides:z,outputSize:V}=Gl(h,u,p),at=!0,Et=n.bufferSync(u),St=n.bufferSync(h),Tt=hk(Et,St,p,V,_,b,g,z,0,at);return n.makeTensorInfo(p,Tt.dtype,Tt.values)}const mz={kernelName:Ef,backendName:"cpu",kernelFunc:gz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yz(r){const{inputs:t,backend:n}=r,{condition:o,t:u,e:h}=t;Go([o,u,h],"select");const p=o.shape.length,g=n.data.get(o.dataId).values,b=n.data.get(u.dataId).values,_=n.data.get(h.dataId).values,z=uo(u.dtype,h.dtype),V=Ot(Rt(u.shape),z);let at=0;const Et=p===0||p>1||u.shape.length===1?1:Rt(u.shape.slice(1));for(let St=0;St<g.length;St++)for(let Tt=0;Tt<Et;Tt++)g[St]===1?V[at++]=b[St]:V[at++]=_[St];return n.makeTensorInfo(u.shape,z,V)}const bz={kernelName:Sf,backendName:"cpu",kernelFunc:yz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xz=My,wz=Ny,Ez=Hl(Yl,r=>r>=0?wz*r:xz*(Math.exp(r)-1)),Sz={kernelName:Yl,backendName:"cpu",kernelFunc:Ez};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cz=Hl(pe,r=>1/(1+Math.exp(-r))),_z={kernelName:pe,backendName:"cpu",kernelFunc:Cz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iz=Hl(Kt,r=>r<0?-1:r>0?1:0),Tz={kernelName:Kt,backendName:"cpu",kernelFunc:Iz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Az=Hl(T,r=>Math.sin(r)),Mz={kernelName:T,backendName:"cpu",kernelFunc:Az};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nz=Hl(rt,r=>Math.sinh(r)),kz={kernelName:rt,backendName:"cpu",kernelFunc:Nz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dk=Math.log(11920928955078125e-23)+2,Dz=Hl(Re,r=>{const t=r>-dk,n=r<dk,o=Math.exp(r);let u;return n?u=o:t?u=r:u=Math.log(1+o),u}),Oz={kernelName:Re,backendName:"cpu",kernelFunc:Dz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rz(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockShape:h,paddings:p}=o;Go([u],"spaceToBatchND");const g=Rt(h),b=[[0,0]];b.push(...p);for(let Rn=1+h.length;Rn<u.shape.length;++Rn)b.push([0,0]);const _=uk.kernelFunc({inputs:{x:u},backend:n,attrs:{paddings:b,constantValue:0}}),z=Kd(_.shape,h,g,!1),V=od(z.length,h.length,!1),at=y0(_.shape,h,g,!1),Tt=Lc({inputs:{x:_},backend:n,attrs:{shape:z}}),ye=_v({inputs:{x:Tt},backend:n,attrs:{perm:V}}),Xe=Lc({inputs:{x:ye},backend:n,attrs:{shape:at}});return n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(Tt),n.disposeIntermediateTensorInfo(ye),Xe}const Lz={kernelName:wn,backendName:"cpu",kernelFunc:Rz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pz(r){const{inputs:t,backend:n,attrs:o}=r,{sparseIndices:u,sparseValues:h,defaultValue:p}=t,{outputShape:g}=o,{sliceRank:b,numUpdates:_,sliceSize:z,strides:V,outputSize:at}=Gl(h,u,g),Et=!1,St=n.bufferSync(u),Tt=n.bufferSync(h),Wt=n.data.get(p.dataId).values[0],le=hk(St,Tt,g,at,z,_,b,V,Wt,Et);return n.makeTensorInfo(g,le.dtype,le.values)}const Fz={kernelName:_r,backendName:"cpu",kernelFunc:Pz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bz(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{numOrSizeSplits:h,axis:p}=o,g=Lr(p,u.shape)[0],b=Dy(u,h,g),_=new Array(u.shape.length).fill(0),z=u.shape.slice();return b.map(V=>{const at=[...z];at[g]=V;const Et=P0({inputs:{x:u},backend:n,attrs:{begin:_,size:at}});return _[g]+=V,Et})}const zz={kernelName:Mn,backendName:"cpu",kernelFunc:Bz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $z=Hl(Je,r=>Math.sqrt(r)),Gz={kernelName:Je,backendName:"cpu",kernelFunc:$z};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uz={kernelName:ca,backendName:"cpu",kernelFunc:({inputs:r,backend:t})=>{const{x:n}=r,o=t;Go(n,"square");const u=o.data.get(n.dataId).values,h=new Float32Array(u.length);for(let g=0;g<u.length;++g){const b=u[g];h[g]=b*b}return{dataId:o.write(h,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pk=wf((r,t)=>{const n=r-t;return n*n}),Wz=Vf(We,pk),Vz={kernelName:We,backendName:"cpu",kernelFunc:Wz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jz=Hl(Bu,(r,t)=>{const n=t;return isNaN(r)?NaN:r>0?1:n.alpha}),Hz={kernelName:Bu,backendName:"cpu",kernelFunc:jz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vk(r,t,n,o){const u=zs(r,t.dtype);for(let h=0;h<u.size;h++){const p=u.indexToLoc(h),g=new Array(p.length);for(let b=0;b<g.length;b++)g[b]=p[b]*n[b]+o[b];u.set(t.get(...g),...p)}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{begin:h,end:p,strides:g,beginMask:b,endMask:_,ellipsisMask:z,newAxisMask:V,shrinkAxisMask:at}=o;Go(u,"stridedSlice");const{nonStrided:Et,$begin:St,$strides:Tt,size:Wt,newShape:le,outShape:ye}=Ip(u.shape,h,p,g,b,_,z,V,at),Qe=Lc({inputs:{x:u},backend:n,attrs:{shape:le}});let $e;if(Et){const Rn=P0({inputs:{x:Qe},backend:n,attrs:{begin:St,size:Wt}});$e=Lc({inputs:{x:Rn},backend:n,attrs:{shape:ye}}),n.disposeIntermediateTensorInfo(Rn)}else if(ye.some(Rn=>Rn===0))$e=n.makeTensorInfo(ye,u.dtype,[]);else{const Rn=n.bufferSync(Qe),Cn=vk(ye,Rn,Tt,St);$e=n.makeTensorInfo(Cn.shape,Cn.dtype,Cn.values)}const Xe=Lc({inputs:{x:$e},backend:n,attrs:{shape:ye}});return n.disposeIntermediateTensorInfo(Qe),n.disposeIntermediateTensorInfo($e),Xe}const Yz={kernelName:Va,backendName:"cpu",kernelFunc:Xz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kz=Hl(qa,r=>Math.tan(r)),Zz={kernelName:qa,backendName:"cpu",kernelFunc:Kz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qz=Hl(ma,r=>Math.tanh(r)),Qz={kernelName:ma,backendName:"cpu",kernelFunc:qz};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gk(r,t){const n=new Array(r.rank);for(let u=0;u<n.length;u++)n[u]=r.shape[u]*t[u];const o=zs(n,r.dtype);for(let u=0;u<o.values.length;++u){const h=o.indexToLoc(u),p=new Array(r.rank);for(let b=0;b<p.length;b++)p[b]=h[b]%r.shape[b];const g=r.locToIndex(p);o.values[u]=r.values[g]}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jz(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{reps:h}=o;Go(u,"tile");const p=gk(n.bufferSync(u),h);return n.makeTensorInfo(p.shape,p.dtype,p.values)}const t$={kernelName:Mi,backendName:"cpu",kernelFunc:Jz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mk(r,t,n,o,u){const h=t[t.length-1],[p,g]=[r.length/h,h],b=sr(n,p*o),_=sr("int32",p*o);for(let V=0;V<p;V++){const at=V*g,Et=r.subarray(at,at+g),St=[];for(let ye=0;ye<Et.length;ye++)St.push({value:Et[ye],index:ye});St.sort((ye,Qe)=>Qe.value-ye.value);const Tt=V*o,Wt=b.subarray(Tt,Tt+o),le=_.subarray(Tt,Tt+o);for(let ye=0;ye<o;ye++)Wt[ye]=St[ye].value,le[ye]=St[ye].index}const z=t.slice();return z[z.length-1]=o,[zs(z,n,b),zs(z,"int32",_)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e$(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{k:h,sorted:p}=o;Go(u,"topk");const g=n.data.get(u.dataId).values,[b,_]=mk(g,u.shape,u.dtype,h,p);return[n.makeTensorInfo(b.shape,b.dtype,b.values),n.makeTensorInfo(_.shape,_.dtype,_.values)]}const n$={kernelName:zo,backendName:"cpu",kernelFunc:e$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yk(r,t,n,o){const u=Lr(t,n)[0],h=[1,n[0],1];for(let St=0;St<u;St++)h[0]*=n[St];h[1]=n[u];for(let St=u+1;St<n.length;St++)h[2]*=n[St];const p={},g=new Int32Array(n[u]),b=new ae(h,o,r),_=[],z=h[0]===1&&h[2]===1;for(let St=0;St<n[u];St++){let Tt;if(z)Tt=r[St].toString();else{const Wt=[];for(let le=0;le<h[0];le++)for(let ye=0;ye<h[2];ye++)Wt.push(b.get(le,St,ye));Tt=Wt.join(",")}if(p[Tt]!==void 0)g[St]=p[Tt];else{const Wt=Object.keys(p).length;p[Tt]=Wt,g[St]=Wt,_.push(St)}}const V=h.slice();V[1]=Object.keys(p).length;const at=new ae(V,o);_.forEach((St,Tt)=>{for(let Wt=0;Wt<h[0];Wt++)for(let le=0;le<h[2];le++)at.set(b.get(Wt,St,le),Wt,Tt,le)});const Et=n.slice();return Et[u]=V[1],{outputValues:at.values,outputShape:Et,indices:g}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r$(r){const{inputs:t,attrs:n,backend:o}=r,{axis:u}=n,{x:h}=t;Go(h,"unique");const p=o.data.get(h.dataId).values,{outputValues:g,outputShape:b,indices:_}=yk(p,u,h.shape,h.dtype);return[o.makeTensorInfo(b,h.dtype,g),o.makeTensorInfo([_.length],"int32",_)]}const a$={kernelName:Lo,backendName:"cpu",kernelFunc:r$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i$(r){const{inputs:t,backend:n,attrs:o}=r,{value:u}=t;let{axis:h}=o;h<0&&(h+=u.shape.length);const p=u.shape.length,g=u.shape[h],b=new Array(p-1);let _=0;for(let Et=0;Et<p;Et++)Et!==h&&(b[_++]=u.shape[Et]);const z=new Array(p).fill(0),V=u.shape.slice();V[h]=1;const at=new Array(g);for(let Et=0;Et<at.length;Et++){z[h]=Et;const St=P0({inputs:{x:u},backend:n,attrs:{begin:z,size:V}});at[Et]=Lc({inputs:{x:St},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(St)}return at}const o$={kernelName:yo,backendName:"cpu",kernelFunc:i$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,segmentIds:h}=t,{numSegments:p}=o;Go(u,"unsortedSegmentSum");const g=u.shape.length,b=h.shape.length,_=[],z=[],V=g-b;let at=h;for(let St=0;St<V;++St){const Tt=uS({inputs:{input:at},backend:n,attrs:{dim:St+1}});at=Tt,z.push(Tt)}for(let St=0;St<p;++St){const Tt=vf(St,"int32"),Wt=n.makeTensorInfo([],"int32",Tt),le=GN({inputs:{a:Wt,b:at},backend:n}),ye=Rm({inputs:{x:le},backend:n,attrs:{dtype:"float32"}}),Qe=YT({inputs:{a:ye,b:u},backend:n}),$e=lS({inputs:{x:Qe},backend:n,attrs:{axis:0,keepDims:!1}});_.push($e),z.push(Wt),z.push(le),z.push(ye),z.push(Qe),z.push($e)}const Et=sk({inputs:_,backend:n,attrs:{axis:0}});return z.forEach(St=>n.disposeIntermediateTensorInfo(St)),Et}const u$={kernelName:No,backendName:"cpu",kernelFunc:s$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l$=[JP,t3,n3,a3,KP,o3,l3,f3,d3,v3,m3,b3,w3,C3,I3,M3,k3,O3,L3,qP,F3,$3,U3,XP,V3,H3,jP,X3,K3,Q3,tF,Z3,aF,oF,nF,uF,cF,hF,pF,gF,yF,bF,wF,SF,_F,IF,AF,TF,ZT,BP,NF,DF,$F,GF,UF,VF,tB,eB,rB,iB,uB,cB,hB,pB,gB,yB,wB,zP,SB,Y3,_B,TB,MB,$P,kB,RB,PB,BB,$B,WB,jB,YB,ZB,QB,e4,r4,i4,s4,l4,f4,JB,p4,g4,y4,x4,S4,I4,HF,A4,k4,R4,F4,z4,G4,W4,V4,uk,Y4,UP,Z4,Q4,HP,tz,WP,VP,ZP,nz,az,oz,uz,cz,fz,dz,vz,mz,bz,Sz,_z,Tz,Mz,kz,B3,C4,Oz,Lz,Fz,zz,Gz,Uz,Vz,Hz,Yz,KF,h4,Zz,Qz,t$,n$,s3,a$,o$,u$,U4];for(const r of l$)wl(r);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lm={},tA={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function kj(r){delete Lm[r]}function c$(r,t){Lm[r]=t}function wg(r){if(!(r in Lm)){const n=h$(r);if(n!==null)Lm[r]=n;else return console.log("Could not get context for WebGL version",r),null}const t=Lm[r];return t.isContextLost()?(delete Lm[r],wg(r)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Lm[r])}function f$(r){if(typeof OffscreenCanvas!="undefined"&&r===2)return new OffscreenCanvas(300,150);if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function h$(r){if(r!==1&&r!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=f$(r);return t.addEventListener("webglcontextlost",n=>{n.preventDefault(),delete Lm[r]},!1),r===1?t.getContext("webgl",tA)||t.getContext("experimental-webgl",tA):t.getContext("webgl2",tA)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Sx;(function(r){r[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH"})(Sx||(Sx={}));var Up;(function(r){r[r.RENDER=0]="RENDER",r[r.UPLOAD=1]="UPLOAD",r[r.PIXELS=2]="PIXELS",r[r.DOWNLOAD=3]="DOWNLOAD"})(Up||(Up={}));var lh;(function(r){r[r.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",r[r.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",r[r.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",r[r.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",r[r.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(lh||(lh={}));function Cx(r,t){return[t,r]}function d$(r,t){return r*t}function Dj(r,t){return[t*4,r]}function _x(r){const t=Rt(r),n=Math.ceil(t/4);return Ur(n)}function Oj(r,t){if(r%t!=0)throw new Error(`unpackedSize (${r}) must be a multiple of ${t}`);return r/t}function Rj(r,t,n){const o=r.length*n/4;if(t.length<o)throw new Error(`matrix length (${t.length}) must be >= ${o}`);let u=0;for(let h=0;h<r.length;h+=4)for(let p=0;p<n;p++)t[u++]=r[h+p]}function x1(r,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(r/2))]}function p$(r,t){const[n,o]=x1(r,t);return n*o*4}function eA(r,t){const n=r;let o,u,h,p,g,b,_,z,V,at;return He().getNumber("WEBGL_VERSION")===2?(o=n.R32F,u=n.R16F,h=n.RGBA16F,p=n.RGBA32F,g=n.RED,_=4,z=1,V=n.HALF_FLOAT,at=n.FLOAT):(o=r.RGBA,u=r.RGBA,h=r.RGBA,p=n.RGBA,g=r.RGBA,_=4,z=4,V=t!=null?t.HALF_FLOAT_OES:null,at=r.FLOAT),b=r.RGBA,{internalFormatFloat:o,internalFormatHalfFloat:u,internalFormatPackedHalfFloat:h,internalFormatPackedFloat:p,textureFormatFloat:g,downloadTextureFormat:b,downloadUnpackNumChannels:_,defaultNumChannels:z,textureTypeHalfFloat:V,textureTypeFloat:at}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uo(r,t){const n=t();return He().getBool("DEBUG")&&v$(r),n}function v$(r){const t=r.getError();if(t!==r.NO_ERROR)throw new Error("WebGL Error: "+b$(r,t))}const g$=596e-10,m$=65504;function y$(r){return!!(He().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||r===0||g$<Math.abs(r)&&Math.abs(r)<m$)}function b$(r,t){switch(t){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function fS(r,t){return nm(r,()=>r.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function x$(r,t){const n=nm(r,()=>r.createShader(r.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Uo(r,()=>r.shaderSource(n,t)),Uo(r,()=>r.compileShader(n)),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw console.log(r.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function w$(r,t){const n=nm(r,()=>r.createShader(r.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Uo(r,()=>r.shaderSource(n,t)),Uo(r,()=>r.compileShader(n)),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw S$(t,r.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const E$=/ERROR: [0-9]+:([0-9]+):/g;function S$(r,t){const n=E$.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(r);return}const o=+n[1],u=r.split(`
`),h=u.length.toString().length+2,p=u.map((V,at)=>Ea((at+1).toString(),h)+V);let g=0;for(let V=0;V<p.length;V++)g=Math.max(p[V].length,g);const b=p.slice(0,o-1),_=p.slice(o-1,o),z=p.slice(o);console.log(b.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${Ea(_[0],g)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(z.join(`
`))}function C$(r){return nm(r,()=>r.createProgram(),"Unable to create WebGLProgram.")}function _$(r,t){if(Uo(r,()=>r.linkProgram(t)),r.getProgramParameter(t,r.LINK_STATUS)===!1)throw console.log(r.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function nA(r,t){if(Uo(r,()=>r.validateProgram(t)),r.getProgramParameter(t,r.VALIDATE_STATUS)===!1)throw console.log(r.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function I$(r,t){const n=nm(r,()=>r.createBuffer(),"Unable to create WebGLBuffer");return Uo(r,()=>r.bindBuffer(r.ARRAY_BUFFER,n)),Uo(r,()=>r.bufferData(r.ARRAY_BUFFER,t,r.STATIC_DRAW)),n}function T$(r,t){const n=nm(r,()=>r.createBuffer(),"Unable to create WebGLBuffer");return Uo(r,()=>r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n)),Uo(r,()=>r.bufferData(r.ELEMENT_ARRAY_BUFFER,t,r.STATIC_DRAW)),n}function Lj(){return env().getNumber("WEBGL_VERSION")===2?1:4}function A$(r){return nm(r,()=>r.createTexture(),"Unable to create WebGLTexture.")}function M$(r,t){const n=He().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(r<=0||t<=0){const o=`[${r}x${t}]`;throw new Error("Requested texture size "+o+" is invalid.")}if(r>n||t>n){const o=`[${r}x${t}]`,u=`[${n}x${n}]`;throw new Error("Requested texture size "+o+" greater than WebGL maximum on this browser / GPU "+u+".")}}function N$(r){return nm(r,()=>r.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function bk(r,t,n,o,u,h,p){const g=r.getAttribLocation(t,n);return g===-1?!1:(Uo(r,()=>r.bindBuffer(r.ARRAY_BUFFER,o)),Uo(r,()=>r.vertexAttribPointer(g,u,r.FLOAT,!1,h,p)),Uo(r,()=>r.enableVertexAttribArray(g)),!0)}function k$(r,t,n){wk(r,n),Uo(r,()=>r.activeTexture(r.TEXTURE0+n)),Uo(r,()=>r.bindTexture(r.TEXTURE_2D,t))}function Pj(r,t){wk(r,t),Uo(r,()=>r.activeTexture(r.TEXTURE0+t)),Uo(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function D$(r,t,n){return nm(r,()=>r.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function O$(r,t,n){return r.getUniformLocation(t,n)}function R$(r,t,n,o){Uo(r,()=>k$(r,t,o)),Uo(r,()=>r.uniform1i(n,o))}function Fj(r){Uo(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,null)),Uo(r,()=>r.viewport(0,0,r.canvas.width,r.canvas.height)),Uo(r,()=>r.scissor(0,0,r.canvas.width,r.canvas.height))}function rA(r,t,n){Uo(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,n)),Uo(r,()=>r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0))}function xk(r,t){Uo(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,t)),Uo(r,()=>r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0))}function hS(r){const t=r.checkFramebufferStatus(r.FRAMEBUFFER);if(t!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+L$(r,t))}function L$(r,t){switch(t){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function nm(r,t,n){const o=Uo(r,()=>t());if(o==null)throw new Error(n);return o}function wk(r,t){const n=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,o=t+r.TEXTURE0;if(o<r.TEXTURE0||o>n){const u=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${u}.`)}}function w1(r,t=2){return Rt(r.slice(0,r.length-t))}function E1(r){if(r.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[r.length>1?r[r.length-2]:1,r[r.length-1]]}function aA(r){let t=[1,1,1];return r.length===0||r.length===1&&r[0]===1||(t=[w1(r),...E1(r)]),t}function P$(r,t=!1){let n=He().getNumber("WEBGL_MAX_TEXTURE_SIZE");t&&(n=n*2,r=r.map((u,h)=>h>=r.length-2?ke(r[h]):r[h]),r.length===1&&(r=[2,r[0]])),r.length!==2&&(r=_n(r).newShape);let o=Rt(r);if(r.length<=1&&o<=n)return[1,o];if(r.length===2&&r[0]<=n&&r[1]<=n)return r;if(r.length===3&&r[0]*r[1]<=n&&r[2]<=n)return[r[0]*r[1],r[2]];if(r.length===3&&r[0]<=n&&r[1]*r[2]<=n)return[r[0],r[1]*r[2]];if(r.length===4&&r[0]*r[1]*r[2]<=n&&r[3]<=n)return[r[0]*r[1]*r[2],r[3]];if(r.length===4&&r[0]<=n&&r[1]*r[2]*r[3]<=n)return[r[0],r[1]*r[2]*r[3]];if(t){const u=w1(r);let h=2,p=2;return r.length&&([h,p]=E1(r)),o=u*(h/2)*(p/2),Ur(o).map(g=>g*2)}return Ur(o)}function dS(r){return r%2==0}function pS(r,t){if(r=r.slice(-2),t=t.slice(-2),Bn(r,t)||!r.length||!t.length||r[0]===0||r[1]===0||t[0]===0||t[1]===0)return!0;if(r.length!==t.length){const n=r.slice(-1)[0],o=t.slice(-1)[0];if(n===o||dS(n)&&dS(o)&&(r[0]===1||t[0]===1))return!0}return r[1]===t[1]&&dS(r[0])&&dS(t[0])}let vS,gS;function F$(r){if(vS==null){const t=wg(r);vS=t.getParameter(t.MAX_TEXTURE_SIZE)}return vS}function Bj(){vS=null}function zj(){gS=null}function B$(r){if(gS==null){const t=wg(r);gS=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,gS)}function z$(r){if(r===0)return 0;let t;const n=wg(r);return Iv(n,"EXT_disjoint_timer_query_webgl2")&&r===2?t=2:Iv(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function Iv(r,t){return r.getExtension(t)!=null}function Ek(r){try{if(wg(r)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function $$(r){if(r===0)return!1;const t=wg(r);if(r===1){if(!Iv(t,"OES_texture_float"))return!1}else if(!Iv(t,"EXT_color_buffer_float"))return!1;return iA(t)}function G$(r){if(r===0)return!1;const t=wg(r);if(r===1){if(!Iv(t,"OES_texture_float")||!Iv(t,"WEBGL_color_buffer_float"))return!1}else{if(Iv(t,"EXT_color_buffer_float"))return iA(t);const o="EXT_color_buffer_half_float";if(Iv(t,o)){const u=t.getExtension(o);return U$(t,u)}return!1}return iA(t)}function iA(r){const t=eA(r),n=r.createTexture();r.bindTexture(r.TEXTURE_2D,n);const o=1,u=1;r.texImage2D(r.TEXTURE_2D,0,t.internalFormatFloat,o,u,0,t.textureFormatFloat,t.textureTypeFloat,null);const h=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,h),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0);const p=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(n),r.deleteFramebuffer(h),p}function U$(r,t){const n=eA(r,t),o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o);const u=1,h=1;r.texImage2D(r.TEXTURE_2D,0,n.internalFormatHalfFloat,u,h,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const p=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,p),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0);const g=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(o),r.deleteFramebuffer(p),g}function W$(r){return r!==2?!1:wg(r).fenceSync!=null}function Ix(r,t){Array.isArray(r)||(r=[r]),r.forEach(n=>{n!=null&&bt(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gs=He();Gs.registerFlag("HAS_WEBGL",()=>Gs.getNumber("WEBGL_VERSION")>0),Gs.registerFlag("WEBGL_VERSION",()=>Ek(2)?2:Ek(1)?1:0),Gs.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),Gs.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Gs.get("WEBGL_VERSION")===2),Gs.registerFlag("WEBGL_CPU_FORWARD",()=>!0),Gs.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),Gs.registerFlag("WEBGL_PACK",()=>Gs.getBool("HAS_WEBGL")),Gs.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Gs.getBool("WEBGL_PACK")),Gs.registerFlag("WEBGL_PACK_CLIP",()=>Gs.getBool("WEBGL_PACK")),Gs.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>!1),Gs.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Gs.getBool("WEBGL_PACK")),Gs.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Gs.getBool("WEBGL_PACK")),Gs.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Gs.getBool("WEBGL_PACK")),Gs.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Gs.getBool("WEBGL_PACK")),Gs.registerFlag("WEBGL_PACK_REDUCE",()=>Gs.getBool("WEBGL_PACK")),Gs.registerFlag("WEBGL_LAZILY_UNPACK",()=>Gs.getBool("WEBGL_PACK")),Gs.registerFlag("WEBGL_CONV_IM2COL",()=>Gs.getBool("WEBGL_PACK")),Gs.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>F$(Gs.getNumber("WEBGL_VERSION"))),Gs.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>B$(Gs.getNumber("WEBGL_VERSION"))),Gs.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const r=Gs.getNumber("WEBGL_VERSION");return r===0?0:z$(r)}),Gs.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Gs.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Hf()),Gs.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>$$(Gs.getNumber("WEBGL_VERSION"))),Gs.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Gs.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Gs.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),Gs.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>G$(Gs.getNumber("WEBGL_VERSION"))),Gs.registerFlag("WEBGL_FENCE_API_ENABLED",()=>W$(Gs.getNumber("WEBGL_VERSION"))),Gs.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Gs.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),Gs.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,r=>{if(r<0&&r!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${r}.`)});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ld(){let r,t,n,o,u,h,p,g,b,_;return He().getNumber("WEBGL_VERSION")===2?(r="#version 300 es",t="in",n="out",o="in",u="texture",h="outputColor",p="out vec4 outputColor;",g=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,b="",_=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(r="",t="attribute",n="varying",o="varying",u="texture2D",h="gl_FragColor",p="",g=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,b=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,_=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:r,attribute:t,varyingVs:n,varyingFs:o,texture2D:u,output:h,defineOutput:p,defineSpecialNaN:g,defineSpecialInf:b,defineRound:_}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F0(r,t,n="index"){const o=gt(t);return o.map((u,h)=>{const p=`int ${r[h]} = ${n} / ${u}`,g=h===o.length-1?`int ${r[h+1]} = ${n} - ${r[h]} * ${u}`:`index -= ${r[h]} * ${u}`;return`${p}; ${g};`}).join("")}function mS(r){return r.length===1?`${r[0]}`:`vec${r.length}(${r.join(",")})`}function $j(r,t){if(r.length!==t.length)throw new Error(`Vectors to be dotted must be of the same length -got ${r.length} and ${t.length}`);const n=[],o=Math.floor(r.length/4),u=r.length%4;for(let h=0;h<o;h++){const p=r.slice(h*4,h*4+4),g=t.slice(h*4,h*4+4);n.push(`${mS(p)}, ${mS(g)}`)}if(u!==0){let h=r.slice(o*4),p=t.slice(o*4);h.length===1&&(h=h.map(g=>`float(${g})`),p=p.map(g=>`float(${g})`)),n.push(`${mS(h)}, ${mS(p)}`)}return n.map((h,p)=>`dot(${h})`).join("+")}function oA(r){const t=gt(r).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}const Sk=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V${constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Sx.DENSE;const n=_x(t),o=ld();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${F0(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(${n[0]}, ${n[1]}));
        int index = 4 * (resTexRC.x * ${n[1]} + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${o.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j${constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Sx.DENSE;const n=_x(t),o=ld();this.outputShape=t,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${F0(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(${n[0]}, ${n[1]}));
        int index = 4 * (resTexRC.x * ${n[1]} + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${o.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H${constructor(t){this.variableNames=["A"],this.outTexUsage=Up.DOWNLOAD;const n=ld();this.outputShape=t,this.userCode=`
      ${Sk}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X${constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Up.DOWNLOAD;const n=ld();this.outputShape=t,this.userCode=`
      ${Sk}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y${constructor(t,n,o=!1){this.variableNames=["A"];const u=ld(),[h,p]=n;this.outputShape=t;let g="result";o&&(g="floor(result * 255. + 0.5)"),this.userCode=`
      ${oA(t)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / ${p};
        int c = imod(flatIndex, ${p});
        vec2 uv = (vec2(c, r) + halfCR) / vec2(${p}.0, ${h}.0);
        vec4 values = ${u.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${u.output} = vec4(${g}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K${constructor(t,n,o=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const u=ld(),[h,p]=n;this.outputShape=t;let g="",b="result";o&&(b="floor(result * 255. + 0.5)");for(let _=0;_<=1;_++)for(let z=0;z<=1;z++){const V=_*2+z;g+=`
          localCoords = coords;
          if(localCoords[2] + ${z} < ${t[2]}) {
            localCoords[2] += ${z};
            if(localCoords[1] + ${_} < ${t[1]}) {
              localCoords[1] += ${_};

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / ${p};
              c = imod(flatIndex, ${p});
              uv = (vec2(c, r) + halfCR) / vec2(${p}.0, ${h}.0);
              values = ${u.texture2D}(A, uv);

              if(offset == 0) {
                result[${V}] = values[0];
              } else if(offset == 1) {
                result[${V}] = values[1];
              } else if(offset == 2) {
                result[${V}] = values[2];
              } else {
                result[${V}] = values[3];
              }
            }
          }
        `}this.userCode=`
      ${oA(t)}

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        ${g}

        ${u.output} = ${b};
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z$(r){const t=ld(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return x$(r,n)}function q$(r){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return I$(r,t)}function Q$(r){const t=new Uint16Array([0,1,2,2,1,3]);return T$(r,t)}function Tx(r,t,n,o,u,h){M$(t,n);const p=A$(r),g=r.TEXTURE_2D;return Uo(r,()=>r.bindTexture(g,p)),Uo(r,()=>r.texParameteri(g,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE)),Uo(r,()=>r.texParameteri(g,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)),Uo(r,()=>r.texParameteri(g,r.TEXTURE_MIN_FILTER,r.NEAREST)),Uo(r,()=>r.texParameteri(g,r.TEXTURE_MAG_FILTER,r.NEAREST)),Uo(r,()=>r.texImage2D(g,0,o,t,n,0,u,h,null)),Uo(r,()=>r.bindTexture(r.TEXTURE_2D,null)),p}function Ck(r){return r.internalFormatFloat}function J$(r,t,n,o){const[u,h]=Cx(t,n);return Tx(r,u,h,Ck(o),o.textureFormatFloat,r.FLOAT)}function _k(r){return r.internalFormatHalfFloat}function t5(r,t,n,o){const[u,h]=Cx(t,n);return Tx(r,u,h,_k(o),o.textureFormatFloat,o.textureTypeHalfFloat)}function Ik(r){return r.downloadTextureFormat}function e5(r,t,n,o){const[u,h]=Cx(t,n);return Tx(r,u,h,Ik(o),r.RGBA,r.UNSIGNED_BYTE)}function Tk(r){return r.internalFormatPackedFloat}function n5(r,t,n,o){const[u,h]=x1(t,n);return Tx(r,u,h,Tk(o),r.RGBA,r.FLOAT)}function Ak(r){return r.internalFormatPackedHalfFloat}function r5(r,t,n,o){const[u,h]=x1(t,n);return Tx(r,u,h,Ak(o),r.RGBA,o.textureTypeHalfFloat)}function a5(r,t,n){const o=0,u=3*4,h=3*4+2*4;return Uo(r,()=>r.bindBuffer(r.ARRAY_BUFFER,n)),bk(r,t,"clipSpacePos",n,3,h,o)&&bk(r,t,"uv",n,2,h,u)}function i5(r,t,n,o,u,h){Uo(r,()=>r.bindTexture(r.TEXTURE_2D,t));let p,g,b;u instanceof Uint8Array?(p=new Uint8Array(n*o*4),g=r.UNSIGNED_BYTE,b=r.RGBA):(p=new Float32Array(n*o*4),g=r.FLOAT,b=h.internalFormatPackedFloat),p.set(u),Uo(r,()=>r.texImage2D(r.TEXTURE_2D,0,b,n,o,0,r.RGBA,g,p)),Uo(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function o5(r,t,n){Uo(r,()=>r.bindTexture(r.TEXTURE_2D,t)),n.data instanceof Uint8Array?Uo(r,()=>r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n.width,n.height,0,r.RGBA,r.UNSIGNED_BYTE,n.data)):Uo(r,()=>r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)),Uo(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function s5(r,t,n,o){const u=r.createBuffer();Uo(r,()=>r.bindBuffer(r.PIXEL_PACK_BUFFER,u));const g=4*4*t*n;return Uo(r,()=>r.bufferData(r.PIXEL_PACK_BUFFER,g,r.STREAM_READ)),Uo(r,()=>r.readPixels(0,0,n,t,r.RGBA,r.FLOAT,0)),Uo(r,()=>r.bindBuffer(r.PIXEL_PACK_BUFFER,null)),u}function u5(r,t,n){const o=r,u=new Float32Array(n);return o.bindBuffer(o.PIXEL_PACK_BUFFER,t),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,u),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),u}function l5(r,t,n,o){const[u,h]=Cx(t,n),p=4,g=new Uint8Array(d$(t*n,p));return Uo(r,()=>r.readPixels(0,0,u,h,o.downloadTextureFormat,r.UNSIGNED_BYTE,g)),new Float32Array(g.buffer)}function c5(r,t,n,o,u,h,p,g){const b=r,_=new Float32Array(p$(h,p));return b.bindBuffer(b.PIXEL_PACK_BUFFER,t),b.getBufferSubData(b.PIXEL_PACK_BUFFER,0,_),b.bindBuffer(b.PIXEL_PACK_BUFFER,null),_}function f5(r,t,n){const o=new Float32Array(t*n*4);return Uo(r,()=>r.readPixels(0,0,n,t,r.RGBA,r.FLOAT,o)),o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h5{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const n=He().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,c$(n,t)):this.gl=wg(n);let o="WEBGL_color_buffer_float";const u="EXT_color_buffer_half_float";if(He().getNumber("WEBGL_VERSION")===1){const h="OES_texture_float",p="OES_texture_half_float";if(this.textureFloatExtension=fS(this.gl,h),Iv(this.gl,p))this.textureHalfFloatExtension=fS(this.gl,p);else if(He().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(o),Iv(this.gl,u))this.colorBufferHalfFloatExtension=fS(this.gl,u);else if(He().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(o="EXT_color_buffer_float",Iv(this.gl,o))this.colorBufferFloatExtension=this.gl.getExtension(o);else if(Iv(this.gl,u))this.colorBufferHalfFloatExtension=this.gl.getExtension(u);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=q$(this.gl),this.indexBuffer=Q$(this.gl),this.framebuffer=N$(this.gl),this.textureConfig=eA(this.gl,this.textureHalfFloatExtension)}get debug(){return He().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;Uo(t,()=>t.finish()),Uo(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Uo(t,()=>t.deleteFramebuffer(this.framebuffer)),Uo(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),Uo(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),Uo(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,n){return this.throwIfDisposed(),J$(this.gl,t,n,this.textureConfig)}createFloat16MatrixTexture(t,n){return this.throwIfDisposed(),t5(this.gl,t,n,this.textureConfig)}createUnsignedBytesMatrixTexture(t,n){return this.throwIfDisposed(),e5(this.gl,t,n,this.textureConfig)}uploadPixelDataToTexture(t,n){this.throwIfDisposed(),o5(this.gl,t,n)}uploadDenseMatrixToTexture(t,n,o,u){this.throwIfDisposed(),i5(this.gl,t,n,o,u,this.textureConfig)}createFloat16PackedMatrixTexture(t,n){return this.throwIfDisposed(),r5(this.gl,t,n,this.textureConfig)}createPackedMatrixTexture(t,n){return this.throwIfDisposed(),n5(this.gl,t,n,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(xk(this.gl,this.framebuffer),this.outputTexture=null),Uo(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,n,o){return this.downloadMatrixDriver(t,()=>l5(this.gl,n,o,this.textureConfig))}downloadPackedMatrixFromBuffer(t,n,o,u,h,p){return c5(this.gl,t,n,o,u,h,p,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,n){return u5(this.gl,t,n)}createBufferFromTexture(t,n,o){this.bindTextureToFrameBuffer(t);const u=s5(this.gl,n,o,this.textureConfig);return this.unbindTextureToFrameBuffer(),u}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let n,o;if(He().getBool("WEBGL_FENCE_API_ENABLED")){const u=t,h=u.fenceSync(u.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),o=()=>{const p=u.clientWaitSync(h,0,0);return p===u.ALREADY_SIGNALED||p===u.CONDITION_SATISFIED},n=h}else He().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),o=()=>this.isQueryAvailable(n,He().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):o=()=>!0;return{query:n,isFencePassed:o}}downloadMatrixFromPackedTexture(t,n,o){return this.downloadMatrixDriver(t,()=>f5(this.gl,n,o))}createProgram(t){this.throwIfDisposed();const n=this.gl,o=w$(n,t),u=Z$(n),h=C$(n);return Uo(n,()=>n.attachShader(h,u)),Uo(n,()=>n.attachShader(h,o)),_$(n,h),this.debug&&nA(n,h),this.vertexAttrsAreBound||(this.setProgram(h),this.vertexAttrsAreBound=a5(n,this.program,this.vertexBuffer)),h}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Uo(this.gl,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&nA(this.gl,this.program),Uo(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,n,o=!0){return this.throwIfDisposed(),o?D$(this.gl,t,n):O$(this.gl,t,n)}getAttributeLocation(t,n){return this.throwIfDisposed(),Uo(this.gl,()=>this.gl.getAttribLocation(t,n))}getUniformLocationNoThrow(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)}setInputMatrixTexture(t,n,o){this.throwIfDisposed(),this.throwIfNoProgram(),R$(this.gl,t,n,o)}setOutputMatrixTexture(t,n,o){this.setOutputMatrixTextureDriver(t,o,n)}setOutputPackedMatrixTexture(t,n,o){this.throwIfDisposed();const[u,h]=x1(n,o);this.setOutputMatrixTextureDriver(t,u,h)}setOutputMatrixWriteRegion(t,n,o,u){this.setOutputMatrixWriteRegionDriver(o,t,u,n)}setOutputPackedMatrixWriteRegion(t,n,o,u){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&nA(this.gl,this.program),hS(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),Uo(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Uo(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=fS(this.gl,He().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(He().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const o=this.gl,u=this.getQueryTimerExtensionWebGL2(),h=o.createQuery();return o.beginQuery(u.TIME_ELAPSED_EXT,h),h}const t=this.getQueryTimerExtensionWebGL1(),n=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n}endQuery(){if(He().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,o=this.getQueryTimerExtensionWebGL2();n.endQuery(o.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}waitForQueryAndGetTime(t){return jr(this,null,function*(){return yield aa(()=>this.disposed||this.isQueryAvailable(t,He().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,He().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})}getQueryTime(t,n){if(n===0)return null;if(n===2){const o=this.gl;return o.getQueryParameter(t,o.QUERY_RESULT)/1e6}else{const o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,n){if(n===0)return!0;if(n===2){const o=this.gl,u=this.getQueryTimerExtensionWebGL2(),h=o.getQueryParameter(t,o.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(u.GPU_DISJOINT_EXT)),h&&!this.disjoint}else{const o=this.getQueryTimerExtensionWebGL1(),u=o.getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),u&&!this.disjoint}}pollFence(t){return new Promise(n=>{this.addItemToPoll(()=>t.isFencePassed(),()=>n())})}pollItems(){const t=d5(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=t;++n){const{resolveFn:o}=this.itemsToPoll[n];o()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,n){this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),!(this.itemsToPoll.length>1)&&aa(()=>(this.pollItems(),this.itemsToPoll.length===0))}bindTextureToFrameBuffer(t){this.throwIfDisposed(),rA(this.gl,t,this.framebuffer),this.debug&&hS(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(rA(this.gl,this.outputTexture,this.framebuffer),this.debug&&hS(this.gl)):xk(this.gl,this.framebuffer)}downloadMatrixDriver(t,n){this.bindTextureToFrameBuffer(t);const o=n();return this.unbindTextureToFrameBuffer(),o}setOutputMatrixTextureDriver(t,n,o){this.throwIfDisposed();const u=this.gl;rA(u,t,this.framebuffer),this.debug&&hS(u),this.outputTexture=t,Uo(u,()=>u.viewport(0,0,n,o)),Uo(u,()=>u.scissor(0,0,n,o))}setOutputMatrixWriteRegionDriver(t,n,o,u){this.throwIfDisposed(),Uo(this.gl,()=>this.gl.scissor(t,n,o,u))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function d5(r){let t=0;for(;t<r.length&&r[t]();++t);return t-1}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:Mk}=F;function p5(r,t,n,o){const u=[];r.forEach(St=>{const Tt=Rt(St.shapeInfo.logicalShape);St.shapeInfo.isUniform?u.push(`uniform float ${St.name}${Tt>1?`[${Tt}]`:""};`):(u.push(`uniform sampler2D ${St.name};`),u.push(`uniform int offset${St.name};`))});const h=u.join(`
`),p=r.map(St=>v5(St,t,o)).join(`
`),g=t.texShape,b=ld(),_=y5(b);let z,V,at=w5(b);return t.isPacked?(z=g5(t.logicalShape,g),V=x5(b)):(z=m5(t.logicalShape,g),V=b5(b)),o&&(at+=_5),[at,_,V,h,z,p,n].join(`
`)}function S1(r){const t=r.shapeInfo.logicalShape;switch(t.length){case 0:return F5(r);case 1:return z5(r);case 2:return G5(r);case 3:return W5(r);case 4:return j5(r);case 5:return H5(r);case 6:return X5(r);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function Nk(r){switch(r.shapeInfo.logicalShape.length){case 0:return P5(r);case 1:return B5(r);case 2:return $5(r);case 3:return U5(r);default:return V5(r)}}function v5(r,t,n=!1){let o="";n?o+=Nk(r):o+=S1(r);const u=r.shapeInfo.logicalShape,h=t.logicalShape;return u.length<=h.length&&(n?o+=Y5(r,t):o+=K5(r,t)),o}function g5(r,t){switch(r.length){case 0:return kk();case 1:return I5(r,t);case 2:return R5(r,t);case 3:return A5(r,t);default:return N5(r,t)}}function m5(r,t){switch(r.length){case 0:return kk();case 1:return T5(r,t);case 2:return L5(r,t);case 3:return M5(r,t);case 4:return k5(r,t);case 5:return D5(r,t);case 6:return O5(r,t);default:throw new Error(`${r.length}-D output sampling is not yet supported`)}}function y5(r){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${r.texture2D}(textureSampler, uv).r;
    }
  `}function b5(r){return`
    void setOutput(float val) {
      ${r.output} = vec4(val, 0, 0, 0);
    }
  `}function x5(r){return`
    void setOutput(vec4 val) {
      ${r.output} = val;
    }
  `}function w5(r){return`${r.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${r.varyingFs} vec2 resultUV;
    ${r.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${r.defineSpecialNaN}
    ${r.defineSpecialInf}
    ${r.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${E5}
    ${S5}
    ${C5}
  `}const E5=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,S5=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,C5=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,_5=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function kk(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function I5(r,t){const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return n[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${n[1]}.0);
      }
    `:n[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${n[0]}.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      return 2 * (resTexRC.x * ${n[1]} + resTexRC.y);
    }
  `}function T5(r,t){return t[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function A5(r,t){const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],o=Math.ceil(r[2]/2),u=o*Math.ceil(r[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      int b = index / ${u};
      index -= b * ${u};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec3(b, r, c);
    }
  `}function M5(r,t){const n=F0(["r","c","d"],r);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${n}
      return ivec3(r, c, d);
    }
  `}function N5(r,t){const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],o=Math.ceil(r[r.length-1]/2),u=o*Math.ceil(r[r.length-2]/2);let h=u,p="",g="b, r, c";for(let b=2;b<r.length-1;b++)h*=r[r.length-b-1],p=`
      int b${b} = index / ${h};
      index -= b${b} * ${h};
    `+p,g=`b${b}, `+g;return`
    ivec${r.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));
      int index = resTexRC.x * ${n[1]} + resTexRC.y;

      ${p}

      int b = index / ${u};
      index -= b * ${u};

      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec${r.length}(${g});
    }
  `}function k5(r,t){const n=F0(["r","c","d","d2"],r);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${n}
      return ivec4(r, c, d, d2);
    }
  `}function D5(r,t){const n=F0(["r","c","d","d2","d3"],r);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function O5(r,t){const n=F0(["r","c","d","d2","d3","d4"],r);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function R5(r,t){const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Bn(r,t))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));
      }
    `;const o=Math.ceil(r[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${n[0]}, ${n[1]}));

      int index = resTexRC.x * ${n[1]} + resTexRC.y;
      int r = 2 * (index / ${o});
      int c = imod(index, ${o}) * 2;

      return ivec2(r, c);
    }
  `}function L5(r,t){return Bn(r,t)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:r[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:r[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${r[1]};
      int c = index - r * ${r[1]};
      return ivec2(r, c);
    }
  `}function B0(r){return`offset${r}`}function P5(r){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),o=ld();return`
    vec4 ${n}() {
      return ${o.texture2D}(${t}, halfCR);
    }
  `}function F5(r){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(r.shapeInfo.isUniform)return`float ${n}() {return ${t};}`;const[o,u]=r.shapeInfo.texShape;if(o===1&&u===1)return`
      float ${n}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const[h,p]=r.shapeInfo.texShape,g=B0(t);return`
    float ${n}() {
      vec2 uv = uvFromFlat(${h}, ${p}, ${g});
      return sampleTexture(${t}, uv);
    }
  `}function B5(r){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),o=r.shapeInfo.texShape,u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],h=ld();return`
    vec4 ${n}(int index) {
      vec2 uv = packedUVfrom1D(
        ${u[0]}, ${u[1]}, index);
      return ${h.texture2D}(${t}, uv);
    }
  `}function z5(r){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(r.shapeInfo.isUniform)return`
      float ${n}(int index) {
        ${C1(r)}
      }
    `;const o=r.shapeInfo.texShape,u=o[0],h=o[1];if(h===1&&u===1)return`
      float ${n}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const p=B0(t);return h===1?`
      float ${n}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${p}) + 0.5) / ${u}.0);
        return sampleTexture(${t}, uv);
      }
    `:u===1?`
      float ${n}(int index) {
        vec2 uv = vec2((float(index + ${p}) + 0.5) / ${h}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
    float ${n}(int index) {
      vec2 uv = uvFromFlat(${u}, ${h}, index + ${p});
      return sampleTexture(${t}, uv);
    }
  `}function $5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=r.shapeInfo.texShape,h=u[0],p=u[1],g=ld();if(u!=null&&Bn(t,u))return`
      vec4 ${o}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${p}.0, ${h}.0);

        return ${g.texture2D}(${n}, uv);
      }
    `;const b=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],_=Math.ceil(t[1]/2);return`
    vec4 ${o}(int row, int col) {
      vec2 uv = packedUVfrom2D(${_}, ${b[0]}, ${b[1]}, row, col);
      return ${g.texture2D}(${n}, uv);
    }
  `}function G5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=r.shapeInfo.texShape;if(u!=null&&Bn(t,u)){const V=u[0],at=u[1];return`
    float ${o}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${at}.0, ${V}.0);
      return sampleTexture(${n}, uv);
    }
  `}const{newShape:h,keptDims:p}=_n(t),g=h;if(g.length<t.length){const V=_1(r,g),at=["row","col"];return`
      ${S1(V)}
      float ${o}(int row, int col) {
        return ${o}(${I1(at,p)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${C1(r)}
      }
    `;const b=u[0],_=u[1],z=B0(n);return _===1?`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${z}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${b}.0);
      return sampleTexture(${n}, uv);
    }
  `:b===1?`
    float ${o}(int row, int col) {
      float index = dot(vec3(row, col, ${z}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${_}.0, 0.5);
      return sampleTexture(${n}, uv);
    }
  `:`
  float ${o}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${z};
    vec2 uv = uvFromFlat(${b}, ${_}, index);
    return sampleTexture(${n}, uv);
  }
`}function U5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=r.shapeInfo.texShape,h=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(t[0]===1){const V=t.slice(1),at=[1,2],Et=_1(r,V),St=["b","row","col"];return`
        ${Nk(Et)}
        vec4 ${o}(int b, int row, int col) {
          return ${o}(${I1(St,at)});
        }
      `}const p=h[0],g=h[1],b=Math.ceil(t[2]/2),_=b*Math.ceil(t[1]/2),z=ld();return`
    vec4 ${o}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${p}, ${g}, ${_}, ${b}, b, row, col);
      return ${z.texture2D}(${n}, uv);
    }
  `}function W5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=t[1]*t[2],h=t[2],{newShape:p,keptDims:g}=_n(t),b=p;if(b.length<t.length){const St=_1(r,b),Tt=["row","col","depth"];return`
        ${S1(St)}
        float ${o}(int row, int col, int depth) {
          return ${o}(${I1(Tt,g)});
        }
      `}if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${u}, ${h}, 1)));
        ${C1(r)}
      }
    `;const _=r.shapeInfo.texShape,z=_[0],V=_[1],at=r.shapeInfo.flatOffset;if(V===u&&at==null)return`
        float ${o}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${h}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${V}.0, ${z}.0);
          return sampleTexture(${n}, uv);
        }
      `;if(V===h&&at==null)return`
    float ${o}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${V}.0, ${z}.0);
      return sampleTexture(${n}, uv);
    }
  `;const Et=B0(n);return`
      float ${o}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${u} + col * ${h} + depth + ${Et};
        vec2 uv = uvFromFlat(${z}, ${V}, index);
        return sampleTexture(${n}, uv);
      }
  `}function V5(r){const t=r.shapeInfo.logicalShape,n=t.length,o=r.name,u="get"+o.charAt(0).toUpperCase()+o.slice(1),h=r.shapeInfo.texShape,p=[Math.ceil(h[0]/2),Math.ceil(h[1]/2)],g=p[0],b=p[1],_=Math.ceil(t[n-1]/2);let z=_*Math.ceil(t[n-2]/2),V="int b, int row, int col",at=`b * ${z} + (row / 2) * ${_} + (col / 2)`;for(let St=2;St<n-1;St++)V=`int b${St}, `+V,z*=t[n-St-1],at=`b${St} * ${z} + `+at;const Et=ld();return`
    vec4 ${u}(${V}) {
      int index = ${at};
      int texR = index / ${b};
      int texC = index - texR * ${b};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${b}, ${g});
      return ${Et.texture2D}(${o}, uv);
    }
  `}function j5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=t[3],h=t[2]*u,p=t[1]*h,{newShape:g,keptDims:b}=_n(t);if(g.length<t.length){const St=_1(r,g),Tt=["row","col","depth","depth2"];return`
      ${S1(St)}
      float ${o}(int row, int col, int depth, int depth2) {
        return ${o}(${I1(Tt,b)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${p}, ${h}, ${u}, 1)));
        ${C1(r)}
      }
    `;const _=r.shapeInfo.flatOffset,z=r.shapeInfo.texShape,V=z[0],at=z[1];if(at===p&&_==null)return`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${h}, ${u}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${at}.0, ${V}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(at===u&&_==null)return`
      float ${o}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${at}.0, ${V}.0);
        return sampleTexture(${n}, uv);
      }
    `;const Et=B0(n);return`
    float ${o}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${p} + col * ${h} +
          depth * ${u} + depth2;
      vec2 uv = uvFromFlat(${V}, ${at}, index + ${Et});
      return sampleTexture(${n}, uv);
    }
  `}function H5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),u=t[4],h=t[3]*u,p=t[2]*h,g=t[1]*p,{newShape:b,keptDims:_}=_n(t);if(b.length<t.length){const Tt=_1(r,b),Wt=["row","col","depth","depth2","depth3"];return`
      ${S1(Tt)}
      float ${o}(int row, int col, int depth, int depth2, int depth3) {
        return ${o}(${I1(Wt,_)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${g}, ${p}, ${h}, ${u})) +
          depth3;
        ${C1(r)}
      }
    `;const z=r.shapeInfo.flatOffset,V=r.shapeInfo.texShape,at=V[0],Et=V[1];if(Et===g&&z==null)return`
      float ${o}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${p}, ${h}, ${u}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${Et}.0, ${at}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(Et===u&&z==null)return`
      float ${o}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${Et}.0, ${at}.0);
        return sampleTexture(${n}, uv);
      }
    `;const St=B0(n);return`
    float ${o}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${g} + col * ${p} + depth * ${h} +
          depth2 * ${u} + depth3 + ${St};
      vec2 uv = uvFromFlat(${at}, ${Et}, index);
      return sampleTexture(${n}, uv);
    }
  `}function X5(r){const t=r.shapeInfo.logicalShape,n=r.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:u,keptDims:h}=_n(t);if(u.length<t.length){const Wt=_1(r,u),le=["row","col","depth","depth2","depth3","depth4"];return`
      ${S1(Wt)}
      float ${o}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${o}(${I1(le,h)});
      }
    `}const p=t[5],g=t[4]*p,b=t[3]*g,_=t[2]*b,z=t[1]*_;if(r.shapeInfo.isUniform)return`
      float ${o}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${z}, ${_}, ${b}, ${g})) +
          dot(
            vec2(depth3, depth4),
            vec2(${p}, 1)));
        ${C1(r)}
      }
    `;const V=r.shapeInfo.flatOffset,at=r.shapeInfo.texShape,Et=at[0],St=at[1];if(St===z&&V==null)return`
      float ${o}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${_}, ${b}, ${g}, ${p})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${St}.0, ${Et}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(St===p&&V==null)return`
      float ${o}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${St}.0, ${Et}.0);
        return sampleTexture(${n}, uv);
      }
    `;const Tt=B0(n);return`
    float ${o}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${z} + col * ${_} + depth * ${b} +
          depth2 * ${g} + depth3 * ${p} + depth4 + ${Tt};
      vec2 uv = uvFromFlat(${Et}, ${St}, index);
      return sampleTexture(${n}, uv);
    }
  `}function C1(r){const t=r.name,n=Rt(r.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function Y5(r,t){const n=r.name,o=n.charAt(0).toUpperCase()+n.slice(1),u="get"+o+"AtOutCoords",h=r.shapeInfo.logicalShape.length,p=t.logicalShape.length,g=Mk(r.shapeInfo.logicalShape,t.logicalShape),b=ic(p),_=p-h;let z;const V=["x","y","z","w","u","v"];h===0?z="":p<2&&g.length>=1?z="coords = 0;":z=g.map(ye=>`coords.${V[ye+_]} = 0;`).join(`
`);let at="";p<2&&h>0?at="coords":at=r.shapeInfo.logicalShape.map((ye,Qe)=>`coords.${V[Qe+_]}`).join(", ");let Et="return outputValue;";const Tt=Rt(r.shapeInfo.logicalShape)===1,le=Rt(t.logicalShape)===1;if(h===1&&!Tt&&!le)Et=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(Tt&&!le)p===1?Et=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:Et=`
        return vec4(outputValue.x);
      `;else if(g.length){const ye=h-2,Qe=h-1;g.indexOf(ye)>-1&&g.indexOf(Qe)>-1?Et="return vec4(outputValue.x);":g.indexOf(ye)>-1?Et="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":g.indexOf(Qe)>-1&&(Et="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${u}() {
      ${b} coords = getOutputCoords();
      ${z}
      vec4 outputValue = get${o}(${at});
      ${Et}
    }
  `}function K5(r,t){const n=r.name,o=n.charAt(0).toUpperCase()+n.slice(1),u="get"+o+"AtOutCoords",h=t.texShape,p=r.shapeInfo.texShape,g=r.shapeInfo.logicalShape.length,b=t.logicalShape.length;if(!r.shapeInfo.isUniform&&g===b&&r.shapeInfo.flatOffset==null&&Bn(p,h))return`
      float ${u}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const _=ic(b),z=Mk(r.shapeInfo.logicalShape,t.logicalShape),V=b-g;let at;const Et=["x","y","z","w","u","v"];g===0?at="":b<2&&z.length>=1?at="coords = 0;":at=z.map(Tt=>`coords.${Et[Tt+V]} = 0;`).join(`
`);let St="";return b<2&&g>0?St="coords":St=r.shapeInfo.logicalShape.map((Tt,Wt)=>`coords.${Et[Wt+V]}`).join(", "),`
    float ${u}() {
      ${_} coords = getOutputCoords();
      ${at}
      return get${o}(${St});
    }
  `}function ic(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error(`GPU for rank ${r} is not yet supported`)}function _1(r,t){const n=JSON.parse(JSON.stringify(r));return n.shapeInfo.logicalShape=t,n}function I1(r,t){return t.map(n=>r[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z5(r,t,n,o){const u=t.userCode,h=n.map((Et,St)=>{const Tt={logicalShape:Et.shape,texShape:Et.isUniform?null:Et.texData.texShape,isUniform:Et.isUniform,isPacked:Et.isUniform?!1:Et.texData.isPacked,flatOffset:null};return Et.texData!=null&&Et.texData.slice!=null&&Et.texData.slice.flatOffset>0&&(Tt.flatOffset=Et.texData.slice.flatOffset),{name:t.variableNames[St],shapeInfo:Tt}}),p=h.map(Et=>Et.shapeInfo),g={logicalShape:o.shape,texShape:o.texData.texShape,isUniform:!1,isPacked:o.texData.isPacked,flatOffset:null},b=p5(h,g,u,t.packedInputs),_=r.createProgram(b);let z=null;const V=r.getUniformLocation(_,"NAN",!1);He().getNumber("WEBGL_VERSION")===1&&(z=r.getUniformLocation(_,"INFINITY",!1));const at={};for(let Et=0;Et<t.variableNames.length;Et++){const St=t.variableNames[Et],Tt=!1;at[St]=r.getUniformLocation(_,St,Tt),at[`offset${St}`]=r.getUniformLocation(_,`offset${St}`,Tt)}return{program:t,source:b,webGLProgram:_,uniformLocations:at,inShapeInfos:p,outShapeInfo:g,infLoc:z,nanLoc:V}}function Dk(r,t){if(r.length!==t.length)throw Error(`Binary was compiled with ${r.length} inputs, but was executed with ${t.length} inputs`);r.forEach((n,o)=>{const u=n.logicalShape,h=t[o],p=h.shape;if(!Bn(u,p))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${u} and ${p} must match`);if(n.isUniform&&h.isUniform)return;const g=n.texShape,b=h.isUniform?null:h.texData.texShape;if(!Bn(g,b))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${g} and ${b} must match`)})}function q5(r,t,n,o,u){Dk(t.inShapeInfos,n),Dk([t.outShapeInfo],[o]);const h=o.texData.texture,p=o.texData.texShape;o.texData.isPacked?r.setOutputPackedMatrixTexture(h,p[0],p[1]):r.setOutputMatrixTexture(h,p[0],p[1]),r.setProgram(t.webGLProgram),He().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&r.gl.uniform1f(t.infLoc,Infinity),t.nanLoc!==null&&r.gl.uniform1f(t.nanLoc,NaN),n.forEach((g,b)=>{const _=t.program.variableNames[b],z=t.uniformLocations[_],V=t.uniformLocations[`offset${_}`];if(z!=null){if(g.isUniform){if(Rt(g.shape)<2)r.gl.uniform1f(z,g.uniformValues[0]);else{let at=g.uniformValues;at instanceof Float32Array||(at=new Float32Array(at)),r.gl.uniform1fv(z,at)}return}g.texData.slice!=null&&V!=null&&r.gl.uniform1i(V,g.texData.slice.flatOffset),r.setInputMatrixTexture(g.texData.texture,z,b)}}),u!=null&&u(r,t.webGLProgram),r.executeProgram()}function Q5(r,t,n){let o="";t.concat(n).forEach(p=>{const g=p.texData!=null&&p.texData.slice!=null&&p.texData.slice.flatOffset>0,b=p.isUniform?"uniform":p.texData.texShape;o+=`${p.shape}_${b}_${g}`});const u=r.userCode;let h=r.constructor.name;return h+="_"+o+"_"+u,h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:J5,bincountImpl:Ok,bincountReduceImpl:t6,ceilImpl:e6,concatImpl:n6,expImpl:r6,expm1Impl:a6,floorImpl:i6,gatherV2Impl:o6,greaterImpl:s6,lessImpl:u6,linSpaceImpl:l6,logImpl:c6,maxImpl:f6,maximumImpl:h6,minimumImpl:d6,multiplyImpl:p6,negImpl:v6,prodImpl:g6,rangeImpl:m6,rsqrtImpl:y6,simpleAbsImpl:Rk,sliceImpl:b6,stridedSliceImpl:x6,subImpl:w6,tileImpl:E6,topKImpl:S6,transposeImpl:sA,uniqueImpl:C6}=Oe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lk(r,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${r}.${n}`)}function cd(r,t){return t===1?[r]:Lk(r,t)}function _6(r,t){if(r===1)return"rc";let n="";for(let o=0;o<r;o++)n+=t[o],o<r-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I6{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;const n=t.length;if(n===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const o=cd("rc",n),u=ic(n),h=A6(n,t,o),p=M6(n,t[t.length-1],t[t.length-2],o),g=N6(t,o);this.userCode=`
        void main() {
          ${u} rc = getOutputCoords();

          if(${h}) {
            setOutput(vec4(0));
          } else {
            ${p}

            setOutput(vec4(${g}));
          }
        }
      `}}}function T6(r,t){const n=[];for(let o=0;o<=1;o++)for(let u=0;u<=1;u++){let h=`${o===0?"r":"rp1"}, ${u===0?"c":"cp1"}`;for(let p=2;p<r;p++)h=`${t[t.length-1-p]},`+h;n.push(h)}return n}function A6(r,t,n){if(r===1)return`rc > ${t[0]}`;let o="";for(let u=r-2;u<r;u++)o+=`${n[u]} >= ${t[u]}`,u<r-1&&(o+="||");return o}function M6(r,t,n,o){if(r===1)return"";const u=o.slice(-2);return`
    int r = ${u[0]};
    int c = ${u[1]};
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= ${t};
    bool rEdge = rp1 >= ${n};
  `}function N6(r,t){const n=r.length,o=T6(n,t);return n===1?`getA(rc),
            rc + 1 >= ${r[0]} ? 0. : getA(rc + 1),
            0, 0`:`getA(${o[0]}),
          cEdge ? 0. : getA(${o[1]}),
          rEdge ? 0. : getA(${o[2]}),
          rEdge || cEdge ? 0. : getA(${o[3]})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pk{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let o="";for(let u=0;u<4;u++){let h="thisRC = rc;";u%2==1&&(h+="thisRC.z += 1;"),u>1&&(h+="thisRC.y += 1;"),o+=`
        ${h}
        ${u>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${u}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${u>0?"}":""}
      `}this.userCode=`
      ${k6(n)}
      ${oA(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${t[1]};
        int cols = ${t[2]};

        ${o}

        setOutput(result);
      }
    `}}function k6(r){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${F0(["r","c","d"],r)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D6{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,n,o){const u=Bk(n,o),h=zk(t,u,o);h in this.freeTextures||(this.freeTextures[h]=[]),h in this.usedTextures||(this.usedTextures[h]=[]);const p=Fk(t,u,this.gpgpu.gl,this.gpgpu.textureConfig,o);if(this.freeTextures[h].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=p,this.log();const b=this.freeTextures[h].shift();return this.usedTextures[h].push(b),b}let g;return u===lh.PACKED_2X2_FLOAT32?g=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):u===lh.PACKED_2X2_FLOAT16?g=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):u===lh.UNPACKED_FLOAT32?g=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):u===lh.UNPACKED_FLOAT16?g=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):u===lh.PACKED_4X1_UNSIGNED_BYTE&&(g=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[h].push(g),this.numUsedTextures++,this._numBytesAllocated+=p,this.log(),g}releaseTexture(t,n,o,u){if(this.freeTextures==null)return;const h=Bk(o,u),p=zk(n,h,u);p in this.freeTextures||(this.freeTextures[p]=[]);const g=Fk(n,h,this.gpgpu.gl,this.gpgpu.textureConfig,u),b=He().get("WEBGL_DELETE_TEXTURE_THRESHOLD");b!==-1&&this._numBytesAllocated>b?(this.gpgpu.deleteMatrixTexture(t),this._numBytesAllocated-=g):(this.freeTextures[p].push(t),this.numFreeTextures++,this._numBytesFree+=g),this.numUsedTextures--;const _=this.usedTextures[p],z=_.indexOf(t);if(z<0)throw new Error("Cannot release a texture that was never provided by this texture manager");_.splice(z,1),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n)});for(const t in this.usedTextures)this.usedTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function O6(r,t){const n=r;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===r.RGBA)return 16;if(t===n.RGBA16F)return 8;throw new Error(`Unknown internal format ${t}`)}function Fk(r,t,n,o,u){const h=R6(t,o);let p;if(u){const[b,_]=x1(r[0],r[1]);p=b*_}else{const[b,_]=Cx(r[0],r[1]);p=b*_}const g=O6(n,h);return p*g}function R6(r,t){switch(r){case lh.PACKED_2X2_FLOAT32:return Tk(t);case lh.PACKED_2X2_FLOAT16:return Ak(t);case lh.UNPACKED_FLOAT32:return Ck(t);case lh.UNPACKED_FLOAT16:return _k(t);case lh.PACKED_4X1_UNSIGNED_BYTE:return Ik(t);default:throw new Error(`Unknown physical texture type ${r}`)}}function L6(r){return He().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?r?lh.PACKED_2X2_FLOAT32:lh.UNPACKED_FLOAT32:r?lh.PACKED_2X2_FLOAT16:lh.UNPACKED_FLOAT16}function Bk(r,t){if(r===Up.UPLOAD)return lh.PACKED_2X2_FLOAT32;if(r===Up.RENDER||r==null)return L6(t);if(r===Up.DOWNLOAD||r===Up.PIXELS)return lh.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${r}`)}function zk(r,t,n){return`${r[0]}_${r[1]}_${t}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pm{constructor(t,n){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Tv="if (isnan(x)) return x;",P6="return x;",$k="return abs(x);";function Gj(r=0){return Tv+`
    return x > 0.0 ? 1.0 : float(${r});
  `}const F6="return (x >= 0.0) ? x : (exp(x) - 1.0);",B6=Tv+`
  return (x < 0.0) ? 0.0 : x;
`,z6=Tv+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,yS="return x;";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $6="return x;",G6=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,U6=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,W6=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;class T1{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V6{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;const n=t.length,o=cd("rc",n),u=ic(n),h=_6(n,o),p=o.slice(-2),g=n<=1?"rc":`vec2(${p.join(",")})`;this.userCode=`
      void main() {
        ${u} rc = getOutputCoords();
        vec4 packedInput = getA(${h});

        setOutput(getChannel(packedInput, ${g}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j6=s0,H6=1e-7,X6=1e-4,bS={};function Y6(r){return r in bS||(bS[r]={}),bS[r]}const K6=128,Z6=600;function q6(){return He().global.screen==null?1024:He().global.screen.height*He().global.screen.width*window.devicePixelRatio*Z6/1024/1024}class Q6 extends Ye{constructor(t){super();if(this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.warnedAboutCPUBackend=!1,this.pendingDeletes=0,this.disposed=!1,!He().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(t==null){const n=wg(He().getNumber("WEBGL_VERSION"));this.binaryCache=Y6(He().getNumber("WEBGL_VERSION")),this.gpgpu=new h5(n),this.canvas=n.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=t,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;this.textureManager=new D6(this.gpgpu),this.numMBBeforeWarning=q6(),this.texData=new Ae(this,Wa())}numDataIds(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}write(t,n,o){if((He().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||He().getBool("DEBUG"))&&this.checkNumericalProblems(t),o==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const u={};return this.texData.set(u,{shape:n,dtype:o,values:t,usage:Up.UPLOAD,refCount:1,complexParentRefCount:0}),u}incRef(t){const n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.refCount--}}decComplexRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.complexParentRefCount>0&&n.refCount--}}move(t,n,o,u){if(He().getBool("DEBUG")&&this.checkNumericalProblems(n),u==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:o,dtype:u,values:n,usage:Up.UPLOAD,refCount:1,complexParentRefCount:0})}disposeIntermediateTensorInfo(t){const n=t.dataId;if(this.texData.has(n)){const o=this.texData.get(n);o.refCount--,o.refCount<1&&this.disposeData(n)}}readSync(t){const n=this.texData.get(t),{values:o,dtype:u,complexTensorInfos:h,slice:p,shape:g,isPacked:b}=n;if(p!=null){let at;b?at=new T1(g,yS):at=new Pm(g,yS);const Et=this.runWebGLProgram(at,[{dataId:t,shape:g,dtype:u}],u),St=this.readSync(Et.dataId);return this.disposeIntermediateTensorInfo(Et),St}if(o!=null)return this.convertAndCacheOnCPU(t);if(u==="string")return o;const _=this.activeTimers!=null;let z;_&&(z=js());let V;if(u==="complex64"){const at=this.readSync(h.real.dataId),Et=this.readSync(h.imag.dataId);V=Uv(at,Et)}else V=this.getValuesFromTexture(t);return _&&(this.downloadWaitMs+=js()-z),this.convertAndCacheOnCPU(t,V)}read(t){return jr(this,null,function*(){if(this.pendingRead.has(t)){const St=this.pendingRead.get(t);return new Promise(Tt=>St.push(Tt))}const n=this.texData.get(t),{values:o,shape:u,slice:h,dtype:p,complexTensorInfos:g,isPacked:b}=n;if(h!=null){let St;b?St=new T1(u,yS):St=new Pm(u,yS);const Tt=this.runWebGLProgram(St,[{dataId:t,shape:u,dtype:p}],p),Wt=this.read(Tt.dataId);return this.disposeIntermediateTensorInfo(Tt),Wt}if(o!=null)return this.convertAndCacheOnCPU(t);if(!He().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&He().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let _=null,z;if(p!=="complex64"&&He().get("WEBGL_BUFFER_SUPPORTED")){z=this.decode(t);const St=this.texData.get(z.dataId);_=this.gpgpu.createBufferFromTexture(St.texture,..._x(u))}this.pendingRead.set(t,[]),p!=="complex64"&&(yield this.gpgpu.createAndWaitForFence());let V;if(p==="complex64"){const St=yield Promise.all([this.read(g.real.dataId),this.read(g.imag.dataId)]),Tt=St[0],Wt=St[1];V=Uv(Tt,Wt)}else if(_==null)V=this.getValuesFromTexture(t);else{const St=Rt(u);V=this.gpgpu.downloadFloat32MatrixFromBuffer(_,St)}z!=null&&this.disposeIntermediateTensorInfo(z);const at=this.convertAndCacheOnCPU(t,V),Et=this.pendingRead.get(t);return this.pendingRead.delete(t),Et.forEach(St=>St(at)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),at})}bufferSync(t){const n=this.readSync(t.dataId);let o=n;if(t.dtype==="string")try{o=n.map(u=>Dt(u))}catch(u){throw new Error("Failed to decode encoded string bytes into utf-8")}return zs(t.shape,t.dtype,o)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){const o=t[n];if(!y$(o))throw He().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${o} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${o} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:n,dtype:o,isPacked:u}=this.texData.get(t),h=Rt(n);if(He().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const at=this.decode(t),Et=this.texData.get(at.dataId),St=this.gpgpu.downloadMatrixFromPackedTexture(Et.texture,..._x(n)).subarray(0,h);return this.disposeIntermediateTensorInfo(at),St}const p=He().getBool("WEBGL_PACK")&&u===!0,g=p?aA(n):n,b=p?new X$(g):new H$(g),_=this.runWebGLProgram(b,[{shape:g,dtype:o,dataId:t}],"float32"),z=this.texData.get(_.dataId),V=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(z.texture,z.texShape[0],z.texShape[1]).subarray(0,h);return this.disposeIntermediateTensorInfo(_),V}time(t){return jr(this,null,function*(){const n=this.activeTimers,o=[];let u=!1;this.programTimersStack==null?(this.programTimersStack=o,u=!0):this.activeTimers.push(o),this.activeTimers=o,t();const h=fn(this.activeTimers.map(b=>b.query)).filter(b=>b!=null),p=fn(this.activeTimers.map(b=>b.name)).filter(b=>b!=null);this.activeTimers=n,u&&(this.programTimersStack=null);const g={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(He().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const b=yield Promise.all(h);g.kernelMs=Ve(b),g.getExtraProfileInfo=()=>b.map((_,z)=>({name:p[z],ms:_})).map(_=>`${_.name}: ${_.ms}`).join(", ")}else g.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,g})}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return He().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:js(),endMs:null}}endTimer(t){return He().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=js(),t)}getQueryTime(t){return jr(this,null,function*(){if(He().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const n=t;return n.endMs-n.startMs})}disposeData(t){if(this.pendingDisposal.has(t))return;if(this.pendingRead.has(t)){this.pendingDisposal.add(t),this.pendingDeletes++;return}if(!this.texData.has(t))return;if(this.texData.get(t).complexParentRefCount>0){this.texData.get(t).refCount--;return}this.releaseGPUData(t);const{complexTensorInfos:n}=this.texData.get(t);n!=null&&(this.texData.get(n.real.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(n.real),this.texData.get(n.imag.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(n.imag)),this.texData.delete(t)}releaseGPUData(t){const{texture:n,dtype:o,texShape:u,usage:h,isPacked:p,slice:g}=this.texData.get(t),b=g&&g.origDataId||t,_=this.dataRefCount.get(b);_>1?this.dataRefCount.set(b,_-1):(this.dataRefCount.delete(b),n!=null&&(this.numBytesInGPU-=this.computeBytes(u,o),this.textureManager.releaseTexture(n,u,h,p)));const z=this.texData.get(t);z.texture=null,z.texShape=null,z.isPacked=!1,z.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture}getDataInfo(t){return this.texData.get(t)}getCPUBackend(){return He().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=Wa().findBackend("cpu")),this.cpuBackend):null}shouldExecuteOnCPU(t,n=K6){const o=this.getCPUBackend();return!He().getBool("IS_TEST")&&!this.warnedAboutCPUBackend&&o==null&&(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),o!=null&&t.every(u=>this.texData.get(u.dataId).texture==null&&Rt(u.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){Sm("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=t.dataSync();return j6(t.shape,n)}packedUnaryOp(t,n,o){const u=new T1(t.shape,n);return this.compileAndRun(u,[t],o)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const o=Rk(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,o)}if(He().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,$k,t.dtype);const n=new Pm(t.shape,$k);return this.compileAndRun(n,[t])}makeTensorInfo(t,n,o){let u;if(n==="string"&&o!=null&&o.length>0&&Sr(o[0])){const h=o.map(p=>Pl(p));u=this.write(h,t,n)}else u=this.write(o,t,n);return this.texData.get(u).usage=null,{dataId:u,shape:t,dtype:n}}makeOutput(t,n,o){const{dataId:u}=this.makeTensorInfo(t,n,o);return Wa().makeTensorFromDataId(u,t,n,this)}unpackTensor(t){const n=new V6(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){const n=new I6(t.shape),o=!0;return this.runWebGLProgram(n,[t],t.dtype,null,o)}packedReshape(t,n){const o=[w1(t.shape),...E1(t.shape)],u={dtype:t.dtype,shape:o,dataId:t.dataId},h=[w1(n),...E1(n)],p=new Pk(h,o),g=!0,b=this.runWebGLProgram(p,[u],t.dtype,null,g);return{dataId:b.dataId,shape:n,dtype:b.dtype}}decode(t){const n=this.texData.get(t),{isPacked:o,shape:u,dtype:h}=n,p=aA(u);let g;o?g=new j$(p):g=new V$(p);const b=!0,_=this.runWebGLProgram(g,[{shape:p,dtype:h,dataId:t}],h,null,b);return{dtype:h,shape:u,dataId:_.dataId}}runWebGLProgram(t,n,o,u,h=!1){const p=this.makeTensorInfo(t.outputShape,o),g=this.texData.get(p.dataId);if(t.packedOutput&&(g.isPacked=!0),t.outPackingScheme===Sx.DENSE){const Tt=_x(t.outputShape);g.texShape=Tt.map(Wt=>Wt*2)}if(t.outTexUsage!=null&&(g.usage=t.outTexUsage),Rt(p.shape)===0)return g.values=sr(p.dtype,0),p;const b=[],_=n.map(Tt=>{if(Tt.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let Wt=this.texData.get(Tt.dataId);if(Wt.texture==null){if(!t.packedInputs&&Rt(Tt.shape)<=He().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:Tt.shape,texData:null,isUniform:!0,uniformValues:Wt.values};t.packedInputs&&(Wt.isPacked=!0,Wt.shape=Tt.shape)}else if(!!Wt.isPacked!=!!t.packedInputs)Tt=Wt.isPacked?this.unpackTensor(Tt):this.packTensor(Tt),b.push(Tt),Wt=this.texData.get(Tt.dataId);else if(Wt.isPacked&&!pS(Wt.shape,Tt.shape)){const le=Tt,ye=Tt.shape;Tt.shape=Wt.shape,Tt=this.packedReshape(Tt,ye),b.push(Tt),Wt=this.texData.get(Tt.dataId),le.shape=ye}return this.uploadToGPU(Tt.dataId),{shape:Tt.shape,texData:Wt,isUniform:!1}});this.uploadToGPU(p.dataId);const z={shape:p.shape,texData:g,isUniform:!1},V=Q5(t,_,z),at=this.getAndSaveBinary(V,()=>Z5(this.gpgpu,t,_,z)),Et=this.activeTimers!=null;let St;if(Et&&(St=this.startTimer()),q5(this.gpgpu,at,_,z,u),b.forEach(Tt=>this.disposeIntermediateTensorInfo(Tt)),Et&&(St=this.endTimer(St),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(St)})),!He().getBool("WEBGL_LAZILY_UNPACK")&&g.isPacked&&h===!1){const Tt=this.unpackTensor(p);return this.disposeIntermediateTensorInfo(p),Tt}return p}compileAndRun(t,n,o,u,h=!1){o=o||n[0].dtype;const p=this.runWebGLProgram(t,n,o,u,h);return Wa().makeTensorFromDataId(p.dataId,p.shape,p.dtype)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(He().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement!="undefined"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Vn(()=>{if(!He().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=He().getBool("DEBUG");He().set("DEBUG",!1);const n=this.abs(zi(1e-8)).dataSync()[0];if(He().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?H6:X6}uploadToGPU(t){const n=this.texData.get(t),{shape:o,dtype:u,values:h,texture:p,usage:g,isPacked:b}=n;if(p!=null)return;const _=this.activeTimers!=null;let z;_&&(z=js());let V=n.texShape;if(V==null&&(V=P$(o,b),n.texShape=V),h!=null){const at=aA(o);let Et,St=V[1],Tt=V[0];const Wt=h instanceof Uint8Array;b?([St,Tt]=x1(V[0],V[1]),Et=new K$(at,[Tt,St],Wt)):Et=new Y$(at,[Tt,St],Wt);const le=this.makeTensorInfo([Tt,St],u);Wt?this.texData.get(le.dataId).usage=Up.PIXELS:this.texData.get(le.dataId).usage=Up.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(le.dataId),St,Tt,h);const ye=!0,Qe=this.runWebGLProgram(Et,[le],u,null,ye),$e=this.texData.get(Qe.dataId);n.texture=$e.texture,n.texShape=$e.texShape,n.isPacked=$e.isPacked,n.usage=$e.usage,this.disposeIntermediateTensorInfo(le),this.texData.delete(Qe.dataId),n.values=null,_&&(this.uploadWaitMs+=js()-z)}else{const at=this.acquireTexture(V,g,u,b);n.texture=at}}convertAndCacheOnCPU(t,n){const o=this.texData.get(t),{dtype:u}=o;return this.releaseGPUData(t),n!=null&&(o.values=J6(n,u)),o.values}acquireTexture(t,n,o,u){if(this.numBytesInGPU+=this.computeBytes(t,o),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const h=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${h} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,u)}computeBytes(t,n){return t[0]*t[1]*nr(n)}}function J6(r,t){if(t==="float32"||t==="complex64")return r;if(t==="int32"||t==="bool"){const n=t==="int32"?new Int32Array(r.length):new Uint8Array(r.length);for(let o=0;o<n.length;++o)n[o]=Math.round(r[o]);return n}else throw new Error(`Unknown dtype ${t}`)}/** @license See the LICENSE file. */const tG="2.8.6";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eG(){He().set("WEBGL_FORCE_F16_TEXTURES",!0)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */mc()&&Ke("webgl",()=>new Q6,2);const Uj={forceHalfFloat:eG};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gk=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,Wj="return (a - b) * (a - b);";class A1{constructor(t,n,o){this.variableNames=["A","B"],this.outputShape=Nr(n,o),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xS=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`,Vj=null,jj=null;class Ax{constructor(t,n,o,u=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Nr(n,o);const h=this.outputShape.length;let p="";if(u)if(h===0||Rt(this.outputShape)===1)p=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(p=`
          ${ic(h)} coords = getOutputCoords();
        `,h===1)p+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const b=cd("coords",h);p+=`
            bool nextRowOutOfBounds =
              (${b[h-2]} + 1) >= ${this.outputShape[h-2]};
            bool nextColOutOfBounds =
              (${b[h-1]} + 1) >= ${this.outputShape[h-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${p}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cp(r){const{inputs:t,backend:n}=r,{x:o}=t;return n.incRef(o.dataId),{dataId:o.dataId,shape:o.shape,dtype:o.dtype}}const nG={kernelName:Au,backendName:"webgl",kernelFunc:cp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fm(r){const{inputs:t,backend:n}=r,{real:o,imag:u}=t,h=n.makeTensorInfo(o.shape,"complex64"),p=n.texData.get(h.dataId),g=cp({inputs:{x:o},backend:n}),b=n.texData.get(g.dataId);b.complexParentRefCount++;const _=cp({inputs:{x:u},backend:n}),z=n.texData.get(_.dataId);return z.complexParentRefCount++,p.complexTensorInfos={real:g,imag:_},h}const rG={kernelName:bi,backendName:"webgl",kernelFunc:Fm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uk="return (a < 0.) ? b * a : a;",Wk=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function aG(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{alpha:h}=o,p=n.makeTensorInfo([],"float32",vf(h,"float32")),g=He().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ax(Wk,u.shape,p.shape):new A1(Uk,u.shape,p.shape),b=n.runWebGLProgram(g,[u,p],u.dtype);return n.disposeIntermediateTensorInfo(p),b}const iG={kernelName:Pu,backendName:"webgl",kernelFunc:aG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vk="return (a < 0.) ? b * a : a;",jk=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function oG(r){const{inputs:t,backend:n}=r,{x:o,alpha:u}=t,h=He().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ax(jk,o.shape,u.shape):new A1(Vk,o.shape,u.shape);return n.runWebGLProgram(h,[o,u],o.dtype)}const sG={kernelName:Oi,backendName:"webgl",kernelFunc:oG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hk="if (isnan(x)) return x;",uG=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`,lG=`
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;
`;function pl({opSnippet:r,packedOpSnippet:t,cpuKernelImpl:n,dtype:o}){return({inputs:u,backend:h})=>{const{x:p}=u,g=h,b=o||p.dtype;if(g.shouldExecuteOnCPU([p])&&n!=null){const V=g.texData.get(p.dataId),at=n(V.values,b);return g.makeTensorInfo(p.shape,b,at)}const _=He().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let z;return _?z=new T1(p.shape,t):z=new Pm(p.shape,r),g.runWebGLProgram(z,[p],b)}}function ch({opSnippet:r,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:o=!1,cpuKernelImpl:u,dtype:h}){return({inputs:p,backend:g})=>{const{a:b,b:_}=p,z=g;if(o&&b.dtype==="complex64"){const St=z.texData.get(b.dataId),Tt=z.texData.get(_.dataId),[Wt,le]=[[St.complexTensorInfos.real,Tt.complexTensorInfos.real],[St.complexTensorInfos.imag,Tt.complexTensorInfos.imag]].map(Qe=>{const[$e,Xe]=Qe,Rn={dataId:$e.dataId,dtype:$e.dtype,shape:b.shape},Cn={dataId:Xe.dataId,dtype:Xe.dtype,shape:_.shape},mr=new A1(r,b.shape,_.shape);return z.runWebGLProgram(mr,[Rn,Cn],uo($e.dtype,Xe.dtype))}),ye=Fm({inputs:{real:Wt,imag:le},backend:z});return z.disposeIntermediateTensorInfo(Wt),z.disposeIntermediateTensorInfo(le),ye}const V=h||uo(b.dtype,_.dtype);if(z.shouldExecuteOnCPU([b,_])&&u!=null){const St=z.texData.get(b.dataId),Tt=z.texData.get(_.dataId),[Wt,le]=u(b.shape,_.shape,St.values,Tt.values,V),ye=z.makeTensorInfo(le,V),Qe=z.texData.get(ye.dataId);return Qe.values=Wt,ye}const at=He().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let Et;return at?Et=new Ax(t,b.shape,_.shape,n):Et=new A1(r,b.shape,_.shape),z.runWebGLProgram(Et,[b,_],V)}}function wS(r,t=!1){if(r==="linear")return t?$6:P6;if(r==="relu")return t?U6:B6;if(r==="elu")return t?G6:F6;if(r==="relu6")return t?W6:z6;if(r==="prelu")return t?jk:Vk;if(r==="leakyrelu")return t?Wk:Uk;throw new Error(`Activation ${r} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xk{constructor(t,n,o,u=!1,h=!1,p=!1,g=null,b=!1,_=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const z=u?t[1]:t[2],V=Math.ceil(z/2),at=u?"i * 2, rc.y":"rc.y, i * 2",Et=h?"rc.z, i * 2":"i * 2, rc.z",St=u?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],Tt=h?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let Wt="",le="";g&&(b?Wt=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${g}
        }`:_?Wt=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${g}
        }`:Wt=`vec4 activation(vec4 x) {
          ${g}
        }`,le="result = activation(result);");const ye=p?"result += getBiasAtOutCoords();":"";p&&this.variableNames.push("bias"),b&&this.variableNames.push("preluActivationWeights"),_&&this.variableNames.push("leakyreluAlpha");let Qe="rc.x",$e="rc.x";t[0]<n[0]?Qe=`int(min(float(rc.x), ${t[0]-1}.))`:n[0]<t[0]&&($e=`int(min(float(rc.x), ${n[0]-1}.))`),this.userCode=`
      ${Wt}

      const float sharedDimension = ${V}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${V}; i++) {
          int batchA = ${Qe};
          int batchB = ${$e};
          vec4 a = getMatrixA(batchA, ${at});
          vec4 b = getMatrixB(batchB, ${Et});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${St[0]} * ${Tt[0]});
          result += (${St[1]} * ${Tt[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${ye}

        ${le}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yk={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class Kk{constructor(t,n,o){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Nr(n,o),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zk="return a * b;";function qk(r){const{inputs:t,backend:n}=r,{a:o,b:u}=t,h=uo(o.dtype,u.dtype);if(o.dtype==="complex64"){const g=n.texData.get(o.dataId),b=n.texData.get(u.dataId),_=new Kk(Yk.REAL,o.shape,u.shape),z=new Kk(Yk.IMAG,o.shape,u.shape),V=[{dataId:g.complexTensorInfos.real.dataId,dtype:g.complexTensorInfos.real.dtype,shape:o.shape},{dataId:g.complexTensorInfos.imag.dataId,dtype:g.complexTensorInfos.imag.dtype,shape:o.shape},{dataId:b.complexTensorInfos.real.dataId,dtype:b.complexTensorInfos.real.dtype,shape:u.shape},{dataId:b.complexTensorInfos.imag.dataId,dtype:b.complexTensorInfos.imag.dtype,shape:u.shape}],at=n.runWebGLProgram(_,V,"float32"),Et=n.runWebGLProgram(z,V,"float32"),St=Fm({inputs:{real:at,imag:Et},backend:n});return n.disposeIntermediateTensorInfo(at),n.disposeIntermediateTensorInfo(Et),St}if(n.shouldExecuteOnCPU([o,u])){const g=n.texData.get(o.dataId),b=n.texData.get(u.dataId),[_,z]=p6(o.shape,u.shape,g.values,b.values,h),V=n.makeTensorInfo(z,h),at=n.texData.get(V.dataId);return at.values=_,V}let p;return He().getBool("WEBGL_PACK_BINARY_OPERATIONS")?p=new Ax(Zk,o.shape,u.shape):p=new A1(Zk,o.shape,u.shape),n.runWebGLProgram(p,[o,u],h)}const cG={kernelName:Ie,backendName:"webgl",kernelFunc:qk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(r,t,n){const o=[w1(r.shape),...E1(r.shape)],u={dtype:r.dtype,shape:o,dataId:r.dataId},h=[w1(t),...E1(t)],p=new Pk(h,o),g=!0,b=n.runWebGLProgram(p,[u],r.dtype,null,g);return{dataId:b.dataId,shape:t,dtype:b.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ko(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{shape:h}=o,p=n,g=Rt(u.shape),b=Da(h,g),_=Rt(b);bt(g===_,()=>`The new shape (${b}) has ${_} elements and the old shape (${u.shape}) has ${g} elements. The new shape and old shape must have the same number of elements.`);const z=p.texData.get(u.dataId);return z.isPacked&&!pS(u.shape,b)&&!(z.texture!==null&&pS(z.shape,b))?fG(u,b,p):(p.incRef(u.dataId),{dataId:u.dataId,shape:b,dtype:u.dtype})}const hG={kernelName:Ps,backendName:"webgl",kernelFunc:ko};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qk{constructor(t,n){this.variableNames=["x"];const{windowSize:o,batchSize:u,inSize:h,outSize:p}=t;this.outputShape=[u,p];const g=Math.floor(o/4)*4,b=o%4;let _="sumValue += dot(values, ones);";if(n!=null){const V=1/n;_=`sumValue += dot(values * ${xr(V)?V.toPrecision(2):V}, ones);`}let z="";h%o>0&&(z=`
        if (inIdx < 0 || inIdx >= ${h}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${z}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        float sumValue = 0.0;

        for (int i = 0; i < ${g}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${_}
        }

        int inIdx = inOffset + ${g};
        if (${b===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${_}
        } else if (${b===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${_}
        } else if (${b===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${_}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dG{constructor(t,n){this.variableNames=["x"];const{windowSize:o,batchSize:u,inSize:h,outSize:p}=t;this.outputShape=[u,p];let g="0.0",b="";n==="prod"?g="1.0":n==="min"?(g="1.0 / 1e-20",b="min"):n==="max"&&(g="-1.0 / 1e-20",b="max");let _=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?_="sumValue":n==="prod"?_="prodValue":n==="all"?_="allValue":n==="any"&&(_="anyValue");const z=Math.floor(o/4)*4,V=o%4;let at=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `,Et="vec4";n==="all"?(g="1.0",at=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,Et="bvec4"):n==="any"&&(g="0.0",at=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,Et="bvec4");let St="";h%o>0&&(St=`
        if (inIdx < 0 || inIdx >= ${h}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${g};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${St}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${o};

        vec4 minMaxValue = vec4(${g});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${z}; i += 4) {
          int inIdx = inOffset + i;
          ${Et} values = ${Et}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${at}
        }

        int inIdx = inOffset + ${z};
        if (${V===1}) {
          ${Et} values = ${Et}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${at}
        } else if (${V===2}) {
          ${Et} values = ${Et}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${at}
        } else if (${V===3}) {
          ${Et} values = ${Et}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${at}
        }
        setOutput(${_});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pG(r){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const n=t.length?t[t.length-1].outSize:r[1],o=Ty(n);t.push({inSize:n,windowSize:o,outSize:Math.ceil(n/o)})}return t}function z0(r,t,n,o){const u=pG(r.shape);let h=r;for(let p=0;p<u.length;p++){const{inSize:g,windowSize:b,outSize:_}=u[p];let z,V;n==="mean"?z=p===0?new Qk({windowSize:b,inSize:g,batchSize:r.shape[0],outSize:_},g):new Qk({windowSize:b,inSize:g,batchSize:r.shape[0],outSize:_}):z=new dG({windowSize:b,inSize:g,batchSize:r.shape[0],outSize:_},n),V=h,h=o.runWebGLProgram(z,[h],t),V.dataId!==r.dataId&&o.disposeIntermediateTensorInfo(V)}return h}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vG{constructor(t,n){this.variableNames=["A"];const o=new Array(t.length);for(let p=0;p<o.length;p++)o[p]=t[n[p]];this.outputShape=o,this.rank=o.length;const u=ic(this.rank),h=gG(n);this.userCode=`
    void main() {
      ${u} resRC = getOutputCoords();
      setOutput(getA(${h}));
    }
    `}}function gG(r){const t=r.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],o=new Array(t);for(let u=0;u<r.length;u++)o[r[u]]=n[u];return o.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mG{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const o=new Array(t.length);for(let z=0;z<o.length;z++)o[z]=t[n[z]];if(this.outputShape=o,this.rank=o.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const u=ic(this.rank),h=Lk("rc",this.rank),p=new Array(this.rank);for(let z=0;z<n.length;z++)p[n[z]]=h[z];const g=`vec2(${p.slice(-2).join()})`,b=`++${h[this.rank-1]} < ${o[this.rank-1]}`,_=`getChannel(getA(${p.join()}), ${g})`;this.userCode=`
    void main() {
      ${u} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${_};
      if(${b}) {
        result[1] = ${_};
      }
      --${h[this.rank-1]};
      if(++${h[this.rank-2]} < ${o[this.rank-2]}) {
        result[2] = ${_};
        if(${b}) {
          result[3] = ${_};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ES(r,t,n){const o=He().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mG(r.shape,t):new vG(r.shape,t);return n.runWebGLProgram(o,[r],r.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yG(r,t,n,o){const u=t,h=r.shape.length,p=Lr(u,r.shape);let g=p;const b=Gc(g,h),_=b!=null;let z=r;_&&(z=ES(r,b,o),g=Qc(g.length,h)),kf("sum",g,h);const[V,at]=uf(z.shape,g);let Et=V;n&&(Et=$c(V,p));const St=Rt(at),Wt=Rt(r.shape)/St,le=ko({inputs:{x:z},attrs:{shape:[Wt,St]},backend:o}),ye=$o(r.dtype),Qe=z0(le,ye,"sum",o),$e=ko({inputs:{x:Qe},attrs:{shape:Et},backend:o});return o.disposeIntermediateTensorInfo(le),o.disposeIntermediateTensorInfo(Qe),_&&o.disposeIntermediateTensorInfo(z),$e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uA(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o;return yG(u,h,p,n)}const bG={kernelName:an,backendName:"webgl",kernelFunc:uA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Md(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{perm:h}=o,p=n,g=u.shape.length,b=new Array(g);for(let z=0;z<b.length;z++)b[z]=u.shape[h[z]];let _;if(p.shouldExecuteOnCPU([u])){const V=p.texData.get(u.dataId).values,at=sA(V,u.shape,u.dtype,h,b);_=p.makeTensorInfo(b,u.dtype);const Et=p.texData.get(_.dataId);Et.values=at}else _=ES(u,h,p);return _}const xG={kernelName:_o,backendName:"webgl",kernelFunc:Md};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jk=1e3;function SS({a:r,b:t,transposeA:n,transposeB:o,backend:u,bias:h=null,preluActivationWeights:p=null,leakyreluAlpha:g=0,activation:b=null}){const _=r.shape.length,z=t.shape.length,V=n?r.shape[_-2]:r.shape[_-1],at=o?t.shape[z-1]:t.shape[z-2],Et=n?r.shape[_-1]:r.shape[_-2],St=o?t.shape[z-2]:t.shape[z-1],Tt=r.shape.slice(0,-2),Wt=t.shape.slice(0,-2),le=Rt(Tt),ye=Rt(Wt),Qe=le===ye||le===1||ye===1;bt(_>=2&&z>=2&&Qe,()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${Tt}) and (${Wt}).`);const Xe=(le>ye?r.shape.slice(0,-2):t.shape.slice(0,-2)).concat([Et,St]);bt(V===at,()=>`Error in matMul: inner shapes (${V}) and (${at}) of Tensors with shapes ${r.shape} and ${t.shape} and transposeA=${n} and transposeB=${o} must match.`);const Rn=n?[le,V,Et]:[le,Et,V],Cn=o?[ye,St,at]:[ye,at,St],mr=ko({inputs:{x:r},backend:u,attrs:{shape:Rn}}),zr=ko({inputs:{x:t},backend:u,attrs:{shape:Cn}}),ta=[mr,zr],Ma=Math.max(le,ye),Za=n?mr.shape[1]:mr.shape[2],Ka=h!=null,ni=p!=null,Ua=b==="leakyrelu",Ba=b!=null?wS(b,!0):null,mi=Ka||ni||Ua||Ba!=null;let ti;if((Et===1||St===1)&&Za>Jk&&mi===!1){let $i=mr,Gi=zr;n&&($i=Md({inputs:{x:mr},backend:u,attrs:{perm:[0,2,1]}}),ta.push($i)),o&&(Gi=Md({inputs:{x:zr},backend:u,attrs:{perm:[0,2,1]}}),ta.push(Gi));const Ji=St!==1,ro=St===1;let io=$i;Ji&&(io=ko({inputs:{x:$i},backend:u,attrs:{shape:[Ma,Za,1]}}),ta.push(io));const bo=St===1?2:1;let co=Gi;ro&&(co=ko({inputs:{x:Gi},backend:u,attrs:{shape:[Ma,1,Za]}}),ta.push(co));const Ko=qk({inputs:{a:io,b:co},backend:u});ti=uA({inputs:{x:Ko},backend:u,attrs:{axis:bo,keepDims:!0}}),ta.push(Ko)}else{const $i=uo(r.dtype,t.dtype),Gi=new Xk(Rn,Cn,[Ma,Et,St],n,o,Ka,Ba,ni,Ua),Ji=[mr,zr];if(h!=null&&Ji.push(h),ni&&Ji.push(p),Ua){const ro=u.makeTensorInfo([],"float32",vf(g,"float32"));Ji.push(ro),ta.push(ro)}ti=u.runWebGLProgram(Gi,Ji,$i)}const yi=ko({inputs:{x:ti},backend:u,attrs:{shape:Xe}});ta.push(ti);for(const $i of ta)u.disposeIntermediateTensorInfo($i);return yi}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(r){const{inputs:t,backend:n,attrs:o}=r,{a:u,b:h,bias:p,preluActivationWeights:g}=t,{transposeA:b,transposeB:_,activation:z,leakyreluAlpha:V}=o;return SS({a:u,b:h,transposeA:b,transposeB:_,backend:n,bias:p,preluActivationWeights:g,leakyreluAlpha:V,activation:z})}const EG={kernelName:Hu,backendName:"webgl",kernelFunc:wG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tD="return abs(x);";function SG(r){const{inputs:t,backend:n}=r,{x:o}=t;if(n.shouldExecuteOnCPU([o])&&o.dtype!=="complex64"){const h=n.texData.get(o.dataId),p=Rk(h.values);return n.makeTensorInfo(o.shape,o.dtype,p)}let u;return He().getBool("WEBGL_PACK_UNARY_OPERATIONS")?u=new T1(o.shape,tD):u=new Pm(o.shape,tD),n.runWebGLProgram(u,[o],o.dtype)}const CG={kernelName:za,backendName:"webgl",kernelFunc:SG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _G=Tv+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,IG=pl({opSnippet:_G}),TG={kernelName:da,backendName:"webgl",kernelFunc:IG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AG=Tv+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,MG=pl({opSnippet:AG}),NG={kernelName:Ti,backendName:"webgl",kernelFunc:MG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eD="return a + b;",kG=ch({opSnippet:eD,packedOpSnippet:eD,supportsComplex:!0,cpuKernelImpl:J5}),DG={kernelName:ki,backendName:"webgl",kernelFunc:kG};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OG{constructor(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map((h,p)=>`T${p}`);const o=[];this.variableNames.forEach(h=>{o.push(`float v${h} = get${h}AtOutCoords();`)});const u=this.variableNames.map(h=>`v${h}`).join(" + ");this.userCode=`
      void main() {
        ${o.join(`
        `)}

        float result = ${u};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RG{constructor(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((h,p)=>`T${p}`);const o=[];this.variableNames.forEach(h=>{o.push(`vec4 v${h} = get${h}AtOutCoords();`)});const u=this.variableNames.map(h=>`v${h}`).join(" + ");this.userCode=`
      void main() {
        ${o.join(`
        `)}

        vec4 result = ${u};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CS(r){const{inputs:t,backend:n}=r,o=t;if(o.length===1)return cp({inputs:{x:o[0]},backend:n});if(o.length>He().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const b=Math.floor(o.length/2),_=CS({inputs:o.slice(0,b),backend:n}),z=CS({inputs:o.slice(b),backend:n});return CS({inputs:[_,z],backend:n})}const u=o.map(b=>b.dtype).reduce((b,_)=>uo(b,_)),h=o.map(b=>b.shape),g=He().getBool("WEBGL_PACK")?new RG(o[0].shape,h):new OG(o[0].shape,h);return n.runWebGLProgram(g,o,u)}const LG={kernelName:vi,backendName:"webgl",kernelFunc:CS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PG(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o,g=u.shape.length,b=Lr(h,u.shape);let _=b;const z=Gc(_,g);let V=u;z!=null&&(V=Md({inputs:{x:u},backend:n,attrs:{perm:z}}),_=Qc(_.length,g)),kf("all",_,g);const[at,Et]=uf(V.shape,_),St=Rt(Et),Tt=ko({inputs:{x:V},backend:n,attrs:{shape:[-1,St]}}),Wt=z0(Tt,Tt.dtype,"all",n);let le;if(p){const ye=$c(at,b);le=ko({inputs:{x:Wt},backend:n,attrs:{shape:ye}})}else le=ko({inputs:{x:Wt},backend:n,attrs:{shape:at}});return n.disposeIntermediateTensorInfo(Tt),n.disposeIntermediateTensorInfo(Wt),z!=null&&n.disposeIntermediateTensorInfo(V),le}const FG={kernelName:ii,backendName:"webgl",kernelFunc:PG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BG(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o,g=u.shape.length,b=Lr(h,u.shape);let _=b;const z=Gc(_,g);let V=u;z!=null&&(V=Md({inputs:{x:u},backend:n,attrs:{perm:z}}),_=Qc(_.length,g)),kf("any",_,g);const[at,Et]=uf(V.shape,_),St=Rt(Et),Tt=ko({inputs:{x:V},backend:n,attrs:{shape:[-1,St]}}),Wt=z0(Tt,Tt.dtype,"any",n);let le;if(p){const ye=$c(at,b);le=ko({inputs:{x:Wt},backend:n,attrs:{shape:ye}})}else le=ko({inputs:{x:Wt},backend:n,attrs:{shape:at}});return n.disposeIntermediateTensorInfo(Tt),n.disposeIntermediateTensorInfo(Wt),z!=null&&n.disposeIntermediateTensorInfo(V),le}const zG={kernelName:Di,backendName:"webgl",kernelFunc:BG};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $G{constructor(t,n,o){this.variableNames=["A"];const{windowSize:u,batchSize:h,outSize:p}=t;o||this.variableNames.push("bestIndicesA"),this.outputShape=[h,p];const g=n==="max"?">":"<",b=o?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${u};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${u}; i++) {
          int inIdx = ${b};
          float candidate = getA(batch, inIdx);
          if (candidate ${g} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GG{constructor(t,n,o,u){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,bt(t.length>2,()=>`Packed arg${o.charAt(0).toUpperCase()+o.slice(1)} supports only inputs with rank above 2.`);const h=t[t.length-1],p=Math.ceil(h/n);this.outputShape=t.slice(0,-1),p>1&&this.outputShape.push(p),u||this.variableNames.push("bestIndicesA");const g=this.outputShape,b=g.length,_=ic(b),z=cd("coords",b);let V,at;if(p===1){at=b+1;const mr=ic(at);V=`
        ${mr} sourceLocR = ${mr}(${z.join()}, 0);
        ++${z[b-1]};
        ${mr} sourceLocG = ${mr}(${z.join()}, 0);
        ++${z[b-2]};
        ${mr} sourceLocA = ${mr}(${z.join()}, 0);
        --${z[b-1]};
        ${mr} sourceLocB = ${mr}(${z.join()}, 0);
        --${z[b-2]};`}else at=b,V=`
        ${_} sourceLocR = coords;
        ++${z[b-1]};
        ${_} sourceLocG = coords;
        ++${z[b-2]};
        ${_} sourceLocA = coords;
        --${z[b-1]};
        ${_} sourceLocB = coords;
        --${z[b-2]};`;const Et=["x","y","z","w","u","v"].slice(0,at),St="."+Et[at-1],Tt=Et.map(mr=>"int "+mr),Wt=cd("sourceLocR",at-1).concat("inIdx.r"),le=cd("sourceLocG",at-1).concat("inIdx.g"),ye=cd("sourceLocB",at-1).concat("inIdx.b"),Qe=cd("sourceLocA",at-1).concat("inIdx.a"),$e=o==="max"?"greaterThan":"lessThan",Xe=u?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${Wt.join()}),
                             getBestIndicesAChannel(${le.join()}),
                             getBestIndicesAChannel(${ye.join()}),
                             getBestIndicesAChannel(${Qe.join()})));`,Rn=`vec4(
            getAChannel(${Wt.join()}),
            hasNextCol ? getAChannel(${le.join()}) : 0.,
            hasNextRow ? getAChannel(${ye.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${Qe.join()}) : 0.)`,Cn=u?"":`
      float getBestIndicesAChannel(${Tt.join()}) {
        return getChannel(getBestIndicesA(${Et.join()}),
                                          vec2(${Et.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${Tt.join()}) {
        return getChannel(getA(${Et.join()}),
                               vec2(${Et.slice(-2).join()}));
      }
      ${Cn}
      void main() {
        ${_} coords = getOutputCoords();
        bool hasNextCol = ${z[b-1]} < ${g[b-1]-1};
        bool hasNextRow = ${z[b-2]} < ${g[b-2]-1};
        ${V}
        ivec4 srcIdx = ivec4(sourceLocR${St}, sourceLocG${St},
          sourceLocB${St}, sourceLocA${St}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${Rn};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${Xe}
          vec4 candidate = ${Rn};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${$e}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nD(r,t,n,o=null){let u=t.shape[0],h=t.shape[1];o!=null&&(u=o.shape[0],h=o.shape[1]);const p=Ty(h),g={windowSize:p,inSize:h,batchSize:u,outSize:Math.ceil(h/p)},b=new $G(g,n,o==null),_=[t];o!=null&&_.push(o);const z=r.runWebGLProgram(b,_,"int32");if(z.shape[1]===1)return z;const V=nD(r,t,n,z);return r.disposeIntermediateTensorInfo(z),V}function rD(r,t,n,o=null){const u=o!=null?o.shape:t.shape,h=u[u.length-1],p=Ty(h),g=new GG(u,p,n,o==null),b=o==null?[t]:[t,o],_=r.runWebGLProgram(g,b,"int32");if(_.shape.length===t.shape.length){const z=rD(r,t,n,_);return r.disposeIntermediateTensorInfo(_),z}return _}function aD(r,t,n,o){const u=[n];if(kf("arg"+o.charAt(0).toUpperCase()+o.slice(1),u,t.shape.length),!He().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const h=[],[p,g]=uf(t.shape,u),b=Rt(g),_=ko({inputs:{x:t},backend:r,attrs:{shape:[-1,b]}});h.push(_);const z=nD(r,_,o);h.push(z);const V=ko({inputs:{x:z},backend:r,attrs:{shape:p}});return h.forEach(at=>r.disposeIntermediateTensorInfo(at)),V}return rD(r,t,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UG(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h}=o;let p=Lr(h,u.shape);const g=Gc(p,u.shape.length);let b=u;const _=[];g!=null&&(b=Md({inputs:{x:u},backend:n,attrs:{perm:g}}),_.push(b),p=Qc(p.length,b.shape.length)),kf("argMax",[p[0]],b.shape.length);const z=aD(n,b,p[0],"max");return _.forEach(V=>n.disposeIntermediateTensorInfo(V)),z}const WG={kernelName:Ra,backendName:"webgl",kernelFunc:UG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VG(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h}=o;let p=Lr(h,u.shape);const g=Gc(p,u.shape.length);let b=u;const _=[];g!=null&&(b=Md({inputs:{x:u},backend:n,attrs:{perm:g}}),_.push(b),p=Qc(p.length,b.shape.length)),kf("argMin",[p[0]],b.shape.length);const z=aD(n,b,p[0],"min");return _.forEach(V=>n.disposeIntermediateTensorInfo(V)),z}const jG={kernelName:ln,backendName:"webgl",kernelFunc:VG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HG=Tv+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,XG=pl({opSnippet:HG}),YG={kernelName:De,backendName:"webgl",kernelFunc:XG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KG=Tv+"return log(x + sqrt(x * x + 1.0));",ZG=pl({opSnippet:KG}),qG={kernelName:dn,backendName:"webgl",kernelFunc:ZG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QG=Tv+`
  return atan(x);
`,JG=pl({opSnippet:QG}),t8={kernelName:Wn,backendName:"webgl",kernelFunc:JG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e8=uG+`
  return atan(a, b);
`,n8=`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+lG+`
  return result;
`,r8=ch({opSnippet:e8,packedOpSnippet:n8}),a8={kernelName:Kn,backendName:"webgl",kernelFunc:r8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i8=Tv+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,o8=pl({opSnippet:i8}),s8={kernelName:Gn,backendName:"webgl",kernelFunc:o8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mx{constructor(t,n,o,u=!1,h=!1){if(this.variableNames=["x"],n==="avg"&&o)throw new Error("Cannot compute positions for average pool.");const p=t.filterWidth,g=t.strideHeight,b=t.strideWidth,_=t.dilationHeight,z=t.dilationWidth,V=t.effectiveFilterHeight,at=t.effectiveFilterWidth,Et=t.padInfo.top,St=t.padInfo.left;this.outputShape=t.outShape;const Tt=n==="avg",Wt=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,le=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let ye="0.0";if(Tt||(ye="-1.0 / 1e-20"),o){const mr=">=";this.userCode=`
        const ivec2 strides = ivec2(${g}, ${b});
        const ivec2 pads = ivec2(${Et}, ${St});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${V};
              wR += ${_}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${at};
                wC += ${z}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${mr} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${u?h?Wt:le:`wR * ${at} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const Qe="max";let $e=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&($e="avgValue / count");const Xe=Math.floor(p/4)*4,Rn=p%4,Cn=`
      if (${Tt}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${Qe}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${g}, ${b});
      const ivec2 pads = ivec2(${Et}, ${St});
      const float initializationValue = ${ye};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${ye});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${V};
            wR += ${_}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${Xe}; wC += 4) {
            int xC = xCCorner + wC * ${z};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${z}, d),
              getValue(batch, xR, xC + 2 * ${z}, d),
              getValue(batch, xR, xC + 3 * ${z}, d)
            );

            ${Cn}
          }

          int xC = xCCorner + ${Xe};
          if (${Rn===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${Cn}
          } else if (${Rn===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${z}, d),
              initializationValue,
              initializationValue
            );

            ${Cn}
          } else if (${Rn===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${z}, d),
              getValue(batch, xR, xC + 2 * ${z}, d),
              initializationValue
            );

            ${Cn}
          }
        }
        setOutput(${$e});
      }
    `}}class lA{constructor(t,n,o,u=!1,h=!1){if(this.variableNames=["x"],n==="avg"&&o)throw new Error("Cannot compute positions for average pool.");const p=t.filterWidth,g=t.strideDepth,b=t.strideHeight,_=t.strideWidth,z=t.dilationDepth,V=t.dilationHeight,at=t.dilationWidth,Et=t.effectiveFilterDepth,St=t.effectiveFilterHeight,Tt=t.effectiveFilterWidth,Wt=t.padInfo.front,le=t.padInfo.top,ye=t.padInfo.left;this.outputShape=t.outShape;const Qe=n==="avg";let $e="0.0";if(Qe||($e="-1.0 / 1e-20"),o){const ta=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${g}, ${b}, ${_});
        const ivec3 pads = ivec3(${Wt}, ${le}, ${ye});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${Et};
              wD += ${z}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${St};
                wR += ${V}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${Tt};
                  wC += ${at}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${ta} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${u?h?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${St} * ${Tt} +
                      wR * ${Tt} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const Xe="max";let Rn=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(Rn="avgValue / count");const Cn=Math.floor(p/4)*4,mr=p%4,zr=`
      if (${Qe}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${Xe}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${g}, ${b}, ${_});
      const ivec3 pads = ivec3(${Wt}, ${le}, ${ye});
      const float initializationValue = ${$e};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${$e});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${Et};
            wD += ${z}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${St};
            wR += ${V}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${Cn}; wC += 4) {
              int xC = xCCorner + wC * ${at};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${at}, ch),
                getValue(batch, xD, xR, xC + 2 * ${at}, ch),
                getValue(batch, xD, xR, xC + 3 * ${at}, ch)
              );

              ${zr}
            }

            int xC = xCCorner + ${Cn};
            if (${mr===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${zr}
            } else if (${mr===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${at}, ch),
                initializationValue,
                initializationValue
              );

              ${zr}
            } else if (${mr===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${at}, ch),
                getValue(batch, xD, xR, xC + 2 * ${at}, ch),
                initializationValue
              );

              ${zr}
            }
          }
          setOutput(${Rn});
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u8(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t;Ix(u,"avgPool");const{filterSize:h,strides:p,pad:g,dimRoundingMode:b}=o,_=1;bt(Ec(p,_),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${p} and dilations '${_}'`);const z=mf(u.shape,h,p,_,g,b);if(z.filterWidth===1&&z.filterHeight===1&&Bn(z.inShape,z.outShape))return cp({inputs:{x:u},backend:n});const V=new Mx(z,"avg",!1);return n.runWebGLProgram(V,[u],"float32")}const l8={kernelName:Rr,backendName:"webgl",kernelFunc:u8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c8(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{filterSize:h,strides:p,pad:g,dimRoundingMode:b,dataFormat:_}=o,z=[1,1,1],V=Hd(u.shape,h,p,z,g,b,_),at=new lA(V,"avg",!1);return n.runWebGLProgram(at,[u],"float32")}const f8={kernelName:La,backendName:"webgl",kernelFunc:c8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h8{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterHeight,o=t.filterWidth,u=t.strideHeight,h=t.strideWidth,p=t.dilationHeight,g=t.dilationWidth,b=t.effectiveFilterHeight,_=t.effectiveFilterWidth,z=b-1-t.padInfo.top,V=_-1-t.padInfo.left,at=1/(n*o);this.userCode=`
      const ivec2 pads = ivec2(${z}, ${V});
      const float avgMultiplier = float(${at});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${b};
            wR += ${p}) {
          float dyR = float(dyRCorner + wR) / ${u}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${_};
            wC+= ${g}) {
            float dyC = float(dyCCorner + wC) / ${h}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class d8{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterDepth,o=t.filterHeight,u=t.filterWidth,h=t.strideDepth,p=t.strideHeight,g=t.strideWidth,b=t.dilationDepth,_=t.dilationHeight,z=t.dilationWidth,V=t.effectiveFilterDepth,at=t.effectiveFilterHeight,Et=t.effectiveFilterWidth,St=V-1-t.padInfo.front,Tt=at-1-t.padInfo.top,Wt=Et-1-t.padInfo.left,le=1/(n*o*u);this.userCode=`
      const ivec3 pads = ivec3(${St}, ${Tt}, ${Wt});
      const float avgMultiplier = float(${le});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${V};
            wD += ${b}) {
          float dyD = float(dyDCorner + wD) / ${h}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${at};
              wR += ${_}) {
            float dyR = float(dyRCorner + wR) / ${p}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${Et};
                wC += ${z}) {
              float dyC = float(dyCCorner + wC) / ${g}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,p=h,{filterSize:g,strides:b,pad:_,dimRoundingMode:z}=o,V=[1,1,1],at=Hd(p.shape,g,b,V,_,z),Et=new d8(at);return n.runWebGLProgram(Et,[u],p.dtype)}const v8={kernelName:ui,backendName:"webgl",kernelFunc:p8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g8(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,p=h;Ix([u,h],"avgPoolGrad");const{filterSize:g,strides:b,pad:_}=o,z=mf(p.shape,g,b,1,_),V=new h8(z);return n.runWebGLProgram(V,[u],p.dtype)}const m8={kernelName:xa,backendName:"webgl",kernelFunc:g8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y8(r){const{inputs:t,backend:n,attrs:o}=r,{a:u,b:h}=t,{transposeA:p,transposeB:g}=o;return SS({a:u,b:h,transposeA:p,transposeB:g,backend:n})}const b8={kernelName:Fi,backendName:"webgl",kernelFunc:y8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x8{constructor(t,n,o,u,h,p){this.outputShape=[],this.variableNames=["x","mean","variance"],Nr(t,n),Nr(t,o);let g="0.0";u!=null&&(Nr(t,u),this.variableNames.push("offset"),g="getOffsetAtOutCoords()");let b="1.0";h!=null&&(Nr(t,h),this.variableNames.push("scale"),b="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${g};
        float scale = ${b};
        float inv = scale * inversesqrt(variance + float(${p}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w8{constructor(t,n,o,u,h,p){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Nr(t,n),Nr(t,o);let g="vec4(0.0)";u!=null&&(Nr(t,u),this.variableNames.push("offset"),g="getOffsetAtOutCoords()");let b="vec4(1.0)";h!=null&&(Nr(t,h),this.variableNames.push("scale"),b="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${g};
        vec4 scale = ${b};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${p}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E8={kernelName:So,backendName:"webgl",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:o,mean:u,variance:h,offset:p,scale:g}=r;bt(u.shape.length===h.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),bt(p==null||u.shape.length===p.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),bt(g==null||u.shape.length===g.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:b}=n;b==null&&(b=.001);const _=[o,u,h];let z=null;p!=null&&(z=p.shape,_.push(p));let V=null;g!=null&&(V=g.shape,_.push(g));const at=He().getBool("WEBGL_PACK_NORMALIZATION")?new w8(o.shape,u.shape,h.shape,z,V,b):new x8(o.shape,u.shape,h.shape,z,V,b);return t.runWebGLProgram(at,_,_[0].dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S8{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const n=ic(this.rank),o=`uniform int start[${this.rank}];`,u=C8(this.rank);let h;const p=t.map((g,b)=>`sourceLoc.${cA[b]} = start[${b}] + coords.${cA[b]};`);h=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${p.join(`
`)}
      `,this.userCode=`
      ${o}
      void main() {
        ${h}
        setOutput(getSource(${u}));
      }
    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(n,o)=>{this.startLoc==null&&(this.startLoc=n.getUniformLocationNoThrow(o,"start"),this.startLoc==null)||n.gl.uniform1iv(this.startLoc,t)}}}const cA=["x","y","z","w","u","v"];function C8(r){if(r===1)return"sourceLoc";if(r<=6)return cA.slice(0,r).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${r} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _8{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;const n=ic(this.rank),o=cd("coords",this.rank),u=cd("sourceLoc",this.rank),h=this.rank===1?"sourceLoc":`vec2(${u.slice(-2).join()})`,p=`getChannel(getSource(${u.join()}), ${h})`,g=`
      result.x = ${p};
      if (++${o[this.rank-1]} < ${t[this.rank-1]}) {
        ++${u[this.rank-1]};
        result.y = ${p};
        --${u[this.rank-1]};
      }
    `,b=this.rank===1?"":`
      --${o[this.rank-1]};
      if (++${o[this.rank-2]} < ${t[this.rank-2]}) {
        ++${u[this.rank-2]};
        result.z = ${p};
        if (++${o[this.rank-1]} < ${t[this.rank-1]}) {
          ++${u[this.rank-1]};
          result.w = ${p};
        }
      }
    `,_=this.rank<=4?`sourceLoc = coords +
            ${n}(${t.map((z,V)=>`start[${V}]`).join()});`:t.map((z,V)=>`${u[V]} = ${o[V]} + start[${V}];`).join(`
`);this.userCode=`
      uniform int start[${this.rank}];
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${_}
        vec4 result = vec4(0.);
        ${g}
        ${b}
        setOutput(result);
      }
    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(n,o)=>{this.startLoc==null&&(this.startLoc=n.getUniformLocationNoThrow(o,"start"),this.startLoc==null)||n.gl.uniform1iv(this.startLoc,t)}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I8(r,t,n,o){const u=o.texData.get(r.dataId),h=o.makeTensorInfo(n,r.dtype),p=o.texData.get(h.dataId);Object.assign(p,u),p.complexParentRefCount=0,p.refCount=1,p.shape=n,p.dtype=r.dtype;let g=sv(t,gt(r.shape));u.slice&&(g+=u.slice.flatOffset),p.slice={flatOffset:g,origDataId:u.slice&&u.slice.origDataId||r.dataId};const b=o.dataRefCount.get(p.slice.origDataId)||1;return o.dataRefCount.set(p.slice.origDataId,b+1),h}function Nx(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{begin:h,size:p}=o,[g,b]=uv(u,h,p);if(av(u,g,b),Rt(b)===0)return n.makeTensorInfo(b,u.dtype,[]);if(n.shouldExecuteOnCPU([u])||u.dtype==="string"){const V=n.texData.get(u.dataId),at=b6(V.values,g,b,u.shape,u.dtype);return n.makeTensorInfo(b,u.dtype,at)}const{isPacked:_}=n.texData.get(u.dataId),z=_p(u.shape,g,b);if(_||!z){const V=He().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _8(b):new S8(b),at=V.getCustomSetupFunc(g);return n.runWebGLProgram(V,[u],u.dtype,at)}return n.uploadToGPU(u.dataId),I8(u,g,b,n)}const T8={kernelName:Cf,backendName:"webgl",kernelFunc:Nx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A8={kernelName:Ki,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockShape:h,crops:p}=o;bt(u.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const g=h.reduce((ye,Qe)=>ye*Qe),b=Kd(u.shape,h,g),_=od(b.length,h.length),z=y0(u.shape,h,g),V=Ay(p,h.length),at=Fg(z,p,h.length),Et=[],St=ko({inputs:{x:u},backend:n,attrs:{shape:b}}),Tt=Md({inputs:{x:St},backend:n,attrs:{perm:_}}),Wt=ko({inputs:{x:Tt},backend:n,attrs:{shape:z}}),le=Nx({inputs:{x:Wt},backend:n,attrs:{begin:V,size:at}});return Et.push(St),Et.push(Tt),Et.push(Wt),Et.forEach(ye=>n.disposeIntermediateTensorInfo(ye)),le}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M8(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,weights:h}=t,{size:p}=o,g=n.readSync(u.dataId),b=n.readSync(h.dataId),_=Ok(g,b,h.dtype,h.shape,p);return n.makeTensorInfo([p],h.dtype,_)}const N8={kernelName:xo,backendName:"webgl",kernelFunc:M8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iD=ch({opSnippet:"return float(a != b);",dtype:"bool"}),k8={kernelName:Fe,backendName:"webgl",kernelFunc:iD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kx(r){const{inputs:t,backend:n}=r,{input:o}=t,u=n.texData.get(o.dataId);return cp({inputs:{x:u.complexTensorInfos.real},backend:n})}const D8={kernelName:ho,backendName:"webgl",kernelFunc:kx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O8="return float(int(x));";function R8(r,t){const n=new Pm(r.shape,O8),o=t.runWebGLProgram(n,[r],"int32");return{dataId:o.dataId,shape:o.shape,dtype:o.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fA(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{dtype:h}=o;if(h==="complex64"){if(u.dtype==="complex64")return cp({inputs:{x:u},backend:n});const p=Uc(u.shape),g=fA({inputs:{x:u},backend:n,attrs:{dtype:"float32"}}),b=Fm({inputs:{real:g,imag:p},backend:n});return p.dispose(),n.disposeIntermediateTensorInfo(g),b}if(u.dtype==="complex64"){const p=kx({inputs:{input:u},backend:n}),g=fA({inputs:{x:p},backend:n,attrs:{dtype:h}});return n.disposeIntermediateTensorInfo(p),g}if(!Wr(u.dtype,h)){const p=cp({inputs:{x:u},backend:n});return{dataId:p.dataId,shape:p.shape,dtype:h}}if(h==="int32")return R8(u,n);if(h==="bool"){const p=n.makeTensorInfo([],"bool",sr("bool",1)),b=iD({inputs:{a:u,b:p},backend:n});return n.disposeIntermediateTensorInfo(p),b}throw new Error(`Error in Cast: failed to cast ${u.dtype} to ${h}`)}const L8={kernelName:es,backendName:"webgl",kernelFunc:fA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oD="return ceil(x);",P8=pl({opSnippet:oD,packedOpSnippet:oD,cpuKernelImpl:e6}),F8={kernelName:Wo,backendName:"webgl",kernelFunc:P8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B8{constructor(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}getCustomSetupFunc(t,n){return(o,u)=>{this.minLoc==null&&(this.minLoc=o.getUniformLocationNoThrow(u,"minVal"),this.maxLoc=o.getUniformLocationNoThrow(u,"maxVal")),o.gl.uniform1f(this.minLoc,t),o.gl.uniform1f(this.maxLoc,n)}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z8{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}getCustomSetupFunc(t,n){return(o,u)=>{this.minLoc==null&&(this.minLoc=o.getUniformLocationNoThrow(u,"minVal"),this.maxLoc=o.getUniformLocationNoThrow(u,"maxVal")),o.gl.uniform1f(this.minLoc,t),o.gl.uniform1f(this.maxLoc,n)}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $8(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{clipValueMin:h,clipValueMax:p}=o;let g;He().getBool("WEBGL_PACK_CLIP")?g=new z8(u.shape):g=new B8(u.shape);const b=g.getCustomSetupFunc(h,p);return n.runWebGLProgram(g,[u],u.dtype,b)}const G8={kernelName:Zi,backendName:"webgl",kernelFunc:$8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U8{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sD(r,t){return{dataId:t.dataId,dtype:t.dtype,shape:r.shape}}function W8(r){const{inputs:t,backend:n}=r,{x:o}=t,u=n.texData.get(o.dataId),h=new U8(o.shape),p=[sD(o,u.complexTensorInfos.real),sD(o,u.complexTensorInfos.imag)];return n.runWebGLProgram(h,p,p[0].dtype)}const V8={kernelName:gi,backendName:"webgl",kernelFunc:W8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j8{constructor(t){this.outputShape=[],this.outputShape=mv(t,1),this.variableNames=t.map((p,g)=>`T${g}`);const n=new Array(t.length-1);n[0]=t[0][1];for(let p=1;p<n.length;p++)n[p]=n[p-1]+t[p][1];const o=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let p=1;p<n.length;p++){const g=n[p-1];o.push(`else if (yC < ${n[p]}) setOutput(getT${p}(yR, yC-${g}));`)}const u=n.length,h=n[n.length-1];o.push(`else setOutput(getT${u}(yR, yC-${h}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${o.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H8{constructor(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=mv(t,n);const o=this.outputShape,u=o.length,h=ic(u),p=cd("coords",u),g=["x","y","z","w","u","v"].slice(0,u);this.variableNames=t.map((Tt,Wt)=>`T${Wt}`);const b=new Array(t.length-1);b[0]=t[0][n];for(let Tt=1;Tt<b.length;Tt++)b[Tt]=b[Tt-1]+t[Tt][n];const _=g[n],z=g.slice(-2),V=g.join();let at=`if (${_} < ${b[0]}) {
        return getChannel(
            getT0(${V}), vec2(${z.join()}));
        }`;for(let Tt=1;Tt<b.length;Tt++){const Wt=b[Tt-1];at+=`
        if (${_} < ${b[Tt]}  && ${_} >= ${b[Tt-1]}) {
          return getChannel(
            getT${Tt}(${_S(g,_,Wt)}),
            vec2(${_S(z,_,Wt)}));
        }`}const Et=b.length,St=b[b.length-1];at+=`
        return getChannel(
          getT${Et}(${_S(g,_,St)}),
          vec2(${_S(z,_,St)}));`,this.userCode=`
      float getValue(${g.map(Tt=>"int "+Tt)}) {
        ${at}
      }

      void main() {
        ${h} coords = getOutputCoords();
        vec4 result = vec4(getValue(${p}), 0., 0., 0.);

        ${p[u-1]} = ${p[u-1]} + 1;
        if (${p[u-1]} < ${o[u-1]}) {
          result.g = getValue(${p});
        }

        ${p[u-2]} = ${p[u-2]} + 1;
        if (${p[u-2]} < ${o[u-2]}) {
          result.a = getValue(${p});
        }

        ${p[u-1]} = ${p[u-1]} - 1;
        if (${p[u-2]} < ${o[u-2]} &&
            ${p[u-1]} < ${o[u-1]}) {
          result.b = getValue(${p});
        }
        setOutput(result);
      }
    `}}function _S(r,t,n){const o=r.indexOf(t);return r.map((h,p)=>p===o?`${h} - ${n}`:h).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IS(r){const{inputs:t,backend:n}=r,{input:o}=t,u=n.texData.get(o.dataId);return cp({inputs:{x:u.complexTensorInfos.imag},backend:n})}const X8={kernelName:bl,backendName:"webgl",kernelFunc:IS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1(r,t,n){const o=r[0].dtype;if(o==="complex64"){const _=r.map(St=>kx({inputs:{input:St},backend:n})),z=r.map(St=>IS({inputs:{input:St},backend:n})),V=M1(_,t,n),at=M1(z,t,n),Et=Fm({inputs:{real:V,imag:at},backend:n});return _.forEach(St=>n.disposeIntermediateTensorInfo(St)),z.forEach(St=>n.disposeIntermediateTensorInfo(St)),n.disposeIntermediateTensorInfo(V),n.disposeIntermediateTensorInfo(at),Et}if(o==="string"){const{tensors2D:_,outShape:z}=uD(r,t,n),V=_.map(Wt=>({vals:n.readSync(Wt.dataId),shape:Wt.shape})),at=_[0].shape[0]===1,Et=n6(V,z,o,at),St=mv(r.map(Wt=>Wt.shape),t),Tt=n.makeTensorInfo(St,o,Et);return _.forEach(Wt=>n.disposeIntermediateTensorInfo(Wt)),Tt}if(r.length>He().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const _=Math.floor(r.length/2),z=M1(r.slice(0,_),t,n),V=M1(r.slice(_),t,n),at=M1([z,V],t,n);return n.disposeIntermediateTensorInfo(z),n.disposeIntermediateTensorInfo(V),at}if(He().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].shape.length>1){const _=new H8(r.map(z=>z.shape),t);return n.runWebGLProgram(_,r,o)}const{tensors2D:u,outShape:h}=uD(r,t,n),p=new j8(u.map(_=>_.shape)),g=n.runWebGLProgram(p,u,o);u.forEach(_=>n.disposeIntermediateTensorInfo(_));const b=ko({inputs:{x:g},attrs:{shape:h},backend:n});return n.disposeIntermediateTensorInfo(g),b}function uD(r,t,n){const o=mv(r.map(h=>h.shape),t);return{tensors2D:r.map(h=>ko({inputs:{x:h},attrs:{shape:[-1,Rt(h.shape.slice(t))]},backend:n})),outShape:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lD(r){const{inputs:t,backend:n,attrs:o}=r,{axis:u}=o,h=Lr(u,t[0].shape)[0],p=mv(t.map(_=>_.shape),h);if(Rt(p)===0)return n.makeTensorInfo(p,t[0].dtype,[]);const g=t.filter(_=>Rt(_.shape)>0);if(g.length===1)return cp({inputs:{x:g[0]},backend:n});const b=g.map(_=>_.shape);return yb(b,h),M1(g,h,n)}const Y8={kernelName:ms,backendName:"webgl",kernelFunc:lD};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cD{constructor(t,n=!1,o=null,u=!1,h=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const p=t.padInfo.top,g=t.padInfo.left,b=t.strideHeight,_=t.strideWidth,z=t.dilationHeight,V=t.dilationWidth,at=t.filterHeight,Et=t.filterWidth,St=Math.floor(t.inChannels/4)*4,Tt=t.inChannels%4,Wt=t.dataFormat==="channelsLast",le=Wt?1:2,ye=Wt?2:3,Qe=Wt?3:1;let $e="",Xe="";o&&(u?$e=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:h?$e=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:$e=`
          float activation(float x) {
            ${o}
          }
        `,Xe="result = activation(result);");const Rn=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),h&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${$e}

      const ivec2 strides = ivec2(${b}, ${_});
      const ivec2 pads = ivec2(${p}, ${g});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${Qe}];

        ivec2 xRCCorner =
            ivec2(coords[${le}], coords[${ye}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${at}; wR++) {
          int xR = xRCorner + wR * ${z};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${Et}; wC++) {
            int xC = xCCorner + wC * ${V};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${St}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${Wt}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${Tt===1}) {

              if (${Wt}) {
                dotProd +=
                    getX(batch, xR, xC, ${St}) *
                    getW(wR, wC, ${St}, d2);
              } else {
                dotProd +=
                    getX(batch, ${St}, xR, xC) *
                    getW(wR, wC, ${St}, d2);
              }

            } else if (${Tt===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${St}, d2),
                getW(wR, wC, ${St} + 1, d2)
              );

              if (${Wt}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${St}),
                  getX(batch, xR, xC, ${St} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${St}, xR, xC),
                  getX(batch, ${St} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${Tt===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${St}, d2),
                getW(wR, wC, ${St} + 1, d2),
                getW(wR, wC, ${St} + 2, d2)
              );

              if (${Wt}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${St}),
                  getX(batch, xR, xC, ${St} + 1),
                  getX(batch, xR, xC, ${St} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${St}, xR, xC),
                  getX(batch, ${St} + 1, xR, xC),
                  getX(batch, ${St} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${Rn}
        ${Xe}
        setOutput(result);
      }
    `}}class K8{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.padInfo.front,o=t.padInfo.top,u=t.padInfo.left,h=t.strideDepth,p=t.strideHeight,g=t.strideWidth,b=t.dilationDepth,_=t.dilationHeight,z=t.dilationWidth,V=t.filterDepth,at=t.filterHeight,Et=t.filterWidth,St=Math.floor(t.inChannels/4)*4,Tt=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${h}, ${p}, ${g});
      const ivec3 pads = ivec3(${n}, ${o}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${V}; wF++) {
          int xF = xFCorner + wF * ${b};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${at}; wR++) {
            int xR = xRCorner + wR * ${_};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${Et}; wC++) {
              int xC = xCCorner + wC * ${z};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${St}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${Tt===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${St}) *
                  getW(wF, wR, wC, ${St}, d2);
              } else if (${Tt===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${St}),
                  getX(batch, xF, xR, xC, ${St} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${St}, d2),
                  getW(wF, wR, wC, ${St} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${Tt===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${St}),
                  getX(batch, xF, xR, xC, ${St} + 1),
                  getX(batch, xF, xR, xC, ${St} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${St}, d2),
                  getW(wF, wR, wC, ${St} + 1, d2),
                  getW(wF, wR, wC, ${St} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z8{constructor(t,n,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;const{filterWidth:u,inChannels:h,strideWidth:p,strideHeight:g,padInfo:b,outWidth:_,dilationWidth:z,dilationHeight:V,dataFormat:at}=o,{left:Et,top:St}=b,Tt=h*u,Wt=ld(),le=at==="channelsLast",ye=le?0:1,Qe=le?1:2;let $e="";for(let Xe=0;Xe<=1;Xe++)for(let Rn=0;Rn<=1;Rn++)$e+=`
          blockIndex = rc.y + ${Rn};
          pos = rc.x + ${Xe};

          if(blockIndex < ${t[1]} && pos < ${t[0]}) {
            offsetY = int(blockIndex / (${_})) * ${g} - ${St};
            d0 = offsetY + ${V} * (pos / ${Tt});

            if(d0 < ${n[ye]} && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), ${_}.) * ${p}. - ${Et}.);
              d1 = offsetX + ${z} * (int(mod(float(pos), ${Tt}.) / ${h}.));

              if(d1 < ${n[Qe]} && d1 >= 0) {

                ch = int(mod(float(pos), ${h}.));

                if (${le}) {
                  innerDims = vec2(d1, ch);
                  result[${Xe*2+Rn}] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${Xe*2+Rn}] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${$e}

        ${Wt.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fD({x:r,filter:t,convInfo:n,backend:o,bias:u=null,preluActivationWeights:h=null,leakyreluAlpha:p=0,activation:g=null}){const b=r.shape,_=o.texData.get(r.dataId),z=n.inChannels,V=b[0]*b[1]*b[2],at=n.outChannels,Et=n.dataFormat==="channelsLast",St=!1,Tt=!1;let Wt;const le=[],ye=(V===1||at===1)&&z>Jk,Qe=b[2]%2!=0&&!!_.isPacked;if(ye||!He().getBool("WEBGL_LAZILY_UNPACK")||!He().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!Qe){const $e=Et?b[0]*b[1]*b[2]:b[0]*b[2]*b[3],Xe=ko({inputs:{x:r},backend:o,attrs:{shape:[1,$e,n.inChannels]}}),Rn=ko({inputs:{x:t},backend:o,attrs:{shape:[1,n.inChannels,n.outChannels]}}),Cn=SS({a:Xe,b:Rn,transposeA:St,transposeB:Tt,backend:o,bias:u,activation:g,preluActivationWeights:h,leakyreluAlpha:p});Wt=ko({inputs:{x:Cn},backend:o,attrs:{shape:n.outShape}}),le.push(Xe),le.push(Rn),le.push(Cn)}else{const $e=Et?b[0]*b[1]*(b[2]+1):b[0]*b[2]*(b[3]+1),Xe={dataId:r.dataId,shape:[1,$e,n.inChannels],dtype:r.dtype},Rn=_.shape;_.shape=_.shape.slice(),_.shape[_.shape.length-2]++,bt(pS(_.shape,Xe.shape),()=>`packed reshape ${_.shape} to ${Xe.shape} isn't free`);const Cn=ko({inputs:{x:t},backend:o,attrs:{shape:[1,n.inChannels,n.outChannels]}});le.push(Cn);const mr=SS({a:Xe,b:Cn,backend:o,transposeA:St,transposeB:Tt,bias:u,activation:g,preluActivationWeights:h,leakyreluAlpha:p}),zr=o.texData.get(mr.dataId);bt(zr.isPacked,()=>"batchMatMul result is expected to be packed"),_.shape=Rn,zr.shape=n.outShape,Wt=cp({inputs:{x:mr},backend:o}),Wt.shape=n.outShape,le.push(mr)}for(const $e of le)o.disposeIntermediateTensorInfo($e);return Wt}function hD({x:r,filter:t,convInfo:n,backend:o,bias:u=null,preluActivationWeights:h=null,leakyreluAlpha:p=0,activation:g=null}){const{filterWidth:b,filterHeight:_,inChannels:z,outWidth:V,outHeight:at,dataFormat:Et}=n,St=Et==="channelsLast",Tt=b*_*z,Wt=at*V,le=[Tt,Wt],ye=!0,Qe=!1,$e=[],Xe=ko({inputs:{x:r},backend:o,attrs:{shape:r.shape.slice(1)}}),Rn=ko({inputs:{x:t},backend:o,attrs:{shape:[1,Tt,Rt(t.shape)/Tt]}});$e.push(Xe),$e.push(Rn);const Cn=new Z8(le,Xe.shape,n),mr=o.runWebGLProgram(Cn,[Xe],"float32"),zr=ko({inputs:{x:mr},backend:o,attrs:{shape:[1,le[0],le[1]]}});$e.push(mr),$e.push(zr);const ta=u!=null,Ma=h!=null,Za=g==="leakyrelu",Ka=g?wS(g,!0):null,ni=new Xk(zr.shape,Rn.shape,[1,Wt,n.outChannels],ye,Qe,ta,Ka,Ma,Za),Ua=[zr,Rn];if(u&&Ua.push(u),Ma&&Ua.push(h),Za){const yi=o.makeTensorInfo([],"float32",vf(p,"float32"));Ua.push(yi),$e.push(yi)}const Ba=o.runWebGLProgram(ni,Ua,"float32"),mi=St?[1,at,V,n.outChannels]:[1,n.outChannels,at,V],ti=ko({inputs:{x:Ba},backend:o,attrs:{shape:mi}});$e.push(Ba);for(const yi of $e)o.disposeIntermediateTensorInfo(yi);return ti}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q8(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dataFormat:b,dilations:_,dimRoundingMode:z}=o,V=hv(b),at=kc(u.shape,h.shape,p,_,g,z,!1,V);let Et;if(at.filterHeight===1&&at.filterWidth===1&&at.dilationHeight===1&&at.dilationWidth===1&&at.strideHeight===1&&at.strideWidth===1&&(at.padInfo.type==="SAME"||at.padInfo.type==="VALID"))Et=fD({x:u,filter:h,convInfo:at,backend:n});else if(He().getBool("WEBGL_CONV_IM2COL")&&u.shape[0]===1)Et=hD({x:u,filter:h,convInfo:at,backend:n});else{const Tt=new cD(at);Et=n.runWebGLProgram(Tt,[u,h],"float32")}const St=ko({inputs:{x:Et},backend:n,attrs:{shape:at.outShape}});return n.disposeIntermediateTensorInfo(Et),St}const Q8={kernelName:Do,backendName:"webgl",kernelFunc:q8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J8{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,o=t.strideWidth,u=t.padInfo.top,h=t.padInfo.left,p=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${u};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${o} - ${h};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              if (${p}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class tU{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,o=t.filterWidth,u=t.strideHeight,h=t.strideWidth,p=t.dataFormat==="channelsLast",g=n-1-t.padInfo.top,b=o-1-t.padInfo.left,_=p?1:2,z=p?2:3,V=p?3:1;this.userCode=`
      const ivec2 pads = ivec2(${g}, ${b});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${V}];

        ivec2 dyCorner = ivec2(coords[${_}], coords[${z}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${u}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${h}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${o} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${p}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class eU{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideDepth,o=t.strideHeight,u=t.strideWidth,h=t.padInfo.front,p=t.padInfo.top,g=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${h};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${o} - ${p};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${u} - ${g};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class nU{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterDepth,o=t.filterHeight,u=t.filterWidth,h=t.strideDepth,p=t.strideHeight,g=t.strideWidth,b=n-1-t.padInfo.front,_=o-1-t.padInfo.top,z=u-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${b}, ${_}, ${z});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${h}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${o}; wR++) {
            float dyR = float(dyRCorner + wR) / ${p}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${o} - 1 - wR;

            for (int wC = 0; wC < ${u}; wC++) {
              float dyC = float(dyCCorner + wC) / ${g}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${u} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,pad:g,dataFormat:b,dimRoundingMode:_,filterShape:z}=o,V=hv(b),at=kc(u.shape,z,p,1,g,_,!1,V),Et=new J8(at);return n.runWebGLProgram(Et,[u,h],"float32")}const aU={kernelName:To,backendName:"webgl",kernelFunc:rU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iU(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{inputShape:p,strides:g,pad:b,dataFormat:_,dimRoundingMode:z}=o,V=hv(_),at=kc(p,h.shape,g,1,b,z,!1,V),Et=new tU(at);return n.runWebGLProgram(Et,[u,h],"float32")}const oU={kernelName:Zs,backendName:"webgl",kernelFunc:iU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dilations:b}=o,_=Th(u.shape,h.shape,p,b,g),z=new K8(_);return n.runWebGLProgram(z,[u,h],"float32")}const uU={kernelName:Eu,backendName:"webgl",kernelFunc:sU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,pad:g,filterShape:b}=o,_=Th(u.shape,b,p,1,g),z=new eU(_);return n.runWebGLProgram(z,[u,h],"float32")}const cU={kernelName:as,backendName:"webgl",kernelFunc:lU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fU(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{pad:p,strides:g,inputShape:b}=o,_=Th(b,h.shape,g,1,p),z=new nU(_);return n.runWebGLProgram(z,[u,h],"float32")}const hU={kernelName:Rs,backendName:"webgl",kernelFunc:fU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dU=Hk+`
  return cos(x);
`,pU=pl({opSnippet:dU}),vU={kernelName:Su,backendName:"webgl",kernelFunc:pU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gU=pl({opSnippet:`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`}),mU={kernelName:fu,backendName:"webgl",kernelFunc:gU};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yU{constructor(t,n,o,u,h){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[p,g,b,_]=t,[z]=n,[V,at]=o;this.outputShape=[z,V,at,_];const Et=u==="bilinear"?1:0,[St,Tt]=[`${g-1}.0`,`${b-1}.0`],[Wt,le,ye]=V>1?[`${(g-1)/(V-1)}`,"(y2-y1) * height_ratio",`y1*${St} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${St}`],[Qe,$e,Xe]=at>1?[`${(b-1)/(at-1)}`,"(x2-x1) * width_ratio",`x1*${Tt} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${Tt}`];this.userCode=`
      const float height_ratio = float(${Wt});
      const float width_ratio = float(${Qe});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${p}) {
          return;
        }

        float height_scale = ${le};
        float width_scale = ${$e};

        float in_y = ${ye};
        if( in_y < 0.0 || in_y > ${St} ) {
          setOutput(float(${h}));
          return;
        }
        float in_x = ${Xe};
        if( in_x < 0.0 || in_x > ${Tt} ) {
          setOutput(float(${h}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${Et} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bU={kernelName:Zo,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{image:u,boxes:h,boxInd:p}=t,{cropSize:g,method:b,extrapolationValue:_}=o,z=new yU(u.shape,h.shape,g,b,_);return n.runWebGLProgram(z,[u,h,p],"float32")}};class dD{constructor(t,n,o){this.variableNames=["x"],this.outputShape=t;const u=t.length,h=n?"0.0":`getX(${pD(u,"coords")})`,p=t[t.length-1];let g="",b="";n?(g=o?`end != ${p-1}`:"end != 0",b=o?"end + 1":"end - 1"):(g=o?`end + pow2 < ${p}`:"end >= pow2",b=o?"end + pow2":"end - pow2"),this.userCode=`
      uniform float index;
      void main() {
        ${ic(u)} coords = getOutputCoords();
        int end = ${vD(u,"coords")};
        float val = ${h};
        int pow2 = int(pow(2.0, index));
        if (${g}) {
          int idx = ${b};
          ${vD(u,"coords")} = idx;
          val += getX(${pD(u,"coords")});
        }
        setOutput(val);
      }
    `}getCustomSetupFunc(t){return(n,o)=>{this.index==null&&(this.index=n.getUniformLocation(o,"index")),n.gl.uniform1f(this.index,t)}}}function pD(r,t){if(r===1)return`${t}`;if(r===2)return`${t}.x, ${t}.y`;if(r===3)return`${t}.x, ${t}.y, ${t}.z`;if(r===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw Error(`Cumulative sum for rank ${r} is not yet supported`)}function vD(r,t){if(r===1)return`${t}`;if(r===2)return`${t}.y`;if(r===3)return`${t}.z`;if(r===4)return`${t}.w`;throw Error(`Cumulative sum for rank ${r} is not yet supported`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,exclusive:p,reverse:g}=o,b=u.shape.length,_=Gc([h],b);let z=u;_!=null&&(z=Md({inputs:{x:u},backend:n,attrs:{perm:_}}));const V=Qc(1,b)[0];if(V!==b-1)throw new Error(`WebGL cumsum shader expects an inner-most axis=${u.shape.length-1} but got axis=${h}`);const at=z.shape[V];let Et=cp({inputs:{x:z},backend:n});for(let St=0;St<=Math.ceil(Math.log2(at))-1;St++){const Tt=new dD(z.shape,!1,g),Wt=Tt.getCustomSetupFunc(St),le=Et;Et=n.runWebGLProgram(Tt,[Et],Et.dtype,Wt),n.disposeIntermediateTensorInfo(le)}if(p){const St=new dD(z.shape,p,g),Tt=Et;Et=n.runWebGLProgram(St,[Et],Et.dtype),n.disposeIntermediateTensorInfo(Tt)}if(_!=null){const St=dm(_),Tt=Md({inputs:{x:Et},backend:n,attrs:{perm:St}});return n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(z),Tt}return Et}const wU={kernelName:Is,backendName:"webgl",kernelFunc:xU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,weights:h}=t,{size:p,binaryOutput:g}=o;if(u.shape.length===1){const b=n.readSync(u.dataId),_=n.readSync(h.dataId),z=Ok(b,_,h.dtype,h.shape,p);return n.makeTensorInfo([p],h.dtype,z)}else if(u.shape.length===2){const b=n.bufferSync(u),_=n.bufferSync(h),z=t6(b,_,p,g);return n.makeTensorInfo(z.shape,h.dtype,z.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${u.shape.length}.`)}const SU={kernelName:Wi,backendName:"webgl",kernelFunc:EU};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CU{constructor(t,n,o){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=o,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _U(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockSize:h,dataFormat:p}=o;bt(h>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${h}`);const g=u.shape[0],b=p==="NHWC"?u.shape[1]:u.shape[2],_=p==="NHWC"?u.shape[2]:u.shape[3],z=p==="NHWC"?u.shape[3]:u.shape[1],V=b*h,at=_*h,Et=z/(h*h),St=p==="NHWC"?[g,V,at,Et]:[g,Et,V,at],Tt=new CU(St,h,p);return n.runWebGLProgram(Tt,[u],u.dtype)}const IU={kernelName:ys,backendName:"webgl",kernelFunc:_U};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gD{constructor(t,n=!1,o=null,u=!1,h=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const p=t.inHeight,g=t.inWidth,b=t.padInfo.top,_=t.padInfo.left,z=t.strideHeight,V=t.strideWidth,at=t.dilationHeight,Et=t.dilationWidth,St=t.filterHeight,Tt=t.filterWidth,Wt=t.outChannels/t.inChannels;let le="",ye="";o&&(u?le=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:h?le=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:le=`
          float activation(float x) {
            ${o}
          }
        `,ye="result = activation(result);");const Qe=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),h&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${le}

      const ivec2 strides = ivec2(${z}, ${V});
      const ivec2 pads = ivec2(${b}, ${_});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${Wt};
        int q = d2 - d1 * ${Wt};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${St}; wR++) {
          int xR = xRCorner + wR * ${at};

          if (xR < 0 || xR >= ${p}) {
            continue;
          }

          for (int wC = 0; wC < ${Tt}; wC++) {
            int xC = xCCorner + wC * ${Et};

            if (xC < 0 || xC >= ${g}) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${Qe}
        ${ye}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mD{constructor(t,n=!1,o=null,u=!1,h=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;const p=t.inHeight,g=t.inWidth,b=t.padInfo.top,_=t.padInfo.left,z=t.strideHeight,V=t.strideWidth,at=t.dilationHeight,Et=t.dilationWidth,St=t.filterHeight,Tt=t.filterWidth,Wt=Tt;let le="int xR; int xC; int xCOffset;";for(let Xe=0;Xe<St;Xe++)for(let Rn=0;Rn<Tt;Rn++)le+=`
          vec4 xTexelR${Xe}C${Rn*2} = vec4(0.);
          vec4 wR${Xe}C${Rn} = vec4(0.);
          vec4 xR${Xe}C${Rn} = vec4(0.);`;for(let Xe=0;Xe<St;Xe++)for(let Rn=0;Rn<Wt;Rn++){const Cn=Rn*2;if(le+=`
          xR = xRCorner + ${Xe*at};
          xC = xCCorner + ${Cn*Et};
        `,V===1){if(Cn<Tt&&(_%2==1?le+=`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < ${p} && xCOffset >= 0 && xCOffset < ${g}) {
                  xTexelR${Xe}C${Cn} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= ${g}) {
                    xTexelR${Xe}C${Cn}.zw = vec2(0.);
                  }
                } else {
                  xTexelR${Xe}C${Cn} = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < ${p} && xCOffset >= 0 && xCOffset < ${g}) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= ${g}) {
                    previous.zw = vec2(0.);
                  }

                  xR${Xe}C${Cn} = vec4(previous.zw, xTexelR${Xe}C${Cn}.xy);
                } else {
                  xR${Xe}C${Cn} = vec4(0, 0, xTexelR${Xe}C${Cn}.xy);
                }
              `:le+=`
                if(xR >= 0 && xR < ${p} && xC >= 0 && xC < ${g}) {
                  xTexelR${Xe}C${Cn} = getX(batch, xR, xC, d1);
                } else {
                  xTexelR${Xe}C${Cn} = vec4(0.);
                }

                xR${Xe}C${Cn} = xTexelR${Xe}C${Cn};
              `,Cn+1<Tt)){const mr=_%2==0?ke(Et):Et;Et%2==0&&_%2==1||Et%2!=0&&_%2!=1?(le+=`
                  xCOffset = xC + ${_%2} + ${mr};

                  if(xR >= 0 && xR < ${p} &&
                    xCOffset >= 0 && xCOffset < ${g}) {
                    xTexelR${Xe}C${Cn+2} = getX(batch, xR, xCOffset, d1);
                  }
                `,Et>1&&(le+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < ${p} &&
                      xCOffset >= 0 && xCOffset < ${g}) {
                      xTexelR${Xe}C${Cn} = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR${Xe}C${Cn} = vec4(0.);
                    }
                  `),le+=`
                  xR${Xe}C${Cn+1} = vec4(
                    xTexelR${Xe}C${Cn}.zw, xTexelR${Xe}C${Cn+2}.xy);
                `):le+=`
                  xCOffset = xC + ${mr};

                  if(xR >= 0 && xR < ${p} &&
                    xCOffset >= 0 && xCOffset < ${g}) {
                    xTexelR${Xe}C${Cn+2} = getX(batch, xR, xCOffset, d1);
                  }

                  xR${Xe}C${Cn+1} = xTexelR${Xe}C${Cn+2};
                `}}else Cn<Tt&&(le+=`
              if(xR >= 0 && xR < ${p}) {
            `,_%2==1?(le+=`
                xCOffset = xC + 1 - ${V};
                if(xCOffset >= 0 && xCOffset < ${g}) {
                  xTexelR${Xe}C${Cn} = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR${Xe}C${Cn} = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < ${g}) {
                  xTexelR${Xe}C${Cn+2} = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR${Xe}C${Cn+2} = vec4(0.);
                }

                xR${Xe}C${Cn} = vec4(
                  xTexelR${Xe}C${Cn}.zw, xTexelR${Xe}C${Cn+2}.zw);
              `,Cn+1<Tt&&(le+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + ${V};
                  if(xCOffset >= 0 && xCOffset < ${g}) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR${Xe}C${Cn+1} = vec4(xTexelR${Xe}C${Cn+2}.xy, final.xy);
                `)):(le+=`
                if(xC >= 0 && xC < ${g}) {
                  xTexelR${Xe}C${Cn} = getX(batch, xR, xC, d1);
                } else {
                  xTexelR${Xe}C${Cn} = vec4(0.);
                }

                xCOffset = xC + ${V};
                if(xCOffset >= 0 && xCOffset < ${g}) {
                  xTexelR${Xe}C${Cn+2} = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR${Xe}C${Cn+2} = vec4(0.);
                }

                xR${Xe}C${Cn} = vec4(
                  xTexelR${Xe}C${Cn}.xy, xTexelR${Xe}C${Cn+2}.xy);
              `,Cn+1<Tt&&(le+=`
                  xR${Xe}C${Cn+1} = vec4(
                    xTexelR${Xe}C${Cn}.zw, xTexelR${Xe}C${Cn+2}.zw);
                `)),le+="}");Cn<Tt&&(le+=`
            vec4 wTexelR${Xe}C${Cn} = getW(${Xe}, ${Cn}, d1, q);
            wR${Xe}C${Cn} = vec4(wTexelR${Xe}C${Cn}.xz, wTexelR${Xe}C${Cn}.xz);
          `,Cn+1<Tt&&(le+=`
              vec4 wTexelR${Xe}C${Cn+1} = getW(${Xe}, ${Cn+1}, d1, q);
              wR${Xe}C${Cn+1} =
                vec4(wTexelR${Xe}C${Cn+1}.xz, wTexelR${Xe}C${Cn+1}.xz);`))}for(let Xe=0;Xe<St;Xe++)for(let Rn=0;Rn<Tt;Rn++)le+=`dotProd += xR${Xe}C${Rn} * wR${Xe}C${Rn};`;let ye="",Qe="";o&&(u?ye=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:h?ye=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:ye=`vec4 activation(vec4 x) {
          ${o}
        }`,Qe="result = activation(result);");const $e=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),h&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${ye}

      const ivec2 strides = ivec2(${z}, ${V});
      const ivec2 pads = ivec2(${b}, ${_});

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        ${le}

        vec4 result = dotProd;
        ${$e}
        ${Qe}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dilations:b,dimRoundingMode:_}=o;let z=b;z==null&&(z=[1,1]),bt(Ec(p,z),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${p} and dilations '${z}'`);const V=kc(u.shape,h.shape,p,z,g,_,!0);let at;return He().getBool("WEBGL_PACK_DEPTHWISECONV")&&V.strideWidth<=2&&V.outChannels/V.inChannels==1?at=new mD(V):at=new gD(V),n.runWebGLProgram(at,[u,h],"float32")}const AU={kernelName:is,backendName:"webgl",kernelFunc:TU};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MU{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,o=t.strideWidth,u=t.padInfo.top,h=t.padInfo.left,p=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${p} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${u};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${o} - ${h};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class NU{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,o=t.filterWidth,u=t.strideHeight,h=t.strideWidth,p=n-1-t.padInfo.top,g=o-1-t.padInfo.left,b=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${p}, ${g});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${u}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${h}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${o} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${b}; dm++) {
              int d2 = d1 * ${b} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,dy:h}=t,{strides:p,dilations:g,pad:b,dimRoundingMode:_,filterShape:z}=o,V=kc(u.shape,z,p,g,b,_,!0),at=new MU(V);return n.runWebGLProgram(at,[u,h],"float32")}const DU={kernelName:Us,backendName:"webgl",kernelFunc:kU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OU(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,filter:h}=t,{strides:p,dilations:g,pad:b,dimRoundingMode:_,inputShape:z}=o,V=kc(z,h.shape,p,g,b,_,!0),at=new NU(V);return n.runWebGLProgram(at,[u,h],"float32")}const RU={kernelName:Du,backendName:"webgl",kernelFunc:OU};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LU{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PU(r){const{inputs:t,backend:n}=r,{x:o}=t,u=[...o.shape,...o.shape],h=Rt(o.shape),p=ko({inputs:{x:o},backend:n,attrs:{shape:[h]}}),g=new LU(h),b=n.runWebGLProgram(g,[p],p.dtype),_=ko({inputs:{x:b},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(b),_}const FU={kernelName:qs,backendName:"webgl",kernelFunc:PU};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BU{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:n,inWidth:o,padInfo:u,strideHeight:h,strideWidth:p,filterHeight:g,filterWidth:b,dilationHeight:_,dilationWidth:z}=t,{top:V,left:at}=u;this.userCode=`
      const ivec2 strides = ivec2(${h}, ${p});
      const ivec2 pads = ivec2(${V}, ${at});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${g}; h++) {
          int hIn = hBeg + h * ${_};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${b}; w++) {
              int wIn = wBeg + w * ${z};

              if (wIn >= 0 && wIn < ${o}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zU(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h}=t,{strides:p,pad:g,dilations:b}=o,_=Nf(u.shape,h.shape,p,g,"NHWC",b);let z;const V=new BU(_);z=n.runWebGLProgram(V,[u,h],"float32");const at=ko({inputs:{x:z},backend:n,attrs:{shape:_.outShape}});return n.disposeIntermediateTensorInfo(z),at}const $U={kernelName:Cu,backendName:"webgl",kernelFunc:zU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GU=pl({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`}),UU={kernelName:os,backendName:"webgl",kernelFunc:GU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WU="return (b >= 1.0) ? a : a * (b + 1.0);",VU=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,jU={kernelName:Ws,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n}=r,{dy:o,y:u}=t,h=He().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ax(VU,o.shape,u.shape):new A1(WU,o.shape,u.shape);return n.runWebGLProgram(h,[o,u],o.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HU=ch({opSnippet:"return float(a == b);",packedOpSnippet:`
  return vec4(equal(a, b));
`,dtype:"bool"}),XU={kernelName:Qs,backendName:"webgl",kernelFunc:HU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YU=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${bb};
  float a1 = ${xb};
  float a2 = ${wb};
  float a3 = ${ky};
  float a4 = ${Eb};
  float a5 = ${Zd};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,KU=pl({opSnippet:YU}),ZU={kernelName:Ss,backendName:"webgl",kernelFunc:KU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yD="return exp(x);",bD=pl({opSnippet:yD,packedOpSnippet:yD,cpuKernelImpl:r6}),qU={kernelName:Qu,backendName:"webgl",kernelFunc:bD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hA(r){const{inputs:t,attrs:n,backend:o}=r,{dim:u}=n,{input:h}=t,p=h.shape.length,g=h.shape.slice();let b=u;return u<0&&(bt(-(p+1)<=u,()=>`Axis must be in the interval [${-(p+1)}, ${p}]`),b=p+u+1),g.splice(b,0,1),ko({inputs:{x:h},backend:o,attrs:{shape:g}})}const QU={kernelName:xn,backendName:"webgl",kernelFunc:hA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xD="return exp(x) - 1.0;",JU=pl({opSnippet:xD,packedOpSnippet:xD,cpuKernelImpl:a6}),tW={kernelName:Vr,backendName:"webgl",kernelFunc:JU};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wD{constructor(t,n,o){this.variableNames=["real","imag"];const u=n[1];this.outputShape=n;const h=o?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,p=o?`${u}.0`:"1.0";let g;if(t==="real")g="return real * expR - imag * expI;";else if(t==="imag")g="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${h};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${g}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${u});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${u}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${p};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ED(r,t,n){const o=n.texData.get(r.dataId),u=Rt(r.shape),h=r.shape[r.shape.length-1],p=u/h,g=ko({inputs:{x:r},backend:n,attrs:{shape:[p,h]}}),b=g.shape,_=new wD("real",b,t),z=new wD("imag",b,t),V=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:b},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:b}],at=n.runWebGLProgram(_,V,"float32"),Et=n.runWebGLProgram(z,V,"float32"),St=Fm({inputs:{real:at,imag:Et},backend:n});n.disposeIntermediateTensorInfo(at),n.disposeIntermediateTensorInfo(Et);const Tt=ko({inputs:{x:St},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(St),Tt}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eW(r){const{inputs:t,backend:n}=r,{input:o}=t;return ED(o,!1,n)}const nW={kernelName:pa,backendName:"webgl",kernelFunc:eW};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rW{constructor(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}getCustomSetupFunc(t){return(n,o)=>{this.valueLoc==null&&(this.valueLoc=n.getUniformLocationNoThrow(o,"value")),n.gl.uniform1f(this.valueLoc,t)}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dA(r){const{backend:t,attrs:n}=r,{shape:o,value:u}=n;let{dtype:h}=n;if(h=h||ua(u),h==="string"){const p=Pn(h,Rt(o));return p.fill(u),t.makeTensorInfo(o,h,p)}else{const p=new rW(o,u),g=p.getCustomSetupFunc(u);return t.runWebGLProgram(p,[],h,g)}}const aW={kernelName:Fa,backendName:"webgl",kernelFunc:dA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iW{constructor(t){this.variableNames=["Image"],this.outputShape=[];const n=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oW={kernelName:Vi,backendName:"webgl",kernelFunc:({inputs:r,backend:t})=>{const{image:n}=r,o=t,u=new iW(n.shape);return o.runWebGLProgram(u,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SD="return floor(x);",sW=pl({opSnippet:SD,packedOpSnippet:SD,cpuKernelImpl:i6}),uW={kernelName:Ao,backendName:"webgl",kernelFunc:sW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lW=ch({opSnippet:`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,packedOpSnippet:`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,dtype:"int32"}),cW={kernelName:ao,backendName:"webgl",kernelFunc:lW};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fW{constructor(t){this.variableNames=["A"];const n=ld(),[o,u]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}.0, ${o}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hW{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ld(),[o,u]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${u}.0, ${o}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dW={kernelName:ju,backendName:"webgl",kernelFunc:pW};let N1;function pW(r){const{inputs:t,backend:n,attrs:o}=r;let{pixels:u}=t;const{numChannels:h}=o,p=typeof HTMLVideoElement!="undefined"&&u instanceof HTMLVideoElement,g=typeof HTMLImageElement!="undefined"&&u instanceof HTMLImageElement,b=typeof ImageBitmap!="undefined"&&u instanceof ImageBitmap,[_,z]=p?[u.videoWidth,u.videoHeight]:[u.width,u.height],V=[z,_],at=[z,_,h];(g||p||b)&&(N1==null&&(N1=document.createElement("canvas").getContext("2d")),N1.canvas.width=_,N1.canvas.height=z,N1.drawImage(u,0,0,_,z),u=N1.canvas);const Et=n.makeTensorInfo(V,"int32");n.texData.get(Et.dataId).usage=Up.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(Et.dataId),u);const St=He().getBool("WEBGL_PACK")?new hW(at):new fW(at),Tt=n.runWebGLProgram(St,[Et],"int32");return n.disposeData(Et.dataId),Tt}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h,bias:p,preluActivationWeights:g}=t,{strides:b,pad:_,dataFormat:z,dilations:V,dimRoundingMode:at,activation:Et,leakyreluAlpha:St}=o,Tt=hv(z),Wt=kc(u.shape,h.shape,b,V,_,at,!1,Tt);let le;const ye=[];if(Wt.filterHeight===1&&Wt.filterWidth===1&&Wt.dilationHeight===1&&Wt.dilationWidth===1&&Wt.strideHeight===1&&Wt.strideWidth===1&&(Wt.padInfo.type==="SAME"||Wt.padInfo.type==="VALID"))le=fD({x:u,filter:h,convInfo:Wt,backend:n,bias:p,activation:Et,preluActivationWeights:g,leakyreluAlpha:St});else if(He().getBool("WEBGL_CONV_IM2COL")&&u.shape[0]===1)le=hD({x:u,filter:h,convInfo:Wt,backend:n,bias:p,activation:Et,preluActivationWeights:g,leakyreluAlpha:St});else{const $e=p!=null,Xe=g!=null,Rn=Et==="leakyrelu",Cn=Et?wS(Et,!1):null,mr=new cD(Wt,$e,Cn,Xe,Rn),zr=[u,h];if(p&&zr.push(p),g&&zr.push(g),Rn){const ta=n.makeTensorInfo([],"float32",vf(St,"float32"));zr.push(ta),ye.push(ta)}le=n.runWebGLProgram(mr,zr,"float32")}const Qe=ko({inputs:{x:le},backend:n,attrs:{shape:Wt.outShape}});return ye.push(le),ye.forEach($e=>n.disposeIntermediateTensorInfo($e)),Qe}const gW={kernelName:al,backendName:"webgl",kernelFunc:vW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mW(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,filter:h,bias:p,preluActivationWeights:g}=t,{strides:b,pad:_,dilations:z,dimRoundingMode:V,activation:at,leakyreluAlpha:Et}=o,St=[];let Tt=z;Tt==null&&(Tt=[1,1]),bt(Ec(b,Tt),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${b} and dilations '${Tt}'`);const Wt=kc(u.shape,h.shape,b,Tt,_,V,!0),le=He().getBool("WEBGL_PACK_DEPTHWISECONV")&&Wt.strideWidth<=2&&Wt.outChannels/Wt.inChannels==1,ye=at?wS(at,le):null,Qe=[u,h],$e=p!=null,Xe=g!=null,Rn=at==="leakyrelu";if($e&&Qe.push(p),Xe&&Qe.push(g),Rn){const zr=n.makeTensorInfo([],"float32",vf(Et,"float32"));Qe.push(zr),St.push(zr)}let Cn;le?Cn=new mD(Wt,$e,ye,Xe,Rn):Cn=new gD(Wt,$e,ye,Xe,Rn);const mr=n.runWebGLProgram(Cn,Qe,"float32");return St.forEach(zr=>n.disposeIntermediateTensorInfo(zr)),mr}const yW={kernelName:il,backendName:"webgl",kernelFunc:mW};class bW{constructor(t,n,o){this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=o;const u=ic(n.length),h=ic(o.length),p=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${this.strides});
         void main() {
          ${h} coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < ${this.sliceDim}; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * ${p};
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(r){const{inputs:t,backend:n}=r,{params:o,indices:u}=t,h=u.shape,p=h[h.length-1],[g,b,_,z]=Sh(o,u),V=ko({inputs:{x:u},backend:n,attrs:{shape:[b,p]}}),at=ko({inputs:{x:o},backend:n,attrs:{shape:[Rt(o.shape)/_,_]}}),Et=new bW(p,z,[b,_]),St=n.runWebGLProgram(Et,[at,V],at.dtype),Tt=ko({inputs:{x:St},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(V),n.disposeIntermediateTensorInfo(at),n.disposeIntermediateTensorInfo(St),Tt}const wW={kernelName:fo,backendName:"webgl",kernelFunc:xW};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EW{constructor(t,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const o=ic(this.rank),u=SW(t,2);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        setOutput(getA(${u}));
      }
    `}}function SW(r,t){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[];for(let u=0;u<r.length;u++)u===2?o.push("int(getIndices(resRC.x, resRC.z))"):o.push(`${n[u]}`);return o.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CW(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,indices:h}=t,{axis:p,batchDims:g}=o,b=Lr(p,u.shape)[0],_=bv(u,h,b,g),z=Rt(h.shape),V=[],at=ko({inputs:{x:u},backend:n,attrs:{shape:[_.batchSize,_.outerSize,_.dimSize,_.sliceSize]}}),Et=ko({inputs:{x:h},backend:n,attrs:{shape:[_.batchSize,z/_.batchSize]}});V.push(at),V.push(Et);const St=[_.batchSize,_.outerSize,z/_.batchSize,_.sliceSize];if(n.shouldExecuteOnCPU([u,h])||u.dtype==="string"){const ye=n.bufferSync(Et),Qe=n.bufferSync(at),$e=o6(Qe,ye,St);return V.forEach(Xe=>n.disposeIntermediateTensorInfo(Xe)),n.makeTensorInfo(_.outputShape,$e.dtype,$e.values)}const Tt=new EW(at.shape,St),Wt=n.runWebGLProgram(Tt,[at,Et],at.dtype);V.push(Wt);const le=ko({inputs:{x:Wt},backend:n,attrs:{shape:_.outputShape}});return V.forEach(ye=>n.disposeIntermediateTensorInfo(ye)),le}const _W={kernelName:Ts,backendName:"webgl",kernelFunc:CW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IW=ch({opSnippet:"return float(a > b);",packedOpSnippet:`
  return vec4(greaterThan(a, b));
`,cpuKernelImpl:s6,dtype:"bool"}),TW={kernelName:ou,backendName:"webgl",kernelFunc:IW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AW=ch({opSnippet:"return float(a >= b);",packedOpSnippet:`
  return vec4(greaterThanEqual(a, b));
`,dtype:"bool"}),MW={kernelName:Cs,backendName:"webgl",kernelFunc:AW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NW(r){const{inputs:t,backend:n}=r,{input:o}=t;return ED(o,!0,n)}const kW={kernelName:Tl,backendName:"webgl",kernelFunc:NW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DW=pl({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),OW={kernelName:Js,backendName:"webgl",kernelFunc:DW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RW=pl({opSnippet:"return float(isinf(x));",dtype:"bool"}),LW={kernelName:ul,backendName:"webgl",kernelFunc:RW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PW=pl({opSnippet:"return float(isnan(x));",dtype:"bool"}),FW={kernelName:Mu,backendName:"webgl",kernelFunc:PW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BW=ch({opSnippet:"return float(a < b);",packedOpSnippet:`
  return vec4(lessThan(a, b));
`,cpuKernelImpl:u6,dtype:"bool"}),zW={kernelName:Nu,backendName:"webgl",kernelFunc:BW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $W=ch({opSnippet:"return float(a <= b);",packedOpSnippet:`
  return vec4(lessThanEqual(a, b));
`,dtype:"bool"}),GW={kernelName:fs,backendName:"webgl",kernelFunc:$W};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(r){const{backend:t,attrs:n}=r,{start:o,stop:u,num:h}=n,p=l6(o,u,h);return t.makeTensorInfo([p.length],"float32",p)}const WW={kernelName:Bs,backendName:"webgl",kernelFunc:UW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VW=pl({opSnippet:`if (x < 0.0) return NAN;
  return log(x);`,packedOpSnippet:`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,cpuKernelImpl:c6}),jW={kernelName:gu,backendName:"webgl",kernelFunc:VW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HW=pl({opSnippet:"return log(1.0 + x);"}),XW={kernelName:Fu,backendName:"webgl",kernelFunc:HW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YW=ch({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,dtype:"bool"}),KW={kernelName:Wu,backendName:"webgl",kernelFunc:YW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZW=pl({opSnippet:"return float(!(x >= 1.0));"}),qW={kernelName:Ju,backendName:"webgl",kernelFunc:ZW};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QW=ch({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,dtype:"bool"}),JW={kernelName:tu,backendName:"webgl",kernelFunc:QW};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tV{constructor(t,n,o,u,h){this.variableNames=["x"],this.outputShape=[];const p=n,g=t[3]-1;this.outputShape=t;let b;const _=`float(${o}) + float(${u}) * sum`;h===.5?b=`inversesqrt(${_})`:h===1?b=`1.0/(${_})`:b=`exp(log(${_}) * float(-${h}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${p}; j <= ${p}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${g}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${b};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eV{constructor(t,n,o,u,h){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const p=n,g=t[3]-1;this.outputShape=t;let b;const _=`float(${o}) + float(${u}) * sum`;h===.5?b=`inversesqrt(${_})`:h===1?b=`1.0/(${_})`:b=`exp(log(${_}) * float(-${h}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${p};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${p}; j <= ${p}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${g}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${b};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nV={kernelName:Bl,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{depthRadius:h,bias:p,alpha:g,beta:b}=o,_=He().getBool("WEBGL_PACK_NORMALIZATION")?new eV(u.shape,h,p,g,b):new tV(u.shape,h,p,g,b);return n.runWebGLProgram(_,[u],u.dtype)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rV{constructor(t,n,o,u,h){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=o,this.alpha=u,this.beta=h,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${u}) * norm + float(${o});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${u})
                * float(${h})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${h});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aV={kernelName:vl,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{x:u,y:h,dy:p}=t,{depthRadius:g,bias:b,alpha:_,beta:z}=o,V=new rV(u.shape,g,b,_,z);return n.runWebGLProgram(V,[u,h,p],u.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iV(r,t,n,o){const u=Rt(t),p=Rt(r.shape)/u,g=ko({inputs:{x:r},attrs:{shape:[p,u]},backend:o}),b=z0(g,r.dtype,"max",o),_=ko({inputs:{x:b},attrs:{shape:n},backend:o});return o.disposeIntermediateTensorInfo(g),o.disposeIntermediateTensorInfo(b),_}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CD(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{reductionIndices:h,keepDims:p}=o,g=u.shape.length,b=Lr(h,u.shape);let _=b;const z=Gc(_,g),V=z!=null,at=n.shouldExecuteOnCPU([u]);let Et=u;if(V){if(at){const Qe=n.texData.get(Et.dataId).values,$e=new Array(g);for(let Cn=0;Cn<$e.length;Cn++)$e[Cn]=u.shape[z[Cn]];const Xe=sA(Qe,u.shape,u.dtype,z,$e);Et=n.makeTensorInfo($e,u.dtype);const Rn=n.texData.get(Et.dataId);Rn.values=Xe}else Et=ES(u,z,n);_=Qc(_.length,g)}kf("max",_,g);const[St,Tt]=uf(Et.shape,_);let Wt=St;p&&(Wt=$c(St,b));let le;if(at){const Qe=n.texData.get(Et.dataId).values,$e=f6(Qe,Rt(Tt),Wt,u.dtype);le=n.makeTensorInfo(Wt,u.dtype);const Xe=n.texData.get(le.dataId);Xe.values=$e}else le=iV(Et,Tt,Wt,n);return V&&n.disposeIntermediateTensorInfo(Et),le}const oV={kernelName:Ls,backendName:"webgl",kernelFunc:CD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sV=Gk+`
  return max(a, b);
`,uV=`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+xS+`
  return result;
`,lV=ch({opSnippet:sV,packedOpSnippet:uV,cpuKernelImpl:h6}),cV={kernelName:el,backendName:"webgl",kernelFunc:lV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fV(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t;Ix(u,"maxPool");const{filterSize:h,strides:p,pad:g,dimRoundingMode:b}=o,_=1;bt(Ec(p,_),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${p} and dilations '${_}'`);const z=mf(u.shape,h,p,_,g,b);if(z.filterWidth===1&&z.filterHeight===1&&Bn(z.inShape,z.outShape))return cp({inputs:{x:u},backend:n});const V=new Mx(z,"max",!1);return n.runWebGLProgram(V,[u],u.dtype)}const hV={kernelName:oc,backendName:"webgl",kernelFunc:fV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dV(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{filterSize:h,strides:p,pad:g,dataFormat:b,dimRoundingMode:_}=o,z=[1,1,1],V=Hd(u.shape,h,p,z,g,_,b),at=new lA(V,"max",!1);return n.runWebGLProgram(at,[u],u.dtype)}const pV={kernelName:Ic,backendName:"webgl",kernelFunc:dV};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vV{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideHeight,o=t.strideWidth,u=t.dilationHeight,h=t.effectiveFilterHeight,p=t.effectiveFilterWidth,g=h-1-t.padInfo.top,b=p-1-t.padInfo.left,_=h*p-1;this.userCode=`
      const ivec2 pads = ivec2(${g}, ${b});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h};
          wR += ${u}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${p}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${_} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${p} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class gV{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideDepth,o=t.strideHeight,u=t.strideWidth,h=t.dilationDepth,p=t.dilationHeight,g=t.dilationWidth,b=t.effectiveFilterDepth,_=t.effectiveFilterHeight,z=t.effectiveFilterWidth,V=b-1-t.padInfo.front,at=_-1-t.padInfo.top,Et=z-1-t.padInfo.left,St=b*_*z-1;this.userCode=`
      const ivec3 pads = ivec3(${V}, ${at}, ${Et});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${b};
           wD += ${h}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${_};
              wR += ${p}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${z};
                wC += ${g}) {
              float dyC = float(dyCCorner + wC) / ${u}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${St} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${_} * ${z} +
                  wR * ${z} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h}=t,p=h,{filterSize:g,strides:b,pad:_,dimRoundingMode:z}=o,V=[1,1,1],at=Hd(p.shape,g,b,V,_,z),Et=new lA(at,"max",!0),St=n.runWebGLProgram(Et,[p],p.dtype),Tt=new gV(at),Wt=n.runWebGLProgram(Tt,[u,St],p.dtype);return n.disposeIntermediateTensorInfo(St),Wt}const yV={kernelName:Se,backendName:"webgl",kernelFunc:mV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bV(r){const{inputs:t,backend:n,attrs:o}=r,{dy:u,input:h,output:p}=t,g=h;Ix([h,p],"maxPoolGrad");const{filterSize:b,strides:_,pad:z,dimRoundingMode:V}=o,at=mf(g.shape,b,_,1,z,V),Et=!0,St=new Mx(at,"max",Et),Tt=n.runWebGLProgram(St,[g],g.dtype),Wt=new vV(at),le=n.runWebGLProgram(Wt,[u,Tt],g.dtype);return n.disposeIntermediateTensorInfo(Tt),le}const xV={kernelName:Ol,backendName:"webgl",kernelFunc:bV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wV(r,t,n,o){let u=new Mx(n,"max",!1);const h=o.runWebGLProgram(u,[r],"float32");u=new Mx(n,"max",!0,!0,t);const p=o.runWebGLProgram(u,[r],"float32");return[h,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EV={kernelName:ve,backendName:"webgl",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{x:o}=r,{filterSize:u,strides:h,pad:p,includeBatchInIndex:g}=t,b=n;bt(o.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.shape.length}.`);const _=[1,1];bt(Ec(h,_),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${h} and dilations '${_}'`);const z=mf(o.shape,u,h,_,p),[V,at]=wV(o,g,z,b);return[V,at]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SV(r,t,n,o){const u=Rt(t),p=Rt(r.shape)/u,g=ko({inputs:{x:r},attrs:{shape:[p,u]},backend:o}),b=z0(g,"float32","mean",o),_=ko({inputs:{x:b},attrs:{shape:n},backend:o});return o.disposeIntermediateTensorInfo(g),o.disposeIntermediateTensorInfo(b),_}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CV={kernelName:Gt,backendName:"webgl",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{x:o}=r,{keepDims:u,axis:h}=t,p=n,g=o.shape.length,b=Lr(h,o.shape);let _=b;const z=Gc(_,g),V=z!=null,at=p.shouldExecuteOnCPU([o]),Et=[];let St=o;if(V){if(at){const $e=p.texData.get(St.dataId).values,Xe=new Array(g);for(let mr=0;mr<Xe.length;mr++)Xe[mr]=o.shape[z[mr]];const Rn=sA($e,o.shape,o.dtype,z,Xe);St=p.makeTensorInfo(Xe,o.dtype);const Cn=p.texData.get(St.dataId);Cn.values=Rn}else St=ES(o,z,p);Et.push(St),_=Qc(_.length,g)}kf("sum",_,g);const[Tt,Wt]=uf(St.shape,_);let le=Tt;u&&(le=$c(Tt,b));const ye=SV(St,Wt,le,p);for(const Qe of Et)p.disposeIntermediateTensorInfo(Qe);return ye}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _V(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o,g=u.shape.length,b=Lr(h,u.shape);let _=b;const z=Gc(_,g);let V=u;z!=null&&(V=Md({inputs:{x:u},backend:n,attrs:{perm:z}}),_=Qc(_.length,u.shape.length)),kf("min",_,g);const[at,Et]=uf(V.shape,_),St=Rt(Et),Tt=ko({inputs:{x:V},backend:n,attrs:{shape:[-1,St]}}),Wt=z0(Tt,Tt.dtype,"min",n);let le;if(p){const ye=$c(at,b);le=ko({inputs:{x:Wt},backend:n,attrs:{shape:ye}})}else le=ko({inputs:{x:Wt},backend:n,attrs:{shape:at}});return n.disposeIntermediateTensorInfo(Tt),n.disposeIntermediateTensorInfo(Wt),z!=null&&n.disposeIntermediateTensorInfo(V),le}const IV={kernelName:re,backendName:"webgl",kernelFunc:_V};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TV=Gk+`
  return min(a, b);
`,AV=`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  `+xS+`
  return result;
`,MV=ch({opSnippet:TV,packedOpSnippet:AV,cpuKernelImpl:d6}),NV={kernelName:me,backendName:"webgl",kernelFunc:MV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kV{constructor(t,n,o){this.variableNames=["x"],this.outputShape=n.map((z,V)=>z[0]+t[V]+z[1]);const u=t.length,h=ic(u),p=n.map(z=>z[0]).join(","),g=n.map((z,V)=>z[0]+t[V]).join(","),b=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,u),_=o==="reflect"?0:1;if(u===1){this.userCode=`
        int start = ${p};
        int end = ${g};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${_};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${_};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${h} start = ${h}(${p});
      ${h} end = ${h}(${g});

      void main() {
        ${h} outC = getOutputCoords();
        for (int i = 0; i < ${u}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${_};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${_};
          }
        }
        ${h} coords = outC - start;
        setOutput(getX(${b}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DV{constructor(t,n,o){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((St,Tt)=>St[0]+t[Tt]+St[1]);const u=t.length,h=ic(u),p=n.map(St=>St[0]).join(","),g=n.map((St,Tt)=>St[0]+t[Tt]).join(","),b=cd("rc",u),_=cd("source",u),z=`${b[u-1]} < ${this.outputShape[u-1]}`,V=u===1?"source":`vec2(${_.slice(-2).join()})`,at=o==="reflect"?0:1;let Et="";if(u===1){const St=`
        ${h} source = rc;
        if (source < start) {
          source = start * 2 - source - ${at};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${at};
        }
        source -= start;
      `;Et=`
        ${h} rc = outputLoc;
        ${St}
        result[0] = getChannel(getX(${_.join()}), ${V});
        ${b[u-1]} += 1;
        if(${z}) {
          ${St}
          result[1] = getChannel(getX(${_.join()}), ${V});
        }
      `}else{const St=`
        ${h} source = rc;
        ${h} lt = ${h}(lessThan(source, start));
        ${h} gte = ${h}(greaterThanEqual(source, end));
        ${h} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${at}) +
                gte * ((end - 1) * 2 - source + ${at});
        source -= start;
      `;Et=`
        ${h} rc = outputLoc;
        ${St}
        result[0] = getChannel(getX(${_.join()}), ${V});
        ${b[u-1]} += 1;
        if(${z}) {
          ${St}
          result[1] = getChannel(getX(${_.join()}), ${V});
        }
        rc = outputLoc;
        ${b[u-2]} += 1;
        if(${b[u-2]} < ${this.outputShape[u-2]}) {
          ${St}
          result[2] = getChannel(getX(${_.join()}), ${V});
          ${b[u-1]} += 1;
          if(${z}) {
            ${St}
            result[3] = getChannel(getX(${_.join()}), ${V});
          }
        }
      `}this.userCode=`
      const ${h} start = ${h}(${p});
      const ${h} end = ${h}(${g});

      void main() {
        ${h} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${Et}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OV={kernelName:bn,backendName:"webgl",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:o}=r,{paddings:u,mode:h}=n,p=He().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new DV(o.shape,u,h):new kV(o.shape,u,h);return t.runWebGLProgram(p,[o],o.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RV=`if (b == 0.0) return NAN;
  return mod(a, b);`,LV=`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  `+xS+`
  return result;
`,PV=ch({opSnippet:RV,packedOpSnippet:LV}),FV={kernelName:Zn,backendName:"webgl",kernelFunc:PV};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BV{constructor(t,n,o){this.variableNames=["probs"],this.outputShape=[t,o],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}getCustomSetupFunc(t){return(n,o)=>{this.seedLoc==null&&(this.seedLoc=n.getUniformLocation(o,"seed")),n.gl.uniform1f(this.seedLoc,t)}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _D=ch({opSnippet:`
if (a == b) {
  return 1.0;
};
return a / b;`,packedOpSnippet:`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,checkOutOfBounds:!0}),zV={kernelName:Ms,backendName:"webgl",kernelFunc:_D};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ID="return a - b;",TD=ch({opSnippet:ID,packedOpSnippet:ID,supportsComplex:!0,cpuKernelImpl:w6}),$V={kernelName:ha,backendName:"webgl",kernelFunc:TD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AD(r){const{inputs:t,backend:n,attrs:o}=r,{logits:u}=t,{dim:h}=o,p=Lr([h],u.shape),g=CD({inputs:{x:u},backend:n,attrs:{reductionIndices:p,keepDims:!1}}),b=$c(g.shape,p),_=ko({inputs:{x:g},backend:n,attrs:{shape:b}}),z=TD({inputs:{a:u,b:_},backend:n}),V=bD({inputs:{x:z},backend:n}),at=uA({inputs:{x:V},backend:n,attrs:{axis:p,keepDims:!1}}),Et=ko({inputs:{x:at},backend:n,attrs:{shape:b}}),St=_D({inputs:{a:V,b:Et},backend:n});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(z),n.disposeIntermediateTensorInfo(V),n.disposeIntermediateTensorInfo(at),n.disposeIntermediateTensorInfo(Et),St}const GV={kernelName:rr,backendName:"webgl",kernelFunc:AD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UV(r){const{inputs:t,backend:n,attrs:o}=r,{logits:u}=t,{numSamples:h,seed:p,normalized:g}=o,b=g?u:AD({inputs:{logits:u},backend:n,attrs:{dim:u.shape.length-1}}),_=b.shape[0],z=b.shape[1],V=new BV(_,z,h),at=V.getCustomSetupFunc(p),Et=n.runWebGLProgram(V,[b],"int32",at);return g||n.disposeIntermediateTensorInfo(b),Et}const WV={kernelName:Yt,backendName:"webgl",kernelFunc:UV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MD="return -x;";function VV(r){const{inputs:t,backend:n}=r,{x:o}=t;if(n.shouldExecuteOnCPU([o])){const h=n.texData.get(o.dataId),[p,g]=v6(h.values,o.shape,o.dtype);return n.makeTensorInfo(g,o.dtype,p)}let u;return He().getBool("WEBGL_PACK_UNARY_OPERATIONS")?u=new T1(o.shape,MD):u=new Pm(o.shape,MD),n.runWebGLProgram(u,[o],o.dtype)}const jV={kernelName:Ge,backendName:"webgl",kernelFunc:VV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HV=wy;function XV(r){Sm("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:b}=o,_=n.readSync(u.dataId),z=n.readSync(h.dataId),{selectedIndices:V}=HV(_,z,p,g,b);return n.makeTensorInfo([V.length],"int32",new Int32Array(V))}const YV={kernelName:In,backendName:"webgl",kernelFunc:XV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KV=Ey;function ZV(r){Sm("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:b,padToMaxOutputSize:_}=o,z=n.readSync(u.dataId),V=n.readSync(h.dataId),{selectedIndices:at,validOutputs:Et}=KV(z,V,p,g,b,_);return[n.makeTensorInfo([at.length],"int32",new Int32Array(at)),n.makeTensorInfo([],"int32",new Int32Array([Et]))]}const qV={kernelName:ar,backendName:"webgl",kernelFunc:ZV};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QV=Sy;function JV(r){Sm("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:o}=r,{boxes:u,scores:h}=t,{maxOutputSize:p,iouThreshold:g,scoreThreshold:b,softNmsSigma:_}=o,z=n.readSync(u.dataId),V=n.readSync(h.dataId),at=p,Et=g,St=b,Tt=_,{selectedIndices:Wt,selectedScores:le}=QV(z,V,at,Et,St,Tt);return[n.makeTensorInfo([Wt.length],"int32",new Int32Array(Wt)),n.makeTensorInfo([le.length],"float32",new Float32Array(le))]}const t7={kernelName:ra,backendName:"webgl",kernelFunc:JV};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e7{constructor(t,n,o,u){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${u}), float(${o}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n7={kernelName:$a,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{indices:u}=t,{depth:h,onValue:p,offValue:g}=o,b=Rt(u.shape),_=new e7(b,h,p,g),z=ko({inputs:{x:u},backend:n,attrs:{shape:[b]}}),V=n.runWebGLProgram(_,[z],u.dtype);n.disposeIntermediateTensorInfo(z);const at=[...u.shape,h],Et=ko({inputs:{x:V},backend:n,attrs:{shape:at}});return n.disposeIntermediateTensorInfo(V),Et}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TS(r){const{inputs:t,backend:n}=r,{x:o}=t;if(o.dtype==="complex64"){const u=kx({inputs:{input:o},backend:n}),h=TS({inputs:{x:u},backend:n}),p=IS({inputs:{input:o},backend:n}),g=TS({inputs:{x:p},backend:n}),b=Fm({inputs:{real:h,imag:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),b}else return dA({attrs:{shape:o.shape,dtype:o.dtype,value:o.dtype==="string"?"":0},backend:n})}const r7={kernelName:Vu,backendName:"webgl",kernelFunc:TS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ND(r){const{inputs:t,backend:n}=r,{x:o}=t;if(o.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(o.dtype==="complex64"){const u=kx({inputs:{input:o},backend:n}),h=ND({inputs:{x:u},backend:n}),p=IS({inputs:{input:o},backend:n}),g=TS({inputs:{x:p},backend:n}),b=Fm({inputs:{real:h,imag:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),b}else return dA({attrs:{shape:o.shape,dtype:o.dtype,value:1},backend:n})}const a7={kernelName:Ta,backendName:"webgl",kernelFunc:ND};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i7(r){const{inputs:t,backend:n,attrs:o}=r,{axis:u}=o;if(t.length===1)return hA({inputs:{input:t[0]},backend:n,attrs:{dim:u}});const h=t[0].shape,p=t[0].dtype;t.forEach(z=>{Me(h,z.shape,"All tensors passed to stack must have matching shapes"),bt(p===z.dtype,()=>"All tensors passed to stack must have matching dtypes")});const g=[],b=t.map(z=>{const V=hA({inputs:{input:z},backend:n,attrs:{dim:u}});return g.push(V),V}),_=lD({inputs:b,backend:n,attrs:{axis:u}});return g.forEach(z=>n.disposeIntermediateTensorInfo(z)),_}const o7={kernelName:ja,backendName:"webgl",kernelFunc:i7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s7{constructor(t,n,o){this.variableNames=["x"],this.outputShape=n.map((_,z)=>_[0]+t[z]+_[1]);const u=t.length,h=ic(u),p=n.map(_=>_[0]).join(","),g=n.map((_,z)=>_[0]+t[z]).join(","),b=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,u);if(u===1){this.userCode=`
        int start = ${p};
        int end = ${g};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(${o}));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${h} start = ${h}(${p});
      ${h} end = ${h}(${g});

      void main() {
        ${h} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(${o}));
        } else {
          ${h} coords = outC - start;
          setOutput(getX(${b}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u7{constructor(t,n,o){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((Tt,Wt)=>Tt[0]+t[Wt]+Tt[1]);const u=t.length,h=ic(u),p=n.map(Tt=>Tt[0]).join(","),g=n.map((Tt,Wt)=>Tt[0]+t[Wt]).join(","),b=cd("rc",u),_=cd("source",u),z=`${b[u-1]} < ${this.outputShape[u-1]}`,V=u===1?"source":`vec2(${_.slice(-2).join()})`,at=[`${h} rc = outputLoc;`,`${b[u-1]} += 1;
       if(${z}) {
      `,u===1?"":`}
       rc = outputLoc;
       ${b[u-2]} += 1;
       if(${b[u-2]} < ${this.outputShape[u-2]}) {`,u===1?"":`  ${b[u-1]} += 1;
         if(${z}) {`],Et=u===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let St="";for(let Tt=0,Wt=u===1?2:4;Tt<Wt;Tt++)St+=`
        ${at[Tt]}
        if (${Et}) {
          result[${Tt}] = float(${o});
        } else {
          ${h} source = rc - start;
          result[${Tt}] = getChannel(getX(${_.join()}), ${V});
        }
      `;St+=u===1?"} ":"}}",this.userCode=`
      const ${h} start = ${h}(${p});
      const ${h} end = ${h}(${g});

      void main() {
        ${h} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${St}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kD=r=>{const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{paddings:h,constantValue:p}=o,g=He().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new u7(u.shape,h,p):new s7(u.shape,h,p);return n.runWebGLProgram(g,[u],u.dtype)},l7={kernelName:Oa,backendName:"webgl",kernelFunc:kD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c7=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,f7=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  `+xS+`
  return result;
`,h7=ch({opSnippet:c7,packedOpSnippet:f7}),d7={kernelName:Ai,backendName:"webgl",kernelFunc:h7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p7(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{axis:h,keepDims:p}=o,g=u.shape.length,b=[],_=Lr(h,u.shape);let z=_;const V=Gc(z,g);let at=u;V!=null&&(at=Md({inputs:{x:u},backend:n,attrs:{perm:V}}),z=Qc(z.length,g),b.push(at)),kf("prod",z,g);let Et;if(n.shouldExecuteOnCPU([at])){const St=n.texData.get(at.dataId).values,{outVals:Tt,outShape:Wt,outDtype:le}=g6(at.shape,at.dtype,St,z);Et=n.makeTensorInfo(Wt,le,Tt)}else{const[St,Tt]=uf(at.shape,z),Wt=Rt(Tt),le=ko({inputs:{x:at},backend:n,attrs:{shape:[-1,Wt]}}),ye=$o(u.dtype),Qe=z0(le,ye,"prod",n);Et=ko({inputs:{x:Qe},backend:n,attrs:{shape:St}}),b.push(le),b.push(Qe)}if(p){b.push(Et);const St=$c(Et.shape,_);Et=ko({inputs:{x:Et},backend:n,attrs:{shape:St}})}return b.forEach(St=>n.disposeIntermediateTensorInfo(St)),Et}const v7={kernelName:hs,backendName:"webgl",kernelFunc:p7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DD=r=>{const{backend:t,attrs:n}=r,{start:o,stop:u,step:h,dtype:p}=n,g=m6(o,u,h,p);return t.makeTensorInfo([g.length],p,g)},g7={kernelName:wo,backendName:"webgl",kernelFunc:DD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m7=pl({opSnippet:"return 1.0 / x;"}),y7={kernelName:Ro,backendName:"webgl",kernelFunc:m7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b7=Tv+`
  return (x < 0.0) ? 0.0 : x;
`,x7=pl({opSnippet:b7,packedOpSnippet:`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),w7={kernelName:Ys,backendName:"webgl",kernelFunc:x7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E7=Tv+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,S7=pl({opSnippet:E7,packedOpSnippet:`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),C7={kernelName:Rl,backendName:"webgl",kernelFunc:S7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _7{constructor(t,n,o,u,h){this.variableNames=["A"],this.outputShape=[];const[p,g,b,_]=t;this.outputShape=[p,n,o,_];const z=[u&&n>1?g-1:g,u&&o>1?b-1:b],V=[u&&n>1?n-1:n,u&&o>1?o-1:o];let at;h?at="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":at="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${z[0]/V[0]},
          ${z[1]/V[1]});
      const vec2 inputShapeRC = vec2(${g}.0, ${b}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${at};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I7{constructor(t,n,o,u,h){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[p,g,b,_]=t;this.outputShape=[p,n,o,_];const z=[u&&n>1?g-1:g,u&&o>1?b-1:b],V=[u&&n>1?n-1:n,u&&o>1?o-1:o];let at;h?at="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":at="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${z[0]/V[0]},
          ${z[1]/V[1]},
          ${z[1]/V[1]});
      const vec3 inputShapeRC = vec3(${g}.0, ${b}.0,
                                     ${b}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${at};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${_-1};
        bool hasNextRow = coords.z < ${o-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7(r){const{inputs:t,backend:n,attrs:o}=r,{images:u}=t,{alignCorners:h,halfPixelCenters:p,size:g}=o,[b,_]=g,z=He().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new I7(u.shape,b,_,h,p):new _7(u.shape,b,_,h,p);return n.runWebGLProgram(z,[u],"float32")}const A7={kernelName:su,backendName:"webgl",kernelFunc:T7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M7{constructor(t,n,o){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,u,h]=n,[,p,g]=t,b=[o&&p>1?u-1:u,o&&g>1?h-1:h],_=[o&&p>1?p-1:p,o&&g>1?g-1:g],z=b[0]/_[0],V=b[1]/_[1],at=1/z,Et=1/V,St=Math.ceil(at)*2+2,Tt=Math.ceil(Et)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${z});
        const float widthScale = float(${V});

        const float invHeightScale = float(${at});
        const float invWidthScale = float(${Et});

        const int winHeight = int(${St});
        const int winWidth = int(${Tt});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${p}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${g}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${u-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${h-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N7(r){const{inputs:t,backend:n,attrs:o}=r,{images:u,dy:h}=t,{alignCorners:p}=o,g=new M7(h.shape,u.shape,p);return n.runWebGLProgram(g,[h],h.dtype)}const k7={kernelName:xl,backendName:"webgl",kernelFunc:N7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D7{constructor(t,n,o,u,h){this.variableNames=["A"],this.outputShape=[];const[p,g,b,_]=t;this.outputShape=[p,n,o,_];const z=[u&&n>1?g-1:g,u&&o>1?b-1:b],V=[u&&n>1?n-1:n,u&&o>1?o-1:o],at=u?"0.5":"0.0";let Et;h?Et="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":Et="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${z[0]/V[0]},
          ${z[1]/V[1]});
      const vec2 inputShapeRC = vec2(${g}.0, ${b}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${Et};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${at})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O7(r){const{inputs:t,backend:n,attrs:o}=r,{images:u}=t,{alignCorners:h,halfPixelCenters:p,size:g}=o,[b,_]=g,z=new D7(u.shape,b,_,h,p);return n.runWebGLProgram(z,[u],u.dtype)}const R7={kernelName:As,backendName:"webgl",kernelFunc:O7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L7{constructor(t,n,o){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,u,h]=n,[,p,g]=t,b=[o&&p>1?u-1:u,o&&g>1?h-1:h],_=[o&&p>1?p-1:p,o&&g>1?g-1:g],z=b[0]/_[0],V=b[1]/_[1],at=1/z,Et=1/V,St=Math.ceil(at)*2+2,Tt=Math.ceil(Et)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${z});
        const float widthScale = float(${V});

        const float invHeightScale = float(${at});
        const float invWidthScale = float(${Et});

        const int winHeight = int(${St});
        const int winWidth = int(${Tt});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${p}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${g}) {
              continue;
            }

            float sourceFracRow =
              float(${b[0]}) *
                (float(dyR) / float(${_[0]}));

            float sourceFracCol =
                float(${b[1]}) *
                  (float(dyC) / float(${_[1]}));

            int sourceNearestRow = int(min(
                float(int(${u}) - 1),
                ${o} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${h}) - 1),
                ${o} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P7(r){const{inputs:t,backend:n,attrs:o}=r,{images:u,dy:h}=t,{alignCorners:p}=o,g=new L7(h.shape,u.shape,p);return n.runWebGLProgram(g,[h],h.dtype)}const F7={kernelName:Vs,backendName:"webgl",kernelFunc:P7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B7{constructor(t,n){this.variableNames=["x"];const o=t.length;if(o>4)throw new Error(`WebGL backend: Reverse of rank-${o} tensor is not yet supported`);if(this.outputShape=t,o===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const u=g=>n.indexOf(g)!==-1&&t[g]!==1?`${t[g]} - coords[${g}] - 1`:`coords[${g}]`,h=t.map((g,b)=>u(b)).join(","),p=ic(o);this.userCode=`
      void main() {
        ${p} coords = getOutputCoords();
        setOutput(getX(${h}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z7{constructor(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const o=t.length;if(o>4)throw new Error(`WebGL backend: Reverse of rank-${o} tensor is not yet supported`);this.outputShape=t;const u=cd("rc",o),h=`${u[o-1]} + 1 < ${this.outputShape[o-1]}`,p=`${u[o-2]} + 1 < ${this.outputShape[o-2]}`,g=ic(o);o===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${h}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${g} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${b(u.slice())};
          if(${h}){
            result.g = ${_(u.slice())};
          }
          if(${p}) {
            result.b = ${z(u.slice())};
            if(${h}) {
              result.a = ${V(u.slice())};
            }
          }
          setOutput(result);
        }
    `;function b(St){return at(St)}function _(St){return St[o-1]="("+St[o-1]+" + 1)",at(St)}function z(St){return St[o-2]="("+St[o-2]+" + 1)",at(St)}function V(St){return St[o-1]="("+St[o-1]+" + 1)",St[o-2]="("+St[o-2]+" + 1)",at(St)}function at(St){const Tt=t.map((ye,Qe)=>Et(Qe,St)),Wt=Tt.join(","),le=Tt.slice(-2).join(",");return`getChannel(getX(${Wt}), vec2(${le}))`}function Et(St,Tt){return n.indexOf(St)!==-1&&t[St]!==1?`${t[St]} - ${Tt[St]} - 1`:`${Tt[St]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $7(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{dims:h}=o,p=u.shape.length,g=Lr(h,u.shape);if(p===0)return cp({inputs:{x:u},backend:n});const b=He().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new z7(u.shape,g):new B7(u.shape,g);return n.runWebGLProgram(b,[u],u.dtype)}const G7={kernelName:Ll,backendName:"webgl",kernelFunc:$7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U7{constructor(t,n,o,u){this.variableNames=["Image"],this.outputShape=[];const h=t[1],p=t[2],g=Math.sin(n).toFixed(3),b=Math.cos(n).toFixed(3);this.outputShape=t;const[_,z]=m0(u,h,p),V=_.toFixed(3),at=z.toFixed(3);let Et="";typeof o=="number"?Et=`float outputValue = ${o.toFixed(2)};`:Et=`
        vec3 fill = vec3(${o.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - ${V}) * ${b} - (float(y) - ${at}) * ${g};
          float coordYFloat = (float(x) - ${V}) * ${g} + (float(y) - ${at}) * ${b};
          int coordX = int(round(coordXFloat + ${V}));
          int coordY = int(round(coordYFloat + ${at}));
          ${Et}
          if(coordX >= 0 && coordX < ${p} && coordY >= 0 && coordY < ${h}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W7={kernelName:tl,backendName:"webgl",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{image:o}=r,{radians:u,fillValue:h,center:p}=t,g=n,b=new U7(o.shape,u,h,p);return g.runWebGLProgram(b,[o],o.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V7=pl({opSnippet:`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`}),j7={kernelName:nl,backendName:"webgl",kernelFunc:V7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H7=pl({opSnippet:"return inversesqrt(x);",cpuKernelImpl:y6}),X7={kernelName:rl,backendName:"webgl",kernelFunc:H7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OD{constructor(t,n,o,u,h,p,g=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=p;const b=ic(h.length),_=ic(p.length);let z="";o===1?z="i":o===2&&(z="i, j");const V=`getIndices(${z})`;let at="";u===1?at="i":u===2&&(at="i, coords[1]");const Et=`getUpdates(${at})`,St=n>1?"strides[j]":"strides";this.userCode=`
        ${b} strides = ${b}(${h});

        void main() {
          ${_} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${V});
              flattenedIndex += index * ${St};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${Et};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(r){const{inputs:t,backend:n,attrs:o}=r,{indices:u,updates:h}=t,{shape:p}=o,{sliceRank:g,numUpdates:b,sliceSize:_,strides:z,outputSize:V}=Gl(h,u,p),at=[V/_,_];if(V===0)return n.makeTensorInfo(p,u.dtype);const Et=ko({inputs:{x:u},backend:n,attrs:{shape:[b,g]}}),St=ko({inputs:{x:h},backend:n,attrs:{shape:[b,_]}}),Tt=n.makeTensorInfo([],"float32",new Float32Array([0])),Wt=new OD(b,g,Et.shape.length,St.shape.length,z,at),le=n.runWebGLProgram(Wt,[St,Et,Tt],St.dtype),ye=ko({inputs:{x:le},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(Et),n.disposeIntermediateTensorInfo(St),n.disposeIntermediateTensorInfo(le),n.disposeIntermediateTensorInfo(Tt),ye}const K7={kernelName:Ef,backendName:"webgl",kernelFunc:Y7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z7{constructor(t,n,o){this.variableNames=["c","a","b"],this.outputShape=n;let u,h;if(o>4)throw Error(`Where for rank ${o} is not yet supported`);if(o===1)h="resRC",u="resRC";else{const g=["resRC.x","resRC.y","resRC.z","resRC.w"],b=[],_=[];for(let z=0;z<n.length;z++)_.push(`${g[z]}`),z<t&&b.push(`${g[z]}`);u=b.join(),h=_.join()}const p=ic(o);this.userCode=`
      void main() {
        ${p} resRC = getOutputCoords();
        float cVal = getC(${u});
        if (cVal >= 1.0) {
          setOutput(getA(${h}));
        } else {
          setOutput(getB(${h}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7(r){const{inputs:t,backend:n}=r,{condition:o,t:u,e:h}=t,p=new Z7(o.shape.length,u.shape,u.shape.length);return n.runWebGLProgram(p,[o,u,h],uo(u.dtype,h.dtype))}const Q7={kernelName:Sf,backendName:"webgl",kernelFunc:q7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J7=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${My};
  float scale = ${Ny};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,t9=pl({opSnippet:J7}),e9={kernelName:Yl,backendName:"webgl",kernelFunc:t9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n9=pl({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),r9={kernelName:pe,backendName:"webgl",kernelFunc:n9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a9=pl({opSnippet:`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`}),i9={kernelName:Kt,backendName:"webgl",kernelFunc:a9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o9=Hk+`
  return sin(x);
`,s9=pl({opSnippet:o9}),u9={kernelName:T,backendName:"webgl",kernelFunc:s9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l9=pl({opSnippet:`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`}),c9={kernelName:rt,backendName:"webgl",kernelFunc:l9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f9=pl({opSnippet:`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`}),h9={kernelName:Re,backendName:"webgl",kernelFunc:f9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d9={kernelName:wn,backendName:"webgl",kernelFunc:r=>{const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{blockShape:h,paddings:p}=o;bt(u.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const g=h.reduce((le,ye)=>le*ye),b=[[0,0]];b.push(...p);for(let le=1+h.length;le<u.shape.length;++le)b.push([0,0]);const _=[],z=kD({inputs:{x:u},backend:n,attrs:{paddings:b,constantValue:0}}),V=Kd(z.shape,h,g,!1),at=od(V.length,h.length,!1),Et=y0(z.shape,h,g,!1),St=ko({inputs:{x:z},backend:n,attrs:{shape:V}}),Tt=Md({inputs:{x:St},backend:n,attrs:{perm:at}}),Wt=ko({inputs:{x:Tt},backend:n,attrs:{shape:Et}});return _.push(z),_.push(St),_.push(Tt),_.forEach(le=>n.disposeIntermediateTensorInfo(le)),Wt}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p9(r){const{inputs:t,backend:n,attrs:o}=r,{sparseIndices:u,sparseValues:h,defaultValue:p}=t,{outputShape:g}=o,{sliceRank:b,numUpdates:_,strides:z,outputSize:V}=Gl(h,u,g),at=!1,Et=new OD(_,b,u.shape.length,h.shape.length,z,[V,1],at),St=n.runWebGLProgram(Et,[h,u,p],h.dtype),Tt=ko({inputs:{x:St},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(St),Tt}const v9={kernelName:_r,backendName:"webgl",kernelFunc:p9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g9(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{numOrSizeSplits:h,axis:p}=o,g=Lr(p,u.shape)[0],b=Dy(u,h,g),_=u.shape.length,z=new Array(_).fill(0),V=u.shape.slice();return b.map(at=>{const Et=[...V];Et[g]=at;const St=Nx({inputs:{x:u},backend:n,attrs:{begin:z,size:Et}});return z[g]+=at,St})}const m9={kernelName:Mn,backendName:"webgl",kernelFunc:g9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y9=pl({opSnippet:"return sqrt(x);"}),b9={kernelName:Je,backendName:"webgl",kernelFunc:y9};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x9=pl({opSnippet:"return x * x;"}),w9={kernelName:ca,backendName:"webgl",kernelFunc:x9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RD="return (a - b) * (a - b);",E9=ch({opSnippet:RD,packedOpSnippet:RD}),S9={kernelName:We,backendName:"webgl",kernelFunc:E9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C9({inputs:r,attrs:t,backend:n}){const{x:o}=r,u=Tv+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,h=new Pm(o.shape,u);return n.runWebGLProgram(h,[o],o.dtype)}const _9={kernelName:Bu,backendName:"webgl",kernelFunc:C9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I9{constructor(t,n,o){this.variableNames=["x"],this.outputShape=o;const u=o.length,h=ic(o.length),p=ic(o.length);let g="";if(u===1)g="coords * strides + begin";else{let b=0;g=o.map((_,z)=>(b++,o.length===1?`coords * strides[${z}] + begin[${z}]`:`coords[${b-1}] * strides[${z}] + begin[${z}]`)).join(",")}this.userCode=`
      ${h} begin = ${h}(${t});
      ${h} strides = ${h}(${n});

      void main() {
        ${p} coords = getOutputCoords();
        setOutput(getX(${g}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T9(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{begin:h,end:p,strides:g,beginMask:b,endMask:_,ellipsisMask:z,newAxisMask:V,shrinkAxisMask:at}=o,{nonStrided:Et,$begin:St,$strides:Tt,size:Wt,newShape:le,outShape:ye}=Ip(u.shape,h,p,g,b,_,z,V,at),Qe=ko({inputs:{x:u},backend:n,attrs:{shape:le}});let $e;if(Et){const Rn=Nx({inputs:{x:Qe},backend:n,attrs:{begin:St,size:Wt}});$e=ko({inputs:{x:Rn},backend:n,attrs:{shape:ye}}),n.disposeIntermediateTensorInfo(Rn)}else if(ye.some(Rn=>Rn===0))$e=n.makeTensorInfo(ye,u.dtype,[]);else if(n.shouldExecuteOnCPU([Qe])){const mr=n.texData.get(Qe.dataId).values,zr=zs(Qe.shape,Qe.dtype,mr),ta=x6(ye,zr,Tt,St);$e=n.makeTensorInfo(ye,Qe.dtype,ta.values)}else{const Cn=new I9(St,Tt,ye);$e=n.runWebGLProgram(Cn,[Qe],Qe.dtype)}const Xe=ko({inputs:{x:$e},backend:n,attrs:{shape:ye}});return n.disposeIntermediateTensorInfo(Qe),n.disposeIntermediateTensorInfo($e),Xe}const A9={kernelName:Va,backendName:"webgl",kernelFunc:T9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M9=pl({opSnippet:"return tan(x);"}),N9={kernelName:qa,backendName:"webgl",kernelFunc:M9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k9=pl({opSnippet:`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`}),D9={kernelName:ma,backendName:"webgl",kernelFunc:k9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class O9{constructor(t,n){this.variableNames=["A"];const o=new Array(t.length);for(let p=0;p<o.length;p++)o[p]=t[p]*n[p];this.outputShape=o,this.rank=o.length;const u=ic(this.rank),h=R9(t);this.userCode=`
      void main() {
        ${u} resRC = getOutputCoords();
        setOutput(getA(${h}));
      }
    `}}function R9(r){const t=r.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${r[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],o=[];for(let u=0;u<r.length;u++)o.push(`imod(${n[u]}, ${r[u]})`);return o.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LD(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{reps:h}=o;if(u.dtype==="string"){const _=n.readSync(u.dataId).map(at=>Dt(at)),z=zs(u.shape,u.dtype,_),V=E6(z,h);return n.makeTensorInfo(V.shape,V.dtype,V.values)}const p=new O9(u.shape,h);return n.runWebGLProgram(p,[u],u.dtype)}const L9={kernelName:Mi,backendName:"webgl",kernelFunc:LD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P9(r){const{inputs:t,backend:n,attrs:o}=r,{x:u}=t,{k:h,sorted:p}=o,g=n.readSync(u.dataId),[b,_]=S6(g,u.shape,u.dtype,h,p);return[n.makeTensorInfo(b.shape,b.dtype,b.values),n.makeTensorInfo(_.shape,_.dtype,_.values)]}const F9={kernelName:zo,backendName:"webgl",kernelFunc:P9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B9(r){const{inputs:t,attrs:n,backend:o}=r,{axis:u}=n,{x:h}=t;Ix(h,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const p=o.readSync(h.dataId),{outputValues:g,outputShape:b,indices:_}=C6(p,u,h.shape,h.dtype);return[o.makeTensorInfo(b,h.dtype,g),o.makeTensorInfo([_.length],"int32",_)]}const z9={kernelName:Lo,backendName:"webgl",kernelFunc:B9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $9(r){const{inputs:t,backend:n,attrs:o}=r,{value:u}=t;let{axis:h}=o;h<0&&(h+=u.shape.length);const p=u,g=p.shape.length,b=u.shape[h],_=new Array(g-1);let z=0;for(let Tt=0;Tt<g;Tt++)Tt!==h&&(_[z++]=p.shape[Tt]);const V=[],at=new Array(g).fill(0),Et=p.shape.slice();Et[h]=1;const St=new Array(b);for(let Tt=0;Tt<St.length;Tt++){at[h]=Tt;const Wt=Nx({inputs:{x:p},backend:n,attrs:{begin:at,size:Et}}),le=ko({inputs:{x:Wt},backend:n,attrs:{shape:_}});St[Tt]=le,V.push(Wt)}return V.forEach(Tt=>n.disposeIntermediateTensorInfo(Tt)),St}const G9={kernelName:yo,backendName:"webgl",kernelFunc:$9};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U9{constructor(t,n){this.variableNames=["x","segmentIds"];const o=t.windowSize,u=t.batchSize,h=t.inSize,p=t.numSegments,g=p*Math.ceil(h/o);this.outputShape=[u,g];const b="0.0",_="sumValue",z=Math.floor(o/4)*4,V=o%4,at=`
        sumValue += dot(values, segFilter);
    `;let Et="";h%o>0&&(Et=`
        if (inIdx < 0 || inIdx >= ${h}) {
          return initializationValue;
        }
      `);let St="";h%o>0&&(St=`
        if (inIdx < 0 || inIdx >= ${h}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${b};

      float getValue(int batch, int inIdx) {
        ${Et}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${St}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${p})) * float(${o}));
        int currentSeg = int(mod(float(outIdx), float(${p})));

        float sumValue = 0.0;

        for (int i = 0; i < ${z}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${at}
        }

        int inIdx = inOffset + ${z};
        if (${V===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${at}
        } else if (${V===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${at}
        } else if (${V===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${at}
        }
        setOutput(${_});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W9(r){const{inputs:t,backend:n,attrs:o}=r,{x:u,segmentIds:h}=t,{numSegments:p}=o,g=u.shape.length,b=[];let _=0;const z=Gc([_],g);let V=u;z!=null&&(V=Md({inputs:{x:u},backend:n,attrs:{perm:z}}),b.push(V),_=Qc(1,g)[0]);const at=Ib(V.shape,_,p),Et=Rt([V.shape[_]]),St=ko({inputs:{x:V},backend:n,attrs:{shape:[-1,Et]}});b.push(St);const Tt=$o(u.dtype),Wt=($e,Xe,Rn,Cn,mr)=>{const zr=$e.shape[0],ta=$e.shape[1],Ma=_b(ta,mr),Za={windowSize:Ma,inSize:ta,batchSize:zr,numSegments:mr},Ka=new U9(Za,Xe),ni=n.compileAndRun(Ka,[$e,Rn],Cn);if(b.push(ni),ni.shape[1]===mr)return ni;const Ua=DD({backend:n,attrs:{start:0,stop:mr,step:1,dtype:"float32"}}),Ba=LD({inputs:{x:Ua},backend:n,attrs:{reps:[ta/Ma]}});return b.push(Ua),b.push(Ba),Wt(ni,Xe,Ba,Cn,mr)},le=Wt(St,"unsortedSegmentSum",h,Tt,p),ye=ko({inputs:{x:le},backend:n,attrs:{shape:at}});let Qe=ye;if(z!=null){b.push(ye);const $e=dm(z);Qe=Md({inputs:{x:Qe},backend:n,attrs:{perm:$e}})}return b.forEach($e=>n.disposeIntermediateTensorInfo($e)),Qe}const V9={kernelName:No,backendName:"webgl",kernelFunc:W9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j9=[nV,aV,EG,CG,TG,NG,DG,LG,FG,zG,WG,jG,YG,qG,a8,t8,s8,f8,l8,v8,m8,b8,E8,A8,N8,L8,F8,G8,V8,rG,Y8,aU,oU,Q8,cU,hU,uU,vU,mU,bU,wU,SU,IU,DU,RU,AU,FU,$U,UU,jU,XU,ZU,qU,QU,tW,nW,aW,oW,uW,cW,dW,gW,yW,wW,_W,TW,MW,nG,kW,X8,OW,LW,FW,iG,zW,GW,WW,XW,jW,KW,qW,JW,oV,pV,hV,yV,xV,EV,cV,CV,IV,NV,OV,FV,WV,cG,jV,YV,qV,t7,k8,n7,a7,o7,l7,d7,sG,v7,g7,D8,zV,y7,C7,w7,hG,A7,k7,R7,F7,G7,W7,j7,X7,K7,Q7,e9,r9,i9,u9,c9,T8,GV,h9,d9,v9,m9,b9,w9,S9,_9,A9,$V,bG,N9,D9,L9,F9,xG,z9,G9,V9,r7];for(const r of j9)wl(r);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//** @license See the LICENSE file. */const H9="2.8.6";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X9={"tfjs-core":qn,"tfjs-backend-cpu":FP,"tfjs-backend-webgl":tG,"tfjs-data":CN,"tfjs-layers":qg,"tfjs-converter":aN,tfjs:H9}},91220:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return tt}});var Y=$(64254);function tt(j,W){var Q=typeof Symbol!="undefined"&&j[Symbol.iterator]||j["@@iterator"];if(!Q){if(Array.isArray(j)||(Q=(0,Y.Z)(j))||W&&j&&typeof j.length=="number"){Q&&(j=Q);var Z=0,R=function(){};return{s:R,n:function(){return Z>=j.length?{done:!0}:{done:!1,value:j[Z++]}},e:function(B){throw B},f:R}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,C=!1,A;return{s:function(){Q=Q.call(j)},n:function(){var B=Q.next();return L=B.done,B},e:function(B){C=!0,A=B},f:function(){try{!L&&Q.return!=null&&Q.return()}finally{if(C)throw A}}}}},90314:function(){},10410:function(){},94635:function(){},81355:function(){},50596:function(){},66247:function(){},63252:function(){},37674:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{forceCenter:function(){return Y},forceCollide:function(){return R},forceLink:function(){return A},forceManyBody:function(){return te},forceRadial:function(){return ke},forceSimulation:function(){return Be},forceX:function(){return Ve},forceY:function(){return ee}});function Y(Ft,bt){var Me,en=1;Ft==null&&(Ft=0),bt==null&&(bt=0);function fn(){var Rt,Xn=Me.length,Bn,xr=0,dr=0;for(Rt=0;Rt<Xn;++Rt)Bn=Me[Rt],xr+=Bn.x,dr+=Bn.y;for(xr=(xr/Xn-Ft)*en,dr=(dr/Xn-bt)*en,Rt=0;Rt<Xn;++Rt)Bn=Me[Rt],Bn.x-=xr,Bn.y-=dr}return fn.initialize=function(Rt){Me=Rt},fn.x=function(Rt){return arguments.length?(Ft=+Rt,fn):Ft},fn.y=function(Rt){return arguments.length?(bt=+Rt,fn):bt},fn.strength=function(Rt){return arguments.length?(en=+Rt,fn):en},fn}var tt=$(88863);function j(Ft){return function(){return Ft}}function W(Ft){return(Ft()-.5)*1e-6}function Q(Ft){return Ft.x+Ft.vx}function Z(Ft){return Ft.y+Ft.vy}function R(Ft){var bt,Me,en,fn=1,Rt=1;typeof Ft!="function"&&(Ft=j(Ft==null?1:+Ft));function Xn(){for(var dr,Ur=bt.length,fa,Ea,aa,Da,Lr,_n,sr=0;sr<Rt;++sr)for(fa=(0,tt.Z)(bt,Q,Z).visitAfter(Bn),dr=0;dr<Ur;++dr)Ea=bt[dr],Lr=Me[Ea.index],_n=Lr*Lr,aa=Ea.x+Ea.vx,Da=Ea.y+Ea.vy,fa.visit(Pn);function Pn(tr,zn,Wr,Yr,nr){var wr=tr.data,Sr=tr.r,pr=Lr+Sr;if(wr){if(wr.index>Ea.index){var qr=aa-wr.x-wr.vx,ua=Da-wr.y-wr.vy,$r=qr*qr+ua*ua;$r<pr*pr&&(qr===0&&(qr=W(en),$r+=qr*qr),ua===0&&(ua=W(en),$r+=ua*ua),$r=(pr-($r=Math.sqrt($r)))/$r*fn,Ea.vx+=(qr*=$r)*(pr=(Sr*=Sr)/(_n+Sr)),Ea.vy+=(ua*=$r)*pr,wr.vx-=qr*(pr=1-pr),wr.vy-=ua*pr)}return}return zn>aa+pr||Yr<aa-pr||Wr>Da+pr||nr<Da-pr}}function Bn(dr){if(dr.data)return dr.r=Me[dr.data.index];for(var Ur=dr.r=0;Ur<4;++Ur)dr[Ur]&&dr[Ur].r>dr.r&&(dr.r=dr[Ur].r)}function xr(){if(!!bt){var dr,Ur=bt.length,fa;for(Me=new Array(Ur),dr=0;dr<Ur;++dr)fa=bt[dr],Me[fa.index]=+Ft(fa,dr,bt)}}return Xn.initialize=function(dr,Ur){bt=dr,en=Ur,xr()},Xn.iterations=function(dr){return arguments.length?(Rt=+dr,Xn):Rt},Xn.strength=function(dr){return arguments.length?(fn=+dr,Xn):fn},Xn.radius=function(dr){return arguments.length?(Ft=typeof dr=="function"?dr:j(+dr),xr(),Xn):Ft},Xn}function L(Ft){return Ft.index}function C(Ft,bt){var Me=Ft.get(bt);if(!Me)throw new Error("node not found: "+bt);return Me}function A(Ft){var bt=L,Me=fa,en,fn=j(30),Rt,Xn,Bn,xr,dr,Ur=1;Ft==null&&(Ft=[]);function fa(_n){return 1/Math.min(Bn[_n.source.index],Bn[_n.target.index])}function Ea(_n){for(var sr=0,Pn=Ft.length;sr<Ur;++sr)for(var tr=0,zn,Wr,Yr,nr,wr,Sr,pr;tr<Pn;++tr)zn=Ft[tr],Wr=zn.source,Yr=zn.target,nr=Yr.x+Yr.vx-Wr.x-Wr.vx||W(dr),wr=Yr.y+Yr.vy-Wr.y-Wr.vy||W(dr),Sr=Math.sqrt(nr*nr+wr*wr),Sr=(Sr-Rt[tr])/Sr*_n*en[tr],nr*=Sr,wr*=Sr,Yr.vx-=nr*(pr=xr[tr]),Yr.vy-=wr*pr,Wr.vx+=nr*(pr=1-pr),Wr.vy+=wr*pr}function aa(){if(!!Xn){var _n,sr=Xn.length,Pn=Ft.length,tr=new Map(Xn.map(function(Wr,Yr){return[bt(Wr,Yr,Xn),Wr]})),zn;for(_n=0,Bn=new Array(sr);_n<Pn;++_n)zn=Ft[_n],zn.index=_n,typeof zn.source!="object"&&(zn.source=C(tr,zn.source)),typeof zn.target!="object"&&(zn.target=C(tr,zn.target)),Bn[zn.source.index]=(Bn[zn.source.index]||0)+1,Bn[zn.target.index]=(Bn[zn.target.index]||0)+1;for(_n=0,xr=new Array(Pn);_n<Pn;++_n)zn=Ft[_n],xr[_n]=Bn[zn.source.index]/(Bn[zn.source.index]+Bn[zn.target.index]);en=new Array(Pn),Da(),Rt=new Array(Pn),Lr()}}function Da(){if(!!Xn)for(var _n=0,sr=Ft.length;_n<sr;++_n)en[_n]=+Me(Ft[_n],_n,Ft)}function Lr(){if(!!Xn)for(var _n=0,sr=Ft.length;_n<sr;++_n)Rt[_n]=+fn(Ft[_n],_n,Ft)}return Ea.initialize=function(_n,sr){Xn=_n,dr=sr,aa()},Ea.links=function(_n){return arguments.length?(Ft=_n,aa(),Ea):Ft},Ea.id=function(_n){return arguments.length?(bt=_n,Ea):bt},Ea.iterations=function(_n){return arguments.length?(Ur=+_n,Ea):Ur},Ea.strength=function(_n){return arguments.length?(Me=typeof _n=="function"?_n:j(+_n),Da(),Ea):Me},Ea.distance=function(_n){return arguments.length?(fn=typeof _n=="function"?_n:j(+_n),Lr(),Ea):fn},Ea}var N={value:function(){}};function B(){for(var Ft=0,bt=arguments.length,Me={},en;Ft<bt;++Ft){if(!(en=arguments[Ft]+"")||en in Me||/[\s.]/.test(en))throw new Error("illegal type: "+en);Me[en]=[]}return new O(Me)}function O(Ft){this._=Ft}function F(Ft,bt){return Ft.trim().split(/^|\s+/).map(function(Me){var en="",fn=Me.indexOf(".");if(fn>=0&&(en=Me.slice(fn+1),Me=Me.slice(0,fn)),Me&&!bt.hasOwnProperty(Me))throw new Error("unknown type: "+Me);return{type:Me,name:en}})}O.prototype=B.prototype={constructor:O,on:function(bt,Me){var en=this._,fn=F(bt+"",en),Rt,Xn=-1,Bn=fn.length;if(arguments.length<2){for(;++Xn<Bn;)if((Rt=(bt=fn[Xn]).type)&&(Rt=K(en[Rt],bt.name)))return Rt;return}if(Me!=null&&typeof Me!="function")throw new Error("invalid callback: "+Me);for(;++Xn<Bn;)if(Rt=(bt=fn[Xn]).type)en[Rt]=nt(en[Rt],bt.name,Me);else if(Me==null)for(Rt in en)en[Rt]=nt(en[Rt],bt.name,null);return this},copy:function(){var bt={},Me=this._;for(var en in Me)bt[en]=Me[en].slice();return new O(bt)},call:function(bt,Me){if((Rt=arguments.length-2)>0)for(var en=new Array(Rt),fn=0,Rt,Xn;fn<Rt;++fn)en[fn]=arguments[fn+2];if(!this._.hasOwnProperty(bt))throw new Error("unknown type: "+bt);for(Xn=this._[bt],fn=0,Rt=Xn.length;fn<Rt;++fn)Xn[fn].value.apply(Me,en)},apply:function(bt,Me,en){if(!this._.hasOwnProperty(bt))throw new Error("unknown type: "+bt);for(var fn=this._[bt],Rt=0,Xn=fn.length;Rt<Xn;++Rt)fn[Rt].value.apply(Me,en)}};function K(Ft,bt){for(var Me=0,en=Ft.length,fn;Me<en;++Me)if((fn=Ft[Me]).name===bt)return fn.value}function nt(Ft,bt,Me){for(var en=0,fn=Ft.length;en<fn;++en)if(Ft[en].name===bt){Ft[en]=N,Ft=Ft.slice(0,en).concat(Ft.slice(en+1));break}return Me!=null&&Ft.push({name:bt,value:Me}),Ft}var P=B,k=0,yt=0,st=0,lt=1e3,ht,mt,wt=0,ut=0,pt=0,Nt=typeof performance=="object"&&performance.now?performance:Date,Ut=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(Ft){setTimeout(Ft,17)};function ue(){return ut||(Ut(se),ut=Nt.now()+pt)}function se(){ut=0}function Le(){this._call=this._time=this._next=null}Le.prototype=Ne.prototype={constructor:Le,restart:function(Ft,bt,Me){if(typeof Ft!="function")throw new TypeError("callback is not a function");Me=(Me==null?ue():+Me)+(bt==null?0:+bt),!this._next&&mt!==this&&(mt?mt._next=this:ht=this,mt=this),this._call=Ft,this._time=Me,rn()},stop:function(){this._call&&(this._call=null,this._time=Infinity,rn())}};function Ne(Ft,bt,Me){var en=new Le;return en.restart(Ft,bt,Me),en}function we(){ue(),++k;for(var Ft=ht,bt;Ft;)(bt=ut-Ft._time)>=0&&Ft._call.call(null,bt),Ft=Ft._next;--k}function At(){ut=(wt=Nt.now())+pt,k=yt=0;try{we()}finally{k=0,de(),ut=0}}function Qt(){var Ft=Nt.now(),bt=Ft-wt;bt>lt&&(pt-=bt,wt=Ft)}function de(){for(var Ft,bt=ht,Me,en=Infinity;bt;)bt._call?(en>bt._time&&(en=bt._time),Ft=bt,bt=bt._next):(Me=bt._next,bt._next=null,bt=Ft?Ft._next=Me:ht=Me);mt=Ft,rn(en)}function rn(Ft){if(!k){yt&&(yt=clearTimeout(yt));var bt=Ft-ut;bt>24?(Ft<Infinity&&(yt=setTimeout(At,Ft-Nt.now()-pt)),st&&(st=clearInterval(st))):(st||(wt=Nt.now(),st=setInterval(Qt,lt)),k=1,Ut(At))}}var Ee=1664525,ce=1013904223,Oe=4294967296;function Ze(){var Ft=1;return function(){return(Ft=(Ee*Ft+ce)%Oe)/Oe}}function fe(Ft){return Ft.x}function Ae(Ft){return Ft.y}var Ye=10,ge=Math.PI*(3-Math.sqrt(5));function Be(Ft){var bt,Me=1,en=.001,fn=1-Math.pow(en,1/300),Rt=0,Xn=.6,Bn=new Map,xr=Ne(fa),dr=P("tick","end"),Ur=Ze();Ft==null&&(Ft=[]);function fa(){Ea(),dr.call("tick",bt),Me<en&&(xr.stop(),dr.call("end",bt))}function Ea(Lr){var _n,sr=Ft.length,Pn;Lr===void 0&&(Lr=1);for(var tr=0;tr<Lr;++tr)for(Me+=(Rt-Me)*fn,Bn.forEach(function(zn){zn(Me)}),_n=0;_n<sr;++_n)Pn=Ft[_n],Pn.fx==null?Pn.x+=Pn.vx*=Xn:(Pn.x=Pn.fx,Pn.vx=0),Pn.fy==null?Pn.y+=Pn.vy*=Xn:(Pn.y=Pn.fy,Pn.vy=0);return bt}function aa(){for(var Lr=0,_n=Ft.length,sr;Lr<_n;++Lr){if(sr=Ft[Lr],sr.index=Lr,sr.fx!=null&&(sr.x=sr.fx),sr.fy!=null&&(sr.y=sr.fy),isNaN(sr.x)||isNaN(sr.y)){var Pn=Ye*Math.sqrt(.5+Lr),tr=Lr*ge;sr.x=Pn*Math.cos(tr),sr.y=Pn*Math.sin(tr)}(isNaN(sr.vx)||isNaN(sr.vy))&&(sr.vx=sr.vy=0)}}function Da(Lr){return Lr.initialize&&Lr.initialize(Ft,Ur),Lr}return aa(),bt={tick:Ea,restart:function(){return xr.restart(fa),bt},stop:function(){return xr.stop(),bt},nodes:function(_n){return arguments.length?(Ft=_n,aa(),Bn.forEach(Da),bt):Ft},alpha:function(_n){return arguments.length?(Me=+_n,bt):Me},alphaMin:function(_n){return arguments.length?(en=+_n,bt):en},alphaDecay:function(_n){return arguments.length?(fn=+_n,bt):+fn},alphaTarget:function(_n){return arguments.length?(Rt=+_n,bt):Rt},velocityDecay:function(_n){return arguments.length?(Xn=1-_n,bt):1-Xn},randomSource:function(_n){return arguments.length?(Ur=_n,Bn.forEach(Da),bt):Ur},force:function(_n,sr){return arguments.length>1?(sr==null?Bn.delete(_n):Bn.set(_n,Da(sr)),bt):Bn.get(_n)},find:function(_n,sr,Pn){var tr=0,zn=Ft.length,Wr,Yr,nr,wr,Sr;for(Pn==null?Pn=Infinity:Pn*=Pn,tr=0;tr<zn;++tr)wr=Ft[tr],Wr=_n-wr.x,Yr=sr-wr.y,nr=Wr*Wr+Yr*Yr,nr<Pn&&(Sr=wr,Pn=nr);return Sr},on:function(_n,sr){return arguments.length>1?(dr.on(_n,sr),bt):dr.on(_n)}}}function te(){var Ft,bt,Me,en,fn=j(-30),Rt,Xn=1,Bn=Infinity,xr=.81;function dr(aa){var Da,Lr=Ft.length,_n=(0,tt.Z)(Ft,fe,Ae).visitAfter(fa);for(en=aa,Da=0;Da<Lr;++Da)bt=Ft[Da],_n.visit(Ea)}function Ur(){if(!!Ft){var aa,Da=Ft.length,Lr;for(Rt=new Array(Da),aa=0;aa<Da;++aa)Lr=Ft[aa],Rt[Lr.index]=+fn(Lr,aa,Ft)}}function fa(aa){var Da=0,Lr,_n,sr=0,Pn,tr,zn;if(aa.length){for(Pn=tr=zn=0;zn<4;++zn)(Lr=aa[zn])&&(_n=Math.abs(Lr.value))&&(Da+=Lr.value,sr+=_n,Pn+=_n*Lr.x,tr+=_n*Lr.y);aa.x=Pn/sr,aa.y=tr/sr}else{Lr=aa,Lr.x=Lr.data.x,Lr.y=Lr.data.y;do Da+=Rt[Lr.data.index];while(Lr=Lr.next)}aa.value=Da}function Ea(aa,Da,Lr,_n){if(!aa.value)return!0;var sr=aa.x-bt.x,Pn=aa.y-bt.y,tr=_n-Da,zn=sr*sr+Pn*Pn;if(tr*tr/xr<zn)return zn<Bn&&(sr===0&&(sr=W(Me),zn+=sr*sr),Pn===0&&(Pn=W(Me),zn+=Pn*Pn),zn<Xn&&(zn=Math.sqrt(Xn*zn)),bt.vx+=sr*aa.value*en/zn,bt.vy+=Pn*aa.value*en/zn),!0;if(aa.length||zn>=Bn)return;(aa.data!==bt||aa.next)&&(sr===0&&(sr=W(Me),zn+=sr*sr),Pn===0&&(Pn=W(Me),zn+=Pn*Pn),zn<Xn&&(zn=Math.sqrt(Xn*zn)));do aa.data!==bt&&(tr=Rt[aa.data.index]*en/zn,bt.vx+=sr*tr,bt.vy+=Pn*tr);while(aa=aa.next)}return dr.initialize=function(aa,Da){Ft=aa,Me=Da,Ur()},dr.strength=function(aa){return arguments.length?(fn=typeof aa=="function"?aa:j(+aa),Ur(),dr):fn},dr.distanceMin=function(aa){return arguments.length?(Xn=aa*aa,dr):Math.sqrt(Xn)},dr.distanceMax=function(aa){return arguments.length?(Bn=aa*aa,dr):Math.sqrt(Bn)},dr.theta=function(aa){return arguments.length?(xr=aa*aa,dr):Math.sqrt(xr)},dr}function ke(Ft,bt,Me){var en,fn=j(.1),Rt,Xn;typeof Ft!="function"&&(Ft=j(+Ft)),bt==null&&(bt=0),Me==null&&(Me=0);function Bn(dr){for(var Ur=0,fa=en.length;Ur<fa;++Ur){var Ea=en[Ur],aa=Ea.x-bt||1e-6,Da=Ea.y-Me||1e-6,Lr=Math.sqrt(aa*aa+Da*Da),_n=(Xn[Ur]-Lr)*Rt[Ur]*dr/Lr;Ea.vx+=aa*_n,Ea.vy+=Da*_n}}function xr(){if(!!en){var dr,Ur=en.length;for(Rt=new Array(Ur),Xn=new Array(Ur),dr=0;dr<Ur;++dr)Xn[dr]=+Ft(en[dr],dr,en),Rt[dr]=isNaN(Xn[dr])?0:+fn(en[dr],dr,en)}}return Bn.initialize=function(dr){en=dr,xr()},Bn.strength=function(dr){return arguments.length?(fn=typeof dr=="function"?dr:j(+dr),xr(),Bn):fn},Bn.radius=function(dr){return arguments.length?(Ft=typeof dr=="function"?dr:j(+dr),xr(),Bn):Ft},Bn.x=function(dr){return arguments.length?(bt=+dr,Bn):bt},Bn.y=function(dr){return arguments.length?(Me=+dr,Bn):Me},Bn}function Ve(Ft){var bt=j(.1),Me,en,fn;typeof Ft!="function"&&(Ft=j(Ft==null?0:+Ft));function Rt(Bn){for(var xr=0,dr=Me.length,Ur;xr<dr;++xr)Ur=Me[xr],Ur.vx+=(fn[xr]-Ur.x)*en[xr]*Bn}function Xn(){if(!!Me){var Bn,xr=Me.length;for(en=new Array(xr),fn=new Array(xr),Bn=0;Bn<xr;++Bn)en[Bn]=isNaN(fn[Bn]=+Ft(Me[Bn],Bn,Me))?0:+bt(Me[Bn],Bn,Me)}}return Rt.initialize=function(Bn){Me=Bn,Xn()},Rt.strength=function(Bn){return arguments.length?(bt=typeof Bn=="function"?Bn:j(+Bn),Xn(),Rt):bt},Rt.x=function(Bn){return arguments.length?(Ft=typeof Bn=="function"?Bn:j(+Bn),Xn(),Rt):Ft},Rt}function ee(Ft){var bt=j(.1),Me,en,fn;typeof Ft!="function"&&(Ft=j(Ft==null?0:+Ft));function Rt(Bn){for(var xr=0,dr=Me.length,Ur;xr<dr;++xr)Ur=Me[xr],Ur.vy+=(fn[xr]-Ur.y)*en[xr]*Bn}function Xn(){if(!!Me){var Bn,xr=Me.length;for(en=new Array(xr),fn=new Array(xr),Bn=0;Bn<xr;++Bn)en[Bn]=isNaN(fn[Bn]=+Ft(Me[Bn],Bn,Me))?0:+bt(Me[Bn],Bn,Me)}}return Rt.initialize=function(Bn){Me=Bn,Xn()},Rt.strength=function(Bn){return arguments.length?(bt=typeof Bn=="function"?Bn:j(+Bn),Xn(),Rt):bt},Rt.y=function(Bn){return arguments.length?(Ft=typeof Bn=="function"?Bn:j(+Bn),Xn(),Rt):Ft},Rt}},52710:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{AbstractMatrix:function(){return te},CHO:function(){return Dn},CholeskyDecomposition:function(){return Dn},EVD:function(){return pr},EigenvalueDecomposition:function(){return pr},LU:function(){return aa},LuDecomposition:function(){return aa},Matrix:function(){return ee},MatrixColumnSelectionView:function(){return Me},MatrixColumnView:function(){return bt},MatrixFlipColumnView:function(){return en},MatrixFlipRowView:function(){return fn},MatrixRowSelectionView:function(){return Xn},MatrixRowView:function(){return Rt},MatrixSelectionView:function(){return Bn},MatrixSubView:function(){return xr},MatrixTransposeView:function(){return dr},NIPALS:function(){return un},Nipals:function(){return un},QR:function(){return Lr},QrDecomposition:function(){return Lr},SVD:function(){return _n},SingularValueDecomposition:function(){return _n},WrapperMatrix1D:function(){return Ur},WrapperMatrix2D:function(){return fa},correlation:function(){return Sr},covariance:function(){return wr},default:function(){return ee},determinant:function(){return tr},inverse:function(){return sr},linearDependencies:function(){return Yr},pseudoInverse:function(){return nr},solve:function(){return Pn},wrap:function(){return Ea}});var Y=$(32926),tt=$(81306),j=$(59206),W=$(69610),Q=$(54941);const Z=Object.prototype.toString;function R(Lt){const Ot=Z.call(Lt);return Ot.endsWith("Array]")&&!Ot.includes("Big")}function L(Lt){var Ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!R(Lt))throw new TypeError("input must be an array");if(Lt.length===0)throw new TypeError("input must not be empty");var it=Ot.fromIndex,H=it===void 0?0:it,X=Ot.toIndex,xt=X===void 0?Lt.length:X;if(H<0||H>=Lt.length||!Number.isInteger(H))throw new Error("fromIndex must be a positive integer smaller than length");if(xt<=H||xt>Lt.length||!Number.isInteger(xt))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var zt=Lt[H],Vt=H+1;Vt<xt;Vt++)Lt[Vt]>zt&&(zt=Lt[Vt]);return zt}function C(Lt){var Ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!R(Lt))throw new TypeError("input must be an array");if(Lt.length===0)throw new TypeError("input must not be empty");var it=Ot.fromIndex,H=it===void 0?0:it,X=Ot.toIndex,xt=X===void 0?Lt.length:X;if(H<0||H>=Lt.length||!Number.isInteger(H))throw new Error("fromIndex must be a positive integer smaller than length");if(xt<=H||xt>Lt.length||!Number.isInteger(xt))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var zt=Lt[H],Vt=H+1;Vt<xt;Vt++)Lt[Vt]<zt&&(zt=Lt[Vt]);return zt}function A(Lt){var Ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(R(Lt)){if(Lt.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var it;if(Ot.output!==void 0){if(!R(Ot.output))throw new TypeError("output option must be an array if specified");it=Ot.output}else it=new Array(Lt.length);var H=C(Lt),X=L(Lt);if(H===X)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var xt=Ot.min,zt=xt===void 0?Ot.autoMinMax?H:0:xt,Vt=Ot.max,Xt=Vt===void 0?Ot.autoMinMax?X:1:Vt;if(zt>=Xt)throw new RangeError("min option must be smaller than max option");for(var ne=(Xt-zt)/(X-H),on=0;on<Lt.length;on++)it[on]=(Lt[on]-H)*ne+zt;return it}var N=" ".repeat(2),B=" ".repeat(4);function O(){return F(this)}function F(Lt){var Ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},it=Ot.maxRows,H=it===void 0?15:it,X=Ot.maxColumns,xt=X===void 0?10:X,zt=Ot.maxNumSize,Vt=zt===void 0?8:zt,Xt=Ot.padMinus,ne=Xt===void 0?"auto":Xt;return"".concat(Lt.constructor.name,` {
`).concat(N,`[
`).concat(B).concat(K(Lt,H,xt,Vt,ne),`
`).concat(N,`]
`).concat(N,"rows: ").concat(Lt.rows,`
`).concat(N,"columns: ").concat(Lt.columns,`
}`)}function K(Lt,Ot,it,H,X){var xt=Lt.rows,zt=Lt.columns,Vt=Math.min(xt,Ot),Xt=Math.min(zt,it),ne=[];if(X==="auto"){X=!1;t:for(var on=0;on<Vt;on++)for(var tn=0;tn<Xt;tn++)if(Lt.get(on,tn)<0){X=!0;break t}}for(var He=0;He<Vt;He++){for(var Qn=[],Ln=0;Ln<Xt;Ln++)Qn.push(nt(Lt.get(He,Ln),H,X));ne.push("".concat(Qn.join(" ")))}return Xt!==zt&&(ne[ne.length-1]+=" ... ".concat(zt-it," more columns")),Vt!==xt&&ne.push("... ".concat(xt-Ot," more rows")),ne.join(`
`.concat(B))}function nt(Lt,Ot,it){return(Lt>=0&&it?" ".concat(P(Lt,Ot-1)):P(Lt,Ot)).padEnd(Ot)}function P(Lt,Ot){var it=Lt.toString();if(it.length<=Ot)return it;var H=Lt.toFixed(Ot);if(H.length>Ot&&(H=Lt.toFixed(Math.max(0,Ot-(H.length-Ot)))),H.length<=Ot&&!H.startsWith("0.000")&&!H.startsWith("-0.000"))return H;var X=Lt.toExponential(Ot);return X.length>Ot&&(X=Lt.toExponential(Math.max(0,Ot-(X.length-Ot)))),X.slice(0)}function k(Lt,Ot){Lt.prototype.add=function(H){return typeof H=="number"?this.addS(H):this.addM(H)},Lt.prototype.addS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)+H);return this},Lt.prototype.addM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)+H.get(X,xt));return this},Lt.add=function(H,X){var xt=new Ot(H);return xt.add(X)},Lt.prototype.sub=function(H){return typeof H=="number"?this.subS(H):this.subM(H)},Lt.prototype.subS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)-H);return this},Lt.prototype.subM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)-H.get(X,xt));return this},Lt.sub=function(H,X){var xt=new Ot(H);return xt.sub(X)},Lt.prototype.subtract=Lt.prototype.sub,Lt.prototype.subtractS=Lt.prototype.subS,Lt.prototype.subtractM=Lt.prototype.subM,Lt.subtract=Lt.sub,Lt.prototype.mul=function(H){return typeof H=="number"?this.mulS(H):this.mulM(H)},Lt.prototype.mulS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)*H);return this},Lt.prototype.mulM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)*H.get(X,xt));return this},Lt.mul=function(H,X){var xt=new Ot(H);return xt.mul(X)},Lt.prototype.multiply=Lt.prototype.mul,Lt.prototype.multiplyS=Lt.prototype.mulS,Lt.prototype.multiplyM=Lt.prototype.mulM,Lt.multiply=Lt.mul,Lt.prototype.div=function(H){return typeof H=="number"?this.divS(H):this.divM(H)},Lt.prototype.divS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)/H);return this},Lt.prototype.divM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)/H.get(X,xt));return this},Lt.div=function(H,X){var xt=new Ot(H);return xt.div(X)},Lt.prototype.divide=Lt.prototype.div,Lt.prototype.divideS=Lt.prototype.divS,Lt.prototype.divideM=Lt.prototype.divM,Lt.divide=Lt.div,Lt.prototype.mod=function(H){return typeof H=="number"?this.modS(H):this.modM(H)},Lt.prototype.modS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)%H);return this},Lt.prototype.modM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)%H.get(X,xt));return this},Lt.mod=function(H,X){var xt=new Ot(H);return xt.mod(X)},Lt.prototype.modulus=Lt.prototype.mod,Lt.prototype.modulusS=Lt.prototype.modS,Lt.prototype.modulusM=Lt.prototype.modM,Lt.modulus=Lt.mod,Lt.prototype.and=function(H){return typeof H=="number"?this.andS(H):this.andM(H)},Lt.prototype.andS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)&H);return this},Lt.prototype.andM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)&H.get(X,xt));return this},Lt.and=function(H,X){var xt=new Ot(H);return xt.and(X)},Lt.prototype.or=function(H){return typeof H=="number"?this.orS(H):this.orM(H)},Lt.prototype.orS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)|H);return this},Lt.prototype.orM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)|H.get(X,xt));return this},Lt.or=function(H,X){var xt=new Ot(H);return xt.or(X)},Lt.prototype.xor=function(H){return typeof H=="number"?this.xorS(H):this.xorM(H)},Lt.prototype.xorS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)^H);return this},Lt.prototype.xorM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)^H.get(X,xt));return this},Lt.xor=function(H,X){var xt=new Ot(H);return xt.xor(X)},Lt.prototype.leftShift=function(H){return typeof H=="number"?this.leftShiftS(H):this.leftShiftM(H)},Lt.prototype.leftShiftS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)<<H);return this},Lt.prototype.leftShiftM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)<<H.get(X,xt));return this},Lt.leftShift=function(H,X){var xt=new Ot(H);return xt.leftShift(X)},Lt.prototype.signPropagatingRightShift=function(H){return typeof H=="number"?this.signPropagatingRightShiftS(H):this.signPropagatingRightShiftM(H)},Lt.prototype.signPropagatingRightShiftS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)>>H);return this},Lt.prototype.signPropagatingRightShiftM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)>>H.get(X,xt));return this},Lt.signPropagatingRightShift=function(H,X){var xt=new Ot(H);return xt.signPropagatingRightShift(X)},Lt.prototype.rightShift=function(H){return typeof H=="number"?this.rightShiftS(H):this.rightShiftM(H)},Lt.prototype.rightShiftS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)>>>H);return this},Lt.prototype.rightShiftM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,this.get(X,xt)>>>H.get(X,xt));return this},Lt.rightShift=function(H,X){var xt=new Ot(H);return xt.rightShift(X)},Lt.prototype.zeroFillRightShift=Lt.prototype.rightShift,Lt.prototype.zeroFillRightShiftS=Lt.prototype.rightShiftS,Lt.prototype.zeroFillRightShiftM=Lt.prototype.rightShiftM,Lt.zeroFillRightShift=Lt.rightShift,Lt.prototype.not=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,~this.get(H,X));return this},Lt.not=function(H){var X=new Ot(H);return X.not()},Lt.prototype.abs=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.abs(this.get(H,X)));return this},Lt.abs=function(H){var X=new Ot(H);return X.abs()},Lt.prototype.acos=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.acos(this.get(H,X)));return this},Lt.acos=function(H){var X=new Ot(H);return X.acos()},Lt.prototype.acosh=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.acosh(this.get(H,X)));return this},Lt.acosh=function(H){var X=new Ot(H);return X.acosh()},Lt.prototype.asin=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.asin(this.get(H,X)));return this},Lt.asin=function(H){var X=new Ot(H);return X.asin()},Lt.prototype.asinh=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.asinh(this.get(H,X)));return this},Lt.asinh=function(H){var X=new Ot(H);return X.asinh()},Lt.prototype.atan=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.atan(this.get(H,X)));return this},Lt.atan=function(H){var X=new Ot(H);return X.atan()},Lt.prototype.atanh=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.atanh(this.get(H,X)));return this},Lt.atanh=function(H){var X=new Ot(H);return X.atanh()},Lt.prototype.cbrt=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.cbrt(this.get(H,X)));return this},Lt.cbrt=function(H){var X=new Ot(H);return X.cbrt()},Lt.prototype.ceil=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.ceil(this.get(H,X)));return this},Lt.ceil=function(H){var X=new Ot(H);return X.ceil()},Lt.prototype.clz32=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.clz32(this.get(H,X)));return this},Lt.clz32=function(H){var X=new Ot(H);return X.clz32()},Lt.prototype.cos=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.cos(this.get(H,X)));return this},Lt.cos=function(H){var X=new Ot(H);return X.cos()},Lt.prototype.cosh=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.cosh(this.get(H,X)));return this},Lt.cosh=function(H){var X=new Ot(H);return X.cosh()},Lt.prototype.exp=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.exp(this.get(H,X)));return this},Lt.exp=function(H){var X=new Ot(H);return X.exp()},Lt.prototype.expm1=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.expm1(this.get(H,X)));return this},Lt.expm1=function(H){var X=new Ot(H);return X.expm1()},Lt.prototype.floor=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.floor(this.get(H,X)));return this},Lt.floor=function(H){var X=new Ot(H);return X.floor()},Lt.prototype.fround=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.fround(this.get(H,X)));return this},Lt.fround=function(H){var X=new Ot(H);return X.fround()},Lt.prototype.log=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.log(this.get(H,X)));return this},Lt.log=function(H){var X=new Ot(H);return X.log()},Lt.prototype.log1p=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.log1p(this.get(H,X)));return this},Lt.log1p=function(H){var X=new Ot(H);return X.log1p()},Lt.prototype.log10=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.log10(this.get(H,X)));return this},Lt.log10=function(H){var X=new Ot(H);return X.log10()},Lt.prototype.log2=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.log2(this.get(H,X)));return this},Lt.log2=function(H){var X=new Ot(H);return X.log2()},Lt.prototype.round=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.round(this.get(H,X)));return this},Lt.round=function(H){var X=new Ot(H);return X.round()},Lt.prototype.sign=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.sign(this.get(H,X)));return this},Lt.sign=function(H){var X=new Ot(H);return X.sign()},Lt.prototype.sin=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.sin(this.get(H,X)));return this},Lt.sin=function(H){var X=new Ot(H);return X.sin()},Lt.prototype.sinh=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.sinh(this.get(H,X)));return this},Lt.sinh=function(H){var X=new Ot(H);return X.sinh()},Lt.prototype.sqrt=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.sqrt(this.get(H,X)));return this},Lt.sqrt=function(H){var X=new Ot(H);return X.sqrt()},Lt.prototype.tan=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.tan(this.get(H,X)));return this},Lt.tan=function(H){var X=new Ot(H);return X.tan()},Lt.prototype.tanh=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.tanh(this.get(H,X)));return this},Lt.tanh=function(H){var X=new Ot(H);return X.tanh()},Lt.prototype.trunc=function(){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,Math.trunc(this.get(H,X)));return this},Lt.trunc=function(H){var X=new Ot(H);return X.trunc()},Lt.pow=function(H,X){var xt=new Ot(H);return xt.pow(X)},Lt.prototype.pow=function(H){return typeof H=="number"?this.powS(H):this.powM(H)},Lt.prototype.powS=function(H){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,Math.pow(this.get(X,xt),H));return this},Lt.prototype.powM=function(H){if(H=Ot.checkMatrix(H),this.rows!==H.rows||this.columns!==H.columns)throw new RangeError("Matrices dimensions must be equal");for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.set(X,xt,Math.pow(this.get(X,xt),H.get(X,xt)));return this}}function yt(Lt,Ot,it){var H=it?Lt.rows:Lt.rows-1;if(Ot<0||Ot>H)throw new RangeError("Row index out of range")}function st(Lt,Ot,it){var H=it?Lt.columns:Lt.columns-1;if(Ot<0||Ot>H)throw new RangeError("Column index out of range")}function lt(Lt,Ot){if(Ot.to1DArray&&(Ot=Ot.to1DArray()),Ot.length!==Lt.columns)throw new RangeError("vector size must be the same as the number of columns");return Ot}function ht(Lt,Ot){if(Ot.to1DArray&&(Ot=Ot.to1DArray()),Ot.length!==Lt.rows)throw new RangeError("vector size must be the same as the number of rows");return Ot}function mt(Lt,Ot){if(!R(Ot))throw new TypeError("row indices must be an array");for(var it=0;it<Ot.length;it++)if(Ot[it]<0||Ot[it]>=Lt.rows)throw new RangeError("row indices are out of range")}function wt(Lt,Ot){if(!R(Ot))throw new TypeError("column indices must be an array");for(var it=0;it<Ot.length;it++)if(Ot[it]<0||Ot[it]>=Lt.columns)throw new RangeError("column indices are out of range")}function ut(Lt,Ot,it,H,X){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Nt("startRow",Ot),Nt("endRow",it),Nt("startColumn",H),Nt("endColumn",X),Ot>it||H>X||Ot<0||Ot>=Lt.rows||it<0||it>=Lt.rows||H<0||H>=Lt.columns||X<0||X>=Lt.columns)throw new RangeError("Submatrix indices are out of range")}function pt(Lt){for(var Ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,it=[],H=0;H<Lt;H++)it.push(Ot);return it}function Nt(Lt,Ot){if(typeof Ot!="number")throw new TypeError("".concat(Lt," must be a number"))}function Ut(Lt){if(Lt.isEmpty())throw new Error("Empty matrix has no elements to index")}function ue(Lt){for(var Ot=pt(Lt.rows),it=0;it<Lt.rows;++it)for(var H=0;H<Lt.columns;++H)Ot[it]+=Lt.get(it,H);return Ot}function se(Lt){for(var Ot=pt(Lt.columns),it=0;it<Lt.rows;++it)for(var H=0;H<Lt.columns;++H)Ot[H]+=Lt.get(it,H);return Ot}function Le(Lt){for(var Ot=0,it=0;it<Lt.rows;it++)for(var H=0;H<Lt.columns;H++)Ot+=Lt.get(it,H);return Ot}function Ne(Lt){for(var Ot=pt(Lt.rows,1),it=0;it<Lt.rows;++it)for(var H=0;H<Lt.columns;++H)Ot[it]*=Lt.get(it,H);return Ot}function we(Lt){for(var Ot=pt(Lt.columns,1),it=0;it<Lt.rows;++it)for(var H=0;H<Lt.columns;++H)Ot[H]*=Lt.get(it,H);return Ot}function At(Lt){for(var Ot=1,it=0;it<Lt.rows;it++)for(var H=0;H<Lt.columns;H++)Ot*=Lt.get(it,H);return Ot}function Qt(Lt,Ot,it){for(var H=Lt.rows,X=Lt.columns,xt=[],zt=0;zt<H;zt++){for(var Vt=0,Xt=0,ne=0,on=0;on<X;on++)ne=Lt.get(zt,on)-it[zt],Vt+=ne,Xt+=ne*ne;Ot?xt.push((Xt-Vt*Vt/X)/(X-1)):xt.push((Xt-Vt*Vt/X)/X)}return xt}function de(Lt,Ot,it){for(var H=Lt.rows,X=Lt.columns,xt=[],zt=0;zt<X;zt++){for(var Vt=0,Xt=0,ne=0,on=0;on<H;on++)ne=Lt.get(on,zt)-it[zt],Vt+=ne,Xt+=ne*ne;Ot?xt.push((Xt-Vt*Vt/H)/(H-1)):xt.push((Xt-Vt*Vt/H)/H)}return xt}function rn(Lt,Ot,it){for(var H=Lt.rows,X=Lt.columns,xt=H*X,zt=0,Vt=0,Xt=0,ne=0;ne<H;ne++)for(var on=0;on<X;on++)Xt=Lt.get(ne,on)-it,zt+=Xt,Vt+=Xt*Xt;return Ot?(Vt-zt*zt/xt)/(xt-1):(Vt-zt*zt/xt)/xt}function Ee(Lt,Ot){for(var it=0;it<Lt.rows;it++)for(var H=0;H<Lt.columns;H++)Lt.set(it,H,Lt.get(it,H)-Ot[it])}function ce(Lt,Ot){for(var it=0;it<Lt.rows;it++)for(var H=0;H<Lt.columns;H++)Lt.set(it,H,Lt.get(it,H)-Ot[H])}function Oe(Lt,Ot){for(var it=0;it<Lt.rows;it++)for(var H=0;H<Lt.columns;H++)Lt.set(it,H,Lt.get(it,H)-Ot)}function Ze(Lt){for(var Ot=[],it=0;it<Lt.rows;it++){for(var H=0,X=0;X<Lt.columns;X++)H+=Math.pow(Lt.get(it,X),2)/(Lt.columns-1);Ot.push(Math.sqrt(H))}return Ot}function fe(Lt,Ot){for(var it=0;it<Lt.rows;it++)for(var H=0;H<Lt.columns;H++)Lt.set(it,H,Lt.get(it,H)/Ot[it])}function Ae(Lt){for(var Ot=[],it=0;it<Lt.columns;it++){for(var H=0,X=0;X<Lt.rows;X++)H+=Math.pow(Lt.get(X,it),2)/(Lt.rows-1);Ot.push(Math.sqrt(H))}return Ot}function Ye(Lt,Ot){for(var it=0;it<Lt.rows;it++)for(var H=0;H<Lt.columns;H++)Lt.set(it,H,Lt.get(it,H)/Ot[H])}function ge(Lt){for(var Ot=Lt.size-1,it=0,H=0;H<Lt.columns;H++)for(var X=0;X<Lt.rows;X++)it+=Math.pow(Lt.get(X,H),2)/Ot;return Math.sqrt(it)}function Be(Lt,Ot){for(var it=0;it<Lt.rows;it++)for(var H=0;H<Lt.columns;H++)Lt.set(it,H,Lt.get(it,H)/Ot)}var te=function(){function Lt(){(0,W.Z)(this,Lt)}return(0,Q.Z)(Lt,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(it){if(typeof it!="function")throw new TypeError("callback must be a function");for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)it.call(this,H,X);return this}},{key:"to1DArray",value:function(){for(var it=[],H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)it.push(this.get(H,X));return it}},{key:"to2DArray",value:function(){for(var it=[],H=0;H<this.rows;H++){it.push([]);for(var X=0;X<this.columns;X++)it[H].push(this.get(H,X))}return it}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return this.rows===1}},{key:"isColumnVector",value:function(){return this.columns===1}},{key:"isVector",value:function(){return this.rows===1||this.columns===1}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return this.rows===0||this.columns===0}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var it=0;it<this.rows;it++)for(var H=0;H<=it;H++)if(this.get(it,H)!==this.get(H,it))return!1;return!0}return!1}},{key:"isEchelonForm",value:function(){for(var it=0,H=0,X=-1,xt=!0,zt=!1;it<this.rows&&xt;){for(H=0,zt=!1;H<this.columns&&zt===!1;)this.get(it,H)===0?H++:this.get(it,H)===1&&H>X?(zt=!0,X=H):(xt=!1,zt=!0);it++}return xt}},{key:"isReducedEchelonForm",value:function(){for(var it=0,H=0,X=-1,xt=!0,zt=!1;it<this.rows&&xt;){for(H=0,zt=!1;H<this.columns&&zt===!1;)this.get(it,H)===0?H++:this.get(it,H)===1&&H>X?(zt=!0,X=H):(xt=!1,zt=!0);for(var Vt=H+1;Vt<this.rows;Vt++)this.get(it,Vt)!==0&&(xt=!1);it++}return xt}},{key:"echelonForm",value:function(){for(var it=this.clone(),H=0,X=0;H<it.rows&&X<it.columns;){for(var xt=H,zt=H;zt<it.rows;zt++)it.get(zt,X)>it.get(xt,X)&&(xt=zt);if(it.get(xt,X)===0)X++;else{it.swapRows(H,xt);for(var Vt=it.get(H,X),Xt=X;Xt<it.columns;Xt++)it.set(H,Xt,it.get(H,Xt)/Vt);for(var ne=H+1;ne<it.rows;ne++){var on=it.get(ne,X)/it.get(H,X);it.set(ne,X,0);for(var tn=X+1;tn<it.columns;tn++)it.set(ne,tn,it.get(ne,tn)-it.get(H,tn)*on)}H++,X++}}return it}},{key:"reducedEchelonForm",value:function(){for(var it=this.echelonForm(),H=it.columns,X=it.rows,xt=X-1;xt>=0;)if(it.maxRow(xt)===0)xt--;else{for(var zt=0,Vt=!1;zt<X&&Vt===!1;)it.get(xt,zt)===1?Vt=!0:zt++;for(var Xt=0;Xt<xt;Xt++)for(var ne=it.get(Xt,zt),on=zt;on<H;on++){var tn=it.get(Xt,on)-ne*it.get(xt,on);it.set(Xt,on,tn)}xt--}return it}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof it!="object")throw new TypeError("options must be an object");var H=it.rows,X=H===void 0?1:H,xt=it.columns,zt=xt===void 0?1:xt;if(!Number.isInteger(X)||X<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(zt)||zt<=0)throw new TypeError("columns must be a positive integer");for(var Vt=new ee(this.rows*X,this.columns*zt),Xt=0;Xt<X;Xt++)for(var ne=0;ne<zt;ne++)Vt.setSubMatrix(this,this.rows*Xt,this.columns*ne);return Vt}},{key:"fill",value:function(it){for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,it);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(it){yt(this,it);for(var H=[],X=0;X<this.columns;X++)H.push(this.get(it,X));return H}},{key:"getRowVector",value:function(it){return ee.rowVector(this.getRow(it))}},{key:"setRow",value:function(it,H){yt(this,it),H=lt(this,H);for(var X=0;X<this.columns;X++)this.set(it,X,H[X]);return this}},{key:"swapRows",value:function(it,H){yt(this,it),yt(this,H);for(var X=0;X<this.columns;X++){var xt=this.get(it,X);this.set(it,X,this.get(H,X)),this.set(H,X,xt)}return this}},{key:"getColumn",value:function(it){st(this,it);for(var H=[],X=0;X<this.rows;X++)H.push(this.get(X,it));return H}},{key:"getColumnVector",value:function(it){return ee.columnVector(this.getColumn(it))}},{key:"setColumn",value:function(it,H){st(this,it),H=ht(this,H);for(var X=0;X<this.rows;X++)this.set(X,it,H[X]);return this}},{key:"swapColumns",value:function(it,H){st(this,it),st(this,H);for(var X=0;X<this.rows;X++){var xt=this.get(X,it);this.set(X,it,this.get(X,H)),this.set(X,H,xt)}return this}},{key:"addRowVector",value:function(it){it=lt(this,it);for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,this.get(H,X)+it[X]);return this}},{key:"subRowVector",value:function(it){it=lt(this,it);for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,this.get(H,X)-it[X]);return this}},{key:"mulRowVector",value:function(it){it=lt(this,it);for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,this.get(H,X)*it[X]);return this}},{key:"divRowVector",value:function(it){it=lt(this,it);for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,this.get(H,X)/it[X]);return this}},{key:"addColumnVector",value:function(it){it=ht(this,it);for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,this.get(H,X)+it[H]);return this}},{key:"subColumnVector",value:function(it){it=ht(this,it);for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,this.get(H,X)-it[H]);return this}},{key:"mulColumnVector",value:function(it){it=ht(this,it);for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,this.get(H,X)*it[H]);return this}},{key:"divColumnVector",value:function(it){it=ht(this,it);for(var H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)this.set(H,X,this.get(H,X)/it[H]);return this}},{key:"mulRow",value:function(it,H){yt(this,it);for(var X=0;X<this.columns;X++)this.set(it,X,this.get(it,X)*H);return this}},{key:"mulColumn",value:function(it,H){st(this,it);for(var X=0;X<this.rows;X++)this.set(X,it,this.get(X,it)*H);return this}},{key:"max",value:function(it){if(this.isEmpty())return NaN;switch(it){case"row":{for(var H=new Array(this.rows).fill(Number.NEGATIVE_INFINITY),X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.get(X,xt)>H[X]&&(H[X]=this.get(X,xt));return H}case"column":{for(var zt=new Array(this.columns).fill(Number.NEGATIVE_INFINITY),Vt=0;Vt<this.rows;Vt++)for(var Xt=0;Xt<this.columns;Xt++)this.get(Vt,Xt)>zt[Xt]&&(zt[Xt]=this.get(Vt,Xt));return zt}case void 0:{for(var ne=this.get(0,0),on=0;on<this.rows;on++)for(var tn=0;tn<this.columns;tn++)this.get(on,tn)>ne&&(ne=this.get(on,tn));return ne}default:throw new Error("invalid option: ".concat(it))}}},{key:"maxIndex",value:function(){Ut(this);for(var it=this.get(0,0),H=[0,0],X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.get(X,xt)>it&&(it=this.get(X,xt),H[0]=X,H[1]=xt);return H}},{key:"min",value:function(it){if(this.isEmpty())return NaN;switch(it){case"row":{for(var H=new Array(this.rows).fill(Number.POSITIVE_INFINITY),X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.get(X,xt)<H[X]&&(H[X]=this.get(X,xt));return H}case"column":{for(var zt=new Array(this.columns).fill(Number.POSITIVE_INFINITY),Vt=0;Vt<this.rows;Vt++)for(var Xt=0;Xt<this.columns;Xt++)this.get(Vt,Xt)<zt[Xt]&&(zt[Xt]=this.get(Vt,Xt));return zt}case void 0:{for(var ne=this.get(0,0),on=0;on<this.rows;on++)for(var tn=0;tn<this.columns;tn++)this.get(on,tn)<ne&&(ne=this.get(on,tn));return ne}default:throw new Error("invalid option: ".concat(it))}}},{key:"minIndex",value:function(){Ut(this);for(var it=this.get(0,0),H=[0,0],X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)this.get(X,xt)<it&&(it=this.get(X,xt),H[0]=X,H[1]=xt);return H}},{key:"maxRow",value:function(it){if(yt(this,it),this.isEmpty())return NaN;for(var H=this.get(it,0),X=1;X<this.columns;X++)this.get(it,X)>H&&(H=this.get(it,X));return H}},{key:"maxRowIndex",value:function(it){yt(this,it),Ut(this);for(var H=this.get(it,0),X=[it,0],xt=1;xt<this.columns;xt++)this.get(it,xt)>H&&(H=this.get(it,xt),X[1]=xt);return X}},{key:"minRow",value:function(it){if(yt(this,it),this.isEmpty())return NaN;for(var H=this.get(it,0),X=1;X<this.columns;X++)this.get(it,X)<H&&(H=this.get(it,X));return H}},{key:"minRowIndex",value:function(it){yt(this,it),Ut(this);for(var H=this.get(it,0),X=[it,0],xt=1;xt<this.columns;xt++)this.get(it,xt)<H&&(H=this.get(it,xt),X[1]=xt);return X}},{key:"maxColumn",value:function(it){if(st(this,it),this.isEmpty())return NaN;for(var H=this.get(0,it),X=1;X<this.rows;X++)this.get(X,it)>H&&(H=this.get(X,it));return H}},{key:"maxColumnIndex",value:function(it){st(this,it),Ut(this);for(var H=this.get(0,it),X=[0,it],xt=1;xt<this.rows;xt++)this.get(xt,it)>H&&(H=this.get(xt,it),X[0]=xt);return X}},{key:"minColumn",value:function(it){if(st(this,it),this.isEmpty())return NaN;for(var H=this.get(0,it),X=1;X<this.rows;X++)this.get(X,it)<H&&(H=this.get(X,it));return H}},{key:"minColumnIndex",value:function(it){st(this,it),Ut(this);for(var H=this.get(0,it),X=[0,it],xt=1;xt<this.rows;xt++)this.get(xt,it)<H&&(H=this.get(xt,it),X[0]=xt);return X}},{key:"diag",value:function(){for(var it=Math.min(this.rows,this.columns),H=[],X=0;X<it;X++)H.push(this.get(X,X));return H}},{key:"norm",value:function(){var it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"frobenius",H=0;if(it==="max")return this.max();if(it==="frobenius"){for(var X=0;X<this.rows;X++)for(var xt=0;xt<this.columns;xt++)H=H+this.get(X,xt)*this.get(X,xt);return Math.sqrt(H)}else throw new RangeError("unknown norm type: ".concat(it))}},{key:"cumulativeSum",value:function(){for(var it=0,H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)it+=this.get(H,X),this.set(H,X,it);return this}},{key:"dot",value:function(it){Lt.isMatrix(it)&&(it=it.to1DArray());var H=this.to1DArray();if(H.length!==it.length)throw new RangeError("vectors do not have the same size");for(var X=0,xt=0;xt<H.length;xt++)X+=H[xt]*it[xt];return X}},{key:"mmul",value:function(it){it=ee.checkMatrix(it);for(var H=this.rows,X=this.columns,xt=it.columns,zt=new ee(H,xt),Vt=new Float64Array(X),Xt=0;Xt<xt;Xt++){for(var ne=0;ne<X;ne++)Vt[ne]=it.get(ne,Xt);for(var on=0;on<H;on++){for(var tn=0,He=0;He<X;He++)tn+=this.get(on,He)*Vt[He];zt.set(on,Xt,tn)}}return zt}},{key:"strassen2x2",value:function(it){it=ee.checkMatrix(it);var H=new ee(2,2),X=this.get(0,0),xt=it.get(0,0),zt=this.get(0,1),Vt=it.get(0,1),Xt=this.get(1,0),ne=it.get(1,0),on=this.get(1,1),tn=it.get(1,1),He=(X+on)*(xt+tn),Qn=(Xt+on)*xt,Ln=X*(Vt-tn),Qr=on*(ne-xt),Ia=(X+zt)*tn,Jn=(Xt-X)*(xt+Vt),Ar=(zt-on)*(ne+tn),na=He+Qr-Ia+Ar,za=Ln+Ia,da=Qn+Qr,Ti=He-Qn+Ln+Jn;return H.set(0,0,na),H.set(0,1,za),H.set(1,0,da),H.set(1,1,Ti),H}},{key:"strassen3x3",value:function(it){it=ee.checkMatrix(it);var H=new ee(3,3),X=this.get(0,0),xt=this.get(0,1),zt=this.get(0,2),Vt=this.get(1,0),Xt=this.get(1,1),ne=this.get(1,2),on=this.get(2,0),tn=this.get(2,1),He=this.get(2,2),Qn=it.get(0,0),Ln=it.get(0,1),Qr=it.get(0,2),Ia=it.get(1,0),Jn=it.get(1,1),Ar=it.get(1,2),na=it.get(2,0),za=it.get(2,1),da=it.get(2,2),Ti=(X+xt+zt-Vt-Xt-tn-He)*Jn,ki=(X-Vt)*(-Ln+Jn),vi=Xt*(-Qn+Ln+Ia-Jn-Ar-na+da),ii=(-X+Vt+Xt)*(Qn-Ln+Jn),Di=(Vt+Xt)*(-Qn+Ln),Ra=X*Qn,ln=(-X+on+tn)*(Qn-Qr+Ar),De=(-X+on)*(Qr-Ar),dn=(on+tn)*(-Qn+Qr),Wn=(X+xt+zt-Xt-ne-on-tn)*Ar,Gn=tn*(-Qn+Qr+Ia-Jn-Ar-na+za),Kn=(-zt+tn+He)*(Jn+na-za),Rr=(zt-He)*(Jn-za),xa=zt*na,La=(tn+He)*(-na+za),ui=(-zt+Xt+ne)*(Ar+na-da),Fi=(zt-ne)*(Ar-da),Ki=(Xt+ne)*(-na+da),xo=xt*Ia,vo=ne*za,es=Vt*Qr,Wo=on*Ln,Zi=He*da,bi=Ra+xa+xo,gi=Ti+ii+Di+Ra+Kn+xa+La,ms=Ra+ln+dn+Wn+xa+ui+Ki,Do=ki+vi+ii+Ra+xa+ui+Fi,To=ki+ii+Di+Ra+vo,Zs=xa+ui+Fi+Ki+es,Eu=Ra+ln+De+Gn+Kn+Rr+xa,as=Kn+Rr+xa+La+Wo,Rs=Ra+ln+De+dn+Zi;return H.set(0,0,bi),H.set(0,1,gi),H.set(0,2,ms),H.set(1,0,Do),H.set(1,1,To),H.set(1,2,Zs),H.set(2,0,Eu),H.set(2,1,as),H.set(2,2,Rs),H}},{key:"mmulStrassen",value:function(it){it=ee.checkMatrix(it);var H=this.clone(),X=H.rows,xt=H.columns,zt=it.rows,Vt=it.columns;xt!==zt&&console.warn("Multiplying ".concat(X," x ").concat(xt," and ").concat(zt," x ").concat(Vt," matrix: dimensions do not match."));function Xt(He,Qn,Ln){var Qr=He.rows,Ia=He.columns;if(Qr===Qn&&Ia===Ln)return He;var Jn=Lt.zeros(Qn,Ln);return Jn=Jn.setSubMatrix(He,0,0),Jn}var ne=Math.max(X,zt),on=Math.max(xt,Vt);H=Xt(H,ne,on),it=Xt(it,ne,on);function tn(He,Qn,Ln,Qr){if(Ln<=512||Qr<=512)return He.mmul(Qn);Ln%2==1&&Qr%2==1?(He=Xt(He,Ln+1,Qr+1),Qn=Xt(Qn,Ln+1,Qr+1)):Ln%2==1?(He=Xt(He,Ln+1,Qr),Qn=Xt(Qn,Ln+1,Qr)):Qr%2==1&&(He=Xt(He,Ln,Qr+1),Qn=Xt(Qn,Ln,Qr+1));var Ia=parseInt(He.rows/2,10),Jn=parseInt(He.columns/2,10),Ar=He.subMatrix(0,Ia-1,0,Jn-1),na=Qn.subMatrix(0,Ia-1,0,Jn-1),za=He.subMatrix(0,Ia-1,Jn,He.columns-1),da=Qn.subMatrix(0,Ia-1,Jn,Qn.columns-1),Ti=He.subMatrix(Ia,He.rows-1,0,Jn-1),ki=Qn.subMatrix(Ia,Qn.rows-1,0,Jn-1),vi=He.subMatrix(Ia,He.rows-1,Jn,He.columns-1),ii=Qn.subMatrix(Ia,Qn.rows-1,Jn,Qn.columns-1),Di=tn(Lt.add(Ar,vi),Lt.add(na,ii),Ia,Jn),Ra=tn(Lt.add(Ti,vi),na,Ia,Jn),ln=tn(Ar,Lt.sub(da,ii),Ia,Jn),De=tn(vi,Lt.sub(ki,na),Ia,Jn),dn=tn(Lt.add(Ar,za),ii,Ia,Jn),Wn=tn(Lt.sub(Ti,Ar),Lt.add(na,da),Ia,Jn),Gn=tn(Lt.sub(za,vi),Lt.add(ki,ii),Ia,Jn),Kn=Lt.add(Di,De);Kn.sub(dn),Kn.add(Gn);var Rr=Lt.add(ln,dn),xa=Lt.add(Ra,De),La=Lt.sub(Di,Ra);La.add(ln),La.add(Wn);var ui=Lt.zeros(2*Kn.rows,2*Kn.columns);return ui=ui.setSubMatrix(Kn,0,0),ui=ui.setSubMatrix(Rr,Kn.rows,0),ui=ui.setSubMatrix(xa,0,Kn.columns),ui=ui.setSubMatrix(La,Kn.rows,Kn.columns),ui.subMatrix(0,Ln-1,0,Qr-1)}return tn(H,it,ne,on)}},{key:"scaleRows",value:function(){var it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof it!="object")throw new TypeError("options must be an object");var H=it.min,X=H===void 0?0:H,xt=it.max,zt=xt===void 0?1:xt;if(!Number.isFinite(X))throw new TypeError("min must be a number");if(!Number.isFinite(zt))throw new TypeError("max must be a number");if(X>=zt)throw new RangeError("min must be smaller than max");for(var Vt=new ee(this.rows,this.columns),Xt=0;Xt<this.rows;Xt++){var ne=this.getRow(Xt);ne.length>0&&A(ne,{min:X,max:zt,output:ne}),Vt.setRow(Xt,ne)}return Vt}},{key:"scaleColumns",value:function(){var it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(typeof it!="object")throw new TypeError("options must be an object");var H=it.min,X=H===void 0?0:H,xt=it.max,zt=xt===void 0?1:xt;if(!Number.isFinite(X))throw new TypeError("min must be a number");if(!Number.isFinite(zt))throw new TypeError("max must be a number");if(X>=zt)throw new RangeError("min must be smaller than max");for(var Vt=new ee(this.rows,this.columns),Xt=0;Xt<this.columns;Xt++){var ne=this.getColumn(Xt);ne.length&&A(ne,{min:X,max:zt,output:ne}),Vt.setColumn(Xt,ne)}return Vt}},{key:"flipRows",value:function(){for(var it=Math.ceil(this.columns/2),H=0;H<this.rows;H++)for(var X=0;X<it;X++){var xt=this.get(H,X),zt=this.get(H,this.columns-1-X);this.set(H,X,zt),this.set(H,this.columns-1-X,xt)}return this}},{key:"flipColumns",value:function(){for(var it=Math.ceil(this.rows/2),H=0;H<this.columns;H++)for(var X=0;X<it;X++){var xt=this.get(X,H),zt=this.get(this.rows-1-X,H);this.set(X,H,zt),this.set(this.rows-1-X,H,xt)}return this}},{key:"kroneckerProduct",value:function(it){it=ee.checkMatrix(it);for(var H=this.rows,X=this.columns,xt=it.rows,zt=it.columns,Vt=new ee(H*xt,X*zt),Xt=0;Xt<H;Xt++)for(var ne=0;ne<X;ne++)for(var on=0;on<xt;on++)for(var tn=0;tn<zt;tn++)Vt.set(xt*Xt+on,zt*ne+tn,this.get(Xt,ne)*it.get(on,tn));return Vt}},{key:"kroneckerSum",value:function(it){if(it=ee.checkMatrix(it),!this.isSquare()||!it.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var H=this.rows,X=it.rows,xt=this.kroneckerProduct(ee.eye(X,X)),zt=ee.eye(H,H).kroneckerProduct(it);return xt.add(zt)}},{key:"transpose",value:function(){for(var it=new ee(this.columns,this.rows),H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)it.set(X,H,this.get(H,X));return it}},{key:"sortRows",value:function(){for(var it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ke,H=0;H<this.rows;H++)this.setRow(H,this.getRow(H).sort(it));return this}},{key:"sortColumns",value:function(){for(var it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ke,H=0;H<this.columns;H++)this.setColumn(H,this.getColumn(H).sort(it));return this}},{key:"subMatrix",value:function(it,H,X,xt){ut(this,it,H,X,xt);for(var zt=new ee(H-it+1,xt-X+1),Vt=it;Vt<=H;Vt++)for(var Xt=X;Xt<=xt;Xt++)zt.set(Vt-it,Xt-X,this.get(Vt,Xt));return zt}},{key:"subMatrixRow",value:function(it,H,X){if(H===void 0&&(H=0),X===void 0&&(X=this.columns-1),H>X||H<0||H>=this.columns||X<0||X>=this.columns)throw new RangeError("Argument out of range");for(var xt=new ee(it.length,X-H+1),zt=0;zt<it.length;zt++)for(var Vt=H;Vt<=X;Vt++){if(it[zt]<0||it[zt]>=this.rows)throw new RangeError("Row index out of range: ".concat(it[zt]));xt.set(zt,Vt-H,this.get(it[zt],Vt))}return xt}},{key:"subMatrixColumn",value:function(it,H,X){if(H===void 0&&(H=0),X===void 0&&(X=this.rows-1),H>X||H<0||H>=this.rows||X<0||X>=this.rows)throw new RangeError("Argument out of range");for(var xt=new ee(X-H+1,it.length),zt=0;zt<it.length;zt++)for(var Vt=H;Vt<=X;Vt++){if(it[zt]<0||it[zt]>=this.columns)throw new RangeError("Column index out of range: ".concat(it[zt]));xt.set(Vt-H,zt,this.get(Vt,it[zt]))}return xt}},{key:"setSubMatrix",value:function(it,H,X){if(it=ee.checkMatrix(it),it.isEmpty())return this;var xt=H+it.rows-1,zt=X+it.columns-1;ut(this,H,xt,X,zt);for(var Vt=0;Vt<it.rows;Vt++)for(var Xt=0;Xt<it.columns;Xt++)this.set(H+Vt,X+Xt,it.get(Vt,Xt));return this}},{key:"selection",value:function(it,H){mt(this,it),wt(this,H);for(var X=new ee(it.length,H.length),xt=0;xt<it.length;xt++)for(var zt=it[xt],Vt=0;Vt<H.length;Vt++){var Xt=H[Vt];X.set(xt,Vt,this.get(zt,Xt))}return X}},{key:"trace",value:function(){for(var it=Math.min(this.rows,this.columns),H=0,X=0;X<it;X++)H+=this.get(X,X);return H}},{key:"clone",value:function(){for(var it=new ee(this.rows,this.columns),H=0;H<this.rows;H++)for(var X=0;X<this.columns;X++)it.set(H,X,this.get(H,X));return it}},{key:"sum",value:function(it){switch(it){case"row":return ue(this);case"column":return se(this);case void 0:return Le(this);default:throw new Error("invalid option: ".concat(it))}}},{key:"product",value:function(it){switch(it){case"row":return Ne(this);case"column":return we(this);case void 0:return At(this);default:throw new Error("invalid option: ".concat(it))}}},{key:"mean",value:function(it){var H=this.sum(it);switch(it){case"row":{for(var X=0;X<this.rows;X++)H[X]/=this.columns;return H}case"column":{for(var xt=0;xt<this.columns;xt++)H[xt]/=this.rows;return H}case void 0:return H/this.size;default:throw new Error("invalid option: ".concat(it))}}},{key:"variance",value:function(it){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof it=="object"&&(H=it,it=void 0),typeof H!="object")throw new TypeError("options must be an object");var X=H,xt=X.unbiased,zt=xt===void 0?!0:xt,Vt=X.mean,Xt=Vt===void 0?this.mean(it):Vt;if(typeof zt!="boolean")throw new TypeError("unbiased must be a boolean");switch(it){case"row":{if(!R(Xt))throw new TypeError("mean must be an array");return Qt(this,zt,Xt)}case"column":{if(!R(Xt))throw new TypeError("mean must be an array");return de(this,zt,Xt)}case void 0:{if(typeof Xt!="number")throw new TypeError("mean must be a number");return rn(this,zt,Xt)}default:throw new Error("invalid option: ".concat(it))}}},{key:"standardDeviation",value:function(it,H){typeof it=="object"&&(H=it,it=void 0);var X=this.variance(it,H);if(it===void 0)return Math.sqrt(X);for(var xt=0;xt<X.length;xt++)X[xt]=Math.sqrt(X[xt]);return X}},{key:"center",value:function(it){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof it=="object"&&(H=it,it=void 0),typeof H!="object")throw new TypeError("options must be an object");var X=H,xt=X.center,zt=xt===void 0?this.mean(it):xt;switch(it){case"row":{if(!R(zt))throw new TypeError("center must be an array");return Ee(this,zt),this}case"column":{if(!R(zt))throw new TypeError("center must be an array");return ce(this,zt),this}case void 0:{if(typeof zt!="number")throw new TypeError("center must be a number");return Oe(this,zt),this}default:throw new Error("invalid option: ".concat(it))}}},{key:"scale",value:function(it){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof it=="object"&&(H=it,it=void 0),typeof H!="object")throw new TypeError("options must be an object");var X=H.scale;switch(it){case"row":{if(X===void 0)X=Ze(this);else if(!R(X))throw new TypeError("scale must be an array");return fe(this,X),this}case"column":{if(X===void 0)X=Ae(this);else if(!R(X))throw new TypeError("scale must be an array");return Ye(this,X),this}case void 0:{if(X===void 0)X=ge(this);else if(typeof X!="number")throw new TypeError("scale must be a number");return Be(this,X),this}default:throw new Error("invalid option: ".concat(it))}}},{key:"toString",value:function(it){return F(this,it)}}],[{key:"from1DArray",value:function(it,H,X){var xt=it*H;if(xt!==X.length)throw new RangeError("data length does not match given dimensions");for(var zt=new ee(it,H),Vt=0;Vt<it;Vt++)for(var Xt=0;Xt<H;Xt++)zt.set(Vt,Xt,X[Vt*H+Xt]);return zt}},{key:"rowVector",value:function(it){for(var H=new ee(1,it.length),X=0;X<it.length;X++)H.set(0,X,it[X]);return H}},{key:"columnVector",value:function(it){for(var H=new ee(it.length,1),X=0;X<it.length;X++)H.set(X,0,it[X]);return H}},{key:"zeros",value:function(it,H){return new ee(it,H)}},{key:"ones",value:function(it,H){return new ee(it,H).fill(1)}},{key:"rand",value:function(it,H){var X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof X!="object")throw new TypeError("options must be an object");for(var xt=X.random,zt=xt===void 0?Math.random:xt,Vt=new ee(it,H),Xt=0;Xt<it;Xt++)for(var ne=0;ne<H;ne++)Vt.set(Xt,ne,zt());return Vt}},{key:"randInt",value:function(it,H){var X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof X!="object")throw new TypeError("options must be an object");var xt=X.min,zt=xt===void 0?0:xt,Vt=X.max,Xt=Vt===void 0?1e3:Vt,ne=X.random,on=ne===void 0?Math.random:ne;if(!Number.isInteger(zt))throw new TypeError("min must be an integer");if(!Number.isInteger(Xt))throw new TypeError("max must be an integer");if(zt>=Xt)throw new RangeError("min must be smaller than max");for(var tn=Xt-zt,He=new ee(it,H),Qn=0;Qn<it;Qn++)for(var Ln=0;Ln<H;Ln++){var Qr=zt+Math.round(on()*tn);He.set(Qn,Ln,Qr)}return He}},{key:"eye",value:function(it,H,X){H===void 0&&(H=it),X===void 0&&(X=1);for(var xt=Math.min(it,H),zt=this.zeros(it,H),Vt=0;Vt<xt;Vt++)zt.set(Vt,Vt,X);return zt}},{key:"diag",value:function(it,H,X){var xt=it.length;H===void 0&&(H=xt),X===void 0&&(X=H);for(var zt=Math.min(xt,H,X),Vt=this.zeros(H,X),Xt=0;Xt<zt;Xt++)Vt.set(Xt,Xt,it[Xt]);return Vt}},{key:"min",value:function(it,H){it=this.checkMatrix(it),H=this.checkMatrix(H);for(var X=it.rows,xt=it.columns,zt=new ee(X,xt),Vt=0;Vt<X;Vt++)for(var Xt=0;Xt<xt;Xt++)zt.set(Vt,Xt,Math.min(it.get(Vt,Xt),H.get(Vt,Xt)));return zt}},{key:"max",value:function(it,H){it=this.checkMatrix(it),H=this.checkMatrix(H);for(var X=it.rows,xt=it.columns,zt=new this(X,xt),Vt=0;Vt<X;Vt++)for(var Xt=0;Xt<xt;Xt++)zt.set(Vt,Xt,Math.max(it.get(Vt,Xt),H.get(Vt,Xt)));return zt}},{key:"checkMatrix",value:function(it){return Lt.isMatrix(it)?it:new ee(it)}},{key:"isMatrix",value:function(it){return it!=null&&it.klass==="Matrix"}}]),Lt}();te.prototype.klass="Matrix",typeof Symbol!="undefined"&&(te.prototype[Symbol.for("nodejs.util.inspect.custom")]=O);function ke(Lt,Ot){return Lt-Ot}function Ve(Lt){return Lt.every(function(Ot){return typeof Ot=="number"})}te.random=te.rand,te.randomInt=te.randInt,te.diagonal=te.diag,te.prototype.diagonal=te.prototype.diag,te.identity=te.eye,te.prototype.negate=te.prototype.neg,te.prototype.tensorProduct=te.prototype.kroneckerProduct;var ee=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H,X){var xt;if((0,W.Z)(this,it),xt=Ot.call(this),it.isMatrix(H))return(0,Y.Z)(xt,H.clone());if(Number.isInteger(H)&&H>=0)if(xt.data=[],Number.isInteger(X)&&X>=0)for(var zt=0;zt<H;zt++)xt.data.push(new Float64Array(X));else throw new TypeError("nColumns must be a positive integer");else if(R(H)){var Vt=H;if(H=Vt.length,X=H?Vt[0].length:0,typeof X!="number")throw new TypeError("Data must be a 2D array with at least one element");xt.data=[];for(var Xt=0;Xt<H;Xt++){if(Vt[Xt].length!==X)throw new RangeError("Inconsistent array dimensions");if(!Ve(Vt[Xt]))throw new TypeError("Input data contains non-numeric values");xt.data.push(Float64Array.from(Vt[Xt]))}}else throw new TypeError("First argument must be a positive number or an array");return xt.rows=H,xt.columns=X,xt}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){return this.data[X][xt]=zt,this}},{key:"get",value:function(X,xt){return this.data[X][xt]}},{key:"removeRow",value:function(X){return yt(this,X),this.data.splice(X,1),this.rows-=1,this}},{key:"addRow",value:function(X,xt){return xt===void 0&&(xt=X,X=this.rows),yt(this,X,!0),xt=Float64Array.from(lt(this,xt)),this.data.splice(X,0,xt),this.rows+=1,this}},{key:"removeColumn",value:function(X){st(this,X);for(var xt=0;xt<this.rows;xt++){for(var zt=new Float64Array(this.columns-1),Vt=0;Vt<X;Vt++)zt[Vt]=this.data[xt][Vt];for(var Xt=X+1;Xt<this.columns;Xt++)zt[Xt-1]=this.data[xt][Xt];this.data[xt]=zt}return this.columns-=1,this}},{key:"addColumn",value:function(X,xt){typeof xt=="undefined"&&(xt=X,X=this.columns),st(this,X,!0),xt=ht(this,xt);for(var zt=0;zt<this.rows;zt++){for(var Vt=new Float64Array(this.columns+1),Xt=0;Xt<X;Xt++)Vt[Xt]=this.data[zt][Xt];for(Vt[Xt++]=xt[zt];Xt<this.columns+1;Xt++)Vt[Xt]=this.data[zt][Xt-1];this.data[zt]=Vt}return this.columns+=1,this}}]),it}(te);k(te,ee);var Ft=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H,X,xt){var zt;return(0,W.Z)(this,it),zt=Ot.call(this),zt.matrix=H,zt.rows=X,zt.columns=xt,zt}return(0,Q.Z)(it)}(te),bt=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H,X){var xt;return(0,W.Z)(this,it),st(H,X),xt=Ot.call(this,H,H.rows,1),xt.column=X,xt}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){return this.matrix.set(X,this.column,zt),this}},{key:"get",value:function(X){return this.matrix.get(X,this.column)}}]),it}(Ft),Me=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H,X){var xt;return(0,W.Z)(this,it),wt(H,X),xt=Ot.call(this,H,H.rows,X.length),xt.columnIndices=X,xt}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){return this.matrix.set(X,this.columnIndices[xt],zt),this}},{key:"get",value:function(X,xt){return this.matrix.get(X,this.columnIndices[xt])}}]),it}(Ft),en=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H){return(0,W.Z)(this,it),Ot.call(this,H,H.rows,H.columns)}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){return this.matrix.set(X,this.columns-xt-1,zt),this}},{key:"get",value:function(X,xt){return this.matrix.get(X,this.columns-xt-1)}}]),it}(Ft),fn=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H){return(0,W.Z)(this,it),Ot.call(this,H,H.rows,H.columns)}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){return this.matrix.set(this.rows-X-1,xt,zt),this}},{key:"get",value:function(X,xt){return this.matrix.get(this.rows-X-1,xt)}}]),it}(Ft),Rt=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H,X){var xt;return(0,W.Z)(this,it),yt(H,X),xt=Ot.call(this,H,1,H.columns),xt.row=X,xt}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){return this.matrix.set(this.row,xt,zt),this}},{key:"get",value:function(X,xt){return this.matrix.get(this.row,xt)}}]),it}(Ft),Xn=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H,X){var xt;return(0,W.Z)(this,it),mt(H,X),xt=Ot.call(this,H,X.length,H.columns),xt.rowIndices=X,xt}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){return this.matrix.set(this.rowIndices[X],xt,zt),this}},{key:"get",value:function(X,xt){return this.matrix.get(this.rowIndices[X],xt)}}]),it}(Ft),Bn=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H,X,xt){var zt;return(0,W.Z)(this,it),mt(H,X),wt(H,xt),zt=Ot.call(this,H,X.length,xt.length),zt.rowIndices=X,zt.columnIndices=xt,zt}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){return this.matrix.set(this.rowIndices[X],this.columnIndices[xt],zt),this}},{key:"get",value:function(X,xt){return this.matrix.get(this.rowIndices[X],this.columnIndices[xt])}}]),it}(Ft),xr=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H,X,xt,zt,Vt){var Xt;return(0,W.Z)(this,it),ut(H,X,xt,zt,Vt),Xt=Ot.call(this,H,xt-X+1,Vt-zt+1),Xt.startRow=X,Xt.startColumn=zt,Xt}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){return this.matrix.set(this.startRow+X,this.startColumn+xt,zt),this}},{key:"get",value:function(X,xt){return this.matrix.get(this.startRow+X,this.startColumn+xt)}}]),it}(Ft),dr=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H){return(0,W.Z)(this,it),Ot.call(this,H,H.columns,H.rows)}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){return this.matrix.set(xt,X,zt),this}},{key:"get",value:function(X,xt){return this.matrix.get(xt,X)}}]),it}(Ft),Ur=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H){var X,xt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,W.Z)(this,it);var zt=xt.rows,Vt=zt===void 0?1:zt;if(H.length%Vt!=0)throw new Error("the data length is not divisible by the number of rows");return X=Ot.call(this),X.rows=Vt,X.columns=H.length/Vt,X.data=H,X}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){var Vt=this._calculateIndex(X,xt);return this.data[Vt]=zt,this}},{key:"get",value:function(X,xt){var zt=this._calculateIndex(X,xt);return this.data[zt]}},{key:"_calculateIndex",value:function(X,xt){return X*this.columns+xt}}]),it}(te),fa=function(Lt){(0,tt.Z)(it,Lt);var Ot=(0,j.Z)(it);function it(H){var X;return(0,W.Z)(this,it),X=Ot.call(this),X.data=H,X.rows=H.length,X.columns=H[0].length,X}return(0,Q.Z)(it,[{key:"set",value:function(X,xt,zt){return this.data[X][xt]=zt,this}},{key:"get",value:function(X,xt){return this.data[X][xt]}}]),it}(te);function Ea(Lt,Ot){if(R(Lt))return Lt[0]&&R(Lt[0])?new fa(Lt):new Ur(Lt,Ot);throw new Error("the argument is not an array")}var aa=function(){function Lt(Ot){(0,W.Z)(this,Lt),Ot=fa.checkMatrix(Ot);var it=Ot.clone(),H=it.rows,X=it.columns,xt=new Float64Array(H),zt=1,Vt,Xt,ne,on,tn,He,Qn,Ln,Qr;for(Vt=0;Vt<H;Vt++)xt[Vt]=Vt;for(Ln=new Float64Array(H),Xt=0;Xt<X;Xt++){for(Vt=0;Vt<H;Vt++)Ln[Vt]=it.get(Vt,Xt);for(Vt=0;Vt<H;Vt++){for(Qr=Math.min(Vt,Xt),tn=0,ne=0;ne<Qr;ne++)tn+=it.get(Vt,ne)*Ln[ne];Ln[Vt]-=tn,it.set(Vt,Xt,Ln[Vt])}for(on=Xt,Vt=Xt+1;Vt<H;Vt++)Math.abs(Ln[Vt])>Math.abs(Ln[on])&&(on=Vt);if(on!==Xt){for(ne=0;ne<X;ne++)He=it.get(on,ne),it.set(on,ne,it.get(Xt,ne)),it.set(Xt,ne,He);Qn=xt[on],xt[on]=xt[Xt],xt[Xt]=Qn,zt=-zt}if(Xt<H&&it.get(Xt,Xt)!==0)for(Vt=Xt+1;Vt<H;Vt++)it.set(Vt,Xt,it.get(Vt,Xt)/it.get(Xt,Xt))}this.LU=it,this.pivotVector=xt,this.pivotSign=zt}return(0,Q.Z)(Lt,[{key:"isSingular",value:function(){for(var it=this.LU,H=it.columns,X=0;X<H;X++)if(it.get(X,X)===0)return!0;return!1}},{key:"solve",value:function(it){it=ee.checkMatrix(it);var H=this.LU,X=H.rows;if(X!==it.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var xt=it.columns,zt=it.subMatrixRow(this.pivotVector,0,xt-1),Vt=H.columns,Xt,ne,on;for(on=0;on<Vt;on++)for(Xt=on+1;Xt<Vt;Xt++)for(ne=0;ne<xt;ne++)zt.set(Xt,ne,zt.get(Xt,ne)-zt.get(on,ne)*H.get(Xt,on));for(on=Vt-1;on>=0;on--){for(ne=0;ne<xt;ne++)zt.set(on,ne,zt.get(on,ne)/H.get(on,on));for(Xt=0;Xt<on;Xt++)for(ne=0;ne<xt;ne++)zt.set(Xt,ne,zt.get(Xt,ne)-zt.get(on,ne)*H.get(Xt,on))}return zt}},{key:"determinant",get:function(){var it=this.LU;if(!it.isSquare())throw new Error("Matrix must be square");for(var H=this.pivotSign,X=it.columns,xt=0;xt<X;xt++)H*=it.get(xt,xt);return H}},{key:"lowerTriangularMatrix",get:function(){for(var it=this.LU,H=it.rows,X=it.columns,xt=new ee(H,X),zt=0;zt<H;zt++)for(var Vt=0;Vt<X;Vt++)zt>Vt?xt.set(zt,Vt,it.get(zt,Vt)):zt===Vt?xt.set(zt,Vt,1):xt.set(zt,Vt,0);return xt}},{key:"upperTriangularMatrix",get:function(){for(var it=this.LU,H=it.rows,X=it.columns,xt=new ee(H,X),zt=0;zt<H;zt++)for(var Vt=0;Vt<X;Vt++)zt<=Vt?xt.set(zt,Vt,it.get(zt,Vt)):xt.set(zt,Vt,0);return xt}},{key:"pivotPermutationVector",get:function(){return Array.from(this.pivotVector)}}]),Lt}();function Da(Lt,Ot){var it=0;return Math.abs(Lt)>Math.abs(Ot)?(it=Ot/Lt,Math.abs(Lt)*Math.sqrt(1+it*it)):Ot!==0?(it=Lt/Ot,Math.abs(Ot)*Math.sqrt(1+it*it)):0}var Lr=function(){function Lt(Ot){(0,W.Z)(this,Lt),Ot=fa.checkMatrix(Ot);var it=Ot.clone(),H=Ot.rows,X=Ot.columns,xt=new Float64Array(X),zt,Vt,Xt,ne;for(Xt=0;Xt<X;Xt++){var on=0;for(zt=Xt;zt<H;zt++)on=Da(on,it.get(zt,Xt));if(on!==0){for(it.get(Xt,Xt)<0&&(on=-on),zt=Xt;zt<H;zt++)it.set(zt,Xt,it.get(zt,Xt)/on);for(it.set(Xt,Xt,it.get(Xt,Xt)+1),Vt=Xt+1;Vt<X;Vt++){for(ne=0,zt=Xt;zt<H;zt++)ne+=it.get(zt,Xt)*it.get(zt,Vt);for(ne=-ne/it.get(Xt,Xt),zt=Xt;zt<H;zt++)it.set(zt,Vt,it.get(zt,Vt)+ne*it.get(zt,Xt))}}xt[Xt]=-on}this.QR=it,this.Rdiag=xt}return(0,Q.Z)(Lt,[{key:"solve",value:function(it){it=ee.checkMatrix(it);var H=this.QR,X=H.rows;if(it.rows!==X)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var xt=it.columns,zt=it.clone(),Vt=H.columns,Xt,ne,on,tn;for(on=0;on<Vt;on++)for(ne=0;ne<xt;ne++){for(tn=0,Xt=on;Xt<X;Xt++)tn+=H.get(Xt,on)*zt.get(Xt,ne);for(tn=-tn/H.get(on,on),Xt=on;Xt<X;Xt++)zt.set(Xt,ne,zt.get(Xt,ne)+tn*H.get(Xt,on))}for(on=Vt-1;on>=0;on--){for(ne=0;ne<xt;ne++)zt.set(on,ne,zt.get(on,ne)/this.Rdiag[on]);for(Xt=0;Xt<on;Xt++)for(ne=0;ne<xt;ne++)zt.set(Xt,ne,zt.get(Xt,ne)-zt.get(on,ne)*H.get(Xt,on))}return zt.subMatrix(0,Vt-1,0,xt-1)}},{key:"isFullRank",value:function(){for(var it=this.QR.columns,H=0;H<it;H++)if(this.Rdiag[H]===0)return!1;return!0}},{key:"upperTriangularMatrix",get:function(){var it=this.QR,H=it.columns,X=new ee(H,H),xt,zt;for(xt=0;xt<H;xt++)for(zt=0;zt<H;zt++)xt<zt?X.set(xt,zt,it.get(xt,zt)):xt===zt?X.set(xt,zt,this.Rdiag[xt]):X.set(xt,zt,0);return X}},{key:"orthogonalMatrix",get:function(){var it=this.QR,H=it.rows,X=it.columns,xt=new ee(H,X),zt,Vt,Xt,ne;for(Xt=X-1;Xt>=0;Xt--){for(zt=0;zt<H;zt++)xt.set(zt,Xt,0);for(xt.set(Xt,Xt,1),Vt=Xt;Vt<X;Vt++)if(it.get(Xt,Xt)!==0){for(ne=0,zt=Xt;zt<H;zt++)ne+=it.get(zt,Xt)*xt.get(zt,Vt);for(ne=-ne/it.get(Xt,Xt),zt=Xt;zt<H;zt++)xt.set(zt,Vt,xt.get(zt,Vt)+ne*it.get(zt,Xt))}}return xt}}]),Lt}(),_n=function(){function Lt(Ot){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if((0,W.Z)(this,Lt),Ot=fa.checkMatrix(Ot),Ot.isEmpty())throw new Error("Matrix must be non-empty");var H=Ot.rows,X=Ot.columns,xt=it.computeLeftSingularVectors,zt=xt===void 0?!0:xt,Vt=it.computeRightSingularVectors,Xt=Vt===void 0?!0:Vt,ne=it.autoTranspose,on=ne===void 0?!1:ne,tn=Boolean(zt),He=Boolean(Xt),Qn=!1,Ln;if(H<X)if(!on)Ln=Ot.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{Ln=Ot.transpose(),H=Ln.rows,X=Ln.columns,Qn=!0;var Qr=tn;tn=He,He=Qr}else Ln=Ot.clone();for(var Ia=Math.min(H,X),Jn=Math.min(H+1,X),Ar=new Float64Array(Jn),na=new ee(H,Ia),za=new ee(X,X),da=new Float64Array(X),Ti=new Float64Array(H),ki=new Float64Array(Jn),vi=0;vi<Jn;vi++)ki[vi]=vi;for(var ii=Math.min(H-1,X),Di=Math.max(0,Math.min(X-2,H)),Ra=Math.max(ii,Di),ln=0;ln<Ra;ln++){if(ln<ii){Ar[ln]=0;for(var De=ln;De<H;De++)Ar[ln]=Da(Ar[ln],Ln.get(De,ln));if(Ar[ln]!==0){Ln.get(ln,ln)<0&&(Ar[ln]=-Ar[ln]);for(var dn=ln;dn<H;dn++)Ln.set(dn,ln,Ln.get(dn,ln)/Ar[ln]);Ln.set(ln,ln,Ln.get(ln,ln)+1)}Ar[ln]=-Ar[ln]}for(var Wn=ln+1;Wn<X;Wn++){if(ln<ii&&Ar[ln]!==0){for(var Gn=0,Kn=ln;Kn<H;Kn++)Gn+=Ln.get(Kn,ln)*Ln.get(Kn,Wn);Gn=-Gn/Ln.get(ln,ln);for(var Rr=ln;Rr<H;Rr++)Ln.set(Rr,Wn,Ln.get(Rr,Wn)+Gn*Ln.get(Rr,ln))}da[Wn]=Ln.get(ln,Wn)}if(tn&&ln<ii)for(var xa=ln;xa<H;xa++)na.set(xa,ln,Ln.get(xa,ln));if(ln<Di){da[ln]=0;for(var La=ln+1;La<X;La++)da[ln]=Da(da[ln],da[La]);if(da[ln]!==0){da[ln+1]<0&&(da[ln]=0-da[ln]);for(var ui=ln+1;ui<X;ui++)da[ui]/=da[ln];da[ln+1]+=1}if(da[ln]=-da[ln],ln+1<H&&da[ln]!==0){for(var Fi=ln+1;Fi<H;Fi++)Ti[Fi]=0;for(var Ki=ln+1;Ki<H;Ki++)for(var xo=ln+1;xo<X;xo++)Ti[Ki]+=da[xo]*Ln.get(Ki,xo);for(var vo=ln+1;vo<X;vo++)for(var es=-da[vo]/da[ln+1],Wo=ln+1;Wo<H;Wo++)Ln.set(Wo,vo,Ln.get(Wo,vo)+es*Ti[Wo])}if(He)for(var Zi=ln+1;Zi<X;Zi++)za.set(Zi,ln,da[Zi])}}var bi=Math.min(X,H+1);if(ii<X&&(Ar[ii]=Ln.get(ii,ii)),H<bi&&(Ar[bi-1]=0),Di+1<bi&&(da[Di]=Ln.get(Di,bi-1)),da[bi-1]=0,tn){for(var gi=ii;gi<Ia;gi++){for(var ms=0;ms<H;ms++)na.set(ms,gi,0);na.set(gi,gi,1)}for(var Do=ii-1;Do>=0;Do--)if(Ar[Do]!==0){for(var To=Do+1;To<Ia;To++){for(var Zs=0,Eu=Do;Eu<H;Eu++)Zs+=na.get(Eu,Do)*na.get(Eu,To);Zs=-Zs/na.get(Do,Do);for(var as=Do;as<H;as++)na.set(as,To,na.get(as,To)+Zs*na.get(as,Do))}for(var Rs=Do;Rs<H;Rs++)na.set(Rs,Do,-na.get(Rs,Do));na.set(Do,Do,1+na.get(Do,Do));for(var Su=0;Su<Do-1;Su++)na.set(Su,Do,0)}else{for(var fu=0;fu<H;fu++)na.set(fu,Do,0);na.set(Do,Do,1)}}if(He)for(var Is=X-1;Is>=0;Is--){if(Is<Di&&da[Is]!==0)for(var Zo=Is+1;Zo<X;Zo++){for(var Wi=0,ys=Is+1;ys<X;ys++)Wi+=za.get(ys,Is)*za.get(ys,Zo);Wi=-Wi/za.get(Is+1,Is);for(var is=Is+1;is<X;is++)za.set(is,Zo,za.get(is,Zo)+Wi*za.get(is,Is))}for(var Us=0;Us<X;Us++)za.set(Us,Is,0);za.set(Is,Is,1)}for(var Du=bi-1,qs=0,Cu=Number.EPSILON;bi>0;){var ji=void 0,Bi=void 0;for(ji=bi-2;ji>=-1&&ji!==-1;ji--){var Ms=Number.MIN_VALUE+Cu*Math.abs(Ar[ji]+Math.abs(Ar[ji+1]));if(Math.abs(da[ji])<=Ms||Number.isNaN(da[ji])){da[ji]=0;break}}if(ji===bi-2)Bi=4;else{var os=void 0;for(os=bi-1;os>=ji&&os!==ji;os--){var Ws=(os!==bi?Math.abs(da[os]):0)+(os!==ji+1?Math.abs(da[os-1]):0);if(Math.abs(Ar[os])<=Cu*Ws){Ar[os]=0;break}}os===ji?Bi=3:os===bi-1?Bi=1:(Bi=2,ji=os)}switch(ji++,Bi){case 1:{var Ss=da[bi-2];da[bi-2]=0;for(var Qs=bi-2;Qs>=ji;Qs--){var Qu=Da(Ar[Qs],Ss),xn=Ar[Qs]/Qu,Vr=Ss/Qu;if(Ar[Qs]=Qu,Qs!==ji&&(Ss=-Vr*da[Qs-1],da[Qs-1]=xn*da[Qs-1]),He)for(var pa=0;pa<X;pa++)Qu=xn*za.get(pa,Qs)+Vr*za.get(pa,bi-1),za.set(pa,bi-1,-Vr*za.get(pa,Qs)+xn*za.get(pa,bi-1)),za.set(pa,Qs,Qu)}break}case 2:{var Fa=da[ji-1];da[ji-1]=0;for(var Vi=ji;Vi<bi;Vi++){var Ao=Da(Ar[Vi],Fa),ao=Ar[Vi]/Ao,So=Fa/Ao;if(Ar[Vi]=Ao,Fa=-So*da[Vi],da[Vi]=ao*da[Vi],tn)for(var Ts=0;Ts<H;Ts++)Ao=ao*na.get(Ts,Vi)+So*na.get(Ts,ji-1),na.set(Ts,ji-1,-So*na.get(Ts,Vi)+ao*na.get(Ts,ji-1)),na.set(Ts,Vi,Ao)}break}case 3:{var fo=Math.max(Math.abs(Ar[bi-1]),Math.abs(Ar[bi-2]),Math.abs(da[bi-2]),Math.abs(Ar[ji]),Math.abs(da[ji])),ou=Ar[bi-1]/fo,Cs=Ar[bi-2]/fo,Au=da[bi-2]/fo,Tl=Ar[ji]/fo,bl=da[ji]/fo,Js=((Cs+ou)*(Cs-ou)+Au*Au)/2,ul=ou*Au*(ou*Au),Mu=0;(Js!==0||ul!==0)&&(Js<0?Mu=0-Math.sqrt(Js*Js+ul):Mu=Math.sqrt(Js*Js+ul),Mu=ul/(Js+Mu));for(var Pu=(Tl+ou)*(Tl-ou)+Mu,Nu=Tl*bl,fs=ji;fs<bi-1;fs++){var Bs=Da(Pu,Nu);Bs===0&&(Bs=Number.MIN_VALUE);var gu=Pu/Bs,Fu=Nu/Bs;if(fs!==ji&&(da[fs-1]=Bs),Pu=gu*Ar[fs]+Fu*da[fs],da[fs]=gu*da[fs]-Fu*Ar[fs],Nu=Fu*Ar[fs+1],Ar[fs+1]=gu*Ar[fs+1],He)for(var Wu=0;Wu<X;Wu++)Bs=gu*za.get(Wu,fs)+Fu*za.get(Wu,fs+1),za.set(Wu,fs+1,-Fu*za.get(Wu,fs)+gu*za.get(Wu,fs+1)),za.set(Wu,fs,Bs);if(Bs=Da(Pu,Nu),Bs===0&&(Bs=Number.MIN_VALUE),gu=Pu/Bs,Fu=Nu/Bs,Ar[fs]=Bs,Pu=gu*da[fs]+Fu*Ar[fs+1],Ar[fs+1]=-Fu*da[fs]+gu*Ar[fs+1],Nu=Fu*da[fs+1],da[fs+1]=gu*da[fs+1],tn&&fs<H-1)for(var Ju=0;Ju<H;Ju++)Bs=gu*na.get(Ju,fs)+Fu*na.get(Ju,fs+1),na.set(Ju,fs+1,-Fu*na.get(Ju,fs)+gu*na.get(Ju,fs+1)),na.set(Ju,fs,Bs)}da[bi-2]=Pu,qs=qs+1;break}case 4:{if(Ar[ji]<=0&&(Ar[ji]=Ar[ji]<0?-Ar[ji]:0,He))for(var tu=0;tu<=Du;tu++)za.set(tu,ji,-za.get(tu,ji));for(;ji<Du&&!(Ar[ji]>=Ar[ji+1]);){var gc=Ar[ji];if(Ar[ji]=Ar[ji+1],Ar[ji+1]=gc,He&&ji<X-1)for(var Bl=0;Bl<X;Bl++)gc=za.get(Bl,ji+1),za.set(Bl,ji+1,za.get(Bl,ji)),za.set(Bl,ji,gc);if(tn&&ji<H-1)for(var vl=0;vl<H;vl++)gc=na.get(vl,ji+1),na.set(vl,ji+1,na.get(vl,ji)),na.set(vl,ji,gc);ji++}qs=0,bi--;break}}}if(Qn){var Ls=za;za=na,na=Ls}this.m=H,this.n=X,this.s=Ar,this.U=na,this.V=za}return(0,Q.Z)(Lt,[{key:"solve",value:function(it){for(var H=it,X=this.threshold,xt=this.s.length,zt=ee.zeros(xt,xt),Vt=0;Vt<xt;Vt++)Math.abs(this.s[Vt])<=X?zt.set(Vt,Vt,0):zt.set(Vt,Vt,1/this.s[Vt]);for(var Xt=this.U,ne=this.rightSingularVectors,on=ne.mmul(zt),tn=ne.rows,He=Xt.rows,Qn=ee.zeros(tn,He),Ln=0;Ln<tn;Ln++)for(var Qr=0;Qr<He;Qr++){for(var Ia=0,Jn=0;Jn<xt;Jn++)Ia+=on.get(Ln,Jn)*Xt.get(Qr,Jn);Qn.set(Ln,Qr,Ia)}return Qn.mmul(H)}},{key:"solveForDiagonal",value:function(it){return this.solve(ee.diag(it))}},{key:"inverse",value:function(){for(var it=this.V,H=this.threshold,X=it.rows,xt=it.columns,zt=new ee(X,this.s.length),Vt=0;Vt<X;Vt++)for(var Xt=0;Xt<xt;Xt++)Math.abs(this.s[Xt])>H&&zt.set(Vt,Xt,it.get(Vt,Xt)/this.s[Xt]);for(var ne=this.U,on=ne.rows,tn=ne.columns,He=new ee(X,on),Qn=0;Qn<X;Qn++)for(var Ln=0;Ln<on;Ln++){for(var Qr=0,Ia=0;Ia<tn;Ia++)Qr+=zt.get(Qn,Ia)*ne.get(Ln,Ia);He.set(Qn,Ln,Qr)}return He}},{key:"condition",get:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}},{key:"norm2",get:function(){return this.s[0]}},{key:"rank",get:function(){for(var it=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,H=0,X=this.s,xt=0,zt=X.length;xt<zt;xt++)X[xt]>it&&H++;return H}},{key:"diagonal",get:function(){return Array.from(this.s)}},{key:"threshold",get:function(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}},{key:"leftSingularVectors",get:function(){return this.U}},{key:"rightSingularVectors",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){return ee.diag(this.s)}}]),Lt}();function sr(Lt){var Ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Lt=fa.checkMatrix(Lt),Ot?new _n(Lt).inverse():Pn(Lt,ee.eye(Lt.rows))}function Pn(Lt,Ot){var it=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return Lt=fa.checkMatrix(Lt),Ot=fa.checkMatrix(Ot),it?new _n(Lt).solve(Ot):Lt.isSquare()?new aa(Lt).solve(Ot):new Lr(Lt).solve(Ot)}function tr(Lt){if(Lt=ee.checkMatrix(Lt),Lt.isSquare()){if(Lt.columns===0)return 1;var Ot,it,H,X;if(Lt.columns===2)return Ot=Lt.get(0,0),it=Lt.get(0,1),H=Lt.get(1,0),X=Lt.get(1,1),Ot*X-it*H;if(Lt.columns===3){var xt,zt,Vt;return xt=new Bn(Lt,[1,2],[1,2]),zt=new Bn(Lt,[1,2],[0,2]),Vt=new Bn(Lt,[1,2],[0,1]),Ot=Lt.get(0,0),it=Lt.get(0,1),H=Lt.get(0,2),Ot*tr(xt)-it*tr(zt)+H*tr(Vt)}else return new aa(Lt).determinant}else throw Error("determinant can only be calculated for a square matrix")}function zn(Lt,Ot){for(var it=[],H=0;H<Lt;H++)H!==Ot&&it.push(H);return it}function Wr(Lt,Ot,it){var H=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e-9,X=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e-9;if(Lt>X)return new Array(Ot.rows+1).fill(0);for(var xt=Ot.addRow(it,[0]),zt=0;zt<xt.rows;zt++)Math.abs(xt.get(zt,0))<H&&xt.set(zt,0,0);return xt.to1DArray()}function Yr(Lt){var Ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},it=Ot.thresholdValue,H=it===void 0?1e-9:it,X=Ot.thresholdError,xt=X===void 0?1e-9:X;Lt=ee.checkMatrix(Lt);for(var zt=Lt.rows,Vt=new ee(zt,zt),Xt=0;Xt<zt;Xt++){var ne=ee.columnVector(Lt.getRow(Xt)),on=Lt.subMatrixRow(zn(zt,Xt)).transpose(),tn=new _n(on),He=tn.solve(ne),Qn=ee.sub(ne,on.mmul(He)).abs().max();Vt.setRow(Xt,Wr(Qn,He,Xt,H,xt))}return Vt}function nr(Lt){var Ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.EPSILON;if(Lt=ee.checkMatrix(Lt),Lt.isEmpty())return Lt.transpose();for(var it=new _n(Lt,{autoTranspose:!0}),H=it.leftSingularVectors,X=it.rightSingularVectors,xt=it.diagonal,zt=0;zt<xt.length;zt++)Math.abs(xt[zt])>Ot?xt[zt]=1/xt[zt]:xt[zt]=0;return X.mmul(ee.diag(xt).mmul(H.transpose()))}function wr(Lt){var Ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lt,it=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Lt=new ee(Lt);var H=!1;if(typeof Ot=="object"&&!ee.isMatrix(Ot)&&!R(Ot)?(it=Ot,Ot=Lt,H=!0):Ot=new ee(Ot),Lt.rows!==Ot.rows)throw new TypeError("Both matrices must have the same number of rows");var X=it,xt=X.center,zt=xt===void 0?!0:xt;zt&&(Lt=Lt.center("column"),H||(Ot=Ot.center("column")));for(var Vt=Lt.transpose().mmul(Ot),Xt=0;Xt<Vt.rows;Xt++)for(var ne=0;ne<Vt.columns;ne++)Vt.set(Xt,ne,Vt.get(Xt,ne)*(1/(Lt.rows-1)));return Vt}function Sr(Lt){var Ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lt,it=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Lt=new ee(Lt);var H=!1;if(typeof Ot=="object"&&!ee.isMatrix(Ot)&&!R(Ot)?(it=Ot,Ot=Lt,H=!0):Ot=new ee(Ot),Lt.rows!==Ot.rows)throw new TypeError("Both matrices must have the same number of rows");var X=it,xt=X.center,zt=xt===void 0?!0:xt,Vt=X.scale,Xt=Vt===void 0?!0:Vt;zt&&(Lt.center("column"),H||Ot.center("column")),Xt&&(Lt.scale("column"),H||Ot.scale("column"));for(var ne=Lt.standardDeviation("column",{unbiased:!0}),on=H?ne:Ot.standardDeviation("column",{unbiased:!0}),tn=Lt.transpose().mmul(Ot),He=0;He<tn.rows;He++)for(var Qn=0;Qn<tn.columns;Qn++)tn.set(He,Qn,tn.get(He,Qn)*(1/(ne[He]*on[Qn]))*(1/(Lt.rows-1)));return tn}var pr=function(){function Lt(Ot){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,W.Z)(this,Lt);var H=it.assumeSymmetric,X=H===void 0?!1:H;if(Ot=fa.checkMatrix(Ot),!Ot.isSquare())throw new Error("Matrix is not a square matrix");if(Ot.isEmpty())throw new Error("Matrix must be non-empty");var xt=Ot.columns,zt=new ee(xt,xt),Vt=new Float64Array(xt),Xt=new Float64Array(xt),ne=Ot,on,tn,He=!1;if(X?He=!0:He=Ot.isSymmetric(),He){for(on=0;on<xt;on++)for(tn=0;tn<xt;tn++)zt.set(on,tn,ne.get(on,tn));qr(xt,Xt,Vt,zt),ua(xt,Xt,Vt,zt)}else{var Qn=new ee(xt,xt),Ln=new Float64Array(xt);for(tn=0;tn<xt;tn++)for(on=0;on<xt;on++)Qn.set(on,tn,ne.get(on,tn));$r(xt,Qn,Ln,zt),ba(xt,Xt,Vt,zt,Qn)}this.n=xt,this.e=Xt,this.d=Vt,this.V=zt}return(0,Q.Z)(Lt,[{key:"realEigenvalues",get:function(){return Array.from(this.d)}},{key:"imaginaryEigenvalues",get:function(){return Array.from(this.e)}},{key:"eigenvectorMatrix",get:function(){return this.V}},{key:"diagonalMatrix",get:function(){var it=this.n,H=this.e,X=this.d,xt=new ee(it,it),zt,Vt;for(zt=0;zt<it;zt++){for(Vt=0;Vt<it;Vt++)xt.set(zt,Vt,0);xt.set(zt,zt,X[zt]),H[zt]>0?xt.set(zt,zt+1,H[zt]):H[zt]<0&&xt.set(zt,zt-1,H[zt])}return xt}}]),Lt}();function qr(Lt,Ot,it,H){var X,xt,zt,Vt,Xt,ne,on,tn;for(Xt=0;Xt<Lt;Xt++)it[Xt]=H.get(Lt-1,Xt);for(Vt=Lt-1;Vt>0;Vt--){for(tn=0,zt=0,ne=0;ne<Vt;ne++)tn=tn+Math.abs(it[ne]);if(tn===0)for(Ot[Vt]=it[Vt-1],Xt=0;Xt<Vt;Xt++)it[Xt]=H.get(Vt-1,Xt),H.set(Vt,Xt,0),H.set(Xt,Vt,0);else{for(ne=0;ne<Vt;ne++)it[ne]/=tn,zt+=it[ne]*it[ne];for(X=it[Vt-1],xt=Math.sqrt(zt),X>0&&(xt=-xt),Ot[Vt]=tn*xt,zt=zt-X*xt,it[Vt-1]=X-xt,Xt=0;Xt<Vt;Xt++)Ot[Xt]=0;for(Xt=0;Xt<Vt;Xt++){for(X=it[Xt],H.set(Xt,Vt,X),xt=Ot[Xt]+H.get(Xt,Xt)*X,ne=Xt+1;ne<=Vt-1;ne++)xt+=H.get(ne,Xt)*it[ne],Ot[ne]+=H.get(ne,Xt)*X;Ot[Xt]=xt}for(X=0,Xt=0;Xt<Vt;Xt++)Ot[Xt]/=zt,X+=Ot[Xt]*it[Xt];for(on=X/(zt+zt),Xt=0;Xt<Vt;Xt++)Ot[Xt]-=on*it[Xt];for(Xt=0;Xt<Vt;Xt++){for(X=it[Xt],xt=Ot[Xt],ne=Xt;ne<=Vt-1;ne++)H.set(ne,Xt,H.get(ne,Xt)-(X*Ot[ne]+xt*it[ne]));it[Xt]=H.get(Vt-1,Xt),H.set(Vt,Xt,0)}}it[Vt]=zt}for(Vt=0;Vt<Lt-1;Vt++){if(H.set(Lt-1,Vt,H.get(Vt,Vt)),H.set(Vt,Vt,1),zt=it[Vt+1],zt!==0){for(ne=0;ne<=Vt;ne++)it[ne]=H.get(ne,Vt+1)/zt;for(Xt=0;Xt<=Vt;Xt++){for(xt=0,ne=0;ne<=Vt;ne++)xt+=H.get(ne,Vt+1)*H.get(ne,Xt);for(ne=0;ne<=Vt;ne++)H.set(ne,Xt,H.get(ne,Xt)-xt*it[ne])}}for(ne=0;ne<=Vt;ne++)H.set(ne,Vt+1,0)}for(Xt=0;Xt<Lt;Xt++)it[Xt]=H.get(Lt-1,Xt),H.set(Lt-1,Xt,0);H.set(Lt-1,Lt-1,1),Ot[0]=0}function ua(Lt,Ot,it,H){var X,xt,zt,Vt,Xt,ne,on,tn,He,Qn,Ln,Qr,Ia,Jn,Ar,na,za;for(zt=1;zt<Lt;zt++)Ot[zt-1]=Ot[zt];Ot[Lt-1]=0;var da=0,Ti=0,ki=Number.EPSILON;for(ne=0;ne<Lt;ne++){for(Ti=Math.max(Ti,Math.abs(it[ne])+Math.abs(Ot[ne])),on=ne;on<Lt&&!(Math.abs(Ot[on])<=ki*Ti);)on++;if(on>ne){za=0;do{for(za=za+1,X=it[ne],tn=(it[ne+1]-X)/(2*Ot[ne]),He=Da(tn,1),tn<0&&(He=-He),it[ne]=Ot[ne]/(tn+He),it[ne+1]=Ot[ne]*(tn+He),Qn=it[ne+1],xt=X-it[ne],zt=ne+2;zt<Lt;zt++)it[zt]-=xt;for(da=da+xt,tn=it[on],Ln=1,Qr=Ln,Ia=Ln,Jn=Ot[ne+1],Ar=0,na=0,zt=on-1;zt>=ne;zt--)for(Ia=Qr,Qr=Ln,na=Ar,X=Ln*Ot[zt],xt=Ln*tn,He=Da(tn,Ot[zt]),Ot[zt+1]=Ar*He,Ar=Ot[zt]/He,Ln=tn/He,tn=Ln*it[zt]-Ar*X,it[zt+1]=xt+Ar*(Ln*X+Ar*it[zt]),Xt=0;Xt<Lt;Xt++)xt=H.get(Xt,zt+1),H.set(Xt,zt+1,Ar*H.get(Xt,zt)+Ln*xt),H.set(Xt,zt,Ln*H.get(Xt,zt)-Ar*xt);tn=-Ar*na*Ia*Jn*Ot[ne]/Qn,Ot[ne]=Ar*tn,it[ne]=Ln*tn}while(Math.abs(Ot[ne])>ki*Ti)}it[ne]=it[ne]+da,Ot[ne]=0}for(zt=0;zt<Lt-1;zt++){for(Xt=zt,tn=it[zt],Vt=zt+1;Vt<Lt;Vt++)it[Vt]<tn&&(Xt=Vt,tn=it[Vt]);if(Xt!==zt)for(it[Xt]=it[zt],it[zt]=tn,Vt=0;Vt<Lt;Vt++)tn=H.get(Vt,zt),H.set(Vt,zt,H.get(Vt,Xt)),H.set(Vt,Xt,tn)}}function $r(Lt,Ot,it,H){var X=0,xt=Lt-1,zt,Vt,Xt,ne,on,tn,He;for(tn=X+1;tn<=xt-1;tn++){for(He=0,ne=tn;ne<=xt;ne++)He=He+Math.abs(Ot.get(ne,tn-1));if(He!==0){for(Xt=0,ne=xt;ne>=tn;ne--)it[ne]=Ot.get(ne,tn-1)/He,Xt+=it[ne]*it[ne];for(Vt=Math.sqrt(Xt),it[tn]>0&&(Vt=-Vt),Xt=Xt-it[tn]*Vt,it[tn]=it[tn]-Vt,on=tn;on<Lt;on++){for(zt=0,ne=xt;ne>=tn;ne--)zt+=it[ne]*Ot.get(ne,on);for(zt=zt/Xt,ne=tn;ne<=xt;ne++)Ot.set(ne,on,Ot.get(ne,on)-zt*it[ne])}for(ne=0;ne<=xt;ne++){for(zt=0,on=xt;on>=tn;on--)zt+=it[on]*Ot.get(ne,on);for(zt=zt/Xt,on=tn;on<=xt;on++)Ot.set(ne,on,Ot.get(ne,on)-zt*it[on])}it[tn]=He*it[tn],Ot.set(tn,tn-1,He*Vt)}}for(ne=0;ne<Lt;ne++)for(on=0;on<Lt;on++)H.set(ne,on,ne===on?1:0);for(tn=xt-1;tn>=X+1;tn--)if(Ot.get(tn,tn-1)!==0){for(ne=tn+1;ne<=xt;ne++)it[ne]=Ot.get(ne,tn-1);for(on=tn;on<=xt;on++){for(Vt=0,ne=tn;ne<=xt;ne++)Vt+=it[ne]*H.get(ne,on);for(Vt=Vt/it[tn]/Ot.get(tn,tn-1),ne=tn;ne<=xt;ne++)H.set(ne,on,H.get(ne,on)+Vt*it[ne])}}}function ba(Lt,Ot,it,H,X){var xt=Lt-1,zt=0,Vt=Lt-1,Xt=Number.EPSILON,ne=0,on=0,tn=0,He=0,Qn=0,Ln=0,Qr=0,Ia=0,Jn,Ar,na,za,da,Ti,ki,vi,ii,Di,Ra,ln,De,dn,Wn;for(Jn=0;Jn<Lt;Jn++)for((Jn<zt||Jn>Vt)&&(it[Jn]=X.get(Jn,Jn),Ot[Jn]=0),Ar=Math.max(Jn-1,0);Ar<Lt;Ar++)on=on+Math.abs(X.get(Jn,Ar));for(;xt>=zt;){for(za=xt;za>zt&&(Ln=Math.abs(X.get(za-1,za-1))+Math.abs(X.get(za,za)),Ln===0&&(Ln=on),!(Math.abs(X.get(za,za-1))<Xt*Ln));)za--;if(za===xt)X.set(xt,xt,X.get(xt,xt)+ne),it[xt]=X.get(xt,xt),Ot[xt]=0,xt--,Ia=0;else if(za===xt-1){if(ki=X.get(xt,xt-1)*X.get(xt-1,xt),tn=(X.get(xt-1,xt-1)-X.get(xt,xt))/2,He=tn*tn+ki,Qr=Math.sqrt(Math.abs(He)),X.set(xt,xt,X.get(xt,xt)+ne),X.set(xt-1,xt-1,X.get(xt-1,xt-1)+ne),vi=X.get(xt,xt),He>=0){for(Qr=tn>=0?tn+Qr:tn-Qr,it[xt-1]=vi+Qr,it[xt]=it[xt-1],Qr!==0&&(it[xt]=vi-ki/Qr),Ot[xt-1]=0,Ot[xt]=0,vi=X.get(xt,xt-1),Ln=Math.abs(vi)+Math.abs(Qr),tn=vi/Ln,He=Qr/Ln,Qn=Math.sqrt(tn*tn+He*He),tn=tn/Qn,He=He/Qn,Ar=xt-1;Ar<Lt;Ar++)Qr=X.get(xt-1,Ar),X.set(xt-1,Ar,He*Qr+tn*X.get(xt,Ar)),X.set(xt,Ar,He*X.get(xt,Ar)-tn*Qr);for(Jn=0;Jn<=xt;Jn++)Qr=X.get(Jn,xt-1),X.set(Jn,xt-1,He*Qr+tn*X.get(Jn,xt)),X.set(Jn,xt,He*X.get(Jn,xt)-tn*Qr);for(Jn=zt;Jn<=Vt;Jn++)Qr=H.get(Jn,xt-1),H.set(Jn,xt-1,He*Qr+tn*H.get(Jn,xt)),H.set(Jn,xt,He*H.get(Jn,xt)-tn*Qr)}else it[xt-1]=vi+tn,it[xt]=vi+tn,Ot[xt-1]=Qr,Ot[xt]=-Qr;xt=xt-2,Ia=0}else{if(vi=X.get(xt,xt),ii=0,ki=0,za<xt&&(ii=X.get(xt-1,xt-1),ki=X.get(xt,xt-1)*X.get(xt-1,xt)),Ia===10){for(ne+=vi,Jn=zt;Jn<=xt;Jn++)X.set(Jn,Jn,X.get(Jn,Jn)-vi);Ln=Math.abs(X.get(xt,xt-1))+Math.abs(X.get(xt-1,xt-2)),vi=ii=.75*Ln,ki=-.4375*Ln*Ln}if(Ia===30&&(Ln=(ii-vi)/2,Ln=Ln*Ln+ki,Ln>0)){for(Ln=Math.sqrt(Ln),ii<vi&&(Ln=-Ln),Ln=vi-ki/((ii-vi)/2+Ln),Jn=zt;Jn<=xt;Jn++)X.set(Jn,Jn,X.get(Jn,Jn)-Ln);ne+=Ln,vi=ii=ki=.964}for(Ia=Ia+1,da=xt-2;da>=za&&(Qr=X.get(da,da),Qn=vi-Qr,Ln=ii-Qr,tn=(Qn*Ln-ki)/X.get(da+1,da)+X.get(da,da+1),He=X.get(da+1,da+1)-Qr-Qn-Ln,Qn=X.get(da+2,da+1),Ln=Math.abs(tn)+Math.abs(He)+Math.abs(Qn),tn=tn/Ln,He=He/Ln,Qn=Qn/Ln,!(da===za||Math.abs(X.get(da,da-1))*(Math.abs(He)+Math.abs(Qn))<Xt*(Math.abs(tn)*(Math.abs(X.get(da-1,da-1))+Math.abs(Qr)+Math.abs(X.get(da+1,da+1))))));)da--;for(Jn=da+2;Jn<=xt;Jn++)X.set(Jn,Jn-2,0),Jn>da+2&&X.set(Jn,Jn-3,0);for(na=da;na<=xt-1&&(dn=na!==xt-1,na!==da&&(tn=X.get(na,na-1),He=X.get(na+1,na-1),Qn=dn?X.get(na+2,na-1):0,vi=Math.abs(tn)+Math.abs(He)+Math.abs(Qn),vi!==0&&(tn=tn/vi,He=He/vi,Qn=Qn/vi)),vi!==0);na++)if(Ln=Math.sqrt(tn*tn+He*He+Qn*Qn),tn<0&&(Ln=-Ln),Ln!==0){for(na!==da?X.set(na,na-1,-Ln*vi):za!==da&&X.set(na,na-1,-X.get(na,na-1)),tn=tn+Ln,vi=tn/Ln,ii=He/Ln,Qr=Qn/Ln,He=He/tn,Qn=Qn/tn,Ar=na;Ar<Lt;Ar++)tn=X.get(na,Ar)+He*X.get(na+1,Ar),dn&&(tn=tn+Qn*X.get(na+2,Ar),X.set(na+2,Ar,X.get(na+2,Ar)-tn*Qr)),X.set(na,Ar,X.get(na,Ar)-tn*vi),X.set(na+1,Ar,X.get(na+1,Ar)-tn*ii);for(Jn=0;Jn<=Math.min(xt,na+3);Jn++)tn=vi*X.get(Jn,na)+ii*X.get(Jn,na+1),dn&&(tn=tn+Qr*X.get(Jn,na+2),X.set(Jn,na+2,X.get(Jn,na+2)-tn*Qn)),X.set(Jn,na,X.get(Jn,na)-tn),X.set(Jn,na+1,X.get(Jn,na+1)-tn*He);for(Jn=zt;Jn<=Vt;Jn++)tn=vi*H.get(Jn,na)+ii*H.get(Jn,na+1),dn&&(tn=tn+Qr*H.get(Jn,na+2),H.set(Jn,na+2,H.get(Jn,na+2)-tn*Qn)),H.set(Jn,na,H.get(Jn,na)-tn),H.set(Jn,na+1,H.get(Jn,na+1)-tn*He)}}}if(on!==0){for(xt=Lt-1;xt>=0;xt--)if(tn=it[xt],He=Ot[xt],He===0)for(za=xt,X.set(xt,xt,1),Jn=xt-1;Jn>=0;Jn--){for(ki=X.get(Jn,Jn)-tn,Qn=0,Ar=za;Ar<=xt;Ar++)Qn=Qn+X.get(Jn,Ar)*X.get(Ar,xt);if(Ot[Jn]<0)Qr=ki,Ln=Qn;else if(za=Jn,Ot[Jn]===0?X.set(Jn,xt,ki!==0?-Qn/ki:-Qn/(Xt*on)):(vi=X.get(Jn,Jn+1),ii=X.get(Jn+1,Jn),He=(it[Jn]-tn)*(it[Jn]-tn)+Ot[Jn]*Ot[Jn],Ti=(vi*Ln-Qr*Qn)/He,X.set(Jn,xt,Ti),X.set(Jn+1,xt,Math.abs(vi)>Math.abs(Qr)?(-Qn-ki*Ti)/vi:(-Ln-ii*Ti)/Qr)),Ti=Math.abs(X.get(Jn,xt)),Xt*Ti*Ti>1)for(Ar=Jn;Ar<=xt;Ar++)X.set(Ar,xt,X.get(Ar,xt)/Ti)}else if(He<0)for(za=xt-1,Math.abs(X.get(xt,xt-1))>Math.abs(X.get(xt-1,xt))?(X.set(xt-1,xt-1,He/X.get(xt,xt-1)),X.set(xt-1,xt,-(X.get(xt,xt)-tn)/X.get(xt,xt-1))):(Wn=gt(0,-X.get(xt-1,xt),X.get(xt-1,xt-1)-tn,He),X.set(xt-1,xt-1,Wn[0]),X.set(xt-1,xt,Wn[1])),X.set(xt,xt-1,0),X.set(xt,xt,1),Jn=xt-2;Jn>=0;Jn--){for(Di=0,Ra=0,Ar=za;Ar<=xt;Ar++)Di=Di+X.get(Jn,Ar)*X.get(Ar,xt-1),Ra=Ra+X.get(Jn,Ar)*X.get(Ar,xt);if(ki=X.get(Jn,Jn)-tn,Ot[Jn]<0)Qr=ki,Qn=Di,Ln=Ra;else if(za=Jn,Ot[Jn]===0?(Wn=gt(-Di,-Ra,ki,He),X.set(Jn,xt-1,Wn[0]),X.set(Jn,xt,Wn[1])):(vi=X.get(Jn,Jn+1),ii=X.get(Jn+1,Jn),ln=(it[Jn]-tn)*(it[Jn]-tn)+Ot[Jn]*Ot[Jn]-He*He,De=(it[Jn]-tn)*2*He,ln===0&&De===0&&(ln=Xt*on*(Math.abs(ki)+Math.abs(He)+Math.abs(vi)+Math.abs(ii)+Math.abs(Qr))),Wn=gt(vi*Qn-Qr*Di+He*Ra,vi*Ln-Qr*Ra-He*Di,ln,De),X.set(Jn,xt-1,Wn[0]),X.set(Jn,xt,Wn[1]),Math.abs(vi)>Math.abs(Qr)+Math.abs(He)?(X.set(Jn+1,xt-1,(-Di-ki*X.get(Jn,xt-1)+He*X.get(Jn,xt))/vi),X.set(Jn+1,xt,(-Ra-ki*X.get(Jn,xt)-He*X.get(Jn,xt-1))/vi)):(Wn=gt(-Qn-ii*X.get(Jn,xt-1),-Ln-ii*X.get(Jn,xt),Qr,He),X.set(Jn+1,xt-1,Wn[0]),X.set(Jn+1,xt,Wn[1]))),Ti=Math.max(Math.abs(X.get(Jn,xt-1)),Math.abs(X.get(Jn,xt))),Xt*Ti*Ti>1)for(Ar=Jn;Ar<=xt;Ar++)X.set(Ar,xt-1,X.get(Ar,xt-1)/Ti),X.set(Ar,xt,X.get(Ar,xt)/Ti)}for(Jn=0;Jn<Lt;Jn++)if(Jn<zt||Jn>Vt)for(Ar=Jn;Ar<Lt;Ar++)H.set(Jn,Ar,X.get(Jn,Ar));for(Ar=Lt-1;Ar>=zt;Ar--)for(Jn=zt;Jn<=Vt;Jn++){for(Qr=0,na=zt;na<=Math.min(Ar,Vt);na++)Qr=Qr+H.get(Jn,na)*X.get(na,Ar);H.set(Jn,Ar,Qr)}}}function gt(Lt,Ot,it,H){var X,xt;return Math.abs(it)>Math.abs(H)?(X=H/it,xt=it+X*H,[(Lt+X*Ot)/xt,(Ot-X*Lt)/xt]):(X=it/H,xt=H+X*it,[(X*Lt+Ot)/xt,(X*Ot-Lt)/xt])}var Dn=function(){function Lt(Ot){if((0,W.Z)(this,Lt),Ot=fa.checkMatrix(Ot),!Ot.isSymmetric())throw new Error("Matrix is not symmetric");var it=Ot,H=it.rows,X=new ee(H,H),xt=!0,zt,Vt,Xt;for(Vt=0;Vt<H;Vt++){var ne=0;for(Xt=0;Xt<Vt;Xt++){var on=0;for(zt=0;zt<Xt;zt++)on+=X.get(Xt,zt)*X.get(Vt,zt);on=(it.get(Vt,Xt)-on)/X.get(Xt,Xt),X.set(Vt,Xt,on),ne=ne+on*on}for(ne=it.get(Vt,Vt)-ne,xt&=ne>0,X.set(Vt,Vt,Math.sqrt(Math.max(ne,0))),Xt=Vt+1;Xt<H;Xt++)X.set(Vt,Xt,0)}this.L=X,this.positiveDefinite=Boolean(xt)}return(0,Q.Z)(Lt,[{key:"isPositiveDefinite",value:function(){return this.positiveDefinite}},{key:"solve",value:function(it){it=fa.checkMatrix(it);var H=this.L,X=H.rows;if(it.rows!==X)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");var xt=it.columns,zt=it.clone(),Vt,Xt,ne;for(ne=0;ne<X;ne++)for(Xt=0;Xt<xt;Xt++){for(Vt=0;Vt<ne;Vt++)zt.set(ne,Xt,zt.get(ne,Xt)-zt.get(Vt,Xt)*H.get(ne,Vt));zt.set(ne,Xt,zt.get(ne,Xt)/H.get(ne,ne))}for(ne=X-1;ne>=0;ne--)for(Xt=0;Xt<xt;Xt++){for(Vt=ne+1;Vt<X;Vt++)zt.set(ne,Xt,zt.get(ne,Xt)-zt.get(Vt,Xt)*H.get(Vt,ne));zt.set(ne,Xt,zt.get(ne,Xt)/H.get(ne,ne))}return zt}},{key:"lowerTriangularMatrix",get:function(){return this.L}}]),Lt}(),un=(0,Q.Z)(function Lt(Ot){var it=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,W.Z)(this,Lt),Ot=fa.checkMatrix(Ot);var H=it.Y,X=it.scaleScores,xt=X===void 0?!1:X,zt=it.maxIterations,Vt=zt===void 0?1e3:zt,Xt=it.terminationCriteria,ne=Xt===void 0?1e-10:Xt,on;if(H){if(R(H)&&typeof H[0]=="number"?H=ee.columnVector(H):H=fa.checkMatrix(H),H.rows!==Ot.rows)throw new Error("Y should have the same number of rows as X");on=H.getColumnVector(0)}else on=Ot.getColumnVector(0);for(var tn=1,He,Qn,Ln,Qr,Ia=0;Ia<Vt&&tn>ne;Ia++)Ln=Ot.transpose().mmul(on).div(on.transpose().mmul(on).get(0,0)),Ln=Ln.div(Ln.norm()),He=Ot.mmul(Ln).div(Ln.transpose().mmul(Ln).get(0,0)),Ia>0&&(tn=He.clone().sub(Qr).pow(2).sum()),Qr=He.clone(),H?(Qn=H.transpose().mmul(He).div(He.transpose().mmul(He).get(0,0)),Qn=Qn.div(Qn.norm()),on=H.mmul(Qn).div(Qn.transpose().mmul(Qn).get(0,0))):on=He;if(H){var Jn=Ot.transpose().mmul(He).div(He.transpose().mmul(He).get(0,0));Jn=Jn.div(Jn.norm());var Ar=Ot.clone().sub(He.clone().mmul(Jn.transpose())),na=on.transpose().mmul(He).div(He.transpose().mmul(He).get(0,0)),za=H.clone().sub(He.clone().mulS(na.get(0,0)).mmul(Qn.transpose()));this.t=He,this.p=Jn.transpose(),this.w=Ln.transpose(),this.q=Qn,this.u=on,this.s=He.transpose().mmul(He),this.xResidual=Ar,this.yResidual=za,this.betas=na}else this.w=Ln.transpose(),this.s=He.transpose().mmul(He).sqrt(),xt?this.t=He.clone().div(this.s.get(0,0)):this.t=He,this.xResidual=Ot.sub(He.mmul(Ln.transpose()))})},27279:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return rn}});var Y=$(22122),tt=$(96156),j=$(8812),W=$(94184),Q=$.n(W),Z=$(85061),R=$(6610),L=$(5991),C=$(10379),A=$(54070),N=$(90484),B=$(50344),O=$(67294),F=$(96774),K=$.n(F),nt=$(81253),P=$(5461),k=$(28481),yt=O.forwardRef(function(Ee,ce){var Oe,Ze=Ee.prefixCls,fe=Ee.forceRender,Ae=Ee.className,Ye=Ee.style,ge=Ee.children,Be=Ee.isActive,te=Ee.role,ke=O.useState(Be||fe),Ve=(0,k.Z)(ke,2),ee=Ve[0],Ft=Ve[1];return O.useEffect(function(){(fe||Be)&&Ft(!0)},[fe,Be]),ee?O.createElement("div",{ref:ce,className:Q()("".concat(Ze,"-content"),(Oe={},(0,tt.Z)(Oe,"".concat(Ze,"-content-active"),Be),(0,tt.Z)(Oe,"".concat(Ze,"-content-inactive"),!Be),Oe),Ae),style:Ye,role:te},O.createElement("div",{className:"".concat(Ze,"-content-box")},ge)):null});yt.displayName="PanelContent";var st=yt,lt=["className","id","style","prefixCls","headerClass","children","isActive","destroyInactivePanel","accordion","forceRender","openMotion","extra","collapsible"],ht=function(Ee){(0,C.Z)(Oe,Ee);var ce=(0,A.Z)(Oe);function Oe(){var Ze;(0,R.Z)(this,Oe);for(var fe=arguments.length,Ae=new Array(fe),Ye=0;Ye<fe;Ye++)Ae[Ye]=arguments[Ye];return Ze=ce.call.apply(ce,[this].concat(Ae)),Ze.onItemClick=function(){var ge=Ze.props,Be=ge.onItemClick,te=ge.panelKey;typeof Be=="function"&&Be(te)},Ze.handleKeyPress=function(ge){(ge.key==="Enter"||ge.keyCode===13||ge.which===13)&&Ze.onItemClick()},Ze.renderIcon=function(){var ge=Ze.props,Be=ge.showArrow,te=ge.expandIcon,ke=ge.prefixCls,Ve=ge.collapsible;if(!Be)return null;var ee=typeof te=="function"?te(Ze.props):O.createElement("i",{className:"arrow"});return ee&&O.createElement("div",{className:"".concat(ke,"-expand-icon"),onClick:Ve==="header"||Ve==="icon"?Ze.onItemClick:null},ee)},Ze.renderTitle=function(){var ge=Ze.props,Be=ge.header,te=ge.prefixCls,ke=ge.collapsible;return O.createElement("span",{className:"".concat(te,"-header-text"),onClick:ke==="header"?Ze.onItemClick:null},Be)},Ze}return(0,L.Z)(Oe,[{key:"shouldComponentUpdate",value:function(fe){return!K()(this.props,fe)}},{key:"render",value:function(){var fe,Ae,Ye=this.props,ge=Ye.className,Be=Ye.id,te=Ye.style,ke=Ye.prefixCls,Ve=Ye.headerClass,ee=Ye.children,Ft=Ye.isActive,bt=Ye.destroyInactivePanel,Me=Ye.accordion,en=Ye.forceRender,fn=Ye.openMotion,Rt=Ye.extra,Xn=Ye.collapsible,Bn=(0,nt.Z)(Ye,lt),xr=Xn==="disabled",dr=Xn==="header",Ur=Xn==="icon",fa=Q()((fe={},(0,tt.Z)(fe,"".concat(ke,"-item"),!0),(0,tt.Z)(fe,"".concat(ke,"-item-active"),Ft),(0,tt.Z)(fe,"".concat(ke,"-item-disabled"),xr),fe),ge),Ea=Q()("".concat(ke,"-header"),(Ae={},(0,tt.Z)(Ae,Ve,Ve),(0,tt.Z)(Ae,"".concat(ke,"-header-collapsible-only"),dr),(0,tt.Z)(Ae,"".concat(ke,"-icon-collapsible-only"),Ur),Ae)),aa={className:Ea,"aria-expanded":Ft,"aria-disabled":xr,onKeyPress:this.handleKeyPress};!dr&&!Ur&&(aa.onClick=this.onItemClick,aa.role=Me?"tab":"button",aa.tabIndex=xr?-1:0);var Da=Rt!=null&&typeof Rt!="boolean";return delete Bn.header,delete Bn.panelKey,delete Bn.onItemClick,delete Bn.showArrow,delete Bn.expandIcon,O.createElement("div",(0,Y.Z)({},Bn,{className:fa,style:te,id:Be}),O.createElement("div",aa,this.renderIcon(),this.renderTitle(),Da&&O.createElement("div",{className:"".concat(ke,"-extra")},Rt)),O.createElement(P.default,(0,Y.Z)({visible:Ft,leavedClassName:"".concat(ke,"-content-hidden")},fn,{forceRender:en,removeOnLeave:bt}),function(Lr,_n){var sr=Lr.className,Pn=Lr.style;return O.createElement(st,{ref:_n,prefixCls:ke,className:sr,style:Pn,isActive:Ft,forceRender:en,role:Me?"tabpanel":null},ee)}))}}]),Oe}(O.Component);ht.defaultProps={showArrow:!0,isActive:!1,onItemClick:function(){},headerClass:"",forceRender:!1};var mt=ht;function wt(Ee){var ce=Ee;if(!Array.isArray(ce)){var Oe=(0,N.Z)(ce);ce=Oe==="number"||Oe==="string"?[ce]:[]}return ce.map(function(Ze){return String(Ze)})}var ut=function(Ee){(0,C.Z)(Oe,Ee);var ce=(0,A.Z)(Oe);function Oe(Ze){var fe;(0,R.Z)(this,Oe),fe=ce.call(this,Ze),fe.onClickItem=function(Be){var te=fe.state.activeKey;if(fe.props.accordion)te=te[0]===Be?[]:[Be];else{te=(0,Z.Z)(te);var ke=te.indexOf(Be),Ve=ke>-1;Ve?te.splice(ke,1):te.push(Be)}fe.setActiveKey(te)},fe.getNewChild=function(Be,te){if(!Be)return null;var ke=fe.state.activeKey,Ve=fe.props,ee=Ve.prefixCls,Ft=Ve.openMotion,bt=Ve.accordion,Me=Ve.destroyInactivePanel,en=Ve.expandIcon,fn=Ve.collapsible,Rt=Be.key||String(te),Xn=Be.props,Bn=Xn.header,xr=Xn.headerClass,dr=Xn.destroyInactivePanel,Ur=Xn.collapsible,fa=!1;bt?fa=ke[0]===Rt:fa=ke.indexOf(Rt)>-1;var Ea=Ur!=null?Ur:fn,aa={key:Rt,panelKey:Rt,header:Bn,headerClass:xr,isActive:fa,prefixCls:ee,destroyInactivePanel:dr!=null?dr:Me,openMotion:Ft,accordion:bt,children:Be.props.children,onItemClick:Ea==="disabled"?null:fe.onClickItem,expandIcon:en,collapsible:Ea};return typeof Be.type=="string"?Be:(Object.keys(aa).forEach(function(Da){typeof aa[Da]=="undefined"&&delete aa[Da]}),O.cloneElement(Be,aa))},fe.getItems=function(){var Be=fe.props.children;return(0,B.Z)(Be).map(fe.getNewChild)},fe.setActiveKey=function(Be){"activeKey"in fe.props||fe.setState({activeKey:Be}),fe.props.onChange(fe.props.accordion?Be[0]:Be)};var Ae=Ze.activeKey,Ye=Ze.defaultActiveKey,ge=Ye;return"activeKey"in Ze&&(ge=Ae),fe.state={activeKey:wt(ge)},fe}return(0,L.Z)(Oe,[{key:"shouldComponentUpdate",value:function(fe,Ae){return!K()(this.props,fe)||!K()(this.state,Ae)}},{key:"render",value:function(){var fe,Ae=this.props,Ye=Ae.prefixCls,ge=Ae.className,Be=Ae.style,te=Ae.accordion,ke=Q()((fe={},(0,tt.Z)(fe,Ye,!0),(0,tt.Z)(fe,ge,!!ge),fe));return O.createElement("div",{className:ke,style:Be,role:te?"tablist":null},this.getItems())}}],[{key:"getDerivedStateFromProps",value:function(fe){var Ae={};return"activeKey"in fe&&(Ae.activeKey=wt(fe.activeKey)),Ae}}]),Oe}(O.Component);ut.defaultProps={prefixCls:"rc-collapse",onChange:function(){},accordion:!1,destroyInactivePanel:!1},ut.Panel=mt;var pt=ut,Nt=pt,Ut=pt.Panel,ue=$(98423),se=$(53124),Le=$(33603),Ne=$(96159),we=function(ce){var Oe=O.useContext(se.E_),Ze=Oe.getPrefixCls,fe=ce.prefixCls,Ae=ce.className,Ye=Ae===void 0?"":Ae,ge=ce.showArrow,Be=ge===void 0?!0:ge,te=Ze("collapse",fe),ke=Q()((0,tt.Z)({},"".concat(te,"-no-arrow"),!Be),Ye);return O.createElement(Nt.Panel,(0,Y.Z)({},ce,{prefixCls:te,className:ke}))},At=we,Qt=function(ce){var Oe,Ze=O.useContext(se.E_),fe=Ze.getPrefixCls,Ae=Ze.direction,Ye=ce.prefixCls,ge=ce.className,Be=ge===void 0?"":ge,te=ce.bordered,ke=te===void 0?!0:te,Ve=ce.ghost,ee=ce.expandIconPosition,Ft=ee===void 0?"start":ee,bt=fe("collapse",Ye),Me=O.useMemo(function(){return Ft==="left"?"start":Ft==="right"?"end":Ft},[Ft]),en=function(){var xr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},dr=ce.expandIcon,Ur=dr?dr(xr):O.createElement(j.Z,{rotate:xr.isActive?90:void 0});return(0,Ne.Tm)(Ur,function(){return{className:Q()(Ur.props.className,"".concat(bt,"-arrow"))}})},fn=Q()("".concat(bt,"-icon-position-").concat(Me),(Oe={},(0,tt.Z)(Oe,"".concat(bt,"-borderless"),!ke),(0,tt.Z)(Oe,"".concat(bt,"-rtl"),Ae==="rtl"),(0,tt.Z)(Oe,"".concat(bt,"-ghost"),!!Ve),Oe),Be),Rt=(0,Y.Z)((0,Y.Z)({},Le.ZP),{motionAppear:!1,leavedClassName:"".concat(bt,"-content-hidden")}),Xn=function(){var xr=ce.children;return(0,B.Z)(xr).map(function(dr,Ur){var fa;if((fa=dr.props)===null||fa===void 0?void 0:fa.disabled){var Ea=dr.key||String(Ur),aa=dr.props,Da=aa.disabled,Lr=aa.collapsible,_n=(0,Y.Z)((0,Y.Z)({},(0,ue.Z)(dr.props,["disabled"])),{key:Ea,collapsible:Lr!=null?Lr:Da?"disabled":void 0});return(0,Ne.Tm)(dr,_n)}return dr})};return O.createElement(Nt,(0,Y.Z)({openMotion:Rt},ce,{expandIcon:en,prefixCls:bt,className:fn}),Xn())};Qt.Panel=At;var de=Qt,rn=de},7359:function(ur,ot,$){"use strict";var Y=$(38663),tt=$.n(Y),j=$(50596),W=$.n(j)},77933:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return Be}});var Y=$(96156),tt=$(85061),j=$(22122),W=$(6610),Q=$(5991),Z=$(10379),R=$(54070),L=$(94184),C=$.n(L),A=$(67294),N=$(53124),B=$(88258),O=$(65223),F=$(42051),K=$(85636),nt=$(9708),P=$(57254),k=$(98423),yt=$(9676),st=$(13013),lt=$(96159),ht=$(90484),mt=$(23492),wt=$(93355),ut=$(73171),pt=$(34952),Nt=function(ke){var Ve,ee=ke.renderedText,Ft=ke.renderedEl,bt=ke.item,Me=ke.checked,en=ke.disabled,fn=ke.prefixCls,Rt=ke.onClick,Xn=ke.onRemove,Bn=ke.showRemove,xr=C()((Ve={},(0,Y.Z)(Ve,"".concat(fn,"-content-item"),!0),(0,Y.Z)(Ve,"".concat(fn,"-content-item-disabled"),en||bt.disabled),(0,Y.Z)(Ve,"".concat(fn,"-content-item-checked"),Me),Ve)),dr;return(typeof ee=="string"||typeof ee=="number")&&(dr=String(ee)),A.createElement(F.Z,{componentName:"Transfer",defaultLocale:K.Z.Transfer},function(Ur){var fa={className:xr,title:dr},Ea=A.createElement("span",{className:"".concat(fn,"-content-item-text")},Ft);return Bn?A.createElement("li",(0,j.Z)({},fa),Ea,A.createElement(pt.Z,{disabled:en||bt.disabled,className:"".concat(fn,"-content-item-remove"),"aria-label":Ur.remove,onClick:function(){Xn==null||Xn(bt)}},A.createElement(ut.Z,null))):(fa.onClick=en||bt.disabled?void 0:function(){return Rt(bt)},A.createElement("li",(0,j.Z)({},fa),A.createElement(yt.Z,{className:"".concat(fn,"-checkbox"),checked:Me,disabled:en||bt.disabled}),Ea))})},Ut=A.memo(Nt),ue=(0,wt.b)("handleFilter","handleClear","checkedKeys");function se(te){if(!te)return null;var ke={pageSize:10,simple:!0,showSizeChanger:!1,showLessItems:!1};return(0,ht.Z)(te)==="object"?(0,j.Z)((0,j.Z)({},ke),te):ke}var Le=function(te){(0,Z.Z)(Ve,te);var ke=(0,R.Z)(Ve);function Ve(){var ee;return(0,W.Z)(this,Ve),ee=ke.apply(this,arguments),ee.state={current:1},ee.onItemSelect=function(Ft){var bt=ee.props,Me=bt.onItemSelect,en=bt.selectedKeys,fn=en.includes(Ft.key);Me(Ft.key,!fn)},ee.onItemRemove=function(Ft){var bt=ee.props.onItemRemove;bt==null||bt([Ft.key])},ee.onPageChange=function(Ft){ee.setState({current:Ft})},ee.getItems=function(){var Ft=ee.state.current,bt=ee.props,Me=bt.pagination,en=bt.filteredRenderItems,fn=se(Me),Rt=en;return fn&&(Rt=en.slice((Ft-1)*fn.pageSize,Ft*fn.pageSize)),Rt},ee}return(0,Q.Z)(Ve,[{key:"render",value:function(){var Ft=this,bt=this.state.current,Me=this.props,en=Me.prefixCls,fn=Me.onScroll,Rt=Me.filteredRenderItems,Xn=Me.selectedKeys,Bn=Me.disabled,xr=Me.showRemove,dr=Me.pagination,Ur=se(dr),fa=null;return Ur&&(fa=A.createElement(mt.Z,{simple:Ur.simple,showSizeChanger:Ur.showSizeChanger,showLessItems:Ur.showLessItems,size:"small",disabled:Bn,className:"".concat(en,"-pagination"),total:Rt.length,pageSize:Ur.pageSize,current:bt,onChange:this.onPageChange})),A.createElement(A.Fragment,null,A.createElement("ul",{className:C()("".concat(en,"-content"),(0,Y.Z)({},"".concat(en,"-content-show-remove"),xr)),onScroll:fn},this.getItems().map(function(Ea){var aa=Ea.renderedEl,Da=Ea.renderedText,Lr=Ea.item,_n=Lr.disabled,sr=Xn.includes(Lr.key);return A.createElement(Ut,{disabled:Bn||_n,key:Lr.key,item:Lr,renderedText:Da,renderedEl:aa,checked:sr,prefixCls:en,onClick:Ft.onItemSelect,onRemove:Ft.onItemRemove,showRemove:xr})})),fa)}}],[{key:"getDerivedStateFromProps",value:function(Ft,bt){var Me=Ft.filteredRenderItems,en=Ft.pagination,fn=bt.current,Rt=se(en);if(Rt){var Xn=Math.ceil(Me.length/Rt.pageSize);if(fn>Xn)return{current:Xn}}return null}}]),Ve}(A.Component),Ne=Le,we=$(76570),At=$(4107);function Qt(te){var ke=te.placeholder,Ve=ke===void 0?"":ke,ee=te.value,Ft=te.prefixCls,bt=te.disabled,Me=te.onChange,en=te.handleClear,fn=A.useCallback(function(Rt){Me==null||Me(Rt),Rt.target.value===""&&(en==null||en())},[Me]);return A.createElement(At.Z,{placeholder:Ve,className:Ft,value:ee,onChange:fn,disabled:bt,allowClear:!0,prefix:A.createElement(we.Z,null)})}var de=function(){return null};function rn(te){return!!(te&&!(0,lt.l$)(te)&&Object.prototype.toString.call(te)==="[object Object]")}function Ee(te){return te.filter(function(ke){return!ke.disabled}).map(function(ke){return ke.key})}var ce=function(te){(0,Z.Z)(Ve,te);var ke=(0,R.Z)(Ve);function Ve(ee){var Ft;return(0,W.Z)(this,Ve),Ft=ke.call(this,ee),Ft.defaultListBodyRef=A.createRef(),Ft.handleFilter=function(bt){var Me=Ft.props.handleFilter,en=bt.target.value;Ft.setState({filterValue:en}),Me(bt)},Ft.handleClear=function(){var bt=Ft.props.handleClear;Ft.setState({filterValue:""}),bt()},Ft.matchFilter=function(bt,Me){var en=Ft.state.filterValue,fn=Ft.props.filterOption;return fn?fn(en,Me):bt.includes(en)},Ft.renderListBody=function(bt,Me){var en=bt?bt(Me):null,fn=!!en;return fn||(en=A.createElement(Ne,(0,j.Z)({ref:Ft.defaultListBodyRef},Me))),{customize:fn,bodyContent:en}},Ft.renderItem=function(bt){var Me=Ft.props.render,en=Me===void 0?de:Me,fn=en(bt),Rt=rn(fn);return{renderedText:Rt?fn.value:fn,renderedEl:Rt?fn.label:fn,item:bt}},Ft.getSelectAllLabel=function(bt,Me){var en=Ft.props,fn=en.itemsUnit,Rt=en.itemUnit,Xn=en.selectAllLabel;if(Xn)return typeof Xn=="function"?Xn({selectedCount:bt,totalCount:Me}):Xn;var Bn=Me>1?fn:Rt;return A.createElement(A.Fragment,null,(bt>0?"".concat(bt,"/"):"")+Me," ",Bn)},Ft.state={filterValue:""},Ft}return(0,Q.Z)(Ve,[{key:"componentWillUnmount",value:function(){clearTimeout(this.triggerScrollTimer)}},{key:"getCheckStatus",value:function(Ft){var bt=this.props.checkedKeys;return bt.length===0?"none":Ft.every(function(Me){return bt.includes(Me.key)||!!Me.disabled})?"all":"part"}},{key:"getFilteredItems",value:function(Ft,bt){var Me=this,en=[],fn=[];return Ft.forEach(function(Rt){var Xn=Me.renderItem(Rt),Bn=Xn.renderedText;if(bt&&!Me.matchFilter(Bn,Rt))return null;en.push(Rt),fn.push(Xn)}),{filteredItems:en,filteredRenderItems:fn}}},{key:"getListBody",value:function(Ft,bt,Me,en,fn,Rt,Xn,Bn,xr,dr){var Ur=this,fa=xr?A.createElement("div",{className:"".concat(Ft,"-body-search-wrapper")},A.createElement(Qt,{prefixCls:"".concat(Ft,"-search"),onChange:this.handleFilter,handleClear:this.handleClear,placeholder:bt,value:Me,disabled:dr})):null,Ea=this.renderListBody(Bn,(0,j.Z)((0,j.Z)({},(0,k.Z)(this.props,ue)),{filteredItems:en,filteredRenderItems:Rt,selectedKeys:Xn})),aa=Ea.bodyContent,Da=Ea.customize,Lr=function(){var Pn=Ur.props.direction==="left"?0:1;return Array.isArray(fn)?fn[Pn]:fn},_n;return Da?_n=A.createElement("div",{className:"".concat(Ft,"-body-customize-wrapper")},aa):_n=en.length?aa:A.createElement("div",{className:"".concat(Ft,"-body-not-found")},Lr()),A.createElement("div",{className:C()(xr?"".concat(Ft,"-body ").concat(Ft,"-body-with-search"):"".concat(Ft,"-body"))},fa,_n)}},{key:"getCheckBox",value:function(Ft){var bt=Ft.filteredItems,Me=Ft.onItemSelectAll,en=Ft.disabled,fn=Ft.prefixCls,Rt=this.getCheckStatus(bt),Xn=Rt==="all",Bn=A.createElement(yt.Z,{disabled:en,checked:Xn,indeterminate:Rt==="part",className:"".concat(fn,"-checkbox"),onChange:function(){Me(bt.filter(function(dr){return!dr.disabled}).map(function(dr){var Ur=dr.key;return Ur}),!Xn)}});return Bn}},{key:"render",value:function(){var Ft,bt=this,Me=this.state.filterValue,en=this.props,fn=en.prefixCls,Rt=en.dataSource,Xn=Rt===void 0?[]:Rt,Bn=en.titleText,xr=Bn===void 0?"":Bn,dr=en.checkedKeys,Ur=en.disabled,fa=en.footer,Ea=en.showSearch,aa=Ea===void 0?!1:Ea,Da=en.style,Lr=en.searchPlaceholder,_n=en.notFoundContent,sr=en.selectAll,Pn=en.selectCurrent,tr=en.selectInvert,zn=en.removeAll,Wr=en.removeCurrent,Yr=en.renderList,nr=en.onItemSelectAll,wr=en.onItemRemove,Sr=en.showSelectAll,pr=Sr===void 0?!0:Sr,qr=en.showRemove,ua=en.pagination,$r=en.direction,ba=fa&&(fa.length<2?fa(this.props):fa(this.props,{direction:$r})),gt=C()(fn,(Ft={},(0,Y.Z)(Ft,"".concat(fn,"-with-pagination"),!!ua),(0,Y.Z)(Ft,"".concat(fn,"-with-footer"),!!ba),Ft)),Dn=this.getFilteredItems(Xn,Me),un=Dn.filteredItems,Lt=Dn.filteredRenderItems,Ot=this.getListBody(fn,Lr,Me,un,_n,Lt,dr,Yr,aa,Ur),it=ba?A.createElement("div",{className:"".concat(fn,"-footer")},ba):null,H=!qr&&!ua&&this.getCheckBox({filteredItems:un,onItemSelectAll:nr,disabled:Ur,prefixCls:fn}),X;qr?X=[ua?{key:"removeCurrent",onClick:function(){var Vt,Xt=Ee((((Vt=bt.defaultListBodyRef.current)===null||Vt===void 0?void 0:Vt.getItems())||[]).map(function(ne){return ne.item}));wr==null||wr(Xt)},label:Wr}:null,{key:"removeAll",onClick:function(){wr==null||wr(Ee(un))},label:zn}].filter(function(zt){return zt}):X=[{key:"selectAll",onClick:function(){var Vt=Ee(un);nr(Vt,Vt.length!==dr.length)},label:sr},ua?{key:"selectCurrent",onClick:function(){var Vt,Xt=((Vt=bt.defaultListBodyRef.current)===null||Vt===void 0?void 0:Vt.getItems())||[];nr(Ee(Xt.map(function(ne){return ne.item})),!0)},label:Pn}:null,{key:"selectInvert",onClick:function(){var Vt,Xt;ua?Xt=Ee((((Vt=bt.defaultListBodyRef.current)===null||Vt===void 0?void 0:Vt.getItems())||[]).map(function(He){return He.item})):Xt=Ee(un);var ne=new Set(dr),on=[],tn=[];Xt.forEach(function(He){ne.has(He)?tn.push(He):on.push(He)}),nr(on,!0),nr(tn,!1)},label:tr}];var xt=A.createElement(st.Z,{className:"".concat(fn,"-header-dropdown"),menu:{items:X},disabled:Ur},A.createElement(P.Z,null));return A.createElement("div",{className:gt,style:Da},A.createElement("div",{className:"".concat(fn,"-header")},pr?A.createElement(A.Fragment,null,H,xt):null,A.createElement("span",{className:"".concat(fn,"-header-selected")},this.getSelectAllLabel(dr.length,un.length)),A.createElement("span",{className:"".concat(fn,"-header-title")},xr)),Ot,it)}}]),Ve}(A.PureComponent),Oe=$(67724),Ze=$(8812),fe=$(71577),Ae=function(ke){var Ve=ke.disabled,ee=ke.moveToLeft,Ft=ke.moveToRight,bt=ke.leftArrowText,Me=bt===void 0?"":bt,en=ke.rightArrowText,fn=en===void 0?"":en,Rt=ke.leftActive,Xn=ke.rightActive,Bn=ke.className,xr=ke.style,dr=ke.direction,Ur=ke.oneWay;return A.createElement("div",{className:Bn,style:xr},A.createElement(fe.Z,{type:"primary",size:"small",disabled:Ve||!Xn,onClick:Ft,icon:dr!=="rtl"?A.createElement(Ze.Z,null):A.createElement(Oe.Z,null)},fn),!Ur&&A.createElement(fe.Z,{type:"primary",size:"small",disabled:Ve||!Rt,onClick:ee,icon:dr!=="rtl"?A.createElement(Oe.Z,null):A.createElement(Ze.Z,null)},Me))},Ye=Ae,ge=function(te){(0,Z.Z)(Ve,te);var ke=(0,R.Z)(Ve);function Ve(ee){var Ft;(0,W.Z)(this,Ve),Ft=ke.call(this,ee),Ft.separatedDataSource=null,Ft.setStateKeys=function(Rt,Xn){Rt==="left"?Ft.setState(function(Bn){var xr=Bn.sourceSelectedKeys;return{sourceSelectedKeys:typeof Xn=="function"?Xn(xr||[]):Xn}}):Ft.setState(function(Bn){var xr=Bn.targetSelectedKeys;return{targetSelectedKeys:typeof Xn=="function"?Xn(xr||[]):Xn}})},Ft.getLocale=function(Rt,Xn){var Bn=Ft.props.locale,xr=Bn===void 0?{}:Bn;return(0,j.Z)((0,j.Z)((0,j.Z)({},Rt),{notFoundContent:Xn("Transfer")}),xr)},Ft.moveTo=function(Rt){var Xn=Ft.props,Bn=Xn.targetKeys,xr=Bn===void 0?[]:Bn,dr=Xn.dataSource,Ur=dr===void 0?[]:dr,fa=Xn.onChange,Ea=Ft.state,aa=Ea.sourceSelectedKeys,Da=Ea.targetSelectedKeys,Lr=Rt==="right"?aa:Da,_n=Lr.filter(function(tr){return!Ur.some(function(zn){return!!(tr===zn.key&&zn.disabled)})}),sr=Rt==="right"?_n.concat(xr):xr.filter(function(tr){return!_n.includes(tr)}),Pn=Rt==="right"?"left":"right";Ft.setStateKeys(Pn,[]),Ft.handleSelectChange(Pn,[]),fa==null||fa(sr,Rt,_n)},Ft.moveToLeft=function(){return Ft.moveTo("left")},Ft.moveToRight=function(){return Ft.moveTo("right")},Ft.onItemSelectAll=function(Rt,Xn,Bn){Ft.setStateKeys(Rt,function(xr){var dr=[];return Bn?dr=Array.from(new Set([].concat((0,tt.Z)(xr),(0,tt.Z)(Xn)))):dr=xr.filter(function(Ur){return!Xn.includes(Ur)}),Ft.handleSelectChange(Rt,dr),dr})},Ft.onLeftItemSelectAll=function(Rt,Xn){return Ft.onItemSelectAll("left",Rt,Xn)},Ft.onRightItemSelectAll=function(Rt,Xn){return Ft.onItemSelectAll("right",Rt,Xn)},Ft.handleFilter=function(Rt,Xn){var Bn=Ft.props.onSearch,xr=Xn.target.value;Bn==null||Bn(Rt,xr)},Ft.handleLeftFilter=function(Rt){return Ft.handleFilter("left",Rt)},Ft.handleRightFilter=function(Rt){return Ft.handleFilter("right",Rt)},Ft.handleClear=function(Rt){var Xn=Ft.props.onSearch;Xn==null||Xn(Rt,"")},Ft.handleLeftClear=function(){return Ft.handleClear("left")},Ft.handleRightClear=function(){return Ft.handleClear("right")},Ft.onItemSelect=function(Rt,Xn,Bn){var xr=Ft.state,dr=xr.sourceSelectedKeys,Ur=xr.targetSelectedKeys,fa=Rt==="left"?(0,tt.Z)(dr):(0,tt.Z)(Ur),Ea=fa.indexOf(Xn);Ea>-1&&fa.splice(Ea,1),Bn&&fa.push(Xn),Ft.handleSelectChange(Rt,fa),Ft.props.selectedKeys||Ft.setStateKeys(Rt,fa)},Ft.onLeftItemSelect=function(Rt,Xn){return Ft.onItemSelect("left",Rt,Xn)},Ft.onRightItemSelect=function(Rt,Xn){return Ft.onItemSelect("right",Rt,Xn)},Ft.onRightItemRemove=function(Rt){var Xn=Ft.props,Bn=Xn.targetKeys,xr=Bn===void 0?[]:Bn,dr=Xn.onChange;Ft.setStateKeys("right",[]),dr==null||dr(xr.filter(function(Ur){return!Rt.includes(Ur)}),"left",(0,tt.Z)(Rt))},Ft.handleScroll=function(Rt,Xn){var Bn=Ft.props.onScroll;Bn==null||Bn(Rt,Xn)},Ft.handleLeftScroll=function(Rt){return Ft.handleScroll("left",Rt)},Ft.handleRightScroll=function(Rt){return Ft.handleScroll("right",Rt)},Ft.handleListStyle=function(Rt,Xn){return typeof Rt=="function"?Rt({direction:Xn}):Rt};var bt=ee.selectedKeys,Me=bt===void 0?[]:bt,en=ee.targetKeys,fn=en===void 0?[]:en;return Ft.state={sourceSelectedKeys:Me.filter(function(Rt){return!fn.includes(Rt)}),targetSelectedKeys:Me.filter(function(Rt){return fn.includes(Rt)})},Ft}return(0,Q.Z)(Ve,[{key:"getTitles",value:function(Ft){var bt,Me;return(Me=(bt=this.props.titles)!==null&&bt!==void 0?bt:Ft.titles)!==null&&Me!==void 0?Me:[]}},{key:"handleSelectChange",value:function(Ft,bt){var Me=this.state,en=Me.sourceSelectedKeys,fn=Me.targetSelectedKeys,Rt=this.props.onSelectChange;!Rt||(Ft==="left"?Rt(bt,fn):Rt(en,bt))}},{key:"separateDataSource",value:function(){var Ft=this.props,bt=Ft.dataSource,Me=bt===void 0?[]:bt,en=Ft.rowKey,fn=Ft.targetKeys,Rt=fn===void 0?[]:fn,Xn=[],Bn=new Array(Rt.length);return Me.forEach(function(xr){en&&(xr=(0,j.Z)((0,j.Z)({},xr),{key:en(xr)}));var dr=Rt.indexOf(xr.key);dr!==-1?Bn[dr]=xr:Xn.push(xr)}),{leftDataSource:Xn,rightDataSource:Bn}}},{key:"render",value:function(){var Ft=this;return A.createElement(F.Z,{componentName:"Transfer",defaultLocale:K.Z.Transfer},function(bt){return A.createElement(N.C,null,function(Me){var en=Me.getPrefixCls,fn=Me.renderEmpty,Rt=Me.direction;return A.createElement(O.aM.Consumer,null,function(Xn){var Bn,xr=Xn.hasFeedback,dr=Xn.status,Ur=Ft.props,fa=Ur.prefixCls,Ea=Ur.className,aa=Ur.disabled,Da=Ur.operations,Lr=Da===void 0?[]:Da,_n=Ur.showSearch,sr=_n===void 0?!1:_n,Pn=Ur.footer,tr=Ur.style,zn=Ur.listStyle,Wr=zn===void 0?{}:zn,Yr=Ur.operationStyle,nr=Ur.filterOption,wr=Ur.render,Sr=Ur.children,pr=Ur.showSelectAll,qr=Ur.oneWay,ua=Ur.pagination,$r=Ur.status,ba=en("transfer",fa),gt=Ft.getLocale(bt,fn||B.Z),Dn=Ft.state,un=Dn.sourceSelectedKeys,Lt=Dn.targetSelectedKeys,Ot=(0,nt.F)(dr,$r),it=!Sr&&ua,H=Ft.separateDataSource(),X=H.leftDataSource,xt=H.rightDataSource,zt=Lt.length>0,Vt=un.length>0,Xt=C()(ba,(Bn={},(0,Y.Z)(Bn,"".concat(ba,"-disabled"),aa),(0,Y.Z)(Bn,"".concat(ba,"-customize-list"),!!Sr),(0,Y.Z)(Bn,"".concat(ba,"-rtl"),Rt==="rtl"),Bn),(0,nt.Z)(ba,Ot,xr),Ea),ne=Ft.getTitles(gt),on=Ft.props.selectAllLabels||[];return A.createElement("div",{className:Xt,style:tr},A.createElement(ce,(0,j.Z)({prefixCls:"".concat(ba,"-list"),titleText:ne==null?void 0:ne[0],dataSource:X,filterOption:nr,style:Ft.handleListStyle(Wr,"left"),checkedKeys:un,handleFilter:Ft.handleLeftFilter,handleClear:Ft.handleLeftClear,onItemSelect:Ft.onLeftItemSelect,onItemSelectAll:Ft.onLeftItemSelectAll,render:wr,showSearch:sr,renderList:Sr,footer:Pn,onScroll:Ft.handleLeftScroll,disabled:aa,direction:Rt==="rtl"?"right":"left",showSelectAll:pr,selectAllLabel:on[0],pagination:it},gt)),A.createElement(Ye,{className:"".concat(ba,"-operation"),rightActive:Vt,rightArrowText:Lr[0],moveToRight:Ft.moveToRight,leftActive:zt,leftArrowText:Lr[1],moveToLeft:Ft.moveToLeft,style:Yr,disabled:aa,direction:Rt,oneWay:qr}),A.createElement(ce,(0,j.Z)({prefixCls:"".concat(ba,"-list"),titleText:ne==null?void 0:ne[1],dataSource:xt,filterOption:nr,style:Ft.handleListStyle(Wr,"right"),checkedKeys:Lt,handleFilter:Ft.handleRightFilter,handleClear:Ft.handleRightClear,onItemSelect:Ft.onRightItemSelect,onItemSelectAll:Ft.onRightItemSelectAll,onItemRemove:Ft.onRightItemRemove,render:wr,showSearch:sr,renderList:Sr,footer:Pn,onScroll:Ft.handleRightScroll,disabled:aa,direction:Rt==="rtl"?"left":"right",showSelectAll:pr,selectAllLabel:on[1],showRemove:qr,pagination:it},gt)))})})})}}],[{key:"getDerivedStateFromProps",value:function(Ft){var bt=Ft.selectedKeys,Me=Ft.targetKeys,en=Ft.pagination,fn=Ft.children;if(bt){var Rt=Me||[];return{sourceSelectedKeys:bt.filter(function(Xn){return!Rt.includes(Xn)}),targetSelectedKeys:bt.filter(function(Xn){return Rt.includes(Xn)})}}return null}}]),Ve}(A.Component);ge.List=ce,ge.Operation=Ye,ge.Search=Qt;var Be=ge},58996:function(ur,ot,$){"use strict";var Y=$(38663),tt=$.n(Y),j=$(66247),W=$.n(j),Q=$(57663),Z=$(63185),R=$(59250),L=$(13254),C=$(47673),A=$(14781)},11324:function(ur,ot,$){"use strict";$.d(ot,{Z:function(){return xt}});var Y=$(22122),tt=$(67294),j=$(96156),W=$(55507),Q=$(90484),Z=$(85061),R=$(28481),L=$(94184),C=$.n(L),A=$(6610),N=$(5991),B=$(10379),O=$(54070),F=$(81253),K=$(92137),nt=$(64217);function P(zt,Vt){var Xt="cannot ".concat(zt.method," ").concat(zt.action," ").concat(Vt.status,"'"),ne=new Error(Xt);return ne.status=Vt.status,ne.method=zt.method,ne.url=zt.action,ne}function k(zt){var Vt=zt.responseText||zt.response;if(!Vt)return Vt;try{return JSON.parse(Vt)}catch(Xt){return Vt}}function yt(zt){var Vt=new XMLHttpRequest;zt.onProgress&&Vt.upload&&(Vt.upload.onprogress=function(tn){tn.total>0&&(tn.percent=tn.loaded/tn.total*100),zt.onProgress(tn)});var Xt=new FormData;zt.data&&Object.keys(zt.data).forEach(function(on){var tn=zt.data[on];if(Array.isArray(tn)){tn.forEach(function(He){Xt.append("".concat(on,"[]"),He)});return}Xt.append(on,tn)}),zt.file instanceof Blob?Xt.append(zt.filename,zt.file,zt.file.name):Xt.append(zt.filename,zt.file),Vt.onerror=function(tn){zt.onError(tn)},Vt.onload=function(){return Vt.status<200||Vt.status>=300?zt.onError(P(zt,Vt),k(Vt)):zt.onSuccess(k(Vt),Vt)},Vt.open(zt.method,zt.action,!0),zt.withCredentials&&"withCredentials"in Vt&&(Vt.withCredentials=!0);var ne=zt.headers||{};return ne["X-Requested-With"]!==null&&Vt.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(ne).forEach(function(on){ne[on]!==null&&Vt.setRequestHeader(on,ne[on])}),Vt.send(Xt),{abort:function(){Vt.abort()}}}var st=+new Date,lt=0;function ht(){return"rc-upload-".concat(st,"-").concat(++lt)}var mt=$(80334),wt=function(zt,Vt){if(zt&&Vt){var Xt=Array.isArray(Vt)?Vt:Vt.split(","),ne=zt.name||"",on=zt.type||"",tn=on.replace(/\/.*$/,"");return Xt.some(function(He){var Qn=He.trim();if(/^\*(\/\*)?$/.test(He))return!0;if(Qn.charAt(0)==="."){var Ln=ne.toLowerCase(),Qr=Qn.toLowerCase(),Ia=[Qr];return(Qr===".jpg"||Qr===".jpeg")&&(Ia=[".jpg",".jpeg"]),Ia.some(function(Jn){return Ln.endsWith(Jn)})}return/\/\*$/.test(Qn)?tn===Qn.replace(/\/.*$/,""):on===Qn?!0:/^\w+$/.test(Qn)?((0,mt.ZP)(!1,"Upload takes an invalidate 'accept' type '".concat(Qn,"'.Skip for check.")),!0):!1})}return!0};function ut(zt,Vt){var Xt=zt.createReader(),ne=[];function on(){Xt.readEntries(function(tn){var He=Array.prototype.slice.apply(tn);ne=ne.concat(He);var Qn=!He.length;Qn?Vt(ne):on()})}on()}var pt=function(Vt,Xt,ne){var on=function tn(He,Qn){He.path=Qn||"",He.isFile?He.file(function(Ln){ne(Ln)&&(He.fullPath&&!Ln.webkitRelativePath&&(Object.defineProperties(Ln,{webkitRelativePath:{writable:!0}}),Ln.webkitRelativePath=He.fullPath.replace(/^\//,""),Object.defineProperties(Ln,{webkitRelativePath:{writable:!1}})),Xt([Ln]))}):He.isDirectory&&ut(He,function(Ln){Ln.forEach(function(Qr){tn(Qr,"".concat(Qn).concat(He.name,"/"))})})};Vt.forEach(function(tn){on(tn.webkitGetAsEntry())})},Nt=pt,Ut=["component","prefixCls","className","disabled","id","style","multiple","accept","capture","children","directory","openFileDialogOnClick","onMouseEnter","onMouseLeave"],ue=function(zt){(0,B.Z)(Xt,zt);var Vt=(0,O.Z)(Xt);function Xt(){var ne;(0,A.Z)(this,Xt);for(var on=arguments.length,tn=new Array(on),He=0;He<on;He++)tn[He]=arguments[He];return ne=Vt.call.apply(Vt,[this].concat(tn)),ne.state={uid:ht()},ne.reqs={},ne.fileInput=void 0,ne._isMounted=void 0,ne.onChange=function(Qn){var Ln=ne.props,Qr=Ln.accept,Ia=Ln.directory,Jn=Qn.target.files,Ar=(0,Z.Z)(Jn).filter(function(na){return!Ia||wt(na,Qr)});ne.uploadFiles(Ar),ne.reset()},ne.onClick=function(Qn){var Ln=ne.fileInput;if(!!Ln){var Qr=ne.props,Ia=Qr.children,Jn=Qr.onClick;if(Ia&&Ia.type==="button"){var Ar=Ln.parentNode;Ar.focus(),Ar.querySelector("button").blur()}Ln.click(),Jn&&Jn(Qn)}},ne.onKeyDown=function(Qn){Qn.key==="Enter"&&ne.onClick(Qn)},ne.onFileDrop=function(Qn){var Ln=ne.props.multiple;if(Qn.preventDefault(),Qn.type!=="dragover")if(ne.props.directory)Nt(Array.prototype.slice.call(Qn.dataTransfer.items),ne.uploadFiles,function(Ia){return wt(Ia,ne.props.accept)});else{var Qr=(0,Z.Z)(Qn.dataTransfer.files).filter(function(Ia){return wt(Ia,ne.props.accept)});Ln===!1&&(Qr=Qr.slice(0,1)),ne.uploadFiles(Qr)}},ne.uploadFiles=function(Qn){var Ln=(0,Z.Z)(Qn),Qr=Ln.map(function(Ia){return Ia.uid=ht(),ne.processFile(Ia,Ln)});Promise.all(Qr).then(function(Ia){var Jn=ne.props.onBatchStart;Jn==null||Jn(Ia.map(function(Ar){var na=Ar.origin,za=Ar.parsedFile;return{file:na,parsedFile:za}})),Ia.filter(function(Ar){return Ar.parsedFile!==null}).forEach(function(Ar){ne.post(Ar)})})},ne.processFile=function(){var Qn=(0,K.Z)((0,W.Z)().mark(function Ln(Qr,Ia){var Jn,Ar,na,za,da,Ti,ki,vi,ii;return(0,W.Z)().wrap(function(Ra){for(;;)switch(Ra.prev=Ra.next){case 0:if(Jn=ne.props.beforeUpload,Ar=Qr,!Jn){Ra.next=14;break}return Ra.prev=3,Ra.next=6,Jn(Qr,Ia);case 6:Ar=Ra.sent,Ra.next=12;break;case 9:Ra.prev=9,Ra.t0=Ra.catch(3),Ar=!1;case 12:if(Ar!==!1){Ra.next=14;break}return Ra.abrupt("return",{origin:Qr,parsedFile:null,action:null,data:null});case 14:if(na=ne.props.action,typeof na!="function"){Ra.next=21;break}return Ra.next=18,na(Qr);case 18:za=Ra.sent,Ra.next=22;break;case 21:za=na;case 22:if(da=ne.props.data,typeof da!="function"){Ra.next=29;break}return Ra.next=26,da(Qr);case 26:Ti=Ra.sent,Ra.next=30;break;case 29:Ti=da;case 30:return ki=((0,Q.Z)(Ar)==="object"||typeof Ar=="string")&&Ar?Ar:Qr,ki instanceof File?vi=ki:vi=new File([ki],Qr.name,{type:Qr.type}),ii=vi,ii.uid=Qr.uid,Ra.abrupt("return",{origin:Qr,data:Ti,parsedFile:ii,action:za});case 35:case"end":return Ra.stop()}},Ln,null,[[3,9]])}));return function(Ln,Qr){return Qn.apply(this,arguments)}}(),ne.saveFileInput=function(Qn){ne.fileInput=Qn},ne}return(0,N.Z)(Xt,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.abort()}},{key:"post",value:function(on){var tn=this,He=on.data,Qn=on.origin,Ln=on.action,Qr=on.parsedFile;if(!!this._isMounted){var Ia=this.props,Jn=Ia.onStart,Ar=Ia.customRequest,na=Ia.name,za=Ia.headers,da=Ia.withCredentials,Ti=Ia.method,ki=Qn.uid,vi=Ar||yt,ii={action:Ln,filename:na,data:He,file:Qr,headers:za,withCredentials:da,method:Ti||"post",onProgress:function(Ra){var ln=tn.props.onProgress;ln==null||ln(Ra,Qr)},onSuccess:function(Ra,ln){var De=tn.props.onSuccess;De==null||De(Ra,Qr,ln),delete tn.reqs[ki]},onError:function(Ra,ln){var De=tn.props.onError;De==null||De(Ra,ln,Qr),delete tn.reqs[ki]}};Jn(Qn),this.reqs[ki]=vi(ii)}}},{key:"reset",value:function(){this.setState({uid:ht()})}},{key:"abort",value:function(on){var tn=this.reqs;if(on){var He=on.uid?on.uid:on;tn[He]&&tn[He].abort&&tn[He].abort(),delete tn[He]}else Object.keys(tn).forEach(function(Qn){tn[Qn]&&tn[Qn].abort&&tn[Qn].abort(),delete tn[Qn]})}},{key:"render",value:function(){var on,tn=this.props,He=tn.component,Qn=tn.prefixCls,Ln=tn.className,Qr=tn.disabled,Ia=tn.id,Jn=tn.style,Ar=tn.multiple,na=tn.accept,za=tn.capture,da=tn.children,Ti=tn.directory,ki=tn.openFileDialogOnClick,vi=tn.onMouseEnter,ii=tn.onMouseLeave,Di=(0,F.Z)(tn,Ut),Ra=C()((on={},(0,j.Z)(on,Qn,!0),(0,j.Z)(on,"".concat(Qn,"-disabled"),Qr),(0,j.Z)(on,Ln,Ln),on)),ln=Ti?{directory:"directory",webkitdirectory:"webkitdirectory"}:{},De=Qr?{}:{onClick:ki?this.onClick:function(){},onKeyDown:ki?this.onKeyDown:function(){},onMouseEnter:vi,onMouseLeave:ii,onDrop:this.onFileDrop,onDragOver:this.onFileDrop,tabIndex:"0"};return tt.createElement(He,(0,Y.Z)({},De,{className:Ra,role:"button",style:Jn}),tt.createElement("input",(0,Y.Z)({},(0,nt.Z)(Di,{aria:!0,data:!0}),{id:Ia,type:"file",ref:this.saveFileInput,onClick:function(Wn){return Wn.stopPropagation()},key:this.state.uid,style:{display:"none"},accept:na},ln,{multiple:Ar,onChange:this.onChange},za!=null?{capture:za}:{})),da)}}]),Xt}(tt.Component),se=ue;function Le(){}var Ne=function(zt){(0,B.Z)(Xt,zt);var Vt=(0,O.Z)(Xt);function Xt(){var ne;(0,A.Z)(this,Xt);for(var on=arguments.length,tn=new Array(on),He=0;He<on;He++)tn[He]=arguments[He];return ne=Vt.call.apply(Vt,[this].concat(tn)),ne.uploader=void 0,ne.saveUploader=function(Qn){ne.uploader=Qn},ne}return(0,N.Z)(Xt,[{key:"abort",value:function(on){this.uploader.abort(on)}},{key:"render",value:function(){return tt.createElement(se,(0,Y.Z)({},this.props,{ref:this.saveUploader}))}}]),Xt}(tt.Component);Ne.defaultProps={component:"span",prefixCls:"rc-upload",data:{},headers:{},name:"file",multipart:!1,onStart:Le,onError:Le,onSuccess:Le,multiple:!1,beforeUpload:null,customRequest:null,withCredentials:!1,openFileDialogOnClick:!0};var we=Ne,At=we,Qt=$(21770),de=$(73935),rn=$(53124),Ee=$(98866),ce=$(42051),Oe=$(85636),Ze=$(28991),fe={icon:function(Vt,Xt){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M534 352V136H232v752h560V394H576a42 42 0 01-42-42z",fill:Xt}},{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM602 137.8L790.2 326H602V137.8zM792 888H232V136h302v216a42 42 0 0042 42h216v494z",fill:Vt}}]}},name:"file",theme:"twotone"},Ae=fe,Ye=$(27029),ge=function(Vt,Xt){return tt.createElement(Ye.Z,(0,Ze.Z)((0,Ze.Z)({},Vt),{},{ref:Xt,icon:Ae}))};ge.displayName="FileTwoTone";var Be=tt.forwardRef(ge),te=$(7085),ke={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z"}}]},name:"paper-clip",theme:"outlined"},Ve=ke,ee=function(Vt,Xt){return tt.createElement(Ye.Z,(0,Ze.Z)((0,Ze.Z)({},Vt),{},{ref:Xt,icon:Ve}))};ee.displayName="PaperClipOutlined";var Ft=tt.forwardRef(ee),bt={icon:function(Vt,Xt){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2z",fill:Vt}},{tag:"path",attrs:{d:"M424.6 765.8l-150.1-178L136 752.1V792h752v-30.4L658.1 489z",fill:Xt}},{tag:"path",attrs:{d:"M136 652.7l132.4-157c3.2-3.8 9-3.8 12.2 0l144 170.7L652 396.8c3.2-3.8 9-3.8 12.2 0L888 662.2V232H136v420.7zM304 280a88 88 0 110 176 88 88 0 010-176z",fill:Xt}},{tag:"path",attrs:{d:"M276 368a28 28 0 1056 0 28 28 0 10-56 0z",fill:Xt}},{tag:"path",attrs:{d:"M304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z",fill:Vt}}]}},name:"picture",theme:"twotone"},Me=bt,en=function(Vt,Xt){return tt.createElement(Ye.Z,(0,Ze.Z)((0,Ze.Z)({},Vt),{},{ref:Xt,icon:Me}))};en.displayName="PictureTwoTone";var fn=tt.forwardRef(en),Rt=$(5461),Xn=$(71577),Bn=$(57838),xr=$(33603),dr=$(96159);function Ur(zt){return(0,Y.Z)((0,Y.Z)({},zt),{lastModified:zt.lastModified,lastModifiedDate:zt.lastModifiedDate,name:zt.name,size:zt.size,type:zt.type,uid:zt.uid,percent:0,originFileObj:zt})}function fa(zt,Vt){var Xt=(0,Z.Z)(Vt),ne=Xt.findIndex(function(on){var tn=on.uid;return tn===zt.uid});return ne===-1?Xt.push(zt):Xt[ne]=zt,Xt}function Ea(zt,Vt){var Xt=zt.uid!==void 0?"uid":"name";return Vt.filter(function(ne){return ne[Xt]===zt[Xt]})[0]}function aa(zt,Vt){var Xt=zt.uid!==void 0?"uid":"name",ne=Vt.filter(function(on){return on[Xt]!==zt[Xt]});return ne.length===Vt.length?null:ne}var Da=function(){var Vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Xt=Vt.split("/"),ne=Xt[Xt.length-1],on=ne.split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(on)||[""])[0]},Lr=function(Vt){return Vt.indexOf("image/")===0},_n=function(Vt){if(Vt.type&&!Vt.thumbUrl)return Lr(Vt.type);var Xt=Vt.thumbUrl||Vt.url||"",ne=Da(Xt);return/^data:image\//.test(Xt)||/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico|heic|heif)$/i.test(ne)?!0:!(/^data:/.test(Xt)||ne)},sr=200;function Pn(zt){return new Promise(function(Vt){if(!zt.type||!Lr(zt.type)){Vt("");return}var Xt=document.createElement("canvas");Xt.width=sr,Xt.height=sr,Xt.style.cssText="position: fixed; left: 0; top: 0; width: ".concat(sr,"px; height: ").concat(sr,"px; z-index: 9999; display: none;"),document.body.appendChild(Xt);var ne=Xt.getContext("2d"),on=new Image;if(on.onload=function(){var He=on.width,Qn=on.height,Ln=sr,Qr=sr,Ia=0,Jn=0;He>Qn?(Qr=Qn*(sr/He),Jn=-(Qr-Ln)/2):(Ln=He*(sr/Qn),Ia=-(Ln-Qr)/2),ne.drawImage(on,Ia,Jn,Ln,Qr);var Ar=Xt.toDataURL();document.body.removeChild(Xt),Vt(Ar)},on.crossOrigin="anonymous",zt.type.startsWith("image/svg+xml")){var tn=new FileReader;tn.addEventListener("load",function(){tn.result&&(on.src=tn.result)}),tn.readAsDataURL(zt)}else on.src=window.URL.createObjectURL(zt)})}var tr=$(73171),zn=$(90631),Wr=$(95357),Yr=$(54458),nr=$(94199),wr=tt.forwardRef(function(zt,Vt){var Xt,ne=zt.prefixCls,on=zt.className,tn=zt.style,He=zt.locale,Qn=zt.listType,Ln=zt.file,Qr=zt.items,Ia=zt.progress,Jn=zt.iconRender,Ar=zt.actionIconRender,na=zt.itemRender,za=zt.isImgUrl,da=zt.showPreviewIcon,Ti=zt.showRemoveIcon,ki=zt.showDownloadIcon,vi=zt.previewIcon,ii=zt.removeIcon,Di=zt.downloadIcon,Ra=zt.onPreview,ln=zt.onDownload,De=zt.onClose,dn,Wn,Gn=Ln.status,Kn=tt.useState(Gn),Rr=(0,R.Z)(Kn,2),xa=Rr[0],La=Rr[1];tt.useEffect(function(){Gn!=="removed"&&La(Gn)},[Gn]);var ui=tt.useState(!1),Fi=(0,R.Z)(ui,2),Ki=Fi[0],xo=Fi[1],vo=tt.useRef(null);tt.useEffect(function(){return vo.current=setTimeout(function(){xo(!0)},300),function(){vo.current&&clearTimeout(vo.current)}},[]);var es="".concat(ne,"-span"),Wo=Jn(Ln),Zi=tt.createElement("div",{className:"".concat(ne,"-text-icon")},Wo);if(Qn==="picture"||Qn==="picture-card")if(xa==="uploading"||!Ln.thumbUrl&&!Ln.url){var bi,gi=C()((bi={},(0,j.Z)(bi,"".concat(ne,"-list-item-thumbnail"),!0),(0,j.Z)(bi,"".concat(ne,"-list-item-file"),xa!=="uploading"),bi));Zi=tt.createElement("div",{className:gi},Wo)}else{var ms,Do=(za==null?void 0:za(Ln))?tt.createElement("img",{src:Ln.thumbUrl||Ln.url,alt:Ln.name,className:"".concat(ne,"-list-item-image"),crossOrigin:Ln.crossOrigin}):Wo,To=C()((ms={},(0,j.Z)(ms,"".concat(ne,"-list-item-thumbnail"),!0),(0,j.Z)(ms,"".concat(ne,"-list-item-file"),za&&!za(Ln)),ms));Zi=tt.createElement("a",{className:To,onClick:function(Ws){return Ra(Ln,Ws)},href:Ln.url||Ln.thumbUrl,target:"_blank",rel:"noopener noreferrer"},Do)}var Zs=C()((Xt={},(0,j.Z)(Xt,"".concat(ne,"-list-item"),!0),(0,j.Z)(Xt,"".concat(ne,"-list-item-").concat(xa),!0),(0,j.Z)(Xt,"".concat(ne,"-list-item-list-type-").concat(Qn),!0),Xt)),Eu=typeof Ln.linkProps=="string"?JSON.parse(Ln.linkProps):Ln.linkProps,as=Ti?Ar((typeof ii=="function"?ii(Ln):ii)||tt.createElement(tr.Z,null),function(){return De(Ln)},ne,He.removeFile):null,Rs=ki&&xa==="done"?Ar((typeof Di=="function"?Di(Ln):Di)||tt.createElement(zn.Z,null),function(){return ln(Ln)},ne,He.downloadFile):null,Su=Qn!=="picture-card"&&tt.createElement("span",{key:"download-delete",className:C()("".concat(ne,"-list-item-card-actions"),{picture:Qn==="picture"})},Rs,as),fu=C()("".concat(ne,"-list-item-name")),Is=Ln.url?[tt.createElement("a",(0,Y.Z)({key:"view",target:"_blank",rel:"noopener noreferrer",className:fu,title:Ln.name},Eu,{href:Ln.url,onClick:function(Ws){return Ra(Ln,Ws)}}),Ln.name),Su]:[tt.createElement("span",{key:"view",className:fu,onClick:function(Ws){return Ra(Ln,Ws)},title:Ln.name},Ln.name),Su],Zo={pointerEvents:"none",opacity:.5},Wi=da?tt.createElement("a",{href:Ln.url||Ln.thumbUrl,target:"_blank",rel:"noopener noreferrer",style:Ln.url||Ln.thumbUrl?void 0:Zo,onClick:function(Ws){return Ra(Ln,Ws)},title:He.previewFile},typeof vi=="function"?vi(Ln):vi||tt.createElement(Wr.Z,null)):null,ys=Qn==="picture-card"&&xa!=="uploading"&&tt.createElement("span",{className:"".concat(ne,"-list-item-actions")},Wi,xa==="done"&&Rs,as),is;Ln.response&&typeof Ln.response=="string"?is=Ln.response:is=((dn=Ln.error)===null||dn===void 0?void 0:dn.statusText)||((Wn=Ln.error)===null||Wn===void 0?void 0:Wn.message)||He.uploadError;var Us=tt.createElement("span",{className:es},Zi,Is),Du=tt.useContext(rn.E_),qs=Du.getPrefixCls,Cu=qs(),ji=tt.createElement("div",{className:Zs},tt.createElement("div",{className:"".concat(ne,"-list-item-info")},Us),ys,Ki&&tt.createElement(Rt.default,{motionName:"".concat(Cu,"-fade"),visible:xa==="uploading",motionDeadline:2e3},function(os){var Ws=os.className,Ss="percent"in Ln?tt.createElement(Yr.Z,(0,Y.Z)({},Ia,{type:"line",percent:Ln.percent})):null;return tt.createElement("div",{className:C()("".concat(ne,"-list-item-progress"),Ws)},Ss)})),Bi=C()("".concat(ne,"-list-").concat(Qn,"-container"),on),Ms=xa==="error"?tt.createElement(nr.Z,{title:is,getPopupContainer:function(Ws){return Ws.parentNode}},ji):ji;return tt.createElement("div",{className:Bi,style:tn,ref:Vt},na?na(Ms,Ln,Qr,{download:ln.bind(null,Ln),preview:Ra.bind(null,Ln),remove:De.bind(null,Ln)}):Ms)}),Sr=wr,pr=(0,Y.Z)({},xr.ZP);delete pr.onAppearEnd,delete pr.onEnterEnd,delete pr.onLeaveEnd;var qr=function(Vt,Xt){var ne,on=Vt.listType,tn=on===void 0?"text":on,He=Vt.previewFile,Qn=He===void 0?Pn:He,Ln=Vt.onPreview,Qr=Vt.onDownload,Ia=Vt.onRemove,Jn=Vt.locale,Ar=Vt.iconRender,na=Vt.isImageUrl,za=na===void 0?_n:na,da=Vt.prefixCls,Ti=Vt.items,ki=Ti===void 0?[]:Ti,vi=Vt.showPreviewIcon,ii=vi===void 0?!0:vi,Di=Vt.showRemoveIcon,Ra=Di===void 0?!0:Di,ln=Vt.showDownloadIcon,De=ln===void 0?!1:ln,dn=Vt.removeIcon,Wn=Vt.previewIcon,Gn=Vt.downloadIcon,Kn=Vt.progress,Rr=Kn===void 0?{strokeWidth:2,showInfo:!1}:Kn,xa=Vt.appendAction,La=Vt.appendActionVisible,ui=La===void 0?!0:La,Fi=Vt.itemRender,Ki=(0,Bn.Z)(),xo=tt.useState(!1),vo=(0,R.Z)(xo,2),es=vo[0],Wo=vo[1];tt.useEffect(function(){tn!=="picture"&&tn!=="picture-card"||(ki||[]).forEach(function(Zo){typeof document=="undefined"||typeof window=="undefined"||!window.FileReader||!window.File||!(Zo.originFileObj instanceof File||Zo.originFileObj instanceof Blob)||Zo.thumbUrl!==void 0||(Zo.thumbUrl="",Qn&&Qn(Zo.originFileObj).then(function(Wi){Zo.thumbUrl=Wi||"",Ki()}))})},[tn,ki,Qn]),tt.useEffect(function(){Wo(!0)},[]);var Zi=function(Wi,ys){if(!!Ln)return ys==null||ys.preventDefault(),Ln(Wi)},bi=function(Wi){typeof Qr=="function"?Qr(Wi):Wi.url&&window.open(Wi.url)},gi=function(Wi){Ia==null||Ia(Wi)},ms=function(Wi){if(Ar)return Ar(Wi,tn);var ys=Wi.status==="uploading",is=za&&za(Wi)?tt.createElement(fn,null):tt.createElement(Be,null),Us=ys?tt.createElement(te.Z,null):tt.createElement(Ft,null);return tn==="picture"?Us=ys?tt.createElement(te.Z,null):is:tn==="picture-card"&&(Us=ys?Jn.uploading:is),Us},Do=function(Wi,ys,is,Us){var Du={type:"text",size:"small",title:Us,onClick:function(ji){ys(),(0,dr.l$)(Wi)&&Wi.props.onClick&&Wi.props.onClick(ji)},className:"".concat(is,"-list-item-card-actions-btn")};if((0,dr.l$)(Wi)){var qs=(0,dr.Tm)(Wi,(0,Y.Z)((0,Y.Z)({},Wi.props),{onClick:function(){}}));return tt.createElement(Xn.Z,(0,Y.Z)({},Du,{icon:qs}))}return tt.createElement(Xn.Z,(0,Y.Z)({},Du),tt.createElement("span",null,Wi))};tt.useImperativeHandle(Xt,function(){return{handlePreview:Zi,handleDownload:bi}});var To=tt.useContext(rn.E_),Zs=To.getPrefixCls,Eu=To.direction,as=Zs("upload",da),Rs=C()((ne={},(0,j.Z)(ne,"".concat(as,"-list"),!0),(0,j.Z)(ne,"".concat(as,"-list-").concat(tn),!0),(0,j.Z)(ne,"".concat(as,"-list-rtl"),Eu==="rtl"),ne)),Su=(0,Z.Z)(ki.map(function(Zo){return{key:Zo.uid,file:Zo}})),fu=tn==="picture-card"?"animate-inline":"animate",Is={motionDeadline:2e3,motionName:"".concat(as,"-").concat(fu),keys:Su,motionAppear:es};return tn!=="picture-card"&&(Is=(0,Y.Z)((0,Y.Z)({},pr),Is)),tt.createElement("div",{className:Rs},tt.createElement(Rt.CSSMotionList,(0,Y.Z)({},Is,{component:!1}),function(Zo){var Wi=Zo.key,ys=Zo.file,is=Zo.className,Us=Zo.style;return tt.createElement(Sr,{key:Wi,locale:Jn,prefixCls:as,className:is,style:Us,file:ys,items:ki,progress:Rr,listType:tn,isImgUrl:za,showPreviewIcon:ii,showRemoveIcon:Ra,showDownloadIcon:De,removeIcon:dn,previewIcon:Wn,downloadIcon:Gn,iconRender:ms,actionIconRender:Do,itemRender:Fi,onPreview:Zi,onDownload:bi,onClose:gi})}),xa&&tt.createElement(Rt.default,(0,Y.Z)({},Is,{visible:ui,forceRender:!0}),function(Zo){var Wi=Zo.className,ys=Zo.style;return(0,dr.Tm)(xa,function(is){return{className:C()(is.className,Wi),style:(0,Y.Z)((0,Y.Z)((0,Y.Z)({},ys),{pointerEvents:Wi?"none":void 0}),is.style)}})}))},ua=tt.forwardRef(qr),$r=ua,ba=function(zt,Vt,Xt,ne){function on(tn){return tn instanceof Xt?tn:new Xt(function(He){He(tn)})}return new(Xt||(Xt=Promise))(function(tn,He){function Qn(Ia){try{Qr(ne.next(Ia))}catch(Jn){He(Jn)}}function Ln(Ia){try{Qr(ne.throw(Ia))}catch(Jn){He(Jn)}}function Qr(Ia){Ia.done?tn(Ia.value):on(Ia.value).then(Qn,Ln)}Qr((ne=ne.apply(zt,Vt||[])).next())})},gt="__LIST_IGNORE_".concat(Date.now(),"__"),Dn=function(Vt,Xt){var ne,on=Vt.fileList,tn=Vt.defaultFileList,He=Vt.onRemove,Qn=Vt.showUploadList,Ln=Qn===void 0?!0:Qn,Qr=Vt.listType,Ia=Qr===void 0?"text":Qr,Jn=Vt.onPreview,Ar=Vt.onDownload,na=Vt.onChange,za=Vt.onDrop,da=Vt.previewFile,Ti=Vt.disabled,ki=Vt.locale,vi=Vt.iconRender,ii=Vt.isImageUrl,Di=Vt.progress,Ra=Vt.prefixCls,ln=Vt.className,De=Vt.type,dn=De===void 0?"select":De,Wn=Vt.children,Gn=Vt.style,Kn=Vt.itemRender,Rr=Vt.maxCount,xa=Vt.data,La=xa===void 0?{}:xa,ui=Vt.multiple,Fi=ui===void 0?!1:ui,Ki=Vt.action,xo=Ki===void 0?"":Ki,vo=Vt.accept,es=vo===void 0?"":vo,Wo=Vt.supportServerRender,Zi=Wo===void 0?!0:Wo,bi=tt.useContext(Ee.Z),gi=Ti!=null?Ti:bi,ms=(0,Qt.Z)(tn||[],{value:on,postState:function(Fa){return Fa!=null?Fa:[]}}),Do=(0,R.Z)(ms,2),To=Do[0],Zs=Do[1],Eu=tt.useState("drop"),as=(0,R.Z)(Eu,2),Rs=as[0],Su=as[1],fu=tt.useRef(null);tt.useMemo(function(){var pa=Date.now();(on||[]).forEach(function(Fa,Vi){!Fa.uid&&!Object.isFrozen(Fa)&&(Fa.uid="__AUTO__".concat(pa,"_").concat(Vi,"__"))})},[on]);var Is=function(Fa,Vi,Ao){var ao=(0,Z.Z)(Vi);Rr===1?ao=ao.slice(-1):Rr&&(ao=ao.slice(0,Rr)),(0,de.flushSync)(function(){Zs(ao)});var So={file:Fa,fileList:ao};Ao&&(So.event=Ao),na==null||na(So)},Zo=function(Fa,Vi){return ba(void 0,void 0,void 0,(0,W.Z)().mark(function Ao(){var ao,So,Ts,fo;return(0,W.Z)().wrap(function(Cs){for(;;)switch(Cs.prev=Cs.next){case 0:if(ao=Vt.beforeUpload,So=Vt.transformFile,Ts=Fa,!ao){Cs.next=13;break}return Cs.next=5,ao(Fa,Vi);case 5:if(fo=Cs.sent,fo!==!1){Cs.next=8;break}return Cs.abrupt("return",!1);case 8:if(delete Fa[gt],fo!==gt){Cs.next=12;break}return Object.defineProperty(Fa,gt,{value:!0,configurable:!0}),Cs.abrupt("return",!1);case 12:(0,Q.Z)(fo)==="object"&&fo&&(Ts=fo);case 13:if(!So){Cs.next=17;break}return Cs.next=16,So(Ts);case 16:Ts=Cs.sent;case 17:return Cs.abrupt("return",Ts);case 18:case"end":return Cs.stop()}},Ao)}))},Wi=function(Fa){var Vi=Fa.filter(function(So){return!So.file[gt]});if(!!Vi.length){var Ao=Vi.map(function(So){return Ur(So.file)}),ao=(0,Z.Z)(To);Ao.forEach(function(So){ao=fa(So,ao)}),Ao.forEach(function(So,Ts){var fo=So;if(Vi[Ts].parsedFile)So.status="uploading";else{var ou=So.originFileObj,Cs;try{Cs=new File([ou],ou.name,{type:ou.type})}catch(Au){Cs=new Blob([ou],{type:ou.type}),Cs.name=ou.name,Cs.lastModifiedDate=new Date,Cs.lastModified=new Date().getTime()}Cs.uid=So.uid,fo=Cs}Is(fo,ao)})}},ys=function(Fa,Vi,Ao){try{typeof Fa=="string"&&(Fa=JSON.parse(Fa))}catch(Ts){}if(!!Ea(Vi,To)){var ao=Ur(Vi);ao.status="done",ao.percent=100,ao.response=Fa,ao.xhr=Ao;var So=fa(ao,To);Is(ao,So)}},is=function(Fa,Vi){if(!!Ea(Vi,To)){var Ao=Ur(Vi);Ao.status="uploading",Ao.percent=Fa.percent;var ao=fa(Ao,To);Is(Ao,ao,Fa)}},Us=function(Fa,Vi,Ao){if(!!Ea(Ao,To)){var ao=Ur(Ao);ao.error=Fa,ao.response=Vi,ao.status="error";var So=fa(ao,To);Is(ao,So)}},Du=function(Fa){var Vi;Promise.resolve(typeof He=="function"?He(Fa):He).then(function(Ao){var ao;if(Ao!==!1){var So=aa(Fa,To);So&&(Vi=(0,Y.Z)((0,Y.Z)({},Fa),{status:"removed"}),To==null||To.forEach(function(Ts){var fo=Vi.uid!==void 0?"uid":"name";Ts[fo]===Vi[fo]&&!Object.isFrozen(Ts)&&(Ts.status="removed")}),(ao=fu.current)===null||ao===void 0||ao.abort(Vi),Is(Vi,So))}})},qs=function(Fa){Su(Fa.type),Fa.type==="drop"&&(za==null||za(Fa))};tt.useImperativeHandle(Xt,function(){return{onBatchStart:Wi,onSuccess:ys,onProgress:is,onError:Us,fileList:To,upload:fu.current}});var Cu=tt.useContext(rn.E_),ji=Cu.getPrefixCls,Bi=Cu.direction,Ms=ji("upload",Ra),os=(0,Y.Z)((0,Y.Z)({onBatchStart:Wi,onError:Us,onProgress:is,onSuccess:ys},Vt),{data:La,multiple:Fi,action:xo,accept:es,supportServerRender:Zi,prefixCls:Ms,disabled:gi,beforeUpload:Zo,onChange:void 0});delete os.className,delete os.style,(!Wn||gi)&&delete os.id;var Ws=function(Fa,Vi){return Ln?tt.createElement(ce.Z,{componentName:"Upload",defaultLocale:Oe.Z.Upload},function(Ao){var ao=typeof Ln=="boolean"?{}:Ln,So=ao.showRemoveIcon,Ts=ao.showPreviewIcon,fo=ao.showDownloadIcon,ou=ao.removeIcon,Cs=ao.previewIcon,Au=ao.downloadIcon;return tt.createElement($r,{prefixCls:Ms,listType:Ia,items:To,previewFile:da,onPreview:Jn,onDownload:Ar,onRemove:Du,showRemoveIcon:!gi&&So,showPreviewIcon:Ts,showDownloadIcon:fo,removeIcon:ou,previewIcon:Cs,downloadIcon:Au,iconRender:vi,locale:(0,Y.Z)((0,Y.Z)({},Ao),ki),isImageUrl:ii,progress:Di,appendAction:Fa,appendActionVisible:Vi,itemRender:Kn})}):Fa};if(dn==="drag"){var Ss,Qs=C()(Ms,(Ss={},(0,j.Z)(Ss,"".concat(Ms,"-drag"),!0),(0,j.Z)(Ss,"".concat(Ms,"-drag-uploading"),To.some(function(pa){return pa.status==="uploading"})),(0,j.Z)(Ss,"".concat(Ms,"-drag-hover"),Rs==="dragover"),(0,j.Z)(Ss,"".concat(Ms,"-disabled"),gi),(0,j.Z)(Ss,"".concat(Ms,"-rtl"),Bi==="rtl"),Ss),ln);return tt.createElement("span",null,tt.createElement("div",{className:Qs,onDrop:qs,onDragOver:qs,onDragLeave:qs,style:Gn},tt.createElement(At,(0,Y.Z)({},os,{ref:fu,className:"".concat(Ms,"-btn")}),tt.createElement("div",{className:"".concat(Ms,"-drag-container")},Wn))),Ws())}var Qu=C()(Ms,(ne={},(0,j.Z)(ne,"".concat(Ms,"-select"),!0),(0,j.Z)(ne,"".concat(Ms,"-select-").concat(Ia),!0),(0,j.Z)(ne,"".concat(Ms,"-disabled"),gi),(0,j.Z)(ne,"".concat(Ms,"-rtl"),Bi==="rtl"),ne)),xn=function(Fa){return tt.createElement("div",{className:Qu,style:Fa},tt.createElement(At,(0,Y.Z)({},os,{ref:fu})))},Vr=xn(Wn?void 0:{display:"none"});return Ia==="picture-card"?tt.createElement("span",{className:C()("".concat(Ms,"-picture-card-wrapper"),ln)},Ws(Vr,!!Wn)):tt.createElement("span",{className:ln},Vr,Ws())},un=tt.forwardRef(Dn),Lt=un,Ot=function(zt,Vt){var Xt={};for(var ne in zt)Object.prototype.hasOwnProperty.call(zt,ne)&&Vt.indexOf(ne)<0&&(Xt[ne]=zt[ne]);if(zt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var on=0,ne=Object.getOwnPropertySymbols(zt);on<ne.length;on++)Vt.indexOf(ne[on])<0&&Object.prototype.propertyIsEnumerable.call(zt,ne[on])&&(Xt[ne[on]]=zt[ne[on]]);return Xt},it=tt.forwardRef(function(zt,Vt){var Xt=zt.style,ne=zt.height,on=Ot(zt,["style","height"]);return tt.createElement(Lt,(0,Y.Z)({ref:Vt},on,{type:"drag",style:(0,Y.Z)((0,Y.Z)({},Xt),{height:ne})}))}),H=it,X=Lt;X.Dragger=H,X.LIST_IGNORE=gt;var xt=X},43185:function(ur,ot,$){"use strict";var Y=$(38663),tt=$.n(Y),j=$(63252),W=$.n(j),Q=$(57663),Z=$(34669),R=$(22385)},48168:function(ur,ot,$){var Y=$(39092),tt={};for(var j in Y)Y.hasOwnProperty(j)&&(tt[Y[j]]=j);var W=ur.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var Q in W)if(W.hasOwnProperty(Q)){if(!("channels"in W[Q]))throw new Error("missing channels property: "+Q);if(!("labels"in W[Q]))throw new Error("missing channel labels property: "+Q);if(W[Q].labels.length!==W[Q].channels)throw new Error("channel and label counts mismatch: "+Q);var Z=W[Q].channels,R=W[Q].labels;delete W[Q].channels,delete W[Q].labels,Object.defineProperty(W[Q],"channels",{value:Z}),Object.defineProperty(W[Q],"labels",{value:R})}W.rgb.hsl=function(C){var A=C[0]/255,N=C[1]/255,B=C[2]/255,O=Math.min(A,N,B),F=Math.max(A,N,B),K=F-O,nt,P,k;return F===O?nt=0:A===F?nt=(N-B)/K:N===F?nt=2+(B-A)/K:B===F&&(nt=4+(A-N)/K),nt=Math.min(nt*60,360),nt<0&&(nt+=360),k=(O+F)/2,F===O?P=0:k<=.5?P=K/(F+O):P=K/(2-F-O),[nt,P*100,k*100]},W.rgb.hsv=function(C){var A,N,B,O,F,K=C[0]/255,nt=C[1]/255,P=C[2]/255,k=Math.max(K,nt,P),yt=k-Math.min(K,nt,P),st=function(lt){return(k-lt)/6/yt+1/2};return yt===0?O=F=0:(F=yt/k,A=st(K),N=st(nt),B=st(P),K===k?O=B-N:nt===k?O=1/3+A-B:P===k&&(O=2/3+N-A),O<0?O+=1:O>1&&(O-=1)),[O*360,F*100,k*100]},W.rgb.hwb=function(C){var A=C[0],N=C[1],B=C[2],O=W.rgb.hsl(C)[0],F=1/255*Math.min(A,Math.min(N,B));return B=1-1/255*Math.max(A,Math.max(N,B)),[O,F*100,B*100]},W.rgb.cmyk=function(C){var A=C[0]/255,N=C[1]/255,B=C[2]/255,O,F,K,nt;return nt=Math.min(1-A,1-N,1-B),O=(1-A-nt)/(1-nt)||0,F=(1-N-nt)/(1-nt)||0,K=(1-B-nt)/(1-nt)||0,[O*100,F*100,K*100,nt*100]};function L(C,A){return Math.pow(C[0]-A[0],2)+Math.pow(C[1]-A[1],2)+Math.pow(C[2]-A[2],2)}W.rgb.keyword=function(C){var A=tt[C];if(A)return A;var N=Infinity,B;for(var O in Y)if(Y.hasOwnProperty(O)){var F=Y[O],K=L(C,F);K<N&&(N=K,B=O)}return B},W.keyword.rgb=function(C){return Y[C]},W.rgb.xyz=function(C){var A=C[0]/255,N=C[1]/255,B=C[2]/255;A=A>.04045?Math.pow((A+.055)/1.055,2.4):A/12.92,N=N>.04045?Math.pow((N+.055)/1.055,2.4):N/12.92,B=B>.04045?Math.pow((B+.055)/1.055,2.4):B/12.92;var O=A*.4124+N*.3576+B*.1805,F=A*.2126+N*.7152+B*.0722,K=A*.0193+N*.1192+B*.9505;return[O*100,F*100,K*100]},W.rgb.lab=function(C){var A=W.rgb.xyz(C),N=A[0],B=A[1],O=A[2],F,K,nt;return N/=95.047,B/=100,O/=108.883,N=N>.008856?Math.pow(N,1/3):7.787*N+16/116,B=B>.008856?Math.pow(B,1/3):7.787*B+16/116,O=O>.008856?Math.pow(O,1/3):7.787*O+16/116,F=116*B-16,K=500*(N-B),nt=200*(B-O),[F,K,nt]},W.hsl.rgb=function(C){var A=C[0]/360,N=C[1]/100,B=C[2]/100,O,F,K,nt,P;if(N===0)return P=B*255,[P,P,P];B<.5?F=B*(1+N):F=B+N-B*N,O=2*B-F,nt=[0,0,0];for(var k=0;k<3;k++)K=A+1/3*-(k-1),K<0&&K++,K>1&&K--,6*K<1?P=O+(F-O)*6*K:2*K<1?P=F:3*K<2?P=O+(F-O)*(2/3-K)*6:P=O,nt[k]=P*255;return nt},W.hsl.hsv=function(C){var A=C[0],N=C[1]/100,B=C[2]/100,O=N,F=Math.max(B,.01),K,nt;return B*=2,N*=B<=1?B:2-B,O*=F<=1?F:2-F,nt=(B+N)/2,K=B===0?2*O/(F+O):2*N/(B+N),[A,K*100,nt*100]},W.hsv.rgb=function(C){var A=C[0]/60,N=C[1]/100,B=C[2]/100,O=Math.floor(A)%6,F=A-Math.floor(A),K=255*B*(1-N),nt=255*B*(1-N*F),P=255*B*(1-N*(1-F));switch(B*=255,O){case 0:return[B,P,K];case 1:return[nt,B,K];case 2:return[K,B,P];case 3:return[K,nt,B];case 4:return[P,K,B];case 5:return[B,K,nt]}},W.hsv.hsl=function(C){var A=C[0],N=C[1]/100,B=C[2]/100,O=Math.max(B,.01),F,K,nt;return nt=(2-N)*B,F=(2-N)*O,K=N*O,K/=F<=1?F:2-F,K=K||0,nt/=2,[A,K*100,nt*100]},W.hwb.rgb=function(C){var A=C[0]/360,N=C[1]/100,B=C[2]/100,O=N+B,F,K,nt,P;O>1&&(N/=O,B/=O),F=Math.floor(6*A),K=1-B,nt=6*A-F,(F&1)!=0&&(nt=1-nt),P=N+nt*(K-N);var k,yt,st;switch(F){default:case 6:case 0:k=K,yt=P,st=N;break;case 1:k=P,yt=K,st=N;break;case 2:k=N,yt=K,st=P;break;case 3:k=N,yt=P,st=K;break;case 4:k=P,yt=N,st=K;break;case 5:k=K,yt=N,st=P;break}return[k*255,yt*255,st*255]},W.cmyk.rgb=function(C){var A=C[0]/100,N=C[1]/100,B=C[2]/100,O=C[3]/100,F,K,nt;return F=1-Math.min(1,A*(1-O)+O),K=1-Math.min(1,N*(1-O)+O),nt=1-Math.min(1,B*(1-O)+O),[F*255,K*255,nt*255]},W.xyz.rgb=function(C){var A=C[0]/100,N=C[1]/100,B=C[2]/100,O,F,K;return O=A*3.2406+N*-1.5372+B*-.4986,F=A*-.9689+N*1.8758+B*.0415,K=A*.0557+N*-.204+B*1.057,O=O>.0031308?1.055*Math.pow(O,1/2.4)-.055:O*12.92,F=F>.0031308?1.055*Math.pow(F,1/2.4)-.055:F*12.92,K=K>.0031308?1.055*Math.pow(K,1/2.4)-.055:K*12.92,O=Math.min(Math.max(0,O),1),F=Math.min(Math.max(0,F),1),K=Math.min(Math.max(0,K),1),[O*255,F*255,K*255]},W.xyz.lab=function(C){var A=C[0],N=C[1],B=C[2],O,F,K;return A/=95.047,N/=100,B/=108.883,A=A>.008856?Math.pow(A,1/3):7.787*A+16/116,N=N>.008856?Math.pow(N,1/3):7.787*N+16/116,B=B>.008856?Math.pow(B,1/3):7.787*B+16/116,O=116*N-16,F=500*(A-N),K=200*(N-B),[O,F,K]},W.lab.xyz=function(C){var A=C[0],N=C[1],B=C[2],O,F,K;F=(A+16)/116,O=N/500+F,K=F-B/200;var nt=Math.pow(F,3),P=Math.pow(O,3),k=Math.pow(K,3);return F=nt>.008856?nt:(F-16/116)/7.787,O=P>.008856?P:(O-16/116)/7.787,K=k>.008856?k:(K-16/116)/7.787,O*=95.047,F*=100,K*=108.883,[O,F,K]},W.lab.lch=function(C){var A=C[0],N=C[1],B=C[2],O,F,K;return O=Math.atan2(B,N),F=O*360/2/Math.PI,F<0&&(F+=360),K=Math.sqrt(N*N+B*B),[A,K,F]},W.lch.lab=function(C){var A=C[0],N=C[1],B=C[2],O,F,K;return K=B/360*2*Math.PI,O=N*Math.cos(K),F=N*Math.sin(K),[A,O,F]},W.rgb.ansi16=function(C){var A=C[0],N=C[1],B=C[2],O=1 in arguments?arguments[1]:W.rgb.hsv(C)[2];if(O=Math.round(O/50),O===0)return 30;var F=30+(Math.round(B/255)<<2|Math.round(N/255)<<1|Math.round(A/255));return O===2&&(F+=60),F},W.hsv.ansi16=function(C){return W.rgb.ansi16(W.hsv.rgb(C),C[2])},W.rgb.ansi256=function(C){var A=C[0],N=C[1],B=C[2];if(A===N&&N===B)return A<8?16:A>248?231:Math.round((A-8)/247*24)+232;var O=16+36*Math.round(A/255*5)+6*Math.round(N/255*5)+Math.round(B/255*5);return O},W.ansi16.rgb=function(C){var A=C%10;if(A===0||A===7)return C>50&&(A+=3.5),A=A/10.5*255,[A,A,A];var N=(~~(C>50)+1)*.5,B=(A&1)*N*255,O=(A>>1&1)*N*255,F=(A>>2&1)*N*255;return[B,O,F]},W.ansi256.rgb=function(C){if(C>=232){var A=(C-232)*10+8;return[A,A,A]}C-=16;var N,B=Math.floor(C/36)/5*255,O=Math.floor((N=C%36)/6)/5*255,F=N%6/5*255;return[B,O,F]},W.rgb.hex=function(C){var A=((Math.round(C[0])&255)<<16)+((Math.round(C[1])&255)<<8)+(Math.round(C[2])&255),N=A.toString(16).toUpperCase();return"000000".substring(N.length)+N},W.hex.rgb=function(C){var A=C.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!A)return[0,0,0];var N=A[0];A[0].length===3&&(N=N.split("").map(function(nt){return nt+nt}).join(""));var B=parseInt(N,16),O=B>>16&255,F=B>>8&255,K=B&255;return[O,F,K]},W.rgb.hcg=function(C){var A=C[0]/255,N=C[1]/255,B=C[2]/255,O=Math.max(Math.max(A,N),B),F=Math.min(Math.min(A,N),B),K=O-F,nt,P;return K<1?nt=F/(1-K):nt=0,K<=0?P=0:O===A?P=(N-B)/K%6:O===N?P=2+(B-A)/K:P=4+(A-N)/K+4,P/=6,P%=1,[P*360,K*100,nt*100]},W.hsl.hcg=function(C){var A=C[1]/100,N=C[2]/100,B=1,O=0;return N<.5?B=2*A*N:B=2*A*(1-N),B<1&&(O=(N-.5*B)/(1-B)),[C[0],B*100,O*100]},W.hsv.hcg=function(C){var A=C[1]/100,N=C[2]/100,B=A*N,O=0;return B<1&&(O=(N-B)/(1-B)),[C[0],B*100,O*100]},W.hcg.rgb=function(C){var A=C[0]/360,N=C[1]/100,B=C[2]/100;if(N===0)return[B*255,B*255,B*255];var O=[0,0,0],F=A%1*6,K=F%1,nt=1-K,P=0;switch(Math.floor(F)){case 0:O[0]=1,O[1]=K,O[2]=0;break;case 1:O[0]=nt,O[1]=1,O[2]=0;break;case 2:O[0]=0,O[1]=1,O[2]=K;break;case 3:O[0]=0,O[1]=nt,O[2]=1;break;case 4:O[0]=K,O[1]=0,O[2]=1;break;default:O[0]=1,O[1]=0,O[2]=nt}return P=(1-N)*B,[(N*O[0]+P)*255,(N*O[1]+P)*255,(N*O[2]+P)*255]},W.hcg.hsv=function(C){var A=C[1]/100,N=C[2]/100,B=A+N*(1-A),O=0;return B>0&&(O=A/B),[C[0],O*100,B*100]},W.hcg.hsl=function(C){var A=C[1]/100,N=C[2]/100,B=N*(1-A)+.5*A,O=0;return B>0&&B<.5?O=A/(2*B):B>=.5&&B<1&&(O=A/(2*(1-B))),[C[0],O*100,B*100]},W.hcg.hwb=function(C){var A=C[1]/100,N=C[2]/100,B=A+N*(1-A);return[C[0],(B-A)*100,(1-B)*100]},W.hwb.hcg=function(C){var A=C[1]/100,N=C[2]/100,B=1-N,O=B-A,F=0;return O<1&&(F=(B-O)/(1-O)),[C[0],O*100,F*100]},W.apple.rgb=function(C){return[C[0]/65535*255,C[1]/65535*255,C[2]/65535*255]},W.rgb.apple=function(C){return[C[0]/255*65535,C[1]/255*65535,C[2]/255*65535]},W.gray.rgb=function(C){return[C[0]/100*255,C[0]/100*255,C[0]/100*255]},W.gray.hsl=W.gray.hsv=function(C){return[0,0,C[0]]},W.gray.hwb=function(C){return[0,100,C[0]]},W.gray.cmyk=function(C){return[0,0,0,C[0]]},W.gray.lab=function(C){return[C[0],0,0]},W.gray.hex=function(C){var A=Math.round(C[0]/100*255)&255,N=(A<<16)+(A<<8)+A,B=N.toString(16).toUpperCase();return"000000".substring(B.length)+B},W.rgb.gray=function(C){var A=(C[0]+C[1]+C[2])/3;return[A/255*100]}},12085:function(ur,ot,$){var Y=$(48168),tt=$(4111),j={},W=Object.keys(Y);function Q(R){var L=function(C){return C==null?C:(arguments.length>1&&(C=Array.prototype.slice.call(arguments)),R(C))};return"conversion"in R&&(L.conversion=R.conversion),L}function Z(R){var L=function(C){if(C==null)return C;arguments.length>1&&(C=Array.prototype.slice.call(arguments));var A=R(C);if(typeof A=="object")for(var N=A.length,B=0;B<N;B++)A[B]=Math.round(A[B]);return A};return"conversion"in R&&(L.conversion=R.conversion),L}W.forEach(function(R){j[R]={},Object.defineProperty(j[R],"channels",{value:Y[R].channels}),Object.defineProperty(j[R],"labels",{value:Y[R].labels});var L=tt(R),C=Object.keys(L);C.forEach(function(A){var N=L[A];j[R][A]=Z(N),j[R][A].raw=Q(N)})}),ur.exports=j},39092:function(ur){"use strict";ur.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},4111:function(ur,ot,$){var Y=$(48168);function tt(){for(var Z={},R=Object.keys(Y),L=R.length,C=0;C<L;C++)Z[R[C]]={distance:-1,parent:null};return Z}function j(Z){var R=tt(),L=[Z];for(R[Z].distance=0;L.length;)for(var C=L.pop(),A=Object.keys(Y[C]),N=A.length,B=0;B<N;B++){var O=A[B],F=R[O];F.distance===-1&&(F.distance=R[C].distance+1,F.parent=C,L.unshift(O))}return R}function W(Z,R){return function(L){return R(Z(L))}}function Q(Z,R){for(var L=[R[Z].parent,Z],C=Y[R[Z].parent][Z],A=R[Z].parent;R[A].parent;)L.unshift(R[A].parent),C=W(Y[R[A].parent][A],C),A=R[A].parent;return C.conversion=L,C}ur.exports=function(Z){for(var R=j(Z),L={},C=Object.keys(R),A=C.length,N=0;N<A;N++){var B=C[N],O=R[B];O.parent!==null&&(L[B]=Q(B,R))}return L}},8874:function(ur){"use strict";ur.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},19818:function(ur,ot,$){var Y=$(8874),tt=$(86851),j=Object.hasOwnProperty,W=Object.create(null);for(var Q in Y)j.call(Y,Q)&&(W[Y[Q]]=Q);var Z=ur.exports={to:{},get:{}};Z.get=function(C){var A=C.substring(0,3).toLowerCase(),N,B;switch(A){case"hsl":N=Z.get.hsl(C),B="hsl";break;case"hwb":N=Z.get.hwb(C),B="hwb";break;default:N=Z.get.rgb(C),B="rgb";break}return N?{model:B,value:N}:null},Z.get.rgb=function(C){if(!C)return null;var A=/^#([a-f0-9]{3,4})$/i,N=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,B=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,O=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,F=/^(\w+)$/,K=[0,0,0,1],nt,P,k;if(nt=C.match(N)){for(k=nt[2],nt=nt[1],P=0;P<3;P++){var yt=P*2;K[P]=parseInt(nt.slice(yt,yt+2),16)}k&&(K[3]=parseInt(k,16)/255)}else if(nt=C.match(A)){for(nt=nt[1],k=nt[3],P=0;P<3;P++)K[P]=parseInt(nt[P]+nt[P],16);k&&(K[3]=parseInt(k+k,16)/255)}else if(nt=C.match(B)){for(P=0;P<3;P++)K[P]=parseInt(nt[P+1],0);nt[4]&&(nt[5]?K[3]=parseFloat(nt[4])*.01:K[3]=parseFloat(nt[4]))}else if(nt=C.match(O)){for(P=0;P<3;P++)K[P]=Math.round(parseFloat(nt[P+1])*2.55);nt[4]&&(nt[5]?K[3]=parseFloat(nt[4])*.01:K[3]=parseFloat(nt[4]))}else return(nt=C.match(F))?nt[1]==="transparent"?[0,0,0,0]:j.call(Y,nt[1])?(K=Y[nt[1]],K[3]=1,K):null:null;for(P=0;P<3;P++)K[P]=R(K[P],0,255);return K[3]=R(K[3],0,1),K},Z.get.hsl=function(C){if(!C)return null;var A=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,N=C.match(A);if(N){var B=parseFloat(N[4]),O=(parseFloat(N[1])%360+360)%360,F=R(parseFloat(N[2]),0,100),K=R(parseFloat(N[3]),0,100),nt=R(isNaN(B)?1:B,0,1);return[O,F,K,nt]}return null},Z.get.hwb=function(C){if(!C)return null;var A=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,N=C.match(A);if(N){var B=parseFloat(N[4]),O=(parseFloat(N[1])%360+360)%360,F=R(parseFloat(N[2]),0,100),K=R(parseFloat(N[3]),0,100),nt=R(isNaN(B)?1:B,0,1);return[O,F,K,nt]}return null},Z.to.hex=function(){var C=tt(arguments);return"#"+L(C[0])+L(C[1])+L(C[2])+(C[3]<1?L(Math.round(C[3]*255)):"")},Z.to.rgb=function(){var C=tt(arguments);return C.length<4||C[3]===1?"rgb("+Math.round(C[0])+", "+Math.round(C[1])+", "+Math.round(C[2])+")":"rgba("+Math.round(C[0])+", "+Math.round(C[1])+", "+Math.round(C[2])+", "+C[3]+")"},Z.to.rgb.percent=function(){var C=tt(arguments),A=Math.round(C[0]/255*100),N=Math.round(C[1]/255*100),B=Math.round(C[2]/255*100);return C.length<4||C[3]===1?"rgb("+A+"%, "+N+"%, "+B+"%)":"rgba("+A+"%, "+N+"%, "+B+"%, "+C[3]+")"},Z.to.hsl=function(){var C=tt(arguments);return C.length<4||C[3]===1?"hsl("+C[0]+", "+C[1]+"%, "+C[2]+"%)":"hsla("+C[0]+", "+C[1]+"%, "+C[2]+"%, "+C[3]+")"},Z.to.hwb=function(){var C=tt(arguments),A="";return C.length>=4&&C[3]!==1&&(A=", "+C[3]),"hwb("+C[0]+", "+C[1]+"%, "+C[2]+"%"+A+")"},Z.to.keyword=function(C){return W[C.slice(0,3)]};function R(C,A,N){return Math.min(Math.max(A,C),N)}function L(C){var A=Math.round(C).toString(16).toUpperCase();return A.length<2?"0"+A:A}},6767:function(ur,ot,$){"use strict";var Y=$(19818),tt=$(12085),j=[].slice,W=["keyword","gray","hex"],Q={};Object.keys(tt).forEach(function(F){Q[j.call(tt[F].labels).sort().join("")]=F});var Z={};function R(F,K){if(!(this instanceof R))return new R(F,K);if(K&&K in W&&(K=null),K&&!(K in tt))throw new Error("Unknown model: "+K);var nt,P;if(F==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(F instanceof R)this.model=F.model,this.color=F.color.slice(),this.valpha=F.valpha;else if(typeof F=="string"){var k=Y.get(F);if(k===null)throw new Error("Unable to parse color from string: "+F);this.model=k.model,P=tt[this.model].channels,this.color=k.value.slice(0,P),this.valpha=typeof k.value[P]=="number"?k.value[P]:1}else if(F.length){this.model=K||"rgb",P=tt[this.model].channels;var yt=j.call(F,0,P);this.color=O(yt,P),this.valpha=typeof F[P]=="number"?F[P]:1}else if(typeof F=="number")F&=16777215,this.model="rgb",this.color=[F>>16&255,F>>8&255,F&255],this.valpha=1;else{this.valpha=1;var st=Object.keys(F);"alpha"in F&&(st.splice(st.indexOf("alpha"),1),this.valpha=typeof F.alpha=="number"?F.alpha:0);var lt=st.sort().join("");if(!(lt in Q))throw new Error("Unable to parse color from object: "+JSON.stringify(F));this.model=Q[lt];var ht=tt[this.model].labels,mt=[];for(nt=0;nt<ht.length;nt++)mt.push(F[ht[nt]]);this.color=O(mt)}if(Z[this.model])for(P=tt[this.model].channels,nt=0;nt<P;nt++){var wt=Z[this.model][nt];wt&&(this.color[nt]=wt(this.color[nt]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}R.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(F){var K=this.model in Y.to?this:this.rgb();K=K.round(typeof F=="number"?F:1);var nt=K.valpha===1?K.color:K.color.concat(this.valpha);return Y.to[K.model](nt)},percentString:function(F){var K=this.rgb().round(typeof F=="number"?F:1),nt=K.valpha===1?K.color:K.color.concat(this.valpha);return Y.to.rgb.percent(nt)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var F={},K=tt[this.model].channels,nt=tt[this.model].labels,P=0;P<K;P++)F[nt[P]]=this.color[P];return this.valpha!==1&&(F.alpha=this.valpha),F},unitArray:function(){var F=this.rgb().color;return F[0]/=255,F[1]/=255,F[2]/=255,this.valpha!==1&&F.push(this.valpha),F},unitObject:function(){var F=this.rgb().object();return F.r/=255,F.g/=255,F.b/=255,this.valpha!==1&&(F.alpha=this.valpha),F},round:function(F){return F=Math.max(F||0,0),new R(this.color.map(C(F)).concat(this.valpha),this.model)},alpha:function(F){return arguments.length?new R(this.color.concat(Math.max(0,Math.min(1,F))),this.model):this.valpha},red:A("rgb",0,N(255)),green:A("rgb",1,N(255)),blue:A("rgb",2,N(255)),hue:A(["hsl","hsv","hsl","hwb","hcg"],0,function(F){return(F%360+360)%360}),saturationl:A("hsl",1,N(100)),lightness:A("hsl",2,N(100)),saturationv:A("hsv",1,N(100)),value:A("hsv",2,N(100)),chroma:A("hcg",1,N(100)),gray:A("hcg",2,N(100)),white:A("hwb",1,N(100)),wblack:A("hwb",2,N(100)),cyan:A("cmyk",0,N(100)),magenta:A("cmyk",1,N(100)),yellow:A("cmyk",2,N(100)),black:A("cmyk",3,N(100)),x:A("xyz",0,N(100)),y:A("xyz",1,N(100)),z:A("xyz",2,N(100)),l:A("lab",0,N(100)),a:A("lab",1),b:A("lab",2),keyword:function(F){return arguments.length?new R(F):tt[this.model].keyword(this.color)},hex:function(F){return arguments.length?new R(F):Y.to.hex(this.rgb().round().color)},rgbNumber:function(){var F=this.rgb().color;return(F[0]&255)<<16|(F[1]&255)<<8|F[2]&255},luminosity:function(){for(var F=this.rgb().color,K=[],nt=0;nt<F.length;nt++){var P=F[nt]/255;K[nt]=P<=.03928?P/12.92:Math.pow((P+.055)/1.055,2.4)}return .2126*K[0]+.7152*K[1]+.0722*K[2]},contrast:function(F){var K=this.luminosity(),nt=F.luminosity();return K>nt?(K+.05)/(nt+.05):(nt+.05)/(K+.05)},level:function(F){var K=this.contrast(F);return K>=7.1?"AAA":K>=4.5?"AA":""},isDark:function(){var F=this.rgb().color,K=(F[0]*299+F[1]*587+F[2]*114)/1e3;return K<128},isLight:function(){return!this.isDark()},negate:function(){for(var F=this.rgb(),K=0;K<3;K++)F.color[K]=255-F.color[K];return F},lighten:function(F){var K=this.hsl();return K.color[2]+=K.color[2]*F,K},darken:function(F){var K=this.hsl();return K.color[2]-=K.color[2]*F,K},saturate:function(F){var K=this.hsl();return K.color[1]+=K.color[1]*F,K},desaturate:function(F){var K=this.hsl();return K.color[1]-=K.color[1]*F,K},whiten:function(F){var K=this.hwb();return K.color[1]+=K.color[1]*F,K},blacken:function(F){var K=this.hwb();return K.color[2]+=K.color[2]*F,K},grayscale:function(){var F=this.rgb().color,K=F[0]*.3+F[1]*.59+F[2]*.11;return R.rgb(K,K,K)},fade:function(F){return this.alpha(this.valpha-this.valpha*F)},opaquer:function(F){return this.alpha(this.valpha+this.valpha*F)},rotate:function(F){var K=this.hsl(),nt=K.color[0];return nt=(nt+F)%360,nt=nt<0?360+nt:nt,K.color[0]=nt,K},mix:function(F,K){if(!F||!F.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof F);var nt=F.rgb(),P=this.rgb(),k=K===void 0?.5:K,yt=2*k-1,st=nt.alpha()-P.alpha(),lt=((yt*st==-1?yt:(yt+st)/(1+yt*st))+1)/2,ht=1-lt;return R.rgb(lt*nt.red()+ht*P.red(),lt*nt.green()+ht*P.green(),lt*nt.blue()+ht*P.blue(),nt.alpha()*k+P.alpha()*(1-k))}},Object.keys(tt).forEach(function(F){if(W.indexOf(F)===-1){var K=tt[F].channels;R.prototype[F]=function(){if(this.model===F)return new R(this);if(arguments.length)return new R(arguments,F);var nt=typeof arguments[K]=="number"?K:this.valpha;return new R(B(tt[this.model][F].raw(this.color)).concat(nt),F)},R[F]=function(nt){return typeof nt=="number"&&(nt=O(j.call(arguments),K)),new R(nt,F)}}});function L(F,K){return Number(F.toFixed(K))}function C(F){return function(K){return L(K,F)}}function A(F,K,nt){return F=Array.isArray(F)?F:[F],F.forEach(function(P){(Z[P]||(Z[P]=[]))[K]=nt}),F=F[0],function(P){var k;return arguments.length?(nt&&(P=nt(P)),k=this[F](),k.color[K]=P,k):(k=this[F]().color[K],nt&&(k=nt(k)),k)}}function N(F){return function(K){return Math.max(0,Math.min(F,K))}}function B(F){return Array.isArray(F)?F:[F]}function O(F,K){for(var nt=0;nt<K;nt++)typeof F[nt]!="number"&&(F[nt]=0);return F}ur.exports=R},31969:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{BRIDGE_GRAPH_NAME:function(){return Q},GraphType:function(){return L},HierarchyNodeType:function(){return C},InclusionType:function(){return R},LAYOUT_CONFIG:function(){return Y},NodeType:function(){return Z},ROOT_NAME:function(){return W},buildGraph:function(){return ea},flatGraph:function(){return Ha},getEdges:function(){return Wa},mergeConfig:function(){return tt}});const Y={graph:{meta:{rankDir:"TB",nodeSep:50,rankSep:50,edgeSep:5,align:void 0}},subScene:{meta:{paddingTop:20,paddingBottom:20,paddingLeft:20,paddingRight:20,labelHeight:20}},nodeSize:{meta:{width:100,maxLabelWidth:0,height:20},node:{width:80,height:20,labelOffset:10,maxLabelWidth:40},bridge:{width:5,height:5,radius:2,labelOffset:0}}};function tt(M={},q=Y){var dt,_t,Pt,jt;const ie=JSON.parse(JSON.stringify(q)),he=((dt=M==null?void 0:M.graph)===null||dt===void 0?void 0:dt.meta)||{},Te=((_t=M==null?void 0:M.subScene)===null||_t===void 0?void 0:_t.meta)||{},Ke=((Pt=M==null?void 0:M.nodeSize)===null||Pt===void 0?void 0:Pt.meta)||{},gn=((jt=M==null?void 0:M.nodeSize)===null||jt===void 0?void 0:jt.node)||{},cn=ie.nodeSize.bridge;return{graph:{meta:Object.assign(ie.graph.meta,he)},subScene:{meta:Object.assign(ie.subScene.meta,Te)},nodeSize:{meta:Object.assign(ie.nodeSize.meta,Ke),node:Object.assign(ie.nodeSize.node,gn),bridge:cn}}}function j(M){return`\u25EC${M}\u25EC`}const W=j("ROOT"),Q=j("BRIDGE_GRAPH");var Z,R,L,C;(function(M){M[M.META=0]="META",M[M.NODE=1]="NODE",M[M.BRIDGE=2]="BRIDGE"})(Z||(Z={})),function(M){M[M.INCLUDE=0]="INCLUDE",M[M.EXCLUDE=1]="EXCLUDE",M[M.UNSPECIFIED=2]="UNSPECIFIED"}(R||(R={})),function(M){M[M.META=0]="META",M[M.CORE=1]="CORE",M[M.BRIDGE=2]="BRIDGE"}(L||(L={})),function(M){M[M.META=0]="META",M[M.OP=1]="OP",M[M.SERIES=2]="SERIES"}(C||(C={}));var A=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof $.g!="undefined"?$.g:typeof self!="undefined"?self:{};function N(M,q){return M(q={exports:{}},q.exports),q.exports}var B=function(){this.__data__=[],this.size=0},O=function(M,q){return M===q||M!=M&&q!=q},F=function(M,q){for(var dt=M.length;dt--;)if(O(M[dt][0],q))return dt;return-1},K=Array.prototype.splice,nt=function(M){var q=this.__data__,dt=F(q,M);return!(dt<0)&&(dt==q.length-1?q.pop():K.call(q,dt,1),--this.size,!0)},P=function(M){var q=this.__data__,dt=F(q,M);return dt<0?void 0:q[dt][1]},k=function(M){return F(this.__data__,M)>-1},yt=function(M,q){var dt=this.__data__,_t=F(dt,M);return _t<0?(++this.size,dt.push([M,q])):dt[_t][1]=q,this};function st(M){var q=-1,dt=M==null?0:M.length;for(this.clear();++q<dt;){var _t=M[q];this.set(_t[0],_t[1])}}st.prototype.clear=B,st.prototype.delete=nt,st.prototype.get=P,st.prototype.has=k,st.prototype.set=yt;var lt=st,ht=function(){this.__data__=new lt,this.size=0},mt=function(M){var q=this.__data__,dt=q.delete(M);return this.size=q.size,dt},wt=function(M){return this.__data__.get(M)},ut=function(M){return this.__data__.has(M)},pt=typeof A=="object"&&A&&A.Object===Object&&A,Nt=typeof self=="object"&&self&&self.Object===Object&&self,Ut=pt||Nt||Function("return this")(),ue=Ut.Symbol,se=Object.prototype,Le=se.hasOwnProperty,Ne=se.toString,we=ue?ue.toStringTag:void 0,At=function(M){var q=Le.call(M,we),dt=M[we];try{M[we]=void 0;var _t=!0}catch(jt){}var Pt=Ne.call(M);return _t&&(q?M[we]=dt:delete M[we]),Pt},Qt=Object.prototype.toString,de=function(M){return Qt.call(M)},rn=ue?ue.toStringTag:void 0,Ee=function(M){return M==null?M===void 0?"[object Undefined]":"[object Null]":rn&&rn in Object(M)?At(M):de(M)},ce=function(M){var q=typeof M;return M!=null&&(q=="object"||q=="function")},Oe,Ze=function(M){if(!ce(M))return!1;var q=Ee(M);return q=="[object Function]"||q=="[object GeneratorFunction]"||q=="[object AsyncFunction]"||q=="[object Proxy]"},fe=Ut["__core-js_shared__"],Ae=(Oe=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||""))?"Symbol(src)_1."+Oe:"",Ye=function(M){return!!Ae&&Ae in M},ge=Function.prototype.toString,Be=function(M){if(M!=null){try{return ge.call(M)}catch(q){}try{return M+""}catch(q){}}return""},te=/^\[object .+?Constructor\]$/,ke=Function.prototype,Ve=Object.prototype,ee=ke.toString,Ft=Ve.hasOwnProperty,bt=RegExp("^"+ee.call(Ft).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Me=function(M){return!(!ce(M)||Ye(M))&&(Ze(M)?bt:te).test(Be(M))},en=function(M,q){return M==null?void 0:M[q]},fn=function(M,q){var dt=en(M,q);return Me(dt)?dt:void 0},Rt=fn(Ut,"Map"),Xn=fn(Object,"create"),Bn=function(){this.__data__=Xn?Xn(null):{},this.size=0},xr=function(M){var q=this.has(M)&&delete this.__data__[M];return this.size-=q?1:0,q},dr=Object.prototype.hasOwnProperty,Ur=function(M){var q=this.__data__;if(Xn){var dt=q[M];return dt==="__lodash_hash_undefined__"?void 0:dt}return dr.call(q,M)?q[M]:void 0},fa=Object.prototype.hasOwnProperty,Ea=function(M){var q=this.__data__;return Xn?q[M]!==void 0:fa.call(q,M)},aa=function(M,q){var dt=this.__data__;return this.size+=this.has(M)?0:1,dt[M]=Xn&&q===void 0?"__lodash_hash_undefined__":q,this};function Da(M){var q=-1,dt=M==null?0:M.length;for(this.clear();++q<dt;){var _t=M[q];this.set(_t[0],_t[1])}}Da.prototype.clear=Bn,Da.prototype.delete=xr,Da.prototype.get=Ur,Da.prototype.has=Ea,Da.prototype.set=aa;var Lr=Da,_n=function(){this.size=0,this.__data__={hash:new Lr,map:new(Rt||lt),string:new Lr}},sr=function(M){var q=typeof M;return q=="string"||q=="number"||q=="symbol"||q=="boolean"?M!=="__proto__":M===null},Pn=function(M,q){var dt=M.__data__;return sr(q)?dt[typeof q=="string"?"string":"hash"]:dt.map},tr=function(M){var q=Pn(this,M).delete(M);return this.size-=q?1:0,q},zn=function(M){return Pn(this,M).get(M)},Wr=function(M){return Pn(this,M).has(M)},Yr=function(M,q){var dt=Pn(this,M),_t=dt.size;return dt.set(M,q),this.size+=dt.size==_t?0:1,this};function nr(M){var q=-1,dt=M==null?0:M.length;for(this.clear();++q<dt;){var _t=M[q];this.set(_t[0],_t[1])}}nr.prototype.clear=_n,nr.prototype.delete=tr,nr.prototype.get=zn,nr.prototype.has=Wr,nr.prototype.set=Yr;var wr=nr,Sr=function(M,q){var dt=this.__data__;if(dt instanceof lt){var _t=dt.__data__;if(!Rt||_t.length<199)return _t.push([M,q]),this.size=++dt.size,this;dt=this.__data__=new wr(_t)}return dt.set(M,q),this.size=dt.size,this};function pr(M){var q=this.__data__=new lt(M);this.size=q.size}pr.prototype.clear=ht,pr.prototype.delete=mt,pr.prototype.get=wt,pr.prototype.has=ut,pr.prototype.set=Sr;var qr=pr,ua=function(M,q){for(var dt=-1,_t=M==null?0:M.length;++dt<_t&&q(M[dt],dt,M)!==!1;);return M},$r=function(){try{var M=fn(Object,"defineProperty");return M({},"",{}),M}catch(q){}}(),ba=function(M,q,dt){q=="__proto__"&&$r?$r(M,q,{configurable:!0,enumerable:!0,value:dt,writable:!0}):M[q]=dt},gt=Object.prototype.hasOwnProperty,Dn=function(M,q,dt){var _t=M[q];gt.call(M,q)&&O(_t,dt)&&(dt!==void 0||q in M)||ba(M,q,dt)},un=function(M,q,dt,_t){var Pt=!dt;dt||(dt={});for(var jt=-1,ie=q.length;++jt<ie;){var he=q[jt],Te=_t?_t(dt[he],M[he],he,dt,M):void 0;Te===void 0&&(Te=M[he]),Pt?ba(dt,he,Te):Dn(dt,he,Te)}return dt},Lt=function(M,q){for(var dt=-1,_t=Array(M);++dt<M;)_t[dt]=q(dt);return _t},Ot=function(M){return M!=null&&typeof M=="object"},it=function(M){return Ot(M)&&Ee(M)=="[object Arguments]"},H=Object.prototype,X=H.hasOwnProperty,xt=H.propertyIsEnumerable,zt=it(function(){return arguments}())?it:function(M){return Ot(M)&&X.call(M,"callee")&&!xt.call(M,"callee")},Vt=Array.isArray,Xt=function(){return!1},ne=N(function(M,q){var dt=q&&!q.nodeType&&q,_t=dt&&M&&!M.nodeType&&M,Pt=_t&&_t.exports===dt?Ut.Buffer:void 0,jt=(Pt?Pt.isBuffer:void 0)||Xt;M.exports=jt}),on=/^(?:0|[1-9]\d*)$/,tn=function(M,q){var dt=typeof M;return!!(q=q==null?9007199254740991:q)&&(dt=="number"||dt!="symbol"&&on.test(M))&&M>-1&&M%1==0&&M<q},He=function(M){return typeof M=="number"&&M>-1&&M%1==0&&M<=9007199254740991},Qn={};Qn["[object Float32Array]"]=Qn["[object Float64Array]"]=Qn["[object Int8Array]"]=Qn["[object Int16Array]"]=Qn["[object Int32Array]"]=Qn["[object Uint8Array]"]=Qn["[object Uint8ClampedArray]"]=Qn["[object Uint16Array]"]=Qn["[object Uint32Array]"]=!0,Qn["[object Arguments]"]=Qn["[object Array]"]=Qn["[object ArrayBuffer]"]=Qn["[object Boolean]"]=Qn["[object DataView]"]=Qn["[object Date]"]=Qn["[object Error]"]=Qn["[object Function]"]=Qn["[object Map]"]=Qn["[object Number]"]=Qn["[object Object]"]=Qn["[object RegExp]"]=Qn["[object Set]"]=Qn["[object String]"]=Qn["[object WeakMap]"]=!1;var Ln=function(M){return Ot(M)&&He(M.length)&&!!Qn[Ee(M)]},Qr=function(M){return function(q){return M(q)}},Ia=N(function(M,q){var dt=q&&!q.nodeType&&q,_t=dt&&M&&!M.nodeType&&M,Pt=_t&&_t.exports===dt&&pt.process,jt=function(){try{var ie=_t&&_t.require&&_t.require("util").types;return ie||Pt&&Pt.binding&&Pt.binding("util")}catch(he){}}();M.exports=jt}),Jn=Ia&&Ia.isTypedArray,Ar=Jn?Qr(Jn):Ln,na=Object.prototype.hasOwnProperty,za=function(M,q){var dt=Vt(M),_t=!dt&&zt(M),Pt=!dt&&!_t&&ne(M),jt=!dt&&!_t&&!Pt&&Ar(M),ie=dt||_t||Pt||jt,he=ie?Lt(M.length,String):[],Te=he.length;for(var Ke in M)!q&&!na.call(M,Ke)||ie&&(Ke=="length"||Pt&&(Ke=="offset"||Ke=="parent")||jt&&(Ke=="buffer"||Ke=="byteLength"||Ke=="byteOffset")||tn(Ke,Te))||he.push(Ke);return he},da=Object.prototype,Ti=function(M){var q=M&&M.constructor;return M===(typeof q=="function"&&q.prototype||da)},ki=function(M,q){return function(dt){return M(q(dt))}},vi=ki(Object.keys,Object),ii=Object.prototype.hasOwnProperty,Di=function(M){if(!Ti(M))return vi(M);var q=[];for(var dt in Object(M))ii.call(M,dt)&&dt!="constructor"&&q.push(dt);return q},Ra=function(M){return M!=null&&He(M.length)&&!Ze(M)},ln=function(M){return Ra(M)?za(M):Di(M)},De=function(M,q){return M&&un(q,ln(q),M)},dn=function(M){var q=[];if(M!=null)for(var dt in Object(M))q.push(dt);return q},Wn=Object.prototype.hasOwnProperty,Gn=function(M){if(!ce(M))return dn(M);var q=Ti(M),dt=[];for(var _t in M)(_t!="constructor"||!q&&Wn.call(M,_t))&&dt.push(_t);return dt},Kn=function(M){return Ra(M)?za(M,!0):Gn(M)},Rr=function(M,q){return M&&un(q,Kn(q),M)},xa=N(function(M,q){var dt=q&&!q.nodeType&&q,_t=dt&&M&&!M.nodeType&&M,Pt=_t&&_t.exports===dt?Ut.Buffer:void 0,jt=Pt?Pt.allocUnsafe:void 0;M.exports=function(ie,he){if(he)return ie.slice();var Te=ie.length,Ke=jt?jt(Te):new ie.constructor(Te);return ie.copy(Ke),Ke}}),La=function(M,q){var dt=-1,_t=M.length;for(q||(q=Array(_t));++dt<_t;)q[dt]=M[dt];return q},ui=function(M,q){for(var dt=-1,_t=M==null?0:M.length,Pt=0,jt=[];++dt<_t;){var ie=M[dt];q(ie,dt,M)&&(jt[Pt++]=ie)}return jt},Fi=function(){return[]},Ki=Object.prototype.propertyIsEnumerable,xo=Object.getOwnPropertySymbols,vo=xo?function(M){return M==null?[]:(M=Object(M),ui(xo(M),function(q){return Ki.call(M,q)}))}:Fi,es=function(M,q){return un(M,vo(M),q)},Wo=function(M,q){for(var dt=-1,_t=q.length,Pt=M.length;++dt<_t;)M[Pt+dt]=q[dt];return M},Zi=ki(Object.getPrototypeOf,Object),bi=Object.getOwnPropertySymbols?function(M){for(var q=[];M;)Wo(q,vo(M)),M=Zi(M);return q}:Fi,gi=function(M,q){return un(M,bi(M),q)},ms=function(M,q,dt){var _t=q(M);return Vt(M)?_t:Wo(_t,dt(M))},Do=function(M){return ms(M,ln,vo)},To=function(M){return ms(M,Kn,bi)},Zs=fn(Ut,"DataView"),Eu=fn(Ut,"Promise"),as=fn(Ut,"Set"),Rs=fn(Ut,"WeakMap"),Su=Be(Zs),fu=Be(Rt),Is=Be(Eu),Zo=Be(as),Wi=Be(Rs),ys=Ee;(Zs&&ys(new Zs(new ArrayBuffer(1)))!="[object DataView]"||Rt&&ys(new Rt)!="[object Map]"||Eu&&ys(Eu.resolve())!="[object Promise]"||as&&ys(new as)!="[object Set]"||Rs&&ys(new Rs)!="[object WeakMap]")&&(ys=function(M){var q=Ee(M),dt=q=="[object Object]"?M.constructor:void 0,_t=dt?Be(dt):"";if(_t)switch(_t){case Su:return"[object DataView]";case fu:return"[object Map]";case Is:return"[object Promise]";case Zo:return"[object Set]";case Wi:return"[object WeakMap]"}return q});var is=ys,Us=Object.prototype.hasOwnProperty,Du=function(M){var q=M.length,dt=new M.constructor(q);return q&&typeof M[0]=="string"&&Us.call(M,"index")&&(dt.index=M.index,dt.input=M.input),dt},qs=Ut.Uint8Array,Cu=function(M){var q=new M.constructor(M.byteLength);return new qs(q).set(new qs(M)),q},ji=function(M,q){var dt=q?Cu(M.buffer):M.buffer;return new M.constructor(dt,M.byteOffset,M.byteLength)},Bi=/\w*$/,Ms=function(M){var q=new M.constructor(M.source,Bi.exec(M));return q.lastIndex=M.lastIndex,q},os=ue?ue.prototype:void 0,Ws=os?os.valueOf:void 0,Ss=function(M){return Ws?Object(Ws.call(M)):{}},Qs=function(M,q){var dt=q?Cu(M.buffer):M.buffer;return new M.constructor(dt,M.byteOffset,M.length)},Qu=function(M,q,dt){var _t=M.constructor;switch(q){case"[object ArrayBuffer]":return Cu(M);case"[object Boolean]":case"[object Date]":return new _t(+M);case"[object DataView]":return ji(M,dt);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Qs(M,dt);case"[object Map]":return new _t;case"[object Number]":case"[object String]":return new _t(M);case"[object RegExp]":return Ms(M);case"[object Set]":return new _t;case"[object Symbol]":return Ss(M)}},xn=Object.create,Vr=function(){function M(){}return function(q){if(!ce(q))return{};if(xn)return xn(q);M.prototype=q;var dt=new M;return M.prototype=void 0,dt}}(),pa=function(M){return typeof M.constructor!="function"||Ti(M)?{}:Vr(Zi(M))},Fa=function(M){return Ot(M)&&is(M)=="[object Map]"},Vi=Ia&&Ia.isMap,Ao=Vi?Qr(Vi):Fa,ao=function(M){return Ot(M)&&is(M)=="[object Set]"},So=Ia&&Ia.isSet,Ts=So?Qr(So):ao,fo={};fo["[object Arguments]"]=fo["[object Array]"]=fo["[object ArrayBuffer]"]=fo["[object DataView]"]=fo["[object Boolean]"]=fo["[object Date]"]=fo["[object Float32Array]"]=fo["[object Float64Array]"]=fo["[object Int8Array]"]=fo["[object Int16Array]"]=fo["[object Int32Array]"]=fo["[object Map]"]=fo["[object Number]"]=fo["[object Object]"]=fo["[object RegExp]"]=fo["[object Set]"]=fo["[object String]"]=fo["[object Symbol]"]=fo["[object Uint8Array]"]=fo["[object Uint8ClampedArray]"]=fo["[object Uint16Array]"]=fo["[object Uint32Array]"]=!0,fo["[object Error]"]=fo["[object Function]"]=fo["[object WeakMap]"]=!1;var ou=function M(q,dt,_t,Pt,jt,ie){var he,Te=1&dt,Ke=2&dt,gn=4&dt;if(_t&&(he=jt?_t(q,Pt,jt,ie):_t(q)),he!==void 0)return he;if(!ce(q))return q;var cn=Vt(q);if(cn){if(he=Du(q),!Te)return La(q,he)}else{var jn=is(q),En=jn=="[object Function]"||jn=="[object GeneratorFunction]";if(ne(q))return xa(q,Te);if(jn=="[object Object]"||jn=="[object Arguments]"||En&&!jt){if(he=Ke||En?{}:pa(q),!Te)return Ke?gi(q,Rr(he,q)):es(q,De(he,q))}else{if(!fo[jn])return jt?q:{};he=Qu(q,jn,Te)}}ie||(ie=new qr);var ya=ie.get(q);if(ya)return ya;ie.set(q,he),Ts(q)?q.forEach(function(Fr){he.add(M(Fr,dt,_t,Fr,q,ie))}):Ao(q)&&q.forEach(function(Fr,or){he.set(or,M(Fr,dt,_t,or,q,ie))});var Dr=cn?void 0:(gn?Ke?To:Do:Ke?Kn:ln)(q);return ua(Dr||q,function(Fr,or){Dr&&(Fr=q[or=Fr]),Dn(he,or,M(Fr,dt,_t,or,q,ie))}),he},Cs=function(M){return ou(M,4)},Au=function(M){return function(){return M}},Tl=function(M){return function(q,dt,_t){for(var Pt=-1,jt=Object(q),ie=_t(q),he=ie.length;he--;){var Te=ie[M?he:++Pt];if(dt(jt[Te],Te,jt)===!1)break}return q}}(),bl=function(M,q){return M&&Tl(M,q,ln)},Js=function(M,q){return function(dt,_t){if(dt==null)return dt;if(!Ra(dt))return M(dt,_t);for(var Pt=dt.length,jt=q?Pt:-1,ie=Object(dt);(q?jt--:++jt<Pt)&&_t(ie[jt],jt,ie)!==!1;);return dt}}(bl),ul=function(M){return M},Mu=function(M){return typeof M=="function"?M:ul},Pu=function(M,q){return(Vt(M)?ua:Js)(M,Mu(q))},Nu=Pu,fs=function(M,q){var dt=[];return Js(M,function(_t,Pt,jt){q(_t,Pt,jt)&&dt.push(_t)}),dt},Bs=function(M){return this.__data__.set(M,"__lodash_hash_undefined__"),this},gu=function(M){return this.__data__.has(M)};function Fu(M){var q=-1,dt=M==null?0:M.length;for(this.__data__=new wr;++q<dt;)this.add(M[q])}Fu.prototype.add=Fu.prototype.push=Bs,Fu.prototype.has=gu;var Wu=Fu,Ju=function(M,q){for(var dt=-1,_t=M==null?0:M.length;++dt<_t;)if(q(M[dt],dt,M))return!0;return!1},tu=function(M,q){return M.has(q)},gc=function(M,q,dt,_t,Pt,jt){var ie=1&dt,he=M.length,Te=q.length;if(he!=Te&&!(ie&&Te>he))return!1;var Ke=jt.get(M),gn=jt.get(q);if(Ke&&gn)return Ke==q&&gn==M;var cn=-1,jn=!0,En=2&dt?new Wu:void 0;for(jt.set(M,q),jt.set(q,M);++cn<he;){var ya=M[cn],Dr=q[cn];if(_t)var Fr=ie?_t(Dr,ya,cn,q,M,jt):_t(ya,Dr,cn,M,q,jt);if(Fr!==void 0){if(Fr)continue;jn=!1;break}if(En){if(!Ju(q,function(or,Xa){if(!tu(En,Xa)&&(ya===or||Pt(ya,or,dt,_t,jt)))return En.push(Xa)})){jn=!1;break}}else if(ya!==Dr&&!Pt(ya,Dr,dt,_t,jt)){jn=!1;break}}return jt.delete(M),jt.delete(q),jn},Bl=function(M){var q=-1,dt=Array(M.size);return M.forEach(function(_t,Pt){dt[++q]=[Pt,_t]}),dt},vl=function(M){var q=-1,dt=Array(M.size);return M.forEach(function(_t){dt[++q]=_t}),dt},Ls=ue?ue.prototype:void 0,el=Ls?Ls.valueOf:void 0,oc=function(M,q,dt,_t,Pt,jt,ie){switch(dt){case"[object DataView]":if(M.byteLength!=q.byteLength||M.byteOffset!=q.byteOffset)return!1;M=M.buffer,q=q.buffer;case"[object ArrayBuffer]":return!(M.byteLength!=q.byteLength||!jt(new qs(M),new qs(q)));case"[object Boolean]":case"[object Date]":case"[object Number]":return O(+M,+q);case"[object Error]":return M.name==q.name&&M.message==q.message;case"[object RegExp]":case"[object String]":return M==q+"";case"[object Map]":var he=Bl;case"[object Set]":var Te=1&_t;if(he||(he=vl),M.size!=q.size&&!Te)return!1;var Ke=ie.get(M);if(Ke)return Ke==q;_t|=2,ie.set(M,q);var gn=gc(he(M),he(q),_t,Pt,jt,ie);return ie.delete(M),gn;case"[object Symbol]":if(el)return el.call(M)==el.call(q)}return!1},Ol=Object.prototype.hasOwnProperty,Ic=function(M,q,dt,_t,Pt,jt){var ie=1&dt,he=Do(M),Te=he.length;if(Te!=Do(q).length&&!ie)return!1;for(var Ke=Te;Ke--;){var gn=he[Ke];if(!(ie?gn in q:Ol.call(q,gn)))return!1}var cn=jt.get(M),jn=jt.get(q);if(cn&&jn)return cn==q&&jn==M;var En=!0;jt.set(M,q),jt.set(q,M);for(var ya=ie;++Ke<Te;){var Dr=M[gn=he[Ke]],Fr=q[gn];if(_t)var or=ie?_t(Fr,Dr,gn,q,M,jt):_t(Dr,Fr,gn,M,q,jt);if(!(or===void 0?Dr===Fr||Pt(Dr,Fr,dt,_t,jt):or)){En=!1;break}ya||(ya=gn=="constructor")}if(En&&!ya){var Xa=M.constructor,Hn=q.constructor;Xa==Hn||!("constructor"in M)||!("constructor"in q)||typeof Xa=="function"&&Xa instanceof Xa&&typeof Hn=="function"&&Hn instanceof Hn||(En=!1)}return jt.delete(M),jt.delete(q),En},Se=Object.prototype.hasOwnProperty,ve=function(M,q,dt,_t,Pt,jt){var ie=Vt(M),he=Vt(q),Te=ie?"[object Array]":is(M),Ke=he?"[object Array]":is(q),gn=(Te=Te=="[object Arguments]"?"[object Object]":Te)=="[object Object]",cn=(Ke=Ke=="[object Arguments]"?"[object Object]":Ke)=="[object Object]",jn=Te==Ke;if(jn&&ne(M)){if(!ne(q))return!1;ie=!0,gn=!1}if(jn&&!gn)return jt||(jt=new qr),ie||Ar(M)?gc(M,q,dt,_t,Pt,jt):oc(M,q,Te,dt,_t,Pt,jt);if(!(1&dt)){var En=gn&&Se.call(M,"__wrapped__"),ya=cn&&Se.call(q,"__wrapped__");if(En||ya){var Dr=En?M.value():M,Fr=ya?q.value():q;return jt||(jt=new qr),Pt(Dr,Fr,dt,_t,jt)}}return!!jn&&(jt||(jt=new qr),Ic(M,q,dt,_t,Pt,jt))},Gt=function M(q,dt,_t,Pt,jt){return q===dt||(q==null||dt==null||!Ot(q)&&!Ot(dt)?q!=q&&dt!=dt:ve(q,dt,_t,Pt,M,jt))},re=function(M,q,dt,_t){var Pt=dt.length,jt=Pt,ie=!_t;if(M==null)return!jt;for(M=Object(M);Pt--;){var he=dt[Pt];if(ie&&he[2]?he[1]!==M[he[0]]:!(he[0]in M))return!1}for(;++Pt<jt;){var Te=(he=dt[Pt])[0],Ke=M[Te],gn=he[1];if(ie&&he[2]){if(Ke===void 0&&!(Te in M))return!1}else{var cn=new qr;if(_t)var jn=_t(Ke,gn,Te,M,q,cn);if(!(jn===void 0?Gt(gn,Ke,3,_t,cn):jn))return!1}}return!0},me=function(M){return M==M&&!ce(M)},bn=function(M){for(var q=ln(M),dt=q.length;dt--;){var _t=q[dt],Pt=M[_t];q[dt]=[_t,Pt,me(Pt)]}return q},Zn=function(M,q){return function(dt){return dt!=null&&dt[M]===q&&(q!==void 0||M in Object(dt))}},Yt=function(M){var q=bn(M);return q.length==1&&q[0][2]?Zn(q[0][0],q[0][1]):function(dt){return dt===M||re(dt,M,q)}},Ie=function(M){return typeof M=="symbol"||Ot(M)&&Ee(M)=="[object Symbol]"},Ge=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fe=/^\w*$/,In=function(M,q){if(Vt(M))return!1;var dt=typeof M;return!(dt!="number"&&dt!="symbol"&&dt!="boolean"&&M!=null&&!Ie(M))||Fe.test(M)||!Ge.test(M)||q!=null&&M in Object(q)};function ar(M,q){if(typeof M!="function"||q!=null&&typeof q!="function")throw new TypeError("Expected a function");var dt=function(){var _t=arguments,Pt=q?q.apply(this,_t):_t[0],jt=dt.cache;if(jt.has(Pt))return jt.get(Pt);var ie=M.apply(this,_t);return dt.cache=jt.set(Pt,ie)||jt,ie};return dt.cache=new(ar.Cache||wr),dt}ar.Cache=wr;var ra=ar,Ta=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$a=/\\(\\)?/g,ja=function(M){var q=ra(M,function(_t){return dt.size===500&&dt.clear(),_t}),dt=q.cache;return q}(function(M){var q=[];return M.charCodeAt(0)===46&&q.push(""),M.replace(Ta,function(dt,_t,Pt,jt){q.push(Pt?jt.replace($a,"$1"):_t||dt)}),q}),Oa=function(M,q){for(var dt=-1,_t=M==null?0:M.length,Pt=Array(_t);++dt<_t;)Pt[dt]=q(M[dt],dt,M);return Pt},so=ue?ue.prototype:void 0,Ai=so?so.toString:void 0,Oi=function M(q){if(typeof q=="string")return q;if(Vt(q))return Oa(q,M)+"";if(Ie(q))return Ai?Ai.call(q):"";var dt=q+"";return dt=="0"&&1/q==-Infinity?"-0":dt},hs=function(M){return M==null?"":Oi(M)},wo=function(M,q){return Vt(M)?M:In(M,q)?[M]:ja(hs(M))},ho=function(M){if(typeof M=="string"||Ie(M))return M;var q=M+"";return q=="0"&&1/M==-Infinity?"-0":q},Ro=function(M,q){for(var dt=0,_t=(q=wo(q,M)).length;M!=null&&dt<_t;)M=M[ho(q[dt++])];return dt&&dt==_t?M:void 0},Ys=function(M,q,dt){var _t=M==null?void 0:Ro(M,q);return _t===void 0?dt:_t},Ps=function(M,q){return M!=null&&q in Object(M)},As=function(M,q,dt){for(var _t=-1,Pt=(q=wo(q,M)).length,jt=!1;++_t<Pt;){var ie=ho(q[_t]);if(!(jt=M!=null&&dt(M,ie)))break;M=M[ie]}return jt||++_t!=Pt?jt:!!(Pt=M==null?0:M.length)&&He(Pt)&&tn(ie,Pt)&&(Vt(M)||zt(M))},Vs=function(M,q){return M!=null&&As(M,q,Ps)},su=function(M,q){return In(M)&&me(q)?Zn(ho(M),q):function(dt){var _t=Ys(dt,M);return _t===void 0&&_t===q?Vs(dt,M):Gt(q,_t,3)}},xl=function(M){return function(q){return q==null?void 0:q[M]}},Rl=function(M){return function(q){return Ro(q,M)}},Ll=function(M){return In(M)?xl(ho(M)):Rl(M)},nl=function(M){return typeof M=="function"?M:M==null?ul:typeof M=="object"?Vt(M)?su(M[0],M[1]):Yt(M):Ll(M)},rl=function(M,q){return(Vt(M)?ui:fs)(M,nl(q))},Ef=Object.prototype.hasOwnProperty,Sf=function(M,q){return M!=null&&Ef.call(M,q)},Yl=function(M,q){return M!=null&&As(M,q,Sf)},Cf=Object.prototype.hasOwnProperty,T=function(M){if(M==null)return!0;if(Ra(M)&&(Vt(M)||typeof M=="string"||typeof M.splice=="function"||ne(M)||Ar(M)||zt(M)))return!M.length;var q=is(M);if(q=="[object Map]"||q=="[object Set]")return!M.size;if(Ti(M))return!Di(M).length;for(var dt in M)if(Cf.call(M,dt))return!1;return!0},rt=function(M){return M===void 0},Kt=function(M,q){var dt=-1,_t=Ra(M)?Array(M.length):[];return Js(M,function(Pt,jt,ie){_t[++dt]=q(Pt,jt,ie)}),_t},pe=function(M,q){return(Vt(M)?Oa:Kt)(M,nl(q))},Re=function(M,q,dt,_t){var Pt=-1,jt=M==null?0:M.length;for(_t&&jt&&(dt=M[++Pt]);++Pt<jt;)dt=q(dt,M[Pt],Pt,M);return dt},Je=function(M,q,dt,_t,Pt){return Pt(M,function(jt,ie,he){dt=_t?(_t=!1,jt):q(dt,jt,ie,he)}),dt},an=function(M,q,dt){var _t=Vt(M)?Re:Je,Pt=arguments.length<3;return _t(M,nl(q),dt,Pt,Js)},wn=function(M){return typeof M=="string"||!Vt(M)&&Ot(M)&&Ee(M)=="[object String]"},Mn=xl("length"),rr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),We=function(M){return rr.test(M)},ca="[\\ud800-\\udfff]",ha="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",_r="\\ud83c[\\udffb-\\udfff]",Va="[^\\ud800-\\udfff]",qa="(?:\\ud83c[\\udde6-\\uddff]){2}",ma="[\\ud800-\\udbff][\\udc00-\\udfff]",Mi="(?:"+ha+"|"+_r+")?",zo="[\\ufe0e\\ufe0f]?"+Mi+("(?:\\u200d(?:"+[Va,qa,ma].join("|")+")[\\ufe0e\\ufe0f]?"+Mi+")*"),_o="(?:"+[Va+ha+"?",ha,qa,ma,ca].join("|")+")",Lo=RegExp(_r+"(?="+_r+")|"+_o+zo,"g"),yo=function(M){for(var q=Lo.lastIndex=0;Lo.test(M);)++q;return q},No=function(M){return We(M)?yo(M):Mn(M)},Vu=function(M){if(M==null)return 0;if(Ra(M))return wn(M)?No(M):M.length;var q=is(M);return q=="[object Map]"||q=="[object Set]"?M.size:Di(M).length},Bu=function(M,q,dt){var _t=Vt(M),Pt=_t||ne(M)||Ar(M);if(q=nl(q),dt==null){var jt=M&&M.constructor;dt=Pt?_t?new jt:[]:ce(M)&&Ze(jt)?Vr(Zi(M)):{}}return(Pt?ua:bl)(M,function(ie,he,Te){return q(dt,ie,he,Te)}),dt},ju=ue?ue.isConcatSpreadable:void 0,tl=function(M){return Vt(M)||zt(M)||!!(ju&&M&&M[ju])},Hu=function M(q,dt,_t,Pt,jt){var ie=-1,he=q.length;for(_t||(_t=tl),jt||(jt=[]);++ie<he;){var Te=q[ie];dt>0&&_t(Te)?dt>1?M(Te,dt-1,_t,Pt,jt):Wo(jt,Te):Pt||(jt[jt.length]=Te)}return jt},al=function(M,q,dt){switch(dt.length){case 0:return M.call(q);case 1:return M.call(q,dt[0]);case 2:return M.call(q,dt[0],dt[1]);case 3:return M.call(q,dt[0],dt[1],dt[2])}return M.apply(q,dt)},il=Math.max,ds=function(M,q,dt){return q=il(q===void 0?M.length-1:q,0),function(){for(var _t=arguments,Pt=-1,jt=il(_t.length-q,0),ie=Array(jt);++Pt<jt;)ie[Pt]=_t[q+Pt];Pt=-1;for(var he=Array(q+1);++Pt<q;)he[Pt]=_t[Pt];return he[q]=dt(ie),al(M,this,he)}},uu=$r?function(M,q){return $r(M,"toString",{configurable:!0,enumerable:!1,value:Au(q),writable:!0})}:ul,Jc=Date.now,tf=function(M){var q=0,dt=0;return function(){var _t=Jc(),Pt=16-(_t-dt);if(dt=_t,Pt>0){if(++q>=800)return arguments[0]}else q=0;return M.apply(void 0,arguments)}}(uu),zl=function(M,q){return tf(ds(M,q,ul),M+"")},wl=function(M,q,dt,_t){for(var Pt=M.length,jt=dt+(_t?1:-1);_t?jt--:++jt<Pt;)if(q(M[jt],jt,M))return jt;return-1},hh=function(M){return M!=M},Nd=function(M,q,dt){for(var _t=dt-1,Pt=M.length;++_t<Pt;)if(M[_t]===q)return _t;return-1},fp=function(M,q,dt){return q==q?Nd(M,q,dt):wl(M,hh,dt)},Vp=function(M,q){return!!(M==null?0:M.length)&&fp(M,q,0)>-1},dh=function(M,q,dt){for(var _t=-1,Pt=M==null?0:M.length;++_t<Pt;)if(dt(q,M[_t]))return!0;return!1},kd=function(){},jp=as&&1/vl(new as([,-0]))[1]==1/0?function(M){return new as(M)}:kd,df=function(M,q,dt){var _t=-1,Pt=Vp,jt=M.length,ie=!0,he=[],Te=he;if(dt)ie=!1,Pt=dh;else if(jt>=200){var Ke=q?null:jp(M);if(Ke)return vl(Ke);ie=!1,Pt=tu,Te=new Wu}else Te=q?[]:he;t:for(;++_t<jt;){var gn=M[_t],cn=q?q(gn):gn;if(gn=dt||gn!==0?gn:0,ie&&cn==cn){for(var jn=Te.length;jn--;)if(Te[jn]===cn)continue t;q&&Te.push(cn),he.push(gn)}else Pt(Te,cn,dt)||(Te!==he&&Te.push(cn),he.push(gn))}return he},Rf=function(M){return Ot(M)&&Ra(M)},hp=zl(function(M){return df(Hu(M,1,Rf,!0))}),jf=function(M,q){return Oa(q,function(dt){return M[dt]})},pf,ph=function(M){return M==null?[]:jf(M,ln(M))};try{pf={clone:Cs,constant:Au,each:Nu,filter:rl,has:Yl,isArray:Vt,isEmpty:T,isFunction:Ze,isUndefined:rt,keys:ln,map:pe,reduce:an,size:Vu,transform:Bu,union:hp,values:ph}}catch(M){}pf||(pf=window._);var Ri=pf,Lh=bs;function bs(M){this._isDirected=!Ri.has(M,"directed")||M.directed,this._isMultigraph=!!Ri.has(M,"multigraph")&&M.multigraph,this._isCompound=!!Ri.has(M,"compound")&&M.compound,this._label=void 0,this._defaultNodeLabelFn=Ri.constant(void 0),this._defaultEdgeLabelFn=Ri.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function Ph(M,q){M[q]?M[q]++:M[q]=1}function sc(M,q){--M[q]||delete M[q]}function ef(M,q,dt,_t){var Pt=""+q,jt=""+dt;if(!M&&Pt>jt){var ie=Pt;Pt=jt,jt=ie}return Pt+""+jt+""+(Ri.isUndefined(_t)?"\0":_t)}function vf(M,q,dt,_t){var Pt=""+q,jt=""+dt;if(!M&&Pt>jt){var ie=Pt;Pt=jt,jt=ie}var he={v:Pt,w:jt};return _t&&(he.name=_t),he}function vh(M,q){return ef(M,q.v,q.w,q.name)}bs.prototype._nodeCount=0,bs.prototype._edgeCount=0,bs.prototype.isDirected=function(){return this._isDirected},bs.prototype.isMultigraph=function(){return this._isMultigraph},bs.prototype.isCompound=function(){return this._isCompound},bs.prototype.setGraph=function(M){return this._label=M,this},bs.prototype.graph=function(){return this._label},bs.prototype.setDefaultNodeLabel=function(M){return Ri.isFunction(M)||(M=Ri.constant(M)),this._defaultNodeLabelFn=M,this},bs.prototype.nodeCount=function(){return this._nodeCount},bs.prototype.nodes=function(){return Ri.keys(this._nodes)},bs.prototype.sources=function(){var M=this;return Ri.filter(this.nodes(),function(q){return Ri.isEmpty(M._in[q])})},bs.prototype.sinks=function(){var M=this;return Ri.filter(this.nodes(),function(q){return Ri.isEmpty(M._out[q])})},bs.prototype.setNodes=function(M,q){var dt=arguments,_t=this;return Ri.each(M,function(Pt){dt.length>1?_t.setNode(Pt,q):_t.setNode(Pt)}),this},bs.prototype.setNode=function(M,q){return Ri.has(this._nodes,M)?(arguments.length>1&&(this._nodes[M]=q),this):(this._nodes[M]=arguments.length>1?q:this._defaultNodeLabelFn(M),this._isCompound&&(this._parent[M]="\0",this._children[M]={},this._children["\0"][M]=!0),this._in[M]={},this._preds[M]={},this._out[M]={},this._sucs[M]={},++this._nodeCount,this)},bs.prototype.node=function(M){return this._nodes[M]},bs.prototype.hasNode=function(M){return Ri.has(this._nodes,M)},bs.prototype.removeNode=function(M){var q=this;if(Ri.has(this._nodes,M)){var dt=function(_t){q.removeEdge(q._edgeObjs[_t])};delete this._nodes[M],this._isCompound&&(this._removeFromParentsChildList(M),delete this._parent[M],Ri.each(this.children(M),function(_t){q.setParent(_t)}),delete this._children[M]),Ri.each(Ri.keys(this._in[M]),dt),delete this._in[M],delete this._preds[M],Ri.each(Ri.keys(this._out[M]),dt),delete this._out[M],delete this._sucs[M],--this._nodeCount}return this},bs.prototype.setParent=function(M,q){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(Ri.isUndefined(q))q="\0";else{for(var dt=q+="";!Ri.isUndefined(dt);dt=this.parent(dt))if(dt===M)throw new Error("Setting "+q+" as parent of "+M+" would create a cycle");this.setNode(q)}return this.setNode(M),this._removeFromParentsChildList(M),this._parent[M]=q,this._children[q][M]=!0,this},bs.prototype._removeFromParentsChildList=function(M){delete this._children[this._parent[M]][M]},bs.prototype.parent=function(M){if(this._isCompound){var q=this._parent[M];if(q!=="\0")return q}},bs.prototype.children=function(M){if(Ri.isUndefined(M)&&(M="\0"),this._isCompound){var q=this._children[M];if(q)return Ri.keys(q)}else{if(M==="\0")return this.nodes();if(this.hasNode(M))return[]}},bs.prototype.predecessors=function(M){var q=this._preds[M];if(q)return Ri.keys(q)},bs.prototype.successors=function(M){var q=this._sucs[M];if(q)return Ri.keys(q)},bs.prototype.neighbors=function(M){var q=this.predecessors(M);if(q)return Ri.union(q,this.successors(M))},bs.prototype.isLeaf=function(M){return(this.isDirected()?this.successors(M):this.neighbors(M)).length===0},bs.prototype.filterNodes=function(M){var q=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});q.setGraph(this.graph());var dt=this;Ri.each(this._nodes,function(jt,ie){M(ie)&&q.setNode(ie,jt)}),Ri.each(this._edgeObjs,function(jt){q.hasNode(jt.v)&&q.hasNode(jt.w)&&q.setEdge(jt,dt.edge(jt))});var _t={};function Pt(jt){var ie=dt.parent(jt);return ie===void 0||q.hasNode(ie)?(_t[jt]=ie,ie):ie in _t?_t[ie]:Pt(ie)}return this._isCompound&&Ri.each(q.nodes(),function(jt){q.setParent(jt,Pt(jt))}),q},bs.prototype.setDefaultEdgeLabel=function(M){return Ri.isFunction(M)||(M=Ri.constant(M)),this._defaultEdgeLabelFn=M,this},bs.prototype.edgeCount=function(){return this._edgeCount},bs.prototype.edges=function(){return Ri.values(this._edgeObjs)},bs.prototype.setPath=function(M,q){var dt=this,_t=arguments;return Ri.reduce(M,function(Pt,jt){return _t.length>1?dt.setEdge(Pt,jt,q):dt.setEdge(Pt,jt),jt}),this},bs.prototype.setEdge=function(){var M,q,dt,_t,Pt=!1,jt=arguments[0];typeof jt=="object"&&jt!==null&&"v"in jt?(M=jt.v,q=jt.w,dt=jt.name,arguments.length===2&&(_t=arguments[1],Pt=!0)):(M=jt,q=arguments[1],dt=arguments[3],arguments.length>2&&(_t=arguments[2],Pt=!0)),M=""+M,q=""+q,Ri.isUndefined(dt)||(dt=""+dt);var ie=ef(this._isDirected,M,q,dt);if(Ri.has(this._edgeLabels,ie))return Pt&&(this._edgeLabels[ie]=_t),this;if(!Ri.isUndefined(dt)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(M),this.setNode(q),this._edgeLabels[ie]=Pt?_t:this._defaultEdgeLabelFn(M,q,dt);var he=vf(this._isDirected,M,q,dt);return M=he.v,q=he.w,Object.freeze(he),this._edgeObjs[ie]=he,Ph(this._preds[q],M),Ph(this._sucs[M],q),this._in[q][ie]=he,this._out[M][ie]=he,this._edgeCount++,this},bs.prototype.edge=function(M,q,dt){var _t=arguments.length===1?vh(this._isDirected,arguments[0]):ef(this._isDirected,M,q,dt);return this._edgeLabels[_t]},bs.prototype.hasEdge=function(M,q,dt){var _t=arguments.length===1?vh(this._isDirected,arguments[0]):ef(this._isDirected,M,q,dt);return Ri.has(this._edgeLabels,_t)},bs.prototype.removeEdge=function(M,q,dt){var _t=arguments.length===1?vh(this._isDirected,arguments[0]):ef(this._isDirected,M,q,dt),Pt=this._edgeObjs[_t];return Pt&&(M=Pt.v,q=Pt.w,delete this._edgeLabels[_t],delete this._edgeObjs[_t],sc(this._preds[q],M),sc(this._sucs[M],q),delete this._in[q][_t],delete this._out[M][_t],this._edgeCount--),this},bs.prototype.inEdges=function(M,q){var dt=this._in[M];if(dt){var _t=Ri.values(dt);return q?Ri.filter(_t,function(Pt){return Pt.v===q}):_t}},bs.prototype.outEdges=function(M,q){var dt=this._out[M];if(dt){var _t=Ri.values(dt);return q?Ri.filter(_t,function(Pt){return Pt.w===q}):_t}},bs.prototype.nodeEdges=function(M,q){var dt=this.inEdges(M,q);if(dt)return dt.concat(this.outEdges(M,q))};var Lf={Graph:Lh,version:"2.1.8"},js={write:function(M){var q={options:{directed:M.isDirected(),multigraph:M.isMultigraph(),compound:M.isCompound()},nodes:dp(M),edges:Pl(M)};return Ri.isUndefined(M.graph())||(q.value=Ri.clone(M.graph())),q},read:function(M){var q=new Lh(M.options).setGraph(M.value);return Ri.each(M.nodes,function(dt){q.setNode(dt.v,dt.value),dt.parent&&q.setParent(dt.v,dt.parent)}),Ri.each(M.edges,function(dt){q.setEdge({v:dt.v,w:dt.w,name:dt.name},dt.value)}),q}};function dp(M){return Ri.map(M.nodes(),function(q){var dt=M.node(q),_t=M.parent(q),Pt={v:q};return Ri.isUndefined(dt)||(Pt.value=dt),Ri.isUndefined(_t)||(Pt.parent=_t),Pt})}function Pl(M){return Ri.map(M.edges(),function(q){var dt=M.edge(q),_t={v:q.v,w:q.w};return Ri.isUndefined(q.name)||(_t.name=q.name),Ri.isUndefined(dt)||(_t.value=dt),_t})}var Dt=function(M){var q,dt={},_t=[];function Pt(jt){Ri.has(dt,jt)||(dt[jt]=!0,q.push(jt),Ri.each(M.successors(jt),Pt),Ri.each(M.predecessors(jt),Pt))}return Ri.each(M.nodes(),function(jt){q=[],Pt(jt),q.length&&_t.push(q)}),_t},ae=xe;function xe(){this._arr=[],this._keyIndices={}}xe.prototype.size=function(){return this._arr.length},xe.prototype.keys=function(){return this._arr.map(function(M){return M.key})},xe.prototype.has=function(M){return Ri.has(this._keyIndices,M)},xe.prototype.priority=function(M){var q=this._keyIndices[M];if(q!==void 0)return this._arr[q].priority},xe.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},xe.prototype.add=function(M,q){var dt=this._keyIndices;if(M=String(M),!Ri.has(dt,M)){var _t=this._arr,Pt=_t.length;return dt[M]=Pt,_t.push({key:M,priority:q}),this._decrease(Pt),!0}return!1},xe.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var M=this._arr.pop();return delete this._keyIndices[M.key],this._heapify(0),M.key},xe.prototype.decrease=function(M,q){var dt=this._keyIndices[M];if(q>this._arr[dt].priority)throw new Error("New priority is greater than current priority. Key: "+M+" Old: "+this._arr[dt].priority+" New: "+q);this._arr[dt].priority=q,this._decrease(dt)},xe.prototype._heapify=function(M){var q=this._arr,dt=2*M,_t=dt+1,Pt=M;dt<q.length&&(Pt=q[dt].priority<q[Pt].priority?dt:Pt,_t<q.length&&(Pt=q[_t].priority<q[Pt].priority?_t:Pt),Pt!==M&&(this._swap(M,Pt),this._heapify(Pt)))},xe.prototype._decrease=function(M){for(var q,dt=this._arr,_t=dt[M].priority;M!==0&&!(dt[q=M>>1].priority<_t);)this._swap(M,q),M=q},xe.prototype._swap=function(M,q){var dt=this._arr,_t=this._keyIndices,Pt=dt[M],jt=dt[q];dt[M]=jt,dt[q]=Pt,_t[jt.key]=M,_t[Pt.key]=q};var qe=function(M,q,dt,_t){return function(Pt,jt,ie,he){var Te,Ke,gn={},cn=new ae,jn=function(En){var ya=En.v!==Te?En.v:En.w,Dr=gn[ya],Fr=ie(En),or=Ke.distance+Fr;if(Fr<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+En+" Weight: "+Fr);or<Dr.distance&&(Dr.distance=or,Dr.predecessor=Te,cn.decrease(ya,or))};for(Pt.nodes().forEach(function(En){var ya=En===jt?0:Number.POSITIVE_INFINITY;gn[En]={distance:ya},cn.add(En,ya)});cn.size()>0&&(Te=cn.removeMin(),(Ke=gn[Te]).distance!==Number.POSITIVE_INFINITY);)he(Te).forEach(jn);return gn}(M,String(q),dt||yn,_t||function(Pt){return M.outEdges(Pt)})},yn=Ri.constant(1),Er=function(M,q,dt){return Ri.transform(M.nodes(),function(_t,Pt){_t[Pt]=qe(M,Pt,q,dt)},{})},Cr=function(M){var q=0,dt=[],_t={},Pt=[];function jt(ie){var he=_t[ie]={onStack:!0,lowlink:q,index:q++};if(dt.push(ie),M.successors(ie).forEach(function(gn){Ri.has(_t,gn)?_t[gn].onStack&&(he.lowlink=Math.min(he.lowlink,_t[gn].index)):(jt(gn),he.lowlink=Math.min(he.lowlink,_t[gn].lowlink))}),he.lowlink===he.index){var Te,Ke=[];do Te=dt.pop(),_t[Te].onStack=!1,Ke.push(Te);while(ie!==Te);Pt.push(Ke)}}return M.nodes().forEach(function(ie){Ri.has(_t,ie)||jt(ie)}),Pt},oa=function(M){return Ri.filter(Cr(M),function(q){return q.length>1||q.length===1&&M.hasEdge(q[0],q[0])})},Nn=function(M,q,dt){return function(_t,Pt,jt){var ie={},he=_t.nodes();return he.forEach(function(Te){ie[Te]={},ie[Te][Te]={distance:0},he.forEach(function(Ke){Te!==Ke&&(ie[Te][Ke]={distance:Number.POSITIVE_INFINITY})}),jt(Te).forEach(function(Ke){var gn=Ke.v===Te?Ke.w:Ke.v,cn=Pt(Ke);ie[Te][gn]={distance:cn,predecessor:Te}})}),he.forEach(function(Te){var Ke=ie[Te];he.forEach(function(gn){var cn=ie[gn];he.forEach(function(jn){var En=cn[Te],ya=Ke[jn],Dr=cn[jn],Fr=En.distance+ya.distance;Fr<Dr.distance&&(Dr.distance=Fr,Dr.predecessor=ya.predecessor)})})}),ie}(M,q||Pa,dt||function(_t){return M.outEdges(_t)})},Pa=Ri.constant(1),wi=Ui;function Ui(M){var q={},dt={},_t=[];if(Ri.each(M.sinks(),function Pt(jt){if(Ri.has(dt,jt))throw new Ei;Ri.has(q,jt)||(dt[jt]=!0,q[jt]=!0,Ri.each(M.predecessors(jt),Pt),delete dt[jt],_t.push(jt))}),Ri.size(q)!==M.nodeCount())throw new Ei;return _t}function Ei(){}Ui.CycleException=Ei,Ei.prototype=new Error;var Oo=function(M,q,dt){Ri.isArray(q)||(q=[q]);var _t=(M.isDirected()?M.successors:M.neighbors).bind(M),Pt=[],jt={};return Ri.each(q,function(ie){if(!M.hasNode(ie))throw new Error("Graph does not have node: "+ie);us(M,ie,dt==="post",jt,_t,Pt)}),Pt};function us(M,q,dt,_t,Pt,jt){Ri.has(_t,q)||(_t[q]=!0,dt||jt.push(q),Ri.each(Pt(q),function(ie){us(M,ie,dt,_t,Pt,jt)}),dt&&jt.push(q))}var Vo,uo={Graph:Lf.Graph,json:js,alg:{components:Dt,dijkstra:qe,dijkstraAll:Er,findCycles:oa,floydWarshall:Nn,isAcyclic:function(M){try{wi(M)}catch(q){if(q instanceof wi.CycleException)return!1;throw q}return!0},postorder:function(M,q){return Oo(M,q,"post")},preorder:function(M,q){return Oo(M,q,"pre")},prim:function(M,q){var dt,_t=new Lh,Pt={},jt=new ae;function ie(Te){var Ke=Te.v===dt?Te.w:Te.v,gn=jt.priority(Ke);if(gn!==void 0){var cn=q(Te);cn<gn&&(Pt[Ke]=dt,jt.decrease(Ke,cn))}}if(M.nodeCount()===0)return _t;Ri.each(M.nodes(),function(Te){jt.add(Te,Number.POSITIVE_INFINITY),_t.setNode(Te)}),jt.decrease(M.nodes()[0],0);for(var he=!1;jt.size()>0;){if(dt=jt.removeMin(),Ri.has(Pt,dt))_t.setEdge(dt,Pt[dt]);else{if(he)throw new Error("Input graph is not connected: "+M);he=!0}M.nodeEdges(dt).forEach(ie)}return _t},tarjan:Cr,topsort:wi},version:Lf.version};try{Vo=uo}catch(M){}Vo||(Vo=window.graphlib);var $o=Vo,Si=function(M){return ou(M,5)},ns=function(M,q,dt){if(!ce(dt))return!1;var _t=typeof q;return!!(_t=="number"?Ra(dt)&&tn(q,dt.length):_t=="string"&&q in dt)&&O(dt[q],M)},Xo=Object.prototype,eo=Xo.hasOwnProperty,qo=zl(function(M,q){M=Object(M);var dt=-1,_t=q.length,Pt=_t>2?q[2]:void 0;for(Pt&&ns(q[0],q[1],Pt)&&(_t=1);++dt<_t;)for(var jt=q[dt],ie=Kn(jt),he=-1,Te=ie.length;++he<Te;){var Ke=ie[he],gn=M[Ke];(gn===void 0||O(gn,Xo[Ke])&&!eo.call(M,Ke))&&(M[Ke]=jt[Ke])}return M}),Ns=function(M){return function(q,dt,_t){var Pt=Object(q);if(!Ra(q)){var jt=nl(dt);q=ln(q),dt=function(he){return jt(Pt[he],he,Pt)}}var ie=M(q,dt,_t);return ie>-1?Pt[jt?q[ie]:ie]:void 0}},lu=/^\s+|\s+$/g,ls=/^[-+]0x[0-9a-f]+$/i,ks=/^0b[01]+$/i,Ou=/^0o[0-7]+$/i,lr=parseInt,ll=function(M){if(typeof M=="number")return M;if(Ie(M))return NaN;if(ce(M)){var q=typeof M.valueOf=="function"?M.valueOf():M;M=ce(q)?q+"":q}if(typeof M!="string")return M===0?M:+M;M=M.replace(lu,"");var dt=ks.test(M);return dt||Ou.test(M)?lr(M.slice(2),dt?2:8):ls.test(M)?NaN:+M},mo=function(M){return M?(M=ll(M))===Infinity||M===-Infinity?17976931348623157e292*(M<0?-1:1):M==M?M:0:M===0?M:0},Hf=function(M){var q=mo(M),dt=q%1;return q==q?dt?q-dt:q:0},mc=Math.max,Xc=Ns(function(M,q,dt){var _t=M==null?0:M.length;if(!_t)return-1;var Pt=dt==null?0:Hf(dt);return Pt<0&&(Pt=mc(_t+Pt,0)),wl(M,nl(q),Pt)}),Jl=function(M){return(M==null?0:M.length)?Hu(M,1):[]},Kl=function(M,q){return M==null?M:Tl(M,Mu(q),Kn)},Xf=function(M){var q=M==null?0:M.length;return q?M[q-1]:void 0},Hp=function(M,q){var dt={};return q=nl(q),bl(M,function(_t,Pt,jt){ba(dt,Pt,q(_t,Pt,jt))}),dt},mn=function(M,q,dt){for(var _t=-1,Pt=M.length;++_t<Pt;){var jt=M[_t],ie=q(jt);if(ie!=null&&(he===void 0?ie==ie&&!Ie(ie):dt(ie,he)))var he=ie,Te=jt}return Te},Yc=function(M,q){return M>q},pp=function(M){return M&&M.length?mn(M,ul,Yc):void 0},br=function(M,q,dt){(dt!==void 0&&!O(M[q],dt)||dt===void 0&&!(q in M))&&ba(M,q,dt)},Yf=Function.prototype,Pf=Object.prototype,Tc=Yf.toString,yc=Pf.hasOwnProperty,gf=Tc.call(Object),nf=function(M){if(!Ot(M)||Ee(M)!="[object Object]")return!1;var q=Zi(M);if(q===null)return!0;var dt=yc.call(q,"constructor")&&q.constructor;return typeof dt=="function"&&dt instanceof dt&&Tc.call(dt)==gf},ol=function(M,q){if((q!=="constructor"||typeof M[q]!="function")&&q!="__proto__")return M[q]},Pc=function(M){return un(M,Kn(M))},tc=function(M,q,dt,_t,Pt,jt,ie){var he=ol(M,dt),Te=ol(q,dt),Ke=ie.get(Te);if(Ke)br(M,dt,Ke);else{var gn=jt?jt(he,Te,dt+"",M,q,ie):void 0,cn=gn===void 0;if(cn){var jn=Vt(Te),En=!jn&&ne(Te),ya=!jn&&!En&&Ar(Te);gn=Te,jn||En||ya?Vt(he)?gn=he:Rf(he)?gn=La(he):En?(cn=!1,gn=xa(Te,!0)):ya?(cn=!1,gn=Qs(Te,!0)):gn=[]:nf(Te)||zt(Te)?(gn=he,zt(he)?gn=Pc(he):ce(he)&&!Ze(he)||(gn=pa(Te))):cn=!1}cn&&(ie.set(Te,gn),Pt(gn,Te,_t,jt,ie),ie.delete(Te)),br(M,dt,gn)}},Ff=function M(q,dt,_t,Pt,jt){q!==dt&&Tl(dt,function(ie,he){if(jt||(jt=new qr),ce(ie))tc(q,dt,he,_t,M,Pt,jt);else{var Te=Pt?Pt(ol(q,he),ie,he+"",q,dt,jt):void 0;Te===void 0&&(Te=ie),br(q,he,Te)}},Kn)},Ac=function(M){return zl(function(q,dt){var _t=-1,Pt=dt.length,jt=Pt>1?dt[Pt-1]:void 0,ie=Pt>2?dt[2]:void 0;for(jt=M.length>3&&typeof jt=="function"?(Pt--,jt):void 0,ie&&ns(dt[0],dt[1],ie)&&(jt=Pt<3?void 0:jt,Pt=1),q=Object(q);++_t<Pt;){var he=dt[_t];he&&M(q,he,_t,jt)}return q})}(function(M,q,dt){Ff(M,q,dt)}),Av=function(M,q){return M<q},Bf=function(M){return M&&M.length?mn(M,ul,Av):void 0},zf=function(M,q){return M&&M.length?mn(M,nl(q),Av):void 0},Kf=function(){return Ut.Date.now()},Fh=function(M,q,dt,_t){if(!ce(M))return M;for(var Pt=-1,jt=(q=wo(q,M)).length,ie=jt-1,he=M;he!=null&&++Pt<jt;){var Te=ho(q[Pt]),Ke=dt;if(Te==="__proto__"||Te==="constructor"||Te==="prototype")return M;if(Pt!=ie){var gn=he[Te];(Ke=_t?_t(gn,Te,he):void 0)===void 0&&(Ke=ce(gn)?gn:tn(q[Pt+1])?[]:{})}Dn(he,Te,Ke),he=he[Te]}return M},gh=function(M,q,dt){for(var _t=-1,Pt=q.length,jt={};++_t<Pt;){var ie=q[_t],he=Ro(M,ie);dt(he,ie)&&Fh(jt,wo(ie,M),he)}return jt},mh=function(M,q){return gh(M,q,function(dt,_t){return Vs(M,_t)})},vp=function(M){return tf(ds(M,void 0,Jl),M+"")}(function(M,q){return M==null?{}:mh(M,q)}),gp=Math.ceil,fd=Math.max,gl=function(M,q,dt,_t){for(var Pt=-1,jt=fd(gp((q-M)/(dt||1)),0),ie=Array(jt);jt--;)ie[_t?jt:++Pt]=M,M+=dt;return ie},mp=function(M){return function(q,dt,_t){return _t&&typeof _t!="number"&&ns(q,dt,_t)&&(dt=_t=void 0),q=mo(q),dt===void 0?(dt=q,q=0):dt=mo(dt),_t=_t===void 0?q<dt?1:-1:mo(_t),gl(q,dt,_t,M)}}(),Zf=function(M,q){var dt=M.length;for(M.sort(q);dt--;)M[dt]=M[dt].value;return M},Dd=function(M,q){if(M!==q){var dt=M!==void 0,_t=M===null,Pt=M==M,jt=Ie(M),ie=q!==void 0,he=q===null,Te=q==q,Ke=Ie(q);if(!he&&!Ke&&!jt&&M>q||jt&&ie&&Te&&!he&&!Ke||_t&&ie&&Te||!dt&&Te||!Pt)return 1;if(!_t&&!jt&&!Ke&&M<q||Ke&&dt&&Pt&&!_t&&!jt||he&&dt&&Pt||!ie&&Pt||!Te)return-1}return 0},Bh=function(M,q,dt){for(var _t=-1,Pt=M.criteria,jt=q.criteria,ie=Pt.length,he=dt.length;++_t<ie;){var Te=Dd(Pt[_t],jt[_t]);if(Te)return _t>=he?Te:Te*(dt[_t]=="desc"?-1:1)}return M.index-q.index},zh=function(M,q,dt){q=q.length?Oa(q,function(jt){return Vt(jt)?function(ie){return Ro(ie,jt.length===1?jt[0]:jt)}:jt}):[ul];var _t=-1;q=Oa(q,Qr(nl));var Pt=Kt(M,function(jt,ie,he){return{criteria:Oa(q,function(Te){return Te(jt)}),index:++_t,value:jt}});return Zf(Pt,function(jt,ie){return Bh(jt,ie,dt)})},uc=zl(function(M,q){if(M==null)return[];var dt=q.length;return dt>1&&ns(M,q[0],q[1])?q=[]:dt>2&&ns(q[0],q[1],q[2])&&(q=[q[0]]),zh(M,Hu(q,1),[])}),ml=0,Al=function(M){var q=++ml;return hs(M)+q},qv=function(M,q,dt){for(var _t=-1,Pt=M.length,jt=q.length,ie={};++_t<Pt;){var he=_t<jt?q[_t]:void 0;dt(ie,M[_t],he)}return ie},ps,ec=function(M,q){return qv(M||[],q||[],Dn)};try{ps={cloneDeep:Si,constant:Au,defaults:qo,each:Nu,filter:rl,find:Xc,flatten:Jl,forEach:Pu,forIn:Kl,has:Yl,isUndefined:rt,last:Xf,map:pe,mapValues:Hp,max:pp,merge:Ac,min:Bf,minBy:zf,now:Kf,pick:vp,range:mp,reduce:an,sortBy:uc,uniqueId:Al,values:ph,zipObject:ec}}catch(M){}ps||(ps=window._);var ir=ps,no=yh;function yh(){var M={};M._next=M._prev=M,this._sentinel=M}function $h(M){M._prev._next=M._next,M._next._prev=M._prev,delete M._next,delete M._prev}function Xp(M,q){if(M!=="_next"&&M!=="_prev")return q}yh.prototype.dequeue=function(){var M=this._sentinel,q=M._prev;if(q!==M)return $h(q),q},yh.prototype.enqueue=function(M){var q=this._sentinel;M._prev&&M._next&&$h(M),M._next=q._next,q._next._prev=M,q._next=M,M._prev=q},yh.prototype.toString=function(){for(var M=[],q=this._sentinel,dt=q._prev;dt!==q;)M.push(JSON.stringify(dt,Xp)),dt=dt._prev;return"["+M.join(", ")+"]"};var $l=$o.Graph,qf=function(M,q){if(M.nodeCount()<=1)return[];var dt=function(Pt,jt){var ie=new $l,he=0,Te=0;ir.forEach(Pt.nodes(),function(cn){ie.setNode(cn,{v:cn,in:0,out:0})}),ir.forEach(Pt.edges(),function(cn){var jn=ie.edge(cn.v,cn.w)||0,En=jt(cn),ya=jn+En;ie.setEdge(cn.v,cn.w,ya),Te=Math.max(Te,ie.node(cn.v).out+=En),he=Math.max(he,ie.node(cn.w).in+=En)});var Ke=ir.range(Te+he+3).map(function(){return new no}),gn=he+1;return ir.forEach(ie.nodes(),function(cn){Qf(Ke,gn,ie.node(cn))}),{graph:ie,buckets:Ke,zeroIdx:gn}}(M,q||Od),_t=function(Pt,jt,ie){for(var he,Te=[],Ke=jt[jt.length-1],gn=jt[0];Pt.nodeCount();){for(;he=gn.dequeue();)Gh(Pt,jt,ie,he);for(;he=Ke.dequeue();)Gh(Pt,jt,ie,he);if(Pt.nodeCount()){for(var cn=jt.length-2;cn>0;--cn)if(he=jt[cn].dequeue()){Te=Te.concat(Gh(Pt,jt,ie,he,!0));break}}}return Te}(dt.graph,dt.buckets,dt.zeroIdx);return ir.flatten(ir.map(_t,function(Pt){return M.outEdges(Pt.v,Pt.w)}),!0)},Od=ir.constant(1);function Gh(M,q,dt,_t,Pt){var jt=Pt?[]:void 0;return ir.forEach(M.inEdges(_t.v),function(ie){var he=M.edge(ie),Te=M.node(ie.v);Pt&&jt.push({v:ie.v,w:ie.w}),Te.out-=he,Qf(q,dt,Te)}),ir.forEach(M.outEdges(_t.v),function(ie){var he=M.edge(ie),Te=ie.w,Ke=M.node(Te);Ke.in-=he,Qf(q,dt,Ke)}),M.removeNode(_t.v),jt}function Qf(M,q,dt){dt.out?dt.in?M[dt.out-dt.in+q].enqueue(dt):M[M.length-1].enqueue(dt):M[0].enqueue(dt)}var Uh={run:function(M){var q=M.graph().acyclicer==="greedy"?qf(M,function(dt){return function(_t){return dt.edge(_t).weight}}(M)):function(dt){var _t=[],Pt={},jt={};function ie(he){ir.has(jt,he)||(jt[he]=!0,Pt[he]=!0,ir.forEach(dt.outEdges(he),function(Te){ir.has(Pt,Te.w)?_t.push(Te):ie(Te.w)}),delete Pt[he])}return ir.forEach(dt.nodes(),ie),_t}(M);ir.forEach(q,function(dt){var _t=M.edge(dt);M.removeEdge(dt),_t.forwardName=dt.name,_t.reversed=!0,M.setEdge(dt.w,dt.v,_t,ir.uniqueId("rev"))})},undo:function(M){ir.forEach(M.edges(),function(q){var dt=M.edge(q);if(dt.reversed){M.removeEdge(q);var _t=dt.forwardName;delete dt.reversed,delete dt.forwardName,M.setEdge(q.w,q.v,dt,_t)}})}},yp=$o.Graph,Ml={addDummyNode:bc,simplify:function(M){var q=new yp().setGraph(M.graph());return ir.forEach(M.nodes(),function(dt){q.setNode(dt,M.node(dt))}),ir.forEach(M.edges(),function(dt){var _t=q.edge(dt.v,dt.w)||{weight:0,minlen:1},Pt=M.edge(dt);q.setEdge(dt.v,dt.w,{weight:_t.weight+Pt.weight,minlen:Math.max(_t.minlen,Pt.minlen)})}),q},asNonCompoundGraph:function(M){var q=new yp({multigraph:M.isMultigraph()}).setGraph(M.graph());return ir.forEach(M.nodes(),function(dt){M.children(dt).length||q.setNode(dt,M.node(dt))}),ir.forEach(M.edges(),function(dt){q.setEdge(dt,M.edge(dt))}),q},successorWeights:function(M){var q=ir.map(M.nodes(),function(dt){var _t={};return ir.forEach(M.outEdges(dt),function(Pt){_t[Pt.w]=(_t[Pt.w]||0)+M.edge(Pt).weight}),_t});return ir.zipObject(M.nodes(),q)},predecessorWeights:function(M){var q=ir.map(M.nodes(),function(dt){var _t={};return ir.forEach(M.inEdges(dt),function(Pt){_t[Pt.v]=(_t[Pt.v]||0)+M.edge(Pt).weight}),_t});return ir.zipObject(M.nodes(),q)},intersectRect:function(M,q){var dt,_t,Pt=M.x,jt=M.y,ie=q.x-Pt,he=q.y-jt,Te=M.width/2,Ke=M.height/2;if(!ie&&!he)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(he)*Te>Math.abs(ie)*Ke?(he<0&&(Ke=-Ke),dt=Ke*ie/he,_t=Ke):(ie<0&&(Te=-Te),dt=Te,_t=Te*he/ie),{x:Pt+dt,y:jt+_t}},buildLayerMatrix:function(M){var q=ir.map(ir.range(hd(M)+1),function(){return[]});return ir.forEach(M.nodes(),function(dt){var _t=M.node(dt),Pt=_t.rank;ir.isUndefined(Pt)||(q[Pt][_t.order]=dt)}),q},normalizeRanks:function(M){var q=ir.min(ir.map(M.nodes(),function(dt){return M.node(dt).rank}));ir.forEach(M.nodes(),function(dt){var _t=M.node(dt);ir.has(_t,"rank")&&(_t.rank-=q)})},removeEmptyRanks:function(M){var q=ir.min(ir.map(M.nodes(),function(jt){return M.node(jt).rank})),dt=[];ir.forEach(M.nodes(),function(jt){var ie=M.node(jt).rank-q;dt[ie]||(dt[ie]=[]),dt[ie].push(jt)});var _t=0,Pt=M.graph().nodeRankFactor;ir.forEach(dt,function(jt,ie){ir.isUndefined(jt)&&ie%Pt!=0?--_t:_t&&ir.forEach(jt,function(he){M.node(he).rank+=_t})})},addBorderNode:function(M,q,dt,_t){var Pt={width:0,height:0};return arguments.length>=4&&(Pt.rank=dt,Pt.order=_t),bc(M,"border",Pt,q)},maxRank:hd,partition:function(M,q){var dt={lhs:[],rhs:[]};return ir.forEach(M,function(_t){q(_t)?dt.lhs.push(_t):dt.rhs.push(_t)}),dt},time:function(M,q){var dt=ir.now();try{return q()}finally{console.log(M+" time: "+(ir.now()-dt)+"ms")}},notime:function(M,q){return q()}};function bc(M,q,dt,_t){var Pt;do Pt=ir.uniqueId(_t);while(M.hasNode(Pt));return dt.dummy=q,M.setNode(Pt,dt),Pt}function hd(M){return ir.max(ir.map(M.nodes(),function(q){var dt=M.node(q).rank;if(!ir.isUndefined(dt))return dt}))}var Rd={run:function(M){M.graph().dummyChains=[],ir.forEach(M.edges(),function(q){(function(dt,_t){var Pt,jt,ie,he=_t.v,Te=dt.node(he).rank,Ke=_t.w,gn=dt.node(Ke).rank,cn=_t.name,jn=dt.edge(_t),En=jn.labelRank;if(gn!==Te+1){for(dt.removeEdge(_t),ie=0,++Te;Te<gn;++ie,++Te)jn.points=[],jt={width:0,height:0,edgeLabel:jn,edgeObj:_t,rank:Te},Pt=Ml.addDummyNode(dt,"edge",jt,"_d"),Te===En&&(jt.width=jn.width,jt.height=jn.height,jt.dummy="edge-label",jt.labelpos=jn.labelpos),dt.setEdge(he,Pt,{weight:jn.weight},cn),ie===0&&dt.graph().dummyChains.push(Pt),he=Pt;dt.setEdge(he,Ke,{weight:jn.weight},cn)}})(M,q)})},undo:function(M){ir.forEach(M.graph().dummyChains,function(q){var dt,_t=M.node(q),Pt=_t.edgeLabel;for(M.setEdge(_t.edgeObj,Pt);_t.dummy;)dt=M.successors(q)[0],M.removeNode(q),Pt.points.push({x:_t.x,y:_t.y}),_t.dummy==="edge-label"&&(Pt.x=_t.x,Pt.y=_t.y,Pt.width=_t.width,Pt.height=_t.height),q=dt,_t=M.node(q)})}},xc=function(M){var q={};ir.forEach(M.sources(),function dt(_t){var Pt=M.node(_t);if(ir.has(q,_t))return Pt.rank;q[_t]=!0;var jt=ir.min(ir.map(M.outEdges(_t),function(ie){return dt(ie.w)-M.edge(ie).minlen}));return jt!==Number.POSITIVE_INFINITY&&jt!=null||(jt=0),Pt.rank=jt})},Wh=function(M,q){return M.node(q.w).rank-M.node(q.v).rank-M.edge(q).minlen},Vh=$o.Graph,Kc=Wh,_f=function(M){var q,dt,_t=new Vh({directed:!1}),Pt=M.nodes()[0],jt=M.nodeCount();for(_t.setNode(Pt,{});lc(_t,M)<jt;)q=If(_t,M),dt=_t.hasNode(q.v)?Kc(M,q):-Kc(M,q),Jf(_t,M,dt);return _t};function lc(M,q){return ir.forEach(M.nodes(),function dt(_t){ir.forEach(q.nodeEdges(_t),function(Pt){var jt=Pt.v,ie=_t===jt?Pt.w:jt;M.hasNode(ie)||Kc(q,Pt)||(M.setNode(ie,{}),M.setEdge(_t,ie,{}),dt(ie))})}),M.nodeCount()}function If(M,q){return ir.minBy(q.edges(),function(dt){if(M.hasNode(dt.v)!==M.hasNode(dt.w))return Kc(q,dt)})}function Jf(M,q,dt){ir.forEach(M.nodes(),function(_t){q.node(_t).rank+=dt})}var bp=Wh,dd=xc,xp=$o.alg.preorder,wp=$o.alg.postorder,Yp=Ml.simplify,bh=rf;function rf(M){M=Yp(M),dd(M);var q,dt=_f(M);for($f(dt),wc(dt,M);q=Nv(dt);)af(dt,M,q,zs(dt,M,q))}function wc(M,q){var dt=wp(M,M.nodes());dt=dt.slice(0,dt.length-1),ir.forEach(dt,function(_t){(function(Pt,jt,ie){var he=Pt.node(ie).parent;Pt.edge(ie,he).cutvalue=Mv(Pt,jt,ie)})(M,q,_t)})}function Mv(M,q,dt){var _t=M.node(dt).parent,Pt=!0,jt=q.edge(dt,_t),ie=0;return jt||(Pt=!1,jt=q.edge(_t,dt)),ie=jt.weight,ir.forEach(q.nodeEdges(dt),function(he){var Te,Ke,gn=he.v===dt,cn=gn?he.w:he.v;if(cn!==_t){var jn=gn===Pt,En=q.edge(he).weight;if(ie+=jn?En:-En,Te=dt,Ke=cn,M.hasEdge(Te,Ke)){var ya=M.edge(dt,cn).cutvalue;ie+=jn?-ya:ya}}}),ie}function $f(M,q){arguments.length<2&&(q=M.nodes()[0]),jh(M,{},1,q)}function jh(M,q,dt,_t,Pt){var jt=dt,ie=M.node(_t);return q[_t]=!0,ir.forEach(M.neighbors(_t),function(he){ir.has(q,he)||(dt=jh(M,q,dt,he,_t))}),ie.low=jt,ie.lim=dt++,Pt?ie.parent=Pt:delete ie.parent,dt}function Nv(M){return ir.find(M.edges(),function(q){return M.edge(q).cutvalue<0})}function zs(M,q,dt){var _t=dt.v,Pt=dt.w;q.hasEdge(_t,Pt)||(_t=dt.w,Pt=dt.v);var jt=M.node(_t),ie=M.node(Pt),he=jt,Te=!1;jt.lim>ie.lim&&(he=ie,Te=!0);var Ke=ir.filter(q.edges(),function(gn){return Te===qi(M,M.node(gn.v),he)&&Te!==qi(M,M.node(gn.w),he)});return ir.minBy(Ke,function(gn){return bp(q,gn)})}function af(M,q,dt,_t){var Pt=dt.v,jt=dt.w;M.removeEdge(Pt,jt),M.setEdge(_t.v,_t.w,{}),$f(M),wc(M,q),function(ie,he){var Te=ir.find(ie.nodes(),function(gn){return!he.node(gn).parent}),Ke=xp(ie,Te);Ke=Ke.slice(1),ir.forEach(Ke,function(gn){var cn=ie.node(gn).parent,jn=he.edge(gn,cn),En=!1;jn||(jn=he.edge(cn,gn),En=!0),he.node(gn).rank=he.node(cn).rank+(En?jn.minlen:-jn.minlen)})}(M,q)}function qi(M,q,dt){return dt.low<=q.lim&&q.lim<=dt.lim}rf.initLowLimValues=$f,rf.initCutValues=wc,rf.calcCutValue=Mv,rf.leaveEdge=Nv,rf.enterEdge=zs,rf.exchangeEdges=af;var pd=xc,th=function(M){switch(M.graph().ranker){case"network-simplex":Ep(M);break;case"tight-tree":(function(q){pd(q),_f(q)})(M);break;case"longest-path":Kp(M);break;default:Ep(M)}},Kp=pd;function Ep(M){bh(M)}var Sg=function(M){var q=function(dt){var _t={},Pt=0;function jt(ie){var he=Pt;ir.forEach(dt.children(ie),jt),_t[ie]={low:he,lim:Pt++}}return ir.forEach(dt.children(),jt),_t}(M);ir.forEach(M.graph().dummyChains,function(dt){for(var _t=M.node(dt),Pt=_t.edgeObj,jt=function(cn,jn,En,ya){var Dr,Fr,or=[],Xa=[],Hn=Math.min(jn[En].low,jn[ya].low),si=Math.max(jn[En].lim,jn[ya].lim);Dr=En;do Dr=cn.parent(Dr),or.push(Dr);while(Dr&&(jn[Dr].low>Hn||si>jn[Dr].lim));for(Fr=Dr,Dr=ya;(Dr=cn.parent(Dr))!==Fr;)Xa.push(Dr);return{path:or.concat(Xa.reverse()),lca:Fr}}(M,q,Pt.v,Pt.w),ie=jt.path,he=jt.lca,Te=0,Ke=ie[Te],gn=!0;dt!==Pt.w;){if(_t=M.node(dt),gn){for(;(Ke=ie[Te])!==he&&M.node(Ke).maxRank<_t.rank;)Te++;Ke===he&&(gn=!1)}if(!gn){for(;Te<ie.length-1&&M.node(Ke=ie[Te+1]).minRank<=_t.rank;)Te++;Ke=ie[Te]}M.setParent(dt,Ke),dt=M.successors(dt)[0]}})},Qv={run:function(M){var q=Ml.addDummyNode(M,"root",{},"_root"),dt=function(ie){var he={};function Te(Ke,gn){var cn=ie.children(Ke);cn&&cn.length&&ir.forEach(cn,function(jn){Te(jn,gn+1)}),he[Ke]=gn}return ir.forEach(ie.children(),function(Ke){Te(Ke,1)}),he}(M),_t=ir.max(ir.values(dt))-1,Pt=2*_t+1;M.graph().nestingRoot=q,ir.forEach(M.edges(),function(ie){M.edge(ie).minlen*=Pt});var jt=function(ie){return ir.reduce(ie.edges(),function(he,Te){return he+ie.edge(Te).weight},0)}(M)+1;ir.forEach(M.children(),function(ie){Ld(M,q,Pt,jt,_t,dt,ie)}),M.graph().nodeRankFactor=Pt},cleanup:function(M){var q=M.graph();M.removeNode(q.nestingRoot),delete q.nestingRoot,ir.forEach(M.edges(),function(dt){M.edge(dt).nestingEdge&&M.removeEdge(dt)})}};function Ld(M,q,dt,_t,Pt,jt,ie){var he=M.children(ie);if(he.length){var Te=Ml.addBorderNode(M,"_bt"),Ke=Ml.addBorderNode(M,"_bb"),gn=M.node(ie);M.setParent(Te,ie),gn.borderTop=Te,M.setParent(Ke,ie),gn.borderBottom=Ke,ir.forEach(he,function(cn){Ld(M,q,dt,_t,Pt,jt,cn);var jn=M.node(cn),En=jn.borderTop?jn.borderTop:cn,ya=jn.borderBottom?jn.borderBottom:cn,Dr=jn.borderTop?_t:2*_t,Fr=En!==ya?1:Pt-jt[ie]+1;M.setEdge(Te,En,{weight:Dr,minlen:Fr,nestingEdge:!0}),M.setEdge(ya,Ke,{weight:Dr,minlen:Fr,nestingEdge:!0})}),M.parent(ie)||M.setEdge(q,Te,{weight:0,minlen:Pt+jt[ie]})}else ie!==q&&M.setEdge(q,ie,{weight:0,minlen:dt})}var Zp=function(M){ir.forEach(M.children(),function q(dt){var _t=M.children(dt),Pt=M.node(dt);if(_t.length&&ir.forEach(_t,q),ir.has(Pt,"minRank")){Pt.borderLeft=[],Pt.borderRight=[];for(var jt=Pt.minRank,ie=Pt.maxRank+1;jt<ie;++jt)xh(M,"borderLeft","_bl",dt,Pt,jt),xh(M,"borderRight","_br",dt,Pt,jt)}})};function xh(M,q,dt,_t,Pt,jt){var ie={width:0,height:0,rank:jt,borderType:q},he=Pt[q][jt-1],Te=Ml.addDummyNode(M,"border",ie,dt);Pt[q][jt]=Te,M.setParent(Te,_t),he&&M.setEdge(he,Te,{weight:1})}var kv={adjust:function(M){var q=M.graph().rankdir.toLowerCase();q!=="lr"&&q!=="rl"||qp(M)},undo:function(M){var q=M.graph().rankdir.toLowerCase();q!=="bt"&&q!=="rl"||function(dt){ir.forEach(dt.nodes(),function(_t){eh(dt.node(_t))}),ir.forEach(dt.edges(),function(_t){var Pt=dt.edge(_t);ir.forEach(Pt.points,eh),ir.has(Pt,"y")&&eh(Pt)})}(M),q!=="lr"&&q!=="rl"||(function(dt){ir.forEach(dt.nodes(),function(_t){vd(dt.node(_t))}),ir.forEach(dt.edges(),function(_t){var Pt=dt.edge(_t);ir.forEach(Pt.points,vd),ir.has(Pt,"x")&&vd(Pt)})}(M),qp(M))}};function qp(M){ir.forEach(M.nodes(),function(q){Qp(M.node(q))}),ir.forEach(M.edges(),function(q){Qp(M.edge(q))})}function Qp(M){var q=M.width;M.width=M.height,M.height=q}function eh(M){M.y=-M.y}function vd(M){var q=M.x;M.x=M.y,M.y=q}var Hh=function(M){var q={},dt=ir.filter(M.nodes(),function(he){return!M.children(he).length}),_t=ir.max(ir.map(dt,function(he){return M.node(he).rank})),Pt=ir.map(ir.range(_t+1),function(){return[]});function jt(he){if(!ir.has(q,he)){q[he]=!0;var Te=M.node(he);Pt[Te.rank].push(he),ir.forEach(M.successors(he),jt)}}var ie=ir.sortBy(dt,function(he){return M.node(he).rank});return ir.forEach(ie,jt),Pt},Pd=function(M,q){for(var dt=0,_t=1;_t<q.length;++_t)dt+=Fd(M,q[_t-1],q[_t]);return dt};function Fd(M,q,dt){for(var _t=ir.zipObject(dt,ir.map(dt,function(Ke,gn){return gn})),Pt=ir.flatten(ir.map(q,function(Ke){return ir.sortBy(ir.map(M.outEdges(Ke),function(gn){return{pos:_t[gn.w],weight:M.edge(gn).weight}}),"pos")}),!0),jt=1;jt<dt.length;)jt<<=1;var ie=2*jt-1;jt-=1;var he=ir.map(new Array(ie),function(){return 0}),Te=0;return ir.forEach(Pt.forEach(function(Ke){var gn=Ke.pos+jt;he[gn]+=Ke.weight;for(var cn=0;gn>0;)gn%2&&(cn+=he[gn+1]),he[gn=gn-1>>1]+=Ke.weight;Te+=Ke.weight*cn})),Te}var Sp=function(M,q){return ir.map(q,function(dt){var _t=M.inEdges(dt);if(_t.length){var Pt=ir.reduce(_t,function(jt,ie){var he=M.edge(ie),Te=M.node(ie.v);return{sum:jt.sum+he.weight*Te.order,weight:jt.weight+he.weight}},{sum:0,weight:0});return{v:dt,barycenter:Pt.sum/Pt.weight,weight:Pt.weight}}return{v:dt}})},Bd=function(M,q){var dt={};return ir.forEach(M,function(_t,Pt){var jt=dt[_t.v]={indegree:0,in:[],out:[],vs:[_t.v],i:Pt};ir.isUndefined(_t.barycenter)||(jt.barycenter=_t.barycenter,jt.weight=_t.weight)}),ir.forEach(q.edges(),function(_t){var Pt=dt[_t.v],jt=dt[_t.w];ir.isUndefined(Pt)||ir.isUndefined(jt)||(jt.indegree++,Pt.out.push(dt[_t.w]))}),function(_t){var Pt=[];function jt(Te){return function(Ke){Ke.merged||(ir.isUndefined(Ke.barycenter)||ir.isUndefined(Te.barycenter)||Ke.barycenter>=Te.barycenter)&&function(gn,cn){var jn=0,En=0;gn.weight&&(jn+=gn.barycenter*gn.weight,En+=gn.weight),cn.weight&&(jn+=cn.barycenter*cn.weight,En+=cn.weight),gn.vs=cn.vs.concat(gn.vs),gn.barycenter=jn/En,gn.weight=En,gn.i=Math.min(cn.i,gn.i),cn.merged=!0}(Te,Ke)}}function ie(Te){return function(Ke){Ke.in.push(Te),--Ke.indegree==0&&_t.push(Ke)}}for(;_t.length;){var he=_t.pop();Pt.push(he),ir.forEach(he.in.reverse(),jt(he)),ir.forEach(he.out,ie(he))}return ir.map(ir.filter(Pt,function(Te){return!Te.merged}),function(Te){return ir.pick(Te,["vs","i","barycenter","weight"])})}(ir.filter(dt,function(_t){return!_t.indegree}))},wh=function(M,q){var dt=Ml.partition(M,function(cn){return ir.has(cn,"barycenter")}),_t=dt.lhs,Pt=ir.sortBy(dt.rhs,function(cn){return-cn.i}),jt=[],ie=0,he=0,Te=0;_t.sort((Ke=!!q,function(cn,jn){return cn.barycenter<jn.barycenter?-1:cn.barycenter>jn.barycenter?1:Ke?jn.i-cn.i:cn.i-jn.i})),Te=Cp(jt,Pt,Te),ir.forEach(_t,function(cn){Te+=cn.vs.length,jt.push(cn.vs),ie+=cn.barycenter*cn.weight,he+=cn.weight,Te=Cp(jt,Pt,Te)});var Ke,gn={vs:ir.flatten(jt,!0)};return he&&(gn.barycenter=ie/he,gn.weight=he),gn};function Cp(M,q,dt){for(var _t;q.length&&(_t=ir.last(q)).i<=dt;)q.pop(),M.push(_t.vs),dt++;return dt}var Tf=function M(q,dt,_t,Pt){var jt=q.children(dt),ie=q.node(dt),he=ie?ie.borderLeft:void 0,Te=ie?ie.borderRight:void 0,Ke={};he&&(jt=ir.filter(jt,function(Dr){return Dr!==he&&Dr!==Te}));var gn=Sp(q,jt);ir.forEach(gn,function(Dr){if(q.children(Dr.v).length){var Fr=M(q,Dr.v,_t,Pt);Ke[Dr.v]=Fr,ir.has(Fr,"barycenter")&&(or=Dr,Xa=Fr,ir.isUndefined(or.barycenter)?(or.barycenter=Xa.barycenter,or.weight=Xa.weight):(or.barycenter=(or.barycenter*or.weight+Xa.barycenter*Xa.weight)/(or.weight+Xa.weight),or.weight+=Xa.weight))}var or,Xa});var cn=Bd(gn,_t);(function(Dr,Fr){ir.forEach(Dr,function(or){or.vs=ir.flatten(or.vs.map(function(Xa){return Fr[Xa]?Fr[Xa].vs:Xa}),!0)})})(cn,Ke);var jn=wh(cn,Pt);if(he&&(jn.vs=ir.flatten([he,jn.vs,Te],!0),q.predecessors(he).length)){var En=q.node(q.predecessors(he)[0]),ya=q.node(q.predecessors(Te)[0]);ir.has(jn,"barycenter")||(jn.barycenter=0,jn.weight=0),jn.barycenter=(jn.barycenter*jn.weight+En.order+ya.order)/(jn.weight+2),jn.weight+=2}return jn},zd=$o.Graph,$d=function(M,q,dt){var _t=function(jt){for(var ie;jt.hasNode(ie=ir.uniqueId("_root")););return ie}(M),Pt=new zd({compound:!0}).setGraph({root:_t}).setDefaultNodeLabel(function(jt){return M.node(jt)});return ir.forEach(M.nodes(),function(jt){var ie=M.node(jt),he=M.parent(jt);(ie.rank===q||ie.minRank<=q&&q<=ie.maxRank)&&(Pt.setNode(jt),Pt.setParent(jt,he||_t),ir.forEach(M[dt](jt),function(Te){var Ke=Te.v===jt?Te.w:Te.v,gn=Pt.edge(Ke,jt),cn=ir.isUndefined(gn)?0:gn.weight;Pt.setEdge(Ke,jt,{weight:M.edge(Te).weight+cn})}),ir.has(ie,"minRank")&&Pt.setNode(jt,{borderLeft:ie.borderLeft[q],borderRight:ie.borderRight[q]}))}),Pt},gd=function(M,q,dt){var _t,Pt={};ir.forEach(dt,function(jt){for(var ie,he,Te=M.parent(jt);Te;){if((ie=M.parent(Te))?(he=Pt[ie],Pt[ie]=Te):(he=_t,_t=Te),he&&he!==Te)return void q.setEdge(he,Te);Te=ie}})},Eh=$o.Graph,Gd=function(M){var q=Ml.maxRank(M),dt=Ud(M,ir.range(1,q+1),"inEdges"),_t=Ud(M,ir.range(q-1,-1,-1),"outEdges"),Pt=Hh(M);Wd(M,Pt);for(var jt,ie=Number.POSITIVE_INFINITY,he=0,Te=0;Te<4;++he,++Te){Xh(he%2?dt:_t,he%4>=2),Pt=Ml.buildLayerMatrix(M);var Ke=Pd(M,Pt);Ke<ie&&(Te=0,jt=ir.cloneDeep(Pt),ie=Ke)}Wd(M,jt)};function Ud(M,q,dt){return ir.map(q,function(_t){return $d(M,_t,dt)})}function Xh(M,q){var dt=new Eh;ir.forEach(M,function(_t){var Pt=_t.graph().root,jt=Tf(_t,Pt,dt,q);ir.forEach(jt.vs,function(ie,he){_t.node(ie).order=he}),gd(_t,dt,jt.vs)})}function Wd(M,q){ir.forEach(q,function(dt){ir.forEach(dt,function(_t,Pt){M.node(_t).order=Pt})})}var $s=$o.Graph,md=function(M){var q,dt=Ml.buildLayerMatrix(M),_t=ir.merge(Mc(M,dt),Jv(M,dt)),Pt={};ir.forEach(["u","d"],function(ie){q=ie==="u"?dt:ir.values(dt).reverse(),ir.forEach(["l","r"],function(he){he==="r"&&(q=ir.map(q,function(cn){return ir.values(cn).reverse()}));var Te=(ie==="u"?M.predecessors:M.successors).bind(M),Ke=Vd(M,q,_t,Te),gn=Jp(M,q,Ke.root,Ke.align,he==="r");he==="r"&&(gn=ir.mapValues(gn,function(cn){return-cn})),Pt[ie+he]=gn})});var jt=Zc(M,Pt);return tv(Pt,jt),ev(Pt,M.graph().align)};function Mc(M,q){var dt={};return ir.reduce(q,function(_t,Pt){var jt=0,ie=0,he=_t.length,Te=ir.last(Pt);return ir.forEach(Pt,function(Ke,gn){var cn=function(En,ya){if(En.node(ya).dummy)return ir.find(En.predecessors(ya),function(Dr){return En.node(Dr).dummy})}(M,Ke),jn=cn?M.node(cn).order:he;(cn||Ke===Te)&&(ir.forEach(Pt.slice(ie,gn+1),function(En){ir.forEach(M.predecessors(En),function(ya){var Dr=M.node(ya),Fr=Dr.order;!(Fr<jt||jn<Fr)||Dr.dummy&&M.node(En).dummy||mu(dt,ya,En)})}),ie=gn+1,jt=jn)}),Pt}),dt}function Jv(M,q){var dt={};function _t(Pt,jt,ie,he,Te){var Ke;ir.forEach(ir.range(jt,ie),function(gn){Ke=Pt[gn],M.node(Ke).dummy&&ir.forEach(M.predecessors(Ke),function(cn){var jn=M.node(cn);jn.dummy&&(jn.order<he||jn.order>Te)&&mu(dt,cn,Ke)})})}return ir.reduce(q,function(Pt,jt){var ie,he=-1,Te=0;return ir.forEach(jt,function(Ke,gn){if(M.node(Ke).dummy==="border"){var cn=M.predecessors(Ke);cn.length&&(ie=M.node(cn[0]).order,_t(jt,Te,gn,he,ie),Te=gn,he=ie)}_t(jt,Te,jt.length,ie,Pt.length)}),jt}),dt}function mu(M,q,dt){if(q>dt){var _t=q;q=dt,dt=_t}var Pt=M[q];Pt||(M[q]=Pt={}),Pt[dt]=!0}function Dv(M,q,dt){if(q>dt){var _t=q;q=dt,dt=_t}return ir.has(M[q],dt)}function Vd(M,q,dt,_t){var Pt={},jt={},ie={};return ir.forEach(q,function(he){ir.forEach(he,function(Te,Ke){Pt[Te]=Te,jt[Te]=Te,ie[Te]=Ke})}),ir.forEach(q,function(he){var Te=-1;ir.forEach(he,function(Ke){var gn=_t(Ke);if(gn.length)for(var cn=((gn=ir.sortBy(gn,function(Dr){return ie[Dr]})).length-1)/2,jn=Math.floor(cn),En=Math.ceil(cn);jn<=En;++jn){var ya=gn[jn];jt[Ke]===Ke&&Te<ie[ya]&&!Dv(dt,Ke,ya)&&(jt[ya]=Ke,jt[Ke]=Pt[Ke]=Pt[ya],Te=ie[ya])}})}),{root:Pt,align:jt}}function Jp(M,q,dt,_t,Pt){var jt={},ie=function(Ke,gn,cn,jn){var En=new $s,ya=Ke.graph(),Dr=function(Fr,or,Xa){return function(Hn,si,Ci){var Yi,_i=Hn.node(si),Yo=Hn.node(Ci),xi=0;if(xi+=_i.width/2,ir.has(_i,"labelpos"))switch(_i.labelpos.toLowerCase()){case"l":Yi=-_i.width/2;break;case"r":Yi=_i.width/2}if(Yi&&(xi+=Xa?Yi:-Yi),Yi=0,xi+=(_i.dummy?or:Fr)/2,xi+=(Yo.dummy?or:Fr)/2,xi+=Yo.width/2,ir.has(Yo,"labelpos"))switch(Yo.labelpos.toLowerCase()){case"l":Yi=Yo.width/2;break;case"r":Yi=-Yo.width/2}return Yi&&(xi+=Xa?Yi:-Yi),Yi=0,xi}}(ya.nodesep,ya.edgesep,jn);return ir.forEach(gn,function(Fr){var or;ir.forEach(Fr,function(Xa){var Hn=cn[Xa];if(En.setNode(Hn),or){var si=cn[or],Ci=En.edge(si,Hn);En.setEdge(si,Hn,Math.max(Dr(Ke,Xa,or),Ci||0))}or=Xa})}),En}(M,q,dt,Pt),he=Pt?"borderLeft":"borderRight";function Te(Ke,gn){for(var cn=ie.nodes(),jn=cn.pop(),En={};jn;)En[jn]?Ke(jn):(En[jn]=!0,cn.push(jn),cn=cn.concat(gn(jn))),jn=cn.pop()}return Te(function(Ke){jt[Ke]=ie.inEdges(Ke).reduce(function(gn,cn){return Math.max(gn,jt[cn.v]+ie.edge(cn))},0)},ie.predecessors.bind(ie)),Te(function(Ke){var gn=ie.outEdges(Ke).reduce(function(jn,En){return Math.min(jn,jt[En.w]-ie.edge(En))},Number.POSITIVE_INFINITY),cn=M.node(Ke);gn!==Number.POSITIVE_INFINITY&&cn.borderType!==he&&(jt[Ke]=Math.max(jt[Ke],gn))},ie.successors.bind(ie)),ir.forEach(_t,function(Ke){jt[Ke]=jt[dt[Ke]]}),jt}function Zc(M,q){return ir.minBy(ir.values(q),function(dt){var _t=Number.NEGATIVE_INFINITY,Pt=Number.POSITIVE_INFINITY;return ir.forIn(dt,function(jt,ie){var he=function(Te,Ke){return Te.node(Ke).width}(M,ie)/2;_t=Math.max(jt+he,_t),Pt=Math.min(jt-he,Pt)}),_t-Pt})}function tv(M,q){var dt=ir.values(q),_t=ir.min(dt),Pt=ir.max(dt);ir.forEach(["u","d"],function(jt){ir.forEach(["l","r"],function(ie){var he,Te=jt+ie,Ke=M[Te];if(Ke!==q){var gn=ir.values(Ke);(he=ie==="l"?_t-ir.min(gn):Pt-ir.max(gn))&&(M[Te]=ir.mapValues(Ke,function(cn){return cn+he}))}})})}function ev(M,q){return ir.mapValues(M.ul,function(dt,_t){if(q)return M[q.toLowerCase()][_t];var Pt=ir.sortBy(ir.map(M,_t));return(Pt[1]+Pt[2])/2})}var nv=md,Sh=function(M){(function(q){var dt=Ml.buildLayerMatrix(q),_t=q.graph().ranksep,Pt=0;ir.forEach(dt,function(jt){var ie=ir.max(ir.map(jt,function(he){return q.node(he).height}));ir.forEach(jt,function(he){q.node(he).y=Pt+ie/2}),Pt+=ie+_t})})(M=Ml.asNonCompoundGraph(M)),ir.forEach(nv(M),function(q,dt){M.node(dt).x=q})},rv=Ml.normalizeRanks,tg=Ml.removeEmptyRanks,Gl=Ml,av=$o.Graph,Af=function(M,q){var dt=q&&q.debugTiming?Gl.time:Gl.notime;dt("layout",function(){var _t=dt("  buildLayoutGraph",function(){return function(Pt){var jt=new av({multigraph:!0,compound:!0}),ie=jd(Pt.graph());return jt.setGraph(ir.merge({},Ov,Fc(ie,Mf),ir.pick(ie,iv))),ir.forEach(Pt.nodes(),function(he){var Te=jd(Pt.node(he));jt.setNode(he,ir.defaults(Fc(Te,Yh),ov)),jt.setParent(he,Pt.parent(he))}),ir.forEach(Pt.edges(),function(he){var Te=jd(Pt.edge(he));jt.setEdge(he,ir.merge({},Ch,Fc(Te,Nc),ir.pick(Te,El)))}),jt}(M)});dt("  runLayout",function(){(function(Pt,jt){jt("    makeSpaceForEdgeLabels",function(){(function(ie){var he=ie.graph();he.ranksep/=2,ir.forEach(ie.edges(),function(Te){var Ke=ie.edge(Te);Ke.minlen*=2,Ke.labelpos.toLowerCase()!=="c"&&(he.rankdir==="TB"||he.rankdir==="BT"?Ke.width+=Ke.labeloffset:Ke.height+=Ke.labeloffset)})})(Pt)}),jt("    removeSelfEdges",function(){(function(ie){ir.forEach(ie.edges(),function(he){if(he.v===he.w){var Te=ie.node(he.v);Te.selfEdges||(Te.selfEdges=[]),Te.selfEdges.push({e:he,label:ie.edge(he)}),ie.removeEdge(he)}})})(Pt)}),jt("    acyclic",function(){Uh.run(Pt)}),jt("    nestingGraph.run",function(){Qv.run(Pt)}),jt("    rank",function(){th(Gl.asNonCompoundGraph(Pt))}),jt("    injectEdgeLabelProxies",function(){(function(ie){ir.forEach(ie.edges(),function(he){var Te=ie.edge(he);if(Te.width&&Te.height){var Ke=ie.node(he.v),gn={rank:(ie.node(he.w).rank-Ke.rank)/2+Ke.rank,e:he};Gl.addDummyNode(ie,"edge-proxy",gn,"_ep")}})})(Pt)}),jt("    removeEmptyRanks",function(){tg(Pt)}),jt("    nestingGraph.cleanup",function(){Qv.cleanup(Pt)}),jt("    normalizeRanks",function(){rv(Pt)}),jt("    assignRankMinMax",function(){(function(ie){var he=0;ir.forEach(ie.nodes(),function(Te){var Ke=ie.node(Te);Ke.borderTop&&(Ke.minRank=ie.node(Ke.borderTop).rank,Ke.maxRank=ie.node(Ke.borderBottom).rank,he=ir.max(he,Ke.maxRank))}),ie.graph().maxRank=he})(Pt)}),jt("    removeEdgeLabelProxies",function(){(function(ie){ir.forEach(ie.nodes(),function(he){var Te=ie.node(he);Te.dummy==="edge-proxy"&&(ie.edge(Te.e).labelRank=Te.rank,ie.removeNode(he))})})(Pt)}),jt("    normalize.run",function(){Rd.run(Pt)}),jt("    parentDummyChains",function(){Sg(Pt)}),jt("    addBorderSegments",function(){Zp(Pt)}),jt("    order",function(){Gd(Pt)}),jt("    insertSelfEdges",function(){(function(ie){var he=Gl.buildLayerMatrix(ie);ir.forEach(he,function(Te){var Ke=0;ir.forEach(Te,function(gn,cn){var jn=ie.node(gn);jn.order=cn+Ke,ir.forEach(jn.selfEdges,function(En){Gl.addDummyNode(ie,"selfedge",{width:En.label.width,height:En.label.height,rank:jn.rank,order:cn+ ++Ke,e:En.e,label:En.label},"_se")}),delete jn.selfEdges})})})(Pt)}),jt("    adjustCoordinateSystem",function(){kv.adjust(Pt)}),jt("    position",function(){Sh(Pt)}),jt("    positionSelfEdges",function(){(function(ie){ir.forEach(ie.nodes(),function(he){var Te=ie.node(he);if(Te.dummy==="selfedge"){var Ke=ie.node(Te.e.v),gn=Ke.x+Ke.width/2,cn=Ke.y,jn=Te.x-gn,En=Ke.height/2;ie.setEdge(Te.e,Te.label),ie.removeNode(he),Te.label.points=[{x:gn+2*jn/3,y:cn-En},{x:gn+5*jn/6,y:cn-En},{x:gn+jn,y:cn},{x:gn+5*jn/6,y:cn+En},{x:gn+2*jn/3,y:cn+En}],Te.label.x=Te.x,Te.label.y=Te.y}})})(Pt)}),jt("    removeBorderNodes",function(){(function(ie){ir.forEach(ie.nodes(),function(he){if(ie.children(he).length){var Te=ie.node(he),Ke=ie.node(Te.borderTop),gn=ie.node(Te.borderBottom),cn=ie.node(ir.last(Te.borderLeft)),jn=ie.node(ir.last(Te.borderRight));Te.width=Math.abs(jn.x-cn.x),Te.height=Math.abs(gn.y-Ke.y),Te.x=cn.x+Te.width/2,Te.y=Ke.y+Te.height/2}}),ir.forEach(ie.nodes(),function(he){ie.node(he).dummy==="border"&&ie.removeNode(he)})})(Pt)}),jt("    normalize.undo",function(){Rd.undo(Pt)}),jt("    fixupEdgeLabelCoords",function(){(function(ie){ir.forEach(ie.edges(),function(he){var Te=ie.edge(he);if(ir.has(Te,"x"))switch(Te.labelpos!=="l"&&Te.labelpos!=="r"||(Te.width-=Te.labeloffset),Te.labelpos){case"l":Te.x-=Te.width/2+Te.labeloffset;break;case"r":Te.x+=Te.width/2+Te.labeloffset}})})(Pt)}),jt("    undoCoordinateSystem",function(){kv.undo(Pt)}),jt("    translateGraph",function(){(function(ie){var he=Number.POSITIVE_INFINITY,Te=0,Ke=Number.POSITIVE_INFINITY,gn=0,cn=ie.graph(),jn=cn.marginx||0,En=cn.marginy||0;function ya(Dr){var Fr=Dr.x,or=Dr.y,Xa=Dr.width,Hn=Dr.height;he=Math.min(he,Fr-Xa/2),Te=Math.max(Te,Fr+Xa/2),Ke=Math.min(Ke,or-Hn/2),gn=Math.max(gn,or+Hn/2)}ir.forEach(ie.nodes(),function(Dr){ya(ie.node(Dr))}),ir.forEach(ie.edges(),function(Dr){var Fr=ie.edge(Dr);ir.has(Fr,"x")&&ya(Fr)}),he-=jn,Ke-=En,ir.forEach(ie.nodes(),function(Dr){var Fr=ie.node(Dr);Fr.x-=he,Fr.y-=Ke}),ir.forEach(ie.edges(),function(Dr){var Fr=ie.edge(Dr);ir.forEach(Fr.points,function(or){or.x-=he,or.y-=Ke}),ir.has(Fr,"x")&&(Fr.x-=he),ir.has(Fr,"y")&&(Fr.y-=Ke)}),cn.width=Te-he+jn,cn.height=gn-Ke+En})(Pt)}),jt("    assignNodeIntersects",function(){(function(ie){ir.forEach(ie.edges(),function(he){var Te,Ke,gn=ie.edge(he),cn=ie.node(he.v),jn=ie.node(he.w);gn.points?(Te=gn.points[0],Ke=gn.points[gn.points.length-1]):(gn.points=[],Te=jn,Ke=cn),gn.points.unshift(Gl.intersectRect(cn,Te)),gn.points.push(Gl.intersectRect(jn,Ke))})})(Pt)}),jt("    reversePoints",function(){(function(ie){ir.forEach(ie.edges(),function(he){var Te=ie.edge(he);Te.reversed&&Te.points.reverse()})})(Pt)}),jt("    acyclic.undo",function(){Uh.undo(Pt)})})(_t,dt)}),dt("  updateInputGraph",function(){(function(Pt,jt){ir.forEach(Pt.nodes(),function(ie){var he=Pt.node(ie),Te=jt.node(ie);he&&(he.x=Te.x,he.y=Te.y,jt.children(ie).length&&(he.width=Te.width,he.height=Te.height))}),ir.forEach(Pt.edges(),function(ie){var he=Pt.edge(ie),Te=jt.edge(ie);he.points=Te.points,ir.has(Te,"x")&&(he.x=Te.x,he.y=Te.y)}),Pt.graph().width=jt.graph().width,Pt.graph().height=jt.graph().height})(M,_t)})})},Mf=["nodesep","edgesep","ranksep","marginx","marginy"],Ov={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},iv=["acyclicer","ranker","rankdir","align"],Yh=["width","height"],ov={width:0,height:0},Nc=["minlen","weight","width","height","labeloffset"],Ch={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},El=["labelpos"];function Fc(M,q){return ir.mapValues(ir.pick(M,q),Number)}function jd(M){var q={};return ir.forEach(M,function(dt,_t){q[_t.toLowerCase()]=dt}),q}var _p=$o.Graph,sv={graphlib:$o,layout:Af,debug:{debugOrdering:function(M){var q=Ml.buildLayerMatrix(M),dt=new _p({compound:!0,multigraph:!0}).setGraph({});return ir.forEach(M.nodes(),function(_t){dt.setNode(_t,{label:_t}),dt.setParent(_t,"layer"+M.node(_t).rank)}),ir.forEach(M.edges(),function(_t){dt.setEdge(_t.v,_t.w,{},_t.name)}),ir.forEach(q,function(_t,Pt){var jt="layer"+Pt;dt.setNode(jt,{rank:"same"}),ir.reduce(_t,function(ie,he){return dt.setEdge(ie,he,{style:"invis"}),he})}),dt}},util:{time:Ml.time,notime:Ml.notime},version:"0.8.5"},uv=sv.graphlib,Ip=sv.layout;class _h{constructor(q){this.cardinality=1,this.include=R.UNSPECIFIED,this.isGroupNode=!1,this.parentNode=null,this.type=Z.NODE,this.name=q.name,this.attr=q.attr||{},this.inputs=q.inputs,this.path=q.path||[],this.width=q.width,this.height=q.height}}class of{constructor(){this.nodes={},this.edges=[],this.nodes={},this.edges=[]}}function li(M){const q=new of;return M.nodes.map(dt=>new _h(dt)).forEach(dt=>{q.nodes[dt.name]=dt,dt.inputs.forEach(_t=>{(function(Pt,jt,ie){ie.name!==jt.name&&Pt.edges.push(Object.assign(Object.assign({},ie.attr),{v:ie.name,w:jt.name}))})(q,dt,_t)})}),q}class eg{constructor(q,dt={}){this.attr=null,this.bridgeGraph=null,this.cardinality=0,this.depth=1,this.include=R.UNSPECIFIED,this.isGroupNode=!0,this.parentNode=null,this.type=Z.META,this.path=[],this.name=q,this.metaGraph=yd(q,L.META,dt)}getFirstChild(){return this.metaGraph.node(this.metaGraph.nodes()[0])}getChildren(){return this.metaGraph.nodes().map(q=>this.metaGraph.node(q))}leaves(){let q,dt=[],_t=[this];for(;_t.length;){let Pt=_t.shift();Pt.isGroupNode?(q=Pt.metaGraph,q.nodes().forEach(jt=>_t.push(q.node(jt)))):dt.push(Pt.name)}return dt}}class Tp{constructor(q,dt){this.v=q,this.w=dt,this.baseEdgeList=[],this.inbound=null,this.name=null}addBaseEdge(q,dt){this.baseEdgeList.push(q)}}function lv(M,q={}){return new eg(M,q)}function Ap(M,q){return new Tp(M,q)}function yd(M,q,dt){const _t=dt||{},Pt=new uv.Graph(_t);return Pt.setGraph({name:M,rankdir:_t.rankdir,type:q,align:_t.align}),Pt}class cv{constructor(q={}){this.graphOptions=q,this.index={},this.graphOptions.compound=!0,this.root=lv(W,this.graphOptions),this.index[W]=this.root}getNodeMap(){return this.index}node(q){return this.index[q]}setNode(q,dt){this.index[q]=dt}getBridgeGraph(q){const dt=this.index[q];if(!dt)throw Error("Could not find node in hierarchy: "+q);if(!("metaGraph"in dt))return null;const _t=dt;if(_t.bridgeGraph)return _t.bridgeGraph;const Pt=yd(Q,L.BRIDGE,this.graphOptions);if(_t.bridgeGraph=Pt,!dt.parentNode||!("metaGraph"in dt.parentNode))return Pt;const jt=dt.parentNode;return[jt.metaGraph,this.getBridgeGraph(jt.name)].forEach(ie=>{ie.edges().filter(he=>he.v===q||he.w===q).forEach(he=>{const Te=he.w===q;ie.edge(he).baseEdgeList.forEach(Ke=>{const[gn,cn]=Te?[Ke.w,he.v]:[Ke.v,he.w],jn=this.getChildName(q,gn),En={v:Te?cn:jn,w:Te?jn:cn};let ya=Pt.edge(En);ya||(ya=Ap(En.v,En.w),ya.inbound=Te,Pt.setEdge(En.v,En.w,ya)),ya.addBaseEdge(Ke,this)})})}),Pt}getChildName(q,dt){let _t=this.index[dt];for(;_t;){if(_t.parentNode&&_t.parentNode.name===q)return _t.name;_t=_t.parentNode}throw Error("Could not find immediate child for descendant: "+dt)}getPredecessors(q){const dt=this.index[q];if(!dt)throw Error("Could not find node with name: "+q);return this.getOneWayEdges(dt,!0)}getSuccessors(q){const dt=this.index[q];if(!dt)throw Error("Could not find node with name: "+q);return this.getOneWayEdges(dt,!1)}getOneWayEdges(q,dt){const _t=[];if(!q.parentNode||!q.parentNode.isGroupNode)return _t;const Pt=q.parentNode,jt=Pt.metaGraph,ie=this.getBridgeGraph(Pt.name);return Rv(jt,q,dt,_t),Rv(ie,q,dt,_t),_t}}function nh(M,q){const{rankDirection:dt,align:_t}=q,Pt=new cv({rankdir:dt,align:_t});return function(jt,ie){Object.keys(ie.nodes).forEach(he=>{const Te=ie.nodes[he],Ke=Te.path;let gn=jt.root;gn.depth=Math.max(Ke.length,gn.depth);for(let cn=0;cn<Ke.length&&(gn.depth=Math.max(gn.depth,Ke.length-cn),gn.cardinality+=Te.cardinality,cn!==Ke.length-1);cn++){const jn=Ke[cn];let En=jt.node(jn);En||(En=lv(jn,jt.graphOptions),En.path=Te.path.slice(0,cn+1),En.parentNode=gn,jt.setNode(jn,En),gn.metaGraph.setNode(jn,En)),gn=En}jt.setNode(Te.name,Te),Te.parentNode=gn,gn.metaGraph.setNode(Te.name,Te)})}(Pt,M),function(jt,ie){const he=jt.getNodeMap();let Te=[],Ke=[];const gn=(cn,jn)=>{let En=0;for(;cn;)jn[En++]=cn.name,cn=cn.parentNode;return En-1};ie.edges.forEach(cn=>{Te=[],Ke=[];let jn=gn(ie.nodes[cn.v],Te),En=gn(ie.nodes[cn.w],Ke);for(;Te[jn]===Ke[En];)if(jn--,En--,jn<0||En<0)throw Error("No difference found between ancestor paths.");const ya=he[Te[jn+1]],Dr=Te[jn],Fr=Ke[En];let or=ya.metaGraph.edge(Dr,Fr);or||(or=Ap(Dr,Fr),ya.metaGraph.setEdge(Dr,Fr,or)),or.addBaseEdge(cn,jt)})}(Pt,M),Pt}function Rv(M,q,dt,_t){(dt?M.inEdges(q.name):M.outEdges(q.name)).forEach(Pt=>{const jt=M.edge(Pt);_t.push(jt)})}class Mp{constructor(q){this.hierarchy=q,this.index={},this.hasSubHierarchy={},this.root=new vn(this.hierarchy.root,this.hierarchy.graphOptions),this.index[q.root.name]=this.root,this.buildSubHierarchy(q.root.name),this.root.expanded=!0}getRenderInfoNodes(){return Object.values(this.index)}getSubHierarchy(){return this.hasSubHierarchy}buildSubHierarchy(q){if(q in this.hasSubHierarchy)return;this.hasSubHierarchy[q]=!0;const dt=this.index[q];if(dt.node.type!==Z.META)return;const _t=dt,Pt=_t.node.metaGraph,jt=_t.coreGraph;Pt.nodes().forEach(gn=>{const cn=this.getOrCreateRenderNodeByName(gn);jt.setNode(gn,cn)}),Pt.edges().forEach(gn=>{const cn=Pt.edge(gn),jn=new oe(cn);jt.setEdge(gn.v,gn.w,jn)});const ie=_t.node.parentNode;if(!ie)return;const he=this.getRenderNodeByName(ie.name),Te=(gn,...cn)=>cn.concat([gn?"IN":"OUT"]).join("~~"),Ke=this.hierarchy.getBridgeGraph(q);Ke.edges().forEach(gn=>{const cn=Ke.edge(gn),jn=!!Pt.node(gn.w),[En,ya]=jn?[gn.w,gn.v]:[gn.v,gn.w],Dr=Ci=>{const Yi=jn?{v:Ci,w:q}:{v:q,w:Ci};return he.coreGraph.edge(Yi)};let Fr=Dr(ya);Fr||(Fr=Dr(Te(jn,ya,ie.name)));const or=Te(jn,q),Xa=Te(jn,ya,q);let Hn=jt.node(Xa);if(!Hn){let Ci=jt.node(or);if(!Ci){const _i={name:or,type:Z.BRIDGE,isGroupNode:!1,cardinality:0,parentNode:null,include:R.UNSPECIFIED,inbound:jn,attr:{}};Ci=new Np(_i),this.index[or]=Ci,jt.setNode(or,Ci)}const Yi={name:Xa,type:Z.BRIDGE,isGroupNode:!1,cardinality:1,parentNode:null,include:R.UNSPECIFIED,inbound:jn,attr:{}};Hn=new Np(Yi),this.index[Xa]=Hn,jt.setNode(Xa,Hn),jt.setParent(Xa,or),Ci.node.cardinality++}const si=new oe(cn);si.adjoiningMetaEdge=Fr,jn?jt.setEdge(Xa,En,si):jt.setEdge(En,Xa,si)})}getOrCreateRenderNodeByName(q){if(!q)return null;if(q in this.index)return this.index[q];const dt=this.getNodeByName(q);return dt?(this.index[q]=dt.isGroupNode?new vn(dt,this.hierarchy.graphOptions):new Np(dt),this.index[q]):null}getRenderNodeByName(q){return this.index[q]}getNodeByName(q){return this.hierarchy.node(q)}}class Np{constructor(q){this.node=q,this.expanded=!1,this.x=0,this.y=0,this.coreBox={width:0,height:0},this.outboxWidth=0,this.labelOffset=0,this.radius=0,this.labelHeight=0,this.paddingTop=0,this.paddingLeft=0,this.paddingRight=0,this.paddingBottom=0,this.width=q.width||0,this.height=q.height||0,this.displayName=q.name,this.attr=q.attr}}class oe{constructor(q){this.metaEdge=q,this.adjoiningMetaEdge=null,this.weight=1,this.points=[]}}class vn extends Np{constructor(q,dt){super(q);const _t=q.metaGraph.graph();dt.compound=!0,this.coreGraph=yd(_t.name,L.CORE,dt)}}function qn(M,q){M.node.isGroupNode&&function(dt,_t){const Pt=tt(_t);dt.coreGraph.nodes().map(jt=>dt.coreGraph.node(jt)).forEach(jt=>{var ie,he,Te,Ke,gn,cn;const{height:jn,width:En}=jt;switch(jt.node.type){case Z.NODE:Object.assign(jt,Pt.nodeSize.node),jt.height=jn||Pt.nodeSize.node.height,jt.width=En||Pt.nodeSize.node.width;break;case Z.BRIDGE:Object.assign(jt,Pt.nodeSize.bridge);break;case Z.META:jt.expanded?qn(jt,_t):(Object.assign(jt,Pt.nodeSize.meta),jt.height=Pt.nodeSize.meta.height,jt.width=Pt.nodeSize.meta.width);break;default:throw Error("Unrecognized node type: "+jt.node.type)}if(!jt.expanded){const ya=jt.attr;(function(Dr,Fr=!1){if(Dr.coreBox.width=Dr.width,Dr.coreBox.height=Dr.height,!Fr){const or=`${Dr.displayName}`.length,Xa=3;Dr.width=Math.max(Dr.coreBox.width,or*Xa)}})(jt,_t&&(jt.node.type===0&&!!((he=(ie=_t==null?void 0:_t.nodeSize)===null||ie===void 0?void 0:ie.meta)===null||he===void 0?void 0:he.width)||jt.node.type===1&&(!!((Ke=(Te=_t==null?void 0:_t.nodeSize)===null||Te===void 0?void 0:Te.node)===null||Ke===void 0?void 0:Ke.width)||!!ya.width)||jt.node.type===2&&!!((cn=(gn=_t==null?void 0:_t.nodeSize)===null||gn===void 0?void 0:gn.bridge)===null||cn===void 0?void 0:cn.width)))}})}(M,q),M.node.type===Z.META&&function(dt,_t){const Pt=tt(_t),jt=Pt.subScene.meta;Object.assign(dt,jt);const{nodeSep:ie,rankSep:he,edgeSep:Te,align:Ke}=Pt.graph.meta,gn={nodesep:ie,ranksep:he,edgesep:Te,align:Ke};Object.assign(dt.coreBox,function(En,ya){const{ranksep:Dr,nodesep:Fr,edgesep:or,align:Xa}=ya;Object.assign(En.graph(),{ranksep:Dr,nodesep:Fr,edgesep:or,align:Xa});const Hn=[];if(En.nodes().forEach(Yo=>{En.node(Yo).node.type!==Z.BRIDGE&&Hn.push(Yo)}),!Hn.length)return{width:0,height:0};Ip(En);let si=1/0,Ci=1/0,Yi=-1/0,_i=-1/0;return Hn.forEach(Yo=>{const xi=En.node(Yo),Xu=.5*xi.width,jo=xi.x-Xu,Fl=xi.x+Xu;si=jo<si?jo:si,Yi=Fl>Yi?Fl:Yi;const ku=.5*xi.height,xs=xi.y-ku,_u=xi.y+ku;Ci=xs<Ci?xs:Ci,_i=_u>_i?_u:_i}),En.edges().forEach(Yo=>{const xi=En.edge(Yo),Xu=En.node(xi.metaEdge.v),jo=En.node(xi.metaEdge.w);if(xi.points.length===3&&function(xs){let _u=ia(xs[0],xs[1]);for(let cl=1;cl<xs.length-1;cl++){const zi=ia(xs[cl],xs[cl+1]);if(Math.abs(zi-_u)>1)return!1;_u=zi}return!0}(xi.points)){if(Xu!=null){const xs=Xu.expanded?Xu.x:Sa(Xu);xi.points[0].x=xs}if(jo!=null){const xs=jo.expanded?jo.x:Sa(jo);xi.points[2].x=xs}xi.points=[xi.points[0],xi.points[1]]}const Fl=xi.points[xi.points.length-2];jo!=null&&(xi.points[xi.points.length-1]=Hr(Fl,jo));const ku=xi.points[1];Xu!=null&&(xi.points[0]=Hr(ku,Xu)),xi.points.forEach(xs=>{si=xs.x<si?xs.x:si,Yi=xs.x>Yi?xs.x:Yi,Ci=xs.y<Ci?xs.y:Ci,_i=xs.y>_i?xs.y:_i})}),En.nodes().forEach(Yo=>{const xi=En.node(Yo);xi.x-=si,xi.y-=Ci}),En.edges().forEach(Yo=>{En.edge(Yo).points.forEach(xi=>{xi.x-=si,xi.y-=Ci})}),{width:Yi-si,height:_i-Ci}}(dt.coreGraph,gn));let cn=0;dt.coreGraph.nodeCount()>0&&cn++;const jn=cn<=1?0:cn;dt.coreBox.width+=jn+jn,dt.coreBox.height=jt.labelHeight+dt.coreBox.height,dt.width=dt.coreBox.width+jt.paddingLeft+jt.paddingRight,dt.height=dt.paddingTop+dt.coreBox.height+dt.paddingBottom}(M,q)}function ia(M,q){const dt=q.x-M.x,_t=q.y-M.y;return 180*Math.atan(_t/dt)/Math.PI}function Sa(M){return M.expanded?M.x:M.x-M.width/2+0+M.coreBox.width/2}function Hr(M,q){const dt=q.expanded?q.x:Sa(q),_t=q.y,Pt=M.x-dt,jt=M.y-_t;let ie,he,Te=q.expanded?q.width:q.coreBox.width,Ke=q.expanded?q.height:q.coreBox.height;return Math.abs(jt)*Te/2>Math.abs(Pt)*Ke/2?(jt<0&&(Ke=-Ke),ie=jt===0?0:Ke/2*Pt/jt,he=Ke/2):(Pt<0&&(Te=-Te),ie=Te/2,he=Pt===0?0:Te/2*jt/Pt),{x:dt+ie,y:_t+he}}function ea(M,q,dt){var _t,Pt,jt,ie;const he=M.nodes.filter((cn,jn,En)=>En.findIndex(ya=>ya.id===cn.id)!==jn).map(cn=>cn.id);if(he.length)throw new Error(`Duplicated ids found: ${he.join(", ")}`);const Te=function(cn){const jn={nodes:[]},En=cn.compound,ya=Object.keys(En||{}),Dr=new Map,Fr=(Xa,Hn=[])=>{if(Dr.has(Xa))return Dr.get(Xa);for(let si=0;si<ya.length;si++){let Ci=ya[si];if(En&&En[Ci].indexOf(Xa)!==-1)return Hn.unshift(Ci),Fr(Ci,Hn)}return Hn.length===0&&Dr.set(Xa,Hn),Hn},or=Xa=>cn.edges.filter(Hn=>Hn.w===Xa).map(Hn=>({name:Hn.v}));return cn.nodes.forEach(Xa=>{const Hn=Xa.id,si=[...Fr(Hn),Hn];let Ci=or(Hn);jn.nodes.push({name:Hn,path:si,inputs:Ci,width:Xa.width,height:Xa.height,attr:Object.assign({},Xa)})}),jn}(M),Ke=function(cn,jn){const En=(Dr,Fr)=>{for(let or of Fr.values())if(or.includes(Dr))return!0;return!1},ya=(Dr,Fr=[])=>{if(Object.keys(Dr).length===0)return[...new Set(Fr)];const or=new Map(Object.keys(Dr).map(Hn=>[Hn,Dr[Hn]])),Xa={};for(let[Hn,si]of or)En(Hn,or)?Xa[Hn]=si:Fr=Fr.concat(Hn,si);return ya(Xa,Fr)};return ya(cn).filter(Dr=>jn.includes(Dr))}(M.compound||{},(q==null?void 0:q.expanded)||[]),gn=function(cn,jn){return function(En){return new Mp(En)}(nh(li(cn),jn))}(Te,{rankDirection:((Pt=(_t=dt==null?void 0:dt.graph)===null||_t===void 0?void 0:_t.meta)===null||Pt===void 0?void 0:Pt.rankDir)||(q==null?void 0:q.rankDirection)||Y.graph.meta.rankDir,align:((ie=(jt=dt==null?void 0:dt.graph)===null||jt===void 0?void 0:jt.meta)===null||ie===void 0?void 0:ie.align)||Y.graph.meta.align});return function(cn,jn){jn.forEach(En=>{const ya=cn.getRenderInfoNodes().find(or=>or.displayName===En);let Dr=ya&&ya.node&&ya.node.name||"";const Fr=cn.getRenderNodeByName(Dr);if(!Fr)throw new Error(`No nodes found: ${Dr}`);Fr.expanded=!0,cn.buildSubHierarchy(Dr)})}(gn,Ke),qn(gn.root,dt),Ga(gn.root)}function Ha(M,q=!1){const dt=JSON.parse(JSON.stringify(M)),_t={nodes:[dt],edges:[...dt.edges]};return dt.nodes.forEach(function Pt(jt){(jt.type===0||jt.type===1)&&_t.nodes.push(jt),jt.type===0&&(_t.edges=_t.edges.concat(jt.edges)),Array.isArray(jt.nodes)&&jt.nodes.forEach(Pt)}),q&&_t.nodes.forEach(Pt=>{const jt=_t.nodes.find(ie=>ie.id===Pt.parentNodeName);if(jt){const ie=jt.x-jt.width/2+jt.paddingLeft,he=jt.y-jt.height/2+jt.labelHeight+jt.paddingTop;jt.id!==W&&(Pt.x+=ie,Pt.y+=he),Pt.type===0&&Pt.edges.forEach(Te=>{Te.points.forEach(Ke=>{Ke.x+=Pt.x-Pt.width/2+Pt.paddingLeft,Ke.y+=Pt.y-Pt.height/2+Pt.labelHeight+Pt.paddingTop})})}}),_t}function Wa(M,q,dt,_t){var Pt,jt;let ie=[];const he=((Pt=dt.find(cn=>cn.id===M))===null||Pt===void 0?void 0:Pt.path)||[],Te=((jt=dt.find(cn=>cn.id===q))===null||jt===void 0?void 0:jt.path)||[],Ke=[W,...he].slice(0,he.length).reverse(),gn=[W,...Te].slice(0,Te.length);return Ke.forEach(cn=>{const jn=dt.find(En=>En.id===cn);ie=ie.concat(jn.edges.filter(En=>En.baseEdgeList.some(ya=>ya.v===((_t==null?void 0:_t.v)||M)&&ya.w===((_t==null?void 0:_t.w)||q))))}),gn.filter(cn=>!Ke.includes(cn)).forEach(cn=>{const jn=dt.find(En=>En.id===cn);ie=ie.concat(jn.edges.filter(En=>En.baseEdgeList.some(ya=>ya.v===((_t==null?void 0:_t.v)||M)&&ya.w===((_t==null?void 0:_t.w)||q))))}),ie}function Ga(M){const q=M.coreGraph.nodes().map(_t=>M.coreGraph.node(_t));return Object.assign(Object.assign({},Qa(M)),{expanded:M.expanded,nodes:M.expanded?(dt=q,dt.map(_t=>_t.node.type===Z.META?Ga(_t):Qa(_t))):[],edges:M.expanded?Vn(M):[]});var dt}function Qa(M){return{id:M.node.name,name:M.node.name,type:M.node.type,cardinality:M.node.cardinality,attr:M.attr,parentNodeName:M.node.parentNode?M.node.parentNode.name:null,coreBox:Object.assign({},M.coreBox),x:M.x,y:M.y,width:M.width,height:M.height,radius:M.radius,labelHeight:M.labelHeight,labelOffset:M.labelOffset,outboxWidth:M.outboxWidth,paddingLeft:M.paddingLeft,paddingTop:M.paddingTop,paddingRight:M.paddingRight,paddingBottom:M.paddingBottom,path:M.node.path}}function Vn(M){return M.coreGraph.edges().map(q=>({renderInfoEdge:M.coreGraph.edge(q),edge:q})).filter(({renderInfoEdge:q})=>q.metaEdge).map(({edge:q,renderInfoEdge:dt})=>{const _t=function(Pt,jt){const ie=jt.points.map(he=>Object.assign({},he));if(jt.adjoiningMetaEdge){const he=jt.adjoiningMetaEdge.points,Te=jt.metaEdge.inbound,Ke=Te?he[he.length-1]:he[0],gn=ie[Te?0:ie.length-1],cn=Pt.x-Pt.width/2,jn=Pt.y-Pt.height/2,En=Ke.x-cn,ya=Ke.y-jn,Dr=-Pt.paddingLeft,Fr=-(Pt.paddingTop+Pt.labelHeight);gn.x=En+Dr,gn.y=ya+Fr}return ie}(M,dt);return{adjoiningEdge:dt.adjoiningMetaEdge?{w:dt.adjoiningMetaEdge.metaEdge.w,v:dt.adjoiningMetaEdge.metaEdge.v}:null,inbound:dt.metaEdge.inbound,w:q.w,v:q.v,points:_t,weight:dt.weight,baseEdgeList:dt.metaEdge.baseEdgeList,parentNodeName:M.node.name}})}},49685:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{EPSILON:function(){return Y},ARRAY_TYPE:function(){return tt},RANDOM:function(){return j},setMatrixArrayType:function(){return W},toRadian:function(){return Z},equals:function(){return R}});var Y=1e-6,tt=typeof Float32Array!="undefined"?Float32Array:Array,j=Math.random;function W(L){tt=L}var Q=Math.PI/180;function Z(L){return L*Q}function R(L,C){return Math.abs(L-C)<=Y*Math.max(1,Math.abs(L),Math.abs(C))}Math.hypot||(Math.hypot=function(){for(var L=0,C=arguments.length;C--;)L+=arguments[C]*arguments[C];return Math.sqrt(L)})},64530:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{glMatrix:function(){return R},mat2:function(){return Y},mat2d:function(){return tt},mat3:function(){return xr},mat4:function(){return j},quat:function(){return Q},quat2:function(){return Z},vec2:function(){return Cf},vec3:function(){return Di},vec4:function(){return W}});var Y={};$.r(Y),$.d(Y,{LDU:function(){return ut},add:function(){return pt},adjoint:function(){return nt},clone:function(){return C},copy:function(){return A},create:function(){return L},determinant:function(){return P},equals:function(){return ue},exactEquals:function(){return Ut},frob:function(){return wt},fromRotation:function(){return lt},fromScaling:function(){return ht},fromValues:function(){return B},identity:function(){return N},invert:function(){return K},mul:function(){return Ne},multiply:function(){return k},multiplyScalar:function(){return se},multiplyScalarAndAdd:function(){return Le},rotate:function(){return yt},scale:function(){return st},set:function(){return O},str:function(){return mt},sub:function(){return we},subtract:function(){return Nt},transpose:function(){return F}});var tt={};$.r(tt),$.d(tt,{add:function(){return Ft},clone:function(){return Qt},copy:function(){return de},create:function(){return At},determinant:function(){return Ze},equals:function(){return Rt},exactEquals:function(){return fn},frob:function(){return ee},fromRotation:function(){return Be},fromScaling:function(){return te},fromTranslation:function(){return ke},fromValues:function(){return Ee},identity:function(){return rn},invert:function(){return Oe},mul:function(){return Xn},multiply:function(){return fe},multiplyScalar:function(){return Me},multiplyScalarAndAdd:function(){return en},rotate:function(){return Ae},scale:function(){return Ye},set:function(){return ce},str:function(){return Ve},sub:function(){return Bn},subtract:function(){return bt},translate:function(){return ge}});var j={};$.r(j),$.d(j,{add:function(){return Ar},adjoint:function(){return sr},clone:function(){return Ur},copy:function(){return fa},create:function(){return dr},determinant:function(){return Pn},equals:function(){return ki},exactEquals:function(){return Ti},frob:function(){return Jn},fromQuat:function(){return xt},fromQuat2:function(){return un},fromRotation:function(){return ua},fromRotationTranslation:function(){return Dn},fromRotationTranslationScale:function(){return H},fromRotationTranslationScaleOrigin:function(){return X},fromScaling:function(){return qr},fromTranslation:function(){return pr},fromValues:function(){return Ea},fromXRotation:function(){return $r},fromYRotation:function(){return ba},fromZRotation:function(){return gt},frustum:function(){return zt},getRotation:function(){return it},getScaling:function(){return Ot},getTranslation:function(){return Lt},identity:function(){return Da},invert:function(){return _n},lookAt:function(){return Ln},mul:function(){return vi},multiply:function(){return tr},multiplyScalar:function(){return za},multiplyScalarAndAdd:function(){return da},ortho:function(){return He},orthoNO:function(){return tn},orthoZO:function(){return Qn},perspective:function(){return Xt},perspectiveFromFieldOfView:function(){return on},perspectiveNO:function(){return Vt},perspectiveZO:function(){return ne},rotate:function(){return Yr},rotateX:function(){return nr},rotateY:function(){return wr},rotateZ:function(){return Sr},scale:function(){return Wr},set:function(){return aa},str:function(){return Ia},sub:function(){return ii},subtract:function(){return na},targetTo:function(){return Qr},translate:function(){return zn},transpose:function(){return Lr}});var W={};$.r(W),$.d(W,{add:function(){return Gn},ceil:function(){return La},clone:function(){return ln},copy:function(){return dn},create:function(){return Ra},cross:function(){return Eu},dist:function(){return qs},distance:function(){return Wo},div:function(){return Du},divide:function(){return xa},dot:function(){return Zs},equals:function(){return ys},exactEquals:function(){return Wi},floor:function(){return ui},forEach:function(){return Ms},fromValues:function(){return De},inverse:function(){return Do},len:function(){return ji},length:function(){return bi},lerp:function(){return as},max:function(){return Ki},min:function(){return Fi},mul:function(){return Us},multiply:function(){return Rr},negate:function(){return ms},normalize:function(){return To},random:function(){return Rs},round:function(){return xo},scale:function(){return vo},scaleAndAdd:function(){return es},set:function(){return Wn},sqrDist:function(){return Cu},sqrLen:function(){return Bi},squaredDistance:function(){return Zi},squaredLength:function(){return gi},str:function(){return Zo},sub:function(){return is},subtract:function(){return Kn},transformMat4:function(){return Su},transformQuat:function(){return fu},zero:function(){return Is}});var Q={};$.r(Q),$.d(Q,{add:function(){return Nu},calculateW:function(){return Vi},clone:function(){return Js},conjugate:function(){return Cs},copy:function(){return Mu},create:function(){return os},dot:function(){return gu},equals:function(){return Ls},exactEquals:function(){return vl},exp:function(){return Ao},fromEuler:function(){return Tl},fromMat3:function(){return Au},fromValues:function(){return ul},getAngle:function(){return Qu},getAxisAngle:function(){return Qs},identity:function(){return Ws},invert:function(){return ou},len:function(){return Ju},length:function(){return Wu},lerp:function(){return Fu},ln:function(){return ao},mul:function(){return fs},multiply:function(){return xn},normalize:function(){return Bl},pow:function(){return So},random:function(){return fo},rotateX:function(){return Vr},rotateY:function(){return pa},rotateZ:function(){return Fa},rotationTo:function(){return el},scale:function(){return Bs},set:function(){return Pu},setAxes:function(){return Ol},setAxisAngle:function(){return Ss},slerp:function(){return Ts},sqlerp:function(){return oc},sqrLen:function(){return gc},squaredLength:function(){return tu},str:function(){return bl}});var Z={};$.r(Z),$.d(Z,{add:function(){return wo},clone:function(){return Se},conjugate:function(){return su},copy:function(){return Yt},create:function(){return Ic},dot:function(){return Ps},equals:function(){return Yl},exactEquals:function(){return Sf},fromMat4:function(){return Zn},fromRotation:function(){return bn},fromRotationTranslation:function(){return re},fromRotationTranslationValues:function(){return Gt},fromTranslation:function(){return me},fromValues:function(){return ve},getDual:function(){return In},getReal:function(){return Fe},getTranslation:function(){return Ta},identity:function(){return Ie},invert:function(){return Vs},len:function(){return Rl},length:function(){return xl},lerp:function(){return As},mul:function(){return Ro},multiply:function(){return ho},normalize:function(){return rl},rotateAroundAxis:function(){return hs},rotateByQuatAppend:function(){return Ai},rotateByQuatPrepend:function(){return Oi},rotateX:function(){return ja},rotateY:function(){return Oa},rotateZ:function(){return so},scale:function(){return Ys},set:function(){return Ge},setDual:function(){return ra},setReal:function(){return ar},sqrLen:function(){return nl},squaredLength:function(){return Ll},str:function(){return Ef},translate:function(){return $a}});var R=$(49685);function L(){var T=new R.ARRAY_TYPE(4);return R.ARRAY_TYPE!=Float32Array&&(T[1]=0,T[2]=0),T[0]=1,T[3]=1,T}function C(T){var rt=new R.ARRAY_TYPE(4);return rt[0]=T[0],rt[1]=T[1],rt[2]=T[2],rt[3]=T[3],rt}function A(T,rt){return T[0]=rt[0],T[1]=rt[1],T[2]=rt[2],T[3]=rt[3],T}function N(T){return T[0]=1,T[1]=0,T[2]=0,T[3]=1,T}function B(T,rt,Kt,pe){var Re=new R.ARRAY_TYPE(4);return Re[0]=T,Re[1]=rt,Re[2]=Kt,Re[3]=pe,Re}function O(T,rt,Kt,pe,Re){return T[0]=rt,T[1]=Kt,T[2]=pe,T[3]=Re,T}function F(T,rt){if(T===rt){var Kt=rt[1];T[1]=rt[2],T[2]=Kt}else T[0]=rt[0],T[1]=rt[2],T[2]=rt[1],T[3]=rt[3];return T}function K(T,rt){var Kt=rt[0],pe=rt[1],Re=rt[2],Je=rt[3],an=Kt*Je-Re*pe;return an?(an=1/an,T[0]=Je*an,T[1]=-pe*an,T[2]=-Re*an,T[3]=Kt*an,T):null}function nt(T,rt){var Kt=rt[0];return T[0]=rt[3],T[1]=-rt[1],T[2]=-rt[2],T[3]=Kt,T}function P(T){return T[0]*T[3]-T[2]*T[1]}function k(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=Kt[0],Mn=Kt[1],rr=Kt[2],We=Kt[3];return T[0]=pe*wn+Je*Mn,T[1]=Re*wn+an*Mn,T[2]=pe*rr+Je*We,T[3]=Re*rr+an*We,T}function yt(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=Math.sin(Kt),Mn=Math.cos(Kt);return T[0]=pe*Mn+Je*wn,T[1]=Re*Mn+an*wn,T[2]=pe*-wn+Je*Mn,T[3]=Re*-wn+an*Mn,T}function st(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=Kt[0],Mn=Kt[1];return T[0]=pe*wn,T[1]=Re*wn,T[2]=Je*Mn,T[3]=an*Mn,T}function lt(T,rt){var Kt=Math.sin(rt),pe=Math.cos(rt);return T[0]=pe,T[1]=Kt,T[2]=-Kt,T[3]=pe,T}function ht(T,rt){return T[0]=rt[0],T[1]=0,T[2]=0,T[3]=rt[1],T}function mt(T){return"mat2("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+")"}function wt(T){return Math.hypot(T[0],T[1],T[2],T[3])}function ut(T,rt,Kt,pe){return T[2]=pe[2]/pe[0],Kt[0]=pe[0],Kt[1]=pe[1],Kt[3]=pe[3]-T[2]*Kt[1],[T,rt,Kt]}function pt(T,rt,Kt){return T[0]=rt[0]+Kt[0],T[1]=rt[1]+Kt[1],T[2]=rt[2]+Kt[2],T[3]=rt[3]+Kt[3],T}function Nt(T,rt,Kt){return T[0]=rt[0]-Kt[0],T[1]=rt[1]-Kt[1],T[2]=rt[2]-Kt[2],T[3]=rt[3]-Kt[3],T}function Ut(T,rt){return T[0]===rt[0]&&T[1]===rt[1]&&T[2]===rt[2]&&T[3]===rt[3]}function ue(T,rt){var Kt=T[0],pe=T[1],Re=T[2],Je=T[3],an=rt[0],wn=rt[1],Mn=rt[2],rr=rt[3];return Math.abs(Kt-an)<=R.EPSILON*Math.max(1,Math.abs(Kt),Math.abs(an))&&Math.abs(pe-wn)<=R.EPSILON*Math.max(1,Math.abs(pe),Math.abs(wn))&&Math.abs(Re-Mn)<=R.EPSILON*Math.max(1,Math.abs(Re),Math.abs(Mn))&&Math.abs(Je-rr)<=R.EPSILON*Math.max(1,Math.abs(Je),Math.abs(rr))}function se(T,rt,Kt){return T[0]=rt[0]*Kt,T[1]=rt[1]*Kt,T[2]=rt[2]*Kt,T[3]=rt[3]*Kt,T}function Le(T,rt,Kt,pe){return T[0]=rt[0]+Kt[0]*pe,T[1]=rt[1]+Kt[1]*pe,T[2]=rt[2]+Kt[2]*pe,T[3]=rt[3]+Kt[3]*pe,T}var Ne=k,we=Nt;function At(){var T=new R.ARRAY_TYPE(6);return R.ARRAY_TYPE!=Float32Array&&(T[1]=0,T[2]=0,T[4]=0,T[5]=0),T[0]=1,T[3]=1,T}function Qt(T){var rt=new R.ARRAY_TYPE(6);return rt[0]=T[0],rt[1]=T[1],rt[2]=T[2],rt[3]=T[3],rt[4]=T[4],rt[5]=T[5],rt}function de(T,rt){return T[0]=rt[0],T[1]=rt[1],T[2]=rt[2],T[3]=rt[3],T[4]=rt[4],T[5]=rt[5],T}function rn(T){return T[0]=1,T[1]=0,T[2]=0,T[3]=1,T[4]=0,T[5]=0,T}function Ee(T,rt,Kt,pe,Re,Je){var an=new R.ARRAY_TYPE(6);return an[0]=T,an[1]=rt,an[2]=Kt,an[3]=pe,an[4]=Re,an[5]=Je,an}function ce(T,rt,Kt,pe,Re,Je,an){return T[0]=rt,T[1]=Kt,T[2]=pe,T[3]=Re,T[4]=Je,T[5]=an,T}function Oe(T,rt){var Kt=rt[0],pe=rt[1],Re=rt[2],Je=rt[3],an=rt[4],wn=rt[5],Mn=Kt*Je-pe*Re;return Mn?(Mn=1/Mn,T[0]=Je*Mn,T[1]=-pe*Mn,T[2]=-Re*Mn,T[3]=Kt*Mn,T[4]=(Re*wn-Je*an)*Mn,T[5]=(pe*an-Kt*wn)*Mn,T):null}function Ze(T){return T[0]*T[3]-T[1]*T[2]}function fe(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=rt[4],Mn=rt[5],rr=Kt[0],We=Kt[1],ca=Kt[2],ha=Kt[3],_r=Kt[4],Va=Kt[5];return T[0]=pe*rr+Je*We,T[1]=Re*rr+an*We,T[2]=pe*ca+Je*ha,T[3]=Re*ca+an*ha,T[4]=pe*_r+Je*Va+wn,T[5]=Re*_r+an*Va+Mn,T}function Ae(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=rt[4],Mn=rt[5],rr=Math.sin(Kt),We=Math.cos(Kt);return T[0]=pe*We+Je*rr,T[1]=Re*We+an*rr,T[2]=pe*-rr+Je*We,T[3]=Re*-rr+an*We,T[4]=wn,T[5]=Mn,T}function Ye(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=rt[4],Mn=rt[5],rr=Kt[0],We=Kt[1];return T[0]=pe*rr,T[1]=Re*rr,T[2]=Je*We,T[3]=an*We,T[4]=wn,T[5]=Mn,T}function ge(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=rt[4],Mn=rt[5],rr=Kt[0],We=Kt[1];return T[0]=pe,T[1]=Re,T[2]=Je,T[3]=an,T[4]=pe*rr+Je*We+wn,T[5]=Re*rr+an*We+Mn,T}function Be(T,rt){var Kt=Math.sin(rt),pe=Math.cos(rt);return T[0]=pe,T[1]=Kt,T[2]=-Kt,T[3]=pe,T[4]=0,T[5]=0,T}function te(T,rt){return T[0]=rt[0],T[1]=0,T[2]=0,T[3]=rt[1],T[4]=0,T[5]=0,T}function ke(T,rt){return T[0]=1,T[1]=0,T[2]=0,T[3]=1,T[4]=rt[0],T[5]=rt[1],T}function Ve(T){return"mat2d("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+", "+T[4]+", "+T[5]+")"}function ee(T){return Math.hypot(T[0],T[1],T[2],T[3],T[4],T[5],1)}function Ft(T,rt,Kt){return T[0]=rt[0]+Kt[0],T[1]=rt[1]+Kt[1],T[2]=rt[2]+Kt[2],T[3]=rt[3]+Kt[3],T[4]=rt[4]+Kt[4],T[5]=rt[5]+Kt[5],T}function bt(T,rt,Kt){return T[0]=rt[0]-Kt[0],T[1]=rt[1]-Kt[1],T[2]=rt[2]-Kt[2],T[3]=rt[3]-Kt[3],T[4]=rt[4]-Kt[4],T[5]=rt[5]-Kt[5],T}function Me(T,rt,Kt){return T[0]=rt[0]*Kt,T[1]=rt[1]*Kt,T[2]=rt[2]*Kt,T[3]=rt[3]*Kt,T[4]=rt[4]*Kt,T[5]=rt[5]*Kt,T}function en(T,rt,Kt,pe){return T[0]=rt[0]+Kt[0]*pe,T[1]=rt[1]+Kt[1]*pe,T[2]=rt[2]+Kt[2]*pe,T[3]=rt[3]+Kt[3]*pe,T[4]=rt[4]+Kt[4]*pe,T[5]=rt[5]+Kt[5]*pe,T}function fn(T,rt){return T[0]===rt[0]&&T[1]===rt[1]&&T[2]===rt[2]&&T[3]===rt[3]&&T[4]===rt[4]&&T[5]===rt[5]}function Rt(T,rt){var Kt=T[0],pe=T[1],Re=T[2],Je=T[3],an=T[4],wn=T[5],Mn=rt[0],rr=rt[1],We=rt[2],ca=rt[3],ha=rt[4],_r=rt[5];return Math.abs(Kt-Mn)<=R.EPSILON*Math.max(1,Math.abs(Kt),Math.abs(Mn))&&Math.abs(pe-rr)<=R.EPSILON*Math.max(1,Math.abs(pe),Math.abs(rr))&&Math.abs(Re-We)<=R.EPSILON*Math.max(1,Math.abs(Re),Math.abs(We))&&Math.abs(Je-ca)<=R.EPSILON*Math.max(1,Math.abs(Je),Math.abs(ca))&&Math.abs(an-ha)<=R.EPSILON*Math.max(1,Math.abs(an),Math.abs(ha))&&Math.abs(wn-_r)<=R.EPSILON*Math.max(1,Math.abs(wn),Math.abs(_r))}var Xn=fe,Bn=bt,xr=$(35600);function dr(){var T=new R.ARRAY_TYPE(16);return R.ARRAY_TYPE!=Float32Array&&(T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[11]=0,T[12]=0,T[13]=0,T[14]=0),T[0]=1,T[5]=1,T[10]=1,T[15]=1,T}function Ur(T){var rt=new R.ARRAY_TYPE(16);return rt[0]=T[0],rt[1]=T[1],rt[2]=T[2],rt[3]=T[3],rt[4]=T[4],rt[5]=T[5],rt[6]=T[6],rt[7]=T[7],rt[8]=T[8],rt[9]=T[9],rt[10]=T[10],rt[11]=T[11],rt[12]=T[12],rt[13]=T[13],rt[14]=T[14],rt[15]=T[15],rt}function fa(T,rt){return T[0]=rt[0],T[1]=rt[1],T[2]=rt[2],T[3]=rt[3],T[4]=rt[4],T[5]=rt[5],T[6]=rt[6],T[7]=rt[7],T[8]=rt[8],T[9]=rt[9],T[10]=rt[10],T[11]=rt[11],T[12]=rt[12],T[13]=rt[13],T[14]=rt[14],T[15]=rt[15],T}function Ea(T,rt,Kt,pe,Re,Je,an,wn,Mn,rr,We,ca,ha,_r,Va,qa){var ma=new R.ARRAY_TYPE(16);return ma[0]=T,ma[1]=rt,ma[2]=Kt,ma[3]=pe,ma[4]=Re,ma[5]=Je,ma[6]=an,ma[7]=wn,ma[8]=Mn,ma[9]=rr,ma[10]=We,ma[11]=ca,ma[12]=ha,ma[13]=_r,ma[14]=Va,ma[15]=qa,ma}function aa(T,rt,Kt,pe,Re,Je,an,wn,Mn,rr,We,ca,ha,_r,Va,qa,ma){return T[0]=rt,T[1]=Kt,T[2]=pe,T[3]=Re,T[4]=Je,T[5]=an,T[6]=wn,T[7]=Mn,T[8]=rr,T[9]=We,T[10]=ca,T[11]=ha,T[12]=_r,T[13]=Va,T[14]=qa,T[15]=ma,T}function Da(T){return T[0]=1,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=1,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=1,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function Lr(T,rt){if(T===rt){var Kt=rt[1],pe=rt[2],Re=rt[3],Je=rt[6],an=rt[7],wn=rt[11];T[1]=rt[4],T[2]=rt[8],T[3]=rt[12],T[4]=Kt,T[6]=rt[9],T[7]=rt[13],T[8]=pe,T[9]=Je,T[11]=rt[14],T[12]=Re,T[13]=an,T[14]=wn}else T[0]=rt[0],T[1]=rt[4],T[2]=rt[8],T[3]=rt[12],T[4]=rt[1],T[5]=rt[5],T[6]=rt[9],T[7]=rt[13],T[8]=rt[2],T[9]=rt[6],T[10]=rt[10],T[11]=rt[14],T[12]=rt[3],T[13]=rt[7],T[14]=rt[11],T[15]=rt[15];return T}function _n(T,rt){var Kt=rt[0],pe=rt[1],Re=rt[2],Je=rt[3],an=rt[4],wn=rt[5],Mn=rt[6],rr=rt[7],We=rt[8],ca=rt[9],ha=rt[10],_r=rt[11],Va=rt[12],qa=rt[13],ma=rt[14],Mi=rt[15],zo=Kt*wn-pe*an,_o=Kt*Mn-Re*an,Lo=Kt*rr-Je*an,yo=pe*Mn-Re*wn,No=pe*rr-Je*wn,Vu=Re*rr-Je*Mn,Bu=We*qa-ca*Va,ju=We*ma-ha*Va,tl=We*Mi-_r*Va,Hu=ca*ma-ha*qa,al=ca*Mi-_r*qa,il=ha*Mi-_r*ma,ds=zo*il-_o*al+Lo*Hu+yo*tl-No*ju+Vu*Bu;return ds?(ds=1/ds,T[0]=(wn*il-Mn*al+rr*Hu)*ds,T[1]=(Re*al-pe*il-Je*Hu)*ds,T[2]=(qa*Vu-ma*No+Mi*yo)*ds,T[3]=(ha*No-ca*Vu-_r*yo)*ds,T[4]=(Mn*tl-an*il-rr*ju)*ds,T[5]=(Kt*il-Re*tl+Je*ju)*ds,T[6]=(ma*Lo-Va*Vu-Mi*_o)*ds,T[7]=(We*Vu-ha*Lo+_r*_o)*ds,T[8]=(an*al-wn*tl+rr*Bu)*ds,T[9]=(pe*tl-Kt*al-Je*Bu)*ds,T[10]=(Va*No-qa*Lo+Mi*zo)*ds,T[11]=(ca*Lo-We*No-_r*zo)*ds,T[12]=(wn*ju-an*Hu-Mn*Bu)*ds,T[13]=(Kt*Hu-pe*ju+Re*Bu)*ds,T[14]=(qa*_o-Va*yo-ma*zo)*ds,T[15]=(We*yo-ca*_o+ha*zo)*ds,T):null}function sr(T,rt){var Kt=rt[0],pe=rt[1],Re=rt[2],Je=rt[3],an=rt[4],wn=rt[5],Mn=rt[6],rr=rt[7],We=rt[8],ca=rt[9],ha=rt[10],_r=rt[11],Va=rt[12],qa=rt[13],ma=rt[14],Mi=rt[15];return T[0]=wn*(ha*Mi-_r*ma)-ca*(Mn*Mi-rr*ma)+qa*(Mn*_r-rr*ha),T[1]=-(pe*(ha*Mi-_r*ma)-ca*(Re*Mi-Je*ma)+qa*(Re*_r-Je*ha)),T[2]=pe*(Mn*Mi-rr*ma)-wn*(Re*Mi-Je*ma)+qa*(Re*rr-Je*Mn),T[3]=-(pe*(Mn*_r-rr*ha)-wn*(Re*_r-Je*ha)+ca*(Re*rr-Je*Mn)),T[4]=-(an*(ha*Mi-_r*ma)-We*(Mn*Mi-rr*ma)+Va*(Mn*_r-rr*ha)),T[5]=Kt*(ha*Mi-_r*ma)-We*(Re*Mi-Je*ma)+Va*(Re*_r-Je*ha),T[6]=-(Kt*(Mn*Mi-rr*ma)-an*(Re*Mi-Je*ma)+Va*(Re*rr-Je*Mn)),T[7]=Kt*(Mn*_r-rr*ha)-an*(Re*_r-Je*ha)+We*(Re*rr-Je*Mn),T[8]=an*(ca*Mi-_r*qa)-We*(wn*Mi-rr*qa)+Va*(wn*_r-rr*ca),T[9]=-(Kt*(ca*Mi-_r*qa)-We*(pe*Mi-Je*qa)+Va*(pe*_r-Je*ca)),T[10]=Kt*(wn*Mi-rr*qa)-an*(pe*Mi-Je*qa)+Va*(pe*rr-Je*wn),T[11]=-(Kt*(wn*_r-rr*ca)-an*(pe*_r-Je*ca)+We*(pe*rr-Je*wn)),T[12]=-(an*(ca*ma-ha*qa)-We*(wn*ma-Mn*qa)+Va*(wn*ha-Mn*ca)),T[13]=Kt*(ca*ma-ha*qa)-We*(pe*ma-Re*qa)+Va*(pe*ha-Re*ca),T[14]=-(Kt*(wn*ma-Mn*qa)-an*(pe*ma-Re*qa)+Va*(pe*Mn-Re*wn)),T[15]=Kt*(wn*ha-Mn*ca)-an*(pe*ha-Re*ca)+We*(pe*Mn-Re*wn),T}function Pn(T){var rt=T[0],Kt=T[1],pe=T[2],Re=T[3],Je=T[4],an=T[5],wn=T[6],Mn=T[7],rr=T[8],We=T[9],ca=T[10],ha=T[11],_r=T[12],Va=T[13],qa=T[14],ma=T[15],Mi=rt*an-Kt*Je,zo=rt*wn-pe*Je,_o=rt*Mn-Re*Je,Lo=Kt*wn-pe*an,yo=Kt*Mn-Re*an,No=pe*Mn-Re*wn,Vu=rr*Va-We*_r,Bu=rr*qa-ca*_r,ju=rr*ma-ha*_r,tl=We*qa-ca*Va,Hu=We*ma-ha*Va,al=ca*ma-ha*qa;return Mi*al-zo*Hu+_o*tl+Lo*ju-yo*Bu+No*Vu}function tr(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=rt[4],Mn=rt[5],rr=rt[6],We=rt[7],ca=rt[8],ha=rt[9],_r=rt[10],Va=rt[11],qa=rt[12],ma=rt[13],Mi=rt[14],zo=rt[15],_o=Kt[0],Lo=Kt[1],yo=Kt[2],No=Kt[3];return T[0]=_o*pe+Lo*wn+yo*ca+No*qa,T[1]=_o*Re+Lo*Mn+yo*ha+No*ma,T[2]=_o*Je+Lo*rr+yo*_r+No*Mi,T[3]=_o*an+Lo*We+yo*Va+No*zo,_o=Kt[4],Lo=Kt[5],yo=Kt[6],No=Kt[7],T[4]=_o*pe+Lo*wn+yo*ca+No*qa,T[5]=_o*Re+Lo*Mn+yo*ha+No*ma,T[6]=_o*Je+Lo*rr+yo*_r+No*Mi,T[7]=_o*an+Lo*We+yo*Va+No*zo,_o=Kt[8],Lo=Kt[9],yo=Kt[10],No=Kt[11],T[8]=_o*pe+Lo*wn+yo*ca+No*qa,T[9]=_o*Re+Lo*Mn+yo*ha+No*ma,T[10]=_o*Je+Lo*rr+yo*_r+No*Mi,T[11]=_o*an+Lo*We+yo*Va+No*zo,_o=Kt[12],Lo=Kt[13],yo=Kt[14],No=Kt[15],T[12]=_o*pe+Lo*wn+yo*ca+No*qa,T[13]=_o*Re+Lo*Mn+yo*ha+No*ma,T[14]=_o*Je+Lo*rr+yo*_r+No*Mi,T[15]=_o*an+Lo*We+yo*Va+No*zo,T}function zn(T,rt,Kt){var pe=Kt[0],Re=Kt[1],Je=Kt[2],an,wn,Mn,rr,We,ca,ha,_r,Va,qa,ma,Mi;return rt===T?(T[12]=rt[0]*pe+rt[4]*Re+rt[8]*Je+rt[12],T[13]=rt[1]*pe+rt[5]*Re+rt[9]*Je+rt[13],T[14]=rt[2]*pe+rt[6]*Re+rt[10]*Je+rt[14],T[15]=rt[3]*pe+rt[7]*Re+rt[11]*Je+rt[15]):(an=rt[0],wn=rt[1],Mn=rt[2],rr=rt[3],We=rt[4],ca=rt[5],ha=rt[6],_r=rt[7],Va=rt[8],qa=rt[9],ma=rt[10],Mi=rt[11],T[0]=an,T[1]=wn,T[2]=Mn,T[3]=rr,T[4]=We,T[5]=ca,T[6]=ha,T[7]=_r,T[8]=Va,T[9]=qa,T[10]=ma,T[11]=Mi,T[12]=an*pe+We*Re+Va*Je+rt[12],T[13]=wn*pe+ca*Re+qa*Je+rt[13],T[14]=Mn*pe+ha*Re+ma*Je+rt[14],T[15]=rr*pe+_r*Re+Mi*Je+rt[15]),T}function Wr(T,rt,Kt){var pe=Kt[0],Re=Kt[1],Je=Kt[2];return T[0]=rt[0]*pe,T[1]=rt[1]*pe,T[2]=rt[2]*pe,T[3]=rt[3]*pe,T[4]=rt[4]*Re,T[5]=rt[5]*Re,T[6]=rt[6]*Re,T[7]=rt[7]*Re,T[8]=rt[8]*Je,T[9]=rt[9]*Je,T[10]=rt[10]*Je,T[11]=rt[11]*Je,T[12]=rt[12],T[13]=rt[13],T[14]=rt[14],T[15]=rt[15],T}function Yr(T,rt,Kt,pe){var Re=pe[0],Je=pe[1],an=pe[2],wn=Math.hypot(Re,Je,an),Mn,rr,We,ca,ha,_r,Va,qa,ma,Mi,zo,_o,Lo,yo,No,Vu,Bu,ju,tl,Hu,al,il,ds,uu;return wn<R.EPSILON?null:(wn=1/wn,Re*=wn,Je*=wn,an*=wn,Mn=Math.sin(Kt),rr=Math.cos(Kt),We=1-rr,ca=rt[0],ha=rt[1],_r=rt[2],Va=rt[3],qa=rt[4],ma=rt[5],Mi=rt[6],zo=rt[7],_o=rt[8],Lo=rt[9],yo=rt[10],No=rt[11],Vu=Re*Re*We+rr,Bu=Je*Re*We+an*Mn,ju=an*Re*We-Je*Mn,tl=Re*Je*We-an*Mn,Hu=Je*Je*We+rr,al=an*Je*We+Re*Mn,il=Re*an*We+Je*Mn,ds=Je*an*We-Re*Mn,uu=an*an*We+rr,T[0]=ca*Vu+qa*Bu+_o*ju,T[1]=ha*Vu+ma*Bu+Lo*ju,T[2]=_r*Vu+Mi*Bu+yo*ju,T[3]=Va*Vu+zo*Bu+No*ju,T[4]=ca*tl+qa*Hu+_o*al,T[5]=ha*tl+ma*Hu+Lo*al,T[6]=_r*tl+Mi*Hu+yo*al,T[7]=Va*tl+zo*Hu+No*al,T[8]=ca*il+qa*ds+_o*uu,T[9]=ha*il+ma*ds+Lo*uu,T[10]=_r*il+Mi*ds+yo*uu,T[11]=Va*il+zo*ds+No*uu,rt!==T&&(T[12]=rt[12],T[13]=rt[13],T[14]=rt[14],T[15]=rt[15]),T)}function nr(T,rt,Kt){var pe=Math.sin(Kt),Re=Math.cos(Kt),Je=rt[4],an=rt[5],wn=rt[6],Mn=rt[7],rr=rt[8],We=rt[9],ca=rt[10],ha=rt[11];return rt!==T&&(T[0]=rt[0],T[1]=rt[1],T[2]=rt[2],T[3]=rt[3],T[12]=rt[12],T[13]=rt[13],T[14]=rt[14],T[15]=rt[15]),T[4]=Je*Re+rr*pe,T[5]=an*Re+We*pe,T[6]=wn*Re+ca*pe,T[7]=Mn*Re+ha*pe,T[8]=rr*Re-Je*pe,T[9]=We*Re-an*pe,T[10]=ca*Re-wn*pe,T[11]=ha*Re-Mn*pe,T}function wr(T,rt,Kt){var pe=Math.sin(Kt),Re=Math.cos(Kt),Je=rt[0],an=rt[1],wn=rt[2],Mn=rt[3],rr=rt[8],We=rt[9],ca=rt[10],ha=rt[11];return rt!==T&&(T[4]=rt[4],T[5]=rt[5],T[6]=rt[6],T[7]=rt[7],T[12]=rt[12],T[13]=rt[13],T[14]=rt[14],T[15]=rt[15]),T[0]=Je*Re-rr*pe,T[1]=an*Re-We*pe,T[2]=wn*Re-ca*pe,T[3]=Mn*Re-ha*pe,T[8]=Je*pe+rr*Re,T[9]=an*pe+We*Re,T[10]=wn*pe+ca*Re,T[11]=Mn*pe+ha*Re,T}function Sr(T,rt,Kt){var pe=Math.sin(Kt),Re=Math.cos(Kt),Je=rt[0],an=rt[1],wn=rt[2],Mn=rt[3],rr=rt[4],We=rt[5],ca=rt[6],ha=rt[7];return rt!==T&&(T[8]=rt[8],T[9]=rt[9],T[10]=rt[10],T[11]=rt[11],T[12]=rt[12],T[13]=rt[13],T[14]=rt[14],T[15]=rt[15]),T[0]=Je*Re+rr*pe,T[1]=an*Re+We*pe,T[2]=wn*Re+ca*pe,T[3]=Mn*Re+ha*pe,T[4]=rr*Re-Je*pe,T[5]=We*Re-an*pe,T[6]=ca*Re-wn*pe,T[7]=ha*Re-Mn*pe,T}function pr(T,rt){return T[0]=1,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=1,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=1,T[11]=0,T[12]=rt[0],T[13]=rt[1],T[14]=rt[2],T[15]=1,T}function qr(T,rt){return T[0]=rt[0],T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=rt[1],T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=rt[2],T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function ua(T,rt,Kt){var pe=Kt[0],Re=Kt[1],Je=Kt[2],an=Math.hypot(pe,Re,Je),wn,Mn,rr;return an<R.EPSILON?null:(an=1/an,pe*=an,Re*=an,Je*=an,wn=Math.sin(rt),Mn=Math.cos(rt),rr=1-Mn,T[0]=pe*pe*rr+Mn,T[1]=Re*pe*rr+Je*wn,T[2]=Je*pe*rr-Re*wn,T[3]=0,T[4]=pe*Re*rr-Je*wn,T[5]=Re*Re*rr+Mn,T[6]=Je*Re*rr+pe*wn,T[7]=0,T[8]=pe*Je*rr+Re*wn,T[9]=Re*Je*rr-pe*wn,T[10]=Je*Je*rr+Mn,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T)}function $r(T,rt){var Kt=Math.sin(rt),pe=Math.cos(rt);return T[0]=1,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=pe,T[6]=Kt,T[7]=0,T[8]=0,T[9]=-Kt,T[10]=pe,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function ba(T,rt){var Kt=Math.sin(rt),pe=Math.cos(rt);return T[0]=pe,T[1]=0,T[2]=-Kt,T[3]=0,T[4]=0,T[5]=1,T[6]=0,T[7]=0,T[8]=Kt,T[9]=0,T[10]=pe,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function gt(T,rt){var Kt=Math.sin(rt),pe=Math.cos(rt);return T[0]=pe,T[1]=Kt,T[2]=0,T[3]=0,T[4]=-Kt,T[5]=pe,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=1,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function Dn(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=pe+pe,Mn=Re+Re,rr=Je+Je,We=pe*wn,ca=pe*Mn,ha=pe*rr,_r=Re*Mn,Va=Re*rr,qa=Je*rr,ma=an*wn,Mi=an*Mn,zo=an*rr;return T[0]=1-(_r+qa),T[1]=ca+zo,T[2]=ha-Mi,T[3]=0,T[4]=ca-zo,T[5]=1-(We+qa),T[6]=Va+ma,T[7]=0,T[8]=ha+Mi,T[9]=Va-ma,T[10]=1-(We+_r),T[11]=0,T[12]=Kt[0],T[13]=Kt[1],T[14]=Kt[2],T[15]=1,T}function un(T,rt){var Kt=new R.ARRAY_TYPE(3),pe=-rt[0],Re=-rt[1],Je=-rt[2],an=rt[3],wn=rt[4],Mn=rt[5],rr=rt[6],We=rt[7],ca=pe*pe+Re*Re+Je*Je+an*an;return ca>0?(Kt[0]=(wn*an+We*pe+Mn*Je-rr*Re)*2/ca,Kt[1]=(Mn*an+We*Re+rr*pe-wn*Je)*2/ca,Kt[2]=(rr*an+We*Je+wn*Re-Mn*pe)*2/ca):(Kt[0]=(wn*an+We*pe+Mn*Je-rr*Re)*2,Kt[1]=(Mn*an+We*Re+rr*pe-wn*Je)*2,Kt[2]=(rr*an+We*Je+wn*Re-Mn*pe)*2),Dn(T,rt,Kt),T}function Lt(T,rt){return T[0]=rt[12],T[1]=rt[13],T[2]=rt[14],T}function Ot(T,rt){var Kt=rt[0],pe=rt[1],Re=rt[2],Je=rt[4],an=rt[5],wn=rt[6],Mn=rt[8],rr=rt[9],We=rt[10];return T[0]=Math.hypot(Kt,pe,Re),T[1]=Math.hypot(Je,an,wn),T[2]=Math.hypot(Mn,rr,We),T}function it(T,rt){var Kt=new R.ARRAY_TYPE(3);Ot(Kt,rt);var pe=1/Kt[0],Re=1/Kt[1],Je=1/Kt[2],an=rt[0]*pe,wn=rt[1]*Re,Mn=rt[2]*Je,rr=rt[4]*pe,We=rt[5]*Re,ca=rt[6]*Je,ha=rt[8]*pe,_r=rt[9]*Re,Va=rt[10]*Je,qa=an+We+Va,ma=0;return qa>0?(ma=Math.sqrt(qa+1)*2,T[3]=.25*ma,T[0]=(ca-_r)/ma,T[1]=(ha-Mn)/ma,T[2]=(wn-rr)/ma):an>We&&an>Va?(ma=Math.sqrt(1+an-We-Va)*2,T[3]=(ca-_r)/ma,T[0]=.25*ma,T[1]=(wn+rr)/ma,T[2]=(ha+Mn)/ma):We>Va?(ma=Math.sqrt(1+We-an-Va)*2,T[3]=(ha-Mn)/ma,T[0]=(wn+rr)/ma,T[1]=.25*ma,T[2]=(ca+_r)/ma):(ma=Math.sqrt(1+Va-an-We)*2,T[3]=(wn-rr)/ma,T[0]=(ha+Mn)/ma,T[1]=(ca+_r)/ma,T[2]=.25*ma),T}function H(T,rt,Kt,pe){var Re=rt[0],Je=rt[1],an=rt[2],wn=rt[3],Mn=Re+Re,rr=Je+Je,We=an+an,ca=Re*Mn,ha=Re*rr,_r=Re*We,Va=Je*rr,qa=Je*We,ma=an*We,Mi=wn*Mn,zo=wn*rr,_o=wn*We,Lo=pe[0],yo=pe[1],No=pe[2];return T[0]=(1-(Va+ma))*Lo,T[1]=(ha+_o)*Lo,T[2]=(_r-zo)*Lo,T[3]=0,T[4]=(ha-_o)*yo,T[5]=(1-(ca+ma))*yo,T[6]=(qa+Mi)*yo,T[7]=0,T[8]=(_r+zo)*No,T[9]=(qa-Mi)*No,T[10]=(1-(ca+Va))*No,T[11]=0,T[12]=Kt[0],T[13]=Kt[1],T[14]=Kt[2],T[15]=1,T}function X(T,rt,Kt,pe,Re){var Je=rt[0],an=rt[1],wn=rt[2],Mn=rt[3],rr=Je+Je,We=an+an,ca=wn+wn,ha=Je*rr,_r=Je*We,Va=Je*ca,qa=an*We,ma=an*ca,Mi=wn*ca,zo=Mn*rr,_o=Mn*We,Lo=Mn*ca,yo=pe[0],No=pe[1],Vu=pe[2],Bu=Re[0],ju=Re[1],tl=Re[2],Hu=(1-(qa+Mi))*yo,al=(_r+Lo)*yo,il=(Va-_o)*yo,ds=(_r-Lo)*No,uu=(1-(ha+Mi))*No,Jc=(ma+zo)*No,tf=(Va+_o)*Vu,zl=(ma-zo)*Vu,wl=(1-(ha+qa))*Vu;return T[0]=Hu,T[1]=al,T[2]=il,T[3]=0,T[4]=ds,T[5]=uu,T[6]=Jc,T[7]=0,T[8]=tf,T[9]=zl,T[10]=wl,T[11]=0,T[12]=Kt[0]+Bu-(Hu*Bu+ds*ju+tf*tl),T[13]=Kt[1]+ju-(al*Bu+uu*ju+zl*tl),T[14]=Kt[2]+tl-(il*Bu+Jc*ju+wl*tl),T[15]=1,T}function xt(T,rt){var Kt=rt[0],pe=rt[1],Re=rt[2],Je=rt[3],an=Kt+Kt,wn=pe+pe,Mn=Re+Re,rr=Kt*an,We=pe*an,ca=pe*wn,ha=Re*an,_r=Re*wn,Va=Re*Mn,qa=Je*an,ma=Je*wn,Mi=Je*Mn;return T[0]=1-ca-Va,T[1]=We+Mi,T[2]=ha-ma,T[3]=0,T[4]=We-Mi,T[5]=1-rr-Va,T[6]=_r+qa,T[7]=0,T[8]=ha+ma,T[9]=_r-qa,T[10]=1-rr-ca,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function zt(T,rt,Kt,pe,Re,Je,an){var wn=1/(Kt-rt),Mn=1/(Re-pe),rr=1/(Je-an);return T[0]=Je*2*wn,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=Je*2*Mn,T[6]=0,T[7]=0,T[8]=(Kt+rt)*wn,T[9]=(Re+pe)*Mn,T[10]=(an+Je)*rr,T[11]=-1,T[12]=0,T[13]=0,T[14]=an*Je*2*rr,T[15]=0,T}function Vt(T,rt,Kt,pe,Re){var Je=1/Math.tan(rt/2),an;return T[0]=Je/Kt,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=Je,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[11]=-1,T[12]=0,T[13]=0,T[15]=0,Re!=null&&Re!==Infinity?(an=1/(pe-Re),T[10]=(Re+pe)*an,T[14]=2*Re*pe*an):(T[10]=-1,T[14]=-2*pe),T}var Xt=Vt;function ne(T,rt,Kt,pe,Re){var Je=1/Math.tan(rt/2),an;return T[0]=Je/Kt,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=Je,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[11]=-1,T[12]=0,T[13]=0,T[15]=0,Re!=null&&Re!==Infinity?(an=1/(pe-Re),T[10]=Re*an,T[14]=Re*pe*an):(T[10]=-1,T[14]=-pe),T}function on(T,rt,Kt,pe){var Re=Math.tan(rt.upDegrees*Math.PI/180),Je=Math.tan(rt.downDegrees*Math.PI/180),an=Math.tan(rt.leftDegrees*Math.PI/180),wn=Math.tan(rt.rightDegrees*Math.PI/180),Mn=2/(an+wn),rr=2/(Re+Je);return T[0]=Mn,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=rr,T[6]=0,T[7]=0,T[8]=-((an-wn)*Mn*.5),T[9]=(Re-Je)*rr*.5,T[10]=pe/(Kt-pe),T[11]=-1,T[12]=0,T[13]=0,T[14]=pe*Kt/(Kt-pe),T[15]=0,T}function tn(T,rt,Kt,pe,Re,Je,an){var wn=1/(rt-Kt),Mn=1/(pe-Re),rr=1/(Je-an);return T[0]=-2*wn,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=-2*Mn,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=2*rr,T[11]=0,T[12]=(rt+Kt)*wn,T[13]=(Re+pe)*Mn,T[14]=(an+Je)*rr,T[15]=1,T}var He=tn;function Qn(T,rt,Kt,pe,Re,Je,an){var wn=1/(rt-Kt),Mn=1/(pe-Re),rr=1/(Je-an);return T[0]=-2*wn,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=-2*Mn,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=rr,T[11]=0,T[12]=(rt+Kt)*wn,T[13]=(Re+pe)*Mn,T[14]=Je*rr,T[15]=1,T}function Ln(T,rt,Kt,pe){var Re,Je,an,wn,Mn,rr,We,ca,ha,_r,Va=rt[0],qa=rt[1],ma=rt[2],Mi=pe[0],zo=pe[1],_o=pe[2],Lo=Kt[0],yo=Kt[1],No=Kt[2];return Math.abs(Va-Lo)<R.EPSILON&&Math.abs(qa-yo)<R.EPSILON&&Math.abs(ma-No)<R.EPSILON?Da(T):(We=Va-Lo,ca=qa-yo,ha=ma-No,_r=1/Math.hypot(We,ca,ha),We*=_r,ca*=_r,ha*=_r,Re=zo*ha-_o*ca,Je=_o*We-Mi*ha,an=Mi*ca-zo*We,_r=Math.hypot(Re,Je,an),_r?(_r=1/_r,Re*=_r,Je*=_r,an*=_r):(Re=0,Je=0,an=0),wn=ca*an-ha*Je,Mn=ha*Re-We*an,rr=We*Je-ca*Re,_r=Math.hypot(wn,Mn,rr),_r?(_r=1/_r,wn*=_r,Mn*=_r,rr*=_r):(wn=0,Mn=0,rr=0),T[0]=Re,T[1]=wn,T[2]=We,T[3]=0,T[4]=Je,T[5]=Mn,T[6]=ca,T[7]=0,T[8]=an,T[9]=rr,T[10]=ha,T[11]=0,T[12]=-(Re*Va+Je*qa+an*ma),T[13]=-(wn*Va+Mn*qa+rr*ma),T[14]=-(We*Va+ca*qa+ha*ma),T[15]=1,T)}function Qr(T,rt,Kt,pe){var Re=rt[0],Je=rt[1],an=rt[2],wn=pe[0],Mn=pe[1],rr=pe[2],We=Re-Kt[0],ca=Je-Kt[1],ha=an-Kt[2],_r=We*We+ca*ca+ha*ha;_r>0&&(_r=1/Math.sqrt(_r),We*=_r,ca*=_r,ha*=_r);var Va=Mn*ha-rr*ca,qa=rr*We-wn*ha,ma=wn*ca-Mn*We;return _r=Va*Va+qa*qa+ma*ma,_r>0&&(_r=1/Math.sqrt(_r),Va*=_r,qa*=_r,ma*=_r),T[0]=Va,T[1]=qa,T[2]=ma,T[3]=0,T[4]=ca*ma-ha*qa,T[5]=ha*Va-We*ma,T[6]=We*qa-ca*Va,T[7]=0,T[8]=We,T[9]=ca,T[10]=ha,T[11]=0,T[12]=Re,T[13]=Je,T[14]=an,T[15]=1,T}function Ia(T){return"mat4("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+", "+T[4]+", "+T[5]+", "+T[6]+", "+T[7]+", "+T[8]+", "+T[9]+", "+T[10]+", "+T[11]+", "+T[12]+", "+T[13]+", "+T[14]+", "+T[15]+")"}function Jn(T){return Math.hypot(T[0],T[1],T[2],T[3],T[4],T[5],T[6],T[7],T[8],T[9],T[10],T[11],T[12],T[13],T[14],T[15])}function Ar(T,rt,Kt){return T[0]=rt[0]+Kt[0],T[1]=rt[1]+Kt[1],T[2]=rt[2]+Kt[2],T[3]=rt[3]+Kt[3],T[4]=rt[4]+Kt[4],T[5]=rt[5]+Kt[5],T[6]=rt[6]+Kt[6],T[7]=rt[7]+Kt[7],T[8]=rt[8]+Kt[8],T[9]=rt[9]+Kt[9],T[10]=rt[10]+Kt[10],T[11]=rt[11]+Kt[11],T[12]=rt[12]+Kt[12],T[13]=rt[13]+Kt[13],T[14]=rt[14]+Kt[14],T[15]=rt[15]+Kt[15],T}function na(T,rt,Kt){return T[0]=rt[0]-Kt[0],T[1]=rt[1]-Kt[1],T[2]=rt[2]-Kt[2],T[3]=rt[3]-Kt[3],T[4]=rt[4]-Kt[4],T[5]=rt[5]-Kt[5],T[6]=rt[6]-Kt[6],T[7]=rt[7]-Kt[7],T[8]=rt[8]-Kt[8],T[9]=rt[9]-Kt[9],T[10]=rt[10]-Kt[10],T[11]=rt[11]-Kt[11],T[12]=rt[12]-Kt[12],T[13]=rt[13]-Kt[13],T[14]=rt[14]-Kt[14],T[15]=rt[15]-Kt[15],T}function za(T,rt,Kt){return T[0]=rt[0]*Kt,T[1]=rt[1]*Kt,T[2]=rt[2]*Kt,T[3]=rt[3]*Kt,T[4]=rt[4]*Kt,T[5]=rt[5]*Kt,T[6]=rt[6]*Kt,T[7]=rt[7]*Kt,T[8]=rt[8]*Kt,T[9]=rt[9]*Kt,T[10]=rt[10]*Kt,T[11]=rt[11]*Kt,T[12]=rt[12]*Kt,T[13]=rt[13]*Kt,T[14]=rt[14]*Kt,T[15]=rt[15]*Kt,T}function da(T,rt,Kt,pe){return T[0]=rt[0]+Kt[0]*pe,T[1]=rt[1]+Kt[1]*pe,T[2]=rt[2]+Kt[2]*pe,T[3]=rt[3]+Kt[3]*pe,T[4]=rt[4]+Kt[4]*pe,T[5]=rt[5]+Kt[5]*pe,T[6]=rt[6]+Kt[6]*pe,T[7]=rt[7]+Kt[7]*pe,T[8]=rt[8]+Kt[8]*pe,T[9]=rt[9]+Kt[9]*pe,T[10]=rt[10]+Kt[10]*pe,T[11]=rt[11]+Kt[11]*pe,T[12]=rt[12]+Kt[12]*pe,T[13]=rt[13]+Kt[13]*pe,T[14]=rt[14]+Kt[14]*pe,T[15]=rt[15]+Kt[15]*pe,T}function Ti(T,rt){return T[0]===rt[0]&&T[1]===rt[1]&&T[2]===rt[2]&&T[3]===rt[3]&&T[4]===rt[4]&&T[5]===rt[5]&&T[6]===rt[6]&&T[7]===rt[7]&&T[8]===rt[8]&&T[9]===rt[9]&&T[10]===rt[10]&&T[11]===rt[11]&&T[12]===rt[12]&&T[13]===rt[13]&&T[14]===rt[14]&&T[15]===rt[15]}function ki(T,rt){var Kt=T[0],pe=T[1],Re=T[2],Je=T[3],an=T[4],wn=T[5],Mn=T[6],rr=T[7],We=T[8],ca=T[9],ha=T[10],_r=T[11],Va=T[12],qa=T[13],ma=T[14],Mi=T[15],zo=rt[0],_o=rt[1],Lo=rt[2],yo=rt[3],No=rt[4],Vu=rt[5],Bu=rt[6],ju=rt[7],tl=rt[8],Hu=rt[9],al=rt[10],il=rt[11],ds=rt[12],uu=rt[13],Jc=rt[14],tf=rt[15];return Math.abs(Kt-zo)<=R.EPSILON*Math.max(1,Math.abs(Kt),Math.abs(zo))&&Math.abs(pe-_o)<=R.EPSILON*Math.max(1,Math.abs(pe),Math.abs(_o))&&Math.abs(Re-Lo)<=R.EPSILON*Math.max(1,Math.abs(Re),Math.abs(Lo))&&Math.abs(Je-yo)<=R.EPSILON*Math.max(1,Math.abs(Je),Math.abs(yo))&&Math.abs(an-No)<=R.EPSILON*Math.max(1,Math.abs(an),Math.abs(No))&&Math.abs(wn-Vu)<=R.EPSILON*Math.max(1,Math.abs(wn),Math.abs(Vu))&&Math.abs(Mn-Bu)<=R.EPSILON*Math.max(1,Math.abs(Mn),Math.abs(Bu))&&Math.abs(rr-ju)<=R.EPSILON*Math.max(1,Math.abs(rr),Math.abs(ju))&&Math.abs(We-tl)<=R.EPSILON*Math.max(1,Math.abs(We),Math.abs(tl))&&Math.abs(ca-Hu)<=R.EPSILON*Math.max(1,Math.abs(ca),Math.abs(Hu))&&Math.abs(ha-al)<=R.EPSILON*Math.max(1,Math.abs(ha),Math.abs(al))&&Math.abs(_r-il)<=R.EPSILON*Math.max(1,Math.abs(_r),Math.abs(il))&&Math.abs(Va-ds)<=R.EPSILON*Math.max(1,Math.abs(Va),Math.abs(ds))&&Math.abs(qa-uu)<=R.EPSILON*Math.max(1,Math.abs(qa),Math.abs(uu))&&Math.abs(ma-Jc)<=R.EPSILON*Math.max(1,Math.abs(ma),Math.abs(Jc))&&Math.abs(Mi-tf)<=R.EPSILON*Math.max(1,Math.abs(Mi),Math.abs(tf))}var vi=tr,ii=na,Di=$(77160);function Ra(){var T=new R.ARRAY_TYPE(4);return R.ARRAY_TYPE!=Float32Array&&(T[0]=0,T[1]=0,T[2]=0,T[3]=0),T}function ln(T){var rt=new R.ARRAY_TYPE(4);return rt[0]=T[0],rt[1]=T[1],rt[2]=T[2],rt[3]=T[3],rt}function De(T,rt,Kt,pe){var Re=new R.ARRAY_TYPE(4);return Re[0]=T,Re[1]=rt,Re[2]=Kt,Re[3]=pe,Re}function dn(T,rt){return T[0]=rt[0],T[1]=rt[1],T[2]=rt[2],T[3]=rt[3],T}function Wn(T,rt,Kt,pe,Re){return T[0]=rt,T[1]=Kt,T[2]=pe,T[3]=Re,T}function Gn(T,rt,Kt){return T[0]=rt[0]+Kt[0],T[1]=rt[1]+Kt[1],T[2]=rt[2]+Kt[2],T[3]=rt[3]+Kt[3],T}function Kn(T,rt,Kt){return T[0]=rt[0]-Kt[0],T[1]=rt[1]-Kt[1],T[2]=rt[2]-Kt[2],T[3]=rt[3]-Kt[3],T}function Rr(T,rt,Kt){return T[0]=rt[0]*Kt[0],T[1]=rt[1]*Kt[1],T[2]=rt[2]*Kt[2],T[3]=rt[3]*Kt[3],T}function xa(T,rt,Kt){return T[0]=rt[0]/Kt[0],T[1]=rt[1]/Kt[1],T[2]=rt[2]/Kt[2],T[3]=rt[3]/Kt[3],T}function La(T,rt){return T[0]=Math.ceil(rt[0]),T[1]=Math.ceil(rt[1]),T[2]=Math.ceil(rt[2]),T[3]=Math.ceil(rt[3]),T}function ui(T,rt){return T[0]=Math.floor(rt[0]),T[1]=Math.floor(rt[1]),T[2]=Math.floor(rt[2]),T[3]=Math.floor(rt[3]),T}function Fi(T,rt,Kt){return T[0]=Math.min(rt[0],Kt[0]),T[1]=Math.min(rt[1],Kt[1]),T[2]=Math.min(rt[2],Kt[2]),T[3]=Math.min(rt[3],Kt[3]),T}function Ki(T,rt,Kt){return T[0]=Math.max(rt[0],Kt[0]),T[1]=Math.max(rt[1],Kt[1]),T[2]=Math.max(rt[2],Kt[2]),T[3]=Math.max(rt[3],Kt[3]),T}function xo(T,rt){return T[0]=Math.round(rt[0]),T[1]=Math.round(rt[1]),T[2]=Math.round(rt[2]),T[3]=Math.round(rt[3]),T}function vo(T,rt,Kt){return T[0]=rt[0]*Kt,T[1]=rt[1]*Kt,T[2]=rt[2]*Kt,T[3]=rt[3]*Kt,T}function es(T,rt,Kt,pe){return T[0]=rt[0]+Kt[0]*pe,T[1]=rt[1]+Kt[1]*pe,T[2]=rt[2]+Kt[2]*pe,T[3]=rt[3]+Kt[3]*pe,T}function Wo(T,rt){var Kt=rt[0]-T[0],pe=rt[1]-T[1],Re=rt[2]-T[2],Je=rt[3]-T[3];return Math.hypot(Kt,pe,Re,Je)}function Zi(T,rt){var Kt=rt[0]-T[0],pe=rt[1]-T[1],Re=rt[2]-T[2],Je=rt[3]-T[3];return Kt*Kt+pe*pe+Re*Re+Je*Je}function bi(T){var rt=T[0],Kt=T[1],pe=T[2],Re=T[3];return Math.hypot(rt,Kt,pe,Re)}function gi(T){var rt=T[0],Kt=T[1],pe=T[2],Re=T[3];return rt*rt+Kt*Kt+pe*pe+Re*Re}function ms(T,rt){return T[0]=-rt[0],T[1]=-rt[1],T[2]=-rt[2],T[3]=-rt[3],T}function Do(T,rt){return T[0]=1/rt[0],T[1]=1/rt[1],T[2]=1/rt[2],T[3]=1/rt[3],T}function To(T,rt){var Kt=rt[0],pe=rt[1],Re=rt[2],Je=rt[3],an=Kt*Kt+pe*pe+Re*Re+Je*Je;return an>0&&(an=1/Math.sqrt(an)),T[0]=Kt*an,T[1]=pe*an,T[2]=Re*an,T[3]=Je*an,T}function Zs(T,rt){return T[0]*rt[0]+T[1]*rt[1]+T[2]*rt[2]+T[3]*rt[3]}function Eu(T,rt,Kt,pe){var Re=Kt[0]*pe[1]-Kt[1]*pe[0],Je=Kt[0]*pe[2]-Kt[2]*pe[0],an=Kt[0]*pe[3]-Kt[3]*pe[0],wn=Kt[1]*pe[2]-Kt[2]*pe[1],Mn=Kt[1]*pe[3]-Kt[3]*pe[1],rr=Kt[2]*pe[3]-Kt[3]*pe[2],We=rt[0],ca=rt[1],ha=rt[2],_r=rt[3];return T[0]=ca*rr-ha*Mn+_r*wn,T[1]=-(We*rr)+ha*an-_r*Je,T[2]=We*Mn-ca*an+_r*Re,T[3]=-(We*wn)+ca*Je-ha*Re,T}function as(T,rt,Kt,pe){var Re=rt[0],Je=rt[1],an=rt[2],wn=rt[3];return T[0]=Re+pe*(Kt[0]-Re),T[1]=Je+pe*(Kt[1]-Je),T[2]=an+pe*(Kt[2]-an),T[3]=wn+pe*(Kt[3]-wn),T}function Rs(T,rt){rt=rt||1;var Kt,pe,Re,Je,an,wn;do Kt=R.RANDOM()*2-1,pe=R.RANDOM()*2-1,an=Kt*Kt+pe*pe;while(an>=1);do Re=R.RANDOM()*2-1,Je=R.RANDOM()*2-1,wn=Re*Re+Je*Je;while(wn>=1);var Mn=Math.sqrt((1-an)/wn);return T[0]=rt*Kt,T[1]=rt*pe,T[2]=rt*Re*Mn,T[3]=rt*Je*Mn,T}function Su(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3];return T[0]=Kt[0]*pe+Kt[4]*Re+Kt[8]*Je+Kt[12]*an,T[1]=Kt[1]*pe+Kt[5]*Re+Kt[9]*Je+Kt[13]*an,T[2]=Kt[2]*pe+Kt[6]*Re+Kt[10]*Je+Kt[14]*an,T[3]=Kt[3]*pe+Kt[7]*Re+Kt[11]*Je+Kt[15]*an,T}function fu(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=Kt[0],wn=Kt[1],Mn=Kt[2],rr=Kt[3],We=rr*pe+wn*Je-Mn*Re,ca=rr*Re+Mn*pe-an*Je,ha=rr*Je+an*Re-wn*pe,_r=-an*pe-wn*Re-Mn*Je;return T[0]=We*rr+_r*-an+ca*-Mn-ha*-wn,T[1]=ca*rr+_r*-wn+ha*-an-We*-Mn,T[2]=ha*rr+_r*-Mn+We*-wn-ca*-an,T[3]=rt[3],T}function Is(T){return T[0]=0,T[1]=0,T[2]=0,T[3]=0,T}function Zo(T){return"vec4("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+")"}function Wi(T,rt){return T[0]===rt[0]&&T[1]===rt[1]&&T[2]===rt[2]&&T[3]===rt[3]}function ys(T,rt){var Kt=T[0],pe=T[1],Re=T[2],Je=T[3],an=rt[0],wn=rt[1],Mn=rt[2],rr=rt[3];return Math.abs(Kt-an)<=R.EPSILON*Math.max(1,Math.abs(Kt),Math.abs(an))&&Math.abs(pe-wn)<=R.EPSILON*Math.max(1,Math.abs(pe),Math.abs(wn))&&Math.abs(Re-Mn)<=R.EPSILON*Math.max(1,Math.abs(Re),Math.abs(Mn))&&Math.abs(Je-rr)<=R.EPSILON*Math.max(1,Math.abs(Je),Math.abs(rr))}var is=Kn,Us=Rr,Du=xa,qs=Wo,Cu=Zi,ji=bi,Bi=gi,Ms=function(){var T=Ra();return function(rt,Kt,pe,Re,Je,an){var wn,Mn;for(Kt||(Kt=4),pe||(pe=0),Re?Mn=Math.min(Re*Kt+pe,rt.length):Mn=rt.length,wn=pe;wn<Mn;wn+=Kt)T[0]=rt[wn],T[1]=rt[wn+1],T[2]=rt[wn+2],T[3]=rt[wn+3],Je(T,T,an),rt[wn]=T[0],rt[wn+1]=T[1],rt[wn+2]=T[2],rt[wn+3]=T[3];return rt}}();function os(){var T=new R.ARRAY_TYPE(4);return R.ARRAY_TYPE!=Float32Array&&(T[0]=0,T[1]=0,T[2]=0),T[3]=1,T}function Ws(T){return T[0]=0,T[1]=0,T[2]=0,T[3]=1,T}function Ss(T,rt,Kt){Kt=Kt*.5;var pe=Math.sin(Kt);return T[0]=pe*rt[0],T[1]=pe*rt[1],T[2]=pe*rt[2],T[3]=Math.cos(Kt),T}function Qs(T,rt){var Kt=Math.acos(rt[3])*2,pe=Math.sin(Kt/2);return pe>R.EPSILON?(T[0]=rt[0]/pe,T[1]=rt[1]/pe,T[2]=rt[2]/pe):(T[0]=1,T[1]=0,T[2]=0),Kt}function Qu(T,rt){var Kt=gu(T,rt);return Math.acos(2*Kt*Kt-1)}function xn(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=Kt[0],Mn=Kt[1],rr=Kt[2],We=Kt[3];return T[0]=pe*We+an*wn+Re*rr-Je*Mn,T[1]=Re*We+an*Mn+Je*wn-pe*rr,T[2]=Je*We+an*rr+pe*Mn-Re*wn,T[3]=an*We-pe*wn-Re*Mn-Je*rr,T}function Vr(T,rt,Kt){Kt*=.5;var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=Math.sin(Kt),Mn=Math.cos(Kt);return T[0]=pe*Mn+an*wn,T[1]=Re*Mn+Je*wn,T[2]=Je*Mn-Re*wn,T[3]=an*Mn-pe*wn,T}function pa(T,rt,Kt){Kt*=.5;var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=Math.sin(Kt),Mn=Math.cos(Kt);return T[0]=pe*Mn-Je*wn,T[1]=Re*Mn+an*wn,T[2]=Je*Mn+pe*wn,T[3]=an*Mn-Re*wn,T}function Fa(T,rt,Kt){Kt*=.5;var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=Math.sin(Kt),Mn=Math.cos(Kt);return T[0]=pe*Mn+Re*wn,T[1]=Re*Mn-pe*wn,T[2]=Je*Mn+an*wn,T[3]=an*Mn-Je*wn,T}function Vi(T,rt){var Kt=rt[0],pe=rt[1],Re=rt[2];return T[0]=Kt,T[1]=pe,T[2]=Re,T[3]=Math.sqrt(Math.abs(1-Kt*Kt-pe*pe-Re*Re)),T}function Ao(T,rt){var Kt=rt[0],pe=rt[1],Re=rt[2],Je=rt[3],an=Math.sqrt(Kt*Kt+pe*pe+Re*Re),wn=Math.exp(Je),Mn=an>0?wn*Math.sin(an)/an:0;return T[0]=Kt*Mn,T[1]=pe*Mn,T[2]=Re*Mn,T[3]=wn*Math.cos(an),T}function ao(T,rt){var Kt=rt[0],pe=rt[1],Re=rt[2],Je=rt[3],an=Math.sqrt(Kt*Kt+pe*pe+Re*Re),wn=an>0?Math.atan2(an,Je)/an:0;return T[0]=Kt*wn,T[1]=pe*wn,T[2]=Re*wn,T[3]=.5*Math.log(Kt*Kt+pe*pe+Re*Re+Je*Je),T}function So(T,rt,Kt){return ao(T,rt),Bs(T,T,Kt),Ao(T,T),T}function Ts(T,rt,Kt,pe){var Re=rt[0],Je=rt[1],an=rt[2],wn=rt[3],Mn=Kt[0],rr=Kt[1],We=Kt[2],ca=Kt[3],ha,_r,Va,qa,ma;return _r=Re*Mn+Je*rr+an*We+wn*ca,_r<0&&(_r=-_r,Mn=-Mn,rr=-rr,We=-We,ca=-ca),1-_r>R.EPSILON?(ha=Math.acos(_r),Va=Math.sin(ha),qa=Math.sin((1-pe)*ha)/Va,ma=Math.sin(pe*ha)/Va):(qa=1-pe,ma=pe),T[0]=qa*Re+ma*Mn,T[1]=qa*Je+ma*rr,T[2]=qa*an+ma*We,T[3]=qa*wn+ma*ca,T}function fo(T){var rt=R.RANDOM(),Kt=R.RANDOM(),pe=R.RANDOM(),Re=Math.sqrt(1-rt),Je=Math.sqrt(rt);return T[0]=Re*Math.sin(2*Math.PI*Kt),T[1]=Re*Math.cos(2*Math.PI*Kt),T[2]=Je*Math.sin(2*Math.PI*pe),T[3]=Je*Math.cos(2*Math.PI*pe),T}function ou(T,rt){var Kt=rt[0],pe=rt[1],Re=rt[2],Je=rt[3],an=Kt*Kt+pe*pe+Re*Re+Je*Je,wn=an?1/an:0;return T[0]=-Kt*wn,T[1]=-pe*wn,T[2]=-Re*wn,T[3]=Je*wn,T}function Cs(T,rt){return T[0]=-rt[0],T[1]=-rt[1],T[2]=-rt[2],T[3]=rt[3],T}function Au(T,rt){var Kt=rt[0]+rt[4]+rt[8],pe;if(Kt>0)pe=Math.sqrt(Kt+1),T[3]=.5*pe,pe=.5/pe,T[0]=(rt[5]-rt[7])*pe,T[1]=(rt[6]-rt[2])*pe,T[2]=(rt[1]-rt[3])*pe;else{var Re=0;rt[4]>rt[0]&&(Re=1),rt[8]>rt[Re*3+Re]&&(Re=2);var Je=(Re+1)%3,an=(Re+2)%3;pe=Math.sqrt(rt[Re*3+Re]-rt[Je*3+Je]-rt[an*3+an]+1),T[Re]=.5*pe,pe=.5/pe,T[3]=(rt[Je*3+an]-rt[an*3+Je])*pe,T[Je]=(rt[Je*3+Re]+rt[Re*3+Je])*pe,T[an]=(rt[an*3+Re]+rt[Re*3+an])*pe}return T}function Tl(T,rt,Kt,pe){var Re=.5*Math.PI/180;rt*=Re,Kt*=Re,pe*=Re;var Je=Math.sin(rt),an=Math.cos(rt),wn=Math.sin(Kt),Mn=Math.cos(Kt),rr=Math.sin(pe),We=Math.cos(pe);return T[0]=Je*Mn*We-an*wn*rr,T[1]=an*wn*We+Je*Mn*rr,T[2]=an*Mn*rr-Je*wn*We,T[3]=an*Mn*We+Je*wn*rr,T}function bl(T){return"quat("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+")"}var Js=ln,ul=De,Mu=dn,Pu=Wn,Nu=Gn,fs=xn,Bs=vo,gu=Zs,Fu=as,Wu=bi,Ju=Wu,tu=gi,gc=tu,Bl=To,vl=Wi,Ls=ys,el=function(){var T=Di.create(),rt=Di.fromValues(1,0,0),Kt=Di.fromValues(0,1,0);return function(pe,Re,Je){var an=Di.dot(Re,Je);return an<-.999999?(Di.cross(T,rt,Re),Di.len(T)<1e-6&&Di.cross(T,Kt,Re),Di.normalize(T,T),Ss(pe,T,Math.PI),pe):an>.999999?(pe[0]=0,pe[1]=0,pe[2]=0,pe[3]=1,pe):(Di.cross(T,Re,Je),pe[0]=T[0],pe[1]=T[1],pe[2]=T[2],pe[3]=1+an,Bl(pe,pe))}}(),oc=function(){var T=os(),rt=os();return function(Kt,pe,Re,Je,an,wn){return Ts(T,pe,an,wn),Ts(rt,Re,Je,wn),Ts(Kt,T,rt,2*wn*(1-wn)),Kt}}(),Ol=function(){var T=xr.create();return function(rt,Kt,pe,Re){return T[0]=pe[0],T[3]=pe[1],T[6]=pe[2],T[1]=Re[0],T[4]=Re[1],T[7]=Re[2],T[2]=-Kt[0],T[5]=-Kt[1],T[8]=-Kt[2],Bl(rt,Au(rt,T))}}();function Ic(){var T=new R.ARRAY_TYPE(8);return R.ARRAY_TYPE!=Float32Array&&(T[0]=0,T[1]=0,T[2]=0,T[4]=0,T[5]=0,T[6]=0,T[7]=0),T[3]=1,T}function Se(T){var rt=new R.ARRAY_TYPE(8);return rt[0]=T[0],rt[1]=T[1],rt[2]=T[2],rt[3]=T[3],rt[4]=T[4],rt[5]=T[5],rt[6]=T[6],rt[7]=T[7],rt}function ve(T,rt,Kt,pe,Re,Je,an,wn){var Mn=new R.ARRAY_TYPE(8);return Mn[0]=T,Mn[1]=rt,Mn[2]=Kt,Mn[3]=pe,Mn[4]=Re,Mn[5]=Je,Mn[6]=an,Mn[7]=wn,Mn}function Gt(T,rt,Kt,pe,Re,Je,an){var wn=new R.ARRAY_TYPE(8);wn[0]=T,wn[1]=rt,wn[2]=Kt,wn[3]=pe;var Mn=Re*.5,rr=Je*.5,We=an*.5;return wn[4]=Mn*pe+rr*Kt-We*rt,wn[5]=rr*pe+We*T-Mn*Kt,wn[6]=We*pe+Mn*rt-rr*T,wn[7]=-Mn*T-rr*rt-We*Kt,wn}function re(T,rt,Kt){var pe=Kt[0]*.5,Re=Kt[1]*.5,Je=Kt[2]*.5,an=rt[0],wn=rt[1],Mn=rt[2],rr=rt[3];return T[0]=an,T[1]=wn,T[2]=Mn,T[3]=rr,T[4]=pe*rr+Re*Mn-Je*wn,T[5]=Re*rr+Je*an-pe*Mn,T[6]=Je*rr+pe*wn-Re*an,T[7]=-pe*an-Re*wn-Je*Mn,T}function me(T,rt){return T[0]=0,T[1]=0,T[2]=0,T[3]=1,T[4]=rt[0]*.5,T[5]=rt[1]*.5,T[6]=rt[2]*.5,T[7]=0,T}function bn(T,rt){return T[0]=rt[0],T[1]=rt[1],T[2]=rt[2],T[3]=rt[3],T[4]=0,T[5]=0,T[6]=0,T[7]=0,T}function Zn(T,rt){var Kt=os();it(Kt,rt);var pe=new R.ARRAY_TYPE(3);return Lt(pe,rt),re(T,Kt,pe),T}function Yt(T,rt){return T[0]=rt[0],T[1]=rt[1],T[2]=rt[2],T[3]=rt[3],T[4]=rt[4],T[5]=rt[5],T[6]=rt[6],T[7]=rt[7],T}function Ie(T){return T[0]=0,T[1]=0,T[2]=0,T[3]=1,T[4]=0,T[5]=0,T[6]=0,T[7]=0,T}function Ge(T,rt,Kt,pe,Re,Je,an,wn,Mn){return T[0]=rt,T[1]=Kt,T[2]=pe,T[3]=Re,T[4]=Je,T[5]=an,T[6]=wn,T[7]=Mn,T}var Fe=Mu;function In(T,rt){return T[0]=rt[4],T[1]=rt[5],T[2]=rt[6],T[3]=rt[7],T}var ar=Mu;function ra(T,rt){return T[4]=rt[0],T[5]=rt[1],T[6]=rt[2],T[7]=rt[3],T}function Ta(T,rt){var Kt=rt[4],pe=rt[5],Re=rt[6],Je=rt[7],an=-rt[0],wn=-rt[1],Mn=-rt[2],rr=rt[3];return T[0]=(Kt*rr+Je*an+pe*Mn-Re*wn)*2,T[1]=(pe*rr+Je*wn+Re*an-Kt*Mn)*2,T[2]=(Re*rr+Je*Mn+Kt*wn-pe*an)*2,T}function $a(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=Kt[0]*.5,Mn=Kt[1]*.5,rr=Kt[2]*.5,We=rt[4],ca=rt[5],ha=rt[6],_r=rt[7];return T[0]=pe,T[1]=Re,T[2]=Je,T[3]=an,T[4]=an*wn+Re*rr-Je*Mn+We,T[5]=an*Mn+Je*wn-pe*rr+ca,T[6]=an*rr+pe*Mn-Re*wn+ha,T[7]=-pe*wn-Re*Mn-Je*rr+_r,T}function ja(T,rt,Kt){var pe=-rt[0],Re=-rt[1],Je=-rt[2],an=rt[3],wn=rt[4],Mn=rt[5],rr=rt[6],We=rt[7],ca=wn*an+We*pe+Mn*Je-rr*Re,ha=Mn*an+We*Re+rr*pe-wn*Je,_r=rr*an+We*Je+wn*Re-Mn*pe,Va=We*an-wn*pe-Mn*Re-rr*Je;return Vr(T,rt,Kt),pe=T[0],Re=T[1],Je=T[2],an=T[3],T[4]=ca*an+Va*pe+ha*Je-_r*Re,T[5]=ha*an+Va*Re+_r*pe-ca*Je,T[6]=_r*an+Va*Je+ca*Re-ha*pe,T[7]=Va*an-ca*pe-ha*Re-_r*Je,T}function Oa(T,rt,Kt){var pe=-rt[0],Re=-rt[1],Je=-rt[2],an=rt[3],wn=rt[4],Mn=rt[5],rr=rt[6],We=rt[7],ca=wn*an+We*pe+Mn*Je-rr*Re,ha=Mn*an+We*Re+rr*pe-wn*Je,_r=rr*an+We*Je+wn*Re-Mn*pe,Va=We*an-wn*pe-Mn*Re-rr*Je;return pa(T,rt,Kt),pe=T[0],Re=T[1],Je=T[2],an=T[3],T[4]=ca*an+Va*pe+ha*Je-_r*Re,T[5]=ha*an+Va*Re+_r*pe-ca*Je,T[6]=_r*an+Va*Je+ca*Re-ha*pe,T[7]=Va*an-ca*pe-ha*Re-_r*Je,T}function so(T,rt,Kt){var pe=-rt[0],Re=-rt[1],Je=-rt[2],an=rt[3],wn=rt[4],Mn=rt[5],rr=rt[6],We=rt[7],ca=wn*an+We*pe+Mn*Je-rr*Re,ha=Mn*an+We*Re+rr*pe-wn*Je,_r=rr*an+We*Je+wn*Re-Mn*pe,Va=We*an-wn*pe-Mn*Re-rr*Je;return Fa(T,rt,Kt),pe=T[0],Re=T[1],Je=T[2],an=T[3],T[4]=ca*an+Va*pe+ha*Je-_r*Re,T[5]=ha*an+Va*Re+_r*pe-ca*Je,T[6]=_r*an+Va*Je+ca*Re-ha*pe,T[7]=Va*an-ca*pe-ha*Re-_r*Je,T}function Ai(T,rt,Kt){var pe=Kt[0],Re=Kt[1],Je=Kt[2],an=Kt[3],wn=rt[0],Mn=rt[1],rr=rt[2],We=rt[3];return T[0]=wn*an+We*pe+Mn*Je-rr*Re,T[1]=Mn*an+We*Re+rr*pe-wn*Je,T[2]=rr*an+We*Je+wn*Re-Mn*pe,T[3]=We*an-wn*pe-Mn*Re-rr*Je,wn=rt[4],Mn=rt[5],rr=rt[6],We=rt[7],T[4]=wn*an+We*pe+Mn*Je-rr*Re,T[5]=Mn*an+We*Re+rr*pe-wn*Je,T[6]=rr*an+We*Je+wn*Re-Mn*pe,T[7]=We*an-wn*pe-Mn*Re-rr*Je,T}function Oi(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=Kt[0],Mn=Kt[1],rr=Kt[2],We=Kt[3];return T[0]=pe*We+an*wn+Re*rr-Je*Mn,T[1]=Re*We+an*Mn+Je*wn-pe*rr,T[2]=Je*We+an*rr+pe*Mn-Re*wn,T[3]=an*We-pe*wn-Re*Mn-Je*rr,wn=Kt[4],Mn=Kt[5],rr=Kt[6],We=Kt[7],T[4]=pe*We+an*wn+Re*rr-Je*Mn,T[5]=Re*We+an*Mn+Je*wn-pe*rr,T[6]=Je*We+an*rr+pe*Mn-Re*wn,T[7]=an*We-pe*wn-Re*Mn-Je*rr,T}function hs(T,rt,Kt,pe){if(Math.abs(pe)<R.EPSILON)return Yt(T,rt);var Re=Math.hypot(Kt[0],Kt[1],Kt[2]);pe=pe*.5;var Je=Math.sin(pe),an=Je*Kt[0]/Re,wn=Je*Kt[1]/Re,Mn=Je*Kt[2]/Re,rr=Math.cos(pe),We=rt[0],ca=rt[1],ha=rt[2],_r=rt[3];T[0]=We*rr+_r*an+ca*Mn-ha*wn,T[1]=ca*rr+_r*wn+ha*an-We*Mn,T[2]=ha*rr+_r*Mn+We*wn-ca*an,T[3]=_r*rr-We*an-ca*wn-ha*Mn;var Va=rt[4],qa=rt[5],ma=rt[6],Mi=rt[7];return T[4]=Va*rr+Mi*an+qa*Mn-ma*wn,T[5]=qa*rr+Mi*wn+ma*an-Va*Mn,T[6]=ma*rr+Mi*Mn+Va*wn-qa*an,T[7]=Mi*rr-Va*an-qa*wn-ma*Mn,T}function wo(T,rt,Kt){return T[0]=rt[0]+Kt[0],T[1]=rt[1]+Kt[1],T[2]=rt[2]+Kt[2],T[3]=rt[3]+Kt[3],T[4]=rt[4]+Kt[4],T[5]=rt[5]+Kt[5],T[6]=rt[6]+Kt[6],T[7]=rt[7]+Kt[7],T}function ho(T,rt,Kt){var pe=rt[0],Re=rt[1],Je=rt[2],an=rt[3],wn=Kt[4],Mn=Kt[5],rr=Kt[6],We=Kt[7],ca=rt[4],ha=rt[5],_r=rt[6],Va=rt[7],qa=Kt[0],ma=Kt[1],Mi=Kt[2],zo=Kt[3];return T[0]=pe*zo+an*qa+Re*Mi-Je*ma,T[1]=Re*zo+an*ma+Je*qa-pe*Mi,T[2]=Je*zo+an*Mi+pe*ma-Re*qa,T[3]=an*zo-pe*qa-Re*ma-Je*Mi,T[4]=pe*We+an*wn+Re*rr-Je*Mn+ca*zo+Va*qa+ha*Mi-_r*ma,T[5]=Re*We+an*Mn+Je*wn-pe*rr+ha*zo+Va*ma+_r*qa-ca*Mi,T[6]=Je*We+an*rr+pe*Mn-Re*wn+_r*zo+Va*Mi+ca*ma-ha*qa,T[7]=an*We-pe*wn-Re*Mn-Je*rr+Va*zo-ca*qa-ha*ma-_r*Mi,T}var Ro=ho;function Ys(T,rt,Kt){return T[0]=rt[0]*Kt,T[1]=rt[1]*Kt,T[2]=rt[2]*Kt,T[3]=rt[3]*Kt,T[4]=rt[4]*Kt,T[5]=rt[5]*Kt,T[6]=rt[6]*Kt,T[7]=rt[7]*Kt,T}var Ps=gu;function As(T,rt,Kt,pe){var Re=1-pe;return Ps(rt,Kt)<0&&(pe=-pe),T[0]=rt[0]*Re+Kt[0]*pe,T[1]=rt[1]*Re+Kt[1]*pe,T[2]=rt[2]*Re+Kt[2]*pe,T[3]=rt[3]*Re+Kt[3]*pe,T[4]=rt[4]*Re+Kt[4]*pe,T[5]=rt[5]*Re+Kt[5]*pe,T[6]=rt[6]*Re+Kt[6]*pe,T[7]=rt[7]*Re+Kt[7]*pe,T}function Vs(T,rt){var Kt=Ll(rt);return T[0]=-rt[0]/Kt,T[1]=-rt[1]/Kt,T[2]=-rt[2]/Kt,T[3]=rt[3]/Kt,T[4]=-rt[4]/Kt,T[5]=-rt[5]/Kt,T[6]=-rt[6]/Kt,T[7]=rt[7]/Kt,T}function su(T,rt){return T[0]=-rt[0],T[1]=-rt[1],T[2]=-rt[2],T[3]=rt[3],T[4]=-rt[4],T[5]=-rt[5],T[6]=-rt[6],T[7]=rt[7],T}var xl=Wu,Rl=xl,Ll=tu,nl=Ll;function rl(T,rt){var Kt=Ll(rt);if(Kt>0){Kt=Math.sqrt(Kt);var pe=rt[0]/Kt,Re=rt[1]/Kt,Je=rt[2]/Kt,an=rt[3]/Kt,wn=rt[4],Mn=rt[5],rr=rt[6],We=rt[7],ca=pe*wn+Re*Mn+Je*rr+an*We;T[0]=pe,T[1]=Re,T[2]=Je,T[3]=an,T[4]=(wn-pe*ca)/Kt,T[5]=(Mn-Re*ca)/Kt,T[6]=(rr-Je*ca)/Kt,T[7]=(We-an*ca)/Kt}return T}function Ef(T){return"quat2("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+", "+T[4]+", "+T[5]+", "+T[6]+", "+T[7]+")"}function Sf(T,rt){return T[0]===rt[0]&&T[1]===rt[1]&&T[2]===rt[2]&&T[3]===rt[3]&&T[4]===rt[4]&&T[5]===rt[5]&&T[6]===rt[6]&&T[7]===rt[7]}function Yl(T,rt){var Kt=T[0],pe=T[1],Re=T[2],Je=T[3],an=T[4],wn=T[5],Mn=T[6],rr=T[7],We=rt[0],ca=rt[1],ha=rt[2],_r=rt[3],Va=rt[4],qa=rt[5],ma=rt[6],Mi=rt[7];return Math.abs(Kt-We)<=R.EPSILON*Math.max(1,Math.abs(Kt),Math.abs(We))&&Math.abs(pe-ca)<=R.EPSILON*Math.max(1,Math.abs(pe),Math.abs(ca))&&Math.abs(Re-ha)<=R.EPSILON*Math.max(1,Math.abs(Re),Math.abs(ha))&&Math.abs(Je-_r)<=R.EPSILON*Math.max(1,Math.abs(Je),Math.abs(_r))&&Math.abs(an-Va)<=R.EPSILON*Math.max(1,Math.abs(an),Math.abs(Va))&&Math.abs(wn-qa)<=R.EPSILON*Math.max(1,Math.abs(wn),Math.abs(qa))&&Math.abs(Mn-ma)<=R.EPSILON*Math.max(1,Math.abs(Mn),Math.abs(ma))&&Math.abs(rr-Mi)<=R.EPSILON*Math.max(1,Math.abs(rr),Math.abs(Mi))}var Cf=$(31437)},35600:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{create:function(){return tt},fromMat4:function(){return j},clone:function(){return W},copy:function(){return Q},fromValues:function(){return Z},set:function(){return R},identity:function(){return L},transpose:function(){return C},invert:function(){return A},adjoint:function(){return N},determinant:function(){return B},multiply:function(){return O},translate:function(){return F},rotate:function(){return K},scale:function(){return nt},fromTranslation:function(){return P},fromRotation:function(){return k},fromScaling:function(){return yt},fromMat2d:function(){return st},fromQuat:function(){return lt},normalFromMat4:function(){return ht},projection:function(){return mt},str:function(){return wt},frob:function(){return ut},add:function(){return pt},subtract:function(){return Nt},multiplyScalar:function(){return Ut},multiplyScalarAndAdd:function(){return ue},exactEquals:function(){return se},equals:function(){return Le},mul:function(){return Ne},sub:function(){return we}});var Y=$(49685);function tt(){var At=new Y.ARRAY_TYPE(9);return Y.ARRAY_TYPE!=Float32Array&&(At[1]=0,At[2]=0,At[3]=0,At[5]=0,At[6]=0,At[7]=0),At[0]=1,At[4]=1,At[8]=1,At}function j(At,Qt){return At[0]=Qt[0],At[1]=Qt[1],At[2]=Qt[2],At[3]=Qt[4],At[4]=Qt[5],At[5]=Qt[6],At[6]=Qt[8],At[7]=Qt[9],At[8]=Qt[10],At}function W(At){var Qt=new Y.ARRAY_TYPE(9);return Qt[0]=At[0],Qt[1]=At[1],Qt[2]=At[2],Qt[3]=At[3],Qt[4]=At[4],Qt[5]=At[5],Qt[6]=At[6],Qt[7]=At[7],Qt[8]=At[8],Qt}function Q(At,Qt){return At[0]=Qt[0],At[1]=Qt[1],At[2]=Qt[2],At[3]=Qt[3],At[4]=Qt[4],At[5]=Qt[5],At[6]=Qt[6],At[7]=Qt[7],At[8]=Qt[8],At}function Z(At,Qt,de,rn,Ee,ce,Oe,Ze,fe){var Ae=new Y.ARRAY_TYPE(9);return Ae[0]=At,Ae[1]=Qt,Ae[2]=de,Ae[3]=rn,Ae[4]=Ee,Ae[5]=ce,Ae[6]=Oe,Ae[7]=Ze,Ae[8]=fe,Ae}function R(At,Qt,de,rn,Ee,ce,Oe,Ze,fe,Ae){return At[0]=Qt,At[1]=de,At[2]=rn,At[3]=Ee,At[4]=ce,At[5]=Oe,At[6]=Ze,At[7]=fe,At[8]=Ae,At}function L(At){return At[0]=1,At[1]=0,At[2]=0,At[3]=0,At[4]=1,At[5]=0,At[6]=0,At[7]=0,At[8]=1,At}function C(At,Qt){if(At===Qt){var de=Qt[1],rn=Qt[2],Ee=Qt[5];At[1]=Qt[3],At[2]=Qt[6],At[3]=de,At[5]=Qt[7],At[6]=rn,At[7]=Ee}else At[0]=Qt[0],At[1]=Qt[3],At[2]=Qt[6],At[3]=Qt[1],At[4]=Qt[4],At[5]=Qt[7],At[6]=Qt[2],At[7]=Qt[5],At[8]=Qt[8];return At}function A(At,Qt){var de=Qt[0],rn=Qt[1],Ee=Qt[2],ce=Qt[3],Oe=Qt[4],Ze=Qt[5],fe=Qt[6],Ae=Qt[7],Ye=Qt[8],ge=Ye*Oe-Ze*Ae,Be=-Ye*ce+Ze*fe,te=Ae*ce-Oe*fe,ke=de*ge+rn*Be+Ee*te;return ke?(ke=1/ke,At[0]=ge*ke,At[1]=(-Ye*rn+Ee*Ae)*ke,At[2]=(Ze*rn-Ee*Oe)*ke,At[3]=Be*ke,At[4]=(Ye*de-Ee*fe)*ke,At[5]=(-Ze*de+Ee*ce)*ke,At[6]=te*ke,At[7]=(-Ae*de+rn*fe)*ke,At[8]=(Oe*de-rn*ce)*ke,At):null}function N(At,Qt){var de=Qt[0],rn=Qt[1],Ee=Qt[2],ce=Qt[3],Oe=Qt[4],Ze=Qt[5],fe=Qt[6],Ae=Qt[7],Ye=Qt[8];return At[0]=Oe*Ye-Ze*Ae,At[1]=Ee*Ae-rn*Ye,At[2]=rn*Ze-Ee*Oe,At[3]=Ze*fe-ce*Ye,At[4]=de*Ye-Ee*fe,At[5]=Ee*ce-de*Ze,At[6]=ce*Ae-Oe*fe,At[7]=rn*fe-de*Ae,At[8]=de*Oe-rn*ce,At}function B(At){var Qt=At[0],de=At[1],rn=At[2],Ee=At[3],ce=At[4],Oe=At[5],Ze=At[6],fe=At[7],Ae=At[8];return Qt*(Ae*ce-Oe*fe)+de*(-Ae*Ee+Oe*Ze)+rn*(fe*Ee-ce*Ze)}function O(At,Qt,de){var rn=Qt[0],Ee=Qt[1],ce=Qt[2],Oe=Qt[3],Ze=Qt[4],fe=Qt[5],Ae=Qt[6],Ye=Qt[7],ge=Qt[8],Be=de[0],te=de[1],ke=de[2],Ve=de[3],ee=de[4],Ft=de[5],bt=de[6],Me=de[7],en=de[8];return At[0]=Be*rn+te*Oe+ke*Ae,At[1]=Be*Ee+te*Ze+ke*Ye,At[2]=Be*ce+te*fe+ke*ge,At[3]=Ve*rn+ee*Oe+Ft*Ae,At[4]=Ve*Ee+ee*Ze+Ft*Ye,At[5]=Ve*ce+ee*fe+Ft*ge,At[6]=bt*rn+Me*Oe+en*Ae,At[7]=bt*Ee+Me*Ze+en*Ye,At[8]=bt*ce+Me*fe+en*ge,At}function F(At,Qt,de){var rn=Qt[0],Ee=Qt[1],ce=Qt[2],Oe=Qt[3],Ze=Qt[4],fe=Qt[5],Ae=Qt[6],Ye=Qt[7],ge=Qt[8],Be=de[0],te=de[1];return At[0]=rn,At[1]=Ee,At[2]=ce,At[3]=Oe,At[4]=Ze,At[5]=fe,At[6]=Be*rn+te*Oe+Ae,At[7]=Be*Ee+te*Ze+Ye,At[8]=Be*ce+te*fe+ge,At}function K(At,Qt,de){var rn=Qt[0],Ee=Qt[1],ce=Qt[2],Oe=Qt[3],Ze=Qt[4],fe=Qt[5],Ae=Qt[6],Ye=Qt[7],ge=Qt[8],Be=Math.sin(de),te=Math.cos(de);return At[0]=te*rn+Be*Oe,At[1]=te*Ee+Be*Ze,At[2]=te*ce+Be*fe,At[3]=te*Oe-Be*rn,At[4]=te*Ze-Be*Ee,At[5]=te*fe-Be*ce,At[6]=Ae,At[7]=Ye,At[8]=ge,At}function nt(At,Qt,de){var rn=de[0],Ee=de[1];return At[0]=rn*Qt[0],At[1]=rn*Qt[1],At[2]=rn*Qt[2],At[3]=Ee*Qt[3],At[4]=Ee*Qt[4],At[5]=Ee*Qt[5],At[6]=Qt[6],At[7]=Qt[7],At[8]=Qt[8],At}function P(At,Qt){return At[0]=1,At[1]=0,At[2]=0,At[3]=0,At[4]=1,At[5]=0,At[6]=Qt[0],At[7]=Qt[1],At[8]=1,At}function k(At,Qt){var de=Math.sin(Qt),rn=Math.cos(Qt);return At[0]=rn,At[1]=de,At[2]=0,At[3]=-de,At[4]=rn,At[5]=0,At[6]=0,At[7]=0,At[8]=1,At}function yt(At,Qt){return At[0]=Qt[0],At[1]=0,At[2]=0,At[3]=0,At[4]=Qt[1],At[5]=0,At[6]=0,At[7]=0,At[8]=1,At}function st(At,Qt){return At[0]=Qt[0],At[1]=Qt[1],At[2]=0,At[3]=Qt[2],At[4]=Qt[3],At[5]=0,At[6]=Qt[4],At[7]=Qt[5],At[8]=1,At}function lt(At,Qt){var de=Qt[0],rn=Qt[1],Ee=Qt[2],ce=Qt[3],Oe=de+de,Ze=rn+rn,fe=Ee+Ee,Ae=de*Oe,Ye=rn*Oe,ge=rn*Ze,Be=Ee*Oe,te=Ee*Ze,ke=Ee*fe,Ve=ce*Oe,ee=ce*Ze,Ft=ce*fe;return At[0]=1-ge-ke,At[3]=Ye-Ft,At[6]=Be+ee,At[1]=Ye+Ft,At[4]=1-Ae-ke,At[7]=te-Ve,At[2]=Be-ee,At[5]=te+Ve,At[8]=1-Ae-ge,At}function ht(At,Qt){var de=Qt[0],rn=Qt[1],Ee=Qt[2],ce=Qt[3],Oe=Qt[4],Ze=Qt[5],fe=Qt[6],Ae=Qt[7],Ye=Qt[8],ge=Qt[9],Be=Qt[10],te=Qt[11],ke=Qt[12],Ve=Qt[13],ee=Qt[14],Ft=Qt[15],bt=de*Ze-rn*Oe,Me=de*fe-Ee*Oe,en=de*Ae-ce*Oe,fn=rn*fe-Ee*Ze,Rt=rn*Ae-ce*Ze,Xn=Ee*Ae-ce*fe,Bn=Ye*Ve-ge*ke,xr=Ye*ee-Be*ke,dr=Ye*Ft-te*ke,Ur=ge*ee-Be*Ve,fa=ge*Ft-te*Ve,Ea=Be*Ft-te*ee,aa=bt*Ea-Me*fa+en*Ur+fn*dr-Rt*xr+Xn*Bn;return aa?(aa=1/aa,At[0]=(Ze*Ea-fe*fa+Ae*Ur)*aa,At[1]=(fe*dr-Oe*Ea-Ae*xr)*aa,At[2]=(Oe*fa-Ze*dr+Ae*Bn)*aa,At[3]=(Ee*fa-rn*Ea-ce*Ur)*aa,At[4]=(de*Ea-Ee*dr+ce*xr)*aa,At[5]=(rn*dr-de*fa-ce*Bn)*aa,At[6]=(Ve*Xn-ee*Rt+Ft*fn)*aa,At[7]=(ee*en-ke*Xn-Ft*Me)*aa,At[8]=(ke*Rt-Ve*en+Ft*bt)*aa,At):null}function mt(At,Qt,de){return At[0]=2/Qt,At[1]=0,At[2]=0,At[3]=0,At[4]=-2/de,At[5]=0,At[6]=-1,At[7]=1,At[8]=1,At}function wt(At){return"mat3("+At[0]+", "+At[1]+", "+At[2]+", "+At[3]+", "+At[4]+", "+At[5]+", "+At[6]+", "+At[7]+", "+At[8]+")"}function ut(At){return Math.hypot(At[0],At[1],At[2],At[3],At[4],At[5],At[6],At[7],At[8])}function pt(At,Qt,de){return At[0]=Qt[0]+de[0],At[1]=Qt[1]+de[1],At[2]=Qt[2]+de[2],At[3]=Qt[3]+de[3],At[4]=Qt[4]+de[4],At[5]=Qt[5]+de[5],At[6]=Qt[6]+de[6],At[7]=Qt[7]+de[7],At[8]=Qt[8]+de[8],At}function Nt(At,Qt,de){return At[0]=Qt[0]-de[0],At[1]=Qt[1]-de[1],At[2]=Qt[2]-de[2],At[3]=Qt[3]-de[3],At[4]=Qt[4]-de[4],At[5]=Qt[5]-de[5],At[6]=Qt[6]-de[6],At[7]=Qt[7]-de[7],At[8]=Qt[8]-de[8],At}function Ut(At,Qt,de){return At[0]=Qt[0]*de,At[1]=Qt[1]*de,At[2]=Qt[2]*de,At[3]=Qt[3]*de,At[4]=Qt[4]*de,At[5]=Qt[5]*de,At[6]=Qt[6]*de,At[7]=Qt[7]*de,At[8]=Qt[8]*de,At}function ue(At,Qt,de,rn){return At[0]=Qt[0]+de[0]*rn,At[1]=Qt[1]+de[1]*rn,At[2]=Qt[2]+de[2]*rn,At[3]=Qt[3]+de[3]*rn,At[4]=Qt[4]+de[4]*rn,At[5]=Qt[5]+de[5]*rn,At[6]=Qt[6]+de[6]*rn,At[7]=Qt[7]+de[7]*rn,At[8]=Qt[8]+de[8]*rn,At}function se(At,Qt){return At[0]===Qt[0]&&At[1]===Qt[1]&&At[2]===Qt[2]&&At[3]===Qt[3]&&At[4]===Qt[4]&&At[5]===Qt[5]&&At[6]===Qt[6]&&At[7]===Qt[7]&&At[8]===Qt[8]}function Le(At,Qt){var de=At[0],rn=At[1],Ee=At[2],ce=At[3],Oe=At[4],Ze=At[5],fe=At[6],Ae=At[7],Ye=At[8],ge=Qt[0],Be=Qt[1],te=Qt[2],ke=Qt[3],Ve=Qt[4],ee=Qt[5],Ft=Qt[6],bt=Qt[7],Me=Qt[8];return Math.abs(de-ge)<=Y.EPSILON*Math.max(1,Math.abs(de),Math.abs(ge))&&Math.abs(rn-Be)<=Y.EPSILON*Math.max(1,Math.abs(rn),Math.abs(Be))&&Math.abs(Ee-te)<=Y.EPSILON*Math.max(1,Math.abs(Ee),Math.abs(te))&&Math.abs(ce-ke)<=Y.EPSILON*Math.max(1,Math.abs(ce),Math.abs(ke))&&Math.abs(Oe-Ve)<=Y.EPSILON*Math.max(1,Math.abs(Oe),Math.abs(Ve))&&Math.abs(Ze-ee)<=Y.EPSILON*Math.max(1,Math.abs(Ze),Math.abs(ee))&&Math.abs(fe-Ft)<=Y.EPSILON*Math.max(1,Math.abs(fe),Math.abs(Ft))&&Math.abs(Ae-bt)<=Y.EPSILON*Math.max(1,Math.abs(Ae),Math.abs(bt))&&Math.abs(Ye-Me)<=Y.EPSILON*Math.max(1,Math.abs(Ye),Math.abs(Me))}var Ne=O,we=Nt},31437:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{create:function(){return tt},clone:function(){return j},fromValues:function(){return W},copy:function(){return Q},set:function(){return Z},add:function(){return R},subtract:function(){return L},multiply:function(){return C},divide:function(){return A},ceil:function(){return N},floor:function(){return B},min:function(){return O},max:function(){return F},round:function(){return K},scale:function(){return nt},scaleAndAdd:function(){return P},distance:function(){return k},squaredDistance:function(){return yt},length:function(){return st},squaredLength:function(){return lt},negate:function(){return ht},inverse:function(){return mt},normalize:function(){return wt},dot:function(){return ut},cross:function(){return pt},lerp:function(){return Nt},random:function(){return Ut},transformMat2:function(){return ue},transformMat2d:function(){return se},transformMat3:function(){return Le},transformMat4:function(){return Ne},rotate:function(){return we},angle:function(){return At},zero:function(){return Qt},str:function(){return de},exactEquals:function(){return rn},equals:function(){return Ee},len:function(){return ce},sub:function(){return Oe},mul:function(){return Ze},div:function(){return fe},dist:function(){return Ae},sqrDist:function(){return Ye},sqrLen:function(){return ge},forEach:function(){return Be}});var Y=$(49685);function tt(){var te=new Y.ARRAY_TYPE(2);return Y.ARRAY_TYPE!=Float32Array&&(te[0]=0,te[1]=0),te}function j(te){var ke=new Y.ARRAY_TYPE(2);return ke[0]=te[0],ke[1]=te[1],ke}function W(te,ke){var Ve=new Y.ARRAY_TYPE(2);return Ve[0]=te,Ve[1]=ke,Ve}function Q(te,ke){return te[0]=ke[0],te[1]=ke[1],te}function Z(te,ke,Ve){return te[0]=ke,te[1]=Ve,te}function R(te,ke,Ve){return te[0]=ke[0]+Ve[0],te[1]=ke[1]+Ve[1],te}function L(te,ke,Ve){return te[0]=ke[0]-Ve[0],te[1]=ke[1]-Ve[1],te}function C(te,ke,Ve){return te[0]=ke[0]*Ve[0],te[1]=ke[1]*Ve[1],te}function A(te,ke,Ve){return te[0]=ke[0]/Ve[0],te[1]=ke[1]/Ve[1],te}function N(te,ke){return te[0]=Math.ceil(ke[0]),te[1]=Math.ceil(ke[1]),te}function B(te,ke){return te[0]=Math.floor(ke[0]),te[1]=Math.floor(ke[1]),te}function O(te,ke,Ve){return te[0]=Math.min(ke[0],Ve[0]),te[1]=Math.min(ke[1],Ve[1]),te}function F(te,ke,Ve){return te[0]=Math.max(ke[0],Ve[0]),te[1]=Math.max(ke[1],Ve[1]),te}function K(te,ke){return te[0]=Math.round(ke[0]),te[1]=Math.round(ke[1]),te}function nt(te,ke,Ve){return te[0]=ke[0]*Ve,te[1]=ke[1]*Ve,te}function P(te,ke,Ve,ee){return te[0]=ke[0]+Ve[0]*ee,te[1]=ke[1]+Ve[1]*ee,te}function k(te,ke){var Ve=ke[0]-te[0],ee=ke[1]-te[1];return Math.hypot(Ve,ee)}function yt(te,ke){var Ve=ke[0]-te[0],ee=ke[1]-te[1];return Ve*Ve+ee*ee}function st(te){var ke=te[0],Ve=te[1];return Math.hypot(ke,Ve)}function lt(te){var ke=te[0],Ve=te[1];return ke*ke+Ve*Ve}function ht(te,ke){return te[0]=-ke[0],te[1]=-ke[1],te}function mt(te,ke){return te[0]=1/ke[0],te[1]=1/ke[1],te}function wt(te,ke){var Ve=ke[0],ee=ke[1],Ft=Ve*Ve+ee*ee;return Ft>0&&(Ft=1/Math.sqrt(Ft)),te[0]=ke[0]*Ft,te[1]=ke[1]*Ft,te}function ut(te,ke){return te[0]*ke[0]+te[1]*ke[1]}function pt(te,ke,Ve){var ee=ke[0]*Ve[1]-ke[1]*Ve[0];return te[0]=te[1]=0,te[2]=ee,te}function Nt(te,ke,Ve,ee){var Ft=ke[0],bt=ke[1];return te[0]=Ft+ee*(Ve[0]-Ft),te[1]=bt+ee*(Ve[1]-bt),te}function Ut(te,ke){ke=ke||1;var Ve=Y.RANDOM()*2*Math.PI;return te[0]=Math.cos(Ve)*ke,te[1]=Math.sin(Ve)*ke,te}function ue(te,ke,Ve){var ee=ke[0],Ft=ke[1];return te[0]=Ve[0]*ee+Ve[2]*Ft,te[1]=Ve[1]*ee+Ve[3]*Ft,te}function se(te,ke,Ve){var ee=ke[0],Ft=ke[1];return te[0]=Ve[0]*ee+Ve[2]*Ft+Ve[4],te[1]=Ve[1]*ee+Ve[3]*Ft+Ve[5],te}function Le(te,ke,Ve){var ee=ke[0],Ft=ke[1];return te[0]=Ve[0]*ee+Ve[3]*Ft+Ve[6],te[1]=Ve[1]*ee+Ve[4]*Ft+Ve[7],te}function Ne(te,ke,Ve){var ee=ke[0],Ft=ke[1];return te[0]=Ve[0]*ee+Ve[4]*Ft+Ve[12],te[1]=Ve[1]*ee+Ve[5]*Ft+Ve[13],te}function we(te,ke,Ve,ee){var Ft=ke[0]-Ve[0],bt=ke[1]-Ve[1],Me=Math.sin(ee),en=Math.cos(ee);return te[0]=Ft*en-bt*Me+Ve[0],te[1]=Ft*Me+bt*en+Ve[1],te}function At(te,ke){var Ve=te[0],ee=te[1],Ft=ke[0],bt=ke[1],Me=Math.sqrt(Ve*Ve+ee*ee)*Math.sqrt(Ft*Ft+bt*bt),en=Me&&(Ve*Ft+ee*bt)/Me;return Math.acos(Math.min(Math.max(en,-1),1))}function Qt(te){return te[0]=0,te[1]=0,te}function de(te){return"vec2("+te[0]+", "+te[1]+")"}function rn(te,ke){return te[0]===ke[0]&&te[1]===ke[1]}function Ee(te,ke){var Ve=te[0],ee=te[1],Ft=ke[0],bt=ke[1];return Math.abs(Ve-Ft)<=Y.EPSILON*Math.max(1,Math.abs(Ve),Math.abs(Ft))&&Math.abs(ee-bt)<=Y.EPSILON*Math.max(1,Math.abs(ee),Math.abs(bt))}var ce=st,Oe=L,Ze=C,fe=A,Ae=k,Ye=yt,ge=lt,Be=function(){var te=tt();return function(ke,Ve,ee,Ft,bt,Me){var en,fn;for(Ve||(Ve=2),ee||(ee=0),Ft?fn=Math.min(Ft*Ve+ee,ke.length):fn=ke.length,en=ee;en<fn;en+=Ve)te[0]=ke[en],te[1]=ke[en+1],bt(te,te,Me),ke[en]=te[0],ke[en+1]=te[1];return ke}}()},77160:function(ur,ot,$){"use strict";$.r(ot),$.d(ot,{create:function(){return tt},clone:function(){return j},length:function(){return W},fromValues:function(){return Q},copy:function(){return Z},set:function(){return R},add:function(){return L},subtract:function(){return C},multiply:function(){return A},divide:function(){return N},ceil:function(){return B},floor:function(){return O},min:function(){return F},max:function(){return K},round:function(){return nt},scale:function(){return P},scaleAndAdd:function(){return k},distance:function(){return yt},squaredDistance:function(){return st},squaredLength:function(){return lt},negate:function(){return ht},inverse:function(){return mt},normalize:function(){return wt},dot:function(){return ut},cross:function(){return pt},lerp:function(){return Nt},hermite:function(){return Ut},bezier:function(){return ue},random:function(){return se},transformMat4:function(){return Le},transformMat3:function(){return Ne},transformQuat:function(){return we},rotateX:function(){return At},rotateY:function(){return Qt},rotateZ:function(){return de},angle:function(){return rn},zero:function(){return Ee},str:function(){return ce},exactEquals:function(){return Oe},equals:function(){return Ze},sub:function(){return fe},mul:function(){return Ae},div:function(){return Ye},dist:function(){return ge},sqrDist:function(){return Be},len:function(){return te},sqrLen:function(){return ke},forEach:function(){return Ve}});var Y=$(49685);function tt(){var ee=new Y.ARRAY_TYPE(3);return Y.ARRAY_TYPE!=Float32Array&&(ee[0]=0,ee[1]=0,ee[2]=0),ee}function j(ee){var Ft=new Y.ARRAY_TYPE(3);return Ft[0]=ee[0],Ft[1]=ee[1],Ft[2]=ee[2],Ft}function W(ee){var Ft=ee[0],bt=ee[1],Me=ee[2];return Math.hypot(Ft,bt,Me)}function Q(ee,Ft,bt){var Me=new Y.ARRAY_TYPE(3);return Me[0]=ee,Me[1]=Ft,Me[2]=bt,Me}function Z(ee,Ft){return ee[0]=Ft[0],ee[1]=Ft[1],ee[2]=Ft[2],ee}function R(ee,Ft,bt,Me){return ee[0]=Ft,ee[1]=bt,ee[2]=Me,ee}function L(ee,Ft,bt){return ee[0]=Ft[0]+bt[0],ee[1]=Ft[1]+bt[1],ee[2]=Ft[2]+bt[2],ee}function C(ee,Ft,bt){return ee[0]=Ft[0]-bt[0],ee[1]=Ft[1]-bt[1],ee[2]=Ft[2]-bt[2],ee}function A(ee,Ft,bt){return ee[0]=Ft[0]*bt[0],ee[1]=Ft[1]*bt[1],ee[2]=Ft[2]*bt[2],ee}function N(ee,Ft,bt){return ee[0]=Ft[0]/bt[0],ee[1]=Ft[1]/bt[1],ee[2]=Ft[2]/bt[2],ee}function B(ee,Ft){return ee[0]=Math.ceil(Ft[0]),ee[1]=Math.ceil(Ft[1]),ee[2]=Math.ceil(Ft[2]),ee}function O(ee,Ft){return ee[0]=Math.floor(Ft[0]),ee[1]=Math.floor(Ft[1]),ee[2]=Math.floor(Ft[2]),ee}function F(ee,Ft,bt){return ee[0]=Math.min(Ft[0],bt[0]),ee[1]=Math.min(Ft[1],bt[1]),ee[2]=Math.min(Ft[2],bt[2]),ee}function K(ee,Ft,bt){return ee[0]=Math.max(Ft[0],bt[0]),ee[1]=Math.max(Ft[1],bt[1]),ee[2]=Math.max(Ft[2],bt[2]),ee}function nt(ee,Ft){return ee[0]=Math.round(Ft[0]),ee[1]=Math.round(Ft[1]),ee[2]=Math.round(Ft[2]),ee}function P(ee,Ft,bt){return ee[0]=Ft[0]*bt,ee[1]=Ft[1]*bt,ee[2]=Ft[2]*bt,ee}function k(ee,Ft,bt,Me){return ee[0]=Ft[0]+bt[0]*Me,ee[1]=Ft[1]+bt[1]*Me,ee[2]=Ft[2]+bt[2]*Me,ee}function yt(ee,Ft){var bt=Ft[0]-ee[0],Me=Ft[1]-ee[1],en=Ft[2]-ee[2];return Math.hypot(bt,Me,en)}function st(ee,Ft){var bt=Ft[0]-ee[0],Me=Ft[1]-ee[1],en=Ft[2]-ee[2];return bt*bt+Me*Me+en*en}function lt(ee){var Ft=ee[0],bt=ee[1],Me=ee[2];return Ft*Ft+bt*bt+Me*Me}function ht(ee,Ft){return ee[0]=-Ft[0],ee[1]=-Ft[1],ee[2]=-Ft[2],ee}function mt(ee,Ft){return ee[0]=1/Ft[0],ee[1]=1/Ft[1],ee[2]=1/Ft[2],ee}function wt(ee,Ft){var bt=Ft[0],Me=Ft[1],en=Ft[2],fn=bt*bt+Me*Me+en*en;return fn>0&&(fn=1/Math.sqrt(fn)),ee[0]=Ft[0]*fn,ee[1]=Ft[1]*fn,ee[2]=Ft[2]*fn,ee}function ut(ee,Ft){return ee[0]*Ft[0]+ee[1]*Ft[1]+ee[2]*Ft[2]}function pt(ee,Ft,bt){var Me=Ft[0],en=Ft[1],fn=Ft[2],Rt=bt[0],Xn=bt[1],Bn=bt[2];return ee[0]=en*Bn-fn*Xn,ee[1]=fn*Rt-Me*Bn,ee[2]=Me*Xn-en*Rt,ee}function Nt(ee,Ft,bt,Me){var en=Ft[0],fn=Ft[1],Rt=Ft[2];return ee[0]=en+Me*(bt[0]-en),ee[1]=fn+Me*(bt[1]-fn),ee[2]=Rt+Me*(bt[2]-Rt),ee}function Ut(ee,Ft,bt,Me,en,fn){var Rt=fn*fn,Xn=Rt*(2*fn-3)+1,Bn=Rt*(fn-2)+fn,xr=Rt*(fn-1),dr=Rt*(3-2*fn);return ee[0]=Ft[0]*Xn+bt[0]*Bn+Me[0]*xr+en[0]*dr,ee[1]=Ft[1]*Xn+bt[1]*Bn+Me[1]*xr+en[1]*dr,ee[2]=Ft[2]*Xn+bt[2]*Bn+Me[2]*xr+en[2]*dr,ee}function ue(ee,Ft,bt,Me,en,fn){var Rt=1-fn,Xn=Rt*Rt,Bn=fn*fn,xr=Xn*Rt,dr=3*fn*Xn,Ur=3*Bn*Rt,fa=Bn*fn;return ee[0]=Ft[0]*xr+bt[0]*dr+Me[0]*Ur+en[0]*fa,ee[1]=Ft[1]*xr+bt[1]*dr+Me[1]*Ur+en[1]*fa,ee[2]=Ft[2]*xr+bt[2]*dr+Me[2]*Ur+en[2]*fa,ee}function se(ee,Ft){Ft=Ft||1;var bt=Y.RANDOM()*2*Math.PI,Me=Y.RANDOM()*2-1,en=Math.sqrt(1-Me*Me)*Ft;return ee[0]=Math.cos(bt)*en,ee[1]=Math.sin(bt)*en,ee[2]=Me*Ft,ee}function Le(ee,Ft,bt){var Me=Ft[0],en=Ft[1],fn=Ft[2],Rt=bt[3]*Me+bt[7]*en+bt[11]*fn+bt[15];return Rt=Rt||1,ee[0]=(bt[0]*Me+bt[4]*en+bt[8]*fn+bt[12])/Rt,ee[1]=(bt[1]*Me+bt[5]*en+bt[9]*fn+bt[13])/Rt,ee[2]=(bt[2]*Me+bt[6]*en+bt[10]*fn+bt[14])/Rt,ee}function Ne(ee,Ft,bt){var Me=Ft[0],en=Ft[1],fn=Ft[2];return ee[0]=Me*bt[0]+en*bt[3]+fn*bt[6],ee[1]=Me*bt[1]+en*bt[4]+fn*bt[7],ee[2]=Me*bt[2]+en*bt[5]+fn*bt[8],ee}function we(ee,Ft,bt){var Me=bt[0],en=bt[1],fn=bt[2],Rt=bt[3],Xn=Ft[0],Bn=Ft[1],xr=Ft[2],dr=en*xr-fn*Bn,Ur=fn*Xn-Me*xr,fa=Me*Bn-en*Xn,Ea=en*fa-fn*Ur,aa=fn*dr-Me*fa,Da=Me*Ur-en*dr,Lr=Rt*2;return dr*=Lr,Ur*=Lr,fa*=Lr,Ea*=2,aa*=2,Da*=2,ee[0]=Xn+dr+Ea,ee[1]=Bn+Ur+aa,ee[2]=xr+fa+Da,ee}function At(ee,Ft,bt,Me){var en=[],fn=[];return en[0]=Ft[0]-bt[0],en[1]=Ft[1]-bt[1],en[2]=Ft[2]-bt[2],fn[0]=en[0],fn[1]=en[1]*Math.cos(Me)-en[2]*Math.sin(Me),fn[2]=en[1]*Math.sin(Me)+en[2]*Math.cos(Me),ee[0]=fn[0]+bt[0],ee[1]=fn[1]+bt[1],ee[2]=fn[2]+bt[2],ee}function Qt(ee,Ft,bt,Me){var en=[],fn=[];return en[0]=Ft[0]-bt[0],en[1]=Ft[1]-bt[1],en[2]=Ft[2]-bt[2],fn[0]=en[2]*Math.sin(Me)+en[0]*Math.cos(Me),fn[1]=en[1],fn[2]=en[2]*Math.cos(Me)-en[0]*Math.sin(Me),ee[0]=fn[0]+bt[0],ee[1]=fn[1]+bt[1],ee[2]=fn[2]+bt[2],ee}function de(ee,Ft,bt,Me){var en=[],fn=[];return en[0]=Ft[0]-bt[0],en[1]=Ft[1]-bt[1],en[2]=Ft[2]-bt[2],fn[0]=en[0]*Math.cos(Me)-en[1]*Math.sin(Me),fn[1]=en[0]*Math.sin(Me)+en[1]*Math.cos(Me),fn[2]=en[2],ee[0]=fn[0]+bt[0],ee[1]=fn[1]+bt[1],ee[2]=fn[2]+bt[2],ee}function rn(ee,Ft){var bt=ee[0],Me=ee[1],en=ee[2],fn=Ft[0],Rt=Ft[1],Xn=Ft[2],Bn=Math.sqrt(bt*bt+Me*Me+en*en),xr=Math.sqrt(fn*fn+Rt*Rt+Xn*Xn),dr=Bn*xr,Ur=dr&&ut(ee,Ft)/dr;return Math.acos(Math.min(Math.max(Ur,-1),1))}function Ee(ee){return ee[0]=0,ee[1]=0,ee[2]=0,ee}function ce(ee){return"vec3("+ee[0]+", "+ee[1]+", "+ee[2]+")"}function Oe(ee,Ft){return ee[0]===Ft[0]&&ee[1]===Ft[1]&&ee[2]===Ft[2]}function Ze(ee,Ft){var bt=ee[0],Me=ee[1],en=ee[2],fn=Ft[0],Rt=Ft[1],Xn=Ft[2];return Math.abs(bt-fn)<=Y.EPSILON*Math.max(1,Math.abs(bt),Math.abs(fn))&&Math.abs(Me-Rt)<=Y.EPSILON*Math.max(1,Math.abs(Me),Math.abs(Rt))&&Math.abs(en-Xn)<=Y.EPSILON*Math.max(1,Math.abs(en),Math.abs(Xn))}var fe=C,Ae=A,Ye=N,ge=yt,Be=st,te=W,ke=lt,Ve=function(){var ee=tt();return function(Ft,bt,Me,en,fn,Rt){var Xn,Bn;for(bt||(bt=3),Me||(Me=0),en?Bn=Math.min(en*bt+Me,Ft.length):Bn=Ft.length,Xn=Me;Xn<Bn;Xn+=bt)ee[0]=Ft[Xn],ee[1]=Ft[Xn+1],ee[2]=Ft[Xn+2],fn(ee,ee,Rt),Ft[Xn]=ee[0],Ft[Xn+1]=ee[1],Ft[Xn+2]=ee[2];return Ft}}()},38186:function(ur){var ot=[],$=[],Y="insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).";function tt(W,Q){if(Q=Q||{},W===void 0)throw new Error(Y);var Z=Q.prepend===!0?"prepend":"append",R=Q.container!==void 0?Q.container:document.querySelector("head"),L=ot.indexOf(R);L===-1&&(L=ot.push(R)-1,$[L]={});var C;return $[L]!==void 0&&$[L][Z]!==void 0?C=$[L][Z]:(C=$[L][Z]=j(),Z==="prepend"?R.insertBefore(C,R.childNodes[0]):R.appendChild(C)),W.charCodeAt(0)===65279&&(W=W.substr(1,W.length)),C.styleSheet?C.styleSheet.cssText+=W:C.textContent+=W,C}function j(){var W=document.createElement("style");return W.setAttribute("type","text/css"),W}ur.exports=tt,ur.exports.insertCss=tt},47443:function(ur,ot,$){var Y=$(42118);function tt(j,W){var Q=j==null?0:j.length;return!!Q&&Y(j,W,0)>-1}ur.exports=tt},1196:function(ur){function ot($,Y,tt){for(var j=-1,W=$==null?0:$.length;++j<W;)if(tt(Y,$[j]))return!0;return!1}ur.exports=ot},20731:function(ur,ot,$){var Y=$(88668),tt=$(47443),j=$(1196),W=$(29932),Q=$(7518),Z=$(74757),R=200;function L(C,A,N,B){var O=-1,F=tt,K=!0,nt=C.length,P=[],k=A.length;if(!nt)return P;N&&(A=W(A,Q(N))),B?(F=j,K=!1):A.length>=R&&(F=Z,K=!1,A=new Y(A));t:for(;++O<nt;){var yt=C[O],st=N==null?yt:N(yt);if(yt=B||yt!==0?yt:0,K&&st===st){for(var lt=k;lt--;)if(A[lt]===st)continue t;P.push(yt)}else F(A,st,B)||P.push(yt)}return P}ur.exports=L},41848:function(ur){function ot($,Y,tt,j){for(var W=$.length,Q=tt+(j?1:-1);j?Q--:++Q<W;)if(Y($[Q],Q,$))return Q;return-1}ur.exports=ot},21078:function(ur,ot,$){var Y=$(62488),tt=$(75708);function j(W,Q,Z,R,L){var C=-1,A=W.length;for(Z||(Z=tt),L||(L=[]);++C<A;){var N=W[C];Q>0&&Z(N)?Q>1?j(N,Q-1,Z,R,L):Y(L,N):R||(L[L.length]=N)}return L}ur.exports=j},42118:function(ur,ot,$){var Y=$(41848),tt=$(62722),j=$(42351);function W(Q,Z,R){return Z===Z?j(Q,Z,R):Y(Q,tt,R)}ur.exports=W},62722:function(ur){function ot($){return $!==$}ur.exports=ot},75708:function(ur,ot,$){var Y=$(62705),tt=$(35694),j=$(1469),W=Y?Y.isConcatSpreadable:void 0;function Q(Z){return j(Z)||tt(Z)||!!(W&&Z&&Z[W])}ur.exports=Q},42351:function(ur){function ot($,Y,tt){for(var j=tt-1,W=$.length;++j<W;)if($[j]===Y)return j;return-1}ur.exports=ot},91966:function(ur,ot,$){var Y=$(20731),tt=$(21078),j=$(5976),W=$(29246),Q=j(function(Z,R){return W(Z)?Y(Z,tt(R,1,W,!0)):[]});ur.exports=Q},81763:function(ur,ot,$){var Y=$(44239),tt=$(37005),j="[object Number]";function W(Q){return typeof Q=="number"||tt(Q)&&Y(Q)==j}ur.exports=W},57460:function(ur,ot){var $,Y,tt;/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(j,W){Y=[],$=W,tt=typeof $=="function"?$.apply(ot,Y):$,tt!==void 0&&(ur.exports=tt)})(this,function j(){"use strict";var W=typeof self!="undefined"?self:typeof window!="undefined"?window:W!==void 0?W:{},Q=!W.document&&!!W.postMessage,Z=W.IS_PAPA_WORKER||!1,R={},L=0,C={parse:function(ut,pt){var Nt=(pt=pt||{}).dynamicTyping||!1;if(wt(Nt)&&(pt.dynamicTypingFunction=Nt,Nt={}),pt.dynamicTyping=Nt,pt.transform=!!wt(pt.transform)&&pt.transform,pt.worker&&C.WORKERS_SUPPORTED){var Ut=function(){if(!C.WORKERS_SUPPORTED)return!1;var se=(Ne=W.URL||W.webkitURL||null,we=j.toString(),C.BLOB_URL||(C.BLOB_URL=Ne.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",we,")();"],{type:"text/javascript"})))),Le=new W.Worker(se),Ne,we;return Le.onmessage=yt,Le.id=L++,R[Le.id]=Le}();return Ut.userStep=pt.step,Ut.userChunk=pt.chunk,Ut.userComplete=pt.complete,Ut.userError=pt.error,pt.step=wt(pt.step),pt.chunk=wt(pt.chunk),pt.complete=wt(pt.complete),pt.error=wt(pt.error),delete pt.worker,void Ut.postMessage({input:ut,config:pt,workerId:Ut.id})}var ue=null;return C.NODE_STREAM_INPUT,typeof ut=="string"?(ut=function(se){return se.charCodeAt(0)===65279?se.slice(1):se}(ut),ue=pt.download?new B(pt):new F(pt)):ut.readable===!0&&wt(ut.read)&&wt(ut.on)?ue=new K(pt):(W.File&&ut instanceof File||ut instanceof Object)&&(ue=new O(pt)),ue.stream(ut)},unparse:function(ut,pt){var Nt=!1,Ut=!0,ue=",",se=`\r
`,Le='"',Ne=Le+Le,we=!1,At=null,Qt=!1;(function(){if(typeof pt=="object"){if(typeof pt.delimiter!="string"||C.BAD_DELIMITERS.filter(function(ce){return pt.delimiter.indexOf(ce)!==-1}).length||(ue=pt.delimiter),(typeof pt.quotes=="boolean"||typeof pt.quotes=="function"||Array.isArray(pt.quotes))&&(Nt=pt.quotes),typeof pt.skipEmptyLines!="boolean"&&typeof pt.skipEmptyLines!="string"||(we=pt.skipEmptyLines),typeof pt.newline=="string"&&(se=pt.newline),typeof pt.quoteChar=="string"&&(Le=pt.quoteChar),typeof pt.header=="boolean"&&(Ut=pt.header),Array.isArray(pt.columns)){if(pt.columns.length===0)throw new Error("Option columns is empty");At=pt.columns}pt.escapeChar!==void 0&&(Ne=pt.escapeChar+Le),(typeof pt.escapeFormulae=="boolean"||pt.escapeFormulae instanceof RegExp)&&(Qt=pt.escapeFormulae instanceof RegExp?pt.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var de=new RegExp(P(Le),"g");if(typeof ut=="string"&&(ut=JSON.parse(ut)),Array.isArray(ut)){if(!ut.length||Array.isArray(ut[0]))return rn(null,ut,we);if(typeof ut[0]=="object")return rn(At||Object.keys(ut[0]),ut,we)}else if(typeof ut=="object")return typeof ut.data=="string"&&(ut.data=JSON.parse(ut.data)),Array.isArray(ut.data)&&(ut.fields||(ut.fields=ut.meta&&ut.meta.fields||At),ut.fields||(ut.fields=Array.isArray(ut.data[0])?ut.fields:typeof ut.data[0]=="object"?Object.keys(ut.data[0]):[]),Array.isArray(ut.data[0])||typeof ut.data[0]=="object"||(ut.data=[ut.data])),rn(ut.fields||[],ut.data||[],we);throw new Error("Unable to serialize unrecognized input");function rn(ce,Oe,Ze){var fe="";typeof ce=="string"&&(ce=JSON.parse(ce)),typeof Oe=="string"&&(Oe=JSON.parse(Oe));var Ae=Array.isArray(ce)&&0<ce.length,Ye=!Array.isArray(Oe[0]);if(Ae&&Ut){for(var ge=0;ge<ce.length;ge++)0<ge&&(fe+=ue),fe+=Ee(ce[ge],ge);0<Oe.length&&(fe+=se)}for(var Be=0;Be<Oe.length;Be++){var te=Ae?ce.length:Oe[Be].length,ke=!1,Ve=Ae?Object.keys(Oe[Be]).length===0:Oe[Be].length===0;if(Ze&&!Ae&&(ke=Ze==="greedy"?Oe[Be].join("").trim()==="":Oe[Be].length===1&&Oe[Be][0].length===0),Ze==="greedy"&&Ae){for(var ee=[],Ft=0;Ft<te;Ft++){var bt=Ye?ce[Ft]:Ft;ee.push(Oe[Be][bt])}ke=ee.join("").trim()===""}if(!ke){for(var Me=0;Me<te;Me++){0<Me&&!Ve&&(fe+=ue);var en=Ae&&Ye?ce[Me]:Me;fe+=Ee(Oe[Be][en],Me)}Be<Oe.length-1&&(!Ze||0<te&&!Ve)&&(fe+=se)}}return fe}function Ee(ce,Oe){if(ce==null)return"";if(ce.constructor===Date)return JSON.stringify(ce).slice(1,25);var Ze=!1;Qt&&typeof ce=="string"&&Qt.test(ce)&&(ce="'"+ce,Ze=!0);var fe=ce.toString().replace(de,Ne);return(Ze=Ze||Nt===!0||typeof Nt=="function"&&Nt(ce,Oe)||Array.isArray(Nt)&&Nt[Oe]||function(Ae,Ye){for(var ge=0;ge<Ye.length;ge++)if(-1<Ae.indexOf(Ye[ge]))return!0;return!1}(fe,C.BAD_DELIMITERS)||-1<fe.indexOf(ue)||fe.charAt(0)===" "||fe.charAt(fe.length-1)===" ")?Le+fe+Le:fe}}};if(C.RECORD_SEP=String.fromCharCode(30),C.UNIT_SEP=String.fromCharCode(31),C.BYTE_ORDER_MARK="\uFEFF",C.BAD_DELIMITERS=["\r",`
`,'"',C.BYTE_ORDER_MARK],C.WORKERS_SUPPORTED=!Q&&!!W.Worker,C.NODE_STREAM_INPUT=1,C.LocalChunkSize=10485760,C.RemoteChunkSize=5242880,C.DefaultDelimiter=",",C.Parser=k,C.ParserHandle=nt,C.NetworkStreamer=B,C.FileStreamer=O,C.StringStreamer=F,C.ReadableStreamStreamer=K,W.jQuery){var A=W.jQuery;A.fn.parse=function(ut){var pt=ut.config||{},Nt=[];return this.each(function(se){if(!(A(this).prop("tagName").toUpperCase()==="INPUT"&&A(this).attr("type").toLowerCase()==="file"&&W.FileReader)||!this.files||this.files.length===0)return!0;for(var Le=0;Le<this.files.length;Le++)Nt.push({file:this.files[Le],inputElem:this,instanceConfig:A.extend({},pt)})}),Ut(),this;function Ut(){if(Nt.length!==0){var se,Le,Ne,we,At=Nt[0];if(wt(ut.before)){var Qt=ut.before(At.file,At.inputElem);if(typeof Qt=="object"){if(Qt.action==="abort")return se="AbortError",Le=At.file,Ne=At.inputElem,we=Qt.reason,void(wt(ut.error)&&ut.error({name:se},Le,Ne,we));if(Qt.action==="skip")return void ue();typeof Qt.config=="object"&&(At.instanceConfig=A.extend(At.instanceConfig,Qt.config))}else if(Qt==="skip")return void ue()}var de=At.instanceConfig.complete;At.instanceConfig.complete=function(rn){wt(de)&&de(rn,At.file,At.inputElem),ue()},C.parse(At.file,At.instanceConfig)}else wt(ut.complete)&&ut.complete()}function ue(){Nt.splice(0,1),Ut()}}}function N(ut){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(pt){var Nt=ht(pt);Nt.chunkSize=parseInt(Nt.chunkSize),pt.step||pt.chunk||(Nt.chunkSize=null),this._handle=new nt(Nt),(this._handle.streamer=this)._config=Nt}.call(this,ut),this.parseChunk=function(pt,Nt){if(this.isFirstChunk&&wt(this._config.beforeFirstChunk)){var Ut=this._config.beforeFirstChunk(pt);Ut!==void 0&&(pt=Ut)}this.isFirstChunk=!1,this._halted=!1;var ue=this._partialLine+pt;this._partialLine="";var se=this._handle.parse(ue,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var Le=se.meta.cursor;this._finished||(this._partialLine=ue.substring(Le-this._baseIndex),this._baseIndex=Le),se&&se.data&&(this._rowCount+=se.data.length);var Ne=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(Z)W.postMessage({results:se,workerId:C.WORKER_ID,finished:Ne});else if(wt(this._config.chunk)&&!Nt){if(this._config.chunk(se,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);se=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(se.data),this._completeResults.errors=this._completeResults.errors.concat(se.errors),this._completeResults.meta=se.meta),this._completed||!Ne||!wt(this._config.complete)||se&&se.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),Ne||se&&se.meta.paused||this._nextChunk(),se}this._halted=!0},this._sendError=function(pt){wt(this._config.error)?this._config.error(pt):Z&&this._config.error&&W.postMessage({workerId:C.WORKER_ID,error:pt,finished:!1})}}function B(ut){var pt;(ut=ut||{}).chunkSize||(ut.chunkSize=C.RemoteChunkSize),N.call(this,ut),this._nextChunk=Q?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(Nt){this._input=Nt,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(pt=new XMLHttpRequest,this._config.withCredentials&&(pt.withCredentials=this._config.withCredentials),Q||(pt.onload=mt(this._chunkLoaded,this),pt.onerror=mt(this._chunkError,this)),pt.open(this._config.downloadRequestBody?"POST":"GET",this._input,!Q),this._config.downloadRequestHeaders){var Nt=this._config.downloadRequestHeaders;for(var Ut in Nt)pt.setRequestHeader(Ut,Nt[Ut])}if(this._config.chunkSize){var ue=this._start+this._config.chunkSize-1;pt.setRequestHeader("Range","bytes="+this._start+"-"+ue)}try{pt.send(this._config.downloadRequestBody)}catch(se){this._chunkError(se.message)}Q&&pt.status===0&&this._chunkError()}},this._chunkLoaded=function(){pt.readyState===4&&(pt.status<200||400<=pt.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:pt.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(Nt){var Ut=Nt.getResponseHeader("Content-Range");return Ut===null?-1:parseInt(Ut.substring(Ut.lastIndexOf("/")+1))}(pt),this.parseChunk(pt.responseText)))},this._chunkError=function(Nt){var Ut=pt.statusText||Nt;this._sendError(new Error(Ut))}}function O(ut){var pt,Nt;(ut=ut||{}).chunkSize||(ut.chunkSize=C.LocalChunkSize),N.call(this,ut);var Ut=typeof FileReader!="undefined";this.stream=function(ue){this._input=ue,Nt=ue.slice||ue.webkitSlice||ue.mozSlice,Ut?((pt=new FileReader).onload=mt(this._chunkLoaded,this),pt.onerror=mt(this._chunkError,this)):pt=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var ue=this._input;if(this._config.chunkSize){var se=Math.min(this._start+this._config.chunkSize,this._input.size);ue=Nt.call(ue,this._start,se)}var Le=pt.readAsText(ue,this._config.encoding);Ut||this._chunkLoaded({target:{result:Le}})},this._chunkLoaded=function(ue){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(ue.target.result)},this._chunkError=function(){this._sendError(pt.error)}}function F(ut){var pt;N.call(this,ut=ut||{}),this.stream=function(Nt){return pt=Nt,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var Nt,Ut=this._config.chunkSize;return Ut?(Nt=pt.substring(0,Ut),pt=pt.substring(Ut)):(Nt=pt,pt=""),this._finished=!pt,this.parseChunk(Nt)}}}function K(ut){N.call(this,ut=ut||{});var pt=[],Nt=!0,Ut=!1;this.pause=function(){N.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){N.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(ue){this._input=ue,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){Ut&&pt.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),pt.length?this.parseChunk(pt.shift()):Nt=!0},this._streamData=mt(function(ue){try{pt.push(typeof ue=="string"?ue:ue.toString(this._config.encoding)),Nt&&(Nt=!1,this._checkIsFinished(),this.parseChunk(pt.shift()))}catch(se){this._streamError(se)}},this),this._streamError=mt(function(ue){this._streamCleanUp(),this._sendError(ue)},this),this._streamEnd=mt(function(){this._streamCleanUp(),Ut=!0,this._streamData("")},this),this._streamCleanUp=mt(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function nt(ut){var pt,Nt,Ut,ue=Math.pow(2,53),se=-ue,Le=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Ne=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,we=this,At=0,Qt=0,de=!1,rn=!1,Ee=[],ce={data:[],errors:[],meta:{}};if(wt(ut.step)){var Oe=ut.step;ut.step=function(Be){if(ce=Be,Ae())fe();else{if(fe(),ce.data.length===0)return;At+=Be.data.length,ut.preview&&At>ut.preview?Nt.abort():(ce.data=ce.data[0],Oe(ce,we))}}}function Ze(Be){return ut.skipEmptyLines==="greedy"?Be.join("").trim()==="":Be.length===1&&Be[0].length===0}function fe(){return ce&&Ut&&(ge("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+C.DefaultDelimiter+"'"),Ut=!1),ut.skipEmptyLines&&(ce.data=ce.data.filter(function(Be){return!Ze(Be)})),Ae()&&function(){if(!ce)return;function Be(ke,Ve){wt(ut.transformHeader)&&(ke=ut.transformHeader(ke,Ve)),Ee.push(ke)}if(Array.isArray(ce.data[0])){for(var te=0;Ae()&&te<ce.data.length;te++)ce.data[te].forEach(Be);ce.data.splice(0,1)}else ce.data.forEach(Be)}(),function(){if(!ce||!ut.header&&!ut.dynamicTyping&&!ut.transform)return ce;function Be(ke,Ve){var ee,Ft=ut.header?{}:[];for(ee=0;ee<ke.length;ee++){var bt=ee,Me=ke[ee];ut.header&&(bt=ee>=Ee.length?"__parsed_extra":Ee[ee]),ut.transform&&(Me=ut.transform(Me,bt)),Me=Ye(bt,Me),bt==="__parsed_extra"?(Ft[bt]=Ft[bt]||[],Ft[bt].push(Me)):Ft[bt]=Me}return ut.header&&(ee>Ee.length?ge("FieldMismatch","TooManyFields","Too many fields: expected "+Ee.length+" fields but parsed "+ee,Qt+Ve):ee<Ee.length&&ge("FieldMismatch","TooFewFields","Too few fields: expected "+Ee.length+" fields but parsed "+ee,Qt+Ve)),Ft}var te=1;return!ce.data.length||Array.isArray(ce.data[0])?(ce.data=ce.data.map(Be),te=ce.data.length):ce.data=Be(ce.data,0),ut.header&&ce.meta&&(ce.meta.fields=Ee),Qt+=te,ce}()}function Ae(){return ut.header&&Ee.length===0}function Ye(Be,te){return ke=Be,ut.dynamicTypingFunction&&ut.dynamicTyping[ke]===void 0&&(ut.dynamicTyping[ke]=ut.dynamicTypingFunction(ke)),(ut.dynamicTyping[ke]||ut.dynamicTyping)===!0?te==="true"||te==="TRUE"||te!=="false"&&te!=="FALSE"&&(function(Ve){if(Le.test(Ve)){var ee=parseFloat(Ve);if(se<ee&&ee<ue)return!0}return!1}(te)?parseFloat(te):Ne.test(te)?new Date(te):te===""?null:te):te;var ke}function ge(Be,te,ke,Ve){var ee={type:Be,code:te,message:ke};Ve!==void 0&&(ee.row=Ve),ce.errors.push(ee)}this.parse=function(Be,te,ke){var Ve=ut.quoteChar||'"';if(ut.newline||(ut.newline=function(bt,Me){bt=bt.substring(0,1048576);var en=new RegExp(P(Me)+"([^]*?)"+P(Me),"gm"),fn=(bt=bt.replace(en,"")).split("\r"),Rt=bt.split(`
`),Xn=1<Rt.length&&Rt[0].length<fn[0].length;if(fn.length===1||Xn)return`
`;for(var Bn=0,xr=0;xr<fn.length;xr++)fn[xr][0]===`
`&&Bn++;return Bn>=fn.length/2?`\r
`:"\r"}(Be,Ve)),Ut=!1,ut.delimiter)wt(ut.delimiter)&&(ut.delimiter=ut.delimiter(Be),ce.meta.delimiter=ut.delimiter);else{var ee=function(bt,Me,en,fn,Rt){var Xn,Bn,xr,dr;Rt=Rt||[",","	","|",";",C.RECORD_SEP,C.UNIT_SEP];for(var Ur=0;Ur<Rt.length;Ur++){var fa=Rt[Ur],Ea=0,aa=0,Da=0;xr=void 0;for(var Lr=new k({comments:fn,delimiter:fa,newline:Me,preview:10}).parse(bt),_n=0;_n<Lr.data.length;_n++)if(en&&Ze(Lr.data[_n]))Da++;else{var sr=Lr.data[_n].length;aa+=sr,xr!==void 0?0<sr&&(Ea+=Math.abs(sr-xr),xr=sr):xr=sr}0<Lr.data.length&&(aa/=Lr.data.length-Da),(Bn===void 0||Ea<=Bn)&&(dr===void 0||dr<aa)&&1.99<aa&&(Bn=Ea,Xn=fa,dr=aa)}return{successful:!!(ut.delimiter=Xn),bestDelimiter:Xn}}(Be,ut.newline,ut.skipEmptyLines,ut.comments,ut.delimitersToGuess);ee.successful?ut.delimiter=ee.bestDelimiter:(Ut=!0,ut.delimiter=C.DefaultDelimiter),ce.meta.delimiter=ut.delimiter}var Ft=ht(ut);return ut.preview&&ut.header&&Ft.preview++,pt=Be,Nt=new k(Ft),ce=Nt.parse(pt,te,ke),fe(),de?{meta:{paused:!0}}:ce||{meta:{paused:!1}}},this.paused=function(){return de},this.pause=function(){de=!0,Nt.abort(),pt=wt(ut.chunk)?"":pt.substring(Nt.getCharIndex())},this.resume=function(){we.streamer._halted?(de=!1,we.streamer.parseChunk(pt,!0)):setTimeout(we.resume,3)},this.aborted=function(){return rn},this.abort=function(){rn=!0,Nt.abort(),ce.meta.aborted=!0,wt(ut.complete)&&ut.complete(ce),pt=""}}function P(ut){return ut.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function k(ut){var pt,Nt=(ut=ut||{}).delimiter,Ut=ut.newline,ue=ut.comments,se=ut.step,Le=ut.preview,Ne=ut.fastMode,we=pt=ut.quoteChar===void 0||ut.quoteChar===null?'"':ut.quoteChar;if(ut.escapeChar!==void 0&&(we=ut.escapeChar),(typeof Nt!="string"||-1<C.BAD_DELIMITERS.indexOf(Nt))&&(Nt=","),ue===Nt)throw new Error("Comment character same as delimiter");ue===!0?ue="#":(typeof ue!="string"||-1<C.BAD_DELIMITERS.indexOf(ue))&&(ue=!1),Ut!==`
`&&Ut!=="\r"&&Ut!==`\r
`&&(Ut=`
`);var At=0,Qt=!1;this.parse=function(de,rn,Ee){if(typeof de!="string")throw new Error("Input must be a string");var ce=de.length,Oe=Nt.length,Ze=Ut.length,fe=ue.length,Ae=wt(se),Ye=[],ge=[],Be=[],te=At=0;if(!de)return Pn();if(ut.header&&!rn){var ke=de.split(Ut)[0].split(Nt),Ve=[],ee={},Ft=!1;for(var bt in ke){var Me=ke[bt];wt(ut.transformHeader)&&(Me=ut.transformHeader(Me,bt));var en=Me,fn=ee[Me]||0;for(0<fn&&(Ft=!0,en=Me+"_"+fn),ee[Me]=fn+1;Ve.includes(en);)en=en+"_"+fn;Ve.push(en)}if(Ft){var Rt=de.split(Ut);Rt[0]=Ve.join(Nt),de=Rt.join(Ut)}}if(Ne||Ne!==!1&&de.indexOf(pt)===-1){for(var Xn=de.split(Ut),Bn=0;Bn<Xn.length;Bn++){if(Be=Xn[Bn],At+=Be.length,Bn!==Xn.length-1)At+=Ut.length;else if(Ee)return Pn();if(!ue||Be.substring(0,fe)!==ue){if(Ae){if(Ye=[],Da(Be.split(Nt)),tr(),Qt)return Pn()}else Da(Be.split(Nt));if(Le&&Le<=Bn)return Ye=Ye.slice(0,Le),Pn(!0)}}return Pn()}for(var xr=de.indexOf(Nt,At),dr=de.indexOf(Ut,At),Ur=new RegExp(P(we)+P(pt),"g"),fa=de.indexOf(pt,At);;)if(de[At]!==pt)if(ue&&Be.length===0&&de.substring(At,At+fe)===ue){if(dr===-1)return Pn();At=dr+Ze,dr=de.indexOf(Ut,At),xr=de.indexOf(Nt,At)}else if(xr!==-1&&(xr<dr||dr===-1))Be.push(de.substring(At,xr)),At=xr+Oe,xr=de.indexOf(Nt,At);else{if(dr===-1)break;if(Be.push(de.substring(At,dr)),sr(dr+Ze),Ae&&(tr(),Qt))return Pn();if(Le&&Ye.length>=Le)return Pn(!0)}else for(fa=At,At++;;){if((fa=de.indexOf(pt,fa+1))===-1)return Ee||ge.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Ye.length,index:At}),_n();if(fa===ce-1)return _n(de.substring(At,fa).replace(Ur,pt));if(pt!==we||de[fa+1]!==we){if(pt===we||fa===0||de[fa-1]!==we){xr!==-1&&xr<fa+1&&(xr=de.indexOf(Nt,fa+1)),dr!==-1&&dr<fa+1&&(dr=de.indexOf(Ut,fa+1));var Ea=Lr(dr===-1?xr:Math.min(xr,dr));if(de.substr(fa+1+Ea,Oe)===Nt){Be.push(de.substring(At,fa).replace(Ur,pt)),de[At=fa+1+Ea+Oe]!==pt&&(fa=de.indexOf(pt,At)),xr=de.indexOf(Nt,At),dr=de.indexOf(Ut,At);break}var aa=Lr(dr);if(de.substring(fa+1+aa,fa+1+aa+Ze)===Ut){if(Be.push(de.substring(At,fa).replace(Ur,pt)),sr(fa+1+aa+Ze),xr=de.indexOf(Nt,At),fa=de.indexOf(pt,At),Ae&&(tr(),Qt))return Pn();if(Le&&Ye.length>=Le)return Pn(!0);break}ge.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Ye.length,index:At}),fa++}}else fa++}return _n();function Da(zn){Ye.push(zn),te=At}function Lr(zn){var Wr=0;if(zn!==-1){var Yr=de.substring(fa+1,zn);Yr&&Yr.trim()===""&&(Wr=Yr.length)}return Wr}function _n(zn){return Ee||(zn===void 0&&(zn=de.substring(At)),Be.push(zn),At=ce,Da(Be),Ae&&tr()),Pn()}function sr(zn){At=zn,Da(Be),Be=[],dr=de.indexOf(Ut,At)}function Pn(zn){return{data:Ye,errors:ge,meta:{delimiter:Nt,linebreak:Ut,aborted:Qt,truncated:!!zn,cursor:te+(rn||0)}}}function tr(){se(Pn()),Ye=[],ge=[]}},this.abort=function(){Qt=!0},this.getCharIndex=function(){return At}}function yt(ut){var pt=ut.data,Nt=R[pt.workerId],Ut=!1;if(pt.error)Nt.userError(pt.error,pt.file);else if(pt.results&&pt.results.data){var ue={abort:function(){Ut=!0,st(pt.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:lt,resume:lt};if(wt(Nt.userStep)){for(var se=0;se<pt.results.data.length&&(Nt.userStep({data:pt.results.data[se],errors:pt.results.errors,meta:pt.results.meta},ue),!Ut);se++);delete pt.results}else wt(Nt.userChunk)&&(Nt.userChunk(pt.results,ue,pt.file),delete pt.results)}pt.finished&&!Ut&&st(pt.workerId,pt.results)}function st(ut,pt){var Nt=R[ut];wt(Nt.userComplete)&&Nt.userComplete(pt),Nt.terminate(),delete R[ut]}function lt(){throw new Error("Not implemented.")}function ht(ut){if(typeof ut!="object"||ut===null)return ut;var pt=Array.isArray(ut)?[]:{};for(var Nt in ut)pt[Nt]=ht(ut[Nt]);return pt}function mt(ut,pt){return function(){ut.apply(pt,arguments)}}function wt(ut){return typeof ut=="function"}return Z&&(W.onmessage=function(ut){var pt=ut.data;if(C.WORKER_ID===void 0&&pt&&(C.WORKER_ID=pt.workerId),typeof pt.input=="string")W.postMessage({workerId:C.WORKER_ID,results:C.parse(pt.input,pt.config),finished:!0});else if(W.File&&pt.input instanceof File||pt.input instanceof Object){var Nt=C.parse(pt.input,pt.config);Nt&&W.postMessage({workerId:C.WORKER_ID,results:Nt,finished:!0})}}),(B.prototype=Object.create(N.prototype)).constructor=B,(O.prototype=Object.create(N.prototype)).constructor=O,(F.prototype=Object.create(F.prototype)).constructor=F,(K.prototype=Object.create(N.prototype)).constructor=K,C})},53110:function(ur,ot,$){"use strict";$.d(ot,{I:function(){return N},r:function(){return A}});var Y=$(67294),tt={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},j=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],W=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],Q=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],Z=typeof window!="undefined"&&typeof window.document!="undefined"?window.document:{},R="fullscreenEnabled"in Z&&Object.keys(tt)||j[0]in Z&&j||W[0]in Z&&W||Q[0]in Z&&Q||[],L={requestFullscreen:function(B){return B[R[tt.requestFullscreen]]()},requestFullscreenFunction:function(B){return B[R[tt.requestFullscreen]]},get exitFullscreen(){return Z[R[tt.exitFullscreen]].bind(Z)},get fullscreenPseudoClass(){return":"+R[tt.fullscreen]},addEventListener:function(B,O,F){return Z.addEventListener(R[tt[B]],O,F)},removeEventListener:function(B,O,F){return Z.removeEventListener(R[tt[B]],O,F)},get fullscreenEnabled(){return Boolean(Z[R[tt.fullscreenEnabled]])},set fullscreenEnabled(B){},get fullscreenElement(){return Z[R[tt.fullscreenElement]]},set fullscreenElement(B){},get onfullscreenchange(){return Z[("on"+R[tt.fullscreenchange]).toLowerCase()]},set onfullscreenchange(B){return Z[("on"+R[tt.fullscreenchange]).toLowerCase()]=B},get onfullscreenerror(){return Z[("on"+R[tt.fullscreenerror]).toLowerCase()]},set onfullscreenerror(B){return Z[("on"+R[tt.fullscreenerror]).toLowerCase()]=B}},C=L;function A(){var B=(0,Y.useState)(!1),O=B[0],F=B[1],K=(0,Y.useRef)(null);(0,Y.useEffect)(function(){var k=function(){F(C.fullscreenElement===K.current)};return C.addEventListener("fullscreenchange",k),function(){return C.removeEventListener("fullscreenchange",k)}},[]);var nt=(0,Y.useCallback)(function(){if(C.fullscreenElement)return C.exitFullscreen().then(function(){return C.requestFullscreen(K.current)});if(K.current)return C.requestFullscreen(K.current)},[]),P=(0,Y.useCallback)(function(){return C.fullscreenElement===K.current?C.exitFullscreen():Promise.resolve()},[]);return(0,Y.useMemo)(function(){return{active:O,enter:nt,exit:P,node:K}},[O,nt,P])}var N=function(O){var F=O.handle,K=O.onChange,nt=O.children,P=O.className,k=[];return P&&k.push(P),k.push("fullscreen"),F.active&&k.push("fullscreen-enabled"),(0,Y.useEffect)(function(){K&&K(F.active,F)},[F.active]),Y.createElement("div",{className:k.join(" "),ref:F.node,style:F.active?{height:"100%",width:"100%"}:void 0},nt)}},37763:function(ur,ot,$){ur.exports=function(Y){var tt={};function j(W){if(tt[W])return tt[W].exports;var Q=tt[W]={exports:{},id:W,loaded:!1};return Y[W].call(Q.exports,Q,Q.exports,j),Q.loaded=!0,Q.exports}return j.m=Y,j.c=tt,j.p="",j(0)}([function(Y,tt,j){Y.exports=j(1)},function(Y,tt,j){"use strict";Object.defineProperty(tt,"__esModule",{value:!0});function W(R){return R&&R.__esModule?R:{default:R}}var Q=j(2),Z=W(Q);tt.default=Z.default,Y.exports=tt.default},function(Y,tt,j){"use strict";Object.defineProperty(tt,"__esModule",{value:!0});var W=Object.assign||function(F){for(var K=1;K<arguments.length;K++){var nt=arguments[K];for(var P in nt)Object.prototype.hasOwnProperty.call(nt,P)&&(F[P]=nt[P])}return F};tt.default=O;function Q(F){return F&&F.__esModule?F:{default:F}}function Z(F,K){var nt={};for(var P in F)K.indexOf(P)>=0||!Object.prototype.hasOwnProperty.call(F,P)||(nt[P]=F[P]);return nt}var R=j(3),L=j(4),C=Q(L),A=j(14),N=j(15),B=Q(N);O.propTypes={activeClassName:C.default.string,activeIndex:C.default.number,activeStyle:C.default.object,autoEscape:C.default.bool,className:C.default.string,findChunks:C.default.func,highlightClassName:C.default.oneOfType([C.default.object,C.default.string]),highlightStyle:C.default.object,highlightTag:C.default.oneOfType([C.default.node,C.default.func,C.default.string]),sanitize:C.default.func,searchWords:C.default.arrayOf(C.default.oneOfType([C.default.string,C.default.instanceOf(RegExp)])).isRequired,textToHighlight:C.default.string.isRequired,unhighlightTag:C.default.oneOfType([C.default.node,C.default.func,C.default.string]),unhighlightClassName:C.default.string,unhighlightStyle:C.default.object};function O(F){var K=F.activeClassName,nt=K===void 0?"":K,P=F.activeIndex,k=P===void 0?-1:P,yt=F.activeStyle,st=F.autoEscape,lt=F.caseSensitive,ht=lt===void 0?!1:lt,mt=F.className,wt=F.findChunks,ut=F.highlightClassName,pt=ut===void 0?"":ut,Nt=F.highlightStyle,Ut=Nt===void 0?{}:Nt,ue=F.highlightTag,se=ue===void 0?"mark":ue,Le=F.sanitize,Ne=F.searchWords,we=F.textToHighlight,At=F.unhighlightTag,Qt=At===void 0?"span":At,de=F.unhighlightClassName,rn=de===void 0?"":de,Ee=F.unhighlightStyle,ce=Z(F,["activeClassName","activeIndex","activeStyle","autoEscape","caseSensitive","className","findChunks","highlightClassName","highlightStyle","highlightTag","sanitize","searchWords","textToHighlight","unhighlightTag","unhighlightClassName","unhighlightStyle"]),Oe=(0,R.findAll)({autoEscape:st,caseSensitive:ht,findChunks:wt,sanitize:Le,searchWords:Ne,textToHighlight:we}),Ze=se,fe=-1,Ae="",Ye=void 0,ge=function(ke){var Ve={};for(var ee in ke)Ve[ee.toLowerCase()]=ke[ee];return Ve},Be=(0,B.default)(ge);return(0,A.createElement)("span",W({className:mt},ce,{children:Oe.map(function(te,ke){var Ve=we.substr(te.start,te.end-te.start);if(te.highlight){fe++;var ee=void 0;typeof pt=="object"?ht?ee=pt[Ve]:(pt=Be(pt),ee=pt[Ve.toLowerCase()]):ee=pt;var Ft=fe===+k;Ae=ee+" "+(Ft?nt:""),Ye=Ft===!0&&yt!=null?Object.assign({},Ut,yt):Ut;var bt={children:Ve,className:Ae,key:ke,style:Ye};return typeof Ze!="string"&&(bt.highlightIndex=fe),(0,A.createElement)(Ze,bt)}else return(0,A.createElement)(Qt,{children:Ve,className:rn,key:ke,style:Ee})})}))}Y.exports=tt.default},function(Y,tt){Y.exports=function(j){var W={};function Q(Z){if(W[Z])return W[Z].exports;var R=W[Z]={exports:{},id:Z,loaded:!1};return j[Z].call(R.exports,R,R.exports,Q),R.loaded=!0,R.exports}return Q.m=j,Q.c=W,Q.p="",Q(0)}([function(j,W,Q){j.exports=Q(1)},function(j,W,Q){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var Z=Q(2);Object.defineProperty(W,"combineChunks",{enumerable:!0,get:function(){return Z.combineChunks}}),Object.defineProperty(W,"fillInChunks",{enumerable:!0,get:function(){return Z.fillInChunks}}),Object.defineProperty(W,"findAll",{enumerable:!0,get:function(){return Z.findAll}}),Object.defineProperty(W,"findChunks",{enumerable:!0,get:function(){return Z.findChunks}})},function(j,W){"use strict";Object.defineProperty(W,"__esModule",{value:!0});var Q=W.findAll=function(B){var O=B.autoEscape,F=B.caseSensitive,K=F===void 0?!1:F,nt=B.findChunks,P=nt===void 0?R:nt,k=B.sanitize,yt=B.searchWords,st=B.textToHighlight;return L({chunksToHighlight:Z({chunks:P({autoEscape:O,caseSensitive:K,sanitize:k,searchWords:yt,textToHighlight:st})}),totalLength:st?st.length:0})},Z=W.combineChunks=function(B){var O=B.chunks;return O=O.sort(function(F,K){return F.start-K.start}).reduce(function(F,K){if(F.length===0)return[K];var nt=F.pop();if(K.start<=nt.end){var P=Math.max(nt.end,K.end);F.push({start:nt.start,end:P})}else F.push(nt,K);return F},[]),O},R=function(B){var O=B.autoEscape,F=B.caseSensitive,K=B.sanitize,nt=K===void 0?C:K,P=B.searchWords,k=B.textToHighlight;return k=nt(k),P.filter(function(yt){return yt}).reduce(function(yt,st){st=nt(st),O&&(st=A(st));for(var lt=new RegExp(st,F?"g":"gi"),ht=void 0;ht=lt.exec(k);){var mt=ht.index,wt=lt.lastIndex;wt>mt&&yt.push({start:mt,end:wt}),ht.index==lt.lastIndex&&lt.lastIndex++}return yt},[])};W.findChunks=R;var L=W.fillInChunks=function(B){var O=B.chunksToHighlight,F=B.totalLength,K=[],nt=function(yt,st,lt){st-yt>0&&K.push({start:yt,end:st,highlight:lt})};if(O.length===0)nt(0,F,!1);else{var P=0;O.forEach(function(k){nt(P,k.start,!1),nt(k.start,k.end,!0),P=k.end}),nt(P,F,!1)}return K};function C(N){return N}function A(N){return N.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}}])},function(Y,tt,j){(function(W){if(W.env.NODE_ENV!=="production"){var Q=typeof Symbol=="function"&&Symbol.for&&Symbol.for("react.element")||60103,Z=function(L){return typeof L=="object"&&L!==null&&L.$$typeof===Q},R=!0;Y.exports=j(6)(Z,R)}else Y.exports=j(13)()}).call(tt,j(5))},function(Y,tt){var j=Y.exports={},W,Q;function Z(){throw new Error("setTimeout has not been defined")}function R(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?W=setTimeout:W=Z}catch(k){W=Z}try{typeof clearTimeout=="function"?Q=clearTimeout:Q=R}catch(k){Q=R}})();function L(k){if(W===setTimeout)return setTimeout(k,0);if((W===Z||!W)&&setTimeout)return W=setTimeout,setTimeout(k,0);try{return W(k,0)}catch(yt){try{return W.call(null,k,0)}catch(st){return W.call(this,k,0)}}}function C(k){if(Q===clearTimeout)return clearTimeout(k);if((Q===R||!Q)&&clearTimeout)return Q=clearTimeout,clearTimeout(k);try{return Q(k)}catch(yt){try{return Q.call(null,k)}catch(st){return Q.call(this,k)}}}var A=[],N=!1,B,O=-1;function F(){!N||!B||(N=!1,B.length?A=B.concat(A):O=-1,A.length&&K())}function K(){if(!N){var k=L(F);N=!0;for(var yt=A.length;yt;){for(B=A,A=[];++O<yt;)B&&B[O].run();O=-1,yt=A.length}B=null,N=!1,C(k)}}j.nextTick=function(k){var yt=new Array(arguments.length-1);if(arguments.length>1)for(var st=1;st<arguments.length;st++)yt[st-1]=arguments[st];A.push(new nt(k,yt)),A.length===1&&!N&&L(K)};function nt(k,yt){this.fun=k,this.array=yt}nt.prototype.run=function(){this.fun.apply(null,this.array)},j.title="browser",j.browser=!0,j.env={},j.argv=[],j.version="",j.versions={};function P(){}j.on=P,j.addListener=P,j.once=P,j.off=P,j.removeListener=P,j.removeAllListeners=P,j.emit=P,j.prependListener=P,j.prependOnceListener=P,j.listeners=function(k){return[]},j.binding=function(k){throw new Error("process.binding is not supported")},j.cwd=function(){return"/"},j.chdir=function(k){throw new Error("process.chdir is not supported")},j.umask=function(){return 0}},function(Y,tt,j){(function(W){"use strict";var Q=j(7),Z=j(8),R=j(9),L=j(10),C=j(11),A=j(12);Y.exports=function(N,B){var O=typeof Symbol=="function"&&Symbol.iterator,F="@@iterator";function K(Ee){var ce=Ee&&(O&&Ee[O]||Ee[F]);if(typeof ce=="function")return ce}var nt="<<anonymous>>",P={array:lt("array"),bool:lt("boolean"),func:lt("function"),number:lt("number"),object:lt("object"),string:lt("string"),symbol:lt("symbol"),any:ht(),arrayOf:mt,element:wt(),instanceOf:ut,node:ue(),objectOf:Nt,oneOf:pt,oneOfType:Ut,shape:se,exact:Le};function k(Ee,ce){return Ee===ce?Ee!==0||1/Ee==1/ce:Ee!==Ee&&ce!==ce}function yt(Ee){this.message=Ee,this.stack=""}yt.prototype=Error.prototype;function st(Ee){if(W.env.NODE_ENV!=="production")var ce={},Oe=0;function Ze(Ae,Ye,ge,Be,te,ke,Ve){if(Be=Be||nt,ke=ke||ge,Ve!==C){if(B)Z(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if(W.env.NODE_ENV!=="production"&&typeof console!="undefined"){var ee=Be+":"+ge;!ce[ee]&&Oe<3&&(R(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",ke,Be),ce[ee]=!0,Oe++)}}return Ye[ge]==null?Ae?Ye[ge]===null?new yt("The "+te+" `"+ke+"` is marked as required "+("in `"+Be+"`, but its value is `null`.")):new yt("The "+te+" `"+ke+"` is marked as required in "+("`"+Be+"`, but its value is `undefined`.")):null:Ee(Ye,ge,Be,te,ke)}var fe=Ze.bind(null,!1);return fe.isRequired=Ze.bind(null,!0),fe}function lt(Ee){function ce(Oe,Ze,fe,Ae,Ye,ge){var Be=Oe[Ze],te=At(Be);if(te!==Ee){var ke=Qt(Be);return new yt("Invalid "+Ae+" `"+Ye+"` of type "+("`"+ke+"` supplied to `"+fe+"`, expected ")+("`"+Ee+"`."))}return null}return st(ce)}function ht(){return st(Q.thatReturnsNull)}function mt(Ee){function ce(Oe,Ze,fe,Ae,Ye){if(typeof Ee!="function")return new yt("Property `"+Ye+"` of component `"+fe+"` has invalid PropType notation inside arrayOf.");var ge=Oe[Ze];if(!Array.isArray(ge)){var Be=At(ge);return new yt("Invalid "+Ae+" `"+Ye+"` of type "+("`"+Be+"` supplied to `"+fe+"`, expected an array."))}for(var te=0;te<ge.length;te++){var ke=Ee(ge,te,fe,Ae,Ye+"["+te+"]",C);if(ke instanceof Error)return ke}return null}return st(ce)}function wt(){function Ee(ce,Oe,Ze,fe,Ae){var Ye=ce[Oe];if(!N(Ye)){var ge=At(Ye);return new yt("Invalid "+fe+" `"+Ae+"` of type "+("`"+ge+"` supplied to `"+Ze+"`, expected a single ReactElement."))}return null}return st(Ee)}function ut(Ee){function ce(Oe,Ze,fe,Ae,Ye){if(!(Oe[Ze]instanceof Ee)){var ge=Ee.name||nt,Be=rn(Oe[Ze]);return new yt("Invalid "+Ae+" `"+Ye+"` of type "+("`"+Be+"` supplied to `"+fe+"`, expected ")+("instance of `"+ge+"`."))}return null}return st(ce)}function pt(Ee){if(!Array.isArray(Ee))return W.env.NODE_ENV!=="production"&&R(!1,"Invalid argument supplied to oneOf, expected an instance of array."),Q.thatReturnsNull;function ce(Oe,Ze,fe,Ae,Ye){for(var ge=Oe[Ze],Be=0;Be<Ee.length;Be++)if(k(ge,Ee[Be]))return null;var te=JSON.stringify(Ee);return new yt("Invalid "+Ae+" `"+Ye+"` of value `"+ge+"` "+("supplied to `"+fe+"`, expected one of "+te+"."))}return st(ce)}function Nt(Ee){function ce(Oe,Ze,fe,Ae,Ye){if(typeof Ee!="function")return new yt("Property `"+Ye+"` of component `"+fe+"` has invalid PropType notation inside objectOf.");var ge=Oe[Ze],Be=At(ge);if(Be!=="object")return new yt("Invalid "+Ae+" `"+Ye+"` of type "+("`"+Be+"` supplied to `"+fe+"`, expected an object."));for(var te in ge)if(ge.hasOwnProperty(te)){var ke=Ee(ge,te,fe,Ae,Ye+"."+te,C);if(ke instanceof Error)return ke}return null}return st(ce)}function Ut(Ee){if(!Array.isArray(Ee))return W.env.NODE_ENV!=="production"&&R(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),Q.thatReturnsNull;for(var ce=0;ce<Ee.length;ce++){var Oe=Ee[ce];if(typeof Oe!="function")return R(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",de(Oe),ce),Q.thatReturnsNull}function Ze(fe,Ae,Ye,ge,Be){for(var te=0;te<Ee.length;te++){var ke=Ee[te];if(ke(fe,Ae,Ye,ge,Be,C)==null)return null}return new yt("Invalid "+ge+" `"+Be+"` supplied to "+("`"+Ye+"`."))}return st(Ze)}function ue(){function Ee(ce,Oe,Ze,fe,Ae){return Ne(ce[Oe])?null:new yt("Invalid "+fe+" `"+Ae+"` supplied to "+("`"+Ze+"`, expected a ReactNode."))}return st(Ee)}function se(Ee){function ce(Oe,Ze,fe,Ae,Ye){var ge=Oe[Ze],Be=At(ge);if(Be!=="object")return new yt("Invalid "+Ae+" `"+Ye+"` of type `"+Be+"` "+("supplied to `"+fe+"`, expected `object`."));for(var te in Ee){var ke=Ee[te];if(!!ke){var Ve=ke(ge,te,fe,Ae,Ye+"."+te,C);if(Ve)return Ve}}return null}return st(ce)}function Le(Ee){function ce(Oe,Ze,fe,Ae,Ye){var ge=Oe[Ze],Be=At(ge);if(Be!=="object")return new yt("Invalid "+Ae+" `"+Ye+"` of type `"+Be+"` "+("supplied to `"+fe+"`, expected `object`."));var te=L({},Oe[Ze],Ee);for(var ke in te){var Ve=Ee[ke];if(!Ve)return new yt("Invalid "+Ae+" `"+Ye+"` key `"+ke+"` supplied to `"+fe+"`.\nBad object: "+JSON.stringify(Oe[Ze],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(Ee),null,"  "));var ee=Ve(ge,ke,fe,Ae,Ye+"."+ke,C);if(ee)return ee}return null}return st(ce)}function Ne(Ee){switch(typeof Ee){case"number":case"string":case"undefined":return!0;case"boolean":return!Ee;case"object":if(Array.isArray(Ee))return Ee.every(Ne);if(Ee===null||N(Ee))return!0;var ce=K(Ee);if(ce){var Oe=ce.call(Ee),Ze;if(ce!==Ee.entries){for(;!(Ze=Oe.next()).done;)if(!Ne(Ze.value))return!1}else for(;!(Ze=Oe.next()).done;){var fe=Ze.value;if(fe&&!Ne(fe[1]))return!1}}else return!1;return!0;default:return!1}}function we(Ee,ce){return Ee==="symbol"||ce["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&ce instanceof Symbol}function At(Ee){var ce=typeof Ee;return Array.isArray(Ee)?"array":Ee instanceof RegExp?"object":we(ce,Ee)?"symbol":ce}function Qt(Ee){if(typeof Ee=="undefined"||Ee===null)return""+Ee;var ce=At(Ee);if(ce==="object"){if(Ee instanceof Date)return"date";if(Ee instanceof RegExp)return"regexp"}return ce}function de(Ee){var ce=Qt(Ee);switch(ce){case"array":case"object":return"an "+ce;case"boolean":case"date":case"regexp":return"a "+ce;default:return ce}}function rn(Ee){return!Ee.constructor||!Ee.constructor.name?nt:Ee.constructor.name}return P.checkPropTypes=A,P.PropTypes=P,P}}).call(tt,j(5))},function(Y,tt){"use strict";function j(Q){return function(){return Q}}var W=function(){};W.thatReturns=j,W.thatReturnsFalse=j(!1),W.thatReturnsTrue=j(!0),W.thatReturnsNull=j(null),W.thatReturnsThis=function(){return this},W.thatReturnsArgument=function(Q){return Q},Y.exports=W},function(Y,tt,j){(function(W){"use strict";var Q=function(L){};W.env.NODE_ENV!=="production"&&(Q=function(L){if(L===void 0)throw new Error("invariant requires an error message argument")});function Z(R,L,C,A,N,B,O,F){if(Q(L),!R){var K;if(L===void 0)K=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var nt=[C,A,N,B,O,F],P=0;K=new Error(L.replace(/%s/g,function(){return nt[P++]})),K.name="Invariant Violation"}throw K.framesToPop=1,K}}Y.exports=Z}).call(tt,j(5))},function(Y,tt,j){(function(W){"use strict";var Q=j(7),Z=Q;if(W.env.NODE_ENV!=="production"){var R=function(C){for(var A=arguments.length,N=Array(A>1?A-1:0),B=1;B<A;B++)N[B-1]=arguments[B];var O=0,F="Warning: "+C.replace(/%s/g,function(){return N[O++]});typeof console!="undefined"&&console.error(F);try{throw new Error(F)}catch(K){}};Z=function(C,A){if(A===void 0)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(A.indexOf("Failed Composite propType: ")!==0&&!C){for(var N=arguments.length,B=Array(N>2?N-2:0),O=2;O<N;O++)B[O-2]=arguments[O];R.apply(void 0,[A].concat(B))}}}Y.exports=Z}).call(tt,j(5))},function(Y,tt){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/"use strict";var j=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;function Z(L){if(L==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(L)}function R(){try{if(!Object.assign)return!1;var L=new String("abc");if(L[5]="de",Object.getOwnPropertyNames(L)[0]==="5")return!1;for(var C={},A=0;A<10;A++)C["_"+String.fromCharCode(A)]=A;var N=Object.getOwnPropertyNames(C).map(function(O){return C[O]});if(N.join("")!=="0123456789")return!1;var B={};return"abcdefghijklmnopqrst".split("").forEach(function(O){B[O]=O}),Object.keys(Object.assign({},B)).join("")==="abcdefghijklmnopqrst"}catch(O){return!1}}Y.exports=R()?Object.assign:function(L,C){for(var A,N=Z(L),B,O=1;O<arguments.length;O++){A=Object(arguments[O]);for(var F in A)W.call(A,F)&&(N[F]=A[F]);if(j){B=j(A);for(var K=0;K<B.length;K++)Q.call(A,B[K])&&(N[B[K]]=A[B[K]])}}return N}},function(Y,tt){"use strict";var j="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";Y.exports=j},function(Y,tt,j){(function(W){"use strict";if(W.env.NODE_ENV!=="production")var Q=j(8),Z=j(9),R=j(11),L={};function C(A,N,B,O,F){if(W.env.NODE_ENV!=="production"){for(var K in A)if(A.hasOwnProperty(K)){var nt;try{Q(typeof A[K]=="function","%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",O||"React class",B,K,typeof A[K]),nt=A[K](N,K,O,B,null,R)}catch(k){nt=k}if(Z(!nt||nt instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",O||"React class",B,K,typeof nt),nt instanceof Error&&!(nt.message in L)){L[nt.message]=!0;var P=F?F():"";Z(!1,"Failed %s type: %s%s",B,nt.message,P!=null?P:"")}}}}Y.exports=C}).call(tt,j(5))},function(Y,tt,j){"use strict";var W=j(7),Q=j(8),Z=j(11);Y.exports=function(){function R(A,N,B,O,F,K){K!==Z&&Q(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}R.isRequired=R;function L(){return R}var C={array:R,bool:R,func:R,number:R,object:R,string:R,symbol:R,any:R,arrayOf:L,element:R,instanceOf:L,node:R,objectOf:L,oneOf:L,oneOfType:L,shape:L,exact:L};return C.checkPropTypes=W,C.PropTypes=C,C}},function(Y,tt){Y.exports=$(67294)},function(Y,tt){"use strict";var j=function(Z,R){return Z===R};function W(Q){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:j,R=void 0,L=[],C=void 0,A=!1,N=function(F,K){return Z(F,L[K])},B=function(){for(var F=arguments.length,K=Array(F),nt=0;nt<F;nt++)K[nt]=arguments[nt];return A&&R===this&&K.length===L.length&&K.every(N)||(A=!0,R=this,L=K,C=Q.apply(this,K)),C};return B}Y.exports=W}])},29154:function(ur,ot,$){"use strict";$.d(ot,{ZP:function(){return Ec}});function Y(y,m){for(var E=y.length,S=0;S<E;++S)if(m(y[S],S))return!0;return!1}function tt(y,m){for(var E=y.length,S=0;S<E;++S)if(m(y[S],S))return y[S];return null}function j(y){var m=y;if(typeof m=="undefined"){if(typeof navigator=="undefined"||!navigator)return"";m=navigator.userAgent||""}return m.toLowerCase()}function W(y,m){try{return new RegExp(y,"g").exec(m)}catch(E){return null}}function Q(){if(typeof navigator=="undefined"||!navigator||!navigator.userAgentData)return!1;var y=navigator.userAgentData,m=y.brands||y.uaList;return!!(m&&m.length)}function Z(y,m){var E=W("("+y+")((?:\\/|\\s|:)([0-9|\\.|_]+))",m);return E?E[3]:""}function R(y){return y.replace(/_/g,".")}function L(y,m){var E=null,S="-1";return Y(y,function(D){var J=W("("+D.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",m);return!J||D.brand?!1:(E=D,S=J[3]||"-1",D.versionAlias?S=D.versionAlias:D.versionTest&&(S=Z(D.versionTest.toLowerCase(),m)||S),S=R(S),!0)}),{preset:E,version:S}}function C(y,m){var E={brand:"",version:"-1"};return Y(y,function(S){var D=A(m,S);return D?(E.brand=S.id,E.version=S.versionAlias||D.version,E.version!=="-1"):!1}),E}function A(y,m){return tt(y,function(E){var S=E.brand;return W(""+m.test,S.toLowerCase())})}var N=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],B=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],O=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],F=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],K=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function nt(y){return!!L(F,y).preset}function P(y){var m=j(y),E=!!/mobi/g.exec(m),S={name:"unknown",version:"-1",majorVersion:-1,webview:nt(m),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},D={name:"unknown",version:"-1",majorVersion:-1},J=L(N,m),ct=J.preset,vt=J.version,It=L(K,m),Bt=It.preset,qt=It.version,Zt=L(B,m);if(S.chromium=!!Zt.preset,S.chromiumVersion=Zt.version,!S.chromium){var Ht=L(O,m);S.webkit=!!Ht.preset,S.webkitVersion=Ht.version}return Bt&&(D.name=Bt.id,D.version=qt,D.majorVersion=parseInt(qt,10)),ct&&(S.name=ct.id,S.version=vt,S.webview&&D.name==="ios"&&S.name!=="safari"&&(S.webview=!1)),S.majorVersion=parseInt(S.version,10),{browser:S,os:D,isMobile:E,isHints:!1}}function k(y){var m=navigator.userAgentData,E=(m.uaList||m.brands).slice(),S=y&&y.fullVersionList,D=m.mobile||!1,J=E[0],ct=(y&&y.platform||m.platform||navigator.platform).toLowerCase(),vt={name:J.brand,version:J.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!C(F,E).brand||nt(j())},It={name:"unknown",version:"-1",majorVersion:-1};vt.webkit=!vt.chromium&&Y(O,function(_e){return A(E,_e)});var Bt=C(B,E);if(vt.chromium=!!Bt.brand,vt.chromiumVersion=Bt.version,!vt.chromium){var qt=C(O,E);vt.webkit=!!qt.brand,vt.webkitVersion=qt.version}var Zt=tt(K,function(_e){return new RegExp(""+_e.test,"g").exec(ct)});if(It.name=Zt?Zt.id:"",y&&(It.version=y.platformVersion),S&&S.length){var Ht=C(N,S);vt.name=Ht.brand||vt.name,vt.version=Ht.version||vt.version}else{var be=C(N,E);vt.name=be.brand||vt.name,vt.version=be.brand&&y?y.uaFullVersion:be.version}return vt.webkit&&(It.name=D?"ios":"mac"),It.name==="ios"&&vt.webview&&(vt.version="-1"),It.version=R(It.version),vt.version=R(vt.version),It.majorVersion=parseInt(It.version,10),vt.majorVersion=parseInt(vt.version,10),{browser:vt,os:It,isMobile:D,isHints:!0}}function yt(y){return Q()?navigator.userAgentData.getHighEntropyValues(["architecture","model","platform","platformVersion","uaFullVersion","fullVersionList"]).then(function(m){var E=k(m);return y&&y(E),E}):(y&&y(st()),typeof Promise=="undefined"||!Promise?null:Promise.resolve(st()))}function st(y){return typeof y=="undefined"&&Q()?k():P(y)}var lt=st;function ht(y){for(var m=[],E=1;E<arguments.length;E++)m[E-1]=arguments[E];return m.map(function(S){return S.split(" ").map(function(D){return D?""+y+D:""}).join(" ")}).join(" ")}function mt(y,m){return m.replace(/([^}{]*){/gm,function(E,S){return S.replace(/\.([^{,\s\d.]+)/g,"."+y+"$1")+"{"})}function wt(y,m){return function(E){E&&(y[m]=E)}}function ut(y,m,E){return function(S){S&&(y[m][E]=S)}}function pt(y,m){return function(E){var S=E.prototype;y.forEach(function(D){m(S,D)})}}function Nt(y,m){return m===void 0&&(m={}),function(E,S){y.forEach(function(D){var J=m[D]||D;J in E||(E[J]=function(){for(var ct,vt=[],It=0;It<arguments.length;It++)vt[It]=arguments[It];var Bt=(ct=this[S])[D].apply(ct,vt);return Bt===this[S]?this:Bt})})}}var Ut="rgb",ue="rgba",se="hsl",Le="hsla",Ne=[Ut,ue,se,Le],we="function",At="property",Qt="array",de="object",rn="string",Ee="number",ce="undefined",Oe=typeof window!==ce,Ze=typeof document!==ce&&document,fe=null,Ae=function(y){if(!Ze)return"";var m=(Ze.body||Ze.documentElement).style,E=fe.length;if(typeof m[y]!==ce)return y;for(var S=0;S<E;++S){var D="-"+fe[S]+"-"+y;if(typeof m[D]!==ce)return D}return""},Ye=null,ge=null,Be=null,te=null,ke=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],Ve=1e-7,ee=1/Ve,Ft={cm:function(y){return y*96/2.54},mm:function(y){return y*96/254},in:function(y){return y*96},pt:function(y){return y*96/72},pc:function(y){return y*96/6},"%":function(y,m){return y*m/100},vw:function(y,m){return m===void 0&&(m=window.innerWidth),y/100*m},vh:function(y,m){return m===void 0&&(m=window.innerHeight),y/100*m},vmax:function(y,m){return m===void 0&&(m=Math.max(window.innerWidth,window.innerHeight)),y/100*m},vmin:function(y,m){return m===void 0&&(m=Math.min(window.innerWidth,window.innerHeight)),y/100*m}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function bt(){for(var y=0,m=0,E=arguments.length;m<E;m++)y+=arguments[m].length;for(var S=Array(y),D=0,m=0;m<E;m++)for(var J=arguments[m],ct=0,vt=J.length;ct<vt;ct++,D++)S[D]=J[ct];return S}function Me(y,m,E,S){return(y*S+m*E)/(E+S)}function en(y){return typeof y===ce}function fn(y){return y&&typeof y===de}function Rt(y){return Array.isArray(y)}function Xn(y){return typeof y===rn}function Bn(y){return typeof y===Ee}function xr(y){return typeof y===we}function dr(y,m){var E=y===""||y==" ",S=m===""||m==" ";return S&&E||y===m}function Ur(y,m,E,S,D){var J=fa(y,m,E);return J?E:Ea(y,m,E+1,S,D)}function fa(y,m,E){if(!y.ignore)return null;var S=m.slice(Math.max(E-3,0),E+3).join("");return new RegExp(y.ignore).exec(S)}function Ea(y,m,E,S,D){for(var J=function(Bt){var qt=m[Bt].trim();if(qt===y.close&&!fa(y,m,Bt))return{value:Bt};var Zt=Bt,Ht=Sr(D,function(be){var _e=be.open;return _e===qt});if(Ht&&(Zt=Ur(Ht,m,Bt,S,D)),Zt===-1)return ct=Bt,"break";Bt=Zt,ct=Bt},ct,vt=E;vt<S;++vt){var It=J(vt);if(vt=ct,typeof It=="object")return It.value;if(It==="break")break}return-1}function aa(y,m){var E=Xn(m)?{separator:m}:m,S=E.separator,D=S===void 0?",":S,J=E.isSeparateFirst,ct=E.isSeparateOnlyOpenClose,vt=E.isSeparateOpenClose,It=vt===void 0?ct:vt,Bt=E.openCloseCharacters,qt=Bt===void 0?ke:Bt,Zt=qt.map(function(gr){var Br=gr.open,Tr=gr.close;return Br===Tr?Br:Br+"|"+Tr}).join("|"),Ht="(\\s*"+D+"\\s*|"+Zt+"|\\s+)",be=new RegExp(Ht,"g"),_e=y.split(be).filter(function(gr){return gr&&gr!=="undefined"}),Ue=_e.length,nn=[],hn=[];function On(){return hn.length?(nn.push(hn.join("")),hn=[],!0):!1}for(var er=function(gr){var Br=_e[gr].trim(),Tr=gr,sa=Sr(qt,function(la){var ka=la.open;return ka===Br}),Gr=Sr(qt,function(la){var ka=la.close;return ka===Br});if(sa){if(Tr=Ur(sa,_e,gr,Ue,qt),Tr!==-1&&It)return On()&&J||(nn.push(_e.slice(gr,Tr+1).join("")),gr=Tr,J)?(Yn=gr,"break"):(Yn=gr,"continue")}else if(Gr&&!fa(Gr,_e,gr)){var va=bt(qt);return va.splice(qt.indexOf(Gr),1),{value:aa(y,{separator:D,isSeparateFirst:J,isSeparateOnlyOpenClose:ct,isSeparateOpenClose:It,openCloseCharacters:va})}}else if(dr(Br,D)&&!ct)return On(),J?(Yn=gr,"break"):(Yn=gr,"continue");Tr===-1&&(Tr=Ue-1),hn.push(_e.slice(gr,Tr+1).join("")),gr=Tr,Yn=gr},Yn,Ir=0;Ir<Ue;++Ir){var Un=er(Ir);if(Ir=Yn,typeof Un=="object")return Un.value;if(Un==="break")break}return hn.length&&nn.push(hn.join("")),nn}function Da(y){return aa(y,"")}function Lr(y){return aa(y,",")}function _n(y){var m=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(y);return!m||m.length<4?{}:{prefix:m[1],value:m[2],suffix:m[3]}}function sr(y){var m=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(y);if(!m)return{prefix:"",unit:"",value:NaN};var E=m[1],S=m[2],D=m[3];return{prefix:E,unit:D,value:parseFloat(S)}}function Pn(y){return y.replace(/[\s-_]+([^\s-_])/g,function(m,E){return E.toUpperCase()})}function tr(y,m){return m===void 0&&(m="-"),y.replace(/([a-z])([A-Z])/g,function(E,S,D){return""+S+m+D.toLowerCase()})}function zn(y){return[].slice.call(y)}function Wr(){return Date.now?Date.now():new Date().getTime()}function Yr(y,m,E){E===void 0&&(E=-1);for(var S=y.length,D=0;D<S;++D)if(m(y[D],D,y))return D;return E}function nr(y,m,E){E===void 0&&(E=-1);for(var S=y.length,D=S-1;D>=0;--D)if(m(y[D],D,y))return D;return E}function wr(y,m,E){var S=nr(y,m);return S>-1?y[S]:E}function Sr(y,m,E){var S=Yr(y,m);return S>-1?y[S]:E}var pr=function(){var y=Wr(),m=Oe&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return m?m.bind(window):function(E){var S=Wr(),D=setTimeout(function(){E(S-y)},1e3/60);return D}}(),qr=function(){var y=Oe&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return y?y.bind(window):function(m){clearTimeout(m)}}();function ua(y){return Object.keys(y)}function $r(y){var m=ua(y);return m.map(function(E){return y[E]})}function ba(y){var m=ua(y);return m.map(function(E){return[E,y[E]]})}function gt(y,m){m===void 0&&(m=[]),y.sort(function(E,S){var D=m.indexOf(E),J=m.indexOf(S);return J===-1&&D===-1?0:D===-1?1:J===-1?-1:D-J})}function Dn(y,m){var E=sr(y),S=E.value,D=E.unit;if(fn(m)){var J=m[D];if(J){if(xr(J))return J(S);if(Ft[D])return Ft[D](S,J)}}else if(D==="%")return S*m/100;return Ft[D]?Ft[D](S):S}function un(y,m,E){return Math.max(m,Math.min(y,E))}function Lt(y,m,E,S){return S===void 0&&(S=y[0]/y[1]),[[Xt(m[0],Ve),Xt(m[0]/S,Ve)],[Xt(m[1]*S,Ve),Xt(m[1],Ve)]].filter(function(D){return D.every(function(J,ct){var vt=m[ct],It=Xt(vt,Ve);return E?J<=vt||J<=It:J>=vt||J>=It})})[0]||y}function Ot(y,m,E,S){if(!S)return y.map(function(be,_e){return un(be,m[_e],E[_e])});var D=y[0],J=y[1],ct=S===!0?D/J:S,vt=Lt(y,m,!1,ct),It=vt[0],Bt=vt[1],qt=Lt(y,E,!0,ct),Zt=qt[0],Ht=qt[1];return D<It||J<Bt?(D=It,J=Bt):(D>Zt||J>Ht)&&(D=Zt,J=Ht),[D,J]}function it(y){for(var m=y.length,E=0,S=m-1;S>=0;--S)E+=y[S];return E}function H(y){for(var m=y.length,E=0,S=m-1;S>=0;--S)E+=y[S];return m?E/m:0}function X(y,m){var E=m[0]-y[0],S=m[1]-y[1],D=Math.atan2(S,E);return D>=0?D:D+Math.PI*2}function xt(y){return[0,1].map(function(m){return H(y.map(function(E){return E[m]}))})}function zt(y){var m=xt(y),E=X(m,y[0]),S=X(m,y[1]);return E<S&&S-E<Math.PI||E>S&&S-E<-Math.PI?1:-1}function Vt(y,m){return Math.sqrt(Math.pow((m?m[0]:0)-y[0],2)+Math.pow((m?m[1]:0)-y[1],2))}function Xt(y,m){if(!m)return y;var E=1/m;return Math.round(y/m)/E}function ne(y,m){return y.forEach(function(E,S){y[S]=Xt(y[S],m)}),y}function on(y){for(var m=[],E=0;E<y;++E)m.push(E);return m}function tn(y,m,E){var S=!1;return y.replace(m,function(){for(var D=[],J=0;J<arguments.length;J++)D[J]=arguments[J];return S?D[0]:(S=!0,Xn(E)?E:E.apply(void 0,D))})}function He(y){return y.reduce(function(m,E){return m.concat(E)},[])}function Qn(y){return y.reduce(function(m,E){return Rt(E)?m.push.apply(m,Qn(E)):m.push(E),m},[])}function Ln(y,m){y.indexOf(m)===-1&&y.push(m)}function Qr(y){return y.replace("#","")}function Ia(y){var m=Qr(y),E=parseInt(m.substring(0,2),16),S=parseInt(m.substring(2,4),16),D=parseInt(m.substring(4,6),16),J=parseInt(m.substring(6,8),16)/255;return isNaN(J)&&(J=1),[E,S,D,J]}function Jn(y){var m=y.charAt(1),E=y.charAt(2),S=y.charAt(3),D=y.charAt(4),J=["#",m,m,E,E,S,S,D,D];return J.join("")}function Ar(y){var m,E=y[0],S=y[1],D=y[2];E<0&&(E+=Math.floor((Math.abs(E)+360)/360)*360),E%=360;var J=(1-Math.abs(2*D-1))*S,ct=J*(1-Math.abs(E/60%2-1)),vt=D-J/2,It;return E<60?It=[J,ct,0]:E<120?It=[ct,J,0]:E<180?It=[0,J,ct]:E<240?It=[0,ct,J]:E<300?It=[ct,0,J]:E<360?It=[J,0,ct]:It=[0,0,0],[Math.round((It[0]+vt)*255),Math.round((It[1]+vt)*255),Math.round((It[2]+vt)*255),(m=y[3])!==null&&m!==void 0?m:1]}function na(y){if(y.charAt(0)==="#")return y.length===4||y.length===5?Ia(Jn(y)):Ia(y);if(y.indexOf("(")!==-1){var m=_n(y),E=m.prefix,S=m.value;if(!E||!S)return;var D=Lr(S),J=[0,0,0,1],ct=D.length;switch(E){case Ut:case ue:for(var vt=0;vt<ct;++vt)J[vt]=parseFloat(D[vt]);return J;case se:case Le:for(var vt=0;vt<ct;++vt)D[vt].indexOf("%")!==-1?J[vt]=parseFloat(D[vt])/100:J[vt]=parseFloat(D[vt]);return Ar(J)}}}function za(y,m){return Ze?m?Ze.querySelectorAll(y):Ze.querySelector(y):m?[]:null}function da(y,m){return y.classList?y.classList.contains(m):!!y.className.match(new RegExp("(\\s|^)"+m+"(\\s|$)"))}function Ti(y,m){y.classList?y.classList.add(m):y.className+=" "+m}function ki(y,m){if(y.classList)y.classList.remove(m);else{var E=new RegExp("(\\s|^)"+m+"(\\s|$)");y.className=y.className.replace(E," ")}}function vi(y,m){if(!y||!m||!m.length)return{};var E;if(y instanceof Element)E=y;else if(y.length)E=y[0];else return{};for(var S={},D=dn(E).getComputedStyle(E),J=m.length,ct=0;ct<J;++ct)S[m[ct]]=D[m[ct]];return S}function ii(y,m,E,S){y.addEventListener(m,E,S)}function Di(y,m,E,S){y.removeEventListener(m,E,S)}function Ra(y){return(y==null?void 0:y.ownerDocument)||Ze}function ln(y){return Ra(y).documentElement}function De(y){return Ra(y).body}function dn(y){var m;return((m=y==null?void 0:y.ownerDocument)===null||m===void 0?void 0:m.defaultView)||window}function Wn(y){return y&&"postMessage"in y&&"blur"in y&&"self"in y}function Gn(y){return fn(y)&&y.nodeName&&y.nodeType&&"ownerDocument"in y}function Kn(y,m,E,S,D,J){for(var ct=0;ct<D;++ct){var vt=E+ct*D,It=S+ct*D;y[vt]+=y[It]*J,m[vt]+=m[It]*J}}function Rr(y,m,E,S,D){for(var J=0;J<D;++J){var ct=E+J*D,vt=S+J*D,It=y[ct],Bt=m[ct];y[ct]=y[vt],y[vt]=It,m[ct]=m[vt],m[vt]=Bt}}function xa(y,m,E,S,D){for(var J=0;J<S;++J){var ct=E+J*S;y[ct]/=D,m[ct]/=D}}function La(y,m,E){E===void 0&&(E=Math.sqrt(y.length));for(var S=y.slice(),D=0;D<E;++D)S[D*E+m-1]=0,S[(m-1)*E+D]=0;return S[(m-1)*(E+1)]=1,S}function ui(y,m){m===void 0&&(m=Math.sqrt(y.length));for(var E=y.slice(),S=Wi(m),D=0;D<m;++D){var J=m*D+D;if(!Xt(E[J],Ve)){for(var ct=D+1;ct<m;++ct)if(E[m*D+ct]){Rr(E,S,D,ct,m);break}}if(!Xt(E[J],Ve))return[];xa(E,S,D,m,E[J]);for(var ct=0;ct<m;++ct){var vt=ct,It=ct+D*m,Bt=E[It];!Xt(Bt,Ve)||D===ct||Kn(E,S,vt,D,m,-Bt)}}return S}function Fi(y,m){m===void 0&&(m=Math.sqrt(y.length));for(var E=[],S=0;S<m;++S)for(var D=0;D<m;++D)E[D*m+S]=y[m*S+D];return E}function Ki(y,m){m===void 0&&(m=Math.sqrt(y.length));for(var E=[],S=y[m*m-1],D=0;D<m-1;++D)E[D]=y[m*(m-1)+D]/S;return E[m-1]=0,E}function xo(y,m){for(var E=Wi(m),S=0;S<m-1;++S)E[m*(m-1)+S]=y[S]||0;return E}function vo(y,m){for(var E=y.slice(),S=y.length;S<m-1;++S)E[S]=0;return E[m-1]=1,E}function es(y,m,E){if(m===void 0&&(m=Math.sqrt(y.length)),m===E)return y;for(var S=Wi(E),D=Math.min(m,E),J=0;J<D-1;++J){for(var ct=0;ct<D-1;++ct)S[J*E+ct]=y[J*m+ct];S[(J+1)*E-1]=y[(J+1)*m-1],S[(E-1)*E+J]=y[(m-1)*m+J]}return S[E*E-1]=y[m*m-1],S}function Wo(y){for(var m=[],E=1;E<arguments.length;E++)m[E-1]=arguments[E];var S=Wi(y);return m.forEach(function(D){S=Zi(S,D,y)}),S}function Zi(y,m,E){E===void 0&&(E=Math.sqrt(y.length));var S=[],D=y.length/E,J=m.length/D;if(D){if(!J)return y}else return m;for(var ct=0;ct<E;++ct)for(var vt=0;vt<J;++vt){S[vt*E+ct]=0;for(var It=0;It<D;++It)S[vt*E+ct]+=y[It*E+ct]*m[vt*D+It]}return S}function bi(y,m){for(var E=Math.min(y.length,m.length),S=y.slice(),D=0;D<E;++D)S[D]=S[D]+m[D];return S}function gi(y,m){for(var E=Math.min(y.length,m.length),S=y.slice(),D=0;D<E;++D)S[D]=S[D]-m[D];return S}function ms(y,m){return m===void 0&&(m=y.length===6),m?[y[0],y[1],0,y[2],y[3],0,y[4],y[5],1]:y}function Do(y,m){return m===void 0&&(m=y.length===9),m?[y[0],y[1],y[3],y[4],y[6],y[7]]:y}function To(y,m,E){E===void 0&&(E=m.length);var S=Zi(y,m,E),D=S[E-1];return S.map(function(J){return J/D})}function Zs(y,m){return Zi(y,[1,0,0,0,0,Math.cos(m),Math.sin(m),0,0,-Math.sin(m),Math.cos(m),0,0,0,0,1],4)}function Eu(y,m){return Zi(y,[Math.cos(m),0,-Math.sin(m),0,0,1,0,0,Math.sin(m),0,Math.cos(m),0,0,0,0,1],4)}function as(y,m){return Zi(y,Zo(m,4))}function Rs(y,m){var E=m[0],S=E===void 0?1:E,D=m[1],J=D===void 0?1:D,ct=m[2],vt=ct===void 0?1:ct;return Zi(y,[S,0,0,0,0,J,0,0,0,0,vt,0,0,0,0,1],4)}function Su(y,m){return To(Zo(m,3),vo(y,3))}function fu(y,m){var E=m[0],S=E===void 0?0:E,D=m[1],J=D===void 0?0:D,ct=m[2],vt=ct===void 0?0:ct;return Zi(y,[1,0,0,0,0,1,0,0,0,0,1,0,S,J,vt,1],4)}function Is(y,m){return Zi(y,m,4)}function Zo(y,m){var E=Math.cos(y),S=Math.sin(y),D=Wi(m);return D[0]=E,D[1]=S,D[m]=-S,D[m+1]=E,D}function Wi(y){for(var m=y*y,E=[],S=0;S<m;++S)E[S]=S%(y+1)?0:1;return E}function ys(y,m){for(var E=Wi(m),S=Math.min(y.length,m-1),D=0;D<S;++D)E[(m+1)*D]=y[D];return E}function is(y,m){for(var E=Wi(m),S=Math.min(y.length,m-1),D=0;D<S;++D)E[m*(m-1)+D]=y[D];return E}function Us(y,m,E,S,D,J,ct,vt){var It=y[0],Bt=y[1],qt=m[0],Zt=m[1],Ht=E[0],be=E[1],_e=S[0],Ue=S[1],nn=D[0],hn=D[1],On=J[0],er=J[1],Yn=ct[0],Ir=ct[1],Un=vt[0],gr=vt[1],Br=[It,0,qt,0,Ht,0,_e,0,Bt,0,Zt,0,be,0,Ue,0,1,0,1,0,1,0,1,0,0,It,0,qt,0,Ht,0,_e,0,Bt,0,Zt,0,be,0,Ue,0,1,0,1,0,1,0,1,-nn*It,-hn*It,-On*qt,-er*qt,-Yn*Ht,-Ir*Ht,-Un*_e,-gr*_e,-nn*Bt,-hn*Bt,-On*Zt,-er*Zt,-Yn*be,-Ir*be,-Un*Ue,-gr*Ue],Tr=ui(Br,8);if(!Tr.length)return[];var sa=Zi(Tr,[nn,hn,On,er,Yn,Ir,Un,gr],8);return sa[8]=1,es(Fi(sa),3,4)}function Du(y){return[0,1].map(function(m){return average(y.map(function(E){return E[m]}))})}var qs=function(){return qs=Object.assign||function(m){for(var E,S=1,D=arguments.length;S<D;S++){E=arguments[S];for(var J in E)Object.prototype.hasOwnProperty.call(E,J)&&(m[J]=E[J])}return m},qs.apply(this,arguments)};function Cu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ji(y,m){return m===void 0&&(m=0),Ws(Ss(y,m))}function Bi(y){return ji(getComputedStyle(y).transform)}function Ms(y,m){var E=To(y,[m[0],m[1]||0,m[2]||0,1],4),S=E[3]||1;return[E[0]/S,E[1]/S,E[2]/S]}function os(y,m){m===void 0&&(m=document.body);for(var E=y,S=Cu();E;){var D=getComputedStyle(E).transform;if(S=matrix3d(ji(D),S),E===m)break;E=E.parentElement}return S=invert(S,4),S[12]=0,S[13]=0,S[14]=0,S}function Ws(y){var m=Cu();return y.forEach(function(E){var S=E.matrixFunction,D=E.functionValue;!S||(m=S(m,D))}),m}function Ss(y,m){m===void 0&&(m=0);var E=Rt(y)?y:Da(y);return E.map(function(S){var D=_n(S),J=D.prefix,ct=D.value,vt=null,It=J,Bt="";if(J==="translate"||J==="translateX"||J==="translate3d"){var qt=fn(m)?qs(qs({},m),{"o%":m["%"]}):{"%":m,"o%":m},Zt=Lr(ct).map(function(la,ka){return ka===0&&"x%"in qt?qt["%"]=m["x%"]:ka===1&&"y%"in qt?qt["%"]=m["y%"]:qt["%"]=m["o%"],Dn(la,qt)}),Ht=Zt[0],be=Zt[1],_e=be===void 0?0:be,Ue=Zt[2],nn=Ue===void 0?0:Ue;vt=fu,Bt=[Ht,_e,nn]}else if(J==="translateY"){var hn=fn(m)?qs({"%":m["y%"]},m):{"%":m},_e=Dn(ct,hn);vt=fu,Bt=[0,_e,0]}else if(J==="translateZ"){var nn=parseFloat(ct);vt=fu,Bt=[0,0,nn]}else if(J==="scale"||J==="scale3d"){var On=Lr(ct).map(function(la){return parseFloat(la)}),er=On[0],Yn=On[1],Ir=Yn===void 0?er:Yn,Un=On[2],gr=Un===void 0?1:Un;vt=Rs,Bt=[er,Ir,gr]}else if(J==="scaleX"){var er=parseFloat(ct);vt=Rs,Bt=[er,1,1]}else if(J==="scaleY"){var Ir=parseFloat(ct);vt=Rs,Bt=[1,Ir,1]}else if(J==="scaleZ"){var gr=parseFloat(ct);vt=Rs,Bt=[1,1,gr]}else if(J==="rotate"||J==="rotateZ"||J==="rotateX"||J==="rotateY"){var Br=sr(ct),Tr=Br.unit,sa=Br.value,Gr=Tr==="rad"?sa:sa*Math.PI/180;J==="rotate"||J==="rotateZ"?(It="rotateZ",vt=as):J==="rotateX"?vt=Zs:J==="rotateY"&&(vt=Eu),Bt=Gr}else if(J==="matrix3d")vt=Is,Bt=Lr(ct).map(function(la){return parseFloat(la)});else if(J==="matrix"){var va=Lr(ct).map(function(la){return parseFloat(la)});vt=Is,Bt=[va[0],va[1],0,0,va[2],va[3],0,0,0,0,1,0,va[4],va[5],0,1]}else It="";return{name:J,functionName:It,value:ct,matrixFunction:vt,functionValue:Bt}})}var Qs=function(){function y(){this.keys=[],this.values=[]}var m=y.prototype;return m.get=function(E){return this.values[this.keys.indexOf(E)]},m.set=function(E,S){var D=this.keys,J=this.values,ct=D.indexOf(E),vt=ct===-1?D.length:ct;D[vt]=E,J[vt]=S},y}(),Qu=function(){function y(){this.object={}}var m=y.prototype;return m.get=function(E){return this.object[E]},m.set=function(E,S){this.object[E]=S},y}(),xn=typeof Map=="function",Vr=function(){function y(){}var m=y.prototype;return m.connect=function(E,S){this.prev=E,this.next=S,E&&(E.next=this),S&&(S.prev=this)},m.disconnect=function(){var E=this.prev,S=this.next;E&&(E.next=S),S&&(S.prev=E)},m.getIndex=function(){for(var E=this,S=-1;E;)E=E.prev,++S;return S},y}();function pa(y,m){var E=[],S=[];return y.forEach(function(D){var J=D[0],ct=D[1],vt=new Vr;E[J]=vt,S[ct]=vt}),E.forEach(function(D,J){D.connect(E[J-1])}),y.filter(function(D,J){return!m[J]}).map(function(D,J){var ct=D[0],vt=D[1];if(ct===vt)return[0,0];var It=E[ct],Bt=S[vt-1],qt=It.getIndex();It.disconnect(),Bt?It.connect(Bt,Bt.next):It.connect(void 0,E[0]);var Zt=It.getIndex();return[qt,Zt]})}var Fa=function(){function y(E,S,D,J,ct,vt,It,Bt){this.prevList=E,this.list=S,this.added=D,this.removed=J,this.changed=ct,this.maintained=vt,this.changedBeforeAdded=It,this.fixed=Bt}var m=y.prototype;return Object.defineProperty(m,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(m,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),m.caculateOrdered=function(){var E=pa(this.changedBeforeAdded,this.fixed),S=this.changed,D=[];this.cacheOrdered=E.filter(function(J,ct){var vt=J[0],It=J[1],Bt=S[ct],qt=Bt[0],Zt=Bt[1];if(vt!==It)return D.push([qt,Zt]),!0}),this.cachePureChanged=D},y}();function Vi(y,m,E){var S=xn?Map:E?Qu:Qs,D=E||function(On){return On},J=[],ct=[],vt=[],It=y.map(D),Bt=m.map(D),qt=new S,Zt=new S,Ht=[],be=[],_e={},Ue=[],nn=0,hn=0;return It.forEach(function(On,er){qt.set(On,er)}),Bt.forEach(function(On,er){Zt.set(On,er)}),It.forEach(function(On,er){var Yn=Zt.get(On);typeof Yn=="undefined"?(++hn,ct.push(er)):_e[Yn]=hn}),Bt.forEach(function(On,er){var Yn=qt.get(On);typeof Yn=="undefined"?(J.push(er),++nn):(vt.push([Yn,er]),hn=_e[er]||0,Ht.push([Yn-hn,er-nn]),be.push(er===Yn),Yn!==er&&Ue.push([Yn,er]))}),ct.reverse(),new Fa(y,m,J,ct,Ue,vt,Ht,be)}var Ao=function(){function y(E,S){E===void 0&&(E=[]),this.findKeyCallback=S,this.list=[].slice.call(E)}var m=y.prototype;return m.update=function(E){var S=[].slice.call(E),D=Vi(this.list,S,this.findKeyCallback);return this.list=S,D},y}(),ao=Ao;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var So=function(y,m){return So=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,S){E.__proto__=S}||function(E,S){for(var D in S)S.hasOwnProperty(D)&&(E[D]=S[D])},So(y,m)};function Ts(y,m){So(y,m);function E(){this.constructor=y}y.prototype=m===null?Object.create(m):(E.prototype=m.prototype,new E)}var fo=typeof Map=="function"?void 0:function(){var y=0;return function(m){return m.__DIFF_KEY__||(m.__DIFF_KEY__=++y)}}(),ou=function(y){Ts(m,y);function m(E){return E===void 0&&(E=[]),y.call(this,E,fo)||this}return m}(ao);function Cs(y,m){return Vi(y,m,fo)}var Au=ou;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Tl=function(){return Tl=Object.assign||function(m){for(var E,S=1,D=arguments.length;S<D;S++){E=arguments[S];for(var J in E)Object.prototype.hasOwnProperty.call(E,J)&&(m[J]=E[J])}return m},Tl.apply(this,arguments)};function bl(){for(var y=0,m=0,E=arguments.length;m<E;m++)y+=arguments[m].length;for(var S=Array(y),D=0,m=0;m<E;m++)for(var J=arguments[m],ct=0,vt=J.length;ct<vt;ct++,D++)S[D]=J[ct];return S}var Js=function(){function y(){this._events={}}var m=y.prototype;return m.on=function(E,S){if(fn(E))for(var D in E)this.on(D,E[D]);else this._addEvent(E,S,{});return this},m.off=function(E,S){if(!E)this._events={};else if(fn(E))for(var D in E)this.off(D);else if(!S)this._events[E]=[];else{var J=this._events[E];if(J){var ct=Yr(J,function(vt){return vt.listener===S});ct>-1&&J.splice(ct,1)}}return this},m.once=function(E,S){var D=this;return S&&this._addEvent(E,S,{once:!0}),new Promise(function(J){D._addEvent(E,J,{once:!0})})},m.emit=function(E,S){var D=this;S===void 0&&(S={});var J=this._events[E];if(!E||!J)return!0;var ct=!1;return S.eventType=E,S.stop=function(){ct=!0},S.currentTarget=this,bl(J).forEach(function(vt){vt.listener(S),vt.once&&D.off(E,vt.listener)}),!ct},m.trigger=function(E,S){return S===void 0&&(S={}),this.emit(E,S)},m._addEvent=function(E,S,D){var J=this._events;J[E]=J[E]||[];var ct=J[E];ct.push(Tl({listener:S},D))},y}(),ul=Js;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Mu=function(y,m){return Mu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,S){E.__proto__=S}||function(E,S){for(var D in S)S.hasOwnProperty(D)&&(E[D]=S[D])},Mu(y,m)};function Pu(y,m){Mu(y,m);function E(){this.constructor=y}y.prototype=m===null?Object.create(m):(E.prototype=m.prototype,new E)}var Nu=function(){return Nu=Object.assign||function(m){for(var E,S=1,D=arguments.length;S<D;S++){E=arguments[S];for(var J in E)Object.prototype.hasOwnProperty.call(E,J)&&(m[J]=E[J])}return m},Nu.apply(this,arguments)};function fs(y){var m=y.container;return m===document.body?[m.scrollLeft||document.documentElement.scrollLeft,m.scrollTop||document.documentElement.scrollTop]:[m.scrollLeft,m.scrollTop]}function Bs(y,m){return y.addEventListener("scroll",m),function(){y.removeEventListener("scroll",m)}}function gu(y){if(y){if(Xn(y))return document.querySelector(y)}else return null;if(xr(y))return y();if(y instanceof Element)return y;if("current"in y)return y.current;if("value"in y)return y.value}var Fu=function(y){Pu(m,y);function m(){var S=y!==null&&y.apply(this,arguments)||this;return S._startRect=null,S._startPos=[],S._prevTime=0,S._timer=0,S._prevScrollPos=[0,0],S._isWait=!1,S._flag=!1,S._currentOptions=null,S._lock=!1,S._unregister=null,S._onScroll=function(){var D=S._currentOptions;S._lock||!D||S.emit("scrollDrag",{next:function(J){S.checkScroll({container:D.container,inputEvent:J})}})},S}var E=m.prototype;return E.dragStart=function(S,D){var J=gu(D.container);if(!J){this._flag=!1;return}var ct=0,vt=0,It=0,Bt=0;if(J===document.body)It=window.innerWidth,Bt=window.innerHeight;else{var qt=J.getBoundingClientRect();ct=qt.top,vt=qt.left,It=qt.width,Bt=qt.height}this._flag=!0,this._startPos=[S.clientX,S.clientY],this._startRect={top:ct,left:vt,width:It,height:Bt},this._prevScrollPos=this._getScrollPosition([0,0],D),this._currentOptions=D,this._registerScrollEvent(D)},E.drag=function(S,D){if(clearTimeout(this._timer),!!this._flag){var J=S.clientX,ct=S.clientY,vt=D.threshold,It=vt===void 0?0:vt,Bt=this,qt=Bt._startRect,Zt=Bt._startPos;this._currentOptions=D;var Ht=[0,0];return qt.top>ct-It?(Zt[1]>qt.top||ct<Zt[1])&&(Ht[1]=-1):qt.top+qt.height<ct+It&&(Zt[1]<qt.top+qt.height||ct>Zt[1])&&(Ht[1]=1),qt.left>J-It?(Zt[0]>qt.left||J<Zt[0])&&(Ht[0]=-1):qt.left+qt.width<J+It&&(Zt[0]<qt.left+qt.width||J>Zt[0])&&(Ht[0]=1),!Ht[0]&&!Ht[1]?!1:this._continueDrag(Nu(Nu({},D),{direction:Ht,inputEvent:S,isDrag:!0}))}},E.checkScroll=function(S){var D=this;if(this._isWait)return!1;var J=S.prevScrollPos,ct=J===void 0?this._prevScrollPos:J,vt=S.direction,It=S.throttleTime,Bt=It===void 0?0:It,qt=S.inputEvent,Zt=S.isDrag,Ht=this._getScrollPosition(vt||[0,0],S),be=Ht[0]-ct[0],_e=Ht[1]-ct[1],Ue=vt||[be?Math.abs(be)/be:0,_e?Math.abs(_e)/_e:0];return this._prevScrollPos=Ht,this._lock=!1,!be&&!_e?!1:(this.emit("move",{offsetX:Ue[0]?be:0,offsetY:Ue[1]?_e:0,inputEvent:qt}),Bt&&Zt&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){D._continueDrag(S)},Bt)),!0)},E.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},E._getScrollPosition=function(S,D){var J=D.container,ct=D.getScrollPosition,vt=ct===void 0?fs:ct;return vt({container:gu(J),direction:S})},E._continueDrag=function(S){var D=this,J,ct=S.container,vt=S.direction,It=S.throttleTime,Bt=S.useScroll,qt=S.isDrag,Zt=S.inputEvent;if(!(!this._flag||qt&&this._isWait)){var Ht=Wr(),be=Math.max(It+this._prevTime-Ht,0);if(be>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){D._continueDrag(S)},be),!1;this._prevTime=Ht;var _e=this._getScrollPosition(vt,S);this._prevScrollPos=_e,qt&&(this._isWait=!0),Bt||(this._lock=!0);var Ue={container:gu(ct),direction:vt,inputEvent:Zt};return(J=S.requestScroll)===null||J===void 0||J.call(S,Ue),this.emit("scroll",Ue),this._isWait=!1,Bt||this.checkScroll(Nu(Nu({},S),{prevScrollPos:_e,direction:vt,inputEvent:Zt}))}},E._registerScrollEvent=function(S){this._unregisterScrollEvent();var D=S.checkScrollEvent;if(!!D){var J=D===!0?Bs:D,ct=gu(S.container);D===!0&&(ct===document.body||ct===document.documentElement)?this._unregister=Bs(window,this._onScroll):this._unregister=J(ct,this._onScroll)}},E._unregisterScrollEvent=function(){var S;(S=this._unregister)===null||S===void 0||S.call(this),this._unregister=null},m}(ul),Wu=Fu;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Ju(){for(var y=0,m=0,E=arguments.length;m<E;m++)y+=arguments[m].length;for(var S=Array(y),D=0,m=0;m<E;m++)for(var J=arguments[m],ct=0,vt=J.length;ct<vt;ct++,D++)S[D]=J[ct];return S}function tu(y){return Xt(y,Ve)}function gc(y,m){return y.every(function(E,S){return tu(E-m[S])===0})}function Bl(y,m){return!tu(y[0]-m[0])&&!tu(y[1]-m[1])}function vl(y){return y.reduce(function(m,E){return m.push.apply(m,E),m},[])}function Ls(y){return y.length<3?0:Math.abs(it(y.map(function(m,E){var S=y[E+1]||y[0];return m[0]*S[1]-S[0]*m[1]})))/2}function el(y,m){var E=m.width,S=m.height,D=m.left,J=m.top,ct=oc(y),vt=ct.minX,It=ct.minY,Bt=ct.maxX,qt=ct.maxY,Zt=E/(Bt-vt),Ht=S/(qt-It);return y.map(function(be){return[D+(be[0]-vt)*Zt,J+(be[1]-It)*Ht]})}function oc(y){var m=y.map(function(S){return S[0]}),E=y.map(function(S){return S[1]});return{minX:Math.min.apply(Math,m),minY:Math.min.apply(Math,E),maxX:Math.max.apply(Math,m),maxY:Math.max.apply(Math,E)}}function Ol(y,m,E){var S=y[0],D=y[1],J=oc(m),ct=J.minX,vt=J.maxX,It=[[ct,D],[vt,D]],Bt=Se(It[0],It[1]),qt=bn(m),Zt=[];if(qt.forEach(function(_e){var Ue=Se(_e[0],_e[1]),nn=_e[0];if(gc(Bt,Ue))Zt.push({pos:y,line:_e,type:"line"});else{var hn=me(ve(Bt,Ue),[It,_e]);hn.forEach(function(On){_e.some(function(er){return Bl(er,On)})?Zt.push({pos:On,line:_e,type:"point"}):tu(nn[1]-D)!==0&&Zt.push({pos:On,line:_e,type:"intersection"})})}}),!E&&Sr(Zt,function(_e){return _e[0]===S}))return!0;var Ht=0,be={};return Zt.forEach(function(_e){var Ue=_e.pos,nn=_e.type,hn=_e.line;if(!(Ue[0]>S))if(nn==="intersection")++Ht;else{if(nn==="line")return;if(nn==="point"){var On=Sr(hn,function(Ir){return Ir[1]!==D}),er=be[Ue[0]],Yn=On[1]>D?1:-1;er?er!==Yn&&++Ht:be[Ue[0]]=Yn}}}),Ht%2==1}function Ic(y,m){var E=y[0],S=y[1],D=y[2];return(E*m[0]+S*m[1]+D)/(E*E+S*S)}function Se(y,m){var E=y[0],S=y[1],D=m[0],J=m[1],ct=D-E,vt=J-S;Math.abs(ct)<Ve&&(ct=0),Math.abs(vt)<Ve&&(vt=0);var It=0,Bt=0,qt=0;return ct?vt?(It=-vt/ct,Bt=1,qt=-It*E-S):(Bt=1,qt=-S):vt&&(It=-1,qt=E),[It,Bt,qt]}function ve(y,m){var E=y[0],S=y[1],D=y[2],J=m[0],ct=m[1],vt=m[2],It=E===0&&J===0,Bt=S===0&&ct===0,qt=[];if(It&&Bt)return[];if(It){var Zt=-D/S,Ht=-vt/ct;return Zt!==Ht?[]:[[-Infinity,Zt],[Infinity,Zt]]}else if(Bt){var be=-D/E,_e=-vt/J;return be!==_e?[]:[[be,-Infinity],[be,Infinity]]}else if(E===0){var Ue=-D/S,nn=-(ct*Ue+vt)/J;qt=[[nn,Ue]]}else if(J===0){var Ue=-vt/ct,nn=-(S*Ue+D)/E;qt=[[nn,Ue]]}else if(S===0){var nn=-D/E,Ue=-(J*nn+vt)/ct;qt=[[nn,Ue]]}else if(ct===0){var nn=-vt/J,Ue=-(E*nn+D)/S;qt=[[nn,Ue]]}else{var nn=(S*vt-ct*D)/(ct*E-S*J),Ue=-(E*nn+D)/S;qt=[[nn,Ue]]}return qt.map(function(hn){return[hn[0],hn[1]]})}function Gt(y,m,E){var S=ve(Se(y[0],y[1]),Se(m[0],m[1]));return E?me(S,[y,m]):S}function re(y,m){var E=Se(m[0],m[1]);return tu(Ic(E,y))===0}function me(y,m){var E=m.map(function(Zt){return[0,1].map(function(Ht){return[Math.min(Zt[0][Ht],Zt[1][Ht]),Math.max(Zt[0][Ht],Zt[1][Ht])]})}),S=[];if(y.length===2){var D=y[0],J=D[0],ct=D[1];if(tu(J-y[1][0])){if(!tu(ct-y[1][1])){var Bt=Math.max.apply(Math,E.map(function(Zt){return Zt[0][0]})),qt=Math.min.apply(Math,E.map(function(Zt){return Zt[0][1]}));if(tu(Bt-qt)>0)return[];S=[[Bt,ct],[qt,ct]]}}else{var vt=Math.max.apply(Math,E.map(function(Zt){return Zt[1][0]})),It=Math.min.apply(Math,E.map(function(Zt){return Zt[1][1]}));if(tu(vt-It)>0)return[];S=[[J,vt],[J,It]]}}return S.length||(S=y.filter(function(Zt){var Ht=Zt[0],be=Zt[1];return E.every(function(_e){return 0<=tu(Ht-_e[0][0])&&0<=tu(_e[0][1]-Ht)&&0<=tu(be-_e[1][0])&&0<=tu(_e[1][1]-be)})})),S.map(function(Zt){return[tu(Zt[0]),tu(Zt[1])]})}function bn(y){return Ju(y.slice(1),[y[0]]).map(function(m,E){return[y[E],m]})}function Zn(y,m){var E=y.slice(),S=m.slice();zt(E)===-1&&E.reverse(),zt(S)===-1&&S.reverse();var D=bn(E),J=bn(S),ct=D.map(function(qt){return Se(qt[0],qt[1])}),vt=J.map(function(qt){return Se(qt[0],qt[1])}),It=[];ct.forEach(function(qt,Zt){var Ht=D[Zt],be=[];vt.forEach(function(_e,Ue){var nn=ve(qt,_e),hn=me(nn,[Ht,J[Ue]]);be.push.apply(be,hn.map(function(On){return{index1:Zt,index2:Ue,pos:On,type:"intersection"}}))}),be.sort(function(_e,Ue){return Vt(Ht[0],_e.pos)-Vt(Ht[0],Ue.pos)}),It.push.apply(It,be),Ol(Ht[1],S)&&It.push({index1:Zt,index2:-1,pos:Ht[1],type:"inside"})}),J.forEach(function(qt,Zt){if(!!Ol(qt[1],E)){var Ht=!1,be=Yr(It,function(_e){var Ue=_e.index2;return Ue===Zt?(Ht=!0,!1):!!Ht});be===-1&&(Ht=!1,be=Yr(It,function(_e){var Ue=_e.index1,nn=_e.index2;return Ue===-1&&nn+1===Zt?(Ht=!0,!1):!!Ht})),be===-1?It.push({index1:-1,index2:Zt,pos:qt[1],type:"inside"}):It.splice(be,0,{index1:-1,index2:Zt,pos:qt[1],type:"inside"})}});var Bt={};return It.filter(function(qt){var Zt=qt.pos,Ht=Zt[0]+"x"+Zt[1];return Bt[Ht]?!1:(Bt[Ht]=!0,!0)})}function Yt(y,m){var E=Zn(y,m);return E.map(function(S){var D=S.pos;return D})}function Ie(y){var m=y[0],E=m.index1,S=m.index2,D=y[1],J=D.index1,ct=D.index2;return E!==-1&&(E===J||E+1===J)||S!==-1&&(S===ct||S+1===ct)}function Ge(y,m){var E=Zn(y,m),S=[],D;return Zn(y,m).forEach(function(J,ct,vt){ct===0||!Ie([vt[ct-1],J])?(D=[J],S.push(D)):D.push(J)}),S.map(function(J){return J.map(function(ct){var vt=ct.pos;return vt})})}function Fe(y,m,E,S){E===void 0&&(E=0),S===void 0&&(S=[]);for(var D=S.length===0,J=y.length,ct=y[E]?E:0,vt=Ju(y.slice(ct),y.slice(0,ct)),It=function(Zt){var Ht=vt[Zt];if(find(m,function(hn){return hn[0]===Ht[0]&&hn[1]===Ht[1]}))return"continue";if(S.some(function(hn){return find(hn,function(On){return On[0]===Ht[0]&&On[1]===Ht[1]})}))return D?"continue":"break";var be=void 0;D?(be=[],S.push(be)):be=S[S.length-1],be.push(Ht);var _e=[Ht,y[E+1]||y[0]],Ue=m.filter(function(hn){return re(hn,_e)}).sort(function(hn,On){return getDist(Ht,hn)-getDist(Ht,On)})[0];if(Ue){var nn=m.indexOf(Ue);if(Fe(m,y,nn,S),!D)return"break"}else return Fe(vt,m,Zt+1,S),"break"},Bt=0;Bt<J;++Bt){var qt=It(Bt);if(qt==="break")break}return S}function In(y,m){return Fe(y,Ju(m).reverse())}function ar(y,m){if(!m.length)return[Ju(y)];var E=Ge(y,m),S=[y];return E.forEach(function(D){var J=Ju(D).reverse();S=vl(S.map(function(ct){var vt=Fe(ct,J),It=vt[0];if(vt.length===1&&J.every(function(Ht){return It.indexOf(Ht)===-1})){var Bt=It[It.length-1],qt=Ju(J).sort(function(Ht,be){return getDist(Bt,Ht)-getDist(Bt,be)})[0],Zt=J.indexOf(qt);It.push.apply(It,Ju(J.slice(Zt),J.slice(0,Zt),[J[Zt],Bt]))}return vt}))}),S}function ra(y,m){var E=Yt(y,m);return Ls(E)}var Ta=$(67294);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $a=function(y,m){return $a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,S){E.__proto__=S}||function(E,S){for(var D in S)S.hasOwnProperty(D)&&(E[D]=S[D])},$a(y,m)};function ja(y,m){$a(y,m);function E(){this.constructor=y}y.prototype=m===null?Object.create(m):(E.prototype=m.prototype,new E)}var Oa=function(){return Oa=Object.assign||function(m){for(var E,S=1,D=arguments.length;S<D;S++){E=arguments[S];for(var J in E)Object.prototype.hasOwnProperty.call(E,J)&&(m[J]=E[J])}return m},Oa.apply(this,arguments)};function so(y,m){var E=m[0]-y[0],S=m[1]-y[1],D=Math.atan2(S,E);return D>=0?D:D+Math.PI*2}function Ai(y){return so([y[0].clientX,y[0].clientY],[y[1].clientX,y[1].clientY])/Math.PI*180}function Oi(y){return y.touches&&y.touches.length>=2}function hs(y){return y?y.touches?Ys(y.touches):[Ps(y)]:[]}function wo(y){return y&&(y.type.indexOf("mouse")>-1||"button"in y)}function ho(y,m,E){var S=E.length,D=As(y,S),J=D.clientX,ct=D.clientY,vt=D.originalClientX,It=D.originalClientY,Bt=As(m,S),qt=Bt.clientX,Zt=Bt.clientY,Ht=As(E,S),be=Ht.clientX,_e=Ht.clientY,Ue=J-qt,nn=ct-Zt,hn=J-be,On=ct-_e;return{clientX:vt,clientY:It,deltaX:Ue,deltaY:nn,distX:hn,distY:On}}function Ro(y){return Math.sqrt(Math.pow(y[0].clientX-y[1].clientX,2)+Math.pow(y[0].clientY-y[1].clientY,2))}function Ys(y){for(var m=Math.min(y.length,2),E=[],S=0;S<m;++S)E.push(Ps(y[S]));return E}function Ps(y){return{clientX:y.clientX,clientY:y.clientY}}function As(y,m){m===void 0&&(m=y.length);for(var E={clientX:0,clientY:0,originalClientX:0,originalClientY:0},S=0;S<m;++S){var D=y[S];E.originalClientX+="originalClientX"in D?D.originalClientX:D.clientX,E.originalClientY+="originalClientY"in D?D.originalClientY:D.clientY,E.clientX+=D.clientX,E.clientY+=D.clientY}return m?{clientX:E.clientX/m,clientY:E.clientY/m,originalClientX:E.originalClientX/m,originalClientY:E.originalClientY/m}:E}var Vs=function(){function y(m){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=m,this.prevClients=m,this.length=m.length}return y.prototype.getAngle=function(m){return m===void 0&&(m=this.prevClients),Ai(m)},y.prototype.getRotation=function(m){return m===void 0&&(m=this.prevClients),Ai(m)-Ai(this.startClients)},y.prototype.getPosition=function(m,E){m===void 0&&(m=this.prevClients);var S=ho(m||this.prevClients,this.prevClients,this.startClients),D=S.deltaX,J=S.deltaY;return this.movement+=Math.sqrt(D*D+J*J),this.prevClients=m,S},y.prototype.getPositions=function(m){m===void 0&&(m=this.prevClients);var E=this.prevClients;return this.startClients.map(function(S,D){return ho([m[D]],[E[D]],[S])})},y.prototype.getMovement=function(m){var E=this.movement;if(!m)return E;var S=As(m,this.length),D=As(this.prevClients,this.length),J=S.clientX-D.clientX,ct=S.clientY-D.clientY;return Math.sqrt(J*J+ct*ct)+E},y.prototype.getDistance=function(m){return m===void 0&&(m=this.prevClients),Ro(m)},y.prototype.getScale=function(m){return m===void 0&&(m=this.prevClients),Ro(m)/Ro(this.startClients)},y.prototype.move=function(m,E){this.startClients.forEach(function(S){S.clientX-=m,S.clientY-=E}),this.prevClients.forEach(function(S){S.clientX-=m,S.clientY-=E})},y}(),su=["textarea","input"],xl=function(y){ja(m,y);function m(E,S){S===void 0&&(S={});var D=y.call(this)||this;D.options={},D.flag=!1,D.pinchFlag=!1,D.data={},D.isDrag=!1,D.isPinch=!1,D.clientStores=[],D.targets=[],D.prevTime=0,D.doubleFlag=!1,D._useMouse=!1,D._useTouch=!1,D._useDrag=!1,D._dragFlag=!1,D._isTrusted=!1,D._isMouseEvent=!1,D._isSecondaryButton=!1,D._preventMouseEvent=!1,D._prevInputEvent=null,D._isDragAPI=!1,D._isIdle=!0,D._window=window,D.onDragStart=function(Ht,be){if(be===void 0&&(be=!0),!(!D.flag&&Ht.cancelable===!1)){var _e=Ht.type.indexOf("drag")>=-1;if(!(D.flag&&_e)){D._isDragAPI=!0;var Ue=D.options,nn=Ue.container,hn=Ue.pinchOutside,On=Ue.preventWheelClick,er=Ue.preventRightClick,Yn=Ue.preventDefault,Ir=Ue.checkInput,Un=Ue.dragFocusedInput,gr=Ue.preventClickEventOnDragStart,Br=Ue.preventClickEventOnDrag,Tr=Ue.preventClickEventByCondition,sa=D._useTouch,Gr=!D.flag;if(D._isSecondaryButton=Ht.which===3||Ht.button===2,On&&(Ht.which===2||Ht.button===1)||er&&(Ht.which===3||Ht.button===2))return D.stop(),!1;if(Gr){var va=D._window.document.activeElement,la=Ht.target;if(la){var ka=la.tagName.toLowerCase(),ri=su.indexOf(ka)>-1,Li=la.isContentEditable;if(ri||Li){if(Ir||!Un&&va===la)return!1;if(va&&(va===la||Li&&va.isContentEditable&&va.contains(la)))if(Un)la.blur();else return!1}else if((Yn||Ht.type==="touchstart")&&va){var to=va.tagName.toLowerCase();(va.isContentEditable||su.indexOf(to)>-1)&&va.blur()}(gr||Br||Tr)&&ii(D._window,"click",D._onClick,!0)}D.clientStores=[new Vs(hs(Ht))],D._isIdle=!1,D.flag=!0,D.isDrag=!1,D._isTrusted=be,D._dragFlag=!0,D._prevInputEvent=Ht,D.data={},D.doubleFlag=Wr()-D.prevTime<200,D._isMouseEvent=wo(Ht),!D._isMouseEvent&&D._preventMouseEvent&&(D._preventMouseEvent=!1);var fi=D._preventMouseEvent||D.emit("dragStart",Oa(Oa({data:D.data,datas:D.data,inputEvent:Ht,isMouseEvent:D._isMouseEvent,isSecondaryButton:D._isSecondaryButton,isTrusted:be,isDouble:D.doubleFlag},D.getCurrentStore().getPosition()),{preventDefault:function(){Ht.preventDefault()},preventDrag:function(){D._dragFlag=!1}}));fi===!1&&D.stop(),D._isMouseEvent&&D.flag&&Yn&&Ht.preventDefault()}if(!D.flag)return!1;var Ii=0;if(Gr?(D._attchDragEvent(),sa&&hn&&(Ii=setTimeout(function(){ii(nn,"touchstart",D.onDragStart,{passive:!1})}))):sa&&hn&&Di(nn,"touchstart",D.onDragStart),D.flag&&Oi(Ht)){if(clearTimeout(Ii),Gr&&Ht.touches.length!==Ht.changedTouches.length)return;D.pinchFlag||D.onPinchStart(Ht)}}}},D.onDrag=function(Ht,be){if(!!D.flag){var _e=D.options.preventDefault;!D._isMouseEvent&&_e&&Ht.preventDefault(),D._prevInputEvent=Ht;var Ue=hs(Ht),nn=D.moveClients(Ue,Ht,!1);if(D._dragFlag){if(D.pinchFlag||nn.deltaX||nn.deltaY){var hn=D._preventMouseEvent||D.emit("drag",Oa(Oa({},nn),{isScroll:!!be,inputEvent:Ht}));if(hn===!1){D.stop();return}}D.pinchFlag&&D.onPinch(Ht,Ue)}D.getCurrentStore().getPosition(Ue,!0)}},D.onDragEnd=function(Ht){if(!!D.flag){var be=D.options,_e=be.pinchOutside,Ue=be.container,nn=be.preventClickEventOnDrag,hn=be.preventClickEventOnDragStart,On=be.preventClickEventByCondition,er=D.isDrag;(nn||hn||On)&&requestAnimationFrame(function(){D._allowClickEvent()}),!On&&!hn&&nn&&!er&&D._allowClickEvent(),D._useTouch&&_e&&Di(Ue,"touchstart",D.onDragStart),D.pinchFlag&&D.onPinchEnd(Ht);var Yn=(Ht==null?void 0:Ht.touches)?hs(Ht):[],Ir=Yn.length;Ir===0||!D.options.keepDragging?D.flag=!1:D._addStore(new Vs(Yn));var Un=D._getPosition(),gr=Wr(),Br=!er&&D.doubleFlag;D._prevInputEvent=null,D.prevTime=er||Br?0:gr,D.flag||(D._dettachDragEvent(),D._preventMouseEvent||D.emit("dragEnd",Oa({data:D.data,datas:D.data,isDouble:Br,isDrag:er,isClick:!er,isMouseEvent:D._isMouseEvent,isSecondaryButton:D._isSecondaryButton,inputEvent:Ht,isTrusted:D._isTrusted},Un)),D.clientStores=[],D._isMouseEvent||(D._preventMouseEvent=!0,requestAnimationFrame(function(){requestAnimationFrame(function(){D._preventMouseEvent=!1})})),D._isIdle=!0)}},D.onBlur=function(){D.onDragEnd()},D._allowClickEvent=function(){Di(D._window,"click",D._onClick,!0)},D._onClick=function(Ht){D._allowClickEvent(),D._preventMouseEvent=!1;var be=D.options.preventClickEventByCondition;(be==null?void 0:be(Ht))||(Ht.stopPropagation(),Ht.preventDefault())},D._onContextMenu=function(Ht){var be=D.options;be.preventRightClick?D.onDragEnd(Ht):Ht.preventDefault()},D._passCallback=function(){};var J=[].concat(E),ct=J[0];D._window=Wn(ct)?ct:dn(ct),D.options=Oa({checkInput:!1,container:ct&&!("document"in ct)?dn(ct):ct,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},S);var vt=D.options,It=vt.container,Bt=vt.events,qt=vt.checkWindowBlur;if(D._useDrag=Bt.indexOf("drag")>-1,D._useTouch=Bt.indexOf("touch")>-1,D._useMouse=Bt.indexOf("mouse")>-1,D.targets=J,D._useDrag&&J.forEach(function(Ht){ii(Ht,"dragstart",D.onDragStart)}),D._useMouse&&(J.forEach(function(Ht){ii(Ht,"mousedown",D.onDragStart),ii(Ht,"mousemove",D._passCallback)}),ii(It,"contextmenu",D._onContextMenu)),qt&&ii(dn(),"blur",D.onBlur),D._useTouch){var Zt={passive:!1};J.forEach(function(Ht){ii(Ht,"touchstart",D.onDragStart,Zt),ii(Ht,"touchmove",D._passCallback,Zt)})}return D}return m.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},m.prototype.getMovement=function(E){return this.getCurrentStore().getMovement(E)+this.clientStores.slice(1).reduce(function(S,D){return S+D.movement},0)},m.prototype.isDragging=function(){return this.isDrag},m.prototype.isIdle=function(){return this._isIdle},m.prototype.isFlag=function(){return this.flag},m.prototype.isPinchFlag=function(){return this.pinchFlag},m.prototype.isDoubleFlag=function(){return this.doubleFlag},m.prototype.isPinching=function(){return this.isPinch},m.prototype.scrollBy=function(E,S,D,J){J===void 0&&(J=!0),!!this.flag&&(this.clientStores[0].move(E,S),J&&this.onDrag(D,!0))},m.prototype.move=function(E,S){var D=E[0],J=E[1],ct=this.getCurrentStore(),vt=ct.prevClients;return this.moveClients(vt.map(function(It){var Bt=It.clientX,qt=It.clientY;return{clientX:Bt+D,clientY:qt+J,originalClientX:Bt,originalClientY:qt}}),S,!0)},m.prototype.triggerDragStart=function(E){this.onDragStart(E,!1)},m.prototype.setEventData=function(E){var S=this.data;for(var D in E)S[D]=E[D];return this},m.prototype.setEventDatas=function(E){return this.setEventData(E)},m.prototype.getCurrentEvent=function(E){return E===void 0&&(E=this._prevInputEvent),Oa(Oa({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:E})},m.prototype.getEventData=function(){return this.data},m.prototype.getEventDatas=function(){return this.data},m.prototype.unset=function(){var E=this,S=this.targets,D=this.options.container;this.off(),Di(this._window,"blur",this.onBlur),this._useDrag&&S.forEach(function(J){Di(J,"dragstart",E.onDragStart)}),this._useMouse&&(S.forEach(function(J){Di(J,"mousedown",E.onDragStart)}),Di(D,"contextmenu",this._onContextMenu)),this._useTouch&&(S.forEach(function(J){Di(J,"touchstart",E.onDragStart)}),Di(D,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},m.prototype.onPinchStart=function(E){var S=this,D=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>D)){var J=new Vs(hs(E));this.pinchFlag=!0,this._addStore(J);var ct=this.emit("pinchStart",Oa(Oa({data:this.data,datas:this.data,angle:J.getAngle(),touches:this.getCurrentStore().getPositions()},J.getPosition()),{inputEvent:E,isTrusted:this._isTrusted,preventDefault:function(){E.preventDefault()},preventDrag:function(){S._dragFlag=!1}}));ct===!1&&(this.pinchFlag=!1)}},m.prototype.onPinch=function(E,S){if(!(!this.flag||!this.pinchFlag||S.length<2)){var D=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",Oa(Oa({data:this.data,datas:this.data,movement:this.getMovement(S),angle:D.getAngle(S),rotation:D.getRotation(S),touches:D.getPositions(S),scale:D.getScale(S),distance:D.getDistance(S)},D.getPosition(S)),{inputEvent:E,isTrusted:this._isTrusted}))}},m.prototype.onPinchEnd=function(E){if(!!this.pinchFlag){var S=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var D=this.getCurrentStore();this.emit("pinchEnd",Oa(Oa({data:this.data,datas:this.data,isPinch:S,touches:D.getPositions()},D.getPosition()),{inputEvent:E}))}},m.prototype.getCurrentStore=function(){return this.clientStores[0]},m.prototype.moveClients=function(E,S,D){var J=this._getPosition(E,D),ct=this.isDrag;(J.deltaX||J.deltaY)&&(this.isDrag=!0);var vt=!1;return!ct&&this.isDrag&&(vt=!0),Oa(Oa({data:this.data,datas:this.data},J),{movement:this.getMovement(E),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:S,isTrusted:this._isTrusted,isFirstDrag:vt})},m.prototype._addStore=function(E){this.clientStores.splice(0,0,E)},m.prototype._getPosition=function(E,S){var D=this.getCurrentStore(),J=D.getPosition(E,S),ct=this.clientStores.slice(1).reduce(function(Bt,qt){var Zt=qt.getPosition();return Bt.distX+=Zt.distX,Bt.distY+=Zt.distY,Bt},J),vt=ct.distX,It=ct.distY;return Oa(Oa({},J),{distX:vt,distY:It})},m.prototype._attchDragEvent=function(){var E=this._window,S=this.options.container,D={passive:!1};this._isDragAPI&&(ii(S,"dragover",this.onDrag,D),ii(E,"dragend",this.onDragEnd)),this._useMouse&&(ii(S,"mousemove",this.onDrag),ii(E,"mouseup",this.onDragEnd)),this._useTouch&&(ii(S,"touchmove",this.onDrag,D),ii(E,"touchend",this.onDragEnd,D),ii(E,"touchcancel",this.onDragEnd,D))},m.prototype._dettachDragEvent=function(){var E=this._window,S=this.options.container;this._isDragAPI&&(Di(S,"dragover",this.onDrag),Di(E,"dragend",this.onDragEnd)),this._useMouse&&(Di(S,"mousemove",this.onDrag),Di(E,"mouseup",this.onDragEnd)),this._useTouch&&(Di(S,"touchstart",this.onDragStart),Di(S,"touchmove",this.onDrag),Di(E,"touchend",this.onDragEnd),Di(E,"touchcancel",this.onDragEnd))},m}(ul);function Rl(y){for(var m=5381,E=y.length;E;)m=m*33^y.charCodeAt(--E);return m>>>0}var Ll=Rl;function nl(y){return Ll(y).toString(36)}function rl(y){if(y&&y.getRootNode){var m=y.getRootNode();if(m.nodeType===11)return m}}function Ef(y,m,E){return E.original?m:m.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(S,D){var J=D.trim();return(J?Lr(J):[""]).map(function(ct){var vt=ct.trim();return vt.indexOf("@")===0?vt:vt.indexOf(":global")>-1?vt.replace(/\:global/g,""):vt.indexOf(":host")>-1?"".concat(vt.replace(/\:host/g,".".concat(y))):vt?".".concat(y," ").concat(vt):".".concat(y)}).join(", ")+" {"})}function Sf(y,m,E,S,D){var J=Ra(S),ct=J.createElement("style");return ct.setAttribute("type","text/css"),ct.setAttribute("data-styled-id",y),ct.setAttribute("data-styled-count","1"),E.nonce&&ct.setAttribute("nonce",E.nonce),ct.innerHTML=Ef(y,m,E),(D||J.head||J.body).appendChild(ct),ct}function Yl(y){var m="rCS"+nl(y);return{className:m,inject:function(E,S){S===void 0&&(S={});var D=rl(E),J=(D||E.ownerDocument||document).querySelector('style[data-styled-id="'.concat(m,'"]'));if(!J)J=Sf(m,y,S,E,D);else{var ct=parseFloat(J.getAttribute("data-styled-count"))||0;J.setAttribute("data-styled-count","".concat(ct+1))}return{destroy:function(){var vt,It=parseFloat(J.getAttribute("data-styled-count"))||0;It<=1?(J.remove?J.remove():(vt=J.parentNode)===null||vt===void 0||vt.removeChild(J),J=null):J.setAttribute("data-styled-count","".concat(It-1))}}}}}var Cf=Yl,T=function(y,m){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,S){E.__proto__=S}||function(E,S){for(var D in S)Object.prototype.hasOwnProperty.call(S,D)&&(E[D]=S[D])},T(y,m)};function rt(y,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");T(y,m);function E(){this.constructor=y}y.prototype=m===null?Object.create(m):(E.prototype=m.prototype,new E)}var Kt=function(){return Kt=Object.assign||function(m){for(var E,S=1,D=arguments.length;S<D;S++){E=arguments[S];for(var J in E)Object.prototype.hasOwnProperty.call(E,J)&&(m[J]=E[J])}return m},Kt.apply(this,arguments)};function pe(y,m){var E={};for(var S in y)Object.prototype.hasOwnProperty.call(y,S)&&m.indexOf(S)<0&&(E[S]=y[S]);if(y!=null&&typeof Object.getOwnPropertySymbols=="function")for(var D=0,S=Object.getOwnPropertySymbols(y);D<S.length;D++)m.indexOf(S[D])<0&&Object.prototype.propertyIsEnumerable.call(y,S[D])&&(E[S[D]]=y[S[D]]);return E}var Re=function(y){rt(m,y);function m(){var S=y!==null&&y.apply(this,arguments)||this;return S.injectResult=null,S.tag="div",S}var E=m.prototype;return E.render=function(){var S=this.props,D=S.className,J=D===void 0?"":D,ct=S.cspNonce,vt=S.portalContainer,It=pe(S,["className","cspNonce","portalContainer"]),Bt=this.injector.className,qt=this.tag,Zt={};return(Ta.version||"").indexOf("simple")>-1&&vt&&(Zt={portalContainer:vt}),(0,Ta.createElement)(qt,Kt(Kt({ref:wt(this,"element"),"data-styled-id":Bt,className:"".concat(J," ").concat(Bt)},Zt),It))},E.componentDidMount=function(){this.injectResult=this.injector.inject(this.element,{nonce:this.props.cspNonce})},E.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},E.getElement=function(){return this.element},m}(Ta.Component);function Je(y,m){var E=cssStyled(m);return function(S){rt(D,S);function D(){var J=S!==null&&S.apply(this,arguments)||this;return J.injector=E,J.tag=y,J}return D}(Re)}function an(y,m){var E=Cf(m),S=E.className;return(0,Ta.forwardRef)(function(D,J){var ct=D.className,vt=ct===void 0?"":ct,It=D.cspNonce,Bt=pe(D,["className","cspNonce"]),qt=(0,Ta.useRef)();return(0,Ta.useImperativeHandle)(J,function(){return qt.current},[]),(0,Ta.useEffect)(function(){var Zt=E.inject(qt.current,{nonce:D.cspNonce});return function(){Zt.destroy()}},[]),(0,Ta.createElement)(y,Kt({ref:qt,"data-styled-id":S,className:"".concat(vt," ").concat(S)},Bt))})}var wn=null,Mn=function(y,m){return Mn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,S){E.__proto__=S}||function(E,S){for(var D in S)Object.prototype.hasOwnProperty.call(S,D)&&(E[D]=S[D])},Mn(y,m)};function rr(y,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");Mn(y,m);function E(){this.constructor=y}y.prototype=m===null?Object.create(m):(E.prototype=m.prototype,new E)}var We=function(){return We=Object.assign||function(m){for(var E,S=1,D=arguments.length;S<D;S++){E=arguments[S];for(var J in E)Object.prototype.hasOwnProperty.call(E,J)&&(m[J]=E[J])}return m},We.apply(this,arguments)};function ca(y,m){var E={};for(var S in y)Object.prototype.hasOwnProperty.call(y,S)&&m.indexOf(S)<0&&(E[S]=y[S]);if(y!=null&&typeof Object.getOwnPropertySymbols=="function")for(var D=0,S=Object.getOwnPropertySymbols(y);D<S.length;D++)m.indexOf(S[D])<0&&Object.prototype.propertyIsEnumerable.call(y,S[D])&&(E[S[D]]=y[S[D]]);return E}function ha(y,m,E,S){var D=arguments.length,J=D<3?m:S===null?S=Object.getOwnPropertyDescriptor(m,E):S,ct;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")J=Reflect.decorate(y,m,E,S);else for(var vt=y.length-1;vt>=0;vt--)(ct=y[vt])&&(J=(D<3?ct(J):D>3?ct(m,E,J):ct(m,E))||J);return D>3&&J&&Object.defineProperty(m,E,J),J}function _r(y,m,E){if(E||arguments.length===2)for(var S=0,D=m.length,J;S<D;S++)(J||!(S in m))&&(J||(J=Array.prototype.slice.call(m,0,S)),J[S]=m[S]);return y.concat(J||Array.prototype.slice.call(m))}function Va(y,m){return We({events:[],props:[],name:y},m)}var qa=["n","w","s","e"],ma=["n","w","s","e","nw","ne","sw","se"];function Mi(y,m){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*y,'px" height="').concat(32*y,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(m,'deg);transform-origin: 16px 16px"></path></svg>')}function zo(y){var m=Mi(1,y),E=Math.round(y/45)*45%180,S="ns-resize";return E===135?S="nwse-resize":E===45?S="nesw-resize":E===90&&(S="ew-resize"),"cursor:".concat(S,";cursor: url('").concat(m,"') 16 16, ").concat(S,";")}var _o=lt(),Lo=_o.browser.webkit,yo=Lo&&function(){var y=typeof window=="undefined"?{userAgent:""}:window.navigator,m=/applewebkit\/([^\s]+)/g.exec(y.userAgent.toLowerCase());return m?parseFloat(m[1])<605:!1}(),No=_o.browser.name,Vu=parseInt(_o.browser.version,10),Bu=No==="chrome",ju=_o.browser.chromium,tl=parseInt(_o.browser.chromiumVersion,10)||0,Hu=Bu&&Vu>=109||ju&&tl>=109,al=No==="firefox",il=parseInt(_o.browser.webkitVersion,10)>=612||Vu>=15,ds="moveable-",uu=ma.map(function(y){var m="",E="",S="center",D="center";return y.indexOf("n")>-1&&(m="top: -20px;",D="bottom"),y.indexOf("s")>-1&&(m="top: 0px;",D="top"),y.indexOf("w")>-1&&(E="left: -20px;",S="right"),y.indexOf("e")>-1&&(E="left: 0px;",S="left"),'.around-control[data-direction*="'.concat(y,`"] {
        `).concat(E).concat(m,`
        transform-origin: `).concat(S," ").concat(D,`;
    }`)}).join(`
`),Jc=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: -10px;
top: -10px;
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(uu,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(y){return`
.direction[data-rotation="`.concat(y,'"], :global .view-control-rotation').concat(y,` {
`).concat(zo(y),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(yo?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),tf=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],zl=1e-4,wl=1e-7,hh=1e-9,Nd=Math.pow(10,10),fp=-Nd,Vp={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},dh={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},kd={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},jp=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag"];function df(y,m,E,S,D,J){var ct,vt;J===void 0&&(J="draggable");var It=(vt=(ct=m.gestos[J])===null||ct===void 0?void 0:ct.move(E,y.inputEvent))!==null&&vt!==void 0?vt:{},Bt=It.originalDatas||It.datas,qt=Bt[J]||(Bt[J]={});return We(We({},D?yp(m,It):It),{isPinch:!!S,parentEvent:!0,datas:qt,originalDatas:y.originalDatas})}var Rf=function(){function y(E){var S;E===void 0&&(E="draggable"),this.ableName=E,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(S={},S[E]={},S)}var m=y.prototype;return m.dragStart=function(E,S){this.isDrag=!1,this.isFlag=!1;var D=S.originalDatas;return this.datas=D,D[this.ableName]||(D[this.ableName]={}),We(We({},this.move(E,S.inputEvent)),{type:"dragstart"})},m.drag=function(E,S){return this.move([E[0]-this.prevX,E[1]-this.prevY],S)},m.move=function(E,S){var D,J,ct=!1;if(!this.isFlag)this.prevX=E[0],this.prevY=E[1],this.startX=E[0],this.startY=E[1],D=E[0],J=E[1],this.isFlag=!0;else{var vt=this.isDrag;D=this.prevX+E[0],J=this.prevY+E[1],(E[0]||E[1])&&(this.isDrag=!0),!vt&&this.isDrag&&(ct=!0)}return this.prevX=D,this.prevY=J,{type:"drag",clientX:D,clientY:J,inputEvent:S,isFirstDrag:ct,isDrag:this.isDrag,distX:D-this.startX,distY:J-this.startY,deltaX:E[0],deltaY:E[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},y}();function hp(y,m){var E=m.clientX,S=m.clientY,D=m.datas,J=y.state,ct=J.moveableClientRect,vt=J.rootMatrix,It=J.is3d,Bt=J.pos1,qt=ct.left,Zt=ct.top,Ht=It?4:3,be=gi(Uh(vt,[E-qt,S-Zt],Ht),Bt),_e=be[0],Ue=be[1],nn=sc({datas:D,distX:_e,distY:Ue}),hn=nn[0],On=nn[1];return[hn,On]}function jf(y,m){var E=m.datas,S=y.state,D=S.allMatrix,J=S.beforeMatrix,ct=S.is3d,vt=S.left,It=S.top,Bt=S.origin,qt=S.offsetMatrix,Zt=S.targetMatrix,Ht=S.transformOrigin,be=ct?4:3;E.is3d=ct,E.matrix=D,E.targetMatrix=Zt,E.beforeMatrix=J,E.offsetMatrix=qt,E.transformOrigin=Ht,E.inverseMatrix=ui(D,be),E.inverseBeforeMatrix=ui(J,be),E.absoluteOrigin=vo(bi([vt,It],Bt),be),E.startDragBeforeDist=To(E.inverseBeforeMatrix,E.absoluteOrigin,be),E.startDragDist=To(E.inverseMatrix,E.absoluteOrigin,be)}function pf(y){return Bf(y.datas.beforeTransform,[50,50],100,100).direction}function ph(y,m){var E=y.datas,S=y.originalDatas.beforeRenderable,D=E.transformIndex,J=S.nextTransforms,ct=J.length,vt=S.nextTransformAppendedIndexes,It=-1;D===-1?(m==="translate"?It=0:m==="rotate"&&(It=Yr(J,function(Ht){return Ht.match(/scale\(/g)})),It===-1&&(It=J.length),E.transformIndex=It):Sr(vt,function(Ht){return Ht.index===D&&Ht.functionName===m})?It=D:It=D+vt.filter(function(Ht){return Ht.index<D}).length;var Bt=Wh(J,It),qt=Bt.targetFunction,Zt=m==="rotate"?"rotateZ":m;E.beforeFunctionTexts=Bt.beforeFunctionTexts,E.afterFunctionTexts=Bt.afterFunctionTexts,E.beforeTransform=Bt.beforeFunctionMatrix,E.beforeTransform2=Bt.beforeFunctionMatrix2,E.targetTansform=Bt.targetFunctionMatrix,E.afterTransform=Bt.afterFunctionMatrix,E.afterTransform2=Bt.afterFunctionMatrix2,E.targetAllTransform=Bt.allFunctionMatrix,qt.functionName===Zt?(E.afterFunctionTexts.splice(0,1),E.isAppendTransform=!1):ct>It&&(E.isAppendTransform=!0,S.nextTransformAppendedIndexes=_r(_r([],vt,!0),[{functionName:m,index:It,isAppend:!0}],!1))}function Ri(y,m,E){return"".concat(y.beforeFunctionTexts.join(" ")," ").concat(y.isAppendTransform?E:m," ").concat(y.afterFunctionTexts.join(" "))}function Lh(y){var m=y.datas,E=y.distX,S=y.distY,D=Ph({datas:m,distX:E,distY:S}),J=D[0],ct=D[1],vt=bs(m,xo([J,ct],4));return To(vt,vo([0,0,0],4),4)}function bs(y,m,E){var S=y.beforeTransform,D=y.afterTransform,J=y.beforeTransform2,ct=y.afterTransform2,vt=y.targetAllTransform,It=E?Zi(vt,m,4):Zi(m,vt,4),Bt=Zi(ui(E?J:S,4),It,4),qt=Zi(Bt,ui(E?ct:D,4),4);return qt}function Ph(y){var m=y.datas,E=y.distX,S=y.distY,D=m.inverseBeforeMatrix,J=m.is3d,ct=m.startDragBeforeDist,vt=m.absoluteOrigin,It=J?4:3;return gi(To(D,bi(vt,[E,S]),It),ct)}function sc(y,m){var E=y.datas,S=y.distX,D=y.distY,J=E.inverseBeforeMatrix,ct=E.inverseMatrix,vt=E.is3d,It=E.startDragBeforeDist,Bt=E.startDragDist,qt=E.absoluteOrigin,Zt=vt?4:3;return gi(To(m?J:ct,bi(qt,[S,D]),Zt),m?It:Bt)}function ef(y,m){var E=y.datas,S=y.distX,D=y.distY,J=E.beforeMatrix,ct=E.matrix,vt=E.is3d,It=E.startDragBeforeDist,Bt=E.startDragDist,qt=E.absoluteOrigin,Zt=vt?4:3;return gi(To(m?J:ct,bi(m?It:Bt,[S,D]),Zt),qt)}function vf(y,m,E,S,D,J){return S===void 0&&(S=m),D===void 0&&(D=E),J===void 0&&(J=[0,0]),y?y.map(function(ct,vt){var It=sr(ct),Bt=It.value,qt=It.unit,Zt=vt?D:S,Ht=vt?E:m;if(ct==="%"||isNaN(Bt)){var be=Zt?J[vt]/Zt:0;return Ht*be}else if(qt!=="%")return Bt;return Ht*Bt/100}):J}function vh(y){var m=[];return y[1]>=0&&(y[0]>=0&&m.push(3),y[0]<=0&&m.push(2)),y[1]<=0&&(y[0]>=0&&m.push(1),y[0]<=0&&m.push(0)),m}function Lf(y,m){return vh(m).map(function(E){return y[E]})}function js(y,m){var E=(m[0]+1)/2,S=(m[1]+1)/2,D=[Me(y[0][0],y[1][0],E,1-E),Me(y[0][1],y[1][1],E,1-E)],J=[Me(y[2][0],y[3][0],E,1-E),Me(y[2][1],y[3][1],E,1-E)];return[Me(D[0],J[0],S,1-S),Me(D[1],J[1],S,1-S)]}function dp(y,m,E,S,D,J){var ct=Pc(m,E,S,D),vt=js(ct,J),It=y[0]-vt[0],Bt=y[1]-vt[1];return[It,Bt]}function Pl(y,m,E,S){return Zi(y,Xc(m,S,E),S)}function Dt(y,m,E){var S=y.transformOrigin,D=y.offsetMatrix,J=y.is3d,ct=J?4:3,vt;if(Xn(E)){var It=m.beforeTransform,Bt=m.afterTransform;vt=es(Zi(Zi(It,ji([E]),4),Bt,4),4,ct)}else vt=E;return Pl(D,vt,S,ct)}function ae(y,m){var E=y.transformOrigin,S=y.offsetMatrix,D=y.is3d,J=y.targetMatrix,ct=y.targetAllTransform,vt=D?4:3;return Pl(S,Zi(ct||J,ys(m,vt),vt),E,vt)}function xe(y){var m=Cr(y);return{setTransform:function(E,S){S===void 0&&(S=-1),m.startTransforms=Rt(E)?E:Da(E),yn(y,S)},setTransformIndex:function(E){yn(y,E)}}}function qe(y,m){var E=Cr(y),S=E.startTransforms;yn(y,Yr(S,function(D){return D.indexOf("".concat(m,"("))===0}))}function yn(y,m){var E=Cr(y),S=y.datas;if(S.transformIndex=m,m!==-1){var D=E.startTransforms[m];if(!!D){var J=Ss([D]);S.startValue=J[0].functionValue}}}function Er(y,m){var E=Cr(y);E.nextTransforms=Da(m)}function Cr(y){return y.originalDatas.beforeRenderable}function oa(y){var m=y.originalDatas.beforeRenderable;return m.nextTransforms}function Nn(y){return oa(y).join(" ")}function Pa(y){return Cr(y).nextStyle}function wi(y,m,E,S,D){Er(D,m);var J=M.drag(y,df(D,y.state,E,S,!1)),ct=J?J.transform:m;return We(We({transform:m,drag:J},Al({transform:ct},D)),{afterTransform:ct})}function Ui(y,m,E,S){var D=Dt(y.state,S,m),J=Vo(y,E,D);return J}function Ei(y,m,E,S,D){var J=Ui(y,m,E,D),ct=y.state,vt=ct.left,It=ct.top,Bt=y.props.groupable,qt=Bt?vt:0,Zt=Bt?It:0,Ht=gi(S,J);return gi(Ht,[qt,Zt])}function Oo(y,m,E,S,D){var J=Ei(y,"scale(".concat(m.join(", "),")"),E,S,D);return J}function us(y,m,E){return[-1+y[0]/(m/2),-1+y[1]/(E/2)]}function Vo(y,m,E){E===void 0&&(E=y.state.allMatrix);var S=y.state,D=S.width,J=S.height,ct=S.is3d,vt=ct?4:3,It=[D/2*(1+m[0]),J/2*(1+m[1])];return ol(E,It,vt)}function uo(y,m,E){var S=E.fixedDirection,D=E.fixedPosition;return Ei(y,"rotate(".concat(m,"deg)"),S,D,E)}function $o(y,m,E,S,D,J){var ct=y.props.groupable,vt=y.state,It=vt.transformOrigin,Bt=vt.offsetMatrix,qt=vt.is3d,Zt=vt.width,Ht=vt.height,be=vt.left,_e=vt.top,Ue=J.fixedDirection,nn=J.nextTargetMatrix||vt.targetMatrix,hn=qt?4:3,On=vf(D,m,E,Zt,Ht,It),er=ct?be:0,Yn=ct?_e:0,Ir=Pl(Bt,nn,On,hn),Un=dp(S,Ir,m,E,hn,Ue);return gi(Un,[er,Yn])}function Si(y,m){return js(uc(y.state),m)}function ns(y,m){var E=y.targetGesto,S=y.controlGesto,D;return(E==null?void 0:E.isFlag())&&(D=E.getEventData()[m]),!D&&(S==null?void 0:S.isFlag())&&(D=S.getEventData()[m]),D||{}}function Xo(y){if(y&&y.getRootNode){var m=y.getRootNode();if(m.nodeType===11)return m}}function eo(y,m,E){for(var S=y,D=[],J=document.documentElement||document.body,ct=!E&&y===m||y===J,vt=ct,It=!1,Bt=3,qt,Zt,Ht,be=!1,_e=Yc(m,m,!0).offsetParent,Ue=1;S&&!vt;){vt=ct;var nn=lr(S),hn=nn("position"),On=nn("scale"),er=mn(S),Yn=hn==="fixed",Ir=ms(mc(er)),Un=void 0,gr=!1,Br=!1,Tr=0,sa=0,Gr=0,va=0,la={hasTransform:!1,fixedContainer:null};Yn&&(be=!0,la=Pf(S),_e=la.fixedContainer);var ka=Ir.length;!It&&ka===16&&(It=!0,Bt=4,Yf(D),Ht&&(Ht=es(Ht,3,4))),It&&ka===9&&(Ir=es(Ir,3,4));var ri=pp(S,y),Li=ri.tagName,to=ri.hasOffset,fi=ri.isSVG,Ii=ri.origin,Ja=ri.targetOrigin,oo=ri.offset,Po=oo[0],Fo=oo[1];Li==="svg"&&Ht&&(D.push({type:"target",target:S,matrix:gf(S,Bt)}),D.push({type:"offset",target:S,matrix:Wi(Bt)}));var _s=parseFloat(nn("zoom"))||1;if(Yn)Un=la.fixedContainer,gr=!0;else{var Eo=Yc(S,m,!1,!0,nn),Co=Eo.offsetZoom;if(Un=Eo.offsetParent,gr=Eo.isEnd,Br=Eo.isStatic,Ue*=Co,(Eo.isCustomElement||Co!==1)&&Br)Po-=Un.offsetLeft,Fo-=Un.offsetTop;else if(al||Hu){var ws=Eo.parentSlotElement;if(ws){for(var rs=Un,$u=0,Bo=0;rs&&Xo(rs);)$u+=rs.offsetLeft,Bo+=rs.offsetTop,rs=rs.offsetParent;Po-=$u,Fo-=Bo}}}if(Lo&&!il&&to&&!fi&&Br&&(hn==="relative"||hn==="static")&&(Po-=Un.offsetLeft,Fo-=Un.offsetTop,ct=ct||gr),Yn)to&&la.hasTransform&&(Gr=Un.clientLeft,va=Un.clientTop);else if(to&&_e!==Un&&(Tr=Un.clientLeft,sa=Un.clientTop),to&&Un===J){var ts=br(S,!1);Po+=ts[0],Fo+=ts[1]}if(D.push({type:"target",target:S,matrix:Xc(Ir,Bt,Ii)}),On&&On!=="1"&&On!=="none"){var hu=On.split(" ").map(function(Ru){return parseFloat(Ru)}),eu=hu[0],Nl=hu[1],Gu=Nl===void 0?eu:Nl,nu=ys([eu,Gu],Bt);D.push({type:"offset",target:S,matrix:Wi(Bt)}),D.push({type:"target",target:S,matrix:Xc(nu,Bt,Ii)})}if(to){var kl=S===y,cu=kl?0:S.scrollLeft,Hs=kl?0:S.scrollTop;D.push({type:"offset",target:S,matrix:is([Po-cu+Tr-Gr,Fo-Hs+sa-va],Bt)})}else D.push({type:"offset",target:S,origin:Ii});if(_s!==1&&D.push({type:"zoom",target:S,matrix:Xc(ys([_s,_s],Bt),Bt,[0,0])}),Ht||(Ht=Ir),qt||(qt=Ii),Zt||(Zt=Ja),vt||Yn)break;S=Un,ct=gr,(!E||S===J)&&(vt=ct)}return Ht||(Ht=Wi(Bt)),qt||(qt=[0,0]),Zt||(Zt=[0,0]),{zoom:Ue,offsetContainer:_e,matrixes:D,targetMatrix:Ht,transformOrigin:qt,targetOrigin:Zt,is3d:It,hasFixed:be}}var qo=null,Ns=null,lu=null;function ls(y){y?(window.Map&&(qo=new Map,Ns=new Map),lu=[]):(qo=null,lu=null,Ns=null)}function ks(y){var m=Ns==null?void 0:Ns.get(y);if(m)return m;var E=Zf(y,!0);return Ns&&Ns.set(y,E),E}function Ou(y,m){if(lu){var E=Sr(lu,function(D){return D[0][0]==y&&D[0][1]==m});if(E)return E[1]}var S=eo(y,m,!0);return lu&&lu.push([[y,m],S]),S}function lr(y){var m=qo==null?void 0:qo.get(y);if(!m){var E=window.getComputedStyle(y);if(!qo)return function(J){return E[J]};m={style:E,cached:{}},qo.set(y,m)}var S=m.cached,D=m.style;return function(J){return J in S||(S[J]=D[J]),S[J]}}function ll(y,m){return[y[0]*m[0],y[1]*m[1]]}function mo(){for(var y=[],m=0;m<arguments.length;m++)y[m]=arguments[m];return ht.apply(void 0,_r([ds],y,!1))}function Hf(y){y()}function mc(y){return!y||y==="none"?[1,0,0,1,0,0]:fn(y)?y:ji(y)}function Xc(y,m,E){return Wo(m,is(E,m),y,is(E.map(function(S){return-S}),m))}function Jl(y,m,E){if(m==="%"){var S=yc(y.ownerSVGElement);return S[E?"width":"height"]/100}return 1}function Kl(y){var m=Hp(yh(y,":before"));return m.map(function(E,S){var D=sr(E),J=D.value,ct=D.unit;return J*Jl(y,ct,S===0)})}function Xf(y){return y?y.split(" "):["0","0"]}function Hp(y){return Xf(y.transformOrigin)}function mn(y){var m=lr(y),E=m("transform");if(E&&E!=="none")return E;if("transform"in y){var S=y.transform,D=S.baseVal;if(!D)return"";var J=D.length;if(!J)return"";for(var ct=[],vt=function(Bt){var qt=D[Bt].matrix;ct.push("matrix(".concat(["a","b","c","d","e","f"].map(function(Zt){return qt[Zt]}).join(", "),")"))},It=0;It<J;++It)vt(It);return ct.join(" ")}return""}function Yc(y,m,E,S,D){var J,ct,vt=y&&y.ownerDocument?y.ownerDocument:document,It=vt.documentElement||vt.body,Bt=!1,qt,Zt;if(!y||E)qt=y;else{var Ht=(J=y==null?void 0:y.assignedSlot)===null||J===void 0?void 0:J.parentElement,be=y.parentElement;Ht?(Bt=!0,Zt=be,qt=Ht):qt=be}for(var _e=!1,Ue=y===m||qt===m,nn="relative",hn=1,On=parseFloat(D==null?void 0:D("zoom"))||1,er=D==null?void 0:D("position");qt&&qt!==It;){m===qt&&(Ue=!0);var Yn=lr(qt),Ir=qt.tagName.toLowerCase(),Un=mn(qt),gr=Yn("willChange"),Br=parseFloat(Yn("zoom"))||1;if(nn=Yn("position"),S&&Br!==1){hn=Br;break}if(!E&&S&&On!==1&&er&&er!=="absolute"||Ir==="svg"||nn!=="static"||Un&&Un!=="none"||gr==="transform")break;var Tr=(ct=y==null?void 0:y.assignedSlot)===null||ct===void 0?void 0:ct.parentNode,sa=qt.parentNode;Tr&&(Bt=!0,Zt=sa);var Gr=sa;if(Gr&&Gr.nodeType===11){qt=Gr.host,_e=!0,nn=lr(qt)("position");break}qt=Gr,nn="relative"}return{offsetZoom:hn,hasSlot:Bt,parentSlotElement:Zt,isCustomElement:_e,isStatic:nn==="static",isEnd:Ue||!qt||qt===It,offsetParent:qt||It}}function pp(y,m){var E,S=y.tagName.toLowerCase(),D=y.offsetLeft,J=y.offsetTop,ct=lr(y),vt=en(D),It=!vt,Bt,qt;return!It&&S!=="svg"?(Bt=yo?Kl(y):Xf(ct("transformOrigin")).map(function(Zt){return parseFloat(Zt)}),qt=Bt.slice(),It=!0,E=nf(y,Bt,y===m&&m.tagName.toLowerCase()==="g"),D=E[0],J=E[1],Bt[0]=E[2],Bt[1]=E[3]):(Bt=Xf(ct("transformOrigin")).map(function(Zt){return parseFloat(Zt)}),qt=Bt.slice()),{tagName:S,isSVG:vt,hasOffset:It,offset:[D||0,J||0],origin:Bt,targetOrigin:qt}}function br(y,m){var E=lr(y),S=lr(document.body),D=S("position");if(!m&&(!D||D==="static"))return[0,0];var J=parseInt(S("marginLeft"),10),ct=parseInt(S("marginTop"),10);return E("position")==="absolute"&&((E("top")!=="auto"||E("bottom")!=="auto")&&(ct=0),(E("left")!=="auto"||E("right")!=="auto")&&(J=0)),[J,ct]}function Yf(y){y.forEach(function(m){var E=m.matrix;E&&(m.matrix=es(E,3,4))})}function Pf(y){for(var m=y.parentElement,E=!1;m;){var S=yh(m).transform;if(S&&S!=="none"){E=!0;break}if(m===document.body)break;m=m.parentElement}return{fixedContainer:m||document.body,hasTransform:E}}function Tc(y,m){return m===void 0&&(m=y.length>9),"".concat(m?"matrix3d":"matrix","(").concat(Do(y,!m).join(","),")")}function yc(y){var m=y.clientWidth,E=y.clientHeight;if(!y)return{x:0,y:0,width:0,height:0,clientWidth:m,clientHeight:E};var S=y.viewBox,D=S&&S.baseVal||{x:0,y:0,width:0,height:0};return{x:D.x,y:D.y,width:D.width||m,height:D.height||E,clientWidth:m,clientHeight:E}}function gf(y,m){var E=yc(y),S=E.width,D=E.height,J=E.clientWidth,ct=E.clientHeight,vt=J/S,It=ct/D,Bt=y.preserveAspectRatio.baseVal,qt=Bt.align,Zt=Bt.meetOrSlice,Ht=[0,0],be=[vt,It],_e=[0,0];if(qt!==1){var Ue=(qt-2)%3,nn=Math.floor((qt-2)/3);Ht[0]=S*Ue/2,Ht[1]=D*nn/2;var hn=Zt===2?Math.max(It,vt):Math.min(vt,It);be[0]=hn,be[1]=hn,_e[0]=(J-S)/2*Ue,_e[1]=(ct-D)/2*nn}var On=ys(be,m);return On[m*(m-1)]=_e[0],On[m*(m-1)+1]=_e[1],Xc(On,m,Ht)}function nf(y,m,E){if(!y.getBBox||!E&&y.tagName.toLowerCase()==="g")return[0,0,0,0];var S=y.getBBox(),D=yc(y.ownerSVGElement),J=S.x-D.x,ct=S.y-D.y;return[J,ct,m[0]-J,m[1]-ct]}function ol(y,m,E){return To(y,vo(m,E),E)}function Pc(y,m,E,S){return[[0,0],[m,0],[0,E],[m,E]].map(function(D){return ol(y,D,S)})}function tc(y){var m=y.map(function(Bt){return Bt[0]}),E=y.map(function(Bt){return Bt[1]}),S=Math.min.apply(Math,m),D=Math.min.apply(Math,E),J=Math.max.apply(Math,m),ct=Math.max.apply(Math,E),vt=J-S,It=ct-D;return{left:S,top:D,right:J,bottom:ct,width:vt,height:It}}function Ff(y,m,E,S){var D=Pc(y,m,E,S);return tc(D)}function Ac(y,m,E,S,D){var J,ct=y.target,vt=y.origin,It=m.matrix,Bt=vp(ct),qt=Bt.offsetWidth,Zt=Bt.offsetHeight,Ht=E.getBoundingClientRect(),be=[0,0];E===document.body&&(be=br(ct,!0));for(var _e=ct.getBoundingClientRect(),Ue=_e.left-Ht.left+E.scrollLeft-(E.clientLeft||0)+be[0],nn=_e.top-Ht.top+E.scrollTop-(E.clientTop||0)+be[1],hn=_e.width,On=_e.height,er=Wo(S,D,It),Yn=Ff(er,qt,Zt,S),Ir=Yn.left,Un=Yn.top,gr=Yn.width,Br=Yn.height,Tr=ol(er,vt,S),sa=gi(Tr,[Ir,Un]),Gr=[Ue+sa[0]*hn/gr,nn+sa[1]*On/Br],va=[0,0],la=0;++la<10;){var ka=ui(D,S);J=gi(ol(ka,Gr,S),ol(ka,Tr,S)),va[0]=J[0],va[1]=J[1];var ri=Wo(S,D,is(va,S),It),Li=Ff(ri,qt,Zt,S),to=Li.left,fi=Li.top,Ii=to-Ue,Ja=fi-nn;if(Math.abs(Ii)<2&&Math.abs(Ja)<2)break;Gr[0]-=Ii,Gr[1]-=Ja}return va.map(function(oo){return Math.round(oo)})}function Av(y,m,E){var S=y.length===16,D=S?4:3,J=m.map(function(It){return ol(y,It,D)}),ct=E.left,vt=E.top;return J.map(function(It){return[It[0]+ct,It[1]+vt]})}function Bf(y,m,E,S){var D=y.length===16,J=D?4:3,ct=Pc(y,E,S,J),vt=ct[0],It=vt[0],Bt=vt[1],qt=ct[1],Zt=qt[0],Ht=qt[1],be=ct[2],_e=be[0],Ue=be[1],nn=ct[3],hn=nn[0],On=nn[1],er=ol(y,m,J),Yn=er[0],Ir=er[1],Un=Math.min(It,Zt,_e,hn),gr=Math.min(Bt,Ht,Ue,On),Br=Math.max(It,Zt,_e,hn),Tr=Math.max(Bt,Ht,Ue,On);It=It-Un||0,Zt=Zt-Un||0,_e=_e-Un||0,hn=hn-Un||0,Bt=Bt-gr||0,Ht=Ht-gr||0,Ue=Ue-gr||0,On=On-gr||0,Yn=Yn-Un||0,Ir=Ir-gr||0;var sa=zt(Pc(y,100,100,J));return{left:Un,top:gr,right:Br,bottom:Tr,origin:[Yn,Ir],pos1:[It,Bt],pos2:[Zt,Ht],pos3:[_e,Ue],pos4:[hn,On],direction:sa}}function zf(y){return Math.sqrt(y[0]*y[0]+y[1]*y[1])}function Kf(y,m){return zf([m[0]-y[0],m[1]-y[1]])}function Fh(y,m,E,S){E===void 0&&(E=1),S===void 0&&(S=X(y,m));var D=Kf(y,m);return{transform:"translateY(-50%) translate(".concat(y[0],"px, ").concat(y[1],"px) rotate(").concat(S,"rad) scaleY(").concat(E,")"),width:"".concat(D,"px")}}function gh(y,m){for(var E=[],S=2;S<arguments.length;S++)E[S-2]=arguments[S];var D=E.length,J=E.reduce(function(vt,It){return vt+It[0]},0)/D,ct=E.reduce(function(vt,It){return vt+It[1]},0)/D;return{transform:"translateZ(0px) translate(".concat(J,"px, ").concat(ct,"px) rotate(").concat(y,"rad) scale(").concat(m,")")}}function mh(y,m){var E=y[m];return fn(E)?We(We({},y),E):y}function vp(y){var m=y&&!en(y.offsetWidth),E=0,S=0,D=0,J=0,ct=0,vt=0,It=0,Bt=0,qt=0,Zt=0,Ht=0,be=0,_e=Infinity,Ue=Infinity,nn=Infinity,hn=Infinity,On=0,er=0,Yn=!1;if(y)if(!m&&y.tagName.toLowerCase()!=="svg"){var Ir=y.getBBox();Yn=!0,E=Ir.width,S=Ir.height,ct=E,vt=S,It=E,Bt=S,D=E,J=S}else{var Un=lr(y),gr=y.style,Br=Un("boxSizing")==="border-box",Tr=parseFloat(Un("borderLeftWidth"))||0,sa=parseFloat(Un("borderRightWidth"))||0,Gr=parseFloat(Un("borderTopWidth"))||0,va=parseFloat(Un("borderBottomWidth"))||0,la=parseFloat(Un("paddingLeft"))||0,ka=parseFloat(Un("paddingRight"))||0,ri=parseFloat(Un("paddingTop"))||0,Li=parseFloat(Un("paddingBottom"))||0,to=la+ka,fi=ri+Li,Ii=Tr+sa,Ja=Gr+va,oo=to+Ii,Po=fi+Ja,Fo=Un("position"),_s=0,Eo=0;if("clientLeft"in y){var Co=null;if(Fo==="absolute"){var ws=Yc(y,document.body);Co=ws.offsetParent}else Co=y.parentElement;if(Co){var rs=lr(Co);_s=parseFloat(rs("width")),Eo=parseFloat(rs("height"))}}qt=Math.max(to,Dn(Un("minWidth"),_s)||0),Zt=Math.max(fi,Dn(Un("minHeight"),Eo)||0),_e=Dn(Un("maxWidth"),_s),Ue=Dn(Un("maxHeight"),Eo),isNaN(_e)&&(_e=Infinity),isNaN(Ue)&&(Ue=Infinity),On=Dn(gr.width,0)||0,er=Dn(gr.height,0)||0,ct=parseFloat(Un("width"))||0,vt=parseFloat(Un("height"))||0,It=Math.abs(ct-On)<1?un(qt,On||ct,_e):ct,Bt=Math.abs(vt-er)<1?un(Zt,er||vt,Ue):vt,E=It,S=Bt,D=It,J=Bt,Br?(nn=_e,hn=Ue,Ht=qt,be=Zt,It=E-oo,Bt=S-Po):(nn=_e+oo,hn=Ue+Po,Ht=qt+oo,be=Zt+Po,E=It+oo,S=Bt+Po),D=It+to,J=Bt+fi}return{svg:Yn,offsetWidth:E,offsetHeight:S,clientWidth:D,clientHeight:J,contentWidth:It,contentHeight:Bt,inlineCSSWidth:On,inlineCSSHeight:er,cssWidth:ct,cssHeight:vt,minWidth:qt,minHeight:Zt,maxWidth:_e,maxHeight:Ue,minOffsetWidth:Ht,minOffsetHeight:be,maxOffsetWidth:nn,maxOffsetHeight:hn}}function gp(y,m){return X(m>0?y[0]:y[1],m>0?y[1]:y[0])}function fd(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function gl(y,m){var E=y===document.body||y===document.documentElement,S={clientLeft:y.clientLeft,clientTop:y.clientTop,clientWidth:y.clientWidth,clientHeight:y.clientHeight,scrollWidth:y.scrollWidth,scrollHeight:y.scrollHeight,overflow:!1};return E&&(S.clientHeight=Math.max(m.height,S.clientHeight),S.scrollHeight=Math.max(m.height,S.scrollHeight)),S.overflow=lr(y)("overflow")!=="visible",We(We({},m),S)}function mp(y,m,E,S){var D=y.left,J=y.right,ct=y.top,vt=y.bottom,It=m.top,Bt=m.left,qt={left:Bt+D,top:It+ct,right:Bt+J,bottom:It+vt,width:J-D,height:vt-ct};return E&&S?gl(E,qt):qt}function Zf(y,m){var E=0,S=0,D=0,J=0;if(y){var ct=y.getBoundingClientRect();E=ct.left,S=ct.top,D=ct.width,J=ct.height}var vt={left:E,top:S,width:D,height:J,right:E+D,bottom:S+J};return y&&m?gl(y,vt):vt}function Dd(y,m,E,S){var D;if(y)D=y;else if(m)D=[0,0];else{var J=E.target;D=Bh(J,S)}return D}function Bh(y,m){if(!!y){var E=y.getAttribute("data-rotation")||"",S=y.getAttribute("data-direction");if(m.deg=E,!!S){var D=[0,0];return S.indexOf("w")>-1&&(D[0]=-1),S.indexOf("e")>-1&&(D[0]=1),S.indexOf("n")>-1&&(D[1]=-1),S.indexOf("s")>-1&&(D[1]=1),D}}}function zh(y,m){return[bi(m,y[0]),bi(m,y[1]),bi(m,y[2]),bi(m,y[3])]}function uc(y){var m=y.left,E=y.top,S=y.pos1,D=y.pos2,J=y.pos3,ct=y.pos4;return zh([S,D,J,ct],[m,E])}function ml(y,m){var E;(E=y[m])===null||E===void 0||E.unset(),y[m]=null}function Al(y,m){if(m){var E=Cr(m);E.nextStyle=We(We({},E.nextStyle),y)}return{style:y,cssText:ua(y).map(function(S){return"".concat(tr(S,"-"),": ").concat(y[S],";")}).join("")}}function qv(y,m,E){var S=m.afterTransform||m.transform;return We(We({},Al(We(We(We({},y.style),m.style),{transform:S}),E)),{afterTransform:S,transform:y.transform})}function ps(y,m,E,S){var D=m.datas;D.datas||(D.datas={});var J=We(We({},E),{target:y.state.target,clientX:m.clientX,clientY:m.clientY,inputEvent:m.inputEvent,currentTarget:y,moveable:y,datas:D.datas,isFirstDrag:!!m.isFirstDrag,isTrusted:m.isTrusted!==!1,stopAble:function(){D.isEventStart=!1},stopDrag:function(){var ct;(ct=m.stop)===null||ct===void 0||ct.call(m)}});return D.isStartEvent?S||(D.lastEvent=J):D.isStartEvent=!0,J}function ec(y,m,E){var S=m.datas,D="isDrag"in E?E.isDrag:m.isDrag;return S.datas||(S.datas={}),We(We({isDrag:D},E),{moveable:y,target:y.state.target,clientX:m.clientX,clientY:m.clientY,inputEvent:m.inputEvent,currentTarget:y,lastEvent:S.lastEvent,isDouble:m.isDouble,datas:S.datas,isFirstDrag:!!m.isFirstDrag})}function ir(y,m,E){y._emitter.on(m,E)}function no(y,m,E,S){return y.triggerEvent(m,E,S)}function yh(y,m){return window.getComputedStyle(y,m)}function $h(y,m,E){var S={},D={};return y.filter(function(J){var ct=J.name;if(S[ct]||!m.some(function(vt){return J[vt]}))return!1;if(!E&&J.ableGroup){if(D[J.ableGroup])return!1;D[J.ableGroup]=!0}return S[ct]=!0,!0})}function Xp(y,m){return y===m||y==null&&m==null}function $l(){for(var y=[],m=0;m<arguments.length;m++)y[m]=arguments[m];for(var E=y.length-1,S=0;S<E;++S){var D=y[S];if(!en(D))return D}return y[E]}function qf(y,m){var E=[],S=[];return y.forEach(function(D,J){var ct=m(D,J,y),vt=S.indexOf(ct),It=E[vt]||[];vt===-1&&(S.push(ct),E.push(It)),It.push(D)}),E}function Od(y,m){var E=[],S={};return y.forEach(function(D,J){var ct=m(D,J,y),vt=S[ct];vt||(vt=[],S[ct]=vt,E.push(vt)),vt.push(D)}),E}function Gh(y){return y.reduce(function(m,E){return m.concat(E)},[])}function Qf(){for(var y=[],m=0;m<arguments.length;m++)y[m]=arguments[m];return y.sort(function(E,S){return Math.abs(S)-Math.abs(E)}),y[0]}function Uh(y,m,E){return To(ui(y,E),vo(m,E),E)}function yp(y,m){var E,S=y.is3d,D=y.rootMatrix,J=S?4:3;return E=Uh(D,[m.distX,m.distY],J),m.distX=E[0],m.distY=E[1],m}function Ml(y,m,E,S,D){return gi(ol(y,bi(E,m),D),S)}function bc(y,m,E){return E?"".concat(y/m*100,"%"):"".concat(y,"px")}function hd(y){return Math.abs(y)<=wl?0:y}function Rd(y){return function(m){if(!m.isDragging(y))return"";var E=ns(m,y),S=E.deg;return S?mo("view-control-rotation".concat(S)):""}}function xc(y,m){return m===void 0&&(m=[y]),function(E,S){if(S.isRequest)return m.some(function(J){return S.requestAble===J})?S.parentDirection:!1;var D=S.inputEvent.target;return da(D,mo("direction"))&&(!y||da(D,mo(y)))}}function Wh(y,m){var E=y.slice(0,m<0?void 0:m),S=y.slice(0,m<0?void 0:m+1),D=y[m]||"",J=m<0?[]:y.slice(m),ct=m<0?[]:y.slice(m+1),vt=Ss(E),It=Ss(S),Bt=Ss([D]),qt=Ss(J),Zt=Ss(ct),Ht=Ws(vt),be=Ws(It),_e=Ws(qt),Ue=Ws(Zt),nn=Zi(Ht,_e,4);return{transforms:y,beforeFunctionMatrix:Ht,beforeFunctionMatrix2:be,targetFunctionMatrix:Ws(Bt),afterFunctionMatrix:_e,afterFunctionMatrix2:Ue,allFunctionMatrix:nn,beforeFunctions:vt,beforeFunctions2:It,targetFunction:Bt[0],afterFunctions:qt,afterFunctions2:Zt,beforeFunctionTexts:E,beforeFunctionTexts2:S,targetFunctionText:D,afterFunctionTexts:J,afterFunctionTexts2:ct}}function Vh(y){return!y||!fn(y)||y instanceof Element?!1:Rt(y)||"length"in y}function Kc(y,m){return y?y instanceof Element?y:Xn(y)?m?document.querySelector(y):y:xr(y)?y():"current"in y?y.current:y:null}function _f(y,m){if(!y)return[];var E=Vh(y)?[].slice.call(y):[y];return E.reduce(function(S,D){return Xn(D)&&m?_r(_r([],S,!0),[].slice.call(document.querySelectorAll(D)),!0):(Rt(D)?S.push(_f(D,m)):S.push(Kc(D,m)),S)},[])}function lc(y,m,E){var S=X(y,m)/Math.PI*180;return S=E>=0?S:180-S,S=S>=0?S:360+S,S}function If(y,m){var E=y.rootMatrix,S=y.is3d,D=S?4:3,J=ui(E,D);return S||(J=es(J,3,4)),J[12]=0,J[13]=0,J[14]=0,Ms(J,m)}function Jf(y,m,E,S,D){var J=y[0],ct=y[1],vt=0,It=0;if(D&&J&&ct){var Bt=X([0,0],m),qt=X([0,0],S),Zt=zf(m),Ht=Math.cos(Bt-qt)*Zt;if(!S[0])It=Ht,vt=It*E;else if(!S[1])vt=Ht,It=vt/E;else{var be=S[0]*J,_e=S[1]*ct,Ue=Math.atan2(be+m[0],_e+m[1]),nn=Math.atan2(be,_e);Ue<0&&(Ue+=Math.PI*2),nn<0&&(nn+=Math.PI*2);var hn=0;Math.abs(Ue-nn)<Math.PI/2||Math.abs(Ue-nn)>Math.PI/2*3||(nn+=Math.PI),hn=Ue-nn,hn>Math.PI*2?hn-=Math.PI*2:hn>Math.PI?hn=2*Math.PI-hn:hn<-Math.PI&&(hn=-2*Math.PI-hn);var On=zf([be+m[0],_e+m[1]])*Math.cos(hn);vt=On*Math.sin(nn)-be,It=On*Math.cos(nn)-_e,S[0]<0&&(vt*=-1),S[1]<0&&(It*=-1)}}else vt=S[0]*m[0],It=S[1]*m[1];return[vt,It]}function bp(y,m,E,S){var D,J=E.ratio,ct=E.startOffsetWidth,vt=E.startOffsetHeight,It=0,Bt=0,qt=S.distX,Zt=S.distY,Ht=S.pinchScale,be=S.parentDistance,_e=S.parentDist,Ue=S.parentScale,nn=E.fixedDirection,hn=[0,1].map(function(gr){return Math.abs(y[gr]-nn[gr])}),On=[0,1].map(function(gr){var Br=hn[gr];return Br!==0&&(Br=2/Br),Br});if(_e)It=_e[0],Bt=_e[1],m&&(It?Bt||(Bt=It/J):It=Bt*J);else if(Bn(Ht))It=(Ht-1)*ct,Bt=(Ht-1)*vt;else if(Ue)It=(Ue[0]-1)*ct,Bt=(Ue[1]-1)*vt;else if(be){var er=ct*hn[0],Yn=vt*hn[1],Ir=zf([er,Yn]);It=be/Ir*er*On[0],Bt=be/Ir*Yn*On[1]}else{var Un=sc({datas:E,distX:qt,distY:Zt});Un=On.map(function(gr,Br){return Un[Br]*gr}),D=Jf([ct,vt],Un,J,y,m),It=D[0],Bt=D[1]}return{distWidth:It,distHeight:Bt}}function dd(y,m){if(m){if(y==="left")return{x:"0%",y:"50%"};if(y==="top")return{x:"50%",y:"50%"};if(y==="center")return{x:"50%",y:"50%"};if(y==="right")return{x:"100%",y:"50%"};if(y==="bottom")return{x:"50%",y:"100%"};var E=y.split(" "),S=E[0],D=E[1],J=dd(S||""),ct=dd(D||""),vt=We(We({},J),ct),It={x:"50%",y:"50%"};return vt.x&&(It.x=vt.x),vt.y&&(It.y=vt.y),vt.value&&(vt.x&&!vt.y&&(It.y=vt.value),!vt.x&&vt.y&&(It.x=vt.value)),It}return y==="left"?{x:"0%"}:y==="right"?{x:"100%"}:y==="top"?{y:"0%"}:y==="bottom"?{y:"100%"}:y?y==="center"?{value:"50%"}:{value:y}:{}}function xp(y,m,E){var S=dd(y,!0),D=S.x,J=S.y;return[Dn(D,m)||0,Dn(J,E)||0]}function wp(y,m,E){var S=y.map(function(J){return gi(J,m)}),D=S.map(function(J){return Su(J,E)});return{prev:S,next:D,result:D.map(function(J){return bi(J,m)})}}function Yp(y,m){return y.length===m.length&&y.every(function(E,S){var D=m[S],J=Rt(E),ct=Rt(D);return J&&ct?Yp(E,D):!J&&!ct?E===D:!1})}function bh(y,m,E,S){var D=y[m];return m in y&&(D===E||S(D)===S(E))?D:(y[m]=E,E)}var rf=Va("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(y,m){var E=m.datas,S=m.targets,D=m.angle,J=m.originalDatas,ct=y.props,vt=ct.pinchable,It=ct.ables;if(!vt)return!1;var Bt="onPinch".concat(S?"Group":"","Start"),qt="drag".concat(S?"Group":"","ControlStart"),Zt=(vt===!0?y.controlAbles:It.filter(function(Ue){return vt.indexOf(Ue.name)>-1})).filter(function(Ue){return Ue.canPinch&&Ue[qt]}),Ht=ps(y,m,{});S&&(Ht.targets=S);var be=no(y,Bt,Ht);E.isPinch=be!==!1,E.ables=Zt;var _e=E.isPinch;return _e?(Zt.forEach(function(Ue){if(J[Ue.name]=J[Ue.name]||{},!!Ue[qt]){var nn=We(We({},m),{datas:J[Ue.name],parentRotate:D,isPinch:!0});Ue[qt](y,nn)}}),y.state.snapRenderInfo={request:m.isRequest,direction:[0,0]},_e):!1},pinch:function(y,m){var E=m.datas,S=m.scale,D=m.distance,J=m.originalDatas,ct=m.inputEvent,vt=m.targets,It=m.angle;if(!!E.isPinch){var Bt=D*(1-1/S),qt=ps(y,m,{});vt&&(qt.targets=vt);var Zt="onPinch".concat(vt?"Group":"");no(y,Zt,qt);var Ht=E.ables,be="drag".concat(vt?"Group":"","Control");return Ht.forEach(function(_e){!_e[be]||_e[be](y,We(We({},m),{datas:J[_e.name],inputEvent:ct,resolveMatrix:!0,pinchScale:S,parentDistance:Bt,parentRotate:It,isPinch:!0}))}),qt}},pinchEnd:function(y,m){var E=m.datas,S=m.isPinch,D=m.inputEvent,J=m.targets,ct=m.originalDatas;if(!!E.isPinch){var vt="onPinch".concat(J?"Group":"","End"),It=ec(y,m,{isDrag:S});J&&(It.targets=J),no(y,vt,It);var Bt=E.ables,qt="drag".concat(J?"Group":"","ControlEnd");return Bt.forEach(function(Zt){!Zt[qt]||Zt[qt](y,We(We({},m),{isDrag:S,datas:ct[Zt.name],inputEvent:D,isPinch:!0}))}),S}},pinchGroupStart:function(y,m){return this.pinchStart(y,We(We({},m),{targets:y.props.targets}))},pinchGroup:function(y,m){return this.pinch(y,We(We({},m),{targets:y.props.targets}))},pinchGroupEnd:function(y,m){return this.pinchEnd(y,We(We({},m),{targets:y.props.targets}))}});function wc(y,m,E){var S=E.originalDatas;S.groupable=S.groupable||{};var D=S.groupable;D.childDatas=D.childDatas||[];var J=D.childDatas;return y.moveables.map(function(ct,vt){return J[vt]=J[vt]||{},J[vt][m]=J[vt][m]||{},We(We({},E),{datas:J[vt][m],originalDatas:J[vt]})})}function Mv(y,m,E,S,D,J,ct){var vt=!!E.match(/Start$/g),It=!!E.match(/End$/g),Bt=D.isPinch,qt=D.datas,Zt=wc(y,m.name,D),Ht=y.moveables,be=Zt.map(function(_e,Ue){var nn=Ht[Ue],hn=nn.state,On=hn.gestos,er=_e;if(vt)er=new Rf(ct).dragStart(S,_e);else{if(On[ct]||(On[ct]=qt.childGestos[Ue]),!On[ct])return;er=df(_e,hn,S,Bt,J,ct)}var Yn=m[E](nn,We(We({},er),{parentFlag:!0}));return It&&(On[ct]=null),Yn});return vt&&(qt.childGestos=Ht.map(function(_e){return _e.state.gestos[ct]})),be}function $f(y,m,E,S,D,J){D===void 0&&(D=function(qt,Zt){return Zt});var ct=!!E.match(/End$/g),vt=wc(y,m.name,S),It=y.moveables,Bt=vt.map(function(qt,Zt){var Ht=It[Zt],be=qt;be=D(Ht,qt);var _e=m[E](Ht,We(We({},be),{parentFlag:!0}));return _e&&J&&J(Ht,qt,_e,Zt),ct&&(Ht.state.gestos={}),_e});return Bt}function jh(y,m,E,S){var D=E.fixedDirection,J=E.fixedPosition,ct=S.datas.startPositions||uc(m.state),vt=js(ct,D),It=To(Zo(-y.rotation/180*Math.PI,3),[vt[0]-J[0],vt[1]-J[1],1],3),Bt=It[0],qt=It[1];return S.datas.originalX=Bt,S.datas.originalY=qt,S}var Nv=["left","right","center"],zs=["top","bottom","middle"],af={start:"left",end:"right",center:"center"},qi={start:"top",end:"bottom",center:"middle"};function pd(y,m){var E=y.props,S=E.snappable,D=E.bounds,J=E.innerBounds,ct=E.verticalGuidelines,vt=E.horizontalGuidelines,It=E.snapGridWidth,Bt=E.snapGridHeight,qt=y.state,Zt=qt.guidelines,Ht=qt.enableSnap;return!S||!Ht||m&&S!==!0&&S.indexOf(m)<0?!1:!!(It||Bt||D||J||Zt&&Zt.length||ct&&ct.length||vt&&vt.length)}function th(y){return y===!1?{}:y===!0||!y?{left:!0,right:!0,top:!0,bottom:!0}:y}function Kp(y,m){var E=th(y),S={};for(var D in E)D in m&&E[D]&&(S[D]=m[D]);return S}function Ep(y,m){var E=Kp(y,m),S=zs.filter(function(J){return J in E}),D=Nv.filter(function(J){return J in E});return{horizontal:S.map(function(J){return E[J]}),vertical:D.map(function(J){return E[J]})}}function Sg(y,m,E){var S=ol(y,[m.clientLeft,m.clientTop],E);return[m.left+S[0],m.top+S[1]]}function Qv(y){var m=y[0],E=y[1],S=E[0]-m[0],D=E[1]-m[1];Math.abs(S)<Ve&&(S=0),Math.abs(D)<Ve&&(D=0);var J=0,ct=0,vt=0;return S?D?(J=-D/S,ct=1,vt=J*m[0]-m[1]):(ct=1,vt=-m[1]):(J=-1,vt=m[0]),[J,ct,vt].map(function(It){return Xt(It,Ve)})}function Ld(y,m,E,S){var D=y.props,J=$l(S,D.snapThreshold,5);return Zp(y.state.guidelines,m,E,J)}function Zp(y,m,E,S){return{vertical:Qp(y,"vertical",m,S),horizontal:Qp(y,"horizontal",E,S)}}function xh(y,m,E){var S=E[0],D=E[1],J=m[0],ct=m[1],vt=gi(E,m),It=vt[0],Bt=vt[1],qt=Bt>0,Zt=It>0;It=hd(It),Bt=hd(Bt);var Ht={isSnap:!1,offset:0,pos:0},be={isSnap:!1,offset:0,pos:0};if(It===0&&Bt===0)return{vertical:Ht,horizontal:be};var _e=Ld(y,It?[S]:[],Bt?[D]:[]),Ue=_e.vertical,nn=_e.horizontal;Ue.posInfos.filter(function(ka){var ri=ka.pos;return Zt?ri>=J:ri<=J}),nn.posInfos.filter(function(ka){var ri=ka.pos;return qt?ri>=ct:ri<=ct}),Ue.isSnap=Ue.posInfos.length>0,nn.isSnap=nn.posInfos.length>0;var hn=qp(Ue),On=hn.isSnap,er=hn.guideline,Yn=qp(nn),Ir=Yn.isSnap,Un=Yn.guideline,gr=Ir?Un.pos[1]:0,Br=On?er.pos[0]:0;if(It===0)Ir&&(be.isSnap=!0,be.pos=Un.pos[1],be.offset=D-be.pos);else if(Bt===0)On&&(Ht.isSnap=!0,Ht.pos=Br,Ht.offset=S-Br);else{var Tr=Bt/It,sa=E[1]-Tr*S,Gr=0,va=0,la=!1;On?(va=Br,Gr=Tr*va+sa,la=!0):Ir&&(Gr=gr,va=(Gr-sa)/Tr,la=!0),la&&(Ht.isSnap=!0,Ht.pos=va,Ht.offset=S-va,be.isSnap=!0,be.pos=Gr,be.offset=D-Gr)}return{vertical:Ht,horizontal:be}}function kv(y,m,E){var S=Ep(y.props.snapDirections,m);return Ld(y,S.vertical,S.horizontal,E)}function qp(y){var m=y.isSnap;if(!m)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var E=y.posInfos[0],S=E.guidelineInfos[0],D=S.offset,J=S.dist,ct=S.guideline;return{isSnap:m,offset:D,dist:J,pos:E.pos,guideline:ct}}function Qp(y,m,E,S){if(!y||!y.length)return{isSnap:!1,index:-1,posInfos:[]};var D=m==="vertical",J=D?0:1,ct=E.map(function(It,Bt){var qt=y.map(function(Zt){var Ht=Zt.pos,be=It-Ht[J];return{offset:be,dist:Math.abs(be),guideline:Zt}}).filter(function(Zt){var Ht=Zt.guideline,be=Zt.dist,_e=Ht.type;return!(_e!==m||be>S)}).sort(function(Zt,Ht){return Zt.dist-Ht.dist});return{pos:It,index:Bt,guidelineInfos:qt}}).filter(function(It){return It.guidelineInfos.length>0}).sort(function(It,Bt){return It.guidelineInfos[0].dist-Bt.guidelineInfos[0].dist}),vt=ct.length>0;return{isSnap:vt,index:vt?ct[0].index:-1,posInfos:ct}}function eh(y,m,E,S){S===void 0&&(S=1);var D=[];if(E[0]&&E[1])D=[E,[-E[0],E[1]],[E[0],-E[1]]].map(function(vt){return js(m,vt)});else if(!E[0]&&!E[1])for(var J=[m[0],m[1],m[3],m[2],m[0]],ct=0;ct<4;++ct)D.push(J[ct]),D.push([(J[ct][0]+J[ct+1][0])/2,(J[ct][1]+J[ct+1][1])/2]);else y.props.keepRatio?D=[[-1,-1],[-1,1],[1,-1],[1,1],E].map(function(vt){return js(m,vt)}):(D=Lf(m,E),D.length>1&&D.push([(D[0][0]+D[1][0])/2,(D[0][1]+D[1][1])/2]));return Ld(y,D.map(function(vt){return vt[0]}),D.map(function(vt){return vt[1]}),S)}function vd(y,m){var E=Math.abs(y.offset),S=Math.abs(m.offset);return y.isBound&&m.isBound?S-E:y.isBound?-1:m.isBound?1:y.isSnap&&m.isSnap?S-E:y.isSnap?-1:m.isSnap||E<wl?1:S<wl?-1:E-S}function Hh(y,m){return y.slice().sort(function(E,S){var D=E.sign[m],J=S.sign[m],ct=E.offset[m],vt=S.offset[m];if(D){if(!J)return-1}else return 1;return vd({isBound:E.isBound,isSnap:E.isSnap,offset:ct},{isBound:S.isBound,isSnap:S.isSnap,offset:vt})})[0]}function Pd(y,m,E){var S=[];if(E)Math.abs(m[0])!==1||Math.abs(m[1])!==1?S.push([m,[-1,-1]],[m,[-1,1]],[m,[1,-1]],[m,[1,1]]):S.push([m,[y[0],-y[1]]],[m,[-y[0],y[1]]]),S.push([m,y]);else if(y[0]&&y[1]||!y[0]&&!y[1]){var D=y[0]?y:[1,1];[1,-1].forEach(function(ct){[1,-1].forEach(function(vt){var It=[ct*D[0],vt*D[1]];m[0]===It[0]&&m[1]===It[1]||S.push([m,It])})})}else if(y[0]){var J=Math.abs(m[0])===1?[1]:[1,-1];J.forEach(function(ct){S.push([[m[0],-1],[ct*y[0],-1]],[[m[0],0],[ct*y[0],0]],[[m[0],1],[ct*y[0],1]])})}else if(y[1]){var J=Math.abs(m[1])===1?[1]:[1,-1];J.forEach(function(vt){S.push([[-1,m[1]],[-1,vt*y[1]]],[[0,m[1]],[0,vt*y[1]]],[[1,m[1]],[1,vt*y[1]]])})}return S}function Fd(y,m){var E=H([m[0][0],m[1][0]]),S=H([m[0][1],m[1][1]]);return{vertical:E<=y[0],horizontal:S<=y[1]}}function Sp(y,m){var E=m[0],S=m[1],D=S[0]-E[0],J=S[1]-E[1];Math.abs(D)<wl&&(D=0),Math.abs(J)<wl&&(J=0);var ct,vt;if(!D)ct=E[0],vt=y[0];else if(!J)ct=E[1],vt=y[1];else{var It=J/D;ct=It*(y[0]-E[0])+E[1],vt=y[1]}return ct-vt}function Bd(y,m,E,S){return S===void 0&&(S=wl),y.every(function(D){var J=Sp(D,m),ct=J<=0;return ct===E||Math.abs(J)<=S})}function wh(y,m,E,S,D){return D===void 0&&(D=0),S&&m-D<=y||!S&&y<=E+D?{isBound:!0,offset:S?m-y:E-y}:{isBound:!1,offset:0}}function Cp(y,m){var E=m.line,S=m.centerSign,D=m.verticalSign,J=m.horizontalSign,ct=m.lineConstants,vt=y.props.innerBounds;if(!vt)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var It=vt.left,Bt=vt.top,qt=vt.width,Zt=vt.height,Ht=[[It,Bt],[It,Bt+Zt]],be=[[It,Bt],[It+qt,Bt]],_e=[[It+qt,Bt],[It+qt,Bt+Zt]],Ue=[[It,Bt+Zt],[It+qt,Bt+Zt]];if(Bd([[It,Bt],[It+qt,Bt],[It,Bt+Zt],[It+qt,Bt+Zt]],E,S))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var nn=Tf(E,ct,be,D),hn=Tf(E,ct,Ue,D),On=Tf(E,ct,Ht,J),er=Tf(E,ct,_e,J),Yn=nn.isBound&&hn.isBound,Ir=nn.isBound||hn.isBound,Un=On.isBound&&er.isBound,gr=On.isBound||er.isBound,Br=Qf(nn.offset,hn.offset),Tr=Qf(On.offset,er.offset),sa=[0,0],Gr=!1,va=!1;return Math.abs(Tr)<Math.abs(Br)?(sa=[Br,0],Gr=Ir,va=Yn):(sa=[0,Tr],Gr=gr,va=Un),{isAllBound:va,isVerticalBound:Ir,isHorizontalBound:gr,isBound:Gr,offset:sa}}function Tf(y,m,E,S,D,J){var ct=m[0],vt=m[1],It=y[0],Bt=E[0],qt=E[1],Zt=hd(qt[1]-Bt[1]),Ht=hd(qt[0]-Bt[0]),be=vt,_e=ct,Ue=-ct/vt;if(Ht){if(!Zt){if(J&&!be)return{isBound:!1,offset:0};if(_e){var er=(Bt[1]-It[1])/Ue+It[0];return wh(er,Bt[0],qt[0],S,D)}else{var hn=Bt[1]-It[1],On=Math.abs(hn)<=(D||0);return{isBound:On,offset:On?hn:0}}}}else{if(J&&!_e)return{isBound:!1,offset:0};if(be){var nn=Ue*(Bt[0]-It[0])+It[1];return wh(nn,Bt[1],qt[1],S,D)}else{var hn=Bt[0]-It[0],On=Math.abs(hn)<=(D||0);return{isBound:On,offset:On?hn:0}}}return{isBound:!1,offset:0}}function zd(y,m,E){return m.map(function(S){var D=Cp(y,S),J=D.isBound,ct=D.offset,vt=D.isVerticalBound,It=D.isHorizontalBound,Bt=S.multiple,qt=sc({datas:E,distX:ct[0],distY:ct[1]}).map(function(Zt,Ht){return Zt*(Bt[Ht]?2/Bt[Ht]:0)});return{sign:Bt,isBound:J,isVerticalBound:vt,isHorizontalBound:It,isSnap:!1,offset:qt}})}function $d(y,m,E){var S,D=Eh(y,m,[0,0],!1).map(function(Ht){return We(We({},Ht),{multiple:Ht.multiple.map(function(be){return Math.abs(be)*2})})}),J=zd(y,D,E),ct=Hh(J,0),vt=Hh(J,1),It=0,Bt=0,qt=ct.isVerticalBound||vt.isVerticalBound,Zt=ct.isHorizontalBound||vt.isHorizontalBound;return(qt||Zt)&&(S=ef({datas:E,distX:-ct.offset[0],distY:-vt.offset[1]}),It=S[0],Bt=S[1]),{vertical:{isBound:qt,offset:It},horizontal:{isBound:Zt,offset:Bt}}}function gd(y,m){var E=[],S=y[0],D=y[1];return S&&D?E.push([[0,D*2],y,[-S,D]],[[S*2,0],y,[S,-D]]):S?(E.push([[S*2,0],[S,1],[S,-1]]),m&&E.push([[0,-1],[S,-1],[-S,-1]],[[0,1],[S,1],[-S,1]])):D?(E.push([[0,D*2],[1,D],[-1,D]]),m&&E.push([[-1,0],[-1,D],[-1,-D]],[[1,0],[1,D],[1,-D]])):E.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),E}function Eh(y,m,E,S){var D=y.state,J=D.allMatrix,ct=D.is3d,vt=Pc(J,100,100,ct?4:3),It=js(vt,[0,0]);return gd(E,S).map(function(Bt){var qt=Bt[0],Zt=Bt[1],Ht=Bt[2],be=[js(vt,Zt),js(vt,Ht)],_e=Qv(be),Ue=Fd(It,be),nn=Ue.vertical,hn=Ue.horizontal,On=Sp(It,be)<=0;return{multiple:qt,centerSign:On,verticalSign:nn,horizontalSign:hn,lineConstants:_e,line:[js(m,Zt),js(m,Ht)]}})}function Gd(y,m,E,S){var D=S?y.map(function(J){return Su(J,S)}):y;return[[D[0],D[1]],[D[1],D[3]],[D[3],D[2]],[D[2],D[0]]].some(function(J){var ct=Sp(E,J)<=0;return!Bd(m,J,ct)})}function Ud(y){var m=y[0],E=y[1],S=E[0]-m[0],D=E[1]-m[1];if(!S)return Math.abs(m[0]);if(!D)return Math.abs(m[1]);var J=D/S;return Math.abs((-J*m[0]+m[1])/Math.sqrt(Math.pow(J,2)+1))}function Xh(y){var m=y[0],E=y[1],S=E[0]-m[0],D=E[1]-m[1];if(!S)return[m[0],0];if(!D)return[0,m[1]];var J=D/S,ct=-J*m[0]+m[1];return[-ct/(J+1/J),ct/(J*J+1)]}function Wd(y,m,E,S,D){var J=y.props.innerBounds,ct=D*Math.PI/180;if(!J)return[];var vt=J.left,It=J.top,Bt=J.width,qt=J.height,Zt=vt-S[0],Ht=vt+Bt-S[0],be=It-S[1],_e=It+qt-S[1],Ue=[[Zt,be],[Ht,be],[Zt,_e],[Ht,_e]],nn=js(E,[0,0]);if(!Gd(E,Ue,nn,0))return[];var hn=[],On=Ue.map(function(er){return[zf(er),X([0,0],er)]});return[[E[0],E[1]],[E[1],E[3]],[E[3],E[2]],[E[2],E[0]]].forEach(function(er){var Yn=X([0,0],Xh(er)),Ir=Ud(er);hn.push.apply(hn,On.filter(function(Un){var gr=Un[0];return gr&&Ir<=gr}).map(function(Un){var gr=Un[0],Br=Un[1],Tr=Math.acos(gr?Ir/gr:0),sa=Br+Tr,Gr=Br-Tr;return[ct+sa-Yn,ct+Gr-Yn]}).reduce(function(Un,gr){return Un.push.apply(Un,gr),Un},[]).filter(function(Un){return!Gd(m,Ue,nn,Un)}).map(function(Un){return Xt(Un*180/Math.PI,wl)}))}),hn}function $s(y){var m=y.props.innerBounds;if(!m)return{vertical:[],horizontal:[]};var E=y.getRect(),S=E.pos1,D=E.pos2,J=E.pos3,ct=E.pos4,vt=[S,D,J,ct],It=js(vt,[0,0]),Bt=m.left,qt=m.top,Zt=m.width,Ht=m.height,be=[[Bt,qt],[Bt,qt+Ht]],_e=[[Bt,qt],[Bt+Zt,qt]],Ue=[[Bt+Zt,qt],[Bt+Zt,qt+Ht]],nn=[[Bt,qt+Ht],[Bt+Zt,qt+Ht]],hn=Eh(y,vt,[0,0],!1),On=[],er=[],Yn={top:!1,bottom:!1,left:!1,right:!1};return hn.forEach(function(Ir){var Un=Ir.line,gr=Ir.lineConstants,Br=Fd(It,Un),Tr=Br.horizontal,sa=Br.vertical,Gr=Tf(Un,gr,_e,sa,1,!0),va=Tf(Un,gr,nn,sa,1,!0),la=Tf(Un,gr,be,Tr,1,!0),ka=Tf(Un,gr,Ue,Tr,1,!0);Gr.isBound&&!Yn.top&&(On.push(qt),Yn.top=!0),va.isBound&&!Yn.bottom&&(On.push(qt+Ht),Yn.bottom=!0),la.isBound&&!Yn.left&&(er.push(Bt),Yn.left=!0),ka.isBound&&!Yn.right&&(er.push(Bt+Zt),Yn.right=!0)}),{horizontal:On,vertical:er}}function md(y,m,E){var S=y||{},D=S.position,J=D===void 0?"client":D,ct=S.left,vt=ct===void 0?-Infinity:ct,It=S.top,Bt=It===void 0?-Infinity:It,qt=S.right,Zt=qt===void 0?Infinity:qt,Ht=S.bottom,be=Ht===void 0?Infinity:Ht,_e={position:J,left:vt,top:Bt,right:Zt,bottom:be};return{vertical:mu(_e,m,!0),horizontal:mu(_e,E,!1)}}function Mc(y,m){var E=y.state,S=E.containerClientRect,D=S.clientHeight,J=S.clientWidth,ct=S.clientLeft,vt=S.clientTop,It=E.snapOffset,Bt=It.left,qt=It.top,Zt=It.right,Ht=It.bottom,be=m||y.props.bounds||{},_e=be.position||"client",Ue=_e==="css",nn=be.left,hn=nn===void 0?-Infinity:nn,On=be.top,er=On===void 0?-Infinity:On,Yn=be.right,Ir=Yn===void 0?Ue?-Infinity:Infinity:Yn,Un=be.bottom,gr=Un===void 0?Ue?-Infinity:Infinity:Un;return Ue&&(Ir=J+Zt-Bt-Ir,gr=D+Ht-qt-gr),{left:hn+Bt-ct,right:Ir+Bt-ct,top:er+qt-vt,bottom:gr+qt-vt}}function Jv(y,m,E){var S=Mc(y),D=S.left,J=S.top,ct=S.right,vt=S.bottom,It=E[0],Bt=E[1],qt=gi(E,m),Zt=qt[0],Ht=qt[1];Math.abs(Zt)<wl&&(Zt=0),Math.abs(Ht)<wl&&(Ht=0);var be=Ht>0,_e=Zt>0,Ue={isBound:!1,offset:0,pos:0},nn={isBound:!1,offset:0,pos:0};if(Zt===0&&Ht===0)return{vertical:Ue,horizontal:nn};if(Zt===0)be?vt<Bt&&(nn.pos=vt,nn.offset=Bt-vt):J>Bt&&(nn.pos=J,nn.offset=Bt-J);else if(Ht===0)_e?ct<It&&(Ue.pos=ct,Ue.offset=It-ct):D>It&&(Ue.pos=D,Ue.offset=It-D);else{var hn=Ht/Zt,On=E[1]-hn*It,er=0,Yn=0,Ir=!1;_e&&ct<=It?(er=hn*ct+On,Yn=ct,Ir=!0):!_e&&It<=D&&(er=hn*D+On,Yn=D,Ir=!0),Ir&&(er<J||er>vt)&&(Ir=!1),Ir||(be&&vt<=Bt?(er=vt,Yn=(er-On)/hn,Ir=!0):!be&&Bt<=J&&(er=J,Yn=(er-On)/hn,Ir=!0)),Ir&&(Ue.isBound=!0,Ue.pos=Yn,Ue.offset=It-Yn,nn.isBound=!0,nn.pos=er,nn.offset=Bt-er)}return{vertical:Ue,horizontal:nn}}function mu(y,m,E){var S=y[E?"left":"top"],D=y[E?"right":"bottom"],J=Math.min.apply(Math,m),ct=Math.max.apply(Math,m),vt=[];return S+1>J&&vt.push({isBound:!0,offset:J-S,pos:S}),D-1<ct&&vt.push({isBound:!0,offset:ct-D,pos:D}),vt.length||vt.push({isBound:!1,offset:0,pos:0}),vt.sort(function(It,Bt){return Math.abs(Bt.offset)-Math.abs(It.offset)})}function Dv(y,m,E){var S=E?y.map(function(D){return Su(D,E)}):y;return S.some(function(D){return D[0]<m.left&&Math.abs(D[0]-m.left)>.1||D[0]>m.right&&Math.abs(D[0]-m.right)>.1||D[1]<m.top&&Math.abs(D[1]-m.top)>.1||D[1]>m.bottom&&Math.abs(D[1]-m.bottom)>.1})}function Vd(y,m,E){var S=zf(y),D=Math.sqrt(S*S-m*m)||0;return[D,-D].sort(function(J,ct){return Math.abs(J-y[E?0:1])-Math.abs(ct-y[E?0:1])}).map(function(J){return X([0,0],E?[J,m]:[m,J])})}function Jp(y,m,E,S,D){if(!y.props.bounds)return[];var J=D*Math.PI/180,ct=Mc(y),vt=ct.left,It=ct.top,Bt=ct.right,qt=ct.bottom,Zt=vt-S[0],Ht=Bt-S[0],be=It-S[1],_e=qt-S[1],Ue={left:Zt,top:be,right:Ht,bottom:_e};if(!Dv(E,Ue,0))return[];var nn=[];return[[Zt,0],[Ht,0],[be,1],[_e,1]].forEach(function(hn){var On=hn[0],er=hn[1];E.forEach(function(Yn){var Ir=X([0,0],Yn);nn.push.apply(nn,Vd(Yn,On,er).map(function(Un){return J+Un-Ir}).filter(function(Un){return!Dv(m,Ue,Un)}).map(function(Un){return Xt(Un*180/Math.PI,wl)}))})}),nn}function Zc(y,m){var E,S=y.direction,D=y.classNames,J=y.size,ct=y.pos,vt=y.zoom,It=y.key,Bt=S==="horizontal",qt=Bt?"Y":"X";return m.createElement("div",{key:It,className:D.join(" "),style:(E={},E[Bt?"width":"height"]="".concat(J),E.transform="translate(".concat(ct[0],", ").concat(ct[1],") translate").concat(qt,"(-50%) scale").concat(qt,"(").concat(vt,")"),E)})}function tv(y,m){return Zc(We(We({},y),{classNames:_r([mo("line","guideline",y.direction)],y.classNames,!0).filter(function(E){return E}),size:y.size||"".concat(y.sizeValue,"px"),pos:y.pos||y.posValue.map(function(E){return"".concat(Xt(E,.1),"px")})}),m)}function ev(y,m,E,S,D,J,ct,vt){var It=y.props.zoom;return E.map(function(Bt,qt){var Zt=Bt.type,Ht=Bt.pos,be=[0,0];return be[ct]=S,be[ct?0:1]=-D+Ht,tv({key:"".concat(m,"TargetGuideline").concat(qt),classNames:[mo("target","bold",Zt)],posValue:be,sizeValue:J,zoom:It,direction:m},vt)})}function nv(y,m,E,S,D,J){var ct=y.props,vt=ct.zoom,It=ct.isDisplayInnerSnapDigit,Bt=m==="horizontal"?af:qi,qt=D[Bt.start],Zt=D[Bt.end];return E.filter(function(Ht){var be=Ht.hide,_e=Ht.elementRect;if(be)return!1;if(It&&_e){var Ue=_e.rect;if(Ue[Bt.start]<=qt&&Zt<=Ue[Bt.end])return!1}return!0}).map(function(Ht,be){var _e=Ht.pos,Ue=Ht.size,nn=Ht.element,hn=Ht.className,On=[-S[0]+_e[0],-S[1]+_e[1]];return tv({key:"".concat(m,"-default-guideline-").concat(be),classNames:nn?[mo("bold"),hn]:[mo("normal"),hn],direction:m,posValue:On,sizeValue:Ue,zoom:vt},J)})}function Sh(y,m,E,S,D,J,ct,vt){var It,Bt=y.props,qt=Bt.snapDigit,Zt=qt===void 0?0:qt,Ht=Bt.isDisplaySnapDigit,be=Ht===void 0?!0:Ht,_e=Bt.snapDistFormat,Ue=_e===void 0?function(Ir,Un){return Ir}:_e,nn=Bt.zoom,hn=m==="horizontal"?"X":"Y",On=m==="vertical"?"height":"width",er=Math.abs(D),Yn=be?parseFloat(er.toFixed(Zt)):0;return vt.createElement("div",{key:"".concat(m,"-").concat(E,"-guideline-").concat(S),className:mo("guideline-group",m),style:(It={left:"".concat(J[0],"px"),top:"".concat(J[1],"px")},It[On]="".concat(er,"px"),It)},tv({direction:m,classNames:[mo(E),ct],size:"100%",posValue:[0,0],sizeValue:er,zoom:nn},vt),vt.createElement("div",{className:mo("size-value","gap"),style:{transform:"translate".concat(hn,"(-50%) scale(").concat(nn,")")}},Yn>0?Ue(Yn,m):""))}function rv(y,m,E,S){var D=y==="vertical"?0:1,J=y==="vertical"?1:0,ct=D?af:qi,vt=E[ct.start],It=E[ct.end];return qf(m,function(Bt){return Bt.pos[D]}).map(function(Bt){var qt=[],Zt=[],Ht=[];return Bt.forEach(function(be){var _e,Ue,nn=be.element,hn=be.elementRect.rect;if(hn[ct.end]<vt)qt.push(be);else if(It<hn[ct.start])Zt.push(be);else if(hn[ct.start]<=vt&&It<=hn[ct.end]&&S){var On=be.pos,er={element:nn,rect:We(We({},hn),(_e={},_e[ct.end]=hn[ct.start],_e))},Yn={element:nn,rect:We(We({},hn),(Ue={},Ue[ct.start]=hn[ct.end],Ue))},Ir=[0,0],Un=[0,0];Ir[D]=On[D],Ir[J]=On[J],Un[D]=On[D],Un[J]=On[J]+be.size,qt.push({type:y,pos:Ir,size:0,elementRect:er}),Zt.push({type:y,pos:Un,size:0,elementRect:Yn})}}),qt.sort(function(be,_e){return _e.pos[J]-be.pos[J]}),Zt.sort(function(be,_e){return be.pos[J]-_e.pos[J]}),{total:Bt,start:qt,end:Zt,inner:Ht}})}function tg(y,m,E,S,D){var J=y.props.isDisplayInnerSnapDigit,ct=[];return["vertical","horizontal"].forEach(function(vt){var It=m.filter(function(nn){return nn.type===vt}),Bt=vt==="vertical"?1:0,qt=Bt?0:1,Zt=rv(vt,It,S,J),Ht=Bt?qi:af,be=Bt?af:qi,_e=S[Ht.start],Ue=S[Ht.end];Zt.forEach(function(nn){var hn=nn.total,On=nn.start,er=nn.end,Yn=nn.inner,Ir=E[qt]+hn[0].pos[qt]-S[be.start],Un=S;On.forEach(function(gr){var Br=gr.elementRect.rect,Tr=Un[Ht.start]-Br[Ht.end];if(Tr>0){var sa=[0,0];sa[Bt]=E[Bt]+Un[Ht.start]-_e-Tr,sa[qt]=Ir,ct.push(Sh(y,vt,"dashed",ct.length,Tr,sa,gr.className,D))}Un=Br}),Un=S,er.forEach(function(gr){var Br=gr.elementRect.rect,Tr=Br[Ht.start]-Un[Ht.end];if(Tr>0){var sa=[0,0];sa[Bt]=E[Bt]+Un[Ht.end]-_e,sa[qt]=Ir,ct.push(Sh(y,vt,"dashed",ct.length,Tr,sa,gr.className,D))}Un=Br}),Yn.forEach(function(gr){var Br=gr.elementRect.rect,Tr=_e-Br[Ht.start],sa=Br[Ht.end]-Ue,Gr=[0,0],va=[0,0];Gr[Bt]=E[Bt]-Tr,Gr[qt]=Ir,va[Bt]=E[Bt]+Ue-_e,va[qt]=Ir,ct.push(Sh(y,vt,"dashed",ct.length,Tr,Gr,gr.className,D)),ct.push(Sh(y,vt,"dashed",ct.length,sa,va,gr.className,D))})})}),ct}function Gl(y,m,E,S,D){var J=[];return["horizontal","vertical"].forEach(function(ct){var vt=m.filter(function(nn){return nn.type===ct}).slice(0,1),It=ct==="vertical"?0:1,Bt=It?0:1,qt=It?qi:af,Zt=It?af:qi,Ht=S[qt.start],be=S[qt.end],_e=S[Zt.start],Ue=S[Zt.end];vt.forEach(function(nn){var hn=nn.gap,On=nn.gapRects,er=Math.max.apply(Math,_r([_e],On.map(function(Un){var gr=Un.rect;return gr[Zt.start]}),!1)),Yn=Math.min.apply(Math,_r([Ue],On.map(function(Un){var gr=Un.rect;return gr[Zt.end]}),!1)),Ir=(er+Yn)/2;er===Yn||Ir===(_e+Ue)/2||On.forEach(function(Un){var gr=Un.rect,Br=Un.className,Tr=[E[0],E[1]];if(gr[qt.end]<Ht)Tr[It]+=gr[qt.end]-Ht;else if(be<gr[qt.start])Tr[It]+=gr[qt.start]-Ht-hn;else return;Tr[Bt]+=Ir-_e,J.push(Sh(y,It?"vertical":"horizontal","gap",J.length,hn,Tr,Br,D))})})}),J}function av(y,m,E,S){var D=m[0]-y[0],J=m[1]-y[1];if(Math.abs(D)<Ve&&(D=0),Math.abs(J)<Ve&&(J=0),!D)return S?[0,0]:[0,E];if(!J)return S?[E,0]:[0,0];var ct=J/D,vt=y[1]-ct*y[0];if(S){var It=ct*(m[0]+E)+vt;return[E,It-m[1]]}else{var Bt=(m[1]+E-vt)/ct;return[Bt-m[0],E]}}function Af(y,m,E,S,D){var J=av(y,m,E,S);if(!J)return{isOutside:!1,offset:[0,0]};var ct=Vt(y,m),vt=Vt(J,y),It=Vt(J,m),Bt=vt>ct||It>ct,qt=sc({datas:D,distX:J[0],distY:J[1]}),Zt=qt[0],Ht=qt[1];return{offset:[Zt,Ht],isOutside:Bt}}function Mf(y,m){return y.isBound?y.offset:m.isSnap?qp(m).offset:0}function Ov(y,m,E,S,D){var J=m[0],ct=m[1],vt=E[0],It=E[1],Bt=S[0],qt=S[1],Zt=D[0],Ht=D[1],be=-Zt,_e=-Ht;if(y&&J&&ct){be=0,_e=0;var Ue=[];if(vt&&It?Ue.push([0,Ht],[Zt,0]):vt?Ue.push([Zt,0]):It?Ue.push([0,Ht]):Bt&&qt?Ue.push([0,Ht],[Zt,0]):Bt?Ue.push([Zt,0]):qt&&Ue.push([0,Ht]),Ue.length){Ue.sort(function(er,Yn){return zf(gi([J,ct],er))-zf(gi([J,ct],Yn))});var nn=Ue[0];if(nn[0]&&Math.abs(J)>Ve)be=-nn[0],_e=ct*Math.abs(J+be)/Math.abs(J)-ct;else if(nn[1]&&Math.abs(ct)>Ve){var hn=ct;_e=-nn[1],be=J*Math.abs(ct+_e)/Math.abs(hn)-J}if(y&&It&&vt)if(Math.abs(be)>Ve&&Math.abs(be)<Math.abs(Zt)){var On=Math.abs(Zt)/Math.abs(be);be*=On,_e*=On}else if(Math.abs(_e)>Ve&&Math.abs(_e)<Math.abs(Ht)){var On=Math.abs(Ht)/Math.abs(_e);be*=On,_e*=On}else be=Qf(-Zt,be),_e=Qf(-Ht,_e)}}else be=J||vt?-Zt:0,_e=ct||It?-Ht:0;return[be,_e]}function iv(y,m,E,S,D,J){if(!pd(y,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var ct=zh(J.absolutePoses,[m,E]),vt=tc(ct),It=vt.left,Bt=vt.right,qt=vt.top,Zt=vt.bottom,Ht={horizontal:ct.map(function(ka){return ka[1]}),vertical:ct.map(function(ka){return ka[0]})},be=th(y.props.snapDirections),_e=Ep(be,{left:It,right:Bt,top:qt,bottom:Zt,center:(It+Bt)/2,middle:(qt+Zt)/2}),Ue=Yh(y,D,_e,Ht),nn=Ue.vertical,hn=Ue.horizontal,On=$d(y,ct,J),er=On.vertical,Yn=On.horizontal,Ir=nn.isSnap,Un=hn.isSnap,gr=nn.isBound||er.isBound,Br=hn.isBound||Yn.isBound,Tr=Qf(nn.offset,er.offset),sa=Qf(hn.offset,Yn.offset),Gr=Ov(S,[m,E],[gr,Br],[Ir,Un],[Tr,sa]),va=Gr[0],la=Gr[1];return[{isBound:gr,isSnap:Ir,offset:va},{isBound:Br,isSnap:Un,offset:la}]}function Yh(y,m,E,S){S===void 0&&(S=E);var D=md(Mc(y),S.vertical,S.horizontal),J=D.horizontal,ct=D.vertical,vt=m?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:Ld(y,E.vertical,E.horizontal),It=vt.horizontal,Bt=vt.vertical,qt=Mf(J[0],It),Zt=Mf(ct[0],Bt),Ht=Math.abs(qt),be=Math.abs(Zt);return{horizontal:{isBound:J[0].isBound,isSnap:It.isSnap,snapIndex:It.index,offset:qt,dist:Ht,bounds:J,snap:It},vertical:{isBound:ct[0].isBound,isSnap:Bt.isSnap,snapIndex:Bt.index,offset:Zt,dist:be,bounds:ct,snap:Bt}}}function ov(y,m,E,S,D){var J=md(m,E,S),ct=J.horizontal,vt=J.vertical,It=Zp(y,E,S,D),Bt=It.horizontal,qt=It.vertical,Zt=Mf(ct[0],Bt),Ht=Mf(vt[0],qt),be=Math.abs(Zt),_e=Math.abs(Ht);return{horizontal:{isBound:ct[0].isBound,isSnap:Bt.isSnap,snapIndex:Bt.index,offset:Zt,dist:be,bounds:ct,snap:Bt},vertical:{isBound:vt[0].isBound,isSnap:qt.isSnap,snapIndex:qt.index,offset:Ht,dist:_e,bounds:vt,snap:qt}}}function Nc(y,m,E,S){var D=X(y,m)/Math.PI*180,J=E.vertical,ct=J.isBound,vt=J.isSnap,It=J.dist,Bt=E.horizontal,qt=Bt.isBound,Zt=Bt.isSnap,Ht=Bt.dist,be=D%180,_e=be<3||be>177,Ue=be>87&&be<93;return Ht<It&&(ct||vt&&!Ue&&(!S||!_e))?"vertical":qt||Zt&&!_e&&(!S||!Ue)?"horizontal":""}function Ch(y,m,E,S,D,J){return E.map(function(ct){var vt=ct[0],It=ct[1],Bt=js(m,vt),qt=js(m,It),Zt=S?Fc(y,Bt,qt,D):Yh(y,D,{vertical:[qt[0]],horizontal:[qt[1]]}),Ht=Zt.horizontal,be=Ht.offset,_e=Ht.isBound,Ue=Ht.isSnap,nn=Zt.vertical,hn=nn.offset,On=nn.isBound,er=nn.isSnap,Yn=gi(It,vt);if(!hn&&!be)return{isBound:On||_e,isSnap:er||Ue,sign:Yn,offset:[0,0]};var Ir=Nc(Bt,qt,Zt,S);if(!Ir)return{sign:Yn,isBound:!1,isSnap:!1,offset:[0,0]};var Un=Ir==="vertical",gr=[0,0];return!S&&Math.abs(It[0])===1&&Math.abs(It[1])===1&&vt[0]!==It[0]&&vt[1]!==It[1]?gr=sc({datas:J,distX:-hn,distY:-be}):gr=Af(Bt,qt,-(Un?hn:be),Un,J).offset,gr=gr.map(function(Br,Tr){return Br*(Yn[Tr]?2/Yn[Tr]:0)}),{sign:Yn,isBound:Un?On:_e,isSnap:Un?er:Ue,offset:gr}})}function El(y,m){return y.isBound?y.offset:m.isSnap?m.offset:0}function Fc(y,m,E,S){var D=Jv(y,m,E),J=D.horizontal,ct=D.vertical,vt=S?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:xh(y,m,E),It=vt.horizontal,Bt=vt.vertical,qt=El(J,It),Zt=El(ct,Bt),Ht=Math.abs(qt),be=Math.abs(Zt);return{horizontal:{isBound:J.isBound,isSnap:It.isSnap,offset:qt,dist:Ht},vertical:{isBound:ct.isBound,isSnap:Bt.isSnap,offset:Zt,dist:be}}}function jd(y,m,E,S,D){var J=[-E[0],-E[1]],ct=y.state,vt=ct.width,It=ct.height,Bt=y.props.bounds,qt=Infinity,Zt=Infinity;if(Bt){var Ht=[[E[0],-E[1]],[-E[0],E[1]]],be=Bt.left,_e=be===void 0?-Infinity:be,Ue=Bt.top,nn=Ue===void 0?-Infinity:Ue,hn=Bt.right,On=hn===void 0?Infinity:hn,er=Bt.bottom,Yn=er===void 0?Infinity:er;Ht.forEach(function(Ir){var Un=Ir[0]!==J[0],gr=Ir[1]!==J[1],Br=js(m,Ir),Tr=X(S,Br)*360/Math.PI;if(gr){var sa=Br.slice();(Math.abs(Tr-360)<2||Math.abs(Tr-180)<2)&&(sa[1]=S[1]);var Gr=Af(S,sa,(S[1]<Br[1]?Yn:nn)-Br[1],!1,D),va=Gr.offset,la=va[1],ka=Gr.isOutside;isNaN(la)||(Zt=It+(ka?1:-1)*Math.abs(la))}if(Un){var sa=Br.slice();(Math.abs(Tr-90)<2||Math.abs(Tr-270)<2)&&(sa[0]=S[0]);var ri=Af(S,sa,(S[0]<Br[0]?On:_e)-Br[0],!0,D),Li=ri.offset[0],to=ri.isOutside;isNaN(Li)||(qt=vt+(to?1:-1)*Math.abs(Li))}})}return{maxWidth:qt,maxHeight:Zt}}function _p(y){var m=y.state,E=m.containerClientRect,S=m.hasFixed,D=E.overflow,J=E.scrollHeight,ct=E.scrollWidth,vt=E.clientHeight,It=E.clientWidth,Bt=E.clientLeft,qt=E.clientTop,Zt=y.props,Ht=Zt.snapGap,be=Ht===void 0?!0:Ht,_e=Zt.verticalGuidelines,Ue=Zt.horizontalGuidelines,nn=Zt.snapThreshold,hn=nn===void 0?5:nn,On=Zt.snapGridWidth,er=On===void 0?0:On,Yn=Zt.snapGridHeight,Ir=Yn===void 0?0:Yn,Un=Zt.maxSnapElementGuidelineDistance,gr=Un===void 0?Infinity:Un,Br=tc(uc(y.state)),Tr=Br.top,sa=Br.left,Gr=Br.bottom,va=Br.right,la={top:Tr,left:sa,bottom:Gr,right:va,center:(sa+va)/2,middle:(Tr+Gr)/2},ka=_h(y),ri=_r([],ka,!0);be&&ri.push.apply(ri,sv(y,la,hn)),ri.push.apply(ri,uv(er,Ir,D?ct:It,D?J:vt,Bt,qt));var Li=We({},m.snapOffset||{left:0,top:0,bottom:0,right:0});if(S){var to=E.left,fi=E.top;Li.left+=to,Li.top+=fi,Li.right+=to,Li.bottom+=fi}return ri.push.apply(ri,li(Ue||!1,_e||!1,D?ct:It,D?J:vt,Bt,qt,Li)),ri=ri.filter(function(Ii){var Ja=Ii.element,oo=Ii.elementRect,Po=Ii.type;if(!Ja||!oo)return!0;var Fo=oo.rect;return Ip(la,Fo,Po,gr)}),ri}function sv(y,m,E){var S=y.props,D=S.maxSnapElementGuidelineDistance,J=D===void 0?Infinity:D,ct=S.maxSnapElementGapDistance,vt=ct===void 0?Infinity:ct,It=y.state.elementRects,Bt=[];return[["vertical",af,qi],["horizontal",qi,af]].forEach(function(qt){var Zt=qt[0],Ht=qt[1],be=qt[2],_e=m[Ht.start],Ue=m[Ht.end],nn=m[Ht.center],hn=m[be.start],On=m[be.end];function er(Un){var gr=Un.rect;return gr[Ht.end]<_e+E?_e-gr[Ht.end]:Ue-E<gr[Ht.start]?gr[Ht.start]-Ue:-1}var Yn=It.filter(function(Un){var gr=Un.rect;return gr[be.start]>On||gr[be.end]<hn?!1:er(Un)>0}).sort(function(Un,gr){return er(Un)-er(gr)}),Ir=[];Yn.forEach(function(Un){Yn.forEach(function(gr){if(Un!==gr){var Br=Un.rect,Tr=gr.rect,sa=Br[be.start],Gr=Br[be.end],va=Tr[be.start],la=Tr[be.end];sa>la||va>Gr||Ir.push([Un,gr])}})}),Ir.forEach(function(Un){var gr=Un[0],Br=Un[1],Tr=gr.rect,sa=Br.rect,Gr=Tr[Ht.start],va=Tr[Ht.end],la=sa[Ht.start],ka=sa[Ht.end],ri=0,Li=0,to=!1,fi=!1,Ii=!1;if(va<=_e&&Ue<=la){if(fi=!0,ri=(la-va-(Ue-_e))/2,Li=va+ri+(Ue-_e)/2,Math.abs(Li-nn)>E)return}else if(va<la&&ka<_e+E){if(to=!0,ri=la-va,Li=ka+ri,Math.abs(Li-_e)>E)return}else if(va<la&&Ue-E<Gr){if(Ii=!0,ri=la-va,Li=Gr-ri,Math.abs(Li-Ue)>E)return}else return;!ri||!Ip(m,sa,Zt,J)||ri>vt||Bt.push({type:Zt,pos:Zt==="vertical"?[Li,0]:[0,Li],element:Br.element,size:0,className:Br.className,isStart:to,isCenter:fi,isEnd:Ii,gap:ri,hide:!0,gapRects:[gr,Br]})})}),Bt}function uv(y,m,E,S,D,J){D===void 0&&(D=0),J===void 0&&(J=0);var ct=[];if(m)for(var vt=0;vt<=S;vt+=m)ct.push({type:"horizontal",pos:[0,Xt(vt-J,.1)],size:E,hide:!0});if(y)for(var vt=0;vt<=E;vt+=y)ct.push({type:"vertical",pos:[Xt(vt-D,.1),0],size:S,hide:!0});return ct}function Ip(y,m,E,S){return E==="horizontal"?Math.abs(y.right-m.left)<=S||Math.abs(y.left-m.right)<=S||y.left<=m.right&&m.left<=y.right:E==="vertical"?Math.abs(y.bottom-m.top)<=S||Math.abs(y.top-m.bottom)<=S||y.top<=m.bottom&&m.top<=y.bottom:!0}function _h(y){var m=y.state,E=y.props.elementGuidelines,S=E===void 0?[]:E;if(!S.length)return m.elementRects=[],[];var D=(m.elementRects||[]).filter(function(Ht){return!Ht.refresh}),J=S.map(function(Ht){return fn(Ht)&&"element"in Ht?We(We({},Ht),{element:Kc(Ht.element,!0)}):{element:Kc(Ht,!0)}}).filter(function(Ht){return Ht.element}),ct=Cs(D.map(function(Ht){return Ht.element}),J.map(function(Ht){return Ht.element})),vt=ct.maintained,It=ct.added,Bt=[];vt.forEach(function(Ht){var be=Ht[0],_e=Ht[1];Bt[_e]=D[be]}),eg(y,It.map(function(Ht){return J[Ht]})).map(function(Ht,be){Bt[It[be]]=Ht}),m.elementRects=Bt;var qt=th(y.props.elementSnapDirections),Zt=[];return Bt.forEach(function(Ht){var be=Ht.element,_e=Ht.top,Ue=_e===void 0?qt.top:_e,nn=Ht.left,hn=nn===void 0?qt.left:nn,On=Ht.right,er=On===void 0?qt.right:On,Yn=Ht.bottom,Ir=Yn===void 0?qt.bottom:Yn,Un=Ht.center,gr=Un===void 0?qt.center:Un,Br=Ht.middle,Tr=Br===void 0?qt.middle:Br,sa=Ht.className,Gr=Ht.rect,va=Ep({top:Ue,right:er,left:hn,bottom:Ir,center:gr,middle:Tr},Gr),la=va.horizontal,ka=va.vertical,ri=Gr.top,Li=Gr.left,to=Gr.right-Li,fi=Gr.bottom-ri,Ii=[to,fi];ka.forEach(function(Ja){Zt.push({type:"vertical",element:be,pos:[Xt(Ja,.1),ri],size:fi,sizes:Ii,className:sa,elementRect:Ht})}),la.forEach(function(Ja){Zt.push({type:"horizontal",element:be,pos:[Li,Xt(Ja,.1)],size:to,sizes:Ii,className:sa,elementRect:Ht})})}),Zt}function of(y,m){return y?y.map(function(E){var S=fn(E)?E:{pos:E},D=S.pos;return Bn(D)?S:We(We({},S),{pos:Dn(D,m)})}):[]}function li(y,m,E,S,D,J,ct){D===void 0&&(D=0),J===void 0&&(J=0),ct===void 0&&(ct={left:0,top:0,right:0,bottom:0});var vt=[],It=ct.left,Bt=ct.top,qt=ct.bottom,Zt=ct.right,Ht=E+Zt-It,be=S+qt-Bt;return of(y,be).forEach(function(_e){vt.push({type:"horizontal",pos:[It,Xt(_e.pos-J+Bt,.1)],size:Ht,className:_e.className})}),of(m,Ht).forEach(function(_e){vt.push({type:"vertical",pos:[Xt(_e.pos-D+It,.1),Bt],size:be,className:_e.className})}),vt}function eg(y,m){if(!m.length)return[];var E=y.state,S=E.containerClientRect,D=E.rootMatrix,J=E.is3d,ct=E.offsetDelta,vt=J?4:3,It=Sg(D,S,vt),Bt=It[0],qt=It[1];return m.map(function(Zt){var Ht=Zt.element.getBoundingClientRect(),be=Ht.left-Bt-ct[0],_e=Ht.top-qt-ct[1],Ue=_e+Ht.height,nn=be+Ht.width,hn=Uh(D,[be,_e],vt),On=hn[0],er=hn[1],Yn=Uh(D,[nn,Ue],vt),Ir=Yn[0],Un=Yn[1];return We(We({},Zt),{rect:{left:On,right:Ir,top:er,bottom:Un,center:(On+Ir)/2,middle:(er+Un)/2}})})}function Tp(y){var m=y.state,E=m.container,S=y.props.snapContainer||E;if(m.snapContainer===S&&m.guidelines&&m.guidelines.length)return!1;var D=m.containerClientRect,J={left:0,top:0,bottom:0,right:0};if(E!==S){var ct=Kc(S,!0);if(ct){var vt=Zf(ct),It=If(m,[vt.left-D.left,vt.top-D.top]),Bt=If(m,[vt.right-D.right,vt.bottom-D.bottom]);J.left=Xt(It[0],1e-5),J.top=Xt(It[1],1e-5),J.right=Xt(Bt[0],1e-5),J.bottom=Xt(Bt[1],1e-5)}}return m.snapContainer=S,m.snapOffset=J,m.guidelines=_p(y),m.enableSnap=!0,!0}function lv(y,m,E,S,D,J){var ct=Pc(y,m,E,J?4:3),vt=js(ct,S);return zh(ct,gi(D,vt))}function Ap(y,m,E,S,D,J){var ct=J.fixedDirection,vt=Pd(E,ct,S),It=Eh(y,m,E,S),Bt=_r(_r([],Ch(y,m,vt,S,D,J),!0),zd(y,It,J),!0),qt=Hh(Bt,0),Zt=Hh(Bt,1);return{width:{isBound:qt.isBound,offset:qt.offset[0]},height:{isBound:Zt.isBound,offset:Zt.offset[1]}}}function yd(y,m,E,S,D,J,ct,vt,It){var Bt=js(m,ct),qt=Yh(y,vt,{vertical:[Bt[0]],horizontal:[Bt[1]]}),Zt=qt.horizontal.offset,Ht=qt.vertical.offset;if(Xt(Ht,zl)||Xt(Zt,zl)){var be=sc({datas:It,distX:-Ht,distY:-Zt}),_e=be[0],Ue=be[1],nn=Math.min(D||Infinity,E+ct[0]*_e),hn=Math.min(J||Infinity,S+ct[1]*Ue);return[nn-E,hn-S]}return[0,0]}function cv(y,m,E,S,D,J,ct,vt){for(var It=uc(y.state),Bt=y.props.keepRatio,qt=0,Zt=0,Ht=0;Ht<2;++Ht){var be=m(qt,Zt),_e=Ap(y,be,D,Bt,ct,vt),Ue=_e.width,nn=_e.height,hn=Ue.isBound,On=nn.isBound,er=Ue.offset,Yn=nn.offset;if(Ht===1&&(hn||(er=0),On||(Yn=0)),Ht===0&&ct&&!hn&&!On)return[0,0];if(Bt){var Ir=Math.abs(er)*(E?1/E:1),Un=Math.abs(Yn)*(S?1/S:1),gr=hn&&On?Ir<Un:On||!hn&&Ir<Un;gr?er=E*Yn/S:Yn=S*er/E}qt+=er,Zt+=Yn}if(D[0]&&D[1]){var Br=jd(y,It,D,J,vt),Tr=Br.maxWidth,sa=Br.maxHeight,Gr=yd(y,m(qt,Zt).map(function(ka){return ka.map(function(ri){return Xt(ri,zl)})}),E+qt,S+Zt,Tr,sa,D,ct,vt),er=Gr[0],Yn=Gr[1];qt+=er,Zt+=Yn}return[qt,Zt]}function nh(y,m,E){if(!pd(y,"rotatable"))return{isSnap:!1,rotation:E};var S=m.pos1,D=m.pos2,J=m.pos3,ct=m.pos4,vt=m.origin,It=E*Math.PI/180,Bt=[S,D,J,ct].map(function(be){return gi(be,vt)}),qt=Bt.map(function(be){return Su(be,It)}),Zt=_r(_r([],Jp(y,Bt,qt,vt,E),!0),Wd(y,Bt,qt,vt,E),!0);Zt.sort(function(be,_e){return Math.abs(be-E)-Math.abs(_e-E)});var Ht=Zt.length>0;return{isSnap:Ht,rotation:Ht?Zt[0]:E}}function Rv(y,m,E,S,D,J,ct){if(!pd(y,"resizable"))return[0,0];var vt=ct.fixedDirection,It=ct.nextAllMatrix,Bt=y.state,qt=Bt.allMatrix,Zt=Bt.is3d;return cv(y,function(Ht,be){return lv(It||qt,m+Ht,E+be,vt,D,Zt)},m,E,S,D,J,ct)}function Mp(y,m,E,S,D){if(!pd(y,"scalable"))return[0,0];var J=D.startOffsetWidth,ct=D.startOffsetHeight,vt=D.fixedPosition,It=D.fixedDirection,Bt=D.is3d,qt=cv(y,function(Zt,Ht){return lv(ae(D,bi(m,[Zt/J,Ht/ct])),J,ct,It,vt,Bt)},J,ct,E,vt,S,D);return[qt[0]/J,qt[1]/ct]}function Np(y,m){m.absolutePoses=uc(y.state)}function oe(y){var m=[];return y.forEach(function(E){E.guidelineInfos.forEach(function(S){var D=S.guideline;m.indexOf(D)>-1||m.push(D)})}),m}function vn(y,m,E,S,D,J){var ct=md(Mc(y,J),m,E),vt=ct.vertical,It=ct.horizontal;vt.forEach(function(Ht){Ht.isBound&&S.push({type:"bounds",pos:Ht.pos})}),It.forEach(function(Ht){Ht.isBound&&D.push({type:"bounds",pos:Ht.pos})});var Bt=$s(y),qt=Bt.vertical,Zt=Bt.horizontal;qt.forEach(function(Ht){Yr(S,function(be){var _e=be.type,Ue=be.pos;return _e==="bounds"&&Ue===Ht})>=0||S.push({type:"bounds",pos:Ht})}),Zt.forEach(function(Ht){Yr(D,function(be){var _e=be.type,Ue=be.pos;return _e==="bounds"&&Ue===Ht})>=0||D.push({type:"bounds",pos:Ht})})}var qn=xc("",["resizable","scalable"]),ia={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","snapDigit","snapThreshold","snapRenderThreshold","horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(y,m){var E=y.state,S=E.top,D=E.left,J=E.pos1,ct=E.pos2,vt=E.pos3,It=E.pos4,Bt=E.snapRenderInfo,qt=y.props.snapRenderThreshold,Zt=qt===void 0?1:qt;if(!Bt||!Bt.render||!pd(y,""))return[];E.guidelines=_p(y);var Ht=Math.min(J[0],ct[0],vt[0],It[0]),be=Math.min(J[1],ct[1],vt[1],It[1]),_e=Bt.externalPoses||[],Ue=uc(y.state),nn=[],hn=[],On=[],er=[],Yn=[],Ir=tc(Ue),Un=Ir.width,gr=Ir.height,Br=Ir.top,Tr=Ir.left,sa=Ir.bottom,Gr=Ir.right,va={left:Tr,right:Gr,top:Br,bottom:sa,center:(Tr+Gr)/2,middle:(Br+sa)/2},la=_e.length>0,ka=la?tc(_e):{};if(!Bt.request){if(Bt.direction&&Yn.push(eh(y,Ue,Bt.direction,Zt)),Bt.snap){var ri=tc(Ue);Bt.center&&(ri.middle=(ri.top+ri.bottom)/2,ri.center=(ri.left+ri.right)/2),Yn.push(kv(y,ri,Zt))}la&&(Bt.center&&(ka.middle=(ka.top+ka.bottom)/2,ka.center=(ka.left+ka.right)/2),Yn.push(kv(y,ka,Zt))),Yn.forEach(function(Ii){var Ja=Ii.vertical.posInfos,oo=Ii.horizontal.posInfos;nn.push.apply(nn,Ja.filter(function(Po){var Fo=Po.guidelineInfos;return Fo.some(function(_s){var Eo=_s.guideline;return!Eo.hide})}).map(function(Po){return{type:"snap",pos:Po.pos}})),hn.push.apply(hn,oo.filter(function(Po){var Fo=Po.guidelineInfos;return Fo.some(function(_s){var Eo=_s.guideline;return!Eo.hide})}).map(function(Po){return{type:"snap",pos:Po.pos}})),On.push.apply(On,oe(Ja)),er.push.apply(er,oe(oo))})}vn(y,[Tr,Gr],[Br,sa],nn,hn),la&&vn(y,[ka.left,ka.right],[ka.top,ka.bottom],nn,hn,Bt.externalBounds);var Li=_r(_r([],On,!0),er,!0),to=Li.filter(function(Ii){return Ii.element&&!Ii.gapRects}),fi=Li.filter(function(Ii){return Ii.gapRects}).sort(function(Ii,Ja){return Ii.gap-Ja.gap});return no(y,"onSnap",{guidelines:Li.filter(function(Ii){var Ja=Ii.element;return!Ja}),elements:to,gaps:fi},!0),_r(_r(_r(_r(_r(_r([],tg(y,to,[Ht,be],va,m),!0),Gl(y,fi,[Ht,be],va,m),!0),nv(y,"horizontal",er,[D,S],va,m),!0),nv(y,"vertical",On,[D,S],va,m),!0),ev(y,"horizontal",hn,Ht,S,Un,0,m),!0),ev(y,"vertical",nn,be,D,gr,1,m),!0)},dragStart:function(y,m){y.state.snapRenderInfo={request:m.isRequest,snap:!0,center:!0},Tp(y)},drag:function(y){var m=y.state;Tp(y)||(m.guidelines=_p(y)),m.snapRenderInfo&&(m.snapRenderInfo.render=!0)},pinchStart:function(y){this.unset(y)},dragEnd:function(y){this.unset(y)},dragControlCondition:function(y,m){if(qn(y,m)||Te(y,m))return!0;if(!m.isRequest&&m.inputEvent)return da(m.inputEvent.target,mo("snap-control"))},dragControlStart:function(y){y.state.snapRenderInfo=null,Tp(y)},dragControl:function(y){this.drag(y)},dragControlEnd:function(y){this.unset(y)},dragGroupStart:function(y,m){this.dragStart(y,m)},dragGroup:function(y){this.drag(y)},dragGroupEnd:function(y){this.unset(y)},dragGroupControlStart:function(y){y.state.snapRenderInfo=null,Tp(y)},dragGroupControl:function(y){this.drag(y)},dragGroupControlEnd:function(y){this.unset(y)},unset:function(y){var m=y.state;m.enableSnap=!1,m.guidelines=[],m.snapRenderInfo=null,m.elementRects=[]}};function Sa(y,m,E,S){var D=y.getState(),J=D.renderPoses,ct=D.rotation,vt=D.direction,It=mh(y.props,m).zoom,Bt=vt>0?1:-1,qt=ct/Math.PI*180,Zt={},Ht=y.renderState;Ht.renderDirectionMap||(Ht.renderDirectionMap={});var be=Ht.renderDirectionMap;return E.forEach(function(_e){var Ue=_e.dir;Zt[Ue]=!0}),E.map(function(_e){var Ue=_e.data,nn=_e.classNames,hn=_e.dir,On=dh[hn];if(!On||!Zt[hn])return null;be[hn]=!0;var er=(Xt(qt,15)+Bt*kd[hn]+720)%180,Yn={};return ua(Ue).forEach(function(Ir){Yn["data-".concat(Ir)]=Ue[Ir]}),S.createElement("div",We({className:mo.apply(void 0,_r(["control","direction",hn,m],nn,!1)),"data-rotation":er,"data-direction":hn},Yn,{key:"direction-".concat(hn),style:gh.apply(void 0,_r([ct,It],On.map(function(Ir){return J[Ir]}),!1))}))})}function Hr(y,m,E,S){var D=mh(y.props,E),J=D.renderDirections,ct=J===void 0?m:J,vt=D.displayAroundControls;if(!ct)return[];var It=ct===!0?ma:ct;return _r(_r([],vt?Vn(y,S,E,It):[],!0),Sa(y,E,It.map(function(Bt){return{data:{},classNames:[],dir:Bt}}),S),!0)}function ea(y,m,E,S,D,J){for(var ct=[],vt=6;vt<arguments.length;vt++)ct[vt-6]=arguments[vt];var It=X(E,S),Bt=m?Xt(It/Math.PI*180,15)%180:-1;return y.createElement("div",{key:"line-".concat(J),className:mo.apply(void 0,_r(["line","direction",m?"edge":"",m],ct,!1)),"data-rotation":Bt,"data-line-key":J,"data-direction":m,style:Fh(E,S,D,It)})}function Ha(y,m,E,S,D){var J=E===!0?qa:E;return J.map(function(ct,vt){var It=dh[ct],Bt=It[0],qt=It[1];if(qt!=null)return ea(y,ct,S[Bt],S[qt],D,"".concat(m,"Edge").concat(vt),m)}).filter(Boolean)}function Wa(y){return function(m,E){var S=mh(m.props,y).edge;return S&&(S===!0||S.length)?_r(_r([],Ha(E,y,S,m.getState().renderPoses,m.props.zoom),!0),Qa(m,y,E),!0):Ga(m,y,E)}}function Ga(y,m,E){return Hr(y,ma,m,E)}function Qa(y,m,E){return Hr(y,["nw","ne","sw","se"],m,E)}function Vn(y,m,E,S){var D=y.renderState;D.renderDirectionMap||(D.renderDirectionMap={});var J=y.getState(),ct=J.renderPoses,vt=J.rotation,It=J.direction,Bt=D.renderDirectionMap,qt=y.props.zoom,Zt=It>0?1:-1,Ht=vt/Math.PI*180;return(S||ua(Bt)).map(function(be){var _e=dh[be];if(!_e)return null;var Ue=(Xt(Ht,15)+Zt*kd[be]+720)%180,nn=["around-control"];return E&&nn.push("direction",E),m.createElement("div",{className:mo.apply(void 0,nn),"data-rotation":Ue,"data-direction":be,key:"direction-around-".concat(be),style:gh.apply(void 0,_r([vt,qt],_e.map(function(hn){return ct[hn]}),!1))})})}var M={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(y,m){var E=y.props,S=E.throttleDragRotate,D=E.zoom,J=y.getState(),ct=J.dragInfo,vt=J.beforeOrigin;if(!S||!ct)return[];var It=ct.dist;if(!It[0]&&!It[1])return[];var Bt=zf(It),qt=X(It,[0,0]);return[m.createElement("div",{className:mo("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(Bt,"px"),transform:"translate(".concat(vt[0],"px, ").concat(vt[1],"px) rotate(").concat(qt,"rad) scaleY(").concat(D,")")}})]},dragStart:function(y,m){var E=m.datas,S=m.parentEvent,D=m.parentGesto,J=y.state,ct=J.gestos,vt=J.style;if(ct.draggable)return!1;ct.draggable=D||y.targetGesto,E.datas={},E.left=parseFloat(vt.left||"")||0,E.top=parseFloat(vt.top||"")||0,E.bottom=parseFloat(vt.bottom||"")||0,E.right=parseFloat(vt.right||"")||0,E.startValue=[0,0],jf(y,m),qe(m,"translate"),Np(y,E),E.prevDist=[0,0],E.prevBeforeDist=[0,0],E.isDrag=!1,E.deltaOffset=[0,0];var It=ps(y,m,We({set:function(qt){E.startValue=qt}},xe(m))),Bt=S||no(y,"onDragStart",It);return Bt!==!1?(E.isDrag=!0,y.state.dragInfo={startRect:y.getRect(),dist:[0,0]}):(ct.draggable=null,E.isPinch=!1),E.isDrag?It:!1},drag:function(y,m){if(!!m){ph(m,"translate");var E=m.datas,S=m.parentEvent,D=m.parentFlag,J=m.isPinch,ct=m.isRequest,vt=m.deltaOffset,It=m.distX,Bt=m.distY,qt=E.isDrag,Zt=E.prevDist,Ht=E.prevBeforeDist,be=E.startValue;if(!!qt){vt&&(It+=vt[0],Bt+=vt[1]);var _e=y.props,Ue=_e.parentMoveable,nn=S?0:_e.throttleDrag||0,hn=S?0:_e.throttleDragRotate||0,On=0,er=!1,Yn=!1,Ir=!1,Un=!1;if(!S&&hn>0&&(It||Bt)){var gr=_e.startDragRotate||0,Br=Xt(gr+X([0,0],[It,Bt])*180/Math.PI,hn)-gr,Tr=Bt*Math.abs(Math.cos((Br-90)/180*Math.PI)),sa=It*Math.abs(Math.cos(Br/180*Math.PI)),Gr=zf([sa,Tr]);On=Br*Math.PI/180,It=Gr*Math.cos(On),Bt=Gr*Math.sin(On)}if(!J&&!S&&!D){var va=iv(y,It,Bt,hn,ct||vt,E),la=va[0],ka=va[1];er=la.isSnap,Yn=la.isBound,Ir=ka.isSnap,Un=ka.isBound;var ri=la.offset,Li=ka.offset;It+=ri,Bt+=Li}var to=bi(Ph({datas:E,distX:It,distY:Bt}),be),fi=bi(Lh({datas:E,distX:It,distY:Bt}),be);ne(fi,wl),ne(to,wl),hn||(!er&&!Yn&&(fi[0]=Xt(fi[0],nn),to[0]=Xt(to[0],nn)),!Ir&&!Un&&(fi[1]=Xt(fi[1],nn),to[1]=Xt(to[1],nn)));var Ii=gi(to,be),Ja=gi(fi,be),oo=gi(Ja,Zt),Po=gi(Ii,Ht);E.prevDist=Ja,E.prevBeforeDist=Ii,E.passDelta=oo,E.passDist=Ja;var Fo=E.left+Ii[0],_s=E.top+Ii[1],Eo=E.right-Ii[0],Co=E.bottom-Ii[1],ws=Ri(E,"translate(".concat(fi[0],"px, ").concat(fi[1],"px)"),"translate(".concat(Ja[0],"px, ").concat(Ja[1],"px)"));if(Er(m,ws),y.state.dragInfo.dist=S?[0,0]:Ja,!(!S&&!Ue&&oo.every(function(hu){return!hu})&&Po.some(function(hu){return!hu}))){var rs=y.state,$u=rs.width,Bo=rs.height,ts=ps(y,m,We({transform:ws,dist:Ja,delta:oo,translate:fi,beforeDist:Ii,beforeDelta:Po,beforeTranslate:to,left:Fo,top:_s,right:Eo,bottom:Co,width:$u,height:Bo,isPinch:J},Al({transform:ws},m)));return!S&&no(y,"onDrag",ts),ts}}}},dragAfter:function(y,m){var E=m.datas,S=E.deltaOffset;return S[0]||S[1]?(E.deltaOffset=[0,0],this.drag(y,We(We({},m),{deltaOffset:S}))):!1},dragEnd:function(y,m){var E=m.parentEvent,S=m.datas;if(y.state.dragInfo=null,!!S.isDrag){S.isDrag=!1;var D=ec(y,m,{});return!E&&no(y,"onDragEnd",D),D}},dragGroupStart:function(y,m){var E=m.datas,S=m.clientX,D=m.clientY,J=this.dragStart(y,m);if(!J)return!1;var ct=Mv(y,this,"dragStart",[S||0,D||0],m,!1,"draggable"),vt=We(We({},J),{targets:y.props.targets,events:ct}),It=no(y,"onDragGroupStart",vt);return E.isDrag=It!==!1,E.isDrag?J:!1},dragGroup:function(y,m){var E=m.datas;if(!!E.isDrag){var S=this.drag(y,m),D=m.datas.passDelta,J=Mv(y,this,"drag",D,m,!1,"draggable");if(!!S){var ct=We({targets:y.props.targets,events:J},S);return no(y,"onDragGroup",ct),ct}}},dragGroupEnd:function(y,m){var E=m.isDrag,S=m.datas;if(!!S.isDrag){this.dragEnd(y,m);var D=Mv(y,this,"dragEnd",[0,0],m,!1,"draggable");return no(y,"onDragGroupEnd",ec(y,m,{targets:y.props.targets,events:D})),E}},request:function(y){var m={},E=y.getRect(),S=0,D=0;return{isControl:!1,requestStart:function(){return{datas:m}},request:function(J){return"x"in J?S=J.x-E.left:"deltaX"in J&&(S+=J.deltaX),"y"in J?D=J.y-E.top:"deltaY"in J&&(D+=J.deltaY),{datas:m,distX:S,distY:D}},requestEnd:function(){return{datas:m,isDrag:!0}}}},unset:function(y){y.state.gestos.draggable=null,y.state.dragInfo=null}},q=xc("resizable"),dt={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:Wa("resizable"),dragControlCondition:q,viewClassName:Rd("resizable"),dragControlStart:function(y,m){var E,S=m.inputEvent,D=m.isPinch,J=m.isGroup,ct=m.parentDirection,vt=m.parentGesto,It=m.datas,Bt=m.parentFixedDirection,qt=m.parentEvent,Zt=Dd(ct,D,S,It),Ht=y.state,be=Ht.target,_e=Ht.width,Ue=Ht.height,nn=Ht.gestos;if(!Zt||!be||nn.resizable)return!1;nn.resizable=vt||y.controlGesto,!D&&jf(y,m),It.datas={},It.direction=Zt,It.startOffsetWidth=_e,It.startOffsetHeight=Ue,It.prevWidth=0,It.prevHeight=0,It.minSize=[0,0],It.startWidth=Ht.inlineCSSWidth||Ht.cssWidth,It.startHeight=Ht.inlineCSSHeight||Ht.cssHeight,It.maxSize=[Infinity,Infinity],J||(It.minSize=[Ht.minOffsetWidth,Ht.minOffsetHeight],It.maxSize=[Ht.maxOffsetWidth,Ht.maxOffsetHeight]);var hn=y.props.transformOrigin||"% %";It.transformOrigin=hn&&Xn(hn)?hn.split(" "):hn,It.startOffsetMatrix=Ht.offsetMatrix,It.startTransformOrigin=Ht.transformOrigin,It.isWidth=(E=m==null?void 0:m.parentIsWidth)!==null&&E!==void 0?E:!Zt[0]&&!Zt[1]||Zt[0]||!Zt[1];function On(Tr){It.ratio=Tr&&isFinite(Tr)?Tr:0}It.startPositions=uc(y.state);function er(Tr){It.fixedDirection=Tr,It.fixedPosition=js(It.startPositions,Tr)}function Yn(Tr){var sa=y.state,Gr=sa.width,va=sa.height;It.fixedPosition=Tr,It.fixedDirection=us(Tr,Gr,va)}function Ir(Tr){It.minSize=[Dn("".concat(Tr[0]),0)||0,Dn("".concat(Tr[1]),0)||0]}function Un(Tr){var sa=[Tr[0]||Infinity,Tr[1]||Infinity];(!Bn(sa[0])||isFinite(sa[0]))&&(sa[0]=Dn("".concat(sa[0]),0)||Infinity),(!Bn(sa[1])||isFinite(sa[1]))&&(sa[1]=Dn("".concat(sa[1]),0)||Infinity),It.maxSize=sa}On(_e/Ue),er(Bt||[-Zt[0],-Zt[1]]),It.setFixedDirection=er,It.setFixedPosition=Yn,It.setMin=Ir,It.setMax=Un;var gr=ps(y,m,{direction:Zt,startRatio:It.ratio,set:function(Tr){var sa=Tr[0],Gr=Tr[1];It.startWidth=sa,It.startHeight=Gr},setMin:Ir,setMax:Un,setRatio:On,setFixedDirection:er,setFixedPosition:Yn,setOrigin:function(Tr){It.transformOrigin=Tr},dragStart:M.dragStart(y,new Rf().dragStart([0,0],m))}),Br=qt||no(y,"onResizeStart",gr);return It.startFixedDirection=It.fixedDirection,It.startFixedPosition=It.fixedPosition,Br!==!1&&(It.isResize=!0,y.state.snapRenderInfo={request:m.isRequest,direction:Zt}),It.isResize?gr:!1},dragControl:function(y,m){var E,S=m.datas,D=m.parentFlag,J=m.isPinch,ct=m.parentKeepRatio,vt=m.dragClient,It=m.parentDist,Bt=m.isRequest,qt=m.isGroup,Zt=m.parentEvent,Ht=m.resolveMatrix,be=S.isResize,_e=S.transformOrigin,Ue=S.startWidth,nn=S.startHeight,hn=S.prevWidth,On=S.prevHeight,er=S.minSize,Yn=S.maxSize,Ir=S.ratio,Un=S.startOffsetWidth,gr=S.startOffsetHeight,Br=S.isWidth;if(!be)return;if(Ht){var Tr=y.state.is3d,sa=S.startOffsetMatrix,Gr=S.startTransformOrigin,va=Tr?4:3,la=ji(oa(m)),ka=Math.sqrt(la.length);va!==ka&&(la=es(la,ka,va));var ri=Pl(sa,la,Gr,va),Li=Pc(ri,Un,gr,va);S.startPositions=Li,S.nextTargetMatrix=la,S.nextAllMatrix=ri}var to=mh(y.props,"resizable"),fi=to.resizeFormat,Ii=to.throttleResize,Ja=Ii===void 0?D?0:1:Ii,oo=to.parentMoveable,Po=to.keepRatioFinally,Fo=S.direction,_s=Fo,Eo=0,Co=0;!Fo[0]&&!Fo[1]&&(_s=[1,1]);var ws=Ir&&(ct!=null?ct:to.keepRatio)||!1;function rs(){var qc=S.fixedDirection,Bc=bp(_s,ws,S,m);Eo=Bc.distWidth,Co=Bc.distHeight;var kp=_s[0]-qc[0]||ws?Math.max(Un+Eo,wl):Un,qh=_s[1]-qc[1]||ws?Math.max(gr+Co,wl):gr;return ws&&Un&&gr&&(Br?qh=kp/Ir:kp=qh*Ir),[kp,qh]}var $u=rs(),Bo=$u[0],ts=$u[1];Zt||(S.setFixedDirection(S.fixedDirection),no(y,"onBeforeResize",ps(y,m,{startFixedDirection:S.startFixedDirection,startFixedPosition:S.startFixedPosition,setFixedDirection:function(qc){var Bc;return S.setFixedDirection(qc),Bc=rs(),Bo=Bc[0],ts=Bc[1],[Bo,ts]},setFixedPosition:function(qc){var Bc;return S.setFixedPosition(qc),Bc=rs(),Bo=Bc[0],ts=Bc[1],[Bo,ts]},boundingWidth:Bo,boundingHeight:ts,setSize:function(qc){Bo=qc[0],ts=qc[1]}},!0)));var hu=vt;vt||(!D&&J?hu=Si(y,[0,0]):hu=S.fixedPosition);var eu=[0,0];J||(eu=Rv(y,Bo,ts,Fo,hu,Bt,S)),It&&(!It[0]&&(eu[0]=0),!It[1]&&(eu[1]=0));function Nl(){var qc;fi&&(qc=fi([Bo,ts]),Bo=qc[0],ts=qc[1]),Bo=Xt(Bo,Ja),ts=Xt(ts,Ja)}if(ws){_s[0]&&_s[1]&&eu[0]&&eu[1]&&(Math.abs(eu[0])>Math.abs(eu[1])?eu[1]=0:eu[0]=0);var Gu=!eu[0]&&!eu[1];Gu&&Nl(),_s[0]&&!_s[1]||eu[0]&&!eu[1]||Gu&&Br?(Bo+=eu[0],ts=Bo/Ir):(!_s[0]&&_s[1]||!eu[0]&&eu[1]||Gu&&!Br)&&(ts+=eu[1],Bo=ts*Ir)}else Bo+=eu[0],ts+=eu[1],Bo=Math.max(0,Bo),ts=Math.max(0,ts);E=Ot([Bo,ts],er,Yn,ws?Ir:!1),Bo=E[0],ts=E[1],Nl(),ws&&(qt||Po)&&(Br?ts=Bo/Ir:Bo=ts*Ir),Eo=Bo-Un,Co=ts-gr;var nu=[Eo-hn,Co-On];S.prevWidth=Eo,S.prevHeight=Co;var kl=$o(y,Bo,ts,hu,_e,S);if(!(!oo&&nu.every(function(qc){return!qc})&&kl.every(function(qc){return!qc}))){var cu=M.drag(y,df(m,y.state,kl,!!J,!1,"draggable")),Hs=cu.transform,Ru=Ue+Eo,ih=nn+Co,Zh=ps(y,m,We({width:Ru,height:ih,offsetWidth:Math.round(Bo),offsetHeight:Math.round(ts),startRatio:Ir,boundingWidth:Bo,boundingHeight:ts,direction:Fo,dist:[Eo,Co],delta:nu,isPinch:!!J,drag:cu},qv({style:{width:"".concat(Ru,"px"),height:"".concat(ih,"px")},transform:Hs},cu,m)));return!Zt&&no(y,"onResize",Zh),Zh}},dragControlAfter:function(y,m){var E=m.datas,S=E.isResize,D=E.startOffsetWidth,J=E.startOffsetHeight,ct=E.prevWidth,vt=E.prevHeight;if(!(!S||y.props.checkResizableError===!1)){var It=y.state,Bt=It.width,qt=It.height,Zt=Bt-(D+ct),Ht=qt-(J+vt),be=Math.abs(Zt)>3,_e=Math.abs(Ht)>3;if(be&&(E.startWidth+=Zt,E.startOffsetWidth+=Zt,E.prevWidth+=Zt),_e&&(E.startHeight+=Ht,E.startOffsetHeight+=Ht,E.prevHeight+=Ht),be||_e)return this.dragControl(y,m)}},dragControlEnd:function(y,m){var E=m.datas,S=m.parentEvent;if(!!E.isResize){E.isResize=!1;var D=ec(y,m,{});return!S&&no(y,"onResizeEnd",D),D}},dragGroupControlCondition:q,dragGroupControlStart:function(y,m){var E=m.datas,S=this.dragControlStart(y,We(We({},m),{isGroup:!0}));if(!S)return!1;var D=wc(y,"resizable",m),J=E.startOffsetWidth,ct=E.startOffsetHeight;function vt(){var be=E.minSize;D.forEach(function(_e){var Ue=_e.datas,nn=Ue.minSize,hn=Ue.startOffsetWidth,On=Ue.startOffsetHeight,er=J*(hn?nn[0]/hn:0),Yn=ct*(On?nn[1]/On:0);be[0]=Math.max(be[0],er),be[1]=Math.max(be[1],Yn)})}function It(){var be=E.maxSize;D.forEach(function(_e){var Ue=_e.datas,nn=Ue.maxSize,hn=Ue.startOffsetWidth,On=Ue.startOffsetHeight,er=J*(hn?nn[0]/hn:0),Yn=ct*(On?nn[1]/On:0);be[0]=Math.min(be[0],er),be[1]=Math.min(be[1],Yn)})}var Bt=$f(y,this,"dragControlStart",m,function(be,_e){return jh(y,be,E,_e)});vt(),It();var qt=function(be){S.setFixedDirection(be),Bt.forEach(function(_e,Ue){_e.setFixedDirection(be),jh(y,_e.moveable,E,D[Ue])})};E.setFixedDirection=qt;var Zt=We(We({},S),{targets:y.props.targets,events:Bt.map(function(be){return We(We({},be),{setMin:function(_e){be.setMin(_e),vt()},setMax:function(_e){be.setMax(_e),It()}})}),setFixedDirection:qt,setMin:function(be){S.setMin(be),vt()},setMax:function(be){S.setMax(be),It()}}),Ht=no(y,"onResizeGroupStart",Zt);return E.isResize=Ht!==!1,E.isResize?S:!1},dragGroupControl:function(y,m){var E=m.datas;if(!!E.isResize){var S=mh(y.props,"resizable");ir(y,"onBeforeResize",function(be){no(y,"onBeforeResizeGroup",ps(y,m,We(We({},be),{targets:S.targets}),!0))});var D=this.dragControl(y,We(We({},m),{isGroup:!0}));if(!!D){var J=D.boundingWidth,ct=D.boundingHeight,vt=D.dist,It=S.keepRatio,Bt=[J/(J-vt[0]),ct/(ct-vt[1])],qt=E.fixedPosition,Zt=$f(y,this,"dragControl",m,function(be,_e){var Ue=To(Zo(y.rotation/180*Math.PI,3),[_e.datas.originalX*Bt[0],_e.datas.originalY*Bt[1],1],3),nn=Ue[0],hn=Ue[1];return We(We({},_e),{parentDist:null,parentScale:Bt,dragClient:bi(qt,[nn,hn]),parentKeepRatio:It})}),Ht=We({targets:S.targets,events:Zt},D);return no(y,"onResizeGroup",Ht),Ht}}},dragGroupControlEnd:function(y,m){var E=m.isDrag,S=m.datas;if(!!S.isResize){this.dragControlEnd(y,m);var D=$f(y,this,"dragControlEnd",m),J=ec(y,m,{targets:y.props.targets,events:D});return no(y,"onResizeGroupEnd",J),E}},request:function(y){var m={},E=0,S=0,D=y.getRect();return{isControl:!0,requestStart:function(J){var ct;return{datas:m,parentDirection:J.direction||[1,1],parentIsWidth:(ct=J==null?void 0:J.horizontal)!==null&&ct!==void 0?ct:!0}},request:function(J){return"offsetWidth"in J?E=J.offsetWidth-D.offsetWidth:"deltaWidth"in J&&(E+=J.deltaWidth),"offsetHeight"in J?S=J.offsetHeight-D.offsetHeight:"deltaHeight"in J&&(S+=J.deltaHeight),{datas:m,parentDist:[E,S],parentKeepRatio:J.keepRatio}},requestEnd:function(){return{datas:m,isDrag:!0}}}},unset:function(y){y.state.gestos.resizable=null}};function _t(y,m,E,S,D){var J=y.props.groupable,ct=y.state,vt=ct.is3d?4:3,It=m.origin,Bt=ol(y.state.rootMatrix,gi([It[0],It[1]],J?[0,0]:[ct.left,ct.top]),vt),qt=bi([D.left,D.top],Bt);m.startAbsoluteOrigin=qt,m.prevDeg=X(qt,[E,S])/Math.PI*180,m.defaultDeg=m.prevDeg,m.prevSnapDeg=0,m.loop=0,m.startDist=Vt(qt,[E,S])}function Pt(y,m,E){var S=E.defaultDeg,D=E.prevDeg,J=D%360,ct=Math.floor(D/360);J<0&&(J+=360),J>y&&J>270&&y<90?++ct:J<y&&J<90&&y>270&&--ct;var vt=m*(ct*360+y-S);return E.prevDeg=S+vt,vt}function jt(y,m,E,S){return Pt(X(S.startAbsoluteOrigin,[y,m])/Math.PI*180,E,S)}function ie(y,m,E,S,D,J){var ct=y.props.throttleRotate,vt=ct===void 0?0:ct,It=E.prevSnapDeg,Bt=0,qt=!1;if(J){var Zt=nh(y,m,S);qt=Zt.isSnap,Bt=D+Zt.rotation}qt||(Bt=Xt(D+S,vt));var Ht=Bt-D;return E.prevSnapDeg=Ht,[Ht-It,Ht,Bt]}function he(y,m,E){var S=m[0],D=m[1],J=m[2],ct=m[3];if(y==="none")return[];if(Rt(y))return y.map(function(Ue){return he(Ue,[S,D,J,ct],E)[0]});var vt=(y||"top").split("-"),It=vt[0],Bt=vt[1],qt=[S,D];It==="left"?qt=[J,S]:It==="right"?qt=[D,ct]:It==="bottom"&&(qt=[ct,J]);var Zt=[(qt[0][0]+qt[1][0])/2,(qt[0][1]+qt[1][1])/2],Ht=gp(qt,E);if(Bt){var be=Bt==="top"||Bt==="left",_e=It==="bottom"||It==="left";Zt=qt[be&&!_e||!be&&_e?0:1]}return[[Zt,Ht]]}function Te(y,m){if(m.isRequest)return m.requestAble==="rotatable";var E=m.inputEvent.target;if(da(E,mo("rotation-control"))||y.props.rotateAroundControls&&da(E,mo("around-control"))||da(E,mo("control"))&&da(E,mo("rotatable")))return!0;var S=y.props.rotationTarget;return S?_f(S,!0).some(function(D){return D?E===D||E.contains(D):!1}):!1}var Ke=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,gn={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[Ke],viewClassName:function(y){return y.isDragging("rotatable")?mo("view-rotation-dragging"):""},render:function(y,m){var E=mh(y.props,"rotatable"),S=E.rotatable,D=E.rotationPosition,J=E.zoom,ct=E.renderDirections,vt=E.rotateAroundControls,It=E.resolveAblesWithRotatable,Bt=y.getState(),qt=Bt.renderPoses,Zt=Bt.direction;if(!S)return null;var Ht=he(D,qt,Zt),be=[];if(Ht.forEach(function(hn,On){var er=hn[0],Yn=hn[1];be.push(m.createElement("div",{key:"rotation".concat(On),className:mo("rotation"),style:{transform:"translate(-50%) translate(".concat(er[0],"px, ").concat(er[1],"px) rotate(").concat(Yn,"rad)")}},m.createElement("div",{className:mo("line rotation-line"),style:{transform:"scaleX(".concat(J,")")}}),m.createElement("div",{className:mo("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(J,")")}})))}),ct){var _e=ua(It||{}),Ue={};_e.forEach(function(hn){It[hn].forEach(function(On){Ue[On]=hn})});var nn=[];Rt(ct)&&(nn=ct.map(function(hn){var On=Ue[hn];return{data:On?{resolve:On}:{},classNames:On?["move"]:[],dir:hn}})),be.push.apply(be,Sa(y,"rotatable",nn,m))}return vt&&be.push.apply(be,Vn(y,m)),be},dragControlCondition:Te,dragControlStart:function(y,m){var E,S,D=m.datas,J=m.clientX,ct=m.clientY,vt=m.parentRotate,It=m.parentFlag,Bt=m.isPinch,qt=m.isRequest,Zt=y.state,Ht=Zt.target,be=Zt.left,_e=Zt.top,Ue=Zt.direction,nn=Zt.beforeDirection,hn=Zt.targetTransform,On=Zt.moveableClientRect,er=Zt.offsetMatrix,Yn=Zt.targetMatrix,Ir=Zt.allMatrix,Un=Zt.width,gr=Zt.height;if(!qt&&!Ht)return!1;var Br=y.getRect();D.rect=Br,D.transform=hn,D.left=be,D.top=_e;var Tr=function(Eo){var Co=y.state,ws=Co.allMatrix,rs=Co.is3d,$u=Co.width,Bo=Co.height,ts=us(Eo,$u,Bo);D.fixedDirection=ts,D.fixedPosition=ol(ws,Eo,rs?4:3),oo&&oo.setFixedPosition(Eo)},sa=function(Eo){D.fixedDirection=Eo,D.fixedPosition=Vo(y,Eo),oo&&oo.setFixedDirection(Eo)},Gr=J,va=ct;if(qt||Bt||It){var la=vt||0;D.beforeInfo={origin:Br.beforeOrigin,prevDeg:la,defaultDeg:la,prevSnapDeg:0,startDist:0},D.afterInfo=We(We({},D.beforeInfo),{origin:Br.origin}),D.absoluteInfo=We(We({},D.beforeInfo),{origin:Br.origin,startValue:la})}else{var ka=(S=m.inputEvent)===null||S===void 0?void 0:S.target;if(ka){var ri=ka.getAttribute("data-direction")||"",Li=Vp[ri];if(Li){D.isControl=!0,D.isAroundControl=da(ka,mo("around-control")),D.controlDirection=Li;var to=ka.getAttribute("data-resolve");to&&(D.resolveAble=to);var fi=Av(Zt.rootMatrix,Zt.renderPoses,On);E=js(fi,Li),Gr=E[0],va=E[1]}}D.beforeInfo={origin:Br.beforeOrigin},D.afterInfo={origin:Br.origin},D.absoluteInfo={origin:Br.origin,startValue:Br.rotation};var Ii=Tr;Tr=function(Eo){var Co=Zt.is3d?4:3,ws=bi(Ki(Yn,Co),Eo),rs=ws[0],$u=ws[1],Bo=To(er,vo([rs,$u],Co)),ts=To(Ir,vo([Eo[0],Eo[1]],Co));Ii(Eo);var hu=Zt.posDelta;D.beforeInfo.origin=gi(Bo,hu),D.afterInfo.origin=gi(ts,hu),D.absoluteInfo.origin=gi(ts,hu),_t(y,D.beforeInfo,Gr,va,On),_t(y,D.afterInfo,Gr,va,On),_t(y,D.absoluteInfo,Gr,va,On)},sa=function(Eo){var Co=js([[0,0],[Un,0],[0,gr],[Un,gr]],Eo);Tr(Co)}}D.startClientX=Gr,D.startClientY=va,D.direction=Ue,D.beforeDirection=nn,D.startValue=0,D.datas={},qe(m,"rotate");var Ja=!1,oo=!1;if(D.isControl&&D.resolveAble){var Po=D.resolveAble;Po==="resizable"&&(oo=dt.dragControlStart(y,We(We({},new Rf("resizable").dragStart([0,0],m)),{parentPosition:D.controlPosition,parentFixedPosition:D.fixedPosition})))}oo||(Ja=M.dragStart(y,new Rf().dragStart([0,0],m))),Tr(Zt.transformOrigin);var Fo=ps(y,m,We(We({set:function(Eo){D.startValue=Eo*Math.PI/180},setFixedDirection:sa,setFixedPosition:Tr},xe(m)),{dragStart:Ja,resizeStart:oo})),_s=no(y,"onRotateStart",Fo);return D.isRotate=_s!==!1,Zt.snapRenderInfo={request:m.isRequest},D.isRotate?Fo:!1},dragControl:function(y,m){var E,S,D,J=m.datas,ct=m.clientDistX,vt=m.clientDistY,It=m.parentRotate,Bt=m.parentFlag,qt=m.isPinch,Zt=m.groupDelta,Ht=m.resolveMatrix,be=J.beforeDirection,_e=J.beforeInfo,Ue=J.afterInfo,nn=J.absoluteInfo,hn=J.isRotate,On=J.startValue,er=J.rect,Yn=J.startClientX,Ir=J.startClientY;if(!!hn){ph(m,"rotate");var Un=pf(m),gr=be*Un,Br=y.props.parentMoveable,Tr=0,sa,Gr,va=0,la,ka,ri=0,Li,to,fi=180/Math.PI*On,Ii=nn.startValue,Ja=!1,oo=Yn+ct,Po=Ir+vt;if(!Bt&&"parentDist"in m){var Fo=m.parentDist;sa=Fo,la=Fo,Li=Fo}else qt||Bt?(sa=Pt(It,be,_e),la=Pt(It,gr,Ue),Li=Pt(It,gr,nn)):(sa=jt(oo,Po,be,_e),la=jt(oo,Po,gr,Ue),Li=jt(oo,Po,gr,nn),Ja=!0);if(Gr=fi+sa,ka=fi+la,to=Ii+Li,no(y,"onBeforeRotate",ps(y,m,{beforeRotation:Gr,rotation:ka,absoluteRotation:to,setRotation:function(eu){la=eu-fi,sa=la,Li=la}},!0)),E=ie(y,er,_e,sa,fi,Ja),Tr=E[0],sa=E[1],Gr=E[2],S=ie(y,er,Ue,la,fi,Ja),va=S[0],la=S[1],ka=S[2],D=ie(y,er,nn,Li,Ii,Ja),ri=D[0],Li=D[1],to=D[2],!(!ri&&!va&&!Tr&&!Br&&!Ht)){var _s=Ri(J,"rotate(".concat(ka,"deg)"),"rotate(".concat(la,"deg)"));Ht&&(J.fixedPosition=Ui(y,J.targetAllTransform,[0,0],J));var Eo=uo(y,la,J),Co=gi(bi(Zt||[0,0],Eo),J.prevInverseDist||[0,0]);J.prevInverseDist=Eo,J.requestValue=null;var ws=wi(y,_s,Co,qt,m),rs=ws,$u=Vt([oo,Po],nn.startAbsoluteOrigin)-nn.startDist,Bo=void 0;if(J.resolveAble==="resizable"){var ts=dt.dragControl(y,We(We({},df(m,y.state,[m.deltaX,m.deltaY],!!qt,!1,"resizable")),{resolveMatrix:!0,parentDistance:$u}));ts&&(Bo=ts,rs=qv(rs,ts,m))}var hu=ps(y,m,We(We({delta:va,dist:la,rotate:ka,rotation:ka,beforeDist:sa,beforeDelta:Tr,beforeRotate:Gr,beforeRotation:Gr,absoluteDist:Li,absoluteDelta:ri,absoluteRotate:to,absoluteRotation:to,isPinch:!!qt,resize:Bo},ws),rs));return no(y,"onRotate",hu),hu}}},dragControlEnd:function(y,m){var E=m.datas;if(!!E.isRotate){E.isRotate=!1;var S=ec(y,m,{});return no(y,"onRotateEnd",S),S}},dragGroupControlCondition:Te,dragGroupControlStart:function(y,m){var E=m.datas,S=y.state,D=S.left,J=S.top,ct=S.beforeOrigin,vt=this.dragControlStart(y,m);if(!vt)return!1;vt.set(E.beforeDirection*y.rotation);var It=$f(y,this,"dragControlStart",m,function(Zt,Ht){var be=Zt.state,_e=be.left,Ue=be.top,nn=be.beforeOrigin,hn=bi(gi([_e,Ue],[D,J]),gi(nn,ct));return Ht.datas.startGroupClient=hn,Ht.datas.groupClient=hn,We(We({},Ht),{parentRotate:0})}),Bt=We(We({},vt),{targets:y.props.targets,events:It}),qt=no(y,"onRotateGroupStart",Bt);return E.isRotate=qt!==!1,E.isRotate?vt:!1},dragGroupControl:function(y,m){var E=m.datas;if(!!E.isRotate){ir(y,"onBeforeRotate",function(Bt){no(y,"onBeforeRotateGroup",ps(y,m,We(We({},Bt),{targets:y.props.targets}),!0))});var S=this.dragControl(y,m);if(!!S){var D=E.beforeDirection,J=S.beforeDist,ct=J/180*Math.PI,vt=$f(y,this,"dragControl",m,function(Bt,qt){var Zt=qt.datas.startGroupClient,Ht=qt.datas.groupClient,be=Ht[0],_e=Ht[1],Ue=Su(Zt,ct*D),nn=Ue[0],hn=Ue[1],On=[nn-be,hn-_e];return qt.datas.groupClient=[nn,hn],We(We({},qt),{parentRotate:J,groupDelta:On})});y.rotation=D*S.beforeRotation;var It=We({targets:y.props.targets,events:vt,set:function(Bt){y.rotation=Bt},setGroupRotation:function(Bt){y.rotation=Bt}},S);return no(y,"onRotateGroup",It),It}}},dragGroupControlEnd:function(y,m){var E=m.isDrag,S=m.datas;if(!!S.isRotate){this.dragControlEnd(y,m);var D=$f(y,this,"dragControlEnd",m),J=ec(y,m,{targets:y.props.targets,events:D});return no(y,"onRotateGroupEnd",J),E}},request:function(y){var m={},E=0,S=y.getRotation();return{isControl:!0,requestStart:function(){return{datas:m}},request:function(D){return"deltaRotate"in D?E+=D.deltaRotate:"rotate"in D&&(E=D.rotate-S),{datas:m,parentDist:E}},requestEnd:function(){return{datas:m,isDrag:!0}}}}},cn=xc("scalable"),jn={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:Wa("scalable"),dragControlCondition:cn,viewClassName:Rd("scalable"),dragControlStart:function(y,m){var E=m.datas,S=m.isPinch,D=m.inputEvent,J=m.parentDirection,ct=Dd(J,S,D,E),vt=y.state,It=vt.width,Bt=vt.height,qt=vt.targetTransform,Zt=vt.target,Ht=vt.pos1,be=vt.pos2,_e=vt.pos4;if(!ct||!Zt)return!1;S||jf(y,m),E.datas={},E.transform=qt,E.prevDist=[1,1],E.direction=ct,E.startOffsetWidth=It,E.startOffsetHeight=Bt,E.startValue=[1,1];var Ue=Vt(Ht,be),nn=Vt(be,_e),hn=!ct[0]&&!ct[1]||ct[0]||!ct[1];E.scaleWidth=Ue,E.scaleHeight=nn,E.scaleXRatio=Ue/It,E.scaleYRatio=nn/Bt,qe(m,"scale"),E.isWidth=hn;function On(Un){E.ratio=Un&&isFinite(Un)?Un:0}E.startPositions=uc(y.state);function er(Un){E.fixedDirection=Un,E.fixedPosition=js(E.startPositions,Un)}E.setFixedDirection=er,On(Vt(Ht,be)/Vt(be,_e)),er([-ct[0],-ct[1]]);var Yn=ps(y,m,We(We({direction:ct,set:function(Un){E.startValue=Un},setRatio:On,setFixedDirection:er},xe(m)),{dragStart:M.dragStart(y,new Rf().dragStart([0,0],m))})),Ir=no(y,"onScaleStart",Yn);return E.startFixedDirection=E.fixedDirection,Ir!==!1&&(E.isScale=!0,y.state.snapRenderInfo={request:m.isRequest,direction:ct}),E.isScale?Yn:!1},dragControl:function(y,m){ph(m,"scale");var E=m.datas,S=m.parentKeepRatio,D=m.parentFlag,J=m.isPinch,ct=m.dragClient,vt=m.isRequest,It=m.resolveMatrix,Bt=E.prevDist,qt=E.direction,Zt=E.startOffsetWidth,Ht=E.startOffsetHeight,be=E.isScale,_e=E.startValue,Ue=E.isWidth,nn=E.ratio;if(!be)return!1;var hn=y.props,On=hn.throttleScale,er=hn.parentMoveable,Yn=qt;!qt[0]&&!qt[1]&&(Yn=[1,1]);var Ir=nn&&(S!=null?S:hn.keepRatio)||!1,Un=y.state;function gr(){var Fo=bp(Yn,Ir,E,m),_s=Fo.distWidth,Eo=Fo.distHeight,Co=Zt?(Zt+_s)/Zt:1,ws=Ht?(Ht+Eo)/Ht:1;return Co=Yn[0]||Ir?Co*_e[0]:_e[0],ws=Yn[1]||Ir?ws*_e[1]:_e[1],Co===0&&(Co=(Bt[0]>0?1:-1)*hh),ws===0&&(ws=(Bt[1]>0?1:-1)*hh),[Co,ws]}var Br=gr();if(!J&&y.props.groupable){var Tr=Un.snapRenderInfo||{},sa=Tr.direction;Rt(sa)&&(sa[0]||sa[1])&&(Un.snapRenderInfo={direction:qt,request:m.isRequest})}no(y,"onBeforeScale",ps(y,m,{scale:Br,setFixedDirection:function(Fo){return E.setFixedDirection(Fo),Br=gr(),Br},startFixedDirection:E.startFixedDirection,setScale:function(Fo){Br=Fo}},!0));var Gr=[Br[0]/_e[0],Br[1]/_e[1]],va=ct,la=[0,0],ka=!ct&&!D&&J;if(ka||It?va=Ui(y,E.targetAllTransform,[0,0],E):ct||(va=E.fixedPosition),J||(la=Mp(y,Gr,qt,vt,E)),Ir){Yn[0]&&Yn[1]&&la[0]&&la[1]&&(Math.abs(la[0]*Zt)>Math.abs(la[1]*Ht)?la[1]=0:la[0]=0);var ri=!la[0]&&!la[1];if(ri&&(Ue?Gr[0]=Xt(Gr[0]*_e[0],On)/_e[0]:Gr[1]=Xt(Gr[1]*_e[1],On)/_e[1]),Yn[0]&&!Yn[1]||la[0]&&!la[1]||ri&&Ue){Gr[0]+=la[0];var Li=Zt*Gr[0]*_e[0]/nn;Gr[1]=Li/Ht/_e[1]}else if(!Yn[0]&&Yn[1]||!la[0]&&la[1]||ri&&!Ue){Gr[1]+=la[1];var to=Ht*Gr[1]*_e[1]*nn;Gr[0]=to/Zt/_e[0]}}else Gr[0]+=la[0],Gr[1]+=la[1],la[0]||(Gr[0]=Xt(Gr[0]*_e[0],On)/_e[0]),la[1]||(Gr[1]=Xt(Gr[1]*_e[1],On)/_e[1]);Gr[0]===0&&(Gr[0]=(Bt[0]>0?1:-1)*hh),Gr[1]===0&&(Gr[1]=(Bt[1]>0?1:-1)*hh);var fi=[Gr[0]/Bt[0],Gr[1]/Bt[1]];Br=ll(Gr,_e);var Ii=Oo(y,Gr,E.fixedDirection,va,E),Ja=ka?Ii:gi(Ii,E.prevInverseDist||[0,0]);if(E.prevDist=Gr,E.prevInverseDist=Ii,Br[0]===Bt[0]&&Br[1]===Bt[1]&&Ja.every(function(Fo){return!Fo})&&!er&&!ka)return!1;var oo=Ri(E,"scale(".concat(Br.join(", "),")"),"scale(".concat(Gr.join(", "),")")),Po=ps(y,m,We({offsetWidth:Zt,offsetHeight:Ht,direction:qt,scale:Br,dist:Gr,delta:fi,isPinch:!!J},wi(y,oo,Ja,J,m)));return no(y,"onScale",Po),Po},dragControlEnd:function(y,m){var E=m.datas;if(!E.isScale)return!1;E.isScale=!1;var S=ec(y,m,{});return no(y,"onScaleEnd",S),S},dragGroupControlCondition:cn,dragGroupControlStart:function(y,m){var E=m.datas,S=this.dragControlStart(y,m);if(!S)return!1;var D=wc(y,"resizable",m);E.moveableScale=y.scale;var J=$f(y,this,"dragControlStart",m,function(Bt,qt){return jh(y,Bt,E,qt)}),ct=function(Bt){S.setFixedDirection(Bt),J.forEach(function(qt,Zt){qt.setFixedDirection(Bt),jh(y,qt.moveable,E,D[Zt])})};E.setFixedDirection=ct;var vt=We(We({},S),{targets:y.props.targets,events:J,setFixedDirection:ct}),It=no(y,"onScaleGroupStart",vt);return E.isScale=It!==!1,E.isScale?vt:!1},dragGroupControl:function(y,m){var E=m.datas;if(!!E.isScale){ir(y,"onBeforeScale",function(Zt){no(y,"onBeforeScaleGroup",ps(y,m,We(We({},Zt),{targets:y.props.targets}),!0))});var S=this.dragControl(y,m);if(!!S){var D=E.moveableScale;y.scale=[S.scale[0]*D[0],S.scale[1]*D[1]];var J=y.props.keepRatio,ct=S.dist,vt=S.scale,It=E.fixedPosition,Bt=$f(y,this,"dragControl",m,function(Zt,Ht){var be=To(Zo(y.rotation/180*Math.PI,3),[Ht.datas.originalX*ct[0],Ht.datas.originalY*ct[1],1],3),_e=be[0],Ue=be[1];return We(We({},Ht),{parentDist:null,parentScale:vt,parentKeepRatio:J,dragClient:bi(It,[_e,Ue])})}),qt=We({targets:y.props.targets,events:Bt},S);return no(y,"onScaleGroup",qt),qt}}},dragGroupControlEnd:function(y,m){var E=m.isDrag,S=m.datas;if(!!S.isScale){this.dragControlEnd(y,m);var D=$f(y,this,"dragControlEnd",m),J=ec(y,m,{targets:y.props.targets,events:D});return no(y,"onScaleGroupEnd",J),E}},request:function(){var y={},m=0,E=0;return{isControl:!0,requestStart:function(S){return{datas:y,parentDirection:S.direction||[1,1]}},request:function(S){return m+=S.deltaWidth,E+=S.deltaHeight,{datas:y,parentDist:[m,E],parentKeepRatio:S.keepRatio}},requestEnd:function(){return{datas:y,isDrag:!0}}}}};function En(y,m){return y.map(function(E,S){return Me(E,m[S],1,2)})}function ya(y,m,E){var S=X(y,m),D=X(y,E),J=D-S;return J>=0?J:J+2*Math.PI}function Dr(y,m){var E=ya(y[0],y[1],y[2]),S=ya(m[0],m[1],m[2]),D=Math.PI;return!(E>=D&&S<=D||E<=D&&S>=D)}var Fr={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:Rd("warpable"),render:function(y,m){var E=y.props,S=E.resizable,D=E.scalable,J=E.warpable,ct=E.zoom;if(S||D||!J)return[];var vt=y.state,It=vt.pos1,Bt=vt.pos2,qt=vt.pos3,Zt=vt.pos4,Ht=En(It,Bt),be=En(Bt,It),_e=En(It,qt),Ue=En(qt,It),nn=En(qt,Zt),hn=En(Zt,qt),On=En(Bt,Zt),er=En(Zt,Bt);return _r([m.createElement("div",{className:mo("line"),key:"middeLine1",style:Fh(Ht,nn,ct)}),m.createElement("div",{className:mo("line"),key:"middeLine2",style:Fh(be,hn,ct)}),m.createElement("div",{className:mo("line"),key:"middeLine3",style:Fh(_e,On,ct)}),m.createElement("div",{className:mo("line"),key:"middeLine4",style:Fh(Ue,er,ct)})],Ga(y,"warpable",m),!0)},dragControlCondition:function(y,m){if(m.isRequest)return!1;var E=m.inputEvent.target;return da(E,mo("direction"))&&da(E,mo("warpable"))},dragControlStart:function(y,m){var E=m.datas,S=m.inputEvent,D=y.props.target,J=S.target,ct=Bh(J,E);if(!ct||!D)return!1;var vt=y.state,It=vt.transformOrigin,Bt=vt.is3d,qt=vt.targetTransform,Zt=vt.targetMatrix,Ht=vt.width,be=vt.height,_e=vt.left,Ue=vt.top;E.datas={},E.targetTransform=qt,E.warpTargetMatrix=Bt?Zt:es(Zt,3,4),E.targetInverseMatrix=La(ui(E.warpTargetMatrix,4),3,4),E.direction=ct,E.left=_e,E.top=Ue,E.poses=[[0,0],[Ht,0],[0,be],[Ht,be]].map(function(On){return gi(On,It)}),E.nextPoses=E.poses.map(function(On){var er=On[0],Yn=On[1];return To(E.warpTargetMatrix,[er,Yn,0,1],4)}),E.startValue=Wi(4),E.prevMatrix=Wi(4),E.absolutePoses=uc(vt),E.posIndexes=vh(ct),jf(y,m),qe(m,"matrix3d"),vt.snapRenderInfo={request:m.isRequest,direction:ct};var nn=ps(y,m,We({set:function(On){E.startValue=On}},xe(m))),hn=no(y,"onWarpStart",nn);return hn!==!1&&(E.isWarp=!0),E.isWarp},dragControl:function(y,m){var E=m.datas,S=m.isRequest,D=m.distX,J=m.distY,ct=E.targetInverseMatrix,vt=E.prevMatrix,It=E.isWarp,Bt=E.startValue,qt=E.poses,Zt=E.posIndexes,Ht=E.absolutePoses;if(!It)return!1;if(ph(m,"matrix3d"),pd(y,"warpable")){var be=Zt.map(function(Tr){return Ht[Tr]});be.length>1&&be.push([(be[0][0]+be[1][0])/2,(be[0][1]+be[1][1])/2]);var _e=Yh(y,S,{horizontal:be.map(function(Tr){return Tr[1]+J}),vertical:be.map(function(Tr){return Tr[0]+D})}),Ue=_e.horizontal,nn=_e.vertical;J-=Ue.offset,D-=nn.offset}var hn=sc({datas:E,distX:D,distY:J},!0),On=E.nextPoses.slice();if(Zt.forEach(function(Tr){On[Tr]=bi(On[Tr],hn)}),!tf.every(function(Tr){return Dr(Tr.map(function(sa){return qt[sa]}),Tr.map(function(sa){return On[sa]}))}))return!1;var er=Us(qt[0],qt[2],qt[1],qt[3],On[0],On[2],On[1],On[3]);if(!er.length)return!1;var Yn=Zi(ct,er,4),Ir=bs(E,Yn,!0),Un=Zi(ui(vt,4),Ir,4);E.prevMatrix=Ir;var gr=Zi(Bt,Ir,4),Br=Ri(E,"matrix3d(".concat(gr.join(", "),")"),"matrix3d(".concat(Ir.join(", "),")"));return Er(m,Br),no(y,"onWarp",ps(y,m,We({delta:Un,matrix:gr,dist:Ir,multiply:Zi,transform:Br},Al({transform:Br},m)))),!0},dragControlEnd:function(y,m){var E=m.datas,S=m.isDrag;return E.isWarp?(E.isWarp=!1,no(y,"onWarpEnd",ec(y,m,{})),S):!1}},or=mo("area-pieces"),Xa=mo("area-piece"),Hn=mo("avoid"),si=mo("view-dragging");function Ci(y){var m=y.areaElement;if(!!m){var E=y.state,S=E.width,D=E.height;ki(m,Hn),m.style.cssText+="left: 0px; top: 0px; width: ".concat(S,"px; height: ").concat(D,"px")}}function Yi(y){return y.createElement("div",{key:"area_pieces",className:or},y.createElement("div",{className:Xa}),y.createElement("div",{className:Xa}),y.createElement("div",{className:Xa}),y.createElement("div",{className:Xa}))}var _i={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(y,m){var E=y.props,S=E.target,D=E.dragArea,J=E.groupable,ct=E.passDragArea,vt=y.getState(),It=vt.width,Bt=vt.height,qt=vt.renderPoses,Zt=ct?mo("area","pass"):mo("area");if(J)return[m.createElement("div",{key:"area",ref:wt(y,"areaElement"),className:Zt}),Yi(m)];if(!S||!D)return[];var Ht=Us([0,0],[It,0],[0,Bt],[It,Bt],qt[0],qt[1],qt[2],qt[3]),be=Ht.length?Tc(Ht,!0):"none";return[m.createElement("div",{key:"area",ref:wt(y,"areaElement"),className:Zt,style:{top:"0px",left:"0px",width:"".concat(It,"px"),height:"".concat(Bt,"px"),transformOrigin:"0 0",transform:be}}),Yi(m)]},dragStart:function(y,m){var E=m.datas,S=m.clientX,D=m.clientY,J=m.inputEvent;if(!J)return!1;E.isDragArea=!1;var ct=y.areaElement,vt=y.state,It=vt.moveableClientRect,Bt=vt.renderPoses,qt=vt.rootMatrix,Zt=vt.is3d,Ht=It.left,be=It.top,_e=tc(Bt),Ue=_e.left,nn=_e.top,hn=_e.width,On=_e.height,er=Zt?4:3,Yn=Uh(qt,[S-Ht,D-be],er),Ir=Yn[0],Un=Yn[1];Ir-=Ue,Un-=nn;var gr=[{left:Ue,top:nn,width:hn,height:Un-10},{left:Ue,top:nn,width:Ir-10,height:On},{left:Ue,top:nn+Un+10,width:hn,height:On-Un-10},{left:Ue+Ir+10,top:nn,width:hn-Ir-10,height:On}],Br=[].slice.call(ct.nextElementSibling.children);gr.forEach(function(Tr,sa){Br[sa].style.cssText="left: ".concat(Tr.left,"px;top: ").concat(Tr.top,"px; width: ").concat(Tr.width,"px; height: ").concat(Tr.height,"px;")}),Ti(ct,Hn),vt.disableNativeEvent=!0},drag:function(y,m){var E=m.datas,S=m.inputEvent;if(this.enableNativeEvent(y),!S)return!1;E.isDragArea||(E.isDragArea=!0,Ci(y))},dragEnd:function(y,m){this.enableNativeEvent(y);var E=m.inputEvent,S=m.datas;if(!E)return!1;S.isDragArea||Ci(y)},dragGroupStart:function(y,m){return this.dragStart(y,m)},dragGroup:function(y,m){return this.drag(y,m)},dragGroupEnd:function(y,m){return this.dragEnd(y,m)},unset:function(y){Ci(y),y.state.disableNativeEvent=!1},enableNativeEvent:function(y){var m=y.state;m.disableNativeEvent&&pr(function(){m.disableNativeEvent=!1})}},Yo=Va("origin",{render:function(y,m){var E=y.props.zoom,S=y.getState(),D=S.beforeOrigin,J=S.rotation;return[m.createElement("div",{className:mo("control","origin"),style:gh(J,E,D),key:"beforeOrigin"})]}});function xi(y){var m=y.scrollContainer;return[m.scrollLeft,m.scrollTop]}var Xu={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(y,m){var E=y.props,S=E.scrollContainer,D=S===void 0?y.getContainer():S,J=E.scrollOptions,ct=new Wu,vt=Kc(D,!0);m.datas.dragScroll=ct,y.state.dragScroll=ct;var It=m.isControl?"controlGesto":"targetGesto",Bt=m.targets;ct.on("scroll",function(qt){var Zt=qt.container,Ht=qt.direction,be=ps(y,m,{scrollContainer:Zt,direction:Ht}),_e=Bt?"onScrollGroup":"onScroll";Bt&&(be.targets=Bt),no(y,_e,be)}).on("move",function(qt){var Zt=qt.offsetX,Ht=qt.offsetY,be=qt.inputEvent;y[It].scrollBy(Zt,Ht,be.inputEvent,!0)}).on("scrollDrag",function(qt){var Zt=qt.next;Zt(y[It].getCurrentEvent())}),ct.dragStart(m,We({container:vt},J))},checkScroll:function(y,m){var E=m.datas.dragScroll;if(!!E){var S=y.props,D=S.scrollContainer,J=D===void 0?y.getContainer():D,ct=S.scrollThreshold,vt=ct===void 0?0:ct,It=S.scrollThrottleTime,Bt=It===void 0?0:It,qt=S.getScrollPosition,Zt=qt===void 0?xi:qt,Ht=S.scrollOptions;return E.drag(m,We({container:J,threshold:vt,throttleTime:Bt,getScrollPosition:function(be){return Zt({scrollContainer:be.container,direction:be.direction})}},Ht)),!0}},drag:function(y,m){return this.checkScroll(y,m)},dragEnd:function(y,m){m.datas.dragScroll.dragEnd(),m.datas.dragScroll=null},dragControlStart:function(y,m){return this.dragStart(y,We(We({},m),{isControl:!0}))},dragControl:function(y,m){return this.drag(y,m)},dragControlEnd:function(y,m){return this.dragEnd(y,m)},dragGroupStart:function(y,m){return this.dragStart(y,We(We({},m),{targets:y.props.targets}))},dragGroup:function(y,m){return this.drag(y,We(We({},m),{targets:y.props.targets}))},dragGroupEnd:function(y,m){return this.dragEnd(y,We(We({},m),{targets:y.props.targets}))},dragGroupControlStart:function(y,m){return this.dragStart(y,We(We({},m),{targets:y.props.targets,isControl:!0}))},dragGroupControl:function(y,m){return this.drag(y,We(We({},m),{targets:y.props.targets}))},dragGroupControEnd:function(y,m){return this.dragEnd(y,We(We({},m),{targets:y.props.targets}))},unset:function(y){var m,E=y.state;(m=E.dragScroll)===null||m===void 0||m.dragEnd(),E.dragScroll=null}},jo={name:"",props:["target","dragTarget","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","transformOrigin","edge","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","displayAroundControls","controlPadding","preventDefault","requestStyles"],events:["changeTargets"]},Fl=Va("padding",{render:function(y,m){var E=y.props;if(E.dragArea)return[];var S=E.padding||{},D=S.left,J=D===void 0?0:D,ct=S.top,vt=ct===void 0?0:ct,It=S.right,Bt=It===void 0?0:It,qt=S.bottom,Zt=qt===void 0?0:qt,Ht=y.getState(),be=Ht.renderPoses,_e=Ht.pos1,Ue=Ht.pos2,nn=Ht.pos3,hn=Ht.pos4,On=[_e,Ue,nn,hn],er=[];return J>0&&er.push([0,2]),vt>0&&er.push([0,1]),Bt>0&&er.push([1,3]),Zt>0&&er.push([2,3]),er.map(function(Yn,Ir){var Un=Yn[0],gr=Yn[1],Br=On[Un],Tr=On[gr],sa=be[Un],Gr=be[gr],va=Us([0,0],[100,0],[0,100],[100,100],Br,Tr,sa,Gr);if(!!va.length)return m.createElement("div",{key:"padding".concat(Ir),className:mo("padding"),style:{transform:Tc(va,!0)}})})}}),ku=["nw","ne","se","sw"];function xs(y,m){var E=y[0]+y[1],S=E>m?m/E:1;return y[0]*=S,y[1]=m-y[1]*S,y}var _u=[1,2,5,6],cl=[0,3,4,7],zi=[1,-1,-1,1],zu=[1,1,-1,-1];function sl(y,m,E,S,D,J,ct,vt){D===void 0&&(D=0),J===void 0&&(J=0),ct===void 0&&(ct=E),vt===void 0&&(vt=S);var It=[],Bt=!1,qt=y.filter(function(Ht){return!Ht.virtual}),Zt=qt.map(function(Ht){var be=Ht.horizontal,_e=Ht.vertical,Ue=Ht.pos;if(_e&&!Bt&&(Bt=!0,It.push("/")),Bt){var nn=Math.max(0,_e===1?Ue[1]-J:vt-Ue[1]);return It.push(bc(nn,S,m)),nn}else{var nn=Math.max(0,be===1?Ue[0]-D:ct-Ue[0]);return It.push(bc(nn,E,m)),nn}});return{radiusPoses:qt,styles:It,raws:Zt}}function Qo(y){for(var m=[0,0],E=[0,0],S=y.length,D=0;D<S;++D){var J=y[D];!J.sub||(J.horizontal&&(m[1]===0&&(m[0]=D),m[1]=D-m[0]+1,E[0]=D+1),J.vertical&&(E[1]===0&&(E[0]=D),E[1]=D-E[0]+1))}return{horizontalRange:m,verticalRange:E}}function Zl(y,m,E,S,D,J,ct){var vt,It,Bt,qt;J===void 0&&(J=[0,0]),ct===void 0&&(ct=!1);var Zt=y.indexOf("/"),Ht=(Zt>-1?y.slice(0,Zt):y).length,be=y.slice(0,Ht),_e=y.slice(Ht+1),Ue=be.length,nn=_e.length,hn=nn>0,On=be[0],er=On===void 0?"0px":On,Yn=be[1],Ir=Yn===void 0?er:Yn,Un=be[2],gr=Un===void 0?er:Un,Br=be[3],Tr=Br===void 0?Ir:Br,sa=_e[0],Gr=sa===void 0?er:sa,va=_e[1],la=va===void 0?hn?Gr:Ir:va,ka=_e[2],ri=ka===void 0?hn?Gr:gr:ka,Li=_e[3],to=Li===void 0?hn?la:Tr:Li,fi=[er,Ir,gr,Tr].map(function(_s){return Dn(_s,m)}),Ii=[Gr,la,ri,to].map(function(_s){return Dn(_s,E)}),Ja=fi.slice(),oo=Ii.slice();vt=xs([Ja[0],Ja[1]],m),Ja[0]=vt[0],Ja[1]=vt[1],It=xs([Ja[3],Ja[2]],m),Ja[3]=It[0],Ja[2]=It[1],Bt=xs([oo[0],oo[3]],E),oo[0]=Bt[0],oo[3]=Bt[1],qt=xs([oo[1],oo[2]],E),oo[1]=qt[0],oo[2]=qt[1];var Po=ct?Ja:Ja.slice(0,Math.max(J[0],Ue)),Fo=ct?oo:oo.slice(0,Math.max(J[1],nn));return _r(_r([],Po.map(function(_s,Eo){var Co=ku[Eo];return{virtual:Eo>=Ue,horizontal:zi[Eo],vertical:0,pos:[S+_s,D+(zu[Eo]===-1?E:0)],sub:!0,raw:fi[Eo],direction:Co}}),!0),Fo.map(function(_s,Eo){var Co=ku[Eo];return{virtual:Eo>=nn,horizontal:0,vertical:zu[Eo],pos:[S+(zi[Eo]===-1?m:0),D+_s],sub:!0,raw:Ii[Eo],direction:Co}}),!0)}function yu(y,m,E,S,D){D===void 0&&(D=m.length);var J=Qo(y.slice(S)),ct=J.horizontalRange,vt=J.verticalRange,It=E-S,Bt=0;if(It===0)Bt=D;else if(It>0&&It<ct[1])Bt=ct[1]-It;else if(It>=vt[0])Bt=vt[0]+vt[1]-It;else return;y.splice(E,Bt),m.splice(E,Bt)}function po(y,m,E,S,D,J,ct,vt,It,Bt,qt){Bt===void 0&&(Bt=0),qt===void 0&&(qt=0);var Zt=Qo(y.slice(E)),Ht=Zt.horizontalRange,be=Zt.verticalRange;if(S>-1)for(var _e=zi[S]===1?J-Bt:vt-J,Ue=Ht[1];Ue<=S;++Ue){var nn=zu[Ue]===1?qt:It,hn=0;if(S===Ue?hn=J:Ue===0?hn=Bt+_e:zi[Ue]===-1&&(hn=vt-(m[E][0]-Bt)),y.splice(E+Ue,0,{horizontal:zi[Ue],vertical:0,pos:[hn,nn]}),m.splice(E+Ue,0,[hn,nn]),Ue===0)break}else if(D>-1){var On=zu[D]===1?ct-qt:It-ct;if(Ht[1]===0&&be[1]===0){var er=[Bt+On,qt];y.push({horizontal:zi[0],vertical:0,pos:er}),m.push(er)}for(var Yn=be[0],Ue=be[1];Ue<=D;++Ue){var hn=zi[Ue]===1?Bt:vt,nn=0;if(D===Ue?nn=ct:Ue===0?nn=qt+On:zu[Ue]===1?nn=m[E+Yn][1]:zu[Ue]===-1&&(nn=It-(m[E+Yn][1]-qt)),y.push({horizontal:0,vertical:zu[Ue],pos:[hn,nn]}),m.push([hn,nn]),Ue===0)break}}}function Ds(y,m){m===void 0&&(m=y.map(function(D){return D.raw}));var E=y.map(function(D,J){return D.horizontal?m[J]:null}).filter(function(D){return D!=null}),S=y.map(function(D,J){return D.vertical?m[J]:null}).filter(function(D){return D!=null});return{horizontals:E,verticals:S}}var pi=[[0,-1,"n"],[1,0,"e"]],Sl=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function rh(y,m,E){var S=y.props.clipRelative,D=y.state,J=D.width,ct=D.height,vt=m,It=vt.type,Bt=vt.poses,qt=It==="rect",Zt=It==="circle";if(It==="polygon")return E.map(function(Un){return"".concat(bc(Un[0],J,S)," ").concat(bc(Un[1],ct,S))});if(qt||It==="inset"){var Ht=E[1][1],be=E[3][0],_e=E[7][0],Ue=E[5][1];if(qt)return[Ht,be,Ue,_e].map(function(Un){return"".concat(Un,"px")});var nn=[Ht,J-be,ct-Ue,_e].map(function(Un,gr){return bc(Un,gr%2?J:ct,S)});if(E.length>8){var hn=gi(E[4],E[0]),On=hn[0],er=hn[1];nn.push.apply(nn,_r(["round"],sl(Bt.slice(8).map(function(Un,gr){return We(We({},Un),{pos:E[gr]})}),S,On,er,_e,Ht,be,Ue).styles,!1))}return nn}else if(Zt||It==="ellipse"){var Yn=E[0],Ir=bc(Math.abs(E[1][1]-Yn[1]),Zt?Math.sqrt((J*J+ct*ct)/2):ct,S),nn=Zt?[Ir]:[bc(Math.abs(E[2][0]-Yn[0]),J,S),Ir];return nn.push("at",bc(Yn[0],J,S),bc(Yn[1],ct,S)),nn}}function fl(y,m,E,S){var D=[S,(S+m)/2,m],J=[y,(y+E)/2,E];return Sl.map(function(ct){var vt=ct[0],It=ct[1],Bt=ct[2],qt=D[vt+1],Zt=J[It+1];return{vertical:Math.abs(It),horizontal:Math.abs(vt),direction:Bt,pos:[qt,Zt]}})}function $n(y){var m=[Infinity,-Infinity],E=[Infinity,-Infinity];return y.forEach(function(S){var D=S.pos;m[0]=Math.min(m[0],D[0]),m[1]=Math.max(m[1],D[0]),E[0]=Math.min(E[0],D[1]),E[1]=Math.max(E[1],D[1])}),[Math.abs(m[1]-m[0]),Math.abs(E[1]-E[0])]}function Jr(y,m,E,S,D){var J,ct,vt,It,Bt,qt,Zt;if(!!y){var Ht=D;if(!Ht){var be=lr(y),_e=be("clipPath");Ht=_e!=="none"?_e:be("clip")}if(!((!Ht||Ht==="none"||Ht==="auto")&&(Ht=S,!Ht))){var Ue=_n(Ht),nn=Ue.prefix,hn=nn===void 0?Ht:nn,On=Ue.value,er=On===void 0?"":On,Yn=hn==="circle",Ir=" ";if(hn==="polygon"){var Un=Lr(er||"0% 0%, 100% 0%, 100% 100%, 0% 100%");Ir=",";var gr=Un.map(function(cu){var Hs=cu.split(" "),Ru=Hs[0],ih=Hs[1];return{vertical:1,horizontal:1,pos:[Dn(Ru,m),Dn(ih,E)]}}),Br=oc(gr.map(function(cu){return cu.pos}));return{type:hn,clipText:Ht,poses:gr,splitter:Ir,left:Br.minX,right:Br.maxX,top:Br.minY,bottom:Br.maxY}}else if(Yn||hn==="ellipse"){var Tr="",sa="",Gr=0,va=0,Un=Da(er);if(Yn){var la="";J=Un[0],la=J===void 0?"50%":J,ct=Un[2],Tr=ct===void 0?"50%":ct,vt=Un[3],sa=vt===void 0?"50%":vt,Gr=Dn(la,Math.sqrt((m*m+E*E)/2)),va=Gr}else{var ka="",ri="";It=Un[0],ka=It===void 0?"50%":It,Bt=Un[1],ri=Bt===void 0?"50%":Bt,qt=Un[3],Tr=qt===void 0?"50%":qt,Zt=Un[4],sa=Zt===void 0?"50%":Zt,Gr=Dn(ka,m),va=Dn(ri,E)}var Li=[Dn(Tr,m),Dn(sa,E)],gr=_r([{vertical:1,horizontal:1,pos:Li,direction:"nesw"}],pi.slice(0,Yn?1:2).map(function(Ru){return{vertical:Math.abs(Ru[1]),horizontal:Ru[0],direction:Ru[2],sub:!0,pos:[Li[0]+Ru[0]*Gr,Li[1]+Ru[1]*va]}}),!0);return{type:hn,clipText:Ht,radiusX:Gr,radiusY:va,left:Li[0]-Gr,top:Li[1]-va,right:Li[0]+Gr,bottom:Li[1]+va,poses:gr,splitter:Ir}}else if(hn==="inset"){var Un=Da(er||"0 0 0 0"),to=Un.indexOf("round"),fi=(to>-1?Un.slice(0,to):Un).length,Ii=Un.slice(fi+1),Ja=Un.slice(0,fi),oo=Ja[0],Po=Ja[1],Fo=Po===void 0?oo:Po,_s=Ja[2],Eo=_s===void 0?oo:_s,Co=Ja[3],ws=Co===void 0?Fo:Co,rs=[oo,Eo].map(function(Ru){return Dn(Ru,E)}),$u=rs[0],Bo=rs[1],ts=[ws,Fo].map(function(Ru){return Dn(Ru,m)}),hu=ts[0],eu=ts[1],Nl=m-eu,Gu=E-Bo,nu=Zl(Ii,Nl-hu,Gu-$u,hu,$u),gr=_r(_r([],fl($u,Nl,Gu,hu),!0),nu,!0);return{type:"inset",clipText:Ht,poses:gr,top:$u,left:hu,right:Nl,bottom:Gu,radius:Ii,splitter:Ir}}else if(hn==="rect"){var Un=Lr(er||"0px, ".concat(m,"px, ").concat(E,"px, 0px"));Ir=",";var kl=Un.map(function(Bc){var kp=sr(Bc).value;return kp}),$u=kl[0],eu=kl[1],Bo=kl[2],hu=kl[3],gr=fl($u,eu,Bo,hu);return{type:"rect",clipText:Ht,poses:gr,top:$u,right:eu,bottom:Bo,left:hu,values:Un,splitter:Ir}}}}}function Nr(y,m,E,S,D){var J=y[m],ct=J.direction,vt=J.sub,It=y.map(function(){return[0,0]}),Bt=ct?ct.split(""):[];if(S&&m<8){var qt=Bt.filter(function(la){return la==="w"||la==="e"}),Zt=Bt.filter(function(la){return la==="n"||la==="s"}),Ht=qt[0],be=Zt[0];It[m]=E;var _e=$n(y),Ue=_e[0],nn=_e[1],hn=Ue&&nn?Ue/nn:0;if(hn&&D){var On=(m+4)%8,er=y[On].pos,Yn=[0,0];ct.indexOf("w")>-1?Yn[0]=-1:ct.indexOf("e")>-1&&(Yn[0]=1),ct.indexOf("n")>-1?Yn[1]=-1:ct.indexOf("s")>-1&&(Yn[1]=1);var Ir=Jf([Ue,nn],E,hn,Yn,!0),Un=Ue+Ir[0],gr=nn+Ir[1],Br=er[1],Tr=er[1],sa=er[0],Gr=er[0];Yn[0]===-1?sa=Gr-Un:Yn[0]===1?Gr=sa+Un:(sa=sa-Un/2,Gr=Gr+Un/2),Yn[1]===-1?Br=Tr-gr:(Yn[1]===1||(Br=Tr-gr/2),Tr=Br+gr);var va=fl(Br,Gr,Tr,sa);y.forEach(function(la,ka){It[ka][0]=va[ka].pos[0]-la.pos[0],It[ka][1]=va[ka].pos[1]-la.pos[1]})}else y.forEach(function(la,ka){var ri=la.direction;!ri||(ri.indexOf(Ht)>-1&&(It[ka][0]=E[0]),ri.indexOf(be)>-1&&(It[ka][1]=E[1]))}),Ht&&(It[1][0]=E[0]/2,It[5][0]=E[0]/2),be&&(It[3][1]=E[1]/2,It[7][1]=E[1]/2)}else ct&&!vt?Bt.forEach(function(la){var ka=la==="n"||la==="s";y.forEach(function(ri,Li){var to=ri.direction,fi=ri.horizontal,Ii=ri.vertical;!to||to.indexOf(la)===-1||(It[Li]=[ka||!fi?0:E[0],!ka||!Ii?0:E[1]])})}):It[m]=E;return It}function Hi(y,m){var E=hp(y,m),S=E[0],D=E[1],J=m.datas,ct=J.clipPath,vt=J.clipIndex,It=ct,Bt=It.type,qt=It.poses,Zt=It.splitter,Ht=qt.map(function(On){return On.pos});if(Bt==="polygon")Ht.splice(vt,0,[S,D]);else if(Bt==="inset"){var be=_u.indexOf(vt),_e=cl.indexOf(vt),Ue=qt.length;if(po(qt,Ht,8,be,_e,S,D,Ht[4][0],Ht[4][1],Ht[0][0],Ht[0][1]),Ue===qt.length)return}else return;var nn=rh(y,ct,Ht),hn="".concat(Bt,"(").concat(nn.join(Zt),")");no(y,"onClip",ps(y,m,We({clipEventType:"added",clipType:Bt,poses:Ht,clipStyles:nn,clipStyle:hn,distX:0,distY:0},Al({clipPath:hn},m))))}function Jo(y,m){var E=m.datas,S=E.clipPath,D=E.clipIndex,J=S,ct=J.type,vt=J.poses,It=J.splitter,Bt=vt.map(function(be){return be.pos}),qt=Bt.length;if(ct==="polygon")vt.splice(D,1),Bt.splice(D,1);else if(ct==="inset"){if(D<8||(yu(vt,Bt,D,8,qt),qt===vt.length))return}else return;var Zt=rh(y,S,Bt),Ht="".concat(ct,"(").concat(Zt.join(It),")");no(y,"onClip",ps(y,m,We({clipEventType:"removed",clipType:ct,poses:Bt,clipStyles:Zt,clipStyle:Ht,distX:0,distY:0},Al({clipPath:Ht},m))))}var An={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(y,m){var E=y.props,S=E.customClipPath,D=E.defaultClipPath,J=E.clipArea,ct=E.zoom,vt=E.groupable,It=y.getState(),Bt=It.target,qt=It.width,Zt=It.height,Ht=It.allMatrix,be=It.is3d,_e=It.left,Ue=It.top,nn=It.pos1,hn=It.pos2,On=It.pos3,er=It.pos4,Yn=It.clipPathState,Ir=It.snapBoundInfos,Un=It.rotation;if(!Bt||vt)return[];var gr=Jr(Bt,qt,Zt,D||"inset",Yn||S);if(!gr)return[];var Br=be?4:3,Tr=gr.type,sa=gr.poses,Gr=sa.map(function(Gu){var nu=ol(Ht,Gu.pos,Br);return[nu[0]-_e,nu[1]-Ue]}),va=[],la=[],ka=Tr==="rect",ri=Tr==="inset",Li=Tr==="polygon";if(ka||ri||Li){var to=ri?Gr.slice(0,8):Gr;la=to.map(function(Gu,nu){var kl=nu===0?to[to.length-1]:to[nu-1],cu=X(kl,Gu),Hs=Kf(kl,Gu);return m.createElement("div",{key:"clipLine".concat(nu),className:mo("line","clip-line","snap-control"),"data-clip-index":nu,style:{width:"".concat(Hs,"px"),transform:"translate(".concat(kl[0],"px, ").concat(kl[1],"px) rotate(").concat(cu,"rad) scaleY(").concat(ct,")")}})})}if(va=Gr.map(function(Gu,nu){return m.createElement("div",{key:"clipControl".concat(nu),className:mo("control","clip-control","snap-control"),"data-clip-index":nu,style:{transform:"translate(".concat(Gu[0],"px, ").concat(Gu[1],"px) rotate(").concat(Un,"rad) scale(").concat(ct,")")}})}),ri&&va.push.apply(va,Gr.slice(8).map(function(Gu,nu){return m.createElement("div",{key:"clipRadiusControl".concat(nu),className:mo("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+nu,style:{transform:"translate(".concat(Gu[0],"px, ").concat(Gu[1],"px) rotate(").concat(Un,"rad) scale(").concat(ct,")")}})})),Tr==="circle"||Tr==="ellipse"){var fi=gr.left,Ii=gr.top,Ja=gr.radiusX,oo=gr.radiusY,Po=gi(ol(Ht,[fi,Ii],Br),ol(Ht,[0,0],Br)),Fo=Po[0],_s=Po[1],Eo="none";if(!J){for(var Co=Math.max(10,Ja/5,oo/5),ws=[],rs=0;rs<=Co;++rs){var $u=Math.PI*2/Co*rs;ws.push([Ja+(Ja-ct)*Math.cos($u),oo+(oo-ct)*Math.sin($u)])}ws.push([Ja,-2]),ws.push([-2,-2]),ws.push([-2,oo*2+2]),ws.push([Ja*2+2,oo*2+2]),ws.push([Ja*2+2,-2]),ws.push([Ja,-2]),Eo="polygon(".concat(ws.map(function(Gu){return"".concat(Gu[0],"px ").concat(Gu[1],"px")}).join(", "),")")}va.push(m.createElement("div",{key:"clipEllipse",className:mo("clip-ellipse","snap-control"),style:{width:"".concat(Ja*2,"px"),height:"".concat(oo*2,"px"),clipPath:Eo,transform:"translate(".concat(-_e+Fo,"px, ").concat(-Ue+_s,"px) ").concat(Tc(Ht))}}))}if(J){var Bo=tc(_r([nn,hn,On,er],Gr,!0)),ts=Bo.width,hu=Bo.height,eu=Bo.left,Nl=Bo.top;if(Li||ka||ri){var ws=ri?Gr.slice(0,8):Gr;va.push(m.createElement("div",{key:"clipArea",className:mo("clip-area","snap-control"),style:{width:"".concat(ts,"px"),height:"".concat(hu,"px"),transform:"translate(".concat(eu,"px, ").concat(Nl,"px)"),clipPath:"polygon(".concat(ws.map(function(nu){return"".concat(nu[0]-eu,"px ").concat(nu[1]-Nl,"px")}).join(", "),")")}}))}}return Ir&&["vertical","horizontal"].forEach(function(Gu){var nu=Ir[Gu],kl=Gu==="horizontal";nu.isSnap&&la.push.apply(la,nu.snap.posInfos.map(function(cu,Hs){var Ru=cu.pos,ih=gi(ol(Ht,kl?[0,Ru]:[Ru,0],Br),[_e,Ue]),Zh=gi(ol(Ht,kl?[qt,Ru]:[Ru,Zt],Br),[_e,Ue]);return ea(m,"",ih,Zh,ct,"clip".concat(Gu,"snap").concat(Hs),"guideline")})),nu.isBound&&la.push.apply(la,nu.bounds.map(function(cu,Hs){var Ru=cu.pos,ih=gi(ol(Ht,kl?[0,Ru]:[Ru,0],Br),[_e,Ue]),Zh=gi(ol(Ht,kl?[qt,Ru]:[Ru,Zt],Br),[_e,Ue]);return ea(m,"",ih,Zh,ct,"clip".concat(Gu,"bounds").concat(Hs),"guideline","bounds","bold")}))}),_r(_r([],va,!0),la,!0)},dragControlCondition:function(y,m){return m.inputEvent&&(m.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(y,m){var E=y.props,S=E.dragWithClip,D=S===void 0?!0:S;return D?!1:this.dragControlStart(y,m)},drag:function(y,m){return this.dragControl(y,We(We({},m),{isDragTarget:!0}))},dragEnd:function(y,m){return this.dragControlEnd(y,m)},dragControlStart:function(y,m){var E=y.state,S=y.props,D=S.defaultClipPath,J=S.customClipPath,ct=E.target,vt=E.width,It=E.height,Bt=m.inputEvent?m.inputEvent.target:null,qt=Bt&&Bt.getAttribute("class")||"",Zt=m.datas,Ht=Jr(ct,vt,It,D||"inset",J);if(!Ht)return!1;var be=Ht.clipText,_e=Ht.type,Ue=Ht.poses,nn=no(y,"onClipStart",ps(y,m,{clipType:_e,clipStyle:be,poses:Ue.map(function(hn){return hn.pos})}));return nn===!1?(Zt.isClipStart=!1,!1):(Zt.isControl=qt&&qt.indexOf("clip-control")>-1,Zt.isLine=qt.indexOf("clip-line")>-1,Zt.isArea=qt.indexOf("clip-area")>-1||qt.indexOf("clip-ellipse")>-1,Zt.clipIndex=Bt?parseInt(Bt.getAttribute("data-clip-index"),10):-1,Zt.clipPath=Ht,Zt.isClipStart=!0,E.clipPathState=be,jf(y,m),!0)},dragControl:function(y,m){var E,S,D=m.datas,J=m.originalDatas,ct=m.isDragTarget;if(!D.isClipStart)return!1;var vt=D,It=vt.isControl,Bt=vt.isLine,qt=vt.isArea,Zt=vt.clipIndex,Ht=vt.clipPath;if(!Ht)return!1;var be=mh(y.props,"clippable"),_e=be.keepRatio,Ue=0,nn=0,hn=J.draggable,On=sc(m);ct&&hn?(E=hn.prevBeforeDist,Ue=E[0],nn=E[1]):(Ue=On[0],nn=On[1]);var er=[Ue,nn],Yn=y.state,Ir=Yn.width,Un=Yn.height,gr=!qt&&!It&&!Bt,Br=Ht.type,Tr=Ht.poses,sa=Ht.splitter,Gr=Tr.map(function(Ul){return Ul.pos});gr&&(Ue=-Ue,nn=-nn);var va=!It||Tr[Zt].direction==="nesw",la=Br==="inset"||Br==="rect",ka=Tr.map(function(){return[0,0]});if(It&&!va){var ri=Tr[Zt],Li=ri.horizontal,to=ri.vertical,fi=[Ue*Math.abs(Li),nn*Math.abs(to)];ka=Nr(Tr,Zt,fi,la,_e)}else va&&(ka=Gr.map(function(){return[Ue,nn]}));var Ii=Gr.map(function(Ul,Cl){return bi(Ul,ka[Cl])}),Ja=_r([],Ii,!0);Yn.snapBoundInfos=null;var oo=Ht.type==="circle",Po=Ht.type==="ellipse";if(oo||Po){var Fo=tc(Ii),_s=Math.abs(Fo.bottom-Fo.top),Eo=Math.abs(Po?Fo.right-Fo.left:_s),Co=Ii[0][1]+_s,ws=Ii[0][0]-Eo,rs=Ii[0][0]+Eo;oo&&(Ja.push([rs,Fo.bottom]),ka.push([1,0])),Ja.push([Fo.left,Co]),ka.push([0,1]),Ja.push([ws,Fo.bottom]),ka.push([1,0])}var $u=li((be.clipHorizontalGuidelines||[]).map(function(Ul){return Dn("".concat(Ul),Un)}),(be.clipVerticalGuidelines||[]).map(function(Ul){return Dn("".concat(Ul),Ir)}),Ir,Un),Bo=[],ts=[];if(oo||Po)Bo=[Ja[4][0],Ja[2][0]],ts=[Ja[1][1],Ja[3][1]];else if(la){var hu=[Ja[0],Ja[2],Ja[4],Ja[6]],eu=[ka[0],ka[2],ka[4],ka[6]];Bo=hu.filter(function(Ul,Cl){return eu[Cl][0]}).map(function(Ul){return Ul[0]}),ts=hu.filter(function(Ul,Cl){return eu[Cl][1]}).map(function(Ul){return Ul[1]})}else Bo=Ja.filter(function(Ul,Cl){return ka[Cl][0]}).map(function(Ul){return Ul[0]}),ts=Ja.filter(function(Ul,Cl){return ka[Cl][1]}).map(function(Ul){return Ul[1]});var Nl=[0,0],Gu=ov($u,be.clipTargetBounds&&{left:0,top:0,right:Ir,bottom:Un},Bo,ts,5),nu=Gu.horizontal,kl=Gu.vertical,cu=nu.offset,Hs=kl.offset;if(nu.isBound&&(Nl[1]+=cu),kl.isBound&&(Nl[0]+=Hs),(Po||oo)&&ka[0][0]===0&&ka[0][1]===0){var Fo=tc(Ii),Ru=Fo.bottom-Fo.top,ih=Po?Fo.right-Fo.left:Ru,Zh=kl.isBound?Math.abs(Hs):kl.snapIndex===0?-Hs:Hs,qc=nu.isBound?Math.abs(cu):nu.snapIndex===0?-cu:cu;ih-=Zh,Ru-=qc,oo&&(Ru=vd(kl,nu)>0?Ru:ih,ih=Ru);var Bc=Ja[0];Ja[1][1]=Bc[1]-Ru,Ja[2][0]=Bc[0]+ih,Ja[3][1]=Bc[1]+Ru,Ja[4][0]=Bc[0]-ih}else if(la&&_e&&It){var kp=$n(Tr),qh=kp[0],W0=kp[1],Cg=qh&&W0?qh/W0:0,Wm=Tr[Zt],Fv=Wm.direction||"",om=Ja[1][1],Co=Ja[5][1],ws=Ja[7][0],rs=Ja[3][0];cu<=Hs?cu=Hs/Cg:Hs=cu*Cg,Fv.indexOf("w")>-1?ws-=Hs:Fv.indexOf("e")>-1?rs-=Hs:(ws+=Hs/2,rs-=Hs/2),Fv.indexOf("n")>-1?om-=cu:Fv.indexOf("s")>-1?Co-=cu:(om+=cu/2,Co-=cu/2);var dv=fl(om,rs,Co,ws);Ja.forEach(function(_g,O1){var cm;cm=dv[O1].pos,_g[0]=cm[0],_g[1]=cm[1]})}else Ja.forEach(function(Ul,Cl){var j0=ka[Cl];j0[0]&&(Ul[0]-=Hs),j0[1]&&(Ul[1]-=cu)});var sm=rh(y,Ht,Ii),um="".concat(Br,"(").concat(sm.join(sa),")");if(Yn.clipPathState=um,oo||Po)Bo=[Ja[4][0],Ja[2][0]],ts=[Ja[1][1],Ja[3][1]];else if(la){var hu=[Ja[0],Ja[2],Ja[4],Ja[6]];Bo=hu.map(function(Cl){return Cl[0]}),ts=hu.map(function(Cl){return Cl[1]})}else Bo=Ja.map(function(Ul){return Ul[0]}),ts=Ja.map(function(Ul){return Ul[1]});if(Yn.snapBoundInfos=ov($u,be.clipTargetBounds&&{left:0,top:0,right:Ir,bottom:Un},Bo,ts,1),hn){var D1=Yn.is3d,lm=Yn.allMatrix,V0=D1?4:3,bd=Nl;ct&&(bd=[er[0]+Nl[0]-On[0],er[1]+Nl[1]-On[1]]),hn.deltaOffset=Zi(lm,[bd[0],bd[1],0,0],V0)}return no(y,"onClip",ps(y,m,We({clipEventType:"changed",clipType:Br,poses:Ii,clipStyle:um,clipStyles:sm,distX:Ue,distY:nn},Al((S={},S[Br==="rect"?"clip":"clipPath"]=um,S),m)))),!0},dragControlEnd:function(y,m){this.unset(y);var E=m.isDrag,S=m.datas,D=m.isDouble,J=S.isLine,ct=S.isClipStart,vt=S.isControl;return ct?(no(y,"onClipEnd",ec(y,m,{})),D&&(vt?Jo(y,m):J&&Hi(y,m)),D||E):!1},unset:function(y){y.state.clipPathState="",y.state.snapBoundInfos=null}},sn={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(y,m){return m.isRequest?m.requestAble==="originDraggable":da(m.inputEvent.target,mo("origin"))},dragControlStart:function(y,m){var E=m.datas;jf(y,m);var S=ps(y,m,{dragStart:M.dragStart(y,new Rf().dragStart([0,0],m))}),D=no(y,"onDragOriginStart",S);return E.startOrigin=y.state.transformOrigin,E.startTargetOrigin=y.state.targetOrigin,E.prevOrigin=[0,0],E.isDragOrigin=!0,D===!1?(E.isDragOrigin=!1,!1):S},dragControl:function(y,m){var E=m.datas,S=m.isPinch,D=m.isRequest;if(!E.isDragOrigin)return!1;var J=sc(m),ct=J[0],vt=J[1],It=y.state,Bt=It.width,qt=It.height,Zt=It.offsetMatrix,Ht=It.targetMatrix,be=It.is3d,_e=y.props.originRelative,Ue=_e===void 0?!0:_e,nn=be?4:3,hn=[ct,vt];if(D){var On=m.distOrigin;(On[0]||On[1])&&(hn=On)}var er=bi(E.startOrigin,hn),Yn=bi(E.startTargetOrigin,hn),Ir=gi(hn,E.prevOrigin),Un=Pl(Zt,Ht,er,nn),gr=y.getRect(),Br=tc(Pc(Un,Bt,qt,nn)),Tr=[gr.left-Br.left,gr.top-Br.top];E.prevOrigin=hn;var sa=[bc(Yn[0],Bt,Ue),bc(Yn[1],qt,Ue)].join(" "),Gr=M.drag(y,df(m,y.state,Tr,!!S,!1)),va=ps(y,m,We(We({width:Bt,height:qt,origin:er,dist:hn,delta:Ir,transformOrigin:sa,drag:Gr},Al({transformOrigin:sa,transform:Gr.transform},m)),{afterTransform:Gr.transform}));return no(y,"onDragOrigin",va),va},dragControlEnd:function(y,m){var E=m.datas;return E.isDragOrigin?(no(y,"onDragOriginEnd",ec(y,m,{})),!0):!1},dragGroupControlCondition:function(y,m){return this.dragControlCondition(y,m)},dragGroupControlStart:function(y,m){var E=this.dragControlStart(y,m);return!!E},dragGroupControl:function(y,m){var E=this.dragControl(y,m);return E?(y.transformOrigin=E.transformOrigin,!0):!1},request:function(y){var m={},E=y.getRect(),S=0,D=0,J=E.transformOrigin,ct=[0,0];return{isControl:!0,requestStart:function(){return{datas:m}},request:function(vt){return"deltaOrigin"in vt?(ct[0]+=vt.deltaOrigin[0],ct[1]+=vt.deltaOrigin[1]):"origin"in vt?(ct[0]=vt.origin[0]-J[0],ct[1]=vt.origin[1]-J[1]):("x"in vt?S=vt.x-E.left:"deltaX"in vt&&(S+=vt.deltaX),"y"in vt?D=vt.y-E.top:"deltaY"in vt&&(D+=vt.deltaY)),{datas:m,distX:S,distY:D,distOrigin:ct}},requestEnd:function(){return{datas:m,isDrag:!0}}}}};function hr(y,m,E,S){var D=y.filter(function(It){var Bt=It.virtual,qt=It.horizontal;return qt&&!Bt}).length,J=y.filter(function(It){var Bt=It.virtual,qt=It.vertical;return qt&&!Bt}).length,ct=-1;if(m===0&&(D===0?ct=0:D===1&&(ct=1)),m===2&&(D<=2?ct=2:D<=3&&(ct=3)),m===3&&(J===0?ct=4:J<4&&(ct=7)),m===1&&(J<=1?ct=5:J<=2&&(ct=6)),!(ct===-1||!y[ct].virtual)){var vt=y[ct];Pr(y,ct),ct<4?vt.pos[0]=E:vt.pos[1]=S}}function Pr(y,m){m<4?y.slice(0,m+1).forEach(function(E){E.virtual=!1}):(y[0].virtual&&(y[0].virtual=!1),y.slice(4,m+1).forEach(function(E){E.virtual=!1}))}function Xr(y,m){m<4?y.slice(m,4).forEach(function(E){E.virtual=!0}):y.slice(m).forEach(function(E){E.virtual=!0})}function yr(y,m,E,S,D){S===void 0&&(S=[0,0]);var J=[];return!y||y==="0px"?J=[]:J=Da(y),Zl(J,m,E,0,0,S,D)}function vr(y,m,E,S,D){var J=y.state,ct=J.width,vt=J.height,It=sl(D,y.props.roundRelative,ct,vt),Bt=It.raws,qt=It.styles,Zt=It.radiusPoses,Ht=Ds(Zt,Bt),be=Ht.horizontals,_e=Ht.verticals,Ue=qt.join(" ");J.borderRadiusState=Ue;var nn=ps(y,m,We({horizontals:be,verticals:_e,borderRadius:Ue,width:ct,height:vt,delta:S,dist:E},Al({borderRadius:Ue},m)));return no(y,"onRound",nn),nn}function Mr(y){var m,E,S=y.getState().style,D=S.borderRadius||"";if(!D&&y.props.groupable){var J=y.moveables[0],ct=y.getTargets()[0];ct&&((J==null?void 0:J.props.target)===ct?(D=(E=(m=y.moveables[0])===null||m===void 0?void 0:m.state.style.borderRadius)!==null&&E!==void 0?E:"",S.borderRadius=D):(D=yh(ct).borderRadius,S.borderRadius=D))}return D}var kn={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(y){var m=y.props.roundClickable;return m===!0||m==="line"?mo("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(y,m){var E=y.getState(),S=E.target,D=E.width,J=E.height,ct=E.allMatrix,vt=E.is3d,It=E.left,Bt=E.top,qt=E.borderRadiusState,Zt=y.props,Ht=Zt.minRoundControls,be=Ht===void 0?[0,0]:Ht,_e=Zt.maxRoundControls,Ue=_e===void 0?[4,4]:_e,nn=Zt.zoom,hn=Zt.roundPadding,On=hn===void 0?0:hn,er=Zt.isDisplayShadowRoundControls,Yn=Zt.groupable;if(!S)return null;var Ir=qt||Mr(y),Un=vt?4:3,gr=yr(Ir,D,J,be,!0);if(!gr)return null;var Br=0,Tr=0,sa=Yn?[0,0]:[It,Bt];return gr.map(function(Gr,va){var la=Gr.horizontal,ka=Gr.vertical,ri=Gr.direction||"",Li=_r([],Gr.pos,!0);Tr+=Math.abs(la),Br+=Math.abs(ka),la&&ri.indexOf("n")>-1&&(Li[1]-=On),ka&&ri.indexOf("w")>-1&&(Li[0]-=On),la&&ri.indexOf("s")>-1&&(Li[1]+=On),ka&&ri.indexOf("e")>-1&&(Li[0]+=On);var to=gi(ol(ct,Li,Un),sa),fi=Gr.vertical?Br<=Ue[1]&&(er||!Gr.virtual):Tr<=Ue[0]&&(er||!Gr.virtual);return m.createElement("div",{key:"borderRadiusControl".concat(va),className:mo("control","border-radius",Gr.vertical?"vertical":"",Gr.virtual?"virtual":""),"data-radius-index":va,style:{display:fi?"block":"none",transform:"translate(".concat(to[0],"px, ").concat(to[1],"px) scale(").concat(nn,")")}})})},dragControlCondition:function(y,m){if(!m.inputEvent||m.isRequest)return!1;var E=m.inputEvent.target.getAttribute("class")||"";return E.indexOf("border-radius")>-1||E.indexOf("moveable-line")>-1&&E.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(y,m){return this.dragControlCondition(y,m)},dragControlStart:function(y,m){var E=m.inputEvent,S=m.datas,D=E.target,J=D.getAttribute("class")||"",ct=J.indexOf("border-radius")>-1,vt=J.indexOf("moveable-line")>-1&&J.indexOf("moveable-direction")>-1,It=ct?parseInt(D.getAttribute("data-radius-index"),10):-1,Bt=-1;if(vt){var qt=D.getAttribute("data-line-key")||"";qt&&(Bt=parseInt(qt.replace(/render-line-/g,""),10),isNaN(Bt)&&(Bt=-1))}if(!ct&&!vt)return!1;var Zt=ps(y,m,{}),Ht=no(y,"onRoundStart",Zt);if(Ht===!1)return!1;S.lineIndex=Bt,S.controlIndex=It,S.isControl=ct,S.isLine=vt,jf(y,m);var be=y.props,_e=be.roundRelative,Ue=be.minRoundControls,nn=Ue===void 0?[0,0]:Ue,hn=y.state,On=hn.width,er=hn.height;S.isRound=!0,S.prevDist=[0,0];var Yn=Mr(y),Ir=yr(Yn||"",On,er,nn,!0)||[];return S.controlPoses=Ir,hn.borderRadiusState=sl(Ir,_e,On,er).styles.join(" "),Zt},dragControl:function(y,m){var E=m.datas,S=E.controlPoses;if(!E.isRound||!E.isControl||!S.length)return!1;var D=E.controlIndex,J=sc(m),ct=J[0],vt=J[1],It=[ct,vt],Bt=gi(It,E.prevDist),qt=y.props.maxRoundControls,Zt=qt===void 0?[4,4]:qt,Ht=y.state,be=Ht.width,_e=Ht.height,Ue=S[D],nn=Ue.vertical,hn=Ue.horizontal,On=S.map(function(Yn){var Ir=Yn.horizontal,Un=Yn.vertical,gr=[Ir*hn*It[0],Un*nn*It[1]];if(Ir){if(Zt[0]===1)return gr;if(Zt[0]<4&&Ir!==hn)return gr}else{if(Zt[1]===0)return gr[1]=Un*hn*It[0]/be*_e,gr;if(nn){if(Zt[1]===1)return gr;if(Zt[1]<4&&Un!==nn)return gr}}return[0,0]});On[D]=It;var er=S.map(function(Yn,Ir){return We(We({},Yn),{pos:bi(Yn.pos,On[Ir])})});return D<4?er.slice(0,D+1).forEach(function(Yn){Yn.virtual=!1}):er.slice(4,D+1).forEach(function(Yn){Yn.virtual=!1}),E.prevDist=[ct,vt],vr(y,m,It,Bt,er)},dragControlEnd:function(y,m){var E=y.state;E.borderRadiusState="";var S=m.datas,D=m.isDouble;if(!S.isRound)return!1;var J=S.isControl,ct=S.controlIndex,vt=S.isLine,It=S.lineIndex,Bt=S.controlPoses,qt=Bt.filter(function(hn){var On=hn.virtual;return On}).length,Zt=y.props.roundClickable,Ht=Zt===void 0?!0:Zt;if(D&&Ht){if(J&&(Ht===!0||Ht==="control"))Xr(Bt,ct);else if(vt&&(Ht===!0||Ht==="line")){var be=hp(y,m),_e=be[0],Ue=be[1];hr(Bt,It,_e,Ue)}qt!==Bt.filter(function(hn){var On=hn.virtual;return On}).length&&vr(y,m,[0,0],[0,0],Bt)}var nn=ec(y,m,{});return no(y,"onRoundEnd",nn),E.borderRadiusState="",nn},dragGroupControlStart:function(y,m){var E=this.dragControlStart(y,m);if(!E)return!1;var S=y.moveables,D=y.props.targets,J=wc(y,"roundable",m),ct=We({targets:y.props.targets,events:J.map(function(vt,It){return We(We({},vt),{target:D[It],moveable:S[It],currentTarget:S[It]})})},E);return no(y,"onRoundGroupStart",ct),E},dragGroupControl:function(y,m){var E=this.dragControl(y,m);if(!E)return!1;var S=y.moveables,D=y.props.targets,J=wc(y,"roundable",m),ct=We({targets:y.props.targets,events:J.map(function(vt,It){return We(We(We({},vt),{target:D[It],moveable:S[It],currentTarget:S[It]}),Al({borderRadius:E.borderRadius},vt))})},E);return no(y,"onRoundGroup",ct),ct},dragGroupControlEnd:function(y,m){var E=y.moveables,S=y.props.targets,D=wc(y,"roundable",m);ir(y,"onRound",function(vt){var It=We({targets:y.props.targets,events:D.map(function(Bt,qt){return We(We(We({},Bt),{target:S[qt],moveable:E[qt],currentTarget:E[qt]}),Al({borderRadius:vt.borderRadius},Bt))})},vt);no(y,"onRoundGroup",It)});var J=this.dragControlEnd(y,m);if(!J)return!1;var ct=We({targets:y.props.targets,events:D.map(function(vt,It){var Bt;return We(We({},vt),{target:S[It],moveable:E[It],currentTarget:E[It],lastEvent:(Bt=vt.datas)===null||Bt===void 0?void 0:Bt.lastEvent})})},J);return no(y,"onRoundGroupEnd",ct),ct},unset:function(y){y.state.borderRadiusState=""}};function fr(y,m){var E=m?4:3,S=Wi(E),D="matrix".concat(m?"3d":"","(").concat(S.join(","),")");return y===D||y==="matrix(1,0,0,1,0,0)"}var Sn={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(y,m){var E=y.state,S=E.is3d,D=E.target,J=E.targetMatrix,ct=D==null?void 0:D.style.transform,vt=S?"matrix3d(".concat(J.join(","),")"):"matrix(".concat(Do(J,!0),")"),It=!ct||ct==="none"?vt:ct;m.datas.startTransforms=fr(It,S)?[]:Da(It)},resetStyle:function(y){var m=y.datas;m.nextStyle={},m.nextTransforms=y.datas.startTransforms,m.nextTransformAppendedIndexes=[]},fillDragStartParams:function(y,m){return ps(y,m,{setTransform:function(E){m.datas.startTransforms=Rt(E)?E:Da(E)},isPinch:!!m.isPinch})},fillDragParams:function(y,m){return ps(y,m,{isPinch:!!m.isPinch})},dragStart:function(y,m){this.setTransform(y,m),this.resetStyle(m),no(y,"onBeforeRenderStart",this.fillDragStartParams(y,m))},drag:function(y,m){this.resetStyle(m),no(y,"onBeforeRender",ps(y,m,{isPinch:!!m.isPinch}))},dragEnd:function(y,m){no(y,"onBeforeRenderEnd",ps(y,m,{isPinch:!!m.isPinch,isDrag:m.isDrag}))},dragGroupStart:function(y,m){var E=this;this.dragStart(y,m);var S=wc(y,"beforeRenderable",m),D=y.moveables,J=S.map(function(ct,vt){var It=D[vt];return E.setTransform(It,ct),E.resetStyle(ct),E.fillDragStartParams(It,ct)});no(y,"onBeforeRenderGroupStart",ps(y,m,{isPinch:!!m.isPinch,targets:y.props.targets,setTransform:function(){},events:J}))},dragGroup:function(y,m){var E=this;this.drag(y,m);var S=wc(y,"beforeRenderable",m),D=y.moveables,J=S.map(function(ct,vt){var It=D[vt];return E.resetStyle(ct),E.fillDragParams(It,ct)});no(y,"onBeforeRenderGroup",ps(y,m,{isPinch:!!m.isPinch,targets:y.props.targets,events:J}))},dragGroupEnd:function(y,m){this.dragEnd(y,m),no(y,"onBeforeRenderGroupEnd",ps(y,m,{isPinch:!!m.isPinch,isDrag:m.isDrag,targets:y.props.targets}))},dragControlStart:function(y,m){return this.dragStart(y,m)},dragControl:function(y,m){return this.drag(y,m)},dragControlEnd:function(y,m){return this.dragEnd(y,m)},dragGroupControlStart:function(y,m){return this.dragGroupStart(y,m)},dragGroupControl:function(y,m){return this.dragGroup(y,m)},dragGroupControlEnd:function(y,m){return this.dragGroupEnd(y,m)}},Or={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(y,m){no(y,"onRenderStart",ps(y,m,{isPinch:!!m.isPinch}))},drag:function(y,m){no(y,"onRender",this.fillDragParams(y,m))},dragAfter:function(y,m){return this.drag(y,m)},dragEnd:function(y,m){no(y,"onRenderEnd",this.fillDragEndParams(y,m))},dragGroupStart:function(y,m){no(y,"onRenderGroupStart",ps(y,m,{isPinch:!!m.isPinch,targets:y.props.targets}))},dragGroup:function(y,m){var E=this,S=wc(y,"beforeRenderable",m),D=y.moveables,J=S.map(function(ct,vt){var It=D[vt];return E.fillDragParams(It,ct)});no(y,"onRenderGroup",ps(y,m,We(We({isPinch:!!m.isPinch,targets:y.props.targets,transform:Nn(m)},Al(Pa(m))),{events:J})))},dragGroupEnd:function(y,m){var E=this,S=wc(y,"beforeRenderable",m),D=y.moveables,J=S.map(function(ct,vt){var It=D[vt];return E.fillDragEndParams(It,ct)});no(y,"onRenderGroupEnd",ps(y,m,We({isPinch:!!m.isPinch,isDrag:m.isDrag,targets:y.props.targets,events:J,transform:Nn(m)},Al(Pa(m)))))},dragControlStart:function(y,m){return this.dragStart(y,m)},dragControl:function(y,m){return this.drag(y,m)},dragControlAfter:function(y,m){return this.dragAfter(y,m)},dragControlEnd:function(y,m){return this.dragEnd(y,m)},dragGroupControlStart:function(y,m){return this.dragGroupStart(y,m)},dragGroupControl:function(y,m){return this.dragGroup(y,m)},dragGroupControlEnd:function(y,m){return this.dragGroupEnd(y,m)},fillDragParams:function(y,m){return ps(y,m,We({isPinch:!!m.isPinch,transform:Nn(m)},Al(Pa(m))))},fillDragEndParams:function(y,m){return ps(y,m,We({isPinch:!!m.isPinch,isDrag:m.isDrag,transform:Nn(m)},Al(Pa(m))))}};function Zr(y,m,E,S,D,J,ct){J.clientDistX=J.distX,J.clientDistY=J.distY;var vt=D==="Start",It=D==="End",Bt=D==="After",qt=y.state.target,Zt=J.isRequest;if(!qt||vt&&S.indexOf("Control")>-1&&!Zt&&y.areaElement===J.inputEvent.target)return!1;var Ht=_r([],y[m],!0);if(Zt){var be=J.requestAble;Ht.some(function(Tr){return Tr.name===be})||Ht.push.apply(Ht,y.props.ables.filter(function(Tr){return Tr.name===be}))}if(!Ht.length||Ht.every(function(Tr){return Tr.dragRelation}))return!1;var _e=J.inputEvent,Ue;It&&_e&&(Ue=document.elementFromPoint(J.clientX,J.clientY)||_e.target);var nn=!1,hn=function(){var Tr;nn=!0,(Tr=J.stop)===null||Tr===void 0||Tr.call(J)},On=vt&&(!y.targetGesto||!y.controlGesto||!y.targetGesto.isFlag()||!y.controlGesto.isFlag());On&&y.updateRect(D,!0,!1);var er=J.datas,Yn=function(Tr,sa,Gr){if(!(sa in Tr))return!1;var va=Tr.name,la=er[va]||(er[va]={});if(vt&&(la.isEventStart=!Gr||!Tr[Gr]||Tr[Gr](y,J)),!la.isEventStart)return!1;var ka=Tr[sa](y,We(We({},J),{stop:hn,datas:la,originalDatas:er,inputTarget:Ue}));return y._emitter.off(),vt&&ka===!1&&(la.isEventStart=!1),ka};On&&Ht.forEach(function(Tr){Tr.unset&&Tr.unset(y)}),Yn(Sn,"drag".concat(S).concat(D));var Ir=0,Un=0;E.forEach(function(Tr){if(nn)return!1;var sa="".concat(Tr).concat(S).concat(D),Gr="".concat(Tr).concat(S,"Condition");D===""&&!Zt&&yp(y.state,J);var va=Ht.filter(function(ri){return ri[sa]});va=va.filter(function(ri,Li){return ri.name&&va.indexOf(ri)===Li});var la=va.filter(function(ri){return Yn(ri,sa,Gr)}),ka=la.length;nn&&++Ir,ka&&++Un,!nn&&vt&&va.length&&!ka&&(Ir+=va.filter(function(ri){var Li=ri.name,to=er[Li];return to.isEventStart?ri.dragRelation!=="strong":!1}).length?1:0)}),(!Bt||Un)&&Yn(Or,"drag".concat(S).concat(D));var gr=Ir===E.length;if((It||nn||gr)&&(y.state.gestos={},y.moveables&&y.moveables.forEach(function(Tr){Tr.state.gestos={}}),Ht.forEach(function(Tr){Tr.unset&&Tr.unset(y)})),vt&&!gr&&!Zt&&Un&&y.props.preventDefault&&(J==null||J.preventDefault()),y.isUnmounted||gr)return!1;if(!vt&&Un&&!ct||It){var Br=y.props.flushSync||Hf;Br(function(){y.updateRect(It?D:"",!0,!1),y.forceUpdate()})}return!vt&&!It&&!Bt&&Un&&!ct&&Zr(y,m,E,S,D+"After",J),!0}function wa(y){return function(m){var E=y.props.dragTarget,S=m.inputEvent.target,D=y.areaElement;return E&&(S===E||E.contains(S))||S===D||!y.isMoveableElement(S)&&!y.controlBox.contains(S)||da(S,"moveable-area")||da(S,"moveable-padding")||da(S,"moveable-edgeDraggable")}}function Na(y,m,E){var S=y.controlBox,D=[],J=y.props.dragTarget;return D.push(S),(!y.props.dragArea||J)&&D.push(m),ga(y,D,"targetAbles",E,{dragStart:wa(y),pinchStart:wa(y)})}function ga(y,m,E,S,D){D===void 0&&(D={});var J=E==="targetAbles",ct=y.props,vt=ct.pinchOutside,It=ct.pinchThreshold,Bt=ct.preventClickEventOnDrag,qt=ct.preventClickDefault,Zt=ct.checkInput,Ht=ct.preventDefault,be=Ht===void 0?!0:Ht,_e={preventDefault:be,preventRightClick:!0,preventWheelClick:!0,container:window,pinchThreshold:It,pinchOutside:vt,preventClickEventOnDrag:J?Bt:!1,preventClickEventOnDragStart:J?qt:!1,preventClickEventByCondition:J?null:function(hn){return y.controlBox.contains(hn.target)},checkInput:J?Zt:!1},Ue=new xl(m,_e),nn=S==="Control";return["drag","pinch"].forEach(function(hn){["Start","","End"].forEach(function(On){Ue.on("".concat(hn).concat(On),function(er){var Yn,Ir=er.eventType,Un=hn==="drag"&&er.isPinch;if(D[Ir]&&!D[Ir](er)){er.stop();return}if(!Un){var gr=hn==="drag"?[hn]:["drag",hn],Br=Zr(y,E,gr,S,On,er);Br?(y.props.stopPropagation||On==="Start"&&nn)&&((Yn=er==null?void 0:er.inputEvent)===null||Yn===void 0||Yn.stopPropagation()):er.stop()}})})}),Ue}var ai=function(){function y(E,S,D){var J=this;this.target=E,this.moveable=S,this.eventName=D,this.ables=[],this._onEvent=function(ct){var vt=J.eventName,It=J.moveable;It.state.disableNativeEvent||J.ables.forEach(function(Bt){Bt[vt](It,{inputEvent:ct})})},E.addEventListener(D.toLowerCase(),this._onEvent)}var m=y.prototype;return m.setAbles=function(E){this.ables=E},m.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},y}();function lo(y,m,E,S){var D;E===void 0&&(E=m);var J=eo(y,m),ct=J.matrixes,vt=J.is3d,It=J.targetMatrix,Bt=J.transformOrigin,qt=J.targetOrigin,Zt=J.offsetContainer,Ht=J.hasFixed,be=J.zoom,_e=Ou(Zt,E),Ue=_e.matrixes,nn=_e.is3d,hn=_e.offsetContainer,On=_e.zoom,er=S||nn||vt,Yn=er?4:3,Ir=y.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in y,Un=It,gr=Wi(Yn),Br=Wi(Yn),Tr=Wi(Yn),sa=Wi(Yn),Gr=ct.length,va=_r([],Ue,!0).reverse();ct.reverse(),!vt&&er&&(Un=es(Un,3,4),Yf(ct)),!nn&&er&&Yf(va),va.forEach(function(Ii){Br=Zi(Br,Ii.matrix,Yn)});var la=E||document.body,ka=((D=va[0])===null||D===void 0?void 0:D.target)||Yc(la,la,!0).offsetParent,ri=va.slice(1).reduce(function(Ii,Ja){return Zi(Ii,Ja.matrix,Yn)},Wi(Yn));ct.forEach(function(Ii,Ja){if(Gr-2===Ja&&(Tr=gr.slice()),Gr-1===Ja&&(sa=gr.slice()),!Ii.matrix){var oo=ct[Ja+1],Po=Ac(Ii,oo,ka,Yn,Zi(ri,gr,Yn));Ii.matrix=is(Po,Yn)}gr=Zi(gr,Ii.matrix,Yn)});var Li=!Ir&&vt;Un||(Un=Wi(Li?4:3));var to=Tc(Ir&&Un.length===16?es(Un,4,3):Un,Li),fi=Br;return Br=La(Br,Yn,Yn),{hasZoom:be!==1||On!==1,hasFixed:Ht,rootMatrix:Br,originalRootMatrix:fi,beforeMatrix:Tr,offsetMatrix:sa,allMatrix:gr,targetMatrix:Un,targetTransform:to,transformOrigin:Bt,targetOrigin:qt,is3d:er,offsetContainer:Zt,offsetRootContainer:hn}}function cs(y,m,E,S){E===void 0&&(E=m);var D=0,J=0,ct=0,vt={},It=vp(y);if(y&&(D=It.offsetWidth,J=It.offsetHeight),y){var Bt=lo(y,m,E,S),qt=Bf(Bt.allMatrix,Bt.transformOrigin,D,J);vt=We(We({},Bt),qt);var Zt=Bf(Bt.allMatrix,[50,50],100,100);ct=gp([Zt.pos1,Zt.pos2],Zt.direction)}var Ht=S?4:3;return We(We(We({hasZoom:!1,width:D,height:J,rotation:ct},It),{originalRootMatrix:Wi(Ht),rootMatrix:Wi(Ht),beforeMatrix:Wi(Ht),offsetMatrix:Wi(Ht),allMatrix:Wi(Ht),targetMatrix:Wi(Ht),targetTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!S,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null}),vt)}function Qi(y,m,E){return E===void 0&&(E=m),cs(y,m,E,!0)}function Io(y,m,E,S,D,J){J===void 0&&(J=[]);var ct=1,vt=[0,0],It=fd(),Bt=fd(),qt=fd(),Zt=fd(),Ht=[0,0],be={},_e=cs(m,E,D,!0);if(m){var Ue=lr(m);J.forEach(function(va){be[va]=Ue(va)});var nn=_e.is3d?4:3,hn=Bf(_e.offsetMatrix,bi(_e.transformOrigin,Ki(_e.targetMatrix,nn)),_e.width,_e.height);ct=hn.direction,vt=bi(hn.origin,[hn.left-_e.left,hn.top-_e.top]),Zt=Zf(_e.offsetRootContainer);var On=Yc(S,S,!0).offsetParent||_e.offsetRootContainer;if(_e.hasZoom){var er=Bf(Zi(_e.originalRootMatrix,_e.allMatrix),_e.transformOrigin,_e.width,_e.height),Yn=Bf(_e.originalRootMatrix,Xf(lr(On)("transformOrigin")).map(function(va){return parseFloat(va)}),On.offsetWidth,On.offsetHeight);if(It=mp(er,Zt),qt=mp(Yn,Zt,On,!0),y){var Ir=er.left,Un=er.top;Bt=mp({left:Ir,top:Un,bottom:Un,right:Un},Zt)}}else{It=Zf(m),qt=ks(On),y&&(Bt=Zf(y));var gr=qt.left,Br=qt.top,Tr=qt.clientLeft,sa=qt.clientTop,Gr=[It.left-gr,It.top-Br];Ht=gi(Uh(_e.rootMatrix,Gr,4),[Tr+_e.left,sa+_e.top])}}return We({targetClientRect:It,containerClientRect:qt,moveableClientRect:Bt,rootContainerClientRect:Zt,beforeDirection:ct,beforeOrigin:vt,originalBeforeOrigin:vt,target:m,style:be,offsetDelta:Ht},_e)}function Mo(y){var m=y.pos1,E=y.pos2,S=y.pos3,D=y.pos4;if(!m||!E||!S||!D)return null;var J=oc([m,E,S,D]),ct=[J.minX,J.minY],vt=gi(y.origin,ct);return m=gi(m,ct),E=gi(E,ct),S=gi(S,ct),D=gi(D,ct),We(We({},y),{left:y.left,top:y.top,posDelta:ct,pos1:m,pos2:E,pos3:S,pos4:D,origin:vt,beforeOrigin:vt,isPersisted:!0})}var Os=function(y){rr(m,y);function m(){var S=y!==null&&y.apply(this,arguments)||this;return S.state=We({container:null,gestos:{},renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},Io(null)),S.renderState={},S.enabledAbles=[],S.targetAbles=[],S.controlAbles=[],S.rotation=0,S.scale=[1,1],S.isMoveableMounted=!1,S.isUnmounted=!1,S.events={mouseEnter:null,mouseLeave:null},S._emitter=new ul,S._prevTarget=null,S._prevDragArea=!1,S._isPropTargetChanged=!1,S._hasFirstTarget=!1,S._reiszeObserver=null,S._observerId=0,S._mutationObserver=null,S._rootContainer=null,S._viewContainer=null,S._viewClassNames=[],S._store={},S.checkUpdateRect=function(){if(!S.isDragging()){var D=S.props.parentMoveable;if(D){D.checkUpdateRect();return}qr(S._observerId),S._observerId=pr(function(){S.isDragging()||S.updateRect()})}},S._onPreventClick=function(D){D.stopPropagation(),D.preventDefault()},S}var E=m.prototype;return E.render=function(){var S=this.props,D=this.getState(),J=S.parentPosition,ct=S.className,vt=S.target,It=S.zoom,Bt=S.cspNonce,qt=S.translateZ,Zt=S.cssStyled,Ht=S.groupable,be=S.linePadding,_e=S.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var Ue=J||[0,0],nn=Ue[0],hn=Ue[1],On=D.left,er=D.top,Yn=D.target,Ir=D.direction,Un=D.hasFixed,gr=D.offsetDelta,Br=S.targets,Tr=this.isDragging(),sa={};this.getEnabledAbles().forEach(function(Li){sa["data-able-".concat(Li.name.toLowerCase())]=!0});var Gr=this._getAbleClassName(),va=Br&&Br.length&&(Yn||Ht)||vt||!this._hasFirstTarget&&this.state.isPersisted,la=this.controlBox||this.props.firstRenderState||this.props.persistData,ka=[On-nn,er-hn];!Ht&&S.useAccuratePosition&&(ka[0]+=gr[0],ka[1]+=gr[1]);var ri={position:Un?"fixed":"absolute",display:va?"block":"none",visibility:la?"visible":"hidden",transform:"translate3d(".concat(ka[0],"px, ").concat(ka[1],"px, ").concat(qt,")"),"--zoom":It,"--zoompx":"".concat(It,"px")};return be&&(ri["--moveable-line-padding"]=be),_e&&(ri["--moveable-control-padding"]=_e),Ta.createElement(Zt,We({cspNonce:Bt,ref:wt(this,"controlBox"),className:"".concat(mo("control-box",Ir===-1?"reverse":"",Tr?"dragging":"")," ").concat(Gr," ").concat(ct)},sa,{onClick:this._onPreventClick,style:ri}),this.renderAbles(),this._renderLines())},E.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var S=this.props,D=S.parentMoveable,J=S.container,ct=S.wrapperMoveable;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!J&&!D&&!ct&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},E.componentDidUpdate=function(S){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateEvents(),this._updateTargets(),this.updateCheckInput(),this._updateObserver(S)},E.componentWillUnmount=function(){var S,D;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(S=this._reiszeObserver)===null||S===void 0||S.disconnect(),(D=this._mutationObserver)===null||D===void 0||D.disconnect();var J=this._viewContainer;J&&this._changeAbleViewClassNames([]),ml(this,"targetGesto"),ml(this,"controlGesto");var ct=this.events;for(var vt in ct){var It=ct[vt];It&&It.destroy()}},E.getTargets=function(){var S=this.props.target;return S?[S]:[]},E.getAble=function(S){var D=this.props.ables||[];return Sr(D,function(J){return J.name===S})},E.getContainer=function(){var S=this.props,D=S.parentMoveable,J=S.wrapperMoveable,ct=S.container;return ct||J&&J.getContainer()||D&&D.getContainer()||this.controlBox.parentElement},E.isMoveableElement=function(S){var D;return S&&(((D=S.getAttribute)===null||D===void 0?void 0:D.call(S,"class"))||"").indexOf(ds)>-1},E.dragStart=function(S){var D=this.targetGesto,J=this.controlGesto;return D&&wa(this)({inputEvent:S})?D.isFlag()||D.triggerDragStart(S):J&&this.isMoveableElement(S.target)&&(J.isFlag()||J.triggerDragStart(S)),this},E.hitTest=function(S){var D=this.state,J=D.target,ct=D.pos1,vt=D.pos2,It=D.pos3,Bt=D.pos4,qt=D.targetClientRect;if(!J)return 0;var Zt;if(S instanceof Element){var Ht=S.getBoundingClientRect();Zt={left:Ht.left,top:Ht.top,width:Ht.width,height:Ht.height}}else Zt=We({width:0,height:0},S);var be=Zt.left,_e=Zt.top,Ue=Zt.width,nn=Zt.height,hn=el([ct,vt,Bt,It],qt),On=ra(hn,[[be,_e],[be+Ue,_e],[be+Ue,_e+nn],[be,_e+nn]]),er=Ls(hn);return!On||!er?0:Math.min(100,On/er*100)},E.isInside=function(S,D){var J=this.state,ct=J.target,vt=J.pos1,It=J.pos2,Bt=J.pos3,qt=J.pos4,Zt=J.targetClientRect;return ct?Ol([S,D],el([vt,It,qt,Bt],Zt)):!1},E.updateRect=function(S,D,J){J===void 0&&(J=!0);var ct=this.props,vt=!ct.parentPosition&&!ct.wrapperMoveable;vt&&ls(!0);var It=ct.parentMoveable,Bt=this.state,qt=Bt.target||ct.target,Zt=this.getContainer(),Ht=It?It._rootContainer:this._rootContainer,be=Io(this.controlBox,qt,Zt,Zt,Ht||Zt,this._getRequestStyles());if(!qt&&this._hasFirstTarget&&ct.persistData){var _e=Mo(ct.persistData);for(var Ue in _e)be[Ue]=_e[Ue]}vt&&ls(),this.updateState(be,It?!1:J)},E.isDragging=function(S){var D,J,ct=this.targetGesto,vt=this.controlGesto;if(ct==null?void 0:ct.isFlag()){if(!S)return!0;var It=ct.getEventData();return!!((D=It[S])===null||D===void 0?void 0:D.isEventStart)}if(vt==null?void 0:vt.isFlag()){if(!S)return!0;var It=vt.getEventData();return!!((J=It[S])===null||J===void 0?void 0:J.isEventStart)}return!1},E.updateTarget=function(S){this.updateRect(S,!0)},E.getRect=function(){var S=this.state,D=uc(this.state),J=D[0],ct=D[1],vt=D[2],It=D[3],Bt=tc(D),qt=S.width,Zt=S.height,Ht=Bt.width,be=Bt.height,_e=Bt.left,Ue=Bt.top,nn=[S.left,S.top],hn=bi(nn,S.origin),On=bi(nn,S.beforeOrigin),er=S.transformOrigin;return{width:Ht,height:be,left:_e,top:Ue,pos1:J,pos2:ct,pos3:vt,pos4:It,offsetWidth:qt,offsetHeight:Zt,beforeOrigin:On,origin:hn,transformOrigin:er,rotation:this.getRotation()}},E.getManager=function(){return this},E.stopDrag=function(S){var D,J;(!S||S==="target")&&((D=this.targetGesto)===null||D===void 0||D.stop()),(!S||S==="control")&&((J=this.controlGesto)===null||J===void 0||J.stop())},E.getRotation=function(){var S=this.state,D=S.pos1,J=S.pos2,ct=S.direction;return lc(D,J,ct)},E.request=function(S,D,J){D===void 0&&(D={});var ct=this.props,vt=ct.ables,It=ct.groupable,Bt=vt.filter(function(nn){return nn.name===S})[0];if(this.isDragging()||!Bt||!Bt.request)return{request:function(){return this},requestEnd:function(){return this}};var qt=this,Zt=Bt.request(this),Ht=J||D.isInstant,be=Zt.isControl?"controlAbles":"targetAbles",_e="".concat(It?"Group":"").concat(Zt.isControl?"Control":""),Ue={request:function(nn){return Zr(qt,be,["drag"],_e,"",We(We({},Zt.request(nn)),{requestAble:S,isRequest:!0}),Ht),this},requestEnd:function(){return Zr(qt,be,["drag"],_e,"End",We(We({},Zt.requestEnd()),{requestAble:S,isRequest:!0}),Ht),this}};return Zr(qt,be,["drag"],_e,"Start",We(We({},Zt.requestStart(D)),{requestAble:S,isRequest:!0}),Ht),Ht?Ue.request(D).requestEnd():Ue},E.destroy=function(){this.componentWillUnmount()},E.updateRenderPoses=function(){var S=this.getState(),D=this.props,J=S.originalBeforeOrigin,ct=S.transformOrigin,vt=S.allMatrix,It=S.is3d,Bt=S.pos1,qt=S.pos2,Zt=S.pos3,Ht=S.pos4,be=S.left,_e=S.top,Ue=S.isPersisted,nn=D.padding||{},hn=nn.left,On=hn===void 0?0:hn,er=nn.top,Yn=er===void 0?0:er,Ir=nn.bottom,Un=Ir===void 0?0:Ir,gr=nn.right,Br=gr===void 0?0:gr,Tr=It?4:3,sa=[];Ue?sa=ct:this.controlBox&&D.groupable?sa=J:sa=bi(J,[be,_e]),S.renderPoses=[bi(Bt,Ml(vt,[-On,-Yn],ct,sa,Tr)),bi(qt,Ml(vt,[Br,-Yn],ct,sa,Tr)),bi(Zt,Ml(vt,[-On,Un],ct,sa,Tr)),bi(Ht,Ml(vt,[Br,Un],ct,sa,Tr))]},E.checkUpdate=function(){this._isPropTargetChanged=!1;var S=this.props,D=S.target,J=S.container,ct=S.parentMoveable,vt=this.state,It=vt.target,Bt=vt.container;if(!(!It&&!D)){this.updateAbles();var qt=!Xp(It,D),Zt=qt||!Xp(Bt,J);if(!!Zt){var Ht=J||this.controlBox;Ht&&this.unsetAbles(),this.updateState({target:D,container:J}),!ct&&Ht&&this.updateRect("End",!1,!1),this._isPropTargetChanged=qt}}},E.waitToChangeTarget=function(){return new Promise(function(){})},E.triggerEvent=function(S,D){this._emitter.trigger(S,D);var J=this.props[S];return J&&J(D)},E.useCSS=function(S,D){var J=this.props.customStyledMap,ct=S+D;return J[ct]||(J[ct]=an(S,D)),J[ct]},E.getState=function(){var S,D=this.props;(D.target||((S=D.targets)===null||S===void 0?void 0:S.length))&&(this._hasFirstTarget=!0);var J=this.controlBox,ct=D.persistData,vt=D.firstRenderState;if(vt&&!J)return vt;if(!this._hasFirstTarget&&ct){var It=Mo(ct);if(It)return this.updateState(It,!1),this.state}return this.state.isPersisted=!1,this.state},E.updateSelectors=function(){},E.unsetAbles=function(){var S=this;this.targetAbles.forEach(function(D){D.unset&&D.unset(S)})},E.updateAbles=function(S,D){S===void 0&&(S=this.props.ables),D===void 0&&(D="");var J=this.props,ct=J.triggerAblesSimultaneously,vt=this.getEnabledAbles(S),It="drag".concat(D,"Start"),Bt="pinch".concat(D,"Start"),qt="drag".concat(D,"ControlStart"),Zt=$h(vt,[It,Bt],ct),Ht=$h(vt,[qt],ct);this.enabledAbles=vt,this.targetAbles=Zt,this.controlAbles=Ht},E.updateState=function(S,D){if(D){if(this.isUnmounted)return;this.setState(S)}else{var J=this.state;for(var ct in S)J[ct]=S[ct]}},E.getEnabledAbles=function(S){S===void 0&&(S=this.props.ables);var D=this.props;return S.filter(function(J){return J&&(J.always&&D[J.name]!==!1||D[J.name])})},E.renderAbles=function(){var S=this,D=this.props,J=D.triggerAblesSimultaneously,ct={createElement:Ta.createElement};return this.renderState={},Od(Gh($h(this.getEnabledAbles(),["render"],J).map(function(vt){var It=vt.render;return It(S,ct)||[]})).filter(function(vt){return vt}),function(vt){var It=vt.key;return It}).map(function(vt){return vt[0]})},E.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},E._getRequestStyles=function(){var S=this.getEnabledAbles().reduce(function(D,J){var ct,vt,It=(vt=(ct=J.requestStyle)===null||ct===void 0?void 0:ct.call(J))!==null&&vt!==void 0?vt:[];return _r(_r([],D,!0),It,!0)},_r([],this.props.requestStyles||[],!0));return S},E._updateObserver=function(S){this._updateResizeObserver(S),this._updateMutationObserver(S)},E._updateEvents=function(){var S=this.controlBox,D=this.targetAbles.length,J=this.controlAbles.length,ct=this.props,vt=ct.dragTarget||ct.target,It=!D&&this.targetGesto||this._isTargetChanged(!0);It&&(ml(this,"targetGesto"),this.updateState({gesto:null})),J||ml(this,"controlGesto"),vt&&D&&!this.targetGesto&&(this.targetGesto=Na(this,vt,"")),!this.controlGesto&&J&&(this.controlGesto=ga(this,S,"controlAbles","Control"))},E._updateTargets=function(){var S=this.props;this._prevTarget=S.dragTarget||S.target,this._prevDragArea=S.dragArea},E._renderLines=function(){var S=this.props,D=S,J=D.zoom,ct=D.hideDefaultLines,vt=D.hideChildMoveableDefaultLines,It=D.parentMoveable;if(ct||It&&vt)return[];var Bt=this.getState().renderPoses,qt={createElement:Ta.createElement};return[[0,1],[1,3],[3,2],[2,0]].map(function(Zt,Ht){var be=Zt[0],_e=Zt[1];return ea(qt,"",Bt[be],Bt[_e],J,"render-line-".concat(Ht))})},E._isTargetChanged=function(S){var D=this.props,J=D.dragTarget||D.target,ct=this._prevTarget,vt=this._prevDragArea,It=D.dragArea,Bt=!It&&ct!==J,qt=(S||It)&&vt!==It;return Bt||qt},E._updateNativeEvents=function(){var S=this,D=this.props,J=D.dragArea?this.areaElement:this.state.target,ct=this.events,vt=ua(ct);if(this._isTargetChanged())for(var It in ct){var Bt=ct[It];Bt&&Bt.destroy(),ct[It]=null}if(!!J){var qt=this.enabledAbles;vt.forEach(function(Zt){var Ht=$h(qt,[Zt]),be=Ht.length>0,_e=ct[Zt];if(!be){_e&&(_e.destroy(),ct[Zt]=null);return}_e||(_e=new ai(J,S,Zt),ct[Zt]=_e),_e.setAbles(Ht)})}},E._checkUpdateRootContainer=function(){var S=this.props.rootContainer;!this._rootContainer&&S&&(this._rootContainer=Kc(S,!0))},E._checkUpdateViewContainer=function(){var S=this.props.viewContainer;!this._viewContainer&&S&&(this._viewContainer=Kc(S,!0));var D=this._viewContainer;D&&this._changeAbleViewClassNames(_r(_r([],this._getAbleViewClassNames(),!0),[this.isDragging()?si:""],!1))},E._changeAbleViewClassNames=function(S){var D=this._viewContainer,J=qf(S.filter(Boolean),function(qt){return qt}).map(function(qt){var Zt=qt[0];return Zt}),ct=this._viewClassNames,vt=Vi(ct,J),It=vt.removed,Bt=vt.added;It.forEach(function(qt){ki(D,ct[qt])}),Bt.forEach(function(qt){Ti(D,J[qt])}),this._viewClassNames=J},E._getAbleViewClassNames=function(){var S=this;return(this.getEnabledAbles().map(function(D){var J;return((J=D.viewClassName)===null||J===void 0?void 0:J.call(D,S))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},E._getAbleClassName=function(S){var D=this;S===void 0&&(S="");var J=this.getEnabledAbles(),ct=this.targetGesto,vt=this.controlGesto,It=(ct==null?void 0:ct.isFlag())?ct.getEventData():{},Bt=(vt==null?void 0:vt.isFlag())?vt.getEventData():{};return J.map(function(qt){var Zt,Ht,be,_e=qt.name,Ue=((Zt=qt.className)===null||Zt===void 0?void 0:Zt.call(qt,D))||"";return(((Ht=It[_e])===null||Ht===void 0?void 0:Ht.isEventStart)||((be=Bt[_e])===null||be===void 0?void 0:be.isEventStart))&&(Ue+=" ".concat(mo("".concat(_e).concat(S,"-dragging")))),Ue.trim()}).filter(Boolean).join(" ")},E._updateResizeObserver=function(S){var D,J=this.props,ct=J.target;if(!window.ResizeObserver||!ct||!J.useResizeObserver){(D=this._reiszeObserver)===null||D===void 0||D.disconnect();return}if(!(S.target===ct&&this._reiszeObserver)){var vt=new ResizeObserver(this.checkUpdateRect);vt.observe(ct,{box:"border-box"}),this._reiszeObserver=vt}},E._updateMutationObserver=function(S){var D=this,J,ct=this.props,vt=ct.target;if(!window.MutationObserver||!vt||!ct.useMutationObserver){(J=this._mutationObserver)===null||J===void 0||J.disconnect();return}if(!(S.target===vt&&this._mutationObserver)){var It=new MutationObserver(function(Bt){for(var qt=0,Zt=Bt;qt<Zt.length;qt++){var Ht=Zt[qt];Ht.type==="attributes"&&Ht.attributeName==="style"&&D.checkUpdateRect()}});It.observe(vt,{attributes:!0}),this._mutationObserver=It}},m.defaultProps={target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Hf,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},m}(Ta.PureComponent),yl={name:"groupable",props:["defaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(y,m){var E,S=y.props,D=S.targets||[],J=y.getState(),ct=J.left,vt=J.top,It=J.isPersisted,Bt=S.zoom||1,qt=y.renderGroupRects,Zt=((E=S.persistData)===null||E===void 0?void 0:E.children)||[];It?D=Zt.map(function(){return null}):Zt=[];var Ht=y._store,be=bh(Ht,"parentPosition",[ct,vt],function(Ue){return Ue.join(",")}),_e=bh(Ht,"requestStyles",y.getRequestChildStyles(),function(Ue){return Ue.join(",")});return y.moveables=y.moveables.slice(0,D.length),_r(_r([],D.map(function(Ue,nn){return m.createElement(Os,{key:"moveable"+nn,ref:ut(y,"moveables",nn),target:Ue,origin:!1,requestStyles:_e,cssStyled:S.cssStyled,customStyledMap:S.customStyledMap,useResizeObserver:S.useResizeObserver,hideChildMoveableDefaultLines:S.hideChildMoveableDefaultLines,parentMoveable:y,parentPosition:[ct,vt],persistData:Zt[nn],zoom:Bt})}),!0),Gh(qt.map(function(Ue,nn){var hn=Ue.pos1,On=Ue.pos2,er=Ue.pos3,Yn=Ue.pos4,Ir=[hn,On,er,Yn];return[[0,1],[1,3],[3,2],[2,0]].map(function(Un,gr){var Br=Un[0],Tr=Un[1];return ea(m,"",gi(Ir[Br],be),gi(Ir[Tr],be),Bt,"group-rect-".concat(nn,"-").concat(gr))})})),!0)}},sf=Va("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(y,m){m.datas.inputTarget=m.inputEvent&&m.inputEvent.target},dragEnd:function(y,m){var E=y.props.target,S=m.inputEvent,D=m.inputTarget,J=y.isMoveableElement(D),ct=!J&&y.controlBox.contains(D);if(!(!S||!D||m.isDrag||y.isMoveableElement(D)||ct)){var vt=E.contains(D);no(y,"onClick",ps(y,m,{isDouble:m.isDouble,inputTarget:D,isTarget:E===D,moveableTarget:y.props.target,containsTarget:vt}))}},dragGroupEnd:function(y,m){var E=m.inputEvent,S=m.inputTarget;if(!(!E||!S||m.isDrag||y.isMoveableElement(S)||m.datas.inputTarget===S)){var D=y.props.targets,J=D.indexOf(S),ct=J>-1,vt=!1;J===-1&&(J=Yr(D,function(It){return It.contains(S)}),vt=J>-1),no(y,"onClickGroup",ps(y,m,{isDouble:m.isDouble,targets:D,inputTarget:S,targetIndex:J,isTarget:ct,containsTarget:vt,moveableTarget:D[J]}))}},dragControlEnd:function(y,m){this.dragEnd(y,m)},dragGroupControlEnd:function(y,m){this.dragEnd(y,m)}});function Ih(y){var m=y.originalDatas.draggable;return m||(y.originalDatas.draggable={},m=y.originalDatas.draggable),We(We({},y),{datas:m})}var ah=Va("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(y,m){var E=y.props,S=E.edgeDraggable;return S?Ha(m,"edgeDraggable",S,y.getState().renderPoses,E.zoom):[]},dragCondition:function(y,m){var E,S=y.props,D=(E=m.inputEvent)===null||E===void 0?void 0:E.target;return!S.edgeDraggable||!D?!1:!S.draggable&&da(D,mo("direction"))&&da(D,mo("edge"))&&da(D,mo("edgeDraggable"))},dragStart:function(y,m){return M.dragStart(y,Ih(m))},drag:function(y,m){return M.drag(y,Ih(m))},dragEnd:function(y,m){return M.dragEnd(y,Ih(m))},dragGroupCondition:function(y,m){var E,S=y.props,D=(E=m.inputEvent)===null||E===void 0?void 0:E.target;return!S.edgeDraggable||!D?!1:!S.draggable&&da(D,mo("direction"))&&da(D,mo("line"))},dragGroupStart:function(y,m){return M.dragGroupStart(y,Ih(m))},dragGroup:function(y,m){return M.dragGroup(y,Ih(m))},dragGroupEnd:function(y,m){return M.dragGroupEnd(y,Ih(m))},unset:function(y){return M.unset(y)}}),Lv={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},Nf=[Sn,jo,ia,rf,M,ah,dt,jn,Fr,gn,Xu,Fl,Yo,sn,An,kn,yl,Lv,sf,_i,Or],mf=null,Hd=null;function kc(y,m){var E=y[0],S=y[1],D=y[2];return(E*m[0]+S*m[1]+D)/Math.sqrt(E*E+S*S)}function Th(y,m){var E=y[0],S=y[1];return-E*m[0]-S*m[1]}function G0(y,m){return Math.max.apply(Math,y.map(function(E){var S=E[0],D=E[1],J=E[2],ct=E[3];return Math.max(S[m],D[m],J[m],ct[m])}))}function Gm(y,m){return Math.min.apply(Math,y.map(function(E){var S=E[0],D=E[1],J=E[2],ct=E[3];return Math.min(S[m],D[m],J[m],ct[m])}))}function im(y,m){var E,S=[0,0],D=[0,0],J=[0,0],ct=[0,0],vt=0,It=0;if(!y.length)return{pos1:S,pos2:D,pos3:J,pos4:ct,minX:0,minY:0,maxX:0,maxY:0,width:vt,height:It,rotation:m};var Bt=Xt(m,wl);if(Bt%90){var qt=Bt/180*Math.PI,Zt=Math.tan(qt),Ht=-1/Zt,be=[Nd,fp],_e=[[0,0],[0,0]],Ue=[Nd,fp],nn=[[0,0],[0,0]];y.forEach(function(Ii){Ii.forEach(function(Ja){var oo=kc([-Zt,1,0],Ja),Po=kc([-Ht,1,0],Ja);be[0]>oo&&(_e[0]=Ja,be[0]=oo),be[1]<oo&&(_e[1]=Ja,be[1]=oo),Ue[0]>Po&&(nn[0]=Ja,Ue[0]=Po),Ue[1]<Po&&(nn[1]=Ja,Ue[1]=Po)})});var hn=_e[0],On=_e[1],er=nn[0],Yn=nn[1],Ir=[-Zt,1,Th([-Zt,1],hn)],Un=[-Zt,1,Th([-Zt,1],On)],gr=[-Ht,1,Th([-Ht,1],er)],Br=[-Ht,1,Th([-Ht,1],Yn)];E=[[Ir,gr],[Ir,Br],[Un,gr],[Un,Br]].map(function(Ii){var Ja=Ii[0],oo=Ii[1];return ve(Ja,oo)[0]}),S=E[0],D=E[1],J=E[2],ct=E[3],vt=Ue[1]-Ue[0],It=be[1]-be[0]}else{var Tr=Gm(y,0),sa=Gm(y,1),Gr=G0(y,0),va=G0(y,1);if(S=[Tr,sa],D=[Gr,sa],J=[Tr,va],ct=[Gr,va],vt=Gr-Tr,It=va-sa,Bt%180){var la=[J,S,ct,D];S=la[0],D=la[1],J=la[2],ct=la[3],vt=va-sa,It=Gr-Tr}}if(Bt%360>180){var la=[ct,J,D,S];S=la[0],D=la[1],J=la[2],ct=la[3]}var ka=oc([S,D,J,ct]),ri=ka.minX,Li=ka.minY,to=ka.maxX,fi=ka.maxY;return{pos1:S,pos2:D,pos3:J,pos4:ct,width:vt,height:It,minX:ri,minY:Li,maxX:to,maxY:fi,rotation:m}}function ng(y,m){var E=m.map(function(S){if(Rt(S)){var D=ng(y,S),J=D.length;return J>1?D:J===1?D[0]:null}else{var ct=Sr(y,function(vt){var It=vt.manager;return It.props.target===S});return ct?(ct.finded=!0,ct.manager):null}}).filter(Boolean);return E.length===1&&Rt(E[0])?E[0]:E}var Um=function(y){rr(m,y);function m(){var S=y!==null&&y.apply(this,arguments)||this;return S.differ=new Au,S.moveables=[],S.transformOrigin="50% 50%",S.renderGroupRects=[],S._targetGroups=[],S._hasFirstTargets=!1,S}var E=m.prototype;return E.componentDidMount=function(){y.prototype.componentDidMount.call(this)},E.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},E.getTargets=function(){return this.props.targets},E.updateRect=function(S,D,J){var ct;J===void 0&&(J=!0);var vt=this.state;if(!this.controlBox||vt.isPersisted)return;ls(!0),this.moveables.forEach(function(rs){rs.updateRect(S,!1,!1)});var It=this.props,Bt=this.moveables,qt=vt.target||It.target,Zt=Bt.map(function(rs){return{finded:!1,manager:rs}}),Ht=this.props.targetGroups||[],be=ng(Zt,Ht);be.push.apply(be,Zt.filter(function(rs){var $u=rs.finded;return!$u}).map(function(rs){var $u=rs.manager;return $u}));var _e=[],Ue=!D||S!==""&&It.updateGroup,nn=It.defaultGroupRotate||0;if(!this._hasFirstTargets){var hn=(ct=this.props.persistData)===null||ct===void 0?void 0:ct.rotation;hn!=null&&(nn=hn)}function On(rs,$u,Bo){var ts=rs.map(function(cu){if(Rt(cu)){var Hs=On(cu,$u),Ru=[Hs.pos1,Hs.pos2,Hs.pos3,Hs.pos4];return _e.push(Hs),{poses:Ru,rotation:Hs.rotation}}else return{poses:uc(cu.state),rotation:cu.getRotation()}}),hu=ts.map(function(cu){var Hs=cu.rotation;return Hs}),eu=0,Nl=hu[0],Gu=hu.every(function(cu){return Math.abs(Nl-cu)<.1});Ue?eu=Gu?Nl:nn:eu=!Bo&&Gu?Nl:$u;var nu=ts.map(function(cu){var Hs=cu.poses;return Hs}),kl=im(nu,eu);return kl}var er=On(be,this.rotation,!0);Ue&&(this.rotation=er.rotation,this.transformOrigin=It.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=Ht,this.renderGroupRects=_e;var Yn=this.transformOrigin,Ir=this.rotation,Un=this.scale,gr=er.width,Br=er.height,Tr=er.minX,sa=er.minY,Gr=wp([[0,0],[gr,0],[0,Br],[gr,Br]],xp(Yn,gr,Br),this.rotation/180*Math.PI),va=oc(Gr.result),la=va.minX,ka=va.minY,ri=" rotate(".concat(Ir,"deg)")+" scale(".concat(Un[0]>=0?1:-1,", ").concat(Un[1]>=0?1:-1,")"),Li="translate(".concat(-la,"px, ").concat(-ka,"px)").concat(ri);this.controlBox.style.transform="translate3d(".concat(Tr,"px, ").concat(sa,"px, ").concat(this.props.translateZ||0,")"),qt.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(Yn,";")+"width:".concat(gr,"px;height:").concat(Br,"px;")+"transform: ".concat(Li),vt.width=gr,vt.height=Br;var to=this.getContainer(),fi=Io(this.controlBox,qt,this.controlBox,this.getContainer(),this._rootContainer||to,[]),Ii=[fi.left,fi.top],Ja=uc(fi),oo=Ja[0],Po=Ja[1],Fo=Ja[2],_s=Ja[3],Eo=oc([oo,Po,Fo,_s]),Co=[Eo.minX,Eo.minY],ws=Un[0]*Un[1]>0?1:-1;fi.pos1=gi(oo,Co),fi.pos2=gi(Po,Co),fi.pos3=gi(Fo,Co),fi.pos4=gi(_s,Co),fi.left=Tr-fi.left+Co[0],fi.top=sa-fi.top+Co[1],fi.origin=gi(bi(Ii,fi.origin),Co),fi.beforeOrigin=gi(bi(Ii,fi.beforeOrigin),Co),fi.originalBeforeOrigin=bi(Ii,fi.originalBeforeOrigin),fi.transformOrigin=gi(bi(Ii,fi.transformOrigin),Co),qt.style.transform="translate(".concat(-la-Co[0],"px, ").concat(-ka-Co[1],"px)")+ri,ls(),this.updateState(We(We({},fi),{posDelta:Co,direction:ws,beforeDirection:ws}),J)},E.getRect=function(){return We(We({},y.prototype.getRect.call(this)),{children:this.moveables.map(function(S){return S.getRect()})})},E.triggerEvent=function(S,D,J){if(J||S.indexOf("Group")>-1)return y.prototype.triggerEvent.call(this,S,D);this._emitter.trigger(S,D)},E.getRequestChildStyles=function(){var S=this.getEnabledAbles().reduce(function(D,J){var ct,vt,It=(vt=(ct=J.requestChildStyle)===null||ct===void 0?void 0:ct.call(J))!==null&&vt!==void 0?vt:[];return _r(_r([],D,!0),It,!0)},[]);return S},E.updateAbles=function(){y.prototype.updateAbles.call(this,_r(_r([],this.props.ables,!0),[yl],!1),"Group")},E._updateTargets=function(){y.prototype._updateTargets.call(this),this._prevTarget=this.props.dragTarget||this.areaElement},E._updateEvents=function(){var S=this.state,D=this.props,J=this._prevTarget,ct=D.dragTarget||this.areaElement;J!==ct&&(ml(this,"targetGesto"),ml(this,"controlGesto"),S.target=null),S.target||(S.target=this.areaElement,this.controlBox.style.display="block"),S.target&&(this.targetGesto||(this.targetGesto=Na(this,ct,"Group")),this.controlGesto||(this.controlGesto=ga(this,this.controlBox,"controlAbles","GroupControl")));var vt=!Xp(S.container,D.container);vt&&(S.container=D.container);var It=D.targets,Bt=this.differ.update(It),qt=Bt.added,Zt=Bt.changed,Ht=Bt.removed,be=qt.length||Ht.length;(vt||be||this.transformOrigin!==(D.defaultGroupOrigin||"50% 50%")||Zt.length||It.length&&!Yp(this._targetGroups,D.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!be},E._updateObserver=function(){},m.defaultProps=We(We({},Os.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),m}(Os),Pv=function(y){rr(m,y);function m(){var S=y!==null&&y.apply(this,arguments)||this;return S.moveables=[],S}var E=m.prototype;return E.render=function(){var S=this,D,J=this.props,ct=J.cspNonce,vt=J.cssStyled,It=J.persistData,Bt=J.targets||[],qt=Bt.length,Zt=this.isUnmounted||!qt,Ht=(D=It==null?void 0:It.children)!==null&&D!==void 0?D:[];return Zt&&!qt&&Ht.length?Bt=Ht.map(function(){return null}):Zt||(Ht=[]),Ta.createElement(vt,{cspNonce:ct,ref:wt(this,"controlBox"),className:mo("control-box")},Bt.map(function(be,_e){var Ue,nn,hn=(nn=(Ue=J.individualGroupableProps)===null||Ue===void 0?void 0:Ue.call(J,be,_e))!==null&&nn!==void 0?nn:{};return Ta.createElement(Os,We({key:"moveable"+_e,ref:ut(S,"moveables",_e)},J,hn,{target:be,wrapperMoveable:S,isWrapperMounted:S.isMoveableMounted,persistData:Ht[_e]}))}))},E.componentDidUpdate=function(){},E.getTargets=function(){return this.props.targets},E.updateRect=function(S,D,J){J===void 0&&(J=!0),ls(!0),this.moveables.forEach(function(ct){ct.updateRect(S,D,J)}),ls()},E.getRect=function(){return We(We({},y.prototype.getRect.call(this)),{children:this.moveables.map(function(S){return S.getRect()})})},E.request=function(){return{request:function(){return this},requestEnd:function(){return this}}},E.dragStart=function(){return this},E.hitTest=function(){return 0},E.isInside=function(){return!1},E.isDragging=function(){return!1},E.updateRenderPoses=function(){},E.checkUpdate=function(){},E.triggerEvent=function(){},E.updateAbles=function(){},E._updateEvents=function(){},E._updateObserver=function(){},m}(Os);function U0(y,m){var E=[];return y.forEach(function(S){if(!!S){if(Xn(S)){m[S]&&E.push.apply(E,m[S]);return}Rt(S)?E.push.apply(E,U0(S,m)):E.push(S)}}),E}function k1(y,m){var E=[];return y.forEach(function(S){if(!!S){if(Xn(S)){m[S]&&E.push.apply(E,m[S]);return}Rt(S)?E.push(k1(S,m)):E.push(S)}}),E}function fv(y,m){return y.length!==m.length||y.some(function(E,S){var D=m[S];return!E&&!D?!1:E!=D?Rt(E)&&Rt(D)?fv(E,D):!0:!1})}var Kh=function(y){rr(m,y);function m(){var S=y!==null&&y.apply(this,arguments)||this;return S.refTargets=[],S.selectorMap={},S._differ=new Au,S._elementTargets=[],S._onChangeTargets=null,S}var E=m.prototype;return m.makeStyled=function(){var S={},D=this.getTotalAbles();D.forEach(function(ct){var vt=ct.css;!vt||vt.forEach(function(It){S[It]=!0})});var J=ua(S).join(`
`);this.defaultStyled=an("div",mt(ds,Jc+J))},m.getTotalAbles=function(){return _r([jo,yl,Lv,_i],this.defaultAbles,!0)},E.render=function(){var S,D=this.constructor;D.defaultStyled||D.makeStyled();var J=this.props,ct=J.ables,vt=J.props,It=ca(J,["ables","props"]),Bt=this._updateRefs(!0),qt=U0(Bt,this.selectorMap),Zt=qt.length>1,Ht=D.getTotalAbles(),be=_r(_r([],Ht,!0),ct||[],!0),_e=We(We(We({},It),vt||{}),{ables:be,cssStyled:D.defaultStyled,customStyledMap:D.customStyledMap});this._elementTargets=qt;var Ue=null,nn=this.moveable,hn=It.persistData;if((hn==null?void 0:hn.children)&&(Zt=!0),It.individualGroupable)return Ta.createElement(Pv,We({key:"individual-group",ref:wt(this,"moveable")},_e,{target:null,targets:qt}));if(Zt){var On=k1(Bt,this.selectorMap);if(nn&&!nn.props.groupable&&!nn.props.individualGroupable){var er=nn.props.target;er&&qt.indexOf(er)>-1&&(Ue=We({},nn.state))}return Ta.createElement(Um,We({key:"group",ref:wt(this,"moveable")},_e,(S=It.groupableProps)!==null&&S!==void 0?S:{},{target:null,targets:qt,targetGroups:On,firstRenderState:Ue}))}else{var Yn=qt[0];if(nn&&(nn.props.groupable||nn.props.individualGroupable)){var Ir=nn.moveables||[],Un=Sr(Ir,function(gr){return gr.props.target===Yn});Un&&(Ue=We({},Un.state))}return Ta.createElement(Os,We({key:"single",ref:wt(this,"moveable")},_e,{target:Yn,firstRenderState:Ue}))}},E.componentDidMount=function(){this._checkChangeTargets(),this._updateRefs()},E.componentDidUpdate=function(){this._checkChangeTargets()},E.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},E.getTargets=function(){var S,D;return(D=(S=this.moveable)===null||S===void 0?void 0:S.getTargets())!==null&&D!==void 0?D:[]},E.updateSelectors=function(){this.selectorMap={},this._updateRefs()},E.waitToChangeTarget=function(){var S=this,D;return this._onChangeTargets=function(){S._onChangeTargets=null,D()},new Promise(function(J){D=J})},E.waitToChangeTargets=function(){return this.waitToChangeTarget()},E.getManager=function(){return this.moveable},E._updateRefs=function(S){var D=this.refTargets,J=_f(this.props.target||this.props.targets),ct=typeof document!="undefined",vt=fv(D,J),It=this.selectorMap,Bt={};return this.refTargets.forEach(function qt(Zt){if(Xn(Zt)){var Ht=It[Zt];Ht?Bt[Zt]=It[Zt]:ct&&(vt=!0,Bt[Zt]=[].slice.call(document.querySelectorAll(Zt)))}else Rt(Zt)&&Zt.forEach(qt)}),this.refTargets=J,this.selectorMap=Bt,!S&&vt&&this.forceUpdate(),J},E._checkChangeTargets=function(){var S,D,J,ct=this._differ.update(this._elementTargets),vt=ct.added,It=ct.removed,Bt=vt.length||It.length;Bt&&((D=(S=this.props).onChangeTargets)===null||D===void 0||D.call(S,{moveable:this.moveable,targets:this._elementTargets}),(J=this._onChangeTargets)===null||J===void 0||J.call(this)),this._updateRefs()},m.defaultAbles=[],m.customStyledMap={},m.defaultStyled=null,ha([Nt(jp)],m.prototype,"moveable",void 0),m}(Ta.PureComponent),Ec=function(y){rr(m,y);function m(){return y!==null&&y.apply(this,arguments)||this}return m.defaultAbles=Nf,m}(Kh);function hv(y){var m;return m=function(E){rr(S,E);function S(){return E!==null&&E.apply(this,arguments)||this}return S}(Kh),m.defaultAbles=y,m}},17453:function(ur,ot,$){"use strict";var Y=$(22122),tt=$(19756),j=$(63349),W=$(41788),Q=$(67294),Z=!!document.documentElement.currentStyle,R={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},L=["letter-spacing","line-height","font-family","font-weight","font-size","font-style","tab-size","text-rendering","text-transform","width","text-indent","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","box-sizing"],C={},A=document.createElement("textarea"),N=function(yt){Object.keys(R).forEach(function(st){yt.style.setProperty(st,R[st],"important")})};A.setAttribute("tab-index","-1"),A.setAttribute("aria-hidden","true"),N(A);function B(k,yt,st,lt,ht){st===void 0&&(st=!1),lt===void 0&&(lt=null),ht===void 0&&(ht=null),A.parentNode===null&&document.body.appendChild(A);var mt=O(k,yt,st);if(mt===null)return null;var wt=mt.paddingSize,ut=mt.borderSize,pt=mt.boxSizing,Nt=mt.sizingStyle;Object.keys(Nt).forEach(function(At){A.style[At]=Nt[At]}),N(A),A.value=k.value||k.placeholder||"x";var Ut=-Infinity,ue=Infinity,se=A.scrollHeight;pt==="border-box"?se=se+ut:pt==="content-box"&&(se=se-wt),A.value="x";var Le=A.scrollHeight-wt,Ne=Math.floor(se/Le);lt!==null&&(Ut=Le*lt,pt==="border-box"&&(Ut=Ut+wt+ut),se=Math.max(Ut,se)),ht!==null&&(ue=Le*ht,pt==="border-box"&&(ue=ue+wt+ut),se=Math.min(ue,se));var we=Math.floor(se/Le);return{height:se,minHeight:Ut,maxHeight:ue,rowCount:we,valueRowCount:Ne}}function O(k,yt,st){if(st===void 0&&(st=!1),st&&C[yt])return C[yt];var lt=window.getComputedStyle(k);if(lt===null)return null;var ht=L.reduce(function(Nt,Ut){return Nt[Ut]=lt.getPropertyValue(Ut),Nt},{}),mt=ht["box-sizing"];if(mt==="")return null;Z&&mt==="border-box"&&(ht.width=parseFloat(ht.width)+parseFloat(lt["border-right-width"])+parseFloat(lt["border-left-width"])+parseFloat(lt["padding-right"])+parseFloat(lt["padding-left"])+"px");var wt=parseFloat(ht["padding-bottom"])+parseFloat(ht["padding-top"]),ut=parseFloat(ht["border-bottom-width"])+parseFloat(ht["border-top-width"]),pt={sizingStyle:ht,paddingSize:wt,borderSize:ut,boxSizing:mt};return st&&(C[yt]=pt),pt}var F=function(yt){delete C[yt]},K=function(){},nt=0,P=function(k){(0,W.Z)(yt,k);function yt(lt){var ht;return ht=k.call(this,lt)||this,ht._onRef=function(mt){ht._ref=mt;var wt=ht.props.inputRef;if(typeof wt=="function"){wt(mt);return}wt.current=mt},ht._onChange=function(mt){ht._controlled||ht._resizeComponent(),ht.props.onChange(mt,(0,j.Z)(ht))},ht._resizeComponent=function(mt){mt===void 0&&(mt=K);var wt=B(ht._ref,ht._uid,ht.props.useCacheForDOMMeasurements,ht.props.minRows,ht.props.maxRows);if(wt===null){mt();return}var ut=wt.height,pt=wt.minHeight,Nt=wt.maxHeight,Ut=wt.rowCount,ue=wt.valueRowCount;if(ht.rowCount=Ut,ht.valueRowCount=ue,ht.state.height!==ut||ht.state.minHeight!==pt||ht.state.maxHeight!==Nt){ht.setState({height:ut,minHeight:pt,maxHeight:Nt},mt);return}mt()},ht.state={height:lt.style&&lt.style.height||0,minHeight:-Infinity,maxHeight:Infinity},ht._uid=nt++,ht._controlled=lt.value!==void 0,ht._resizeLock=!1,ht}var st=yt.prototype;return st.render=function(){var ht=this.props,mt=ht.inputRef,wt=ht.maxRows,ut=ht.minRows,pt=ht.onHeightChange,Nt=ht.useCacheForDOMMeasurements,Ut=(0,tt.Z)(ht,["inputRef","maxRows","minRows","onHeightChange","useCacheForDOMMeasurements"]);Ut.style=(0,Y.Z)({},Ut.style,{height:this.state.height});var ue=Math.max(Ut.style.maxHeight||Infinity,this.state.maxHeight);return ue<this.state.height&&(Ut.style.overflow="hidden"),(0,Q.createElement)("textarea",(0,Y.Z)({},Ut,{onChange:this._onChange,ref:this._onRef}))},st.componentDidMount=function(){var ht=this;this._resizeComponent(),this._resizeListener=function(){ht._resizeLock||(ht._resizeLock=!0,ht._resizeComponent(function(){ht._resizeLock=!1}))},window.addEventListener("resize",this._resizeListener)},st.componentDidUpdate=function(ht,mt){ht!==this.props&&this._resizeComponent(),this.state.height!==mt.height&&this.props.onHeightChange(this.state.height,this)},st.componentWillUnmount=function(){window.removeEventListener("resize",this._resizeListener),F(this._uid)},yt}(Q.Component);P.defaultProps={inputRef:K,onChange:K,onHeightChange:K,useCacheForDOMMeasurements:!1},ot.Z=P},81550:function(ur){(function(ot,$){ur.exports=$()})(this,function(){"use strict";var ot=function(oe){return oe instanceof Uint8Array||oe instanceof Uint16Array||oe instanceof Uint32Array||oe instanceof Int8Array||oe instanceof Int16Array||oe instanceof Int32Array||oe instanceof Float32Array||oe instanceof Float64Array||oe instanceof Uint8ClampedArray},$=function(oe,vn){for(var qn=Object.keys(vn),ia=0;ia<qn.length;++ia)oe[qn[ia]]=vn[qn[ia]];return oe},Y=`
`;function tt(oe){return typeof atob!="undefined"?atob(oe):"base64:"+oe}function j(oe){var vn=new Error("(regl) "+oe);throw console.error(vn),vn}function W(oe,vn){oe||j(vn)}function Q(oe){return oe?": "+oe:""}function Z(oe,vn,qn){oe in vn||j("unknown parameter ("+oe+")"+Q(qn)+". possible values: "+Object.keys(vn).join())}function R(oe,vn){ot(oe)||j("invalid parameter type"+Q(vn)+". must be a typed array")}function L(oe,vn){switch(vn){case"number":return typeof oe=="number";case"object":return typeof oe=="object";case"string":return typeof oe=="string";case"boolean":return typeof oe=="boolean";case"function":return typeof oe=="function";case"undefined":return typeof oe=="undefined";case"symbol":return typeof oe=="symbol"}}function C(oe,vn,qn){L(oe,vn)||j("invalid parameter type"+Q(qn)+". expected "+vn+", got "+typeof oe)}function A(oe,vn){oe>=0&&(oe|0)===oe||j("invalid parameter type, ("+oe+")"+Q(vn)+". must be a nonnegative integer")}function N(oe,vn,qn){vn.indexOf(oe)<0&&j("invalid value"+Q(qn)+". must be one of: "+vn)}var B=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function O(oe){Object.keys(oe).forEach(function(vn){B.indexOf(vn)<0&&j('invalid regl constructor argument "'+vn+'". must be one of '+B)})}function F(oe,vn){for(oe=oe+"";oe.length<vn;)oe=" "+oe;return oe}function K(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function nt(oe,vn){this.number=oe,this.line=vn,this.errors=[]}function P(oe,vn,qn){this.file=oe,this.line=vn,this.message=qn}function k(){var oe=new Error,vn=(oe.stack||oe).toString(),qn=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(vn);if(qn)return qn[1];var ia=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(vn);return ia?ia[1]:"unknown"}function yt(){var oe=new Error,vn=(oe.stack||oe).toString(),qn=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(vn);if(qn)return qn[1];var ia=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(vn);return ia?ia[1]:"unknown"}function st(oe,vn){var qn=oe.split(`
`),ia=1,Sa=0,Hr={unknown:new K,0:new K};Hr.unknown.name=Hr[0].name=vn||k(),Hr.unknown.lines.push(new nt(0,""));for(var ea=0;ea<qn.length;++ea){var Ha=qn[ea],Wa=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Ha);if(Wa)switch(Wa[1]){case"line":var Ga=/(\d+)(\s+\d+)?/.exec(Wa[2]);Ga&&(ia=Ga[1]|0,Ga[2]&&(Sa=Ga[2]|0,Sa in Hr||(Hr[Sa]=new K)));break;case"define":var Qa=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Wa[2]);Qa&&(Hr[Sa].name=Qa[1]?tt(Qa[2]):Qa[2]);break}Hr[Sa].lines.push(new nt(ia++,Ha))}return Object.keys(Hr).forEach(function(Vn){var M=Hr[Vn];M.lines.forEach(function(q){M.index[q.number]=q})}),Hr}function lt(oe){var vn=[];return oe.split(`
`).forEach(function(qn){if(!(qn.length<5)){var ia=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(qn);ia?vn.push(new P(ia[1]|0,ia[2]|0,ia[3].trim())):qn.length>0&&vn.push(new P("unknown",0,qn))}}),vn}function ht(oe,vn){vn.forEach(function(qn){var ia=oe[qn.file];if(ia){var Sa=ia.index[qn.line];if(Sa){Sa.errors.push(qn),ia.hasErrors=!0;return}}oe.unknown.hasErrors=!0,oe.unknown.lines[0].errors.push(qn)})}function mt(oe,vn,qn,ia,Sa){if(!oe.getShaderParameter(vn,oe.COMPILE_STATUS)){var Hr=oe.getShaderInfoLog(vn),ea=ia===oe.FRAGMENT_SHADER?"fragment":"vertex";se(qn,"string",ea+" shader source must be a string",Sa);var Ha=st(qn,Sa),Wa=lt(Hr);ht(Ha,Wa),Object.keys(Ha).forEach(function(Ga){var Qa=Ha[Ga];if(!Qa.hasErrors)return;var Vn=[""],M=[""];function q(dt,_t){Vn.push(dt),M.push(_t||"")}q("file number "+Ga+": "+Qa.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Qa.lines.forEach(function(dt){if(dt.errors.length>0){q(F(dt.number,4)+"|  ","background-color:yellow; font-weight:bold"),q(dt.line+Y,"color:red; background-color:yellow; font-weight:bold");var _t=0;dt.errors.forEach(function(Pt){var jt=Pt.message,ie=/^\s*'(.*)'\s*:\s*(.*)$/.exec(jt);if(ie){var he=ie[1];switch(jt=ie[2],he){case"assign":he="=";break}_t=Math.max(dt.line.indexOf(he,_t),0)}else _t=0;q(F("| ",6)),q(F("^^^",_t+3)+Y,"font-weight:bold"),q(F("| ",6)),q(jt+Y,"font-weight:bold")}),q(F("| ",6)+Y)}else q(F(dt.number,4)+"|  "),q(dt.line+Y,"color:red")}),typeof document!="undefined"&&!window.chrome?(M[0]=Vn.join("%c"),console.log.apply(console,M)):console.log(Vn.join(""))}),W.raise("Error compiling "+ea+" shader, "+Ha[0].name)}}function wt(oe,vn,qn,ia,Sa){if(!oe.getProgramParameter(vn,oe.LINK_STATUS)){var Hr=oe.getProgramInfoLog(vn),ea=st(qn,Sa),Ha=st(ia,Sa),Wa='Error linking program with vertex shader, "'+Ha[0].name+'", and fragment shader "'+ea[0].name+'"';typeof document!="undefined"?console.log("%c"+Wa+Y+"%c"+Hr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Wa+Y+Hr),W.raise(Wa)}}function ut(oe){oe._commandRef=k()}function pt(oe,vn,qn,ia){ut(oe);function Sa(Wa){return Wa?ia.id(Wa):0}oe._fragId=Sa(oe.static.frag),oe._vertId=Sa(oe.static.vert);function Hr(Wa,Ga){Object.keys(Ga).forEach(function(Qa){Wa[ia.id(Qa)]=!0})}var ea=oe._uniformSet={};Hr(ea,vn.static),Hr(ea,vn.dynamic);var Ha=oe._attributeSet={};Hr(Ha,qn.static),Hr(Ha,qn.dynamic),oe._hasCount="count"in oe.static||"count"in oe.dynamic||"elements"in oe.static||"elements"in oe.dynamic}function Nt(oe,vn){var qn=yt();j(oe+" in command "+(vn||k())+(qn==="unknown"?"":" called from "+qn))}function Ut(oe,vn,qn){oe||Nt(vn,qn||k())}function ue(oe,vn,qn,ia){oe in vn||Nt("unknown parameter ("+oe+")"+Q(qn)+". possible values: "+Object.keys(vn).join(),ia||k())}function se(oe,vn,qn,ia){L(oe,vn)||Nt("invalid parameter type"+Q(qn)+". expected "+vn+", got "+typeof oe,ia||k())}function Le(oe){oe()}function Ne(oe,vn,qn){oe.texture?N(oe.texture._texture.internalformat,vn,"unsupported texture format for attachment"):N(oe.renderbuffer._renderbuffer.format,qn,"unsupported renderbuffer format for attachment")}var we=33071,At=9728,Qt=9984,de=9985,rn=9986,Ee=9987,ce=5120,Oe=5121,Ze=5122,fe=5123,Ae=5124,Ye=5125,ge=5126,Be=32819,te=32820,ke=33635,Ve=34042,ee=36193,Ft={};Ft[ce]=Ft[Oe]=1,Ft[Ze]=Ft[fe]=Ft[ee]=Ft[ke]=Ft[Be]=Ft[te]=2,Ft[Ae]=Ft[Ye]=Ft[ge]=Ft[Ve]=4;function bt(oe,vn){return oe===te||oe===Be||oe===ke?2:oe===Ve?4:Ft[oe]*vn}function Me(oe){return!(oe&oe-1)&&!!oe}function en(oe,vn,qn){var ia,Sa=vn.width,Hr=vn.height,ea=vn.channels;W(Sa>0&&Sa<=qn.maxTextureSize&&Hr>0&&Hr<=qn.maxTextureSize,"invalid texture shape"),(oe.wrapS!==we||oe.wrapT!==we)&&W(Me(Sa)&&Me(Hr),"incompatible wrap mode for texture, both width and height must be power of 2"),vn.mipmask===1?Sa!==1&&Hr!==1&&W(oe.minFilter!==Qt&&oe.minFilter!==rn&&oe.minFilter!==de&&oe.minFilter!==Ee,"min filter requires mipmap"):(W(Me(Sa)&&Me(Hr),"texture must be a square power of 2 to support mipmapping"),W(vn.mipmask===(Sa<<1)-1,"missing or incomplete mipmap data")),vn.type===ge&&(qn.extensions.indexOf("oes_texture_float_linear")<0&&W(oe.minFilter===At&&oe.magFilter===At,"filter not supported, must enable oes_texture_float_linear"),W(!oe.genMipmaps,"mipmap generation not supported with float textures"));var Ha=vn.images;for(ia=0;ia<16;++ia)if(Ha[ia]){var Wa=Sa>>ia,Ga=Hr>>ia;W(vn.mipmask&1<<ia,"missing mipmap data");var Qa=Ha[ia];if(W(Qa.width===Wa&&Qa.height===Ga,"invalid shape for mip images"),W(Qa.format===vn.format&&Qa.internalformat===vn.internalformat&&Qa.type===vn.type,"incompatible type for mip image"),!Qa.compressed)if(Qa.data){var Vn=Math.ceil(bt(Qa.type,ea)*Wa/Qa.unpackAlignment)*Qa.unpackAlignment;W(Qa.data.byteLength===Vn*Ga,"invalid data for image, buffer size is inconsistent with image format")}else Qa.element||Qa.copy}else oe.genMipmaps||W((vn.mipmask&1<<ia)==0,"extra mipmap data");vn.compressed&&W(!oe.genMipmaps,"mipmap generation for compressed images not supported")}function fn(oe,vn,qn,ia){var Sa=oe.width,Hr=oe.height,ea=oe.channels;W(Sa>0&&Sa<=ia.maxTextureSize&&Hr>0&&Hr<=ia.maxTextureSize,"invalid texture shape"),W(Sa===Hr,"cube map must be square"),W(vn.wrapS===we&&vn.wrapT===we,"wrap mode not supported by cube map");for(var Ha=0;Ha<qn.length;++Ha){var Wa=qn[Ha];W(Wa.width===Sa&&Wa.height===Hr,"inconsistent cube map face shape"),vn.genMipmaps&&(W(!Wa.compressed,"can not generate mipmap for compressed textures"),W(Wa.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Ga=Wa.images,Qa=0;Qa<16;++Qa){var Vn=Ga[Qa];if(Vn){var M=Sa>>Qa,q=Hr>>Qa;W(Wa.mipmask&1<<Qa,"missing mipmap data"),W(Vn.width===M&&Vn.height===q,"invalid shape for mip images"),W(Vn.format===oe.format&&Vn.internalformat===oe.internalformat&&Vn.type===oe.type,"incompatible type for mip image"),Vn.compressed||(Vn.data?W(Vn.data.byteLength===M*q*Math.max(bt(Vn.type,ea),Vn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Vn.element||Vn.copy)}}}}var Rt=$(W,{optional:Le,raise:j,commandRaise:Nt,command:Ut,parameter:Z,commandParameter:ue,constructor:O,type:C,commandType:se,isTypedArray:R,nni:A,oneOf:N,shaderError:mt,linkError:wt,callSite:yt,saveCommandRef:ut,saveDrawInfo:pt,framebufferFormat:Ne,guessCommand:k,texture2D:en,textureCube:fn}),Xn=0,Bn=0,xr=5,dr=6;function Ur(oe,vn){this.id=Xn++,this.type=oe,this.data=vn}function fa(oe){return oe.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Ea(oe){if(oe.length===0)return[];var vn=oe.charAt(0),qn=oe.charAt(oe.length-1);if(oe.length>1&&vn===qn&&(vn==='"'||vn==="'"))return['"'+fa(oe.substr(1,oe.length-2))+'"'];var ia=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(oe);if(ia)return Ea(oe.substr(0,ia.index)).concat(Ea(ia[1])).concat(Ea(oe.substr(ia.index+ia[0].length)));var Sa=oe.split(".");if(Sa.length===1)return['"'+fa(oe)+'"'];for(var Hr=[],ea=0;ea<Sa.length;++ea)Hr=Hr.concat(Ea(Sa[ea]));return Hr}function aa(oe){return"["+Ea(oe).join("][")+"]"}function Da(oe,vn){return new Ur(oe,aa(vn+""))}function Lr(oe){return typeof oe=="function"&&!oe._reglType||oe instanceof Ur}function _n(oe,vn){if(typeof oe=="function")return new Ur(Bn,oe);if(typeof oe=="number"||typeof oe=="boolean")return new Ur(xr,oe);if(Array.isArray(oe))return new Ur(dr,oe.map((qn,ia)=>_n(qn,vn+"["+ia+"]")));if(oe instanceof Ur)return oe;Rt(!1,"invalid option type in uniform "+vn)}var sr={DynamicVariable:Ur,define:Da,isDynamic:Lr,unbox:_n,accessor:aa},Pn={next:typeof requestAnimationFrame=="function"?function(oe){return requestAnimationFrame(oe)}:function(oe){return setTimeout(oe,16)},cancel:typeof cancelAnimationFrame=="function"?function(oe){return cancelAnimationFrame(oe)}:clearTimeout},tr=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function zn(){var oe={"":0},vn=[""];return{id:function(qn){var ia=oe[qn];return ia||(ia=oe[qn]=vn.length,vn.push(qn),ia)},str:function(qn){return vn[qn]}}}function Wr(oe,vn,qn){var ia=document.createElement("canvas");$(ia.style,{border:0,margin:0,padding:0,top:0,left:0}),oe.appendChild(ia),oe===document.body&&(ia.style.position="absolute",$(oe.style,{margin:0,padding:0}));function Sa(){var Ha=window.innerWidth,Wa=window.innerHeight;if(oe!==document.body){var Ga=oe.getBoundingClientRect();Ha=Ga.right-Ga.left,Wa=Ga.bottom-Ga.top}ia.width=qn*Ha,ia.height=qn*Wa,$(ia.style,{width:Ha+"px",height:Wa+"px"})}var Hr;oe!==document.body&&typeof ResizeObserver=="function"?(Hr=new ResizeObserver(function(){setTimeout(Sa)}),Hr.observe(oe)):window.addEventListener("resize",Sa,!1);function ea(){Hr?Hr.disconnect():window.removeEventListener("resize",Sa),oe.removeChild(ia)}return Sa(),{canvas:ia,onDestroy:ea}}function Yr(oe,vn){function qn(ia){try{return oe.getContext(ia,vn)}catch(Sa){return null}}return qn("webgl")||qn("experimental-webgl")||qn("webgl-experimental")}function nr(oe){return typeof oe.nodeName=="string"&&typeof oe.appendChild=="function"&&typeof oe.getBoundingClientRect=="function"}function wr(oe){return typeof oe.drawArrays=="function"||typeof oe.drawElements=="function"}function Sr(oe){return typeof oe=="string"?oe.split():(Rt(Array.isArray(oe),"invalid extension array"),oe)}function pr(oe){return typeof oe=="string"?(Rt(typeof document!="undefined","not supported outside of DOM"),document.querySelector(oe)):oe}function qr(oe){var vn=oe||{},qn,ia,Sa,Hr,ea={},Ha=[],Wa=[],Ga=typeof window=="undefined"?1:window.devicePixelRatio,Qa=!1,Vn=function(dt){dt&&Rt.raise(dt)},M=function(){};if(typeof vn=="string"?(Rt(typeof document!="undefined","selector queries only supported in DOM enviroments"),qn=document.querySelector(vn),Rt(qn,"invalid query string for element")):typeof vn=="object"?nr(vn)?qn=vn:wr(vn)?(Hr=vn,Sa=Hr.canvas):(Rt.constructor(vn),"gl"in vn?Hr=vn.gl:"canvas"in vn?Sa=pr(vn.canvas):"container"in vn&&(ia=pr(vn.container)),"attributes"in vn&&(ea=vn.attributes,Rt.type(ea,"object","invalid context attributes")),"extensions"in vn&&(Ha=Sr(vn.extensions)),"optionalExtensions"in vn&&(Wa=Sr(vn.optionalExtensions)),"onDone"in vn&&(Rt.type(vn.onDone,"function","invalid or missing onDone callback"),Vn=vn.onDone),"profile"in vn&&(Qa=!!vn.profile),"pixelRatio"in vn&&(Ga=+vn.pixelRatio,Rt(Ga>0,"invalid pixel ratio"))):Rt.raise("invalid arguments to regl"),qn&&(qn.nodeName.toLowerCase()==="canvas"?Sa=qn:ia=qn),!Hr){if(!Sa){Rt(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var q=Wr(ia||document.body,Vn,Ga);if(!q)return null;Sa=q.canvas,M=q.onDestroy}ea.premultipliedAlpha===void 0&&(ea.premultipliedAlpha=!0),Hr=Yr(Sa,ea)}return Hr?{gl:Hr,canvas:Sa,container:ia,extensions:Ha,optionalExtensions:Wa,pixelRatio:Ga,profile:Qa,onDone:Vn,onDestroy:M}:(M(),Vn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function ua(oe,vn){var qn={};function ia(ea){Rt.type(ea,"string","extension name must be string");var Ha=ea.toLowerCase(),Wa;try{Wa=qn[Ha]=oe.getExtension(Ha)}catch(Ga){}return!!Wa}for(var Sa=0;Sa<vn.extensions.length;++Sa){var Hr=vn.extensions[Sa];if(!ia(Hr))return vn.onDestroy(),vn.onDone('"'+Hr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return vn.optionalExtensions.forEach(ia),{extensions:qn,restore:function(){Object.keys(qn).forEach(function(ea){if(qn[ea]&&!ia(ea))throw new Error("(regl): error restoring extension "+ea)})}}}function $r(oe,vn){for(var qn=Array(oe),ia=0;ia<oe;++ia)qn[ia]=vn(ia);return qn}var ba=5120,gt=5121,Dn=5122,un=5123,Lt=5124,Ot=5125,it=5126;function H(oe){for(var vn=16;vn<=1<<28;vn*=16)if(oe<=vn)return vn;return 0}function X(oe){var vn,qn;return vn=(oe>65535)<<4,oe>>>=vn,qn=(oe>255)<<3,oe>>>=qn,vn|=qn,qn=(oe>15)<<2,oe>>>=qn,vn|=qn,qn=(oe>3)<<1,oe>>>=qn,vn|=qn,vn|oe>>1}function xt(){var oe=$r(8,function(){return[]});function vn(Hr){var ea=H(Hr),Ha=oe[X(ea)>>2];return Ha.length>0?Ha.pop():new ArrayBuffer(ea)}function qn(Hr){oe[X(Hr.byteLength)>>2].push(Hr)}function ia(Hr,ea){var Ha=null;switch(Hr){case ba:Ha=new Int8Array(vn(ea),0,ea);break;case gt:Ha=new Uint8Array(vn(ea),0,ea);break;case Dn:Ha=new Int16Array(vn(2*ea),0,ea);break;case un:Ha=new Uint16Array(vn(2*ea),0,ea);break;case Lt:Ha=new Int32Array(vn(4*ea),0,ea);break;case Ot:Ha=new Uint32Array(vn(4*ea),0,ea);break;case it:Ha=new Float32Array(vn(4*ea),0,ea);break;default:return null}return Ha.length!==ea?Ha.subarray(0,ea):Ha}function Sa(Hr){qn(Hr.buffer)}return{alloc:vn,free:qn,allocType:ia,freeType:Sa}}var zt=xt();zt.zero=xt();var Vt=3408,Xt=3410,ne=3411,on=3412,tn=3413,He=3414,Qn=3415,Ln=33901,Qr=33902,Ia=3379,Jn=3386,Ar=34921,na=36347,za=36348,da=35661,Ti=35660,ki=34930,vi=36349,ii=34076,Di=34024,Ra=7936,ln=7937,De=7938,dn=35724,Wn=34047,Gn=36063,Kn=34852,Rr=3553,xa=34067,La=34069,ui=33984,Fi=6408,Ki=5126,xo=5121,vo=36160,es=36053,Wo=36064,Zi=16384,bi=function(oe,vn){var qn=1;vn.ext_texture_filter_anisotropic&&(qn=oe.getParameter(Wn));var ia=1,Sa=1;vn.webgl_draw_buffers&&(ia=oe.getParameter(Kn),Sa=oe.getParameter(Gn));var Hr=!!vn.oes_texture_float;if(Hr){var ea=oe.createTexture();oe.bindTexture(Rr,ea),oe.texImage2D(Rr,0,Fi,1,1,0,Fi,Ki,null);var Ha=oe.createFramebuffer();if(oe.bindFramebuffer(vo,Ha),oe.framebufferTexture2D(vo,Wo,Rr,ea,0),oe.bindTexture(Rr,null),oe.checkFramebufferStatus(vo)!==es)Hr=!1;else{oe.viewport(0,0,1,1),oe.clearColor(1,0,0,1),oe.clear(Zi);var Wa=zt.allocType(Ki,4);oe.readPixels(0,0,1,1,Fi,Ki,Wa),oe.getError()?Hr=!1:(oe.deleteFramebuffer(Ha),oe.deleteTexture(ea),Hr=Wa[0]===1),zt.freeType(Wa)}}var Ga=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Qa=!0;if(!Ga){var Vn=oe.createTexture(),M=zt.allocType(xo,36);oe.activeTexture(ui),oe.bindTexture(xa,Vn),oe.texImage2D(La,0,Fi,3,3,0,Fi,xo,M),zt.freeType(M),oe.bindTexture(xa,null),oe.deleteTexture(Vn),Qa=!oe.getError()}return{colorBits:[oe.getParameter(Xt),oe.getParameter(ne),oe.getParameter(on),oe.getParameter(tn)],depthBits:oe.getParameter(He),stencilBits:oe.getParameter(Qn),subpixelBits:oe.getParameter(Vt),extensions:Object.keys(vn).filter(function(q){return!!vn[q]}),maxAnisotropic:qn,maxDrawbuffers:ia,maxColorAttachments:Sa,pointSizeDims:oe.getParameter(Ln),lineWidthDims:oe.getParameter(Qr),maxViewportDims:oe.getParameter(Jn),maxCombinedTextureUnits:oe.getParameter(da),maxCubeMapSize:oe.getParameter(ii),maxRenderbufferSize:oe.getParameter(Di),maxTextureUnits:oe.getParameter(ki),maxTextureSize:oe.getParameter(Ia),maxAttributes:oe.getParameter(Ar),maxVertexUniforms:oe.getParameter(na),maxVertexTextureUnits:oe.getParameter(Ti),maxVaryingVectors:oe.getParameter(za),maxFragmentUniforms:oe.getParameter(vi),glsl:oe.getParameter(dn),renderer:oe.getParameter(ln),vendor:oe.getParameter(Ra),version:oe.getParameter(De),readFloat:Hr,npotTextureCube:Qa}};function gi(oe){return!!oe&&typeof oe=="object"&&Array.isArray(oe.shape)&&Array.isArray(oe.stride)&&typeof oe.offset=="number"&&oe.shape.length===oe.stride.length&&(Array.isArray(oe.data)||ot(oe.data))}var ms=function(oe){return Object.keys(oe).map(function(vn){return oe[vn]})},Do={shape:Su,flatten:Rs};function To(oe,vn,qn){for(var ia=0;ia<vn;++ia)qn[ia]=oe[ia]}function Zs(oe,vn,qn,ia){for(var Sa=0,Hr=0;Hr<vn;++Hr)for(var ea=oe[Hr],Ha=0;Ha<qn;++Ha)ia[Sa++]=ea[Ha]}function Eu(oe,vn,qn,ia,Sa,Hr){for(var ea=Hr,Ha=0;Ha<vn;++Ha)for(var Wa=oe[Ha],Ga=0;Ga<qn;++Ga)for(var Qa=Wa[Ga],Vn=0;Vn<ia;++Vn)Sa[ea++]=Qa[Vn]}function as(oe,vn,qn,ia,Sa){for(var Hr=1,ea=qn+1;ea<vn.length;++ea)Hr*=vn[ea];var Ha=vn[qn];if(vn.length-qn==4){var Wa=vn[qn+1],Ga=vn[qn+2],Qa=vn[qn+3];for(ea=0;ea<Ha;++ea)Eu(oe[ea],Wa,Ga,Qa,ia,Sa),Sa+=Hr}else for(ea=0;ea<Ha;++ea)as(oe[ea],vn,qn+1,ia,Sa),Sa+=Hr}function Rs(oe,vn,qn,ia){var Sa=1;if(vn.length)for(var Hr=0;Hr<vn.length;++Hr)Sa*=vn[Hr];else Sa=0;var ea=ia||zt.allocType(qn,Sa);switch(vn.length){case 0:break;case 1:To(oe,vn[0],ea);break;case 2:Zs(oe,vn[0],vn[1],ea);break;case 3:Eu(oe,vn[0],vn[1],vn[2],ea,0);break;default:as(oe,vn,0,ea,0)}return ea}function Su(oe){for(var vn=[],qn=oe;qn.length;qn=qn[0])vn.push(qn.length);return vn}var fu={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Is=5120,Zo=5122,Wi=5124,ys=5121,is=5123,Us=5125,Du=5126,qs=5126,Cu={int8:Is,int16:Zo,int32:Wi,uint8:ys,uint16:is,uint32:Us,float:Du,float32:qs},ji=35048,Bi=35040,Ms={dynamic:ji,stream:Bi,static:35044},os=Do.flatten,Ws=Do.shape,Ss=35044,Qs=35040,Qu=5121,xn=5126,Vr=[];Vr[5120]=1,Vr[5122]=2,Vr[5124]=4,Vr[5121]=1,Vr[5123]=2,Vr[5125]=4,Vr[5126]=4;function pa(oe){return fu[Object.prototype.toString.call(oe)]|0}function Fa(oe,vn){for(var qn=0;qn<vn.length;++qn)oe[qn]=vn[qn]}function Vi(oe,vn,qn,ia,Sa,Hr,ea){for(var Ha=0,Wa=0;Wa<qn;++Wa)for(var Ga=0;Ga<ia;++Ga)oe[Ha++]=vn[Sa*Wa+Hr*Ga+ea]}function Ao(oe,vn,qn,ia){var Sa=0,Hr={};function ea(_t){this.id=Sa++,this.buffer=oe.createBuffer(),this.type=_t,this.usage=Ss,this.byteLength=0,this.dimension=1,this.dtype=Qu,this.persistentData=null,qn.profile&&(this.stats={size:0})}ea.prototype.bind=function(){oe.bindBuffer(this.type,this.buffer)},ea.prototype.destroy=function(){M(this)};var Ha=[];function Wa(_t,Pt){var jt=Ha.pop();return jt||(jt=new ea(_t)),jt.bind(),Vn(jt,Pt,Qs,0,1,!1),jt}function Ga(_t){Ha.push(_t)}function Qa(_t,Pt,jt){_t.byteLength=Pt.byteLength,oe.bufferData(_t.type,Pt,jt)}function Vn(_t,Pt,jt,ie,he,Te){var Ke;if(_t.usage=jt,Array.isArray(Pt)){if(_t.dtype=ie||xn,Pt.length>0){var gn;if(Array.isArray(Pt[0])){Ke=Ws(Pt);for(var cn=1,jn=1;jn<Ke.length;++jn)cn*=Ke[jn];_t.dimension=cn,gn=os(Pt,Ke,_t.dtype),Qa(_t,gn,jt),Te?_t.persistentData=gn:zt.freeType(gn)}else if(typeof Pt[0]=="number"){_t.dimension=he;var En=zt.allocType(_t.dtype,Pt.length);Fa(En,Pt),Qa(_t,En,jt),Te?_t.persistentData=En:zt.freeType(En)}else ot(Pt[0])?(_t.dimension=Pt[0].length,_t.dtype=ie||pa(Pt[0])||xn,gn=os(Pt,[Pt.length,Pt[0].length],_t.dtype),Qa(_t,gn,jt),Te?_t.persistentData=gn:zt.freeType(gn)):Rt.raise("invalid buffer data")}}else if(ot(Pt))_t.dtype=ie||pa(Pt),_t.dimension=he,Qa(_t,Pt,jt),Te&&(_t.persistentData=new Uint8Array(new Uint8Array(Pt.buffer)));else if(gi(Pt)){Ke=Pt.shape;var ya=Pt.stride,Dr=Pt.offset,Fr=0,or=0,Xa=0,Hn=0;Ke.length===1?(Fr=Ke[0],or=1,Xa=ya[0],Hn=0):Ke.length===2?(Fr=Ke[0],or=Ke[1],Xa=ya[0],Hn=ya[1]):Rt.raise("invalid shape"),_t.dtype=ie||pa(Pt.data)||xn,_t.dimension=or;var si=zt.allocType(_t.dtype,Fr*or);Vi(si,Pt.data,Fr,or,Xa,Hn,Dr),Qa(_t,si,jt),Te?_t.persistentData=si:zt.freeType(si)}else Pt instanceof ArrayBuffer?(_t.dtype=Qu,_t.dimension=he,Qa(_t,Pt,jt),Te&&(_t.persistentData=new Uint8Array(new Uint8Array(Pt)))):Rt.raise("invalid buffer data")}function M(_t){vn.bufferCount--,ia(_t);var Pt=_t.buffer;Rt(Pt,"buffer must not be deleted already"),oe.deleteBuffer(Pt),_t.buffer=null,delete Hr[_t.id]}function q(_t,Pt,jt,ie){vn.bufferCount++;var he=new ea(Pt);Hr[he.id]=he;function Te(cn){var jn=Ss,En=null,ya=0,Dr=0,Fr=1;return Array.isArray(cn)||ot(cn)||gi(cn)||cn instanceof ArrayBuffer?En=cn:typeof cn=="number"?ya=cn|0:cn&&(Rt.type(cn,"object","buffer arguments must be an object, a number or an array"),"data"in cn&&(Rt(En===null||Array.isArray(En)||ot(En)||gi(En),"invalid data for buffer"),En=cn.data),"usage"in cn&&(Rt.parameter(cn.usage,Ms,"invalid buffer usage"),jn=Ms[cn.usage]),"type"in cn&&(Rt.parameter(cn.type,Cu,"invalid buffer type"),Dr=Cu[cn.type]),"dimension"in cn&&(Rt.type(cn.dimension,"number","invalid dimension"),Fr=cn.dimension|0),"length"in cn&&(Rt.nni(ya,"buffer length must be a nonnegative integer"),ya=cn.length|0)),he.bind(),En?Vn(he,En,jn,Dr,Fr,ie):(ya&&oe.bufferData(he.type,ya,jn),he.dtype=Dr||Qu,he.usage=jn,he.dimension=Fr,he.byteLength=ya),qn.profile&&(he.stats.size=he.byteLength*Vr[he.dtype]),Te}function Ke(cn,jn){Rt(jn+cn.byteLength<=he.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+cn.byteLength+" starting from offset "+jn+" to a buffer of size "+he.byteLength),oe.bufferSubData(he.type,jn,cn)}function gn(cn,jn){var En=(jn||0)|0,ya;if(he.bind(),ot(cn)||cn instanceof ArrayBuffer)Ke(cn,En);else if(Array.isArray(cn)){if(cn.length>0)if(typeof cn[0]=="number"){var Dr=zt.allocType(he.dtype,cn.length);Fa(Dr,cn),Ke(Dr,En),zt.freeType(Dr)}else if(Array.isArray(cn[0])||ot(cn[0])){ya=Ws(cn);var Fr=os(cn,ya,he.dtype);Ke(Fr,En),zt.freeType(Fr)}else Rt.raise("invalid buffer data")}else if(gi(cn)){ya=cn.shape;var or=cn.stride,Xa=0,Hn=0,si=0,Ci=0;ya.length===1?(Xa=ya[0],Hn=1,si=or[0],Ci=0):ya.length===2?(Xa=ya[0],Hn=ya[1],si=or[0],Ci=or[1]):Rt.raise("invalid shape");var Yi=Array.isArray(cn.data)?he.dtype:pa(cn.data),_i=zt.allocType(Yi,Xa*Hn);Vi(_i,cn.data,Xa,Hn,si,Ci,cn.offset),Ke(_i,En),zt.freeType(_i)}else Rt.raise("invalid data for buffer subdata");return Te}return jt||Te(_t),Te._reglType="buffer",Te._buffer=he,Te.subdata=gn,qn.profile&&(Te.stats=he.stats),Te.destroy=function(){M(he)},Te}function dt(){ms(Hr).forEach(function(_t){_t.buffer=oe.createBuffer(),oe.bindBuffer(_t.type,_t.buffer),oe.bufferData(_t.type,_t.persistentData||_t.byteLength,_t.usage)})}return qn.profile&&(vn.getTotalBufferSize=function(){var _t=0;return Object.keys(Hr).forEach(function(Pt){_t+=Hr[Pt].stats.size}),_t}),{create:q,createStream:Wa,destroyStream:Ga,clear:function(){ms(Hr).forEach(M),Ha.forEach(M)},getBuffer:function(_t){return _t&&_t._buffer instanceof ea?_t._buffer:null},restore:dt,_initBuffer:Vn}}var ao=0,So=0,Ts=1,fo=1,ou=4,Cs=4,Au={points:ao,point:So,lines:Ts,line:fo,triangles:ou,triangle:Cs,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Tl=0,bl=1,Js=4,ul=5120,Mu=5121,Pu=5122,Nu=5123,fs=5124,Bs=5125,gu=34963,Fu=35040,Wu=35044;function Ju(oe,vn,qn,ia){var Sa={},Hr=0,ea={uint8:Mu,uint16:Nu};vn.oes_element_index_uint&&(ea.uint32=Bs);function Ha(dt){this.id=Hr++,Sa[this.id]=this,this.buffer=dt,this.primType=Js,this.vertCount=0,this.type=0}Ha.prototype.bind=function(){this.buffer.bind()};var Wa=[];function Ga(dt){var _t=Wa.pop();return _t||(_t=new Ha(qn.create(null,gu,!0,!1)._buffer)),Vn(_t,dt,Fu,-1,-1,0,0),_t}function Qa(dt){Wa.push(dt)}function Vn(dt,_t,Pt,jt,ie,he,Te){dt.buffer.bind();var Ke;if(_t){var gn=Te;!Te&&(!ot(_t)||gi(_t)&&!ot(_t.data))&&(gn=vn.oes_element_index_uint?Bs:Nu),qn._initBuffer(dt.buffer,_t,Pt,gn,3)}else oe.bufferData(gu,he,Pt),dt.buffer.dtype=Ke||Mu,dt.buffer.usage=Pt,dt.buffer.dimension=3,dt.buffer.byteLength=he;if(Ke=Te,!Te){switch(dt.buffer.dtype){case Mu:case ul:Ke=Mu;break;case Nu:case Pu:Ke=Nu;break;case Bs:case fs:Ke=Bs;break;default:Rt.raise("unsupported type for element array")}dt.buffer.dtype=Ke}dt.type=Ke,Rt(Ke!==Bs||!!vn.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var cn=ie;cn<0&&(cn=dt.buffer.byteLength,Ke===Nu?cn>>=1:Ke===Bs&&(cn>>=2)),dt.vertCount=cn;var jn=jt;if(jt<0){jn=Js;var En=dt.buffer.dimension;En===1&&(jn=Tl),En===2&&(jn=bl),En===3&&(jn=Js)}dt.primType=jn}function M(dt){ia.elementsCount--,Rt(dt.buffer!==null,"must not double destroy elements"),delete Sa[dt.id],dt.buffer.destroy(),dt.buffer=null}function q(dt,_t){var Pt=qn.create(null,gu,!0),jt=new Ha(Pt._buffer);ia.elementsCount++;function ie(he){if(!he)Pt(),jt.primType=Js,jt.vertCount=0,jt.type=Mu;else if(typeof he=="number")Pt(he),jt.primType=Js,jt.vertCount=he|0,jt.type=Mu;else{var Te=null,Ke=Wu,gn=-1,cn=-1,jn=0,En=0;Array.isArray(he)||ot(he)||gi(he)?Te=he:(Rt.type(he,"object","invalid arguments for elements"),"data"in he&&(Te=he.data,Rt(Array.isArray(Te)||ot(Te)||gi(Te),"invalid data for element buffer")),"usage"in he&&(Rt.parameter(he.usage,Ms,"invalid element buffer usage"),Ke=Ms[he.usage]),"primitive"in he&&(Rt.parameter(he.primitive,Au,"invalid element buffer primitive"),gn=Au[he.primitive]),"count"in he&&(Rt(typeof he.count=="number"&&he.count>=0,"invalid vertex count for elements"),cn=he.count|0),"type"in he&&(Rt.parameter(he.type,ea,"invalid buffer type"),En=ea[he.type]),"length"in he?jn=he.length|0:(jn=cn,En===Nu||En===Pu?jn*=2:(En===Bs||En===fs)&&(jn*=4))),Vn(jt,Te,Ke,gn,cn,jn,En)}return ie}return ie(dt),ie._reglType="elements",ie._elements=jt,ie.subdata=function(he,Te){return Pt.subdata(he,Te),ie},ie.destroy=function(){M(jt)},ie}return{create:q,createStream:Ga,destroyStream:Qa,getElements:function(dt){return typeof dt=="function"&&dt._elements instanceof Ha?dt._elements:null},clear:function(){ms(Sa).forEach(M)}}}var tu=new Float32Array(1),gc=new Uint32Array(tu.buffer),Bl=5123;function vl(oe){for(var vn=zt.allocType(Bl,oe.length),qn=0;qn<oe.length;++qn)if(isNaN(oe[qn]))vn[qn]=65535;else if(oe[qn]===Infinity)vn[qn]=31744;else if(oe[qn]===-Infinity)vn[qn]=64512;else{tu[0]=oe[qn];var ia=gc[0],Sa=ia>>>31<<15,Hr=(ia<<1>>>24)-127,ea=ia>>13&(1<<10)-1;if(Hr<-24)vn[qn]=Sa;else if(Hr<-14){var Ha=-14-Hr;vn[qn]=Sa+(ea+(1<<10)>>Ha)}else Hr>15?vn[qn]=Sa+31744:vn[qn]=Sa+(Hr+15<<10)+ea}return vn}function Ls(oe){return Array.isArray(oe)||ot(oe)}var el=function(oe){return!(oe&oe-1)&&!!oe},oc=34467,Ol=3553,Ic=34067,Se=34069,ve=6408,Gt=6406,re=6407,me=6409,bn=6410,Zn=32854,Yt=32855,Ie=36194,Ge=32819,Fe=32820,In=33635,ar=34042,ra=6402,Ta=34041,$a=35904,ja=35906,Oa=36193,so=33776,Ai=33777,Oi=33778,hs=33779,wo=35986,ho=35987,Ro=34798,Ys=35840,Ps=35841,As=35842,Vs=35843,su=36196,xl=5121,Rl=5123,Ll=5125,nl=5126,rl=10242,Ef=10243,Sf=10497,Yl=33071,Cf=33648,T=10240,rt=10241,Kt=9728,pe=9729,Re=9984,Je=9985,an=9986,wn=9987,Mn=33170,rr=4352,We=4353,ca=4354,ha=34046,_r=3317,Va=37440,qa=37441,ma=37443,Mi=37444,zo=33984,_o=[Re,an,Je,wn],Lo=[0,me,bn,re,ve],yo={};yo[me]=yo[Gt]=yo[ra]=1,yo[Ta]=yo[bn]=2,yo[re]=yo[$a]=3,yo[ve]=yo[ja]=4;function No(oe){return"[object "+oe+"]"}var Vu=No("HTMLCanvasElement"),Bu=No("OffscreenCanvas"),ju=No("CanvasRenderingContext2D"),tl=No("ImageBitmap"),Hu=No("HTMLImageElement"),al=No("HTMLVideoElement"),il=Object.keys(fu).concat([Vu,Bu,ju,tl,Hu,al]),ds=[];ds[xl]=1,ds[nl]=4,ds[Oa]=2,ds[Rl]=2,ds[Ll]=4;var uu=[];uu[Zn]=2,uu[Yt]=2,uu[Ie]=2,uu[Ta]=4,uu[so]=.5,uu[Ai]=.5,uu[Oi]=1,uu[hs]=1,uu[wo]=.5,uu[ho]=1,uu[Ro]=1,uu[Ys]=.5,uu[Ps]=.25,uu[As]=.5,uu[Vs]=.25,uu[su]=.5;function Jc(oe){return Array.isArray(oe)&&(oe.length===0||typeof oe[0]=="number")}function tf(oe){if(!Array.isArray(oe))return!1;var vn=oe.length;return!(vn===0||!Ls(oe[0]))}function zl(oe){return Object.prototype.toString.call(oe)}function wl(oe){return zl(oe)===Vu}function hh(oe){return zl(oe)===Bu}function Nd(oe){return zl(oe)===ju}function fp(oe){return zl(oe)===tl}function Vp(oe){return zl(oe)===Hu}function dh(oe){return zl(oe)===al}function kd(oe){if(!oe)return!1;var vn=zl(oe);return il.indexOf(vn)>=0?!0:Jc(oe)||tf(oe)||gi(oe)}function jp(oe){return fu[Object.prototype.toString.call(oe)]|0}function df(oe,vn){var qn=vn.length;switch(oe.type){case xl:case Rl:case Ll:case nl:var ia=zt.allocType(oe.type,qn);ia.set(vn),oe.data=ia;break;case Oa:oe.data=vl(vn);break;default:Rt.raise("unsupported texture type, must specify a typed array")}}function Rf(oe,vn){return zt.allocType(oe.type===Oa?nl:oe.type,vn)}function hp(oe,vn){oe.type===Oa?(oe.data=vl(vn),zt.freeType(vn)):oe.data=vn}function jf(oe,vn,qn,ia,Sa,Hr){for(var ea=oe.width,Ha=oe.height,Wa=oe.channels,Ga=ea*Ha*Wa,Qa=Rf(oe,Ga),Vn=0,M=0;M<Ha;++M)for(var q=0;q<ea;++q)for(var dt=0;dt<Wa;++dt)Qa[Vn++]=vn[qn*q+ia*M+Sa*dt+Hr];hp(oe,Qa)}function pf(oe,vn,qn,ia,Sa,Hr){var ea;if(typeof uu[oe]!="undefined"?ea=uu[oe]:ea=yo[oe]*ds[vn],Hr&&(ea*=6),Sa){for(var Ha=0,Wa=qn;Wa>=1;)Ha+=ea*Wa*Wa,Wa/=2;return Ha}else return ea*qn*ia}function ph(oe,vn,qn,ia,Sa,Hr,ea){var Ha={"don't care":rr,"dont care":rr,nice:ca,fast:We},Wa={repeat:Sf,clamp:Yl,mirror:Cf},Ga={nearest:Kt,linear:pe},Qa=$({mipmap:wn,"nearest mipmap nearest":Re,"linear mipmap nearest":Je,"nearest mipmap linear":an,"linear mipmap linear":wn},Ga),Vn={none:0,browser:Mi},M={uint8:xl,rgba4:Ge,rgb565:In,"rgb5 a1":Fe},q={alpha:Gt,luminance:me,"luminance alpha":bn,rgb:re,rgba:ve,rgba4:Zn,"rgb5 a1":Yt,rgb565:Ie},dt={};vn.ext_srgb&&(q.srgb=$a,q.srgba=ja),vn.oes_texture_float&&(M.float32=M.float=nl),vn.oes_texture_half_float&&(M.float16=M["half float"]=Oa),vn.webgl_depth_texture&&($(q,{depth:ra,"depth stencil":Ta}),$(M,{uint16:Rl,uint32:Ll,"depth stencil":ar})),vn.webgl_compressed_texture_s3tc&&$(dt,{"rgb s3tc dxt1":so,"rgba s3tc dxt1":Ai,"rgba s3tc dxt3":Oi,"rgba s3tc dxt5":hs}),vn.webgl_compressed_texture_atc&&$(dt,{"rgb atc":wo,"rgba atc explicit alpha":ho,"rgba atc interpolated alpha":Ro}),vn.webgl_compressed_texture_pvrtc&&$(dt,{"rgb pvrtc 4bppv1":Ys,"rgb pvrtc 2bppv1":Ps,"rgba pvrtc 4bppv1":As,"rgba pvrtc 2bppv1":Vs}),vn.webgl_compressed_texture_etc1&&(dt["rgb etc1"]=su);var _t=Array.prototype.slice.call(oe.getParameter(oc));Object.keys(dt).forEach(function($n){var Jr=dt[$n];_t.indexOf(Jr)>=0&&(q[$n]=Jr)});var Pt=Object.keys(q);qn.textureFormats=Pt;var jt=[];Object.keys(q).forEach(function($n){var Jr=q[$n];jt[Jr]=$n});var ie=[];Object.keys(M).forEach(function($n){var Jr=M[$n];ie[Jr]=$n});var he=[];Object.keys(Ga).forEach(function($n){var Jr=Ga[$n];he[Jr]=$n});var Te=[];Object.keys(Qa).forEach(function($n){var Jr=Qa[$n];Te[Jr]=$n});var Ke=[];Object.keys(Wa).forEach(function($n){var Jr=Wa[$n];Ke[Jr]=$n});var gn=Pt.reduce(function($n,Jr){var Nr=q[Jr];return Nr===me||Nr===Gt||Nr===me||Nr===bn||Nr===ra||Nr===Ta||vn.ext_srgb&&(Nr===$a||Nr===ja)?$n[Nr]=Nr:Nr===Yt||Jr.indexOf("rgba")>=0?$n[Nr]=ve:$n[Nr]=re,$n},{});function cn(){this.internalformat=ve,this.format=ve,this.type=xl,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Mi,this.width=0,this.height=0,this.channels=0}function jn($n,Jr){$n.internalformat=Jr.internalformat,$n.format=Jr.format,$n.type=Jr.type,$n.compressed=Jr.compressed,$n.premultiplyAlpha=Jr.premultiplyAlpha,$n.flipY=Jr.flipY,$n.unpackAlignment=Jr.unpackAlignment,$n.colorSpace=Jr.colorSpace,$n.width=Jr.width,$n.height=Jr.height,$n.channels=Jr.channels}function En($n,Jr){if(!(typeof Jr!="object"||!Jr)){if("premultiplyAlpha"in Jr&&(Rt.type(Jr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),$n.premultiplyAlpha=Jr.premultiplyAlpha),"flipY"in Jr&&(Rt.type(Jr.flipY,"boolean","invalid texture flip"),$n.flipY=Jr.flipY),"alignment"in Jr&&(Rt.oneOf(Jr.alignment,[1,2,4,8],"invalid texture unpack alignment"),$n.unpackAlignment=Jr.alignment),"colorSpace"in Jr&&(Rt.parameter(Jr.colorSpace,Vn,"invalid colorSpace"),$n.colorSpace=Vn[Jr.colorSpace]),"type"in Jr){var Nr=Jr.type;Rt(vn.oes_texture_float||!(Nr==="float"||Nr==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),Rt(vn.oes_texture_half_float||!(Nr==="half float"||Nr==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),Rt(vn.webgl_depth_texture||!(Nr==="uint16"||Nr==="uint32"||Nr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Rt.parameter(Nr,M,"invalid texture type"),$n.type=M[Nr]}var Hi=$n.width,Jo=$n.height,An=$n.channels,sn=!1;"shape"in Jr?(Rt(Array.isArray(Jr.shape)&&Jr.shape.length>=2,"shape must be an array"),Hi=Jr.shape[0],Jo=Jr.shape[1],Jr.shape.length===3&&(An=Jr.shape[2],Rt(An>0&&An<=4,"invalid number of channels"),sn=!0),Rt(Hi>=0&&Hi<=qn.maxTextureSize,"invalid width"),Rt(Jo>=0&&Jo<=qn.maxTextureSize,"invalid height")):("radius"in Jr&&(Hi=Jo=Jr.radius,Rt(Hi>=0&&Hi<=qn.maxTextureSize,"invalid radius")),"width"in Jr&&(Hi=Jr.width,Rt(Hi>=0&&Hi<=qn.maxTextureSize,"invalid width")),"height"in Jr&&(Jo=Jr.height,Rt(Jo>=0&&Jo<=qn.maxTextureSize,"invalid height")),"channels"in Jr&&(An=Jr.channels,Rt(An>0&&An<=4,"invalid number of channels"),sn=!0)),$n.width=Hi|0,$n.height=Jo|0,$n.channels=An|0;var hr=!1;if("format"in Jr){var Pr=Jr.format;Rt(vn.webgl_depth_texture||!(Pr==="depth"||Pr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Rt.parameter(Pr,q,"invalid texture format");var Xr=$n.internalformat=q[Pr];$n.format=gn[Xr],Pr in M&&("type"in Jr||($n.type=M[Pr])),Pr in dt&&($n.compressed=!0),hr=!0}!sn&&hr?$n.channels=yo[$n.format]:sn&&!hr?$n.channels!==Lo[$n.format]&&($n.format=$n.internalformat=Lo[$n.channels]):hr&&sn&&Rt($n.channels===yo[$n.format],"number of channels inconsistent with specified format")}}function ya($n){oe.pixelStorei(Va,$n.flipY),oe.pixelStorei(qa,$n.premultiplyAlpha),oe.pixelStorei(ma,$n.colorSpace),oe.pixelStorei(_r,$n.unpackAlignment)}function Dr(){cn.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Fr($n,Jr){var Nr=null;if(kd(Jr)?Nr=Jr:Jr&&(Rt.type(Jr,"object","invalid pixel data type"),En($n,Jr),"x"in Jr&&($n.xOffset=Jr.x|0),"y"in Jr&&($n.yOffset=Jr.y|0),kd(Jr.data)&&(Nr=Jr.data)),Rt(!$n.compressed||Nr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Jr.copy){Rt(!Nr,"can not specify copy and data field for the same texture");var Hi=Sa.viewportWidth,Jo=Sa.viewportHeight;$n.width=$n.width||Hi-$n.xOffset,$n.height=$n.height||Jo-$n.yOffset,$n.needsCopy=!0,Rt($n.xOffset>=0&&$n.xOffset<Hi&&$n.yOffset>=0&&$n.yOffset<Jo&&$n.width>0&&$n.width<=Hi&&$n.height>0&&$n.height<=Jo,"copy texture read out of bounds")}else if(!Nr)$n.width=$n.width||1,$n.height=$n.height||1,$n.channels=$n.channels||4;else if(ot(Nr))$n.channels=$n.channels||4,$n.data=Nr,!("type"in Jr)&&$n.type===xl&&($n.type=jp(Nr));else if(Jc(Nr))$n.channels=$n.channels||4,df($n,Nr),$n.alignment=1,$n.needsFree=!0;else if(gi(Nr)){var An=Nr.data;!Array.isArray(An)&&$n.type===xl&&($n.type=jp(An));var sn=Nr.shape,hr=Nr.stride,Pr,Xr,yr,vr,Mr,kn;sn.length===3?(yr=sn[2],kn=hr[2]):(Rt(sn.length===2,"invalid ndarray pixel data, must be 2 or 3D"),yr=1,kn=1),Pr=sn[0],Xr=sn[1],vr=hr[0],Mr=hr[1],$n.alignment=1,$n.width=Pr,$n.height=Xr,$n.channels=yr,$n.format=$n.internalformat=Lo[yr],$n.needsFree=!0,jf($n,An,vr,Mr,kn,Nr.offset)}else if(wl(Nr)||hh(Nr)||Nd(Nr))wl(Nr)||hh(Nr)?$n.element=Nr:$n.element=Nr.canvas,$n.width=$n.element.width,$n.height=$n.element.height,$n.channels=4;else if(fp(Nr))$n.element=Nr,$n.width=Nr.width,$n.height=Nr.height,$n.channels=4;else if(Vp(Nr))$n.element=Nr,$n.width=Nr.naturalWidth,$n.height=Nr.naturalHeight,$n.channels=4;else if(dh(Nr))$n.element=Nr,$n.width=Nr.videoWidth,$n.height=Nr.videoHeight,$n.channels=4;else if(tf(Nr)){var fr=$n.width||Nr[0].length,Sn=$n.height||Nr.length,Or=$n.channels;Ls(Nr[0][0])?Or=Or||Nr[0][0].length:Or=Or||1;for(var Zr=Do.shape(Nr),wa=1,Na=0;Na<Zr.length;++Na)wa*=Zr[Na];var ga=Rf($n,wa);Do.flatten(Nr,Zr,"",ga),hp($n,ga),$n.alignment=1,$n.width=fr,$n.height=Sn,$n.channels=Or,$n.format=$n.internalformat=Lo[Or],$n.needsFree=!0}$n.type===nl?Rt(qn.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):$n.type===Oa&&Rt(qn.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function or($n,Jr,Nr){var Hi=$n.element,Jo=$n.data,An=$n.internalformat,sn=$n.format,hr=$n.type,Pr=$n.width,Xr=$n.height;ya($n),Hi?oe.texImage2D(Jr,Nr,sn,sn,hr,Hi):$n.compressed?oe.compressedTexImage2D(Jr,Nr,An,Pr,Xr,0,Jo):$n.needsCopy?(ia(),oe.copyTexImage2D(Jr,Nr,sn,$n.xOffset,$n.yOffset,Pr,Xr,0)):oe.texImage2D(Jr,Nr,sn,Pr,Xr,0,sn,hr,Jo||null)}function Xa($n,Jr,Nr,Hi,Jo){var An=$n.element,sn=$n.data,hr=$n.internalformat,Pr=$n.format,Xr=$n.type,yr=$n.width,vr=$n.height;ya($n),An?oe.texSubImage2D(Jr,Jo,Nr,Hi,Pr,Xr,An):$n.compressed?oe.compressedTexSubImage2D(Jr,Jo,Nr,Hi,hr,yr,vr,sn):$n.needsCopy?(ia(),oe.copyTexSubImage2D(Jr,Jo,Nr,Hi,$n.xOffset,$n.yOffset,yr,vr)):oe.texSubImage2D(Jr,Jo,Nr,Hi,yr,vr,Pr,Xr,sn)}var Hn=[];function si(){return Hn.pop()||new Dr}function Ci($n){$n.needsFree&&zt.freeType($n.data),Dr.call($n),Hn.push($n)}function Yi(){cn.call(this),this.genMipmaps=!1,this.mipmapHint=rr,this.mipmask=0,this.images=Array(16)}function _i($n,Jr,Nr){var Hi=$n.images[0]=si();$n.mipmask=1,Hi.width=$n.width=Jr,Hi.height=$n.height=Nr,Hi.channels=$n.channels=4}function Yo($n,Jr){var Nr=null;if(kd(Jr))Nr=$n.images[0]=si(),jn(Nr,$n),Fr(Nr,Jr),$n.mipmask=1;else if(En($n,Jr),Array.isArray(Jr.mipmap))for(var Hi=Jr.mipmap,Jo=0;Jo<Hi.length;++Jo)Nr=$n.images[Jo]=si(),jn(Nr,$n),Nr.width>>=Jo,Nr.height>>=Jo,Fr(Nr,Hi[Jo]),$n.mipmask|=1<<Jo;else Nr=$n.images[0]=si(),jn(Nr,$n),Fr(Nr,Jr),$n.mipmask=1;jn($n,$n.images[0]),$n.compressed&&($n.internalformat===so||$n.internalformat===Ai||$n.internalformat===Oi||$n.internalformat===hs)&&Rt($n.width%4==0&&$n.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function xi($n,Jr){for(var Nr=$n.images,Hi=0;Hi<Nr.length;++Hi){if(!Nr[Hi])return;or(Nr[Hi],Jr,Hi)}}var Xu=[];function jo(){var $n=Xu.pop()||new Yi;cn.call($n),$n.mipmask=0;for(var Jr=0;Jr<16;++Jr)$n.images[Jr]=null;return $n}function Fl($n){for(var Jr=$n.images,Nr=0;Nr<Jr.length;++Nr)Jr[Nr]&&Ci(Jr[Nr]),Jr[Nr]=null;Xu.push($n)}function ku(){this.minFilter=Kt,this.magFilter=Kt,this.wrapS=Yl,this.wrapT=Yl,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=rr}function xs($n,Jr){if("min"in Jr){var Nr=Jr.min;Rt.parameter(Nr,Qa),$n.minFilter=Qa[Nr],_o.indexOf($n.minFilter)>=0&&!("faces"in Jr)&&($n.genMipmaps=!0)}if("mag"in Jr){var Hi=Jr.mag;Rt.parameter(Hi,Ga),$n.magFilter=Ga[Hi]}var Jo=$n.wrapS,An=$n.wrapT;if("wrap"in Jr){var sn=Jr.wrap;typeof sn=="string"?(Rt.parameter(sn,Wa),Jo=An=Wa[sn]):Array.isArray(sn)&&(Rt.parameter(sn[0],Wa),Rt.parameter(sn[1],Wa),Jo=Wa[sn[0]],An=Wa[sn[1]])}else{if("wrapS"in Jr){var hr=Jr.wrapS;Rt.parameter(hr,Wa),Jo=Wa[hr]}if("wrapT"in Jr){var Pr=Jr.wrapT;Rt.parameter(Pr,Wa),An=Wa[Pr]}}if($n.wrapS=Jo,$n.wrapT=An,"anisotropic"in Jr){var Xr=Jr.anisotropic;Rt(typeof Xr=="number"&&Xr>=1&&Xr<=qn.maxAnisotropic,"aniso samples must be between 1 and "),$n.anisotropic=Jr.anisotropic}if("mipmap"in Jr){var yr=!1;switch(typeof Jr.mipmap){case"string":Rt.parameter(Jr.mipmap,Ha,"invalid mipmap hint"),$n.mipmapHint=Ha[Jr.mipmap],$n.genMipmaps=!0,yr=!0;break;case"boolean":yr=$n.genMipmaps=Jr.mipmap;break;case"object":Rt(Array.isArray(Jr.mipmap),"invalid mipmap type"),$n.genMipmaps=!1,yr=!0;break;default:Rt.raise("invalid mipmap type")}yr&&!("min"in Jr)&&($n.minFilter=Re)}}function _u($n,Jr){oe.texParameteri(Jr,rt,$n.minFilter),oe.texParameteri(Jr,T,$n.magFilter),oe.texParameteri(Jr,rl,$n.wrapS),oe.texParameteri(Jr,Ef,$n.wrapT),vn.ext_texture_filter_anisotropic&&oe.texParameteri(Jr,ha,$n.anisotropic),$n.genMipmaps&&(oe.hint(Mn,$n.mipmapHint),oe.generateMipmap(Jr))}var cl=0,zi={},zu=qn.maxTextureUnits,sl=Array(zu).map(function(){return null});function Qo($n){cn.call(this),this.mipmask=0,this.internalformat=ve,this.id=cl++,this.refCount=1,this.target=$n,this.texture=oe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new ku,ea.profile&&(this.stats={size:0})}function Zl($n){oe.activeTexture(zo),oe.bindTexture($n.target,$n.texture)}function yu(){var $n=sl[0];$n?oe.bindTexture($n.target,$n.texture):oe.bindTexture(Ol,null)}function po($n){var Jr=$n.texture;Rt(Jr,"must not double destroy texture");var Nr=$n.unit,Hi=$n.target;Nr>=0&&(oe.activeTexture(zo+Nr),oe.bindTexture(Hi,null),sl[Nr]=null),oe.deleteTexture(Jr),$n.texture=null,$n.params=null,$n.pixels=null,$n.refCount=0,delete zi[$n.id],Hr.textureCount--}$(Qo.prototype,{bind:function(){var $n=this;$n.bindCount+=1;var Jr=$n.unit;if(Jr<0){for(var Nr=0;Nr<zu;++Nr){var Hi=sl[Nr];if(Hi){if(Hi.bindCount>0)continue;Hi.unit=-1}sl[Nr]=$n,Jr=Nr;break}Jr>=zu&&Rt.raise("insufficient number of texture units"),ea.profile&&Hr.maxTextureUnits<Jr+1&&(Hr.maxTextureUnits=Jr+1),$n.unit=Jr,oe.activeTexture(zo+Jr),oe.bindTexture($n.target,$n.texture)}return Jr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&po(this)}});function Ds($n,Jr){var Nr=new Qo(Ol);zi[Nr.id]=Nr,Hr.textureCount++;function Hi(sn,hr){var Pr=Nr.texInfo;ku.call(Pr);var Xr=jo();return typeof sn=="number"?typeof hr=="number"?_i(Xr,sn|0,hr|0):_i(Xr,sn|0,sn|0):sn?(Rt.type(sn,"object","invalid arguments to regl.texture"),xs(Pr,sn),Yo(Xr,sn)):_i(Xr,1,1),Pr.genMipmaps&&(Xr.mipmask=(Xr.width<<1)-1),Nr.mipmask=Xr.mipmask,jn(Nr,Xr),Rt.texture2D(Pr,Xr,qn),Nr.internalformat=Xr.internalformat,Hi.width=Xr.width,Hi.height=Xr.height,Zl(Nr),xi(Xr,Ol),_u(Pr,Ol),yu(),Fl(Xr),ea.profile&&(Nr.stats.size=pf(Nr.internalformat,Nr.type,Xr.width,Xr.height,Pr.genMipmaps,!1)),Hi.format=jt[Nr.internalformat],Hi.type=ie[Nr.type],Hi.mag=he[Pr.magFilter],Hi.min=Te[Pr.minFilter],Hi.wrapS=Ke[Pr.wrapS],Hi.wrapT=Ke[Pr.wrapT],Hi}function Jo(sn,hr,Pr,Xr){Rt(!!sn,"must specify image data");var yr=hr|0,vr=Pr|0,Mr=Xr|0,kn=si();return jn(kn,Nr),kn.width=0,kn.height=0,Fr(kn,sn),kn.width=kn.width||(Nr.width>>Mr)-yr,kn.height=kn.height||(Nr.height>>Mr)-vr,Rt(Nr.type===kn.type&&Nr.format===kn.format&&Nr.internalformat===kn.internalformat,"incompatible format for texture.subimage"),Rt(yr>=0&&vr>=0&&yr+kn.width<=Nr.width&&vr+kn.height<=Nr.height,"texture.subimage write out of bounds"),Rt(Nr.mipmask&1<<Mr,"missing mipmap data"),Rt(kn.data||kn.element||kn.needsCopy,"missing image data"),Zl(Nr),Xa(kn,Ol,yr,vr,Mr),yu(),Ci(kn),Hi}function An(sn,hr){var Pr=sn|0,Xr=hr|0||Pr;if(Pr===Nr.width&&Xr===Nr.height)return Hi;Hi.width=Nr.width=Pr,Hi.height=Nr.height=Xr,Zl(Nr);for(var yr=0;Nr.mipmask>>yr;++yr){var vr=Pr>>yr,Mr=Xr>>yr;if(!vr||!Mr)break;oe.texImage2D(Ol,yr,Nr.format,vr,Mr,0,Nr.format,Nr.type,null)}return yu(),ea.profile&&(Nr.stats.size=pf(Nr.internalformat,Nr.type,Pr,Xr,!1,!1)),Hi}return Hi($n,Jr),Hi.subimage=Jo,Hi.resize=An,Hi._reglType="texture2d",Hi._texture=Nr,ea.profile&&(Hi.stats=Nr.stats),Hi.destroy=function(){Nr.decRef()},Hi}function pi($n,Jr,Nr,Hi,Jo,An){var sn=new Qo(Ic);zi[sn.id]=sn,Hr.cubeCount++;var hr=new Array(6);function Pr(vr,Mr,kn,fr,Sn,Or){var Zr,wa=sn.texInfo;for(ku.call(wa),Zr=0;Zr<6;++Zr)hr[Zr]=jo();if(typeof vr=="number"||!vr){var Na=vr|0||1;for(Zr=0;Zr<6;++Zr)_i(hr[Zr],Na,Na)}else if(typeof vr=="object")if(Mr)Yo(hr[0],vr),Yo(hr[1],Mr),Yo(hr[2],kn),Yo(hr[3],fr),Yo(hr[4],Sn),Yo(hr[5],Or);else if(xs(wa,vr),En(sn,vr),"faces"in vr){var ga=vr.faces;for(Rt(Array.isArray(ga)&&ga.length===6,"cube faces must be a length 6 array"),Zr=0;Zr<6;++Zr)Rt(typeof ga[Zr]=="object"&&!!ga[Zr],"invalid input for cube map face"),jn(hr[Zr],sn),Yo(hr[Zr],ga[Zr])}else for(Zr=0;Zr<6;++Zr)Yo(hr[Zr],vr);else Rt.raise("invalid arguments to cube map");for(jn(sn,hr[0]),qn.npotTextureCube||Rt(el(sn.width)&&el(sn.height),"your browser does not support non power or two texture dimensions"),wa.genMipmaps?sn.mipmask=(hr[0].width<<1)-1:sn.mipmask=hr[0].mipmask,Rt.textureCube(sn,wa,hr,qn),sn.internalformat=hr[0].internalformat,Pr.width=hr[0].width,Pr.height=hr[0].height,Zl(sn),Zr=0;Zr<6;++Zr)xi(hr[Zr],Se+Zr);for(_u(wa,Ic),yu(),ea.profile&&(sn.stats.size=pf(sn.internalformat,sn.type,Pr.width,Pr.height,wa.genMipmaps,!0)),Pr.format=jt[sn.internalformat],Pr.type=ie[sn.type],Pr.mag=he[wa.magFilter],Pr.min=Te[wa.minFilter],Pr.wrapS=Ke[wa.wrapS],Pr.wrapT=Ke[wa.wrapT],Zr=0;Zr<6;++Zr)Fl(hr[Zr]);return Pr}function Xr(vr,Mr,kn,fr,Sn){Rt(!!Mr,"must specify image data"),Rt(typeof vr=="number"&&vr===(vr|0)&&vr>=0&&vr<6,"invalid face");var Or=kn|0,Zr=fr|0,wa=Sn|0,Na=si();return jn(Na,sn),Na.width=0,Na.height=0,Fr(Na,Mr),Na.width=Na.width||(sn.width>>wa)-Or,Na.height=Na.height||(sn.height>>wa)-Zr,Rt(sn.type===Na.type&&sn.format===Na.format&&sn.internalformat===Na.internalformat,"incompatible format for texture.subimage"),Rt(Or>=0&&Zr>=0&&Or+Na.width<=sn.width&&Zr+Na.height<=sn.height,"texture.subimage write out of bounds"),Rt(sn.mipmask&1<<wa,"missing mipmap data"),Rt(Na.data||Na.element||Na.needsCopy,"missing image data"),Zl(sn),Xa(Na,Se+vr,Or,Zr,wa),yu(),Ci(Na),Pr}function yr(vr){var Mr=vr|0;if(Mr!==sn.width){Pr.width=sn.width=Mr,Pr.height=sn.height=Mr,Zl(sn);for(var kn=0;kn<6;++kn)for(var fr=0;sn.mipmask>>fr;++fr)oe.texImage2D(Se+kn,fr,sn.format,Mr>>fr,Mr>>fr,0,sn.format,sn.type,null);return yu(),ea.profile&&(sn.stats.size=pf(sn.internalformat,sn.type,Pr.width,Pr.height,!1,!0)),Pr}}return Pr($n,Jr,Nr,Hi,Jo,An),Pr.subimage=Xr,Pr.resize=yr,Pr._reglType="textureCube",Pr._texture=sn,ea.profile&&(Pr.stats=sn.stats),Pr.destroy=function(){sn.decRef()},Pr}function Sl(){for(var $n=0;$n<zu;++$n)oe.activeTexture(zo+$n),oe.bindTexture(Ol,null),sl[$n]=null;ms(zi).forEach(po),Hr.cubeCount=0,Hr.textureCount=0}ea.profile&&(Hr.getTotalTextureSize=function(){var $n=0;return Object.keys(zi).forEach(function(Jr){$n+=zi[Jr].stats.size}),$n});function rh(){for(var $n=0;$n<zu;++$n){var Jr=sl[$n];Jr&&(Jr.bindCount=0,Jr.unit=-1,sl[$n]=null)}ms(zi).forEach(function(Nr){Nr.texture=oe.createTexture(),oe.bindTexture(Nr.target,Nr.texture);for(var Hi=0;Hi<32;++Hi)if((Nr.mipmask&1<<Hi)!=0)if(Nr.target===Ol)oe.texImage2D(Ol,Hi,Nr.internalformat,Nr.width>>Hi,Nr.height>>Hi,0,Nr.internalformat,Nr.type,null);else for(var Jo=0;Jo<6;++Jo)oe.texImage2D(Se+Jo,Hi,Nr.internalformat,Nr.width>>Hi,Nr.height>>Hi,0,Nr.internalformat,Nr.type,null);_u(Nr.texInfo,Nr.target)})}function fl(){for(var $n=0;$n<zu;++$n){var Jr=sl[$n];Jr&&(Jr.bindCount=0,Jr.unit=-1,sl[$n]=null),oe.activeTexture(zo+$n),oe.bindTexture(Ol,null),oe.bindTexture(Ic,null)}}return{create2D:Ds,createCube:pi,clear:Sl,getTexture:function($n){return null},restore:rh,refresh:fl}}var Ri=36161,Lh=32854,bs=32855,Ph=36194,sc=33189,ef=36168,vf=34041,vh=35907,Lf=34836,js=34842,dp=34843,Pl=[];Pl[Lh]=2,Pl[bs]=2,Pl[Ph]=2,Pl[sc]=2,Pl[ef]=1,Pl[vf]=4,Pl[vh]=4,Pl[Lf]=16,Pl[js]=8,Pl[dp]=6;function Dt(oe,vn,qn){return Pl[oe]*vn*qn}var ae=function(oe,vn,qn,ia,Sa){var Hr={rgba4:Lh,rgb565:Ph,"rgb5 a1":bs,depth:sc,stencil:ef,"depth stencil":vf};vn.ext_srgb&&(Hr.srgba=vh),vn.ext_color_buffer_half_float&&(Hr.rgba16f=js,Hr.rgb16f=dp),vn.webgl_color_buffer_float&&(Hr.rgba32f=Lf);var ea=[];Object.keys(Hr).forEach(function(q){var dt=Hr[q];ea[dt]=q});var Ha=0,Wa={};function Ga(q){this.id=Ha++,this.refCount=1,this.renderbuffer=q,this.format=Lh,this.width=0,this.height=0,Sa.profile&&(this.stats={size:0})}Ga.prototype.decRef=function(){--this.refCount<=0&&Qa(this)};function Qa(q){var dt=q.renderbuffer;Rt(dt,"must not double destroy renderbuffer"),oe.bindRenderbuffer(Ri,null),oe.deleteRenderbuffer(dt),q.renderbuffer=null,q.refCount=0,delete Wa[q.id],ia.renderbufferCount--}function Vn(q,dt){var _t=new Ga(oe.createRenderbuffer());Wa[_t.id]=_t,ia.renderbufferCount++;function Pt(ie,he){var Te=0,Ke=0,gn=Lh;if(typeof ie=="object"&&ie){var cn=ie;if("shape"in cn){var jn=cn.shape;Rt(Array.isArray(jn)&&jn.length>=2,"invalid renderbuffer shape"),Te=jn[0]|0,Ke=jn[1]|0}else"radius"in cn&&(Te=Ke=cn.radius|0),"width"in cn&&(Te=cn.width|0),"height"in cn&&(Ke=cn.height|0);"format"in cn&&(Rt.parameter(cn.format,Hr,"invalid renderbuffer format"),gn=Hr[cn.format])}else typeof ie=="number"?(Te=ie|0,typeof he=="number"?Ke=he|0:Ke=Te):ie?Rt.raise("invalid arguments to renderbuffer constructor"):Te=Ke=1;if(Rt(Te>0&&Ke>0&&Te<=qn.maxRenderbufferSize&&Ke<=qn.maxRenderbufferSize,"invalid renderbuffer size"),!(Te===_t.width&&Ke===_t.height&&gn===_t.format))return Pt.width=_t.width=Te,Pt.height=_t.height=Ke,_t.format=gn,oe.bindRenderbuffer(Ri,_t.renderbuffer),oe.renderbufferStorage(Ri,gn,Te,Ke),Rt(oe.getError()===0,"invalid render buffer format"),Sa.profile&&(_t.stats.size=Dt(_t.format,_t.width,_t.height)),Pt.format=ea[_t.format],Pt}function jt(ie,he){var Te=ie|0,Ke=he|0||Te;return Te===_t.width&&Ke===_t.height||(Rt(Te>0&&Ke>0&&Te<=qn.maxRenderbufferSize&&Ke<=qn.maxRenderbufferSize,"invalid renderbuffer size"),Pt.width=_t.width=Te,Pt.height=_t.height=Ke,oe.bindRenderbuffer(Ri,_t.renderbuffer),oe.renderbufferStorage(Ri,_t.format,Te,Ke),Rt(oe.getError()===0,"invalid render buffer format"),Sa.profile&&(_t.stats.size=Dt(_t.format,_t.width,_t.height))),Pt}return Pt(q,dt),Pt.resize=jt,Pt._reglType="renderbuffer",Pt._renderbuffer=_t,Sa.profile&&(Pt.stats=_t.stats),Pt.destroy=function(){_t.decRef()},Pt}Sa.profile&&(ia.getTotalRenderbufferSize=function(){var q=0;return Object.keys(Wa).forEach(function(dt){q+=Wa[dt].stats.size}),q});function M(){ms(Wa).forEach(function(q){q.renderbuffer=oe.createRenderbuffer(),oe.bindRenderbuffer(Ri,q.renderbuffer),oe.renderbufferStorage(Ri,q.format,q.width,q.height)}),oe.bindRenderbuffer(Ri,null)}return{create:Vn,clear:function(){ms(Wa).forEach(Qa)},restore:M}},xe=36160,qe=36161,yn=3553,Er=34069,Cr=36064,oa=36096,Nn=36128,Pa=33306,wi=36053,Ui=36054,Ei=36055,Oo=36057,us=36061,Vo=36193,uo=5121,$o=5126,Si=6407,ns=6408,Xo=6402,eo=[Si,ns],qo=[];qo[ns]=4,qo[Si]=3;var Ns=[];Ns[uo]=1,Ns[$o]=4,Ns[Vo]=2;var lu=32854,ls=32855,ks=36194,Ou=33189,lr=36168,ll=34041,mo=35907,Hf=34836,mc=34842,Xc=34843,Jl=[lu,ls,ks,mo,mc,Xc,Hf],Kl={};Kl[wi]="complete",Kl[Ui]="incomplete attachment",Kl[Oo]="incomplete dimensions",Kl[Ei]="incomplete, missing attachment",Kl[us]="unsupported";function Xf(oe,vn,qn,ia,Sa,Hr){var ea={cur:null,next:null,dirty:!1,setFBO:null},Ha=["rgba"],Wa=["rgba4","rgb565","rgb5 a1"];vn.ext_srgb&&Wa.push("srgba"),vn.ext_color_buffer_half_float&&Wa.push("rgba16f","rgb16f"),vn.webgl_color_buffer_float&&Wa.push("rgba32f");var Ga=["uint8"];vn.oes_texture_half_float&&Ga.push("half float","float16"),vn.oes_texture_float&&Ga.push("float","float32");function Qa(Dr,Fr,or){this.target=Dr,this.texture=Fr,this.renderbuffer=or;var Xa=0,Hn=0;Fr?(Xa=Fr.width,Hn=Fr.height):or&&(Xa=or.width,Hn=or.height),this.width=Xa,this.height=Hn}function Vn(Dr){Dr&&(Dr.texture&&Dr.texture._texture.decRef(),Dr.renderbuffer&&Dr.renderbuffer._renderbuffer.decRef())}function M(Dr,Fr,or){if(!!Dr)if(Dr.texture){var Xa=Dr.texture._texture,Hn=Math.max(1,Xa.width),si=Math.max(1,Xa.height);Rt(Hn===Fr&&si===or,"inconsistent width/height for supplied texture"),Xa.refCount+=1}else{var Ci=Dr.renderbuffer._renderbuffer;Rt(Ci.width===Fr&&Ci.height===or,"inconsistent width/height for renderbuffer"),Ci.refCount+=1}}function q(Dr,Fr){Fr&&(Fr.texture?oe.framebufferTexture2D(xe,Dr,Fr.target,Fr.texture._texture.texture,0):oe.framebufferRenderbuffer(xe,Dr,qe,Fr.renderbuffer._renderbuffer.renderbuffer))}function dt(Dr){var Fr=yn,or=null,Xa=null,Hn=Dr;typeof Dr=="object"&&(Hn=Dr.data,"target"in Dr&&(Fr=Dr.target|0)),Rt.type(Hn,"function","invalid attachment data");var si=Hn._reglType;return si==="texture2d"?(or=Hn,Rt(Fr===yn)):si==="textureCube"?(or=Hn,Rt(Fr>=Er&&Fr<Er+6,"invalid cube map target")):si==="renderbuffer"?(Xa=Hn,Fr=qe):Rt.raise("invalid regl object for attachment"),new Qa(Fr,or,Xa)}function _t(Dr,Fr,or,Xa,Hn){if(or){var si=ia.create2D({width:Dr,height:Fr,format:Xa,type:Hn});return si._texture.refCount=0,new Qa(yn,si,null)}else{var Ci=Sa.create({width:Dr,height:Fr,format:Xa});return Ci._renderbuffer.refCount=0,new Qa(qe,null,Ci)}}function Pt(Dr){return Dr&&(Dr.texture||Dr.renderbuffer)}function jt(Dr,Fr,or){Dr&&(Dr.texture?Dr.texture.resize(Fr,or):Dr.renderbuffer&&Dr.renderbuffer.resize(Fr,or),Dr.width=Fr,Dr.height=or)}var ie=0,he={};function Te(){this.id=ie++,he[this.id]=this,this.framebuffer=oe.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ke(Dr){Dr.colorAttachments.forEach(Vn),Vn(Dr.depthAttachment),Vn(Dr.stencilAttachment),Vn(Dr.depthStencilAttachment)}function gn(Dr){var Fr=Dr.framebuffer;Rt(Fr,"must not double destroy framebuffer"),oe.deleteFramebuffer(Fr),Dr.framebuffer=null,Hr.framebufferCount--,delete he[Dr.id]}function cn(Dr){var Fr;oe.bindFramebuffer(xe,Dr.framebuffer);var or=Dr.colorAttachments;for(Fr=0;Fr<or.length;++Fr)q(Cr+Fr,or[Fr]);for(Fr=or.length;Fr<qn.maxColorAttachments;++Fr)oe.framebufferTexture2D(xe,Cr+Fr,yn,null,0);oe.framebufferTexture2D(xe,Pa,yn,null,0),oe.framebufferTexture2D(xe,oa,yn,null,0),oe.framebufferTexture2D(xe,Nn,yn,null,0),q(oa,Dr.depthAttachment),q(Nn,Dr.stencilAttachment),q(Pa,Dr.depthStencilAttachment);var Xa=oe.checkFramebufferStatus(xe);!oe.isContextLost()&&Xa!==wi&&Rt.raise("framebuffer configuration not supported, status = "+Kl[Xa]),oe.bindFramebuffer(xe,ea.next?ea.next.framebuffer:null),ea.cur=ea.next,oe.getError()}function jn(Dr,Fr){var or=new Te;Hr.framebufferCount++;function Xa(si,Ci){var Yi;Rt(ea.next!==or,"can not update framebuffer which is currently in use");var _i=0,Yo=0,xi=!0,Xu=!0,jo=null,Fl=!0,ku="rgba",xs="uint8",_u=1,cl=null,zi=null,zu=null,sl=!1;if(typeof si=="number")_i=si|0,Yo=Ci|0||_i;else if(!si)_i=Yo=1;else{Rt.type(si,"object","invalid arguments for framebuffer");var Qo=si;if("shape"in Qo){var Zl=Qo.shape;Rt(Array.isArray(Zl)&&Zl.length>=2,"invalid shape for framebuffer"),_i=Zl[0],Yo=Zl[1]}else"radius"in Qo&&(_i=Yo=Qo.radius),"width"in Qo&&(_i=Qo.width),"height"in Qo&&(Yo=Qo.height);("color"in Qo||"colors"in Qo)&&(jo=Qo.color||Qo.colors,Array.isArray(jo)&&Rt(jo.length===1||vn.webgl_draw_buffers,"multiple render targets not supported")),jo||("colorCount"in Qo&&(_u=Qo.colorCount|0,Rt(_u>0,"invalid color buffer count")),"colorTexture"in Qo&&(Fl=!!Qo.colorTexture,ku="rgba4"),"colorType"in Qo&&(xs=Qo.colorType,Fl?(Rt(vn.oes_texture_float||!(xs==="float"||xs==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),Rt(vn.oes_texture_half_float||!(xs==="half float"||xs==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):xs==="half float"||xs==="float16"?(Rt(vn.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),ku="rgba16f"):(xs==="float"||xs==="float32")&&(Rt(vn.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),ku="rgba32f"),Rt.oneOf(xs,Ga,"invalid color type")),"colorFormat"in Qo&&(ku=Qo.colorFormat,Ha.indexOf(ku)>=0?Fl=!0:Wa.indexOf(ku)>=0?Fl=!1:Fl?Rt.oneOf(Qo.colorFormat,Ha,"invalid color format for texture"):Rt.oneOf(Qo.colorFormat,Wa,"invalid color format for renderbuffer"))),("depthTexture"in Qo||"depthStencilTexture"in Qo)&&(sl=!!(Qo.depthTexture||Qo.depthStencilTexture),Rt(!sl||vn.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Qo&&(typeof Qo.depth=="boolean"?xi=Qo.depth:(cl=Qo.depth,Xu=!1)),"stencil"in Qo&&(typeof Qo.stencil=="boolean"?Xu=Qo.stencil:(zi=Qo.stencil,xi=!1)),"depthStencil"in Qo&&(typeof Qo.depthStencil=="boolean"?xi=Xu=Qo.depthStencil:(zu=Qo.depthStencil,xi=!1,Xu=!1))}var yu=null,po=null,Ds=null,pi=null;if(Array.isArray(jo))yu=jo.map(dt);else if(jo)yu=[dt(jo)];else for(yu=new Array(_u),Yi=0;Yi<_u;++Yi)yu[Yi]=_t(_i,Yo,Fl,ku,xs);Rt(vn.webgl_draw_buffers||yu.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),Rt(yu.length<=qn.maxColorAttachments,"too many color attachments, not supported"),_i=_i||yu[0].width,Yo=Yo||yu[0].height,cl?po=dt(cl):xi&&!Xu&&(po=_t(_i,Yo,sl,"depth","uint32")),zi?Ds=dt(zi):Xu&&!xi&&(Ds=_t(_i,Yo,!1,"stencil","uint8")),zu?pi=dt(zu):!cl&&!zi&&Xu&&xi&&(pi=_t(_i,Yo,sl,"depth stencil","depth stencil")),Rt(!!cl+!!zi+!!zu<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Sl=null;for(Yi=0;Yi<yu.length;++Yi)if(M(yu[Yi],_i,Yo),Rt(!yu[Yi]||yu[Yi].texture&&eo.indexOf(yu[Yi].texture._texture.format)>=0||yu[Yi].renderbuffer&&Jl.indexOf(yu[Yi].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Yi+" is invalid"),yu[Yi]&&yu[Yi].texture){var rh=qo[yu[Yi].texture._texture.format]*Ns[yu[Yi].texture._texture.type];Sl===null?Sl=rh:Rt(Sl===rh,"all color attachments much have the same number of bits per pixel.")}return M(po,_i,Yo),Rt(!po||po.texture&&po.texture._texture.format===Xo||po.renderbuffer&&po.renderbuffer._renderbuffer.format===Ou,"invalid depth attachment for framebuffer object"),M(Ds,_i,Yo),Rt(!Ds||Ds.renderbuffer&&Ds.renderbuffer._renderbuffer.format===lr,"invalid stencil attachment for framebuffer object"),M(pi,_i,Yo),Rt(!pi||pi.texture&&pi.texture._texture.format===ll||pi.renderbuffer&&pi.renderbuffer._renderbuffer.format===ll,"invalid depth-stencil attachment for framebuffer object"),Ke(or),or.width=_i,or.height=Yo,or.colorAttachments=yu,or.depthAttachment=po,or.stencilAttachment=Ds,or.depthStencilAttachment=pi,Xa.color=yu.map(Pt),Xa.depth=Pt(po),Xa.stencil=Pt(Ds),Xa.depthStencil=Pt(pi),Xa.width=or.width,Xa.height=or.height,cn(or),Xa}function Hn(si,Ci){Rt(ea.next!==or,"can not resize a framebuffer which is currently in use");var Yi=Math.max(si|0,1),_i=Math.max(Ci|0||Yi,1);if(Yi===or.width&&_i===or.height)return Xa;for(var Yo=or.colorAttachments,xi=0;xi<Yo.length;++xi)jt(Yo[xi],Yi,_i);return jt(or.depthAttachment,Yi,_i),jt(or.stencilAttachment,Yi,_i),jt(or.depthStencilAttachment,Yi,_i),or.width=Xa.width=Yi,or.height=Xa.height=_i,cn(or),Xa}return Xa(Dr,Fr),$(Xa,{resize:Hn,_reglType:"framebuffer",_framebuffer:or,destroy:function(){gn(or),Ke(or)},use:function(si){ea.setFBO({framebuffer:Xa},si)}})}function En(Dr){var Fr=Array(6);function or(Hn){var si;Rt(Fr.indexOf(ea.next)<0,"can not update framebuffer which is currently in use");var Ci={color:null},Yi=0,_i=null,Yo="rgba",xi="uint8",Xu=1;if(typeof Hn=="number")Yi=Hn|0;else if(!Hn)Yi=1;else{Rt.type(Hn,"object","invalid arguments for framebuffer");var jo=Hn;if("shape"in jo){var Fl=jo.shape;Rt(Array.isArray(Fl)&&Fl.length>=2,"invalid shape for framebuffer"),Rt(Fl[0]===Fl[1],"cube framebuffer must be square"),Yi=Fl[0]}else"radius"in jo&&(Yi=jo.radius|0),"width"in jo?(Yi=jo.width|0,"height"in jo&&Rt(jo.height===Yi,"must be square")):"height"in jo&&(Yi=jo.height|0);("color"in jo||"colors"in jo)&&(_i=jo.color||jo.colors,Array.isArray(_i)&&Rt(_i.length===1||vn.webgl_draw_buffers,"multiple render targets not supported")),_i||("colorCount"in jo&&(Xu=jo.colorCount|0,Rt(Xu>0,"invalid color buffer count")),"colorType"in jo&&(Rt.oneOf(jo.colorType,Ga,"invalid color type"),xi=jo.colorType),"colorFormat"in jo&&(Yo=jo.colorFormat,Rt.oneOf(jo.colorFormat,Ha,"invalid color format for texture"))),"depth"in jo&&(Ci.depth=jo.depth),"stencil"in jo&&(Ci.stencil=jo.stencil),"depthStencil"in jo&&(Ci.depthStencil=jo.depthStencil)}var ku;if(_i)if(Array.isArray(_i))for(ku=[],si=0;si<_i.length;++si)ku[si]=_i[si];else ku=[_i];else{ku=Array(Xu);var xs={radius:Yi,format:Yo,type:xi};for(si=0;si<Xu;++si)ku[si]=ia.createCube(xs)}for(Ci.color=Array(ku.length),si=0;si<ku.length;++si){var _u=ku[si];Rt(typeof _u=="function"&&_u._reglType==="textureCube","invalid cube map"),Yi=Yi||_u.width,Rt(_u.width===Yi&&_u.height===Yi,"invalid cube map shape"),Ci.color[si]={target:Er,data:ku[si]}}for(si=0;si<6;++si){for(var cl=0;cl<ku.length;++cl)Ci.color[cl].target=Er+si;si>0&&(Ci.depth=Fr[0].depth,Ci.stencil=Fr[0].stencil,Ci.depthStencil=Fr[0].depthStencil),Fr[si]?Fr[si](Ci):Fr[si]=jn(Ci)}return $(or,{width:Yi,height:Yi,color:ku})}function Xa(Hn){var si,Ci=Hn|0;if(Rt(Ci>0&&Ci<=qn.maxCubeMapSize,"invalid radius for cube fbo"),Ci===or.width)return or;var Yi=or.color;for(si=0;si<Yi.length;++si)Yi[si].resize(Ci);for(si=0;si<6;++si)Fr[si].resize(Ci);return or.width=or.height=Ci,or}return or(Dr),$(or,{faces:Fr,resize:Xa,_reglType:"framebufferCube",destroy:function(){Fr.forEach(function(Hn){Hn.destroy()})}})}function ya(){ea.cur=null,ea.next=null,ea.dirty=!0,ms(he).forEach(function(Dr){Dr.framebuffer=oe.createFramebuffer(),cn(Dr)})}return $(ea,{getFramebuffer:function(Dr){if(typeof Dr=="function"&&Dr._reglType==="framebuffer"){var Fr=Dr._framebuffer;if(Fr instanceof Te)return Fr}return null},create:jn,createCube:En,clear:function(){ms(he).forEach(gn)},restore:ya})}var Hp=5126,mn=34962;function Yc(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Hp,this.offset=0,this.stride=0,this.divisor=0}function pp(oe,vn,qn,ia,Sa){for(var Hr=qn.maxAttributes,ea=new Array(Hr),Ha=0;Ha<Hr;++Ha)ea[Ha]=new Yc;var Wa=0,Ga={},Qa={Record:Yc,scope:{},state:ea,currentVAO:null,targetVAO:null,restore:M()?he:function(){},createVAO:Te,getVAO:dt,destroyBuffer:Vn,setVAO:M()?_t:Pt,clear:M()?jt:function(){}};function Vn(Ke){for(var gn=0;gn<ea.length;++gn){var cn=ea[gn];cn.buffer===Ke&&(oe.disableVertexAttribArray(gn),cn.buffer=null)}}function M(){return vn.oes_vertex_array_object}function q(){return vn.angle_instanced_arrays}function dt(Ke){return typeof Ke=="function"&&Ke._vao?Ke._vao:null}function _t(Ke){if(Ke!==Qa.currentVAO){var gn=M();Ke?gn.bindVertexArrayOES(Ke.vao):gn.bindVertexArrayOES(null),Qa.currentVAO=Ke}}function Pt(Ke){if(Ke!==Qa.currentVAO){if(Ke)Ke.bindAttrs();else for(var gn=q(),cn=0;cn<ea.length;++cn){var jn=ea[cn];jn.buffer?(oe.enableVertexAttribArray(cn),oe.vertexAttribPointer(cn,jn.size,jn.type,jn.normalized,jn.stride,jn.offfset),gn&&jn.divisor&&gn.vertexAttribDivisorANGLE(cn,jn.divisor)):(oe.disableVertexAttribArray(cn),oe.vertexAttrib4f(cn,jn.x,jn.y,jn.z,jn.w))}Qa.currentVAO=Ke}}function jt(){ms(Ga).forEach(function(Ke){Ke.destroy()})}function ie(){this.id=++Wa,this.attributes=[];var Ke=M();Ke?this.vao=Ke.createVertexArrayOES():this.vao=null,Ga[this.id]=this,this.buffers=[]}ie.prototype.bindAttrs=function(){for(var Ke=q(),gn=this.attributes,cn=0;cn<gn.length;++cn){var jn=gn[cn];jn.buffer?(oe.enableVertexAttribArray(cn),oe.bindBuffer(mn,jn.buffer.buffer),oe.vertexAttribPointer(cn,jn.size,jn.type,jn.normalized,jn.stride,jn.offset),Ke&&jn.divisor&&Ke.vertexAttribDivisorANGLE(cn,jn.divisor)):(oe.disableVertexAttribArray(cn),oe.vertexAttrib4f(cn,jn.x,jn.y,jn.z,jn.w))}for(var En=gn.length;En<Hr;++En)oe.disableVertexAttribArray(En)},ie.prototype.refresh=function(){var Ke=M();Ke&&(Ke.bindVertexArrayOES(this.vao),this.bindAttrs(),Qa.currentVAO=this)},ie.prototype.destroy=function(){if(this.vao){var Ke=M();this===Qa.currentVAO&&(Qa.currentVAO=null,Ke.bindVertexArrayOES(null)),Ke.deleteVertexArrayOES(this.vao),this.vao=null}Ga[this.id]&&(delete Ga[this.id],ia.vaoCount-=1)};function he(){var Ke=M();Ke&&ms(Ga).forEach(function(gn){gn.refresh()})}function Te(Ke){var gn=new ie;ia.vaoCount+=1;function cn(jn){Rt(Array.isArray(jn),"arguments to vertex array constructor must be an array"),Rt(jn.length<Hr,"too many attributes"),Rt(jn.length>0,"must specify at least one attribute");var En={},ya=gn.attributes;ya.length=jn.length;for(var Dr=0;Dr<jn.length;++Dr){var Fr=jn[Dr],or=ya[Dr]=new Yc,Xa=Fr.data||Fr;if(Array.isArray(Xa)||ot(Xa)||gi(Xa)){var Hn;gn.buffers[Dr]&&(Hn=gn.buffers[Dr],ot(Xa)&&Hn._buffer.byteLength>=Xa.byteLength?Hn.subdata(Xa):(Hn.destroy(),gn.buffers[Dr]=null)),gn.buffers[Dr]||(Hn=gn.buffers[Dr]=Sa.create(Fr,mn,!1,!0)),or.buffer=Sa.getBuffer(Hn),or.size=or.buffer.dimension|0,or.normalized=!1,or.type=or.buffer.dtype,or.offset=0,or.stride=0,or.divisor=0,or.state=1,En[Dr]=1}else Sa.getBuffer(Fr)?(or.buffer=Sa.getBuffer(Fr),or.size=or.buffer.dimension|0,or.normalized=!1,or.type=or.buffer.dtype,or.offset=0,or.stride=0,or.divisor=0,or.state=1):Sa.getBuffer(Fr.buffer)?(or.buffer=Sa.getBuffer(Fr.buffer),or.size=(+Fr.size||or.buffer.dimension)|0,or.normalized=!!Fr.normalized||!1,"type"in Fr?(Rt.parameter(Fr.type,Cu,"invalid buffer type"),or.type=Cu[Fr.type]):or.type=or.buffer.dtype,or.offset=(Fr.offset||0)|0,or.stride=(Fr.stride||0)|0,or.divisor=(Fr.divisor||0)|0,or.state=1,Rt(or.size>=1&&or.size<=4,"size must be between 1 and 4"),Rt(or.offset>=0,"invalid offset"),Rt(or.stride>=0&&or.stride<=255,"stride must be between 0 and 255"),Rt(or.divisor>=0,"divisor must be positive"),Rt(!or.divisor||!!vn.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Fr?(Rt(Dr>0,"first attribute must not be a constant"),or.x=+Fr.x||0,or.y=+Fr.y||0,or.z=+Fr.z||0,or.w=+Fr.w||0,or.state=2):Rt(!1,"invalid attribute spec for location "+Dr)}for(var si=0;si<gn.buffers.length;++si)!En[si]&&gn.buffers[si]&&(gn.buffers[si].destroy(),gn.buffers[si]=null);return gn.refresh(),cn}return cn.destroy=function(){for(var jn=0;jn<gn.buffers.length;++jn)gn.buffers[jn]&&gn.buffers[jn].destroy();gn.buffers.length=0,gn.destroy()},cn._vao=gn,cn._reglType="vao",cn(Ke)}return Qa}var br=35632,Yf=35633,Pf=35718,Tc=35721;function yc(oe,vn,qn,ia){var Sa={},Hr={};function ea(_t,Pt,jt,ie){this.name=_t,this.id=Pt,this.location=jt,this.info=ie}function Ha(_t,Pt){for(var jt=0;jt<_t.length;++jt)if(_t[jt].id===Pt.id){_t[jt].location=Pt.location;return}_t.push(Pt)}function Wa(_t,Pt,jt){var ie=_t===br?Sa:Hr,he=ie[Pt];if(!he){var Te=vn.str(Pt);he=oe.createShader(_t),oe.shaderSource(he,Te),oe.compileShader(he),Rt.shaderError(oe,he,Te,_t,jt),ie[Pt]=he}return he}var Ga={},Qa=[],Vn=0;function M(_t,Pt){this.id=Vn++,this.fragId=_t,this.vertId=Pt,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,ia.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function q(_t,Pt,jt){var ie,he,Te=Wa(br,_t.fragId),Ke=Wa(Yf,_t.vertId),gn=_t.program=oe.createProgram();if(oe.attachShader(gn,Te),oe.attachShader(gn,Ke),jt)for(ie=0;ie<jt.length;++ie){var cn=jt[ie];oe.bindAttribLocation(gn,cn[0],cn[1])}oe.linkProgram(gn),Rt.linkError(oe,gn,vn.str(_t.fragId),vn.str(_t.vertId),Pt);var jn=oe.getProgramParameter(gn,Pf);ia.profile&&(_t.stats.uniformsCount=jn);var En=_t.uniforms;for(ie=0;ie<jn;++ie)if(he=oe.getActiveUniform(gn,ie),he)if(he.size>1)for(var ya=0;ya<he.size;++ya){var Dr=he.name.replace("[0]","["+ya+"]");Ha(En,new ea(Dr,vn.id(Dr),oe.getUniformLocation(gn,Dr),he))}else Ha(En,new ea(he.name,vn.id(he.name),oe.getUniformLocation(gn,he.name),he));var Fr=oe.getProgramParameter(gn,Tc);ia.profile&&(_t.stats.attributesCount=Fr);var or=_t.attributes;for(ie=0;ie<Fr;++ie)he=oe.getActiveAttrib(gn,ie),he&&Ha(or,new ea(he.name,vn.id(he.name),oe.getAttribLocation(gn,he.name),he))}ia.profile&&(qn.getMaxUniformsCount=function(){var _t=0;return Qa.forEach(function(Pt){Pt.stats.uniformsCount>_t&&(_t=Pt.stats.uniformsCount)}),_t},qn.getMaxAttributesCount=function(){var _t=0;return Qa.forEach(function(Pt){Pt.stats.attributesCount>_t&&(_t=Pt.stats.attributesCount)}),_t});function dt(){Sa={},Hr={};for(var _t=0;_t<Qa.length;++_t)q(Qa[_t],null,Qa[_t].attributes.map(function(Pt){return[Pt.location,Pt.name]}))}return{clear:function(){var _t=oe.deleteShader.bind(oe);ms(Sa).forEach(_t),Sa={},ms(Hr).forEach(_t),Hr={},Qa.forEach(function(Pt){oe.deleteProgram(Pt.program)}),Qa.length=0,Ga={},qn.shaderCount=0},program:function(_t,Pt,jt,ie){Rt.command(_t>=0,"missing vertex shader",jt),Rt.command(Pt>=0,"missing fragment shader",jt);var he=Ga[Pt];he||(he=Ga[Pt]={});var Te=he[_t];if(Te&&(Te.refCount++,!ie))return Te;var Ke=new M(Pt,_t);return qn.shaderCount++,q(Ke,jt,ie),Te||(he[_t]=Ke),Qa.push(Ke),$(Ke,{destroy:function(){if(Ke.refCount--,Ke.refCount<=0){oe.deleteProgram(Ke.program);var gn=Qa.indexOf(Ke);Qa.splice(gn,1),qn.shaderCount--}he[Ke.vertId].refCount<=0&&(oe.deleteShader(Hr[Ke.vertId]),delete Hr[Ke.vertId],delete Ga[Ke.fragId][Ke.vertId]),Object.keys(Ga[Ke.fragId]).length||(oe.deleteShader(Sa[Ke.fragId]),delete Sa[Ke.fragId],delete Ga[Ke.fragId])}})},restore:dt,shader:Wa,frag:-1,vert:-1}}var gf=6408,nf=5121,ol=3333,Pc=5126;function tc(oe,vn,qn,ia,Sa,Hr,ea){function Ha(Qa){var Vn;vn.next===null?(Rt(Sa.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Vn=nf):(Rt(vn.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Vn=vn.next.colorAttachments[0].texture._texture.type,Hr.oes_texture_float?(Rt(Vn===nf||Vn===Pc,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Vn===Pc&&Rt(ea.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):Rt(Vn===nf,"Reading from a framebuffer is only allowed for the type 'uint8'"));var M=0,q=0,dt=ia.framebufferWidth,_t=ia.framebufferHeight,Pt=null;ot(Qa)?Pt=Qa:Qa&&(Rt.type(Qa,"object","invalid arguments to regl.read()"),M=Qa.x|0,q=Qa.y|0,Rt(M>=0&&M<ia.framebufferWidth,"invalid x offset for regl.read"),Rt(q>=0&&q<ia.framebufferHeight,"invalid y offset for regl.read"),dt=(Qa.width||ia.framebufferWidth-M)|0,_t=(Qa.height||ia.framebufferHeight-q)|0,Pt=Qa.data||null),Pt&&(Vn===nf?Rt(Pt instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Vn===Pc&&Rt(Pt instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),Rt(dt>0&&dt+M<=ia.framebufferWidth,"invalid width for read pixels"),Rt(_t>0&&_t+q<=ia.framebufferHeight,"invalid height for read pixels"),qn();var jt=dt*_t*4;return Pt||(Vn===nf?Pt=new Uint8Array(jt):Vn===Pc&&(Pt=Pt||new Float32Array(jt))),Rt.isTypedArray(Pt,"data buffer for regl.read() must be a typedarray"),Rt(Pt.byteLength>=jt,"data buffer for regl.read() too small"),oe.pixelStorei(ol,4),oe.readPixels(M,q,dt,_t,gf,Vn,Pt),Pt}function Wa(Qa){var Vn;return vn.setFBO({framebuffer:Qa.framebuffer},function(){Vn=Ha(Qa)}),Vn}function Ga(Qa){return!Qa||!("framebuffer"in Qa)?Ha(Qa):Wa(Qa)}return Ga}function Ff(oe){return Array.prototype.slice.call(oe)}function Ac(oe){return Ff(oe).join("")}function Av(){var oe=0,vn=[],qn=[];function ia(Vn){for(var M=0;M<qn.length;++M)if(qn[M]===Vn)return vn[M];var q="g"+oe++;return vn.push(q),qn.push(Vn),q}function Sa(){var Vn=[];function M(){Vn.push.apply(Vn,Ff(arguments))}var q=[];function dt(){var _t="v"+oe++;return q.push(_t),arguments.length>0&&(Vn.push(_t,"="),Vn.push.apply(Vn,Ff(arguments)),Vn.push(";")),_t}return $(M,{def:dt,toString:function(){return Ac([q.length>0?"var "+q.join(",")+";":"",Ac(Vn)])}})}function Hr(){var Vn=Sa(),M=Sa(),q=Vn.toString,dt=M.toString;function _t(Pt,jt){M(Pt,jt,"=",Vn.def(Pt,jt),";")}return $(function(){Vn.apply(Vn,Ff(arguments))},{def:Vn.def,entry:Vn,exit:M,save:_t,set:function(Pt,jt,ie){_t(Pt,jt),Vn(Pt,jt,"=",ie,";")},toString:function(){return q()+dt()}})}function ea(){var Vn=Ac(arguments),M=Hr(),q=Hr(),dt=M.toString,_t=q.toString;return $(M,{then:function(){return M.apply(M,Ff(arguments)),this},else:function(){return q.apply(q,Ff(arguments)),this},toString:function(){var Pt=_t();return Pt&&(Pt="else{"+Pt+"}"),Ac(["if(",Vn,"){",dt(),"}",Pt])}})}var Ha=Sa(),Wa={};function Ga(Vn,M){var q=[];function dt(){var he="a"+q.length;return q.push(he),he}M=M||0;for(var _t=0;_t<M;++_t)dt();var Pt=Hr(),jt=Pt.toString,ie=Wa[Vn]=$(Pt,{arg:dt,toString:function(){return Ac(["function(",q.join(),"){",jt(),"}"])}});return ie}function Qa(){var Vn=['"use strict";',Ha,"return {"];Object.keys(Wa).forEach(function(dt){Vn.push('"',dt,'":',Wa[dt].toString(),",")}),Vn.push("}");var M=Ac(Vn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),q=Function.apply(null,vn.concat(M));return q.apply(null,qn)}return{global:Ha,link:ia,block:Sa,proc:Ga,scope:Hr,cond:ea,compile:Qa}}var Bf="xyzw".split(""),zf=5121,Kf=1,Fh=2,gh=0,mh=1,vp=2,gp=3,fd=4,gl=5,mp=6,Zf="dither",Dd="blend.enable",Bh="blend.color",zh="blend.equation",uc="blend.func",ml="depth.enable",Al="depth.func",qv="depth.range",ps="depth.mask",ec="colorMask",ir="cull.enable",no="cull.face",yh="frontFace",$h="lineWidth",Xp="polygonOffset.enable",$l="polygonOffset.offset",qf="sample.alpha",Od="sample.enable",Gh="sample.coverage",Qf="stencil.enable",Uh="stencil.mask",yp="stencil.func",Ml="stencil.opFront",bc="stencil.opBack",hd="scissor.enable",Rd="scissor.box",xc="viewport",Wh="profile",Vh="framebuffer",Kc="vert",_f="frag",lc="elements",If="primitive",Jf="count",bp="offset",dd="instances",xp="vao",wp="Width",Yp="Height",bh=Vh+wp,rf=Vh+Yp,wc=xc+wp,Mv=xc+Yp,$f="drawingBuffer",jh=$f+wp,Nv=$f+Yp,zs=[uc,zh,yp,Ml,bc,Gh,xc,Rd,$l],af=34962,qi=34963,pd=35632,th=35633,Kp=3553,Ep=34067,Sg=2884,Qv=3042,Ld=3024,Zp=2960,xh=2929,kv=3089,qp=32823,Qp=32926,eh=32928,vd=5126,Hh=35664,Pd=35665,Fd=35666,Sp=5124,Bd=35667,wh=35668,Cp=35669,Tf=35670,zd=35671,$d=35672,gd=35673,Eh=35674,Gd=35675,Ud=35676,Xh=35678,Wd=35680,$s=4,md=1028,Mc=1029,Jv=2304,mu=2305,Dv=32775,Vd=32776,Jp=519,Zc=7680,tv=0,ev=1,nv=32774,Sh=513,rv=36160,tg=36064,Gl={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},av=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Af={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Mf={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ov={frag:pd,vert:th},iv={cw:Jv,ccw:mu};function Yh(oe){return Array.isArray(oe)||ot(oe)||gi(oe)}function ov(oe){return oe.sort(function(vn,qn){return vn===xc?-1:qn===xc?1:vn<qn?-1:1})}function Nc(oe,vn,qn,ia){this.thisDep=oe,this.contextDep=vn,this.propDep=qn,this.append=ia}function Ch(oe){return oe&&!(oe.thisDep||oe.contextDep||oe.propDep)}function El(oe){return new Nc(!1,!1,!1,oe)}function Fc(oe,vn){var qn=oe.type;if(qn===gh){var ia=oe.data.length;return new Nc(!0,ia>=1,ia>=2,vn)}else if(qn===fd){var Sa=oe.data;return new Nc(Sa.thisDep,Sa.contextDep,Sa.propDep,vn)}else{if(qn===gl)return new Nc(!1,!1,!1,vn);if(qn===mp){for(var Hr=!1,ea=!1,Ha=!1,Wa=0;Wa<oe.data.length;++Wa){var Ga=oe.data[Wa];if(Ga.type===mh)Ha=!0;else if(Ga.type===vp)ea=!0;else if(Ga.type===gp)Hr=!0;else if(Ga.type===gh){Hr=!0;var Qa=Ga.data;Qa>=1&&(ea=!0),Qa>=2&&(Ha=!0)}else Ga.type===fd&&(Hr=Hr||Ga.data.thisDep,ea=ea||Ga.data.contextDep,Ha=Ha||Ga.data.propDep)}return new Nc(Hr,ea,Ha,vn)}else return new Nc(qn===gp,qn===vp,qn===mh,vn)}}var jd=new Nc(!1,!1,!1,function(){});function _p(oe,vn,qn,ia,Sa,Hr,ea,Ha,Wa,Ga,Qa,Vn,M,q,dt){var _t=Ga.Record,Pt={add:32774,subtract:32778,"reverse subtract":32779};qn.ext_blend_minmax&&(Pt.min=Dv,Pt.max=Vd);var jt=qn.angle_instanced_arrays,ie=qn.webgl_draw_buffers,he={dirty:!0,profile:dt.profile},Te={},Ke=[],gn={},cn={};function jn(An){return An.replace(".","_")}function En(An,sn,hr){var Pr=jn(An);Ke.push(An),Te[Pr]=he[Pr]=!!hr,gn[Pr]=sn}function ya(An,sn,hr){var Pr=jn(An);Ke.push(An),Array.isArray(hr)?(he[Pr]=hr.slice(),Te[Pr]=hr.slice()):he[Pr]=Te[Pr]=hr,cn[Pr]=sn}En(Zf,Ld),En(Dd,Qv),ya(Bh,"blendColor",[0,0,0,0]),ya(zh,"blendEquationSeparate",[nv,nv]),ya(uc,"blendFuncSeparate",[ev,tv,ev,tv]),En(ml,xh,!0),ya(Al,"depthFunc",Sh),ya(qv,"depthRange",[0,1]),ya(ps,"depthMask",!0),ya(ec,ec,[!0,!0,!0,!0]),En(ir,Sg),ya(no,"cullFace",Mc),ya(yh,yh,mu),ya($h,$h,1),En(Xp,qp),ya($l,"polygonOffset",[0,0]),En(qf,Qp),En(Od,eh),ya(Gh,"sampleCoverage",[1,!1]),En(Qf,Zp),ya(Uh,"stencilMask",-1),ya(yp,"stencilFunc",[Jp,0,-1]),ya(Ml,"stencilOpSeparate",[md,Zc,Zc,Zc]),ya(bc,"stencilOpSeparate",[Mc,Zc,Zc,Zc]),En(hd,kv),ya(Rd,"scissor",[0,0,oe.drawingBufferWidth,oe.drawingBufferHeight]),ya(xc,xc,[0,0,oe.drawingBufferWidth,oe.drawingBufferHeight]);var Dr={gl:oe,context:M,strings:vn,next:Te,current:he,draw:Vn,elements:Hr,buffer:Sa,shader:Qa,attributes:Ga.state,vao:Ga,uniforms:Wa,framebuffer:Ha,extensions:qn,timer:q,isBufferArgs:Yh},Fr={primTypes:Au,compareFuncs:Af,blendFuncs:Gl,blendEquations:Pt,stencilOps:Mf,glTypes:Cu,orientationType:iv};Rt.optional(function(){Dr.isArrayLike=Ls}),ie&&(Fr.backBuffer=[Mc],Fr.drawBuffer=$r(ia.maxDrawbuffers,function(An){return An===0?[0]:$r(An,function(sn){return tg+sn})}));var or=0;function Xa(){var An=Av(),sn=An.link,hr=An.global;An.id=or++,An.batchId="0";var Pr=sn(Dr),Xr=An.shared={props:"a0"};Object.keys(Dr).forEach(function(fr){Xr[fr]=hr.def(Pr,".",fr)}),Rt.optional(function(){An.CHECK=sn(Rt),An.commandStr=Rt.guessCommand(),An.command=sn(An.commandStr),An.assert=function(fr,Sn,Or){fr("if(!(",Sn,"))",this.CHECK,".commandRaise(",sn(Or),",",this.command,");")},Fr.invalidBlendCombinations=av});var yr=An.next={},vr=An.current={};Object.keys(cn).forEach(function(fr){Array.isArray(he[fr])&&(yr[fr]=hr.def(Xr.next,".",fr),vr[fr]=hr.def(Xr.current,".",fr))});var Mr=An.constants={};Object.keys(Fr).forEach(function(fr){Mr[fr]=hr.def(JSON.stringify(Fr[fr]))}),An.invoke=function(fr,Sn){switch(Sn.type){case gh:var Or=["this",Xr.context,Xr.props,An.batchId];return fr.def(sn(Sn.data),".call(",Or.slice(0,Math.max(Sn.data.length+1,4)),")");case mh:return fr.def(Xr.props,Sn.data);case vp:return fr.def(Xr.context,Sn.data);case gp:return fr.def("this",Sn.data);case fd:return Sn.data.append(An,fr),Sn.data.ref;case gl:return Sn.data.toString();case mp:return Sn.data.map(function(Zr){return An.invoke(fr,Zr)})}},An.attribCache={};var kn={};return An.scopeAttrib=function(fr){var Sn=vn.id(fr);if(Sn in kn)return kn[Sn];var Or=Ga.scope[Sn];Or||(Or=Ga.scope[Sn]=new _t);var Zr=kn[Sn]=sn(Or);return Zr},An}function Hn(An){var sn=An.static,hr=An.dynamic,Pr;if(Wh in sn){var Xr=!!sn[Wh];Pr=El(function(vr,Mr){return Xr}),Pr.enable=Xr}else if(Wh in hr){var yr=hr[Wh];Pr=Fc(yr,function(vr,Mr){return vr.invoke(Mr,yr)})}return Pr}function si(An,sn){var hr=An.static,Pr=An.dynamic;if(Vh in hr){var Xr=hr[Vh];return Xr?(Xr=Ha.getFramebuffer(Xr),Rt.command(Xr,"invalid framebuffer object"),El(function(vr,Mr){var kn=vr.link(Xr),fr=vr.shared;Mr.set(fr.framebuffer,".next",kn);var Sn=fr.context;return Mr.set(Sn,"."+bh,kn+".width"),Mr.set(Sn,"."+rf,kn+".height"),kn})):El(function(vr,Mr){var kn=vr.shared;Mr.set(kn.framebuffer,".next","null");var fr=kn.context;return Mr.set(fr,"."+bh,fr+"."+jh),Mr.set(fr,"."+rf,fr+"."+Nv),"null"})}else if(Vh in Pr){var yr=Pr[Vh];return Fc(yr,function(vr,Mr){var kn=vr.invoke(Mr,yr),fr=vr.shared,Sn=fr.framebuffer,Or=Mr.def(Sn,".getFramebuffer(",kn,")");Rt.optional(function(){vr.assert(Mr,"!"+kn+"||"+Or,"invalid framebuffer object")}),Mr.set(Sn,".next",Or);var Zr=fr.context;return Mr.set(Zr,"."+bh,Or+"?"+Or+".width:"+Zr+"."+jh),Mr.set(Zr,"."+rf,Or+"?"+Or+".height:"+Zr+"."+Nv),Or})}else return null}function Ci(An,sn,hr){var Pr=An.static,Xr=An.dynamic;function yr(kn){if(kn in Pr){var fr=Pr[kn];Rt.commandType(fr,"object","invalid "+kn,hr.commandStr);var Sn=!0,Or=fr.x|0,Zr=fr.y|0,wa,Na;return"width"in fr?(wa=fr.width|0,Rt.command(wa>=0,"invalid "+kn,hr.commandStr)):Sn=!1,"height"in fr?(Na=fr.height|0,Rt.command(Na>=0,"invalid "+kn,hr.commandStr)):Sn=!1,new Nc(!Sn&&sn&&sn.thisDep,!Sn&&sn&&sn.contextDep,!Sn&&sn&&sn.propDep,function(lo,cs){var Qi=lo.shared.context,Io=wa;"width"in fr||(Io=cs.def(Qi,".",bh,"-",Or));var Mo=Na;return"height"in fr||(Mo=cs.def(Qi,".",rf,"-",Zr)),[Or,Zr,Io,Mo]})}else if(kn in Xr){var ga=Xr[kn],ai=Fc(ga,function(lo,cs){var Qi=lo.invoke(cs,ga);Rt.optional(function(){lo.assert(cs,Qi+"&&typeof "+Qi+'==="object"',"invalid "+kn)});var Io=lo.shared.context,Mo=cs.def(Qi,".x|0"),Os=cs.def(Qi,".y|0"),yl=cs.def('"width" in ',Qi,"?",Qi,".width|0:","(",Io,".",bh,"-",Mo,")"),sf=cs.def('"height" in ',Qi,"?",Qi,".height|0:","(",Io,".",rf,"-",Os,")");return Rt.optional(function(){lo.assert(cs,yl+">=0&&"+sf+">=0","invalid "+kn)}),[Mo,Os,yl,sf]});return sn&&(ai.thisDep=ai.thisDep||sn.thisDep,ai.contextDep=ai.contextDep||sn.contextDep,ai.propDep=ai.propDep||sn.propDep),ai}else return sn?new Nc(sn.thisDep,sn.contextDep,sn.propDep,function(lo,cs){var Qi=lo.shared.context;return[0,0,cs.def(Qi,".",bh),cs.def(Qi,".",rf)]}):null}var vr=yr(xc);if(vr){var Mr=vr;vr=new Nc(vr.thisDep,vr.contextDep,vr.propDep,function(kn,fr){var Sn=Mr.append(kn,fr),Or=kn.shared.context;return fr.set(Or,"."+wc,Sn[2]),fr.set(Or,"."+Mv,Sn[3]),Sn})}return{viewport:vr,scissor_box:yr(Rd)}}function Yi(An,sn){var hr=An.static,Pr=typeof hr[_f]=="string"&&typeof hr[Kc]=="string";if(Pr){if(Object.keys(sn.dynamic).length>0)return null;var Xr=sn.static,yr=Object.keys(Xr);if(yr.length>0&&typeof Xr[yr[0]]=="number"){for(var vr=[],Mr=0;Mr<yr.length;++Mr)Rt(typeof Xr[yr[Mr]]=="number","must specify all vertex attribute locations when using vaos"),vr.push([Xr[yr[Mr]]|0,yr[Mr]]);return vr}}return null}function _i(An,sn,hr){var Pr=An.static,Xr=An.dynamic;function yr(Sn){if(Sn in Pr){var Or=vn.id(Pr[Sn]);Rt.optional(function(){Qa.shader(Ov[Sn],Or,Rt.guessCommand())});var Zr=El(function(){return Or});return Zr.id=Or,Zr}else if(Sn in Xr){var wa=Xr[Sn];return Fc(wa,function(Na,ga){var ai=Na.invoke(ga,wa),lo=ga.def(Na.shared.strings,".id(",ai,")");return Rt.optional(function(){ga(Na.shared.shader,".shader(",Ov[Sn],",",lo,",",Na.command,");")}),lo})}return null}var vr=yr(_f),Mr=yr(Kc),kn=null,fr;return Ch(vr)&&Ch(Mr)?(kn=Qa.program(Mr.id,vr.id,null,hr),fr=El(function(Sn,Or){return Sn.link(kn)})):fr=new Nc(vr&&vr.thisDep||Mr&&Mr.thisDep,vr&&vr.contextDep||Mr&&Mr.contextDep,vr&&vr.propDep||Mr&&Mr.propDep,function(Sn,Or){var Zr=Sn.shared.shader,wa;vr?wa=vr.append(Sn,Or):wa=Or.def(Zr,".",_f);var Na;Mr?Na=Mr.append(Sn,Or):Na=Or.def(Zr,".",Kc);var ga=Zr+".program("+Na+","+wa;return Rt.optional(function(){ga+=","+Sn.command}),Or.def(ga+")")}),{frag:vr,vert:Mr,progVar:fr,program:kn}}function Yo(An,sn){var hr=An.static,Pr=An.dynamic;function Xr(){if(lc in hr){var Sn=hr[lc];Yh(Sn)?Sn=Hr.getElements(Hr.create(Sn,!0)):Sn&&(Sn=Hr.getElements(Sn),Rt.command(Sn,"invalid elements",sn.commandStr));var Or=El(function(wa,Na){if(Sn){var ga=wa.link(Sn);return wa.ELEMENTS=ga,ga}return wa.ELEMENTS=null,null});return Or.value=Sn,Or}else if(lc in Pr){var Zr=Pr[lc];return Fc(Zr,function(wa,Na){var ga=wa.shared,ai=ga.isBufferArgs,lo=ga.elements,cs=wa.invoke(Na,Zr),Qi=Na.def("null"),Io=Na.def(ai,"(",cs,")"),Mo=wa.cond(Io).then(Qi,"=",lo,".createStream(",cs,");").else(Qi,"=",lo,".getElements(",cs,");");return Rt.optional(function(){wa.assert(Mo.else,"!"+cs+"||"+Qi,"invalid elements")}),Na.entry(Mo),Na.exit(wa.cond(Io).then(lo,".destroyStream(",Qi,");")),wa.ELEMENTS=Qi,Qi})}return null}var yr=Xr();function vr(){if(If in hr){var Sn=hr[If];return Rt.commandParameter(Sn,Au,"invalid primitve",sn.commandStr),El(function(Zr,wa){return Au[Sn]})}else if(If in Pr){var Or=Pr[If];return Fc(Or,function(Zr,wa){var Na=Zr.constants.primTypes,ga=Zr.invoke(wa,Or);return Rt.optional(function(){Zr.assert(wa,ga+" in "+Na,"invalid primitive, must be one of "+Object.keys(Au))}),wa.def(Na,"[",ga,"]")})}else if(yr)return Ch(yr)?yr.value?El(function(Zr,wa){return wa.def(Zr.ELEMENTS,".primType")}):El(function(){return $s}):new Nc(yr.thisDep,yr.contextDep,yr.propDep,function(Zr,wa){var Na=Zr.ELEMENTS;return wa.def(Na,"?",Na,".primType:",$s)});return null}function Mr(Sn,Or){if(Sn in hr){var Zr=hr[Sn]|0;return Rt.command(!Or||Zr>=0,"invalid "+Sn,sn.commandStr),El(function(Na,ga){return Or&&(Na.OFFSET=Zr),Zr})}else if(Sn in Pr){var wa=Pr[Sn];return Fc(wa,function(Na,ga){var ai=Na.invoke(ga,wa);return Or&&(Na.OFFSET=ai,Rt.optional(function(){Na.assert(ga,ai+">=0","invalid "+Sn)})),ai})}else if(Or&&yr)return El(function(Na,ga){return Na.OFFSET="0",0});return null}var kn=Mr(bp,!0);function fr(){if(Jf in hr){var Sn=hr[Jf]|0;return Rt.command(typeof Sn=="number"&&Sn>=0,"invalid vertex count",sn.commandStr),El(function(){return Sn})}else if(Jf in Pr){var Or=Pr[Jf];return Fc(Or,function(Na,ga){var ai=Na.invoke(ga,Or);return Rt.optional(function(){Na.assert(ga,"typeof "+ai+'==="number"&&'+ai+">=0&&"+ai+"===("+ai+"|0)","invalid vertex count")}),ai})}else if(yr)if(Ch(yr)){if(yr)return kn?new Nc(kn.thisDep,kn.contextDep,kn.propDep,function(Na,ga){var ai=ga.def(Na.ELEMENTS,".vertCount-",Na.OFFSET);return Rt.optional(function(){Na.assert(ga,ai+">=0","invalid vertex offset/element buffer too small")}),ai}):El(function(Na,ga){return ga.def(Na.ELEMENTS,".vertCount")});var Zr=El(function(){return-1});return Rt.optional(function(){Zr.MISSING=!0}),Zr}else{var wa=new Nc(yr.thisDep||kn.thisDep,yr.contextDep||kn.contextDep,yr.propDep||kn.propDep,function(Na,ga){var ai=Na.ELEMENTS;return Na.OFFSET?ga.def(ai,"?",ai,".vertCount-",Na.OFFSET,":-1"):ga.def(ai,"?",ai,".vertCount:-1")});return Rt.optional(function(){wa.DYNAMIC=!0}),wa}return null}return{elements:yr,primitive:vr(),count:fr(),instances:Mr(dd,!1),offset:kn}}function xi(An,sn){var hr=An.static,Pr=An.dynamic,Xr={};return Ke.forEach(function(yr){var vr=jn(yr);function Mr(kn,fr){if(yr in hr){var Sn=kn(hr[yr]);Xr[vr]=El(function(){return Sn})}else if(yr in Pr){var Or=Pr[yr];Xr[vr]=Fc(Or,function(Zr,wa){return fr(Zr,wa,Zr.invoke(wa,Or))})}}switch(yr){case ir:case Dd:case Zf:case Qf:case ml:case hd:case Xp:case qf:case Od:case ps:return Mr(function(kn){return Rt.commandType(kn,"boolean",yr,sn.commandStr),kn},function(kn,fr,Sn){return Rt.optional(function(){kn.assert(fr,"typeof "+Sn+'==="boolean"',"invalid flag "+yr,kn.commandStr)}),Sn});case Al:return Mr(function(kn){return Rt.commandParameter(kn,Af,"invalid "+yr,sn.commandStr),Af[kn]},function(kn,fr,Sn){var Or=kn.constants.compareFuncs;return Rt.optional(function(){kn.assert(fr,Sn+" in "+Or,"invalid "+yr+", must be one of "+Object.keys(Af))}),fr.def(Or,"[",Sn,"]")});case qv:return Mr(function(kn){return Rt.command(Ls(kn)&&kn.length===2&&typeof kn[0]=="number"&&typeof kn[1]=="number"&&kn[0]<=kn[1],"depth range is 2d array",sn.commandStr),kn},function(kn,fr,Sn){Rt.optional(function(){kn.assert(fr,kn.shared.isArrayLike+"("+Sn+")&&"+Sn+".length===2&&typeof "+Sn+'[0]==="number"&&typeof '+Sn+'[1]==="number"&&'+Sn+"[0]<="+Sn+"[1]","depth range must be a 2d array")});var Or=fr.def("+",Sn,"[0]"),Zr=fr.def("+",Sn,"[1]");return[Or,Zr]});case uc:return Mr(function(kn){Rt.commandType(kn,"object","blend.func",sn.commandStr);var fr="srcRGB"in kn?kn.srcRGB:kn.src,Sn="srcAlpha"in kn?kn.srcAlpha:kn.src,Or="dstRGB"in kn?kn.dstRGB:kn.dst,Zr="dstAlpha"in kn?kn.dstAlpha:kn.dst;return Rt.commandParameter(fr,Gl,vr+".srcRGB",sn.commandStr),Rt.commandParameter(Sn,Gl,vr+".srcAlpha",sn.commandStr),Rt.commandParameter(Or,Gl,vr+".dstRGB",sn.commandStr),Rt.commandParameter(Zr,Gl,vr+".dstAlpha",sn.commandStr),Rt.command(av.indexOf(fr+", "+Or)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+fr+", "+Or+")",sn.commandStr),[Gl[fr],Gl[Or],Gl[Sn],Gl[Zr]]},function(kn,fr,Sn){var Or=kn.constants.blendFuncs;Rt.optional(function(){kn.assert(fr,Sn+"&&typeof "+Sn+'==="object"',"invalid blend func, must be an object")});function Zr(Qi,Io){var Mo=fr.def('"',Qi,Io,'" in ',Sn,"?",Sn,".",Qi,Io,":",Sn,".",Qi);return Rt.optional(function(){kn.assert(fr,Mo+" in "+Or,"invalid "+yr+"."+Qi+Io+", must be one of "+Object.keys(Gl))}),Mo}var wa=Zr("src","RGB"),Na=Zr("dst","RGB");Rt.optional(function(){var Qi=kn.constants.invalidBlendCombinations;kn.assert(fr,Qi+".indexOf("+wa+'+", "+'+Na+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ga=fr.def(Or,"[",wa,"]"),ai=fr.def(Or,"[",Zr("src","Alpha"),"]"),lo=fr.def(Or,"[",Na,"]"),cs=fr.def(Or,"[",Zr("dst","Alpha"),"]");return[ga,lo,ai,cs]});case zh:return Mr(function(kn){if(typeof kn=="string")return Rt.commandParameter(kn,Pt,"invalid "+yr,sn.commandStr),[Pt[kn],Pt[kn]];if(typeof kn=="object")return Rt.commandParameter(kn.rgb,Pt,yr+".rgb",sn.commandStr),Rt.commandParameter(kn.alpha,Pt,yr+".alpha",sn.commandStr),[Pt[kn.rgb],Pt[kn.alpha]];Rt.commandRaise("invalid blend.equation",sn.commandStr)},function(kn,fr,Sn){var Or=kn.constants.blendEquations,Zr=fr.def(),wa=fr.def(),Na=kn.cond("typeof ",Sn,'==="string"');return Rt.optional(function(){function ga(ai,lo,cs){kn.assert(ai,cs+" in "+Or,"invalid "+lo+", must be one of "+Object.keys(Pt))}ga(Na.then,yr,Sn),kn.assert(Na.else,Sn+"&&typeof "+Sn+'==="object"',"invalid "+yr),ga(Na.else,yr+".rgb",Sn+".rgb"),ga(Na.else,yr+".alpha",Sn+".alpha")}),Na.then(Zr,"=",wa,"=",Or,"[",Sn,"];"),Na.else(Zr,"=",Or,"[",Sn,".rgb];",wa,"=",Or,"[",Sn,".alpha];"),fr(Na),[Zr,wa]});case Bh:return Mr(function(kn){return Rt.command(Ls(kn)&&kn.length===4,"blend.color must be a 4d array",sn.commandStr),$r(4,function(fr){return+kn[fr]})},function(kn,fr,Sn){return Rt.optional(function(){kn.assert(fr,kn.shared.isArrayLike+"("+Sn+")&&"+Sn+".length===4","blend.color must be a 4d array")}),$r(4,function(Or){return fr.def("+",Sn,"[",Or,"]")})});case Uh:return Mr(function(kn){return Rt.commandType(kn,"number",vr,sn.commandStr),kn|0},function(kn,fr,Sn){return Rt.optional(function(){kn.assert(fr,"typeof "+Sn+'==="number"',"invalid stencil.mask")}),fr.def(Sn,"|0")});case yp:return Mr(function(kn){Rt.commandType(kn,"object",vr,sn.commandStr);var fr=kn.cmp||"keep",Sn=kn.ref||0,Or="mask"in kn?kn.mask:-1;return Rt.commandParameter(fr,Af,yr+".cmp",sn.commandStr),Rt.commandType(Sn,"number",yr+".ref",sn.commandStr),Rt.commandType(Or,"number",yr+".mask",sn.commandStr),[Af[fr],Sn,Or]},function(kn,fr,Sn){var Or=kn.constants.compareFuncs;Rt.optional(function(){function ga(){kn.assert(fr,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ga(Sn+"&&typeof ",Sn,'==="object"'),ga('!("cmp" in ',Sn,")||(",Sn,".cmp in ",Or,")")});var Zr=fr.def('"cmp" in ',Sn,"?",Or,"[",Sn,".cmp]",":",Zc),wa=fr.def(Sn,".ref|0"),Na=fr.def('"mask" in ',Sn,"?",Sn,".mask|0:-1");return[Zr,wa,Na]});case Ml:case bc:return Mr(function(kn){Rt.commandType(kn,"object",vr,sn.commandStr);var fr=kn.fail||"keep",Sn=kn.zfail||"keep",Or=kn.zpass||"keep";return Rt.commandParameter(fr,Mf,yr+".fail",sn.commandStr),Rt.commandParameter(Sn,Mf,yr+".zfail",sn.commandStr),Rt.commandParameter(Or,Mf,yr+".zpass",sn.commandStr),[yr===bc?Mc:md,Mf[fr],Mf[Sn],Mf[Or]]},function(kn,fr,Sn){var Or=kn.constants.stencilOps;Rt.optional(function(){kn.assert(fr,Sn+"&&typeof "+Sn+'==="object"',"invalid "+yr)});function Zr(wa){return Rt.optional(function(){kn.assert(fr,'!("'+wa+'" in '+Sn+")||("+Sn+"."+wa+" in "+Or+")","invalid "+yr+"."+wa+", must be one of "+Object.keys(Mf))}),fr.def('"',wa,'" in ',Sn,"?",Or,"[",Sn,".",wa,"]:",Zc)}return[yr===bc?Mc:md,Zr("fail"),Zr("zfail"),Zr("zpass")]});case $l:return Mr(function(kn){Rt.commandType(kn,"object",vr,sn.commandStr);var fr=kn.factor|0,Sn=kn.units|0;return Rt.commandType(fr,"number",vr+".factor",sn.commandStr),Rt.commandType(Sn,"number",vr+".units",sn.commandStr),[fr,Sn]},function(kn,fr,Sn){Rt.optional(function(){kn.assert(fr,Sn+"&&typeof "+Sn+'==="object"',"invalid "+yr)});var Or=fr.def(Sn,".factor|0"),Zr=fr.def(Sn,".units|0");return[Or,Zr]});case no:return Mr(function(kn){var fr=0;return kn==="front"?fr=md:kn==="back"&&(fr=Mc),Rt.command(!!fr,vr,sn.commandStr),fr},function(kn,fr,Sn){return Rt.optional(function(){kn.assert(fr,Sn+'==="front"||'+Sn+'==="back"',"invalid cull.face")}),fr.def(Sn,'==="front"?',md,":",Mc)});case $h:return Mr(function(kn){return Rt.command(typeof kn=="number"&&kn>=ia.lineWidthDims[0]&&kn<=ia.lineWidthDims[1],"invalid line width, must be a positive number between "+ia.lineWidthDims[0]+" and "+ia.lineWidthDims[1],sn.commandStr),kn},function(kn,fr,Sn){return Rt.optional(function(){kn.assert(fr,"typeof "+Sn+'==="number"&&'+Sn+">="+ia.lineWidthDims[0]+"&&"+Sn+"<="+ia.lineWidthDims[1],"invalid line width")}),Sn});case yh:return Mr(function(kn){return Rt.commandParameter(kn,iv,vr,sn.commandStr),iv[kn]},function(kn,fr,Sn){return Rt.optional(function(){kn.assert(fr,Sn+'==="cw"||'+Sn+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),fr.def(Sn+'==="cw"?'+Jv+":"+mu)});case ec:return Mr(function(kn){return Rt.command(Ls(kn)&&kn.length===4,"color.mask must be length 4 array",sn.commandStr),kn.map(function(fr){return!!fr})},function(kn,fr,Sn){return Rt.optional(function(){kn.assert(fr,kn.shared.isArrayLike+"("+Sn+")&&"+Sn+".length===4","invalid color.mask")}),$r(4,function(Or){return"!!"+Sn+"["+Or+"]"})});case Gh:return Mr(function(kn){Rt.command(typeof kn=="object"&&kn,vr,sn.commandStr);var fr="value"in kn?kn.value:1,Sn=!!kn.invert;return Rt.command(typeof fr=="number"&&fr>=0&&fr<=1,"sample.coverage.value must be a number between 0 and 1",sn.commandStr),[fr,Sn]},function(kn,fr,Sn){Rt.optional(function(){kn.assert(fr,Sn+"&&typeof "+Sn+'==="object"',"invalid sample.coverage")});var Or=fr.def('"value" in ',Sn,"?+",Sn,".value:1"),Zr=fr.def("!!",Sn,".invert");return[Or,Zr]})}}),Xr}function Xu(An,sn){var hr=An.static,Pr=An.dynamic,Xr={};return Object.keys(hr).forEach(function(yr){var vr=hr[yr],Mr;if(typeof vr=="number"||typeof vr=="boolean")Mr=El(function(){return vr});else if(typeof vr=="function"){var kn=vr._reglType;kn==="texture2d"||kn==="textureCube"?Mr=El(function(fr){return fr.link(vr)}):kn==="framebuffer"||kn==="framebufferCube"?(Rt.command(vr.color.length>0,'missing color attachment for framebuffer sent to uniform "'+yr+'"',sn.commandStr),Mr=El(function(fr){return fr.link(vr.color[0])})):Rt.commandRaise('invalid data for uniform "'+yr+'"',sn.commandStr)}else Ls(vr)?Mr=El(function(fr){var Sn=fr.global.def("[",$r(vr.length,function(Or){return Rt.command(typeof vr[Or]=="number"||typeof vr[Or]=="boolean","invalid uniform "+yr,fr.commandStr),vr[Or]}),"]");return Sn}):Rt.commandRaise('invalid or missing data for uniform "'+yr+'"',sn.commandStr);Mr.value=vr,Xr[yr]=Mr}),Object.keys(Pr).forEach(function(yr){var vr=Pr[yr];Xr[yr]=Fc(vr,function(Mr,kn){return Mr.invoke(kn,vr)})}),Xr}function jo(An,sn){var hr=An.static,Pr=An.dynamic,Xr={};return Object.keys(hr).forEach(function(yr){var vr=hr[yr],Mr=vn.id(yr),kn=new _t;if(Yh(vr))kn.state=Kf,kn.buffer=Sa.getBuffer(Sa.create(vr,af,!1,!0)),kn.type=0;else{var fr=Sa.getBuffer(vr);if(fr)kn.state=Kf,kn.buffer=fr,kn.type=0;else if(Rt.command(typeof vr=="object"&&vr,"invalid data for attribute "+yr,sn.commandStr),"constant"in vr){var Sn=vr.constant;kn.buffer="null",kn.state=Fh,typeof Sn=="number"?kn.x=Sn:(Rt.command(Ls(Sn)&&Sn.length>0&&Sn.length<=4,"invalid constant for attribute "+yr,sn.commandStr),Bf.forEach(function(lo,cs){cs<Sn.length&&(kn[lo]=Sn[cs])}))}else{Yh(vr.buffer)?fr=Sa.getBuffer(Sa.create(vr.buffer,af,!1,!0)):fr=Sa.getBuffer(vr.buffer),Rt.command(!!fr,'missing buffer for attribute "'+yr+'"',sn.commandStr);var Or=vr.offset|0;Rt.command(Or>=0,'invalid offset for attribute "'+yr+'"',sn.commandStr);var Zr=vr.stride|0;Rt.command(Zr>=0&&Zr<256,'invalid stride for attribute "'+yr+'", must be integer betweeen [0, 255]',sn.commandStr);var wa=vr.size|0;Rt.command(!("size"in vr)||wa>0&&wa<=4,'invalid size for attribute "'+yr+'", must be 1,2,3,4',sn.commandStr);var Na=!!vr.normalized,ga=0;"type"in vr&&(Rt.commandParameter(vr.type,Cu,"invalid type for attribute "+yr,sn.commandStr),ga=Cu[vr.type]);var ai=vr.divisor|0;"divisor"in vr&&(Rt.command(ai===0||jt,'cannot specify divisor for attribute "'+yr+'", instancing not supported',sn.commandStr),Rt.command(ai>=0,'invalid divisor for attribute "'+yr+'"',sn.commandStr)),Rt.optional(function(){var lo=sn.commandStr,cs=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(vr).forEach(function(Qi){Rt.command(cs.indexOf(Qi)>=0,'unknown parameter "'+Qi+'" for attribute pointer "'+yr+'" (valid parameters are '+cs+")",lo)})}),kn.buffer=fr,kn.state=Kf,kn.size=wa,kn.normalized=Na,kn.type=ga||fr.dtype,kn.offset=Or,kn.stride=Zr,kn.divisor=ai}}Xr[yr]=El(function(lo,cs){var Qi=lo.attribCache;if(Mr in Qi)return Qi[Mr];var Io={isStream:!1};return Object.keys(kn).forEach(function(Mo){Io[Mo]=kn[Mo]}),kn.buffer&&(Io.buffer=lo.link(kn.buffer),Io.type=Io.type||Io.buffer+".dtype"),Qi[Mr]=Io,Io})}),Object.keys(Pr).forEach(function(yr){var vr=Pr[yr];function Mr(kn,fr){var Sn=kn.invoke(fr,vr),Or=kn.shared,Zr=kn.constants,wa=Or.isBufferArgs,Na=Or.buffer;Rt.optional(function(){kn.assert(fr,Sn+"&&(typeof "+Sn+'==="object"||typeof '+Sn+'==="function")&&('+wa+"("+Sn+")||"+Na+".getBuffer("+Sn+")||"+Na+".getBuffer("+Sn+".buffer)||"+wa+"("+Sn+'.buffer)||("constant" in '+Sn+"&&(typeof "+Sn+'.constant==="number"||'+Or.isArrayLike+"("+Sn+".constant))))",'invalid dynamic attribute "'+yr+'"')});var ga={isStream:fr.def(!1)},ai=new _t;ai.state=Kf,Object.keys(ai).forEach(function(Io){ga[Io]=fr.def(""+ai[Io])});var lo=ga.buffer,cs=ga.type;fr("if(",wa,"(",Sn,")){",ga.isStream,"=true;",lo,"=",Na,".createStream(",af,",",Sn,");",cs,"=",lo,".dtype;","}else{",lo,"=",Na,".getBuffer(",Sn,");","if(",lo,"){",cs,"=",lo,".dtype;",'}else if("constant" in ',Sn,"){",ga.state,"=",Fh,";","if(typeof "+Sn+'.constant === "number"){',ga[Bf[0]],"=",Sn,".constant;",Bf.slice(1).map(function(Io){return ga[Io]}).join("="),"=0;","}else{",Bf.map(function(Io,Mo){return ga[Io]+"="+Sn+".constant.length>"+Mo+"?"+Sn+".constant["+Mo+"]:0;"}).join(""),"}}else{","if(",wa,"(",Sn,".buffer)){",lo,"=",Na,".createStream(",af,",",Sn,".buffer);","}else{",lo,"=",Na,".getBuffer(",Sn,".buffer);","}",cs,'="type" in ',Sn,"?",Zr.glTypes,"[",Sn,".type]:",lo,".dtype;",ga.normalized,"=!!",Sn,".normalized;");function Qi(Io){fr(ga[Io],"=",Sn,".",Io,"|0;")}return Qi("size"),Qi("offset"),Qi("stride"),Qi("divisor"),fr("}}"),fr.exit("if(",ga.isStream,"){",Na,".destroyStream(",lo,");","}"),ga}Xr[yr]=Fc(vr,Mr)}),Xr}function Fl(An,sn){var hr=An.static,Pr=An.dynamic;if(xp in hr){var Xr=hr[xp];return Xr!==null&&Ga.getVAO(Xr)===null&&(Xr=Ga.createVAO(Xr)),El(function(vr){return vr.link(Ga.getVAO(Xr))})}else if(xp in Pr){var yr=Pr[xp];return Fc(yr,function(vr,Mr){var kn=vr.invoke(Mr,yr);return Mr.def(vr.shared.vao+".getVAO("+kn+")")})}return null}function ku(An){var sn=An.static,hr=An.dynamic,Pr={};return Object.keys(sn).forEach(function(Xr){var yr=sn[Xr];Pr[Xr]=El(function(vr,Mr){return typeof yr=="number"||typeof yr=="boolean"?""+yr:vr.link(yr)})}),Object.keys(hr).forEach(function(Xr){var yr=hr[Xr];Pr[Xr]=Fc(yr,function(vr,Mr){return vr.invoke(Mr,yr)})}),Pr}function xs(An,sn,hr,Pr,Xr){var yr=An.static,vr=An.dynamic;Rt.optional(function(){var Qi=[Vh,Kc,_f,lc,If,bp,Jf,dd,Wh,xp].concat(Ke);function Io(Mo){Object.keys(Mo).forEach(function(Os){Rt.command(Qi.indexOf(Os)>=0,'unknown parameter "'+Os+'"',Xr.commandStr)})}Io(yr),Io(vr)});var Mr=Yi(An,sn),kn=si(An,Xr),fr=Ci(An,kn,Xr),Sn=Yo(An,Xr),Or=xi(An,Xr),Zr=_i(An,Xr,Mr);function wa(Qi){var Io=fr[Qi];Io&&(Or[Qi]=Io)}wa(xc),wa(jn(Rd));var Na=Object.keys(Or).length>0,ga={framebuffer:kn,draw:Sn,shader:Zr,state:Or,dirty:Na,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ga.profile=Hn(An,Xr),ga.uniforms=Xu(hr,Xr),ga.drawVAO=ga.scopeVAO=Fl(An,Xr),!ga.drawVAO&&Zr.program&&!Mr&&qn.angle_instanced_arrays){var ai=!0,lo=Zr.program.attributes.map(function(Qi){var Io=sn.static[Qi];return ai=ai&&!!Io,Io});if(ai&&lo.length>0){var cs=Ga.getVAO(Ga.createVAO(lo));ga.drawVAO=new Nc(null,null,null,function(Qi,Io){return Qi.link(cs)}),ga.useVAO=!0}}return Mr?ga.useVAO=!0:ga.attributes=jo(sn,Xr),ga.context=ku(Pr,Xr),ga}function _u(An,sn,hr){var Pr=An.shared,Xr=Pr.context,yr=An.scope();Object.keys(hr).forEach(function(vr){sn.save(Xr,"."+vr);var Mr=hr[vr],kn=Mr.append(An,sn);Array.isArray(kn)?yr(Xr,".",vr,"=[",kn.join(),"];"):yr(Xr,".",vr,"=",kn,";")}),sn(yr)}function cl(An,sn,hr,Pr){var Xr=An.shared,yr=Xr.gl,vr=Xr.framebuffer,Mr;ie&&(Mr=sn.def(Xr.extensions,".webgl_draw_buffers"));var kn=An.constants,fr=kn.drawBuffer,Sn=kn.backBuffer,Or;hr?Or=hr.append(An,sn):Or=sn.def(vr,".next"),Pr||sn("if(",Or,"!==",vr,".cur){"),sn("if(",Or,"){",yr,".bindFramebuffer(",rv,",",Or,".framebuffer);"),ie&&sn(Mr,".drawBuffersWEBGL(",fr,"[",Or,".colorAttachments.length]);"),sn("}else{",yr,".bindFramebuffer(",rv,",null);"),ie&&sn(Mr,".drawBuffersWEBGL(",Sn,");"),sn("}",vr,".cur=",Or,";"),Pr||sn("}")}function zi(An,sn,hr){var Pr=An.shared,Xr=Pr.gl,yr=An.current,vr=An.next,Mr=Pr.current,kn=Pr.next,fr=An.cond(Mr,".dirty");Ke.forEach(function(Sn){var Or=jn(Sn);if(!(Or in hr.state)){var Zr,wa;if(Or in vr){Zr=vr[Or],wa=yr[Or];var Na=$r(he[Or].length,function(ai){return fr.def(Zr,"[",ai,"]")});fr(An.cond(Na.map(function(ai,lo){return ai+"!=="+wa+"["+lo+"]"}).join("||")).then(Xr,".",cn[Or],"(",Na,");",Na.map(function(ai,lo){return wa+"["+lo+"]="+ai}).join(";"),";"))}else{Zr=fr.def(kn,".",Or);var ga=An.cond(Zr,"!==",Mr,".",Or);fr(ga),Or in gn?ga(An.cond(Zr).then(Xr,".enable(",gn[Or],");").else(Xr,".disable(",gn[Or],");"),Mr,".",Or,"=",Zr,";"):ga(Xr,".",cn[Or],"(",Zr,");",Mr,".",Or,"=",Zr,";")}}}),Object.keys(hr.state).length===0&&fr(Mr,".dirty=false;"),sn(fr)}function zu(An,sn,hr,Pr){var Xr=An.shared,yr=An.current,vr=Xr.current,Mr=Xr.gl;ov(Object.keys(hr)).forEach(function(kn){var fr=hr[kn];if(!(Pr&&!Pr(fr))){var Sn=fr.append(An,sn);if(gn[kn]){var Or=gn[kn];Ch(fr)?Sn?sn(Mr,".enable(",Or,");"):sn(Mr,".disable(",Or,");"):sn(An.cond(Sn).then(Mr,".enable(",Or,");").else(Mr,".disable(",Or,");")),sn(vr,".",kn,"=",Sn,";")}else if(Ls(Sn)){var Zr=yr[kn];sn(Mr,".",cn[kn],"(",Sn,");",Sn.map(function(wa,Na){return Zr+"["+Na+"]="+wa}).join(";"),";")}else sn(Mr,".",cn[kn],"(",Sn,");",vr,".",kn,"=",Sn,";")}})}function sl(An,sn){jt&&(An.instancing=sn.def(An.shared.extensions,".angle_instanced_arrays"))}function Qo(An,sn,hr,Pr,Xr){var yr=An.shared,vr=An.stats,Mr=yr.current,kn=yr.timer,fr=hr.profile;function Sn(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var Or,Zr;function wa(Qi){Or=sn.def(),Qi(Or,"=",Sn(),";"),typeof Xr=="string"?Qi(vr,".count+=",Xr,";"):Qi(vr,".count++;"),q&&(Pr?(Zr=sn.def(),Qi(Zr,"=",kn,".getNumPendingQueries();")):Qi(kn,".beginQuery(",vr,");"))}function Na(Qi){Qi(vr,".cpuTime+=",Sn(),"-",Or,";"),q&&(Pr?Qi(kn,".pushScopeStats(",Zr,",",kn,".getNumPendingQueries(),",vr,");"):Qi(kn,".endQuery();"))}function ga(Qi){var Io=sn.def(Mr,".profile");sn(Mr,".profile=",Qi,";"),sn.exit(Mr,".profile=",Io,";")}var ai;if(fr){if(Ch(fr)){fr.enable?(wa(sn),Na(sn.exit),ga("true")):ga("false");return}ai=fr.append(An,sn),ga(ai)}else ai=sn.def(Mr,".profile");var lo=An.block();wa(lo),sn("if(",ai,"){",lo,"}");var cs=An.block();Na(cs),sn.exit("if(",ai,"){",cs,"}")}function Zl(An,sn,hr,Pr,Xr){var yr=An.shared;function vr(kn){switch(kn){case Hh:case Bd:case zd:return 2;case Pd:case wh:case $d:return 3;case Fd:case Cp:case gd:return 4;default:return 1}}function Mr(kn,fr,Sn){var Or=yr.gl,Zr=sn.def(kn,".location"),wa=sn.def(yr.attributes,"[",Zr,"]"),Na=Sn.state,ga=Sn.buffer,ai=[Sn.x,Sn.y,Sn.z,Sn.w],lo=["buffer","normalized","offset","stride"];function cs(){sn("if(!",wa,".buffer){",Or,".enableVertexAttribArray(",Zr,");}");var Io=Sn.type,Mo;if(Sn.size?Mo=sn.def(Sn.size,"||",fr):Mo=fr,sn("if(",wa,".type!==",Io,"||",wa,".size!==",Mo,"||",lo.map(function(yl){return wa+"."+yl+"!=="+Sn[yl]}).join("||"),"){",Or,".bindBuffer(",af,",",ga,".buffer);",Or,".vertexAttribPointer(",[Zr,Mo,Io,Sn.normalized,Sn.stride,Sn.offset],");",wa,".type=",Io,";",wa,".size=",Mo,";",lo.map(function(yl){return wa+"."+yl+"="+Sn[yl]+";"}).join(""),"}"),jt){var Os=Sn.divisor;sn("if(",wa,".divisor!==",Os,"){",An.instancing,".vertexAttribDivisorANGLE(",[Zr,Os],");",wa,".divisor=",Os,";}")}}function Qi(){sn("if(",wa,".buffer){",Or,".disableVertexAttribArray(",Zr,");",wa,".buffer=null;","}if(",Bf.map(function(Io,Mo){return wa+"."+Io+"!=="+ai[Mo]}).join("||"),"){",Or,".vertexAttrib4f(",Zr,",",ai,");",Bf.map(function(Io,Mo){return wa+"."+Io+"="+ai[Mo]+";"}).join(""),"}")}Na===Kf?cs():Na===Fh?Qi():(sn("if(",Na,"===",Kf,"){"),cs(),sn("}else{"),Qi(),sn("}"))}Pr.forEach(function(kn){var fr=kn.name,Sn=hr.attributes[fr],Or;if(Sn){if(!Xr(Sn))return;Or=Sn.append(An,sn)}else{if(!Xr(jd))return;var Zr=An.scopeAttrib(fr);Rt.optional(function(){An.assert(sn,Zr+".state","missing attribute "+fr)}),Or={},Object.keys(new _t).forEach(function(wa){Or[wa]=sn.def(Zr,".",wa)})}Mr(An.link(kn),vr(kn.info.type),Or)})}function yu(An,sn,hr,Pr,Xr){for(var yr=An.shared,vr=yr.gl,Mr,kn=0;kn<Pr.length;++kn){var fr=Pr[kn],Sn=fr.name,Or=fr.info.type,Zr=hr.uniforms[Sn],wa=An.link(fr),Na=wa+".location",ga;if(Zr){if(!Xr(Zr))continue;if(Ch(Zr)){var ai=Zr.value;if(Rt.command(ai!==null&&typeof ai!="undefined",'missing uniform "'+Sn+'"',An.commandStr),Or===Xh||Or===Wd){Rt.command(typeof ai=="function"&&(Or===Xh&&(ai._reglType==="texture2d"||ai._reglType==="framebuffer")||Or===Wd&&(ai._reglType==="textureCube"||ai._reglType==="framebufferCube")),"invalid texture for uniform "+Sn,An.commandStr);var lo=An.link(ai._texture||ai.color[0]._texture);sn(vr,".uniform1i(",Na,",",lo+".bind());"),sn.exit(lo,".unbind();")}else if(Or===Eh||Or===Gd||Or===Ud){Rt.optional(function(){Rt.command(Ls(ai),"invalid matrix for uniform "+Sn,An.commandStr),Rt.command(Or===Eh&&ai.length===4||Or===Gd&&ai.length===9||Or===Ud&&ai.length===16,"invalid length for matrix uniform "+Sn,An.commandStr)});var cs=An.global.def("new Float32Array(["+Array.prototype.slice.call(ai)+"])"),Qi=2;Or===Gd?Qi=3:Or===Ud&&(Qi=4),sn(vr,".uniformMatrix",Qi,"fv(",Na,",false,",cs,");")}else{switch(Or){case vd:Rt.commandType(ai,"number","uniform "+Sn,An.commandStr),Mr="1f";break;case Hh:Rt.command(Ls(ai)&&ai.length===2,"uniform "+Sn,An.commandStr),Mr="2f";break;case Pd:Rt.command(Ls(ai)&&ai.length===3,"uniform "+Sn,An.commandStr),Mr="3f";break;case Fd:Rt.command(Ls(ai)&&ai.length===4,"uniform "+Sn,An.commandStr),Mr="4f";break;case Tf:Rt.commandType(ai,"boolean","uniform "+Sn,An.commandStr),Mr="1i";break;case Sp:Rt.commandType(ai,"number","uniform "+Sn,An.commandStr),Mr="1i";break;case zd:Rt.command(Ls(ai)&&ai.length===2,"uniform "+Sn,An.commandStr),Mr="2i";break;case Bd:Rt.command(Ls(ai)&&ai.length===2,"uniform "+Sn,An.commandStr),Mr="2i";break;case $d:Rt.command(Ls(ai)&&ai.length===3,"uniform "+Sn,An.commandStr),Mr="3i";break;case wh:Rt.command(Ls(ai)&&ai.length===3,"uniform "+Sn,An.commandStr),Mr="3i";break;case gd:Rt.command(Ls(ai)&&ai.length===4,"uniform "+Sn,An.commandStr),Mr="4i";break;case Cp:Rt.command(Ls(ai)&&ai.length===4,"uniform "+Sn,An.commandStr),Mr="4i";break}sn(vr,".uniform",Mr,"(",Na,",",Ls(ai)?Array.prototype.slice.call(ai):ai,");")}continue}else ga=Zr.append(An,sn)}else{if(!Xr(jd))continue;ga=sn.def(yr.uniforms,"[",vn.id(Sn),"]")}Or===Xh?(Rt(!Array.isArray(ga),"must specify a scalar prop for textures"),sn("if(",ga,"&&",ga,'._reglType==="framebuffer"){',ga,"=",ga,".color[0];","}")):Or===Wd&&(Rt(!Array.isArray(ga),"must specify a scalar prop for cube maps"),sn("if(",ga,"&&",ga,'._reglType==="framebufferCube"){',ga,"=",ga,".color[0];","}")),Rt.optional(function(){function sf(Nf,mf){An.assert(sn,Nf,'bad data or missing for uniform "'+Sn+'".  '+mf)}function Ih(Nf){Rt(!Array.isArray(ga),"must not specify an array type for uniform"),sf("typeof "+ga+'==="'+Nf+'"',"invalid type, expected "+Nf)}function ah(Nf,mf){Array.isArray(ga)?Rt(ga.length===Nf,"must have length "+Nf):sf(yr.isArrayLike+"("+ga+")&&"+ga+".length==="+Nf,"invalid vector, should have length "+Nf,An.commandStr)}function Lv(Nf){Rt(!Array.isArray(ga),"must not specify a value type"),sf("typeof "+ga+'==="function"&&'+ga+'._reglType==="texture'+(Nf===Kp?"2d":"Cube")+'"',"invalid texture type",An.commandStr)}switch(Or){case Sp:Ih("number");break;case Bd:ah(2,"number");break;case wh:ah(3,"number");break;case Cp:ah(4,"number");break;case vd:Ih("number");break;case Hh:ah(2,"number");break;case Pd:ah(3,"number");break;case Fd:ah(4,"number");break;case Tf:Ih("boolean");break;case zd:ah(2,"boolean");break;case $d:ah(3,"boolean");break;case gd:ah(4,"boolean");break;case Eh:ah(4,"number");break;case Gd:ah(9,"number");break;case Ud:ah(16,"number");break;case Xh:Lv(Kp);break;case Wd:Lv(Ep);break}});var Io=1;switch(Or){case Xh:case Wd:var Mo=sn.def(ga,"._texture");sn(vr,".uniform1i(",Na,",",Mo,".bind());"),sn.exit(Mo,".unbind();");continue;case Sp:case Tf:Mr="1i";break;case Bd:case zd:Mr="2i",Io=2;break;case wh:case $d:Mr="3i",Io=3;break;case Cp:case gd:Mr="4i",Io=4;break;case vd:Mr="1f";break;case Hh:Mr="2f",Io=2;break;case Pd:Mr="3f",Io=3;break;case Fd:Mr="4f",Io=4;break;case Eh:Mr="Matrix2fv";break;case Gd:Mr="Matrix3fv";break;case Ud:Mr="Matrix4fv";break}if(sn(vr,".uniform",Mr,"(",Na,","),Mr.charAt(0)==="M"){var Os=Math.pow(Or-Eh+2,2),yl=An.global.def("new Float32Array(",Os,")");Array.isArray(ga)?sn("false,(",$r(Os,function(sf){return yl+"["+sf+"]="+ga[sf]}),",",yl,")"):sn("false,(Array.isArray(",ga,")||",ga," instanceof Float32Array)?",ga,":(",$r(Os,function(sf){return yl+"["+sf+"]="+ga+"["+sf+"]"}),",",yl,")")}else Io>1?sn($r(Io,function(sf){return Array.isArray(ga)?ga[sf]:ga+"["+sf+"]"})):(Rt(!Array.isArray(ga),"uniform value must not be an array"),sn(ga));sn(");")}}function po(An,sn,hr,Pr){var Xr=An.shared,yr=Xr.gl,vr=Xr.draw,Mr=Pr.draw;function kn(){var Mo=Mr.elements,Os,yl=sn;return Mo?((Mo.contextDep&&Pr.contextDynamic||Mo.propDep)&&(yl=hr),Os=Mo.append(An,yl)):Os=yl.def(vr,".",lc),Os&&yl("if("+Os+")"+yr+".bindBuffer("+qi+","+Os+".buffer.buffer);"),Os}function fr(){var Mo=Mr.count,Os,yl=sn;return Mo?((Mo.contextDep&&Pr.contextDynamic||Mo.propDep)&&(yl=hr),Os=Mo.append(An,yl),Rt.optional(function(){Mo.MISSING&&An.assert(sn,"false","missing vertex count"),Mo.DYNAMIC&&An.assert(yl,Os+">=0","missing vertex count")})):(Os=yl.def(vr,".",Jf),Rt.optional(function(){An.assert(yl,Os+">=0","missing vertex count")})),Os}var Sn=kn();function Or(Mo){var Os=Mr[Mo];return Os?Os.contextDep&&Pr.contextDynamic||Os.propDep?Os.append(An,hr):Os.append(An,sn):sn.def(vr,".",Mo)}var Zr=Or(If),wa=Or(bp),Na=fr();if(typeof Na=="number"){if(Na===0)return}else hr("if(",Na,"){"),hr.exit("}");var ga,ai;jt&&(ga=Or(dd),ai=An.instancing);var lo=Sn+".type",cs=Mr.elements&&Ch(Mr.elements);function Qi(){function Mo(){hr(ai,".drawElementsInstancedANGLE(",[Zr,Na,lo,wa+"<<(("+lo+"-"+zf+")>>1)",ga],");")}function Os(){hr(ai,".drawArraysInstancedANGLE(",[Zr,wa,Na,ga],");")}Sn?cs?Mo():(hr("if(",Sn,"){"),Mo(),hr("}else{"),Os(),hr("}")):Os()}function Io(){function Mo(){hr(yr+".drawElements("+[Zr,Na,lo,wa+"<<(("+lo+"-"+zf+")>>1)"]+");")}function Os(){hr(yr+".drawArrays("+[Zr,wa,Na]+");")}Sn?cs?Mo():(hr("if(",Sn,"){"),Mo(),hr("}else{"),Os(),hr("}")):Os()}jt&&(typeof ga!="number"||ga>=0)?typeof ga=="string"?(hr("if(",ga,">0){"),Qi(),hr("}else if(",ga,"<0){"),Io(),hr("}")):Qi():Io()}function Ds(An,sn,hr,Pr,Xr){var yr=Xa(),vr=yr.proc("body",Xr);return Rt.optional(function(){yr.commandStr=sn.commandStr,yr.command=yr.link(sn.commandStr)}),jt&&(yr.instancing=vr.def(yr.shared.extensions,".angle_instanced_arrays")),An(yr,vr,hr,Pr),yr.compile().body}function pi(An,sn,hr,Pr){sl(An,sn),hr.useVAO?hr.drawVAO?sn(An.shared.vao,".setVAO(",hr.drawVAO.append(An,sn),");"):sn(An.shared.vao,".setVAO(",An.shared.vao,".targetVAO);"):(sn(An.shared.vao,".setVAO(null);"),Zl(An,sn,hr,Pr.attributes,function(){return!0})),yu(An,sn,hr,Pr.uniforms,function(){return!0}),po(An,sn,sn,hr)}function Sl(An,sn){var hr=An.proc("draw",1);sl(An,hr),_u(An,hr,sn.context),cl(An,hr,sn.framebuffer),zi(An,hr,sn),zu(An,hr,sn.state),Qo(An,hr,sn,!1,!0);var Pr=sn.shader.progVar.append(An,hr);if(hr(An.shared.gl,".useProgram(",Pr,".program);"),sn.shader.program)pi(An,hr,sn,sn.shader.program);else{hr(An.shared.vao,".setVAO(null);");var Xr=An.global.def("{}"),yr=hr.def(Pr,".id"),vr=hr.def(Xr,"[",yr,"]");hr(An.cond(vr).then(vr,".call(this,a0);").else(vr,"=",Xr,"[",yr,"]=",An.link(function(Mr){return Ds(pi,An,sn,Mr,1)}),"(",Pr,");",vr,".call(this,a0);"))}Object.keys(sn.state).length>0&&hr(An.shared.current,".dirty=true;")}function rh(An,sn,hr,Pr){An.batchId="a1",sl(An,sn);function Xr(){return!0}Zl(An,sn,hr,Pr.attributes,Xr),yu(An,sn,hr,Pr.uniforms,Xr),po(An,sn,sn,hr)}function fl(An,sn,hr,Pr){sl(An,sn);var Xr=hr.contextDep,yr=sn.def(),vr="a0",Mr="a1",kn=sn.def();An.shared.props=kn,An.batchId=yr;var fr=An.scope(),Sn=An.scope();sn(fr.entry,"for(",yr,"=0;",yr,"<",Mr,";++",yr,"){",kn,"=",vr,"[",yr,"];",Sn,"}",fr.exit);function Or(lo){return lo.contextDep&&Xr||lo.propDep}function Zr(lo){return!Or(lo)}if(hr.needsContext&&_u(An,Sn,hr.context),hr.needsFramebuffer&&cl(An,Sn,hr.framebuffer),zu(An,Sn,hr.state,Or),hr.profile&&Or(hr.profile)&&Qo(An,Sn,hr,!1,!0),Pr)hr.useVAO?hr.drawVAO?Or(hr.drawVAO)?Sn(An.shared.vao,".setVAO(",hr.drawVAO.append(An,Sn),");"):fr(An.shared.vao,".setVAO(",hr.drawVAO.append(An,fr),");"):fr(An.shared.vao,".setVAO(",An.shared.vao,".targetVAO);"):(fr(An.shared.vao,".setVAO(null);"),Zl(An,fr,hr,Pr.attributes,Zr),Zl(An,Sn,hr,Pr.attributes,Or)),yu(An,fr,hr,Pr.uniforms,Zr),yu(An,Sn,hr,Pr.uniforms,Or),po(An,fr,Sn,hr);else{var wa=An.global.def("{}"),Na=hr.shader.progVar.append(An,Sn),ga=Sn.def(Na,".id"),ai=Sn.def(wa,"[",ga,"]");Sn(An.shared.gl,".useProgram(",Na,".program);","if(!",ai,"){",ai,"=",wa,"[",ga,"]=",An.link(function(lo){return Ds(rh,An,hr,lo,2)}),"(",Na,");}",ai,".call(this,a0[",yr,"],",yr,");")}}function $n(An,sn){var hr=An.proc("batch",2);An.batchId="0",sl(An,hr);var Pr=!1,Xr=!0;Object.keys(sn.context).forEach(function(wa){Pr=Pr||sn.context[wa].propDep}),Pr||(_u(An,hr,sn.context),Xr=!1);var yr=sn.framebuffer,vr=!1;yr?(yr.propDep?Pr=vr=!0:yr.contextDep&&Pr&&(vr=!0),vr||cl(An,hr,yr)):cl(An,hr,null),sn.state.viewport&&sn.state.viewport.propDep&&(Pr=!0);function Mr(wa){return wa.contextDep&&Pr||wa.propDep}zi(An,hr,sn),zu(An,hr,sn.state,function(wa){return!Mr(wa)}),(!sn.profile||!Mr(sn.profile))&&Qo(An,hr,sn,!1,"a1"),sn.contextDep=Pr,sn.needsContext=Xr,sn.needsFramebuffer=vr;var kn=sn.shader.progVar;if(kn.contextDep&&Pr||kn.propDep)fl(An,hr,sn,null);else{var fr=kn.append(An,hr);if(hr(An.shared.gl,".useProgram(",fr,".program);"),sn.shader.program)fl(An,hr,sn,sn.shader.program);else{hr(An.shared.vao,".setVAO(null);");var Sn=An.global.def("{}"),Or=hr.def(fr,".id"),Zr=hr.def(Sn,"[",Or,"]");hr(An.cond(Zr).then(Zr,".call(this,a0,a1);").else(Zr,"=",Sn,"[",Or,"]=",An.link(function(wa){return Ds(fl,An,sn,wa,2)}),"(",fr,");",Zr,".call(this,a0,a1);"))}}Object.keys(sn.state).length>0&&hr(An.shared.current,".dirty=true;")}function Jr(An,sn){var hr=An.proc("scope",3);An.batchId="a2";var Pr=An.shared,Xr=Pr.current;_u(An,hr,sn.context),sn.framebuffer&&sn.framebuffer.append(An,hr),ov(Object.keys(sn.state)).forEach(function(vr){var Mr=sn.state[vr],kn=Mr.append(An,hr);Ls(kn)?kn.forEach(function(fr,Sn){hr.set(An.next[vr],"["+Sn+"]",fr)}):hr.set(Pr.next,"."+vr,kn)}),Qo(An,hr,sn,!0,!0),[lc,bp,Jf,dd,If].forEach(function(vr){var Mr=sn.draw[vr];!Mr||hr.set(Pr.draw,"."+vr,""+Mr.append(An,hr))}),Object.keys(sn.uniforms).forEach(function(vr){var Mr=sn.uniforms[vr].append(An,hr);Array.isArray(Mr)&&(Mr="["+Mr.join()+"]"),hr.set(Pr.uniforms,"["+vn.id(vr)+"]",Mr)}),Object.keys(sn.attributes).forEach(function(vr){var Mr=sn.attributes[vr].append(An,hr),kn=An.scopeAttrib(vr);Object.keys(new _t).forEach(function(fr){hr.set(kn,"."+fr,Mr[fr])})}),sn.scopeVAO&&hr.set(Pr.vao,".targetVAO",sn.scopeVAO.append(An,hr));function yr(vr){var Mr=sn.shader[vr];Mr&&hr.set(Pr.shader,"."+vr,Mr.append(An,hr))}yr(Kc),yr(_f),Object.keys(sn.state).length>0&&(hr(Xr,".dirty=true;"),hr.exit(Xr,".dirty=true;")),hr("a1(",An.shared.context,",a0,",An.batchId,");")}function Nr(An){if(!(typeof An!="object"||Ls(An))){for(var sn=Object.keys(An),hr=0;hr<sn.length;++hr)if(sr.isDynamic(An[sn[hr]]))return!0;return!1}}function Hi(An,sn,hr){var Pr=sn.static[hr];if(!Pr||!Nr(Pr))return;var Xr=An.global,yr=Object.keys(Pr),vr=!1,Mr=!1,kn=!1,fr=An.global.def("{}");yr.forEach(function(Or){var Zr=Pr[Or];if(sr.isDynamic(Zr)){typeof Zr=="function"&&(Zr=Pr[Or]=sr.unbox(Zr));var wa=Fc(Zr,null);vr=vr||wa.thisDep,kn=kn||wa.propDep,Mr=Mr||wa.contextDep}else{switch(Xr(fr,".",Or,"="),typeof Zr){case"number":Xr(Zr);break;case"string":Xr('"',Zr,'"');break;case"object":Array.isArray(Zr)&&Xr("[",Zr.join(),"]");break;default:Xr(An.link(Zr));break}Xr(";")}});function Sn(Or,Zr){yr.forEach(function(wa){var Na=Pr[wa];if(!!sr.isDynamic(Na)){var ga=Or.invoke(Zr,Na);Zr(fr,".",wa,"=",ga,";")}})}sn.dynamic[hr]=new sr.DynamicVariable(fd,{thisDep:vr,contextDep:Mr,propDep:kn,ref:fr,append:Sn}),delete sn.static[hr]}function Jo(An,sn,hr,Pr,Xr){var yr=Xa();yr.stats=yr.link(Xr),Object.keys(sn.static).forEach(function(Mr){Hi(yr,sn,Mr)}),zs.forEach(function(Mr){Hi(yr,An,Mr)});var vr=xs(An,sn,hr,Pr,yr);return Sl(yr,vr),Jr(yr,vr),$n(yr,vr),$(yr.compile(),{destroy:function(){vr.shader.program.destroy()}})}return{next:Te,current:he,procs:function(){var An=Xa(),sn=An.proc("poll"),hr=An.proc("refresh"),Pr=An.block();sn(Pr),hr(Pr);var Xr=An.shared,yr=Xr.gl,vr=Xr.next,Mr=Xr.current;Pr(Mr,".dirty=false;"),cl(An,sn),cl(An,hr,null,!0);var kn;jt&&(kn=An.link(jt)),qn.oes_vertex_array_object&&hr(An.link(qn.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var fr=0;fr<ia.maxAttributes;++fr){var Sn=hr.def(Xr.attributes,"[",fr,"]"),Or=An.cond(Sn,".buffer");Or.then(yr,".enableVertexAttribArray(",fr,");",yr,".bindBuffer(",af,",",Sn,".buffer.buffer);",yr,".vertexAttribPointer(",fr,",",Sn,".size,",Sn,".type,",Sn,".normalized,",Sn,".stride,",Sn,".offset);").else(yr,".disableVertexAttribArray(",fr,");",yr,".vertexAttrib4f(",fr,",",Sn,".x,",Sn,".y,",Sn,".z,",Sn,".w);",Sn,".buffer=null;"),hr(Or),jt&&hr(kn,".vertexAttribDivisorANGLE(",fr,",",Sn,".divisor);")}return hr(An.shared.vao,".currentVAO=null;",An.shared.vao,".setVAO(",An.shared.vao,".targetVAO);"),Object.keys(gn).forEach(function(Zr){var wa=gn[Zr],Na=Pr.def(vr,".",Zr),ga=An.block();ga("if(",Na,"){",yr,".enable(",wa,")}else{",yr,".disable(",wa,")}",Mr,".",Zr,"=",Na,";"),hr(ga),sn("if(",Na,"!==",Mr,".",Zr,"){",ga,"}")}),Object.keys(cn).forEach(function(Zr){var wa=cn[Zr],Na=he[Zr],ga,ai,lo=An.block();if(lo(yr,".",wa,"("),Ls(Na)){var cs=Na.length;ga=An.global.def(vr,".",Zr),ai=An.global.def(Mr,".",Zr),lo($r(cs,function(Qi){return ga+"["+Qi+"]"}),");",$r(cs,function(Qi){return ai+"["+Qi+"]="+ga+"["+Qi+"];"}).join("")),sn("if(",$r(cs,function(Qi){return ga+"["+Qi+"]!=="+ai+"["+Qi+"]"}).join("||"),"){",lo,"}")}else ga=Pr.def(vr,".",Zr),ai=Pr.def(Mr,".",Zr),lo(ga,");",Mr,".",Zr,"=",ga,";"),sn("if(",ga,"!==",ai,"){",lo,"}");hr(lo)}),An.compile()}(),compile:Jo}}function sv(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var uv=34918,Ip=34919,_h=35007,of=function(oe,vn){if(!vn.ext_disjoint_timer_query)return null;var qn=[];function ia(){return qn.pop()||vn.ext_disjoint_timer_query.createQueryEXT()}function Sa(jt){qn.push(jt)}var Hr=[];function ea(jt){var ie=ia();vn.ext_disjoint_timer_query.beginQueryEXT(_h,ie),Hr.push(ie),q(Hr.length-1,Hr.length,jt)}function Ha(){vn.ext_disjoint_timer_query.endQueryEXT(_h)}function Wa(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Ga=[];function Qa(){return Ga.pop()||new Wa}function Vn(jt){Ga.push(jt)}var M=[];function q(jt,ie,he){var Te=Qa();Te.startQueryIndex=jt,Te.endQueryIndex=ie,Te.sum=0,Te.stats=he,M.push(Te)}var dt=[],_t=[];function Pt(){var jt,ie,he=Hr.length;if(he!==0){_t.length=Math.max(_t.length,he+1),dt.length=Math.max(dt.length,he+1),dt[0]=0,_t[0]=0;var Te=0;for(jt=0,ie=0;ie<Hr.length;++ie){var Ke=Hr[ie];vn.ext_disjoint_timer_query.getQueryObjectEXT(Ke,Ip)?(Te+=vn.ext_disjoint_timer_query.getQueryObjectEXT(Ke,uv),Sa(Ke)):Hr[jt++]=Ke,dt[ie+1]=Te,_t[ie+1]=jt}for(Hr.length=jt,jt=0,ie=0;ie<M.length;++ie){var gn=M[ie],cn=gn.startQueryIndex,jn=gn.endQueryIndex;gn.sum+=dt[jn]-dt[cn];var En=_t[cn],ya=_t[jn];ya===En?(gn.stats.gpuTime+=gn.sum/1e6,Vn(gn)):(gn.startQueryIndex=En,gn.endQueryIndex=ya,M[jt++]=gn)}M.length=jt}}return{beginQuery:ea,endQuery:Ha,pushScopeStats:q,update:Pt,getNumPendingQueries:function(){return Hr.length},clear:function(){qn.push.apply(qn,Hr);for(var jt=0;jt<qn.length;jt++)vn.ext_disjoint_timer_query.deleteQueryEXT(qn[jt]);Hr.length=0,qn.length=0},restore:function(){Hr.length=0,qn.length=0}}},li=16384,eg=256,Tp=1024,lv=34962,Ap="webglcontextlost",yd="webglcontextrestored",cv=1,nh=2,Rv=3;function Mp(oe,vn){for(var qn=0;qn<oe.length;++qn)if(oe[qn]===vn)return qn;return-1}function Np(oe){var vn=qr(oe);if(!vn)return null;var qn=vn.gl,ia=qn.getContextAttributes(),Sa=qn.isContextLost(),Hr=ua(qn,vn);if(!Hr)return null;var ea=zn(),Ha=sv(),Wa=Hr.extensions,Ga=of(qn,Wa),Qa=tr(),Vn=qn.drawingBufferWidth,M=qn.drawingBufferHeight,q={tick:0,time:0,viewportWidth:Vn,viewportHeight:M,framebufferWidth:Vn,framebufferHeight:M,drawingBufferWidth:Vn,drawingBufferHeight:M,pixelRatio:vn.pixelRatio},dt={},_t={elements:null,primitive:4,count:-1,offset:0,instances:-1},Pt=bi(qn,Wa),jt=Ao(qn,Ha,vn,he),ie=pp(qn,Wa,Pt,Ha,jt);function he(po){return ie.destroyBuffer(po)}var Te=Ju(qn,Wa,jt,Ha),Ke=yc(qn,ea,Ha,vn),gn=ph(qn,Wa,Pt,function(){En.procs.poll()},q,Ha,vn),cn=ae(qn,Wa,Pt,Ha,vn),jn=Xf(qn,Wa,Pt,gn,cn,Ha),En=_p(qn,ea,Wa,Pt,jt,Te,gn,jn,dt,ie,Ke,_t,q,Ga,vn),ya=tc(qn,jn,En.procs.poll,q,ia,Wa,Pt),Dr=En.next,Fr=qn.canvas,or=[],Xa=[],Hn=[],si=[vn.onDestroy],Ci=null;function Yi(){if(or.length===0){Ga&&Ga.update(),Ci=null;return}Ci=Pn.next(Yi),zu();for(var po=or.length-1;po>=0;--po){var Ds=or[po];Ds&&Ds(q,null,0)}qn.flush(),Ga&&Ga.update()}function _i(){!Ci&&or.length>0&&(Ci=Pn.next(Yi))}function Yo(){Ci&&(Pn.cancel(Yi),Ci=null)}function xi(po){po.preventDefault(),Sa=!0,Yo(),Xa.forEach(function(Ds){Ds()})}function Xu(po){qn.getError(),Sa=!1,Hr.restore(),Ke.restore(),jt.restore(),gn.restore(),cn.restore(),jn.restore(),ie.restore(),Ga&&Ga.restore(),En.procs.refresh(),_i(),Hn.forEach(function(Ds){Ds()})}Fr&&(Fr.addEventListener(Ap,xi,!1),Fr.addEventListener(yd,Xu,!1));function jo(){or.length=0,Yo(),Fr&&(Fr.removeEventListener(Ap,xi),Fr.removeEventListener(yd,Xu)),Ke.clear(),jn.clear(),cn.clear(),gn.clear(),Te.clear(),jt.clear(),ie.clear(),Ga&&Ga.clear(),si.forEach(function(po){po()})}function Fl(po){Rt(!!po,"invalid args to regl({...})"),Rt.type(po,"object","invalid args to regl({...})");function Ds(Xr){var yr=$({},Xr);delete yr.uniforms,delete yr.attributes,delete yr.context,delete yr.vao,"stencil"in yr&&yr.stencil.op&&(yr.stencil.opBack=yr.stencil.opFront=yr.stencil.op,delete yr.stencil.op);function vr(Mr){if(Mr in yr){var kn=yr[Mr];delete yr[Mr],Object.keys(kn).forEach(function(fr){yr[Mr+"."+fr]=kn[fr]})}}return vr("blend"),vr("depth"),vr("cull"),vr("stencil"),vr("polygonOffset"),vr("scissor"),vr("sample"),"vao"in Xr&&(yr.vao=Xr.vao),yr}function pi(Xr,yr){var vr={},Mr={};return Object.keys(Xr).forEach(function(kn){var fr=Xr[kn];if(sr.isDynamic(fr)){Mr[kn]=sr.unbox(fr,kn);return}else if(yr&&Array.isArray(fr)){for(var Sn=0;Sn<fr.length;++Sn)if(sr.isDynamic(fr[Sn])){Mr[kn]=sr.unbox(fr,kn);return}}vr[kn]=fr}),{dynamic:Mr,static:vr}}var Sl=pi(po.context||{},!0),rh=pi(po.uniforms||{},!0),fl=pi(po.attributes||{},!1),$n=pi(Ds(po),!1),Jr={gpuTime:0,cpuTime:0,count:0},Nr=En.compile($n,fl,rh,Sl,Jr),Hi=Nr.draw,Jo=Nr.batch,An=Nr.scope,sn=[];function hr(Xr){for(;sn.length<Xr;)sn.push(null);return sn}function Pr(Xr,yr){var vr;if(Sa&&Rt.raise("context lost"),typeof Xr=="function")return An.call(this,null,Xr,0);if(typeof yr=="function")if(typeof Xr=="number")for(vr=0;vr<Xr;++vr)An.call(this,null,yr,vr);else if(Array.isArray(Xr))for(vr=0;vr<Xr.length;++vr)An.call(this,Xr[vr],yr,vr);else return An.call(this,Xr,yr,0);else if(typeof Xr=="number"){if(Xr>0)return Jo.call(this,hr(Xr|0),Xr|0)}else if(Array.isArray(Xr)){if(Xr.length)return Jo.call(this,Xr,Xr.length)}else return Hi.call(this,Xr)}return $(Pr,{stats:Jr,destroy:function(){Nr.destroy()}})}var ku=jn.setFBO=Fl({framebuffer:sr.define.call(null,cv,"framebuffer")});function xs(po,Ds){var pi=0;En.procs.poll();var Sl=Ds.color;Sl&&(qn.clearColor(+Sl[0]||0,+Sl[1]||0,+Sl[2]||0,+Sl[3]||0),pi|=li),"depth"in Ds&&(qn.clearDepth(+Ds.depth),pi|=eg),"stencil"in Ds&&(qn.clearStencil(Ds.stencil|0),pi|=Tp),Rt(!!pi,"called regl.clear with no buffer specified"),qn.clear(pi)}function _u(po){if(Rt(typeof po=="object"&&po,"regl.clear() takes an object as input"),"framebuffer"in po)if(po.framebuffer&&po.framebuffer_reglType==="framebufferCube")for(var Ds=0;Ds<6;++Ds)ku($({framebuffer:po.framebuffer.faces[Ds]},po),xs);else ku(po,xs);else xs(null,po)}function cl(po){Rt.type(po,"function","regl.frame() callback must be a function"),or.push(po);function Ds(){var pi=Mp(or,po);Rt(pi>=0,"cannot cancel a frame twice");function Sl(){var rh=Mp(or,Sl);or[rh]=or[or.length-1],or.length-=1,or.length<=0&&Yo()}or[pi]=Sl}return _i(),{cancel:Ds}}function zi(){var po=Dr.viewport,Ds=Dr.scissor_box;po[0]=po[1]=Ds[0]=Ds[1]=0,q.viewportWidth=q.framebufferWidth=q.drawingBufferWidth=po[2]=Ds[2]=qn.drawingBufferWidth,q.viewportHeight=q.framebufferHeight=q.drawingBufferHeight=po[3]=Ds[3]=qn.drawingBufferHeight}function zu(){q.tick+=1,q.time=Qo(),zi(),En.procs.poll()}function sl(){gn.refresh(),zi(),En.procs.refresh(),Ga&&Ga.update()}function Qo(){return(tr()-Qa)/1e3}sl();function Zl(po,Ds){Rt.type(Ds,"function","listener callback must be a function");var pi;switch(po){case"frame":return cl(Ds);case"lost":pi=Xa;break;case"restore":pi=Hn;break;case"destroy":pi=si;break;default:Rt.raise("invalid event, must be one of frame,lost,restore,destroy")}return pi.push(Ds),{cancel:function(){for(var Sl=0;Sl<pi.length;++Sl)if(pi[Sl]===Ds){pi[Sl]=pi[pi.length-1],pi.pop();return}}}}var yu=$(Fl,{clear:_u,prop:sr.define.bind(null,cv),context:sr.define.bind(null,nh),this:sr.define.bind(null,Rv),draw:Fl({}),buffer:function(po){return jt.create(po,lv,!1,!1)},elements:function(po){return Te.create(po,!1)},texture:gn.create2D,cube:gn.createCube,renderbuffer:cn.create,framebuffer:jn.create,framebufferCube:jn.createCube,vao:ie.createVAO,attributes:ia,frame:cl,on:Zl,limits:Pt,hasExtension:function(po){return Pt.extensions.indexOf(po.toLowerCase())>=0},read:ya,destroy:jo,_gl:qn,_refresh:sl,poll:function(){zu(),Ga&&Ga.update()},now:Qo,stats:Ha});return vn.onDone(null,yu),yu}return Np})},36377:function(ur,ot,$){var Y=$(84832),tt=$(68652),j=$(90801),W=$(92030),Q=$(3618),Z=$(89049),R=$(51971);R.alea=Y,R.xor128=tt,R.xorwow=j,R.xorshift7=W,R.xor4096=Q,R.tychei=Z,ur.exports=R},84832:function(ur,ot,$){ur=$.nmd(ur);var Y;(function(tt,j,W){function Q(C){var A=this,N=L();A.next=function(){var B=2091639*A.s0+A.c*23283064365386963e-26;return A.s0=A.s1,A.s1=A.s2,A.s2=B-(A.c=B|0)},A.c=1,A.s0=N(" "),A.s1=N(" "),A.s2=N(" "),A.s0-=N(C),A.s0<0&&(A.s0+=1),A.s1-=N(C),A.s1<0&&(A.s1+=1),A.s2-=N(C),A.s2<0&&(A.s2+=1),N=null}function Z(C,A){return A.c=C.c,A.s0=C.s0,A.s1=C.s1,A.s2=C.s2,A}function R(C,A){var N=new Q(C),B=A&&A.state,O=N.next;return O.int32=function(){return N.next()*4294967296|0},O.double=function(){return O()+(O()*2097152|0)*11102230246251565e-32},O.quick=O,B&&(typeof B=="object"&&Z(B,N),O.state=function(){return Z(N,{})}),O}function L(){var C=4022871197,A=function(N){N=N.toString();for(var B=0;B<N.length;B++){C+=N.charCodeAt(B);var O=.02519603282416938*C;C=O>>>0,O-=C,O*=C,C=O>>>0,O-=C,C+=O*4294967296}return(C>>>0)*23283064365386963e-26};return A}j&&j.exports?j.exports=R:$.amdD&&$.amdO?(Y=function(){return R}.call(ot,$,ot,j),Y!==void 0&&(j.exports=Y)):this.alea=R})(this,ur,$.amdD)},89049:function(ur,ot,$){ur=$.nmd(ur);var Y;(function(tt,j,W){function Q(L){var C=this,A="";C.next=function(){var B=C.b,O=C.c,F=C.d,K=C.a;return B=B<<25^B>>>7^O,O=O-F|0,F=F<<24^F>>>8^K,K=K-B|0,C.b=B=B<<20^B>>>12^O,C.c=O=O-F|0,C.d=F<<16^O>>>16^K,C.a=K-B|0},C.a=0,C.b=0,C.c=2654435769|0,C.d=1367130551,L===Math.floor(L)?(C.a=L/4294967296|0,C.b=L|0):A+=L;for(var N=0;N<A.length+20;N++)C.b^=A.charCodeAt(N)|0,C.next()}function Z(L,C){return C.a=L.a,C.b=L.b,C.c=L.c,C.d=L.d,C}function R(L,C){var A=new Q(L),N=C&&C.state,B=function(){return(A.next()>>>0)/4294967296};return B.double=function(){do var O=A.next()>>>11,F=(A.next()>>>0)/4294967296,K=(O+F)/(1<<21);while(K===0);return K},B.int32=A.next,B.quick=B,N&&(typeof N=="object"&&Z(N,A),B.state=function(){return Z(A,{})}),B}j&&j.exports?j.exports=R:$.amdD&&$.amdO?(Y=function(){return R}.call(ot,$,ot,j),Y!==void 0&&(j.exports=Y)):this.tychei=R})(this,ur,$.amdD)},68652:function(ur,ot,$){ur=$.nmd(ur);var Y;(function(tt,j,W){function Q(L){var C=this,A="";C.x=0,C.y=0,C.z=0,C.w=0,C.next=function(){var B=C.x^C.x<<11;return C.x=C.y,C.y=C.z,C.z=C.w,C.w^=C.w>>>19^B^B>>>8},L===(L|0)?C.x=L:A+=L;for(var N=0;N<A.length+64;N++)C.x^=A.charCodeAt(N)|0,C.next()}function Z(L,C){return C.x=L.x,C.y=L.y,C.z=L.z,C.w=L.w,C}function R(L,C){var A=new Q(L),N=C&&C.state,B=function(){return(A.next()>>>0)/4294967296};return B.double=function(){do var O=A.next()>>>11,F=(A.next()>>>0)/4294967296,K=(O+F)/(1<<21);while(K===0);return K},B.int32=A.next,B.quick=B,N&&(typeof N=="object"&&Z(N,A),B.state=function(){return Z(A,{})}),B}j&&j.exports?j.exports=R:$.amdD&&$.amdO?(Y=function(){return R}.call(ot,$,ot,j),Y!==void 0&&(j.exports=Y)):this.xor128=R})(this,ur,$.amdD)},3618:function(ur,ot,$){ur=$.nmd(ur);var Y;(function(tt,j,W){function Q(L){var C=this;C.next=function(){var N=C.w,B=C.X,O=C.i,F,K;return C.w=N=N+1640531527|0,K=B[O+34&127],F=B[O=O+1&127],K^=K<<13,F^=F<<17,K^=K>>>15,F^=F>>>12,K=B[O]=K^F,C.i=O,K+(N^N>>>16)|0};function A(N,B){var O,F,K,nt,P,k=[],yt=128;for(B===(B|0)?(F=B,B=null):(B=B+"\0",F=0,yt=Math.max(yt,B.length)),K=0,nt=-32;nt<yt;++nt)B&&(F^=B.charCodeAt((nt+32)%B.length)),nt===0&&(P=F),F^=F<<10,F^=F>>>15,F^=F<<4,F^=F>>>13,nt>=0&&(P=P+1640531527|0,O=k[nt&127]^=F+P,K=O==0?K+1:0);for(K>=128&&(k[(B&&B.length||0)&127]=-1),K=127,nt=4*128;nt>0;--nt)F=k[K+34&127],O=k[K=K+1&127],F^=F<<13,O^=O<<17,F^=F>>>15,O^=O>>>12,k[K]=F^O;N.w=P,N.X=k,N.i=K}A(C,L)}function Z(L,C){return C.i=L.i,C.w=L.w,C.X=L.X.slice(),C}function R(L,C){L==null&&(L=+new Date);var A=new Q(L),N=C&&C.state,B=function(){return(A.next()>>>0)/4294967296};return B.double=function(){do var O=A.next()>>>11,F=(A.next()>>>0)/4294967296,K=(O+F)/(1<<21);while(K===0);return K},B.int32=A.next,B.quick=B,N&&(N.X&&Z(N,A),B.state=function(){return Z(A,{})}),B}j&&j.exports?j.exports=R:$.amdD&&$.amdO?(Y=function(){return R}.call(ot,$,ot,j),Y!==void 0&&(j.exports=Y)):this.xor4096=R})(this,ur,$.amdD)},92030:function(ur,ot,$){ur=$.nmd(ur);var Y;(function(tt,j,W){function Q(L){var C=this;C.next=function(){var N=C.x,B=C.i,O,F,K;return O=N[B],O^=O>>>7,F=O^O<<24,O=N[B+1&7],F^=O^O>>>10,O=N[B+3&7],F^=O^O>>>3,O=N[B+4&7],F^=O^O<<7,O=N[B+7&7],O=O^O<<13,F^=O^O<<9,N[B]=F,C.i=B+1&7,F};function A(N,B){var O,F,K=[];if(B===(B|0))F=K[0]=B;else for(B=""+B,O=0;O<B.length;++O)K[O&7]=K[O&7]<<15^B.charCodeAt(O)+K[O+1&7]<<13;for(;K.length<8;)K.push(0);for(O=0;O<8&&K[O]===0;++O);for(O==8?F=K[7]=-1:F=K[O],N.x=K,N.i=0,O=256;O>0;--O)N.next()}A(C,L)}function Z(L,C){return C.x=L.x.slice(),C.i=L.i,C}function R(L,C){L==null&&(L=+new Date);var A=new Q(L),N=C&&C.state,B=function(){return(A.next()>>>0)/4294967296};return B.double=function(){do var O=A.next()>>>11,F=(A.next()>>>0)/4294967296,K=(O+F)/(1<<21);while(K===0);return K},B.int32=A.next,B.quick=B,N&&(N.x&&Z(N,A),B.state=function(){return Z(A,{})}),B}j&&j.exports?j.exports=R:$.amdD&&$.amdO?(Y=function(){return R}.call(ot,$,ot,j),Y!==void 0&&(j.exports=Y)):this.xorshift7=R})(this,ur,$.amdD)},90801:function(ur,ot,$){ur=$.nmd(ur);var Y;(function(tt,j,W){function Q(L){var C=this,A="";C.next=function(){var B=C.x^C.x>>>2;return C.x=C.y,C.y=C.z,C.z=C.w,C.w=C.v,(C.d=C.d+362437|0)+(C.v=C.v^C.v<<4^(B^B<<1))|0},C.x=0,C.y=0,C.z=0,C.w=0,C.v=0,L===(L|0)?C.x=L:A+=L;for(var N=0;N<A.length+64;N++)C.x^=A.charCodeAt(N)|0,N==A.length&&(C.d=C.x<<10^C.x>>>4),C.next()}function Z(L,C){return C.x=L.x,C.y=L.y,C.z=L.z,C.w=L.w,C.v=L.v,C.d=L.d,C}function R(L,C){var A=new Q(L),N=C&&C.state,B=function(){return(A.next()>>>0)/4294967296};return B.double=function(){do var O=A.next()>>>11,F=(A.next()>>>0)/4294967296,K=(O+F)/(1<<21);while(K===0);return K},B.int32=A.next,B.quick=B,N&&(typeof N=="object"&&Z(N,A),B.state=function(){return Z(A,{})}),B}j&&j.exports?j.exports=R:$.amdD&&$.amdO?(Y=function(){return R}.call(ot,$,ot,j),Y!==void 0&&(j.exports=Y)):this.xorwow=R})(this,ur,$.amdD)},51971:function(ur,ot,$){var Y;(function(tt,j){var W=this,Q=256,Z=6,R=52,L="random",C=j.pow(Q,Z),A=j.pow(2,R),N=A*2,B=Q-1,O;function F(lt,ht,mt){var wt=[];ht=ht==!0?{entropy:!0}:ht||{};var ut=k(P(ht.entropy?[lt,st(tt)]:lt==null?yt():lt,3),wt),pt=new K(wt),Nt=function(){for(var Ut=pt.g(Z),ue=C,se=0;Ut<A;)Ut=(Ut+se)*Q,ue*=Q,se=pt.g(1);for(;Ut>=N;)Ut/=2,ue/=2,se>>>=1;return(Ut+se)/ue};return Nt.int32=function(){return pt.g(4)|0},Nt.quick=function(){return pt.g(4)/4294967296},Nt.double=Nt,k(st(pt.S),tt),(ht.pass||mt||function(Ut,ue,se,Le){return Le&&(Le.S&&nt(Le,pt),Ut.state=function(){return nt(pt,{})}),se?(j[L]=Ut,ue):Ut})(Nt,ut,"global"in ht?ht.global:this==j,ht.state)}j["seed"+L]=F;function K(lt){var ht,mt=lt.length,wt=this,ut=0,pt=wt.i=wt.j=0,Nt=wt.S=[];for(mt||(lt=[mt++]);ut<Q;)Nt[ut]=ut++;for(ut=0;ut<Q;ut++)Nt[ut]=Nt[pt=B&pt+lt[ut%mt]+(ht=Nt[ut])],Nt[pt]=ht;(wt.g=function(Ut){for(var ue,se=0,Le=wt.i,Ne=wt.j,we=wt.S;Ut--;)ue=we[Le=B&Le+1],se=se*Q+we[B&(we[Le]=we[Ne=B&Ne+ue])+(we[Ne]=ue)];return wt.i=Le,wt.j=Ne,se})(Q)}function nt(lt,ht){return ht.i=lt.i,ht.j=lt.j,ht.S=lt.S.slice(),ht}function P(lt,ht){var mt=[],wt=typeof lt,ut;if(ht&&wt=="object")for(ut in lt)try{mt.push(P(lt[ut],ht-1))}catch(pt){}return mt.length?mt:wt=="string"?lt:lt+"\0"}function k(lt,ht){for(var mt=lt+"",wt,ut=0;ut<mt.length;)ht[B&ut]=B&(wt^=ht[B&ut]*19)+mt.charCodeAt(ut++);return st(ht)}function yt(){try{var lt;return O&&(lt=O.randomBytes)?lt=lt(Q):(lt=new Uint8Array(Q),(W.crypto||W.msCrypto).getRandomValues(lt)),st(lt)}catch(wt){var ht=W.navigator,mt=ht&&ht.plugins;return[+new Date,W,mt,W.screen,st(tt)]}}function st(lt){return String.fromCharCode.apply(0,lt)}if(k(j.random(),tt),ur.exports){ur.exports=F;try{O=$(75042)}catch(lt){}}else Y=function(){return F}.call(ot,$,ot,ur),Y!==void 0&&(ur.exports=Y)})([],Math)},86851:function(ur,ot,$){"use strict";var Y=$(89594),tt=Array.prototype.concat,j=Array.prototype.slice,W=ur.exports=function(Z){for(var R=[],L=0,C=Z.length;L<C;L++){var A=Z[L];Y(A)?R=tt.call(R,j.call(A)):R.push(A)}return R};W.wrap=function(Q){return function(){return Q(W(arguments))}}},89594:function(ur){ur.exports=function($){return!$||typeof $=="string"?!1:$ instanceof Array||Array.isArray($)||$.length>=0&&($.splice instanceof Function||Object.getOwnPropertyDescriptor($,$.length-1)&&$.constructor.name!=="String")}}}]);
