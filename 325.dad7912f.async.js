(self.webpackChunkbiomedgps_studio=self.webpackChunkbiomedgps_studio||[]).push([[325],{22325:function(A,Z,e){"use strict";e.d(Z,{Z:function(){return Oe}});var T=e(39428),V=e(3182),k=e(86582),U=e(2824),Ee=e(57663),te=e(71577),se=e(11849),ne=e(69610),re=e(54941),W=e(3372),ie=e(81306),oe=e(59206),w=e(67294),ce=e(17453),J=function(i){return i.replace(/^\s+|\s+$/g,"")},le=e(82741),de=e.n(le),a=e(85893);function he(t){var i=(0,w.useState)(""),o=(0,U.Z)(i,2),r=o[0],n=o[1],s=function(l){n(l.target.value)},x=function(l){var u=J(r);u.length&&g(u)},p=function(l){if((t.onSendKey===void 0||l[t.onSendKey])&&l.charCode===13){var u=J(r);return u.length&&g(u),l.preventDefault(),!1}},g=function(l){t.onSendMessage(l),n("")};return(0,a.jsxs)("div",{className:"react-chat-inputBox ".concat(t.disabled?"disabled":""),children:[(0,a.jsx)(ce.Z,{maxRows:3,className:"react-chat-textarea",placeholder:t.disabled?t.disabledInputPlaceholder:t.placeholder,value:r,onChange:s,onKeyPress:p,autoFocus:!0,disabled:t.disabled}),(0,a.jsx)("button",{className:"react-chat-sendButton",onClick:x,disabled:t.disabled,children:(0,a.jsx)("img",{src:de(),className:t.disabled?"react-chat-SendIcon-disable":"react-chat-SendIcon"})})]})}var Re=e(22385),z=e(94199),ue=e(30381),E=e.n(ue),me=e(74310),ge=e(49523),ve=e.n(ge),fe=e(59108),xe=e.n(fe),pe=e(58812),ye=e(81825),Ae=e(10043),Ie=e.n(Ae),je=e(10913),Fe=e(63183),Ce=e(78777),Se=e(99251),Ne=e(33835),Me=e(70445);function Pe(t){var i=t.type,o=t.timestamp,r=t.timestampFormat,n=t.buttons,s=t.left,x=t.author,p=t.hasError,g=t.text,v=t.likeHandler,l=t.dislikeHandler,u=(0,me.Kd)();if(i==="text"||i==="indicator"||i==="markdown"){var I;o&&(r==="calendar"?I=E()(o).locale(u).calendar():r==="fromNow"?I=E()(o).locale(u).fromNow():I=E()(o).locale(u).format(r));var C=n?n.map(function(N,j){if(N.type==="URL")return(0,a.jsx)("a",{href:N.payload,rel:"noreferrer",target:"_blank",className:"react-chat-message-button",children:N.title},j)}):[],S=[je.Z,Se.Z,Ne.Z,Ce.Z];return(0,a.jsxs)("div",{className:"react-chat-messageBox ".concat(s?"react-chat-messageBoxLeft":"react-chat-messageBoxRight"),children:[(0,a.jsx)("img",{alt:"avater img",src:x.avatarUrl?x.avatarUrl:xe(),className:"react-chat-avatar ".concat(s?"react-chat-avatarLeft":"react-chat-avatarRight")}),(0,a.jsxs)("div",{className:"react-chat-message ".concat(s?"react-chat-messageLeft":"react-chat-messageRight"),children:[(0,a.jsx)("div",{className:"react-chat-additional",children:x.username}),(0,a.jsxs)("div",{className:"react-chat-bubble ".concat(s?"react-chat-leftBubble":"react-chat-rightBubble"," ").concat(p?"react-chat-bubbleWithError":""),children:[i==="indicator"&&(0,a.jsxs)("div",{className:"react-chat-typing-indicator",children:[(0,a.jsx)("span",{}),(0,a.jsx)("span",{}),(0,a.jsx)("span",{})]}),i==="text"&&g,i==="markdown"&&g&&(0,a.jsx)(Me.D,{className:"message-markdown-viewer",rehypePlugins:S,remarkPlugins:[Ie()],children:g}),C.length>0&&(0,a.jsx)("div",{className:s?"react-chat-message-buttonGroupLeft":"react-chat-message-buttonGroupRight",children:C}),p&&(0,a.jsx)("img",{src:ve(),className:"".concat(s?"react-chat-errorLeft":"react-chat-errorRight"," react-chat-error")})]}),(0,a.jsxs)("div",{className:"react-chat-additional",children:[I!==null&&I,(0,a.jsxs)("span",{className:"react-chat-message-like",children:[(0,a.jsx)(z.Z,{title:"Like",children:(0,a.jsx)(pe.Z,{onClick:function(j){v&&v(j)}})}),(0,a.jsx)(z.Z,{title:"Dislike",children:(0,a.jsx)(ye.Z,{onClick:function(j){l&&l(j)}})})]})]})]})]})}else if(i==="notification")return(0,a.jsx)("div",{className:"text-center text-secondary react-chat-notification",children:g})}var X=Pe,Q=function(t){(0,ie.Z)(o,t);var i=(0,oe.Z)(o);function o(r){var n;return(0,ne.Z)(this,o),n=i.call(this,r),n.scrollToBottom=n.scrollToBottom.bind((0,W.Z)(n)),n.handleOnSendMessage=n.handleOnSendMessage.bind((0,W.Z)(n)),n}return(0,re.Z)(o,[{key:"scrollToBottom",value:function(){this.messagesList&&(this.messagesList.scrollTop=this.messagesList.scrollHeight-this.messagesList.clientHeight)}},{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"handleOnSendMessage",value:function(n){this.props.onSendMessage(n)}},{key:"render",value:function(){var n=this,s=this.props,x=s.messages,p=s.userId,g=s.timestampFormat,v=s.height,l=s.width,u=s.disableInput,I=s.disabledInputPlaceholder,C=s.placeholder,S=s.style,N=s.showTypingIndicator,j=s.activeAuthor,R=s.onSendKey,D=s.title,F=s.dislikeHandler,H=s.likeHandler,b=x.map(function(M,m){return(0,a.jsx)(X,(0,se.Z)({dislikeHandler:F,likeHandler:H,left:M.author&&M.author.id!==p,timestampFormat:g},M),m)});return(0,a.jsx)("div",{style:S,className:"react-chat-container",children:(0,a.jsx)("div",{className:"react-chat-row",children:(0,a.jsxs)("div",{className:"react-chat-viewerBox",style:{height:v,width:l},children:[(0,a.jsxs)("div",{className:"react-chat-header",children:[(0,a.jsx)("div",{className:"react-chat-headerTitle",children:D||"ChatBot"}),(0,a.jsx)(te.Z,{size:"small",shape:"round",danger:!0,onClick:function(){n.props.clearHistory&&n.props.clearHistory()},children:"Clear"})]}),(0,a.jsx)("div",{className:"react-chat-messagesList",ref:function(m){return n.messagesList=m},children:(0,a.jsxs)("div",{className:"react-chat-messagesListContent",children:[b&&b.length>0?b:"No messages yet, please start a conversation.",N&&j!==null&&(0,a.jsx)(X,{type:"indicator",author:j,text:"",left:!0})]})}),(0,a.jsx)(he,{onSendMessage:this.handleOnSendMessage,disabled:u,placeholder:C,disabledInputPlaceholder:I,onSendKey:R})]})})})}}]),o}(w.Component);Q.defaultProps={messages:[],timestampFormat:"calendar",disableInput:!1,disabledInputPlaceholder:"",placeholder:"",showTypingIndicator:!1,activeAuthor:null};var we=Q,He=e(57492),Le=e(78610);function Ge(t){var i=t.icon,o=t.chatbox,r=t.showChatbox,n=t.clickIcon,s=t.showIcon,x=t.iconStyle,p=t.children;return _jsx("div",{className:"react-chat-frame",children:_jsxs("div",{className:"react-chat-frame-wrapper",children:[r&&o!==void 0&&_jsxs(_Fragment,{children:[_jsx("div",{className:"react-chat-close-icon",onClick:n,children:_jsx(CloseIcon,{})}),o]}),!r&&_jsx("div",{className:"react-chat-frame-custom",children:p}),s&&_jsx("div",{className:"react-chat-frame-icon-container",onClick:n,style:x,children:i!==void 0?i:_jsx(RobotIcon,{className:"react-chat-frame-icon"})})]})})}var Ke=null,be=we,Be=e(96486),Ze={UMI_APP_IS_STATIC:"true",UMI_APP_API_PREFIX:"https://data.3steps.cn:8443",NODE_ENV:"production"}.UMI_APP_AI_API?{UMI_APP_IS_STATIC:"true",UMI_APP_API_PREFIX:"https://data.3steps.cn:8443",NODE_ENV:"production"}.UMI_APP_AI_API:"https://ai.3steps.cn/run/predict",ke=function(i){var o="indicator",r="text",n=300,s=function(c){return(0,Be.filter)(c,function(d){return d.type!==o})},x=(0,w.useState)(!1),p=(0,U.Z)(x,2),g=p[0],v=p[1],l=JSON.parse(localStorage.getItem("chatai-messages")||"[]"),u=(0,w.useState)(s(l)),I=(0,U.Z)(u,2),C=I[0],S=I[1],N=function(c,d){var y={author:{id:2,username:"ChatAI",avatarUrl:"/images/ai.svg"},text:c,timestamp:+new Date,type:o},h=[].concat((0,k.Z)(d),[y]);return S(h),h},j=function(c,d){var y={author:{id:2,username:"ChatAI",avatarUrl:"/images/ai.svg"},text:c,timestamp:+new Date,type:r};return[].concat((0,k.Z)(d),[y])},R=function(c,d){var y={author:{id:2,username:"ChatAI",avatarUrl:"/images/ai.svg"},text:c,timestamp:+new Date,type:"markdown"};return[].concat((0,k.Z)(d),[y])},D=function(c){var d={author:{id:2,username:"ChatAI",avatarUrl:"/images/ai.svg"},text:"Sorry, error occurred, please try again later.",timestamp:+new Date,type:r};return[].concat((0,k.Z)(c),[d])},F=function(c){return c==="human"?9606:c==="mouse"?10090:c==="rat"?10116:9606},H=function(){var m=(0,V.Z)((0,T.Z)().mark(function c(d,y){var h,$,Te;return(0,T.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:h=N("Predicting, wait a moment (it's slow, be patient)...",y),v(!0),$=d,Te=`

Do you know the above question? please output it as the following format?  {     "entity_type": "xxx",  // One of Gene, Drug or Protein  "entity_name": "xxx", "which_relationships": "xxx", // One of All, Gene-Drug, Gene-Gene, Gene-Protein, Drug-Protein "gene_name": "xxx", "entrez_id": "xxx", "taxid": "xxx",  "which_task": "xxx", // One of KnowledgeGraph, sgRNAs  "which_species": "xxx" // one of rat, mouse and human }`,fetch(Ze,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic c2FtbXk6USlZS3V4RlU4IVkjbihCWg=="},body:JSON.stringify({data:[$]})}).then(function(){var De=(0,V.Z)((0,T.Z)().mark(function Y(Ue){var P,f,B,q,_,G,ee,K,ae;return(0,T.Z)().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,Ue.json();case 2:if(P=O.sent,P&&P.data){console.log("Alpacas response: ",P.data);try{f=JSON.parse(P.data.join(" ")),B="",f.which_task==="KnowledgeGraph"?f.entity_type&&f.entity_name&&(q=f.entity_type,_=f.entity_name,B='Based on my experiences and knowledges, I guess you want to know the following information. For testing, I will output the parameters based on your input.\n```json\n{\n  "entity_type": "'.concat(q,`",
  "entity_name": "`).concat(_,`",
  "which_relationships": "`).concat(f.which_relationships,'"\n}\n```')):f.which_task==="sgRNAs"&&f.gene_name&&f.which_species&&(G=f.which_species,ee=F(G),K=f.gene_name,B=`Based on my experiences and knowledges, I recommend you to access the following urls for more details.
- <a target="_blank" href="https://biosolver.cn/index.html#/guider-query-details?geneName=`.concat(K,"&taxid=").concat(ee,'">GuideScoper-').concat(K,"-").concat(G,"</a>")),B===""&&(B=P.data.join(" ")),h=R(B,h)}catch(Je){ae=P.data.join(" "),h=j(ae,h)}}else h=D(h);S(s(h)),v(!1);case 6:case"end":return O.stop()}},Y)}));return function(Y){return De.apply(this,arguments)}}()).catch(function(){h=D(h),S(s(h)),v(!1)});case 5:case"end":return L.stop()}},c)}));return function(d,y){return m.apply(this,arguments)}}(),b=function(c){var d={author:{id:1,username:"Me",avatarUrl:"/images/general.svg"},text:c,timestamp:+new Date,type:r},y=[].concat((0,k.Z)(C),[d]);S(y),H(c,y)},M="Predicting, wait a moment...";return(0,w.useEffect)(function(){localStorage.setItem("chatai-messages",JSON.stringify(C))},[C]),(0,w.useEffect)(function(){i.message&&b(i.message)},[i.message]),(0,a.jsx)(be,{messages:C,userId:1,disableInput:g,disabledInputPlaceholder:M,showTypingIndicator:!0,onSendMessage:b,clearHistory:function(){S([]),localStorage.setItem("chatai-messages",JSON.stringify([]))},width:"100%",height:"calc(100vh - 58px)"})},Oe=ke},57492:function(A,Z,e){A.exports=e.p+"static/comments.f39333e3.svg"},78610:function(A,Z,e){A.exports=e.p+"static/compress-alt.2bdf3109.svg"},49523:function(A,Z,e){A.exports=e.p+"static/error-icon.7f8210c1.svg"},82741:function(A,Z,e){A.exports=e.p+"static/send-icon.eb0d7f80.svg"},59108:function(A){A.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYAQMAAADaua+7AAAABlBMVEUAgAAAgAAvApEWAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAFklEQVQImWNgIAFwMDSAaWYGA2K1AAAiqQC8t2zWVgAAAABJRU5ErkJggg=="}}]);
