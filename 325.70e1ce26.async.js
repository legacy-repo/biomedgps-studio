(self.webpackChunkbiomedgps_studio=self.webpackChunkbiomedgps_studio||[]).push([[325],{22325:function(A,k,e){"use strict";e.d(k,{Z:function(){return Pe}});var T=e(39428),W=e(3182),O=e(86582),R=e(2824),He=e(57663),te=e(71577),se=e(11849),ne=e(69610),re=e(54941),J=e(3372),ie=e(81306),oe=e(59206),M=e(67294),ce=e(17453),V=function(i){return i.replace(/^\s+|\s+$/g,"")},le=e(82741),de=e.n(le),a=e(85893);function he(t){var i=(0,M.useState)(""),o=(0,R.Z)(i,2),r=o[0],n=o[1],s=function(l){n(l.target.value)},x=function(l){var u=V(r);u.length&&g(u)},p=function(l){if((t.onSendKey===void 0||l[t.onSendKey])&&l.charCode===13){var u=V(r);return u.length&&g(u),l.preventDefault(),!1}},g=function(l){t.onSendMessage(l),n("")};return(0,a.jsxs)("div",{className:"react-chat-inputBox ".concat(t.disabled?"disabled":""),children:[(0,a.jsx)(ce.Z,{maxRows:3,className:"react-chat-textarea",placeholder:t.disabled?t.disabledInputPlaceholder:t.placeholder,value:r,onChange:s,onKeyPress:p,autoFocus:!0,disabled:t.disabled}),(0,a.jsx)("button",{className:"react-chat-sendButton",onClick:x,disabled:t.disabled,children:(0,a.jsx)("img",{src:de(),className:t.disabled?"react-chat-SendIcon-disable":"react-chat-SendIcon"})})]})}var Le=e(22385),z=e(94199),ue=e(30381),H=e.n(ue),me=e(74310),ge=e(49523),ve=e.n(ge),fe=e(59108),xe=e.n(fe),pe=e(58812),ye=e(81825),Ae=e(10043),je=e.n(Ae),Ce=e(10913),Ue=e(63183),Ie=e(78777),Se=e(99251),Ne=e(33835),we=e(70445);function be(t){var i=t.type,o=t.timestamp,r=t.timestampFormat,n=t.buttons,s=t.left,x=t.author,p=t.hasError,g=t.text,v=t.likeHandler,l=t.dislikeHandler,u=(0,me.Kd)();if(i==="text"||i==="indicator"||i==="markdown"){var j;o&&(r==="calendar"?j=H()(o).locale(u).calendar():r==="fromNow"?j=H()(o).locale(u).fromNow():j=H()(o).locale(u).format(r));var I=n?n.map(function(N,C){if(N.type==="URL")return(0,a.jsx)("a",{href:N.payload,rel:"noreferrer",target:"_blank",className:"react-chat-message-button",children:N.title},C)}):[],S=[Ce.Z,Se.Z,Ne.Z,Ie.Z];return(0,a.jsxs)("div",{className:"react-chat-messageBox ".concat(s?"react-chat-messageBoxLeft":"react-chat-messageBoxRight"),children:[(0,a.jsx)("img",{alt:"avater img",src:x.avatarUrl?x.avatarUrl:xe(),className:"react-chat-avatar ".concat(s?"react-chat-avatarLeft":"react-chat-avatarRight")}),(0,a.jsxs)("div",{className:"react-chat-message ".concat(s?"react-chat-messageLeft":"react-chat-messageRight"),children:[(0,a.jsx)("div",{className:"react-chat-additional",children:x.username}),(0,a.jsxs)("div",{className:"react-chat-bubble ".concat(s?"react-chat-leftBubble":"react-chat-rightBubble"," ").concat(p?"react-chat-bubbleWithError":""),children:[i==="indicator"&&(0,a.jsxs)("div",{className:"react-chat-typing-indicator",children:[(0,a.jsx)("span",{}),(0,a.jsx)("span",{}),(0,a.jsx)("span",{})]}),i==="text"&&g,i==="markdown"&&g&&(0,a.jsx)(we.D,{className:"message-markdown-viewer",rehypePlugins:S,remarkPlugins:[je()],children:g}),I.length>0&&(0,a.jsx)("div",{className:s?"react-chat-message-buttonGroupLeft":"react-chat-message-buttonGroupRight",children:I}),p&&(0,a.jsx)("img",{src:ve(),className:"".concat(s?"react-chat-errorLeft":"react-chat-errorRight"," react-chat-error")})]}),(0,a.jsxs)("div",{className:"react-chat-additional",children:[j!==null&&j,(0,a.jsxs)("span",{className:"react-chat-message-like",children:[(0,a.jsx)(z.Z,{title:"Like",children:(0,a.jsx)(pe.Z,{onClick:function(C){v&&v(C)}})}),(0,a.jsx)(z.Z,{title:"Dislike",children:(0,a.jsx)(ye.Z,{onClick:function(C){l&&l(C)}})})]})]})]})]})}else if(i==="notification")return(0,a.jsx)("div",{className:"text-center text-secondary react-chat-notification",children:g})}var Q=be,$=function(t){(0,ie.Z)(o,t);var i=(0,oe.Z)(o);function o(r){var n;return(0,ne.Z)(this,o),n=i.call(this,r),n.scrollToBottom=n.scrollToBottom.bind((0,J.Z)(n)),n.handleOnSendMessage=n.handleOnSendMessage.bind((0,J.Z)(n)),n}return(0,re.Z)(o,[{key:"scrollToBottom",value:function(){this.messagesList&&(this.messagesList.scrollTop=this.messagesList.scrollHeight-this.messagesList.clientHeight)}},{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"handleOnSendMessage",value:function(n){this.props.onSendMessage(n)}},{key:"render",value:function(){var n=this,s=this.props,x=s.messages,p=s.userId,g=s.timestampFormat,v=s.height,l=s.width,u=s.disableInput,j=s.disabledInputPlaceholder,I=s.placeholder,S=s.style,N=s.showTypingIndicator,C=s.activeAuthor,L=s.onSendKey,D=s.title,U=s.dislikeHandler,F=s.likeHandler,B=x.map(function(w,m){return(0,a.jsx)(Q,(0,se.Z)({dislikeHandler:U,likeHandler:F,left:w.author&&w.author.id!==p,timestampFormat:g},w),m)});return(0,a.jsx)("div",{style:S,className:"react-chat-container",children:(0,a.jsx)("div",{className:"react-chat-row",children:(0,a.jsxs)("div",{className:"react-chat-viewerBox",style:{height:v,width:l},children:[(0,a.jsxs)("div",{className:"react-chat-header",children:[(0,a.jsx)("div",{className:"react-chat-headerTitle",children:D||"ChatBot"}),(0,a.jsx)(te.Z,{size:"small",shape:"round",danger:!0,onClick:function(){n.props.clearHistory&&n.props.clearHistory()},children:"Clear"})]}),(0,a.jsx)("div",{className:"react-chat-messagesList",ref:function(m){return n.messagesList=m},children:(0,a.jsxs)("div",{className:"react-chat-messagesListContent",children:[B&&B.length>0?B:"No messages yet, please start a conversation.",N&&C!==null&&(0,a.jsx)(Q,{type:"indicator",author:C,text:"",left:!0})]})}),(0,a.jsx)(he,{onSendMessage:this.handleOnSendMessage,disabled:u,placeholder:I,disabledInputPlaceholder:j,onSendKey:L})]})})})}}]),o}(M.Component);$.defaultProps={messages:[],timestampFormat:"calendar",disableInput:!1,disabledInputPlaceholder:"",placeholder:"",showTypingIndicator:!1,activeAuthor:null};var Me=$,Fe=e(57492),Ee=e(78610);function Ge(t){var i=t.icon,o=t.chatbox,r=t.showChatbox,n=t.clickIcon,s=t.showIcon,x=t.iconStyle,p=t.children;return _jsx("div",{className:"react-chat-frame",children:_jsxs("div",{className:"react-chat-frame-wrapper",children:[r&&o!==void 0&&_jsxs(_Fragment,{children:[_jsx("div",{className:"react-chat-close-icon",onClick:n,children:_jsx(CloseIcon,{})}),o]}),!r&&_jsx("div",{className:"react-chat-frame-custom",children:p}),s&&_jsx("div",{className:"react-chat-frame-icon-container",onClick:n,style:x,children:i!==void 0?i:_jsx(RobotIcon,{className:"react-chat-frame-icon"})})]})})}var Ke=null,Be=Me,Ze=e(96486),ke="https://ai.3steps.cn/run/predict",Oe=function(i){var o="indicator",r="text",n=300,s=function(c){return(0,Ze.filter)(c,function(d){return d.type!==o})},x=(0,M.useState)(!1),p=(0,R.Z)(x,2),g=p[0],v=p[1],l=JSON.parse(localStorage.getItem("chatai-messages")||"[]"),u=(0,M.useState)(s(l)),j=(0,R.Z)(u,2),I=j[0],S=j[1],N=function(c,d){var y={author:{id:2,username:"ChatAI",avatarUrl:"/images/ai.svg"},text:c,timestamp:+new Date,type:o},h=[].concat((0,O.Z)(d),[y]);return S(h),h},C=function(c,d){var y={author:{id:2,username:"ChatAI",avatarUrl:"/images/ai.svg"},text:c,timestamp:+new Date,type:r};return[].concat((0,O.Z)(d),[y])},L=function(c,d){var y={author:{id:2,username:"ChatAI",avatarUrl:"/images/ai.svg"},text:c,timestamp:+new Date,type:"markdown"};return[].concat((0,O.Z)(d),[y])},D=function(c){var d={author:{id:2,username:"ChatAI",avatarUrl:"/images/ai.svg"},text:"Sorry, error occurred, please try again later.",timestamp:+new Date,type:r};return[].concat((0,O.Z)(c),[d])},U=function(c){return c==="human"?9606:c==="mouse"?10090:c==="rat"?10116:9606},F=function(){var m=(0,W.Z)((0,T.Z)().mark(function c(d,y){var h,X,Te;return(0,T.Z)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:h=N("Predicting, wait a moment (it's slow, be patient)...",y),v(!0),X=d,Te=`

Do you know the above question? please output it as the following format?  {     "entity_type": "xxx",  // One of Gene, Drug or Protein  "entity_name": "xxx", "which_relationships": "xxx", // One of All, Gene-Drug, Gene-Gene, Gene-Protein, Drug-Protein "gene_name": "xxx", "entrez_id": "xxx", "taxid": "xxx",  "which_task": "xxx", // One of KnowledgeGraph, sgRNAs  "which_species": "xxx" // one of rat, mouse and human }`,fetch(ke,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic c2FtbXk6USlZS3V4RlU4IVkjbihCWg=="},body:JSON.stringify({data:[X]})}).then(function(){var De=(0,W.Z)((0,T.Z)().mark(function Y(Re){var b,f,Z,q,_,G,ee,K,ae;return(0,T.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,Re.json();case 2:if(b=P.sent,b&&b.data){console.log("Alpacas response: ",b.data);try{f=JSON.parse(b.data.join(" ")),Z="",f.which_task==="KnowledgeGraph"?f.entity_type&&f.entity_name&&(q=f.entity_type,_=f.entity_name,Z='Based on my experiences and knowledges, I guess you want to know the following information. For testing, I will output the parameters based on your input.\n```json\n{\n  "entity_type": "'.concat(q,`",
  "entity_name": "`).concat(_,`",
  "which_relationships": "`).concat(f.which_relationships,'"\n}\n```')):f.which_task==="sgRNAs"&&f.gene_name&&f.which_species&&(G=f.which_species,ee=U(G),K=f.gene_name,Z=`Based on my experiences and knowledges, I recommend you to access the following urls for more details.
- <a target="_blank" href="https://biosolver.cn/index.html#/guider-query-details?geneName=`.concat(K,"&taxid=").concat(ee,'">GuideScoper-').concat(K,"-").concat(G,"</a>")),Z===""&&(Z=b.data.join(" ")),h=L(Z,h)}catch(Ve){ae=b.data.join(" "),h=C(ae,h)}}else h=D(h);S(s(h)),v(!1);case 6:case"end":return P.stop()}},Y)}));return function(Y){return De.apply(this,arguments)}}()).catch(function(){h=D(h),S(s(h)),v(!1)});case 5:case"end":return E.stop()}},c)}));return function(d,y){return m.apply(this,arguments)}}(),B=function(c){var d={author:{id:1,username:"Me",avatarUrl:"/images/general.svg"},text:c,timestamp:+new Date,type:r},y=[].concat((0,O.Z)(I),[d]);S(y),F(c,y)},w="Predicting, wait a moment...";return(0,M.useEffect)(function(){localStorage.setItem("chatai-messages",JSON.stringify(I))},[I]),(0,M.useEffect)(function(){i.message&&B(i.message)},[i.message]),(0,a.jsx)(Be,{messages:I,userId:1,disableInput:g,disabledInputPlaceholder:w,showTypingIndicator:!0,onSendMessage:B,clearHistory:function(){S([]),localStorage.setItem("chatai-messages",JSON.stringify([]))},width:"100%",height:"calc(100vh - 58px)"})},Pe=Oe},57492:function(A,k,e){A.exports=e.p+"static/comments.f39333e3.svg"},78610:function(A,k,e){A.exports=e.p+"static/compress-alt.2bdf3109.svg"},49523:function(A,k,e){A.exports=e.p+"static/error-icon.7f8210c1.svg"},82741:function(A,k,e){A.exports=e.p+"static/send-icon.eb0d7f80.svg"},59108:function(A){A.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYAQMAAADaua+7AAAABlBMVEUAgAAAgAAvApEWAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAFklEQVQImWNgIAFwMDSAaWYGA2K1AAAiqQC8t2zWVgAAAABJRU5ErkJggg=="}}]);
